(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();function vx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var s0={exports:{}},Jc={};var tw;function GE(){if(tw)return Jc;tw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var m in o)m!=="key"&&(c[m]=o[m])}else c=o;return o=c.ref,{$$typeof:n,type:i,key:d,ref:o!==void 0?o:null,props:c}}return Jc.Fragment=e,Jc.jsx=t,Jc.jsxs=t,Jc}var sw;function YE(){return sw||(sw=1,s0.exports=GE()),s0.exports}var a=YE(),n0={exports:{}},ct={};var nw;function WE(){if(nw)return ct;nw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),_=Symbol.iterator;function R(z){return z===null||typeof z!="object"?null:(z=_&&z[_]||z["@@iterator"],typeof z=="function"?z:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,U={};function F(z,Z,ce){this.props=z,this.context=Z,this.refs=U,this.updater=ce||B}F.prototype.isReactComponent={},F.prototype.setState=function(z,Z){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,Z,"setState")},F.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function Q(){}Q.prototype=F.prototype;function H(z,Z,ce){this.props=z,this.context=Z,this.refs=U,this.updater=ce||B}var re=H.prototype=new Q;re.constructor=H,V(re,F.prototype),re.isPureReactComponent=!0;var he=Array.isArray;function W(){}var T={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function S(z,Z,ce){var ge=ce.ref;return{$$typeof:n,type:z,key:Z,ref:ge!==void 0?ge:null,props:ce}}function I(z,Z){return S(z.type,Z,z.props)}function k(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function O(z){var Z={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(ce){return Z[ce]})}var C=/\/+/g;function $(z,Z){return typeof z=="object"&&z!==null&&z.key!=null?O(""+z.key):Z.toString(36)}function L(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(W,W):(z.status="pending",z.then(function(Z){z.status==="pending"&&(z.status="fulfilled",z.value=Z)},function(Z){z.status==="pending"&&(z.status="rejected",z.reason=Z)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function P(z,Z,ce,ge,de){var Ce=typeof z;(Ce==="undefined"||Ce==="boolean")&&(z=null);var Fe=!1;if(z===null)Fe=!0;else switch(Ce){case"bigint":case"string":case"number":Fe=!0;break;case"object":switch(z.$$typeof){case n:case e:Fe=!0;break;case b:return Fe=z._init,P(Fe(z._payload),Z,ce,ge,de)}}if(Fe)return de=de(z),Fe=ge===""?"."+$(z,0):ge,he(de)?(ce="",Fe!=null&&(ce=Fe.replace(C,"$&/")+"/"),P(de,Z,ce,"",function(Bt){return Bt})):de!=null&&(k(de)&&(de=I(de,ce+(de.key==null||z&&z.key===de.key?"":(""+de.key).replace(C,"$&/")+"/")+Fe)),Z.push(de)),1;Fe=0;var Rt=ge===""?".":ge+":";if(he(z))for(var it=0;it<z.length;it++)ge=z[it],Ce=Rt+$(ge,it),Fe+=P(ge,Z,ce,Ce,de);else if(it=R(z),typeof it=="function")for(z=it.call(z),it=0;!(ge=z.next()).done;)ge=ge.value,Ce=Rt+$(ge,it++),Fe+=P(ge,Z,ce,Ce,de);else if(Ce==="object"){if(typeof z.then=="function")return P(L(z),Z,ce,ge,de);throw Z=String(z),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return Fe}function K(z,Z,ce){if(z==null)return z;var ge=[],de=0;return P(z,ge,"","",function(Ce){return Z.call(ce,Ce,de++)}),ge}function le(z){if(z._status===-1){var Z=z._result;Z=Z(),Z.then(function(ce){(z._status===0||z._status===-1)&&(z._status=1,z._result=ce)},function(ce){(z._status===0||z._status===-1)&&(z._status=2,z._result=ce)}),z._status===-1&&(z._status=0,z._result=Z)}if(z._status===1)return z._result.default;throw z._result}var Ee=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)},ye={map:K,forEach:function(z,Z,ce){K(z,function(){Z.apply(this,arguments)},ce)},count:function(z){var Z=0;return K(z,function(){Z++}),Z},toArray:function(z){return K(z,function(Z){return Z})||[]},only:function(z){if(!k(z))throw Error("React.Children.only expected to receive a single React element child.");return z}};return ct.Activity=w,ct.Children=ye,ct.Component=F,ct.Fragment=t,ct.Profiler=o,ct.PureComponent=H,ct.StrictMode=i,ct.Suspense=x,ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,ct.__COMPILER_RUNTIME={__proto__:null,c:function(z){return T.H.useMemoCache(z)}},ct.cache=function(z){return function(){return z.apply(null,arguments)}},ct.cacheSignal=function(){return null},ct.cloneElement=function(z,Z,ce){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var ge=V({},z.props),de=z.key;if(Z!=null)for(Ce in Z.key!==void 0&&(de=""+Z.key),Z)!E.call(Z,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&Z.ref===void 0||(ge[Ce]=Z[Ce]);var Ce=arguments.length-2;if(Ce===1)ge.children=ce;else if(1<Ce){for(var Fe=Array(Ce),Rt=0;Rt<Ce;Rt++)Fe[Rt]=arguments[Rt+2];ge.children=Fe}return S(z.type,de,ge)},ct.createContext=function(z){return z={$$typeof:d,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:c,_context:z},z},ct.createElement=function(z,Z,ce){var ge,de={},Ce=null;if(Z!=null)for(ge in Z.key!==void 0&&(Ce=""+Z.key),Z)E.call(Z,ge)&&ge!=="key"&&ge!=="__self"&&ge!=="__source"&&(de[ge]=Z[ge]);var Fe=arguments.length-2;if(Fe===1)de.children=ce;else if(1<Fe){for(var Rt=Array(Fe),it=0;it<Fe;it++)Rt[it]=arguments[it+2];de.children=Rt}if(z&&z.defaultProps)for(ge in Fe=z.defaultProps,Fe)de[ge]===void 0&&(de[ge]=Fe[ge]);return S(z,Ce,de)},ct.createRef=function(){return{current:null}},ct.forwardRef=function(z){return{$$typeof:m,render:z}},ct.isValidElement=k,ct.lazy=function(z){return{$$typeof:b,_payload:{_status:-1,_result:z},_init:le}},ct.memo=function(z,Z){return{$$typeof:g,type:z,compare:Z===void 0?null:Z}},ct.startTransition=function(z){var Z=T.T,ce={};T.T=ce;try{var ge=z(),de=T.S;de!==null&&de(ce,ge),typeof ge=="object"&&ge!==null&&typeof ge.then=="function"&&ge.then(W,Ee)}catch(Ce){Ee(Ce)}finally{Z!==null&&ce.types!==null&&(Z.types=ce.types),T.T=Z}},ct.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},ct.use=function(z){return T.H.use(z)},ct.useActionState=function(z,Z,ce){return T.H.useActionState(z,Z,ce)},ct.useCallback=function(z,Z){return T.H.useCallback(z,Z)},ct.useContext=function(z){return T.H.useContext(z)},ct.useDebugValue=function(){},ct.useDeferredValue=function(z,Z){return T.H.useDeferredValue(z,Z)},ct.useEffect=function(z,Z){return T.H.useEffect(z,Z)},ct.useEffectEvent=function(z){return T.H.useEffectEvent(z)},ct.useId=function(){return T.H.useId()},ct.useImperativeHandle=function(z,Z,ce){return T.H.useImperativeHandle(z,Z,ce)},ct.useInsertionEffect=function(z,Z){return T.H.useInsertionEffect(z,Z)},ct.useLayoutEffect=function(z,Z){return T.H.useLayoutEffect(z,Z)},ct.useMemo=function(z,Z){return T.H.useMemo(z,Z)},ct.useOptimistic=function(z,Z){return T.H.useOptimistic(z,Z)},ct.useReducer=function(z,Z,ce){return T.H.useReducer(z,Z,ce)},ct.useRef=function(z){return T.H.useRef(z)},ct.useState=function(z){return T.H.useState(z)},ct.useSyncExternalStore=function(z,Z,ce){return T.H.useSyncExternalStore(z,Z,ce)},ct.useTransition=function(){return T.H.useTransition()},ct.version="19.2.4",ct}var aw;function wx(){return aw||(aw=1,n0.exports=WE()),n0.exports}var j=wx();const ts=vx(j);var a0={exports:{}},Zc={},r0={exports:{}},i0={};var rw;function QE(){return rw||(rw=1,(function(n){function e(P,K){var le=P.length;P.push(K);e:for(;0<le;){var Ee=le-1>>>1,ye=P[Ee];if(0<o(ye,K))P[Ee]=K,P[le]=ye,le=Ee;else break e}}function t(P){return P.length===0?null:P[0]}function i(P){if(P.length===0)return null;var K=P[0],le=P.pop();if(le!==K){P[0]=le;e:for(var Ee=0,ye=P.length,z=ye>>>1;Ee<z;){var Z=2*(Ee+1)-1,ce=P[Z],ge=Z+1,de=P[ge];if(0>o(ce,le))ge<ye&&0>o(de,ce)?(P[Ee]=de,P[ge]=le,Ee=ge):(P[Ee]=ce,P[Z]=le,Ee=Z);else if(ge<ye&&0>o(de,le))P[Ee]=de,P[ge]=le,Ee=ge;else break e}}return K}function o(P,K){var le=P.sortIndex-K.sortIndex;return le!==0?le:P.id-K.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,m=d.now();n.unstable_now=function(){return d.now()-m}}var x=[],g=[],b=1,w=null,_=3,R=!1,B=!1,V=!1,U=!1,F=typeof setTimeout=="function"?setTimeout:null,Q=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function re(P){for(var K=t(g);K!==null;){if(K.callback===null)i(g);else if(K.startTime<=P)i(g),K.sortIndex=K.expirationTime,e(x,K);else break;K=t(g)}}function he(P){if(V=!1,re(P),!B)if(t(x)!==null)B=!0,W||(W=!0,O());else{var K=t(g);K!==null&&L(he,K.startTime-P)}}var W=!1,T=-1,E=5,S=-1;function I(){return U?!0:!(n.unstable_now()-S<E)}function k(){if(U=!1,W){var P=n.unstable_now();S=P;var K=!0;try{e:{B=!1,V&&(V=!1,Q(T),T=-1),R=!0;var le=_;try{t:{for(re(P),w=t(x);w!==null&&!(w.expirationTime>P&&I());){var Ee=w.callback;if(typeof Ee=="function"){w.callback=null,_=w.priorityLevel;var ye=Ee(w.expirationTime<=P);if(P=n.unstable_now(),typeof ye=="function"){w.callback=ye,re(P),K=!0;break t}w===t(x)&&i(x),re(P)}else i(x);w=t(x)}if(w!==null)K=!0;else{var z=t(g);z!==null&&L(he,z.startTime-P),K=!1}}break e}finally{w=null,_=le,R=!1}K=void 0}}finally{K?O():W=!1}}}var O;if(typeof H=="function")O=function(){H(k)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,$=C.port2;C.port1.onmessage=k,O=function(){$.postMessage(null)}}else O=function(){F(k,0)};function L(P,K){T=F(function(){P(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(P){P.callback=null},n.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<P?Math.floor(1e3/P):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_next=function(P){switch(_){case 1:case 2:case 3:var K=3;break;default:K=_}var le=_;_=K;try{return P()}finally{_=le}},n.unstable_requestPaint=function(){U=!0},n.unstable_runWithPriority=function(P,K){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var le=_;_=P;try{return K()}finally{_=le}},n.unstable_scheduleCallback=function(P,K,le){var Ee=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?Ee+le:Ee):le=Ee,P){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=le+ye,P={id:b++,callback:K,priorityLevel:P,startTime:le,expirationTime:ye,sortIndex:-1},le>Ee?(P.sortIndex=le,e(g,P),t(x)===null&&P===t(g)&&(V?(Q(T),T=-1):V=!0,L(he,le-Ee))):(P.sortIndex=ye,e(x,P),B||R||(B=!0,W||(W=!0,O()))),P},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(P){var K=_;return function(){var le=_;_=K;try{return P.apply(this,arguments)}finally{_=le}}}})(i0)),i0}var iw;function KE(){return iw||(iw=1,r0.exports=QE()),r0.exports}var l0={exports:{}},en={};var lw;function XE(){if(lw)return en;lw=1;var n=wx();function e(x){var g="https://react.dev/errors/"+x;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+x+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(x,g,b){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:w==null?null:""+w,children:x,containerInfo:g,implementation:b}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(x,g){if(x==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return en.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,en.createPortal=function(x,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(x,g,null,b)},en.flushSync=function(x){var g=d.T,b=i.p;try{if(d.T=null,i.p=2,x)return x()}finally{d.T=g,i.p=b,i.d.f()}},en.preconnect=function(x,g){typeof x=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(x,g))},en.prefetchDNS=function(x){typeof x=="string"&&i.d.D(x)},en.preinit=function(x,g){if(typeof x=="string"&&g&&typeof g.as=="string"){var b=g.as,w=m(b,g.crossOrigin),_=typeof g.integrity=="string"?g.integrity:void 0,R=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?i.d.S(x,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:w,integrity:_,fetchPriority:R}):b==="script"&&i.d.X(x,{crossOrigin:w,integrity:_,fetchPriority:R,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},en.preinitModule=function(x,g){if(typeof x=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=m(g.as,g.crossOrigin);i.d.M(x,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(x)},en.preload=function(x,g){if(typeof x=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,w=m(b,g.crossOrigin);i.d.L(x,b,{crossOrigin:w,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},en.preloadModule=function(x,g){if(typeof x=="string")if(g){var b=m(g.as,g.crossOrigin);i.d.m(x,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(x)},en.requestFormReset=function(x){i.d.r(x)},en.unstable_batchedUpdates=function(x,g){return x(g)},en.useFormState=function(x,g,b){return d.H.useFormState(x,g,b)},en.useFormStatus=function(){return d.H.useHostTransitionStatus()},en.version="19.2.4",en}var ow;function JE(){if(ow)return l0.exports;ow=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),l0.exports=XE(),l0.exports}var cw;function ZE(){if(cw)return Zc;cw=1;var n=KE(),e=wx(),t=JE();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var r=s,l=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(l=r.return),s=r.return;while(s)}return r.tag===3?l:null}function d(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function m(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function x(s){if(c(s)!==s)throw Error(i(188))}function g(s){var r=s.alternate;if(!r){if(r=c(s),r===null)throw Error(i(188));return r!==s?null:s}for(var l=s,u=r;;){var f=l.return;if(f===null)break;var p=f.alternate;if(p===null){if(u=f.return,u!==null){l=u;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===l)return x(f),s;if(p===u)return x(f),r;p=p.sibling}throw Error(i(188))}if(l.return!==u.return)l=f,u=p;else{for(var v=!1,A=f.child;A;){if(A===l){v=!0,l=f,u=p;break}if(A===u){v=!0,u=f,l=p;break}A=A.sibling}if(!v){for(A=p.child;A;){if(A===l){v=!0,l=p,u=f;break}if(A===u){v=!0,u=p,l=f;break}A=A.sibling}if(!v)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:r}function b(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=b(s),r!==null)return r;s=s.sibling}return null}var w=Object.assign,_=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),B=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),Q=Symbol.for("react.consumer"),H=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function O(s){return s===null||typeof s!="object"?null:(s=k&&s[k]||s["@@iterator"],typeof s=="function"?s:null)}var C=Symbol.for("react.client.reference");function $(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===C?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case V:return"Fragment";case F:return"Profiler";case U:return"StrictMode";case he:return"Suspense";case W:return"SuspenseList";case S:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case B:return"Portal";case H:return s.displayName||"Context";case Q:return(s._context.displayName||"Context")+".Consumer";case re:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case T:return r=s.displayName||null,r!==null?r:$(s.type)||"Memo";case E:r=s._payload,s=s._init;try{return $(s(r))}catch{}}return null}var L=Array.isArray,P=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},Ee=[],ye=-1;function z(s){return{current:s}}function Z(s){0>ye||(s.current=Ee[ye],Ee[ye]=null,ye--)}function ce(s,r){ye++,Ee[ye]=s.current,s.current=r}var ge=z(null),de=z(null),Ce=z(null),Fe=z(null);function Rt(s,r){switch(ce(Ce,r),ce(de,s),ce(ge,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?_v(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=_v(r),s=Sv(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Z(ge),ce(ge,s)}function it(){Z(ge),Z(de),Z(Ce)}function Bt(s){s.memoizedState!==null&&ce(Fe,s);var r=ge.current,l=Sv(r,s.type);r!==l&&(ce(de,s),ce(ge,l))}function ne(s){de.current===s&&(Z(ge),Z(de)),Fe.current===s&&(Z(Fe),Wc._currentValue=le)}var je,Se;function $e(s){if(je===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);je=r&&r[1]||"",Se=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+je+s+Se}var Ze=!1;function Et(s,r){if(!s||Ze)return"";Ze=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(oe){var ae=oe}Reflect.construct(s,[],ve)}else{try{ve.call()}catch(oe){ae=oe}s.call(ve.prototype)}}else{try{throw Error()}catch(oe){ae=oe}(ve=s())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(oe){if(oe&&ae&&typeof oe.stack=="string")return[oe.stack,ae.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=u.DetermineComponentFrameRoot(),v=p[0],A=p[1];if(v&&A){var q=v.split(`
`),se=A.split(`
`);for(f=u=0;u<q.length&&!q[u].includes("DetermineComponentFrameRoot");)u++;for(;f<se.length&&!se[f].includes("DetermineComponentFrameRoot");)f++;if(u===q.length||f===se.length)for(u=q.length-1,f=se.length-1;1<=u&&0<=f&&q[u]!==se[f];)f--;for(;1<=u&&0<=f;u--,f--)if(q[u]!==se[f]){if(u!==1||f!==1)do if(u--,f--,0>f||q[u]!==se[f]){var me=`
`+q[u].replace(" at new "," at ");return s.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",s.displayName)),me}while(1<=u&&0<=f);break}}}finally{Ze=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?$e(l):""}function Bs(s,r){switch(s.tag){case 26:case 27:case 5:return $e(s.type);case 16:return $e("Lazy");case 13:return s.child!==r&&r!==null?$e("Suspense Fallback"):$e("Suspense");case 19:return $e("SuspenseList");case 0:case 15:return Et(s.type,!1);case 11:return Et(s.type.render,!1);case 1:return Et(s.type,!0);case 31:return $e("Activity");default:return""}}function Mt(s){try{var r="",l=null;do r+=Bs(s,l),l=s,s=s.return;while(s);return r}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var xt=Object.prototype.hasOwnProperty,Ie=n.unstable_scheduleCallback,Be=n.unstable_cancelCallback,xe=n.unstable_shouldYield,qe=n.unstable_requestPaint,Le=n.unstable_now,De=n.unstable_getCurrentPriorityLevel,Ge=n.unstable_ImmediatePriority,He=n.unstable_UserBlockingPriority,J=n.unstable_NormalPriority,Ae=n.unstable_LowPriority,We=n.unstable_IdlePriority,tt=n.log,It=n.unstable_setDisableYieldValue,rs=null,gt=null;function hs(s){if(typeof tt=="function"&&It(s),gt&&typeof gt.setStrictMode=="function")try{gt.setStrictMode(rs,s)}catch{}}var Xt=Math.clz32?Math.clz32:Cn,rn=Math.log,Ms=Math.LN2;function Cn(s){return s>>>=0,s===0?32:31-(rn(s)/Ms|0)|0}var ln=256,_e=262144,Te=4194304;function ot(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function pt(s,r,l){var u=s.pendingLanes;if(u===0)return 0;var f=0,p=s.suspendedLanes,v=s.pingedLanes;s=s.warmLanes;var A=u&134217727;return A!==0?(u=A&~p,u!==0?f=ot(u):(v&=A,v!==0?f=ot(v):l||(l=A&~s,l!==0&&(f=ot(l))))):(A=u&~p,A!==0?f=ot(A):v!==0?f=ot(v):l||(l=u&~s,l!==0&&(f=ot(l)))),f===0?0:r!==0&&r!==f&&(r&p)===0&&(p=f&-f,l=r&-r,p>=l||p===32&&(l&4194048)!==0)?r:f}function Dt(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function M(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function G(){var s=Te;return Te<<=1,(Te&62914560)===0&&(Te=4194304),s}function fe(s){for(var r=[],l=0;31>l;l++)r.push(s);return r}function ue(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ve(s,r,l,u,f,p){var v=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var A=s.entanglements,q=s.expirationTimes,se=s.hiddenUpdates;for(l=v&~l;0<l;){var me=31-Xt(l),ve=1<<me;A[me]=0,q[me]=-1;var ae=se[me];if(ae!==null)for(se[me]=null,me=0;me<ae.length;me++){var oe=ae[me];oe!==null&&(oe.lane&=-536870913)}l&=~ve}u!==0&&et(s,u,0),p!==0&&f===0&&s.tag!==0&&(s.suspendedLanes|=p&~(v&~r))}function et(s,r,l){s.pendingLanes|=r,s.suspendedLanes&=~r;var u=31-Xt(r);s.entangledLanes|=r,s.entanglements[u]=s.entanglements[u]|1073741824|l&261930}function ft(s,r){var l=s.entangledLanes|=r;for(s=s.entanglements;l;){var u=31-Xt(l),f=1<<u;f&r|s[u]&r&&(s[u]|=r),l&=~f}}function Qe(s,r){var l=r&-r;return l=(l&42)!==0?1:vt(l),(l&(s.suspendedLanes|r))!==0?0:l}function vt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Tt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Os(){var s=K.p;return s!==0?s:(s=window.event,s===void 0?32:Wv(s.type))}function Ot(s,r){var l=K.p;try{return K.p=s,r()}finally{K.p=l}}var zs=Math.random().toString(36).slice(2),Jt="__reactFiber$"+zs,ms="__reactProps$"+zs,on="__reactContainer$"+zs,nr="__reactEvents$"+zs,Bi="__reactListeners$"+zs,Il="__reactHandles$"+zs,Dl="__reactResources$"+zs,Aa="__reactMarker$"+zs;function Ml(s){delete s[Jt],delete s[ms],delete s[nr],delete s[Bi],delete s[Il]}function ka(s){var r=s[Jt];if(r)return r;for(var l=s.parentNode;l;){if(r=l[on]||l[Jt]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(s=Iv(s);s!==null;){if(l=s[Jt])return l;s=Iv(s)}return r}s=l,l=s.parentNode}return null}function Hn(s){if(s=s[Jt]||s[on]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function Rn(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function Ca(s){var r=s[Dl];return r||(r=s[Dl]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function _s(s){s[Aa]=!0}var tc=new Set,sc={};function Ra(s,r){Ia(s,r),Ia(s+"Capture",r)}function Ia(s,r){for(sc[s]=r,s=0;s<r.length;s++)tc.add(r[s])}var nc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ac={},rc={};function td(s){return xt.call(rc,s)?!0:xt.call(ac,s)?!1:nc.test(s)?rc[s]=!0:(ac[s]=!0,!1)}function Ol(s,r,l){if(td(r))if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+l)}}function In(s,r,l){if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+l)}}function Ss(s,r,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(r,l,""+u)}}function Fs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Vr(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function ic(s,r,l){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var f=u.get,p=u.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return f.call(this)},set:function(v){l=""+v,p.call(this,v)}}),Object.defineProperty(s,r,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(v){l=""+v},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function qt(s){if(!s._valueTracker){var r=Vr(s)?"checked":"value";s._valueTracker=ic(s,r,""+s[r])}}function zi(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return s&&(u=Vr(s)?s.checked?"true":"false":s.value),s=u,s!==l?(r.setValue(s),!0):!1}function Da(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Fi=/[\n"\\]/g;function fn(s){return s.replace(Fi,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Pl(s,r,l,u,f,p,v,A){s.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?s.type=v:s.removeAttribute("type"),r!=null?v==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+Fs(r)):s.value!==""+Fs(r)&&(s.value=""+Fs(r)):v!=="submit"&&v!=="reset"||s.removeAttribute("value"),r!=null?lc(s,v,Fs(r)):l!=null?lc(s,v,Fs(l)):u!=null&&s.removeAttribute("value"),f==null&&p!=null&&(s.defaultChecked=!!p),f!=null&&(s.checked=f&&typeof f!="function"&&typeof f!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.name=""+Fs(A):s.removeAttribute("name")}function sd(s,r,l,u,f,p,v,A){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(s.type=p),r!=null||l!=null){if(!(p!=="submit"&&p!=="reset"||r!=null)){qt(s);return}l=l!=null?""+Fs(l):"",r=r!=null?""+Fs(r):l,A||r===s.value||(s.value=r),s.defaultValue=r}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=A?s.checked:!!u,s.defaultChecked=!!u,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.name=v),qt(s)}function lc(s,r,l){r==="number"&&Da(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function Ur(s,r,l,u){if(s=s.options,r){r={};for(var f=0;f<l.length;f++)r["$"+l[f]]=!0;for(l=0;l<s.length;l++)f=r.hasOwnProperty("$"+s[l].value),s[l].selected!==f&&(s[l].selected=f),f&&u&&(s[l].defaultSelected=!0)}else{for(l=""+Fs(l),r=null,f=0;f<s.length;f++){if(s[f].value===l){s[f].selected=!0,u&&(s[f].defaultSelected=!0);return}r!==null||s[f].disabled||(r=s[f])}r!==null&&(r.selected=!0)}}function nd(s,r,l){if(r!=null&&(r=""+Fs(r),r!==s.value&&(s.value=r),l==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=l!=null?""+Fs(l):""}function Br(s,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(i(92));if(L(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=Fs(r),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u),qt(s)}function mn(s,r){if(r){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=r;return}}s.textContent=r}var ad=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function oc(s,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":u?s.setProperty(r,l):typeof l!="number"||l===0||ad.has(r)?r==="float"?s.cssFloat=l:s[r]=(""+l).trim():s[r]=l+"px"}function cc(s,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var f in r)u=r[f],r.hasOwnProperty(f)&&l[f]!==u&&oc(s,f,u)}else for(var p in r)r.hasOwnProperty(p)&&oc(s,p,r[p])}function Ll(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vl(s){return zr.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ca(){}var uc=null;function Gn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Fr=null,Ma=null;function $i(s){var r=Hn(s);if(r&&(s=r.stateNode)){var l=s[ms]||null;e:switch(s=r.stateNode,r.type){case"input":if(Pl(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+fn(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==s&&u.form===s.form){var f=u[ms]||null;if(!f)throw Error(i(90));Pl(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===s.form&&zi(u)}break e;case"textarea":nd(s,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&Ur(s,!!l.multiple,r,!1)}}}var Ul=!1;function $r(s,r,l){if(Ul)return s(r,l);Ul=!0;try{var u=s(r);return u}finally{if(Ul=!1,(Fr!==null||Ma!==null)&&(Jd(),Fr&&(r=Fr,s=Ma,Ma=Fr=null,$i(r),s)))for(r=0;r<s.length;r++)$i(s[r])}}function ua(s,r){var l=s.stateNode;if(l===null)return null;var u=l[ms]||null;if(u===null)return null;l=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var Yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qi=!1;if(Yn)try{var Yt={};Object.defineProperty(Yt,"passive",{get:function(){qi=!0}}),window.addEventListener("test",Yt,Yt),window.removeEventListener("test",Yt,Yt)}catch{qi=!1}var Oa=null,dc=null,Hi=null;function hc(){if(Hi)return Hi;var s,r=dc,l=r.length,u,f="value"in Oa?Oa.value:Oa.textContent,p=f.length;for(s=0;s<l&&r[s]===f[s];s++);var v=l-s;for(u=1;u<=v&&r[l-u]===f[p-u];u++);return Hi=f.slice(s,1<u?1-u:void 0)}function Gi(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function ar(){return!0}function da(){return!1}function Hs(s){function r(l,u,f,p,v){this._reactName=l,this._targetInst=f,this.type=u,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var A in s)s.hasOwnProperty(A)&&(l=s[A],this[A]=l?l(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?ar:da,this.isPropagationStopped=da,this}return w(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ar)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ar)},persist:function(){},isPersistent:ar}),r}var rr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pa=Hs(rr),qr=w({},rr,{view:0,detail:0}),fc=Hs(qr),Hr,Bl,La,zl=w({},qr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==La&&(La&&s.type==="mousemove"?(Hr=s.screenX-La.screenX,Bl=s.screenY-La.screenY):Bl=Hr=0,La=s),Hr)},movementY:function(s){return"movementY"in s?s.movementY:Bl}}),mc=Hs(zl),Yi=w({},zl,{dataTransfer:0}),id=Hs(Yi),ld=w({},qr,{relatedTarget:0}),Wi=Hs(ld),pc=w({},rr,{animationName:0,elapsedTime:0,pseudoElement:0}),od=Hs(pc),Fl=w({},rr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),cd=Hs(Fl),ud=w({},rr,{data:0}),Va=Hs(ud),dd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function md(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=fd[s])?!!r[s]:!1}function Gr(){return md}var cn=w({},qr,{key:function(s){if(s.key){var r=dd[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Gi(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?hd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gr,charCode:function(s){return s.type==="keypress"?Gi(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Gi(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),pd=Hs(cn),xd=w({},zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ir=Hs(xd),h=w({},qr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gr}),y=Hs(h),N=w({},rr,{propertyName:0,elapsedTime:0,pseudoElement:0}),D=Hs(N),ee=w({},zl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ie=Hs(ee),ke=w({},rr,{newState:0,oldState:0}),dt=Hs(ke),vs=[9,13,27,32],Vt=Yn&&"CompositionEvent"in window,cs=null;Yn&&"documentMode"in document&&(cs=document.documentMode);var Wn=Yn&&"TextEvent"in window&&!cs,Ua=Yn&&(!Vt||cs&&8<cs&&11>=cs),ha=" ",fa=!1;function Qi(s,r){switch(s){case"keyup":return vs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $l(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ql=!1;function xS(s,r){switch(s){case"compositionend":return $l(r);case"keypress":return r.which!==32?null:(fa=!0,ha);case"textInput":return s=r.data,s===ha&&fa?null:s;default:return null}}function gS(s,r){if(ql)return s==="compositionend"||!Vt&&Qi(s,r)?(s=hc(),Hi=dc=Oa=null,ql=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Ua&&r.locale!=="ko"?null:r.data;default:return null}}var bS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Og(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!bS[s.type]:r==="textarea"}function Pg(s,r,l,u){Fr?Ma?Ma.push(u):Ma=[u]:Fr=u,r=rh(r,"onChange"),0<r.length&&(l=new Pa("onChange","change",null,l,u),s.push({event:l,listeners:r}))}var xc=null,gc=null;function yS(s){bv(s,0)}function gd(s){var r=Rn(s);if(zi(r))return s}function Lg(s,r){if(s==="change")return r}var Vg=!1;if(Yn){var cm;if(Yn){var um="oninput"in document;if(!um){var Ug=document.createElement("div");Ug.setAttribute("oninput","return;"),um=typeof Ug.oninput=="function"}cm=um}else cm=!1;Vg=cm&&(!document.documentMode||9<document.documentMode)}function Bg(){xc&&(xc.detachEvent("onpropertychange",zg),gc=xc=null)}function zg(s){if(s.propertyName==="value"&&gd(gc)){var r=[];Pg(r,gc,s,Gn(s)),$r(yS,r)}}function vS(s,r,l){s==="focusin"?(Bg(),xc=r,gc=l,xc.attachEvent("onpropertychange",zg)):s==="focusout"&&Bg()}function wS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return gd(gc)}function NS(s,r){if(s==="click")return gd(r)}function jS(s,r){if(s==="input"||s==="change")return gd(r)}function _S(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Dn=typeof Object.is=="function"?Object.is:_S;function bc(s,r){if(Dn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var l=Object.keys(s),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var f=l[u];if(!xt.call(r,f)||!Dn(s[f],r[f]))return!1}return!0}function Fg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function $g(s,r){var l=Fg(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=r&&u>=r)return{node:l,offset:r-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Fg(l)}}function qg(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?qg(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Hg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Da(s.document);r instanceof s.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)s=r.contentWindow;else break;r=Da(s.document)}return r}function dm(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var SS=Yn&&"documentMode"in document&&11>=document.documentMode,Hl=null,hm=null,yc=null,fm=!1;function Gg(s,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;fm||Hl==null||Hl!==Da(u)||(u=Hl,"selectionStart"in u&&dm(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),yc&&bc(yc,u)||(yc=u,u=rh(hm,"onSelect"),0<u.length&&(r=new Pa("onSelect","select",null,r,l),s.push({event:r,listeners:u}),r.target=Hl)))}function Ki(s,r){var l={};return l[s.toLowerCase()]=r.toLowerCase(),l["Webkit"+s]="webkit"+r,l["Moz"+s]="moz"+r,l}var Gl={animationend:Ki("Animation","AnimationEnd"),animationiteration:Ki("Animation","AnimationIteration"),animationstart:Ki("Animation","AnimationStart"),transitionrun:Ki("Transition","TransitionRun"),transitionstart:Ki("Transition","TransitionStart"),transitioncancel:Ki("Transition","TransitionCancel"),transitionend:Ki("Transition","TransitionEnd")},mm={},Yg={};Yn&&(Yg=document.createElement("div").style,"AnimationEvent"in window||(delete Gl.animationend.animation,delete Gl.animationiteration.animation,delete Gl.animationstart.animation),"TransitionEvent"in window||delete Gl.transitionend.transition);function Xi(s){if(mm[s])return mm[s];if(!Gl[s])return s;var r=Gl[s],l;for(l in r)if(r.hasOwnProperty(l)&&l in Yg)return mm[s]=r[l];return s}var Wg=Xi("animationend"),Qg=Xi("animationiteration"),Kg=Xi("animationstart"),ES=Xi("transitionrun"),TS=Xi("transitionstart"),AS=Xi("transitioncancel"),Xg=Xi("transitionend"),Jg=new Map,pm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");pm.push("scrollEnd");function ma(s,r){Jg.set(s,r),Ra(r,[s])}var bd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Qn=[],Yl=0,xm=0;function yd(){for(var s=Yl,r=xm=Yl=0;r<s;){var l=Qn[r];Qn[r++]=null;var u=Qn[r];Qn[r++]=null;var f=Qn[r];Qn[r++]=null;var p=Qn[r];if(Qn[r++]=null,u!==null&&f!==null){var v=u.pending;v===null?f.next=f:(f.next=v.next,v.next=f),u.pending=f}p!==0&&Zg(l,f,p)}}function vd(s,r,l,u){Qn[Yl++]=s,Qn[Yl++]=r,Qn[Yl++]=l,Qn[Yl++]=u,xm|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function gm(s,r,l,u){return vd(s,r,l,u),wd(s)}function Ji(s,r){return vd(s,null,null,r),wd(s)}function Zg(s,r,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var f=!1,p=s.return;p!==null;)p.childLanes|=l,u=p.alternate,u!==null&&(u.childLanes|=l),p.tag===22&&(s=p.stateNode,s===null||s._visibility&1||(f=!0)),s=p,p=p.return;return s.tag===3?(p=s.stateNode,f&&r!==null&&(f=31-Xt(l),s=p.hiddenUpdates,u=s[f],u===null?s[f]=[r]:u.push(r),r.lane=l|536870912),p):null}function wd(s){if(50<zc)throw zc=0,Ep=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var Wl={};function kS(s,r,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mn(s,r,l,u){return new kS(s,r,l,u)}function bm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function lr(s,r){var l=s.alternate;return l===null?(l=Mn(s.tag,r,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=r,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,r=s.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function eb(s,r){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,r=l.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function Nd(s,r,l,u,f,p){var v=0;if(u=s,typeof s=="function")bm(s)&&(v=1);else if(typeof s=="string")v=ME(s,l,ge.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case S:return s=Mn(31,l,r,f),s.elementType=S,s.lanes=p,s;case V:return Zi(l.children,f,p,r);case U:v=8,f|=24;break;case F:return s=Mn(12,l,r,f|2),s.elementType=F,s.lanes=p,s;case he:return s=Mn(13,l,r,f),s.elementType=he,s.lanes=p,s;case W:return s=Mn(19,l,r,f),s.elementType=W,s.lanes=p,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case H:v=10;break e;case Q:v=9;break e;case re:v=11;break e;case T:v=14;break e;case E:v=16,u=null;break e}v=29,l=Error(i(130,s===null?"null":typeof s,"")),u=null}return r=Mn(v,l,r,f),r.elementType=s,r.type=u,r.lanes=p,r}function Zi(s,r,l,u){return s=Mn(7,s,u,r),s.lanes=l,s}function ym(s,r,l){return s=Mn(6,s,null,r),s.lanes=l,s}function tb(s){var r=Mn(18,null,null,0);return r.stateNode=s,r}function vm(s,r,l){return r=Mn(4,s.children!==null?s.children:[],s.key,r),r.lanes=l,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var sb=new WeakMap;function Kn(s,r){if(typeof s=="object"&&s!==null){var l=sb.get(s);return l!==void 0?l:(r={value:s,source:r,stack:Mt(r)},sb.set(s,r),r)}return{value:s,source:r,stack:Mt(r)}}var Ql=[],Kl=0,jd=null,vc=0,Xn=[],Jn=0,Yr=null,Ba=1,za="";function or(s,r){Ql[Kl++]=vc,Ql[Kl++]=jd,jd=s,vc=r}function nb(s,r,l){Xn[Jn++]=Ba,Xn[Jn++]=za,Xn[Jn++]=Yr,Yr=s;var u=Ba;s=za;var f=32-Xt(u)-1;u&=~(1<<f),l+=1;var p=32-Xt(r)+f;if(30<p){var v=f-f%5;p=(u&(1<<v)-1).toString(32),u>>=v,f-=v,Ba=1<<32-Xt(r)+f|l<<f|u,za=p+s}else Ba=1<<p|l<<f|u,za=s}function wm(s){s.return!==null&&(or(s,1),nb(s,1,0))}function Nm(s){for(;s===jd;)jd=Ql[--Kl],Ql[Kl]=null,vc=Ql[--Kl],Ql[Kl]=null;for(;s===Yr;)Yr=Xn[--Jn],Xn[Jn]=null,za=Xn[--Jn],Xn[Jn]=null,Ba=Xn[--Jn],Xn[Jn]=null}function ab(s,r){Xn[Jn++]=Ba,Xn[Jn++]=za,Xn[Jn++]=Yr,Ba=r.id,za=r.overflow,Yr=s}var Gs=null,is=null,At=!1,Wr=null,Zn=!1,jm=Error(i(519));function Qr(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wc(Kn(r,s)),jm}function rb(s){var r=s.stateNode,l=s.type,u=s.memoizedProps;switch(r[Jt]=s,r[ms]=u,l){case"dialog":yt("cancel",r),yt("close",r);break;case"iframe":case"object":case"embed":yt("load",r);break;case"video":case"audio":for(l=0;l<$c.length;l++)yt($c[l],r);break;case"source":yt("error",r);break;case"img":case"image":case"link":yt("error",r),yt("load",r);break;case"details":yt("toggle",r);break;case"input":yt("invalid",r),sd(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":yt("invalid",r);break;case"textarea":yt("invalid",r),Br(r,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||Nv(r.textContent,l)?(u.popover!=null&&(yt("beforetoggle",r),yt("toggle",r)),u.onScroll!=null&&yt("scroll",r),u.onScrollEnd!=null&&yt("scrollend",r),u.onClick!=null&&(r.onclick=ca),r=!0):r=!1,r||Qr(s,!0)}function ib(s){for(Gs=s.return;Gs;)switch(Gs.tag){case 5:case 31:case 13:Zn=!1;return;case 27:case 3:Zn=!0;return;default:Gs=Gs.return}}function Xl(s){if(s!==Gs)return!1;if(!At)return ib(s),At=!0,!1;var r=s.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||zp(s.type,s.memoizedProps)),l=!l),l&&is&&Qr(s),ib(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));is=Rv(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));is=Rv(s)}else r===27?(r=is,ci(s.type)?(s=Gp,Gp=null,is=s):is=r):is=Gs?ta(s.stateNode.nextSibling):null;return!0}function el(){is=Gs=null,At=!1}function _m(){var s=Wr;return s!==null&&(bn===null?bn=s:bn.push.apply(bn,s),Wr=null),s}function wc(s){Wr===null?Wr=[s]:Wr.push(s)}var Sm=z(null),tl=null,cr=null;function Kr(s,r,l){ce(Sm,r._currentValue),r._currentValue=l}function ur(s){s._currentValue=Sm.current,Z(Sm)}function Em(s,r,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),s===l)break;s=s.return}}function Tm(s,r,l,u){var f=s.child;for(f!==null&&(f.return=s);f!==null;){var p=f.dependencies;if(p!==null){var v=f.child;p=p.firstContext;e:for(;p!==null;){var A=p;p=f;for(var q=0;q<r.length;q++)if(A.context===r[q]){p.lanes|=l,A=p.alternate,A!==null&&(A.lanes|=l),Em(p.return,l,s),u||(v=null);break e}p=A.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(i(341));v.lanes|=l,p=v.alternate,p!==null&&(p.lanes|=l),Em(v,l,s),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===s){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function Jl(s,r,l,u){s=null;for(var f=r,p=!1;f!==null;){if(!p){if((f.flags&524288)!==0)p=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(i(387));if(v=v.memoizedProps,v!==null){var A=f.type;Dn(f.pendingProps.value,v.value)||(s!==null?s.push(A):s=[A])}}else if(f===Fe.current){if(v=f.alternate,v===null)throw Error(i(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(s!==null?s.push(Wc):s=[Wc])}f=f.return}s!==null&&Tm(r,s,l,u),r.flags|=262144}function _d(s){for(s=s.firstContext;s!==null;){if(!Dn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function sl(s){tl=s,cr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ys(s){return lb(tl,s)}function Sd(s,r){return tl===null&&sl(s),lb(s,r)}function lb(s,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},cr===null){if(s===null)throw Error(i(308));cr=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else cr=cr.next=r;return l}var CS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){r.aborted=!0,s.forEach(function(l){return l()})}},RS=n.unstable_scheduleCallback,IS=n.unstable_NormalPriority,Es={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Am(){return{controller:new CS,data:new Map,refCount:0}}function Nc(s){s.refCount--,s.refCount===0&&RS(IS,function(){s.controller.abort()})}var jc=null,km=0,Zl=0,eo=null;function DS(s,r){if(jc===null){var l=jc=[];km=0,Zl=Ip(),eo={status:"pending",value:void 0,then:function(u){l.push(u)}}}return km++,r.then(ob,ob),r}function ob(){if(--km===0&&jc!==null){eo!==null&&(eo.status="fulfilled");var s=jc;jc=null,Zl=0,eo=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function MS(s,r){var l=[],u={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return s.then(function(){u.status="fulfilled",u.value=r;for(var f=0;f<l.length;f++)(0,l[f])(r)},function(f){for(u.status="rejected",u.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),u}var cb=P.S;P.S=function(s,r){Gy=Le(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&DS(s,r),cb!==null&&cb(s,r)};var nl=z(null);function Cm(){var s=nl.current;return s!==null?s:Zt.pooledCache}function Ed(s,r){r===null?ce(nl,nl.current):ce(nl,r.pool)}function ub(){var s=Cm();return s===null?null:{parent:Es._currentValue,pool:s}}var to=Error(i(460)),Rm=Error(i(474)),Td=Error(i(542)),Ad={then:function(){}};function db(s){return s=s.status,s==="fulfilled"||s==="rejected"}function hb(s,r,l){switch(l=s[l],l===void 0?s.push(r):l!==r&&(r.then(ca,ca),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,mb(s),s;default:if(typeof r.status=="string")r.then(ca,ca);else{if(s=Zt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(u){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=u}},function(u){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,mb(s),s}throw rl=r,to}}function al(s){try{var r=s._init;return r(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(rl=l,to):l}}var rl=null;function fb(){if(rl===null)throw Error(i(459));var s=rl;return rl=null,s}function mb(s){if(s===to||s===Td)throw Error(i(483))}var so=null,_c=0;function kd(s){var r=_c;return _c+=1,so===null&&(so=[]),hb(so,s,r)}function Sc(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function Cd(s,r){throw r.$$typeof===_?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function pb(s){function r(X,Y){if(s){var te=X.deletions;te===null?(X.deletions=[Y],X.flags|=16):te.push(Y)}}function l(X,Y){if(!s)return null;for(;Y!==null;)r(X,Y),Y=Y.sibling;return null}function u(X){for(var Y=new Map;X!==null;)X.key!==null?Y.set(X.key,X):Y.set(X.index,X),X=X.sibling;return Y}function f(X,Y){return X=lr(X,Y),X.index=0,X.sibling=null,X}function p(X,Y,te){return X.index=te,s?(te=X.alternate,te!==null?(te=te.index,te<Y?(X.flags|=67108866,Y):te):(X.flags|=67108866,Y)):(X.flags|=1048576,Y)}function v(X){return s&&X.alternate===null&&(X.flags|=67108866),X}function A(X,Y,te,be){return Y===null||Y.tag!==6?(Y=ym(te,X.mode,be),Y.return=X,Y):(Y=f(Y,te),Y.return=X,Y)}function q(X,Y,te,be){var Ke=te.type;return Ke===V?me(X,Y,te.props.children,be,te.key):Y!==null&&(Y.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===E&&al(Ke)===Y.type)?(Y=f(Y,te.props),Sc(Y,te),Y.return=X,Y):(Y=Nd(te.type,te.key,te.props,null,X.mode,be),Sc(Y,te),Y.return=X,Y)}function se(X,Y,te,be){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==te.containerInfo||Y.stateNode.implementation!==te.implementation?(Y=vm(te,X.mode,be),Y.return=X,Y):(Y=f(Y,te.children||[]),Y.return=X,Y)}function me(X,Y,te,be,Ke){return Y===null||Y.tag!==7?(Y=Zi(te,X.mode,be,Ke),Y.return=X,Y):(Y=f(Y,te),Y.return=X,Y)}function ve(X,Y,te){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=ym(""+Y,X.mode,te),Y.return=X,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case R:return te=Nd(Y.type,Y.key,Y.props,null,X.mode,te),Sc(te,Y),te.return=X,te;case B:return Y=vm(Y,X.mode,te),Y.return=X,Y;case E:return Y=al(Y),ve(X,Y,te)}if(L(Y)||O(Y))return Y=Zi(Y,X.mode,te,null),Y.return=X,Y;if(typeof Y.then=="function")return ve(X,kd(Y),te);if(Y.$$typeof===H)return ve(X,Sd(X,Y),te);Cd(X,Y)}return null}function ae(X,Y,te,be){var Ke=Y!==null?Y.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return Ke!==null?null:A(X,Y,""+te,be);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case R:return te.key===Ke?q(X,Y,te,be):null;case B:return te.key===Ke?se(X,Y,te,be):null;case E:return te=al(te),ae(X,Y,te,be)}if(L(te)||O(te))return Ke!==null?null:me(X,Y,te,be,null);if(typeof te.then=="function")return ae(X,Y,kd(te),be);if(te.$$typeof===H)return ae(X,Y,Sd(X,te),be);Cd(X,te)}return null}function oe(X,Y,te,be,Ke){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return X=X.get(te)||null,A(Y,X,""+be,Ke);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case R:return X=X.get(be.key===null?te:be.key)||null,q(Y,X,be,Ke);case B:return X=X.get(be.key===null?te:be.key)||null,se(Y,X,be,Ke);case E:return be=al(be),oe(X,Y,te,be,Ke)}if(L(be)||O(be))return X=X.get(te)||null,me(Y,X,be,Ke,null);if(typeof be.then=="function")return oe(X,Y,te,kd(be),Ke);if(be.$$typeof===H)return oe(X,Y,te,Sd(Y,be),Ke);Cd(Y,be)}return null}function Ue(X,Y,te,be){for(var Ke=null,Pt=null,ze=Y,mt=Y=0,Nt=null;ze!==null&&mt<te.length;mt++){ze.index>mt?(Nt=ze,ze=null):Nt=ze.sibling;var Lt=ae(X,ze,te[mt],be);if(Lt===null){ze===null&&(ze=Nt);break}s&&ze&&Lt.alternate===null&&r(X,ze),Y=p(Lt,Y,mt),Pt===null?Ke=Lt:Pt.sibling=Lt,Pt=Lt,ze=Nt}if(mt===te.length)return l(X,ze),At&&or(X,mt),Ke;if(ze===null){for(;mt<te.length;mt++)ze=ve(X,te[mt],be),ze!==null&&(Y=p(ze,Y,mt),Pt===null?Ke=ze:Pt.sibling=ze,Pt=ze);return At&&or(X,mt),Ke}for(ze=u(ze);mt<te.length;mt++)Nt=oe(ze,X,mt,te[mt],be),Nt!==null&&(s&&Nt.alternate!==null&&ze.delete(Nt.key===null?mt:Nt.key),Y=p(Nt,Y,mt),Pt===null?Ke=Nt:Pt.sibling=Nt,Pt=Nt);return s&&ze.forEach(function(mi){return r(X,mi)}),At&&or(X,mt),Ke}function st(X,Y,te,be){if(te==null)throw Error(i(151));for(var Ke=null,Pt=null,ze=Y,mt=Y=0,Nt=null,Lt=te.next();ze!==null&&!Lt.done;mt++,Lt=te.next()){ze.index>mt?(Nt=ze,ze=null):Nt=ze.sibling;var mi=ae(X,ze,Lt.value,be);if(mi===null){ze===null&&(ze=Nt);break}s&&ze&&mi.alternate===null&&r(X,ze),Y=p(mi,Y,mt),Pt===null?Ke=mi:Pt.sibling=mi,Pt=mi,ze=Nt}if(Lt.done)return l(X,ze),At&&or(X,mt),Ke;if(ze===null){for(;!Lt.done;mt++,Lt=te.next())Lt=ve(X,Lt.value,be),Lt!==null&&(Y=p(Lt,Y,mt),Pt===null?Ke=Lt:Pt.sibling=Lt,Pt=Lt);return At&&or(X,mt),Ke}for(ze=u(ze);!Lt.done;mt++,Lt=te.next())Lt=oe(ze,X,mt,Lt.value,be),Lt!==null&&(s&&Lt.alternate!==null&&ze.delete(Lt.key===null?mt:Lt.key),Y=p(Lt,Y,mt),Pt===null?Ke=Lt:Pt.sibling=Lt,Pt=Lt);return s&&ze.forEach(function(HE){return r(X,HE)}),At&&or(X,mt),Ke}function Kt(X,Y,te,be){if(typeof te=="object"&&te!==null&&te.type===V&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case R:e:{for(var Ke=te.key;Y!==null;){if(Y.key===Ke){if(Ke=te.type,Ke===V){if(Y.tag===7){l(X,Y.sibling),be=f(Y,te.props.children),be.return=X,X=be;break e}}else if(Y.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===E&&al(Ke)===Y.type){l(X,Y.sibling),be=f(Y,te.props),Sc(be,te),be.return=X,X=be;break e}l(X,Y);break}else r(X,Y);Y=Y.sibling}te.type===V?(be=Zi(te.props.children,X.mode,be,te.key),be.return=X,X=be):(be=Nd(te.type,te.key,te.props,null,X.mode,be),Sc(be,te),be.return=X,X=be)}return v(X);case B:e:{for(Ke=te.key;Y!==null;){if(Y.key===Ke)if(Y.tag===4&&Y.stateNode.containerInfo===te.containerInfo&&Y.stateNode.implementation===te.implementation){l(X,Y.sibling),be=f(Y,te.children||[]),be.return=X,X=be;break e}else{l(X,Y);break}else r(X,Y);Y=Y.sibling}be=vm(te,X.mode,be),be.return=X,X=be}return v(X);case E:return te=al(te),Kt(X,Y,te,be)}if(L(te))return Ue(X,Y,te,be);if(O(te)){if(Ke=O(te),typeof Ke!="function")throw Error(i(150));return te=Ke.call(te),st(X,Y,te,be)}if(typeof te.then=="function")return Kt(X,Y,kd(te),be);if(te.$$typeof===H)return Kt(X,Y,Sd(X,te),be);Cd(X,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,Y!==null&&Y.tag===6?(l(X,Y.sibling),be=f(Y,te),be.return=X,X=be):(l(X,Y),be=ym(te,X.mode,be),be.return=X,X=be),v(X)):l(X,Y)}return function(X,Y,te,be){try{_c=0;var Ke=Kt(X,Y,te,be);return so=null,Ke}catch(ze){if(ze===to||ze===Td)throw ze;var Pt=Mn(29,ze,null,X.mode);return Pt.lanes=be,Pt.return=X,Pt}}}var il=pb(!0),xb=pb(!1),Xr=!1;function Im(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Dm(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Jr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Zr(s,r,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(Ut&2)!==0){var f=u.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),u.pending=r,r=wd(s),Zg(s,null,l),r}return vd(s,u,r,l),wd(s)}function Ec(s,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,ft(s,l)}}function Mm(s,r){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var f=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var v={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};p===null?f=p=v:p=p.next=v,l=l.next}while(l!==null);p===null?f=p=r:p=p.next=r}else f=p=r;l={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=r:s.next=r,l.lastBaseUpdate=r}var Om=!1;function Tc(){if(Om){var s=eo;if(s!==null)throw s}}function Ac(s,r,l,u){Om=!1;var f=s.updateQueue;Xr=!1;var p=f.firstBaseUpdate,v=f.lastBaseUpdate,A=f.shared.pending;if(A!==null){f.shared.pending=null;var q=A,se=q.next;q.next=null,v===null?p=se:v.next=se,v=q;var me=s.alternate;me!==null&&(me=me.updateQueue,A=me.lastBaseUpdate,A!==v&&(A===null?me.firstBaseUpdate=se:A.next=se,me.lastBaseUpdate=q))}if(p!==null){var ve=f.baseState;v=0,me=se=q=null,A=p;do{var ae=A.lane&-536870913,oe=ae!==A.lane;if(oe?(wt&ae)===ae:(u&ae)===ae){ae!==0&&ae===Zl&&(Om=!0),me!==null&&(me=me.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var Ue=s,st=A;ae=r;var Kt=l;switch(st.tag){case 1:if(Ue=st.payload,typeof Ue=="function"){ve=Ue.call(Kt,ve,ae);break e}ve=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=st.payload,ae=typeof Ue=="function"?Ue.call(Kt,ve,ae):Ue,ae==null)break e;ve=w({},ve,ae);break e;case 2:Xr=!0}}ae=A.callback,ae!==null&&(s.flags|=64,oe&&(s.flags|=8192),oe=f.callbacks,oe===null?f.callbacks=[ae]:oe.push(ae))}else oe={lane:ae,tag:A.tag,payload:A.payload,callback:A.callback,next:null},me===null?(se=me=oe,q=ve):me=me.next=oe,v|=ae;if(A=A.next,A===null){if(A=f.shared.pending,A===null)break;oe=A,A=oe.next,oe.next=null,f.lastBaseUpdate=oe,f.shared.pending=null}}while(!0);me===null&&(q=ve),f.baseState=q,f.firstBaseUpdate=se,f.lastBaseUpdate=me,p===null&&(f.shared.lanes=0),ai|=v,s.lanes=v,s.memoizedState=ve}}function gb(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function bb(s,r){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)gb(l[s],r)}var no=z(null),Rd=z(0);function yb(s,r){s=yr,ce(Rd,s),ce(no,r),yr=s|r.baseLanes}function Pm(){ce(Rd,yr),ce(no,no.current)}function Lm(){yr=Rd.current,Z(no),Z(Rd)}var On=z(null),ea=null;function ei(s){var r=s.alternate;ce(ws,ws.current&1),ce(On,s),ea===null&&(r===null||no.current!==null||r.memoizedState!==null)&&(ea=s)}function Vm(s){ce(ws,ws.current),ce(On,s),ea===null&&(ea=s)}function vb(s){s.tag===22?(ce(ws,ws.current),ce(On,s),ea===null&&(ea=s)):ti()}function ti(){ce(ws,ws.current),ce(On,On.current)}function Pn(s){Z(On),ea===s&&(ea=null),Z(ws)}var ws=z(0);function Id(s){for(var r=s;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||qp(l)||Hp(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var dr=0,ht=null,Wt=null,Ts=null,Dd=!1,ao=!1,ll=!1,Md=0,kc=0,ro=null,OS=0;function ps(){throw Error(i(321))}function Um(s,r){if(r===null)return!1;for(var l=0;l<r.length&&l<s.length;l++)if(!Dn(s[l],r[l]))return!1;return!0}function Bm(s,r,l,u,f,p){return dr=p,ht=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,P.H=s===null||s.memoizedState===null?ny:tp,ll=!1,p=l(u,f),ll=!1,ao&&(p=Nb(r,l,u,f)),wb(s),p}function wb(s){P.H=Ic;var r=Wt!==null&&Wt.next!==null;if(dr=0,Ts=Wt=ht=null,Dd=!1,kc=0,ro=null,r)throw Error(i(300));s===null||As||(s=s.dependencies,s!==null&&_d(s)&&(As=!0))}function Nb(s,r,l,u){ht=s;var f=0;do{if(ao&&(ro=null),kc=0,ao=!1,25<=f)throw Error(i(301));if(f+=1,Ts=Wt=null,s.updateQueue!=null){var p=s.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}P.H=ay,p=r(l,u)}while(ao);return p}function PS(){var s=P.H,r=s.useState()[0];return r=typeof r.then=="function"?Cc(r):r,s=s.useState()[0],(Wt!==null?Wt.memoizedState:null)!==s&&(ht.flags|=1024),r}function zm(){var s=Md!==0;return Md=0,s}function Fm(s,r,l){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~l}function $m(s){if(Dd){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Dd=!1}dr=0,Ts=Wt=ht=null,ao=!1,kc=Md=0,ro=null}function un(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ts===null?ht.memoizedState=Ts=s:Ts=Ts.next=s,Ts}function Ns(){if(Wt===null){var s=ht.alternate;s=s!==null?s.memoizedState:null}else s=Wt.next;var r=Ts===null?ht.memoizedState:Ts.next;if(r!==null)Ts=r,Wt=s;else{if(s===null)throw ht.alternate===null?Error(i(467)):Error(i(310));Wt=s,s={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Ts===null?ht.memoizedState=Ts=s:Ts=Ts.next=s}return Ts}function Od(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cc(s){var r=kc;return kc+=1,ro===null&&(ro=[]),s=hb(ro,s,r),r=ht,(Ts===null?r.memoizedState:Ts.next)===null&&(r=r.alternate,P.H=r===null||r.memoizedState===null?ny:tp),s}function Pd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Cc(s);if(s.$$typeof===H)return Ys(s)}throw Error(i(438,String(s)))}function qm(s){var r=null,l=ht.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=ht.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=Od(),ht.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(s),u=0;u<s;u++)l[u]=I;return r.index++,l}function hr(s,r){return typeof r=="function"?r(s):r}function Ld(s){var r=Ns();return Hm(r,Wt,s)}function Hm(s,r,l){var u=s.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var f=s.baseQueue,p=u.pending;if(p!==null){if(f!==null){var v=f.next;f.next=p.next,p.next=v}r.baseQueue=f=p,u.pending=null}if(p=s.baseState,f===null)s.memoizedState=p;else{r=f.next;var A=v=null,q=null,se=r,me=!1;do{var ve=se.lane&-536870913;if(ve!==se.lane?(wt&ve)===ve:(dr&ve)===ve){var ae=se.revertLane;if(ae===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),ve===Zl&&(me=!0);else if((dr&ae)===ae){se=se.next,ae===Zl&&(me=!0);continue}else ve={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},q===null?(A=q=ve,v=p):q=q.next=ve,ht.lanes|=ae,ai|=ae;ve=se.action,ll&&l(p,ve),p=se.hasEagerState?se.eagerState:l(p,ve)}else ae={lane:ve,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},q===null?(A=q=ae,v=p):q=q.next=ae,ht.lanes|=ve,ai|=ve;se=se.next}while(se!==null&&se!==r);if(q===null?v=p:q.next=A,!Dn(p,s.memoizedState)&&(As=!0,me&&(l=eo,l!==null)))throw l;s.memoizedState=p,s.baseState=v,s.baseQueue=q,u.lastRenderedState=p}return f===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function Gm(s){var r=Ns(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var u=l.dispatch,f=l.pending,p=r.memoizedState;if(f!==null){l.pending=null;var v=f=f.next;do p=s(p,v.action),v=v.next;while(v!==f);Dn(p,r.memoizedState)||(As=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),l.lastRenderedState=p}return[p,u]}function jb(s,r,l){var u=ht,f=Ns(),p=At;if(p){if(l===void 0)throw Error(i(407));l=l()}else l=r();var v=!Dn((Wt||f).memoizedState,l);if(v&&(f.memoizedState=l,As=!0),f=f.queue,Qm(Eb.bind(null,u,f,s),[s]),f.getSnapshot!==r||v||Ts!==null&&Ts.memoizedState.tag&1){if(u.flags|=2048,io(9,{destroy:void 0},Sb.bind(null,u,f,l,r),null),Zt===null)throw Error(i(349));p||(dr&127)!==0||_b(u,r,l)}return l}function _b(s,r,l){s.flags|=16384,s={getSnapshot:r,value:l},r=ht.updateQueue,r===null?(r=Od(),ht.updateQueue=r,r.stores=[s]):(l=r.stores,l===null?r.stores=[s]:l.push(s))}function Sb(s,r,l,u){r.value=l,r.getSnapshot=u,Tb(r)&&Ab(s)}function Eb(s,r,l){return l(function(){Tb(r)&&Ab(s)})}function Tb(s){var r=s.getSnapshot;s=s.value;try{var l=r();return!Dn(s,l)}catch{return!0}}function Ab(s){var r=Ji(s,2);r!==null&&yn(r,s,2)}function Ym(s){var r=un();if(typeof s=="function"){var l=s;if(s=l(),ll){hs(!0);try{l()}finally{hs(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:s},r}function kb(s,r,l,u){return s.baseState=l,Hm(s,Wt,typeof u=="function"?u:hr)}function LS(s,r,l,u,f){if(Bd(s))throw Error(i(485));if(s=r.action,s!==null){var p={payload:f,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){p.listeners.push(v)}};P.T!==null?l(!0):p.isTransition=!1,u(p),l=r.pending,l===null?(p.next=r.pending=p,Cb(r,p)):(p.next=l.next,r.pending=l.next=p)}}function Cb(s,r){var l=r.action,u=r.payload,f=s.state;if(r.isTransition){var p=P.T,v={};P.T=v;try{var A=l(f,u),q=P.S;q!==null&&q(v,A),Rb(s,r,A)}catch(se){Wm(s,r,se)}finally{p!==null&&v.types!==null&&(p.types=v.types),P.T=p}}else try{p=l(f,u),Rb(s,r,p)}catch(se){Wm(s,r,se)}}function Rb(s,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Ib(s,r,u)},function(u){return Wm(s,r,u)}):Ib(s,r,l)}function Ib(s,r,l){r.status="fulfilled",r.value=l,Db(r),s.state=l,r=s.pending,r!==null&&(l=r.next,l===r?s.pending=null:(l=l.next,r.next=l,Cb(s,l)))}function Wm(s,r,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,Db(r),r=r.next;while(r!==u)}s.action=null}function Db(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function Mb(s,r){return r}function Ob(s,r){if(At){var l=Zt.formState;if(l!==null){e:{var u=ht;if(At){if(is){t:{for(var f=is,p=Zn;f.nodeType!==8;){if(!p){f=null;break t}if(f=ta(f.nextSibling),f===null){f=null;break t}}p=f.data,f=p==="F!"||p==="F"?f:null}if(f){is=ta(f.nextSibling),u=f.data==="F!";break e}}Qr(u)}u=!1}u&&(r=l[0])}}return l=un(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mb,lastRenderedState:r},l.queue=u,l=ey.bind(null,ht,u),u.dispatch=l,u=Ym(!1),p=ep.bind(null,ht,!1,u.queue),u=un(),f={state:r,dispatch:null,action:s,pending:null},u.queue=f,l=LS.bind(null,ht,f,p,l),f.dispatch=l,u.memoizedState=s,[r,l,!1]}function Pb(s){var r=Ns();return Lb(r,Wt,s)}function Lb(s,r,l){if(r=Hm(s,r,Mb)[0],s=Ld(hr)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=Cc(r)}catch(v){throw v===to?Td:v}else u=r;r=Ns();var f=r.queue,p=f.dispatch;return l!==r.memoizedState&&(ht.flags|=2048,io(9,{destroy:void 0},VS.bind(null,f,l),null)),[u,p,s]}function VS(s,r){s.action=r}function Vb(s){var r=Ns(),l=Wt;if(l!==null)return Lb(r,l,s);Ns(),r=r.memoizedState,l=Ns();var u=l.queue.dispatch;return l.memoizedState=s,[r,u,!1]}function io(s,r,l,u){return s={tag:s,create:l,deps:u,inst:r,next:null},r=ht.updateQueue,r===null&&(r=Od(),ht.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,r.lastEffect=s),s}function Ub(){return Ns().memoizedState}function Vd(s,r,l,u){var f=un();ht.flags|=s,f.memoizedState=io(1|r,{destroy:void 0},l,u===void 0?null:u)}function Ud(s,r,l,u){var f=Ns();u=u===void 0?null:u;var p=f.memoizedState.inst;Wt!==null&&u!==null&&Um(u,Wt.memoizedState.deps)?f.memoizedState=io(r,p,l,u):(ht.flags|=s,f.memoizedState=io(1|r,p,l,u))}function Bb(s,r){Vd(8390656,8,s,r)}function Qm(s,r){Ud(2048,8,s,r)}function US(s){ht.flags|=4;var r=ht.updateQueue;if(r===null)r=Od(),ht.updateQueue=r,r.events=[s];else{var l=r.events;l===null?r.events=[s]:l.push(s)}}function zb(s){var r=Ns().memoizedState;return US({ref:r,nextImpl:s}),function(){if((Ut&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Fb(s,r){return Ud(4,2,s,r)}function $b(s,r){return Ud(4,4,s,r)}function qb(s,r){if(typeof r=="function"){s=s();var l=r(s);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Hb(s,r,l){l=l!=null?l.concat([s]):null,Ud(4,4,qb.bind(null,r,s),l)}function Km(){}function Gb(s,r){var l=Ns();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&Um(r,u[1])?u[0]:(l.memoizedState=[s,r],s)}function Yb(s,r){var l=Ns();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&Um(r,u[1]))return u[0];if(u=s(),ll){hs(!0);try{s()}finally{hs(!1)}}return l.memoizedState=[u,r],u}function Xm(s,r,l){return l===void 0||(dr&1073741824)!==0&&(wt&261930)===0?s.memoizedState=r:(s.memoizedState=l,s=Wy(),ht.lanes|=s,ai|=s,l)}function Wb(s,r,l,u){return Dn(l,r)?l:no.current!==null?(s=Xm(s,l,u),Dn(s,r)||(As=!0),s):(dr&42)===0||(dr&1073741824)!==0&&(wt&261930)===0?(As=!0,s.memoizedState=l):(s=Wy(),ht.lanes|=s,ai|=s,r)}function Qb(s,r,l,u,f){var p=K.p;K.p=p!==0&&8>p?p:8;var v=P.T,A={};P.T=A,ep(s,!1,r,l);try{var q=f(),se=P.S;if(se!==null&&se(A,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var me=MS(q,u);Rc(s,r,me,Un(s))}else Rc(s,r,u,Un(s))}catch(ve){Rc(s,r,{then:function(){},status:"rejected",reason:ve},Un())}finally{K.p=p,v!==null&&A.types!==null&&(v.types=A.types),P.T=v}}function BS(){}function Jm(s,r,l,u){if(s.tag!==5)throw Error(i(476));var f=Kb(s).queue;Qb(s,f,r,le,l===null?BS:function(){return Xb(s),l(u)})}function Kb(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:le},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:l},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function Xb(s){var r=Kb(s);r.next===null&&(r=s.alternate.memoizedState),Rc(s,r.next.queue,{},Un())}function Zm(){return Ys(Wc)}function Jb(){return Ns().memoizedState}function Zb(){return Ns().memoizedState}function zS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var l=Un();s=Jr(l);var u=Zr(r,s,l);u!==null&&(yn(u,r,l),Ec(u,r,l)),r={cache:Am()},s.payload=r;return}r=r.return}}function FS(s,r,l){var u=Un();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Bd(s)?ty(r,l):(l=gm(s,r,l,u),l!==null&&(yn(l,s,u),sy(l,r,u)))}function ey(s,r,l){var u=Un();Rc(s,r,l,u)}function Rc(s,r,l,u){var f={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Bd(s))ty(r,f);else{var p=s.alternate;if(s.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var v=r.lastRenderedState,A=p(v,l);if(f.hasEagerState=!0,f.eagerState=A,Dn(A,v))return vd(s,r,f,0),Zt===null&&yd(),!1}catch{}if(l=gm(s,r,f,u),l!==null)return yn(l,s,u),sy(l,r,u),!0}return!1}function ep(s,r,l,u){if(u={lane:2,revertLane:Ip(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Bd(s)){if(r)throw Error(i(479))}else r=gm(s,l,u,2),r!==null&&yn(r,s,2)}function Bd(s){var r=s.alternate;return s===ht||r!==null&&r===ht}function ty(s,r){ao=Dd=!0;var l=s.pending;l===null?r.next=r:(r.next=l.next,l.next=r),s.pending=r}function sy(s,r,l){if((l&4194048)!==0){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,ft(s,l)}}var Ic={readContext:Ys,use:Pd,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useLayoutEffect:ps,useInsertionEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useSyncExternalStore:ps,useId:ps,useHostTransitionStatus:ps,useFormState:ps,useActionState:ps,useOptimistic:ps,useMemoCache:ps,useCacheRefresh:ps};Ic.useEffectEvent=ps;var ny={readContext:Ys,use:Pd,useCallback:function(s,r){return un().memoizedState=[s,r===void 0?null:r],s},useContext:Ys,useEffect:Bb,useImperativeHandle:function(s,r,l){l=l!=null?l.concat([s]):null,Vd(4194308,4,qb.bind(null,r,s),l)},useLayoutEffect:function(s,r){return Vd(4194308,4,s,r)},useInsertionEffect:function(s,r){Vd(4,2,s,r)},useMemo:function(s,r){var l=un();r=r===void 0?null:r;var u=s();if(ll){hs(!0);try{s()}finally{hs(!1)}}return l.memoizedState=[u,r],u},useReducer:function(s,r,l){var u=un();if(l!==void 0){var f=l(r);if(ll){hs(!0);try{l(r)}finally{hs(!1)}}}else f=r;return u.memoizedState=u.baseState=f,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:f},u.queue=s,s=s.dispatch=FS.bind(null,ht,s),[u.memoizedState,s]},useRef:function(s){var r=un();return s={current:s},r.memoizedState=s},useState:function(s){s=Ym(s);var r=s.queue,l=ey.bind(null,ht,r);return r.dispatch=l,[s.memoizedState,l]},useDebugValue:Km,useDeferredValue:function(s,r){var l=un();return Xm(l,s,r)},useTransition:function(){var s=Ym(!1);return s=Qb.bind(null,ht,s.queue,!0,!1),un().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,l){var u=ht,f=un();if(At){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),Zt===null)throw Error(i(349));(wt&127)!==0||_b(u,r,l)}f.memoizedState=l;var p={value:l,getSnapshot:r};return f.queue=p,Bb(Eb.bind(null,u,p,s),[s]),u.flags|=2048,io(9,{destroy:void 0},Sb.bind(null,u,p,l,r),null),l},useId:function(){var s=un(),r=Zt.identifierPrefix;if(At){var l=za,u=Ba;l=(u&~(1<<32-Xt(u)-1)).toString(32)+l,r="_"+r+"R_"+l,l=Md++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=OS++,r="_"+r+"r_"+l.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:Zm,useFormState:Ob,useActionState:Ob,useOptimistic:function(s){var r=un();r.memoizedState=r.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=ep.bind(null,ht,!0,l),l.dispatch=r,[s,r]},useMemoCache:qm,useCacheRefresh:function(){return un().memoizedState=zS.bind(null,ht)},useEffectEvent:function(s){var r=un(),l={impl:s};return r.memoizedState=l,function(){if((Ut&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},tp={readContext:Ys,use:Pd,useCallback:Gb,useContext:Ys,useEffect:Qm,useImperativeHandle:Hb,useInsertionEffect:Fb,useLayoutEffect:$b,useMemo:Yb,useReducer:Ld,useRef:Ub,useState:function(){return Ld(hr)},useDebugValue:Km,useDeferredValue:function(s,r){var l=Ns();return Wb(l,Wt.memoizedState,s,r)},useTransition:function(){var s=Ld(hr)[0],r=Ns().memoizedState;return[typeof s=="boolean"?s:Cc(s),r]},useSyncExternalStore:jb,useId:Jb,useHostTransitionStatus:Zm,useFormState:Pb,useActionState:Pb,useOptimistic:function(s,r){var l=Ns();return kb(l,Wt,s,r)},useMemoCache:qm,useCacheRefresh:Zb};tp.useEffectEvent=zb;var ay={readContext:Ys,use:Pd,useCallback:Gb,useContext:Ys,useEffect:Qm,useImperativeHandle:Hb,useInsertionEffect:Fb,useLayoutEffect:$b,useMemo:Yb,useReducer:Gm,useRef:Ub,useState:function(){return Gm(hr)},useDebugValue:Km,useDeferredValue:function(s,r){var l=Ns();return Wt===null?Xm(l,s,r):Wb(l,Wt.memoizedState,s,r)},useTransition:function(){var s=Gm(hr)[0],r=Ns().memoizedState;return[typeof s=="boolean"?s:Cc(s),r]},useSyncExternalStore:jb,useId:Jb,useHostTransitionStatus:Zm,useFormState:Vb,useActionState:Vb,useOptimistic:function(s,r){var l=Ns();return Wt!==null?kb(l,Wt,s,r):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:qm,useCacheRefresh:Zb};ay.useEffectEvent=zb;function sp(s,r,l,u){r=s.memoizedState,l=l(u,r),l=l==null?r:w({},r,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var np={enqueueSetState:function(s,r,l){s=s._reactInternals;var u=Un(),f=Jr(u);f.payload=r,l!=null&&(f.callback=l),r=Zr(s,f,u),r!==null&&(yn(r,s,u),Ec(r,s,u))},enqueueReplaceState:function(s,r,l){s=s._reactInternals;var u=Un(),f=Jr(u);f.tag=1,f.payload=r,l!=null&&(f.callback=l),r=Zr(s,f,u),r!==null&&(yn(r,s,u),Ec(r,s,u))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var l=Un(),u=Jr(l);u.tag=2,r!=null&&(u.callback=r),r=Zr(s,u,l),r!==null&&(yn(r,s,l),Ec(r,s,l))}};function ry(s,r,l,u,f,p,v){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,p,v):r.prototype&&r.prototype.isPureReactComponent?!bc(l,u)||!bc(f,p):!0}function iy(s,r,l,u){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==s&&np.enqueueReplaceState(r,r.state,null)}function ol(s,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(s=s.defaultProps){l===r&&(l=w({},l));for(var f in s)l[f]===void 0&&(l[f]=s[f])}return l}function ly(s){bd(s)}function oy(s){console.error(s)}function cy(s){bd(s)}function zd(s,r){try{var l=s.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function uy(s,r,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function ap(s,r,l){return l=Jr(l),l.tag=3,l.payload={element:null},l.callback=function(){zd(s,r)},l}function dy(s){return s=Jr(s),s.tag=3,s}function hy(s,r,l,u){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var p=u.value;s.payload=function(){return f(p)},s.callback=function(){uy(r,l,u)}}var v=l.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){uy(r,l,u),typeof f!="function"&&(ri===null?ri=new Set([this]):ri.add(this));var A=u.stack;this.componentDidCatch(u.value,{componentStack:A!==null?A:""})})}function $S(s,r,l,u,f){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&Jl(r,l,f,!0),l=On.current,l!==null){switch(l.tag){case 31:case 13:return ea===null?Zd():l.alternate===null&&xs===0&&(xs=3),l.flags&=-257,l.flags|=65536,l.lanes=f,u===Ad?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),kp(s,u,f)),!1;case 22:return l.flags|=65536,u===Ad?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),kp(s,u,f)),!1}throw Error(i(435,l.tag))}return kp(s,u,f),Zd(),!1}if(At)return r=On.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,u!==jm&&(s=Error(i(422),{cause:u}),wc(Kn(s,l)))):(u!==jm&&(r=Error(i(423),{cause:u}),wc(Kn(r,l))),s=s.current.alternate,s.flags|=65536,f&=-f,s.lanes|=f,u=Kn(u,l),f=ap(s.stateNode,u,f),Mm(s,f),xs!==4&&(xs=2)),!1;var p=Error(i(520),{cause:u});if(p=Kn(p,l),Bc===null?Bc=[p]:Bc.push(p),xs!==4&&(xs=2),r===null)return!0;u=Kn(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,s=f&-f,l.lanes|=s,s=ap(l.stateNode,u,s),Mm(l,s),!1;case 1:if(r=l.type,p=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(ri===null||!ri.has(p))))return l.flags|=65536,f&=-f,l.lanes|=f,f=dy(f),hy(f,s,l,u),Mm(l,f),!1}l=l.return}while(l!==null);return!1}var rp=Error(i(461)),As=!1;function Ws(s,r,l,u){r.child=s===null?xb(r,null,l,u):il(r,s.child,l,u)}function fy(s,r,l,u,f){l=l.render;var p=r.ref;if("ref"in u){var v={};for(var A in u)A!=="ref"&&(v[A]=u[A])}else v=u;return sl(r),u=Bm(s,r,l,v,p,f),A=zm(),s!==null&&!As?(Fm(s,r,f),fr(s,r,f)):(At&&A&&wm(r),r.flags|=1,Ws(s,r,u,f),r.child)}function my(s,r,l,u,f){if(s===null){var p=l.type;return typeof p=="function"&&!bm(p)&&p.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=p,py(s,r,p,u,f)):(s=Nd(l.type,null,u,r,r.mode,f),s.ref=r.ref,s.return=r,r.child=s)}if(p=s.child,!fp(s,f)){var v=p.memoizedProps;if(l=l.compare,l=l!==null?l:bc,l(v,u)&&s.ref===r.ref)return fr(s,r,f)}return r.flags|=1,s=lr(p,u),s.ref=r.ref,s.return=r,r.child=s}function py(s,r,l,u,f){if(s!==null){var p=s.memoizedProps;if(bc(p,u)&&s.ref===r.ref)if(As=!1,r.pendingProps=u=p,fp(s,f))(s.flags&131072)!==0&&(As=!0);else return r.lanes=s.lanes,fr(s,r,f)}return ip(s,r,l,u,f)}function xy(s,r,l,u){var f=u.children,p=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((r.flags&128)!==0){if(p=p!==null?p.baseLanes|l:l,s!==null){for(u=r.child=s.child,f=0;u!==null;)f=f|u.lanes|u.childLanes,u=u.sibling;u=f&~p}else u=0,r.child=null;return gy(s,r,p,l,u)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&Ed(r,p!==null?p.cachePool:null),p!==null?yb(r,p):Pm(),vb(r);else return u=r.lanes=536870912,gy(s,r,p!==null?p.baseLanes|l:l,l,u)}else p!==null?(Ed(r,p.cachePool),yb(r,p),ti(),r.memoizedState=null):(s!==null&&Ed(r,null),Pm(),ti());return Ws(s,r,f,l),r.child}function Dc(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function gy(s,r,l,u,f){var p=Cm();return p=p===null?null:{parent:Es._currentValue,pool:p},r.memoizedState={baseLanes:l,cachePool:p},s!==null&&Ed(r,null),Pm(),vb(r),s!==null&&Jl(s,r,u,!0),r.childLanes=f,null}function Fd(s,r){return r=qd({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function by(s,r,l){return il(r,s.child,null,l),s=Fd(r,r.pendingProps),s.flags|=2,Pn(r),r.memoizedState=null,s}function qS(s,r,l){var u=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(At){if(u.mode==="hidden")return s=Fd(r,u),r.lanes=536870912,Dc(null,s);if(Vm(r),(s=is)?(s=Cv(s,Zn),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Yr!==null?{id:Ba,overflow:za}:null,retryLane:536870912,hydrationErrors:null},l=tb(s),l.return=r,r.child=l,Gs=r,is=null)):s=null,s===null)throw Qr(r);return r.lanes=536870912,null}return Fd(r,u)}var p=s.memoizedState;if(p!==null){var v=p.dehydrated;if(Vm(r),f)if(r.flags&256)r.flags&=-257,r=by(s,r,l);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(As||Jl(s,r,l,!1),f=(l&s.childLanes)!==0,As||f){if(u=Zt,u!==null&&(v=Qe(u,l),v!==0&&v!==p.retryLane))throw p.retryLane=v,Ji(s,v),yn(u,s,v),rp;Zd(),r=by(s,r,l)}else s=p.treeContext,is=ta(v.nextSibling),Gs=r,At=!0,Wr=null,Zn=!1,s!==null&&ab(r,s),r=Fd(r,u),r.flags|=4096;return r}return s=lr(s.child,{mode:u.mode,children:u.children}),s.ref=r.ref,r.child=s,s.return=r,s}function $d(s,r){var l=r.ref;if(l===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(r.flags|=4194816)}}function ip(s,r,l,u,f){return sl(r),l=Bm(s,r,l,u,void 0,f),u=zm(),s!==null&&!As?(Fm(s,r,f),fr(s,r,f)):(At&&u&&wm(r),r.flags|=1,Ws(s,r,l,f),r.child)}function yy(s,r,l,u,f,p){return sl(r),r.updateQueue=null,l=Nb(r,u,l,f),wb(s),u=zm(),s!==null&&!As?(Fm(s,r,p),fr(s,r,p)):(At&&u&&wm(r),r.flags|=1,Ws(s,r,l,p),r.child)}function vy(s,r,l,u,f){if(sl(r),r.stateNode===null){var p=Wl,v=l.contextType;typeof v=="object"&&v!==null&&(p=Ys(v)),p=new l(u,p),r.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=np,r.stateNode=p,p._reactInternals=r,p=r.stateNode,p.props=u,p.state=r.memoizedState,p.refs={},Im(r),v=l.contextType,p.context=typeof v=="object"&&v!==null?Ys(v):Wl,p.state=r.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(sp(r,l,v,u),p.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(v=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),v!==p.state&&np.enqueueReplaceState(p,p.state,null),Ac(r,u,p,f),Tc(),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(s===null){p=r.stateNode;var A=r.memoizedProps,q=ol(l,A);p.props=q;var se=p.context,me=l.contextType;v=Wl,typeof me=="object"&&me!==null&&(v=Ys(me));var ve=l.getDerivedStateFromProps;me=typeof ve=="function"||typeof p.getSnapshotBeforeUpdate=="function",A=r.pendingProps!==A,me||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(A||se!==v)&&iy(r,p,u,v),Xr=!1;var ae=r.memoizedState;p.state=ae,Ac(r,u,p,f),Tc(),se=r.memoizedState,A||ae!==se||Xr?(typeof ve=="function"&&(sp(r,l,ve,u),se=r.memoizedState),(q=Xr||ry(r,l,q,u,ae,se,v))?(me||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(r.flags|=4194308)):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=se),p.props=u,p.state=se,p.context=v,u=q):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{p=r.stateNode,Dm(s,r),v=r.memoizedProps,me=ol(l,v),p.props=me,ve=r.pendingProps,ae=p.context,se=l.contextType,q=Wl,typeof se=="object"&&se!==null&&(q=Ys(se)),A=l.getDerivedStateFromProps,(se=typeof A=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(v!==ve||ae!==q)&&iy(r,p,u,q),Xr=!1,ae=r.memoizedState,p.state=ae,Ac(r,u,p,f),Tc();var oe=r.memoizedState;v!==ve||ae!==oe||Xr||s!==null&&s.dependencies!==null&&_d(s.dependencies)?(typeof A=="function"&&(sp(r,l,A,u),oe=r.memoizedState),(me=Xr||ry(r,l,me,u,ae,oe,q)||s!==null&&s.dependencies!==null&&_d(s.dependencies))?(se||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,oe,q),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,oe,q)),typeof p.componentDidUpdate=="function"&&(r.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof p.componentDidUpdate!="function"||v===s.memoizedProps&&ae===s.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&ae===s.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=oe),p.props=u,p.state=oe,p.context=q,u=me):(typeof p.componentDidUpdate!="function"||v===s.memoizedProps&&ae===s.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&ae===s.memoizedState||(r.flags|=1024),u=!1)}return p=u,$d(s,r),u=(r.flags&128)!==0,p||u?(p=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:p.render(),r.flags|=1,s!==null&&u?(r.child=il(r,s.child,null,f),r.child=il(r,null,l,f)):Ws(s,r,l,f),r.memoizedState=p.state,s=r.child):s=fr(s,r,f),s}function wy(s,r,l,u){return el(),r.flags|=256,Ws(s,r,l,u),r.child}var lp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function op(s){return{baseLanes:s,cachePool:ub()}}function cp(s,r,l){return s=s!==null?s.childLanes&~l:0,r&&(s|=Vn),s}function Ny(s,r,l){var u=r.pendingProps,f=!1,p=(r.flags&128)!==0,v;if((v=p)||(v=s!==null&&s.memoizedState===null?!1:(ws.current&2)!==0),v&&(f=!0,r.flags&=-129),v=(r.flags&32)!==0,r.flags&=-33,s===null){if(At){if(f?ei(r):ti(),(s=is)?(s=Cv(s,Zn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Yr!==null?{id:Ba,overflow:za}:null,retryLane:536870912,hydrationErrors:null},l=tb(s),l.return=r,r.child=l,Gs=r,is=null)):s=null,s===null)throw Qr(r);return Hp(s)?r.lanes=32:r.lanes=536870912,null}var A=u.children;return u=u.fallback,f?(ti(),f=r.mode,A=qd({mode:"hidden",children:A},f),u=Zi(u,f,l,null),A.return=r,u.return=r,A.sibling=u,r.child=A,u=r.child,u.memoizedState=op(l),u.childLanes=cp(s,v,l),r.memoizedState=lp,Dc(null,u)):(ei(r),up(r,A))}var q=s.memoizedState;if(q!==null&&(A=q.dehydrated,A!==null)){if(p)r.flags&256?(ei(r),r.flags&=-257,r=dp(s,r,l)):r.memoizedState!==null?(ti(),r.child=s.child,r.flags|=128,r=null):(ti(),A=u.fallback,f=r.mode,u=qd({mode:"visible",children:u.children},f),A=Zi(A,f,l,null),A.flags|=2,u.return=r,A.return=r,u.sibling=A,r.child=u,il(r,s.child,null,l),u=r.child,u.memoizedState=op(l),u.childLanes=cp(s,v,l),r.memoizedState=lp,r=Dc(null,u));else if(ei(r),Hp(A)){if(v=A.nextSibling&&A.nextSibling.dataset,v)var se=v.dgst;v=se,u=Error(i(419)),u.stack="",u.digest=v,wc({value:u,source:null,stack:null}),r=dp(s,r,l)}else if(As||Jl(s,r,l,!1),v=(l&s.childLanes)!==0,As||v){if(v=Zt,v!==null&&(u=Qe(v,l),u!==0&&u!==q.retryLane))throw q.retryLane=u,Ji(s,u),yn(v,s,u),rp;qp(A)||Zd(),r=dp(s,r,l)}else qp(A)?(r.flags|=192,r.child=s.child,r=null):(s=q.treeContext,is=ta(A.nextSibling),Gs=r,At=!0,Wr=null,Zn=!1,s!==null&&ab(r,s),r=up(r,u.children),r.flags|=4096);return r}return f?(ti(),A=u.fallback,f=r.mode,q=s.child,se=q.sibling,u=lr(q,{mode:"hidden",children:u.children}),u.subtreeFlags=q.subtreeFlags&65011712,se!==null?A=lr(se,A):(A=Zi(A,f,l,null),A.flags|=2),A.return=r,u.return=r,u.sibling=A,r.child=u,Dc(null,u),u=r.child,A=s.child.memoizedState,A===null?A=op(l):(f=A.cachePool,f!==null?(q=Es._currentValue,f=f.parent!==q?{parent:q,pool:q}:f):f=ub(),A={baseLanes:A.baseLanes|l,cachePool:f}),u.memoizedState=A,u.childLanes=cp(s,v,l),r.memoizedState=lp,Dc(s.child,u)):(ei(r),l=s.child,s=l.sibling,l=lr(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,s!==null&&(v=r.deletions,v===null?(r.deletions=[s],r.flags|=16):v.push(s)),r.child=l,r.memoizedState=null,l)}function up(s,r){return r=qd({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function qd(s,r){return s=Mn(22,s,null,r),s.lanes=0,s}function dp(s,r,l){return il(r,s.child,null,l),s=up(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function jy(s,r,l){s.lanes|=r;var u=s.alternate;u!==null&&(u.lanes|=r),Em(s.return,r,l)}function hp(s,r,l,u,f,p){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:f,treeForkCount:p}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=l,v.tailMode=f,v.treeForkCount=p)}function _y(s,r,l){var u=r.pendingProps,f=u.revealOrder,p=u.tail;u=u.children;var v=ws.current,A=(v&2)!==0;if(A?(v=v&1|2,r.flags|=128):v&=1,ce(ws,v),Ws(s,r,u,l),u=At?vc:0,!A&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&jy(s,l,r);else if(s.tag===19)jy(s,l,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(f){case"forwards":for(l=r.child,f=null;l!==null;)s=l.alternate,s!==null&&Id(s)===null&&(f=l),l=l.sibling;l=f,l===null?(f=r.child,r.child=null):(f=l.sibling,l.sibling=null),hp(r,!1,f,l,p,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,f=r.child,r.child=null;f!==null;){if(s=f.alternate,s!==null&&Id(s)===null){r.child=f;break}s=f.sibling,f.sibling=l,l=f,f=s}hp(r,!0,l,null,p,u);break;case"together":hp(r,!1,null,null,void 0,u);break;default:r.memoizedState=null}return r.child}function fr(s,r,l){if(s!==null&&(r.dependencies=s.dependencies),ai|=r.lanes,(l&r.childLanes)===0)if(s!==null){if(Jl(s,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,l=lr(s,s.pendingProps),r.child=l,l.return=r;s.sibling!==null;)s=s.sibling,l=l.sibling=lr(s,s.pendingProps),l.return=r;l.sibling=null}return r.child}function fp(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&_d(s)))}function HS(s,r,l){switch(r.tag){case 3:Rt(r,r.stateNode.containerInfo),Kr(r,Es,s.memoizedState.cache),el();break;case 27:case 5:Bt(r);break;case 4:Rt(r,r.stateNode.containerInfo);break;case 10:Kr(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Vm(r),null;break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(ei(r),r.flags|=128,null):(l&r.child.childLanes)!==0?Ny(s,r,l):(ei(r),s=fr(s,r,l),s!==null?s.sibling:null);ei(r);break;case 19:var f=(s.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||(Jl(s,r,l,!1),u=(l&r.childLanes)!==0),f){if(u)return _y(s,r,l);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ce(ws,ws.current),u)break;return null;case 22:return r.lanes=0,xy(s,r,l,r.pendingProps);case 24:Kr(r,Es,s.memoizedState.cache)}return fr(s,r,l)}function Sy(s,r,l){if(s!==null)if(s.memoizedProps!==r.pendingProps)As=!0;else{if(!fp(s,l)&&(r.flags&128)===0)return As=!1,HS(s,r,l);As=(s.flags&131072)!==0}else As=!1,At&&(r.flags&1048576)!==0&&nb(r,vc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var u=r.pendingProps;if(s=al(r.elementType),r.type=s,typeof s=="function")bm(s)?(u=ol(s,u),r.tag=1,r=vy(null,r,s,u,l)):(r.tag=0,r=ip(null,r,s,u,l));else{if(s!=null){var f=s.$$typeof;if(f===re){r.tag=11,r=fy(null,r,s,u,l);break e}else if(f===T){r.tag=14,r=my(null,r,s,u,l);break e}}throw r=$(s)||s,Error(i(306,r,""))}}return r;case 0:return ip(s,r,r.type,r.pendingProps,l);case 1:return u=r.type,f=ol(u,r.pendingProps),vy(s,r,u,f,l);case 3:e:{if(Rt(r,r.stateNode.containerInfo),s===null)throw Error(i(387));u=r.pendingProps;var p=r.memoizedState;f=p.element,Dm(s,r),Ac(r,u,null,l);var v=r.memoizedState;if(u=v.cache,Kr(r,Es,u),u!==p.cache&&Tm(r,[Es],l,!0),Tc(),u=v.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:v.cache},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){r=wy(s,r,u,l);break e}else if(u!==f){f=Kn(Error(i(424)),r),wc(f),r=wy(s,r,u,l);break e}else for(s=r.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,is=ta(s.firstChild),Gs=r,At=!0,Wr=null,Zn=!0,l=xb(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(el(),u===f){r=fr(s,r,l);break e}Ws(s,r,u,l)}r=r.child}return r;case 26:return $d(s,r),s===null?(l=Pv(r.type,null,r.pendingProps,null))?r.memoizedState=l:At||(l=r.type,s=r.pendingProps,u=ih(Ce.current).createElement(l),u[Jt]=r,u[ms]=s,Qs(u,l,s),_s(u),r.stateNode=u):r.memoizedState=Pv(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Bt(r),s===null&&At&&(u=r.stateNode=Dv(r.type,r.pendingProps,Ce.current),Gs=r,Zn=!0,f=is,ci(r.type)?(Gp=f,is=ta(u.firstChild)):is=f),Ws(s,r,r.pendingProps.children,l),$d(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&At&&((f=u=is)&&(u=wE(u,r.type,r.pendingProps,Zn),u!==null?(r.stateNode=u,Gs=r,is=ta(u.firstChild),Zn=!1,f=!0):f=!1),f||Qr(r)),Bt(r),f=r.type,p=r.pendingProps,v=s!==null?s.memoizedProps:null,u=p.children,zp(f,p)?u=null:v!==null&&zp(f,v)&&(r.flags|=32),r.memoizedState!==null&&(f=Bm(s,r,PS,null,null,l),Wc._currentValue=f),$d(s,r),Ws(s,r,u,l),r.child;case 6:return s===null&&At&&((s=l=is)&&(l=NE(l,r.pendingProps,Zn),l!==null?(r.stateNode=l,Gs=r,is=null,s=!0):s=!1),s||Qr(r)),null;case 13:return Ny(s,r,l);case 4:return Rt(r,r.stateNode.containerInfo),u=r.pendingProps,s===null?r.child=il(r,null,u,l):Ws(s,r,u,l),r.child;case 11:return fy(s,r,r.type,r.pendingProps,l);case 7:return Ws(s,r,r.pendingProps,l),r.child;case 8:return Ws(s,r,r.pendingProps.children,l),r.child;case 12:return Ws(s,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,Kr(r,r.type,u.value),Ws(s,r,u.children,l),r.child;case 9:return f=r.type._context,u=r.pendingProps.children,sl(r),f=Ys(f),u=u(f),r.flags|=1,Ws(s,r,u,l),r.child;case 14:return my(s,r,r.type,r.pendingProps,l);case 15:return py(s,r,r.type,r.pendingProps,l);case 19:return _y(s,r,l);case 31:return qS(s,r,l);case 22:return xy(s,r,l,r.pendingProps);case 24:return sl(r),u=Ys(Es),s===null?(f=Cm(),f===null&&(f=Zt,p=Am(),f.pooledCache=p,p.refCount++,p!==null&&(f.pooledCacheLanes|=l),f=p),r.memoizedState={parent:u,cache:f},Im(r),Kr(r,Es,f)):((s.lanes&l)!==0&&(Dm(s,r),Ac(r,null,null,l),Tc()),f=s.memoizedState,p=r.memoizedState,f.parent!==u?(f={parent:u,cache:u},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),Kr(r,Es,u)):(u=p.cache,Kr(r,Es,u),u!==f.cache&&Tm(r,[Es],l,!0))),Ws(s,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function mr(s){s.flags|=4}function mp(s,r,l,u,f){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(f&335544128)===f)if(s.stateNode.complete)s.flags|=8192;else if(Jy())s.flags|=8192;else throw rl=Ad,Rm}else s.flags&=-16777217}function Ey(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!zv(r))if(Jy())s.flags|=8192;else throw rl=Ad,Rm}function Hd(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?G():536870912,s.lanes|=r,uo|=r)}function Mc(s,r){if(!At)switch(s.tailMode){case"hidden":r=s.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function ls(s){var r=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(r)for(var f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=s,f=f.sibling;else for(f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=s,f=f.sibling;return s.subtreeFlags|=u,s.childLanes=l,r}function GS(s,r,l){var u=r.pendingProps;switch(Nm(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ls(r),null;case 1:return ls(r),null;case 3:return l=r.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),ur(Es),it(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Xl(r)?mr(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,_m())),ls(r),null;case 26:var f=r.type,p=r.memoizedState;return s===null?(mr(r),p!==null?(ls(r),Ey(r,p)):(ls(r),mp(r,f,null,u,l))):p?p!==s.memoizedState?(mr(r),ls(r),Ey(r,p)):(ls(r),r.flags&=-16777217):(s=s.memoizedProps,s!==u&&mr(r),ls(r),mp(r,f,s,u,l)),null;case 27:if(ne(r),l=Ce.current,f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&mr(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return ls(r),null}s=ge.current,Xl(r)?rb(r):(s=Dv(f,u,l),r.stateNode=s,mr(r))}return ls(r),null;case 5:if(ne(r),f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&mr(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return ls(r),null}if(p=ge.current,Xl(r))rb(r);else{var v=ih(Ce.current);switch(p){case 1:p=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:p=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":p=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":p=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":p=v.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof u.is=="string"?v.createElement("select",{is:u.is}):v.createElement("select"),u.multiple?p.multiple=!0:u.size&&(p.size=u.size);break;default:p=typeof u.is=="string"?v.createElement(f,{is:u.is}):v.createElement(f)}}p[Jt]=r,p[ms]=u;e:for(v=r.child;v!==null;){if(v.tag===5||v.tag===6)p.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===r)break e;for(;v.sibling===null;){if(v.return===null||v.return===r)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}r.stateNode=p;e:switch(Qs(p,f,u),f){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&mr(r)}}return ls(r),mp(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,l),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==u&&mr(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(s=Ce.current,Xl(r)){if(s=r.stateNode,l=r.memoizedProps,u=null,f=Gs,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}s[Jt]=r,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||Nv(s.nodeValue,l)),s||Qr(r,!0)}else s=ih(s).createTextNode(u),s[Jt]=r,r.stateNode=s}return ls(r),null;case 31:if(l=r.memoizedState,s===null||s.memoizedState!==null){if(u=Xl(r),l!==null){if(s===null){if(!u)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Jt]=r}else el(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ls(r),s=!1}else l=_m(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return r.flags&256?(Pn(r),r):(Pn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return ls(r),null;case 13:if(u=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(f=Xl(r),u!==null&&u.dehydrated!==null){if(s===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Jt]=r}else el(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ls(r),f=!1}else f=_m(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Pn(r),r):(Pn(r),null)}return Pn(r),(r.flags&128)!==0?(r.lanes=l,r):(l=u!==null,s=s!==null&&s.memoizedState!==null,l&&(u=r.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==f&&(u.flags|=2048)),l!==s&&l&&(r.child.flags|=8192),Hd(r,r.updateQueue),ls(r),null);case 4:return it(),s===null&&Pp(r.stateNode.containerInfo),ls(r),null;case 10:return ur(r.type),ls(r),null;case 19:if(Z(ws),u=r.memoizedState,u===null)return ls(r),null;if(f=(r.flags&128)!==0,p=u.rendering,p===null)if(f)Mc(u,!1);else{if(xs!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(p=Id(s),p!==null){for(r.flags|=128,Mc(u,!1),s=p.updateQueue,r.updateQueue=s,Hd(r,s),r.subtreeFlags=0,s=l,l=r.child;l!==null;)eb(l,s),l=l.sibling;return ce(ws,ws.current&1|2),At&&or(r,u.treeForkCount),r.child}s=s.sibling}u.tail!==null&&Le()>Kd&&(r.flags|=128,f=!0,Mc(u,!1),r.lanes=4194304)}else{if(!f)if(s=Id(p),s!==null){if(r.flags|=128,f=!0,s=s.updateQueue,r.updateQueue=s,Hd(r,s),Mc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!p.alternate&&!At)return ls(r),null}else 2*Le()-u.renderingStartTime>Kd&&l!==536870912&&(r.flags|=128,f=!0,Mc(u,!1),r.lanes=4194304);u.isBackwards?(p.sibling=r.child,r.child=p):(s=u.last,s!==null?s.sibling=p:r.child=p,u.last=p)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=Le(),s.sibling=null,l=ws.current,ce(ws,f?l&1|2:l&1),At&&or(r,u.treeForkCount),s):(ls(r),null);case 22:case 23:return Pn(r),Lm(),u=r.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(ls(r),r.subtreeFlags&6&&(r.flags|=8192)):ls(r),l=r.updateQueue,l!==null&&Hd(r,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),s!==null&&Z(nl),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),ur(Es),ls(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function YS(s,r){switch(Nm(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return ur(Es),it(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return ne(r),null;case 31:if(r.memoizedState!==null){if(Pn(r),r.alternate===null)throw Error(i(340));el()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(Pn(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));el()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return Z(ws),null;case 4:return it(),null;case 10:return ur(r.type),null;case 22:case 23:return Pn(r),Lm(),s!==null&&Z(nl),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return ur(Es),null;case 25:return null;default:return null}}function Ty(s,r){switch(Nm(r),r.tag){case 3:ur(Es),it();break;case 26:case 27:case 5:ne(r);break;case 4:it();break;case 31:r.memoizedState!==null&&Pn(r);break;case 13:Pn(r);break;case 19:Z(ws);break;case 10:ur(r.type);break;case 22:case 23:Pn(r),Lm(),s!==null&&Z(nl);break;case 24:ur(Es)}}function Oc(s,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&s)===s){u=void 0;var p=l.create,v=l.inst;u=p(),v.destroy=u}l=l.next}while(l!==f)}}catch(A){Gt(r,r.return,A)}}function si(s,r,l){try{var u=r.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var p=f.next;u=p;do{if((u.tag&s)===s){var v=u.inst,A=v.destroy;if(A!==void 0){v.destroy=void 0,f=r;var q=l,se=A;try{se()}catch(me){Gt(f,q,me)}}}u=u.next}while(u!==p)}}catch(me){Gt(r,r.return,me)}}function Ay(s){var r=s.updateQueue;if(r!==null){var l=s.stateNode;try{bb(r,l)}catch(u){Gt(s,s.return,u)}}}function ky(s,r,l){l.props=ol(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){Gt(s,r,u)}}function Pc(s,r){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(f){Gt(s,r,f)}}function Fa(s,r){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(f){Gt(s,r,f)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){Gt(s,r,f)}else l.current=null}function Cy(s){var r=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(f){Gt(s,s.return,f)}}function pp(s,r,l){try{var u=s.stateNode;pE(u,s.type,l,r),u[ms]=r}catch(f){Gt(s,s.return,f)}}function Ry(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ci(s.type)||s.tag===4}function xp(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Ry(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ci(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function gp(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(s),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=ca));else if(u!==4&&(u===27&&ci(s.type)&&(l=s.stateNode,r=null),s=s.child,s!==null))for(gp(s,r,l),s=s.sibling;s!==null;)gp(s,r,l),s=s.sibling}function Gd(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?l.insertBefore(s,r):l.appendChild(s);else if(u!==4&&(u===27&&ci(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Gd(s,r,l),s=s.sibling;s!==null;)Gd(s,r,l),s=s.sibling}function Iy(s){var r=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Qs(r,u,l),r[Jt]=s,r[ms]=l}catch(p){Gt(s,s.return,p)}}var pr=!1,ks=!1,bp=!1,Dy=typeof WeakSet=="function"?WeakSet:Set,$s=null;function WS(s,r){if(s=s.containerInfo,Up=fh,s=Hg(s),dm(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var f=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var v=0,A=-1,q=-1,se=0,me=0,ve=s,ae=null;t:for(;;){for(var oe;ve!==l||f!==0&&ve.nodeType!==3||(A=v+f),ve!==p||u!==0&&ve.nodeType!==3||(q=v+u),ve.nodeType===3&&(v+=ve.nodeValue.length),(oe=ve.firstChild)!==null;)ae=ve,ve=oe;for(;;){if(ve===s)break t;if(ae===l&&++se===f&&(A=v),ae===p&&++me===u&&(q=v),(oe=ve.nextSibling)!==null)break;ve=ae,ae=ve.parentNode}ve=oe}l=A===-1||q===-1?null:{start:A,end:q}}else l=null}l=l||{start:0,end:0}}else l=null;for(Bp={focusedElem:s,selectionRange:l},fh=!1,$s=r;$s!==null;)if(r=$s,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,$s=s;else for(;$s!==null;){switch(r=$s,p=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)f=s[l],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&p!==null){s=void 0,l=r,f=p.memoizedProps,p=p.memoizedState,u=l.stateNode;try{var Ue=ol(l.type,f);s=u.getSnapshotBeforeUpdate(Ue,p),u.__reactInternalSnapshotBeforeUpdate=s}catch(st){Gt(l,l.return,st)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,l=s.nodeType,l===9)$p(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":$p(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,$s=s;break}$s=r.return}}function My(s,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:gr(s,l),u&4&&Oc(5,l);break;case 1:if(gr(s,l),u&4)if(s=l.stateNode,r===null)try{s.componentDidMount()}catch(v){Gt(l,l.return,v)}else{var f=ol(l.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(f,r,s.__reactInternalSnapshotBeforeUpdate)}catch(v){Gt(l,l.return,v)}}u&64&&Ay(l),u&512&&Pc(l,l.return);break;case 3:if(gr(s,l),u&64&&(s=l.updateQueue,s!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{bb(s,r)}catch(v){Gt(l,l.return,v)}}break;case 27:r===null&&u&4&&Iy(l);case 26:case 5:gr(s,l),r===null&&u&4&&Cy(l),u&512&&Pc(l,l.return);break;case 12:gr(s,l);break;case 31:gr(s,l),u&4&&Ly(s,l);break;case 13:gr(s,l),u&4&&Vy(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=nE.bind(null,l),jE(s,l))));break;case 22:if(u=l.memoizedState!==null||pr,!u){r=r!==null&&r.memoizedState!==null||ks,f=pr;var p=ks;pr=u,(ks=r)&&!p?br(s,l,(l.subtreeFlags&8772)!==0):gr(s,l),pr=f,ks=p}break;case 30:break;default:gr(s,l)}}function Oy(s){var r=s.alternate;r!==null&&(s.alternate=null,Oy(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Ml(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var us=null,pn=!1;function xr(s,r,l){for(l=l.child;l!==null;)Py(s,r,l),l=l.sibling}function Py(s,r,l){if(gt&&typeof gt.onCommitFiberUnmount=="function")try{gt.onCommitFiberUnmount(rs,l)}catch{}switch(l.tag){case 26:ks||Fa(l,r),xr(s,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:ks||Fa(l,r);var u=us,f=pn;ci(l.type)&&(us=l.stateNode,pn=!1),xr(s,r,l),Hc(l.stateNode),us=u,pn=f;break;case 5:ks||Fa(l,r);case 6:if(u=us,f=pn,us=null,xr(s,r,l),us=u,pn=f,us!==null)if(pn)try{(us.nodeType===9?us.body:us.nodeName==="HTML"?us.ownerDocument.body:us).removeChild(l.stateNode)}catch(p){Gt(l,r,p)}else try{us.removeChild(l.stateNode)}catch(p){Gt(l,r,p)}break;case 18:us!==null&&(pn?(s=us,Av(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),yo(s)):Av(us,l.stateNode));break;case 4:u=us,f=pn,us=l.stateNode.containerInfo,pn=!0,xr(s,r,l),us=u,pn=f;break;case 0:case 11:case 14:case 15:si(2,l,r),ks||si(4,l,r),xr(s,r,l);break;case 1:ks||(Fa(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&ky(l,r,u)),xr(s,r,l);break;case 21:xr(s,r,l);break;case 22:ks=(u=ks)||l.memoizedState!==null,xr(s,r,l),ks=u;break;default:xr(s,r,l)}}function Ly(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{yo(s)}catch(l){Gt(r,r.return,l)}}}function Vy(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{yo(s)}catch(l){Gt(r,r.return,l)}}function QS(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new Dy),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new Dy),r;default:throw Error(i(435,s.tag))}}function Yd(s,r){var l=QS(s);r.forEach(function(u){if(!l.has(u)){l.add(u);var f=aE.bind(null,s,u);u.then(f,f)}})}function xn(s,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var f=l[u],p=s,v=r,A=v;e:for(;A!==null;){switch(A.tag){case 27:if(ci(A.type)){us=A.stateNode,pn=!1;break e}break;case 5:us=A.stateNode,pn=!1;break e;case 3:case 4:us=A.stateNode.containerInfo,pn=!0;break e}A=A.return}if(us===null)throw Error(i(160));Py(p,v,f),us=null,pn=!1,p=f.alternate,p!==null&&(p.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Uy(r,s),r=r.sibling}var pa=null;function Uy(s,r){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:xn(r,s),gn(s),u&4&&(si(3,s,s.return),Oc(3,s),si(5,s,s.return));break;case 1:xn(r,s),gn(s),u&512&&(ks||l===null||Fa(l,l.return)),u&64&&pr&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var f=pa;if(xn(r,s),gn(s),u&512&&(ks||l===null||Fa(l,l.return)),u&4){var p=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":p=f.getElementsByTagName("title")[0],(!p||p[Aa]||p[Jt]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=f.createElement(u),f.head.insertBefore(p,f.querySelector("head > title"))),Qs(p,u,l),p[Jt]=s,_s(p),u=p;break e;case"link":var v=Uv("link","href",f).get(u+(l.href||""));if(v){for(var A=0;A<v.length;A++)if(p=v[A],p.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&p.getAttribute("rel")===(l.rel==null?null:l.rel)&&p.getAttribute("title")===(l.title==null?null:l.title)&&p.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){v.splice(A,1);break t}}p=f.createElement(u),Qs(p,u,l),f.head.appendChild(p);break;case"meta":if(v=Uv("meta","content",f).get(u+(l.content||""))){for(A=0;A<v.length;A++)if(p=v[A],p.getAttribute("content")===(l.content==null?null:""+l.content)&&p.getAttribute("name")===(l.name==null?null:l.name)&&p.getAttribute("property")===(l.property==null?null:l.property)&&p.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&p.getAttribute("charset")===(l.charSet==null?null:l.charSet)){v.splice(A,1);break t}}p=f.createElement(u),Qs(p,u,l),f.head.appendChild(p);break;default:throw Error(i(468,u))}p[Jt]=s,_s(p),u=p}s.stateNode=u}else Bv(f,s.type,s.stateNode);else s.stateNode=Vv(f,u,s.memoizedProps);else p!==u?(p===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):p.count--,u===null?Bv(f,s.type,s.stateNode):Vv(f,u,s.memoizedProps)):u===null&&s.stateNode!==null&&pp(s,s.memoizedProps,l.memoizedProps)}break;case 27:xn(r,s),gn(s),u&512&&(ks||l===null||Fa(l,l.return)),l!==null&&u&4&&pp(s,s.memoizedProps,l.memoizedProps);break;case 5:if(xn(r,s),gn(s),u&512&&(ks||l===null||Fa(l,l.return)),s.flags&32){f=s.stateNode;try{mn(f,"")}catch(Ue){Gt(s,s.return,Ue)}}u&4&&s.stateNode!=null&&(f=s.memoizedProps,pp(s,f,l!==null?l.memoizedProps:f)),u&1024&&(bp=!0);break;case 6:if(xn(r,s),gn(s),u&4){if(s.stateNode===null)throw Error(i(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(Ue){Gt(s,s.return,Ue)}}break;case 3:if(ch=null,f=pa,pa=lh(r.containerInfo),xn(r,s),pa=f,gn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{yo(r.containerInfo)}catch(Ue){Gt(s,s.return,Ue)}bp&&(bp=!1,By(s));break;case 4:u=pa,pa=lh(s.stateNode.containerInfo),xn(r,s),gn(s),pa=u;break;case 12:xn(r,s),gn(s);break;case 31:xn(r,s),gn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Yd(s,u)));break;case 13:xn(r,s),gn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Qd=Le()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Yd(s,u)));break;case 22:f=s.memoizedState!==null;var q=l!==null&&l.memoizedState!==null,se=pr,me=ks;if(pr=se||f,ks=me||q,xn(r,s),ks=me,pr=se,gn(s),u&8192)e:for(r=s.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(l===null||q||pr||ks||cl(s)),l=null,r=s;;){if(r.tag===5||r.tag===26){if(l===null){q=l=r;try{if(p=q.stateNode,f)v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{A=q.stateNode;var ve=q.memoizedProps.style,ae=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;A.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(Ue){Gt(q,q.return,Ue)}}}else if(r.tag===6){if(l===null){q=r;try{q.stateNode.nodeValue=f?"":q.memoizedProps}catch(Ue){Gt(q,q.return,Ue)}}}else if(r.tag===18){if(l===null){q=r;try{var oe=q.stateNode;f?kv(oe,!0):kv(q.stateNode,!1)}catch(Ue){Gt(q,q.return,Ue)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Yd(s,l))));break;case 19:xn(r,s),gn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Yd(s,u)));break;case 30:break;case 21:break;default:xn(r,s),gn(s)}}function gn(s){var r=s.flags;if(r&2){try{for(var l,u=s.return;u!==null;){if(Ry(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var f=l.stateNode,p=xp(s);Gd(s,p,f);break;case 5:var v=l.stateNode;l.flags&32&&(mn(v,""),l.flags&=-33);var A=xp(s);Gd(s,A,v);break;case 3:case 4:var q=l.stateNode.containerInfo,se=xp(s);gp(s,se,q);break;default:throw Error(i(161))}}catch(me){Gt(s,s.return,me)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function By(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;By(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function gr(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)My(s,r.alternate,r),r=r.sibling}function cl(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:si(4,r,r.return),cl(r);break;case 1:Fa(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&ky(r,r.return,l),cl(r);break;case 27:Hc(r.stateNode);case 26:case 5:Fa(r,r.return),cl(r);break;case 22:r.memoizedState===null&&cl(r);break;case 30:cl(r);break;default:cl(r)}s=s.sibling}}function br(s,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,f=s,p=r,v=p.flags;switch(p.tag){case 0:case 11:case 15:br(f,p,l),Oc(4,p);break;case 1:if(br(f,p,l),u=p,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(se){Gt(u,u.return,se)}if(u=p,f=u.updateQueue,f!==null){var A=u.stateNode;try{var q=f.shared.hiddenCallbacks;if(q!==null)for(f.shared.hiddenCallbacks=null,f=0;f<q.length;f++)gb(q[f],A)}catch(se){Gt(u,u.return,se)}}l&&v&64&&Ay(p),Pc(p,p.return);break;case 27:Iy(p);case 26:case 5:br(f,p,l),l&&u===null&&v&4&&Cy(p),Pc(p,p.return);break;case 12:br(f,p,l);break;case 31:br(f,p,l),l&&v&4&&Ly(f,p);break;case 13:br(f,p,l),l&&v&4&&Vy(f,p);break;case 22:p.memoizedState===null&&br(f,p,l),Pc(p,p.return);break;case 30:break;default:br(f,p,l)}r=r.sibling}}function yp(s,r){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Nc(l))}function vp(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Nc(s))}function xa(s,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)zy(s,r,l,u),r=r.sibling}function zy(s,r,l,u){var f=r.flags;switch(r.tag){case 0:case 11:case 15:xa(s,r,l,u),f&2048&&Oc(9,r);break;case 1:xa(s,r,l,u);break;case 3:xa(s,r,l,u),f&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Nc(s)));break;case 12:if(f&2048){xa(s,r,l,u),s=r.stateNode;try{var p=r.memoizedProps,v=p.id,A=p.onPostCommit;typeof A=="function"&&A(v,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(q){Gt(r,r.return,q)}}else xa(s,r,l,u);break;case 31:xa(s,r,l,u);break;case 13:xa(s,r,l,u);break;case 23:break;case 22:p=r.stateNode,v=r.alternate,r.memoizedState!==null?p._visibility&2?xa(s,r,l,u):Lc(s,r):p._visibility&2?xa(s,r,l,u):(p._visibility|=2,lo(s,r,l,u,(r.subtreeFlags&10256)!==0||!1)),f&2048&&yp(v,r);break;case 24:xa(s,r,l,u),f&2048&&vp(r.alternate,r);break;default:xa(s,r,l,u)}}function lo(s,r,l,u,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var p=s,v=r,A=l,q=u,se=v.flags;switch(v.tag){case 0:case 11:case 15:lo(p,v,A,q,f),Oc(8,v);break;case 23:break;case 22:var me=v.stateNode;v.memoizedState!==null?me._visibility&2?lo(p,v,A,q,f):Lc(p,v):(me._visibility|=2,lo(p,v,A,q,f)),f&&se&2048&&yp(v.alternate,v);break;case 24:lo(p,v,A,q,f),f&&se&2048&&vp(v.alternate,v);break;default:lo(p,v,A,q,f)}r=r.sibling}}function Lc(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=s,u=r,f=u.flags;switch(u.tag){case 22:Lc(l,u),f&2048&&yp(u.alternate,u);break;case 24:Lc(l,u),f&2048&&vp(u.alternate,u);break;default:Lc(l,u)}r=r.sibling}}var Vc=8192;function oo(s,r,l){if(s.subtreeFlags&Vc)for(s=s.child;s!==null;)Fy(s,r,l),s=s.sibling}function Fy(s,r,l){switch(s.tag){case 26:oo(s,r,l),s.flags&Vc&&s.memoizedState!==null&&OE(l,pa,s.memoizedState,s.memoizedProps);break;case 5:oo(s,r,l);break;case 3:case 4:var u=pa;pa=lh(s.stateNode.containerInfo),oo(s,r,l),pa=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Vc,Vc=16777216,oo(s,r,l),Vc=u):oo(s,r,l));break;default:oo(s,r,l)}}function $y(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Uc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];$s=u,Hy(u,s)}$y(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)qy(s),s=s.sibling}function qy(s){switch(s.tag){case 0:case 11:case 15:Uc(s),s.flags&2048&&si(9,s,s.return);break;case 3:Uc(s);break;case 12:Uc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Wd(s)):Uc(s);break;default:Uc(s)}}function Wd(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];$s=u,Hy(u,s)}$y(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:si(8,r,r.return),Wd(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,Wd(r));break;default:Wd(r)}s=s.sibling}}function Hy(s,r){for(;$s!==null;){var l=$s;switch(l.tag){case 0:case 11:case 15:si(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Nc(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,$s=u;else e:for(l=s;$s!==null;){u=$s;var f=u.sibling,p=u.return;if(Oy(u),u===l){$s=null;break e}if(f!==null){f.return=p,$s=f;break e}$s=p}}}var KS={getCacheForType:function(s){var r=Ys(Es),l=r.data.get(s);return l===void 0&&(l=s(),r.data.set(s,l)),l},cacheSignal:function(){return Ys(Es).controller.signal}},XS=typeof WeakMap=="function"?WeakMap:Map,Ut=0,Zt=null,bt=null,wt=0,Ht=0,Ln=null,ni=!1,co=!1,wp=!1,yr=0,xs=0,ai=0,ul=0,Np=0,Vn=0,uo=0,Bc=null,bn=null,jp=!1,Qd=0,Gy=0,Kd=1/0,Xd=null,ri=null,Ps=0,ii=null,ho=null,vr=0,_p=0,Sp=null,Yy=null,zc=0,Ep=null;function Un(){return(Ut&2)!==0&&wt!==0?wt&-wt:P.T!==null?Ip():Os()}function Wy(){if(Vn===0)if((wt&536870912)===0||At){var s=_e;_e<<=1,(_e&3932160)===0&&(_e=262144),Vn=s}else Vn=536870912;return s=On.current,s!==null&&(s.flags|=32),Vn}function yn(s,r,l){(s===Zt&&(Ht===2||Ht===9)||s.cancelPendingCommit!==null)&&(fo(s,0),li(s,wt,Vn,!1)),ue(s,l),((Ut&2)===0||s!==Zt)&&(s===Zt&&((Ut&2)===0&&(ul|=l),xs===4&&li(s,wt,Vn,!1)),$a(s))}function Qy(s,r,l){if((Ut&6)!==0)throw Error(i(327));var u=!l&&(r&127)===0&&(r&s.expiredLanes)===0||Dt(s,r),f=u?eE(s,r):Ap(s,r,!0),p=u;do{if(f===0){co&&!u&&li(s,r,0,!1);break}else{if(l=s.current.alternate,p&&!JS(l)){f=Ap(s,r,!1),p=!1;continue}if(f===2){if(p=r,s.errorRecoveryDisabledLanes&p)var v=0;else v=s.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){r=v;e:{var A=s;f=Bc;var q=A.current.memoizedState.isDehydrated;if(q&&(fo(A,v).flags|=256),v=Ap(A,v,!1),v!==2){if(wp&&!q){A.errorRecoveryDisabledLanes|=p,ul|=p,f=4;break e}p=bn,bn=f,p!==null&&(bn===null?bn=p:bn.push.apply(bn,p))}f=v}if(p=!1,f!==2)continue}}if(f===1){fo(s,0),li(s,r,0,!0);break}e:{switch(u=s,p=f,p){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:li(u,r,Vn,!ni);break e;case 2:bn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Qd+300-Le(),10<f)){if(li(u,r,Vn,!ni),pt(u,0,!0)!==0)break e;vr=r,u.timeoutHandle=Ev(Ky.bind(null,u,l,bn,Xd,jp,r,Vn,ul,uo,ni,p,"Throttled",-0,0),f);break e}Ky(u,l,bn,Xd,jp,r,Vn,ul,uo,ni,p,null,-0,0)}}break}while(!0);$a(s)}function Ky(s,r,l,u,f,p,v,A,q,se,me,ve,ae,oe){if(s.timeoutHandle=-1,ve=r.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ca},Fy(r,p,ve);var Ue=(p&62914560)===p?Qd-Le():(p&4194048)===p?Gy-Le():0;if(Ue=PE(ve,Ue),Ue!==null){vr=p,s.cancelPendingCommit=Ue(av.bind(null,s,r,p,l,u,f,v,A,q,me,ve,null,ae,oe)),li(s,p,v,!se);return}}av(s,r,p,l,u,f,v,A,q)}function JS(s){for(var r=s;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var f=l[u],p=f.getSnapshot;f=f.value;try{if(!Dn(p(),f))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function li(s,r,l,u){r&=~Np,r&=~ul,s.suspendedLanes|=r,s.pingedLanes&=~r,u&&(s.warmLanes|=r),u=s.expirationTimes;for(var f=r;0<f;){var p=31-Xt(f),v=1<<p;u[p]=-1,f&=~v}l!==0&&et(s,l,r)}function Jd(){return(Ut&6)===0?(Fc(0),!1):!0}function Tp(){if(bt!==null){if(Ht===0)var s=bt.return;else s=bt,cr=tl=null,$m(s),so=null,_c=0,s=bt;for(;s!==null;)Ty(s.alternate,s),s=s.return;bt=null}}function fo(s,r){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,bE(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),vr=0,Tp(),Zt=s,bt=l=lr(s.current,null),wt=r,Ht=0,Ln=null,ni=!1,co=Dt(s,r),wp=!1,uo=Vn=Np=ul=ai=xs=0,bn=Bc=null,jp=!1,(r&8)!==0&&(r|=r&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=r;0<u;){var f=31-Xt(u),p=1<<f;r|=s[f],u&=~p}return yr=r,yd(),l}function Xy(s,r){ht=null,P.H=Ic,r===to||r===Td?(r=fb(),Ht=3):r===Rm?(r=fb(),Ht=4):Ht=r===rp?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ln=r,bt===null&&(xs=1,zd(s,Kn(r,s.current)))}function Jy(){var s=On.current;return s===null?!0:(wt&4194048)===wt?ea===null:(wt&62914560)===wt||(wt&536870912)!==0?s===ea:!1}function Zy(){var s=P.H;return P.H=Ic,s===null?Ic:s}function ev(){var s=P.A;return P.A=KS,s}function Zd(){xs=4,ni||(wt&4194048)!==wt&&On.current!==null||(co=!0),(ai&134217727)===0&&(ul&134217727)===0||Zt===null||li(Zt,wt,Vn,!1)}function Ap(s,r,l){var u=Ut;Ut|=2;var f=Zy(),p=ev();(Zt!==s||wt!==r)&&(Xd=null,fo(s,r)),r=!1;var v=xs;e:do try{if(Ht!==0&&bt!==null){var A=bt,q=Ln;switch(Ht){case 8:Tp(),v=6;break e;case 3:case 2:case 9:case 6:On.current===null&&(r=!0);var se=Ht;if(Ht=0,Ln=null,mo(s,A,q,se),l&&co){v=0;break e}break;default:se=Ht,Ht=0,Ln=null,mo(s,A,q,se)}}ZS(),v=xs;break}catch(me){Xy(s,me)}while(!0);return r&&s.shellSuspendCounter++,cr=tl=null,Ut=u,P.H=f,P.A=p,bt===null&&(Zt=null,wt=0,yd()),v}function ZS(){for(;bt!==null;)tv(bt)}function eE(s,r){var l=Ut;Ut|=2;var u=Zy(),f=ev();Zt!==s||wt!==r?(Xd=null,Kd=Le()+500,fo(s,r)):co=Dt(s,r);e:do try{if(Ht!==0&&bt!==null){r=bt;var p=Ln;t:switch(Ht){case 1:Ht=0,Ln=null,mo(s,r,p,1);break;case 2:case 9:if(db(p)){Ht=0,Ln=null,sv(r);break}r=function(){Ht!==2&&Ht!==9||Zt!==s||(Ht=7),$a(s)},p.then(r,r);break e;case 3:Ht=7;break e;case 4:Ht=5;break e;case 7:db(p)?(Ht=0,Ln=null,sv(r)):(Ht=0,Ln=null,mo(s,r,p,7));break;case 5:var v=null;switch(bt.tag){case 26:v=bt.memoizedState;case 5:case 27:var A=bt;if(v?zv(v):A.stateNode.complete){Ht=0,Ln=null;var q=A.sibling;if(q!==null)bt=q;else{var se=A.return;se!==null?(bt=se,eh(se)):bt=null}break t}}Ht=0,Ln=null,mo(s,r,p,5);break;case 6:Ht=0,Ln=null,mo(s,r,p,6);break;case 8:Tp(),xs=6;break e;default:throw Error(i(462))}}tE();break}catch(me){Xy(s,me)}while(!0);return cr=tl=null,P.H=u,P.A=f,Ut=l,bt!==null?0:(Zt=null,wt=0,yd(),xs)}function tE(){for(;bt!==null&&!xe();)tv(bt)}function tv(s){var r=Sy(s.alternate,s,yr);s.memoizedProps=s.pendingProps,r===null?eh(s):bt=r}function sv(s){var r=s,l=r.alternate;switch(r.tag){case 15:case 0:r=yy(l,r,r.pendingProps,r.type,void 0,wt);break;case 11:r=yy(l,r,r.pendingProps,r.type.render,r.ref,wt);break;case 5:$m(r);default:Ty(l,r),r=bt=eb(r,yr),r=Sy(l,r,yr)}s.memoizedProps=s.pendingProps,r===null?eh(s):bt=r}function mo(s,r,l,u){cr=tl=null,$m(r),so=null,_c=0;var f=r.return;try{if($S(s,f,r,l,wt)){xs=1,zd(s,Kn(l,s.current)),bt=null;return}}catch(p){if(f!==null)throw bt=f,p;xs=1,zd(s,Kn(l,s.current)),bt=null;return}r.flags&32768?(At||u===1?s=!0:co||(wt&536870912)!==0?s=!1:(ni=s=!0,(u===2||u===9||u===3||u===6)&&(u=On.current,u!==null&&u.tag===13&&(u.flags|=16384))),nv(r,s)):eh(r)}function eh(s){var r=s;do{if((r.flags&32768)!==0){nv(r,ni);return}s=r.return;var l=GS(r.alternate,r,yr);if(l!==null){bt=l;return}if(r=r.sibling,r!==null){bt=r;return}bt=r=s}while(r!==null);xs===0&&(xs=5)}function nv(s,r){do{var l=YS(s.alternate,s);if(l!==null){l.flags&=32767,bt=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(s=s.sibling,s!==null)){bt=s;return}bt=s=l}while(s!==null);xs=6,bt=null}function av(s,r,l,u,f,p,v,A,q){s.cancelPendingCommit=null;do th();while(Ps!==0);if((Ut&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(p=r.lanes|r.childLanes,p|=xm,Ve(s,l,p,v,A,q),s===Zt&&(bt=Zt=null,wt=0),ho=r,ii=s,vr=l,_p=p,Sp=f,Yy=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,rE(J,function(){return cv(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=P.T,P.T=null,f=K.p,K.p=2,v=Ut,Ut|=4;try{WS(s,r,l)}finally{Ut=v,K.p=f,P.T=u}}Ps=1,rv(),iv(),lv()}}function rv(){if(Ps===1){Ps=0;var s=ii,r=ho,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=P.T,P.T=null;var u=K.p;K.p=2;var f=Ut;Ut|=4;try{Uy(r,s);var p=Bp,v=Hg(s.containerInfo),A=p.focusedElem,q=p.selectionRange;if(v!==A&&A&&A.ownerDocument&&qg(A.ownerDocument.documentElement,A)){if(q!==null&&dm(A)){var se=q.start,me=q.end;if(me===void 0&&(me=se),"selectionStart"in A)A.selectionStart=se,A.selectionEnd=Math.min(me,A.value.length);else{var ve=A.ownerDocument||document,ae=ve&&ve.defaultView||window;if(ae.getSelection){var oe=ae.getSelection(),Ue=A.textContent.length,st=Math.min(q.start,Ue),Kt=q.end===void 0?st:Math.min(q.end,Ue);!oe.extend&&st>Kt&&(v=Kt,Kt=st,st=v);var X=$g(A,st),Y=$g(A,Kt);if(X&&Y&&(oe.rangeCount!==1||oe.anchorNode!==X.node||oe.anchorOffset!==X.offset||oe.focusNode!==Y.node||oe.focusOffset!==Y.offset)){var te=ve.createRange();te.setStart(X.node,X.offset),oe.removeAllRanges(),st>Kt?(oe.addRange(te),oe.extend(Y.node,Y.offset)):(te.setEnd(Y.node,Y.offset),oe.addRange(te))}}}}for(ve=[],oe=A;oe=oe.parentNode;)oe.nodeType===1&&ve.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<ve.length;A++){var be=ve[A];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}fh=!!Up,Bp=Up=null}finally{Ut=f,K.p=u,P.T=l}}s.current=r,Ps=2}}function iv(){if(Ps===2){Ps=0;var s=ii,r=ho,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=P.T,P.T=null;var u=K.p;K.p=2;var f=Ut;Ut|=4;try{My(s,r.alternate,r)}finally{Ut=f,K.p=u,P.T=l}}Ps=3}}function lv(){if(Ps===4||Ps===3){Ps=0,qe();var s=ii,r=ho,l=vr,u=Yy;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ps=5:(Ps=0,ho=ii=null,ov(s,s.pendingLanes));var f=s.pendingLanes;if(f===0&&(ri=null),Tt(l),r=r.stateNode,gt&&typeof gt.onCommitFiberRoot=="function")try{gt.onCommitFiberRoot(rs,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=P.T,f=K.p,K.p=2,P.T=null;try{for(var p=s.onRecoverableError,v=0;v<u.length;v++){var A=u[v];p(A.value,{componentStack:A.stack})}}finally{P.T=r,K.p=f}}(vr&3)!==0&&th(),$a(s),f=s.pendingLanes,(l&261930)!==0&&(f&42)!==0?s===Ep?zc++:(zc=0,Ep=s):zc=0,Fc(0)}}function ov(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Nc(r)))}function th(){return rv(),iv(),lv(),cv()}function cv(){if(Ps!==5)return!1;var s=ii,r=_p;_p=0;var l=Tt(vr),u=P.T,f=K.p;try{K.p=32>l?32:l,P.T=null,l=Sp,Sp=null;var p=ii,v=vr;if(Ps=0,ho=ii=null,vr=0,(Ut&6)!==0)throw Error(i(331));var A=Ut;if(Ut|=4,qy(p.current),zy(p,p.current,v,l),Ut=A,Fc(0,!1),gt&&typeof gt.onPostCommitFiberRoot=="function")try{gt.onPostCommitFiberRoot(rs,p)}catch{}return!0}finally{K.p=f,P.T=u,ov(s,r)}}function uv(s,r,l){r=Kn(l,r),r=ap(s.stateNode,r,2),s=Zr(s,r,2),s!==null&&(ue(s,2),$a(s))}function Gt(s,r,l){if(s.tag===3)uv(s,s,l);else for(;r!==null;){if(r.tag===3){uv(r,s,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ri===null||!ri.has(u))){s=Kn(l,s),l=dy(2),u=Zr(r,l,2),u!==null&&(hy(l,u,r,s),ue(u,2),$a(u));break}}r=r.return}}function kp(s,r,l){var u=s.pingCache;if(u===null){u=s.pingCache=new XS;var f=new Set;u.set(r,f)}else f=u.get(r),f===void 0&&(f=new Set,u.set(r,f));f.has(l)||(wp=!0,f.add(l),s=sE.bind(null,s,r,l),r.then(s,s))}function sE(s,r,l){var u=s.pingCache;u!==null&&u.delete(r),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Zt===s&&(wt&l)===l&&(xs===4||xs===3&&(wt&62914560)===wt&&300>Le()-Qd?(Ut&2)===0&&fo(s,0):Np|=l,uo===wt&&(uo=0)),$a(s)}function dv(s,r){r===0&&(r=G()),s=Ji(s,r),s!==null&&(ue(s,r),$a(s))}function nE(s){var r=s.memoizedState,l=0;r!==null&&(l=r.retryLane),dv(s,l)}function aE(s,r){var l=0;switch(s.tag){case 31:case 13:var u=s.stateNode,f=s.memoizedState;f!==null&&(l=f.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),dv(s,l)}function rE(s,r){return Ie(s,r)}var sh=null,po=null,Cp=!1,nh=!1,Rp=!1,oi=0;function $a(s){s!==po&&s.next===null&&(po===null?sh=po=s:po=po.next=s),nh=!0,Cp||(Cp=!0,lE())}function Fc(s,r){if(!Rp&&nh){Rp=!0;do for(var l=!1,u=sh;u!==null;){if(s!==0){var f=u.pendingLanes;if(f===0)var p=0;else{var v=u.suspendedLanes,A=u.pingedLanes;p=(1<<31-Xt(42|s)+1)-1,p&=f&~(v&~A),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(l=!0,pv(u,p))}else p=wt,p=pt(u,u===Zt?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(p&3)===0||Dt(u,p)||(l=!0,pv(u,p));u=u.next}while(l);Rp=!1}}function iE(){hv()}function hv(){nh=Cp=!1;var s=0;oi!==0&&gE()&&(s=oi);for(var r=Le(),l=null,u=sh;u!==null;){var f=u.next,p=fv(u,r);p===0?(u.next=null,l===null?sh=f:l.next=f,f===null&&(po=l)):(l=u,(s!==0||(p&3)!==0)&&(nh=!0)),u=f}Ps!==0&&Ps!==5||Fc(s),oi!==0&&(oi=0)}function fv(s,r){for(var l=s.suspendedLanes,u=s.pingedLanes,f=s.expirationTimes,p=s.pendingLanes&-62914561;0<p;){var v=31-Xt(p),A=1<<v,q=f[v];q===-1?((A&l)===0||(A&u)!==0)&&(f[v]=M(A,r)):q<=r&&(s.expiredLanes|=A),p&=~A}if(r=Zt,l=wt,l=pt(s,s===r?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===r&&(Ht===2||Ht===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Be(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Dt(s,l)){if(r=l&-l,r===s.callbackPriority)return r;switch(u!==null&&Be(u),Tt(l)){case 2:case 8:l=He;break;case 32:l=J;break;case 268435456:l=We;break;default:l=J}return u=mv.bind(null,s),l=Ie(l,u),s.callbackPriority=r,s.callbackNode=l,r}return u!==null&&u!==null&&Be(u),s.callbackPriority=2,s.callbackNode=null,2}function mv(s,r){if(Ps!==0&&Ps!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(th()&&s.callbackNode!==l)return null;var u=wt;return u=pt(s,s===Zt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(Qy(s,u,r),fv(s,Le()),s.callbackNode!=null&&s.callbackNode===l?mv.bind(null,s):null)}function pv(s,r){if(th())return null;Qy(s,r,!0)}function lE(){yE(function(){(Ut&6)!==0?Ie(Ge,iE):hv()})}function Ip(){if(oi===0){var s=Zl;s===0&&(s=ln,ln<<=1,(ln&261888)===0&&(ln=256)),oi=s}return oi}function xv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Vl(""+s)}function gv(s,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,s.id&&l.setAttribute("form",s.id),r.parentNode.insertBefore(l,r),s=new FormData(s),l.parentNode.removeChild(l),s}function oE(s,r,l,u,f){if(r==="submit"&&l&&l.stateNode===f){var p=xv((f[ms]||null).action),v=u.submitter;v&&(r=(r=v[ms]||null)?xv(r.formAction):v.getAttribute("formAction"),r!==null&&(p=r,v=null));var A=new Pa("action","action",null,u,f);s.push({event:A,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(oi!==0){var q=v?gv(f,v):new FormData(f);Jm(l,{pending:!0,data:q,method:f.method,action:p},null,q)}}else typeof p=="function"&&(A.preventDefault(),q=v?gv(f,v):new FormData(f),Jm(l,{pending:!0,data:q,method:f.method,action:p},p,q))},currentTarget:f}]})}}for(var Dp=0;Dp<pm.length;Dp++){var Mp=pm[Dp],cE=Mp.toLowerCase(),uE=Mp[0].toUpperCase()+Mp.slice(1);ma(cE,"on"+uE)}ma(Wg,"onAnimationEnd"),ma(Qg,"onAnimationIteration"),ma(Kg,"onAnimationStart"),ma("dblclick","onDoubleClick"),ma("focusin","onFocus"),ma("focusout","onBlur"),ma(ES,"onTransitionRun"),ma(TS,"onTransitionStart"),ma(AS,"onTransitionCancel"),ma(Xg,"onTransitionEnd"),Ia("onMouseEnter",["mouseout","mouseover"]),Ia("onMouseLeave",["mouseout","mouseover"]),Ia("onPointerEnter",["pointerout","pointerover"]),Ia("onPointerLeave",["pointerout","pointerover"]),Ra("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ra("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ra("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ra("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ra("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ra("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $c="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($c));function bv(s,r){r=(r&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],f=u.event;u=u.listeners;e:{var p=void 0;if(r)for(var v=u.length-1;0<=v;v--){var A=u[v],q=A.instance,se=A.currentTarget;if(A=A.listener,q!==p&&f.isPropagationStopped())break e;p=A,f.currentTarget=se;try{p(f)}catch(me){bd(me)}f.currentTarget=null,p=q}else for(v=0;v<u.length;v++){if(A=u[v],q=A.instance,se=A.currentTarget,A=A.listener,q!==p&&f.isPropagationStopped())break e;p=A,f.currentTarget=se;try{p(f)}catch(me){bd(me)}f.currentTarget=null,p=q}}}}function yt(s,r){var l=r[nr];l===void 0&&(l=r[nr]=new Set);var u=s+"__bubble";l.has(u)||(yv(r,s,2,!1),l.add(u))}function Op(s,r,l){var u=0;r&&(u|=4),yv(l,s,u,r)}var ah="_reactListening"+Math.random().toString(36).slice(2);function Pp(s){if(!s[ah]){s[ah]=!0,tc.forEach(function(l){l!=="selectionchange"&&(dE.has(l)||Op(l,!1,s),Op(l,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[ah]||(r[ah]=!0,Op("selectionchange",!1,r))}}function yv(s,r,l,u){switch(Wv(r)){case 2:var f=UE;break;case 8:f=BE;break;default:f=Xp}l=f.bind(null,r,l,s),f=void 0,!qi||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),u?f!==void 0?s.addEventListener(r,l,{capture:!0,passive:f}):s.addEventListener(r,l,!0):f!==void 0?s.addEventListener(r,l,{passive:f}):s.addEventListener(r,l,!1)}function Lp(s,r,l,u,f){var p=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var A=u.stateNode.containerInfo;if(A===f)break;if(v===4)for(v=u.return;v!==null;){var q=v.tag;if((q===3||q===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;A!==null;){if(v=ka(A),v===null)return;if(q=v.tag,q===5||q===6||q===26||q===27){u=p=v;continue e}A=A.parentNode}}u=u.return}$r(function(){var se=p,me=Gn(l),ve=[];e:{var ae=Jg.get(s);if(ae!==void 0){var oe=Pa,Ue=s;switch(s){case"keypress":if(Gi(l)===0)break e;case"keydown":case"keyup":oe=pd;break;case"focusin":Ue="focus",oe=Wi;break;case"focusout":Ue="blur",oe=Wi;break;case"beforeblur":case"afterblur":oe=Wi;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=mc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=id;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=y;break;case Wg:case Qg:case Kg:oe=od;break;case Xg:oe=D;break;case"scroll":case"scrollend":oe=fc;break;case"wheel":oe=ie;break;case"copy":case"cut":case"paste":oe=cd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=ir;break;case"toggle":case"beforetoggle":oe=dt}var st=(r&4)!==0,Kt=!st&&(s==="scroll"||s==="scrollend"),X=st?ae!==null?ae+"Capture":null:ae;st=[];for(var Y=se,te;Y!==null;){var be=Y;if(te=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||te===null||X===null||(be=ua(Y,X),be!=null&&st.push(qc(Y,be,te))),Kt)break;Y=Y.return}0<st.length&&(ae=new oe(ae,Ue,null,l,me),ve.push({event:ae,listeners:st}))}}if((r&7)===0){e:{if(ae=s==="mouseover"||s==="pointerover",oe=s==="mouseout"||s==="pointerout",ae&&l!==uc&&(Ue=l.relatedTarget||l.fromElement)&&(ka(Ue)||Ue[on]))break e;if((oe||ae)&&(ae=me.window===me?me:(ae=me.ownerDocument)?ae.defaultView||ae.parentWindow:window,oe?(Ue=l.relatedTarget||l.toElement,oe=se,Ue=Ue?ka(Ue):null,Ue!==null&&(Kt=c(Ue),st=Ue.tag,Ue!==Kt||st!==5&&st!==27&&st!==6)&&(Ue=null)):(oe=null,Ue=se),oe!==Ue)){if(st=mc,be="onMouseLeave",X="onMouseEnter",Y="mouse",(s==="pointerout"||s==="pointerover")&&(st=ir,be="onPointerLeave",X="onPointerEnter",Y="pointer"),Kt=oe==null?ae:Rn(oe),te=Ue==null?ae:Rn(Ue),ae=new st(be,Y+"leave",oe,l,me),ae.target=Kt,ae.relatedTarget=te,be=null,ka(me)===se&&(st=new st(X,Y+"enter",Ue,l,me),st.target=te,st.relatedTarget=Kt,be=st),Kt=be,oe&&Ue)t:{for(st=hE,X=oe,Y=Ue,te=0,be=X;be;be=st(be))te++;be=0;for(var Ke=Y;Ke;Ke=st(Ke))be++;for(;0<te-be;)X=st(X),te--;for(;0<be-te;)Y=st(Y),be--;for(;te--;){if(X===Y||Y!==null&&X===Y.alternate){st=X;break t}X=st(X),Y=st(Y)}st=null}else st=null;oe!==null&&vv(ve,ae,oe,st,!1),Ue!==null&&Kt!==null&&vv(ve,Kt,Ue,st,!0)}}e:{if(ae=se?Rn(se):window,oe=ae.nodeName&&ae.nodeName.toLowerCase(),oe==="select"||oe==="input"&&ae.type==="file")var Pt=Lg;else if(Og(ae))if(Vg)Pt=jS;else{Pt=wS;var ze=vS}else oe=ae.nodeName,!oe||oe.toLowerCase()!=="input"||ae.type!=="checkbox"&&ae.type!=="radio"?se&&Ll(se.elementType)&&(Pt=Lg):Pt=NS;if(Pt&&(Pt=Pt(s,se))){Pg(ve,Pt,l,me);break e}ze&&ze(s,ae,se),s==="focusout"&&se&&ae.type==="number"&&se.memoizedProps.value!=null&&lc(ae,"number",ae.value)}switch(ze=se?Rn(se):window,s){case"focusin":(Og(ze)||ze.contentEditable==="true")&&(Hl=ze,hm=se,yc=null);break;case"focusout":yc=hm=Hl=null;break;case"mousedown":fm=!0;break;case"contextmenu":case"mouseup":case"dragend":fm=!1,Gg(ve,l,me);break;case"selectionchange":if(SS)break;case"keydown":case"keyup":Gg(ve,l,me)}var mt;if(Vt)e:{switch(s){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else ql?Qi(s,l)&&(Nt="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Nt="onCompositionStart");Nt&&(Ua&&l.locale!=="ko"&&(ql||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&ql&&(mt=hc()):(Oa=me,dc="value"in Oa?Oa.value:Oa.textContent,ql=!0)),ze=rh(se,Nt),0<ze.length&&(Nt=new Va(Nt,s,null,l,me),ve.push({event:Nt,listeners:ze}),mt?Nt.data=mt:(mt=$l(l),mt!==null&&(Nt.data=mt)))),(mt=Wn?xS(s,l):gS(s,l))&&(Nt=rh(se,"onBeforeInput"),0<Nt.length&&(ze=new Va("onBeforeInput","beforeinput",null,l,me),ve.push({event:ze,listeners:Nt}),ze.data=mt)),oE(ve,s,se,l,me)}bv(ve,r)})}function qc(s,r,l){return{instance:s,listener:r,currentTarget:l}}function rh(s,r){for(var l=r+"Capture",u=[];s!==null;){var f=s,p=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||p===null||(f=ua(s,l),f!=null&&u.unshift(qc(s,f,p)),f=ua(s,r),f!=null&&u.push(qc(s,f,p))),s.tag===3)return u;s=s.return}return[]}function hE(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function vv(s,r,l,u,f){for(var p=r._reactName,v=[];l!==null&&l!==u;){var A=l,q=A.alternate,se=A.stateNode;if(A=A.tag,q!==null&&q===u)break;A!==5&&A!==26&&A!==27||se===null||(q=se,f?(se=ua(l,p),se!=null&&v.unshift(qc(l,se,q))):f||(se=ua(l,p),se!=null&&v.push(qc(l,se,q)))),l=l.return}v.length!==0&&s.push({event:r,listeners:v})}var fE=/\r\n?/g,mE=/\u0000|\uFFFD/g;function wv(s){return(typeof s=="string"?s:""+s).replace(fE,`
`).replace(mE,"")}function Nv(s,r){return r=wv(r),wv(s)===r}function Qt(s,r,l,u,f,p){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||mn(s,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&mn(s,""+u);break;case"className":In(s,"class",u);break;case"tabIndex":In(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":In(s,l,u);break;case"style":cc(s,u,p);break;case"data":if(r!=="object"){In(s,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Vl(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(l==="formAction"?(r!=="input"&&Qt(s,r,"name",f.name,f,null),Qt(s,r,"formEncType",f.formEncType,f,null),Qt(s,r,"formMethod",f.formMethod,f,null),Qt(s,r,"formTarget",f.formTarget,f,null)):(Qt(s,r,"encType",f.encType,f,null),Qt(s,r,"method",f.method,f,null),Qt(s,r,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Vl(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=ca);break;case"onScroll":u!=null&&yt("scroll",s);break;case"onScrollEnd":u!=null&&yt("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Vl(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":yt("beforetoggle",s),yt("toggle",s),Ol(s,"popover",u);break;case"xlinkActuate":Ss(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ss(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ss(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ss(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ss(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ss(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ss(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ss(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ss(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ol(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=rd.get(l)||l,Ol(s,l,u))}}function Vp(s,r,l,u,f,p){switch(l){case"style":cc(s,u,p);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof u=="string"?mn(s,u):(typeof u=="number"||typeof u=="bigint")&&mn(s,""+u);break;case"onScroll":u!=null&&yt("scroll",s);break;case"onScrollEnd":u!=null&&yt("scrollend",s);break;case"onClick":u!=null&&(s.onclick=ca);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!sc.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),r=l.slice(2,f?l.length-7:void 0),p=s[ms]||null,p=p!=null?p[l]:null,typeof p=="function"&&s.removeEventListener(r,p,f),typeof u=="function")){typeof p!="function"&&p!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(r,u,f);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Ol(s,l,u)}}}function Qs(s,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",s),yt("load",s);var u=!1,f=!1,p;for(p in l)if(l.hasOwnProperty(p)){var v=l[p];if(v!=null)switch(p){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Qt(s,r,p,v,l,null)}}f&&Qt(s,r,"srcSet",l.srcSet,l,null),u&&Qt(s,r,"src",l.src,l,null);return;case"input":yt("invalid",s);var A=p=v=f=null,q=null,se=null;for(u in l)if(l.hasOwnProperty(u)){var me=l[u];if(me!=null)switch(u){case"name":f=me;break;case"type":v=me;break;case"checked":q=me;break;case"defaultChecked":se=me;break;case"value":p=me;break;case"defaultValue":A=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,r));break;default:Qt(s,r,u,me,l,null)}}sd(s,p,A,q,se,v,f,!1);return;case"select":yt("invalid",s),u=v=p=null;for(f in l)if(l.hasOwnProperty(f)&&(A=l[f],A!=null))switch(f){case"value":p=A;break;case"defaultValue":v=A;break;case"multiple":u=A;default:Qt(s,r,f,A,l,null)}r=p,l=v,s.multiple=!!u,r!=null?Ur(s,!!u,r,!1):l!=null&&Ur(s,!!u,l,!0);return;case"textarea":yt("invalid",s),p=f=u=null;for(v in l)if(l.hasOwnProperty(v)&&(A=l[v],A!=null))switch(v){case"value":u=A;break;case"defaultValue":f=A;break;case"children":p=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(i(91));break;default:Qt(s,r,v,A,l,null)}Br(s,u,f,p);return;case"option":for(q in l)l.hasOwnProperty(q)&&(u=l[q],u!=null)&&(q==="selected"?s.selected=u&&typeof u!="function"&&typeof u!="symbol":Qt(s,r,q,u,l,null));return;case"dialog":yt("beforetoggle",s),yt("toggle",s),yt("cancel",s),yt("close",s);break;case"iframe":case"object":yt("load",s);break;case"video":case"audio":for(u=0;u<$c.length;u++)yt($c[u],s);break;case"image":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"embed":case"source":case"link":yt("error",s),yt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in l)if(l.hasOwnProperty(se)&&(u=l[se],u!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Qt(s,r,se,u,l,null)}return;default:if(Ll(r)){for(me in l)l.hasOwnProperty(me)&&(u=l[me],u!==void 0&&Vp(s,r,me,u,l,void 0));return}}for(A in l)l.hasOwnProperty(A)&&(u=l[A],u!=null&&Qt(s,r,A,u,l,null))}function pE(s,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,p=null,v=null,A=null,q=null,se=null,me=null;for(oe in l){var ve=l[oe];if(l.hasOwnProperty(oe)&&ve!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":q=ve;default:u.hasOwnProperty(oe)||Qt(s,r,oe,null,u,ve)}}for(var ae in u){var oe=u[ae];if(ve=l[ae],u.hasOwnProperty(ae)&&(oe!=null||ve!=null))switch(ae){case"type":p=oe;break;case"name":f=oe;break;case"checked":se=oe;break;case"defaultChecked":me=oe;break;case"value":v=oe;break;case"defaultValue":A=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,r));break;default:oe!==ve&&Qt(s,r,ae,oe,u,ve)}}Pl(s,v,A,q,se,me,p,f);return;case"select":oe=v=A=ae=null;for(p in l)if(q=l[p],l.hasOwnProperty(p)&&q!=null)switch(p){case"value":break;case"multiple":oe=q;default:u.hasOwnProperty(p)||Qt(s,r,p,null,u,q)}for(f in u)if(p=u[f],q=l[f],u.hasOwnProperty(f)&&(p!=null||q!=null))switch(f){case"value":ae=p;break;case"defaultValue":A=p;break;case"multiple":v=p;default:p!==q&&Qt(s,r,f,p,u,q)}r=A,l=v,u=oe,ae!=null?Ur(s,!!l,ae,!1):!!u!=!!l&&(r!=null?Ur(s,!!l,r,!0):Ur(s,!!l,l?[]:"",!1));return;case"textarea":oe=ae=null;for(A in l)if(f=l[A],l.hasOwnProperty(A)&&f!=null&&!u.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:Qt(s,r,A,null,u,f)}for(v in u)if(f=u[v],p=l[v],u.hasOwnProperty(v)&&(f!=null||p!=null))switch(v){case"value":ae=f;break;case"defaultValue":oe=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==p&&Qt(s,r,v,f,u,p)}nd(s,ae,oe);return;case"option":for(var Ue in l)ae=l[Ue],l.hasOwnProperty(Ue)&&ae!=null&&!u.hasOwnProperty(Ue)&&(Ue==="selected"?s.selected=!1:Qt(s,r,Ue,null,u,ae));for(q in u)ae=u[q],oe=l[q],u.hasOwnProperty(q)&&ae!==oe&&(ae!=null||oe!=null)&&(q==="selected"?s.selected=ae&&typeof ae!="function"&&typeof ae!="symbol":Qt(s,r,q,ae,u,oe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var st in l)ae=l[st],l.hasOwnProperty(st)&&ae!=null&&!u.hasOwnProperty(st)&&Qt(s,r,st,null,u,ae);for(se in u)if(ae=u[se],oe=l[se],u.hasOwnProperty(se)&&ae!==oe&&(ae!=null||oe!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(i(137,r));break;default:Qt(s,r,se,ae,u,oe)}return;default:if(Ll(r)){for(var Kt in l)ae=l[Kt],l.hasOwnProperty(Kt)&&ae!==void 0&&!u.hasOwnProperty(Kt)&&Vp(s,r,Kt,void 0,u,ae);for(me in u)ae=u[me],oe=l[me],!u.hasOwnProperty(me)||ae===oe||ae===void 0&&oe===void 0||Vp(s,r,me,ae,u,oe);return}}for(var X in l)ae=l[X],l.hasOwnProperty(X)&&ae!=null&&!u.hasOwnProperty(X)&&Qt(s,r,X,null,u,ae);for(ve in u)ae=u[ve],oe=l[ve],!u.hasOwnProperty(ve)||ae===oe||ae==null&&oe==null||Qt(s,r,ve,ae,u,oe)}function jv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function xE(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var f=l[u],p=f.transferSize,v=f.initiatorType,A=f.duration;if(p&&A&&jv(v)){for(v=0,A=f.responseEnd,u+=1;u<l.length;u++){var q=l[u],se=q.startTime;if(se>A)break;var me=q.transferSize,ve=q.initiatorType;me&&jv(ve)&&(q=q.responseEnd,v+=me*(q<A?1:(A-se)/(q-se)))}if(--u,r+=8*(p+v)/(f.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Up=null,Bp=null;function ih(s){return s.nodeType===9?s:s.ownerDocument}function _v(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Sv(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function zp(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Fp=null;function gE(){var s=window.event;return s&&s.type==="popstate"?s===Fp?!1:(Fp=s,!0):(Fp=null,!1)}var Ev=typeof setTimeout=="function"?setTimeout:void 0,bE=typeof clearTimeout=="function"?clearTimeout:void 0,Tv=typeof Promise=="function"?Promise:void 0,yE=typeof queueMicrotask=="function"?queueMicrotask:typeof Tv<"u"?function(s){return Tv.resolve(null).then(s).catch(vE)}:Ev;function vE(s){setTimeout(function(){throw s})}function ci(s){return s==="head"}function Av(s,r){var l=r,u=0;do{var f=l.nextSibling;if(s.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"||l==="/&"){if(u===0){s.removeChild(f),yo(r);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")Hc(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,Hc(l);for(var p=l.firstChild;p;){var v=p.nextSibling,A=p.nodeName;p[Aa]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&p.rel.toLowerCase()==="stylesheet"||l.removeChild(p),p=v}}else l==="body"&&Hc(s.ownerDocument.body);l=f}while(l);yo(r)}function kv(s,r){var l=s;s=0;do{var u=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=u}while(l)}function $p(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":$p(l),Ml(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function wE(s,r,l,u){for(;s.nodeType===1;){var f=l;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Aa])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(p=s.getAttribute("rel"),p==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(p!==f.rel||s.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||s.getAttribute("title")!==(f.title==null?null:f.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(p=s.getAttribute("src"),(p!==(f.src==null?null:f.src)||s.getAttribute("type")!==(f.type==null?null:f.type)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&p&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var p=f.name==null?null:""+f.name;if(f.type==="hidden"&&s.getAttribute("name")===p)return s}else return s;if(s=ta(s.nextSibling),s===null)break}return null}function NE(s,r,l){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=ta(s.nextSibling),s===null))return null;return s}function Cv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=ta(s.nextSibling),s===null))return null;return s}function qp(s){return s.data==="$?"||s.data==="$~"}function Hp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function jE(s,r){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||l.readyState!=="loading")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function ta(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var Gp=null;function Rv(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(r===0)return ta(s.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}s=s.nextSibling}return null}function Iv(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return s;r--}else l!=="/$"&&l!=="/&"||r++}s=s.previousSibling}return null}function Dv(s,r,l){switch(r=ih(l),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Hc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Ml(s)}var sa=new Map,Mv=new Set;function lh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var wr=K.d;K.d={f:_E,r:SE,D:EE,C:TE,L:AE,m:kE,X:RE,S:CE,M:IE};function _E(){var s=wr.f(),r=Jd();return s||r}function SE(s){var r=Hn(s);r!==null&&r.tag===5&&r.type==="form"?Xb(r):wr.r(s)}var xo=typeof document>"u"?null:document;function Ov(s,r,l){var u=xo;if(u&&typeof r=="string"&&r){var f=fn(r);f='link[rel="'+s+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),Mv.has(f)||(Mv.add(f),s={rel:s,crossOrigin:l,href:r},u.querySelector(f)===null&&(r=u.createElement("link"),Qs(r,"link",s),_s(r),u.head.appendChild(r)))}}function EE(s){wr.D(s),Ov("dns-prefetch",s,null)}function TE(s,r){wr.C(s,r),Ov("preconnect",s,r)}function AE(s,r,l){wr.L(s,r,l);var u=xo;if(u&&s&&r){var f='link[rel="preload"][as="'+fn(r)+'"]';r==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+fn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+fn(l.imageSizes)+'"]')):f+='[href="'+fn(s)+'"]';var p=f;switch(r){case"style":p=go(s);break;case"script":p=bo(s)}sa.has(p)||(s=w({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:s,as:r},l),sa.set(p,s),u.querySelector(f)!==null||r==="style"&&u.querySelector(Gc(p))||r==="script"&&u.querySelector(Yc(p))||(r=u.createElement("link"),Qs(r,"link",s),_s(r),u.head.appendChild(r)))}}function kE(s,r){wr.m(s,r);var l=xo;if(l&&s){var u=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+fn(u)+'"][href="'+fn(s)+'"]',p=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=bo(s)}if(!sa.has(p)&&(s=w({rel:"modulepreload",href:s},r),sa.set(p,s),l.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Yc(p)))return}u=l.createElement("link"),Qs(u,"link",s),_s(u),l.head.appendChild(u)}}}function CE(s,r,l){wr.S(s,r,l);var u=xo;if(u&&s){var f=Ca(u).hoistableStyles,p=go(s);r=r||"default";var v=f.get(p);if(!v){var A={loading:0,preload:null};if(v=u.querySelector(Gc(p)))A.loading=5;else{s=w({rel:"stylesheet",href:s,"data-precedence":r},l),(l=sa.get(p))&&Yp(s,l);var q=v=u.createElement("link");_s(q),Qs(q,"link",s),q._p=new Promise(function(se,me){q.onload=se,q.onerror=me}),q.addEventListener("load",function(){A.loading|=1}),q.addEventListener("error",function(){A.loading|=2}),A.loading|=4,oh(v,r,u)}v={type:"stylesheet",instance:v,count:1,state:A},f.set(p,v)}}}function RE(s,r){wr.X(s,r);var l=xo;if(l&&s){var u=Ca(l).hoistableScripts,f=bo(s),p=u.get(f);p||(p=l.querySelector(Yc(f)),p||(s=w({src:s,async:!0},r),(r=sa.get(f))&&Wp(s,r),p=l.createElement("script"),_s(p),Qs(p,"link",s),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function IE(s,r){wr.M(s,r);var l=xo;if(l&&s){var u=Ca(l).hoistableScripts,f=bo(s),p=u.get(f);p||(p=l.querySelector(Yc(f)),p||(s=w({src:s,async:!0,type:"module"},r),(r=sa.get(f))&&Wp(s,r),p=l.createElement("script"),_s(p),Qs(p,"link",s),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function Pv(s,r,l,u){var f=(f=Ce.current)?lh(f):null;if(!f)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=go(l.href),l=Ca(f).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=go(l.href);var p=Ca(f).hoistableStyles,v=p.get(s);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(s,v),(p=f.querySelector(Gc(s)))&&!p._p&&(v.instance=p,v.state.loading=5),sa.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},sa.set(s,l),p||DE(f,s,l,v.state))),r&&u===null)throw Error(i(528,""));return v}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=bo(l),l=Ca(f).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function go(s){return'href="'+fn(s)+'"'}function Gc(s){return'link[rel="stylesheet"]['+s+"]"}function Lv(s){return w({},s,{"data-precedence":s.precedence,precedence:null})}function DE(s,r,l,u){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=s.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),Qs(r,"link",l),_s(r),s.head.appendChild(r))}function bo(s){return'[src="'+fn(s)+'"]'}function Yc(s){return"script[async]"+s}function Vv(s,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=s.querySelector('style[data-href~="'+fn(l.href)+'"]');if(u)return r.instance=u,_s(u),u;var f=w({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),_s(u),Qs(u,"style",f),oh(u,l.precedence,s),r.instance=u;case"stylesheet":f=go(l.href);var p=s.querySelector(Gc(f));if(p)return r.state.loading|=4,r.instance=p,_s(p),p;u=Lv(l),(f=sa.get(f))&&Yp(u,f),p=(s.ownerDocument||s).createElement("link"),_s(p);var v=p;return v._p=new Promise(function(A,q){v.onload=A,v.onerror=q}),Qs(p,"link",u),r.state.loading|=4,oh(p,l.precedence,s),r.instance=p;case"script":return p=bo(l.src),(f=s.querySelector(Yc(p)))?(r.instance=f,_s(f),f):(u=l,(f=sa.get(p))&&(u=w({},l),Wp(u,f)),s=s.ownerDocument||s,f=s.createElement("script"),_s(f),Qs(f,"link",u),s.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,oh(u,l.precedence,s));return r.instance}function oh(s,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,p=f,v=0;v<u.length;v++){var A=u[v];if(A.dataset.precedence===r)p=A;else if(p!==f)break}p?p.parentNode.insertBefore(s,p.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(s,r.firstChild))}function Yp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function Wp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var ch=null;function Uv(s,r,l){if(ch===null){var u=new Map,f=ch=new Map;f.set(l,u)}else f=ch,u=f.get(l),u||(u=new Map,f.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),f=0;f<l.length;f++){var p=l[f];if(!(p[Aa]||p[Jt]||s==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var v=p.getAttribute(r)||"";v=s+v;var A=u.get(v);A?A.push(p):u.set(v,[p])}}return u}function Bv(s,r,l){s=s.ownerDocument||s,s.head.insertBefore(l,r==="title"?s.querySelector("head > title"):null)}function ME(s,r,l){if(l===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(s=r.disabled,typeof r.precedence=="string"&&s==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function zv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function OE(s,r,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var f=go(u.href),p=r.querySelector(Gc(f));if(p){r=p._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=uh.bind(s),r.then(s,s)),l.state.loading|=4,l.instance=p,_s(p);return}p=r.ownerDocument||r,u=Lv(u),(f=sa.get(f))&&Yp(u,f),p=p.createElement("link"),_s(p);var v=p;v._p=new Promise(function(A,q){v.onload=A,v.onerror=q}),Qs(p,"link",u),l.instance=p}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=uh.bind(s),r.addEventListener("load",l),r.addEventListener("error",l))}}var Qp=0;function PE(s,r){return s.stylesheets&&s.count===0&&hh(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var u=setTimeout(function(){if(s.stylesheets&&hh(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4+r);0<s.imgBytes&&Qp===0&&(Qp=62500*xE());var f=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&hh(s,s.stylesheets),s.unsuspend)){var p=s.unsuspend;s.unsuspend=null,p()}},(s.imgBytes>Qp?50:800)+r);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(f)}}:null}function uh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)hh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var dh=null;function hh(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,dh=new Map,r.forEach(LE,s),dh=null,uh.call(s))}function LE(s,r){if(!(r.state.loading&4)){var l=dh.get(s);if(l)var u=l.get(null);else{l=new Map,dh.set(s,l);for(var f=s.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<f.length;p++){var v=f[p];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(l.set(v.dataset.precedence,v),u=v)}u&&l.set(null,u)}f=r.instance,v=f.getAttribute("data-precedence"),p=l.get(v)||u,p===u&&l.set(null,f),l.set(v,f),this.count++,u=uh.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),p?p.parentNode.insertBefore(f,p.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(f,s.firstChild)),r.state.loading|=4}}var Wc={$$typeof:H,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function VE(s,r,l,u,f,p,v,A,q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fe(0),this.hiddenUpdates=fe(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=p,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function Fv(s,r,l,u,f,p,v,A,q,se,me,ve){return s=new VE(s,r,l,v,q,se,me,ve,A),r=1,p===!0&&(r|=24),p=Mn(3,null,null,r),s.current=p,p.stateNode=s,r=Am(),r.refCount++,s.pooledCache=r,r.refCount++,p.memoizedState={element:u,isDehydrated:l,cache:r},Im(p),s}function $v(s){return s?(s=Wl,s):Wl}function qv(s,r,l,u,f,p){f=$v(f),u.context===null?u.context=f:u.pendingContext=f,u=Jr(r),u.payload={element:l},p=p===void 0?null:p,p!==null&&(u.callback=p),l=Zr(s,u,r),l!==null&&(yn(l,s,r),Ec(l,s,r))}function Hv(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<r?l:r}}function Kp(s,r){Hv(s,r),(s=s.alternate)&&Hv(s,r)}function Gv(s){if(s.tag===13||s.tag===31){var r=Ji(s,67108864);r!==null&&yn(r,s,67108864),Kp(s,67108864)}}function Yv(s){if(s.tag===13||s.tag===31){var r=Un();r=vt(r);var l=Ji(s,r);l!==null&&yn(l,s,r),Kp(s,r)}}var fh=!0;function UE(s,r,l,u){var f=P.T;P.T=null;var p=K.p;try{K.p=2,Xp(s,r,l,u)}finally{K.p=p,P.T=f}}function BE(s,r,l,u){var f=P.T;P.T=null;var p=K.p;try{K.p=8,Xp(s,r,l,u)}finally{K.p=p,P.T=f}}function Xp(s,r,l,u){if(fh){var f=Jp(u);if(f===null)Lp(s,r,u,mh,l),Qv(s,u);else if(FE(f,s,r,l,u))u.stopPropagation();else if(Qv(s,u),r&4&&-1<zE.indexOf(s)){for(;f!==null;){var p=Hn(f);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var v=ot(p.pendingLanes);if(v!==0){var A=p;for(A.pendingLanes|=2,A.entangledLanes|=2;v;){var q=1<<31-Xt(v);A.entanglements[1]|=q,v&=~q}$a(p),(Ut&6)===0&&(Kd=Le()+500,Fc(0))}}break;case 31:case 13:A=Ji(p,2),A!==null&&yn(A,p,2),Jd(),Kp(p,2)}if(p=Jp(u),p===null&&Lp(s,r,u,mh,l),p===f)break;f=p}f!==null&&u.stopPropagation()}else Lp(s,r,u,null,l)}}function Jp(s){return s=Gn(s),Zp(s)}var mh=null;function Zp(s){if(mh=null,s=ka(s),s!==null){var r=c(s);if(r===null)s=null;else{var l=r.tag;if(l===13){if(s=d(r),s!==null)return s;s=null}else if(l===31){if(s=m(r),s!==null)return s;s=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return mh=s,null}function Wv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(De()){case Ge:return 2;case He:return 8;case J:case Ae:return 32;case We:return 268435456;default:return 32}default:return 32}}var e0=!1,ui=null,di=null,hi=null,Qc=new Map,Kc=new Map,fi=[],zE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Qv(s,r){switch(s){case"focusin":case"focusout":ui=null;break;case"dragenter":case"dragleave":di=null;break;case"mouseover":case"mouseout":hi=null;break;case"pointerover":case"pointerout":Qc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kc.delete(r.pointerId)}}function Xc(s,r,l,u,f,p){return s===null||s.nativeEvent!==p?(s={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:p,targetContainers:[f]},r!==null&&(r=Hn(r),r!==null&&Gv(r)),s):(s.eventSystemFlags|=u,r=s.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),s)}function FE(s,r,l,u,f){switch(r){case"focusin":return ui=Xc(ui,s,r,l,u,f),!0;case"dragenter":return di=Xc(di,s,r,l,u,f),!0;case"mouseover":return hi=Xc(hi,s,r,l,u,f),!0;case"pointerover":var p=f.pointerId;return Qc.set(p,Xc(Qc.get(p)||null,s,r,l,u,f)),!0;case"gotpointercapture":return p=f.pointerId,Kc.set(p,Xc(Kc.get(p)||null,s,r,l,u,f)),!0}return!1}function Kv(s){var r=ka(s.target);if(r!==null){var l=c(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){s.blockedOn=r,Ot(s.priority,function(){Yv(l)});return}}else if(r===31){if(r=m(l),r!==null){s.blockedOn=r,Ot(s.priority,function(){Yv(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ph(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var l=Jp(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);uc=u,l.target.dispatchEvent(u),uc=null}else return r=Hn(l),r!==null&&Gv(r),s.blockedOn=l,!1;r.shift()}return!0}function Xv(s,r,l){ph(s)&&l.delete(r)}function $E(){e0=!1,ui!==null&&ph(ui)&&(ui=null),di!==null&&ph(di)&&(di=null),hi!==null&&ph(hi)&&(hi=null),Qc.forEach(Xv),Kc.forEach(Xv)}function xh(s,r){s.blockedOn===r&&(s.blockedOn=null,e0||(e0=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,$E)))}var gh=null;function Jv(s){gh!==s&&(gh=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){gh===s&&(gh=null);for(var r=0;r<s.length;r+=3){var l=s[r],u=s[r+1],f=s[r+2];if(typeof u!="function"){if(Zp(u||l)===null)continue;break}var p=Hn(l);p!==null&&(s.splice(r,3),r-=3,Jm(p,{pending:!0,data:f,method:l.method,action:u},u,f))}}))}function yo(s){function r(q){return xh(q,s)}ui!==null&&xh(ui,s),di!==null&&xh(di,s),hi!==null&&xh(hi,s),Qc.forEach(r),Kc.forEach(r);for(var l=0;l<fi.length;l++){var u=fi[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<fi.length&&(l=fi[0],l.blockedOn===null);)Kv(l),l.blockedOn===null&&fi.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var f=l[u],p=l[u+1],v=f[ms]||null;if(typeof p=="function")v||Jv(l);else if(v){var A=null;if(p&&p.hasAttribute("formAction")){if(f=p,v=p[ms]||null)A=v.formAction;else if(Zp(f)!==null)continue}else A=v.action;typeof A=="function"?l[u+1]=A:(l.splice(u,3),u-=3),Jv(l)}}}function Zv(){function s(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,f=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function t0(s){this._internalRoot=s}bh.prototype.render=t0.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,u=Un();qv(l,u,s,r,null,null)},bh.prototype.unmount=t0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;qv(s.current,2,null,s,null,null),Jd(),r[on]=null}};function bh(s){this._internalRoot=s}bh.prototype.unstable_scheduleHydration=function(s){if(s){var r=Os();s={blockedOn:null,target:s,priority:r};for(var l=0;l<fi.length&&r!==0&&r<fi[l].priority;l++);fi.splice(l,0,s),l===0&&Kv(s)}};var ew=e.version;if(ew!=="19.2.4")throw Error(i(527,ew,"19.2.4"));K.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=g(r),s=s!==null?b(s):null,s=s===null?null:s.stateNode,s};var qE={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yh.isDisabled&&yh.supportsFiber)try{rs=yh.inject(qE),gt=yh}catch{}}return Zc.createRoot=function(s,r){if(!o(s))throw Error(i(299));var l=!1,u="",f=ly,p=oy,v=cy;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(p=r.onCaughtError),r.onRecoverableError!==void 0&&(v=r.onRecoverableError)),r=Fv(s,1,!1,null,null,l,u,null,f,p,v,Zv),s[on]=r.current,Pp(s),new t0(r)},Zc.hydrateRoot=function(s,r,l){if(!o(s))throw Error(i(299));var u=!1,f="",p=ly,v=oy,A=cy,q=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(p=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(A=l.onRecoverableError),l.formState!==void 0&&(q=l.formState)),r=Fv(s,1,!0,r,l??null,u,f,q,p,v,A,Zv),r.context=$v(null),l=r.current,u=Un(),u=vt(u),f=Jr(u),f.callback=null,Zr(l,f,u),l=u,r.current.lanes=l,ue(r,l),$a(r),s[on]=r.current,Pp(s),new bh(r)},Zc.version="19.2.4",Zc}var uw;function eT(){if(uw)return a0.exports;uw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),a0.exports=ZE(),a0.exports}var tT=eT();const sT=vx(tT);var dw="popstate";function nT(n={}){function e(o,c){let{pathname:d="/",search:m="",hash:x=""}=El(o.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),D0("",{pathname:d,search:m,hash:x},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function t(o,c){let d=o.document.querySelector("base"),m="";if(d&&d.getAttribute("href")){let x=o.location.href,g=x.indexOf("#");m=g===-1?x:x.slice(0,g)}return m+"#"+(typeof c=="string"?c:_u(c))}function i(o,c){$n(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(c)})`)}return rT(e,t,i,n)}function ds(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function $n(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function aT(){return Math.random().toString(36).substring(2,10)}function hw(n,e){return{usr:n.state,key:n.key,idx:e}}function D0(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?El(e):e,state:t,key:e&&e.key||i||aT()}}function _u({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function El(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function rT(n,e,t,i={}){let{window:o=document.defaultView,v5Compat:c=!1}=i,d=o.history,m="POP",x=null,g=b();g==null&&(g=0,d.replaceState({...d.state,idx:g},""));function b(){return(d.state||{idx:null}).idx}function w(){m="POP";let U=b(),F=U==null?null:U-g;g=U,x&&x({action:m,location:V.location,delta:F})}function _(U,F){m="PUSH";let Q=D0(V.location,U,F);t&&t(Q,U),g=b()+1;let H=hw(Q,g),re=V.createHref(Q);try{d.pushState(H,"",re)}catch(he){if(he instanceof DOMException&&he.name==="DataCloneError")throw he;o.location.assign(re)}c&&x&&x({action:m,location:V.location,delta:1})}function R(U,F){m="REPLACE";let Q=D0(V.location,U,F);t&&t(Q,U),g=b();let H=hw(Q,g),re=V.createHref(Q);d.replaceState(H,"",re),c&&x&&x({action:m,location:V.location,delta:0})}function B(U){return iT(U)}let V={get action(){return m},get location(){return n(o,d)},listen(U){if(x)throw new Error("A history only accepts one active listener");return o.addEventListener(dw,w),x=U,()=>{o.removeEventListener(dw,w),x=null}},createHref(U){return e(o,U)},createURL:B,encodeLocation(U){let F=B(U);return{pathname:F.pathname,search:F.search,hash:F.hash}},push:_,replace:R,go(U){return d.go(U)}};return V}function iT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ds(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:_u(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function I1(n,e,t="/"){return lT(n,e,t,!1)}function lT(n,e,t,i){let o=typeof e=="string"?El(e):e,c=Cr(o.pathname||"/",t);if(c==null)return null;let d=D1(n);oT(d);let m=null;for(let x=0;m==null&&x<d.length;++x){let g=yT(c);m=gT(d[x],g,i)}return m}function D1(n,e=[],t=[],i="",o=!1){let c=(d,m,x=o,g)=>{let b={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:m,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&x)return;ds(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let w=Er([i,b.relativePath]),_=t.concat(b);d.children&&d.children.length>0&&(ds(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),D1(d.children,e,_,w,x)),!(d.path==null&&!d.index)&&e.push({path:w,score:pT(w,d.index),routesMeta:_})};return n.forEach((d,m)=>{if(d.path===""||!d.path?.includes("?"))c(d,m);else for(let x of M1(d.path))c(d,m,!0,x)}),e}function M1(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,o=t.endsWith("?"),c=t.replace(/\?$/,"");if(i.length===0)return o?[c,""]:[c];let d=M1(i.join("/")),m=[];return m.push(...d.map(x=>x===""?c:[c,x].join("/"))),o&&m.push(...d),m.map(x=>n.startsWith("/")&&x===""?"/":x)}function oT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:xT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var cT=/^:[\w-]+$/,uT=3,dT=2,hT=1,fT=10,mT=-2,fw=n=>n==="*";function pT(n,e){let t=n.split("/"),i=t.length;return t.some(fw)&&(i+=mT),e&&(i+=dT),t.filter(o=>!fw(o)).reduce((o,c)=>o+(cT.test(c)?uT:c===""?hT:fT),i)}function xT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,o)=>i===e[o])?n[n.length-1]-e[e.length-1]:0}function gT(n,e,t=!1){let{routesMeta:i}=n,o={},c="/",d=[];for(let m=0;m<i.length;++m){let x=i[m],g=m===i.length-1,b=c==="/"?e:e.slice(c.length)||"/",w=ef({path:x.relativePath,caseSensitive:x.caseSensitive,end:g},b),_=x.route;if(!w&&g&&t&&!i[i.length-1].route.index&&(w=ef({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},b)),!w)return null;Object.assign(o,w.params),d.push({params:o,pathname:Er([c,w.pathname]),pathnameBase:jT(Er([c,w.pathnameBase])),route:_}),w.pathnameBase!=="/"&&(c=Er([c,w.pathnameBase]))}return d}function ef(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=bT(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),m=o.slice(1);return{params:i.reduce((g,{paramName:b,isOptional:w},_)=>{if(b==="*"){let B=m[_]||"";d=c.slice(0,c.length-B.length).replace(/(.)\/+$/,"$1")}const R=m[_];return w&&!R?g[b]=void 0:g[b]=(R||"").replace(/%2F/g,"/"),g},{}),pathname:c,pathnameBase:d,pattern:n}}function bT(n,e=!1,t=!0){$n(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,m,x)=>(i.push({paramName:m,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function yT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return $n(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Cr(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var vT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function wT(n,e="/"){let{pathname:t,search:i="",hash:o=""}=typeof n=="string"?El(n):n,c;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?c=mw(t.substring(1),"/"):c=mw(t,e)):c=e,{pathname:c,search:_T(i),hash:ST(o)}}function mw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function o0(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function NT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Nx(n){let e=NT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function jx(n,e,t,i=!1){let o;typeof n=="string"?o=El(n):(o={...n},ds(!o.pathname||!o.pathname.includes("?"),o0("?","pathname","search",o)),ds(!o.pathname||!o.pathname.includes("#"),o0("#","pathname","hash",o)),ds(!o.search||!o.search.includes("#"),o0("#","search","hash",o)));let c=n===""||o.pathname==="",d=c?"/":o.pathname,m;if(d==null)m=t;else{let w=e.length-1;if(!i&&d.startsWith("..")){let _=d.split("/");for(;_[0]==="..";)_.shift(),w-=1;o.pathname=_.join("/")}m=w>=0?e[w]:"/"}let x=wT(o,m),g=d&&d!=="/"&&d.endsWith("/"),b=(c||d===".")&&t.endsWith("/");return!x.pathname.endsWith("/")&&(g||b)&&(x.pathname+="/"),x}var Er=n=>n.join("/").replace(/\/\/+/g,"/"),jT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),_T=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,ST=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,ET=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function TT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function AT(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var O1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function P1(n,e){let t=n;if(typeof t!="string"||!vT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,o=!1;if(O1)try{let c=new URL(window.location.href),d=t.startsWith("//")?new URL(c.protocol+t):new URL(t),m=Cr(d.pathname,e);d.origin===c.origin&&m!=null?t=m+d.search+d.hash:o=!0}catch{$n(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:o,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var L1=["POST","PUT","PATCH","DELETE"];new Set(L1);var kT=["GET",...L1];new Set(kT);var Go=j.createContext(null);Go.displayName="DataRouter";var Rf=j.createContext(null);Rf.displayName="DataRouterState";var CT=j.createContext(!1),V1=j.createContext({isTransitioning:!1});V1.displayName="ViewTransition";var RT=j.createContext(new Map);RT.displayName="Fetchers";var IT=j.createContext(null);IT.displayName="Await";var qn=j.createContext(null);qn.displayName="Navigation";var Vu=j.createContext(null);Vu.displayName="Location";var Ea=j.createContext({outlet:null,matches:[],isDataRoute:!1});Ea.displayName="Route";var _x=j.createContext(null);_x.displayName="RouteError";var U1="REACT_ROUTER_ERROR",DT="REDIRECT",MT="ROUTE_ERROR_RESPONSE";function OT(n){if(n.startsWith(`${U1}:${DT}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function PT(n){if(n.startsWith(`${U1}:${MT}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new ET(e.status,e.statusText,e.data)}catch{}}function LT(n,{relative:e}={}){ds(Yo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=j.useContext(qn),{hash:o,pathname:c,search:d}=Uu(n,{relative:e}),m=c;return t!=="/"&&(m=c==="/"?t:Er([t,c])),i.createHref({pathname:m,search:d,hash:o})}function Yo(){return j.useContext(Vu)!=null}function Lr(){return ds(Yo(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(Vu).location}var B1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function z1(n){j.useContext(qn).static||j.useLayoutEffect(n)}function Oi(){let{isDataRoute:n}=j.useContext(Ea);return n?KT():VT()}function VT(){ds(Yo(),"useNavigate() may be used only in the context of a <Router> component.");let n=j.useContext(Go),{basename:e,navigator:t}=j.useContext(qn),{matches:i}=j.useContext(Ea),{pathname:o}=Lr(),c=JSON.stringify(Nx(i)),d=j.useRef(!1);return z1(()=>{d.current=!0}),j.useCallback((x,g={})=>{if($n(d.current,B1),!d.current)return;if(typeof x=="number"){t.go(x);return}let b=jx(x,JSON.parse(c),o,g.relative==="path");n==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Er([e,b.pathname])),(g.replace?t.replace:t.push)(b,g.state,g)},[e,t,c,o,n])}j.createContext(null);function Wo(){let{matches:n}=j.useContext(Ea),e=n[n.length-1];return e?e.params:{}}function Uu(n,{relative:e}={}){let{matches:t}=j.useContext(Ea),{pathname:i}=Lr(),o=JSON.stringify(Nx(t));return j.useMemo(()=>jx(n,JSON.parse(o),i,e==="path"),[n,o,i,e])}function UT(n,e){return F1(n,e)}function F1(n,e,t,i,o){ds(Yo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=j.useContext(qn),{matches:d}=j.useContext(Ea),m=d[d.length-1],x=m?m.params:{},g=m?m.pathname:"/",b=m?m.pathnameBase:"/",w=m&&m.route;{let Q=w&&w.path||"";q1(g,!w||Q.endsWith("*")||Q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${Q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Q}"> to <Route path="${Q==="/"?"*":`${Q}/*`}">.`)}let _=Lr(),R;if(e){let Q=typeof e=="string"?El(e):e;ds(b==="/"||Q.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${Q.pathname}" was given in the \`location\` prop.`),R=Q}else R=_;let B=R.pathname||"/",V=B;if(b!=="/"){let Q=b.replace(/^\//,"").split("/");V="/"+B.replace(/^\//,"").split("/").slice(Q.length).join("/")}let U=I1(n,{pathname:V});$n(w||U!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),$n(U==null||U[U.length-1].route.element!==void 0||U[U.length-1].route.Component!==void 0||U[U.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let F=qT(U&&U.map(Q=>Object.assign({},Q,{params:Object.assign({},x,Q.params),pathname:Er([b,c.encodeLocation?c.encodeLocation(Q.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Q.pathname]),pathnameBase:Q.pathnameBase==="/"?b:Er([b,c.encodeLocation?c.encodeLocation(Q.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Q.pathnameBase])})),d,t,i,o);return e&&F?j.createElement(Vu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...R},navigationType:"POP"}},F):F}function BT(){let n=QT(),e=TT(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},c={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:c},"ErrorBoundary")," or"," ",j.createElement("code",{style:c},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:o},t):null,d)}var zT=j.createElement(BT,null),$1=class extends j.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=PT(n.digest);t&&(n=t)}let e=n!==void 0?j.createElement(Ea.Provider,{value:this.props.routeContext},j.createElement(_x.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?j.createElement(FT,{error:n},e):e}};$1.contextType=CT;var c0=new WeakMap;function FT({children:n,error:e}){let{basename:t}=j.useContext(qn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=OT(e.digest);if(i){let o=c0.get(e);if(o)throw o;let c=P1(i.location,t);if(O1&&!c0.get(e))if(c.isExternal||i.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:i.replace}));throw c0.set(e,d),d}return j.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return n}function $T({routeContext:n,match:e,children:t}){let i=j.useContext(Go);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),j.createElement(Ea.Provider,{value:n},t)}function qT(n,e=[],t=null,i=null,o=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,d=t?.errors;if(d!=null){let b=c.findIndex(w=>w.route.id&&d?.[w.route.id]!==void 0);ds(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,b+1))}let m=!1,x=-1;if(t)for(let b=0;b<c.length;b++){let w=c[b];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(x=b),w.route.id){let{loaderData:_,errors:R}=t,B=w.route.loader&&!_.hasOwnProperty(w.route.id)&&(!R||R[w.route.id]===void 0);if(w.route.lazy||B){m=!0,x>=0?c=c.slice(0,x+1):c=[c[0]];break}}}let g=t&&i?(b,w)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:AT(t.matches),errorInfo:w})}:void 0;return c.reduceRight((b,w,_)=>{let R,B=!1,V=null,U=null;t&&(R=d&&w.route.id?d[w.route.id]:void 0,V=w.route.errorElement||zT,m&&(x<0&&_===0?(q1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),B=!0,U=null):x===_&&(B=!0,U=w.route.hydrateFallbackElement||null)));let F=e.concat(c.slice(0,_+1)),Q=()=>{let H;return R?H=V:B?H=U:w.route.Component?H=j.createElement(w.route.Component,null):w.route.element?H=w.route.element:H=b,j.createElement($T,{match:w,routeContext:{outlet:b,matches:F,isDataRoute:t!=null},children:H})};return t&&(w.route.ErrorBoundary||w.route.errorElement||_===0)?j.createElement($1,{location:t.location,revalidation:t.revalidation,component:V,error:R,children:Q(),routeContext:{outlet:null,matches:F,isDataRoute:!0},onError:g}):Q()},null)}function Sx(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function HT(n){let e=j.useContext(Go);return ds(e,Sx(n)),e}function GT(n){let e=j.useContext(Rf);return ds(e,Sx(n)),e}function YT(n){let e=j.useContext(Ea);return ds(e,Sx(n)),e}function Ex(n){let e=YT(n),t=e.matches[e.matches.length-1];return ds(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function WT(){return Ex("useRouteId")}function QT(){let n=j.useContext(_x),e=GT("useRouteError"),t=Ex("useRouteError");return n!==void 0?n:e.errors?.[t]}function KT(){let{router:n}=HT("useNavigate"),e=Ex("useNavigate"),t=j.useRef(!1);return z1(()=>{t.current=!0}),j.useCallback(async(o,c={})=>{$n(t.current,B1),t.current&&(typeof o=="number"?await n.navigate(o):await n.navigate(o,{fromRouteId:e,...c}))},[n,e])}var pw={};function q1(n,e,t){!e&&!pw[n]&&(pw[n]=!0,$n(!1,t))}j.memo(XT);function XT({routes:n,future:e,state:t,onError:i}){return F1(n,void 0,t,i,e)}function JT({to:n,replace:e,state:t,relative:i}){ds(Yo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=j.useContext(qn);$n(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=j.useContext(Ea),{pathname:d}=Lr(),m=Oi(),x=jx(n,Nx(c),d,i==="path"),g=JSON.stringify(x);return j.useEffect(()=>{m(JSON.parse(g),{replace:e,state:t,relative:i})},[m,g,i,e,t]),null}function na(n){ds(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ZT({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:o,static:c=!1,unstable_useTransitions:d}){ds(!Yo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let m=n.replace(/^\/*/,"/"),x=j.useMemo(()=>({basename:m,navigator:o,static:c,unstable_useTransitions:d,future:{}}),[m,o,c,d]);typeof t=="string"&&(t=El(t));let{pathname:g="/",search:b="",hash:w="",state:_=null,key:R="default"}=t,B=j.useMemo(()=>{let V=Cr(g,m);return V==null?null:{location:{pathname:V,search:b,hash:w,state:_,key:R},navigationType:i}},[m,g,b,w,_,R,i]);return $n(B!=null,`<Router basename="${m}"> is not able to match the URL "${g}${b}${w}" because it does not start with the basename, so the <Router> won't render anything.`),B==null?null:j.createElement(qn.Provider,{value:x},j.createElement(Vu.Provider,{children:e,value:B}))}function e5({children:n,location:e}){return UT(M0(n),e)}function M0(n,e=[]){let t=[];return j.Children.forEach(n,(i,o)=>{if(!j.isValidElement(i))return;let c=[...e,o];if(i.type===j.Fragment){t.push.apply(t,M0(i.props.children,c));return}ds(i.type===na,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ds(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||c.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=M0(i.props.children,c)),t.push(d)}),t}var Oh="get",Ph="application/x-www-form-urlencoded";function If(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function t5(n){return If(n)&&n.tagName.toLowerCase()==="button"}function s5(n){return If(n)&&n.tagName.toLowerCase()==="form"}function n5(n){return If(n)&&n.tagName.toLowerCase()==="input"}function a5(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function r5(n,e){return n.button===0&&(!e||e==="_self")&&!a5(n)}function O0(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(o=>[t,o]):[[t,i]])},[]))}function i5(n,e){let t=O0(n);return e&&e.forEach((i,o)=>{t.has(o)||e.getAll(o).forEach(c=>{t.append(o,c)})}),t}var vh=null;function l5(){if(vh===null)try{new FormData(document.createElement("form"),0),vh=!1}catch{vh=!0}return vh}var o5=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function u0(n){return n!=null&&!o5.has(n)?($n(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ph}"`),null):n}function c5(n,e){let t,i,o,c,d;if(s5(n)){let m=n.getAttribute("action");i=m?Cr(m,e):null,t=n.getAttribute("method")||Oh,o=u0(n.getAttribute("enctype"))||Ph,c=new FormData(n)}else if(t5(n)||n5(n)&&(n.type==="submit"||n.type==="image")){let m=n.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let x=n.getAttribute("formaction")||m.getAttribute("action");if(i=x?Cr(x,e):null,t=n.getAttribute("formmethod")||m.getAttribute("method")||Oh,o=u0(n.getAttribute("formenctype"))||u0(m.getAttribute("enctype"))||Ph,c=new FormData(m,n),!l5()){let{name:g,type:b,value:w}=n;if(b==="image"){let _=g?`${g}.`:"";c.append(`${_}x`,"0"),c.append(`${_}y`,"0")}else g&&c.append(g,w)}}else{if(If(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Oh,i=null,o=Ph,d=n}return c&&o==="text/plain"&&(d=c,c=void 0),{action:i,method:t.toLowerCase(),encType:o,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Tx(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function u5(n,e,t,i){let o=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${i}`:o.pathname=`${o.pathname}.${i}`:o.pathname==="/"?o.pathname=`_root.${i}`:e&&Cr(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${i}`,o}async function d5(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function h5(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function f5(n,e,t){let i=await Promise.all(n.map(async o=>{let c=e.routes[o.route.id];if(c){let d=await d5(c,t);return d.links?d.links():[]}return[]}));return g5(i.flat(1).filter(h5).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function xw(n,e,t,i,o,c){let d=(x,g)=>t[g]?x.route.id!==t[g].route.id:!0,m=(x,g)=>t[g].pathname!==x.pathname||t[g].route.path?.endsWith("*")&&t[g].params["*"]!==x.params["*"];return c==="assets"?e.filter((x,g)=>d(x,g)||m(x,g)):c==="data"?e.filter((x,g)=>{let b=i.routes[x.route.id];if(!b||!b.hasLoader)return!1;if(d(x,g)||m(x,g))return!0;if(x.route.shouldRevalidate){let w=x.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:x.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function m5(n,e,{includeHydrateFallback:t}={}){return p5(n.map(i=>{let o=e.routes[i.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function p5(n){return[...new Set(n)]}function x5(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function g5(n,e){let t=new Set;return new Set(e),n.reduce((i,o)=>{let c=JSON.stringify(x5(o));return t.has(c)||(t.add(c),i.push({key:c,link:o})),i},[])}function H1(){let n=j.useContext(Go);return Tx(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function b5(){let n=j.useContext(Rf);return Tx(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Ax=j.createContext(void 0);Ax.displayName="FrameworkContext";function G1(){let n=j.useContext(Ax);return Tx(n,"You must render this element inside a <HydratedRouter> element"),n}function y5(n,e){let t=j.useContext(Ax),[i,o]=j.useState(!1),[c,d]=j.useState(!1),{onFocus:m,onBlur:x,onMouseEnter:g,onMouseLeave:b,onTouchStart:w}=e,_=j.useRef(null);j.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let V=F=>{F.forEach(Q=>{d(Q.isIntersecting)})},U=new IntersectionObserver(V,{threshold:.5});return _.current&&U.observe(_.current),()=>{U.disconnect()}}},[n]),j.useEffect(()=>{if(i){let V=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(V)}}},[i]);let R=()=>{o(!0)},B=()=>{o(!1),d(!1)};return t?n!=="intent"?[c,_,{}]:[c,_,{onFocus:eu(m,R),onBlur:eu(x,B),onMouseEnter:eu(g,R),onMouseLeave:eu(b,B),onTouchStart:eu(w,R)}]:[!1,_,{}]}function eu(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function v5({page:n,...e}){let{router:t}=H1(),i=j.useMemo(()=>I1(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?j.createElement(N5,{page:n,matches:i,...e}):null}function w5(n){let{manifest:e,routeModules:t}=G1(),[i,o]=j.useState([]);return j.useEffect(()=>{let c=!1;return f5(n,e,t).then(d=>{c||o(d)}),()=>{c=!0}},[n,e,t]),i}function N5({page:n,matches:e,...t}){let i=Lr(),{future:o,manifest:c,routeModules:d}=G1(),{basename:m}=H1(),{loaderData:x,matches:g}=b5(),b=j.useMemo(()=>xw(n,e,g,c,i,"data"),[n,e,g,c,i]),w=j.useMemo(()=>xw(n,e,g,c,i,"assets"),[n,e,g,c,i]),_=j.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let V=new Set,U=!1;if(e.forEach(Q=>{let H=c.routes[Q.route.id];!H||!H.hasLoader||(!b.some(re=>re.route.id===Q.route.id)&&Q.route.id in x&&d[Q.route.id]?.shouldRevalidate||H.hasClientLoader?U=!0:V.add(Q.route.id))}),V.size===0)return[];let F=u5(n,m,o.unstable_trailingSlashAwareDataRequests,"data");return U&&V.size>0&&F.searchParams.set("_routes",e.filter(Q=>V.has(Q.route.id)).map(Q=>Q.route.id).join(",")),[F.pathname+F.search]},[m,o.unstable_trailingSlashAwareDataRequests,x,i,c,b,e,n,d]),R=j.useMemo(()=>m5(w,c),[w,c]),B=w5(w);return j.createElement(j.Fragment,null,_.map(V=>j.createElement("link",{key:V,rel:"prefetch",as:"fetch",href:V,...t})),R.map(V=>j.createElement("link",{key:V,rel:"modulepreload",href:V,...t})),B.map(({key:V,link:U})=>j.createElement("link",{key:V,nonce:t.nonce,...U,crossOrigin:U.crossOrigin??t.crossOrigin})))}function j5(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var _5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{_5&&(window.__reactRouterVersion="7.13.0")}catch{}function S5({basename:n,children:e,unstable_useTransitions:t,window:i}){let o=j.useRef();o.current==null&&(o.current=nT({window:i,v5Compat:!0}));let c=o.current,[d,m]=j.useState({action:c.action,location:c.location}),x=j.useCallback(g=>{t===!1?m(g):j.startTransition(()=>m(g))},[t]);return j.useLayoutEffect(()=>c.listen(x),[c,x]),j.createElement(ZT,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:c,unstable_useTransitions:t})}var Y1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,at=j.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:o,reloadDocument:c,replace:d,state:m,target:x,to:g,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:_,...R},B){let{basename:V,unstable_useTransitions:U}=j.useContext(qn),F=typeof g=="string"&&Y1.test(g),Q=P1(g,V);g=Q.to;let H=LT(g,{relative:o}),[re,he,W]=y5(i,R),T=k5(g,{replace:d,state:m,target:x,preventScrollReset:b,relative:o,viewTransition:w,unstable_defaultShouldRevalidate:_,unstable_useTransitions:U});function E(I){e&&e(I),I.defaultPrevented||T(I)}let S=j.createElement("a",{...R,...W,href:Q.absoluteURL||H,onClick:Q.isExternal||c?e:E,ref:j5(B,he),target:x,"data-discover":!F&&t==="render"?"true":void 0});return re&&!F?j.createElement(j.Fragment,null,S,j.createElement(v5,{page:H})):S});at.displayName="Link";var E5=j.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:o=!1,style:c,to:d,viewTransition:m,children:x,...g},b){let w=Uu(d,{relative:g.relative}),_=Lr(),R=j.useContext(Rf),{navigator:B,basename:V}=j.useContext(qn),U=R!=null&&M5(w)&&m===!0,F=B.encodeLocation?B.encodeLocation(w).pathname:w.pathname,Q=_.pathname,H=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;t||(Q=Q.toLowerCase(),H=H?H.toLowerCase():null,F=F.toLowerCase()),H&&V&&(H=Cr(H,V)||H);const re=F!=="/"&&F.endsWith("/")?F.length-1:F.length;let he=Q===F||!o&&Q.startsWith(F)&&Q.charAt(re)==="/",W=H!=null&&(H===F||!o&&H.startsWith(F)&&H.charAt(F.length)==="/"),T={isActive:he,isPending:W,isTransitioning:U},E=he?e:void 0,S;typeof i=="function"?S=i(T):S=[i,he?"active":null,W?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let I=typeof c=="function"?c(T):c;return j.createElement(at,{...g,"aria-current":E,className:S,ref:b,style:I,to:d,viewTransition:m},typeof x=="function"?x(T):x)});E5.displayName="NavLink";var T5=j.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:o,state:c,method:d=Oh,action:m,onSubmit:x,relative:g,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:_,...R},B)=>{let{unstable_useTransitions:V}=j.useContext(qn),U=I5(),F=D5(m,{relative:g}),Q=d.toLowerCase()==="get"?"get":"post",H=typeof m=="string"&&Y1.test(m),re=he=>{if(x&&x(he),he.defaultPrevented)return;he.preventDefault();let W=he.nativeEvent.submitter,T=W?.getAttribute("formmethod")||d,E=()=>U(W||he.currentTarget,{fetcherKey:e,method:T,navigate:t,replace:o,state:c,relative:g,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:_});V&&t!==!1?j.startTransition(()=>E()):E()};return j.createElement("form",{ref:B,method:Q,action:F,onSubmit:i?x:re,...R,"data-discover":!H&&n==="render"?"true":void 0})});T5.displayName="Form";function A5(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function W1(n){let e=j.useContext(Go);return ds(e,A5(n)),e}function k5(n,{target:e,replace:t,state:i,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:m,unstable_useTransitions:x}={}){let g=Oi(),b=Lr(),w=Uu(n,{relative:c});return j.useCallback(_=>{if(r5(_,e)){_.preventDefault();let R=t!==void 0?t:_u(b)===_u(w),B=()=>g(n,{replace:R,state:i,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:m});x?j.startTransition(()=>B()):B()}},[b,g,w,t,i,e,n,o,c,d,m,x])}function Q1(n){$n(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=j.useRef(O0(n)),t=j.useRef(!1),i=Lr(),o=j.useMemo(()=>i5(i.search,t.current?null:e.current),[i.search]),c=Oi(),d=j.useCallback((m,x)=>{const g=O0(typeof m=="function"?m(new URLSearchParams(o)):m);t.current=!0,c("?"+g,x)},[c,o]);return[o,d]}var C5=0,R5=()=>`__${String(++C5)}__`;function I5(){let{router:n}=W1("useSubmit"),{basename:e}=j.useContext(qn),t=WT(),i=n.fetch,o=n.navigate;return j.useCallback(async(c,d={})=>{let{action:m,method:x,encType:g,formData:b,body:w}=c5(c,e);if(d.navigate===!1){let _=d.fetcherKey||R5();await i(_,t,d.action||m,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:w,formMethod:d.method||x,formEncType:d.encType||g,flushSync:d.flushSync})}else await o(d.action||m,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:w,formMethod:d.method||x,formEncType:d.encType||g,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,o,e,t])}function D5(n,{relative:e}={}){let{basename:t}=j.useContext(qn),i=j.useContext(Ea);ds(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),c={...Uu(n||".",{relative:e})},d=Lr();if(n==null){c.search=d.search;let m=new URLSearchParams(c.search),x=m.getAll("index");if(x.some(b=>b==="")){m.delete("index"),x.filter(w=>w).forEach(w=>m.append("index",w));let b=m.toString();c.search=b?`?${b}`:""}}return(!n||n===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(c.pathname=c.pathname==="/"?t:Er([t,c.pathname])),_u(c)}function M5(n,{relative:e}={}){let t=j.useContext(V1);ds(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=W1("useViewTransitionState"),o=Uu(n,{relative:e});if(!t.isTransitioning)return!1;let c=Cr(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=Cr(t.nextLocation.pathname,i)||t.nextLocation.pathname;return ef(o.pathname,d)!=null||ef(o.pathname,c)!=null}const O5=()=>{};var gw={};const K1=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},P5=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[i++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],m=n[t++],x=((o&7)<<18|(c&63)<<12|(d&63)<<6|m&63)-65536;e[i++]=String.fromCharCode(55296+(x>>10)),e[i++]=String.fromCharCode(56320+(x&1023))}else{const c=n[t++],d=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},X1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,m=d?n[o+1]:0,x=o+2<n.length,g=x?n[o+2]:0,b=c>>2,w=(c&3)<<4|m>>4;let _=(m&15)<<2|g>>6,R=g&63;x||(R=64,d||(_=64)),i.push(t[b],t[w],t[_],t[R])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(K1(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):P5(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],m=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const w=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||m==null||g==null||w==null)throw new L5;const _=c<<2|m>>4;if(i.push(_),g!==64){const R=m<<4&240|g>>2;if(i.push(R),w!==64){const B=g<<6&192|w;i.push(B)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class L5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const V5=function(n){const e=K1(n);return X1.encodeByteArray(e,!0)},tf=function(n){return V5(n).replace(/\./g,"")},J1=function(n){try{return X1.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function U5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const B5=()=>U5().__FIREBASE_DEFAULTS__,z5=()=>{if(typeof process>"u"||typeof gw>"u")return;const n=gw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},F5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&J1(n[1]);return e&&JSON.parse(e)},Df=()=>{try{return O5()||B5()||z5()||F5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Z1=n=>Df()?.emulatorHosts?.[n],kx=n=>{const e=Z1(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},ej=()=>Df()?.config,tj=n=>Df()?.[`_${n}`];class $5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function sr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Mf(n){return(await fetch(n,{credentials:"include"})).ok}function sj(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}},...n};return[tf(JSON.stringify(t)),tf(JSON.stringify(d)),""].join(".")}const pu={};function q5(){const n={prod:[],emulator:[]};for(const e of Object.keys(pu))pu[e]?n.emulator.push(e):n.prod.push(e);return n}function H5(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let bw=!1;function Of(n,e){if(typeof window>"u"||typeof document>"u"||!sr(window.location.host)||pu[n]===e||pu[n]||bw)return;pu[n]=e;function t(_){return`__firebase__banner__${_}`}const i="__firebase__banner",c=q5().prod.length>0;function d(){const _=document.getElementById(i);_&&_.remove()}function m(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function x(_,R){_.setAttribute("width","24"),_.setAttribute("id",R),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function g(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{bw=!0,d()},_}function b(_,R){_.setAttribute("id",R),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function w(){const _=H5(i),R=t("text"),B=document.getElementById(R)||document.createElement("span"),V=t("learnmore"),U=document.getElementById(V)||document.createElement("a"),F=t("preprendIcon"),Q=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const H=_.element;m(H),b(U,V);const re=g();x(Q,F),H.append(Q,B,U,re),document.body.appendChild(H)}c?(B.innerText="Preview backend disconnected.",Q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}function an(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function G5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(an())}function Y5(){const n=Df()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function W5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Q5(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function K5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function X5(){const n=an();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function J5(){return!Y5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Z5(){try{return typeof indexedDB=="object"}catch{return!1}}function eA(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}const tA="FirebaseError";class Ta extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=tA,Object.setPrototypeOf(this,Ta.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Bu.prototype.create)}}class Bu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?sA(c,i):"Error",m=`${this.serviceName}: ${d} (${o}).`;return new Ta(o,m,i)}}function sA(n,e){return n.replace(nA,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const nA=/\{\$([^}]+)}/g;function aA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function yl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const c=n[o],d=e[o];if(yw(c)&&yw(d)){if(!yl(c,d))return!1}else if(c!==d)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function yw(n){return n!==null&&typeof n=="object"}function zu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ou(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,c]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function cu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function rA(n,e){const t=new iA(n,e);return t.subscribe.bind(t)}class iA{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");lA(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=d0),o.error===void 0&&(o.error=d0),o.complete===void 0&&(o.complete=d0);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function lA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function d0(){}function ns(n){return n&&n._delegate?n._delegate:n}class Rr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ml="[DEFAULT]";class oA{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new $5;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(uA(e))try{this.getOrInitializeService({instanceIdentifier:ml})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});i.resolve(c)}catch{}}}}clearInstance(e=ml){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ml){return this.instances.has(e)}getOptions(e=ml){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[c,d]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(c);i===m&&d.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const c=this.instances.get(i);return c&&e(c,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:cA(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ml){return this.component?this.component.multipleInstances?e:ml:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function cA(n){return n===ml?void 0:n}function uA(n){return n.instantiationMode==="EAGER"}class dA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new oA(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var jt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(jt||(jt={}));const hA={debug:jt.DEBUG,verbose:jt.VERBOSE,info:jt.INFO,warn:jt.WARN,error:jt.ERROR,silent:jt.SILENT},fA=jt.INFO,mA={[jt.DEBUG]:"log",[jt.VERBOSE]:"log",[jt.INFO]:"info",[jt.WARN]:"warn",[jt.ERROR]:"error"},pA=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=mA[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Cx{constructor(e){this.name=e,this._logLevel=fA,this._logHandler=pA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in jt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,jt.DEBUG,...e),this._logHandler(this,jt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,jt.VERBOSE,...e),this._logHandler(this,jt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,jt.INFO,...e),this._logHandler(this,jt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,jt.WARN,...e),this._logHandler(this,jt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,jt.ERROR,...e),this._logHandler(this,jt.ERROR,...e)}}const xA=(n,e)=>e.some(t=>n instanceof t);let vw,ww;function gA(){return vw||(vw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bA(){return ww||(ww=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nj=new WeakMap,P0=new WeakMap,aj=new WeakMap,h0=new WeakMap,Rx=new WeakMap;function yA(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(ji(n.result)),o()},d=()=>{i(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&nj.set(t,n)}).catch(()=>{}),Rx.set(e,n),e}function vA(n){if(P0.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});P0.set(n,e)}let L0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return P0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||aj.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ji(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function wA(n){L0=n(L0)}function NA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(f0(this),e,...t);return aj.set(i,e.sort?e.sort():[e]),ji(i)}:bA().includes(n)?function(...e){return n.apply(f0(this),e),ji(nj.get(this))}:function(...e){return ji(n.apply(f0(this),e))}}function jA(n){return typeof n=="function"?NA(n):(n instanceof IDBTransaction&&vA(n),xA(n,gA())?new Proxy(n,L0):n)}function ji(n){if(n instanceof IDBRequest)return yA(n);if(h0.has(n))return h0.get(n);const e=jA(n);return e!==n&&(h0.set(n,e),Rx.set(e,n)),e}const f0=n=>Rx.get(n);function _A(n,e,{blocked:t,upgrade:i,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),m=ji(d);return i&&d.addEventListener("upgradeneeded",x=>{i(ji(d.result),x.oldVersion,x.newVersion,ji(d.transaction),x)}),t&&d.addEventListener("blocked",x=>t(x.oldVersion,x.newVersion,x)),m.then(x=>{c&&x.addEventListener("close",()=>c()),o&&x.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),m}const SA=["get","getKey","getAll","getAllKeys","count"],EA=["put","add","delete","clear"],m0=new Map;function Nw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(m0.get(e))return m0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=EA.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||SA.includes(t)))return;const c=async function(d,...m){const x=this.transaction(d,o?"readwrite":"readonly");let g=x.store;return i&&(g=g.index(m.shift())),(await Promise.all([g[t](...m),o&&x.done]))[0]};return m0.set(e,c),c}wA(n=>({...n,get:(e,t,i)=>Nw(e,t)||n.get(e,t,i),has:(e,t)=>!!Nw(e,t)||n.has(e,t)}));class TA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(AA(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function AA(n){return n.getComponent()?.type==="VERSION"}const V0="@firebase/app",jw="0.14.7";const Ir=new Cx("@firebase/app"),kA="@firebase/app-compat",CA="@firebase/analytics-compat",RA="@firebase/analytics",IA="@firebase/app-check-compat",DA="@firebase/app-check",MA="@firebase/auth",OA="@firebase/auth-compat",PA="@firebase/database",LA="@firebase/data-connect",VA="@firebase/database-compat",UA="@firebase/functions",BA="@firebase/functions-compat",zA="@firebase/installations",FA="@firebase/installations-compat",$A="@firebase/messaging",qA="@firebase/messaging-compat",HA="@firebase/performance",GA="@firebase/performance-compat",YA="@firebase/remote-config",WA="@firebase/remote-config-compat",QA="@firebase/storage",KA="@firebase/storage-compat",XA="@firebase/firestore",JA="@firebase/ai",ZA="@firebase/firestore-compat",ek="firebase",tk="12.8.0";const U0="[DEFAULT]",sk={[V0]:"fire-core",[kA]:"fire-core-compat",[RA]:"fire-analytics",[CA]:"fire-analytics-compat",[DA]:"fire-app-check",[IA]:"fire-app-check-compat",[MA]:"fire-auth",[OA]:"fire-auth-compat",[PA]:"fire-rtdb",[LA]:"fire-data-connect",[VA]:"fire-rtdb-compat",[UA]:"fire-fn",[BA]:"fire-fn-compat",[zA]:"fire-iid",[FA]:"fire-iid-compat",[$A]:"fire-fcm",[qA]:"fire-fcm-compat",[HA]:"fire-perf",[GA]:"fire-perf-compat",[YA]:"fire-rc",[WA]:"fire-rc-compat",[QA]:"fire-gcs",[KA]:"fire-gcs-compat",[XA]:"fire-fst",[ZA]:"fire-fst-compat",[JA]:"fire-vertex","fire-js":"fire-js",[ek]:"fire-js-all"};const sf=new Map,nk=new Map,B0=new Map;function _w(n,e){try{n.container.addComponent(e)}catch(t){Ir.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ai(n){const e=n.name;if(B0.has(e))return Ir.debug(`There were multiple attempts to register component ${e}.`),!1;B0.set(e,n);for(const t of sf.values())_w(t,n);for(const t of nk.values())_w(t,n);return!0}function Fu(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function wn(n){return n==null?!1:n.settings!==void 0}const ak={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_i=new Bu("app","Firebase",ak);class rk{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Rr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _i.create("app-deleted",{appName:this._name})}}const Tl=tk;function rj(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:U0,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw _i.create("bad-app-name",{appName:String(o)});if(t||(t=ej()),!t)throw _i.create("no-options");const c=sf.get(o);if(c){if(yl(t,c.options)&&yl(i,c.config))return c;throw _i.create("duplicate-app",{appName:o})}const d=new dA(o);for(const x of B0.values())d.addComponent(x);const m=new rk(t,i,d);return sf.set(o,m),m}function Pf(n=U0){const e=sf.get(n);if(!e&&n===U0&&ej())return rj();if(!e)throw _i.create("no-app",{appName:n});return e}function la(n,e,t){let i=sk[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const d=[`Unable to register library "${i}" with version "${e}":`];o&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ir.warn(d.join(" "));return}Ai(new Rr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const ik="firebase-heartbeat-database",lk=1,Su="firebase-heartbeat-store";let p0=null;function ij(){return p0||(p0=_A(ik,lk,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Su)}catch(t){console.warn(t)}}}}).catch(n=>{throw _i.create("idb-open",{originalErrorMessage:n.message})})),p0}async function ok(n){try{const t=(await ij()).transaction(Su),i=await t.objectStore(Su).get(lj(n));return await t.done,i}catch(e){if(e instanceof Ta)Ir.warn(e.message);else{const t=_i.create("idb-get",{originalErrorMessage:e?.message});Ir.warn(t.message)}}}async function Sw(n,e){try{const i=(await ij()).transaction(Su,"readwrite");await i.objectStore(Su).put(e,lj(n)),await i.done}catch(t){if(t instanceof Ta)Ir.warn(t.message);else{const i=_i.create("idb-set",{originalErrorMessage:t?.message});Ir.warn(i.message)}}}function lj(n){return`${n.name}!${n.options.appId}`}const ck=1024,uk=30;class dk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new fk(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Ew();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>uk){const o=mk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ir.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ew(),{heartbeatsToSend:t,unsentEntries:i}=hk(this._heartbeatsCache.heartbeats),o=tf(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Ir.warn(e),""}}}function Ew(){return new Date().toISOString().substring(0,10)}function hk(n,e=ck){const t=[];let i=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),Tw(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Tw(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class fk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Z5()?eA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await ok(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Sw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Sw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Tw(n){return tf(JSON.stringify({version:2,heartbeats:n})).length}function mk(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function pk(n){Ai(new Rr("platform-logger",e=>new TA(e),"PRIVATE")),Ai(new Rr("heartbeat",e=>new dk(e),"PRIVATE")),la(V0,jw,n),la(V0,jw,"esm2020"),la("fire-js","")}pk("");function oj(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xk=oj,cj=new Bu("auth","Firebase",oj());const nf=new Cx("@firebase/auth");function gk(n,...e){nf.logLevel<=jt.WARN&&nf.warn(`Auth (${Tl}): ${n}`,...e)}function Lh(n,...e){nf.logLevel<=jt.ERROR&&nf.error(`Auth (${Tl}): ${n}`,...e)}function ja(n,...e){throw Ix(n,...e)}function Wa(n,...e){return Ix(n,...e)}function uj(n,e,t){const i={...xk(),[e]:t};return new Bu("auth","Firebase",i).create(e,{appName:n.name})}function Tr(n){return uj(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ix(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return cj.create(n,...e)}function nt(n,e,...t){if(!n)throw Ix(e,...t)}function jr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Lh(e),new Error(e)}function Dr(n,e){n||jr(e)}function z0(){return typeof self<"u"&&self.location?.href||""}function bk(){return Aw()==="http:"||Aw()==="https:"}function Aw(){return typeof self<"u"&&self.location?.protocol||null}function yk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(bk()||Q5()||"connection"in navigator)?navigator.onLine:!0}function vk(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class $u{constructor(e,t){this.shortDelay=e,this.longDelay=t,Dr(t>e,"Short delay should be less than long delay!"),this.isMobile=G5()||K5()}get(){return yk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Dx(n,e){Dr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class dj{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;jr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;jr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;jr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const wk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Nk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],jk=new $u(3e4,6e4);function Pi(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Li(n,e,t,i,o={}){return hj(n,o,async()=>{let c={},d={};i&&(e==="GET"?d=i:c={body:JSON.stringify(i)});const m=zu({key:n.config.apiKey,...d}).slice(1),x=await n._getAdditionalHeaders();x["Content-Type"]="application/json",n.languageCode&&(x["X-Firebase-Locale"]=n.languageCode);const g={method:e,headers:x,...c};return W5()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&sr(n.emulatorConfig.host)&&(g.credentials="include"),dj.fetch()(await fj(n,n.config.apiHost,t,m),g)})}async function hj(n,e,t){n._canInitEmulator=!1;const i={...wk,...e};try{const o=new Sk(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw wh(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const m=c.ok?d.errorMessage:d.error.message,[x,g]=m.split(" : ");if(x==="FEDERATED_USER_ID_ALREADY_LINKED")throw wh(n,"credential-already-in-use",d);if(x==="EMAIL_EXISTS")throw wh(n,"email-already-in-use",d);if(x==="USER_DISABLED")throw wh(n,"user-disabled",d);const b=i[x]||x.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw uj(n,b,g);ja(n,b)}}catch(o){if(o instanceof Ta)throw o;ja(n,"network-request-failed",{message:String(o)})}}async function qu(n,e,t,i,o={}){const c=await Li(n,e,t,i,o);return"mfaPendingCredential"in c&&ja(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function fj(n,e,t,i){const o=`${e}${t}?${i}`,c=n,d=c.config.emulator?Dx(n.config,o):`${n.config.apiScheme}://${o}`;return Nk.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function _k(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Sk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Wa(this.auth,"network-request-failed")),jk.get())})}}function wh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=Wa(n,e,i);return o.customData._tokenResponse=t,o}function kw(n){return n!==void 0&&n.enterprise!==void 0}class Ek{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return _k(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Tk(n,e){return Li(n,"GET","/v2/recaptchaConfig",Pi(n,e))}async function Ak(n,e){return Li(n,"POST","/v1/accounts:delete",e)}async function af(n,e){return Li(n,"POST","/v1/accounts:lookup",e)}function xu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function kk(n,e=!1){const t=ns(n),i=await t.getIdToken(e),o=Mx(i);nt(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:i,authTime:xu(x0(o.auth_time)),issuedAtTime:xu(x0(o.iat)),expirationTime:xu(x0(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function x0(n){return Number(n)*1e3}function Mx(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Lh("JWT malformed, contained fewer than 3 sections"),null;try{const o=J1(t);return o?JSON.parse(o):(Lh("Failed to decode base64 JWT payload"),null)}catch(o){return Lh("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Cw(n){const e=Mx(n);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Eu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Ta&&Ck(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Ck({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Rk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class F0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=xu(this.lastLoginAt),this.creationTime=xu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function rf(n){const e=n.auth,t=await n.getIdToken(),i=await Eu(n,af(e,{idToken:t}));nt(i?.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const c=o.providerUserInfo?.length?mj(o.providerUserInfo):[],d=Dk(n.providerData,c),m=n.isAnonymous,x=!(n.email&&o.passwordHash)&&!d?.length,g=m?x:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new F0(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(n,b)}async function Ik(n){const e=ns(n);await rf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Dk(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function mj(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function Mk(n,e){const t=await hj(n,{},async()=>{const i=zu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await fj(n,o,"/v1/token",`key=${c}`),m=await n._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const x={method:"POST",headers:m,body:i};return n.emulatorConfig&&sr(n.emulatorConfig.host)&&(x.credentials="include"),dj.fetch()(d,x)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Ok(n,e){return Li(n,"POST","/v2/accounts:revokeToken",Pi(n,e))}class To{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Cw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const t=Cw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:c}=await Mk(e,t);this.updateTokensAndExpiration(i,o,Number(c))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:c}=t,d=new To;return i&&(nt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),o&&(nt(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(nt(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new To,this.toJSON())}_performRefresh(){return jr("not implemented")}}function pi(n,e){nt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ga{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new Rk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new F0(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Eu(this,this.stsTokenManager.getToken(this.auth,e));return nt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return kk(this,e)}reload(){return Ik(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ga({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await rf(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wn(this.auth.app))return Promise.reject(Tr(this.auth));const e=await this.getIdToken();return await Eu(this,Ak(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,c=t.phoneNumber??void 0,d=t.photoURL??void 0,m=t.tenantId??void 0,x=t._redirectEventId??void 0,g=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:w,emailVerified:_,isAnonymous:R,providerData:B,stsTokenManager:V}=t;nt(w&&V,e,"internal-error");const U=To.fromJSON(this.name,V);nt(typeof w=="string",e,"internal-error"),pi(i,e.name),pi(o,e.name),nt(typeof _=="boolean",e,"internal-error"),nt(typeof R=="boolean",e,"internal-error"),pi(c,e.name),pi(d,e.name),pi(m,e.name),pi(x,e.name),pi(g,e.name),pi(b,e.name);const F=new ga({uid:w,auth:e,email:o,emailVerified:_,displayName:i,isAnonymous:R,photoURL:d,phoneNumber:c,tenantId:m,stsTokenManager:U,createdAt:g,lastLoginAt:b});return B&&Array.isArray(B)&&(F.providerData=B.map(Q=>({...Q}))),x&&(F._redirectEventId=x),F}static async _fromIdTokenResponse(e,t,i=!1){const o=new To;o.updateFromServerResponse(t);const c=new ga({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await rf(c),c}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];nt(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?mj(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,m=new To;m.updateFromIdToken(i);const x=new ga({uid:o.localId,auth:e,stsTokenManager:m,isAnonymous:d}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new F0(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(x,g),x}}const Rw=new Map;function _r(n){Dr(n instanceof Function,"Expected a class definition");let e=Rw.get(n);return e?(Dr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Rw.set(n,e),e)}class pj{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}pj.type="NONE";const Iw=pj;function Vh(n,e,t){return`firebase:${n}:${e}:${t}`}class Ao{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:c}=this.auth;this.fullUserKey=Vh(this.userKey,o.apiKey,c),this.fullPersistenceKey=Vh("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await af(this.auth,{idToken:e}).catch(()=>{});return t?ga._fromGetAccountInfoResponse(this.auth,t,e):null}return ga._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Ao(_r(Iw),e,i);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||_r(Iw);const d=Vh(i,e.config.apiKey,e.name);let m=null;for(const g of t)try{const b=await g._get(d);if(b){let w;if(typeof b=="string"){const _=await af(e,{idToken:b}).catch(()=>{});if(!_)break;w=await ga._fromGetAccountInfoResponse(e,_,b)}else w=ga._fromJSON(e,b);g!==c&&(m=w),c=g;break}}catch{}const x=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!x.length?new Ao(c,e,i):(c=x[0],m&&await c._set(d,m.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(d)}catch{}})),new Ao(c,e,i))}}function Dw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(yj(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xj(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(wj(e))return"Blackberry";if(Nj(e))return"Webos";if(gj(e))return"Safari";if((e.includes("chrome/")||bj(e))&&!e.includes("edge/"))return"Chrome";if(vj(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function xj(n=an()){return/firefox\//i.test(n)}function gj(n=an()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bj(n=an()){return/crios\//i.test(n)}function yj(n=an()){return/iemobile/i.test(n)}function vj(n=an()){return/android/i.test(n)}function wj(n=an()){return/blackberry/i.test(n)}function Nj(n=an()){return/webos/i.test(n)}function Ox(n=an()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Pk(n=an()){return Ox(n)&&!!window.navigator?.standalone}function Lk(){return X5()&&document.documentMode===10}function jj(n=an()){return Ox(n)||vj(n)||Nj(n)||wj(n)||/windows phone/i.test(n)||yj(n)}function _j(n,e=[]){let t;switch(n){case"Browser":t=Dw(an());break;case"Worker":t=`${Dw(an())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Tl}/${i}`}class Vk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=c=>new Promise((d,m)=>{try{const x=e(c);d(x)}catch(x){m(x)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function Uk(n,e={}){return Li(n,"GET","/v2/passwordPolicy",Pi(n,e))}const Bk=6;class zk{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Bk,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}class Fk{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Mw(this),this.idTokenSubscription=new Mw(this),this.beforeStateQueue=new Vk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cj,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_r(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ao.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await af(this,{idToken:e}),i=await ga._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(wn(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=this.redirectUser?._redirectEventId,d=i?._redirectEventId,m=await this.tryRedirectSignIn(e);(!c||c===d)&&m?.user&&(i=m.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await rf(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=vk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(wn(this.app))return Promise.reject(Tr(this));const t=e?ns(e):null;return t&&nt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return wn(this.app)?Promise.reject(Tr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return wn(this.app)?Promise.reject(Tr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Uk(this),t=new zk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Bu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await Ok(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&_r(e)||this._popupRedirectResolver;nt(t,this,"argument-error"),this.redirectPersistenceManager=await Ao.create(this,[_r(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(m,this,"internal-error"),m.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const x=e.addObserver(t,i,o);return()=>{d=!0,x()}}else{const x=e.addObserver(t);return()=>{d=!0,x()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_j(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(wn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&gk(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Al(n){return ns(n)}class Mw{constructor(e){this.auth=e,this.observer=null,this.addObserver=rA(t=>this.observer=t)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Lf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $k(n){Lf=n}function Sj(n){return Lf.loadJS(n)}function qk(){return Lf.recaptchaEnterpriseScript}function Hk(){return Lf.gapiScript}function Gk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Yk{constructor(){this.enterprise=new Wk}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Wk{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Qk="recaptcha-enterprise",Ej="NO_RECAPTCHA";class Kk{constructor(e){this.type=Qk,this.auth=Al(e)}async verify(e="verify",t=!1){async function i(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,m)=>{Tk(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(x=>{if(x.recaptchaKey===void 0)m(new Error("recaptcha Enterprise site key undefined"));else{const g=new Ek(x);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,d(g.siteKey)}}).catch(x=>{m(x)})})}function o(c,d,m){const x=window.grecaptcha;kw(x)?x.enterprise.ready(()=>{x.enterprise.execute(c,{action:e}).then(g=>{d(g)}).catch(()=>{d(Ej)})}):m(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Yk().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{i(this.auth).then(m=>{if(!t&&kw(window.grecaptcha))o(m,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let x=qk();x.length!==0&&(x+=m),Sj(x).then(()=>{o(m,c,d)}).catch(g=>{d(g)})}}).catch(m=>{d(m)})})}}async function Ow(n,e,t,i=!1,o=!1){const c=new Kk(n);let d;if(o)d=Ej;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const m={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in m){const x=m.phoneEnrollmentInfo.phoneNumber,g=m.phoneEnrollmentInfo.recaptchaToken;Object.assign(m,{phoneEnrollmentInfo:{phoneNumber:x,recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in m){const x=m.phoneSignInInfo.recaptchaToken;Object.assign(m,{phoneSignInInfo:{recaptchaToken:x,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return m}return i?Object.assign(m,{captchaResp:d}):Object.assign(m,{captchaResponse:d}),Object.assign(m,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(m,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),m}async function $0(n,e,t,i,o){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Ow(n,e,t,t==="getOobCode");return i(n,c)}else return i(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Ow(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(c)})}function Xk(n,e){const t=Fu(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(yl(c,e??{}))return o;ja(o,"already-initialized")}return t.initialize({options:e})}function Jk(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(_r);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function Zk(n,e,t){const i=Al(n);nt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,c=Tj(e),{host:d,port:m}=eC(e),x=m===null?"":`:${m}`,g={url:`${c}//${d}${x}/`},b=Object.freeze({host:d,port:m,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){nt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),nt(yl(g,i.config.emulator)&&yl(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,sr(d)?(Mf(`${c}//${d}${x}`),Of("Auth",!0)):tC()}function Tj(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function eC(n){const e=Tj(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const c=o[1];return{host:c,port:Pw(i.substr(c.length+1))}}else{const[c,d]=i.split(":");return{host:c,port:Pw(d)}}}function Pw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function tC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Px{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return jr("not implemented")}_getIdTokenResponse(e){return jr("not implemented")}_linkToIdToken(e,t){return jr("not implemented")}_getReauthenticationResolver(e){return jr("not implemented")}}async function sC(n,e){return Li(n,"POST","/v1/accounts:signUp",e)}async function nC(n,e){return qu(n,"POST","/v1/accounts:signInWithPassword",Pi(n,e))}async function aC(n,e){return qu(n,"POST","/v1/accounts:signInWithEmailLink",Pi(n,e))}async function rC(n,e){return qu(n,"POST","/v1/accounts:signInWithEmailLink",Pi(n,e))}class Tu extends Px{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Tu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Tu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $0(e,t,"signInWithPassword",nC);case"emailLink":return aC(e,{email:this._email,oobCode:this._password});default:ja(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $0(e,i,"signUpPassword",sC);case"emailLink":return rC(e,{idToken:t,email:this._email,oobCode:this._password});default:ja(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ko(n,e){return qu(n,"POST","/v1/accounts:signInWithIdp",Pi(n,e))}const iC="http://localhost";class vl extends Px{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new vl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ja("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...c}=t;if(!i||!o)return null;const d=new vl(i,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return ko(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ko(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ko(e,t)}buildRequest(){const e={requestUri:iC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=zu(t)}return e}}function lC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function oC(n){const e=ou(cu(n)).link,t=e?ou(cu(e)).deep_link_id:null,i=ou(cu(n)).deep_link_id;return(i?ou(cu(i)).link:null)||i||t||e||n}class Lx{constructor(e){const t=ou(cu(e)),i=t.apiKey??null,o=t.oobCode??null,c=lC(t.mode??null);nt(i&&o&&c,"argument-error"),this.apiKey=i,this.operation=c,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=oC(e);try{return new Lx(t)}catch{return null}}}class Qo{constructor(){this.providerId=Qo.PROVIDER_ID}static credential(e,t){return Tu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Lx.parseLink(t);return nt(i,"argument-error"),Tu._fromEmailAndCode(e,i.code,i.tenantId)}}Qo.PROVIDER_ID="password";Qo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Qo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Aj{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Hu extends Aj{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class gi extends Hu{constructor(){super("facebook.com")}static credential(e){return vl._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return gi.credential(e.oauthAccessToken)}catch{return null}}}gi.FACEBOOK_SIGN_IN_METHOD="facebook.com";gi.PROVIDER_ID="facebook.com";class bi extends Hu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return vl._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return bi.credential(t,i)}catch{return null}}}bi.GOOGLE_SIGN_IN_METHOD="google.com";bi.PROVIDER_ID="google.com";class yi extends Hu{constructor(){super("github.com")}static credential(e){return vl._fromParams({providerId:yi.PROVIDER_ID,signInMethod:yi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yi.credentialFromTaggedObject(e)}static credentialFromError(e){return yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yi.credential(e.oauthAccessToken)}catch{return null}}}yi.GITHUB_SIGN_IN_METHOD="github.com";yi.PROVIDER_ID="github.com";class vi extends Hu{constructor(){super("twitter.com")}static credential(e,t){return vl._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return vi.credential(t,i)}catch{return null}}}vi.TWITTER_SIGN_IN_METHOD="twitter.com";vi.PROVIDER_ID="twitter.com";async function cC(n,e){return qu(n,"POST","/v1/accounts:signUp",Pi(n,e))}class wl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const c=await ga._fromIdTokenResponse(e,i,o),d=Lw(i);return new wl({user:c,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=Lw(i);return new wl({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function Lw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class lf extends Ta{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,lf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new lf(e,t,i,o)}}function kj(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?lf._fromErrorAndOperation(n,c,e,i):c})}async function uC(n,e,t=!1){const i=await Eu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wl._forOperation(n,"link",i)}async function dC(n,e,t=!1){const{auth:i}=n;if(wn(i.app))return Promise.reject(Tr(i));const o="reauthenticate";try{const c=await Eu(n,kj(i,o,e,n),t);nt(c.idToken,i,"internal-error");const d=Mx(c.idToken);nt(d,i,"internal-error");const{sub:m}=d;return nt(n.uid===m,i,"user-mismatch"),wl._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&ja(i,"user-mismatch"),c}}async function Cj(n,e,t=!1){if(wn(n.app))return Promise.reject(Tr(n));const i="signIn",o=await kj(n,i,e),c=await wl._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(c.user),c}async function hC(n,e){return Cj(Al(n),e)}async function Rj(n){const e=Al(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function fC(n,e,t){if(wn(n.app))return Promise.reject(Tr(n));const i=Al(n),d=await $0(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cC).catch(x=>{throw x.code==="auth/password-does-not-meet-requirements"&&Rj(n),x}),m=await wl._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(m.user),m}function Vx(n,e,t){return wn(n.app)?Promise.reject(Tr(n)):hC(ns(n),Qo.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Rj(n),i})}function mC(n,e,t,i){return ns(n).onIdTokenChanged(e,t,i)}function pC(n,e,t){return ns(n).beforeAuthStateChanged(e,t)}function xC(n,e,t,i){return ns(n).onAuthStateChanged(e,t,i)}function of(n){return ns(n).signOut()}const cf="__sak";class Ij{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(cf,"1"),this.storage.removeItem(cf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const gC=1e3,bC=10;class Dj extends Ij{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jj(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,m,x)=>{this.notifyListeners(d,x)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},c=this.storage.getItem(i);Lk()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,bC):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},gC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Dj.type="LOCAL";const yC=Dj;class Mj extends Ij{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Mj.type="SESSION";const Oj=Mj;function vC(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Vf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Vf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const m=Array.from(d).map(async g=>g(t.origin,c)),x=await vC(m);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:x})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Vf.receivers=[];function Ux(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class wC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((m,x)=>{const g=Ux("",20);o.port1.start();const b=setTimeout(()=>{x(new Error("unsupported_event"))},i);d={messageChannel:o,onMessage(w){const _=w;if(_.data.eventId===g)switch(_.data.status){case"ack":clearTimeout(b),c=setTimeout(()=>{x(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),m(_.data.response);break;default:clearTimeout(b),clearTimeout(c),x(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Qa(){return window}function NC(n){Qa().location.href=n}function Pj(){return typeof Qa().WorkerGlobalScope<"u"&&typeof Qa().importScripts=="function"}async function jC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _C(){return navigator?.serviceWorker?.controller||null}function SC(){return Pj()?self:null}const Lj="firebaseLocalStorageDb",EC=1,uf="firebaseLocalStorage",Vj="fbase_key";class Gu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Uf(n,e){return n.transaction([uf],e?"readwrite":"readonly").objectStore(uf)}function TC(){const n=indexedDB.deleteDatabase(Lj);return new Gu(n).toPromise()}function q0(){const n=indexedDB.open(Lj,EC);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(uf,{keyPath:Vj})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(uf)?e(i):(i.close(),await TC(),e(await q0()))})})}async function Vw(n,e,t){const i=Uf(n,!0).put({[Vj]:e,value:t});return new Gu(i).toPromise()}async function AC(n,e){const t=Uf(n,!1).get(e),i=await new Gu(t).toPromise();return i===void 0?null:i.value}function Uw(n,e){const t=Uf(n,!0).delete(e);return new Gu(t).toPromise()}const kC=800,CC=3;class Uj{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await q0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>CC)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Pj()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vf._getInstance(SC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await jC(),!this.activeServiceWorker)return;this.sender=new wC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_C()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await q0();return await Vw(e,cf,"1"),await Uw(e,cf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Vw(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>AC(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Uw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Uf(o,!1).getAll();return new Gu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),kC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Uj.type="LOCAL";const RC=Uj;new $u(3e4,6e4);function IC(n,e){return e?_r(e):(nt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Bx extends Px{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ko(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ko(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ko(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function DC(n){return Cj(n.auth,new Bx(n),n.bypassAuthState)}function MC(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),dC(t,new Bx(n),n.bypassAuthState)}async function OC(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),uC(t,new Bx(n),n.bypassAuthState)}class Bj{constructor(e,t,i,o,c=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:c,error:d,type:m}=e;if(d){this.reject(d);return}const x={auth:this.auth,requestUri:t,sessionId:i,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(x))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return DC;case"linkViaPopup":case"linkViaRedirect":return OC;case"reauthViaPopup":case"reauthViaRedirect":return MC;default:ja(this.auth,"internal-error")}}resolve(e){Dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const PC=new $u(2e3,1e4);class So extends Bj{constructor(e,t,i,o,c){super(e,t,o,c),this.provider=i,this.authWindow=null,this.pollId=null,So.currentPopupAction&&So.currentPopupAction.cancel(),So.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){Dr(this.filter.length===1,"Popup operations only handle one event");const e=Ux();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Wa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Wa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,So.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PC.get())};e()}}So.currentPopupAction=null;const LC="pendingRedirect",Uh=new Map;class VC extends Bj{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Uh.get(this.auth._key());if(!e){try{const i=await UC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Uh.set(this.auth._key(),e)}return this.bypassAuthState||Uh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function UC(n,e){const t=FC(e),i=zC(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function BC(n,e){Uh.set(n._key(),e)}function zC(n){return _r(n._redirectPersistence)}function FC(n){return Vh(LC,n.config.apiKey,n.name)}async function $C(n,e,t=!1){if(wn(n.app))return Promise.reject(Tr(n));const i=Al(n),o=IC(i,e),d=await new VC(i,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const qC=600*1e3;class HC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!GC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!zj(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Wa(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qC&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bw(e))}saveEventToCache(e){this.cachedEventUids.add(Bw(e)),this.lastProcessedEventTime=Date.now()}}function Bw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function zj({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function GC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zj(n);default:return!1}}async function YC(n,e={}){return Li(n,"GET","/v1/projects",e)}const WC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,QC=/^https?/;async function KC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await YC(n);for(const t of e)try{if(XC(t))return}catch{}ja(n,"unauthorized-domain")}function XC(n){const e=z0(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!QC.test(t))return!1;if(WC.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}const JC=new $u(3e4,6e4);function zw(){const n=Qa().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function ZC(n){return new Promise((e,t)=>{function i(){zw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zw(),t(Wa(n,"network-request-failed"))},timeout:JC.get()})}if(Qa().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Qa().gapi?.load)i();else{const o=Gk("iframefcb");return Qa()[o]=()=>{gapi.load?i():t(Wa(n,"network-request-failed"))},Sj(`${Hk()}?onload=${o}`).catch(c=>t(c))}}).catch(e=>{throw Bh=null,e})}let Bh=null;function e4(n){return Bh=Bh||ZC(n),Bh}const t4=new $u(5e3,15e3),s4="__/auth/iframe",n4="emulator/auth/iframe",a4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},r4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function i4(n){const e=n.config;nt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Dx(e,n4):`https://${n.config.authDomain}/${s4}`,i={apiKey:e.apiKey,appName:n.name,v:Tl},o=r4.get(n.config.apiHost);o&&(i.eid=o);const c=n._getFrameworks();return c.length&&(i.fw=c.join(",")),`${t}?${zu(i).slice(1)}`}async function l4(n){const e=await e4(n),t=Qa().gapi;return nt(t,n,"internal-error"),e.open({where:document.body,url:i4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:a4,dontclear:!0},i=>new Promise(async(o,c)=>{await i.restyle({setHideOnLeave:!1});const d=Wa(n,"network-request-failed"),m=Qa().setTimeout(()=>{c(d)},t4.get());function x(){Qa().clearTimeout(m),o(i)}i.ping(x).then(x,()=>{c(d)})}))}const o4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},c4=500,u4=600,d4="_blank",h4="http://localhost";class Fw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function f4(n,e,t,i=c4,o=u4){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let m="";const x={...o4,width:i.toString(),height:o.toString(),top:c,left:d},g=an().toLowerCase();t&&(m=bj(g)?d4:t),xj(g)&&(e=e||h4,x.scrollbars="yes");const b=Object.entries(x).reduce((_,[R,B])=>`${_}${R}=${B},`,"");if(Pk(g)&&m!=="_self")return m4(e||"",m),new Fw(null);const w=window.open(e||"",m,b);nt(w,n,"popup-blocked");try{w.focus()}catch{}return new Fw(w)}function m4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const p4="__/auth/handler",x4="emulator/auth/handler",g4=encodeURIComponent("fac");async function $w(n,e,t,i,o,c){nt(n.config.authDomain,n,"auth-domain-config-required"),nt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Tl,eventId:o};if(e instanceof Aj){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",aA(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,w]of Object.entries({}))d[b]=w}if(e instanceof Hu){const b=e.getScopes().filter(w=>w!=="");b.length>0&&(d.scopes=b.join(","))}n.tenantId&&(d.tid=n.tenantId);const m=d;for(const b of Object.keys(m))m[b]===void 0&&delete m[b];const x=await n._getAppCheckToken(),g=x?`#${g4}=${encodeURIComponent(x)}`:"";return`${b4(n)}?${zu(m).slice(1)}${g}`}function b4({config:n}){return n.emulator?Dx(n,x4):`https://${n.authDomain}/${p4}`}const g0="webStorageSupport";class y4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Oj,this._completeRedirectFn=$C,this._overrideRedirectResult=BC}async _openPopup(e,t,i,o){Dr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const c=await $w(e,t,i,z0(),o);return f4(e,c,Ux())}async _openRedirect(e,t,i,o){await this._originValidation(e);const c=await $w(e,t,i,z0(),o);return NC(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Dr(c,"If manager is not set, promise should be"),c)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await l4(e),i=new HC(e);return t.register("authEvent",o=>(nt(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(g0,{type:g0},o=>{const c=o?.[0]?.[g0];c!==void 0&&t(!!c),ja(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=KC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jj()||gj()||Ox()}}const v4=y4;var qw="@firebase/auth",Hw="1.12.0";class w4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function N4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function j4(n){Ai(new Rr("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:m}=i.options;nt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const x={apiKey:d,authDomain:m,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_j(n)},g=new Fk(i,o,c,x);return Jk(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ai(new Rr("auth-internal",e=>{const t=Al(e.getProvider("auth").getImmediate());return(i=>new w4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),la(qw,Hw,N4(n)),la(qw,Hw,"esm2020")}const _4=300,S4=tj("authIdTokenMaxAge")||_4;let Gw=null;const E4=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>S4)return;const o=t?.token;Gw!==o&&(Gw=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function T4(n=Pf()){const e=Fu(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Xk(n,{popupRedirectResolver:v4,persistence:[RC,yC,Oj]}),i=tj("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(i,location.origin);if(location.origin===c.origin){const d=E4(c.toString());pC(t,d,()=>d(t.currentUser)),mC(t,m=>d(m))}}const o=Z1("auth");return o&&Zk(t,`http://${o}`),t}function A4(){return document.getElementsByTagName("head")?.[0]??document}$k({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const c=Wa("internal-error");c.customData=o,t(c)},i.type="text/javascript",i.charset="UTF-8",A4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});j4("Browser");var k4="firebase",C4="12.8.0";la(k4,C4,"app");var Yw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Si,Fj;(function(){var n;function e(T,E){function S(){}S.prototype=E.prototype,T.F=E.prototype,T.prototype=new S,T.prototype.constructor=T,T.D=function(I,k,O){for(var C=Array(arguments.length-2),$=2;$<arguments.length;$++)C[$-2]=arguments[$];return E.prototype[k].apply(I,C)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(T,E,S){S||(S=0);const I=Array(16);if(typeof E=="string")for(var k=0;k<16;++k)I[k]=E.charCodeAt(S++)|E.charCodeAt(S++)<<8|E.charCodeAt(S++)<<16|E.charCodeAt(S++)<<24;else for(k=0;k<16;++k)I[k]=E[S++]|E[S++]<<8|E[S++]<<16|E[S++]<<24;E=T.g[0],S=T.g[1],k=T.g[2];let O=T.g[3],C;C=E+(O^S&(k^O))+I[0]+3614090360&4294967295,E=S+(C<<7&4294967295|C>>>25),C=O+(k^E&(S^k))+I[1]+3905402710&4294967295,O=E+(C<<12&4294967295|C>>>20),C=k+(S^O&(E^S))+I[2]+606105819&4294967295,k=O+(C<<17&4294967295|C>>>15),C=S+(E^k&(O^E))+I[3]+3250441966&4294967295,S=k+(C<<22&4294967295|C>>>10),C=E+(O^S&(k^O))+I[4]+4118548399&4294967295,E=S+(C<<7&4294967295|C>>>25),C=O+(k^E&(S^k))+I[5]+1200080426&4294967295,O=E+(C<<12&4294967295|C>>>20),C=k+(S^O&(E^S))+I[6]+2821735955&4294967295,k=O+(C<<17&4294967295|C>>>15),C=S+(E^k&(O^E))+I[7]+4249261313&4294967295,S=k+(C<<22&4294967295|C>>>10),C=E+(O^S&(k^O))+I[8]+1770035416&4294967295,E=S+(C<<7&4294967295|C>>>25),C=O+(k^E&(S^k))+I[9]+2336552879&4294967295,O=E+(C<<12&4294967295|C>>>20),C=k+(S^O&(E^S))+I[10]+4294925233&4294967295,k=O+(C<<17&4294967295|C>>>15),C=S+(E^k&(O^E))+I[11]+2304563134&4294967295,S=k+(C<<22&4294967295|C>>>10),C=E+(O^S&(k^O))+I[12]+1804603682&4294967295,E=S+(C<<7&4294967295|C>>>25),C=O+(k^E&(S^k))+I[13]+4254626195&4294967295,O=E+(C<<12&4294967295|C>>>20),C=k+(S^O&(E^S))+I[14]+2792965006&4294967295,k=O+(C<<17&4294967295|C>>>15),C=S+(E^k&(O^E))+I[15]+1236535329&4294967295,S=k+(C<<22&4294967295|C>>>10),C=E+(k^O&(S^k))+I[1]+4129170786&4294967295,E=S+(C<<5&4294967295|C>>>27),C=O+(S^k&(E^S))+I[6]+3225465664&4294967295,O=E+(C<<9&4294967295|C>>>23),C=k+(E^S&(O^E))+I[11]+643717713&4294967295,k=O+(C<<14&4294967295|C>>>18),C=S+(O^E&(k^O))+I[0]+3921069994&4294967295,S=k+(C<<20&4294967295|C>>>12),C=E+(k^O&(S^k))+I[5]+3593408605&4294967295,E=S+(C<<5&4294967295|C>>>27),C=O+(S^k&(E^S))+I[10]+38016083&4294967295,O=E+(C<<9&4294967295|C>>>23),C=k+(E^S&(O^E))+I[15]+3634488961&4294967295,k=O+(C<<14&4294967295|C>>>18),C=S+(O^E&(k^O))+I[4]+3889429448&4294967295,S=k+(C<<20&4294967295|C>>>12),C=E+(k^O&(S^k))+I[9]+568446438&4294967295,E=S+(C<<5&4294967295|C>>>27),C=O+(S^k&(E^S))+I[14]+3275163606&4294967295,O=E+(C<<9&4294967295|C>>>23),C=k+(E^S&(O^E))+I[3]+4107603335&4294967295,k=O+(C<<14&4294967295|C>>>18),C=S+(O^E&(k^O))+I[8]+1163531501&4294967295,S=k+(C<<20&4294967295|C>>>12),C=E+(k^O&(S^k))+I[13]+2850285829&4294967295,E=S+(C<<5&4294967295|C>>>27),C=O+(S^k&(E^S))+I[2]+4243563512&4294967295,O=E+(C<<9&4294967295|C>>>23),C=k+(E^S&(O^E))+I[7]+1735328473&4294967295,k=O+(C<<14&4294967295|C>>>18),C=S+(O^E&(k^O))+I[12]+2368359562&4294967295,S=k+(C<<20&4294967295|C>>>12),C=E+(S^k^O)+I[5]+4294588738&4294967295,E=S+(C<<4&4294967295|C>>>28),C=O+(E^S^k)+I[8]+2272392833&4294967295,O=E+(C<<11&4294967295|C>>>21),C=k+(O^E^S)+I[11]+1839030562&4294967295,k=O+(C<<16&4294967295|C>>>16),C=S+(k^O^E)+I[14]+4259657740&4294967295,S=k+(C<<23&4294967295|C>>>9),C=E+(S^k^O)+I[1]+2763975236&4294967295,E=S+(C<<4&4294967295|C>>>28),C=O+(E^S^k)+I[4]+1272893353&4294967295,O=E+(C<<11&4294967295|C>>>21),C=k+(O^E^S)+I[7]+4139469664&4294967295,k=O+(C<<16&4294967295|C>>>16),C=S+(k^O^E)+I[10]+3200236656&4294967295,S=k+(C<<23&4294967295|C>>>9),C=E+(S^k^O)+I[13]+681279174&4294967295,E=S+(C<<4&4294967295|C>>>28),C=O+(E^S^k)+I[0]+3936430074&4294967295,O=E+(C<<11&4294967295|C>>>21),C=k+(O^E^S)+I[3]+3572445317&4294967295,k=O+(C<<16&4294967295|C>>>16),C=S+(k^O^E)+I[6]+76029189&4294967295,S=k+(C<<23&4294967295|C>>>9),C=E+(S^k^O)+I[9]+3654602809&4294967295,E=S+(C<<4&4294967295|C>>>28),C=O+(E^S^k)+I[12]+3873151461&4294967295,O=E+(C<<11&4294967295|C>>>21),C=k+(O^E^S)+I[15]+530742520&4294967295,k=O+(C<<16&4294967295|C>>>16),C=S+(k^O^E)+I[2]+3299628645&4294967295,S=k+(C<<23&4294967295|C>>>9),C=E+(k^(S|~O))+I[0]+4096336452&4294967295,E=S+(C<<6&4294967295|C>>>26),C=O+(S^(E|~k))+I[7]+1126891415&4294967295,O=E+(C<<10&4294967295|C>>>22),C=k+(E^(O|~S))+I[14]+2878612391&4294967295,k=O+(C<<15&4294967295|C>>>17),C=S+(O^(k|~E))+I[5]+4237533241&4294967295,S=k+(C<<21&4294967295|C>>>11),C=E+(k^(S|~O))+I[12]+1700485571&4294967295,E=S+(C<<6&4294967295|C>>>26),C=O+(S^(E|~k))+I[3]+2399980690&4294967295,O=E+(C<<10&4294967295|C>>>22),C=k+(E^(O|~S))+I[10]+4293915773&4294967295,k=O+(C<<15&4294967295|C>>>17),C=S+(O^(k|~E))+I[1]+2240044497&4294967295,S=k+(C<<21&4294967295|C>>>11),C=E+(k^(S|~O))+I[8]+1873313359&4294967295,E=S+(C<<6&4294967295|C>>>26),C=O+(S^(E|~k))+I[15]+4264355552&4294967295,O=E+(C<<10&4294967295|C>>>22),C=k+(E^(O|~S))+I[6]+2734768916&4294967295,k=O+(C<<15&4294967295|C>>>17),C=S+(O^(k|~E))+I[13]+1309151649&4294967295,S=k+(C<<21&4294967295|C>>>11),C=E+(k^(S|~O))+I[4]+4149444226&4294967295,E=S+(C<<6&4294967295|C>>>26),C=O+(S^(E|~k))+I[11]+3174756917&4294967295,O=E+(C<<10&4294967295|C>>>22),C=k+(E^(O|~S))+I[2]+718787259&4294967295,k=O+(C<<15&4294967295|C>>>17),C=S+(O^(k|~E))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+E&4294967295,T.g[1]=T.g[1]+(k+(C<<21&4294967295|C>>>11))&4294967295,T.g[2]=T.g[2]+k&4294967295,T.g[3]=T.g[3]+O&4294967295}i.prototype.v=function(T,E){E===void 0&&(E=T.length);const S=E-this.blockSize,I=this.C;let k=this.h,O=0;for(;O<E;){if(k==0)for(;O<=S;)o(this,T,O),O+=this.blockSize;if(typeof T=="string"){for(;O<E;)if(I[k++]=T.charCodeAt(O++),k==this.blockSize){o(this,I),k=0;break}}else for(;O<E;)if(I[k++]=T[O++],k==this.blockSize){o(this,I),k=0;break}}this.h=k,this.o+=E},i.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var E=1;E<T.length-8;++E)T[E]=0;E=this.o*8;for(var S=T.length-8;S<T.length;++S)T[S]=E&255,E/=256;for(this.v(T),T=Array(16),E=0,S=0;S<4;++S)for(let I=0;I<32;I+=8)T[E++]=this.g[S]>>>I&255;return T};function c(T,E){var S=m;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=E(T)}function d(T,E){this.h=E;const S=[];let I=!0;for(let k=T.length-1;k>=0;k--){const O=T[k]|0;I&&O==E||(S[k]=O,I=!1)}this.g=S}var m={};function x(T){return-128<=T&&T<128?c(T,function(E){return new d([E|0],E<0?-1:0)}):new d([T|0],T<0?-1:0)}function g(T){if(isNaN(T)||!isFinite(T))return w;if(T<0)return U(g(-T));const E=[];let S=1;for(let I=0;T>=S;I++)E[I]=T/S|0,S*=4294967296;return new d(E,0)}function b(T,E){if(T.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(T.charAt(0)=="-")return U(b(T.substring(1),E));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=g(Math.pow(E,8));let I=w;for(let O=0;O<T.length;O+=8){var k=Math.min(8,T.length-O);const C=parseInt(T.substring(O,O+k),E);k<8?(k=g(Math.pow(E,k)),I=I.j(k).add(g(C))):(I=I.j(S),I=I.add(g(C)))}return I}var w=x(0),_=x(1),R=x(16777216);n=d.prototype,n.m=function(){if(V(this))return-U(this).m();let T=0,E=1;for(let S=0;S<this.g.length;S++){const I=this.i(S);T+=(I>=0?I:4294967296+I)*E,E*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(B(this))return"0";if(V(this))return"-"+U(this).toString(T);const E=g(Math.pow(T,6));var S=this;let I="";for(;;){const k=re(S,E).g;S=F(S,k.j(E));let O=((S.g.length>0?S.g[0]:S.h)>>>0).toString(T);if(S=k,B(S))return O+I;for(;O.length<6;)O="0"+O;I=O+I}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function B(T){if(T.h!=0)return!1;for(let E=0;E<T.g.length;E++)if(T.g[E]!=0)return!1;return!0}function V(T){return T.h==-1}n.l=function(T){return T=F(this,T),V(T)?-1:B(T)?0:1};function U(T){const E=T.g.length,S=[];for(let I=0;I<E;I++)S[I]=~T.g[I];return new d(S,~T.h).add(_)}n.abs=function(){return V(this)?U(this):this},n.add=function(T){const E=Math.max(this.g.length,T.g.length),S=[];let I=0;for(let k=0;k<=E;k++){let O=I+(this.i(k)&65535)+(T.i(k)&65535),C=(O>>>16)+(this.i(k)>>>16)+(T.i(k)>>>16);I=C>>>16,O&=65535,C&=65535,S[k]=C<<16|O}return new d(S,S[S.length-1]&-2147483648?-1:0)};function F(T,E){return T.add(U(E))}n.j=function(T){if(B(this)||B(T))return w;if(V(this))return V(T)?U(this).j(U(T)):U(U(this).j(T));if(V(T))return U(this.j(U(T)));if(this.l(R)<0&&T.l(R)<0)return g(this.m()*T.m());const E=this.g.length+T.g.length,S=[];for(var I=0;I<2*E;I++)S[I]=0;for(I=0;I<this.g.length;I++)for(let k=0;k<T.g.length;k++){const O=this.i(I)>>>16,C=this.i(I)&65535,$=T.i(k)>>>16,L=T.i(k)&65535;S[2*I+2*k]+=C*L,Q(S,2*I+2*k),S[2*I+2*k+1]+=O*L,Q(S,2*I+2*k+1),S[2*I+2*k+1]+=C*$,Q(S,2*I+2*k+1),S[2*I+2*k+2]+=O*$,Q(S,2*I+2*k+2)}for(T=0;T<E;T++)S[T]=S[2*T+1]<<16|S[2*T];for(T=E;T<2*E;T++)S[T]=0;return new d(S,0)};function Q(T,E){for(;(T[E]&65535)!=T[E];)T[E+1]+=T[E]>>>16,T[E]&=65535,E++}function H(T,E){this.g=T,this.h=E}function re(T,E){if(B(E))throw Error("division by zero");if(B(T))return new H(w,w);if(V(T))return E=re(U(T),E),new H(U(E.g),U(E.h));if(V(E))return E=re(T,U(E)),new H(U(E.g),E.h);if(T.g.length>30){if(V(T)||V(E))throw Error("slowDivide_ only works with positive integers.");for(var S=_,I=E;I.l(T)<=0;)S=he(S),I=he(I);var k=W(S,1),O=W(I,1);for(I=W(I,2),S=W(S,2);!B(I);){var C=O.add(I);C.l(T)<=0&&(k=k.add(S),O=C),I=W(I,1),S=W(S,1)}return E=F(T,k.j(E)),new H(k,E)}for(k=w;T.l(E)>=0;){for(S=Math.max(1,Math.floor(T.m()/E.m())),I=Math.ceil(Math.log(S)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),O=g(S),C=O.j(E);V(C)||C.l(T)>0;)S-=I,O=g(S),C=O.j(E);B(O)&&(O=_),k=k.add(O),T=F(T,C)}return new H(k,T)}n.B=function(T){return re(this,T).h},n.and=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let I=0;I<E;I++)S[I]=this.i(I)&T.i(I);return new d(S,this.h&T.h)},n.or=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let I=0;I<E;I++)S[I]=this.i(I)|T.i(I);return new d(S,this.h|T.h)},n.xor=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let I=0;I<E;I++)S[I]=this.i(I)^T.i(I);return new d(S,this.h^T.h)};function he(T){const E=T.g.length+1,S=[];for(let I=0;I<E;I++)S[I]=T.i(I)<<1|T.i(I-1)>>>31;return new d(S,T.h)}function W(T,E){const S=E>>5;E%=32;const I=T.g.length-S,k=[];for(let O=0;O<I;O++)k[O]=E>0?T.i(O+S)>>>E|T.i(O+S+1)<<32-E:T.i(O+S);return new d(k,T.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Fj=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=g,d.fromString=b,Si=d}).apply(typeof Yw<"u"?Yw:typeof self<"u"?self:typeof window<"u"?window:{});var Nh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $j,uu,qj,zh,H0,Hj,Gj,Yj;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Nh=="object"&&Nh];for(var y=0;y<h.length;++y){var N=h[y];if(N&&N.Math==Math)return N}throw Error("Cannot find global object")}var i=t(this);function o(h,y){if(y)e:{var N=i;h=h.split(".");for(var D=0;D<h.length-1;D++){var ee=h[D];if(!(ee in N))break e;N=N[ee]}h=h[h.length-1],D=N[h],y=y(D),y!=D&&y!=null&&e(N,h,{configurable:!0,writable:!0,value:y})}}o("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(h){return h||function(y){var N=[],D;for(D in y)Object.prototype.hasOwnProperty.call(y,D)&&N.push([D,y[D]]);return N}});var c=c||{},d=this||self;function m(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function x(h,y,N){return h.call.apply(h.bind,arguments)}function g(h,y,N){return g=x,g.apply(null,arguments)}function b(h,y){var N=Array.prototype.slice.call(arguments,1);return function(){var D=N.slice();return D.push.apply(D,arguments),h.apply(this,D)}}function w(h,y){function N(){}N.prototype=y.prototype,h.Z=y.prototype,h.prototype=new N,h.prototype.constructor=h,h.Ob=function(D,ee,ie){for(var ke=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)ke[dt-2]=arguments[dt];return y.prototype[ee].apply(D,ke)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function R(h){const y=h.length;if(y>0){const N=Array(y);for(let D=0;D<y;D++)N[D]=h[D];return N}return[]}function B(h,y){for(let D=1;D<arguments.length;D++){const ee=arguments[D];var N=typeof ee;if(N=N!="object"?N:ee?Array.isArray(ee)?"array":N:"null",N=="array"||N=="object"&&typeof ee.length=="number"){N=h.length||0;const ie=ee.length||0;h.length=N+ie;for(let ke=0;ke<ie;ke++)h[N+ke]=ee[ke]}else h.push(ee)}}class V{constructor(y,N){this.i=y,this.j=N,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function U(h){d.setTimeout(()=>{throw h},0)}function F(){var h=T;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class Q{constructor(){this.h=this.g=null}add(y,N){const D=H.get();D.set(y,N),this.h?this.h.next=D:this.g=D,this.h=D}}var H=new V(()=>new re,h=>h.reset());class re{constructor(){this.next=this.g=this.h=null}set(y,N){this.h=y,this.g=N,this.next=null}reset(){this.next=this.g=this.h=null}}let he,W=!1,T=new Q,E=()=>{const h=Promise.resolve(void 0);he=()=>{h.then(S)}};function S(){for(var h;h=F();){try{h.h.call(h.g)}catch(N){U(N)}var y=H;y.j(h),y.h<100&&(y.h++,h.next=y.g,y.g=h)}W=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const N=()=>{};d.addEventListener("test",N,y),d.removeEventListener("test",N,y)}catch{}return h})();function C(h){return/^[\s\xa0]*$/.test(h)}function $(h,y){k.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,y)}w($,k),$.prototype.init=function(h,y){const N=this.type=h.type,D=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget,y||(N=="mouseover"?y=h.fromElement:N=="mouseout"&&(y=h.toElement)),this.relatedTarget=y,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&$.Z.h.call(this)},$.prototype.h=function(){$.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var L="closure_listenable_"+(Math.random()*1e6|0),P=0;function K(h,y,N,D,ee){this.listener=h,this.proxy=null,this.src=y,this.type=N,this.capture=!!D,this.ha=ee,this.key=++P,this.da=this.fa=!1}function le(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ee(h,y,N){for(const D in h)y.call(N,h[D],D,h)}function ye(h,y){for(const N in h)y.call(void 0,h[N],N,h)}function z(h){const y={};for(const N in h)y[N]=h[N];return y}const Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ce(h,y){let N,D;for(let ee=1;ee<arguments.length;ee++){D=arguments[ee];for(N in D)h[N]=D[N];for(let ie=0;ie<Z.length;ie++)N=Z[ie],Object.prototype.hasOwnProperty.call(D,N)&&(h[N]=D[N])}}function ge(h){this.src=h,this.g={},this.h=0}ge.prototype.add=function(h,y,N,D,ee){const ie=h.toString();h=this.g[ie],h||(h=this.g[ie]=[],this.h++);const ke=Ce(h,y,D,ee);return ke>-1?(y=h[ke],N||(y.fa=!1)):(y=new K(y,this.src,ie,!!D,ee),y.fa=N,h.push(y)),y};function de(h,y){const N=y.type;if(N in h.g){var D=h.g[N],ee=Array.prototype.indexOf.call(D,y,void 0),ie;(ie=ee>=0)&&Array.prototype.splice.call(D,ee,1),ie&&(le(y),h.g[N].length==0&&(delete h.g[N],h.h--))}}function Ce(h,y,N,D){for(let ee=0;ee<h.length;++ee){const ie=h[ee];if(!ie.da&&ie.listener==y&&ie.capture==!!N&&ie.ha==D)return ee}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),Rt={};function it(h,y,N,D,ee){if(Array.isArray(y)){for(let ie=0;ie<y.length;ie++)it(h,y[ie],N,D,ee);return null}return N=Mt(N),h&&h[L]?h.J(y,N,m(D)?!!D.capture:!1,ee):Bt(h,y,N,!1,D,ee)}function Bt(h,y,N,D,ee,ie){if(!y)throw Error("Invalid event type");const ke=m(ee)?!!ee.capture:!!ee;let dt=Et(h);if(dt||(h[Fe]=dt=new ge(h)),N=dt.add(y,N,D,ke,ie),N.proxy)return N;if(D=ne(),N.proxy=D,D.src=h,D.listener=N,h.addEventListener)O||(ee=ke),ee===void 0&&(ee=!1),h.addEventListener(y.toString(),D,ee);else if(h.attachEvent)h.attachEvent($e(y.toString()),D);else if(h.addListener&&h.removeListener)h.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return N}function ne(){function h(N){return y.call(h.src,h.listener,N)}const y=Ze;return h}function je(h,y,N,D,ee){if(Array.isArray(y))for(var ie=0;ie<y.length;ie++)je(h,y[ie],N,D,ee);else D=m(D)?!!D.capture:!!D,N=Mt(N),h&&h[L]?(h=h.i,ie=String(y).toString(),ie in h.g&&(y=h.g[ie],N=Ce(y,N,D,ee),N>-1&&(le(y[N]),Array.prototype.splice.call(y,N,1),y.length==0&&(delete h.g[ie],h.h--)))):h&&(h=Et(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Ce(y,N,D,ee)),(N=h>-1?y[h]:null)&&Se(N))}function Se(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[L])de(y.i,h);else{var N=h.type,D=h.proxy;y.removeEventListener?y.removeEventListener(N,D,h.capture):y.detachEvent?y.detachEvent($e(N),D):y.addListener&&y.removeListener&&y.removeListener(D),(N=Et(y))?(de(N,h),N.h==0&&(N.src=null,y[Fe]=null)):le(h)}}}function $e(h){return h in Rt?Rt[h]:Rt[h]="on"+h}function Ze(h,y){if(h.da)h=!0;else{y=new $(y,this);const N=h.listener,D=h.ha||h.src;h.fa&&Se(h),h=N.call(D,y)}return h}function Et(h){return h=h[Fe],h instanceof ge?h:null}var Bs="__closure_events_fn_"+(Math.random()*1e9>>>0);function Mt(h){return typeof h=="function"?h:(h[Bs]||(h[Bs]=function(y){return h.handleEvent(y)}),h[Bs])}function xt(){I.call(this),this.i=new ge(this),this.M=this,this.G=null}w(xt,I),xt.prototype[L]=!0,xt.prototype.removeEventListener=function(h,y,N,D){je(this,h,y,N,D)};function Ie(h,y){var N,D=h.G;if(D)for(N=[];D;D=D.G)N.push(D);if(h=h.M,D=y.type||y,typeof y=="string")y=new k(y,h);else if(y instanceof k)y.target=y.target||h;else{var ee=y;y=new k(D,h),ce(y,ee)}ee=!0;let ie,ke;if(N)for(ke=N.length-1;ke>=0;ke--)ie=y.g=N[ke],ee=Be(ie,D,!0,y)&&ee;if(ie=y.g=h,ee=Be(ie,D,!0,y)&&ee,ee=Be(ie,D,!1,y)&&ee,N)for(ke=0;ke<N.length;ke++)ie=y.g=N[ke],ee=Be(ie,D,!1,y)&&ee}xt.prototype.N=function(){if(xt.Z.N.call(this),this.i){var h=this.i;for(const y in h.g){const N=h.g[y];for(let D=0;D<N.length;D++)le(N[D]);delete h.g[y],h.h--}}this.G=null},xt.prototype.J=function(h,y,N,D){return this.i.add(String(h),y,!1,N,D)},xt.prototype.K=function(h,y,N,D){return this.i.add(String(h),y,!0,N,D)};function Be(h,y,N,D){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();let ee=!0;for(let ie=0;ie<y.length;++ie){const ke=y[ie];if(ke&&!ke.da&&ke.capture==N){const dt=ke.listener,vs=ke.ha||ke.src;ke.fa&&de(h.i,ke),ee=dt.call(vs,D)!==!1&&ee}}return ee&&!D.defaultPrevented}function xe(h,y){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:d.setTimeout(h,y||0)}function qe(h){h.g=xe(()=>{h.g=null,h.i&&(h.i=!1,qe(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Le extends I{constructor(y,N){super(),this.m=y,this.l=N,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:qe(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function De(h){I.call(this),this.h=h,this.g={}}w(De,I);var Ge=[];function He(h){Ee(h.g,function(y,N){this.g.hasOwnProperty(N)&&Se(y)},h),h.g={}}De.prototype.N=function(){De.Z.N.call(this),He(this)},De.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var J=d.JSON.stringify,Ae=d.JSON.parse,We=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function tt(){}function It(){}var rs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gt(){k.call(this,"d")}w(gt,k);function hs(){k.call(this,"c")}w(hs,k);var Xt={},rn=null;function Ms(){return rn=rn||new xt}Xt.Ia="serverreachability";function Cn(h){k.call(this,Xt.Ia,h)}w(Cn,k);function ln(h){const y=Ms();Ie(y,new Cn(y))}Xt.STAT_EVENT="statevent";function _e(h,y){k.call(this,Xt.STAT_EVENT,h),this.stat=y}w(_e,k);function Te(h){const y=Ms();Ie(y,new _e(y,h))}Xt.Ja="timingevent";function ot(h,y){k.call(this,Xt.Ja,h),this.size=y}w(ot,k);function pt(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},y)}function Dt(){this.g=!0}Dt.prototype.ua=function(){this.g=!1};function M(h,y,N,D,ee,ie){h.info(function(){if(h.g)if(ie){var ke="",dt=ie.split("&");for(let Vt=0;Vt<dt.length;Vt++){var vs=dt[Vt].split("=");if(vs.length>1){const cs=vs[0];vs=vs[1];const Wn=cs.split("_");ke=Wn.length>=2&&Wn[1]=="type"?ke+(cs+"="+vs+"&"):ke+(cs+"=redacted&")}}}else ke=null;else ke=ie;return"XMLHTTP REQ ("+D+") [attempt "+ee+"]: "+y+`
`+N+`
`+ke})}function G(h,y,N,D,ee,ie,ke){h.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+ee+"]: "+y+`
`+N+`
`+ie+" "+ke})}function fe(h,y,N,D){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+Ve(h,N)+(D?" "+D:"")})}function ue(h,y){h.info(function(){return"TIMEOUT: "+y})}Dt.prototype.info=function(){};function Ve(h,y){if(!h.g)return y;if(!y)return null;try{const ie=JSON.parse(y);if(ie){for(h=0;h<ie.length;h++)if(Array.isArray(ie[h])){var N=ie[h];if(!(N.length<2)){var D=N[1];if(Array.isArray(D)&&!(D.length<1)){var ee=D[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(let ke=1;ke<D.length;ke++)D[ke]=""}}}}return J(ie)}catch{return y}}var et={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ft={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Qe;function vt(){}w(vt,tt),vt.prototype.g=function(){return new XMLHttpRequest},Qe=new vt;function Tt(h){return encodeURIComponent(String(h))}function Os(h){var y=1;h=h.split(":");const N=[];for(;y>0&&h.length;)N.push(h.shift()),y--;return h.length&&N.push(h.join(":")),N}function Ot(h,y,N,D){this.j=h,this.i=y,this.l=N,this.S=D||1,this.V=new De(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new zs}function zs(){this.i=null,this.g="",this.h=!1}var Jt={},ms={};function on(h,y,N){h.M=1,h.A=zi(Ss(y)),h.u=N,h.R=!0,nr(h,null)}function nr(h,y){h.F=Date.now(),Aa(h),h.B=Ss(h.A);var N=h.B,D=h.S;Array.isArray(D)||(D=[String(D)]),Ll(N.i,"t",D),h.C=0,N=h.j.L,h.h=new zs,h.g=fd(h.j,N?y:null,!h.u),h.P>0&&(h.O=new Le(g(h.Y,h,h.g),h.P)),y=h.V,N=h.g,D=h.ba;var ee="readystatechange";Array.isArray(ee)||(ee&&(Ge[0]=ee.toString()),ee=Ge);for(let ie=0;ie<ee.length;ie++){const ke=it(N,ee[ie],D||y.handleEvent,!1,y.h||y);if(!ke)break;y.g[ke.key]=ke}y=h.J?z(h.J):{},h.u?(h.v||(h.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,y)):(h.v="GET",h.g.ea(h.B,h.v,null,y)),ln(),M(h.i,h.v,h.B,h.l,h.S,h.u)}Ot.prototype.ba=function(h){h=h.target;const y=this.O;y&&da(h)==3?y.j():this.Y(h)},Ot.prototype.Y=function(h){try{if(h==this.g)e:{const dt=da(this.g),vs=this.g.ya(),Vt=this.g.ca();if(!(dt<3)&&(dt!=3||this.g&&(this.h.h||this.g.la()||Hs(this.g)))){this.K||dt!=4||vs==7||(vs==8||Vt<=0?ln(3):ln(2)),ka(this);var y=this.g.ca();this.X=y;var N=Bi(this);if(this.o=y==200,G(this.i,this.v,this.B,this.l,this.S,dt,y),this.o){if(this.U&&!this.L){t:{if(this.g){var D,ee=this.g;if((D=ee.g?ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(D)){var ie=D;break t}}ie=null}if(h=ie)fe(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ca(this,h);else{this.o=!1,this.m=3,Te(12),Rn(this),Hn(this);break e}}if(this.R){h=!0;let cs;for(;!this.K&&this.C<N.length;)if(cs=Dl(this,N),cs==ms){dt==4&&(this.m=4,Te(14),h=!1),fe(this.i,this.l,null,"[Incomplete Response]");break}else if(cs==Jt){this.m=4,Te(15),fe(this.i,this.l,N,"[Invalid Chunk]"),h=!1;break}else fe(this.i,this.l,cs,null),Ca(this,cs);if(Il(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dt!=4||N.length!=0||this.h.h||(this.m=1,Te(16),h=!1),this.o=this.o&&h,!h)fe(this.i,this.l,N,"[Invalid Chunked Response]"),Rn(this),Hn(this);else if(N.length>0&&!this.W){this.W=!0;var ke=this.j;ke.g==this&&ke.aa&&!ke.P&&(ke.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),pc(ke),ke.P=!0,Te(11))}}else fe(this.i,this.l,N,null),Ca(this,N);dt==4&&Rn(this),this.o&&!this.K&&(dt==4?cd(this.j,this):(this.o=!1,Aa(this)))}else rr(this.g),y==400&&N.indexOf("Unknown SID")>0?(this.m=3,Te(12)):(this.m=0,Te(13)),Rn(this),Hn(this)}}}catch{}};function Bi(h){if(!Il(h))return h.g.la();const y=Hs(h.g);if(y==="")return"";let N="";const D=y.length,ee=da(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Rn(h),Hn(h),"";h.h.i=new d.TextDecoder}for(let ie=0;ie<D;ie++)h.h.h=!0,N+=h.h.i.decode(y[ie],{stream:!(ee&&ie==D-1)});return y.length=0,h.h.g+=N,h.C=0,h.h.g}function Il(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Dl(h,y){var N=h.C,D=y.indexOf(`
`,N);return D==-1?ms:(N=Number(y.substring(N,D)),isNaN(N)?Jt:(D+=1,D+N>y.length?ms:(y=y.slice(D,D+N),h.C=D+N,y)))}Ot.prototype.cancel=function(){this.K=!0,Rn(this)};function Aa(h){h.T=Date.now()+h.H,Ml(h,h.H)}function Ml(h,y){if(h.D!=null)throw Error("WatchDog timer not null");h.D=pt(g(h.aa,h),y)}function ka(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Ot.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(ue(this.i,this.B),this.M!=2&&(ln(),Te(17)),Rn(this),this.m=2,Hn(this)):Ml(this,this.T-h)};function Hn(h){h.j.I==0||h.K||cd(h.j,h)}function Rn(h){ka(h);var y=h.O;y&&typeof y.dispose=="function"&&y.dispose(),h.O=null,He(h.V),h.g&&(y=h.g,h.g=null,y.abort(),y.dispose())}function Ca(h,y){try{var N=h.j;if(N.I!=0&&(N.g==h||Ia(N.h,h))){if(!h.L&&Ia(N.h,h)&&N.I==3){try{var D=N.Ba.g.parse(y)}catch{D=null}if(Array.isArray(D)&&D.length==3){var ee=D;if(ee[0]==0){e:if(!N.v){if(N.g)if(N.g.F+3e3<h.F)Fl(N),Hr(N);else break e;Wi(N),Te(18)}}else N.xa=ee[1],0<N.xa-N.K&&ee[2]<37500&&N.F&&N.A==0&&!N.C&&(N.C=pt(g(N.Va,N),6e3));Ra(N.h)<=1&&N.ta&&(N.ta=void 0)}else Va(N,11)}else if((h.L||N.g==h)&&Fl(N),!C(y))for(ee=N.Ba.g.parse(y),y=0;y<ee.length;y++){let Vt=ee[y];const cs=Vt[0];if(!(cs<=N.K))if(N.K=cs,Vt=Vt[1],N.I==2)if(Vt[0]=="c"){N.M=Vt[1],N.ba=Vt[2];const Wn=Vt[3];Wn!=null&&(N.ka=Wn,N.j.info("VER="+N.ka));const Ua=Vt[4];Ua!=null&&(N.za=Ua,N.j.info("SVER="+N.za));const ha=Vt[5];ha!=null&&typeof ha=="number"&&ha>0&&(D=1.5*ha,N.O=D,N.j.info("backChannelRequestTimeoutMs_="+D)),D=N;const fa=h.g;if(fa){const Qi=fa.g?fa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qi){var ie=D.h;ie.g||Qi.indexOf("spdy")==-1&&Qi.indexOf("quic")==-1&&Qi.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(nc(ie,ie.h),ie.h=null))}if(D.G){const $l=fa.g?fa.g.getResponseHeader("X-HTTP-Session-Id"):null;$l&&(D.wa=$l,qt(D.J,D.G,$l))}}N.I=3,N.l&&N.l.ra(),N.aa&&(N.T=Date.now()-h.F,N.j.info("Handshake RTT: "+N.T+"ms")),D=N;var ke=h;if(D.na=hd(D,D.L?D.ba:null,D.W),ke.L){ac(D.h,ke);var dt=ke,vs=D.O;vs&&(dt.H=vs),dt.D&&(ka(dt),Aa(dt)),D.g=ke}else ld(D);N.i.length>0&&La(N)}else Vt[0]!="stop"&&Vt[0]!="close"||Va(N,7);else N.I==3&&(Vt[0]=="stop"||Vt[0]=="close"?Vt[0]=="stop"?Va(N,7):fc(N):Vt[0]!="noop"&&N.l&&N.l.qa(Vt),N.A=0)}}ln(4)}catch{}}var _s=class{constructor(h,y){this.g=h,this.map=y}};function tc(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function sc(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ra(h){return h.h?1:h.g?h.g.size:0}function Ia(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function nc(h,y){h.g?h.g.add(y):h.h=y}function ac(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}tc.prototype.cancel=function(){if(this.i=rc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function rc(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const N of h.g.values())y=y.concat(N.G);return y}return R(h.i)}var td=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ol(h,y){if(h){h=h.split("&");for(let N=0;N<h.length;N++){const D=h[N].indexOf("=");let ee,ie=null;D>=0?(ee=h[N].substring(0,D),ie=h[N].substring(D+1)):ee=h[N],y(ee,ie?decodeURIComponent(ie.replace(/\+/g," ")):"")}}}function In(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;h instanceof In?(this.l=h.l,Fs(this,h.j),this.o=h.o,this.g=h.g,Vr(this,h.u),this.h=h.h,ic(this,rd(h.i)),this.m=h.m):h&&(y=String(h).match(td))?(this.l=!1,Fs(this,y[1]||"",!0),this.o=Da(y[2]||""),this.g=Da(y[3]||"",!0),Vr(this,y[4]),this.h=Da(y[5]||"",!0),ic(this,y[6]||"",!0),this.m=Da(y[7]||"")):(this.l=!1,this.i=new Br(null,this.l))}In.prototype.toString=function(){const h=[];var y=this.j;y&&h.push(Fi(y,Pl,!0),":");var N=this.g;return(N||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Fi(y,Pl,!0),"@"),h.push(Tt(N).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N=this.u,N!=null&&h.push(":",String(N))),(N=this.h)&&(this.g&&N.charAt(0)!="/"&&h.push("/"),h.push(Fi(N,N.charAt(0)=="/"?lc:sd,!0))),(N=this.i.toString())&&h.push("?",N),(N=this.m)&&h.push("#",Fi(N,nd)),h.join("")},In.prototype.resolve=function(h){const y=Ss(this);let N=!!h.j;N?Fs(y,h.j):N=!!h.o,N?y.o=h.o:N=!!h.g,N?y.g=h.g:N=h.u!=null;var D=h.h;if(N)Vr(y,h.u);else if(N=!!h.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var ee=y.h.lastIndexOf("/");ee!=-1&&(D=y.h.slice(0,ee+1)+D)}if(ee=D,ee==".."||ee==".")D="";else if(ee.indexOf("./")!=-1||ee.indexOf("/.")!=-1){D=ee.lastIndexOf("/",0)==0,ee=ee.split("/");const ie=[];for(let ke=0;ke<ee.length;){const dt=ee[ke++];dt=="."?D&&ke==ee.length&&ie.push(""):dt==".."?((ie.length>1||ie.length==1&&ie[0]!="")&&ie.pop(),D&&ke==ee.length&&ie.push("")):(ie.push(dt),D=!0)}D=ie.join("/")}else D=ee}return N?y.h=D:N=h.i.toString()!=="",N?ic(y,rd(h.i)):N=!!h.m,N&&(y.m=h.m),y};function Ss(h){return new In(h)}function Fs(h,y,N){h.j=N?Da(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Vr(h,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);h.u=y}else h.u=null}function ic(h,y,N){y instanceof Br?(h.i=y,Vl(h.i,h.l)):(N||(y=Fi(y,Ur)),h.i=new Br(y,h.l))}function qt(h,y,N){h.i.set(y,N)}function zi(h){return qt(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Da(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Fi(h,y,N){return typeof h=="string"?(h=encodeURI(h).replace(y,fn),N&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function fn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Pl=/[#\/\?@]/g,sd=/[#\?:]/g,lc=/[#\?]/g,Ur=/[#\?@]/g,nd=/#/g;function Br(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function mn(h){h.g||(h.g=new Map,h.h=0,h.i&&Ol(h.i,function(y,N){h.add(decodeURIComponent(y.replace(/\+/g," ")),N)}))}n=Br.prototype,n.add=function(h,y){mn(this),this.i=null,h=zr(this,h);let N=this.g.get(h);return N||this.g.set(h,N=[]),N.push(y),this.h+=1,this};function ad(h,y){mn(h),y=zr(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function oc(h,y){return mn(h),y=zr(h,y),h.g.has(y)}n.forEach=function(h,y){mn(this),this.g.forEach(function(N,D){N.forEach(function(ee){h.call(y,ee,D,this)},this)},this)};function cc(h,y){mn(h);let N=[];if(typeof y=="string")oc(h,y)&&(N=N.concat(h.g.get(zr(h,y))));else for(h=Array.from(h.g.values()),y=0;y<h.length;y++)N=N.concat(h[y]);return N}n.set=function(h,y){return mn(this),this.i=null,h=zr(this,h),oc(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=cc(this,h),h.length>0?String(h[0]):y):y};function Ll(h,y,N){ad(h,y),N.length>0&&(h.i=null,h.g.set(zr(h,y),R(N)),h.h+=N.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(let D=0;D<y.length;D++){var N=y[D];const ee=Tt(N);N=cc(this,N);for(let ie=0;ie<N.length;ie++){let ke=ee;N[ie]!==""&&(ke+="="+Tt(N[ie])),h.push(ke)}}return this.i=h.join("&")};function rd(h){const y=new Br;return y.i=h.i,h.g&&(y.g=new Map(h.g),y.h=h.h),y}function zr(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Vl(h,y){y&&!h.j&&(mn(h),h.i=null,h.g.forEach(function(N,D){const ee=D.toLowerCase();D!=ee&&(ad(this,D),Ll(this,ee,N))},h)),h.j=y}function ca(h,y){const N=new Dt;if(d.Image){const D=new Image;D.onload=b(Gn,N,"TestLoadImage: loaded",!0,y,D),D.onerror=b(Gn,N,"TestLoadImage: error",!1,y,D),D.onabort=b(Gn,N,"TestLoadImage: abort",!1,y,D),D.ontimeout=b(Gn,N,"TestLoadImage: timeout",!1,y,D),d.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=h}else y(!1)}function uc(h,y){const N=new Dt,D=new AbortController,ee=setTimeout(()=>{D.abort(),Gn(N,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:D.signal}).then(ie=>{clearTimeout(ee),ie.ok?Gn(N,"TestPingServer: ok",!0,y):Gn(N,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(ee),Gn(N,"TestPingServer: error",!1,y)})}function Gn(h,y,N,D,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),D(N)}catch{}}function Fr(){this.g=new We}function Ma(h){this.i=h.Sb||null,this.h=h.ab||!1}w(Ma,tt),Ma.prototype.g=function(){return new $i(this.i,this.h)};function $i(h,y){xt.call(this),this.H=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w($i,xt),n=$i.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=y,this.readyState=1,ua(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(y.body=h),(this.H||d).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,$r(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ua(this)),this.g&&(this.readyState=3,ua(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ul(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ul(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?$r(this):ua(this),this.readyState==3&&Ul(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,$r(this))},n.Na=function(h){this.g&&(this.response=h,$r(this))},n.ga=function(){this.g&&$r(this)};function $r(h){h.readyState=4,h.l=null,h.j=null,h.B=null,ua(h)}n.setRequestHeader=function(h,y){this.A.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var N=y.next();!N.done;)N=N.value,h.push(N[0]+": "+N[1]),N=y.next();return h.join(`\r
`)};function ua(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty($i.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Yn(h){let y="";return Ee(h,function(N,D){y+=D,y+=":",y+=N,y+=`\r
`}),y}function qi(h,y,N){e:{for(D in N){var D=!1;break e}D=!0}D||(N=Yn(N),typeof h=="string"?N!=null&&Tt(N):qt(h,y,N))}function Yt(h){xt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(Yt,xt);var Oa=/^https?$/i,dc=["POST","PUT"];n=Yt.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,y,N,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Qe.g(),this.g.onreadystatechange=_(g(this.Ca,this));try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(ie){Hi(this,ie);return}if(h=N||"",N=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var ee in D)N.set(ee,D[ee]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const ie of D.keys())N.set(ie,D.get(ie));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(N.keys()).find(ie=>ie.toLowerCase()=="content-type"),ee=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(dc,y,void 0)>=0)||D||ee||N.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,ke]of N)this.g.setRequestHeader(ie,ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ie){Hi(this,ie)}};function Hi(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.o=5,hc(h),ar(h)}function hc(h){h.A||(h.A=!0,Ie(h,"complete"),Ie(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ie(this,"complete"),Ie(this,"abort"),ar(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ar(this,!0)),Yt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Gi(this):this.Xa())},n.Xa=function(){Gi(this)};function Gi(h){if(h.h&&typeof c<"u"){if(h.v&&da(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ie(h,"readystatechange"),da(h)==4){h.h=!1;try{const ie=h.ca();e:switch(ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var N;if(!(N=y)){var D;if(D=ie===0){let ke=String(h.D).match(td)[1]||null;!ke&&d.self&&d.self.location&&(ke=d.self.location.protocol.slice(0,-1)),D=!Oa.test(ke?ke.toLowerCase():"")}N=D}if(N)Ie(h,"complete"),Ie(h,"success");else{h.o=6;try{var ee=da(h)>2?h.g.statusText:""}catch{ee=""}h.l=ee+" ["+h.ca()+"]",hc(h)}}finally{ar(h)}}}}function ar(h,y){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const N=h.g;h.g=null,y||Ie(h,"ready");try{N.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function da(h){return h.g?h.g.readyState:0}n.ca=function(){try{return da(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),Ae(y)}};function Hs(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function rr(h){const y={};h=(h.g&&da(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<h.length;D++){if(C(h[D]))continue;var N=Os(h[D]);const ee=N[0];if(N=N[1],typeof N!="string")continue;N=N.trim();const ie=y[ee]||[];y[ee]=ie,ie.push(N)}ye(y,function(D){return D.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pa(h,y,N){return N&&N.internalChannelParams&&N.internalChannelParams[h]||y}function qr(h){this.za=0,this.i=[],this.j=new Dt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Pa("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Pa("baseRetryDelayMs",5e3,h),this.Za=Pa("retryDelaySeedMs",1e4,h),this.Ta=Pa("forwardChannelMaxRetries",2,h),this.va=Pa("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new tc(h&&h.concurrentRequestLimit),this.Ba=new Fr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=qr.prototype,n.ka=8,n.I=1,n.connect=function(h,y,N,D){Te(0),this.W=h,this.H=y||{},N&&D!==void 0&&(this.H.OSID=N,this.H.OAID=D),this.F=this.X,this.J=hd(this,null,this.W),La(this)};function fc(h){if(Bl(h),h.I==3){var y=h.V++,N=Ss(h.J);if(qt(N,"SID",h.M),qt(N,"RID",y),qt(N,"TYPE","terminate"),Yi(h,N),y=new Ot(h,h.j,y),y.M=2,y.A=zi(Ss(N)),N=!1,d.navigator&&d.navigator.sendBeacon)try{N=d.navigator.sendBeacon(y.A.toString(),"")}catch{}!N&&d.Image&&(new Image().src=y.A,N=!0),N||(y.g=fd(y.j,null),y.g.ea(y.A)),y.F=Date.now(),Aa(y)}dd(h)}function Hr(h){h.g&&(pc(h),h.g.cancel(),h.g=null)}function Bl(h){Hr(h),h.v&&(d.clearTimeout(h.v),h.v=null),Fl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function La(h){if(!sc(h.h)&&!h.m){h.m=!0;var y=h.Ea;he||E(),W||(he(),W=!0),T.add(y,h),h.D=0}}function zl(h,y){return Ra(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=y.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=pt(g(h.Ea,h,y),ud(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ee=new Ot(this,this.j,h);let ie=this.o;if(this.U&&(ie?(ie=z(ie),ce(ie,this.U)):ie=this.U),this.u!==null||this.R||(ee.J=ie,ie=null),this.S)e:{for(var y=0,N=0;N<this.i.length;N++){t:{var D=this.i[N];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(y+=D,y>4096){y=N;break e}if(y===4096||N===this.i.length-1){y=N+1;break e}}y=1e3}else y=1e3;y=id(this,ee,y),N=Ss(this.J),qt(N,"RID",h),qt(N,"CVER",22),this.G&&qt(N,"X-HTTP-Session-Id",this.G),Yi(this,N),ie&&(this.R?y="headers="+Tt(Yn(ie))+"&"+y:this.u&&qi(N,this.u,ie)),nc(this.h,ee),this.Ra&&qt(N,"TYPE","init"),this.S?(qt(N,"$req",y),qt(N,"SID","null"),ee.U=!0,on(ee,N,null)):on(ee,N,y),this.I=2}}else this.I==3&&(h?mc(this,h):this.i.length==0||sc(this.h)||mc(this))};function mc(h,y){var N;y?N=y.l:N=h.V++;const D=Ss(h.J);qt(D,"SID",h.M),qt(D,"RID",N),qt(D,"AID",h.K),Yi(h,D),h.u&&h.o&&qi(D,h.u,h.o),N=new Ot(h,h.j,N,h.D+1),h.u===null&&(N.J=h.o),y&&(h.i=y.G.concat(h.i)),y=id(h,N,1e3),N.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),nc(h.h,N),on(N,D,y)}function Yi(h,y){h.H&&Ee(h.H,function(N,D){qt(y,D,N)}),h.l&&Ee({},function(N,D){qt(y,D,N)})}function id(h,y,N){N=Math.min(h.i.length,N);const D=h.l?g(h.l.Ka,h.l,h):null;e:{var ee=h.i;let dt=-1;for(;;){const vs=["count="+N];dt==-1?N>0?(dt=ee[0].g,vs.push("ofs="+dt)):dt=0:vs.push("ofs="+dt);let Vt=!0;for(let cs=0;cs<N;cs++){var ie=ee[cs].g;const Wn=ee[cs].map;if(ie-=dt,ie<0)dt=Math.max(0,ee[cs].g-100),Vt=!1;else try{ie="req"+ie+"_"||"";try{var ke=Wn instanceof Map?Wn:Object.entries(Wn);for(const[Ua,ha]of ke){let fa=ha;m(ha)&&(fa=J(ha)),vs.push(ie+Ua+"="+encodeURIComponent(fa))}}catch(Ua){throw vs.push(ie+"type="+encodeURIComponent("_badmap")),Ua}}catch{D&&D(Wn)}}if(Vt){ke=vs.join("&");break e}}ke=void 0}return h=h.i.splice(0,N),y.G=h,ke}function ld(h){if(!h.g&&!h.v){h.Y=1;var y=h.Da;he||E(),W||(he(),W=!0),T.add(y,h),h.A=0}}function Wi(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=pt(g(h.Da,h),ud(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,od(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=pt(g(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Te(10),Hr(this),od(this))};function pc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function od(h){h.g=new Ot(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var y=Ss(h.na);qt(y,"RID","rpc"),qt(y,"SID",h.M),qt(y,"AID",h.K),qt(y,"CI",h.F?"0":"1"),!h.F&&h.ia&&qt(y,"TO",h.ia),qt(y,"TYPE","xmlhttp"),Yi(h,y),h.u&&h.o&&qi(y,h.u,h.o),h.O&&(h.g.H=h.O);var N=h.g;h=h.ba,N.M=1,N.A=zi(Ss(y)),N.u=null,N.R=!0,nr(N,h)}n.Va=function(){this.C!=null&&(this.C=null,Hr(this),Wi(this),Te(19))};function Fl(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function cd(h,y){var N=null;if(h.g==y){Fl(h),pc(h),h.g=null;var D=2}else if(Ia(h.h,y))N=y.G,ac(h.h,y),D=1;else return;if(h.I!=0){if(y.o)if(D==1){N=y.u?y.u.length:0,y=Date.now()-y.F;var ee=h.D;D=Ms(),Ie(D,new ot(D,N)),La(h)}else ld(h);else if(ee=y.m,ee==3||ee==0&&y.X>0||!(D==1&&zl(h,y)||D==2&&Wi(h)))switch(N&&N.length>0&&(y=h.h,y.i=y.i.concat(N)),ee){case 1:Va(h,5);break;case 4:Va(h,10);break;case 3:Va(h,6);break;default:Va(h,2)}}}function ud(h,y){let N=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(N*=2),N*y}function Va(h,y){if(h.j.info("Error code "+y),y==2){var N=g(h.bb,h),D=h.Ua;const ee=!D;D=new In(D||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Fs(D,"https"),zi(D),ee?ca(D.toString(),N):uc(D.toString(),N)}else Te(2);h.I=0,h.l&&h.l.pa(y),dd(h),Bl(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Te(2)):(this.j.info("Failed to ping google.com"),Te(1))};function dd(h){if(h.I=0,h.ja=[],h.l){const y=rc(h.h);(y.length!=0||h.i.length!=0)&&(B(h.ja,y),B(h.ja,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.oa()}}function hd(h,y,N){var D=N instanceof In?Ss(N):new In(N);if(D.g!="")y&&(D.g=y+"."+D.g),Vr(D,D.u);else{var ee=d.location;D=ee.protocol,y=y?y+"."+ee.hostname:ee.hostname,ee=+ee.port;const ie=new In(null);D&&Fs(ie,D),y&&(ie.g=y),ee&&Vr(ie,ee),N&&(ie.h=N),D=ie}return N=h.G,y=h.wa,N&&y&&qt(D,N,y),qt(D,"VER",h.ka),Yi(h,D),D}function fd(h,y,N){if(y&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Aa&&!h.ma?new Yt(new Ma({ab:N})):new Yt(h.ma),y.Fa(h.L),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function md(){}n=md.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Gr(){}Gr.prototype.g=function(h,y){return new cn(h,y)};function cn(h,y){xt.call(this),this.g=new qr(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(h?h["X-WebChannel-Client-Profile"]=y.sa:h={"X-WebChannel-Client-Profile":y.sa}),this.g.U=h,(h=y&&y.Qb)&&!C(h)&&(this.g.u=h),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!C(y)&&(this.g.G=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new ir(this)}w(cn,xt),cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){fc(this.g)},cn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var N={};N.__data__=h,h=N}else this.v&&(N={},N.__data__=J(h),h=N);y.i.push(new _s(y.Ya++,h)),y.I==3&&La(y)},cn.prototype.N=function(){this.g.l=null,delete this.j,fc(this.g),delete this.g,cn.Z.N.call(this)};function pd(h){gt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const N in y){h=N;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}w(pd,gt);function xd(){hs.call(this),this.status=1}w(xd,hs);function ir(h){this.g=h}w(ir,md),ir.prototype.ra=function(){Ie(this.g,"a")},ir.prototype.qa=function(h){Ie(this.g,new pd(h))},ir.prototype.pa=function(h){Ie(this.g,new xd)},ir.prototype.oa=function(){Ie(this.g,"b")},Gr.prototype.createWebChannel=Gr.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,Yj=function(){return new Gr},Gj=function(){return Ms()},Hj=Xt,H0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},et.NO_ERROR=0,et.TIMEOUT=8,et.HTTP_ERROR=6,zh=et,ft.COMPLETE="complete",qj=ft,It.EventType=rs,rs.OPEN="a",rs.CLOSE="b",rs.ERROR="c",rs.MESSAGE="d",xt.prototype.listen=xt.prototype.J,uu=It,Yt.prototype.listenOnce=Yt.prototype.K,Yt.prototype.getLastError=Yt.prototype.Ha,Yt.prototype.getLastErrorCode=Yt.prototype.ya,Yt.prototype.getStatus=Yt.prototype.ca,Yt.prototype.getResponseJson=Yt.prototype.La,Yt.prototype.getResponseText=Yt.prototype.la,Yt.prototype.send=Yt.prototype.ea,Yt.prototype.setWithCredentials=Yt.prototype.Fa,$j=Yt}).apply(typeof Nh<"u"?Nh:typeof self<"u"?self:typeof window<"u"?window:{});let sn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};sn.UNAUTHENTICATED=new sn(null),sn.GOOGLE_CREDENTIALS=new sn("google-credentials-uid"),sn.FIRST_PARTY=new sn("first-party-uid"),sn.MOCK_USER=new sn("mock-user");let Ko="12.8.0";function R4(n){Ko=n}const Nl=new Cx("@firebase/firestore");function wo(){return Nl.logLevel}function Pe(n,...e){if(Nl.logLevel<=jt.DEBUG){const t=e.map(zx);Nl.debug(`Firestore (${Ko}): ${n}`,...t)}}function Mr(n,...e){if(Nl.logLevel<=jt.ERROR){const t=e.map(zx);Nl.error(`Firestore (${Ko}): ${n}`,...t)}}function Oo(n,...e){if(Nl.logLevel<=jt.WARN){const t=e.map(zx);Nl.warn(`Firestore (${Ko}): ${n}`,...t)}}function zx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function rt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Wj(n,i,t)}function Wj(n,e,t){let i=`FIRESTORE (${Ko}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Mr(i),new Error(i)}function $t(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||Wj(e,o,i)}function ut(n,e){return n}const we={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Me extends Ta{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ar{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Qj{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class I4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(sn.UNAUTHENTICATED)))}shutdown(){}}class D4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class M4{constructor(e){this.t=e,this.currentUser=sn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){$t(this.o===void 0,42304);let i=this.i;const o=x=>this.i!==i?(i=this.i,t(x)):Promise.resolve();let c=new Ar;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Ar,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const x=c;e.enqueueRetryable((async()=>{await x.promise,await o(this.currentUser)}))},m=x=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=x,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((x=>m(x))),setTimeout((()=>{if(!this.auth){const x=this.t.getImmediate({optional:!0});x?m(x):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Ar)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?($t(typeof i.accessToken=="string",31837,{l:i}),new Qj(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $t(e===null||typeof e=="string",2055,{h:e}),new sn(e)}}class O4{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=sn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class P4{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new O4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(sn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Ww{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class L4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){$t(this.o===void 0,3512);const i=c=>{c.error!=null&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,Pe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>i(c)))};const o=c=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>o(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Ww(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?($t(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Ww(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function V4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Fx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=V4(40);for(let c=0;c<o.length;++c)i.length<20&&o[c]<t&&(i+=e.charAt(o[c]%62))}return i}}function _t(n,e){return n<e?-1:n>e?1:0}function G0(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),c=e.charAt(i);if(o!==c)return b0(o)===b0(c)?_t(o,c):b0(o)?1:-1}return _t(n.length,e.length)}const U4=55296,B4=57343;function b0(n){const e=n.charCodeAt(0);return e>=U4&&e<=B4}function Po(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}const Qw="__name__";class qa{constructor(e,t,i){t===void 0?t=0:t>e.length&&rt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&rt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return qa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qa?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const c=qa.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return _t(e.length,t.length)}static compareSegments(e,t){const i=qa.isNumericId(e),o=qa.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?qa.extractNumericId(e).compare(qa.extractNumericId(t)):G0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Si.fromString(e.substring(4,e.length-2))}}class as extends qa{construct(e,t,i){return new as(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Me(we.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new as(t)}static emptyPath(){return new as([])}}const z4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Xs extends qa{construct(e,t,i){return new Xs(e,t,i)}static isValidIdentifier(e){return z4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Xs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Qw}static keyField(){return new Xs([Qw])}static fromServerFormat(e){const t=[];let i="",o=0;const c=()=>{if(i.length===0)throw new Me(we.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;o<e.length;){const m=e[o];if(m==="\\"){if(o+1===e.length)throw new Me(we.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const x=e[o+1];if(x!=="\\"&&x!=="."&&x!=="`")throw new Me(we.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=x,o+=2}else m==="`"?(d=!d,o++):m!=="."||d?(i+=m,o++):(c(),o++)}if(c(),d)throw new Me(we.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Xs(t)}static emptyPath(){return new Xs([])}}class Je{constructor(e){this.path=e}static fromPath(e){return new Je(as.fromString(e))}static fromName(e){return new Je(as.fromString(e).popFirst(5))}static empty(){return new Je(as.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&as.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return as.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Je(new as(e.slice()))}}function Kj(n,e,t){if(!t)throw new Me(we.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function F4(n,e,t,i){if(e===!0&&i===!0)throw new Me(we.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Kw(n){if(!Je.isDocumentKey(n))throw new Me(we.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Xw(n){if(Je.isDocumentKey(n))throw new Me(we.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Xj(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Bf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":rt(12329,{type:typeof n})}function En(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Me(we.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Bf(n);throw new Me(we.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Is(n,e){const t={typeString:n};return e&&(t.value=e),t}function Yu(n,e){if(!Xj(n))throw new Me(we.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,c="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(o&&typeof d!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(c!==void 0&&d!==c.value){t=`Expected '${i}' field to equal '${c.value}'`;break}}if(t)throw new Me(we.INVALID_ARGUMENT,t);return!0}const Jw=-62135596800,Zw=1e6;class zt{static now(){return zt.fromMillis(Date.now())}static fromDate(e){return zt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*Zw);return new zt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Me(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Me(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Jw)throw new Me(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Me(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Zw}_compareTo(e){return this.seconds===e.seconds?_t(this.nanoseconds,e.nanoseconds):_t(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:zt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yu(e,zt._jsonSchema))return new zt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Jw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}zt._jsonSchemaVersion="firestore/timestamp/1.0",zt._jsonSchema={type:Is("string",zt._jsonSchemaVersion),seconds:Is("number"),nanoseconds:Is("number")};class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new zt(0,0))}static max(){return new lt(new zt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Au=-1;function $4(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=lt.fromTimestamp(i===1e9?new zt(t+1,0):new zt(t,i));return new ki(o,Je.empty(),e)}function q4(n){return new ki(n.readTime,n.key,Au)}class ki{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ki(lt.min(),Je.empty(),Au)}static max(){return new ki(lt.max(),Je.empty(),Au)}}function H4(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Je.comparator(n.documentKey,e.documentKey),t!==0?t:_t(n.largestBatchId,e.largestBatchId))}const G4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Y4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Xo(n){if(n.code!==we.FAILED_PRECONDITION||n.message!==G4)throw n;Pe("LocalStore","Unexpectedly lost primary lease")}class Ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&rt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ne(((i,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(i,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ne?t:Ne.resolve(t)}catch(t){return Ne.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.reject(t)}static resolve(e){return new Ne(((t,i)=>{t(e)}))}static reject(e){return new Ne(((t,i)=>{i(e)}))}static waitFor(e){return new Ne(((t,i)=>{let o=0,c=0,d=!1;e.forEach((m=>{++o,m.next((()=>{++c,d&&c===o&&t()}),(x=>i(x)))})),d=!0,c===o&&t()}))}static or(e){let t=Ne.resolve(!1);for(const i of e)t=t.next((o=>o?Ne.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,c)=>{i.push(t.call(this,o,c))})),this.waitFor(i)}static mapArray(e,t){return new Ne(((i,o)=>{const c=e.length,d=new Array(c);let m=0;for(let x=0;x<c;x++){const g=x;t(e[g]).next((b=>{d[g]=b,++m,m===c&&i(d)}),(b=>o(b)))}}))}static doWhile(e,t){return new Ne(((i,o)=>{const c=()=>{e()===!0?t().next((()=>{c()}),o):i()};c()}))}}function W4(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Jo(n){return n.name==="IndexedDbTransactionError"}class zf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}zf.ce=-1;const $x=-1;function Ff(n){return n==null}function df(n){return n===0&&1/n==-1/0}function Q4(n){return typeof n=="number"&&Number.isInteger(n)&&!df(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Jj="";function K4(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=eN(e)),e=X4(n.get(t),e);return eN(e)}function X4(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case Jj:t+="";break;default:t+=c}}return t}function eN(n){return n+Jj+""}function tN(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Vi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Zj(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class fs{constructor(e,t){this.comparator=e,this.root=t||Ks.EMPTY}insert(e,t){return new fs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ks.BLACK,null,null))}remove(e){return new fs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ks.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new jh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new jh(this.root,e,this.comparator,!1)}getReverseIterator(){return new jh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new jh(this.root,e,this.comparator,!0)}}class jh{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?i(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ks{constructor(e,t,i,o,c){this.key=e,this.value=t,this.color=i??Ks.RED,this.left=o??Ks.EMPTY,this.right=c??Ks.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,c){return new Ks(e??this.key,t??this.value,i??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const c=i(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,i),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Ks.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Ks.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ks.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ks.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw rt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw rt(27949);return e+(this.isRed()?0:1)}}Ks.EMPTY=null,Ks.RED=!0,Ks.BLACK=!1;Ks.EMPTY=new class{constructor(){this.size=0}get key(){throw rt(57766)}get value(){throw rt(16141)}get color(){throw rt(16727)}get left(){throw rt(29726)}get right(){throw rt(36894)}copy(e,t,i,o,c){return this}insert(e,t,i){return new Ks(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Us{constructor(e){this.comparator=e,this.data=new fs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new sN(this.data.getIterator())}getIteratorFrom(e){return new sN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Us)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Us(this.comparator);return t.data=e,t}}class sN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Bn{constructor(e){this.fields=e,e.sort(Xs.comparator)}static empty(){return new Bn([])}unionWith(e){let t=new Us(Xs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Bn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Po(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class e_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Zs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new e_("Invalid base64 string: "+c):c}})(e);return new Zs(t)}static fromUint8Array(e){const t=(function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c})(e);return new Zs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return _t(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Zs.EMPTY_BYTE_STRING=new Zs("");const J4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ci(n){if($t(!!n,39018),typeof n=="string"){let e=0;const t=J4.exec(n);if($t(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:js(n.seconds),nanos:js(n.nanos)}}function js(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ri(n){return typeof n=="string"?Zs.fromBase64String(n):Zs.fromUint8Array(n)}const t_="server_timestamp",s_="__type__",n_="__previous_value__",a_="__local_write_time__";function qx(n){return(n?.mapValue?.fields||{})[s_]?.stringValue===t_}function $f(n){const e=n.mapValue.fields[n_];return qx(e)?$f(e):e}function ku(n){const e=Ci(n.mapValue.fields[a_].timestampValue);return new zt(e.seconds,e.nanos)}class Z4{constructor(e,t,i,o,c,d,m,x,g,b,w){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=m,this.longPollingOptions=x,this.useFetchStreams=g,this.isUsingEmulator=b,this.apiKey=w}}const hf="(default)";class Cu{constructor(e,t){this.projectId=e,this.database=t||hf}static empty(){return new Cu("","")}get isDefaultDatabase(){return this.database===hf}isEqual(e){return e instanceof Cu&&e.projectId===this.projectId&&e.database===this.database}}function eR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Me(we.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cu(n.options.projectId,e)}const r_="__type__",tR="__max__",_h={mapValue:{}},i_="__vector__",ff="value";function Ii(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?qx(n)?4:nR(n)?9007199254740991:sR(n)?10:11:rt(28295,{value:n})}function er(n,e){if(n===e)return!0;const t=Ii(n);if(t!==Ii(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ku(n).isEqual(ku(e));case 3:return(function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=Ci(o.timestampValue),m=Ci(c.timestampValue);return d.seconds===m.seconds&&d.nanos===m.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,c){return Ri(o.bytesValue).isEqual(Ri(c.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,c){return js(o.geoPointValue.latitude)===js(c.geoPointValue.latitude)&&js(o.geoPointValue.longitude)===js(c.geoPointValue.longitude)})(n,e);case 2:return(function(o,c){if("integerValue"in o&&"integerValue"in c)return js(o.integerValue)===js(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=js(o.doubleValue),m=js(c.doubleValue);return d===m?df(d)===df(m):isNaN(d)&&isNaN(m)}return!1})(n,e);case 9:return Po(n.arrayValue.values||[],e.arrayValue.values||[],er);case 10:case 11:return(function(o,c){const d=o.mapValue.fields||{},m=c.mapValue.fields||{};if(tN(d)!==tN(m))return!1;for(const x in d)if(d.hasOwnProperty(x)&&(m[x]===void 0||!er(d[x],m[x])))return!1;return!0})(n,e);default:return rt(52216,{left:n})}}function Ru(n,e){return(n.values||[]).find((t=>er(t,e)))!==void 0}function Lo(n,e){if(n===e)return 0;const t=Ii(n),i=Ii(e);if(t!==i)return _t(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return _t(n.booleanValue,e.booleanValue);case 2:return(function(c,d){const m=js(c.integerValue||c.doubleValue),x=js(d.integerValue||d.doubleValue);return m<x?-1:m>x?1:m===x?0:isNaN(m)?isNaN(x)?0:-1:1})(n,e);case 3:return nN(n.timestampValue,e.timestampValue);case 4:return nN(ku(n),ku(e));case 5:return G0(n.stringValue,e.stringValue);case 6:return(function(c,d){const m=Ri(c),x=Ri(d);return m.compareTo(x)})(n.bytesValue,e.bytesValue);case 7:return(function(c,d){const m=c.split("/"),x=d.split("/");for(let g=0;g<m.length&&g<x.length;g++){const b=_t(m[g],x[g]);if(b!==0)return b}return _t(m.length,x.length)})(n.referenceValue,e.referenceValue);case 8:return(function(c,d){const m=_t(js(c.latitude),js(d.latitude));return m!==0?m:_t(js(c.longitude),js(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return aN(n.arrayValue,e.arrayValue);case 10:return(function(c,d){const m=c.fields||{},x=d.fields||{},g=m[ff]?.arrayValue,b=x[ff]?.arrayValue,w=_t(g?.values?.length||0,b?.values?.length||0);return w!==0?w:aN(g,b)})(n.mapValue,e.mapValue);case 11:return(function(c,d){if(c===_h.mapValue&&d===_h.mapValue)return 0;if(c===_h.mapValue)return 1;if(d===_h.mapValue)return-1;const m=c.fields||{},x=Object.keys(m),g=d.fields||{},b=Object.keys(g);x.sort(),b.sort();for(let w=0;w<x.length&&w<b.length;++w){const _=G0(x[w],b[w]);if(_!==0)return _;const R=Lo(m[x[w]],g[b[w]]);if(R!==0)return R}return _t(x.length,b.length)})(n.mapValue,e.mapValue);default:throw rt(23264,{he:t})}}function nN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return _t(n,e);const t=Ci(n),i=Ci(e),o=_t(t.seconds,i.seconds);return o!==0?o:_t(t.nanos,i.nanos)}function aN(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const c=Lo(t[o],i[o]);if(c)return c}return _t(t.length,i.length)}function Vo(n){return Y0(n)}function Y0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Ci(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ri(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Je.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const c of t.values||[])o?o=!1:i+=",",i+=Y0(c);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of i)c?c=!1:o+=",",o+=`${d}:${Y0(t.fields[d])}`;return o+"}"})(n.mapValue):rt(61005,{value:n})}function Fh(n){switch(Ii(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$f(n);return e?16+Fh(e):16;case 5:return 2*n.stringValue.length;case 6:return Ri(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,c)=>o+Fh(c)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return Vi(i.fields,((c,d)=>{o+=c.length+Fh(d)})),o})(n.mapValue);default:throw rt(13486,{value:n})}}function rN(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function W0(n){return!!n&&"integerValue"in n}function Hx(n){return!!n&&"arrayValue"in n}function iN(n){return!!n&&"nullValue"in n}function lN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function $h(n){return!!n&&"mapValue"in n}function sR(n){return(n?.mapValue?.fields||{})[r_]?.stringValue===i_}function gu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Vi(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=gu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gu(n.arrayValue.values[t]);return e}return{...n}}function nR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===tR}class Nn{constructor(e){this.value=e}static empty(){return new Nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!$h(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gu(t)}setAll(e){let t=Xs.emptyPath(),i={},o=[];e.forEach(((d,m)=>{if(!t.isImmediateParentOf(m)){const x=this.getFieldsMap(t);this.applyChanges(x,i,o),i={},o=[],t=m.popLast()}d?i[m.lastSegment()]=gu(d):o.push(m.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,i,o)}delete(e){const t=this.field(e.popLast());$h(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return er(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];$h(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Vi(t,((o,c)=>e[o]=c));for(const o of i)delete e[o]}clone(){return new Nn(gu(this.value))}}function l_(n){const e=[];return Vi(n.fields,((t,i)=>{const o=new Xs([t]);if($h(i)){const c=l_(i.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)})),new Bn(e)}class nn{constructor(e,t,i,o,c,d,m){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=c,this.data=d,this.documentState=m}static newInvalidDocument(e){return new nn(e,0,lt.min(),lt.min(),lt.min(),Nn.empty(),0)}static newFoundDocument(e,t,i,o){return new nn(e,1,t,lt.min(),i,o,0)}static newNoDocument(e,t){return new nn(e,2,t,lt.min(),lt.min(),Nn.empty(),0)}static newUnknownDocument(e,t){return new nn(e,3,t,lt.min(),lt.min(),Nn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof nn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new nn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class mf{constructor(e,t){this.position=e,this.inclusive=t}}function oN(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?i=Je.comparator(Je.fromName(d.referenceValue),t.key):i=Lo(d,t.data.field(c.field)),c.dir==="desc"&&(i*=-1),i!==0)break}return i}function cN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!er(n.position[t],e.position[t]))return!1;return!0}class pf{constructor(e,t="asc"){this.field=e,this.dir=t}}function aR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class o_{}class Rs extends o_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new iR(e,t,i):t==="array-contains"?new cR(e,i):t==="in"?new uR(e,i):t==="not-in"?new dR(e,i):t==="array-contains-any"?new hR(e,i):new Rs(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new lR(e,i):new oR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Lo(t,this.value)):t!==null&&Ii(this.value)===Ii(t)&&this.matchesComparison(Lo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return rt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _a extends o_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new _a(e,t)}matches(e){return c_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function c_(n){return n.op==="and"}function u_(n){return rR(n)&&c_(n)}function rR(n){for(const e of n.filters)if(e instanceof _a)return!1;return!0}function Q0(n){if(n instanceof Rs)return n.field.canonicalString()+n.op.toString()+Vo(n.value);if(u_(n))return n.filters.map((e=>Q0(e))).join(",");{const e=n.filters.map((t=>Q0(t))).join(",");return`${n.op}(${e})`}}function d_(n,e){return n instanceof Rs?(function(i,o){return o instanceof Rs&&i.op===o.op&&i.field.isEqual(o.field)&&er(i.value,o.value)})(n,e):n instanceof _a?(function(i,o){return o instanceof _a&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((c,d,m)=>c&&d_(d,o.filters[m])),!0):!1})(n,e):void rt(19439)}function h_(n){return n instanceof Rs?(function(t){return`${t.field.canonicalString()} ${t.op} ${Vo(t.value)}`})(n):n instanceof _a?(function(t){return t.op.toString()+" {"+t.getFilters().map(h_).join(" ,")+"}"})(n):"Filter"}class iR extends Rs{constructor(e,t,i){super(e,t,i),this.key=Je.fromName(i.referenceValue)}matches(e){const t=Je.comparator(e.key,this.key);return this.matchesComparison(t)}}class lR extends Rs{constructor(e,t){super(e,"in",t),this.keys=f_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class oR extends Rs{constructor(e,t){super(e,"not-in",t),this.keys=f_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function f_(n,e){return(e.arrayValue?.values||[]).map((t=>Je.fromName(t.referenceValue)))}class cR extends Rs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Hx(t)&&Ru(t.arrayValue,this.value)}}class uR extends Rs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ru(this.value.arrayValue,t)}}class dR extends Rs{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ru(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ru(this.value.arrayValue,t)}}class hR extends Rs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Hx(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Ru(this.value.arrayValue,i)))}}class fR{constructor(e,t=null,i=[],o=[],c=null,d=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=c,this.startAt=d,this.endAt=m,this.Te=null}}function uN(n,e=null,t=[],i=[],o=null,c=null,d=null){return new fR(n,e,t,i,o,c,d)}function Gx(n){const e=ut(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Q0(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(c){return c.field.canonicalString()+c.dir})(i))).join(","),Ff(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Vo(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Vo(i))).join(",")),e.Te=t}return e.Te}function Yx(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!aR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!d_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!cN(n.startAt,e.startAt)&&cN(n.endAt,e.endAt)}function K0(n){return Je.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Wu{constructor(e,t=null,i=[],o=[],c=null,d="F",m=null,x=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=c,this.limitType=d,this.startAt=m,this.endAt=x,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function mR(n,e,t,i,o,c,d,m){return new Wu(n,e,t,i,o,c,d,m)}function qf(n){return new Wu(n)}function dN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function pR(n){return Je.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function m_(n){return n.collectionGroup!==null}function bu(n){const e=ut(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),t.add(c.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let m=new Us(Xs.comparator);return d.filters.forEach((x=>{x.getFlattenedFilters().forEach((g=>{g.isInequality()&&(m=m.add(g.field))}))})),m})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new pf(c,i))})),t.has(Xs.keyField().canonicalString())||e.Ie.push(new pf(Xs.keyField(),i))}return e.Ie}function Ka(n){const e=ut(n);return e.Ee||(e.Ee=xR(e,bu(n))),e.Ee}function xR(n,e){if(n.limitType==="F")return uN(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const c=o.dir==="desc"?"asc":"desc";return new pf(o.field,c)}));const t=n.endAt?new mf(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new mf(n.startAt.position,n.startAt.inclusive):null;return uN(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function X0(n,e){const t=n.filters.concat([e]);return new Wu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function J0(n,e,t){return new Wu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Hf(n,e){return Yx(Ka(n),Ka(e))&&n.limitType===e.limitType}function p_(n){return`${Gx(Ka(n))}|lt:${n.limitType}`}function No(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>h_(o))).join(", ")}]`),Ff(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>Vo(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>Vo(o))).join(",")),`Target(${i})`})(Ka(n))}; limitType=${n.limitType})`}function Gf(n,e){return e.isFoundDocument()&&(function(i,o){const c=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(c):Je.isDocumentKey(i.path)?i.path.isEqual(c):i.path.isImmediateParentOf(c)})(n,e)&&(function(i,o){for(const c of bu(i))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const c of i.filters)if(!c.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(d,m,x){const g=oN(d,m,x);return d.inclusive?g<=0:g<0})(i.startAt,bu(i),o)||i.endAt&&!(function(d,m,x){const g=oN(d,m,x);return d.inclusive?g>=0:g>0})(i.endAt,bu(i),o))})(n,e)}function gR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function x_(n){return(e,t)=>{let i=!1;for(const o of bu(n)){const c=bR(o,e,t);if(c!==0)return c;i=i||o.field.isKeyField()}return 0}}function bR(n,e,t){const i=n.field.isKeyField()?Je.comparator(e.key,t.key):(function(c,d,m){const x=d.data.field(c),g=m.data.field(c);return x!==null&&g!==null?Lo(x,g):rt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return rt(19790,{direction:n.dir})}}class kl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,c]of i)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Vi(this.inner,((t,i)=>{for(const[o,c]of i)e(o,c)}))}isEmpty(){return Zj(this.inner)}size(){return this.innerSize}}const yR=new fs(Je.comparator);function Or(){return yR}const g_=new fs(Je.comparator);function du(...n){let e=g_;for(const t of n)e=e.insert(t.key,t);return e}function b_(n){let e=g_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function pl(){return yu()}function y_(){return yu()}function yu(){return new kl((n=>n.toString()),((n,e)=>n.isEqual(e)))}const vR=new fs(Je.comparator),wR=new Us(Je.comparator);function St(...n){let e=wR;for(const t of n)e=e.add(t);return e}const NR=new Us(_t);function jR(){return NR}function Wx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:df(e)?"-0":e}}function v_(n){return{integerValue:""+n}}function _R(n,e){return Q4(e)?v_(e):Wx(n,e)}class Yf{constructor(){this._=void 0}}function SR(n,e,t){return n instanceof Iu?(function(o,c){const d={fields:{[s_]:{stringValue:t_},[a_]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&qx(c)&&(c=$f(c)),c&&(d.fields[n_]=c),{mapValue:d}})(t,e):n instanceof Du?N_(n,e):n instanceof Mu?j_(n,e):(function(o,c){const d=w_(o,c),m=hN(d)+hN(o.Ae);return W0(d)&&W0(o.Ae)?v_(m):Wx(o.serializer,m)})(n,e)}function ER(n,e,t){return n instanceof Du?N_(n,e):n instanceof Mu?j_(n,e):t}function w_(n,e){return n instanceof xf?(function(i){return W0(i)||(function(c){return!!c&&"doubleValue"in c})(i)})(e)?e:{integerValue:0}:null}class Iu extends Yf{}class Du extends Yf{constructor(e){super(),this.elements=e}}function N_(n,e){const t=__(e);for(const i of n.elements)t.some((o=>er(o,i)))||t.push(i);return{arrayValue:{values:t}}}class Mu extends Yf{constructor(e){super(),this.elements=e}}function j_(n,e){let t=__(e);for(const i of n.elements)t=t.filter((o=>!er(o,i)));return{arrayValue:{values:t}}}class xf extends Yf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function hN(n){return js(n.integerValue||n.doubleValue)}function __(n){return Hx(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class TR{constructor(e,t){this.field=e,this.transform=t}}function AR(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof Du&&o instanceof Du||i instanceof Mu&&o instanceof Mu?Po(i.elements,o.elements,er):i instanceof xf&&o instanceof xf?er(i.Ae,o.Ae):i instanceof Iu&&o instanceof Iu})(n.transform,e.transform)}class kR{constructor(e,t){this.version=e,this.transformResults=t}}class oa{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new oa}static exists(e){return new oa(void 0,e)}static updateTime(e){return new oa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Wf{}function S_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qx(n.key,oa.none()):new Qu(n.key,n.data,oa.none());{const t=n.data,i=Nn.empty();let o=new Us(Xs.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?i.delete(c):i.set(c,d),o=o.add(c)}return new Ui(n.key,i,new Bn(o.toArray()),oa.none())}}function CR(n,e,t){n instanceof Qu?(function(o,c,d){const m=o.value.clone(),x=mN(o.fieldTransforms,c,d.transformResults);m.setAll(x),c.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):n instanceof Ui?(function(o,c,d){if(!qh(o.precondition,c))return void c.convertToUnknownDocument(d.version);const m=mN(o.fieldTransforms,c,d.transformResults),x=c.data;x.setAll(E_(o)),x.setAll(m),c.convertToFoundDocument(d.version,x).setHasCommittedMutations()})(n,e,t):(function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function vu(n,e,t,i){return n instanceof Qu?(function(c,d,m,x){if(!qh(c.precondition,d))return m;const g=c.value.clone(),b=pN(c.fieldTransforms,x,d);return g.setAll(b),d.convertToFoundDocument(d.version,g).setHasLocalMutations(),null})(n,e,t,i):n instanceof Ui?(function(c,d,m,x){if(!qh(c.precondition,d))return m;const g=pN(c.fieldTransforms,x,d),b=d.data;return b.setAll(E_(c)),b.setAll(g),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),m===null?null:m.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((w=>w.field)))})(n,e,t,i):(function(c,d,m){return qh(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):m})(n,e,t)}function RR(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),c=w_(i.transform,o||null);c!=null&&(t===null&&(t=Nn.empty()),t.set(i.field,c))}return t||null}function fN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Po(i,o,((c,d)=>AR(c,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Qu extends Wf{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Ui extends Wf{constructor(e,t,i,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function E_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function mN(n,e,t){const i=new Map;$t(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,m=e.data.field(c.field);i.set(c.field,ER(d,m,t[o]))}return i}function pN(n,e,t){const i=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);i.set(o.field,SR(c,d,e))}return i}class Qx extends Wf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class IR extends Wf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class DR{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&CR(c,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=vu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=vu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=y_();return this.mutations.forEach((o=>{const c=e.get(o.key),d=c.overlayedDocument;let m=this.applyToLocalView(d,c.mutatedFields);m=t.has(o.key)?null:m;const x=S_(d,m);x!==null&&i.set(o.key,x),d.isValidDocument()||d.convertToNoDocument(lt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),St())}isEqual(e){return this.batchId===e.batchId&&Po(this.mutations,e.mutations,((t,i)=>fN(t,i)))&&Po(this.baseMutations,e.baseMutations,((t,i)=>fN(t,i)))}}class Kx{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){$t(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return vR})();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,i[d].version);return new Kx(e,t,i,o)}}class MR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class OR{constructor(e,t){this.count=e,this.unchangedNames=t}}var Cs,kt;function PR(n){switch(n){case we.OK:return rt(64938);case we.CANCELLED:case we.UNKNOWN:case we.DEADLINE_EXCEEDED:case we.RESOURCE_EXHAUSTED:case we.INTERNAL:case we.UNAVAILABLE:case we.UNAUTHENTICATED:return!1;case we.INVALID_ARGUMENT:case we.NOT_FOUND:case we.ALREADY_EXISTS:case we.PERMISSION_DENIED:case we.FAILED_PRECONDITION:case we.ABORTED:case we.OUT_OF_RANGE:case we.UNIMPLEMENTED:case we.DATA_LOSS:return!0;default:return rt(15467,{code:n})}}function T_(n){if(n===void 0)return Mr("GRPC error has no .code"),we.UNKNOWN;switch(n){case Cs.OK:return we.OK;case Cs.CANCELLED:return we.CANCELLED;case Cs.UNKNOWN:return we.UNKNOWN;case Cs.DEADLINE_EXCEEDED:return we.DEADLINE_EXCEEDED;case Cs.RESOURCE_EXHAUSTED:return we.RESOURCE_EXHAUSTED;case Cs.INTERNAL:return we.INTERNAL;case Cs.UNAVAILABLE:return we.UNAVAILABLE;case Cs.UNAUTHENTICATED:return we.UNAUTHENTICATED;case Cs.INVALID_ARGUMENT:return we.INVALID_ARGUMENT;case Cs.NOT_FOUND:return we.NOT_FOUND;case Cs.ALREADY_EXISTS:return we.ALREADY_EXISTS;case Cs.PERMISSION_DENIED:return we.PERMISSION_DENIED;case Cs.FAILED_PRECONDITION:return we.FAILED_PRECONDITION;case Cs.ABORTED:return we.ABORTED;case Cs.OUT_OF_RANGE:return we.OUT_OF_RANGE;case Cs.UNIMPLEMENTED:return we.UNIMPLEMENTED;case Cs.DATA_LOSS:return we.DATA_LOSS;default:return rt(39323,{code:n})}}(kt=Cs||(Cs={}))[kt.OK=0]="OK",kt[kt.CANCELLED=1]="CANCELLED",kt[kt.UNKNOWN=2]="UNKNOWN",kt[kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kt[kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kt[kt.NOT_FOUND=5]="NOT_FOUND",kt[kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",kt[kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",kt[kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",kt[kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kt[kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kt[kt.ABORTED=10]="ABORTED",kt[kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",kt[kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",kt[kt.INTERNAL=13]="INTERNAL",kt[kt.UNAVAILABLE=14]="UNAVAILABLE",kt[kt.DATA_LOSS=15]="DATA_LOSS";function LR(){return new TextEncoder}const VR=new Si([4294967295,4294967295],0);function xN(n){const e=LR().encode(n),t=new Fj;return t.update(e),new Uint8Array(t.digest())}function gN(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new Si([t,i],0),new Si([o,c],0)]}class Xx{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new hu(`Invalid padding: ${t}`);if(i<0)throw new hu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new hu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new hu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Si.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(Si.fromNumber(i)));return o.compare(VR)===1&&(o=new Si([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=xN(e),[i,o]=gN(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(i,o,c);if(!this.we(d))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Xx(c,o,t);return i.forEach((m=>d.insert(m))),d}insert(e){if(this.ge===0)return;const t=xN(e),[i,o]=gN(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(i,o,c);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class hu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Qf{constructor(e,t,i,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Ku.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Qf(lt.min(),o,new fs(_t),Or(),St())}}class Ku{constructor(e,t,i,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ku(i,t,St(),St(),St())}}class Hh{constructor(e,t,i,o){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=o}}class A_{constructor(e,t){this.targetId=e,this.Ce=t}}class k_{constructor(e,t,i=Zs.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class bN{constructor(){this.ve=0,this.Fe=yN(),this.Me=Zs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=St(),t=St(),i=St();return this.Fe.forEach(((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:rt(38017,{changeType:c})}})),new Ku(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=yN()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,$t(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class UR{constructor(e){this.Ge=e,this.ze=new Map,this.je=Or(),this.He=Sh(),this.Je=Sh(),this.Ze=new fs(_t)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:rt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const c=o.target;if(K0(c))if(i===0){const d=new Je(c.path);this.et(t,d,nn.newNoDocument(d,lt.min()))}else $t(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const m=this.ut(e),x=m?this.ct(m,e,d):1;if(x!==0){this.it(t);const g=x===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:c=0}=t;let d,m;try{d=Ri(i).toUint8Array()}catch(x){if(x instanceof e_)return Oo("Decoding the base64 bloom filter in existence filter failed ("+x.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw x}try{m=new Xx(d,o,c)}catch(x){return Oo(x instanceof hu?"BloomFilter error: ":"Applying bloom filter failed: ",x),null}return m.ge===0?null:m}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((c=>{const d=this.Ge.ht(),m=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(m)||(this.et(t,c,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((c,d)=>{const m=this.ot(d);if(m){if(c.current&&K0(m.target)){const x=new Je(m.target.path);this.It(x).has(d)||this.Et(d,x)||this.et(d,x,nn.newNoDocument(x,e))}c.Be&&(t.set(d,c.ke()),c.Ke())}}));let i=St();this.Je.forEach(((c,d)=>{let m=!0;d.forEachWhile((x=>{const g=this.ot(x);return!g||g.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(i=i.add(c))})),this.je.forEach(((c,d)=>d.setReadTime(e)));const o=new Qf(e,t,this.Ze,this.je,i);return this.je=Or(),this.He=Sh(),this.Je=Sh(),this.Ze=new fs(_t),o}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.qe(t,1):o.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new bN,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Us(_t),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Us(_t),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new bN),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Sh(){return new fs(Je.comparator)}function yN(){return new fs(Je.comparator)}const BR={asc:"ASCENDING",desc:"DESCENDING"},zR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},FR={and:"AND",or:"OR"};class $R{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Z0(n,e){return n.useProto3Json||Ff(e)?e:{value:e}}function gf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function C_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function qR(n,e){return gf(n,e.toTimestamp())}function Xa(n){return $t(!!n,49232),lt.fromTimestamp((function(t){const i=Ci(t);return new zt(i.seconds,i.nanos)})(n))}function Jx(n,e){return ex(n,e).canonicalString()}function ex(n,e){const t=(function(o){return new as(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function R_(n){const e=as.fromString(n);return $t(P_(e),10190,{key:e.toString()}),e}function tx(n,e){return Jx(n.databaseId,e.path)}function y0(n,e){const t=R_(e);if(t.get(1)!==n.databaseId.projectId)throw new Me(we.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Me(we.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Je(D_(t))}function I_(n,e){return Jx(n.databaseId,e)}function HR(n){const e=R_(n);return e.length===4?as.emptyPath():D_(e)}function sx(n){return new as(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function D_(n){return $t(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function vN(n,e,t){return{name:tx(n,e),fields:t.value.mapValue.fields}}function GR(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:rt(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=(function(g,b){return g.useProto3Json?($t(b===void 0||typeof b=="string",58123),Zs.fromBase64String(b||"")):($t(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Zs.fromUint8Array(b||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,m=d&&(function(g){const b=g.code===void 0?we.UNKNOWN:T_(g.code);return new Me(b,g.message||"")})(d);t=new k_(i,o,c,m||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=y0(n,i.document.name),c=Xa(i.document.updateTime),d=i.document.createTime?Xa(i.document.createTime):lt.min(),m=new Nn({mapValue:{fields:i.document.fields}}),x=nn.newFoundDocument(o,c,d,m),g=i.targetIds||[],b=i.removedTargetIds||[];t=new Hh(g,b,x.key,x)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=y0(n,i.document),c=i.readTime?Xa(i.readTime):lt.min(),d=nn.newNoDocument(o,c),m=i.removedTargetIds||[];t=new Hh([],m,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=y0(n,i.document),c=i.removedTargetIds||[];t=new Hh([],c,o,null)}else{if(!("filter"in e))return rt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:c}=i,d=new OR(o,c),m=i.targetId;t=new A_(m,d)}}return t}function YR(n,e){let t;if(e instanceof Qu)t={update:vN(n,e.key,e.value)};else if(e instanceof Qx)t={delete:tx(n,e.key)};else if(e instanceof Ui)t={update:vN(n,e.key,e.data),updateMask:s6(e.fieldMask)};else{if(!(e instanceof IR))return rt(16599,{dt:e.type});t={verify:tx(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(c,d){const m=d.transform;if(m instanceof Iu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Du)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Mu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof xf)return{fieldPath:d.field.canonicalString(),increment:m.Ae};throw rt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(o,c){return c.updateTime!==void 0?{updateTime:qR(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:rt(27497)})(n,e.precondition)),t}function WR(n,e){return n&&n.length>0?($t(e!==void 0,14353),n.map((t=>(function(o,c){let d=o.updateTime?Xa(o.updateTime):Xa(c);return d.isEqual(lt.min())&&(d=Xa(c)),new kR(d,o.transformResults||[])})(t,e)))):[]}function QR(n,e){return{documents:[I_(n,e.path)]}}function KR(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=I_(n,o);const c=(function(g){if(g.length!==0)return O_(_a.create(g,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const d=(function(g){if(g.length!==0)return g.map((b=>(function(_){return{field:jo(_.field),direction:ZR(_.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const m=Z0(n,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:o}}function XR(n){let e=HR(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){$t(i===1,65062);const b=t.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let c=[];t.where&&(c=(function(w){const _=M_(w);return _ instanceof _a&&u_(_)?_.getFilters():[_]})(t.where));let d=[];t.orderBy&&(d=(function(w){return w.map((_=>(function(B){return new pf(_o(B.field),(function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(_)))})(t.orderBy));let m=null;t.limit&&(m=(function(w){let _;return _=typeof w=="object"?w.value:w,Ff(_)?null:_})(t.limit));let x=null;t.startAt&&(x=(function(w){const _=!!w.before,R=w.values||[];return new mf(R,_)})(t.startAt));let g=null;return t.endAt&&(g=(function(w){const _=!w.before,R=w.values||[];return new mf(R,_)})(t.endAt)),mR(e,o,d,c,m,"F",x,g)}function JR(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function M_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=_o(t.unaryFilter.field);return Rs.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=_o(t.unaryFilter.field);return Rs.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=_o(t.unaryFilter.field);return Rs.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=_o(t.unaryFilter.field);return Rs.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return rt(61313);default:return rt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Rs.create(_o(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return rt(58110);default:return rt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return _a.create(t.compositeFilter.filters.map((i=>M_(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return rt(1026)}})(t.compositeFilter.op))})(n):rt(30097,{filter:n})}function ZR(n){return BR[n]}function e6(n){return zR[n]}function t6(n){return FR[n]}function jo(n){return{fieldPath:n.canonicalString()}}function _o(n){return Xs.fromServerFormat(n.fieldPath)}function O_(n){return n instanceof Rs?(function(t){if(t.op==="=="){if(lN(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NAN"}};if(iN(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(lN(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NAN"}};if(iN(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jo(t.field),op:e6(t.op),value:t.value}}})(n):n instanceof _a?(function(t){const i=t.getFilters().map((o=>O_(o)));return i.length===1?i[0]:{compositeFilter:{op:t6(t.op),filters:i}}})(n):rt(54877,{filter:n})}function s6(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function P_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function L_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class Ni{constructor(e,t,i,o,c=lt.min(),d=lt.min(),m=Zs.EMPTY_BYTE_STRING,x=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=m,this.expectedCount=x}withSequenceNumber(e){return new Ni(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ni(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ni(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ni(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class n6{constructor(e){this.yt=e}}function a6(n){const e=XR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?J0(e,e.limit,"L"):e}class r6{constructor(){this.Sn=new i6}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ne.resolve()}getCollectionParents(e,t){return Ne.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ne.resolve()}deleteFieldIndex(e,t){return Ne.resolve()}deleteAllFieldIndexes(e){return Ne.resolve()}createTargetIndexes(e,t){return Ne.resolve()}getDocumentsMatchingTarget(e,t){return Ne.resolve(null)}getIndexType(e,t){return Ne.resolve(0)}getFieldIndexes(e,t){return Ne.resolve([])}getNextCollectionGroupToUpdate(e){return Ne.resolve(null)}getMinOffset(e,t){return Ne.resolve(ki.min())}getMinOffsetFromCollectionGroup(e,t){return Ne.resolve(ki.min())}updateCollectionGroup(e,t,i){return Ne.resolve()}updateIndexEntries(e,t){return Ne.resolve()}}class i6{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new Us(as.comparator),c=!o.has(i);return this.index[t]=o.add(i),c}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new Us(as.comparator)).toArray()}}const wN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},V_=41943040;class vn{static withCacheSize(e){return new vn(e,vn.DEFAULT_COLLECTION_PERCENTILE,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}vn.DEFAULT_COLLECTION_PERCENTILE=10,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vn.DEFAULT=new vn(V_,vn.DEFAULT_COLLECTION_PERCENTILE,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vn.DISABLED=new vn(-1,0,0);class Uo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Uo(0)}static ar(){return new Uo(-1)}}const NN="LruGarbageCollector",l6=1048576;function jN([n,e],[t,i]){const o=_t(n,t);return o===0?_t(e,i):o}class o6{constructor(e){this.Pr=e,this.buffer=new Us(jN),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();jN(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class c6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Pe(NN,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Jo(t)?Pe(NN,"Ignoring IndexedDB error during garbage collection: ",t):await Xo(t)}await this.Ar(3e5)}))}}class u6{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ne.resolve(zf.ce);const i=new o6(t);return this.Vr.forEachTarget(e,(o=>i.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>i.Er(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Pe("LruGarbageCollector","Garbage collection skipped; disabled"),Ne.resolve(wN)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),wN):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,o,c,d,m,x,g;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(Pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),o=this.params.maximumSequenceNumbersToCollect):o=w,d=Date.now(),this.nthSequenceNumber(e,o)))).next((w=>(i=w,m=Date.now(),this.removeTargets(e,i,t)))).next((w=>(c=w,x=Date.now(),this.removeOrphanedDocuments(e,i)))).next((w=>(g=Date.now(),wo()<=jt.DEBUG&&Pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${o} in `+(m-d)+`ms
	Removed ${c} targets in `+(x-m)+`ms
	Removed ${w} documents in `+(g-x)+`ms
Total Duration: ${g-b}ms`),Ne.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:w}))))}}function d6(n,e){return new u6(n,e)}class h6{constructor(){this.changes=new kl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,nn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ne.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class f6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class m6{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&vu(i.mutation,o,Bn.empty(),zt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,St()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=St()){const o=pl();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((c=>{let d=du();return c.forEach(((m,x)=>{d=d.insert(m,x.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=pl();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,St())))}populateOverlays(e,t,i){const o=[];return i.forEach((c=>{t.has(c)||o.push(c)})),this.documentOverlayCache.getOverlays(e,o).next((c=>{c.forEach(((d,m)=>{t.set(d,m)}))}))}computeViews(e,t,i,o){let c=Or();const d=yu(),m=(function(){return yu()})();return t.forEach(((x,g)=>{const b=i.get(g.key);o.has(g.key)&&(b===void 0||b.mutation instanceof Ui)?c=c.insert(g.key,g):b!==void 0?(d.set(g.key,b.mutation.getFieldMask()),vu(b.mutation,g,b.mutation.getFieldMask(),zt.now())):d.set(g.key,Bn.empty())})),this.recalculateAndSaveOverlays(e,c).next((x=>(x.forEach(((g,b)=>d.set(g,b))),t.forEach(((g,b)=>m.set(g,new f6(b,d.get(g)??null)))),m)))}recalculateAndSaveOverlays(e,t){const i=yu();let o=new fs(((d,m)=>d-m)),c=St();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const m of d)m.keys().forEach((x=>{const g=t.get(x);if(g===null)return;let b=i.get(x)||Bn.empty();b=m.applyToLocalView(g,b),i.set(x,b);const w=(o.get(m.batchId)||St()).add(x);o=o.insert(m.batchId,w)}))})).next((()=>{const d=[],m=o.getReverseIterator();for(;m.hasNext();){const x=m.getNext(),g=x.key,b=x.value,w=y_();b.forEach((_=>{if(!c.has(_)){const R=S_(t.get(_),i.get(_));R!==null&&w.set(_,R),c=c.add(_)}})),d.push(this.documentOverlayCache.saveOverlays(e,g,w))}return Ne.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return pR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):m_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-c.size):Ne.resolve(pl());let m=Au,x=c;return d.next((g=>Ne.forEach(g,((b,w)=>(m<w.largestBatchId&&(m=w.largestBatchId),c.get(b)?Ne.resolve():this.remoteDocumentCache.getEntry(e,b).next((_=>{x=x.insert(b,_)}))))).next((()=>this.populateOverlays(e,g,c))).next((()=>this.computeViews(e,x,g,St()))).next((b=>({batchId:m,changes:b_(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Je(t)).next((i=>{let o=du();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const c=t.collectionGroup;let d=du();return this.indexManager.getCollectionParents(e,c).next((m=>Ne.forEach(m,(x=>{const g=(function(w,_){return new Wu(_,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,x.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,i,o).next((b=>{b.forEach(((w,_)=>{d=d.insert(w,_)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,c,o)))).next((d=>{c.forEach(((x,g)=>{const b=g.getKey();d.get(b)===null&&(d=d.insert(b,nn.newInvalidDocument(b)))}));let m=du();return d.forEach(((x,g)=>{const b=c.get(x);b!==void 0&&vu(b.mutation,g,Bn.empty(),zt.now()),Gf(t,g)&&(m=m.insert(x,g))})),m}))}}class p6{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ne.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Xa(o.createTime)}})(t)),Ne.resolve()}getNamedQuery(e,t){return Ne.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(o){return{name:o.name,query:a6(o.bundledQuery),readTime:Xa(o.readTime)}})(t)),Ne.resolve()}}class x6{constructor(){this.overlays=new fs(Je.comparator),this.Lr=new Map}getOverlay(e,t){return Ne.resolve(this.overlays.get(t))}getOverlays(e,t){const i=pl();return Ne.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&i.set(o,c)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,c)=>{this.bt(e,t,c)})),Ne.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.Lr.get(i);return o!==void 0&&(o.forEach((c=>this.overlays=this.overlays.remove(c))),this.Lr.delete(i)),Ne.resolve()}getOverlaysForCollection(e,t,i){const o=pl(),c=t.length+1,d=new Je(t.child("")),m=this.overlays.getIteratorFrom(d);for(;m.hasNext();){const x=m.getNext().value,g=x.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&x.largestBatchId>i&&o.set(x.getKey(),x)}return Ne.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let c=new fs(((g,b)=>g-b));const d=this.overlays.getIterator();for(;d.hasNext();){const g=d.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>i){let b=c.get(g.largestBatchId);b===null&&(b=pl(),c=c.insert(g.largestBatchId,b)),b.set(g.getKey(),g)}}const m=pl(),x=c.getIterator();for(;x.hasNext()&&(x.getNext().value.forEach(((g,b)=>m.set(g,b))),!(m.size()>=o)););return Ne.resolve(m)}bt(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const d=this.Lr.get(o.largestBatchId).delete(i.key);this.Lr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new MR(t,i));let c=this.Lr.get(t);c===void 0&&(c=St(),this.Lr.set(t,c)),this.Lr.set(t,c.add(i.key))}}class g6{constructor(){this.sessionToken=Zs.EMPTY_BYTE_STRING}getSessionToken(e){return Ne.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ne.resolve()}}class Zx{constructor(){this.kr=new Us(qs.Kr),this.qr=new Us(qs.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new qs(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new qs(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Je(new as([])),i=new qs(t,e),o=new qs(t,e+1),c=[];return this.qr.forEachInRange([i,o],(d=>{this.Wr(d),c.push(d.key)})),c}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Je(new as([])),i=new qs(t,e),o=new qs(t,e+1);let c=St();return this.qr.forEachInRange([i,o],(d=>{c=c.add(d.key)})),c}containsKey(e){const t=new qs(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class qs{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Je.comparator(e.key,t.key)||_t(e.Hr,t.Hr)}static Ur(e,t){return _t(e.Hr,t.Hr)||Je.comparator(e.key,t.key)}}class b6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Us(qs.Kr)}checkEmpty(e){return Ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const c=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new DR(c,t,i,o);this.mutationQueue.push(d);for(const m of o)this.Jr=this.Jr.add(new qs(m.key,c)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return Ne.resolve(d)}lookupMutationBatch(e,t){return Ne.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.Xr(i),c=o<0?0:o;return Ne.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return Ne.resolve(this.mutationQueue.length===0?$x:this.Yn-1)}getAllMutationBatches(e){return Ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new qs(t,0),o=new qs(t,Number.POSITIVE_INFINITY),c=[];return this.Jr.forEachInRange([i,o],(d=>{const m=this.Zr(d.Hr);c.push(m)})),Ne.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Us(_t);return t.forEach((o=>{const c=new qs(o,0),d=new qs(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([c,d],(m=>{i=i.add(m.Hr)}))})),Ne.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let c=i;Je.isDocumentKey(c)||(c=c.child(""));const d=new qs(new Je(c),0);let m=new Us(_t);return this.Jr.forEachWhile((x=>{const g=x.key.path;return!!i.isPrefixOf(g)&&(g.length===o&&(m=m.add(x.Hr)),!0)}),d),Ne.resolve(this.Yr(m))}Yr(e){const t=[];return e.forEach((i=>{const o=this.Zr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){$t(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ne.forEach(t.mutations,(o=>{const c=new qs(o.key,t.batchId);return i=i.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new qs(t,0),o=this.Jr.firstAfterOrEqual(i);return Ne.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ne.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class y6{constructor(e){this.ti=e,this.docs=(function(){return new fs(Je.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),c=o?o.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ne.resolve(i?i.document.mutableCopy():nn.newInvalidDocument(t))}getEntries(e,t){let i=Or();return t.forEach((o=>{const c=this.docs.get(o);i=i.insert(o,c?c.document.mutableCopy():nn.newInvalidDocument(o))})),Ne.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let c=Or();const d=t.path,m=new Je(d.child("__id-9223372036854775808__")),x=this.docs.getIteratorFrom(m);for(;x.hasNext();){const{key:g,value:{document:b}}=x.getNext();if(!d.isPrefixOf(g.path))break;g.path.length>d.length+1||H4(q4(b),i)<=0||(o.has(b.key)||Gf(t,b))&&(c=c.insert(b.key,b.mutableCopy()))}return Ne.resolve(c)}getAllFromCollectionGroup(e,t,i,o){rt(9500)}ni(e,t){return Ne.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new v6(this)}getSize(e){return Ne.resolve(this.size)}}class v6 extends h6{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(i)})),Ne.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class w6{constructor(e){this.persistence=e,this.ri=new kl((t=>Gx(t)),Yx),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.ii=0,this.si=new Zx,this.targetCount=0,this.oi=Uo._r()}forEachTarget(e,t){return this.ri.forEach(((i,o)=>t(o))),Ne.resolve()}getLastRemoteSnapshotVersion(e){return Ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ne.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ne.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ne.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Uo(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ne.resolve()}updateTargetData(e,t){return this.lr(t),Ne.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ne.resolve()}removeTargets(e,t,i){let o=0;const c=[];return this.ri.forEach(((d,m)=>{m.sequenceNumber<=t&&i.get(m.targetId)===null&&(this.ri.delete(d),c.push(this.removeMatchingKeysForTargetId(e,m.targetId)),o++)})),Ne.waitFor(c).next((()=>o))}getTargetCount(e){return Ne.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ne.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ne.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach((d=>{c.push(o.markPotentiallyOrphaned(e,d))})),Ne.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ne.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ne.resolve(i)}containsKey(e,t){return Ne.resolve(this.si.containsKey(t))}}class U_{constructor(e,t){this._i={},this.overlays={},this.ai=new zf(0),this.ui=!1,this.ui=!0,this.ci=new g6,this.referenceDelegate=e(this),this.li=new w6(this),this.indexManager=new r6,this.remoteDocumentCache=(function(o){return new y6(o)})((i=>this.referenceDelegate.hi(i))),this.serializer=new n6(t),this.Pi=new p6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new x6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new b6(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Pe("MemoryPersistence","Starting transaction:",e);const o=new N6(this.ai.next());return this.referenceDelegate.Ti(),i(o).next((c=>this.referenceDelegate.Ii(o).next((()=>c)))).toPromise().then((c=>(o.raiseOnCommittedEvent(),c)))}Ei(e,t){return Ne.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class N6 extends Y4{constructor(e){super(),this.currentSequenceNumber=e}}class eg{constructor(e){this.persistence=e,this.Ri=new Zx,this.Ai=null}static Vi(e){return new eg(e)}get di(){if(this.Ai)return this.Ai;throw rt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ne.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ne.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ne.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((o=>this.di.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((c=>this.di.add(c.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ne.forEach(this.di,(i=>{const o=Je.fromPath(i);return this.mi(e,o).next((c=>{c||t.removeEntry(o,lt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ne.or([()=>Ne.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class bf{constructor(e,t){this.persistence=e,this.fi=new kl((i=>K4(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=d6(this,t)}static Vi(e,t){return new bf(e,t)}Ti(){}Ii(e){return Ne.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ne.forEach(this.fi,((i,o)=>this.wr(e,i,o).next((c=>c?Ne.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ni(e,(d=>this.wr(e,d,t).next((m=>{m||(i++,c.removeEntry(d,lt.min()))})))).next((()=>c.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Fh(e.data.value)),t}wr(e,t,i){return Ne.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.fi.get(t);return Ne.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class tg{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=o}static Es(e,t){let i=St(),o=St();for(const c of t.docChanges)switch(c.type){case 0:i=i.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new tg(e,t.fromCache,i,o)}}class j6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class _6{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return J5()?8:W4(an())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const c={result:null};return this.gs(e,t).next((d=>{c.result=d})).next((()=>{if(!c.result)return this.ps(e,t,o,i).next((d=>{c.result=d}))})).next((()=>{if(c.result)return;const d=new j6;return this.ys(e,t,d).next((m=>{if(c.result=m,this.As)return this.ws(e,t,d,m.size)}))})).next((()=>c.result))}ws(e,t,i,o){return i.documentReadCount<this.Vs?(wo()<=jt.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",No(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ne.resolve()):(wo()<=jt.DEBUG&&Pe("QueryEngine","Query:",No(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.ds*o?(wo()<=jt.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",No(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ka(t))):Ne.resolve())}gs(e,t){if(dN(t))return Ne.resolve(null);let i=Ka(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=J0(t,null,"F"),i=Ka(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((c=>{const d=St(...c);return this.fs.getDocuments(e,d).next((m=>this.indexManager.getMinOffset(e,i).next((x=>{const g=this.bs(t,m);return this.Ss(t,g,d,x.readTime)?this.gs(e,J0(t,null,"F")):this.Ds(e,g,t,x)}))))})))))}ps(e,t,i,o){return dN(t)||o.isEqual(lt.min())?Ne.resolve(null):this.fs.getDocuments(e,i).next((c=>{const d=this.bs(t,c);return this.Ss(t,d,i,o)?Ne.resolve(null):(wo()<=jt.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),No(t)),this.Ds(e,d,t,$4(o,Au)).next((m=>m)))}))}bs(e,t){let i=new Us(x_(e));return t.forEach(((o,c)=>{Gf(e,c)&&(i=i.add(c))})),i}Ss(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}ys(e,t,i){return wo()<=jt.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",No(t)),this.fs.getDocumentsMatchingQuery(e,t,ki.min(),i)}Ds(e,t,i,o){return this.fs.getDocumentsMatchingQuery(e,i,o).next((c=>(t.forEach((d=>{c=c.insert(d.key,d)})),c)))}}const sg="LocalStore",S6=3e8;class E6{constructor(e,t,i,o){this.persistence=e,this.Cs=t,this.serializer=o,this.vs=new fs(_t),this.Fs=new kl((c=>Gx(c)),Yx),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new m6(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function T6(n,e,t,i){return new E6(n,e,t,i)}async function B_(n,e){const t=ut(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((c=>(o=c,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((c=>{const d=[],m=[];let x=St();for(const g of o){d.push(g.batchId);for(const b of g.mutations)x=x.add(b.key)}for(const g of c){m.push(g.batchId);for(const b of g.mutations)x=x.add(b.key)}return t.localDocuments.getDocuments(i,x).next((g=>({Ns:g,removedBatchIds:d,addedBatchIds:m})))}))}))}function A6(n,e){const t=ut(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),c=t.xs.newChangeBuffer({trackRemovals:!0});return(function(m,x,g,b){const w=g.batch,_=w.keys();let R=Ne.resolve();return _.forEach((B=>{R=R.next((()=>b.getEntry(x,B))).next((V=>{const U=g.docVersions.get(B);$t(U!==null,48541),V.version.compareTo(U)<0&&(w.applyToRemoteDocument(V,g),V.isValidDocument()&&(V.setReadTime(g.commitVersion),b.addEntry(V)))}))})),R.next((()=>m.mutationQueue.removeMutationBatch(x,w)))})(t,i,e,c).next((()=>c.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(m){let x=St();for(let g=0;g<m.mutationResults.length;++g)m.mutationResults[g].transformResults.length>0&&(x=x.add(m.batch.mutations[g].key));return x})(e)))).next((()=>t.localDocuments.getDocuments(i,o)))}))}function z_(n){const e=ut(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function k6(n,e){const t=ut(n),i=e.snapshotVersion;let o=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});o=t.vs;const m=[];e.targetChanges.forEach(((b,w)=>{const _=o.get(w);if(!_)return;m.push(t.li.removeMatchingKeys(c,b.removedDocuments,w).next((()=>t.li.addMatchingKeys(c,b.addedDocuments,w))));let R=_.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(w)!==null?R=R.withResumeToken(Zs.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):b.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(b.resumeToken,i)),o=o.insert(w,R),(function(V,U,F){return V.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=S6?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0})(_,R,b)&&m.push(t.li.updateTargetData(c,R))}));let x=Or(),g=St();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(c,b))})),m.push(C6(c,d,e.documentUpdates).next((b=>{x=b.Bs,g=b.Ls}))),!i.isEqual(lt.min())){const b=t.li.getLastRemoteSnapshotVersion(c).next((w=>t.li.setTargetsMetadata(c,c.currentSequenceNumber,i)));m.push(b)}return Ne.waitFor(m).next((()=>d.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,x,g))).next((()=>x))})).then((c=>(t.vs=o,c)))}function C6(n,e,t){let i=St(),o=St();return t.forEach((c=>i=i.add(c))),e.getEntries(n,i).next((c=>{let d=Or();return t.forEach(((m,x)=>{const g=c.get(m);x.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(m)),x.isNoDocument()&&x.version.isEqual(lt.min())?(e.removeEntry(m,x.readTime),d=d.insert(m,x)):!g.isValidDocument()||x.version.compareTo(g.version)>0||x.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(x),d=d.insert(m,x)):Pe(sg,"Ignoring outdated watch update for ",m,". Current version:",g.version," Watch version:",x.version)})),{Bs:d,Ls:o}}))}function R6(n,e){const t=ut(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=$x),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function I6(n,e){const t=ut(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.li.getTargetData(i,e).next((c=>c?(o=c,Ne.resolve(o)):t.li.allocateTargetId(i).next((d=>(o=new Ni(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.vs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function nx(n,e,t){const i=ut(n),o=i.vs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",c,(d=>i.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!Jo(d))throw d;Pe(sg,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(o.target)}function _N(n,e,t){const i=ut(n);let o=lt.min(),c=St();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(x,g,b){const w=ut(x),_=w.Fs.get(b);return _!==void 0?Ne.resolve(w.vs.get(_)):w.li.getTargetData(g,b)})(i,d,Ka(e)).next((m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,m.targetId).next((x=>{c=x}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?o:lt.min(),t?c:St()))).next((m=>(D6(i,gR(e),m),{documents:m,ks:c})))))}function D6(n,e,t){let i=n.Ms.get(e)||lt.min();t.forEach(((o,c)=>{c.readTime.compareTo(i)>0&&(i=c.readTime)})),n.Ms.set(e,i)}class SN{constructor(){this.activeTargetIds=jR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class M6{constructor(){this.vo=new SN,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new SN,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class O6{Mo(e){}shutdown(){}}const EN="ConnectivityMonitor";class TN{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Pe(EN,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Pe(EN,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Eh=null;function ax(){return Eh===null?Eh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Eh++,"0x"+Eh.toString(16)}const v0="RestConnection",P6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class L6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${o}`,this.$o=this.databaseId.database===hf?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Wo(e,t,i,o,c){const d=ax(),m=this.Qo(e,t.toUriEncodedString());Pe(v0,`Sending RPC '${e}' ${d}:`,m,i);const x={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(x,o,c);const{host:g}=new URL(m),b=sr(g);return this.zo(e,m,x,i,b).then((w=>(Pe(v0,`Received RPC '${e}' ${d}: `,w),w)),(w=>{throw Oo(v0,`RPC '${e}' ${d} failed with error: `,w,"url: ",m,"request:",i),w}))}jo(e,t,i,o,c,d){return this.Wo(e,t,i,o,c)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ko})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,c)=>e[c]=o)),i&&i.headers.forEach(((o,c)=>e[c]=o))}Qo(e,t){const i=P6[e];let o=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class V6{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const tn="WebChannelConnection",tu=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(o){setTimeout((()=>{throw o}),0)}}))};class Co extends L6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Co.c_){const e=Gj();tu(e,Hj.STAT_EVENT,(t=>{t.stat===H0.PROXY?Pe(tn,"STAT_EVENT: detected buffering proxy"):t.stat===H0.NOPROXY&&Pe(tn,"STAT_EVENT: detected no buffering proxy")})),Co.c_=!0}}zo(e,t,i,o,c){const d=ax();return new Promise(((m,x)=>{const g=new $j;g.setWithCredentials(!0),g.listenOnce(qj.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case zh.NO_ERROR:const w=g.getResponseJson();Pe(tn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(w)),m(w);break;case zh.TIMEOUT:Pe(tn,`RPC '${e}' ${d} timed out`),x(new Me(we.DEADLINE_EXCEEDED,"Request time out"));break;case zh.HTTP_ERROR:const _=g.getStatus();if(Pe(tn,`RPC '${e}' ${d} failed with status:`,_,"response text:",g.getResponseText()),_>0){let R=g.getResponseJson();Array.isArray(R)&&(R=R[0]);const B=R?.error;if(B&&B.status&&B.message){const V=(function(F){const Q=F.toLowerCase().replace(/_/g,"-");return Object.values(we).indexOf(Q)>=0?Q:we.UNKNOWN})(B.status);x(new Me(V,B.message))}else x(new Me(we.UNKNOWN,"Server responded with status "+g.getStatus()))}else x(new Me(we.UNAVAILABLE,"Connection failed."));break;default:rt(9055,{l_:e,streamId:d,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Pe(tn,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(o);Pe(tn,`RPC '${e}' ${d} sending request:`,o),g.send(t,"POST",b,i,15)}))}T_(e,t,i){const o=ax(),c=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},x=this.longPollingOptions.timeoutSeconds;x!==void 0&&(m.longPollingTimeout=Math.round(1e3*x)),this.useFetchStreams&&(m.useFetchStreams=!0),this.Go(m.initMessageHeaders,t,i),m.encodeInitMessageHeaders=!0;const g=c.join("");Pe(tn,`Creating RPC '${e}' stream ${o}: ${g}`,m);const b=d.createWebChannel(g,m);this.I_(b);let w=!1,_=!1;const R=new V6({Ho:B=>{_?Pe(tn,`Not sending because RPC '${e}' stream ${o} is closed:`,B):(w||(Pe(tn,`Opening RPC '${e}' stream ${o} transport.`),b.open(),w=!0),Pe(tn,`RPC '${e}' stream ${o} sending:`,B),b.send(B))},Jo:()=>b.close()});return tu(b,uu.EventType.OPEN,(()=>{_||(Pe(tn,`RPC '${e}' stream ${o} transport opened.`),R.i_())})),tu(b,uu.EventType.CLOSE,(()=>{_||(_=!0,Pe(tn,`RPC '${e}' stream ${o} transport closed`),R.o_(),this.E_(b))})),tu(b,uu.EventType.ERROR,(B=>{_||(_=!0,Oo(tn,`RPC '${e}' stream ${o} transport errored. Name:`,B.name,"Message:",B.message),R.o_(new Me(we.UNAVAILABLE,"The operation could not be completed")))})),tu(b,uu.EventType.MESSAGE,(B=>{if(!_){const V=B.data[0];$t(!!V,16349);const U=V,F=U?.error||U[0]?.error;if(F){Pe(tn,`RPC '${e}' stream ${o} received error:`,F);const Q=F.status;let H=(function(W){const T=Cs[W];if(T!==void 0)return T_(T)})(Q),re=F.message;H===void 0&&(H=we.INTERNAL,re="Unknown error status: "+Q+" with message "+F.message),_=!0,R.o_(new Me(H,re)),b.close()}else Pe(tn,`RPC '${e}' stream ${o} received:`,V),R.__(V)}})),Co.u_(),setTimeout((()=>{R.s_()}),0),R}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Yj()}}function U6(n){return new Co(n)}function w0(){return typeof document<"u"?document:null}function Kf(n){return new $R(n,!0)}Co.c_=!1;class F_{constructor(e,t,i=1e3,o=1.5,c=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=o,this.V_=c,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&Pe("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const AN="PersistentStream";class $_{constructor(e,t,i,o,c,d,m,x){this.Ci=e,this.b_=i,this.S_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=m,this.listener=x,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new F_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===we.RESOURCE_EXHAUSTED?(Mr(t.toString()),Mr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===we.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new Me(we.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Pe(AN,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Pe(AN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class B6 extends $_{constructor(e,t,i,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=GR(this.serializer,e),i=(function(c){if(!("targetChange"in c))return lt.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?lt.min():d.readTime?Xa(d.readTime):lt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=sx(this.serializer),t.addTarget=(function(c,d){let m;const x=d.target;if(m=K0(x)?{documents:QR(c,x)}:{query:KR(c,x).ft},m.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){m.resumeToken=C_(c,d.resumeToken);const g=Z0(c,d.expectedCount);g!==null&&(m.expectedCount=g)}else if(d.snapshotVersion.compareTo(lt.min())>0){m.readTime=gf(c,d.snapshotVersion.toTimestamp());const g=Z0(c,d.expectedCount);g!==null&&(m.expectedCount=g)}return m})(this.serializer,e);const i=JR(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=sx(this.serializer),t.removeTarget=e,this.K_(t)}}class z6 extends $_{constructor(e,t,i,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return $t(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$t(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){$t(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=WR(e.writeResults,e.commitTime),i=Xa(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=sx(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>YR(this.serializer,i)))};this.K_(t)}}class F6{}class $6 extends F6{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Me(we.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Wo(e,ex(t,i),o,c,d))).catch((c=>{throw c.name==="FirebaseError"?(c.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Me(we.UNKNOWN,c.toString())}))}jo(e,t,i,o,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,m])=>this.connection.jo(e,ex(t,i),o,d,m,c))).catch((d=>{throw d.name==="FirebaseError"?(d.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Me(we.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function q6(n,e,t,i){return new $6(n,e,t,i)}class H6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Mr(t),this.aa=!1):Pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const jl="RemoteStore";class G6{constructor(e,t,i,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=c,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{Cl(this)&&(Pe(jl,"Restarting streams for network reachability change."),await(async function(x){const g=ut(x);g.Ea.add(4),await Xu(g),g.Va.set("Unknown"),g.Ea.delete(4),await Xf(g)})(this))}))})),this.Va=new H6(i,o)}}async function Xf(n){if(Cl(n))for(const e of n.Ra)await e(!0)}async function Xu(n){for(const e of n.Ra)await e(!1)}function q_(n,e){const t=ut(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ig(t)?rg(t):Zo(t).O_()&&ag(t,e))}function ng(n,e){const t=ut(n),i=Zo(t);t.Ia.delete(e),i.O_()&&H_(t,e),t.Ia.size===0&&(i.O_()?i.L_():Cl(t)&&t.Va.set("Unknown"))}function ag(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Zo(n).Z_(e)}function H_(n,e){n.da.$e(e),Zo(n).X_(e)}function rg(n){n.da=new UR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Zo(n).start(),n.Va.ua()}function ig(n){return Cl(n)&&!Zo(n).x_()&&n.Ia.size>0}function Cl(n){return ut(n).Ea.size===0}function G_(n){n.da=void 0}async function Y6(n){n.Va.set("Online")}async function W6(n){n.Ia.forEach(((e,t)=>{ag(n,e)}))}async function Q6(n,e){G_(n),ig(n)?(n.Va.ha(e),rg(n)):n.Va.set("Unknown")}async function K6(n,e,t){if(n.Va.set("Online"),e instanceof k_&&e.state===2&&e.cause)try{await(async function(o,c){const d=c.cause;for(const m of c.targetIds)o.Ia.has(m)&&(await o.remoteSyncer.rejectListen(m,d),o.Ia.delete(m),o.da.removeTarget(m))})(n,e)}catch(i){Pe(jl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await yf(n,i)}else if(e instanceof Hh?n.da.Xe(e):e instanceof A_?n.da.st(e):n.da.tt(e),!t.isEqual(lt.min()))try{const i=await z_(n.localStore);t.compareTo(i)>=0&&await(function(c,d){const m=c.da.Tt(d);return m.targetChanges.forEach(((x,g)=>{if(x.resumeToken.approximateByteSize()>0){const b=c.Ia.get(g);b&&c.Ia.set(g,b.withResumeToken(x.resumeToken,d))}})),m.targetMismatches.forEach(((x,g)=>{const b=c.Ia.get(x);if(!b)return;c.Ia.set(x,b.withResumeToken(Zs.EMPTY_BYTE_STRING,b.snapshotVersion)),H_(c,x);const w=new Ni(b.target,x,g,b.sequenceNumber);ag(c,w)})),c.remoteSyncer.applyRemoteEvent(m)})(n,t)}catch(i){Pe(jl,"Failed to raise snapshot:",i),await yf(n,i)}}async function yf(n,e,t){if(!Jo(e))throw e;n.Ea.add(1),await Xu(n),n.Va.set("Offline"),t||(t=()=>z_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Pe(jl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Xf(n)}))}function Y_(n,e){return e().catch((t=>yf(n,t,e)))}async function Jf(n){const e=ut(n),t=Di(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:$x;for(;X6(e);)try{const o=await R6(e.localStore,i);if(o===null){e.Ta.length===0&&t.L_();break}i=o.batchId,J6(e,o)}catch(o){await yf(e,o)}W_(e)&&Q_(e)}function X6(n){return Cl(n)&&n.Ta.length<10}function J6(n,e){n.Ta.push(e);const t=Di(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function W_(n){return Cl(n)&&!Di(n).x_()&&n.Ta.length>0}function Q_(n){Di(n).start()}async function Z6(n){Di(n).ra()}async function e3(n){const e=Di(n);for(const t of n.Ta)e.ea(t.mutations)}async function t3(n,e,t){const i=n.Ta.shift(),o=Kx.from(i,e,t);await Y_(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await Jf(n)}async function s3(n,e){e&&Di(n).Y_&&await(async function(i,o){if((function(d){return PR(d)&&d!==we.ABORTED})(o.code)){const c=i.Ta.shift();Di(i).B_(),await Y_(i,(()=>i.remoteSyncer.rejectFailedWrite(c.batchId,o))),await Jf(i)}})(n,e),W_(n)&&Q_(n)}async function kN(n,e){const t=ut(n);t.asyncQueue.verifyOperationInProgress(),Pe(jl,"RemoteStore received new credentials");const i=Cl(t);t.Ea.add(3),await Xu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Xf(t)}async function n3(n,e){const t=ut(n);e?(t.Ea.delete(2),await Xf(t)):e||(t.Ea.add(2),await Xu(t),t.Va.set("Unknown"))}function Zo(n){return n.ma||(n.ma=(function(t,i,o){const c=ut(t);return c.sa(),new B6(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:Y6.bind(null,n),Yo:W6.bind(null,n),t_:Q6.bind(null,n),J_:K6.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),ig(n)?rg(n):n.Va.set("Unknown")):(await n.ma.stop(),G_(n))}))),n.ma}function Di(n){return n.fa||(n.fa=(function(t,i,o){const c=ut(t);return c.sa(),new z6(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:Z6.bind(null,n),t_:s3.bind(null,n),ta:e3.bind(null,n),na:t3.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Jf(n)):(await n.fa.stop(),n.Ta.length>0&&(Pe(jl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class lg{constructor(e,t,i,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=c,this.deferred=new Ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,c){const d=Date.now()+i,m=new lg(e,t,d,o,c);return m.start(i),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Me(we.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function og(n,e){if(Mr("AsyncQueue",`${e}: ${n}`),Jo(n))return new Me(we.UNAVAILABLE,`${e}: ${n}`);throw n}class Ro{static emptySet(e){return new Ro(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Je.comparator(t.key,i.key):(t,i)=>Je.comparator(t.key,i.key),this.keyedMap=du(),this.sortedSet=new fs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ro)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Ro;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class CN{constructor(){this.ga=new fs(Je.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):rt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Bo{constructor(e,t,i,o,c,d,m,x,g){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=m,this.excludesMetadataChanges=x,this.hasCachedResults=g}static fromInitialDocuments(e,t,i,o,c){const d=[];return t.forEach((m=>{d.push({type:0,doc:m})})),new Bo(e,t,Ro.emptySet(t),d,i,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}class a3{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class r3{constructor(){this.queries=RN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=ut(t),c=o.queries;o.queries=RN(),c.forEach(((d,m)=>{for(const x of m.ba)x.onError(i)}))})(this,new Me(we.ABORTED,"Firestore shutting down"))}}function RN(){return new kl((n=>p_(n)),Hf)}async function cg(n,e){const t=ut(n);let i=3;const o=e.query;let c=t.queries.get(o);c?!c.Sa()&&e.Da()&&(i=2):(c=new a3,i=e.Da()?0:1);try{switch(i){case 0:c.wa=await t.onListen(o,!0);break;case 1:c.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const m=og(d,`Initialization of query '${No(e.query)}' failed`);return void e.onError(m)}t.queries.set(o,c),c.ba.push(e),e.va(t.onlineState),c.wa&&e.Fa(c.wa)&&dg(t)}async function ug(n,e){const t=ut(n),i=e.query;let o=3;const c=t.queries.get(i);if(c){const d=c.ba.indexOf(e);d>=0&&(c.ba.splice(d,1),c.ba.length===0?o=e.Da()?0:1:!c.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function i3(n,e){const t=ut(n);let i=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const m of d.ba)m.Fa(o)&&(i=!0);d.wa=o}}i&&dg(t)}function l3(n,e,t){const i=ut(n),o=i.queries.get(e);if(o)for(const c of o.ba)c.onError(t);i.queries.delete(e)}function dg(n){n.Ca.forEach((e=>{e.next()}))}var rx,IN;(IN=rx||(rx={})).Ma="default",IN.Cache="cache";class hg{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new Bo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Bo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==rx.Cache}}class K_{constructor(e){this.key=e}}class X_{constructor(e){this.key=e}}class o3{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=St(),this.mutatedKeys=St(),this.eu=x_(e),this.tu=new Ro(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new CN,o=t?t.tu:this.tu;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,m=!1;const x=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,w)=>{const _=o.get(b),R=Gf(this.query,w)?w:null,B=!!_&&this.mutatedKeys.has(_.key),V=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let U=!1;_&&R?_.data.isEqual(R.data)?B!==V&&(i.track({type:3,doc:R}),U=!0):this.su(_,R)||(i.track({type:2,doc:R}),U=!0,(x&&this.eu(R,x)>0||g&&this.eu(R,g)<0)&&(m=!0)):!_&&R?(i.track({type:0,doc:R}),U=!0):_&&!R&&(i.track({type:1,doc:_}),U=!0,(x||g)&&(m=!0)),U&&(R?(d=d.add(R),c=V?c.add(b):c.delete(b)):(d=d.delete(b),c=c.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),c=c.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:m,mutatedKeys:c}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,w)=>(function(R,B){const V=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt(20277,{Vt:U})}};return V(R)-V(B)})(b.type,w.type)||this.eu(b.doc,w.doc))),this.ou(i),o=o??!1;const m=t&&!o?this._u():[],x=this.Ya.size===0&&this.current&&!o?1:0,g=x!==this.Xa;return this.Xa=x,d.length!==0||g?{snapshot:new Bo(this.query,e.tu,c,d,e.mutatedKeys,x===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new CN,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=St(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new X_(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new K_(i))})),t}cu(e){this.Za=e.ks,this.Ya=St();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Bo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const fg="SyncEngine";class c3{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class u3{constructor(e){this.key=e,this.hu=!1}}class d3{constructor(e,t,i,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new kl((m=>p_(m)),Hf),this.Iu=new Map,this.Eu=new Set,this.Ru=new fs(Je.comparator),this.Au=new Map,this.Vu=new Zx,this.du={},this.mu=new Map,this.fu=Uo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function h3(n,e,t=!0){const i=n2(n);let o;const c=i.Tu.get(e);return c?(i.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.lu()):o=await J_(i,e,t,!0),o}async function f3(n,e){const t=n2(n);await J_(t,e,!0,!1)}async function J_(n,e,t,i){const o=await I6(n.localStore,Ka(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let m;return i&&(m=await m3(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&q_(n.remoteStore,o),m}async function m3(n,e,t,i,o){n.pu=(w,_,R)=>(async function(V,U,F,Q){let H=U.view.ru(F);H.Ss&&(H=await _N(V.localStore,U.query,!1).then((({documents:T})=>U.view.ru(T,H))));const re=Q&&Q.targetChanges.get(U.targetId),he=Q&&Q.targetMismatches.get(U.targetId)!=null,W=U.view.applyChanges(H,V.isPrimaryClient,re,he);return MN(V,U.targetId,W.au),W.snapshot})(n,w,_,R);const c=await _N(n.localStore,e,!0),d=new o3(e,c.ks),m=d.ru(c.documents),x=Ku.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),g=d.applyChanges(m,n.isPrimaryClient,x);MN(n,t,g.au);const b=new c3(e,t,d);return n.Tu.set(e,b),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),g.snapshot}async function p3(n,e,t){const i=ut(n),o=i.Tu.get(e),c=i.Iu.get(o.targetId);if(c.length>1)return i.Iu.set(o.targetId,c.filter((d=>!Hf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await nx(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&ng(i.remoteStore,o.targetId),ix(i,o.targetId)})).catch(Xo)):(ix(i,o.targetId),await nx(i.localStore,o.targetId,!0))}async function x3(n,e){const t=ut(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),ng(t.remoteStore,i.targetId))}async function g3(n,e,t){const i=_3(n);try{const o=await(function(d,m){const x=ut(d),g=zt.now(),b=m.reduce(((R,B)=>R.add(B.key)),St());let w,_;return x.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let B=Or(),V=St();return x.xs.getEntries(R,b).next((U=>{B=U,B.forEach(((F,Q)=>{Q.isValidDocument()||(V=V.add(F))}))})).next((()=>x.localDocuments.getOverlayedDocuments(R,B))).next((U=>{w=U;const F=[];for(const Q of m){const H=RR(Q,w.get(Q.key).overlayedDocument);H!=null&&F.push(new Ui(Q.key,H,l_(H.value.mapValue),oa.exists(!0)))}return x.mutationQueue.addMutationBatch(R,g,F,m)})).next((U=>{_=U;const F=U.applyToLocalDocumentSet(w,V);return x.documentOverlayCache.saveOverlays(R,U.batchId,F)}))})).then((()=>({batchId:_.batchId,changes:b_(w)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(d,m,x){let g=d.du[d.currentUser.toKey()];g||(g=new fs(_t)),g=g.insert(m,x),d.du[d.currentUser.toKey()]=g})(i,o.batchId,t),await Ju(i,o.changes),await Jf(i.remoteStore)}catch(o){const c=og(o,"Failed to persist write");t.reject(c)}}async function Z_(n,e){const t=ut(n);try{const i=await k6(t.localStore,e);e.targetChanges.forEach(((o,c)=>{const d=t.Au.get(c);d&&($t(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?$t(d.hu,14607):o.removedDocuments.size>0&&($t(d.hu,42227),d.hu=!1))})),await Ju(t,i,e)}catch(i){await Xo(i)}}function DN(n,e,t){const i=ut(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((c,d)=>{const m=d.view.va(e);m.snapshot&&o.push(m.snapshot)})),(function(d,m){const x=ut(d);x.onlineState=m;let g=!1;x.queries.forEach(((b,w)=>{for(const _ of w.ba)_.va(m)&&(g=!0)})),g&&dg(x)})(i.eventManager,e),o.length&&i.Pu.J_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function b3(n,e,t){const i=ut(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),c=o&&o.key;if(c){let d=new fs(Je.comparator);d=d.insert(c,nn.newNoDocument(c,lt.min()));const m=St().add(c),x=new Qf(lt.min(),new Map,new fs(_t),d,m);await Z_(i,x),i.Ru=i.Ru.remove(c),i.Au.delete(e),mg(i)}else await nx(i.localStore,e,!1).then((()=>ix(i,e,t))).catch(Xo)}async function y3(n,e){const t=ut(n),i=e.batch.batchId;try{const o=await A6(t.localStore,e);t2(t,i,null),e2(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ju(t,o)}catch(o){await Xo(o)}}async function v3(n,e,t){const i=ut(n);try{const o=await(function(d,m){const x=ut(d);return x.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let b;return x.mutationQueue.lookupMutationBatch(g,m).next((w=>($t(w!==null,37113),b=w.keys(),x.mutationQueue.removeMutationBatch(g,w)))).next((()=>x.mutationQueue.performConsistencyCheck(g))).next((()=>x.documentOverlayCache.removeOverlaysForBatchId(g,b,m))).next((()=>x.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,b))).next((()=>x.localDocuments.getDocuments(g,b)))}))})(i.localStore,e);t2(i,e,t),e2(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ju(i,o)}catch(o){await Xo(o)}}function e2(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function t2(n,e,t){const i=ut(n);let o=i.du[i.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),i.du[i.currentUser.toKey()]=o}}function ix(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||s2(n,i)}))}function s2(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(ng(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),mg(n))}function MN(n,e,t){for(const i of t)i instanceof K_?(n.Vu.addReference(i.key,e),w3(n,i)):i instanceof X_?(Pe(fg,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||s2(n,i.key)):rt(19791,{wu:i})}function w3(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(Pe(fg,"New document in limbo: "+t),n.Eu.add(i),mg(n))}function mg(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Je(as.fromString(e)),i=n.fu.next();n.Au.set(i,new u3(t)),n.Ru=n.Ru.insert(t,i),q_(n.remoteStore,new Ni(Ka(qf(t.path)),i,"TargetPurposeLimboResolution",zf.ce))}}async function Ju(n,e,t){const i=ut(n),o=[],c=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((m,x)=>{d.push(i.pu(x,e,t).then((g=>{if((g||t)&&i.isPrimaryClient){const b=g?!g.fromCache:t?.targetChanges.get(x.targetId)?.current;i.sharedClientState.updateQueryState(x.targetId,b?"current":"not-current")}if(g){o.push(g);const b=tg.Es(x.targetId,g);c.push(b)}})))})),await Promise.all(d),i.Pu.J_(o),await(async function(x,g){const b=ut(x);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>Ne.forEach(g,(_=>Ne.forEach(_.Ts,(R=>b.persistence.referenceDelegate.addReference(w,_.targetId,R))).next((()=>Ne.forEach(_.Is,(R=>b.persistence.referenceDelegate.removeReference(w,_.targetId,R)))))))))}catch(w){if(!Jo(w))throw w;Pe(sg,"Failed to update sequence numbers: "+w)}for(const w of g){const _=w.targetId;if(!w.fromCache){const R=b.vs.get(_),B=R.snapshotVersion,V=R.withLastLimboFreeSnapshotVersion(B);b.vs=b.vs.insert(_,V)}}})(i.localStore,c))}async function N3(n,e){const t=ut(n);if(!t.currentUser.isEqual(e)){Pe(fg,"User change. New user:",e.toKey());const i=await B_(t.localStore,e);t.currentUser=e,(function(c,d){c.mu.forEach((m=>{m.forEach((x=>{x.reject(new Me(we.CANCELLED,d))}))})),c.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ju(t,i.Ns)}}function j3(n,e){const t=ut(n),i=t.Au.get(e);if(i&&i.hu)return St().add(i.key);{let o=St();const c=t.Iu.get(e);if(!c)return o;for(const d of c){const m=t.Tu.get(d);o=o.unionWith(m.view.nu)}return o}}function n2(n){const e=ut(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Z_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=j3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=b3.bind(null,e),e.Pu.J_=i3.bind(null,e.eventManager),e.Pu.yu=l3.bind(null,e.eventManager),e}function _3(n){const e=ut(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=y3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=v3.bind(null,e),e}class vf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Kf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return T6(this.persistence,new _6,e.initialUser,this.serializer)}Cu(e){return new U_(eg.Vi,this.serializer)}Du(e){return new M6}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vf.provider={build:()=>new vf};class S3 extends vf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){$t(this.persistence.referenceDelegate instanceof bf,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new c6(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?vn.withCacheSize(this.cacheSizeBytes):vn.DEFAULT;return new U_((i=>bf.Vi(i,t)),this.serializer)}}class lx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>DN(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=N3.bind(null,this.syncEngine),await n3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new r3})()}createDatastore(e){const t=Kf(e.databaseInfo.databaseId),i=U6(e.databaseInfo);return q6(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,c,d,m){return new G6(i,o,c,d,m)})(this.localStore,this.datastore,e.asyncQueue,(t=>DN(this.syncEngine,t,0)),(function(){return TN.v()?new TN:new O6})())}createSyncEngine(e,t){return(function(o,c,d,m,x,g,b){const w=new d3(o,c,d,m,x,g);return b&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=ut(t);Pe(jl,"RemoteStore shutting down."),i.Ea.add(5),await Xu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}lx.provider={build:()=>new lx};class pg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Mr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Mi="FirestoreClient";class E3{constructor(e,t,i,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=o,this.user=sn.UNAUTHENTICATED,this.clientId=Fx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(i,(async d=>{Pe(Mi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Pe(Mi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=og(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function N0(n,e){n.asyncQueue.verifyOperationInProgress(),Pe(Mi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await B_(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function ON(n,e){n.asyncQueue.verifyOperationInProgress();const t=await T3(n);Pe(Mi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>kN(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>kN(e.remoteStore,o))),n._onlineComponents=e}async function T3(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Pe(Mi,"Using user provided OfflineComponentProvider");try{await N0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===we.FAILED_PRECONDITION||o.code===we.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Oo("Error using user provided cache. Falling back to memory cache: "+t),await N0(n,new vf)}}else Pe(Mi,"Using default OfflineComponentProvider"),await N0(n,new S3(void 0));return n._offlineComponents}async function a2(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Pe(Mi,"Using user provided OnlineComponentProvider"),await ON(n,n._uninitializedComponentsProvider._online)):(Pe(Mi,"Using default OnlineComponentProvider"),await ON(n,new lx))),n._onlineComponents}function A3(n){return a2(n).then((e=>e.syncEngine))}async function wf(n){const e=await a2(n),t=e.eventManager;return t.onListen=h3.bind(null,e.syncEngine),t.onUnlisten=p3.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=f3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=x3.bind(null,e.syncEngine),t}function k3(n,e,t,i){const o=new pg(i),c=new hg(e,o,t);return n.asyncQueue.enqueueAndForget((async()=>cg(await wf(n),c))),()=>{o.Nu(),n.asyncQueue.enqueueAndForget((async()=>ug(await wf(n),c)))}}function C3(n,e,t={}){const i=new Ar;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,m,x,g){const b=new pg({next:_=>{b.Nu(),d.enqueueAndForget((()=>ug(c,w)));const R=_.docs.has(m);!R&&_.fromCache?g.reject(new Me(we.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&_.fromCache&&x&&x.source==="server"?g.reject(new Me(we.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(_)},error:_=>g.reject(_)}),w=new hg(qf(m.path),b,{includeMetadataChanges:!0,Ka:!0});return cg(c,w)})(await wf(n),n.asyncQueue,e,t,i))),i.promise}function R3(n,e,t={}){const i=new Ar;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,m,x,g){const b=new pg({next:_=>{b.Nu(),d.enqueueAndForget((()=>ug(c,w))),_.fromCache&&x.source==="server"?g.reject(new Me(we.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(_)},error:_=>g.reject(_)}),w=new hg(m,b,{includeMetadataChanges:!0,Ka:!0});return cg(c,w)})(await wf(n),n.asyncQueue,e,t,i))),i.promise}function I3(n,e){const t=new Ar;return n.asyncQueue.enqueueAndForget((async()=>g3(await A3(n),e,t))),t.promise}function r2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const D3="ComponentProvider",PN=new Map;function M3(n,e,t,i,o){return new Z4(n,e,t,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,r2(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,i)}const i2="firestore.googleapis.com",LN=!0;class VN{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Me(we.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=i2,this.ssl=LN}else this.host=e.host,this.ssl=e.ssl??LN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=V_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<l6)throw new Me(we.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}F4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=r2(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Me(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Me(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Me(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zf{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new VN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Me(we.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Me(we.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new VN(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new I4;switch(i.type){case"firstParty":return new P4(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Me(we.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=PN.get(t);i&&(Pe(D3,"Removing Datastore"),PN.delete(t),i.terminate())})(this),Promise.resolve()}}function O3(n,e,t,i={}){n=En(n,Zf);const o=sr(e),c=n._getSettings(),d={...c,emulatorOptions:n._getEmulatorOptions()},m=`${e}:${t}`;o&&(Mf(`https://${m}`),Of("Firestore",!0)),c.host!==i2&&c.host!==m&&Oo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const x={...c,host:m,ssl:o,emulatorOptions:i};if(!yl(x,d)&&(n._setSettings(x),i.mockUserToken)){let g,b;if(typeof i.mockUserToken=="string")g=i.mockUserToken,b=sn.MOCK_USER;else{g=sj(i.mockUserToken,n._app?.options.projectId);const w=i.mockUserToken.sub||i.mockUserToken.user_id;if(!w)throw new Me(we.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new sn(w)}n._authCredentials=new D4(new Qj(g,b))}}class Rl{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Rl(this.firestore,e,this._query)}}class gs{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ei(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gs(this.firestore,e,this._key)}toJSON(){return{type:gs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Yu(t,gs._jsonSchema))return new gs(e,i||null,new Je(as.fromString(t.referencePath)))}}gs._jsonSchemaVersion="firestore/documentReference/1.0",gs._jsonSchema={type:Is("string",gs._jsonSchemaVersion),referencePath:Is("string")};class Ei extends Rl{constructor(e,t,i){super(e,t,qf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gs(this.firestore,null,new Je(e))}withConverter(e){return new Ei(this.firestore,e,this._path)}}function Xe(n,e,...t){if(n=ns(n),Kj("collection","path",e),n instanceof Zf){const i=as.fromString(e,...t);return Xw(i),new Ei(n,null,i)}{if(!(n instanceof gs||n instanceof Ei))throw new Me(we.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(as.fromString(e,...t));return Xw(i),new Ei(n.firestore,null,i)}}function Oe(n,e,...t){if(n=ns(n),arguments.length===1&&(e=Fx.newId()),Kj("doc","path",e),n instanceof Zf){const i=as.fromString(e,...t);return Kw(i),new gs(n,null,new Je(i))}{if(!(n instanceof gs||n instanceof Ei))throw new Me(we.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(as.fromString(e,...t));return Kw(i),new gs(n.firestore,n instanceof Ei?n.converter:null,new Je(i))}}const UN="AsyncQueue";class BN{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new F_(this,"async_queue_retry"),this._c=()=>{const i=w0();i&&Pe(UN,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=w0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=w0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ar;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Jo(e))throw e;Pe(UN,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Mr("INTERNAL UNHANDLED ERROR: ",zN(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=lg.createAndSchedule(this,e,t,i,(c=>this.hc(c)));return this.tc.push(o),o}uc(){this.nc&&rt(47125,{Pc:zN(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function zN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Pr extends Zf{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new BN,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new BN(e),this._firestoreClient=void 0,await e}}}function P3(n,e){const t=typeof n=="object"?n:Pf(),i=typeof n=="string"?n:hf,o=Fu(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const c=kx("firestore");c&&O3(o,...c)}return o}function em(n){if(n._terminated)throw new Me(we.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||L3(n),n._firestoreClient}function L3(n){const e=n._freezeSettings(),t=M3(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new E3(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(o){const c=o?._online.build();return{_offline:o?._offline.build(c),_online:c}})(n._componentsProvider))}class aa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new aa(Zs.fromBase64String(e))}catch(t){throw new Me(we.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new aa(Zs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:aa._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yu(e,aa._jsonSchema))return aa.fromBase64String(e.bytes)}}aa._jsonSchemaVersion="firestore/bytes/1.0",aa._jsonSchema={type:Is("string",aa._jsonSchemaVersion),bytes:Is("string")};class xg{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Me(we.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class tm{constructor(e){this._methodName=e}}class Ja{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Me(we.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Me(we.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return _t(this._lat,e._lat)||_t(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ja._jsonSchemaVersion}}static fromJSON(e){if(Yu(e,Ja._jsonSchema))return new Ja(e.latitude,e.longitude)}}Ja._jsonSchemaVersion="firestore/geoPoint/1.0",Ja._jsonSchema={type:Is("string",Ja._jsonSchemaVersion),latitude:Is("number"),longitude:Is("number")};class va{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let c=0;c<i.length;++c)if(i[c]!==o[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:va._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yu(e,va._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new va(e.vectorValues);throw new Me(we.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}va._jsonSchemaVersion="firestore/vectorValue/1.0",va._jsonSchema={type:Is("string",va._jsonSchemaVersion),vectorValues:Is("object")};const V3=/^__.*__$/;class U3{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ui(e,this.data,this.fieldMask,t,this.fieldTransforms):new Qu(e,this.data,t,this.fieldTransforms)}}class l2{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Ui(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function o2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt(40011,{dataSource:n})}}class gg{constructor(e,t,i,o,c,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,c===void 0&&this.validatePath(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new gg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Nf(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(o2(this.dataSource)&&V3.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class B3{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Kf(e)}createContext(e,t,i,o=!1){return new gg({dataSource:e,methodName:t,targetDoc:i,path:Xs.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sm(n){const e=n._freezeSettings(),t=Kf(n._databaseId);return new B3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function c2(n,e,t,i,o,c={}){const d=n.createContext(c.merge||c.mergeFields?2:0,e,t,o);yg("Data must be an object, but it was:",d,i);const m=u2(i,d);let x,g;if(c.merge)x=new Bn(d.fieldMask),g=d.fieldTransforms;else if(c.mergeFields){const b=[];for(const w of c.mergeFields){const _=zo(e,w,t);if(!d.contains(_))throw new Me(we.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);f2(b,_)||b.push(_)}x=new Bn(b),g=d.fieldTransforms.filter((w=>x.covers(w.field)))}else x=null,g=d.fieldTransforms;return new U3(new Nn(m),x,g)}class nm extends tm{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof nm}}class bg extends tm{_toFieldTransform(e){return new TR(e.path,new Iu)}isEqual(e){return e instanceof bg}}function z3(n,e,t,i){const o=n.createContext(1,e,t);yg("Data must be an object, but it was:",o,i);const c=[],d=Nn.empty();Vi(i,((x,g)=>{const b=h2(e,x,t);g=ns(g);const w=o.childContextForFieldPath(b);if(g instanceof nm)c.push(b);else{const _=Zu(g,w);_!=null&&(c.push(b),d.set(b,_))}}));const m=new Bn(c);return new l2(d,m,o.fieldTransforms)}function F3(n,e,t,i,o,c){const d=n.createContext(1,e,t),m=[zo(e,i,t)],x=[o];if(c.length%2!=0)throw new Me(we.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<c.length;_+=2)m.push(zo(e,c[_])),x.push(c[_+1]);const g=[],b=Nn.empty();for(let _=m.length-1;_>=0;--_)if(!f2(g,m[_])){const R=m[_];let B=x[_];B=ns(B);const V=d.childContextForFieldPath(R);if(B instanceof nm)g.push(R);else{const U=Zu(B,V);U!=null&&(g.push(R),b.set(R,U))}}const w=new Bn(g);return new l2(b,w,d.fieldTransforms)}function $3(n,e,t,i=!1){return Zu(t,n.createContext(i?4:3,e))}function Zu(n,e){if(d2(n=ns(n)))return yg("Unsupported field value:",e,n),u2(n,e);if(n instanceof tm)return(function(i,o){if(!o2(o.dataSource))throw o.createError(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${i._methodName}() is not currently supported inside arrays`);const c=i._toFieldTransform(o);c&&o.fieldTransforms.push(c)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,o){const c=[];let d=0;for(const m of i){let x=Zu(m,o.childContextForArray(d));x==null&&(x={nullValue:"NULL_VALUE"}),c.push(x),d++}return{arrayValue:{values:c}}})(n,e)}return(function(i,o){if((i=ns(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return _R(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const c=zt.fromDate(i);return{timestampValue:gf(o.serializer,c)}}if(i instanceof zt){const c=new zt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:gf(o.serializer,c)}}if(i instanceof Ja)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof aa)return{bytesValue:C_(o.serializer,i._byteString)};if(i instanceof gs){const c=o.databaseId,d=i.firestore._databaseId;if(!d.isEqual(c))throw o.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Jx(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof va)return(function(d,m){const x=d instanceof va?d.toArray():d;return{mapValue:{fields:{[r_]:{stringValue:i_},[ff]:{arrayValue:{values:x.map((b=>{if(typeof b!="number")throw m.createError("VectorValues must only contain numeric values.");return Wx(m.serializer,b)}))}}}}}})(i,o);if(L_(i))return i._toProto(o.serializer);throw o.createError(`Unsupported field value: ${Bf(i)}`)})(n,e)}function u2(n,e){const t={};return Zj(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vi(n,((i,o)=>{const c=Zu(o,e.childContextForField(i));c!=null&&(t[i]=c)})),{mapValue:{fields:t}}}function d2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof zt||n instanceof Ja||n instanceof aa||n instanceof gs||n instanceof tm||n instanceof va||L_(n))}function yg(n,e,t){if(!d2(t)||!Xj(t)){const i=Bf(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function zo(n,e,t){if((e=ns(e))instanceof xg)return e._internalPath;if(typeof e=="string")return h2(n,e);throw Nf("Field path arguments must be of type string or ",n,!1,void 0,t)}const q3=new RegExp("[~\\*/\\[\\]]");function h2(n,e,t){if(e.search(q3)>=0)throw Nf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new xg(...e.split("."))._internalPath}catch{throw Nf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Nf(n,e,t,i,o){const c=i&&!i.isEmpty(),d=o!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let x="";return(c||d)&&(x+=" (found",c&&(x+=` in field ${i}`),d&&(x+=` in document ${o}`),x+=")"),new Me(we.INVALID_ARGUMENT,m+n+x)}function f2(n,e){return n.some((t=>t.isEqual(e)))}class H3{convertValue(e,t="none"){switch(Ii(e)){case 0:return null;case 1:return e.booleanValue;case 2:return js(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ri(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw rt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Vi(e,((o,c)=>{i[o]=this.convertValue(c,t)})),i}convertVectorValue(e){const t=e.fields?.[ff].arrayValue?.values?.map((i=>js(i.doubleValue)));return new va(t)}convertGeoPoint(e){return new Ja(js(e.latitude),js(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=$f(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(ku(e));default:return null}}convertTimestamp(e){const t=Ci(e);return new zt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=as.fromString(e);$t(P_(i),9688,{name:e});const o=new Cu(i.get(1),i.get(3)),c=new Je(i.popFirst(5));return o.isEqual(t)||Mr(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}class vg extends H3{constructor(e){super(),this.firestore=e}convertBytes(e){return new aa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gs(this.firestore,null,t)}}function kr(){return new bg("serverTimestamp")}const FN="@firebase/firestore",$N="4.10.0";function qN(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of i)if(c in o&&typeof o[c]=="function")return!0;return!1})(n,["next","error","complete"])}class m2{constructor(e,t,i,o,c){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new gs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new G3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(zo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class G3 extends m2{data(){return super.data()}}function p2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Me(we.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wg{}class Y3 extends wg{}function Fn(n,e,...t){let i=[];e instanceof wg&&i.push(e),i=i.concat(t),(function(c){const d=c.filter((x=>x instanceof Ng)).length,m=c.filter((x=>x instanceof am)).length;if(d>1||d>0&&m>0)throw new Me(we.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const o of i)n=o._apply(n);return n}class am extends Y3{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new am(e,t,i)}_apply(e){const t=this._parse(e);return x2(e._query,t),new Rl(e.firestore,e.converter,X0(e._query,t))}_parse(e){const t=sm(e.firestore);return(function(c,d,m,x,g,b,w){let _;if(g.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Me(we.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){GN(w,b);const B=[];for(const V of w)B.push(HN(x,c,V));_={arrayValue:{values:B}}}else _=HN(x,c,w)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||GN(w,b),_=$3(m,d,w,b==="in"||b==="not-in");return Rs.create(g,b,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function jn(n,e,t){const i=e,o=zo("where",n);return am._create(o,i,t)}class Ng extends wg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ng(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:_a.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,c){let d=o;const m=c.getFlattenedFilters();for(const x of m)x2(d,x),d=X0(d,x)})(e._query,t),new Rl(e.firestore,e.converter,X0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function HN(n,e,t){if(typeof(t=ns(t))=="string"){if(t==="")throw new Me(we.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!m_(e)&&t.indexOf("/")!==-1)throw new Me(we.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(as.fromString(t));if(!Je.isDocumentKey(i))throw new Me(we.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return rN(n,new Je(i))}if(t instanceof gs)return rN(n,t._key);throw new Me(we.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bf(t)}.`)}function GN(n,e){if(!Array.isArray(n)||n.length===0)throw new Me(we.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function x2(n,e){const t=(function(o,c){for(const d of o)for(const m of d.getFlattenedFilters())if(c.indexOf(m.op)>=0)return m.op;return null})(n.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Me(we.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Me(we.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function g2(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class fu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xl extends m2{constructor(e,t,i,o,c,d){super(e,t,i,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Gh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(zo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Me(we.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=xl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}xl._jsonSchemaVersion="firestore/documentSnapshot/1.0",xl._jsonSchema={type:Is("string",xl._jsonSchemaVersion),bundleSource:Is("string","DocumentSnapshot"),bundleName:Is("string"),bundle:Is("string")};class Gh extends xl{data(e={}){return super.data(e)}}class gl{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new fu(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Gh(this._firestore,this._userDataWriter,i.key,i,new fu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Me(we.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((m=>{const x=new Gh(o._firestore,o._userDataWriter,m.doc.key,m.doc,new fu(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:x,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((m=>c||m.type!==3)).map((m=>{const x=new Gh(o._firestore,o._userDataWriter,m.doc.key,m.doc,new fu(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,b=-1;return m.type!==0&&(g=d.indexOf(m.doc.key),d=d.delete(m.doc.key)),m.type!==1&&(d=d.add(m.doc),b=d.indexOf(m.doc.key)),{type:W3(m.type),doc:x,oldIndex:g,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Me(we.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=gl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Fx.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),i.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function W3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt(61501,{type:n})}}gl._jsonSchemaVersion="firestore/querySnapshot/1.0",gl._jsonSchema={type:Is("string",gl._jsonSchemaVersion),bundleSource:Is("string","QuerySnapshot"),bundleName:Is("string"),bundle:Is("string")};function j0(n){n=En(n,gs);const e=En(n.firestore,Pr),t=em(e);return C3(t,n._key).then((i=>b2(e,n,i)))}function Ls(n){n=En(n,Rl);const e=En(n.firestore,Pr),t=em(e),i=new vg(e);return p2(n._query),R3(t,n._query).then((o=>new gl(e,i,n,o)))}function _0(n,e,t){n=En(n,gs);const i=En(n.firestore,Pr),o=g2(n.converter,e),c=sm(i);return rm(i,[c2(c,"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,oa.none())])}function Ye(n,e,t,...i){n=En(n,gs);const o=En(n.firestore,Pr),c=sm(o);let d;return d=typeof(e=ns(e))=="string"||e instanceof xg?F3(c,"updateDoc",n._key,e,t,i):z3(c,"updateDoc",n._key,e),rm(o,[d.toMutation(n._key,oa.exists(!0))])}function Io(n){return rm(En(n.firestore,Pr),[new Qx(n._key,oa.none())])}function Sa(n,e){const t=En(n.firestore,Pr),i=Oe(n),o=g2(n.converter,e),c=sm(n.firestore);return rm(t,[c2(c,"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,oa.exists(!1))]).then((()=>i))}function ss(n,...e){n=ns(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||qN(e[i])||(t=e[i++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(qN(e[i])){const g=e[i];e[i]=g.next?.bind(g),e[i+1]=g.error?.bind(g),e[i+2]=g.complete?.bind(g)}let c,d,m;if(n instanceof gs)d=En(n.firestore,Pr),m=qf(n._key.path),c={next:g=>{e[i]&&e[i](b2(d,n,g))},error:e[i+1],complete:e[i+2]};else{const g=En(n,Rl);d=En(g.firestore,Pr),m=g._query;const b=new vg(d);c={next:w=>{e[i]&&e[i](new gl(d,b,g,w))},error:e[i+1],complete:e[i+2]},p2(n._query)}const x=em(d);return k3(x,m,o,c)}function rm(n,e){const t=em(n);return I3(t,e)}function b2(n,e,t){const i=t.docs.get(e._key),o=new vg(n);return new xl(n,o,e._key,i,new fu(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){R4(Tl),Ai(new Rr("firestore",((i,{instanceIdentifier:o,options:c})=>{const d=i.getProvider("app").getImmediate(),m=new Pr(new M4(i.getProvider("auth-internal")),new L4(d,i.getProvider("app-check-internal")),eR(d,o),d);return c={useFetchStreams:t,...c},m._setSettings(c),m}),"PUBLIC").setMultipleInstances(!0)),la(FN,$N,e),la(FN,$N,"esm2020")})();const y2="firebasestorage.googleapis.com",v2="storageBucket",Q3=120*1e3,K3=600*1e3;class ys extends Ta{constructor(e,t,i=0){super(S0(e),`Firebase Storage: ${t} (${S0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ys.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return S0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var bs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(bs||(bs={}));function S0(n){return"storage/"+n}function jg(){const n="An unknown error occurred, please check the error payload for server response.";return new ys(bs.UNKNOWN,n)}function X3(n){return new ys(bs.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function J3(n){return new ys(bs.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Z3(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ys(bs.UNAUTHENTICATED,n)}function eI(){return new ys(bs.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function tI(n){return new ys(bs.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function sI(){return new ys(bs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function nI(){return new ys(bs.CANCELED,"User canceled the upload/download.")}function aI(n){return new ys(bs.INVALID_URL,"Invalid URL '"+n+"'.")}function rI(n){return new ys(bs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function iI(){return new ys(bs.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+v2+"' property when initializing the app?")}function lI(){return new ys(bs.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function oI(){return new ys(bs.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function cI(n){return new ys(bs.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ox(n){return new ys(bs.INVALID_ARGUMENT,n)}function w2(){return new ys(bs.APP_DELETED,"The Firebase app was deleted.")}function uI(n){return new ys(bs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wu(n,e){return new ys(bs.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function su(n){throw new ys(bs.INTERNAL_ERROR,"Internal error: "+n)}class zn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=zn.makeFromUrl(e,t)}catch{return new zn(e,"")}if(i.path==="")return i;throw rI(e)}static makeFromUrl(e,t){let i=null;const o="([A-Za-z0-9.\\-_]+)";function c(re){re.path.charAt(re.path.length-1)==="/"&&(re.path_=re.path_.slice(0,-1))}const d="(/(.*))?$",m=new RegExp("^gs://"+o+d,"i"),x={bucket:1,path:3};function g(re){re.path_=decodeURIComponent(re.path)}const b="v[A-Za-z0-9_]+",w=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",R=new RegExp(`^https?://${w}/${b}/b/${o}/o${_}`,"i"),B={bucket:1,path:3},V=t===y2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,U="([^?#]*)",F=new RegExp(`^https?://${V}/${o}/${U}`,"i"),H=[{regex:m,indices:x,postModify:c},{regex:R,indices:B,postModify:g},{regex:F,indices:{bucket:1,path:2},postModify:g}];for(let re=0;re<H.length;re++){const he=H[re],W=he.regex.exec(e);if(W){const T=W[he.indices.bucket];let E=W[he.indices.path];E||(E=""),i=new zn(T,E),he.postModify(i);break}}if(i==null)throw aI(e);return i}}class dI{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function hI(n,e,t){let i=1,o=null,c=null,d=!1,m=0;function x(){return m===2}let g=!1;function b(...U){g||(g=!0,e.apply(null,U))}function w(U){o=setTimeout(()=>{o=null,n(R,x())},U)}function _(){c&&clearTimeout(c)}function R(U,...F){if(g){_();return}if(U){_(),b.call(null,U,...F);return}if(x()||d){_(),b.call(null,U,...F);return}i<64&&(i*=2);let H;m===1?(m=2,H=0):H=(i+Math.random())*1e3,w(H)}let B=!1;function V(U){B||(B=!0,_(),!g&&(o!==null?(U||(m=2),clearTimeout(o),w(0)):U||(m=1)))}return w(0),c=setTimeout(()=>{d=!0,V(!0)},t),V}function fI(n){n(!1)}function mI(n){return n!==void 0}function pI(n){return typeof n=="object"&&!Array.isArray(n)}function _g(n){return typeof n=="string"||n instanceof String}function YN(n){return Sg()&&n instanceof Blob}function Sg(){return typeof Blob<"u"}function WN(n,e,t,i){if(i<e)throw ox(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw ox(`Invalid value for '${n}'. Expected ${t} or less.`)}function im(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function N2(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const o=e(i)+"="+e(n[i]);t=t+o+"&"}return t=t.slice(0,-1),t}var bl;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(bl||(bl={}));function xI(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}class gI{constructor(e,t,i,o,c,d,m,x,g,b,w,_=!0,R=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=m,this.errorCallback_=x,this.timeout_=g,this.progressCallback_=b,this.connectionFactory_=w,this.retry=_,this.isUsingEmulator=R,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((B,V)=>{this.resolve_=B,this.reject_=V,this.start_()})}start_(){const e=(i,o)=>{if(o){i(!1,new Th(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=m=>{const x=m.loaded,g=m.lengthComputable?m.total:-1;this.progressCallback_!==null&&this.progressCallback_(x,g)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const m=c.getErrorCode()===bl.NO_ERROR,x=c.getStatus();if(!m||xI(x,this.additionalRetryCodes_)&&this.retry){const b=c.getErrorCode()===bl.ABORT;i(!1,new Th(!1,null,b));return}const g=this.successCodes_.indexOf(x)!==-1;i(!0,new Th(g,c))})},t=(i,o)=>{const c=this.resolve_,d=this.reject_,m=o.connection;if(o.wasSuccessCode)try{const x=this.callback_(m,m.getResponse());mI(x)?c(x):c()}catch(x){d(x)}else if(m!==null){const x=jg();x.serverResponse=m.getErrorText(),this.errorCallback_?d(this.errorCallback_(m,x)):d(x)}else if(o.canceled){const x=this.appDelete_?w2():nI();d(x)}else{const x=sI();d(x)}};this.canceled_?t(!1,new Th(!1,null,!0)):this.backoffId_=hI(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&fI(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Th{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function bI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function yI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function vI(n,e){e&&(n["X-Firebase-GMPID"]=e)}function wI(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function NI(n,e,t,i,o,c,d=!0,m=!1){const x=N2(n.urlParams),g=n.url+x,b=Object.assign({},n.headers);return vI(b,e),bI(b,t),yI(b,c),wI(b,i),new gI(g,n.method,b,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,m)}function jI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function _I(...n){const e=jI();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Sg())return new Blob(n);throw new ys(bs.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function SI(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function EI(n){if(typeof atob>"u")throw cI("base-64");return atob(n)}const Ga={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class E0{constructor(e,t){this.data=e,this.contentType=t||null}}function TI(n,e){switch(n){case Ga.RAW:return new E0(j2(e));case Ga.BASE64:case Ga.BASE64URL:return new E0(_2(n,e));case Ga.DATA_URL:return new E0(kI(e),CI(e))}throw jg()}function j2(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const c=i,d=n.charCodeAt(++t);i=65536|(c&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function AI(n){let e;try{e=decodeURIComponent(n)}catch{throw wu(Ga.DATA_URL,"Malformed data URL.")}return j2(e)}function _2(n,e){switch(n){case Ga.BASE64:{const o=e.indexOf("-")!==-1,c=e.indexOf("_")!==-1;if(o||c)throw wu(n,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Ga.BASE64URL:{const o=e.indexOf("+")!==-1,c=e.indexOf("/")!==-1;if(o||c)throw wu(n,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=EI(e)}catch(o){throw o.message.includes("polyfill")?o:wu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}class S2{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw wu(Ga.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=RI(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function kI(n){const e=new S2(n);return e.base64?_2(Ga.BASE64,e.rest):AI(e.rest)}function CI(n){return new S2(n).contentType}function RI(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class wi{constructor(e,t){let i=0,o="";YN(e)?(this.data_=e,i=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(YN(this.data_)){const i=this.data_,o=SI(i,e,t);return o===null?null:new wi(o)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new wi(i,!0)}}static getBlob(...e){if(Sg()){const t=e.map(i=>i instanceof wi?i.data_:i);return new wi(_I.apply(null,t))}else{const t=e.map(d=>_g(d)?TI(Ga.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const o=new Uint8Array(i);let c=0;return t.forEach(d=>{for(let m=0;m<d.length;m++)o[c++]=d[m]}),new wi(o,!0)}}uploadData(){return this.data_}}function E2(n){let e;try{e=JSON.parse(n)}catch{return null}return pI(e)?e:null}function II(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function DI(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function T2(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function MI(n,e){return e}class dn{constructor(e,t,i,o){this.server=e,this.local=t||e,this.writable=!!i,this.xform=o||MI}}let Ah=null;function OI(n){return!_g(n)||n.length<2?n:T2(n)}function A2(){if(Ah)return Ah;const n=[];n.push(new dn("bucket")),n.push(new dn("generation")),n.push(new dn("metageneration")),n.push(new dn("name","fullPath",!0));function e(c,d){return OI(d)}const t=new dn("name");t.xform=e,n.push(t);function i(c,d){return d!==void 0?Number(d):d}const o=new dn("size");return o.xform=i,n.push(o),n.push(new dn("timeCreated")),n.push(new dn("updated")),n.push(new dn("md5Hash",null,!0)),n.push(new dn("cacheControl",null,!0)),n.push(new dn("contentDisposition",null,!0)),n.push(new dn("contentEncoding",null,!0)),n.push(new dn("contentLanguage",null,!0)),n.push(new dn("contentType",null,!0)),n.push(new dn("metadata","customMetadata",!0)),Ah=n,Ah}function PI(n,e){function t(){const i=n.bucket,o=n.fullPath,c=new zn(i,o);return e._makeStorageReference(c)}Object.defineProperty(n,"ref",{get:t})}function LI(n,e,t){const i={};i.type="file";const o=t.length;for(let c=0;c<o;c++){const d=t[c];i[d.local]=d.xform(i,e[d.server])}return PI(i,n),i}function k2(n,e,t){const i=E2(e);return i===null?null:LI(n,i,t)}function VI(n,e,t,i){const o=E2(e);if(o===null||!_g(o.downloadTokens))return null;const c=o.downloadTokens;if(c.length===0)return null;const d=encodeURIComponent;return c.split(",").map(g=>{const b=n.bucket,w=n.fullPath,_="/b/"+d(b)+"/o/"+d(w),R=im(_,t,i),B=N2({alt:"media",token:g});return R+B})[0]}function UI(n,e){const t={},i=e.length;for(let o=0;o<i;o++){const c=e[o];c.writable&&(t[c.server]=n[c.local])}return JSON.stringify(t)}class Eg{constructor(e,t,i,o){this.url=e,this.method=t,this.handler=i,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function C2(n){if(!n)throw jg()}function BI(n,e){function t(i,o){const c=k2(n,o,e);return C2(c!==null),c}return t}function zI(n,e){function t(i,o){const c=k2(n,o,e);return C2(c!==null),VI(c,o,n.host,n._protocol)}return t}function R2(n){function e(t,i){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=eI():o=Z3():t.getStatus()===402?o=J3(n.bucket):t.getStatus()===403?o=tI(n.path):o=i,o.status=t.getStatus(),o.serverResponse=i.serverResponse,o}return e}function I2(n){const e=R2(n);function t(i,o){let c=e(i,o);return i.getStatus()===404&&(c=X3(n.path)),c.serverResponse=o.serverResponse,c}return t}function FI(n,e,t){const i=e.fullServerUrl(),o=im(i,n.host,n._protocol),c="GET",d=n.maxOperationRetryTime,m=new Eg(o,c,zI(n,t),d);return m.errorHandler=I2(e),m}function $I(n,e){const t=e.fullServerUrl(),i=im(t,n.host,n._protocol),o="DELETE",c=n.maxOperationRetryTime;function d(x,g){}const m=new Eg(i,o,d,c);return m.successCodes=[200,204],m.errorHandler=I2(e),m}function qI(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function HI(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=qI(null,e)),i}function GI(n,e,t,i,o){const c=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function m(){let H="";for(let re=0;re<2;re++)H=H+Math.random().toString().slice(2);return H}const x=m();d["Content-Type"]="multipart/related; boundary="+x;const g=HI(e,i,o),b=UI(g,t),w="--"+x+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+x+`\r
Content-Type: `+g.contentType+`\r
\r
`,_=`\r
--`+x+"--",R=wi.getBlob(w,i,_);if(R===null)throw lI();const B={name:g.fullPath},V=im(c,n.host,n._protocol),U="POST",F=n.maxUploadRetryTime,Q=new Eg(V,U,BI(n,t),F);return Q.urlParams=B,Q.headers=d,Q.body=R.uploadData(),Q.errorHandler=R2(e),Q}class YI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=bl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=bl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=bl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,o,c){if(this.sent_)throw su("cannot .send() more than once");if(sr(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),c!==void 0)for(const d in c)c.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,c[d].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw su("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw su("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw su("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw su("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class WI extends YI{initXhr(){this.xhr_.responseType="text"}}function Tg(){return new WI}class _l{constructor(e,t){this._service=e,t instanceof zn?this._location=t:this._location=zn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new _l(e,t)}get root(){const e=new zn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return T2(this._location.path)}get storage(){return this._service}get parent(){const e=II(this._location.path);if(e===null)return null;const t=new zn(this._location.bucket,e);return new _l(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw uI(e)}}function QI(n,e,t){n._throwIfRoot("uploadBytes");const i=GI(n.storage,n._location,A2(),new wi(e,!0),t);return n.storage.makeRequestWithTokens(i,Tg).then(o=>({metadata:o,ref:n}))}function KI(n){n._throwIfRoot("getDownloadURL");const e=FI(n.storage,n._location,A2());return n.storage.makeRequestWithTokens(e,Tg).then(t=>{if(t===null)throw oI();return t})}function XI(n){n._throwIfRoot("deleteObject");const e=$I(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Tg)}function JI(n,e){const t=DI(n._location.path,e),i=new zn(n._location.bucket,t);return new _l(n.storage,i)}function ZI(n){return/^[A-Za-z]+:\/\//.test(n)}function eD(n,e){return new _l(n,e)}function D2(n,e){if(n instanceof Ag){const t=n;if(t._bucket==null)throw iI();const i=new _l(t,t._bucket);return e!=null?D2(i,e):i}else return e!==void 0?JI(n,e):n}function tD(n,e){if(e&&ZI(e)){if(n instanceof Ag)return eD(n,e);throw ox("To use ref(service, url), the first argument must be a Storage instance.")}else return D2(n,e)}function QN(n,e){const t=e?.[v2];return t==null?null:zn.makeFromBucketSpec(t,n)}function sD(n,e,t,i={}){n.host=`${e}:${t}`;const o=sr(e);o&&(Mf(`https://${n.host}/b`),Of("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=i;c&&(n._overrideAuthToken=typeof c=="string"?c:sj(c,n.app.options.projectId))}class Ag{constructor(e,t,i,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=y2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Q3,this._maxUploadRetryTime=K3,this._requests=new Set,o!=null?this._bucket=zn.makeFromBucketSpec(o,this._host):this._bucket=QN(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=zn.makeFromBucketSpec(this._url,e):this._bucket=QN(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){WN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){WN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(wn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new _l(this,e)}_makeRequest(e,t,i,o,c=!0){if(this._deleted)return new dI(w2());{const d=NI(e,this._appId,i,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,o).getPromise()}}const KN="@firebase/storage",XN="0.14.0";const M2="storage";function O2(n,e,t){return n=ns(n),QI(n,e,t)}function P2(n){return n=ns(n),KI(n)}function nD(n){return n=ns(n),XI(n)}function cx(n,e){return n=ns(n),tD(n,e)}function aD(n=Pf(),e){n=ns(n);const i=Fu(n,M2).getImmediate({identifier:e}),o=kx("storage");return o&&rD(i,...o),i}function rD(n,e,t,i={}){sD(n,e,t,i)}function iD(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new Ag(t,i,o,e,Tl)}function lD(){Ai(new Rr(M2,iD,"PUBLIC").setMultipleInstances(!0)),la(KN,XN,""),la(KN,XN,"esm2020")}lD();const oD={apiKey:"AIzaSyC1qZ9fK-6LFBxVWZsAD4dZq-KVg36A7f8",authDomain:"scheduler-65e51.firebaseapp.com",projectId:"scheduler-65e51",storageBucket:"scheduler-65e51.firebasestorage.app",messagingSenderId:"93993791456",appId:"1:93993791456:web:3a777a2da0dad4b8b74585"},kg=rj(oD),pe=P3(kg),wa=T4(kg),ux=aD(kg);const L2=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();const cD=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const uD=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase());const JN=n=>{const e=uD(n);return e.charAt(0).toUpperCase()+e.slice(1)};var dD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const hD=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const fD=j.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:o="",children:c,iconNode:d,...m},x)=>j.createElement("svg",{ref:x,...dD,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:L2("lucide",o),...!c&&!hD(m)&&{"aria-hidden":"true"},...m},[...d.map(([g,b])=>j.createElement(g,b)),...Array.isArray(c)?c:[c]]));const Re=(n,e)=>{const t=j.forwardRef(({className:i,...o},c)=>j.createElement(fD,{ref:c,iconNode:e,className:L2(`lucide-${cD(JN(n))}`,`lucide-${n}`,i),...o}));return t.displayName=JN(n),t};const mD=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Nu=Re("archive",mD);const pD=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],xD=Re("arrow-down-right",pD);const gD=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ba=Re("arrow-left",gD);const bD=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Do=Re("arrow-right",bD);const yD=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],vD=Re("arrow-up-down",yD);const wD=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],V2=Re("arrow-up-right",wD);const ND=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ZN=Re("ban",ND);const jD=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Eo=Re("bell",jD);const _D=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],SD=Re("bot",_D);const ED=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],TD=Re("building-2",ED);const AD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],Na=Re("calendar-check",AD);const kD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],e1=Re("calendar-days",kD);const CD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ct=Re("calendar",CD);const RD=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],ID=Re("camera",RD);const DD=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Cg=Re("chart-column",DD);const MD=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],U2=Re("chart-pie",MD);const OD=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Js=Re("check",OD);const PD=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ou=Re("chevron-down",PD);const LD=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Rg=Re("chevron-left",LD);const VD=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ed=Re("chevron-right",VD);const UD=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],dx=Re("chevron-up",UD);const BD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Pu=Re("circle-alert",BD);const zD=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Vs=Re("circle-check-big",zD);const FD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ha=Re("circle-x",FD);const $D=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],os=Re("clock",$D);const qD=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],HD=Re("code",qD);const GD=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],jf=Re("coffee",GD);const YD=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],B2=Re("copy",YD);const WD=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],_n=Re("credit-card",WD);const QD=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Fo=Re("crown",QD);const KD=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Mo=Re("dollar-sign",KD);const XD=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Za=Re("external-link",XD);const JD=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ju=Re("eye",JD);const ZD=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],eM=Re("ghost",ZD);const tM=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],sM=Re("gift",tM);const nM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],aM=Re("globe",nM);const rM=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],iM=Re("headphones",rM);const lM=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Ig=Re("heart",lM);const oM=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],lm=Re("image",oM);const cM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],t1=Re("info",cM);const uM=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],hx=Re("list-ordered",uM);const dM=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]],_f=Re("list-plus",dM);const hM=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ra=Re("loader-circle",hM);const fM=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Sf=Re("lock",fM);const mM=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Ef=Re("log-out",mM);const pM=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Tf=Re("mail",pM);const xM=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],gM=Re("map-pin",xM);const bM=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],z2=Re("menu",bM);const yM=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Af=Re("message-circle",yM);const vM=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],fx=Re("message-square",vM);const wM=[["path",{d:"M5 12h14",key:"1ays0h"}]],NM=Re("minus",wM);const jM=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],F2=Re("palette",jM);const _M=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],$2=Re("party-popper",_M);const SM=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Dg=Re("pen-line",SM);const EM=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],mx=Re("phone",EM);const TM=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],T0=Re("play",TM);const AM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],tr=Re("plus",AM);const kM=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Lu=Re("refresh-cw",kM);const CM=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],Ti=Re("repeat",CM);const RM=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],q2=Re("save",RM);const IM=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Yh=Re("search",IM);const DM=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Wh=Re("send",DM);const MM=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Qh=Re("settings",MM);const OM=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Kh=Re("shield",OM);const PM=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],H2=Re("sparkles",PM);const LM=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],px=Re("star",LM);const VM=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],s1=Re("sticky-note",VM);const UM=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],Nr=Re("store",UM);const BM=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Tn=Re("tag",BM);const zM=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],G2=Re("thermometer",zM);const FM=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Y2=Re("timer",FM);const $M=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ya=Re("trash-2",$M);const qM=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],$o=Re("trending-up",qM);const HM=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ia=Re("triangle-alert",HM);const GM=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],YM=Re("upload",GM);const WM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],W2=Re("user-plus",WM);const QM=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Sl=Re("user",QM);const KM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ft=Re("users",KM);const XM=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],n1=Re("wallet",XM);const JM=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ds=Re("x",JM);const ZM=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ec=Re("zap",ZM);function a1({className:n=""}){return a.jsxs(at,{to:"/",className:`flex items-center gap-2.5 ${n}`,children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(Na,{className:"w-[18px] h-[18px] text-white"})}),a.jsxs("span",{className:"text-xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function eO(){return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-100",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsx(a1,{}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(at,{to:"/login",className:"px-4 py-2.5 text-sm font-semibold text-slate-600 hover:text-slate-900 transition-colors",children:"Sign In"}),a.jsxs(at,{to:"/register",className:"hidden sm:inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:["Get Started Free",a.jsx(Do,{className:"w-4 h-4"})]}),a.jsx(at,{to:"/register",className:"sm:hidden px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all",children:"Start Free"})]})]})}),a.jsxs("section",{className:"relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 -z-10",children:[a.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-blue-50 rounded-full blur-3xl opacity-60 -translate-y-1/2 translate-x-1/3"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-violet-50 rounded-full blur-3xl opacity-50 translate-y-1/3 -translate-x-1/4"})]}),a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 pt-16 sm:pt-24 pb-16 sm:pb-20",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-16 items-center",children:[a.jsxs("div",{className:"animate-fade-in-up",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 px-3.5 py-1.5 bg-blue-50 border border-blue-100 rounded-full text-sm font-medium text-blue-700 mb-6",children:[a.jsx(H2,{className:"w-3.5 h-3.5"}),"Free for beauty professionals"]}),a.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-[3.5rem] font-extrabold text-slate-900 leading-[1.1] mb-6 tracking-tight",children:["Online booking",a.jsx("br",{}),a.jsx("span",{className:"text-blue-600",children:"made effortless"})]}),a.jsx("p",{className:"text-lg sm:text-xl text-slate-600 leading-relaxed mb-8 max-w-lg",children:"Let clients book 24/7. Manage your team, services, and schedule from one beautiful dashboard. No more phone tag."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-10",children:[a.jsxs(at,{to:"/register",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-base shadow-lg shadow-blue-600/25 hover:shadow-xl hover:shadow-blue-600/30 transition-all hover:-translate-y-0.5",children:["Start for Free",a.jsx(Do,{className:"w-4 h-4"})]}),a.jsx("a",{href:"#how-it-works",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-base border border-slate-200 transition-all",children:"See How It Works"})]}),a.jsxs("div",{className:"flex items-center gap-5 text-sm text-slate-500",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Vs,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"Free to use"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Vs,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"No credit card"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Vs,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"Setup in 2 min"})]})]})]}),a.jsxs("div",{className:"relative animate-fade-in-up",style:{animationDelay:"150ms"},children:[a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl shadow-slate-200/60 border border-slate-200/80 overflow-hidden",children:[a.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-slate-50 border-b border-slate-100",children:[a.jsxs("div",{className:"flex gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"})]}),a.jsx("div",{className:"flex-1 mx-4",children:a.jsx("div",{className:"bg-white border border-slate-200 rounded-lg px-3 py-1.5 text-xs text-slate-400 font-mono",children:"bookflow.app/shop/janes-salon"})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-sm font-bold",children:"J"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-slate-900",children:"Jane's Salon"}),a.jsx("div",{className:"text-xs text-slate-500",children:"Book your next appointment"})]})]}),a.jsx("div",{className:"space-y-2.5",children:[{name:"Haircut & Style",price:"$45",time:"45 min",color:"bg-blue-500"},{name:"Color Treatment",price:"$120",time:"2 hours",color:"bg-violet-500"},{name:"Blowout",price:"$35",time:"30 min",color:"bg-emerald-500"}].map(n=>a.jsxs("div",{className:"flex items-center justify-between p-3.5 bg-slate-50 rounded-xl border border-slate-100 group hover:border-blue-200 hover:bg-blue-50/50 transition-all cursor-default",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-2 h-8 ${n.color} rounded-full`}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-800",children:n.name}),a.jsx("div",{className:"text-xs text-slate-500",children:n.time})]})]}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:n.price})]},n.name))})]})]}),a.jsxs("div",{className:"absolute -bottom-4 -left-4 bg-white rounded-xl shadow-lg shadow-slate-200/60 border border-slate-100 px-4 py-3 flex items-center gap-3 animate-float",children:[a.jsx("div",{className:"w-9 h-9 bg-emerald-100 rounded-full flex items-center justify-center",children:a.jsx(Vs,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-slate-500",children:"Booking confirmed"}),a.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Tomorrow at 2:00 PM"})]})]})]})]})})]}),a.jsx("section",{className:"border-y border-slate-100 bg-slate-50/50",children:a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-8 sm:py-10",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-8 sm:gap-16 text-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"500+"}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Businesses trust SpotBookie"})]}),a.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"10,000+"}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Appointments booked"})]}),a.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl sm:text-3xl font-extrabold text-slate-900",children:["4.9 ",a.jsx(px,{className:"w-5 h-5 text-amber-400 fill-amber-400"})]}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Average rating"})]})]})})}),a.jsx("section",{className:"py-20 sm:py-28",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Everything you need to run your bookings"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Built specifically for beauty professionals, salons, and service businesses. Simple, powerful, and free."})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 stagger-children",children:[{icon:a.jsx(Ct,{className:"w-6 h-6"}),title:"Smart Scheduling",desc:"Set weekly hours with breaks. Slots auto-generate so your calendar is always up to date.",color:"bg-blue-100 text-blue-600"},{icon:a.jsx(Ft,{className:"w-6 h-6"}),title:"Multi-Staff Support",desc:"Add your whole team. Each member gets their own schedule, hours, and bookings.",color:"bg-violet-100 text-violet-600"},{icon:a.jsx(ec,{className:"w-6 h-6"}),title:"Instant Booking",desc:"Clients pick a service, choose a stylist, and book  all in under a minute.",color:"bg-amber-100 text-amber-600"},{icon:a.jsx(aM,{className:"w-6 h-6"}),title:"Your Own Booking Page",desc:"Get a unique link to share anywhere. No app downloads needed for your clients.",color:"bg-emerald-100 text-emerald-600"}].map(n=>a.jsxs("div",{className:"group bg-white rounded-2xl p-7 border border-slate-200/80 hover:border-slate-300 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[a.jsx("div",{className:`w-12 h-12 ${n.color} rounded-xl flex items-center justify-center mb-5 group-hover:scale-110 transition-transform duration-300`,children:n.icon}),a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:n.title}),a.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:n.desc})]},n.title))})]})}),a.jsx("section",{id:"how-it-works",className:"py-20 sm:py-28 bg-slate-50 border-y border-slate-100",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Up and running in minutes"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Three simple steps to start accepting online bookings today."})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-8 lg:gap-12 relative",children:[a.jsx("div",{className:"hidden md:block absolute top-14 left-[calc(16.67%+1rem)] right-[calc(16.67%+1rem)] h-px bg-gradient-to-r from-blue-200 via-violet-200 to-emerald-200"}),[{step:"1",title:"Create your account",desc:"Sign up free in 30 seconds. Name your shop and you're in.",color:"from-blue-500 to-blue-600",shadow:"shadow-blue-500/30"},{step:"2",title:"Set up your shop",desc:"Add your services, team, and weekly hours. SpotBookie handles the rest.",color:"from-violet-500 to-violet-600",shadow:"shadow-violet-500/30"},{step:"3",title:"Share your link",desc:"Send your booking page to clients. They book, you get notified.",color:"from-emerald-500 to-emerald-600",shadow:"shadow-emerald-500/30"}].map(n=>a.jsxs("div",{className:"relative text-center",children:[a.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${n.color} rounded-2xl flex items-center justify-center mx-auto mb-6 text-white text-xl font-extrabold shadow-lg ${n.shadow} relative z-10`,children:n.step}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:n.title}),a.jsx("p",{className:"text-slate-600 leading-relaxed max-w-xs mx-auto",children:n.desc})]},n.step))]})]})}),a.jsx("section",{className:"py-20 sm:py-28",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Loved by professionals"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"See why salons and stylists are switching to SpotBookie."})]}),a.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{quote:"SpotBookie replaced our paper appointment book. Clients love being able to book online anytime.",name:"Maria Santos",role:"Salon Owner",initials:"MS",color:"bg-blue-100 text-blue-700"},{quote:"Setting up was incredibly easy. I had my booking page live and shared with clients in under 10 minutes.",name:"David Chen",role:"Barber",initials:"DC",color:"bg-violet-100 text-violet-700"},{quote:"The multi-staff feature is perfect. Each stylist manages their own schedule and clients can pick who they want.",name:"Lisa Park",role:"Studio Manager",initials:"LP",color:"bg-emerald-100 text-emerald-700"}].map(n=>a.jsxs("div",{className:"bg-white rounded-2xl p-7 border border-slate-200/80 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[a.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(5)].map((e,t)=>a.jsx(px,{className:"w-4 h-4 text-amber-400 fill-amber-400"},t))}),a.jsxs("p",{className:"text-slate-700 leading-relaxed mb-6",children:['"',n.quote,'"']}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 ${n.color} rounded-full flex items-center justify-center text-sm font-bold`,children:n.initials}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:n.name}),a.jsx("div",{className:"text-xs text-slate-500",children:n.role})]})]})]},n.name))})]})}),a.jsxs("section",{className:"py-20 sm:py-28 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 -z-0",children:[a.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-violet-500/10 rounded-full blur-3xl"})]}),a.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto px-5 sm:px-8 text-center",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-extrabold text-white mb-6 leading-tight",children:"Ready to streamline your bookings?"}),a.jsx("p",{className:"text-lg text-slate-400 mb-10 max-w-xl mx-auto",children:"Join hundreds of professionals who have ditched the old appointment book. Set up in minutes, free forever."}),a.jsxs(at,{to:"/register",className:"inline-flex items-center gap-2 px-8 py-4 bg-white hover:bg-slate-50 text-slate-900 rounded-xl font-bold text-lg transition-all hover:shadow-xl hover:shadow-white/10 hover:-translate-y-0.5",children:["Create Your Free Account",a.jsx(Do,{className:"w-5 h-5"})]})]})]}),a.jsx("footer",{className:"bg-white border-t border-slate-100",children:a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-10",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[a.jsx(a1,{}),a.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500",children:[a.jsx(at,{to:"/register",className:"hover:text-slate-900 transition-colors",children:"Sign Up"}),a.jsx("span",{className:"text-slate-200",children:""}),a.jsx(at,{to:"/login",className:"hover:text-slate-900 transition-colors",children:"Sign In"}),a.jsx("span",{className:"text-slate-200",children:""}),a.jsx("a",{href:"#how-it-works",className:"hover:text-slate-900 transition-colors",children:"How It Works"})]}),a.jsxs("p",{className:"text-xs text-slate-400",children:[" ",new Date().getFullYear()," SpotBookie. All rights reserved."]})]})})})]})}function tO(n){return n.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function sO(){const n=Oi(),[e,t]=j.useState(""),[i,o]=j.useState(""),[c,d]=j.useState(""),[m,x]=j.useState(""),[g,b]=j.useState(!1),w=tO(e),_=async R=>{if(R.preventDefault(),x(""),!w){x("Please enter a valid shop name");return}if(c.length<6){x("Password must be at least 6 characters");return}b(!0);try{const B=Fn(Xe(pe,"shops"),jn("slug","==",w));if(!(await Ls(B)).empty){x("A shop with that name already exists. Please choose a different name."),b(!1);return}const F=(await fC(wa,i,c)).user;await Sa(Xe(pe,"shops"),{name:e.trim(),slug:w,ownerUid:F.uid,ownerEmail:i,createdAt:kr()}),n(`/shop/${w}/dashboard`)}catch(B){switch(B.code){case"auth/email-already-in-use":x("An account with this email already exists");break;case"auth/invalid-email":x("Please enter a valid email address");break;case"auth/weak-password":x("Password must be at least 6 characters");break;default:x("Registration failed. Please try again.")}}finally{b(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(Na,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Create your shop"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Set up your booking page in seconds  it's free"})]}),a.jsxs("form",{onSubmit:_,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Shop Name"}),a.jsx("input",{type:"text",value:e,onChange:R=>{t(R.target.value),x("")},placeholder:"Jane's Salon",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),w&&a.jsxs("p",{className:"mt-1.5 text-xs text-slate-400",children:["Your page: ",a.jsxs("span",{className:"font-mono text-blue-600 font-medium",children:["bookflow.app/shop/",w]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:i,onChange:R=>{o(R.target.value),x("")},placeholder:"you@example.com",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:c,onChange:R=>{d(R.target.value),x("")},placeholder:"At least 6 characters",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${m?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),m&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",m]})]}),a.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Creating your shop"]}):a.jsxs(a.Fragment,{children:["Create Shop",a.jsx(Do,{className:"w-4 h-4"})]})})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Already have an account?"," ",a.jsx(at,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Sign in"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(at,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(ba,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function nO({user:n}){const e=Oi(),[t,i]=j.useState(""),[o,c]=j.useState(""),[d,m]=j.useState(""),[x,g]=j.useState(!1);j.useState(()=>{if(!n)return;(async()=>{const _=Fn(Xe(pe,"shops"),jn("ownerUid","==",n.uid)),R=await Ls(_);if(!R.empty){const B=R.docs[0].data();e(`/shop/${B.slug}/dashboard`,{replace:!0})}})()},[n,e]);const b=async w=>{w.preventDefault(),m(""),g(!0);try{const R=(await Vx(wa,t,o)).user,B=Fn(Xe(pe,"shops"),jn("ownerUid","==",R.uid)),V=await Ls(B);if(V.empty){m("No shop found for this account. Need to create one?"),await wa.signOut(),g(!1);return}const U=V.docs[0].data();e(`/shop/${U.slug}/dashboard`,{replace:!0})}catch(_){switch(_.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":m("Invalid email or password");break;case"auth/invalid-email":m("Please enter a valid email address");break;case"auth/too-many-requests":m("Too many failed attempts. Please try again later.");break;default:m("Login failed. Please try again.")}c("")}finally{g(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(Na,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:t,onChange:w=>{i(w.target.value),m("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:o,onChange:w=>{c(w.target.value),m("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${d?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),d&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",d]})]}),a.jsx("button",{type:"submit",disabled:x,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:x?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):a.jsxs(a.Fragment,{children:["Sign In",a.jsx(Do,{className:"w-4 h-4"})]})})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",a.jsx(at,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(at,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(ba,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function Q2({availableDates:n,selectedDate:e,onSelectDate:t}){const[i,o]=j.useState(new Date),c=F=>{const Q=F.getFullYear(),H=F.getMonth(),re=new Date(Q,H,1),W=new Date(Q,H+1,0).getDate(),T=re.getDay();return{daysInMonth:W,startingDayOfWeek:T,year:Q,month:H}},{daysInMonth:d,startingDayOfWeek:m,year:x,month:g}=c(i),b=()=>{o(new Date(i.getFullYear(),i.getMonth()-1))},w=()=>{o(new Date(i.getFullYear(),i.getMonth()+1))},_=F=>{const Q=`${x}-${String(g+1).padStart(2,"0")}-${String(F).padStart(2,"0")}`;return n.includes(Q)},R=F=>`${x}-${String(g+1).padStart(2,"0")}-${String(F).padStart(2,"0")}`===e,B=F=>{if(_(F)){const Q=`${x}-${String(g+1).padStart(2,"0")}-${String(F).padStart(2,"0")}`;t(Q)}},V=["January","February","March","April","May","June","July","August","September","October","November","December"],U=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return a.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-5 sm:p-6 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-5",children:[a.jsx("button",{onClick:b,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Rg,{className:"w-5 h-5 text-slate-600"})}),a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[V[g]," ",x]}),a.jsx("button",{onClick:w,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(ed,{className:"w-5 h-5 text-slate-600"})})]}),a.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:U.map(F=>a.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:F},F))}),a.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:m}).map((F,Q)=>a.jsx("div",{},`empty-${Q}`)),Array.from({length:d}).map((F,Q)=>{const H=Q+1,re=_(H),he=R(H),W=new Date,T=W.getDate()===H&&W.getMonth()===g&&W.getFullYear()===x;return a.jsxs("button",{onClick:()=>B(H),disabled:!re,className:`
                relative p-2.5 sm:p-3 text-center rounded-lg text-sm font-semibold transition-all duration-200
                ${he?"bg-blue-600 text-white shadow-md shadow-blue-600/30":re?"bg-emerald-50 text-emerald-700 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-300 cursor-pointer":T?"text-slate-900 font-bold":"text-slate-300 cursor-not-allowed"}
              `,children:[H,T&&!he&&a.jsx("span",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]},H)})]}),a.jsxs("div",{className:"mt-4 flex gap-5 text-xs text-slate-500",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 bg-emerald-50 border border-emerald-200 rounded"}),a.jsx("span",{children:"Available"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded"}),a.jsx("span",{children:"Selected"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-1 h-1 bg-blue-500 rounded-full"}),a.jsx("span",{children:"Today"})]})]})]})}const aO=[{key:"monday",label:"Mon"},{key:"tuesday",label:"Tue"},{key:"wednesday",label:"Wed"},{key:"thursday",label:"Thu"},{key:"friday",label:"Fri"},{key:"saturday",label:"Sat"},{key:"sunday",label:"Sun"}],r1=[{key:"morning",label:"Morning (9AM12PM)",start:"09:00",end:"12:00"},{key:"afternoon",label:"Afternoon (12PM5PM)",start:"12:00",end:"17:00"},{key:"evening",label:"Evening (5PM9PM)",start:"17:00",end:"21:00"},{key:"any",label:"Any time",start:"00:00",end:"23:59"}];function rO(){const n="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="WL";for(let t=0;t<4;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}function i1({shopId:n,slug:e,selectedService:t,selectedStaff:i,staffMembers:o,preferredDate:c,onSuccess:d,onCancel:m}){const[x,g]=j.useState({name:"",email:"",phone:""}),[b,w]=j.useState([]),[_,R]=j.useState("any"),[B,V]=j.useState(!1),[U,F]=j.useState(!1),[Q,H]=j.useState(""),re=W=>{w(T=>T.includes(W)?T.filter(E=>E!==W):[...T,W])},he=async W=>{W.preventDefault(),V(!0);try{const T=rO(),E=r1.find(O=>O.key===_),S=i&&i!=="any"?i.id:"any",I=i&&i!=="any"?i.name:"Any Available",k={clientName:x.name,clientEmail:x.email,clientPhone:x.phone,serviceId:t?.id||null,serviceName:t?.name||"Any Service",staffId:S,staffName:I,preferredDate:c||null,preferredDays:b.length>0?b:null,preferredTimeRange:E?{start:E.start,end:E.end}:null,status:"waiting",refCode:T,createdAt:new Date().toISOString(),notifiedAt:null,notifiedSlot:null};await Sa(Xe(pe,"shops",n,"waitlist"),k),H(T),F(!0),d&&d(T)}catch(T){console.error("Waitlist error:",T)}finally{V(!1)}};return U?a.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg shadow-blue-100/50 p-8 text-center animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Vs,{className:"w-8 h-8 text-blue-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"You're on the Waitlist!"}),a.jsxs("p",{className:"text-slate-600 mb-4",children:["We'll notify you when a slot opens up",t?` for ${t.name}`:"","."]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your waitlist reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:Q})]}),a.jsxs("a",{href:`#/shop/${e}/waitlist/${Q}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(os,{className:"w-4 h-4"}),"Check Waitlist Status"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to check your position and get notified"})]}):a.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg p-6 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(_f,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Join the Waitlist"}),a.jsx("p",{className:"text-sm text-slate-500",children:"We'll notify you when a slot opens up"})]})]}),a.jsxs("form",{onSubmit:he,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),a.jsx("input",{type:"text",value:x.name,onChange:W=>g({...x,name:W.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:x.email,onChange:W=>g({...x,email:W.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),a.jsx("input",{type:"tel",value:x.phone,onChange:W=>g({...x,phone:W.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["Preferred Days ",a.jsx("span",{className:"text-slate-400 font-normal",children:"(optional)"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:aO.map(W=>a.jsx("button",{type:"button",onClick:()=>re(W.key),className:`px-3.5 py-2 rounded-lg text-sm font-semibold transition-all border ${b.includes(W.key)?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:W.label},W.key))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preferred Time"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:r1.map(W=>a.jsx("button",{type:"button",onClick:()=>R(W.key),className:`px-3.5 py-2.5 rounded-lg text-sm font-medium transition-all border text-left ${_===W.key?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:W.label},W.key))})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:B,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:B?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Joining"]}):a.jsxs(a.Fragment,{children:[a.jsx(_f,{className:"w-4 h-4"}),"Join Waitlist"]})}),m&&a.jsx("button",{type:"button",onClick:m,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]})}function iO(){return a.jsxs("div",{className:"flex items-end gap-2 mb-3",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:a.jsx(Af,{className:"w-3.5 h-3.5 text-white"})}),a.jsx("div",{className:"bg-slate-100 rounded-2xl rounded-bl-md px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})}function lO({message:n,onSelectService:e,onQuickReply:t}){const i=n.sender==="bot";return a.jsxs("div",{className:`flex items-end gap-2 mb-3 ${i?"":"flex-row-reverse"}`,children:[i&&a.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:a.jsx(Af,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("div",{className:"max-w-[85%] space-y-2",children:[a.jsx("div",{className:`px-4 py-2.5 text-sm leading-relaxed whitespace-pre-line ${i?"bg-slate-100 text-slate-800 rounded-2xl rounded-bl-md":"bg-blue-600 text-white rounded-2xl rounded-br-md"}`,children:n.text}),n.serviceCards&&n.serviceCards.length>0&&a.jsx("div",{className:"space-y-1.5",children:n.serviceCards.map(o=>a.jsxs("button",{onClick:()=>e(o),className:"w-full flex items-center justify-between gap-2 px-3.5 py-2.5 bg-white border border-slate-200 hover:border-blue-400 rounded-xl text-left transition-all hover:shadow-sm group",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold text-slate-800 group-hover:text-blue-700 truncate",children:o.name}),a.jsxs("p",{className:"text-xs text-slate-500",children:[Xh(o.duration),"  ",xx(o.price)]})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 whitespace-nowrap flex items-center gap-0.5",children:["Book ",a.jsx(ed,{className:"w-3 h-3"})]})]},o.id))}),n.quickReplies&&n.quickReplies.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5 pt-1",children:n.quickReplies.map((o,c)=>a.jsx("button",{onClick:()=>t(o),className:"px-3 py-1.5 text-xs font-medium text-blue-600 bg-white border border-blue-200 hover:bg-blue-50 hover:border-blue-400 rounded-full transition-all",children:o},c))})]})]})}function xx(n){return n==null?"":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(n)}function Xh(n){if(!n)return"";if(n<60)return`${n} min`;const e=Math.floor(n/60),t=n%60;return t?`${e}h ${t}m`:`${e} hour${e>1?"s":""}`}function oO(n,{services:e,staffMembers:t,shop:i}){const o=n.toLowerCase().trim(),c=i?.name||"our shop";if(/^(hi|hello|hey|howdy|sup|yo|hiya|good\s*(morning|afternoon|evening))/.test(o))return{text:`Hi!  I'm here to help you book an appointment at ${c}. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]};if(/how (do i|to|can i) book|help.*(book|appoint)|booking help/i.test(o))return{text:`Booking is easy! Here's how:

1 Choose a service
2 Pick your stylist
3 Select a date & time
4 Fill in your details

That's it! Would you like to start?`,quickReplies:["View Services","View Staff"]};if(/what (services|do you offer)|menu|prices|how much|service list|your services/i.test(o)||o==="view services")return!e||e.length===0?{text:"We don't have any services listed right now. Please check back later!"}:{text:`Here are our services:

${e.map(m=>` ${m.name}  ${Xh(m.duration)}  ${xx(m.price)}`).join(`
`)}

Would you like to book one of these? Just tap below! `,serviceCards:e};if(e&&e.length>0){const d=e.find(m=>{const x=m.name.toLowerCase();return o.includes(x)||x.includes(o)});if(d&&o.length>2)return{text:`Great choice! Here are the details for **${d.name}**:

 Duration: ${Xh(d.duration)}
 Price: ${xx(d.price)}${d.description?`
 ${d.description}`:""}

Would you like to book this service? Tap "Book" below!`,serviceCards:[d],quickReplies:["View All Services","View Staff"]}}if(/how long|how much time|duration/i.test(o))return!e||e.length===0?{text:"No services are listed right now. Check back soon!"}:{text:`Here's how long each service takes:

${e.map(m=>` ${m.name}: ${Xh(m.duration)}`).join(`
`)}`,quickReplies:["View Services","How to Book"]};if(/who works|stylists?|staff|team|barber|who('s| is) (here|available)|your (team|people)/i.test(o)||o==="view staff")return!t||t.length===0?{text:"We don't have any team members listed right now."}:{text:`Meet our team! 

${t.map(m=>{let x=` ${m.name}`;return m.role&&(x+=`  ${m.role}`),m.bio&&(x+=`
  "${m.bio.slice(0,80)}${m.bio.length>80?"":""}"`),x}).join(`
`)}

You can pick your preferred stylist during booking.`,quickReplies:["View Services","How to Book"]};if(/available|open slot|when can i|next available|free slot|any opening/i.test(o)){const d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],m=new Set;return t&&t.length>0&&t.forEach(g=>{g.weeklyHours&&Object.entries(g.weeklyHours).forEach(([b,w])=>{w&&w.enabled&&m.add(b)})}),{text:`You can check available times by selecting a service and date in the booking flow above. We're generally available on ${m.size>0?[...m].sort((g,b)=>d.indexOf(g)-d.indexOf(b)).join(", "):"most days"}. `,quickReplies:["View Services","How to Book"]}}if(/hours|when are you open|business hours|open hours|what time|operating/i.test(o)){const d=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],m={};if(t&&t.length>0&&t.forEach(x=>{x.weeklyHours&&Object.entries(x.weeklyHours).forEach(([g,b])=>{b&&b.enabled&&b.start&&b.end&&(m[g]?(b.start<m[g].start&&(m[g].start=b.start),b.end>m[g].end&&(m[g].end=b.end)):m[g]={start:b.start,end:b.end})})}),Object.keys(m).length>0){const x=b=>{const[w,_]=b.split(":"),R=parseInt(w),B=R>=12?"PM":"AM";return`${R%12||12}:${_} ${B}`};return{text:`Here are our general hours:

${d.filter(b=>m[b]).map(b=>` ${b}: ${x(m[b].start)}  ${x(m[b].end)}`).join(`
`)}

Hours may vary by stylist. Select a service to see exact availability.`,quickReplies:["View Services","View Staff"]}}return{text:"Our hours vary by stylist. You can see exact availability by selecting a service above.",quickReplies:["View Services","How to Book"]}}return/phone|address|contact|where|location|email|reach/i.test(o)?{text:"For contact information, please reach out to the shop directly. You can also find us through the booking confirmation email after you book! ",quickReplies:["View Services","How to Book"]}:/cancel|reschedule|change my (booking|appointment)|modify/i.test(o)?{text:"You can manage your booking using the reference code you received. Go to your confirmation email and click 'Manage Booking' to reschedule or cancel. ",quickReplies:["How to Book","View Services"]}:/waitlist|no availability|fully booked|no slots|all booked|sold out/i.test(o)?{text:"If there are no available slots, you can join our waitlist and we'll notify you when something opens up! Look for the 'Join Waitlist' button when viewing available times. ",quickReplies:["View Services","How to Book"]}:/^(thanks?|thank you|thx|ty|cheers|appreciate)/i.test(o)?{text:"You're welcome!  Let me know if you need anything else.",quickReplies:["View Services","View Staff","How to Book"]}:{text:"I'm not sure about that. You can browse our services above, or try asking about our services, staff, or availability! ",quickReplies:["View Services","View Staff","How to Book"]}}function cO({services:n,staffMembers:e,shop:t,onSelectService:i}){const[o,c]=j.useState(!1),[d,m]=j.useState([]),[x,g]=j.useState(""),[b,w]=j.useState(!1),[_,R]=j.useState(!1),[B,V]=j.useState(!1),[U,F]=j.useState(!1),Q=j.useRef(null),H=j.useRef(null),re=t?.name||"our shop";j.useEffect(()=>{Q.current?.scrollIntoView({behavior:"smooth"})},[d,b]),j.useEffect(()=>{o&&setTimeout(()=>H.current?.focus(),100)},[o]);const he=j.useCallback(()=>{V(!1),F(!0),c(!0),d.length===0&&m([{id:"welcome",sender:"bot",text:`Hi!  Welcome to ${re}. I can help you find the right service and book an appointment. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]}])},[d.length,re]),W=j.useCallback(k=>{w(!0);const O=400+Math.random()*600;setTimeout(()=>{const C=oO(k,{services:n,staffMembers:e,shop:t});m($=>[...$,{id:`bot-${Date.now()}`,sender:"bot",text:C.text,serviceCards:C.serviceCards||null,quickReplies:C.quickReplies||null}]),w(!1)},O)},[n,e,t]),T=j.useCallback(()=>{const k=x.trim();k&&(m(O=>[...O,{id:`user-${Date.now()}`,sender:"user",text:k}]),g(""),W(k))},[x,W]),E=j.useCallback(k=>{m(O=>[...O,{id:`user-${Date.now()}`,sender:"user",text:k}]),W(k)},[W]),S=j.useCallback(k=>{i&&(i(k),m(O=>[...O,{id:`bot-${Date.now()}`,sender:"bot",text:`Great! I've selected "${k.name}" for you. You can now pick your stylist and time above. `}]),setTimeout(()=>c(!1),1500))},[i]),I=k=>{k.key==="Enter"&&!k.shiftKey&&(k.preventDefault(),T())};return a.jsxs(a.Fragment,{children:[B&&!o&&a.jsxs("div",{className:"fixed bottom-24 right-5 z-50 animate-fade-in",children:[a.jsx("button",{onClick:he,className:"bg-white border border-slate-200 shadow-lg rounded-2xl rounded-br-md px-4 py-3 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all max-w-[220px]",children:"Need help booking? "}),a.jsx("button",{onClick:()=>{V(!1),F(!0)},className:"absolute -top-2 -right-2 w-5 h-5 bg-slate-200 hover:bg-slate-300 rounded-full flex items-center justify-center text-slate-500 transition-colors",children:a.jsx(Ds,{className:"w-3 h-3"})})]}),o&&a.jsxs("div",{className:`fixed bottom-20 right-5 z-50 bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden animate-scale-in
                     w-[calc(100vw-2.5rem)] max-w-[380px] h-[min(500px,calc(100vh-7rem))]
                     sm:w-[380px] sm:right-5 sm:bottom-20`,style:{transformOrigin:"bottom right"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Af,{className:"w-4 h-4"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-bold leading-tight",children:"SpotBookie Assistant"}),a.jsx("p",{className:"text-[11px] text-blue-100",children:"Ask me anything about booking"})]})]}),a.jsx("button",{onClick:()=>c(!1),className:"w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors","aria-label":"Close chat",children:a.jsx(Ds,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-0 bg-slate-50/50",children:[d.map(k=>a.jsx(lO,{message:k,onSelectService:S,onQuickReply:E},k.id)),b&&a.jsx(iO,{}),a.jsx("div",{ref:Q})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 border-t border-slate-200 bg-white flex-shrink-0",children:[a.jsx("input",{ref:H,type:"text",value:x,onChange:k=>g(k.target.value),onKeyDown:I,placeholder:"Type a message",className:"flex-1 px-3.5 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder:text-slate-400"}),a.jsx("button",{onClick:T,disabled:!x.trim(),className:"w-10 h-10 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-200 disabled:cursor-not-allowed text-white disabled:text-slate-400 rounded-xl flex items-center justify-center transition-all flex-shrink-0","aria-label":"Send message",children:a.jsx(Wh,{className:"w-4 h-4"})})]})]}),a.jsx("button",{onClick:()=>{o?c(!1):he()},className:`fixed bottom-5 right-5 z-50 w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 hover:scale-105 hover:shadow-xl ${o?"bg-slate-700 hover:bg-slate-800":"bg-blue-600 hover:bg-blue-700 chat-bubble-pulse"}`,"aria-label":o?"Close chat assistant":"Open chat assistant",children:o?a.jsx(Ds,{className:"w-6 h-6 text-white"}):a.jsx(Af,{className:"w-6 h-6 text-white"})})]})}var A0={exports:{}},k0,l1;function uO(){if(l1)return k0;l1=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return k0=n,k0}var C0,o1;function dO(){if(o1)return C0;o1=1;var n=uO();function e(){}function t(){}return t.resetWarningCache=e,C0=function(){function i(d,m,x,g,b,w){if(w!==n){var _=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw _.name="Invariant Violation",_}}i.isRequired=i;function o(){return i}var c={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:o,element:i,elementType:i,instanceOf:o,node:i,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:t,resetWarningCache:e};return c.PropTypes=c,c},C0}var c1;function hO(){return c1||(c1=1,A0.exports=dO()()),A0.exports}var fO=hO();const es=vx(fO);function u1(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,i)}return t}function d1(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?u1(Object(t),!0).forEach(function(i){K2(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):u1(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Jh(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Jh=function(e){return typeof e}:Jh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jh(n)}function K2(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mO(n,e){if(n==null)return{};var t={},i=Object.keys(n),o,c;for(c=0;c<i.length;c++)o=i[c],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function pO(n,e){if(n==null)return{};var t=mO(n,e),i,o;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(o=0;o<c.length;o++)i=c[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function X2(n,e){return xO(n)||gO(n,e)||bO(n,e)||yO()}function xO(n){if(Array.isArray(n))return n}function gO(n,e){var t=n&&(typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"]);if(t!=null){var i=[],o=!0,c=!1,d,m;try{for(t=t.call(n);!(o=(d=t.next()).done)&&(i.push(d.value),!(e&&i.length===e));o=!0);}catch(x){c=!0,m=x}finally{try{!o&&t.return!=null&&t.return()}finally{if(c)throw m}}return i}}function bO(n,e){if(n){if(typeof n=="string")return h1(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return h1(n,e)}}function h1(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function yO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var hn=function(e,t,i){var o=!!i,c=ts.useRef(i);ts.useEffect(function(){c.current=i},[i]),ts.useEffect(function(){if(!o||!e)return function(){};var d=function(){c.current&&c.current.apply(c,arguments)};return e.on(t,d),function(){e.off(t,d)}},[o,t,e,c])},gx=function(e){var t=ts.useRef(e);return ts.useEffect(function(){t.current=e},[e]),t.current},qo=function(e){return e!==null&&Jh(e)==="object"},vO=function(e){return qo(e)&&typeof e.then=="function"},wO=function(e){return qo(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},f1="[object Object]",NO=function n(e,t){if(!qo(e)||!qo(t))return e===t;var i=Array.isArray(e),o=Array.isArray(t);if(i!==o)return!1;var c=Object.prototype.toString.call(e)===f1,d=Object.prototype.toString.call(t)===f1;if(c!==d)return!1;if(!c&&!i)return e===t;var m=Object.keys(e),x=Object.keys(t);if(m.length!==x.length)return!1;for(var g={},b=0;b<m.length;b+=1)g[m[b]]=!0;for(var w=0;w<x.length;w+=1)g[x[w]]=!0;var _=Object.keys(g);if(_.length!==m.length)return!1;var R=e,B=t,V=function(F){return n(R[F],B[F])};return _.every(V)},J2=function(e,t,i){return qo(e)?Object.keys(e).reduce(function(o,c){var d=!qo(t)||!NO(e[c],t[c]);return i.includes(c)?(d&&console.warn("Unsupported prop change: options.".concat(c," is not a mutable property.")),o):d?d1(d1({},o||{}),{},K2({},c,e[c])):o},null):null},Z2="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",m1=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Z2;if(e===null||wO(e))return e;throw new Error(t)},jO=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Z2;if(vO(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(o){return m1(o,t)})};var i=m1(e,t);return i===null?{tag:"empty"}:{tag:"sync",stripe:i}},_O=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.6.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.6.0",url:"https://stripe.com/docs/stripe-js/react"}))},om=ts.createContext(null);om.displayName="ElementsContext";var eS=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},tS=function(e){var t=e.stripe,i=e.options,o=e.children,c=ts.useMemo(function(){return jO(t)},[t]),d=ts.useState(function(){return{stripe:c.tag==="sync"?c.stripe:null,elements:c.tag==="sync"?c.stripe.elements(i):null}}),m=X2(d,2),x=m[0],g=m[1];ts.useEffect(function(){var _=!0,R=function(V){g(function(U){return U.stripe?U:{stripe:V,elements:V.elements(i)}})};return c.tag==="async"&&!x.stripe?c.stripePromise.then(function(B){B&&_&&R(B)}):c.tag==="sync"&&!x.stripe&&R(c.stripe),function(){_=!1}},[c,x,i]);var b=gx(t);ts.useEffect(function(){b!==null&&b!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[b,t]);var w=gx(i);return ts.useEffect(function(){if(x.elements){var _=J2(i,w,["clientSecret","fonts"]);_&&x.elements.update(_)}},[i,w,x.elements]),ts.useEffect(function(){_O(x.stripe)},[x.stripe]),ts.createElement(om.Provider,{value:x},o)};tS.propTypes={stripe:es.any,options:es.object};var SO=function(e){var t=ts.useContext(om);return eS(t,e)},EO=function(){var e=SO("calls useElements()"),t=e.elements;return t};es.func.isRequired;var sS=ts.createContext(null);sS.displayName="CheckoutContext";es.any,es.shape({clientSecret:es.oneOfType([es.string,es.instanceOf(Promise)]).isRequired,elementsOptions:es.object}).isRequired;var bx=function(e){var t=ts.useContext(sS),i=ts.useContext(om);if(t){if(i)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t}else return eS(i,e)},TO=["mode"],AO=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},An=function(e,t){var i="".concat(AO(e),"Element"),o=function(x){var g=x.id,b=x.className,w=x.options,_=w===void 0?{}:w,R=x.onBlur,B=x.onFocus,V=x.onReady,U=x.onChange,F=x.onEscape,Q=x.onClick,H=x.onLoadError,re=x.onLoaderStart,he=x.onNetworksChange,W=x.onConfirm,T=x.onCancel,E=x.onShippingAddressChange,S=x.onShippingRateChange,I=x.onSavedPaymentMethodRemove,k=x.onSavedPaymentMethodUpdate,O=bx("mounts <".concat(i,">")),C="elements"in O?O.elements:null,$="checkoutState"in O?O.checkoutState:null,L=$?.type==="success"||$?.type==="loading"?$.sdk:null,P=ts.useState(null),K=X2(P,2),le=K[0],Ee=K[1],ye=ts.useRef(null),z=ts.useRef(null);hn(le,"blur",R),hn(le,"focus",B),hn(le,"escape",F),hn(le,"click",Q),hn(le,"loaderror",H),hn(le,"loaderstart",re),hn(le,"networkschange",he),hn(le,"confirm",W),hn(le,"cancel",T),hn(le,"shippingaddresschange",E),hn(le,"shippingratechange",S),hn(le,"savedpaymentmethodremove",I),hn(le,"savedpaymentmethodupdate",k),hn(le,"change",U);var Z;V&&(e==="expressCheckout"?Z=V:Z=function(){V(le)}),hn(le,"ready",Z),ts.useLayoutEffect(function(){if(ye.current===null&&z.current!==null&&(C||L)){var ge=null;if(L)switch(e){case"paymentForm":ge=L.createPaymentFormElement(_);break;case"payment":ge=L.createPaymentElement(_);break;case"address":if("mode"in _){var de=_.mode,Ce=pO(_,TO);if(de==="shipping")ge=L.createShippingAddressElement(Ce);else if(de==="billing")ge=L.createBillingAddressElement(Ce);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":ge=L.createExpressCheckoutElement(_);break;case"currencySelector":ge=L.createCurrencySelectorElement();break;case"taxId":ge=L.createTaxIdElement(_);break;default:throw new Error("Invalid Element type ".concat(i,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else C&&(ge=C.create(e,_));ye.current=ge,Ee(ge),ge&&ge.mount(z.current)}},[C,L,_]);var ce=gx(_);return ts.useEffect(function(){if(ye.current){var ge=J2(_,ce,["paymentRequest"]);ge&&"update"in ye.current&&ye.current.update(ge)}},[_,ce]),ts.useLayoutEffect(function(){return function(){if(ye.current&&typeof ye.current.destroy=="function")try{ye.current.destroy(),ye.current=null}catch{}}},[]),ts.createElement("div",{id:g,className:b,ref:z})},c=function(x){bx("mounts <".concat(i,">"));var g=x.id,b=x.className;return ts.createElement("div",{id:g,className:b})},d=t?c:o;return d.propTypes={id:es.string,className:es.string,onChange:es.func,onBlur:es.func,onFocus:es.func,onReady:es.func,onEscape:es.func,onClick:es.func,onLoadError:es.func,onLoaderStart:es.func,onNetworksChange:es.func,onConfirm:es.func,onCancel:es.func,onShippingAddressChange:es.func,onShippingRateChange:es.func,onSavedPaymentMethodRemove:es.func,onSavedPaymentMethodUpdate:es.func,options:es.object},d.displayName=i,d.__elementType=e,d},kn=typeof window>"u",kO=ts.createContext(null);kO.displayName="EmbeddedCheckoutProviderContext";var CO=function(){var e=bx("calls useStripe()"),t=e.stripe;return t};An("auBankAccount",kn);var p1=An("card",kn);An("cardNumber",kn);An("cardExpiry",kn);An("cardCvc",kn);An("iban",kn);An("payment",kn);An("expressCheckout",kn);An("paymentRequestButton",kn);An("linkAuthentication",kn);An("address",kn);An("shippingAddress",kn);An("paymentMethodMessaging",kn);An("taxId",kn);function Zh(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Zh=function(e){return typeof e}:Zh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zh(n)}var nS="clover",RO=function(e){return e===3?"v3":e},aS="https://js.stripe.com",IO="".concat(aS,"/").concat(nS,"/stripe.js"),DO=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,MO=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var OO=function(e){return DO.test(e)||MO.test(e)},PO=function(){for(var e=document.querySelectorAll('script[src^="'.concat(aS,'"]')),t=0;t<e.length;t++){var i=e[t];if(OO(i.src))return i}return null},x1=function(e){var t="",i=document.createElement("script");i.src="".concat(IO).concat(t);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(i),i},LO=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.7.0",startTime:t})},nu=null,kh=null,Ch=null,VO=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},UO=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},BO=function(e){return nu!==null?nu:(nu=new Promise(function(t,i){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var o=PO();if(!(o&&e)){if(!o)o=x1(e);else if(o&&Ch!==null&&kh!==null){var c;o.removeEventListener("load",Ch),o.removeEventListener("error",kh),(c=o.parentNode)===null||c===void 0||c.removeChild(o),o=x1(e)}}Ch=UO(t,i),kh=VO(i),o.addEventListener("load",Ch),o.addEventListener("error",kh)}catch(d){i(d);return}}),nu.catch(function(t){return nu=null,Promise.reject(t)}))},zO=function(e,t,i){if(e===null)return null;var o=t[0];if(typeof o!="string")throw new Error("Expected publishable key to be of type string, got type ".concat(Zh(o)," instead."));var c=o.match(/^pk_test/),d=RO(e.version),m=nS;c&&d!==m&&console.warn("Stripe.js@".concat(d," was loaded on the page, but @stripe/stripe-js@").concat("8.7.0"," expected Stripe.js@").concat(m,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var x=e.apply(void 0,t);return LO(x,i),x},au,rS=!1,iS=function(){return au||(au=BO(null).catch(function(e){return au=null,Promise.reject(e)}),au)};Promise.resolve().then(function(){return iS()}).catch(function(n){rS||console.warn(n)});var FO=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];rS=!0;var o=Date.now();return iS().then(function(c){return zO(c,t,o)})};const $O=FO("pk_test_51NXZytLhwB1Jyzw82kEuknbGp3F4vTdnqmBrVmzsHqKYeldrpbiWInM6U2v2ojnsLW4u251zbpRk2UiXnwBgiQZo00bK99q5kj"),qO="https://us-central1-scheduler-65e51.cloudfunctions.net",HO={style:{base:{fontSize:"16px",color:"#1e293b",fontFamily:"system-ui, -apple-system, sans-serif","::placeholder":{color:"#94a3b8"}},invalid:{color:"#ef4444",iconColor:"#ef4444"}}};function GO({amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:m=!0}){const x=CO(),g=EO(),[b,w]=j.useState(!1),[_,R]=j.useState(null),[B,V]=j.useState(!1),U=async Q=>{if(Q.preventDefault(),!x||!g)return;w(!0),R(null);const H=g.getElement(p1),{error:re,paymentMethod:he}=await x.createPaymentMethod({type:"card",card:H,billing_details:{name:i.name,email:i.email,phone:i.phone}});if(re){R(re.message),w(!1);return}if(m&&c)try{const W=await fetch(`${qO}/createDepositPaymentIntent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:c,amount:n,serviceName:o,clientName:i.name,clientEmail:i.email,bookingRefCode:d,paymentMethodId:he.id})}),T=await W.json();if(!W.ok){T.needsConnect?R("This shop has not connected Stripe yet. Please contact the shop owner."):T.needsOnboarding?R("This shop is still setting up payments. Please try again later."):R(T.error||"Payment failed. Please try again."),w(!1);return}console.log("Payment processed:",T.paymentIntentId),w(!1),e({paymentMethodId:he.id,paymentIntentId:T.paymentIntentId,last4:he.card.last4,brand:he.card.brand,amount:T.amount})}catch(W){console.error("Payment error:",W),R("Payment failed. Please try again."),w(!1)}else console.log("Payment method created (no Connect):",he.id),await new Promise(W=>setTimeout(W,500)),w(!1),e({paymentMethodId:he.id,last4:he.card.last4,brand:he.card.brand})},F=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q/100);return a.jsxs("form",{onSubmit:U,className:"space-y-5",children:[a.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 rounded-xl p-5 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-emerald-100 text-sm font-medium",children:["Deposit for ",o]}),a.jsx("p",{className:"text-3xl font-bold mt-1",children:F(n)})]}),a.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:a.jsx(_n,{className:"w-6 h-6"})})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Card Details"}),a.jsx("div",{className:"p-4 border-2 border-slate-200 rounded-xl focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-500/20 transition-all bg-white",children:a.jsx(p1,{options:HO,onChange:Q=>{V(Q.complete),Q.error?R(Q.error.message):R(null)}})})]}),_&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:[a.jsx(Pu,{className:"w-4 h-4 flex-shrink-0"}),_]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[a.jsx(Sf,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:"Your payment is secured with 256-bit encryption"})]}),a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-700",children:[a.jsx(Pu,{className:"w-4 h-4 flex-shrink-0"}),a.jsxs("span",{children:[a.jsx("strong",{children:"Test Mode:"})," Use card number ",a.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"4242 4242 4242 4242"})," with any future date and CVC."]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:b||!x||!B,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold shadow-md shadow-emerald-600/20 hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:b?a.jsxs(a.Fragment,{children:[a.jsx(ra,{className:"w-4 h-4 animate-spin"}),"Processing"]}):a.jsxs(a.Fragment,{children:[a.jsx(Sf,{className:"w-4 h-4"}),"Pay ",F(n)]})}),a.jsx("button",{type:"button",onClick:t,disabled:b,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 disabled:opacity-50",children:"Back"})]})]})}function YO({amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:m=!0}){return a.jsx(tS,{stripe:$O,children:a.jsx(GO,{amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:m})})}const WO=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function Ya(n){const[e,t]=n.split(":").map(Number);return e*60+t}function g1(n){const e=Math.floor(n/60),t=n%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}function QO(n){const e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${i}`}function KO(n,e,t){if(!t||t.length===0)return!1;for(const i of t){if(!i||!i.start||!i.end)continue;const o=Ya(i.start),c=Ya(i.end);if(n<c&&e>o)return!0}return!1}function XO(n,e){if(!e||e.length===0)return n;const t=[...e].filter(o=>o&&o.start&&o.end).sort((o,c)=>Ya(o.start)-Ya(c.start));let i=n;for(const o of t){const c=Ya(o.start),d=Ya(o.end);if(i<c)break;i<d&&(i=d)}return i}function JO(n,e,t,i,o,c){if(!n)return[];const m=new Date(e+"T12:00:00").getDay(),x=WO[m],g=n[x];if(!g||!g.enabled)return[];const b=Ya(g.start),w=Ya(g.end),_=g.breaks||(g.break?[g.break]:[]),R=t+i,B=[];let V=b;for(;V+t<=w;){const U=V+t;if(KO(V,U,_)){V=XO(V,_);continue}B.push({id:`wh-${o}-${e}-${g1(V)}`,date:e,time:g1(V),duration:t,available:!0,staffId:o,staffName:c,generated:!0}),V+=R}return B}function lS(n,e,t=0,i=4){const o=[],c=new Date;c.setHours(0,0,0,0);const d=new Date(c);d.setDate(d.getDate()+i*7);for(const m of n){if(!m.weeklyHours)continue;const x=new Date(c);for(;x<d;){const g=QO(x),b=JO(m.weeklyHours,g,e,t,m.id,m.name);o.push(...b),x.setDate(x.getDate()+1)}}return o}function oS(n,e,t=0){const i=e.filter(o=>!o.status||o.status==="pending"||o.status==="confirmed");return n.filter(o=>{const c=Ya(o.time),d=c+o.duration;return!i.some(x=>{if(o.staffId&&x.staffId&&x.staffId!==o.staffId||x.date!==o.date)return!1;const g=Ya(x.time),b=x.serviceDuration||x.duration||o.duration,w=g+b;return!(d+t<=g||w+t<=c)})})}function cS(n,e){const t=new Set(e.map(o=>`${o.staffId||""}-${o.date}-${o.time}`)),i=n.filter(o=>{const c=`${o.staffId||""}-${o.date}-${o.time}`;return!t.has(c)});return[...e,...i]}function mu({name:n,className:e="w-12 h-12",bgClass:t="bg-blue-100 text-blue-700"}){const i=(n||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return a.jsx("div",{className:`${e} ${t} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function ZO(){return a.jsxs(at,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(Na,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function e9({member:n,onClose:e}){const[t,i]=j.useState(null),o=n.portfolio||[];return j.useEffect(()=>{const c=d=>{d.key==="Escape"&&(t!==null?i(null):e())};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,e]),a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in",children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center text-slate-600 transition-all z-10",children:a.jsx(Ds,{className:"w-4 h-4"})}),a.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(mu,{name:n.name,className:"w-14 h-14",bgClass:"bg-violet-100 text-violet-700"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name}),n.role&&a.jsx("p",{className:"text-sm text-violet-600 font-medium",children:n.role})]})]}),n.bio&&a.jsx("p",{className:"mt-3 text-sm text-slate-600 leading-relaxed",children:n.bio})]}),a.jsx("div",{className:"p-6",children:o.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(lm,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:o.map((c,d)=>a.jsxs("button",{onClick:()=>i(d),className:"group relative aspect-square rounded-xl overflow-hidden bg-slate-100 shadow-sm hover:shadow-md transition-all hover:-translate-y-0.5",children:[a.jsx("img",{src:c.url,alt:c.caption||"Portfolio",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),c.caption&&a.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/70 to-transparent p-2.5 pt-6",children:a.jsx("p",{className:"text-xs text-white font-medium truncate",children:c.caption})})]},d))})})]}),t!==null&&o[t]&&a.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/90",children:[a.jsx("button",{onClick:()=>i(null),className:"absolute top-4 right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(Ds,{className:"w-5 h-5"})}),t>0&&a.jsx("button",{onClick:()=>i(t-1),className:"absolute left-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(Rg,{className:"w-5 h-5"})}),t<o.length-1&&a.jsx("button",{onClick:()=>i(t+1),className:"absolute right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(ed,{className:"w-5 h-5"})}),a.jsxs("div",{className:"max-w-4xl max-h-[85vh] flex flex-col items-center",children:[a.jsx("img",{src:o[t].url,alt:o[t].caption||"Portfolio",className:"max-w-full max-h-[75vh] object-contain rounded-lg"}),o[t].caption&&a.jsx("p",{className:"mt-3 text-sm text-white/90 font-medium text-center px-4",children:o[t].caption}),a.jsxs("p",{className:"mt-1 text-xs text-white/50",children:[t+1," / ",o.length]})]})]})]})}function t9(){const{slug:n}=Wo(),[e,t]=j.useState(null),[i,o]=j.useState(null),[c,d]=j.useState(!0),[m,x]=j.useState(!1),[g,b]=j.useState([]),[w,_]=j.useState([]),[R,B]=j.useState(null),[V,U]=j.useState(null),[F,Q]=j.useState([]),[H,re]=j.useState([]),[he,W]=j.useState(!1),[T,E]=j.useState(null),[S,I]=j.useState(null),[k,O]=j.useState(""),[C,$]=j.useState(!1),[L,P]=j.useState({name:"",email:"",phone:""}),[K,le]=j.useState(""),[Ee,ye]=j.useState(!1),[z,Z]=j.useState(null),[ce,ge]=j.useState(!1),[de,Ce]=j.useState("biweekly"),[Fe,Rt]=j.useState(null),[it,Bt]=j.useState(!1),[ne,je]=j.useState(null);j.useEffect(()=>{(async()=>{d(!0),x(!1);try{const Te=Fn(Xe(pe,"shops"),jn("slug","==",n)),ot=await Ls(Te);if(ot.empty)x(!0);else{const pt=ot.docs[0];t(pt.data()),o(pt.id)}}catch(Te){console.error("Error looking up shop:",Te),x(!0)}finally{d(!1)}})()},[n]),j.useEffect(()=>{if(!i)return;const _e=ss(Xe(pe,"shops",i,"services"),Dt=>{const M=Dt.docs.map(G=>({id:G.id,...G.data()})).filter(G=>G.active!==!1).sort((G,fe)=>(G.name||"").localeCompare(fe.name||""));b(M)}),Te=ss(Xe(pe,"shops",i,"availability"),Dt=>{const M=new Date,G=Dt.docs.map(fe=>({id:fe.id,...fe.data()})).filter(fe=>new Date(`${fe.date}T${fe.time}`)>M);Q(G)}),ot=ss(Xe(pe,"shops",i,"bookings"),Dt=>{const M=Dt.docs.map(G=>({id:G.id,...G.data()}));re(M)}),pt=ss(Xe(pe,"shops",i,"staff"),Dt=>{const M=Dt.docs.map(G=>({id:G.id,...G.data()})).filter(G=>G.active!==!1).sort((G,fe)=>(G.name||"").localeCompare(fe.name||""));_(M)});return()=>{_e(),Te(),ot(),pt()}},[i]),j.useEffect(()=>{w.length===1?U(w[0]):w.length===0&&U(null)},[w]);const Se=g.length>0;w.length>0;const $e=w.length>1,Ze=e?.bufferMinutes||0,Et=j.useMemo(()=>{const _e=new Date;let Te=F.filter(M=>M.available);if(R&&(Te=Te.filter(M=>M.duration>=R.duration)),V&&V!=="any"&&(Te=Te.filter(M=>M.staffId===V.id||!M.staffId)),!R)return Te;const ot=V&&V!=="any"?w.filter(M=>M.id===V.id):w,pt=lS(ot,R.duration,Ze,4).filter(M=>new Date(`${M.date}T${M.time}`)>_e),Dt=cS(pt,Te);return oS(Dt,H,Ze)},[F,R,V,w,H,Ze]),Bs=(_e,Te,ot=3)=>{const pt=[],Dt=new Date(_e+"T12:00:00"),M=new Date(Dt);M.setMonth(M.getMonth()+ot);let G=new Date(Dt);for(Te==="weekly"?G.setDate(G.getDate()+7):Te==="biweekly"?G.setDate(G.getDate()+14):Te==="fourweekly"?G.setDate(G.getDate()+28):Te==="monthly"&&G.setMonth(G.getMonth()+1);G<=M;){const fe=G.getFullYear(),ue=String(G.getMonth()+1).padStart(2,"0"),Ve=String(G.getDate()).padStart(2,"0");pt.push(`${fe}-${ue}-${Ve}`),Te==="weekly"?G.setDate(G.getDate()+7):Te==="biweekly"?G.setDate(G.getDate()+14):Te==="fourweekly"?G.setDate(G.getDate()+28):Te==="monthly"&&G.setMonth(G.getMonth()+1)}return pt},Mt=j.useMemo(()=>{if(!ce||!T)return null;const _e=Bs(T.date,de),Te=R?R.duration:T.duration||60,ot=V&&V!=="any"?V.id:T.staffId,pt=T.time,Dt=H.filter(Tt=>!Tt.status||Tt.status==="pending"||Tt.status==="confirmed"),M=Tt=>{const[Os,Ot]=Tt.split(":").map(Number);return Os*60+Ot},G=M(pt),fe=G+Te;let ue=[],Ve=[];const et=new Set;_e.forEach(Tt=>{Dt.some(Ot=>{if(ot&&Ot.staffId&&Ot.staffId!==ot||Ot.date!==Tt)return!1;const zs=M(Ot.time),Jt=Ot.serviceDuration||Ot.duration||Te,ms=zs+Jt,on=Ze||0;return!(fe+on<=zs||ms+on<=G)})||et.has(Tt)?Ve.push(Tt):(ue.push(Tt),et.add(Tt))});const ft=_e.length>0?_e[_e.length-1]:T.date,Qe=new Date(ft+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),vt={weekly:"week",biweekly:"2 weeks",fourweekly:"4 weeks",monthly:"month"};return{available:ue,conflicts:Ve,total:ue.length+1,skipped:Ve.length,endDate:Qe,intervalLabel:vt[de]||de}},[ce,de,T,R,V,H,Ze]),xt=_e=>{B(_e),w.length>1&&U(null),I(null),E(null),W(!1),O("")},Ie=_e=>{U(_e),I(null),E(null),W(!1),O("")},Be=()=>{B(null),w.length>1&&U(null),I(null),E(null),W(!1)},xe=()=>{I(null),E(null),W(!1),$e?U(null):Se&&B(null)},qe=_e=>{E(_e),W(!0),O("")},Le=()=>{const _e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let Te="BK";for(let ot=0;ot<4;ot++)Te+=_e.charAt(Math.floor(Math.random()*_e.length));return Te},De=_e=>{_e.preventDefault(),gt?Bt(!0):He()},Ge=_e=>{je(_e),He(_e)},He=async(_e=null)=>{$(!0),Rt(null);try{const Te=Le(),ot=e?.requireApproval?"pending":"confirmed",pt=ce?`rg-${Date.now()}-${Math.random().toString(36).slice(2,8)}`:null,Dt=ce&&Mt?Mt.endDate:null,M={slotId:T.id,date:T.date,time:T.time,duration:R?R.duration:T.duration,clientName:L.name,clientEmail:L.email,clientPhone:L.phone,bookedAt:new Date().toISOString(),status:ot,refCode:Te};if(R&&(M.serviceId=R.id,M.serviceName=R.name,M.servicePrice=R.price,M.serviceDuration=R.duration,M.depositPercent=R.depositPercent||0),_e||ne){const ue=_e||ne;M.depositPaid=!0,M.depositAmount=hs/100,M.paymentMethodId=ue.paymentMethodId,M.cardLast4=ue.last4,M.cardBrand=ue.brand}V&&V!=="any"?(M.staffId=V.id,M.staffName=V.name):T.staffId&&(M.staffId=T.staffId,M.staffName=T.staffName||""),ce&&pt&&(M.recurring=!0,M.recurringInterval=de,M.recurringGroupId=pt,M.recurringUntil=Dt),await Sa(Xe(pe,"shops",i,"bookings"),M),T.generated||await Ye(Oe(pe,"shops",i,"availability",T.id),{available:!1});let G=1,fe=0;if(ce&&Mt){const ue=Mt.available;fe=Mt.skipped;for(const Ve of ue){const et=Le(),ft={...M,date:Ve,slotId:`recurring-${pt}-${Ve}`,refCode:et,bookedAt:new Date().toISOString()};await Sa(Xe(pe,"shops",i,"bookings"),ft),G++}Rt({created:G,skipped:fe})}P({name:"",email:"",phone:""}),W(!1),Bt(!1),je(null),E(null),B(null),I(null),U(w.length===1?w[0]:null),ge(!1),le(Te),e?.requireApproval?O(" Your booking request has been submitted! The shop will review and confirm it shortly."):O(" Booking confirmed! You will receive a confirmation email shortly.")}catch(Te){console.error("Booking error:",Te),O(" Something went wrong. Please try again.")}finally{$(!1)}},J=_e=>new Date(_e+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),Ae=_e=>{const[Te,ot]=_e.split(":"),pt=parseInt(Te),Dt=pt>=12?"PM":"AM";return`${pt%12||12}:${ot} ${Dt}`},We=_e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(_e),tt=_e=>{if(_e<60)return`${_e} min`;const Te=Math.floor(_e/60),ot=_e%60;return ot?`${Te}h ${ot}m`:`${Te} hour${Te>1?"s":""}`};if(c)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking page"})]})});if(m)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Ct,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(ba,{className:"w-4 h-4"}),"Go Home"]})]})});if(e?.archived)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-amber-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Nu,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Unavailable"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[a.jsx("span",{className:"font-semibold",children:e.name})," is currently not accepting new bookings. Please check back later or contact the shop directly."]}),a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(ba,{className:"w-4 h-4"}),"Go Home"]})]})});const It=[...new Set(Et.map(_e=>_e.date))].sort(),rs=S?Et.filter(_e=>_e.date===S):Et,gt=R&&R.depositPercent>0,hs=gt?Math.round(R.price*(R.depositPercent/100)*100):0,rn=it?"payment":he?"form":Se&&!R?"services":$e&&!V?"staff":"calendar",Ms=[];Se&&Ms.push({key:"services",label:"Service"}),$e&&Ms.push({key:"staff",label:"Stylist"}),Ms.push({key:"calendar",label:"Date & Time"}),Ms.push({key:"form",label:"Details"}),gt&&Ms.push({key:"payment",label:"Payment"});const Cn=Ms.findIndex(_e=>_e.key===rn),ln=["border-l-blue-500","border-l-violet-500","border-l-emerald-500","border-l-amber-500","border-l-rose-500","border-l-cyan-500","border-l-indigo-500","border-l-pink-500","border-l-teal-500"];return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[e.logoUrl?a.jsx("img",{src:e.logoUrl,alt:`${e.name} logo`,className:"w-10 h-10 rounded-xl object-cover shadow-md"}):a.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md",style:{backgroundColor:e.brandColor||"#3B82F6"},children:(e.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e.name}),a.jsx("p",{className:"text-xs text-slate-500",children:e.tagline||"Book your appointment"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(at,{to:`/shop/${n}/login`,className:"flex items-center gap-1.5 px-3.5 py-2 text-xs font-medium text-slate-500 hover:text-slate-700 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[a.jsx(Sf,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Owner"})]}),a.jsx(ZO,{})]})]})}),a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[Ms.length>1&&a.jsx("div",{className:"flex items-center justify-center gap-0 mb-8 animate-fade-in",children:Ms.map((_e,Te)=>{const ot=_e.key===rn,pt=Te<Cn;return a.jsxs(j.Fragment,{children:[Te>0&&a.jsx("div",{className:`w-8 sm:w-14 h-0.5 transition-colors duration-300 ${Te<=Cn?"bg-blue-500":"bg-slate-200"}`}),a.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[a.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 ${ot?"bg-blue-600 text-white shadow-md shadow-blue-600/30 scale-110":pt?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:pt?a.jsx(Vs,{className:"w-5 h-5"}):Te+1}),a.jsx("span",{className:`text-xs font-medium hidden sm:block transition-colors ${ot?"text-blue-700":pt?"text-blue-600":"text-slate-400"}`,children:_e.label})]})]},_e.key)})}),k&&a.jsx("div",{className:"mb-8 animate-scale-in",children:k.startsWith("")?a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx($2,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Confirmed!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"You're all set. We'll send a confirmation to your email."}),Fe&&a.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[a.jsx(Ti,{className:"w-4 h-4"}),"Recurring Series Created"]}),a.jsxs("p",{className:"text-sm text-slate-700",children:[Fe.created," appointment",Fe.created!==1?"s":""," booked"]}),Fe.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",Fe.skipped," date",Fe.skipped!==1?"s":""," skipped due to conflicts"]})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:K})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsxs(at,{to:`/shop/${n}/booking/${K}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(Na,{className:"w-4 h-4"}),"Manage Your Booking"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-lg text-sm text-emerald-700 font-medium",children:[a.jsx(Na,{className:"w-4 h-4"}),"Add to your calendar to remember"]})]}):k.startsWith("")?a.jsxs("div",{className:"bg-white rounded-2xl border border-amber-200 shadow-lg shadow-amber-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(os,{className:"w-8 h-8 text-amber-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Request Submitted!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking request has been submitted! The shop will review and confirm it shortly."}),Fe&&a.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[a.jsx(Ti,{className:"w-4 h-4"}),"Recurring Series Created"]}),a.jsxs("p",{className:"text-sm text-slate-700",children:[Fe.created," appointment",Fe.created!==1?"s":""," submitted"]}),Fe.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",Fe.skipped," date",Fe.skipped!==1?"s":""," skipped due to conflicts"]})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:K})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsxs(at,{to:`/shop/${n}/booking/${K}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(Na,{className:"w-4 h-4"}),"Manage Your Booking"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-700 font-medium",children:[a.jsx(os,{className:"w-4 h-4"}),"You'll be notified once it's confirmed"]})]}):a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Something went wrong. Please try again."})]})}),rn==="services"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a Service"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select the service you'd like to book"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 stagger-children",children:g.map((_e,Te)=>a.jsxs("button",{onClick:()=>xt(_e),className:`group text-left bg-white border-l-4 ${ln[Te%ln.length]} border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5`,children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors pr-2",children:_e.name}),a.jsx("span",{className:"text-xl font-extrabold text-blue-600 whitespace-nowrap",children:We(_e.price)})]}),_e.description&&a.jsx("p",{className:"text-sm text-slate-500 mb-3 line-clamp-2 leading-relaxed",children:_e.description}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-400",children:[a.jsx(os,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:tt(_e.duration)})]}),a.jsx("span",{className:"text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]})]},_e.id))})]}),rn==="staff"&&a.jsxs("div",{className:"animate-fade-in",children:[Se&&R&&a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:Be,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(ba,{className:"w-3.5 h-3.5"}),"Back"]}),a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Tn,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:R.name}),a.jsx("span",{className:"text-blue-600 font-bold",children:We(R.price)})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose Your Stylist"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select your preferred professional"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 stagger-children",children:[a.jsxs("button",{onClick:()=>Ie("any"),className:"group text-left bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-3.5 mb-3",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Ft,{className:"w-5 h-5 text-slate-500"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:"Any Available"}),a.jsx("p",{className:"text-xs text-slate-500",children:"First available professional"})]})]}),a.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),w.map(_e=>{const Te=_e.portfolio||[];return a.jsxs("div",{className:"group bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[a.jsxs("button",{onClick:()=>Ie(_e),className:"w-full text-left",children:[a.jsxs("div",{className:"flex items-center gap-3.5 mb-2",children:[a.jsx(mu,{name:_e.name}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:_e.name}),_e.role&&a.jsx("p",{className:"text-xs text-slate-500",children:_e.role})]})]}),_e.bio&&a.jsx("p",{className:"text-xs text-slate-500 leading-relaxed mb-2 line-clamp-2",children:_e.bio}),Te.length>0&&a.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[Te.slice(0,3).map((ot,pt)=>a.jsx("img",{src:ot.url,alt:ot.caption||"Work",className:"w-10 h-10 rounded-md object-cover border border-slate-200"},pt)),Te.length>3&&a.jsxs("span",{className:"w-10 h-10 rounded-md bg-slate-100 border border-slate-200 flex items-center justify-center text-xs text-slate-500 font-semibold",children:["+",Te.length-3]})]}),a.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),Te.length>0&&a.jsxs("button",{onClick:ot=>{ot.stopPropagation(),Z(_e)},className:"mt-2 w-full flex items-center justify-center gap-1.5 py-1.5 text-xs font-semibold text-violet-600 hover:text-violet-700 hover:bg-violet-50 rounded-lg transition-all",children:[a.jsx(lm,{className:"w-3.5 h-3.5"}),"View Portfolio (",Te.length,")"]})]},_e.id)})]})]}),rn==="calendar"&&a.jsxs("div",{className:"animate-fade-in",children:[(Se||$e)&&a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:xe,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(ba,{className:"w-3.5 h-3.5"}),"Back"]}),R&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Tn,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:R.name}),a.jsx("span",{className:"text-blue-600 font-bold",children:We(R.price)}),a.jsxs("span",{className:"text-slate-400",children:[" ",tt(R.duration)]})]}),V&&V!=="any"&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[a.jsx(mu,{name:V.name,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:V.name})]}),V==="any"&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm",children:[a.jsx(Ft,{className:"w-3.5 h-3.5 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-700",children:"Any Available"})]})]}),It.length===0?a.jsx("div",{children:Ee?a.jsx("div",{className:"max-w-lg mx-auto",children:a.jsx(i1,{shopId:i,slug:n,selectedService:R,selectedStaff:V,staffMembers:w,preferredDate:null,onCancel:()=>ye(!1)})}):a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(Ct,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),a.jsx("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:R?`No time slots available for ${R.name} (${tt(R.duration)}). Join the waitlist to be notified when a slot opens up!`:"Check back soon for new availability, or join the waitlist!"}),a.jsxs("button",{onClick:()=>ye(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:[a.jsx(_f,{className:"w-4 h-4"}),"Join Waitlist"]})]})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Select a Date"}),a.jsx("p",{className:"text-slate-500 text-sm",children:"Pick a day that works for you"})]}),a.jsx("div",{className:"mb-8",children:a.jsx(Q2,{availableDates:It,selectedDate:S,onSelectDate:I})}),S&&a.jsxs("div",{className:"animate-slide-down",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",J(S)]}),a.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[rs.length," slot",rs.length!==1?"s":""]})]}),rs.length===0?a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:[a.jsx("p",{className:"text-slate-500 mb-4",children:"No times available for this date"}),Ee?a.jsx("div",{className:"mt-4 text-left",children:a.jsx(i1,{shopId:i,slug:n,selectedService:R,selectedStaff:V,staffMembers:w,preferredDate:S,onCancel:()=>ye(!1)})}):a.jsxs("button",{onClick:()=>ye(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(_f,{className:"w-4 h-4"}),"Join the Waitlist"]})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:rs.sort((_e,Te)=>_e.time.localeCompare(Te.time)).map(_e=>a.jsxs("button",{onClick:()=>qe(_e),className:"group bg-white border border-slate-200 hover:border-blue-400 rounded-xl p-4 transition-all duration-200 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-slate-900 group-hover:text-blue-700 transition-colors mb-1",children:Ae(_e.time)}),_e.staffName&&V==="any"&&a.jsxs("div",{className:"text-xs text-violet-600 mb-0.5 flex items-center justify-center gap-1",children:[a.jsx(Ft,{className:"w-3 h-3"}),_e.staffName]}),a.jsx("div",{className:"text-xs text-slate-400",children:R?tt(R.duration):`${_e.duration} min`})]},_e.id))})]}),!S&&a.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]}),rn==="form"&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Complete Your Booking"}),a.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Review your details and confirm"}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[R&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Tn,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:R.name})]}),a.jsx("span",{className:"font-bold text-blue-600",children:We(R.price)})]}),V&&V!=="any"&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(mu,{name:V.name,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-800",children:V.name}),V.role&&a.jsxs("span",{className:"text-slate-400 text-sm ml-1.5",children:[" ",V.role]})]})]}),V==="any"&&T?.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(mu,{name:T.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:T.staffName})]}),a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Ct,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[J(T.date)," at ",Ae(T.time)]})]}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(os,{className:"w-4 h-4 text-slate-500"})}),a.jsx("span",{children:R?tt(R.duration):`${T.duration} min`})]})]}),a.jsxs("form",{onSubmit:De,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),a.jsx("input",{type:"text",value:L.name,onChange:_e=>P({...L,name:_e.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:L.email,onChange:_e=>P({...L,email:_e.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),a.jsx("input",{type:"tel",value:L.phone,onChange:_e=>P({...L,phone:_e.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Ti,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Make this recurring"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Book the same slot on a regular schedule"})]})]}),a.jsx("button",{type:"button",onClick:()=>ge(!ce),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${ce?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${ce?"translate-x-6":"translate-x-1"}`})})]}),ce&&a.jsxs("div",{className:"space-y-3 pt-1 animate-fade-in",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Repeat every"}),a.jsxs("select",{value:de,onChange:_e=>Ce(_e.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[a.jsx("option",{value:"weekly",children:"Week"}),a.jsx("option",{value:"biweekly",children:"2 Weeks"}),a.jsx("option",{value:"fourweekly",children:"4 Weeks"}),a.jsx("option",{value:"monthly",children:"Month"})]})]}),Mt&&a.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:[" Every ",Mt.intervalLabel," through ",Mt.endDate]}),a.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[Mt.total," total appointment",Mt.total!==1?"s":""]}),Mt.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1 font-medium",children:[" ",Mt.skipped," date",Mt.skipped!==1?"s":""," will be skipped due to existing bookings"]})]})]})]}),gt&&a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(_n,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm font-semibold text-emerald-800",children:["$",(hs/100).toFixed(2)," deposit required"]}),a.jsxs("p",{className:"text-xs text-emerald-600",children:[R.depositPercent,"% of service price  Remaining $",(R.price-hs/100).toFixed(2)," due at appointment"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:C,className:`flex-1 flex items-center justify-center gap-2 px-6 py-3.5 ${gt?"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-600/20 hover:shadow-emerald-600/25":""} text-white rounded-xl font-semibold shadow-md hover:shadow-lg transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0`,style:gt?{}:{backgroundColor:e.brandColor||"#3B82F6"},children:C?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):gt?a.jsxs(a.Fragment,{children:[a.jsx(_n,{className:"w-4 h-4"}),"Continue to Payment"]}):a.jsxs(a.Fragment,{children:[a.jsx(Vs,{className:"w-4 h-4"}),"Confirm Booking"]})}),a.jsx("button",{type:"button",onClick:()=>{W(!1),E(null)},className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]}),rn==="payment"&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Secure Payment"}),a.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Complete your deposit to confirm your booking"}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Ct,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-800",children:R?.name}),a.jsxs("p",{className:"text-sm text-slate-500",children:[T&&J(T.date)," at ",T&&Ae(T.time)]})]})]}),a.jsxs("div",{className:"text-sm text-slate-600 pl-13",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Client:"})," ",L.name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",L.email]})]})]}),!e?.payoutsEnabled&&(!e?.subscriptionTier||e?.subscriptionTier==="free")&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(_n,{className:"w-4 h-4 text-red-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800 text-sm",children:"Booking Unavailable"}),a.jsx("p",{className:"text-xs text-red-700 mt-1",children:"This shop is still setting up their payment system and cannot accept bookings yet. Please check back later or contact the shop directly."})]})]})}),!e?.payoutsEnabled&&e?.subscriptionTier&&e?.subscriptionTier!=="free"&&a.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(_n,{className:"w-4 h-4 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-amber-800 text-sm",children:"Payment Setup in Progress"}),a.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"This shop is still setting up their payment system. You can still book, but payment will be collected at the time of your appointment."}),a.jsx("button",{onClick:()=>He(),disabled:C,className:"mt-3 flex items-center gap-2 px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg font-semibold text-sm transition-all disabled:opacity-50",children:C?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):a.jsxs(a.Fragment,{children:[a.jsx(Vs,{className:"w-4 h-4"}),"Book Without Deposit"]})})]})]})}),e?.payoutsEnabled&&a.jsx(YO,{amount:hs,serviceName:R?.name||"Service",clientInfo:L,onSuccess:Ge,onCancel:()=>Bt(!1),shopId:i,bookingRefCode:null,shopHasConnect:e?.payoutsEnabled}),!e?.payoutsEnabled&&a.jsx("button",{onClick:()=>Bt(!1),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 mt-4",children:" Back"})]})]}),z&&a.jsx(e9,{member:z,onClose:()=>Z(null)}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(at,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})}),a.jsx(cO,{services:g,staffMembers:w,shop:e,onSelectService:xt})]})}function s9({slotsByDate:n,bookingsByDate:e,selectedDate:t,onSelectDate:i,recurringDayFlags:o={},breaksByDate:c={}}){const[d,m]=j.useState(new Date),x=he=>{const W=he.getFullYear(),T=he.getMonth(),E=new Date(W,T,1),I=new Date(W,T+1,0).getDate(),k=E.getDay();return{daysInMonth:I,startingDayOfWeek:k,year:W,month:T}},{daysInMonth:g,startingDayOfWeek:b,year:w,month:_}=x(d),R=()=>{m(new Date(d.getFullYear(),d.getMonth()-1))},B=()=>{m(new Date(d.getFullYear(),d.getMonth()+1))},V=he=>`${w}-${String(_+1).padStart(2,"0")}-${String(he).padStart(2,"0")}`,U=he=>{const W=V(he),T=n[W]||[],E=e[W]||[],S=c[W]||[],I=T.filter(C=>C.available).length,k=E.length,O=S.length;return{availableCount:I,bookedCount:k,breakCount:O,hasData:T.length>0||E.length>0||O>0}},F=he=>{const W=V(he);i(W===t?null:W)},Q=["January","February","March","April","May","June","July","August","September","October","November","December"],H=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],re=new Date;return re.setHours(0,0,0,0),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-5",children:[a.jsx("button",{onClick:R,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Rg,{className:"w-5 h-5 text-slate-600"})}),a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[Q[_]," ",w]}),a.jsx("button",{onClick:B,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(ed,{className:"w-5 h-5 text-slate-600"})})]}),a.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:H.map(he=>a.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:he},he))}),a.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:b}).map((he,W)=>a.jsx("div",{},`empty-${W}`)),Array.from({length:g}).map((he,W)=>{const T=W+1,E=V(T),{availableCount:S,bookedCount:I,breakCount:k,hasData:O}=U(T),C=E===t,$=new Date,L=$.getDate()===T&&$.getMonth()===_&&$.getFullYear()===w,P=new Date(w,_,T),K=P.getDay(),le=o[K]&&P>=re;return a.jsxs("button",{onClick:()=>F(T),className:`
                relative p-2 text-center rounded-lg text-sm font-semibold transition-all duration-200 min-h-[56px] flex flex-col items-center justify-start cursor-pointer
                ${C?"bg-blue-600 text-white shadow-md shadow-blue-600/30":O||le?"bg-slate-50 hover:bg-slate-100 text-slate-900 border border-slate-200 hover:border-slate-300":L?"text-slate-900 font-bold hover:bg-slate-50":"text-slate-400 hover:bg-slate-50"}
              `,children:[a.jsxs("span",{className:`text-sm ${L&&!C?"relative":""}`,children:[T,L&&!C&&a.jsx("span",{className:"absolute -bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]}),(O||le)&&a.jsxs("div",{className:"flex gap-0.5 mt-1 flex-wrap justify-center",children:[le&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${C?"bg-white/20 text-white":"bg-violet-100 text-violet-700"}`,children:"R"}),k>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${C?"bg-white/20 text-white":"bg-amber-100 text-amber-700"}`,children:""}),S>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${C?"bg-white/20 text-white":"bg-emerald-100 text-emerald-700"}`,children:S}),I>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${C?"bg-white/20 text-white":"bg-blue-100 text-blue-700"}`,children:I})]})]},T)})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-xs text-slate-500",children:[Object.keys(o).length>0&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-violet-100 border border-violet-200 rounded flex items-center justify-center text-[7px] font-bold text-violet-700",children:"R"}),a.jsx("span",{children:"Recurring"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-amber-100 border border-amber-200 rounded flex items-center justify-center text-[8px]",children:""}),a.jsx("span",{children:"Break"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-emerald-100 border border-emerald-200 rounded"}),a.jsx("span",{children:"Available"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-blue-100 border border-blue-200 rounded"}),a.jsx("span",{children:"Booked"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-blue-600 rounded"}),a.jsx("span",{children:"Selected"})]})]})]})}const n9=[{value:15,label:"15 min"},{value:30,label:"30 min"},{value:45,label:"45 min"},{value:60,label:"1 hour"},{value:90,label:"1.5 hours"},{value:120,label:"2 hours"}],a9=[{value:0,label:"No deposit required"},{value:10,label:"10%"},{value:20,label:"20%"},{value:25,label:"25%"},{value:50,label:"50%"},{value:100,label:"Full payment upfront"}];function r9({shopId:n}){const[e,t]=j.useState([]),[i,o]=j.useState(!1),[c,d]=j.useState(null),[m,x]=j.useState({name:"",description:"",duration:30,price:"",depositPercent:0}),[g,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;const F=ss(Xe(pe,"shops",n,"services"),Q=>{const H=Q.docs.map(re=>({id:re.id,...re.data()})).filter(re=>re.active!==!1).sort((re,he)=>(re.name||"").localeCompare(he.name||""));t(H)});return()=>F()},[n]);const w=()=>{x({name:"",description:"",duration:30,price:"",depositPercent:0}),o(!1),d(null)},_=async F=>{F.preventDefault(),b(!0);const Q={name:m.name.trim(),description:m.description.trim(),duration:parseInt(m.duration),price:parseFloat(m.price),depositPercent:parseInt(m.depositPercent)||0,active:!0};try{c?await Ye(Oe(pe,"shops",n,"services",c),Q):await Sa(Xe(pe,"shops",n,"services"),{...Q,createdAt:kr()}),w()}catch(H){console.error("Error saving service:",H)}finally{b(!1)}},R=F=>{x({name:F.name,description:F.description||"",duration:F.duration,price:F.price.toString(),depositPercent:F.depositPercent||0}),d(F.id),o(!0)},B=async F=>{try{await Ye(Oe(pe,"shops",n,"services",F),{active:!1})}catch(Q){console.error("Error deleting service:",Q)}},V=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F),U=F=>{if(F<60)return`${F} min`;const Q=Math.floor(F/60),H=F%60;return H?`${Q}h ${H}m`:`${Q}h`};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Services"}),a.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Define the services you offer  clients will pick one before booking"})]}),!i&&a.jsxs("button",{onClick:()=>{w(),o(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(tr,{className:"w-4 h-4"}),"Add Service"]})]}),i&&a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:c?"Edit Service":"New Service"}),a.jsxs("form",{onSubmit:_,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Service Name *"}),a.jsx("input",{type:"text",value:m.name,onChange:F=>x({...m,name:F.target.value}),required:!0,placeholder:"e.g. Haircut",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description (optional)"}),a.jsx("input",{type:"text",value:m.description,onChange:F=>x({...m,description:F.target.value}),placeholder:"e.g. Classic cut and style",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Duration *"}),a.jsx("select",{value:m.duration,onChange:F=>x({...m,duration:F.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:n9.map(F=>a.jsx("option",{value:F.value,children:F.label},F.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Price (USD) *"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-semibold",children:"$"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:m.price,onChange:F=>x({...m,price:F.target.value}),required:!0,placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx(_n,{className:"w-4 h-4 text-emerald-500"}),"Deposit Required"]})}),a.jsx("select",{value:m.depositPercent,onChange:F=>x({...m,depositPercent:F.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:a9.map(F=>a.jsx("option",{value:F.value,children:F.label},F.value))})]})]}),m.depositPercent>0&&m.price&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-emerald-50 border border-emerald-200 rounded-lg text-sm",children:[a.jsx(_n,{className:"w-4 h-4 text-emerald-600"}),a.jsxs("span",{className:"text-emerald-800",children:["Clients will pay ",a.jsxs("strong",{children:["$",((parseFloat(m.price)||0)*(parseInt(m.depositPercent)/100)).toFixed(2)]})," deposit at booking",parseInt(m.depositPercent)<100&&a.jsxs("span",{children:[" ($",((parseFloat(m.price)||0)*(1-parseInt(m.depositPercent)/100)).toFixed(2)," remaining due at appointment)"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:g,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(Js,{className:"w-4 h-4"}),g?"Saving":c?"Update Service":"Add Service"]}),a.jsxs("button",{type:"button",onClick:w,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Ds,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"text-5xl mb-3",children:""}),a.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No services yet"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Add your first service so clients can choose what to book"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(F=>a.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:F.name}),F.description&&a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:F.description})]}),a.jsx("span",{className:"text-xl font-bold text-blue-600 whitespace-nowrap ml-3",children:V(F.price)})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500 mb-4 flex-wrap",children:[a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx(os,{className:"w-4 h-4"}),U(F.duration)]}),F.depositPercent>0&&a.jsxs("span",{className:"flex items-center gap-1.5 text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full text-xs font-medium",children:[a.jsx(_n,{className:"w-3 h-3"}),F.depositPercent,"% deposit"]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>R(F),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:[a.jsx(Dg,{className:"w-3.5 h-3.5"}),"Edit"]}),a.jsx("button",{onClick:()=>B(F.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:a.jsx(ya,{className:"w-3.5 h-3.5"})})]})]},F.id))})]})}const ru=[{key:"monday",label:"Monday",short:"Mon"},{key:"tuesday",label:"Tuesday",short:"Tue"},{key:"wednesday",label:"Wednesday",short:"Wed"},{key:"thursday",label:"Thursday",short:"Thu"},{key:"friday",label:"Friday",short:"Fri"},{key:"saturday",label:"Saturday",short:"Sat"},{key:"sunday",label:"Sunday",short:"Sun"}],b1={enabled:!1,start:"09:00",end:"17:00",breaks:[]};function i9({shopId:n,staffId:e,staffName:t,weeklyHours:i,onClose:o}){const[c,d]=j.useState(()=>{const E={};for(const S of ru){const I=i?.[S.key];if(I){const k=I.breaks||(I.break?[I.break]:[]);E[S.key]={enabled:!!I.enabled,start:I.start||"09:00",end:I.end||"17:00",breaks:k}}else E[S.key]={...b1,breaks:[]}}return E}),[m,x]=j.useState(!1),[g,b]=j.useState(null),[w,_]=j.useState([]),[R,B]=j.useState(!1),[V,U]=j.useState(null);j.useEffect(()=>{if(!n)return;const E=ss(Xe(pe,"shops",n,"schedulePresets"),S=>{const I=S.docs.map(k=>({id:k.id,...k.data()})).sort((k,O)=>k.isDefault&&!O.isDefault?-1:!k.isDefault&&O.isDefault?1:(k.name||"").localeCompare(O.name||""));_(I)});return()=>E()},[n]);const F=(E,S,I)=>{d(k=>({...k,[E]:{...k[E],[S]:I}})),U(null)},Q=E=>{d(S=>({...S,[E]:{...S[E],breaks:[...S[E].breaks||[],{start:"12:00",end:"13:00"}]}})),U(null)},H=(E,S,I,k)=>{d(O=>{const C=[...O[E].breaks||[]];return C[S]={...C[S],[I]:k},{...O,[E]:{...O[E],breaks:C}}}),U(null)},re=(E,S)=>{d(I=>({...I,[E]:{...I[E],breaks:I[E].breaks.filter((k,O)=>O!==S)}})),U(null)},he=E=>{const S=c[E];d(I=>{const k={...I};for(const O of ru)O.key!==E&&(k[O.key]={enabled:S.enabled,start:S.start,end:S.end,breaks:S.breaks.map(C=>({...C}))});return k}),b(E),U(null),setTimeout(()=>b(null),1500)},W=E=>{if(!E.days)return;const S={};for(const I of ru){const k=E.days[I.key];if(k){const O=k.breaks||(k.break?[k.break]:[]);S[I.key]={enabled:!!k.enabled,start:k.start||"09:00",end:k.end||"17:00",breaks:O.map(C=>({...C}))}}else S[I.key]={...b1,breaks:[]}}d(S),B(!1),U(E.name),setTimeout(()=>U(null),2e3)},T=async()=>{x(!0);try{const E={};for(const S of ru){const I=c[S.key];E[S.key]={enabled:I.enabled,start:I.start,end:I.end,breaks:I.breaks||[],break:I.breaks&&I.breaks.length>0?I.breaks[0]:null}}await Ye(Oe(pe,"shops",n,"staff",e),{weeklyHours:E}),o()}catch(E){console.error("Error saving weekly hours:",E)}finally{x(!1)}};return a.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Weekly Hours"}),a.jsx("p",{className:"text-sm text-slate-500",children:t})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[w.length>0&&a.jsxs("div",{className:"relative",children:[a.jsxs("button",{type:"button",onClick:()=>B(!R),className:"flex items-center gap-2 px-4 py-2 bg-violet-50 hover:bg-violet-100 text-violet-700 border border-violet-200 rounded-xl text-sm font-semibold transition-all",children:[a.jsx(Ct,{className:"w-4 h-4"}),"Apply Preset",a.jsx(Ou,{className:`w-4 h-4 transition-transform ${R?"rotate-180":""}`})]}),R&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>B(!1)}),a.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white border border-slate-200 rounded-xl shadow-xl z-20 py-2 max-h-80 overflow-y-auto",children:w.map(E=>a.jsxs("button",{onClick:()=>W(E),className:"w-full px-4 py-3 text-left hover:bg-blue-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:E.name}),E.isDefault&&a.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded",children:"DEFAULT"})]}),E.description&&a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:E.description})]},E.id))})]})]}),a.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Ds,{className:"w-5 h-5 text-slate-400"})})]})]}),V&&a.jsxs("div",{className:"mb-4 px-4 py-3 bg-green-50 border border-green-200 rounded-xl flex items-center gap-2 text-sm text-green-700 font-medium animate-fade-in",children:[a.jsx(Js,{className:"w-4 h-4"}),'Applied "',V,'" preset  click Save to keep changes']}),a.jsx("div",{className:"space-y-3",children:ru.map(({key:E,label:S})=>{const I=c[E],k=I.breaks||[];return a.jsxs("div",{className:`rounded-xl p-4 transition-all ${I.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{type:"button",onClick:()=>F(E,"enabled",!I.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${I.enabled?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${I.enabled?"translate-x-6":"translate-x-1"}`})}),a.jsx("span",{className:`font-semibold text-sm ${I.enabled?"text-slate-900":"text-slate-400"}`,children:S}),!I.enabled&&a.jsx("span",{className:"text-sm text-slate-400 italic ml-2",children:"Day off"})]}),I.enabled&&a.jsxs("div",{className:"mt-3 ml-14 space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx(os,{className:"w-4 h-4 text-blue-500"}),a.jsx("input",{type:"time",value:I.start,onChange:O=>F(E,"start",O.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),a.jsx("input",{type:"time",value:I.end,onChange:O=>F(E,"end",O.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{type:"button",onClick:()=>Q(E),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${k.length>0?"bg-amber-100 text-amber-700 border border-amber-200":"bg-slate-100 text-slate-500 border border-slate-200 hover:bg-amber-50 hover:text-amber-600 hover:border-amber-200"}`,children:[a.jsx(jf,{className:"w-3.5 h-3.5"}),k.length>0?`${k.length} Break${k.length>1?"s":""}`:"+ Break"]}),a.jsx("button",{type:"button",onClick:()=>he(E),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:g===E?" Copied!":"Copy to all"})]})]}),I.enabled&&k.length>0&&a.jsx("div",{className:"mt-2 ml-14 space-y-2",children:k.map((O,C)=>a.jsxs("div",{className:"flex items-start gap-2 animate-fade-in",children:[a.jsx(jf,{className:"w-3.5 h-3.5 text-amber-500 mt-2"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("span",{className:"text-xs text-slate-500 block mb-1",children:["Break ",C+1]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("input",{type:"time",value:O.start,onChange:$=>H(E,C,"start",$.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("span",{className:"text-slate-400 text-xs",children:"to"}),a.jsx("input",{type:"time",value:O.end,onChange:$=>H(E,C,"end",$.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("button",{type:"button",onClick:()=>re(E,C),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",title:"Remove break",children:a.jsx(Ds,{className:"w-3.5 h-3.5"})})]})]})]},C))})]},E)})}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t border-slate-200",children:[a.jsxs("button",{onClick:T,disabled:m,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(q2,{className:"w-4 h-4"}),m?"Saving":"Save Hours"]}),a.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Ds,{className:"w-4 h-4"}),"Cancel"]})]})]})}const vo=[{key:"monday",short:"Mon",label:"Monday"},{key:"tuesday",short:"Tue",label:"Tuesday"},{key:"wednesday",short:"Wed",label:"Wednesday"},{key:"thursday",short:"Thu",label:"Thursday"},{key:"friday",short:"Fri",label:"Friday"},{key:"saturday",short:"Sat",label:"Saturday"},{key:"sunday",short:"Sun",label:"Sunday"}],l9=[{name:"Full-time 9-5",description:"Monday to Friday, 9am to 5pm with lunch break",days:{monday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},tuesday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},wednesday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},thursday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},friday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},saturday:{enabled:!1,start:"09:00",end:"17:00",breaks:[]},sunday:{enabled:!1,start:"09:00",end:"17:00",breaks:[]}},isDefault:!0},{name:"Part-time Mornings",description:"Monday to Friday, 9am to 1pm",days:{monday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},tuesday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},wednesday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},thursday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},friday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},saturday:{enabled:!1,start:"09:00",end:"13:00",breaks:[]},sunday:{enabled:!1,start:"09:00",end:"13:00",breaks:[]}},isDefault:!0},{name:"Weekends Only",description:"Saturday and Sunday, 10am to 6pm",days:{monday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},tuesday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},wednesday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},thursday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},friday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},saturday:{enabled:!0,start:"10:00",end:"18:00",breaks:[{start:"13:00",end:"14:00"}]},sunday:{enabled:!0,start:"10:00",end:"18:00",breaks:[{start:"13:00",end:"14:00"}]}},isDefault:!0}],Rh={enabled:!1,start:"09:00",end:"17:00",breaks:[]};function y1(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return t===0?`${o}${i}`:`${o}:${t.toString().padStart(2,"0")}${i}`}function o9({shopId:n}){const[e,t]=j.useState([]),[i,o]=j.useState(!0),[c,d]=j.useState(!1),[m,x]=j.useState(null),[g,b]=j.useState(!1),[w,_]=j.useState({name:"",description:"",days:{}});j.useEffect(()=>{R()},[]),j.useEffect(()=>{if(!n)return;const S=ss(Xe(pe,"shops",n,"schedulePresets"),I=>{const k=I.docs.map(O=>({id:O.id,...O.data()})).sort((O,C)=>O.isDefault&&!C.isDefault?-1:!O.isDefault&&C.isDefault?1:(O.name||"").localeCompare(C.name||""));t(k),o(!1)});return()=>S()},[n]);const R=()=>{const S={};vo.forEach(I=>{S[I.key]={...Rh,breaks:[]}}),_({name:"",description:"",days:S}),x(null),d(!1)},B=async()=>{try{for(const S of l9)await Sa(Xe(pe,"shops",n,"schedulePresets"),{...S,createdAt:kr()})}catch(S){console.error("Error initializing default presets:",S)}},V=async S=>{if(S.preventDefault(),!!w.name.trim()){b(!0);try{const I={name:w.name.trim(),description:w.description.trim(),days:w.days,isDefault:!1,updatedAt:kr()};m?await Ye(Oe(pe,"shops",n,"schedulePresets",m.id),I):await Sa(Xe(pe,"shops",n,"schedulePresets"),{...I,createdAt:kr()}),R()}catch(I){console.error("Error saving preset:",I)}finally{b(!1)}}},U=S=>{const I={};vo.forEach(k=>{const O=S.days?.[k.key];O?I[k.key]={enabled:!!O.enabled,start:O.start||"09:00",end:O.end||"17:00",breaks:O.breaks||(O.break?[O.break]:[])}:I[k.key]={...Rh,breaks:[]}}),_({name:S.name,description:S.description||"",days:I}),x(S),d(!0)},F=async S=>{if(confirm("Delete this schedule preset?"))try{await Io(Oe(pe,"shops",n,"schedulePresets",S))}catch(I){console.error("Error deleting preset:",I)}},Q=S=>{const I={};vo.forEach(k=>{const O=S.days?.[k.key];O?I[k.key]={enabled:!!O.enabled,start:O.start||"09:00",end:O.end||"17:00",breaks:[...O.breaks||(O.break?[O.break]:[])]}:I[k.key]={...Rh,breaks:[]}}),_({name:`${S.name} (Copy)`,description:S.description||"",days:I}),x(null),d(!0)},H=(S,I,k)=>{_(O=>({...O,days:{...O.days,[S]:{...O.days[S],[I]:k}}}))},re=S=>{_(I=>({...I,days:{...I.days,[S]:{...I.days[S],breaks:[...I.days[S].breaks||[],{start:"12:00",end:"13:00"}]}}}))},he=(S,I,k,O)=>{_(C=>{const $=[...C.days[S].breaks||[]];return $[I]={...$[I],[k]:O},{...C,days:{...C.days,[S]:{...C.days[S],breaks:$}}}})},W=(S,I)=>{_(k=>({...k,days:{...k.days,[S]:{...k.days[S],breaks:k.days[S].breaks.filter((O,C)=>C!==I)}}}))},T=S=>{const I=w.days[S];_(k=>{const O={...k.days};return vo.forEach(C=>{C.key!==S&&(O[C.key]={enabled:I.enabled,start:I.start,end:I.end,breaks:I.breaks.map($=>({...$}))})}),{...k,days:O}})},E=S=>{if(!S.days)return"No schedule configured";const I=vo.filter(O=>S.days[O.key]?.enabled);return I.length===0?"No working days":I.map(O=>{const C=S.days[O.key],$=C.breaks||(C.break?[C.break]:[]),L=$.length>0?` (${$.length} break${$.length>1?"s":""})`:"";return`${O.short} ${y1(C.start)}${y1(C.end)}${L}`}).join("  ")};return i?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"spinner"})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Schedule Presets"}),a.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create reusable schedule templates with breaks to quickly apply to staff"})]}),!c&&a.jsxs("button",{onClick:()=>{R(),d(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(tr,{className:"w-4 h-4"}),"New Preset"]})]}),e.length===0&&!c&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 text-center mb-6",children:[a.jsx(Ct,{className:"w-10 h-10 text-blue-500 mx-auto mb-3"}),a.jsx("h3",{className:"font-bold text-slate-900 mb-2",children:"Get started with presets"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:'Add common schedule templates like "Full-time 9-5" or "Weekends Only"'}),a.jsxs("button",{onClick:B,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(tr,{className:"w-4 h-4"}),"Add Default Presets"]})]}),c&&a.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 mb-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:m?"Edit Preset":"New Schedule Preset"}),a.jsx("button",{onClick:R,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Ds,{className:"w-5 h-5 text-slate-400"})})]}),a.jsxs("form",{onSubmit:V,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preset Name *"}),a.jsx("input",{type:"text",value:w.name,onChange:S=>_({...w,name:S.target.value}),placeholder:"e.g., Full-time 9-5",required:!0,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description"}),a.jsx("input",{type:"text",value:w.description,onChange:S=>_({...w,description:S.target.value}),placeholder:"e.g., Standard work week with lunch break",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Weekly Schedule"}),vo.map(({key:S,label:I})=>{const k=w.days[S]||Rh;return a.jsxs("div",{className:`rounded-xl p-4 transition-all ${k.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-[140px]",children:[a.jsx("button",{type:"button",onClick:()=>H(S,"enabled",!k.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${k.enabled?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${k.enabled?"translate-x-6":"translate-x-1"}`})}),a.jsx("span",{className:`font-semibold text-sm ${k.enabled?"text-slate-900":"text-slate-400"}`,children:I})]}),k.enabled?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(os,{className:"w-4 h-4 text-blue-500"}),a.jsx("input",{type:"time",value:k.start,onChange:O=>H(S,"start",O.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),a.jsx("input",{type:"time",value:k.end,onChange:O=>H(S,"end",O.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("button",{type:"button",onClick:()=>re(S),className:"flex items-center gap-1.5 px-3 py-1.5 bg-amber-100 hover:bg-amber-200 text-amber-700 border border-amber-200 rounded-lg text-xs font-semibold transition-all",children:[a.jsx(jf,{className:"w-3.5 h-3.5"}),"+ Break"]}),a.jsx("button",{type:"button",onClick:()=>T(S),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:"Copy to all"})]}):a.jsx("span",{className:"text-sm text-slate-400 italic",children:"Day off"})]}),k.enabled&&k.breaks&&k.breaks.length>0&&a.jsx("div",{className:"mt-3 ml-[140px] space-y-2",children:k.breaks.map((O,C)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jf,{className:"w-3.5 h-3.5 text-amber-500"}),a.jsx("span",{className:"text-xs text-slate-500",children:"Break:"}),a.jsx("input",{type:"time",value:O.start,onChange:$=>he(S,C,"start",$.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("span",{className:"text-slate-400 text-xs",children:""}),a.jsx("input",{type:"time",value:O.end,onChange:$=>he(S,C,"end",$.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("button",{type:"button",onClick:()=>W(S,C),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",children:a.jsx(Ds,{className:"w-3.5 h-3.5"})})]},C))})]},S)})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:g,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(q2,{className:"w-4 h-4"}),g?"Saving":m?"Update Preset":"Save Preset"]}),a.jsxs("button",{type:"button",onClick:R,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Ds,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length>0&&a.jsx("div",{className:"space-y-3",children:e.map(S=>a.jsx("div",{className:"bg-white border border-slate-200 rounded-xl p-5 hover:shadow-md transition-all",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900",children:S.name}),S.isDefault&&a.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-[10px] font-bold rounded-md",children:"DEFAULT"})]}),S.description&&a.jsx("p",{className:"text-sm text-slate-500 mb-2",children:S.description}),a.jsx("p",{className:"text-xs text-slate-400 leading-relaxed",children:E(S)})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx("button",{onClick:()=>Q(S),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"Duplicate preset",children:a.jsx(B2,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>U(S),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"Edit preset",children:a.jsx(Dg,{className:"w-4 h-4"})}),!S.isDefault&&a.jsx("button",{onClick:()=>F(S.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Delete preset",children:a.jsx(ya,{className:"w-4 h-4"})})]})]})},S.id))})]})}const Sr={free:{name:"Free",price:0,staffLimit:1,platformFeePercent:5,features:["basicBooking","emailNotifications"]},pro:{name:"Pro",price:29,priceId:null,staffLimit:5,platformFeePercent:0,features:["basicBooking","emailNotifications","aiAssistant","recurringBookings","waitlist","crm","analytics","smsNotifications","customBranding"]},unlimited:{name:"Unlimited",price:79,priceId:null,staffLimit:1/0,platformFeePercent:0,features:["basicBooking","emailNotifications","aiAssistant","recurringBookings","waitlist","crm","analytics","smsNotifications","customBranding","walkIns","multiLocation","noBranding","apiAccess","prioritySupport"]}},c9={basicBooking:{name:"Online Booking",description:"Accept bookings through your booking page"},emailNotifications:{name:"Email Notifications",description:"Automatic booking confirmations and reminders"},aiAssistant:{name:"AI Booking Assistant",description:"Smart suggestions and automated responses"},recurringBookings:{name:"Recurring Bookings",description:"Schedule repeating appointments"},waitlist:{name:"Waitlist",description:"Let clients join a waitlist when fully booked"},crm:{name:"Client CRM",description:"Client notes, history, and win-back tracking"},analytics:{name:"Analytics",description:"Detailed booking and revenue analytics"},smsNotifications:{name:"SMS Notifications",description:"Send text message reminders to clients"},customBranding:{name:"Custom Branding",description:"Customize colors and branding on your booking page"},walkIns:{name:"Walk-in Queue",description:"Manage walk-in clients with live queue"},multiLocation:{name:"Multi-Location",description:"Manage multiple business locations"},noBranding:{name:"Remove SpotBookie Branding",description:"White-label your booking experience"},apiAccess:{name:"API Access",description:"Integrate with external tools and systems"},prioritySupport:{name:"Priority Support",description:"24/7 priority customer support"}};function uS(n){const e=n?.subscriptionTier||"free";return Sr[e]?.staffLimit||1}function u9(n,e){const t=uS(n);return e<t}function d9(n,e){const t=Sr[n]||Sr.free,i=Sr[e];return i?i.features.filter(o=>!t.features.includes(o)):[]}function h9(n){const e=["free","pro","unlimited"],t=e.indexOf(n||"free");return e.slice(t+1).map(i=>({key:i,...Sr[i],newFeatures:d9(n,i)}))}const f9="https://us-central1-scheduler-65e51.cloudfunctions.net",m9={pro:"price_1Sxx7ILhwB1Jyzw8UvRxE5FT",unlimited:"price_1Sxx7JLhwB1Jyzw8uw9BRYhO"};function p9({isOpen:n,onClose:e,shopId:t,slug:i,currentTier:o="free",feature:c,title:d,description:m}){const[x,g]=j.useState(null),[b,w]=j.useState(null);if(!n)return null;const _=h9(o),R=async B=>{g(B),w(null);try{const V=await fetch(`${f9}/createCheckoutSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:t,priceId:m9[B],successUrl:`${window.location.origin}/#/shop/${i}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/#/shop/${i}/dashboard?subscription=canceled`})}),U=await V.json();if(!V.ok)throw new Error(U.error||"Failed to create checkout session");window.location.href=U.url}catch(V){console.error("Upgrade error:",V),w(V.message),g(null)}};return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-violet-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20",children:a.jsx(Fo,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:d||"Upgrade Required"}),a.jsx("p",{className:"text-sm text-slate-500",children:m||"Unlock more features with a premium plan"})]})]}),a.jsx("button",{onClick:e,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",children:a.jsx(Ds,{className:"w-5 h-5"})})]}),b&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:b}),a.jsx("div",{className:"space-y-3",children:_.map(B=>a.jsxs("div",{className:`border-2 rounded-xl p-4 transition-all ${B.key==="pro"?"border-blue-300 bg-blue-50/50":"border-violet-300 bg-violet-50/50"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-slate-900",children:B.name}),a.jsxs("p",{className:"text-lg font-extrabold text-slate-900",children:["$",B.price,a.jsx("span",{className:"text-sm font-normal text-slate-500",children:"/month"})]})]}),a.jsx("button",{onClick:()=>R(B.key),disabled:x,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-semibold text-sm transition-all disabled:opacity-50 ${B.key==="pro"?"bg-blue-500 hover:bg-blue-600 text-white shadow-md shadow-blue-500/20":"bg-violet-500 hover:bg-violet-600 text-white shadow-md shadow-violet-500/20"}`,children:x===B.key?a.jsx(ra,{className:"w-4 h-4 animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(ec,{className:"w-4 h-4"}),"Upgrade"]})})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[B.key==="pro"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-blue-200 rounded-lg text-xs font-medium text-blue-700",children:[a.jsx(Ft,{className:"w-3 h-3"}),"5 staff"]}),B.key==="unlimited"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-violet-200 rounded-lg text-xs font-medium text-violet-700",children:[a.jsx(Ft,{className:"w-3 h-3"}),"Unlimited staff"]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-emerald-50 border border-emerald-200 rounded-lg text-xs font-medium text-emerald-700",children:[a.jsx(Js,{className:"w-3 h-3"}),"No platform fees"]})]})]},B.key))}),a.jsx("p",{className:"text-xs text-slate-400 text-center mt-4",children:"Cancel anytime  14-day money-back guarantee"})]})})}function x9({currentCount:n,limit:e,onUpgradeClick:t}){const i=n>=e,o=n>=e-1&&n<e;return!i&&!o?null:a.jsxs("div",{className:`rounded-xl p-4 flex items-center justify-between gap-4 mb-4 ${i?"bg-amber-50 border border-amber-200":"bg-blue-50 border border-blue-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${i?"bg-amber-100":"bg-blue-100"}`,children:a.jsx(Ft,{className:`w-5 h-5 ${i?"text-amber-600":"text-blue-600"}`})}),a.jsxs("div",{children:[a.jsx("p",{className:`font-semibold text-sm ${i?"text-amber-900":"text-blue-900"}`,children:i?"Staff limit reached":"Almost at staff limit"}),a.jsxs("p",{className:"text-xs text-slate-600",children:["You have ",n," of ",e," staff member",e!==1?"s":"",".",i?" Upgrade to add more.":" Upgrade before you need more."]})]})]}),a.jsxs("button",{onClick:t,className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-semibold text-sm transition-all shadow-md flex-shrink-0 ${i?"bg-amber-500 hover:bg-amber-600 text-white shadow-amber-500/20":"bg-blue-500 hover:bg-blue-600 text-white shadow-blue-500/20"}`,children:[a.jsx(ec,{className:"w-4 h-4"}),"Upgrade"]})]})}const g9=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}],b9=5*1024*1024,y9=["image/jpeg","image/png","image/webp"];function v1(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return t===0?`${o}${i}`:`${o}:${t.toString().padStart(2,"0")}${i}`}function v9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState([]),[c,d]=j.useState(!1),[m,x]=j.useState(null),[g,b]=j.useState(null),[w,_]=j.useState(null),[R,B]=j.useState({name:"",role:""}),[V,U]=j.useState(!1),[F,Q]=j.useState(!1),[H,re]=j.useState("staff"),[he,W]=j.useState([]),[T,E]=j.useState(null),[S,I]=j.useState(null),k=uS(e),O=u9(e,i.length),[C,$]=j.useState(null),[L,P]=j.useState(""),[K,le]=j.useState(!1),[Ee,ye]=j.useState(!1),[z,Z]=j.useState(""),[ce,ge]=j.useState(null),[de,Ce]=j.useState(null),[Fe,Rt]=j.useState(null),it=j.useRef(null);j.useEffect(()=>{if(!n)return;const xe=ss(Xe(pe,"shops",n,"staff"),Le=>{const De=Le.docs.map(Ge=>({id:Ge.id,...Ge.data()})).filter(Ge=>Ge.active!==!1).sort((Ge,He)=>(Ge.name||"").localeCompare(He.name||""));o(De)}),qe=ss(Xe(pe,"shops",n,"schedulePresets"),Le=>{const De=Le.docs.map(Ge=>({id:Ge.id,...Ge.data()})).sort((Ge,He)=>Ge.isDefault&&!He.isDefault?-1:!Ge.isDefault&&He.isDefault?1:(Ge.name||"").localeCompare(He.name||""));W(De)});return()=>{xe(),qe()}},[n]);const Bt=async(xe,qe)=>{if(qe.days)try{const Le={},De=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];for(const Ge of De){const He=qe.days[Ge];if(He){const J=He.breaks||(He.break?[He.break]:[]);Le[Ge]={enabled:!!He.enabled,start:He.start||"09:00",end:He.end||"17:00",breaks:J,break:J.length>0?J[0]:null}}else Le[Ge]={enabled:!1,start:"09:00",end:"17:00",breaks:[],break:null}}await Ye(Oe(pe,"shops",n,"staff",xe),{weeklyHours:Le}),E(null),I({staffId:xe,presetName:qe.name}),setTimeout(()=>I(null),2500)}catch(Le){console.error("Error applying preset:",Le)}},ne=()=>{B({name:"",role:""}),d(!1),x(null)},je=async xe=>{xe.preventDefault(),U(!0);const qe={name:R.name.trim(),role:R.role.trim(),active:!0};try{m?await Ye(Oe(pe,"shops",n,"staff",m),qe):await Sa(Xe(pe,"shops",n,"staff"),{...qe,email:"",bio:"",portfolio:[],createdAt:kr()}),ne()}catch(Le){console.error("Error saving staff member:",Le)}finally{U(!1)}},Se=xe=>{B({name:xe.name,role:xe.role||""}),x(xe.id),d(!0)},$e=async xe=>{try{await Ye(Oe(pe,"shops",n,"staff",xe),{active:!1})}catch(qe){console.error("Error deleting staff member:",qe)}},Ze=xe=>{$(xe.id),P(xe.bio||"")},Et=async xe=>{le(!0);try{await Ye(Oe(pe,"shops",n,"staff",xe),{bio:L.trim()}),$(null),P("")}catch(qe){console.error("Error saving bio:",qe)}finally{le(!1)}},Bs=xe=>{ge(xe),Z(""),Ce(null),setTimeout(()=>{it.current&&(it.current.value="",it.current.click())},50)},Mt=xe=>{const qe=xe.target.files?.[0];if(qe){if(!y9.includes(qe.type)){alert("Please select a JPG, PNG, or WebP image.");return}if(qe.size>b9){alert("File size must be under 5MB.");return}Ce(qe)}},xt=async xe=>{if(de){ye(!0);try{const qe=Date.now(),Le=de.name.split(".").pop(),De=`${qe}.${Le}`,Ge=`shops/${n}/staff/${xe}/portfolio/${De}`,He=cx(ux,Ge);await O2(He,de);const J=await P2(He),We=i.find(tt=>tt.id===xe)?.portfolio||[];await Ye(Oe(pe,"shops",n,"staff",xe),{portfolio:[...We,{url:J,storagePath:Ge,caption:z.trim(),uploadedAt:new Date().toISOString()}]}),ge(null),Z(""),Ce(null)}catch(qe){console.error("Error uploading photo:",qe),alert("Upload failed. Please try again.")}finally{ye(!1)}}},Ie=async(xe,qe)=>{const Le=i.find(Ge=>Ge.id===xe);if(!Le)return;const De=Le.portfolio[qe];if(De){Rt(`${xe}-${qe}`);try{if(De.storagePath)try{const He=cx(ux,De.storagePath);await nD(He)}catch(He){console.warn("Storage delete warning:",He)}const Ge=Le.portfolio.filter((He,J)=>J!==qe);await Ye(Oe(pe,"shops",n,"staff",xe),{portfolio:Ge})}catch(Ge){console.error("Error deleting photo:",Ge),alert("Failed to delete photo.")}finally{Rt(null)}}},Be=xe=>{if(!xe)return null;const qe=g9.filter(Le=>xe[Le.key]?.enabled);return qe.length===0?null:qe.map(Le=>{const De=xe[Le.key],Ge=De.breaks||(De.break?[De.break]:[]),He=Ge.length>0?` ${Ge.length>1?Ge.length:""}`:"";return`${Le.short} ${v1(De.start)}${v1(De.end)}${He}`})};return a.jsxs("div",{children:[a.jsx("input",{ref:it,type:"file",accept:".jpg,.jpeg,.png,.webp",className:"hidden",onChange:Mt}),a.jsxs("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl mb-6 w-fit",children:[a.jsxs("button",{onClick:()=>re("staff"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${H==="staff"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(Ft,{className:"w-4 h-4"}),"Staff Members"]}),a.jsxs("button",{onClick:()=>re("presets"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${H==="presets"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(Ct,{className:"w-4 h-4"}),"Schedule Presets"]})]}),H==="presets"&&a.jsx(o9,{shopId:n}),H==="staff"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Staff"}),a.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Manage your team  assign availability and bookings per staff member"})]}),!c&&(O?a.jsxs("button",{onClick:()=>{ne(),d(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(tr,{className:"w-4 h-4"}),"Add Staff"]}):a.jsxs("button",{onClick:()=>Q(!0),className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white rounded-xl font-semibold shadow-lg shadow-amber-500/30 hover:shadow-xl hover:shadow-amber-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(Fo,{className:"w-4 h-4"}),"Upgrade to Add More"]}))]}),a.jsx(x9,{currentCount:i.length,limit:k,onUpgradeClick:()=>Q(!0)}),a.jsx(p9,{isOpen:F,onClose:()=>Q(!1),shopId:n,slug:t,currentTier:e?.subscriptionTier||"free",title:"Add More Staff Members",description:`Your ${e?.subscriptionTier||"Free"} plan allows ${k} staff member${k!==1?"s":""}. Upgrade to add more.`}),c&&a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:m?"Edit Staff Member":"New Staff Member"}),a.jsxs("form",{onSubmit:je,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Name *"}),a.jsx("input",{type:"text",value:R.name,onChange:xe=>B({...R,name:xe.target.value}),required:!0,placeholder:"e.g. Jane Smith",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Role (optional)"}),a.jsx("input",{type:"text",value:R.role,onChange:xe=>B({...R,role:xe.target.value}),placeholder:"e.g. Senior Stylist",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:V,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(Js,{className:"w-4 h-4"}),V?"Saving":m?"Update Staff":"Add Staff"]}),a.jsxs("button",{type:"button",onClick:ne,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Ds,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),i.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"text-5xl mb-3",children:""}),a.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No staff members yet"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Add your team members to assign them availability and bookings"})]}):a.jsx("div",{className:"space-y-4",children:i.map(xe=>{const qe=Be(xe.weeklyHours),Le=xe.portfolio||[];return a.jsxs("div",{children:[a.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:xe.name}),xe.role&&a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:xe.role})]}),a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Ft,{className:"w-5 h-5 text-blue-600"})})]}),a.jsx("div",{className:"mb-3",children:C===xe.id?a.jsxs("div",{className:"space-y-2",children:[a.jsx("textarea",{value:L,onChange:De=>P(De.target.value),placeholder:"Write a short bio  specialties, experience, personality",rows:3,maxLength:500,className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none transition-all"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>Et(xe.id),disabled:K,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[K?a.jsx(ra,{className:"w-3 h-3 animate-spin"}):a.jsx(Js,{className:"w-3 h-3"}),"Save Bio"]}),a.jsx("button",{onClick:()=>{$(null),P("")},className:"px-3 py-1.5 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"}),a.jsxs("span",{className:"text-xs text-slate-400 ml-auto",children:[L.length,"/500"]})]})]}):a.jsx("div",{onClick:()=>Ze(xe),className:"cursor-pointer group",children:xe.bio?a.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed group-hover:text-slate-800 transition-colors",children:[xe.bio,a.jsx("span",{className:"ml-1.5 text-xs text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",children:"edit"})]}):a.jsx("p",{className:"text-sm text-slate-400 italic group-hover:text-blue-500 transition-colors",children:"+ Add a bio"})})}),qe?a.jsx("div",{className:"mb-3 flex flex-wrap gap-1.5",children:qe.map((De,Ge)=>a.jsx("span",{className:"inline-block px-2 py-0.5 bg-green-50 text-green-700 border border-green-200 rounded text-xs font-medium",children:De},Ge))}):a.jsx("p",{className:"text-xs text-slate-400 mb-3 italic",children:"No weekly hours set"}),Le.length>0&&w!==xe.id&&a.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[a.jsx("div",{className:"flex -space-x-1",children:Le.slice(0,4).map((De,Ge)=>a.jsx("img",{src:De.url,alt:De.caption||"Portfolio",className:"w-10 h-10 rounded-lg object-cover border-2 border-white shadow-sm"},Ge))}),a.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[Le.length," photo",Le.length!==1?"s":""]})]}),S?.staffId===xe.id&&a.jsxs("div",{className:"mb-3 px-3 py-2 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-xs text-green-700 font-medium animate-fade-in",children:[a.jsx(Js,{className:"w-3.5 h-3.5"}),'Applied "',S.presetName,'" schedule']}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs("button",{onClick:()=>b(g===xe.id?null:xe.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${g===xe.id?"bg-blue-100 text-blue-700 border-blue-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:[a.jsx(os,{className:"w-3.5 h-3.5"}),"Set Hours"]}),he.length>0&&a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>E(T===xe.id?null:xe.id),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${T===xe.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-violet-50 hover:bg-violet-100 text-violet-700 border-violet-200"}`,children:[a.jsx(Ct,{className:"w-3.5 h-3.5"}),"Apply Preset",a.jsx(Ou,{className:`w-3 h-3 transition-transform ${T===xe.id?"rotate-180":""}`})]}),T===xe.id&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>E(null)}),a.jsx("div",{className:"absolute top-full right-0 mt-1 w-56 bg-white border border-slate-200 rounded-xl shadow-xl z-20 py-2 max-h-64 overflow-y-auto",children:he.map(De=>a.jsxs("button",{onClick:()=>Bt(xe.id,De),className:"w-full px-4 py-2.5 text-left hover:bg-blue-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-900 text-sm",children:De.name}),De.isDefault&&a.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded",children:"DEFAULT"})]}),De.description&&a.jsx("p",{className:"text-xs text-slate-500 mt-0.5 line-clamp-1",children:De.description})]},De.id))})]})]}),a.jsx("button",{onClick:()=>_(w===xe.id?null:xe.id),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${w===xe.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:a.jsx(ID,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>Se(xe),className:"flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:a.jsx(Dg,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>$e(xe.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:a.jsx(ya,{className:"w-3.5 h-3.5"})})]})]}),g===xe.id&&a.jsx("div",{className:"mt-2",children:a.jsx(i9,{shopId:n,staffId:xe.id,staffName:xe.name,weeklyHours:xe.weeklyHours,onClose:()=>b(null)})}),w===xe.id&&a.jsxs("div",{className:"mt-2 bg-white border-2 border-violet-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[a.jsx(lm,{className:"w-4 h-4 text-violet-600"}),"Portfolio  ",xe.name]}),a.jsxs("button",{onClick:()=>Bs(xe.id),disabled:Ee,className:"flex items-center gap-1.5 px-3 py-1.5 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[a.jsx(tr,{className:"w-3 h-3"}),"Add Photo"]})]}),ce===xe.id&&de&&a.jsxs("div",{className:"mb-4 p-3 bg-violet-50 border border-violet-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-16 h-16 rounded-lg bg-slate-200 overflow-hidden flex-shrink-0",children:a.jsx("img",{src:URL.createObjectURL(de),alt:"Preview",className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-xs text-slate-600 font-medium mb-1 truncate",children:de.name}),a.jsxs("p",{className:"text-xs text-slate-400",children:[(de.size/1024/1024).toFixed(1)," MB"]})]})]}),a.jsx("input",{type:"text",value:z,onChange:De=>Z(De.target.value),placeholder:"Add a caption (optional)",maxLength:200,className:"w-full px-3 py-2 text-sm border border-violet-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-400 focus:border-transparent mb-2"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>xt(xe.id),disabled:Ee,className:"flex items-center gap-1.5 px-4 py-2 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:Ee?a.jsxs(a.Fragment,{children:[a.jsx(ra,{className:"w-3 h-3 animate-spin"}),"Uploading"]}):a.jsxs(a.Fragment,{children:[a.jsx(Js,{className:"w-3 h-3"}),"Upload"]})}),a.jsx("button",{onClick:()=>{ge(null),Ce(null),Z("")},className:"px-3 py-2 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}),Le.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-3xl mb-2",children:""}),a.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet. Add some to showcase work!"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:Le.map((De,Ge)=>a.jsxs("div",{className:"group relative bg-slate-50 rounded-lg overflow-hidden border border-slate-200 shadow-sm",children:[a.jsx("div",{className:"aspect-square",children:a.jsx("img",{src:De.url,alt:De.caption||"Portfolio photo",className:"w-full h-full object-cover"})}),De.caption&&a.jsx("div",{className:"px-2 py-1.5",children:a.jsx("p",{className:"text-xs text-slate-600 truncate",children:De.caption})}),a.jsx("button",{onClick:()=>Ie(xe.id,Ge),disabled:Fe===`${xe.id}-${Ge}`,className:"absolute top-1.5 right-1.5 w-7 h-7 bg-red-500/90 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-md disabled:opacity-50",title:"Delete photo",children:Fe===`${xe.id}-${Ge}`?a.jsx(ra,{className:"w-3.5 h-3.5 animate-spin"}):a.jsx(ya,{className:"w-3.5 h-3.5"})})]},Ge))})]})]},xe.id)})})]})]})}function dl(n){return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}function w9(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function hl(n){return`$${Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function w1(n){return new Date(n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}function N1(n){return new Date(n+"T12:00:00").toLocaleDateString("en-US",{weekday:"short"})}function R0(n,e){return e===0&&n===0?0:e===0?100:(n-e)/e*100}function N9({bookings:n}){const[e,t]=j.useState(null),[i,o]=j.useState(null),c=j.useMemo(()=>n.filter($=>$.status==="confirmed"||$.status==="pending"||!$.status),[n]),d=j.useMemo(()=>{const $=new Date;return $.setHours(0,0,0,0),$},[]),m=j.useMemo(()=>dl(d),[d]),x=j.useMemo(()=>w9(d),[d]),g=j.useMemo(()=>{const $=new Date(x);return $.setDate($.getDate()+6),$},[x]),b=j.useMemo(()=>{const $=new Date(x);return $.setDate($.getDate()-7),$},[x]),w=j.useMemo(()=>{const $=new Date(b);return $.setDate($.getDate()+6),$},[b]),_=j.useMemo(()=>new Date(d.getFullYear(),d.getMonth(),1),[d]),R=j.useMemo(()=>new Date(d.getFullYear(),d.getMonth()-1,1),[d]),B=j.useMemo(()=>{const $=new Date(_);return $.setDate($.getDate()-1),$},[_]),V=j.useMemo(()=>{const $=new Date(d);return $.setDate($.getDate()-1),dl($)},[d]),U=j.useMemo(()=>{const $=ce=>ce.reduce((ge,de)=>ge+(Number(de.servicePrice)||0),0),L=(ce,ge,de)=>ce.date>=dl(ge)&&ce.date<=dl(de),P=$(c.filter(ce=>ce.date===m)),K=$(c.filter(ce=>ce.date===V)),le=$(c.filter(ce=>L(ce,x,g))),Ee=$(c.filter(ce=>L(ce,b,w))),ye=$(c.filter(ce=>L(ce,_,d))),z=$(c.filter(ce=>L(ce,R,B))),Z=$(c);return{today:P,todayChange:R0(P,K),week:le,weekChange:R0(le,Ee),month:ye,monthChange:R0(ye,z),allTime:Z}},[c,m,V,x,g,b,w,_,B,d]),F=j.useMemo(()=>{const $=[];for(let L=13;L>=0;L--){const P=new Date(d);P.setDate(P.getDate()-L),$.push(dl(P))}return $},[d]),Q=j.useMemo(()=>{const $={};return F.forEach(L=>{$[L]=0}),c.forEach(L=>{$[L.date]!==void 0&&($[L.date]+=Number(L.servicePrice)||0)}),F.map(L=>({date:L,value:$[L]}))},[c,F]),H=j.useMemo(()=>Math.max(...Q.map($=>$.value),1),[Q]),re=j.useMemo(()=>{const $={},L={};return F.forEach(P=>{$[P]=0,L[P]=0}),n.forEach(P=>{$[P.date]!==void 0&&(P.status==="cancelled"||P.status==="rejected"?L[P.date]++:$[P.date]++)}),F.map(P=>({date:P,confirmed:$[P],cancelled:L[P],total:$[P]+L[P]}))},[n,F]),he=j.useMemo(()=>Math.max(...re.map($=>$.total),1),[re]),W=j.useMemo(()=>{const $=n.length;if($===0)return 100;const L=n.filter(P=>P.status==="cancelled"||P.status==="rejected").length;return Math.round(($-L)/$*100)},[n]),T=j.useMemo(()=>{const $=Array.from({length:7},()=>Array(24).fill(0));c.forEach(P=>{if(!P.date||!P.time)return;const le=new Date(P.date+"T12:00:00").getDay(),Ee=parseInt(P.time.split(":")[0],10);!isNaN(le)&&!isNaN(Ee)&&$[le][Ee]++});let L=0;return $.forEach(P=>P.forEach(K=>{K>L&&(L=K)})),{grid:$,max:L}},[c]),E=j.useMemo(()=>{const $={};return c.forEach(L=>{const P=L.serviceName||"Unknown";$[P]||($[P]={name:P,count:0,revenue:0}),$[P].count++,$[P].revenue+=Number(L.servicePrice)||0}),Object.values($).map(L=>({...L,avgRevenue:L.count>0?L.revenue/L.count:0})).sort((L,P)=>P.revenue-L.revenue)},[c]),S=j.useMemo(()=>{const $={};return c.forEach(L=>{const P=L.staffName||"Unassigned";$[P]||($[P]={name:P,count:0,revenue:0,clients:new Set}),$[P].count++,$[P].revenue+=Number(L.servicePrice)||0,L.clientEmail&&$[P].clients.add(L.clientEmail.toLowerCase())}),Object.values($).map(L=>({...L,clientCount:L.clients.size})).sort((L,P)=>P.revenue-L.revenue)},[c]),I=j.useMemo(()=>{const $=c.map(de=>de.clientEmail?.toLowerCase()).filter(Boolean),L=new Set($).size,P=c.filter(de=>de.date>=dl(_)&&de.date<=m),K=new Set(P.map(de=>de.clientEmail?.toLowerCase()).filter(Boolean)),le=c.filter(de=>de.date<dl(_)),Ee=new Set(le.map(de=>de.clientEmail?.toLowerCase()).filter(Boolean));let ye=0,z=0;K.forEach(de=>{Ee.has(de)?z++:ye++});const Z={};c.forEach(de=>{const Ce=de.clientEmail?.toLowerCase();Ce&&(Z[Ce]||(Z[Ce]={email:Ce,name:de.clientName||Ce,count:0}),Z[Ce].count++,de.clientName&&(Z[Ce].name=de.clientName))});const ce=Object.values(Z).sort((de,Ce)=>Ce.count-de.count).slice(0,10),ge=L>0?c.length/L:0;return{uniqueClients:L,newThisMonth:ye,returningThisMonth:z,topClients:ce,avgBookingsPerClient:ge}},[c,_,m]),k=({value:$,suffix:L="vs prev"})=>{if($===0)return a.jsxs("span",{className:"flex items-center gap-0.5 text-xs font-medium text-slate-400",children:[a.jsx(NM,{className:"w-3 h-3"})," 0% ",L]});const P=$>0;return a.jsxs("span",{className:`flex items-center gap-0.5 text-xs font-semibold ${P?"text-emerald-600":"text-red-500"}`,children:[P?a.jsx(V2,{className:"w-3 h-3"}):a.jsx(xD,{className:"w-3 h-3"}),P?"+":"",Math.round($),"% ",L]})},O=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],C=Array.from({length:15},($,L)=>L+7);return a.jsxs("div",{className:"animate-fade-in space-y-6",children:[a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Today's Revenue",value:U.today,change:U.todayChange,suffix:"vs yesterday",icon:Mo,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:U.week,change:U.weekChange,suffix:"vs last week",icon:$o,color:"bg-violet-100 text-violet-600"},{label:"This Month",value:U.month,change:U.monthChange,suffix:"vs last month",icon:Ct,color:"bg-emerald-100 text-emerald-600"},{label:"All-time Revenue",value:U.allTime,change:null,icon:Cg,color:"bg-amber-100 text-amber-600"}].map($=>{const L=$.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${$.color} rounded-xl flex items-center justify-center`,children:a.jsx(L,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:hl($.value)}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5 mb-1",children:$.label}),$.change!==null&&a.jsx(k,{value:$.change,suffix:$.suffix})]},$.label)})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Revenue"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Last 14 days  confirmed & pending bookings"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("div",{className:"flex items-end gap-0",children:[a.jsxs("div",{className:"flex flex-col justify-between h-48 pr-2 text-right flex-shrink-0 w-16",children:[a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:hl(H)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:hl(H/2)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"$0"})]}),a.jsx("div",{className:"flex-1 flex items-end gap-1 h-48 border-b border-l border-slate-200 pl-1 pb-0 relative",children:Q.map(($,L)=>{const P=H>0?$.value/H*100:0,K=e===L;return a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative group",onMouseEnter:()=>t(L),onMouseLeave:()=>t(null),onTouchStart:()=>t(L),children:[K&&a.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[hl($.value),a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),a.jsx("div",{className:"w-full rounded-t-md transition-all duration-200 cursor-pointer",style:{height:`${Math.max(P,$.value>0?2:0)}%`,background:K?"linear-gradient(to top, #2563eb, #60a5fa)":"linear-gradient(to top, #3b82f6, #93c5fd)",minHeight:$.value>0?"4px":"0px"}})]},$.date)})})]}),a.jsx("div",{className:"flex ml-16 pl-1",children:Q.map($=>a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:N1($.date)}),a.jsx("div",{className:"text-[9px] text-slate-400",children:w1($.date)})]},$.date))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-5",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Booking Trends"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Last 14 days breakdown"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-blue-500"})," Confirmed"]}),a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-red-400"})," Cancelled"]}),a.jsxs("span",{className:"px-2.5 py-1 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-lg font-semibold",children:[W,"% completion"]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("div",{className:"flex items-end gap-0",children:[a.jsxs("div",{className:"flex flex-col justify-between h-40 pr-2 text-right flex-shrink-0 w-16",children:[a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:he}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:Math.round(he/2)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"0"})]}),a.jsx("div",{className:"flex-1 flex items-end gap-1 h-40 border-b border-l border-slate-200 pl-1 relative",children:re.map(($,L)=>{const P=he>0?$.confirmed/he*100:0,K=he>0?$.cancelled/he*100:0,le=i===L;return a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative",onMouseEnter:()=>o(L),onMouseLeave:()=>o(null),onTouchStart:()=>o(L),children:[le&&a.jsxs("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[$.confirmed," confirmed, ",$.cancelled," cancelled",a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),a.jsxs("div",{className:"w-full flex flex-col items-stretch",children:[$.cancelled>0&&a.jsx("div",{className:"w-full rounded-t-md bg-red-400 transition-all duration-200",style:{height:`${Math.max(K,2)}%`}}),$.confirmed>0&&a.jsx("div",{className:`w-full bg-blue-500 transition-all duration-200 ${$.cancelled===0?"rounded-t-md":""}`,style:{height:`${Math.max(P,2)}%`}})]})]},$.date)})})]}),a.jsx("div",{className:"flex ml-16 pl-1",children:re.map($=>a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:N1($.date)}),a.jsx("div",{className:"text-[9px] text-slate-400",children:w1($.date)})]},$.date))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Busiest Times"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Booking density by day of week and hour"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"w-12"}),C.map($=>a.jsxs("th",{className:"text-[10px] text-slate-400 font-medium pb-2 text-center px-0.5",children:[$%12||12,$>=12?"p":"a"]},$))]})}),a.jsx("tbody",{children:[1,2,3,4,5,6,0].map($=>a.jsxs("tr",{children:[a.jsx("td",{className:"text-[11px] text-slate-500 font-semibold pr-2 py-0.5 text-right",children:O[$]}),C.map(L=>{const P=T.grid[$][L],K=T.max||1,le=P/K;let Ee="bg-slate-50";return P>0&&(le<=.2?Ee="bg-blue-100":le<=.4?Ee="bg-blue-200":le<=.6?Ee="bg-blue-300":le<=.8?Ee="bg-blue-500 text-white":Ee="bg-blue-700 text-white"),a.jsx("td",{className:"px-0.5 py-0.5",children:a.jsx("div",{className:`w-full aspect-square rounded-sm ${Ee} flex items-center justify-center text-[9px] font-bold transition-all hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 cursor-default`,title:`${O[$]} ${L}:00  ${P} booking${P!==1?"s":""}`,children:P>0?P:""})},L)})]},$))})]}),a.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-3",children:[a.jsx("span",{className:"text-[10px] text-slate-400",children:"Less"}),["bg-slate-50","bg-blue-100","bg-blue-200","bg-blue-300","bg-blue-500","bg-blue-700"].map(($,L)=>a.jsx("div",{className:`w-4 h-4 rounded-sm ${$} border border-slate-200`},L)),a.jsx("span",{className:"text-[10px] text-slate-400",children:"More"})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Top Services"}),a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Ranked by revenue from confirmed & pending bookings"}),E.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Tn,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No service data yet"})]}):a.jsx("div",{className:"space-y-2",children:E.map(($,L)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm flex-shrink-0",children:L+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:$.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:[$.count," booking",$.count!==1?"s":"","  avg ",hl($.avgRevenue)]})]}),a.jsx("div",{className:"text-sm font-bold text-blue-600 flex-shrink-0",children:hl($.revenue)})]},$.name))})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Staff Performance"}),a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Bookings, revenue & clients per staff member"}),S.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Ft,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No staff data yet"})]}):a.jsx("div",{className:"space-y-2",children:S.map(($,L)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center text-violet-600 font-bold text-sm flex-shrink-0",children:L+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:$.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:[$.count," booking",$.count!==1?"s":"","  ",$.clientCount," client",$.clientCount!==1?"s":""]})]}),a.jsx("div",{className:"text-sm font-bold text-violet-600 flex-shrink-0",children:hl($.revenue)})]},$.name))})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Insights"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Understanding your client base"}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[a.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:I.uniqueClients}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Unique Clients"})]}),a.jsxs("div",{className:"bg-emerald-50 rounded-xl border border-emerald-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-emerald-700",children:I.newThisMonth}),a.jsx("div",{className:"text-xs font-medium text-emerald-600 mt-0.5",children:"New This Month"})]}),a.jsxs("div",{className:"bg-blue-50 rounded-xl border border-blue-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-blue-700",children:I.returningThisMonth}),a.jsx("div",{className:"text-xs font-medium text-blue-600 mt-0.5",children:"Returning This Month"})]}),a.jsxs("div",{className:"bg-violet-50 rounded-xl border border-violet-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-violet-700",children:I.avgBookingsPerClient.toFixed(1)}),a.jsx("div",{className:"text-xs font-medium text-violet-600 mt-0.5",children:"Avg Bookings / Client"})]})]}),a.jsx("h4",{className:"text-sm font-bold text-slate-700 mb-3",children:"Top Clients by Frequency"}),I.topClients.length===0?a.jsxs("div",{className:"text-center py-6",children:[a.jsx(Sl,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No client data yet"})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:I.topClients.map(($,L)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center text-amber-700 font-bold text-xs flex-shrink-0",children:L+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:$.name}),a.jsx("div",{className:"text-xs text-slate-400 truncate",children:$.email})]}),a.jsxs("div",{className:"flex-shrink-0 px-2.5 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-bold",children:[$.count," visit",$.count!==1?"s":""]})]},$.email))})]})]})}function dS({waitingAhead:n=[],inProgress:e=[],staffCount:t=1,upcomingBookings:i=[],defaultDuration:o=30}){const c=Math.max(t,1),d=Date.now(),m=e.map(b=>{const w=b.startedAt?.toDate?.()||(b.startedAt?new Date(b.startedAt):null);if(!w)return 0;const _=(d-w.getTime())/6e4,R=b.estimatedDuration||o;return Math.max(0,R-_)});m.sort((b,w)=>b-w);const x=[];for(let b=0;b<c;b++)x.push(m[b]||0);x.sort((b,w)=>b-w);const g=n.map(b=>b.estimatedDuration||o);for(const b of g)x[0]+=b,x.sort((w,_)=>w-_);return Math.round(x[0])}function hS({waitingQueue:n=[],inProgress:e=[],staffCount:t=1,upcomingBookings:i=[],defaultDuration:o=30}){const c=new Map;for(let d=0;d<n.length;d++){const m=n.slice(0,d),x=dS({waitingAhead:m,inProgress:e,staffCount:t,upcomingBookings:i,defaultDuration:o});c.set(n[d].id,x)}return c}function j9(n=[],e=3){const t=new Date,i=new Date(t.getTime()+e*60*60*1e3),o=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return n.filter(c=>{if(c.status==="cancelled"||c.status==="rejected"||c.date!==o)return!1;const d=new Date(`${c.date}T${c.time}`);return d>=t&&d<=i}).sort((c,d)=>`${c.time}`.localeCompare(`${d.time}`))}function _9(n){if(!n)return"0m";const e=n?.toDate?.()||new Date(n),t=Math.floor((Date.now()-e.getTime())/6e4);if(t<1)return"<1m";if(t<60)return`${t}m`;const i=Math.floor(t/60),o=t%60;return o>0?`${i}h ${o}m`:`${i}h`}function S9(n){if(n==null)return"";if(n<1)return"Next up";if(n<60)return`~${n}m`;const e=Math.floor(n/60),t=n%60;return t>0?`~${e}h ${t}m`:`~${e}h`}function E9({shopId:n,services:e,staff:t,bookings:i}){const[o,c]=j.useState([]),[d,m]=j.useState(!1),[x,g]=j.useState(!1),[b,w]=j.useState(!1),[_,R]=j.useState({clientName:"",serviceId:"",staffId:"",estimatedDuration:30});j.useEffect(()=>{if(!n)return;const L=ss(Xe(pe,"shops",n,"walkins"),P=>{const K=P.docs.map(le=>({id:le.id,...le.data()}));c(K)});return()=>L()},[n]);const B=j.useMemo(()=>o.filter(L=>L.status==="waiting").sort((L,P)=>(L.position||0)-(P.position||0)),[o]),V=j.useMemo(()=>o.filter(L=>L.status==="in-progress").sort((L,P)=>{const K=L.startedAt?.toDate?.()?.getTime()||0,le=P.startedAt?.toDate?.()?.getTime()||0;return K-le}),[o]),U=j.useMemo(()=>{const L=new Date;return L.setHours(0,0,0,0),L},[]),F=j.useMemo(()=>o.filter(L=>{if(L.status!=="completed"&&L.status!=="no-show")return!1;const P=L.completedAt?.toDate?.()||(L.completedAt?new Date(L.completedAt):null);return P?P>=U:!1}).sort((L,P)=>{const K=L.completedAt?.toDate?.()?.getTime()||0;return(P.completedAt?.toDate?.()?.getTime()||0)-K}),[o,U]),Q=j.useMemo(()=>Math.max(t.filter(L=>L.active!==!1).length,1),[t]),H=j.useMemo(()=>j9(i,3),[i]),re=j.useMemo(()=>hS({waitingQueue:B,inProgress:V,staffCount:Q,upcomingBookings:H,defaultDuration:30}),[B,V,Q,H]),he=j.useMemo(()=>{const L=F.filter(K=>K.status==="completed"&&K.joinedAt&&K.startedAt).map(K=>{const le=K.joinedAt?.toDate?.()||new Date(K.joinedAt),Ee=K.startedAt?.toDate?.()||new Date(K.startedAt);return Math.floor((Ee.getTime()-le.getTime())/6e4)}).filter(K=>K>=0),P=L.length>0?Math.round(L.reduce((K,le)=>K+le,0)/L.length):0;return{waiting:B.length,avgWait:P,completedToday:F.filter(K=>K.status==="completed").length}},[B,F]),W=L=>{const P=e.find(K=>K.id===L);R(K=>({...K,serviceId:L,estimatedDuration:P?.duration||30}))},T=()=>B.length===0?1:Math.max(...B.map(L=>L.position||0))+1,E=j.useMemo(()=>o.filter(L=>{const P=L.joinedAt?.toDate?.()||(L.joinedAt?new Date(L.joinedAt):null);return P&&P>=U}).length,[o,U]),S=async L=>{L.preventDefault(),w(!0);const P=e.find(ye=>ye.id===_.serviceId),K=t.find(ye=>ye.id===_.staffId),le=T(),Ee=_.clientName.trim()||`Walk-in #${E+1}`;try{await Sa(Xe(pe,"shops",n,"walkins"),{clientName:Ee,serviceId:_.serviceId||null,serviceName:P?.name||null,staffId:_.staffId||null,staffName:K?.name||null,estimatedDuration:parseInt(_.estimatedDuration)||30,status:"waiting",position:le,joinedAt:zt.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),R({clientName:"",serviceId:"",staffId:"",estimatedDuration:30}),m(!1)}catch(ye){console.error("Error adding walk-in:",ye)}finally{w(!1)}},I=async L=>{try{await Ye(Oe(pe,"shops",n,"walkins",L),{status:"in-progress",startedAt:zt.now()});const P=B.filter(K=>K.id!==L).sort((K,le)=>(K.position||0)-(le.position||0));for(let K=0;K<P.length;K++)await Ye(Oe(pe,"shops",n,"walkins",P[K].id),{position:K+1})}catch(P){console.error("Error starting service:",P)}},k=async L=>{try{await Ye(Oe(pe,"shops",n,"walkins",L),{status:"completed",completedAt:zt.now()})}catch(P){console.error("Error completing service:",P)}},O=async L=>{try{await Ye(Oe(pe,"shops",n,"walkins",L),{status:"no-show",completedAt:zt.now()});const P=B.filter(K=>K.id!==L).sort((K,le)=>(K.position||0)-(le.position||0));for(let K=0;K<P.length;K++)await Ye(Oe(pe,"shops",n,"walkins",P[K].id),{position:K+1})}catch(P){console.error("Error marking no-show:",P)}},C=async L=>{const P=B.findIndex(Ee=>Ee.id===L);if(P<=0)return;const K=B[P-1],le=B[P];try{await Ye(Oe(pe,"shops",n,"walkins",le.id),{position:K.position}),await Ye(Oe(pe,"shops",n,"walkins",K.id),{position:le.position})}catch(Ee){console.error("Error reordering:",Ee)}},$=async L=>{const P=B.findIndex(Ee=>Ee.id===L);if(P<0||P>=B.length-1)return;const K=B[P+1],le=B[P];try{await Ye(Oe(pe,"shops",n,"walkins",le.id),{position:K.position}),await Ye(Oe(pe,"shops",n,"walkins",K.id),{position:le.position})}catch(Ee){console.error("Error reordering:",Ee)}};return a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[{label:"Currently Waiting",value:he.waiting,icon:Ft,color:"bg-blue-100 text-blue-600"},{label:"Avg Wait",value:he.avgWait>0?`${he.avgWait}m`:"",icon:Y2,color:"bg-amber-100 text-amber-600"},{label:"Completed Today",value:he.completedToday,icon:$o,color:"bg-emerald-100 text-emerald-600"}].map(L=>{const P=L.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${L.color} rounded-xl flex items-center justify-center`,children:a.jsx(P,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:L.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:L.label})]},L.label)})}),H.length>0&&a.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ia,{className:"w-4 h-4 text-amber-600"}),a.jsx("span",{className:"text-sm font-bold text-amber-800",children:"Upcoming Online Bookings"})]}),a.jsx("div",{className:"space-y-1",children:H.slice(0,5).map(L=>{const[P,K]=(L.time||"").split(":"),le=parseInt(P),Ee=`${le%12||12}:${K} ${le>=12?"PM":"AM"}`;return a.jsxs("div",{className:"text-xs text-amber-700 flex items-center gap-2",children:[a.jsx(os,{className:"w-3 h-3"}),a.jsx("span",{className:"font-medium",children:Ee}),a.jsx("span",{children:""}),a.jsx("span",{children:L.clientName}),L.serviceName&&a.jsxs("span",{className:"text-amber-500",children:["(",L.serviceName,")"]}),L.staffName&&a.jsxs("span",{className:"text-violet-600",children:["with ",L.staffName]})]},L.id)})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Walk-in Queue"}),!d&&a.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[a.jsx(tr,{className:"w-4 h-4"}),"Add Walk-in"]})]}),d&&a.jsxs("form",{onSubmit:S,className:"mb-5 p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3",children:"New Walk-in"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Client Name"}),a.jsx("input",{type:"text",value:_.clientName,onChange:L=>R(P=>({...P,clientName:L.target.value})),placeholder:`Walk-in #${E+1}`,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Service"}),a.jsxs("select",{value:_.serviceId,onChange:L=>W(L.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"No service selected"}),e.map(L=>a.jsxs("option",{value:L.id,children:[L.name," (",L.duration,"min)"]},L.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Staff Preference"}),a.jsxs("select",{value:_.staffId,onChange:L=>R(P=>({...P,staffId:L.target.value})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"Next available"}),t.map(L=>a.jsx("option",{value:L.id,children:L.name},L.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Est. Duration (min)"}),a.jsx("select",{value:_.estimatedDuration,onChange:L=>R(P=>({...P,estimatedDuration:parseInt(L.target.value)})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[15,30,45,60,90,120].map(L=>a.jsx("option",{value:L,children:L<60?`${L} min`:`${L/60}h${L%60?` ${L%60}m`:""}`},L))})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{type:"submit",disabled:b,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[a.jsx(tr,{className:"w-4 h-4"}),b?"Adding":"Add to Queue"]}),a.jsx("button",{type:"button",onClick:()=>{m(!1),R({clientName:"",serviceId:"",staffId:"",estimatedDuration:30})},className:"px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Cancel"})]})]}),B.length===0&&V.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Ft,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No walk-ins in queue"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Add a walk-in client to start the queue."})]}):a.jsxs(a.Fragment,{children:[B.length>0&&a.jsxs("div",{className:"mb-5",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx(os,{className:"w-4 h-4 text-blue-500"}),"Waiting",a.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:B.length})]}),a.jsx("div",{className:"space-y-2",children:B.map((L,P)=>{const K=re.get(L.id);return a.jsxs("div",{className:"group flex items-center gap-3 border border-slate-200 rounded-xl p-3.5 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[a.jsx("button",{onClick:()=>C(L.id),disabled:P===0,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:a.jsx(dx,{className:"w-4 h-4"})}),a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center font-bold text-blue-700 text-sm",children:P+1}),a.jsx("button",{onClick:()=>$(L.id),disabled:P===B.length-1,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:a.jsx(Ou,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:L.clientName}),a.jsx("span",{className:"px-2 py-0.5 bg-blue-50 text-blue-600 border border-blue-200 text-[10px] font-bold rounded-md",children:"WAITING"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[L.serviceName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Tn,{className:"w-3 h-3 text-blue-400"}),L.serviceName]}),L.staffName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Sl,{className:"w-3 h-3 text-violet-400"}),L.staffName]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(os,{className:"w-3 h-3"}),L.estimatedDuration||30,"min"]})]})]}),a.jsxs("div",{className:"text-right mr-2",children:[a.jsx("div",{className:"text-sm font-bold text-amber-600",children:S9(K)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"est. wait"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs("button",{onClick:()=>I(L.id),className:"flex items-center gap-1 px-3 py-2 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 border border-emerald-200 rounded-lg text-xs font-semibold transition-all",title:"Start Service",children:[a.jsx(T0,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Start"})]}),a.jsxs("button",{onClick:()=>O(L.id),className:"flex items-center gap-1 px-3 py-2 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all",title:"No-show",children:[a.jsx(Ha,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"No-show"})]})]})]},L.id)})})]}),V.length>0&&a.jsxs("div",{className:"mb-5",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx(T0,{className:"w-4 h-4 text-emerald-500"}),"In Progress",a.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 border border-emerald-200 text-xs font-bold rounded-full",children:V.length})]}),a.jsx("div",{className:"space-y-2",children:V.map(L=>a.jsxs("div",{className:"flex items-center gap-3 border border-emerald-200 bg-emerald-50/50 rounded-xl p-3.5 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center",children:a.jsx(T0,{className:"w-4 h-4 text-emerald-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:L.clientName}),a.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 text-[10px] font-bold rounded-md",children:"IN PROGRESS"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[L.serviceName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Tn,{className:"w-3 h-3 text-blue-400"}),L.serviceName]}),L.staffName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Sl,{className:"w-3 h-3 text-violet-400"}),L.staffName]})]})]}),a.jsxs("div",{className:"text-right mr-2",children:[a.jsx("div",{className:"text-sm font-bold text-emerald-600",children:_9(L.startedAt)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"elapsed"})]}),a.jsxs("button",{onClick:()=>k(L.id),className:"flex items-center gap-1 px-3 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 rounded-lg text-xs font-semibold transition-all",title:"Complete",children:[a.jsx(Vs,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Complete"})]})]},L.id))})]})]})]}),F.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("button",{onClick:()=>g(!x),className:"w-full flex items-center justify-between",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[a.jsx(Vs,{className:"w-4 h-4 text-slate-400"}),"Completed Today",a.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-500 border border-slate-200 text-xs font-bold rounded-full",children:F.length})]}),a.jsx(ed,{className:`w-4 h-4 text-slate-400 transition-transform ${x?"rotate-90":""}`})]}),x&&a.jsx("div",{className:"mt-3 space-y-2",children:F.map(L=>a.jsxs("div",{className:"flex items-center gap-3 border border-slate-100 rounded-lg p-3 bg-slate-50/50",children:[a.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center bg-slate-100",children:L.status==="no-show"?a.jsx(Ha,{className:"w-3.5 h-3.5 text-red-400"}):a.jsx(Vs,{className:"w-3.5 h-3.5 text-emerald-400"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-700 text-sm truncate",children:L.clientName}),a.jsx("span",{className:`text-[10px] font-bold rounded-md px-1.5 py-0.5 border ${L.status==="no-show"?"bg-red-50 text-red-600 border-red-200":"bg-emerald-50 text-emerald-600 border-emerald-200"}`,children:L.status==="no-show"?"NO-SHOW":"COMPLETED"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[L.serviceName&&a.jsx("span",{children:L.serviceName}),L.staffName&&a.jsxs("span",{children:[" ",L.staffName]})]})]})]},L.id))})]})]})}function T9(n,e){const t=new Date(n+"T12:00:00"),i=e.getTime()-t.getTime();return Math.floor(i/864e5)}function Ih(n){return`$${Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function iu(n){return n?new Date(n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function A9(n,e,t){return n>90?"lost":n>t?"at-risk":n>e?"getting-cold":"active"}const Dh={active:{label:"Active",bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200",icon:Ig,iconColor:"text-emerald-500"},"getting-cold":{label:"Getting Cold",bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",icon:G2,iconColor:"text-amber-500"},"at-risk":{label:"At Risk",bg:"bg-orange-50",text:"text-orange-700",border:"border-orange-200",icon:ia,iconColor:"text-orange-500"},lost:{label:"Lost",bg:"bg-red-50",text:"text-red-700",border:"border-red-200",icon:eM,iconColor:"text-red-500"}};function k9({shopId:n,bookings:e,shop:t,slug:i}){const[o,c]=j.useState({}),[d,m]=j.useState(null),[x,g]=j.useState(null),[b,w]=j.useState(""),[_,R]=j.useState(""),[B,V]=j.useState("all"),[U,F]=j.useState("lastVisit"),[Q,H]=j.useState("asc"),[re,he]=j.useState(null),[W,T]=j.useState(!1),[E,S]=j.useState(null),[I,k]=j.useState(!1),[O,C]=j.useState(null),$=t?.winbackSettings?.warningDays||30,L=t?.winbackSettings?.inactiveDays||60,P=t?.winbackSettings?.enabled!==!1,K=ne=>ne.toLowerCase().replace(/\./g,"_dot_").replace(/@/g,"_at_");j.useEffect(()=>{if(!n)return;const ne=ss(Xe(pe,"shops",n,"clientNotes"),je=>{const Se={};je.docs.forEach($e=>{Se[$e.id]=$e.data()}),c(Se)});return()=>ne()},[n]);const le=j.useMemo(()=>new Date,[]),Ee=j.useMemo(()=>e.filter(ne=>ne.status==="confirmed"||ne.status==="pending"||!ne.status),[e]),ye=j.useMemo(()=>{const ne={};return Ee.forEach(je=>{const Se=je.clientEmail?.toLowerCase();if(!Se)return;ne[Se]||(ne[Se]={email:Se,name:je.clientName||Se,phone:je.clientPhone||"",totalVisits:0,totalSpent:0,lastVisitDate:null,firstVisitDate:null,bookings:[],serviceFrequency:{},staffFrequency:{}});const $e=ne[Se];je.clientName&&($e.name=je.clientName),je.clientPhone&&($e.phone=je.clientPhone),$e.totalVisits++,$e.totalSpent+=Number(je.servicePrice)||0,$e.bookings.push(je),(!$e.lastVisitDate||je.date>$e.lastVisitDate)&&($e.lastVisitDate=je.date),(!$e.firstVisitDate||je.date<$e.firstVisitDate)&&($e.firstVisitDate=je.date),je.serviceName&&($e.serviceFrequency[je.serviceName]=($e.serviceFrequency[je.serviceName]||0)+1),je.staffName&&($e.staffFrequency[je.staffName]=($e.staffFrequency[je.staffName]||0)+1)}),Object.values(ne).map(je=>{const Se=je.lastVisitDate?T9(je.lastVisitDate,le):999,$e=A9(Se,$,L),Ze=Object.entries(je.serviceFrequency).sort((Ie,Be)=>Be[1]-Ie[1])[0]?.[0]||null,Et=Object.entries(je.staffFrequency).sort((Ie,Be)=>Be[1]-Ie[1])[0]?.[0]||null,Bs=je.totalVisits>0?je.totalSpent/je.totalVisits:0,Mt=K(je.email),xt=o[Mt];return{...je,daysSinceLastVisit:Se,status:$e,favoriteService:Ze,favoriteStaff:Et,avgSpending:Bs,encodedEmail:Mt,notes:xt?.notes||"",contacted:xt?.contacted||!1,contactedAt:xt?.contactedAt||null,tags:xt?.tags||[]}})},[Ee,le,$,L,o]),z=j.useMemo(()=>{const ne={all:ye.length,active:0,"getting-cold":0,"at-risk":0,lost:0};return ye.forEach(je=>{ne[je.status]++}),ne},[ye]),Z=j.useMemo(()=>ye.filter(ne=>(ne.status==="at-risk"||ne.status==="lost")&&!ne.contacted),[ye]),ce=j.useMemo(()=>{let ne=ye;if(_.trim()){const je=_.toLowerCase();ne=ne.filter(Se=>Se.name.toLowerCase().includes(je)||Se.email.includes(je)||Se.phone.includes(je))}return B!=="all"&&(ne=ne.filter(je=>je.status===B)),ne=[...ne].sort((je,Se)=>{if(U==="lastVisit"){const $e=(je.lastVisitDate||"").localeCompare(Se.lastVisitDate||"");return Q==="asc"?$e:-$e}return U==="totalVisits"?Q==="desc"?Se.totalVisits-je.totalVisits:je.totalVisits-Se.totalVisits:U==="totalSpent"?Q==="desc"?Se.totalSpent-je.totalSpent:je.totalSpent-Se.totalSpent:0}),ne},[ye,_,B,U,Q]),ge=ne=>{U===ne?H(je=>je==="asc"?"desc":"asc"):(F(ne),H(ne==="lastVisit"?"asc":"desc"))},de=j.useCallback(ne=>{const je=t?.name||"our shop",Se=`${window.location.origin}${window.location.pathname}#/shop/${i}`;return`Hi ${ne.name.split(" ")[0]}, we miss you at ${je}! It's been ${ne.daysSinceLastVisit} days since your last visit.${ne.favoriteService?` Book your next ${ne.favoriteService} today:`:" Book your next appointment:"} ${Se}`},[t,i]),Ce=ne=>{const je=de(ne);S({email:ne.email,encodedEmail:ne.encodedEmail,name:ne.name,message:je})},Fe=async(ne,je)=>{try{await navigator.clipboard.writeText(ne),he(je),setTimeout(()=>he(null),2e3)}catch(Se){console.error("Failed to copy:",Se)}},Rt=async ne=>{C(ne);try{const je=Oe(pe,"shops",n,"clientNotes",ne),Se=await j0(je),$e=Se.exists()?Se.data():{};await _0(je,{...$e,contacted:!0,contactedAt:new Date().toISOString()}),S(null)}catch(je){console.error("Error marking as contacted:",je)}finally{C(null)}},it=async ne=>{try{const je=Oe(pe,"shops",n,"clientNotes",ne),Se=await j0(je),$e=Se.exists()?Se.data():{};await _0(je,{...$e,contacted:!1,contactedAt:null})}catch(je){console.error("Error resetting contacted status:",je)}},Bt=async ne=>{k(!0);try{const je=Oe(pe,"shops",n,"clientNotes",ne),Se=await j0(je),$e=Se.exists()?Se.data():{};await _0(je,{...$e,notes:b}),g(null)}catch(je){console.error("Error saving notes:",je)}finally{k(!1)}};return a.jsxs("div",{className:"animate-fade-in space-y-6",children:[P&&Z.length>0&&a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>T(!W),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:a.jsx(ia,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[Z.length," client",Z.length!==1?"s":""," need",Z.length===1?"s":""," attention"]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Haven't visited in over ",L," days  send a win-back message to re-engage"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-2.5 py-1 bg-orange-100 text-orange-700 border border-orange-200 text-xs font-bold rounded-lg",children:Z.length}),W?a.jsx(dx,{className:"w-5 h-5 text-slate-400"}):a.jsx(Ou,{className:"w-5 h-5 text-slate-400"})]})]}),W&&a.jsx("div",{className:"mt-4 space-y-2.5",children:Z.sort((ne,je)=>je.daysSinceLastVisit-ne.daysSinceLastVisit).map(ne=>a.jsxs("div",{className:"bg-white rounded-xl border border-orange-100 p-4 flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx("div",{className:"w-9 h-9 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Sl,{className:"w-4 h-4 text-orange-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:ne.name}),a.jsxs("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Dh[ne.status].bg} ${Dh[ne.status].text} ${Dh[ne.status].border}`,children:[ne.daysSinceLastVisit," days ago"]})]}),a.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 flex-wrap mt-0.5",children:[a.jsxs("span",{children:["Last: ",iu(ne.lastVisitDate)]}),ne.favoriteService&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-slate-300",children:""}),a.jsxs("span",{className:"text-blue-600",children:["Loves ",ne.favoriteService]})]}),a.jsx("span",{className:"text-slate-300",children:""}),a.jsxs("span",{children:[ne.totalVisits," visit",ne.totalVisits!==1?"s":""]})]})]})]}),a.jsxs("button",{onClick:je=>{je.stopPropagation(),Ce(ne)},className:"flex items-center gap-1.5 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-xl text-xs font-semibold transition-all shadow-sm flex-shrink-0",children:[a.jsx(Wh,{className:"w-3.5 h-3.5"}),"Send Win-back"]})]},ne.email))})]}),E&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:a.jsx(fx,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Win-back Message"}),a.jsxs("p",{className:"text-sm text-slate-500",children:["Send to ",E.name]})]})]}),a.jsx("div",{className:"bg-slate-50 rounded-xl p-4 mb-4 border border-slate-200",children:a.jsx("textarea",{value:E.message,onChange:ne=>S({...E,message:ne.target.value}),rows:4,className:"w-full bg-transparent text-sm text-slate-700 resize-none focus:outline-none leading-relaxed"})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{Fe(E.message,E.email)},className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:re===E.email?a.jsxs(a.Fragment,{children:[a.jsx(Js,{className:"w-4 h-4"}),"Copied!"]}):a.jsxs(a.Fragment,{children:[a.jsx(B2,{className:"w-4 h-4"}),"Copy to Clipboard"]})}),a.jsxs("button",{onClick:()=>Rt(E.encodedEmail),disabled:O===E.encodedEmail,className:"flex items-center justify-center gap-2 px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-emerald-600/20 disabled:opacity-50",children:[a.jsx(Js,{className:"w-4 h-4"}),"Mark Contacted"]}),a.jsx("button",{onClick:()=>S(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Close"})]})]})}),a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Clients",value:z.all,icon:Ft,color:"bg-blue-100 text-blue-600"},{label:"Active",value:z.active,icon:Ig,color:"bg-emerald-100 text-emerald-600"},{label:"Getting Cold",value:z["getting-cold"],icon:G2,color:"bg-amber-100 text-amber-600"},{label:"At Risk / Lost",value:z["at-risk"]+z.lost,icon:ia,color:"bg-red-100 text-red-600"}].map(ne=>{const je=ne.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${ne.color} rounded-xl flex items-center justify-center`,children:a.jsx(je,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:ne.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:ne.label})]},ne.label)})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Clients"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Derived from booking history"})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[ce.length," client",ce.length!==1?"s":""]})]}),a.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[a.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[a.jsx(Yh,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2"}),a.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:_,onChange:ne=>R(ne.target.value),className:"w-full pl-10 pr-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),_&&a.jsx("button",{onClick:()=>R(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:a.jsx(Ds,{className:"w-4 h-4 text-slate-400 hover:text-slate-600"})})]}),a.jsx("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl overflow-x-auto",children:[{key:"all",label:"All"},{key:"active",label:"Active"},{key:"getting-cold",label:"Cold"},{key:"at-risk",label:"At Risk"},{key:"lost",label:"Lost"}].map(ne=>a.jsxs("button",{onClick:()=>V(ne.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap ${B===ne.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[ne.label,a.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${B===ne.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:z[ne.key]??0})]},ne.key))}),a.jsx("div",{className:"flex items-center gap-1",children:[{key:"lastVisit",label:"Last Visit"},{key:"totalVisits",label:"Visits"},{key:"totalSpent",label:"Spent"}].map(ne=>a.jsxs("button",{onClick:()=>ge(ne.key),className:`flex items-center gap-1 px-3 py-2 rounded-lg text-xs font-semibold transition-all border ${U===ne.key?"bg-blue-50 text-blue-700 border-blue-200":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[ne.label,U===ne.key&&a.jsx(vD,{className:"w-3 h-3"})]},ne.key))})]}),ce.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Ft,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No clients found"}),a.jsx("p",{className:"text-xs text-slate-400",children:_?"Try a different search term":"Client data will appear as bookings come in"})]}):a.jsx("div",{className:"space-y-2",children:ce.map(ne=>{const je=d===ne.email,Se=Dh[ne.status],$e=Se.icon;return a.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden hover:border-slate-300 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 cursor-pointer hover:bg-slate-50/50 transition-all",onClick:()=>m(je?null:ne.email),children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Sl,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:ne.name}),a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-bold rounded-md border ${Se.bg} ${Se.text} ${Se.border}`,children:[a.jsx($e,{className:"w-3 h-3"}),Se.label]}),ne.contacted&&a.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",children:[a.jsx(Wh,{className:"w-2.5 h-2.5"}),"Contacted"]}),ne.notes&&a.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-violet-50 text-violet-600 border-violet-200",children:a.jsx(s1,{className:"w-2.5 h-2.5"})})]}),a.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-3 mt-0.5 flex-wrap",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Tf,{className:"w-3 h-3"}),ne.email]}),ne.phone&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(mx,{className:"w-3 h-3"}),ne.phone]})]})]}),a.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-shrink-0",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900",children:ne.totalVisits}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-blue-600",children:Ih(ne.totalSpent)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-700",children:iu(ne.lastVisitDate)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(ne.status==="at-risk"||ne.status==="lost")&&!ne.contacted&&a.jsx("button",{onClick:Ze=>{Ze.stopPropagation(),Ce(ne)},className:"p-2 text-orange-500 hover:text-orange-700 hover:bg-orange-50 rounded-lg transition-all",title:"Send win-back message",children:a.jsx(Wh,{className:"w-4 h-4"})}),je?a.jsx(dx,{className:"w-4 h-4 text-slate-400"}):a.jsx(Ou,{className:"w-4 h-4 text-slate-400"})]})]}),je&&a.jsxs("div",{className:"border-t border-slate-200 bg-slate-50/50 p-5 space-y-5",children:[a.jsxs("div",{className:"sm:hidden grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-slate-900",children:ne.totalVisits}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-blue-600",children:Ih(ne.totalSpent)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-700",children:iu(ne.lastVisitDate)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Avg per Visit"}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:Ih(ne.avgSpending)})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"First Visit"}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:iu(ne.firstVisitDate)})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Days Since Last Visit"}),a.jsxs("div",{className:"text-sm font-bold text-slate-900",children:[ne.daysSinceLastVisit,"d"]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Favorite Service"}),a.jsx("div",{className:"text-sm font-bold text-blue-600 truncate",children:ne.favoriteService||""})]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Tn,{className:"w-3.5 h-3.5 text-blue-500"}),"Services Used"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(ne.serviceFrequency).sort((Ze,Et)=>Et[1]-Ze[1]).map(([Ze,Et])=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg text-xs font-medium",children:[Ze,a.jsxs("span",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[Et,""]})]},Ze))})]}),Object.keys(ne.staffFrequency).length>0&&a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Ft,{className:"w-3.5 h-3.5 text-violet-500"}),"Staff Members Seen"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(ne.staffFrequency).sort((Ze,Et)=>Et[1]-Ze[1]).map(([Ze,Et])=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-violet-50 text-violet-700 border border-violet-200 rounded-lg text-xs font-medium",children:[Ze,a.jsxs("span",{className:"bg-violet-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[Et,""]})]},Ze))})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Ct,{className:"w-3.5 h-3.5 text-emerald-500"}),"Booking History",a.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",ne.bookings.length,")"]})]}),a.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:ne.bookings.sort((Ze,Et)=>(Et.date+Et.time).localeCompare(Ze.date+Ze.time)).map((Ze,Et)=>a.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded-lg hover:bg-slate-50 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-700",children:iu(Ze.date)}),a.jsx("span",{className:"text-slate-400",children:Ze.time}),Ze.serviceName&&a.jsx("span",{className:"text-blue-600",children:Ze.serviceName})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[Ze.staffName&&a.jsx("span",{className:"text-violet-600",children:Ze.staffName}),Ze.servicePrice!=null&&a.jsx("span",{className:"font-semibold text-slate-900",children:Ih(Ze.servicePrice)})]})]},Et))})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 flex items-center gap-1.5",children:[a.jsx(s1,{className:"w-3.5 h-3.5 text-amber-500"}),"Notes"]}),x!==ne.encodedEmail&&a.jsx("button",{onClick:()=>{g(ne.encodedEmail),w(ne.notes||"")},className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:ne.notes?"Edit":"Add Notes"})]}),x===ne.encodedEmail?a.jsxs("div",{className:"space-y-2",children:[a.jsx("textarea",{value:b,onChange:Ze=>w(Ze.target.value),placeholder:"Add notes about this client (e.g., preferences, allergies, favorite styles...)",rows:3,className:"w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>Bt(ne.encodedEmail),disabled:I,className:"px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:I?"Saving...":"Save"}),a.jsx("button",{onClick:()=>g(null),className:"px-4 py-1.5 bg-white hover:bg-slate-50 text-slate-600 border border-slate-200 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}):a.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:ne.notes||'No notes yet. Click "Add Notes" to save preferences, allergies, or anything useful.'})]}),ne.contacted&&a.jsxs("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[a.jsx(Js,{className:"w-4 h-4"}),a.jsxs("span",{className:"font-medium",children:["Contacted",ne.contactedAt?` on ${new Date(ne.contactedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`:""]})]}),a.jsx("button",{onClick:()=>it(ne.encodedEmail),className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:"Reset"})]})]})]},ne.email)})})]})]})}const j1="https://us-central1-scheduler-65e51.cloudfunctions.net",C9={pro:"price_1Sxx7ILhwB1Jyzw8UvRxE5FT",unlimited:"price_1Sxx7JLhwB1Jyzw8uw9BRYhO"},R9={basicBooking:Ct,emailNotifications:fx,aiAssistant:SD,recurringBookings:os,waitlist:Ft,crm:Ft,analytics:Cg,smsNotifications:fx,customBranding:F2,walkIns:W2,multiLocation:gM,noBranding:H2,apiAccess:HD,prioritySupport:iM};function I9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState(e),[c,d]=j.useState(!1),[m,x]=j.useState(null),[g,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;const H=ss(Oe(pe,"shops",n),re=>{re.exists()&&o(re.data())});return()=>H()},[n]);const w=i?.subscriptionTier||"free",_=Sr[w],R=i?.subscriptionStatus,B=i?.subscriptionEndsAt,V=H=>H?(H.toDate?H.toDate():new Date(H)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):null,U=async H=>{d(H),x(null);try{const re=await fetch(`${j1}/createCheckoutSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,priceId:C9[H],successUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?subscription=canceled`})}),he=await re.json();if(!re.ok)throw new Error(he.error||"Failed to create checkout session");window.location.href=he.url}catch(re){console.error("Upgrade error:",re),x(re.message),d(null)}},F=async()=>{b(!0),x(null);try{const H=await fetch(`${j1}/createBillingPortalSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,returnUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard`})}),re=await H.json();if(!H.ok)throw new Error(re.error||"Failed to open billing portal");window.location.href=re.url}catch(H){console.error("Billing portal error:",H),x(H.message),b(!1)}},Q=[{key:"free",name:"Free",price:"$0",period:"forever",description:"Perfect for getting started",color:"slate",features:[{key:"staff",text:"1 staff member"},{key:"basicBooking",text:"Online booking"},{key:"emailNotifications",text:"Email notifications"},{key:"fee",text:"5% platform fee on deposits",negative:!0}]},{key:"pro",name:"Pro",price:"$29",period:"/month",description:"For growing businesses",color:"blue",popular:!0,features:[{key:"staff",text:"Up to 5 staff members"},{key:"basicBooking",text:"Online booking"},{key:"emailNotifications",text:"Email notifications"},{key:"aiAssistant",text:"AI booking assistant"},{key:"recurringBookings",text:"Recurring bookings"},{key:"waitlist",text:"Waitlist management"},{key:"crm",text:"Client CRM & notes"},{key:"analytics",text:"Analytics dashboard"},{key:"smsNotifications",text:"SMS notifications"},{key:"fee",text:"No platform fees",highlight:!0}]},{key:"unlimited",name:"Unlimited",price:"$79",period:"/month",description:"For established businesses",color:"violet",features:[{key:"staff",text:"Unlimited staff members"},{key:"everything",text:"Everything in Pro, plus:"},{key:"walkIns",text:"Walk-in queue management"},{key:"multiLocation",text:"Multi-location support"},{key:"noBranding",text:"Remove SpotBookie branding"},{key:"apiAccess",text:"API access"},{key:"prioritySupport",text:"Priority support"}]}];return a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:`rounded-2xl p-6 mb-8 ${w==="unlimited"?"bg-gradient-to-r from-violet-500 to-purple-600":w==="pro"?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gradient-to-r from-slate-600 to-slate-700"}`,children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:a.jsx(Fo,{className:"w-7 h-7 text-white"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("h2",{className:"text-xl font-bold text-white",children:[_.name," Plan"]}),R==="past_due"&&a.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full",children:"Payment Failed"}),B&&a.jsx("span",{className:"px-2 py-0.5 bg-amber-500 text-white text-xs font-bold rounded-full",children:"Canceling"})]}),a.jsx("p",{className:"text-white/80 text-sm mt-0.5",children:w==="free"?"Upgrade to unlock more features":B?`Access until ${V(B)}`:"Your subscription is active"})]})]}),w!=="free"&&a.jsxs("button",{onClick:F,disabled:g,className:"flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 text-white rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[g?a.jsx(ra,{className:"w-4 h-4 animate-spin"}):a.jsx(Za,{className:"w-4 h-4"}),"Manage Billing"]})]})}),m&&a.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[a.jsx(Pu,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800",children:"Something went wrong"}),a.jsx("p",{className:"text-sm text-red-600",children:m})]})]}),R==="past_due"&&a.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl flex items-start gap-3",children:[a.jsx(Pu,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-amber-800",children:"Payment Failed"}),a.jsx("p",{className:"text-sm text-amber-600",children:"Your last payment failed. Please update your payment method to keep your subscription active."}),a.jsx("button",{onClick:F,className:"mt-2 text-sm font-semibold text-amber-700 hover:text-amber-800 underline",children:"Update Payment Method "})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Q.map(H=>{const re=H.key===w,he=["free","pro","unlimited"].indexOf(H.key)<["free","pro","unlimited"].indexOf(w),W=!re&&!he;return a.jsxs("div",{className:`relative bg-white rounded-2xl border-2 p-6 transition-all ${H.popular?"border-blue-500 shadow-lg shadow-blue-500/10":re?"border-emerald-500":"border-slate-200 hover:border-slate-300"}`,children:[H.popular&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsx("span",{className:"px-3 py-1 bg-blue-500 text-white text-xs font-bold rounded-full",children:"Most Popular"})}),re&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsx("span",{className:"px-3 py-1 bg-emerald-500 text-white text-xs font-bold rounded-full",children:"Current Plan"})}),a.jsxs("div",{className:"text-center mb-6 pt-2",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:H.name}),a.jsxs("div",{className:"mt-2 flex items-baseline justify-center gap-1",children:[a.jsx("span",{className:"text-4xl font-extrabold text-slate-900",children:H.price}),a.jsx("span",{className:"text-slate-500 text-sm",children:H.period})]}),a.jsx("p",{className:"text-sm text-slate-500 mt-2",children:H.description})]}),a.jsx("ul",{className:"space-y-3 mb-6",children:H.features.map((T,E)=>(R9[T.key],a.jsxs("li",{className:"flex items-start gap-2.5",children:[a.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5 ${T.negative?"bg-red-100 text-red-500":T.highlight?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-600"}`,children:T.negative?a.jsx("span",{className:"text-xs font-bold",children:"%"}):a.jsx(Js,{className:"w-3 h-3"})}),a.jsx("span",{className:`text-sm ${T.negative?"text-red-600":T.highlight?"text-emerald-700 font-medium":"text-slate-700"}`,children:T.text})]},E)))}),W?a.jsx("button",{onClick:()=>U(H.key),disabled:c,className:`w-full flex items-center justify-center gap-2 py-3 rounded-xl font-semibold text-sm transition-all ${H.key==="unlimited"?"bg-gradient-to-r from-violet-500 to-purple-600 hover:from-violet-600 hover:to-purple-700 text-white shadow-lg shadow-violet-500/20":H.key==="pro"?"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg shadow-blue-500/20":"bg-slate-100 hover:bg-slate-200 text-slate-700"} disabled:opacity-50`,children:c===H.key?a.jsxs(a.Fragment,{children:[a.jsx(ra,{className:"w-4 h-4 animate-spin"}),"Redirecting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ec,{className:"w-4 h-4"}),"Upgrade to ",H.name]})}):re?a.jsx("div",{className:"w-full py-3 text-center text-sm font-semibold text-emerald-600 bg-emerald-50 rounded-xl border border-emerald-200",children:" Your Current Plan"}):a.jsx("div",{className:"w-full py-3 text-center text-sm font-medium text-slate-400 bg-slate-50 rounded-xl",children:"Included in your plan"})]},H.key)})}),a.jsxs("div",{className:"mt-12",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Feature Comparison"}),a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Feature"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-slate-700",children:"Free"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-blue-600",children:"Pro"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-violet-600",children:"Unlimited"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b border-slate-100",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:"Staff Members"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"1"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"5"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"Unlimited"})]}),a.jsxs("tr",{className:"border-b border-slate-100",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:"Platform Fee"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-red-500",children:"5%"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-emerald-600",children:"0%"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-emerald-600",children:"0%"})]}),Object.entries(c9).map(([H,re])=>a.jsxs("tr",{className:"border-b border-slate-100 last:border-b-0",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:re.name}),a.jsx("td",{className:"py-3 px-4 text-center",children:Sr.free.features.includes(H)?a.jsx(Js,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})}),a.jsx("td",{className:"py-3 px-4 text-center",children:Sr.pro.features.includes(H)?a.jsx(Js,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})}),a.jsx("td",{className:"py-3 px-4 text-center",children:Sr.unlimited.features.includes(H)?a.jsx(Js,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})})]},H))]})]})})]}),a.jsxs("div",{className:"mt-12",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Frequently Asked Questions"}),a.jsx("div",{className:"space-y-4",children:[{q:"Can I cancel anytime?",a:"Yes! You can cancel your subscription at any time. You'll continue to have access until the end of your billing period."},{q:"What happens if I downgrade?",a:"When you downgrade, you'll keep your current plan until the end of the billing period. After that, feature limits (like staff count) will apply."},{q:"What is the platform fee?",a:"On the Free plan, we charge a 5% fee on any deposits collected through SpotBookie. Pro and Unlimited plans have no platform fees."},{q:"Do you offer refunds?",a:"We offer a 14-day money-back guarantee for first-time subscribers. Contact us if you're not satisfied."}].map((H,re)=>a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:H.q}),a.jsx("p",{className:"text-sm text-slate-600",children:H.a})]},re))})]})]})}const Mh="https://us-central1-scheduler-65e51.cloudfunctions.net";function D9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState(e),[c,d]=j.useState(null),[m,x]=j.useState(null),[g,b]=j.useState(null);j.useEffect(()=>{if(!n)return;const W=ss(Oe(pe,"shops",n),T=>{T.exists()&&o(T.data())});return()=>W()},[n]);const w=!!i?.stripeAccountId,_=i?.stripeOnboardingComplete,R=i?.payoutsEnabled;i?.stripeAccountStatus;const B=i?.subscriptionTier||"free",V=B==="free"?"5%":"0%",U=async()=>{d("create"),x(null);try{const W=await fetch(`${Mh}/createConnectAccount`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,email:i.ownerEmail,businessName:i.name})}),T=await W.json();if(!W.ok)throw new Error(T.error||"Failed to create account");(!T.alreadyExists||!i.stripeOnboardingComplete)&&await F()}catch(W){console.error("Create account error:",W),x(W.message)}finally{d(null)}},F=async()=>{d("onboard"),x(null);try{const W=await fetch(`${Mh}/createAccountLink`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,returnUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?connect=return`,refreshUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?connect=refresh`})}),T=await W.json();if(!W.ok)throw new Error(T.error||"Failed to create onboarding link");window.location.href=T.url}catch(W){console.error("Onboarding error:",W),x(W.message),d(null)}},Q=async()=>{d("dashboard"),x(null);try{const W=await fetch(`${Mh}/getConnectDashboardLink`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n})}),T=await W.json();if(!W.ok)throw new Error(T.error||"Failed to get dashboard link");window.open(T.url,"_blank")}catch(W){console.error("Dashboard link error:",W),x(W.message)}finally{d(null)}},H=async()=>{d("balance"),x(null);try{const W=await fetch(`${Mh}/getConnectBalance`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n})}),T=await W.json();if(!W.ok)throw new Error(T.error||"Failed to fetch balance");b(T)}catch(W){console.error("Balance fetch error:",W),x(W.message)}finally{d(null)}};j.useEffect(()=>{R&&!g&&H()},[R]);const re=(W,T="usd")=>new Intl.NumberFormat("en-US",{style:"currency",currency:T.toUpperCase()}).format(W/100),he=W=>new Date(W*1e3).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Payments"}),a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:"Connect Stripe to accept deposits and get paid"})]}),w&&R&&a.jsxs("button",{onClick:H,disabled:c==="balance",className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-all",children:[c==="balance"?a.jsx(ra,{className:"w-3.5 h-3.5 animate-spin"}):a.jsx(Lu,{className:"w-3.5 h-3.5"}),"Refresh"]})]}),m&&a.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[a.jsx(Pu,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800 text-sm",children:"Something went wrong"}),a.jsx("p",{className:"text-sm text-red-600",children:m})]})]}),!w&&a.jsx("div",{className:"bg-gradient-to-br from-violet-50 to-blue-50 rounded-2xl border border-violet-200 p-8",children:a.jsxs("div",{className:"flex flex-col items-center text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-lg flex items-center justify-center mb-5",children:a.jsx(_n,{className:"w-8 h-8 text-violet-600"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"Accept Payments"}),a.jsx("p",{className:"text-slate-600 max-w-md mb-6",children:"Connect your Stripe account to accept deposit payments from clients when they book. Funds are transferred directly to your bank account."}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 w-full max-w-xl mb-8",children:[{icon:Kh,label:"Secure payments",desc:"256-bit encryption"},{icon:ec,label:"Fast payouts",desc:"2-day transfers"},{icon:Mo,label:"Low fees",desc:"2.9% + 30"}].map(({icon:W,label:T,desc:E})=>a.jsxs("div",{className:"bg-white/70 rounded-xl p-4 text-center",children:[a.jsx(W,{className:"w-5 h-5 text-violet-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm font-semibold text-slate-900",children:T}),a.jsx("p",{className:"text-xs text-slate-500",children:E})]},T))}),a.jsx("button",{onClick:U,disabled:c==="create",className:"flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-violet-600 to-blue-600 hover:from-violet-700 hover:to-blue-700 text-white rounded-xl font-bold text-base shadow-lg shadow-violet-600/25 transition-all disabled:opacity-50",children:c==="create"?a.jsxs(a.Fragment,{children:[a.jsx(ra,{className:"w-5 h-5 animate-spin"}),"Setting up..."]}):a.jsxs(a.Fragment,{children:[a.jsx(_n,{className:"w-5 h-5"}),"Connect with Stripe",a.jsx(Do,{className:"w-5 h-5"})]})}),B==="free"&&a.jsxs("p",{className:"mt-4 text-xs text-slate-500 flex items-center gap-1",children:[a.jsx(t1,{className:"w-3.5 h-3.5"}),"Free tier: ",V," platform fee on deposits.",a.jsx("a",{href:"#",className:"text-violet-600 hover:underline",children:"Upgrade to remove"})]})]})}),w&&!_&&a.jsx("div",{className:"bg-amber-50 rounded-2xl border border-amber-200 p-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(os,{className:"w-6 h-6 text-amber-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Complete Your Setup"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Your Stripe account is created, but you need to complete the onboarding process to start accepting payments."}),a.jsx("button",{onClick:F,disabled:c==="onboard",className:"flex items-center gap-2 px-5 py-2.5 bg-amber-600 hover:bg-amber-700 text-white rounded-xl font-semibold text-sm shadow-md transition-all disabled:opacity-50",children:c==="onboard"?a.jsxs(a.Fragment,{children:[a.jsx(ra,{className:"w-4 h-4 animate-spin"}),"Redirecting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Za,{className:"w-4 h-4"}),"Complete Setup"]})})]})]})}),w&&_&&!R&&a.jsx("div",{className:"bg-blue-50 rounded-2xl border border-blue-200 p-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(TD,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Verification in Progress"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Stripe is reviewing your account. This usually takes a few minutes. Once approved, you'll be able to accept payments."}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("button",{onClick:F,disabled:c==="onboard",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[c==="onboard"?a.jsx(ra,{className:"w-4 h-4 animate-spin"}):a.jsx(Za,{className:"w-4 h-4"}),"Check Status"]})})]})]})}),w&&R&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:a.jsx(Vs,{className:"w-7 h-7"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Stripe Connected"}),a.jsx("span",{className:"px-2 py-0.5 bg-white/20 text-xs font-bold rounded-full",children:"Active"})]}),a.jsx("p",{className:"text-white/80 text-sm mt-0.5",children:"You're ready to accept deposit payments"})]})]}),a.jsxs("button",{onClick:Q,disabled:c==="dashboard",className:"flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[c==="dashboard"?a.jsx(ra,{className:"w-4 h-4 animate-spin"}):a.jsx(Za,{className:"w-4 h-4"}),"Stripe Dashboard"]})]})}),g&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Available"}),a.jsx(n1,{className:"w-4 h-4 text-emerald-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:g.balance.available[0]?re(g.balance.available[0].amount,g.balance.available[0].currency):"$0.00"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Ready to pay out"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Pending"}),a.jsx(os,{className:"w-4 h-4 text-blue-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:g.balance.pending[0]?re(g.balance.pending[0].amount,g.balance.pending[0].currency):"$0.00"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Processing"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Platform Fee"}),a.jsx(Mo,{className:"w-4 h-4 text-violet-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:V}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:B==="free"?"Upgrade to remove":"No platform fees"})]})]}),g?.recentCharges?.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-bold text-slate-900",children:"Recent Payments"}),a.jsx("button",{onClick:Q,className:"text-xs font-medium text-blue-600 hover:text-blue-700",children:"View All "})]}),a.jsx("div",{className:"space-y-3",children:g.recentCharges.slice(0,5).map(W=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${W.status==="succeeded"?"bg-emerald-100":"bg-slate-100"}`,children:W.status==="succeeded"?a.jsx(Vs,{className:"w-4 h-4 text-emerald-600"}):a.jsx(os,{className:"w-4 h-4 text-slate-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:W.metadata?.clientName||"Payment"}),a.jsxs("p",{className:"text-xs text-slate-400",children:[he(W.created),W.metadata?.serviceName&&`  ${W.metadata.serviceName}`]})]})]}),a.jsx("span",{className:"text-sm font-bold text-slate-900",children:re(W.amount,W.currency)})]},W.id))})]}),g?.recentPayouts?.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-bold text-slate-900",children:"Recent Payouts"}),a.jsx($o,{className:"w-4 h-4 text-slate-400"})]}),a.jsx("div",{className:"space-y-3",children:g.recentPayouts.slice(0,3).map(W=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${W.status==="paid"?"bg-emerald-100":"bg-amber-100"}`,children:a.jsx(n1,{className:`w-4 h-4 ${W.status==="paid"?"text-emerald-600":"text-amber-600"}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900 capitalize",children:W.status}),a.jsx("p",{className:"text-xs text-slate-400",children:W.arrivalDate?`Arrives ${he(W.arrivalDate)}`:he(W.created)})]})]}),a.jsx("span",{className:"text-sm font-bold text-emerald-600",children:re(W.amount,W.currency)})]},W.id))})]})]}),a.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-5",children:[a.jsxs("h3",{className:"font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(t1,{className:"w-4 h-4 text-blue-500"}),"How it works"]}),a.jsxs("ul",{className:"space-y-2 text-sm text-slate-600",children:[a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"1"}),a.jsx("span",{children:"Client books an appointment and pays the deposit"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"2"}),a.jsxs("span",{children:["Payment goes directly to your Stripe account (minus Stripe's 2.9% + 30 fee",B==="free"&&` and ${V} platform fee`,")"]})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"3"}),a.jsx("span",{children:"Stripe automatically transfers funds to your bank (usually within 2 days)"})]})]})]})]})}const M9=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function I0(n){const[e,t]=n.split(":").map(Number);return e*60+t}function O9(n,e){if(n.status!=="waiting"||n.serviceId&&e.serviceId&&n.serviceId!==e.serviceId||n.staffId&&n.staffId!=="any"&&e.staffId&&n.staffId!==e.staffId)return!1;if(e.date){if(n.preferredDate&&n.preferredDate!==e.date)return!1;if(n.preferredDays&&n.preferredDays.length>0){const t=new Date(e.date+"T12:00:00"),i=M9[t.getDay()];if(!n.preferredDays.includes(i))return!1}}if(e.time&&n.preferredTimeRange){const t=I0(e.time),i=I0(n.preferredTimeRange.start),o=I0(n.preferredTimeRange.end);if(!(n.preferredTimeRange.start==="00:00"&&n.preferredTimeRange.end==="23:59")&&(t<i||t>o))return!1}return!0}function P9(n,e){return n.filter(t=>O9(t,e)).sort((t,i)=>(t.createdAt||"").localeCompare(i.createdAt||""))}const _1=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}];function xi(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"PM":"AM";return`${e%12||12}:${t.toString().padStart(2,"0")} ${i}`}function L9({user:n}){const{slug:e}=Wo(),t=Oi(),[i,o]=Q1(),[c,d]=j.useState(null),[m,x]=j.useState(null),[g,b]=j.useState(!0),[w,_]=j.useState(!1),[R,B]=j.useState([]),[V,U]=j.useState([]),[F,Q]=j.useState([]),[H,re]=j.useState([]),he=["schedule","clients","walkins","analytics","waitlist","staff","services","subscription","settings"],W=i.get("tab"),T=he.includes(W)?W:"schedule",E=M=>{o({tab:M})},[S,I]=j.useState(null),[k,O]=j.useState("all"),[C,$]=j.useState("all"),[L,P]=j.useState([]),[K,le]=j.useState(null),[Ee,ye]=j.useState(null),[z,Z]=j.useState(!1),[ce,ge]=j.useState(!1),[de,Ce]=j.useState({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""});j.useEffect(()=>{if(!n){t(`/shop/${e}/login`,{replace:!0});return}(async()=>{b(!0);try{const G=Fn(Xe(pe,"shops"),jn("slug","==",e)),fe=await Ls(G);if(fe.empty){_(!0),b(!1);return}const ue=fe.docs[0],Ve=ue.data();if(Ve.ownerUid!==n.uid){_(!0),b(!1);return}d(Ve),x(ue.id)}catch(G){console.error("Error checking ownership:",G),_(!0)}finally{b(!1)}})()},[n,e,t]),j.useEffect(()=>{if(!m)return;const M=ss(Xe(pe,"shops",m,"availability"),et=>{const ft=et.docs.map(Qe=>({id:Qe.id,...Qe.data()}));B(ft)}),G=ss(Xe(pe,"shops",m,"bookings"),et=>{const ft=et.docs.map(Qe=>({id:Qe.id,...Qe.data()}));U(ft)}),fe=ss(Xe(pe,"shops",m,"staff"),et=>{const ft=et.docs.map(Qe=>({id:Qe.id,...Qe.data()})).filter(Qe=>Qe.active!==!1).sort((Qe,vt)=>(Qe.name||"").localeCompare(vt.name||""));Q(ft)}),ue=ss(Xe(pe,"shops",m,"waitlist"),et=>{const ft=et.docs.map(Qe=>({id:Qe.id,...Qe.data()})).sort((Qe,vt)=>(Qe.createdAt||"").localeCompare(vt.createdAt||""));P(ft)}),Ve=ss(Xe(pe,"shops",m,"services"),et=>{const ft=et.docs.map(Qe=>({id:Qe.id,...Qe.data()})).filter(Qe=>Qe.active!==!1).sort((Qe,vt)=>(Qe.name||"").localeCompare(vt.name||""));re(ft)});return()=>{M(),G(),fe(),ue(),Ve()}},[m]);const Fe=async()=>{await of(wa),t(`/shop/${e}`,{replace:!0})},Rt=async M=>{M.preventDefault();const{date:G,startTime:fe,endTime:ue,slotDuration:Ve,staffId:et}=de,ft=parseInt(Ve),[Qe,vt]=fe.split(":").map(Number),[Tt,Os]=ue.split(":").map(Number),Ot=Qe*60+vt,zs=Tt*60+Os;let Jt=Ot;for(;Jt+ft<=zs;){const ms=Math.floor(Jt/60),on=Jt%60,nr=`${ms.toString().padStart(2,"0")}:${on.toString().padStart(2,"0")}`,Bi={date:G,time:nr,duration:ft,available:!0};if(et){const Il=F.find(Dl=>Dl.id===et);Bi.staffId=et,Bi.staffName=Il?.name||""}await Sa(Xe(pe,"shops",m,"availability"),Bi),Jt+=ft}Ce({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""})},it=async M=>{await Io(Oe(pe,"shops",m,"availability",M))},Bt=M=>{const G={date:M.date,time:M.time,staffId:M.staffId||null,serviceId:M.serviceId||null},fe=P9(L,G);fe.length>0&&le({matches:fe,slot:G})},ne=async(M,G)=>{for(const fe of M)await Ye(Oe(pe,"shops",m,"waitlist",fe.id),{status:"notified",notifiedAt:new Date().toISOString(),notifiedSlot:{date:G.date,time:G.time,staffId:G.staffId||null,staffName:G.staffName||null}});le(null)},je=async M=>{await Ye(Oe(pe,"shops",m,"waitlist",M),{status:"notified",notifiedAt:new Date().toISOString()})},Se=async M=>{await Ye(Oe(pe,"shops",m,"waitlist",M),{status:"expired"})},$e=async M=>{const G=V.find(fe=>fe.id===M);if(G&&G.recurringGroupId){ye({bookingId:M,recurringGroupId:G.recurringGroupId});return}if(await Ye(Oe(pe,"shops",m,"bookings",M),{status:"cancelled"}),G&&G.slotId&&!G.slotId.startsWith("wh-")&&!G.slotId.startsWith("recurring-"))try{await Ye(Oe(pe,"shops",m,"availability",G.slotId),{available:!0})}catch(fe){console.warn("Could not re-open slot:",fe)}G&&Bt(G)},Ze=async M=>{const G=V.find(fe=>fe.id===M);if(await Ye(Oe(pe,"shops",m,"bookings",M),{status:"cancelled"}),G&&G.slotId&&!G.slotId.startsWith("wh-")&&!G.slotId.startsWith("recurring-"))try{await Ye(Oe(pe,"shops",m,"availability",G.slotId),{available:!0})}catch(fe){console.warn("Could not re-open slot:",fe)}G&&Bt(G),ye(null)},Et=async(M,G)=>{const fe=V.find(Ve=>Ve.id===M);if(!fe)return;const ue=V.filter(Ve=>Ve.recurringGroupId===G&&Ve.date>=fe.date&&(Ve.status==="pending"||Ve.status==="confirmed"));for(const Ve of ue)if(await Ye(Oe(pe,"shops",m,"bookings",Ve.id),{status:"cancelled"}),Ve.slotId&&!Ve.slotId.startsWith("wh-")&&!Ve.slotId.startsWith("recurring-"))try{await Ye(Oe(pe,"shops",m,"availability",Ve.slotId),{available:!0})}catch(et){console.warn("Could not re-open slot:",et)}fe&&Bt(fe),ye(null)},Bs=async M=>{await Ye(Oe(pe,"shops",m,"bookings",M),{status:"confirmed"})},Mt=async M=>{const G=V.find(fe=>fe.id===M);if(await Ye(Oe(pe,"shops",m,"bookings",M),{status:"rejected"}),G&&G.slotId&&!G.slotId.startsWith("wh-"))try{await Ye(Oe(pe,"shops",m,"availability",G.slotId),{available:!0})}catch(fe){console.warn("Could not re-open slot:",fe)}G&&Bt(G)},xt=async M=>{await Ye(Oe(pe,"shops",m,"bookings",M),{status:"completed",completedAt:kr()})},Ie=async()=>{const M=!c?.requireApproval;try{await Ye(Oe(pe,"shops",m),{requireApproval:M}),d(G=>({...G,requireApproval:M}))}catch(G){console.error("Error updating requireApproval:",G)}},Be=async M=>{const G=parseInt(M);try{await Ye(Oe(pe,"shops",m),{bufferMinutes:G}),d(fe=>({...fe,bufferMinutes:G}))}catch(fe){console.error("Error updating buffer minutes:",fe)}},xe=async M=>{const G=M.target.files?.[0];if(G){if(!G.type.startsWith("image/")){alert("Please select an image file");return}if(G.size>2*1024*1024){alert("Image must be smaller than 2MB");return}ge(!0);try{const fe=cx(ux,`shops/${m}/logo-${Date.now()}`);await O2(fe,G);const ue=await P2(fe);await Ye(Oe(pe,"shops",m),{logoUrl:ue}),d(Ve=>({...Ve,logoUrl:ue}))}catch(fe){console.error("Error uploading logo:",fe),alert("Failed to upload logo. Please try again.")}finally{ge(!1)}}},qe=async M=>{try{await Ye(Oe(pe,"shops",m),{brandColor:M}),d(G=>({...G,brandColor:M}))}catch(G){console.error("Error updating brand color:",G)}},Le=async M=>{try{await Ye(Oe(pe,"shops",m),{tagline:M}),d(G=>({...G,tagline:M}))}catch(G){console.error("Error updating tagline:",G)}},De=(M,G)=>new Date(`${M}T${G}`).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),Ge=j.useMemo(()=>{const M={},G=k==="all"?F:F.filter(ue=>ue.id===k),fe=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(const ue of G)ue.weeklyHours&&fe.forEach((Ve,et)=>{ue.weeklyHours[Ve]?.enabled&&(M[et]=!0)});return M},[F,k]),He=j.useMemo(()=>{const M={},G=k==="all"?F:F.filter(Ve=>Ve.id===k),fe=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],ue=new Date;ue.setHours(0,0,0,0);for(let Ve=0;Ve<60;Ve++){const et=new Date(ue);et.setDate(et.getDate()+Ve);const ft=et.getDay(),Qe=fe[ft],vt=`${et.getFullYear()}-${String(et.getMonth()+1).padStart(2,"0")}-${String(et.getDate()).padStart(2,"0")}`;for(const Tt of G){if(!Tt.weeklyHours||!Tt.weeklyHours[Qe]?.enabled)continue;const Os=Tt.weeklyHours[Qe],Ot=Os.breaks||(Os.break?[Os.break]:[]);Ot.length>0&&(M[vt]||(M[vt]=[]),M[vt].push(...Ot.map(zs=>({...zs,staffId:Tt.id,staffName:Tt.name}))))}}return M},[F,k]),J=j.useMemo(()=>(k==="all"?F:F.filter(G=>G.id===k)).filter(G=>G.weeklyHours?_1.some(fe=>G.weeklyHours[fe.key]?.enabled):!1),[F,k]),Ae=j.useMemo(()=>{const M=new Date,G=`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}-${String(M.getDate()).padStart(2,"0")}`,fe=M.getDay(),ue=fe===0?-6:1-fe,Ve=new Date(M);Ve.setDate(M.getDate()+ue),Ve.setHours(0,0,0,0);const et=new Date(Ve);et.setDate(Ve.getDate()+6),et.setHours(23,59,59,999);const ft=`${Ve.getFullYear()}-${String(Ve.getMonth()+1).padStart(2,"0")}-${String(Ve.getDate()).padStart(2,"0")}`,Qe=`${et.getFullYear()}-${String(et.getMonth()+1).padStart(2,"0")}-${String(et.getDate()).padStart(2,"0")}`,vt=V.filter(Ot=>Ot.date===G).length,Tt=V.filter(Ot=>Ot.date>=ft&&Ot.date<=Qe).length,Os=new Set(V.map(Ot=>Ot.clientEmail?.toLowerCase()).filter(Boolean)).size;return{todayBookings:vt,weekBookings:Tt,uniqueClients:Os,totalBookings:V.length}},[V]),We=j.useMemo(()=>V.filter(M=>M.status==="pending").length,[V]),tt=j.useMemo(()=>L.filter(M=>M.status==="waiting").length,[L]),[It,rs]=j.useState(0),[gt,hs]=j.useState({}),Xt=j.useMemo(()=>{if(!c)return 0;c?.winbackSettings?.warningDays;const M=c?.winbackSettings?.inactiveDays||60;if(!(c?.winbackSettings?.enabled!==!1))return 0;const fe=new Date,ue=V.filter(Qe=>Qe.status==="confirmed"||Qe.status==="pending"||!Qe.status),Ve={};ue.forEach(Qe=>{const vt=Qe.clientEmail?.toLowerCase();vt&&(!Ve[vt]||Qe.date>Ve[vt])&&(Ve[vt]=Qe.date)});let et=0;const ft=Qe=>Qe.replace(/\./g,"_dot_").replace(/@/g,"_at_");return Object.entries(Ve).forEach(([Qe,vt])=>{if(Math.floor((fe.getTime()-new Date(vt+"T12:00:00").getTime())/864e5)>M){const Os=ft(Qe);gt[Os]?.contacted||et++}}),et},[V,c,gt]);if(j.useEffect(()=>{if(!m)return;const M=ss(Xe(pe,"shops",m,"clientNotes"),G=>{const fe={};G.docs.forEach(ue=>{fe[ue.id]=ue.data()}),hs(fe)});return()=>M()},[m]),j.useEffect(()=>{if(!m)return;const M=ss(Xe(pe,"shops",m,"walkins"),G=>{const fe=G.docs.filter(ue=>ue.data().status==="waiting").length;rs(fe)});return()=>M()},[m]),g)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading dashboard"})]})});if(w)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Sf,{className:"w-8 h-8 text-red-500"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Unauthorized"}),a.jsx("p",{className:"text-slate-600 mb-6",children:"You don't have access to this dashboard."}),a.jsx(at,{to:`/shop/${e}/login`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:"Login"})]})});const rn=k==="all"?R:R.filter(M=>M.staffId===k),Ms=k==="all"?V:V.filter(M=>M.staffId===k),Cn=rn.reduce((M,G)=>(M[G.date]||(M[G.date]=[]),M[G.date].push(G),M),{}),ln=Ms.reduce((M,G)=>(M[G.date]||(M[G.date]=[]),M[G.date].push(G),M),{}),_e=S?Object.keys(Cn).filter(M=>M===S).sort():Object.keys(Cn).sort(),Te=S?Ms.filter(M=>M.date===S):Ms,ot=C==="all"?Te:C==="pending"?Te.filter(M=>M.status==="pending"):C==="confirmed"?Te.filter(M=>!M.status||M.status==="confirmed"):C==="completed"?Te.filter(M=>M.status==="completed"):Te.filter(M=>M.status==="cancelled"||M.status==="rejected"),pt={all:Te.length,pending:Te.filter(M=>M.status==="pending").length,confirmed:Te.filter(M=>!M.status||M.status==="confirmed").length,completed:Te.filter(M=>M.status==="completed").length,cancelled:Te.filter(M=>M.status==="cancelled"||M.status==="rejected").length},Dt=[{key:"schedule",label:"Schedule",icon:Ct},{key:"clients",label:"Clients",icon:Ig},{key:"walkins",label:"Walk-ins",icon:W2},{key:"analytics",label:"Analytics",icon:U2},{key:"waitlist",label:"Waitlist",icon:hx},{key:"staff",label:"Staff",icon:Ft},{key:"services",label:"Services",icon:Tn},{key:"subscription",label:"Plan",icon:Fo},{key:"settings",label:"Settings",icon:Qh}];return a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>Z(!0),className:"lg:hidden p-2 -ml-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:a.jsx(z2,{className:"w-6 h-6"})}),a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(c.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{className:"hidden sm:block",children:[a.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:c.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),a.jsx("div",{className:"hidden lg:flex items-center bg-slate-100 p-1 rounded-xl",children:Dt.map(M=>{const G=M.icon,ue=M.key==="schedule"&&We>0?{count:We,color:"bg-amber-500"}:M.key==="clients"&&Xt>0?{count:Xt,color:"bg-orange-500"}:M.key==="walkins"&&It>0?{count:It,color:"bg-emerald-500"}:M.key==="waitlist"&&tt>0?{count:tt,color:"bg-blue-500"}:null;return a.jsxs("button",{onClick:()=>E(M.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${T===M.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(G,{className:"w-4 h-4"}),a.jsx("span",{children:M.label}),ue&&a.jsx("span",{className:`ml-1 px-1.5 py-0.5 ${ue.color} text-white text-[10px] font-bold rounded-full leading-none`,children:ue.count})]},M.key)})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(at,{to:`/shop/${e}`,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[a.jsx(ju,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"View Page"})]}),a.jsxs("button",{onClick:Fe,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",children:[a.jsx(Ef,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),z&&a.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>Z(!1)}),a.jsxs("div",{className:"fixed inset-y-0 left-0 w-72 bg-white shadow-2xl animate-slide-in-left",children:[a.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-slate-200",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm",children:(c.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-bold text-slate-900",children:c.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),a.jsx("button",{onClick:()=>Z(!1),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",children:a.jsx(Ds,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"p-3 space-y-1",children:Dt.map(M=>{const G=M.icon,ue=M.key==="schedule"&&We>0?{count:We,color:"bg-amber-500"}:M.key==="clients"&&Xt>0?{count:Xt,color:"bg-orange-500"}:M.key==="walkins"&&It>0?{count:It,color:"bg-emerald-500"}:M.key==="waitlist"&&tt>0?{count:tt,color:"bg-blue-500"}:null;return a.jsxs("button",{onClick:()=>{E(M.key),Z(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left font-medium transition-all ${T===M.key?"bg-blue-50 text-blue-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,children:[a.jsx(G,{className:`w-5 h-5 ${T===M.key?"text-blue-600":"text-slate-400"}`}),a.jsx("span",{className:"flex-1",children:M.label}),ue&&a.jsx("span",{className:`px-2 py-0.5 ${ue.color} text-white text-xs font-bold rounded-full`,children:ue.count})]},M.key)})}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 border-t border-slate-200 bg-slate-50",children:[a.jsxs(at,{to:`/shop/${e}`,onClick:()=>Z(!1),className:"flex items-center gap-3 px-4 py-3 text-slate-600 hover:bg-white rounded-xl font-medium transition-all",children:[a.jsx(ju,{className:"w-5 h-5 text-slate-400"}),"View Public Page"]}),a.jsxs("button",{onClick:()=>{Z(!1),Fe()},className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl font-medium transition-all",children:[a.jsx(Ef,{className:"w-5 h-5"}),"Logout"]})]})]})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[T==="schedule"&&a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8 animate-fade-in",children:[{label:"Today's Bookings",value:Ae.todayBookings,icon:e1,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:Ae.weekBookings,icon:$o,color:"bg-violet-100 text-violet-600"},{label:"Total Bookings",value:Ae.totalBookings,icon:Cg,color:"bg-emerald-100 text-emerald-600"},{label:"Unique Clients",value:Ae.uniqueClients,icon:Ft,color:"bg-amber-100 text-amber-600"}].map(M=>{const G=M.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${M.color} rounded-xl flex items-center justify-center`,children:a.jsx(G,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:M.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:M.label})]},M.label)})}),T==="clients"&&a.jsx(k9,{shopId:m,bookings:V,shop:c,slug:e}),T==="walkins"&&a.jsx(E9,{shopId:m,services:H,staff:F,bookings:V}),T==="analytics"&&a.jsx(N9,{bookings:V}),T==="staff"&&a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:a.jsx(v9,{shopId:m,shop:c,slug:e})}),T==="services"&&a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:a.jsx(r9,{shopId:m})}),T==="subscription"&&a.jsx(I9,{shopId:m,shop:c,slug:e}),K&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(Eo,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Waitlist Match!"}),a.jsxs("p",{className:"text-sm text-slate-500",children:[K.matches.length," client",K.matches.length!==1?"s":""," on the waitlist match this freed slot"]})]})]}),a.jsx("div",{className:"bg-slate-50 rounded-xl p-3 mb-4 text-sm",children:a.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[a.jsx(Ct,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-medium",children:[new Date(K.slot.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})," at ",(()=>{const[M,G]=K.slot.time.split(":"),fe=parseInt(M);return`${fe%12||12}:${G} ${fe>=12?"PM":"AM"}`})()]})]})}),a.jsx("div",{className:"space-y-2 mb-5 max-h-48 overflow-y-auto",children:K.matches.map(M=>a.jsx("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-50 border border-blue-100 rounded-lg",children:a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:M.clientName}),a.jsx("span",{className:"text-xs text-slate-500 ml-2",children:M.serviceName})]})},M.id))}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>ne(K.matches,K.slot),className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:[a.jsx(Eo,{className:"w-4 h-4"}),"Notify All"]}),a.jsx("button",{onClick:()=>le(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Dismiss"})]})]})}),Ee&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center",children:a.jsx(Ti,{className:"w-5 h-5 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Cancel Recurring Booking"}),a.jsx("p",{className:"text-sm text-slate-500",children:"This booking is part of a recurring series"})]})]}),a.jsxs("div",{className:"space-y-2 mb-5",children:[a.jsxs("button",{onClick:()=>Ze(Ee.bookingId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(Ha,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this one only"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments stay active"})]})]}),a.jsxs("button",{onClick:()=>Et(Ee.bookingId,Ee.recurringGroupId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(Ti,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future in series"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments"})]})]})]}),a.jsx("button",{onClick:()=>ye(null),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Never mind"})]})}),T==="waitlist"&&a.jsx("div",{className:"animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-5",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Waitlist"}),tt>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:[tt," waiting"]})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[L.length," total"]})]}),L.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(hx,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No waitlist entries yet"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Clients can join the waitlist when no slots are available on your booking page."})]}):a.jsx("div",{children:(()=>{const M={};return L.forEach(G=>{const fe=G.serviceName||"Other";M[fe]||(M[fe]=[]),M[fe].push(G)}),Object.entries(M).sort(([G],[fe])=>G.localeCompare(fe)).map(([G,fe])=>a.jsxs("div",{className:"mb-6 last:mb-0",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100 flex items-center gap-2",children:[a.jsx(Tn,{className:"w-3.5 h-3.5 text-blue-500"}),G,a.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",fe.filter(ue=>ue.status==="waiting").length," waiting)"]})]}),a.jsx("div",{className:"space-y-2.5",children:fe.sort((ue,Ve)=>(ue.createdAt||"").localeCompare(Ve.createdAt||"")).map(ue=>{const Ve={waiting:"bg-blue-50 text-blue-700 border-blue-200",notified:"bg-emerald-50 text-emerald-700 border-emerald-200",booked:"bg-emerald-50 text-emerald-700 border-emerald-200",expired:"bg-slate-100 text-slate-500 border-slate-200"},et={waiting:"Waiting",notified:"Notified",booked:"Booked",expired:"Removed"},ft=ue.createdAt?(()=>{const vt=Date.now()-new Date(ue.createdAt).getTime(),Tt=Math.floor(vt/864e5),Os=Math.floor(vt/36e5);return Tt>0?`${Tt}d`:`${Os}h`})():"",Qe={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return a.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Sl,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:ue.clientName}),a.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Ve[ue.status]||Ve.waiting}`,children:et[ue.status]||"Waiting"})]}),a.jsxs("div",{className:"text-xs text-slate-500",children:["Joined ",ft," ago",ue.refCode&&a.jsx("span",{className:"font-mono text-slate-400 ml-2",children:ue.refCode})]})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[ue.status==="waiting"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>je(ue.id),className:"p-1.5 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-all",title:"Notify client",children:a.jsx(Eo,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Se(ue.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove from waitlist",children:a.jsx(Ds,{className:"w-4 h-4"})})]}),ue.status==="notified"&&a.jsx("button",{onClick:()=>Se(ue.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove",children:a.jsx(Ds,{className:"w-3.5 h-3.5"})})]})]}),a.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[ue.staffName&&ue.staffName!=="Any Available"&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ft,{className:"w-3 h-3 text-violet-400"}),a.jsx("span",{className:"text-violet-600",children:ue.staffName})]}),ue.preferredDate&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ct,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Preferred: ",new Date(ue.preferredDate+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]})]}),ue.preferredDays&&ue.preferredDays.length>0&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ct,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Days: ",ue.preferredDays.map(vt=>Qe[vt]||vt).join(", ")]})]}),ue.preferredTimeRange&&!(ue.preferredTimeRange.start==="00:00"&&ue.preferredTimeRange.end==="23:59")&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(os,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Time: ",xi(ue.preferredTimeRange.start),"",xi(ue.preferredTimeRange.end)]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Tf,{className:"w-3 h-3"}),ue.clientEmail]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(mx,{className:"w-3 h-3"}),ue.clientPhone]})]}),ue.status==="notified"&&ue.notifiedSlot&&a.jsxs("div",{className:"mt-1.5 px-2.5 py-1.5 bg-emerald-50 border border-emerald-200 rounded-lg inline-flex items-center gap-1.5",children:[a.jsx(Eo,{className:"w-3 h-3 text-emerald-500"}),a.jsxs("span",{className:"text-emerald-700 font-medium",children:["Notified about ",new Date(ue.notifiedSlot.date+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})," at ",xi(ue.notifiedSlot.time)]})]})]})]},ue.id)})})]},G))})()})]})}),T==="settings"&&a.jsxs("div",{className:"max-w-2xl animate-fade-in space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Settings"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure your booking preferences"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Require Booking Approval"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Review and approve bookings before they're confirmed"})]}),a.jsx("button",{type:"button",onClick:Ie,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${c?.requireApproval?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${c?.requireApproval?"translate-x-6":"translate-x-1"}`})})]}),c?.requireApproval&&a.jsxs("div",{className:"p-3.5 bg-amber-50 border border-amber-200 rounded-xl text-xs text-amber-800 leading-relaxed",children:[a.jsx("strong",{children:" Approval mode is on."}),' New bookings will appear as "Pending" until you approve or reject them. Time slots are held while pending to prevent double-booking.']}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Buffer Time Between Bookings"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Add a gap between consecutive appointments"})]}),a.jsxs("select",{value:c?.bufferMinutes||0,onChange:M=>Be(M.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"0",children:"No buffer"}),a.jsx("option",{value:"5",children:"5 minutes"}),a.jsx("option",{value:"10",children:"10 minutes"}),a.jsx("option",{value:"15",children:"15 minutes"}),a.jsx("option",{value:"30",children:"30 minutes"})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Retention"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure win-back alerts to re-engage inactive clients"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Enable Win-back Alerts"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Show alerts when clients haven't visited in a while"})]}),a.jsx("button",{type:"button",onClick:async()=>{const M=c?.winbackSettings||{},G=M.enabled===!1;try{await Ye(Oe(pe,"shops",m),{winbackSettings:{...M,enabled:G}}),d(fe=>({...fe,winbackSettings:{...fe.winbackSettings||{},enabled:G}}))}catch(fe){console.error("Error updating winback settings:",fe)}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${c?.winbackSettings?.enabled!==!1?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${c?.winbackSettings?.enabled!==!1?"translate-x-6":"translate-x-1"}`})})]}),c?.winbackSettings?.enabled!==!1&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Getting Cold Threshold"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "Getting Cold" after this many days without a booking'})]}),a.jsxs("select",{value:c?.winbackSettings?.warningDays||30,onChange:async M=>{const G=parseInt(M.target.value),fe=c?.winbackSettings||{};try{await Ye(Oe(pe,"shops",m),{winbackSettings:{...fe,warningDays:G}}),d(ue=>({...ue,winbackSettings:{...ue.winbackSettings||{},warningDays:G}}))}catch(ue){console.error("Error updating warning days:",ue)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"14",children:"14 days"}),a.jsx("option",{value:"21",children:"21 days"}),a.jsx("option",{value:"30",children:"30 days"}),a.jsx("option",{value:"45",children:"45 days"}),a.jsx("option",{value:"60",children:"60 days"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"At Risk Threshold"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "At Risk" after this many days without a booking'})]}),a.jsxs("select",{value:c?.winbackSettings?.inactiveDays||60,onChange:async M=>{const G=parseInt(M.target.value),fe=c?.winbackSettings||{};try{await Ye(Oe(pe,"shops",m),{winbackSettings:{...fe,inactiveDays:G}}),d(ue=>({...ue,winbackSettings:{...ue.winbackSettings||{},inactiveDays:G}}))}catch(ue){console.error("Error updating inactive days:",ue)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"30",children:"30 days"}),a.jsx("option",{value:"45",children:"45 days"}),a.jsx("option",{value:"60",children:"60 days"}),a.jsx("option",{value:"90",children:"90 days"}),a.jsx("option",{value:"120",children:"120 days"})]})]}),a.jsxs("div",{className:"p-3.5 bg-orange-50 border border-orange-200 rounded-xl text-xs text-orange-800 leading-relaxed",children:[a.jsx("strong",{children:" Tip:"}),' Clients flagged as "Lost" (over 90 days) will also appear in win-back alerts. Visit the ',a.jsx("strong",{children:"Clients"})," tab to view at-risk clients and send win-back messages."]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-1 flex items-center gap-2",children:[a.jsx(F2,{className:"w-5 h-5 text-violet-500"}),"Branding"]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Customize how your booking page looks to customers"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Shop Logo"}),a.jsxs("div",{className:"flex items-center gap-4",children:[c?.logoUrl?a.jsx("img",{src:c.logoUrl,alt:"Shop logo",className:"w-20 h-20 rounded-xl object-cover border-2 border-slate-200"}):a.jsx("div",{className:"w-20 h-20 rounded-xl bg-slate-100 border-2 border-dashed border-slate-300 flex items-center justify-center",children:a.jsx(lm,{className:"w-8 h-8 text-slate-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("label",{className:"relative cursor-pointer",children:[a.jsx("input",{type:"file",accept:"image/*",onChange:xe,className:"hidden",disabled:ce}),a.jsxs("span",{className:`inline-flex items-center gap-2 px-4 py-2.5 rounded-xl font-medium text-sm transition-all ${ce?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-blue-50 text-blue-600 hover:bg-blue-100"}`,children:[a.jsx(YM,{className:"w-4 h-4"}),ce?"Uploading...":c?.logoUrl?"Change Logo":"Upload Logo"]})]}),a.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Recommended: Square image, at least 200x200px. Max 2MB."})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Brand Color"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("input",{type:"color",value:c?.brandColor||"#3B82F6",onChange:M=>qe(M.target.value),className:"w-12 h-12 rounded-xl cursor-pointer border-2 border-slate-200"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm text-slate-600",children:"Used for buttons and accents on your booking page"}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("span",{className:"text-xs text-slate-500",children:"Preview:"}),a.jsx("button",{className:"px-4 py-1.5 rounded-lg text-white text-sm font-medium",style:{backgroundColor:c?.brandColor||"#3B82F6"},children:"Book Now"})]})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Tagline"}),a.jsx("input",{type:"text",value:c?.tagline||"",onChange:M=>Le(M.target.value),placeholder:"e.g., Your neighborhood barbershop since 2010",maxLength:100,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Appears below your shop name on the booking page (max 100 chars)"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-1 flex items-center gap-2",children:[a.jsx(px,{className:"w-5 h-5 text-amber-500"}),"Review Requests"]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Automatically ask clients to leave reviews after their appointment"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Enable Review Requests"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Send an email asking for reviews after completed appointments"})]}),a.jsx("button",{type:"button",onClick:async()=>{const M=c?.reviewSettings||{},G=!M.enabled;try{await Ye(Oe(pe,"shops",m),{reviewSettings:{...M,enabled:G}}),d(fe=>({...fe,reviewSettings:{...fe.reviewSettings||{},enabled:G}}))}catch(fe){console.error("Error updating review settings:",fe)}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${c?.reviewSettings?.enabled?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${c?.reviewSettings?.enabled?"translate-x-6":"translate-x-1"}`})})]}),c?.reviewSettings?.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Send After"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"How long after the appointment to send the review request"})]}),a.jsxs("select",{value:c?.reviewSettings?.delayHours||2,onChange:async M=>{const G=parseInt(M.target.value),fe=c?.reviewSettings||{};try{await Ye(Oe(pe,"shops",m),{reviewSettings:{...fe,delayHours:G}}),d(ue=>({...ue,reviewSettings:{...ue.reviewSettings||{},delayHours:G}}))}catch(ue){console.error("Error updating delay hours:",ue)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"1",children:"1 hour"}),a.jsx("option",{value:"2",children:"2 hours"}),a.jsx("option",{value:"4",children:"4 hours"}),a.jsx("option",{value:"24",children:"24 hours"}),a.jsx("option",{value:"48",children:"48 hours"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Google Place ID"}),a.jsx("input",{type:"text",value:c?.reviewSettings?.googlePlaceId||"",onChange:async M=>{const G=M.target.value,fe=c?.reviewSettings||{};try{await Ye(Oe(pe,"shops",m),{reviewSettings:{...fe,googlePlaceId:G}}),d(ue=>({...ue,reviewSettings:{...ue.reviewSettings||{},googlePlaceId:G}}))}catch(ue){console.error("Error updating Google Place ID:",ue)}},placeholder:"e.g., ChIJN1t_tDeuEmsRUsoyG83frY4",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),a.jsx("p",{className:"text-xs text-slate-500",children:a.jsxs("a",{href:"https://developers.google.com/maps/documentation/places/web-service/place-id",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["How to find your Place ID ",a.jsx(Za,{className:"w-3 h-3"})]})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("h3",{className:"font-semibold text-slate-900 text-sm",children:["Yelp Business ID ",a.jsx("span",{className:"text-slate-400 font-normal",children:"(optional)"})]}),a.jsx("input",{type:"text",value:c?.reviewSettings?.yelpBusinessId||"",onChange:async M=>{const G=M.target.value,fe=c?.reviewSettings||{};try{await Ye(Oe(pe,"shops",m),{reviewSettings:{...fe,yelpBusinessId:G}}),d(ue=>({...ue,reviewSettings:{...ue.reviewSettings||{},yelpBusinessId:G}}))}catch(ue){console.error("Error updating Yelp Business ID:",ue)}},placeholder:"e.g., joes-barbershop-new-york",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Found in your Yelp business page URL: yelp.com/biz/",a.jsx("strong",{children:"your-business-id"})]})]}),(c?.reviewSettings?.googlePlaceId||c?.reviewSettings?.yelpBusinessId)&&a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsx("p",{className:"text-sm font-medium text-amber-800 mb-2",children:" Review links will go to:"}),a.jsxs("div",{className:"space-y-1 text-sm",children:[c?.reviewSettings?.googlePlaceId&&a.jsxs("a",{href:`https://search.google.com/local/writereview?placeid=${c.reviewSettings.googlePlaceId}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:["Google Reviews ",a.jsx(Za,{className:"w-3 h-3"})]}),c?.reviewSettings?.yelpBusinessId&&a.jsxs("a",{href:`https://www.yelp.com/writeareview/biz/${c.reviewSettings.yelpBusinessId}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:["Yelp Reviews ",a.jsx(Za,{className:"w-3 h-3"})]})]})]})]})]})]}),a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:a.jsx(D9,{shopId:m,shop:c,slug:e})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Visibility"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Temporarily hide your shop from public view"}),c?.archived?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Nu,{className:"w-5 h-5 text-amber-600"}),a.jsx("span",{className:"font-semibold text-amber-800",children:"Shop is Archived"})]}),a.jsx("p",{className:"text-sm text-amber-700",children:"Your shop is currently hidden from the public booking page. You can still access your dashboard to view history."})]}),a.jsxs("button",{onClick:async()=>{try{await Ye(Oe(pe,"shops",m),{archived:!1,archivedAt:null}),d(M=>({...M,archived:!1,archivedAt:null}))}catch(M){console.error("Error unarchiving shop:",M)}},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-emerald-600/20 transition-all",children:[a.jsx(Nu,{className:"w-4 h-4"}),"Unarchive Shop"]})]}):a.jsxs("button",{onClick:async()=>{if(window.confirm("Are you sure you want to archive your shop? It will be hidden from the public booking page."))try{await Ye(Oe(pe,"shops",m),{archived:!0,archivedAt:kr()}),d(M=>({...M,archived:!0,archivedAt:new Date().toISOString()}))}catch(M){console.error("Error archiving shop:",M)}},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-amber-500 hover:bg-amber-600 text-white rounded-xl font-semibold text-sm shadow-md shadow-amber-500/20 transition-all",children:[a.jsx(Nu,{className:"w-4 h-4"}),"Archive Shop"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-3",children:"Archiving hides your shop but preserves all data. You can unarchive at any time."})]}),a.jsxs("div",{className:"bg-white rounded-xl border-2 border-red-200 p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(ia,{className:"w-5 h-5 text-red-500"}),a.jsx("h2",{className:"text-lg font-bold text-red-600",children:"Danger Zone"})]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Irreversible actions that will permanently affect your shop"}),a.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl mb-4",children:[a.jsx("h3",{className:"font-semibold text-red-800 mb-2",children:"Delete Shop Permanently"}),a.jsxs("p",{className:"text-sm text-red-700 mb-3",children:["This will permanently delete your shop, all staff, bookings, time slots, and settings.",a.jsx("strong",{children:" This cannot be undone."})]}),a.jsxs("button",{onClick:()=>{const M=new Date().toISOString().split("T")[0],G=V.filter(ue=>ue.date>=M&&(ue.status==="pending"||ue.status==="confirmed"||!ue.status));if(G.length>0){alert(`Cannot delete shop: You have ${G.length} upcoming booking${G.length!==1?"s":""}. Please cancel or complete all upcoming bookings before deleting your shop.`);return}const fe=window.prompt(`To delete your shop, type "${c.name}" below:

 WARNING: This will permanently delete:
 Your shop and all settings
 All staff members
 All bookings (past and future)
 All time slots
 All waitlist entries
 All schedule presets`);fe===c.name?(async()=>{try{const Ve=["staff","bookings","availability","waitlist","schedulePresets","services","walkins","clientNotes"];for(const et of Ve){const ft=await Ls(Xe(pe,"shops",m,et));for(const Qe of ft.docs)await Io(Oe(pe,"shops",m,et,Qe.id))}await Io(Oe(pe,"shops",m)),await of(wa),t("/",{replace:!0})}catch(Ve){console.error("Error deleting shop:",Ve),alert("An error occurred while deleting the shop. Please try again.")}})():fe!==null&&alert("Shop name did not match. Deletion cancelled.")},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-red-600/20 transition-all",children:[a.jsx(ya,{className:"w-4 h-4"}),"Delete Shop Forever"]})]})]})]}),T==="schedule"&&a.jsxs("div",{className:"animate-fade-in",children:[F.length>0&&a.jsx("div",{className:"flex flex-wrap gap-4 mb-6",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5",children:"Filter by Staff"}),a.jsxs("select",{value:k,onChange:M=>O(M.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[a.jsx("option",{value:"all",children:"All Staff"}),F.map(M=>a.jsxs("option",{value:M.id,children:[M.name,M.role?`  ${M.role}`:""]},M.id))]})]})}),J.length>0&&a.jsxs("div",{className:"mb-6 bg-violet-50 border border-violet-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Lu,{className:"w-4 h-4 text-violet-600"}),a.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Recurring Weekly Hours"})]}),a.jsx("div",{className:"space-y-2.5",children:J.map(M=>{const G=_1.filter(fe=>M.weeklyHours[fe.key]?.enabled);return a.jsxs("div",{className:"flex items-start gap-2.5",children:[a.jsx("div",{className:"w-7 h-7 bg-violet-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(Ft,{className:"w-3.5 h-3.5 text-violet-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-900 text-sm",children:M.name}),a.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:G.map(fe=>{const ue=M.weeklyHours[fe.key];return a.jsxs("span",{className:"inline-block px-2 py-0.5 bg-white text-violet-700 border border-violet-200 rounded text-xs font-medium",children:[fe.short," ",xi(ue.start),"",xi(ue.end),ue.break&&a.jsxs("span",{className:"text-amber-600 ml-1",children:["(break ",xi(ue.break.start),"",xi(ue.break.end),")"]})]},fe.key)})})]})]},M.id)})}),a.jsx("p",{className:"text-xs text-violet-500 mt-3",children:"Slots auto-generate on the booking page. Manage hours in the Staff tab."})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Monthly Overview"}),a.jsx(s9,{slotsByDate:Cn,bookingsByDate:ln,selectedDate:S,onSelectDate:I,recurringDayFlags:Ge,breaksByDate:He}),S&&a.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[a.jsxs("span",{className:"text-sm text-slate-600",children:["Showing: ",a.jsx("strong",{className:"text-slate-900",children:new Date(S+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),a.jsx("button",{onClick:()=>I(null),className:"text-xs px-3 py-1 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-medium transition-all border border-slate-200",children:"Show All"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:J.length>0?"Add Custom Slots":"Create Time Slots"}),J.length>0&&a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Use this for one-off availability outside regular hours."}),!J.length&&a.jsx("div",{className:"mb-4"}),a.jsxs("form",{onSubmit:Rt,className:"space-y-4",children:[F.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Staff Member"}),a.jsxs("select",{value:de.staffId,onChange:M=>Ce({...de,staffId:M.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"Select a staff member"}),F.map(M=>a.jsxs("option",{value:M.id,children:[M.name,M.role?`  ${M.role}`:""]},M.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Date"}),a.jsx("input",{type:"date",value:de.date,onChange:M=>Ce({...de,date:M.target.value}),required:!0,min:new Date().toISOString().split("T")[0],className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Start"}),a.jsx("input",{type:"time",value:de.startTime,onChange:M=>Ce({...de,startTime:M.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"End"}),a.jsx("input",{type:"time",value:de.endTime,onChange:M=>Ce({...de,endTime:M.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Slot Duration"}),(()=>{const[M,G]=de.startTime.split(":").map(Number),[fe,ue]=de.endTime.split(":").map(Number),Ve=fe*60+ue-(M*60+G),et=[{value:"15",label:"15 minutes"},{value:"30",label:"30 minutes"},{value:"45",label:"45 minutes"},{value:"60",label:"1 hour"},{value:"90",label:"1.5 hours"},{value:"120",label:"2 hours"}].filter(ft=>parseInt(ft.value)<=Ve);return a.jsx("select",{value:de.slotDuration,onChange:ft=>Ce({...de,slotDuration:ft.target.value}),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:et.length>0?et.map(ft=>a.jsx("option",{value:ft.value,children:ft.label},ft.value)):a.jsx("option",{value:"15",children:"15 minutes"})})})()]}),a.jsxs("button",{type:"submit",className:"w-full flex items-center justify-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(tr,{className:"w-4 h-4"}),"Generate Slots"]})]}),a.jsxs("div",{className:"mt-4 p-3.5 bg-blue-50 border border-blue-100 rounded-xl text-xs text-slate-600 leading-relaxed",children:[a.jsx("strong",{className:"text-slate-700",children:" Tip:"})," ",J.length>0?"Weekly hours auto-generate slots. Use this for one-off slots outside regular hours.":F.length>0?"Select a staff member, pick a date, and set working hours to create slots.":"Set your hours and slot duration. We'll create all the time slots for that day."]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:S?"Bookings":"All Bookings"}),pt.pending>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 border border-amber-200 text-xs font-bold rounded-full",children:[pt.pending," pending"]})]}),a.jsx("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:ot.length})]}),a.jsx("div",{className:"flex items-center gap-1 mb-4 p-1 bg-slate-100 rounded-lg overflow-x-auto",children:[{key:"all",label:"All"},{key:"pending",label:"Pending"},{key:"confirmed",label:"Confirmed"},{key:"completed",label:"Completed"},{key:"cancelled",label:"Cancelled"}].map(M=>a.jsxs("button",{onClick:()=>$(M.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-semibold transition-all whitespace-nowrap ${C===M.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[M.label,a.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${C===M.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:pt[M.key]})]},M.key))}),ot.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(e1,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium",children:C!=="all"?`No ${C} bookings`:S?"No bookings for this date":"No bookings yet"})]}):a.jsx("div",{className:"space-y-2.5 max-h-[500px] overflow-y-auto pr-1",children:ot.sort((M,G)=>`${M.date}${M.time}`.localeCompare(`${G.date}${G.time}`)).map(M=>{const G=M.status||"confirmed",fe={pending:"bg-amber-50 text-amber-700 border-amber-200",confirmed:"bg-emerald-50 text-emerald-700 border-emerald-200",completed:"bg-blue-50 text-blue-700 border-blue-200",rejected:"bg-red-50 text-red-700 border-red-200",cancelled:"bg-slate-100 text-slate-500 border-slate-200"},ue={pending:"Pending",confirmed:"Confirmed",completed:"Completed",rejected:"Rejected",cancelled:"Cancelled"};return a.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Sl,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:M.clientName}),a.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${fe[G]}`,children:ue[G]}),M.recurring&&a.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",title:"Recurring appointment",children:a.jsx(Ti,{className:"w-2.5 h-2.5"})})]}),a.jsx("div",{className:"text-xs text-slate-500",children:De(M.date,M.time)})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[G==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>Bs(M.id),className:"p-1.5 text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50 rounded-lg transition-all",title:"Approve booking",children:a.jsx(Js,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Mt(M.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Reject booking",children:a.jsx(Ha,{className:"w-4 h-4"})})]}),G==="confirmed"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>xt(M.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50 rounded-lg transition-all",title:"Mark as completed",children:a.jsx(Js,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>$e(M.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Cancel booking",children:a.jsx(ya,{className:"w-3.5 h-3.5"})})]})]})]}),a.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[M.serviceName&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Tn,{className:"w-3 h-3 text-blue-400"}),a.jsx("span",{className:"font-medium text-slate-700",children:M.serviceName}),M.servicePrice!=null&&a.jsxs("span",{className:"text-blue-600 font-semibold",children:["$",Number(M.servicePrice).toFixed(2)]})]}),M.staffName&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ft,{className:"w-3 h-3 text-violet-400"}),a.jsx("span",{className:"text-violet-600",children:M.staffName})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Tf,{className:"w-3 h-3"}),M.clientEmail]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(mx,{className:"w-3 h-3"}),M.clientPhone]})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[M.refCode&&a.jsxs("span",{className:"font-mono text-[10px] text-slate-400",children:["REF: ",M.refCode]}),M.recurring&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-indigo-50 border border-indigo-200 rounded text-[10px] font-semibold text-indigo-600",children:" Recurring"})]})]})]},M.id)})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:S?"Custom Time Slots":"All Custom Time Slots"}),a.jsx("span",{className:"text-xs font-semibold text-slate-500 bg-slate-100 px-2.5 py-1 rounded-lg",children:S?(Cn[S]||[]).length:rn.length})]}),J.length>0&&a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Recurring slots from weekly hours auto-generate  not shown here."}),!J.length&&a.jsx("div",{className:"mb-4"}),_e.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Ct,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:S?"No custom slots for this date":"No custom slots yet"}),a.jsx("p",{className:"text-xs text-slate-400",children:J.length>0?"Recurring hours handle most scheduling.":"Use the form above to generate availability."})]}):a.jsx("div",{className:"space-y-6",children:_e.map(M=>a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100",children:new Date(M).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-2.5",children:Cn[M].sort((G,fe)=>G.time.localeCompare(fe.time)).map(G=>a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-3.5 text-center group hover:border-slate-300 transition-all",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900 mb-0.5",children:xi(G.time)}),a.jsxs("div",{className:"text-xs text-slate-500 mb-1",children:[G.duration," min"]}),G.staffName&&a.jsxs("div",{className:"text-xs text-violet-600 mb-1.5 flex items-center justify-center gap-1",children:[a.jsx(Ft,{className:"w-3 h-3"}),G.staffName]}),a.jsx("div",{className:"mb-2",children:G.available?a.jsx("span",{className:"inline-block px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-md text-xs font-medium",children:"Available"}):a.jsx("span",{className:"inline-block px-2 py-0.5 bg-red-50 text-red-700 border border-red-200 rounded-md text-xs font-medium",children:"Booked"})}),G.available&&a.jsxs("button",{onClick:()=>it(G.id),className:"opacity-0 group-hover:opacity-100 flex items-center justify-center gap-1 w-full px-2 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-xs font-medium transition-all border border-red-200",children:[a.jsx(ya,{className:"w-3 h-3"}),"Remove"]})]},G.id))})]},M))})]})]})]})]})}function V9({user:n}){const{slug:e}=Wo(),t=Oi(),[i,o]=j.useState(""),[c,d]=j.useState(""),[m,x]=j.useState(""),[g,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;(async()=>{const R=Fn(Xe(pe,"shops"),jn("slug","==",e)),B=await Ls(R);B.empty||B.docs[0].data().ownerUid===n.uid&&t(`/shop/${e}/dashboard`,{replace:!0})})()},[n,e,t]);const w=async _=>{_.preventDefault(),x(""),b(!0);try{const B=(await Vx(wa,i,c)).user,V=Fn(Xe(pe,"shops"),jn("slug","==",e)),U=await Ls(V);if(U.empty){x("Shop not found"),b(!1);return}if(U.docs[0].data().ownerUid!==B.uid){x("You are not the owner of this shop"),await wa.signOut(),b(!1);return}t(`/shop/${e}/dashboard`,{replace:!0})}catch(R){switch(R.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":x("Invalid email or password");break;case"auth/invalid-email":x("Please enter a valid email address");break;case"auth/too-many-requests":x("Too many failed attempts. Please try again later.");break;default:x("Login failed. Please try again.")}d("")}finally{b(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(Na,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),a.jsxs("form",{onSubmit:w,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:i,onChange:_=>{o(_.target.value),x("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:c,onChange:_=>{d(_.target.value),x("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${m?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),m&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",m]})]}),a.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):"Sign In"})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",a.jsx(at,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(at,{to:`/shop/${e}`,className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(ba,{className:"w-3.5 h-3.5"}),"Back to booking page"]})})]})})}function S1({name:n,className:e="w-12 h-12",bgClass:t="bg-blue-100 text-blue-700"}){const i=(n||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return a.jsx("div",{className:`${e} ${t} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function E1(){return a.jsxs(at,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(Na,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function U9(){const{slug:n,refCode:e}=Wo(),[t,i]=j.useState(null),[o,c]=j.useState(null),[d,m]=j.useState(!0),[x,g]=j.useState(!1),[b,w]=j.useState(null),[_,R]=j.useState(null),[B,V]=j.useState(!1),[U,F]=j.useState([]),[Q,H]=j.useState([]),[re,he]=j.useState([]),[W,T]=j.useState([]),[E,S]=j.useState(!1),[I,k]=j.useState(!1),[O,C]=j.useState(null),[$,L]=j.useState(null),[P,K]=j.useState(null),[le,Ee]=j.useState(!1),[ye,z]=j.useState("");j.useEffect(()=>{(async()=>{m(!0);try{const Be=Fn(Xe(pe,"shops"),jn("slug","==",n)),xe=await Ls(Be);if(xe.empty)g(!0);else{const qe=xe.docs[0];i(qe.data()),c(qe.id)}}catch(Be){console.error("Error looking up shop:",Be),g(!0)}finally{m(!1)}})()},[n]),j.useEffect(()=>{if(!o)return;(async()=>{try{const Be=Fn(Xe(pe,"shops",o,"bookings"),jn("refCode","==",e.toUpperCase())),xe=await Ls(Be);if(xe.empty)V(!0);else{const qe=xe.docs[0];w(qe.data()),R(qe.id)}}catch(Be){console.error("Error looking up booking:",Be),V(!0)}})()},[o,e]),j.useEffect(()=>{if(!o||!b)return;const Ie=ss(Xe(pe,"shops",o,"bookings"),Le=>{F(Le.docs.map(De=>({id:De.id,...De.data()})))}),Be=ss(Xe(pe,"shops",o,"availability"),Le=>{const De=new Date,Ge=Le.docs.map(He=>({id:He.id,...He.data()})).filter(He=>new Date(`${He.date}T${He.time}`)>De);H(Ge)}),xe=ss(Xe(pe,"shops",o,"staff"),Le=>{he(Le.docs.map(De=>({id:De.id,...De.data()})).filter(De=>De.active!==!1).sort((De,Ge)=>(De.name||"").localeCompare(Ge.name||"")))}),qe=ss(Xe(pe,"shops",o,"services"),Le=>{T(Le.docs.map(De=>({id:De.id,...De.data()})).filter(De=>De.active!==!1))});return()=>{Ie(),Be(),xe(),qe()}},[o,b]);const Z=t?.bufferMinutes||0,ce=j.useMemo(()=>{if(!b)return null;if(b.serviceId){const Ie=W.find(Be=>Be.id===b.serviceId);if(Ie)return Ie}return b.serviceName?{id:b.serviceId,name:b.serviceName,price:b.servicePrice,duration:b.serviceDuration||b.duration}:null},[b,W]),ge=j.useMemo(()=>{if(!E||!b)return[];const Ie=new Date,Be=ce?.duration||b.duration||60;let xe=Q.filter(He=>He.available);xe=xe.filter(He=>He.duration>=Be),b.staffId&&(xe=xe.filter(He=>He.staffId===b.staffId||!He.staffId));const qe=b.staffId?re.filter(He=>He.id===b.staffId):re,Le=lS(qe,Be,Z,4).filter(He=>new Date(`${He.date}T${He.time}`)>Ie),De=cS(Le,xe),Ge=U.filter(He=>He.id!==_);return oS(De,Ge,Z)},[E,b,_,Q,re,U,Z,ce]),de=j.useMemo(()=>[...new Set(ge.map(Ie=>Ie.date))].sort(),[ge]),Ce=j.useMemo(()=>$?ge.filter(Ie=>Ie.date===$):[],[$,ge]),Fe=async(Ie="single")=>{Ee(!0);try{if(await Ye(Oe(pe,"shops",o,"bookings",_),{status:"cancelled"}),b.slotId&&!b.slotId.startsWith("wh-")&&!b.slotId.startsWith("recurring-"))try{await Ye(Oe(pe,"shops",o,"availability",b.slotId),{available:!0})}catch(Be){console.warn("Could not re-open slot:",Be)}if(Ie==="future"&&b.recurringGroupId){const Be=U.filter(xe=>xe.recurringGroupId===b.recurringGroupId&&xe.id!==_&&xe.date>=b.date&&(xe.status==="pending"||xe.status==="confirmed"));for(const xe of Be)if(await Ye(Oe(pe,"shops",o,"bookings",xe.id),{status:"cancelled"}),xe.slotId&&!xe.slotId.startsWith("wh-")&&!xe.slotId.startsWith("recurring-"))try{await Ye(Oe(pe,"shops",o,"availability",xe.slotId),{available:!0})}catch(qe){console.warn("Could not re-open slot:",qe)}}w(Be=>({...Be,status:"cancelled"})),k(!1),C(null),z("cancelled")}catch(Be){console.error("Cancel error:",Be),z("error")}finally{Ee(!1)}},Rt=async()=>{if(P){Ee(!0);try{const Ie={date:P.date,time:P.time,slotId:P.id};if(P.staffId&&(Ie.staffId=P.staffId,Ie.staffName=P.staffName||""),t?.requireApproval&&(Ie.status="pending"),b.slotId&&!b.slotId.startsWith("wh-"))try{await Ye(Oe(pe,"shops",o,"availability",b.slotId),{available:!0})}catch(Be){console.warn("Could not re-open old slot:",Be)}if(!P.generated&&P.id)try{await Ye(Oe(pe,"shops",o,"availability",P.id),{available:!1})}catch(Be){console.warn("Could not block new slot:",Be)}await Ye(Oe(pe,"shops",o,"bookings",_),Ie),w(Be=>({...Be,...Ie})),S(!1),L(null),K(null),z("rescheduled")}catch(Ie){console.error("Reschedule error:",Ie),z("error")}finally{Ee(!1)}}},it=Ie=>new Date(Ie+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),Bt=Ie=>{const[Be,xe]=Ie.split(":"),qe=parseInt(Be),Le=qe>=12?"PM":"AM";return`${qe%12||12}:${xe} ${Le}`},ne=Ie=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(Ie),je=Ie=>{if(!Ie)return"";if(Ie<60)return`${Ie} min`;const Be=Math.floor(Ie/60),xe=Ie%60;return xe?`${Be}h ${xe}m`:`${Be} hour${Be>1?"s":""}`};if(d)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(x)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Ct,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(ba,{className:"w-4 h-4"}),"Go Home"]})]})});if(B)return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),a.jsx(E1,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(ia,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Not Found"}),a.jsx("p",{className:"text-slate-600 mb-2",children:"No booking found with reference code"}),a.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Ct,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking"})]})});const Se=b.status||"confirmed",$e=Se==="pending"||Se==="confirmed",Ze=Se==="cancelled",Et=Se==="rejected",Bs={pending:{label:"Pending Approval",color:"bg-amber-100 text-amber-700 border-amber-200",icon:os},confirmed:{label:"Confirmed",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Vs},cancelled:{label:"Cancelled",color:"bg-slate-100 text-slate-500 border-slate-200",icon:Ha},rejected:{label:"Rejected",color:"bg-red-100 text-red-700 border-red-200",icon:Ha}},Mt=Bs[Se]||Bs.confirmed,xt=Mt.icon;return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),a.jsx(E1,{})]})}),a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[ye==="rescheduled"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx($2,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Rescheduled!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:t?.requireApproval?"Your booking has been rescheduled and is pending approval.":"Your booking has been successfully rescheduled."}),a.jsx("button",{onClick:()=>z(""),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View updated details "})]})}),ye==="cancelled"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Ha,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Cancelled"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking has been cancelled."}),a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[a.jsx(Ct,{className:"w-4 h-4"}),"Book a new appointment"]})]})}),ye==="error"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Something went wrong. Please try again."})]})}),!E&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Your Booking"}),a.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference: ",a.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),(Ze||Et)&&a.jsxs("div",{className:`mb-4 p-4 rounded-xl border flex items-center gap-3 ${Ze?"bg-slate-50 border-slate-200":"bg-red-50 border-red-200"}`,children:[a.jsx(xt,{className:`w-5 h-5 ${Ze?"text-slate-400":"text-red-500"}`}),a.jsx("span",{className:`font-medium text-sm ${Ze?"text-slate-600":"text-red-700"}`,children:Ze?"This booking has been cancelled.":"This booking has been rejected by the shop."})]}),b.recurringGroupId&&a.jsxs("div",{className:"mb-4 p-3.5 bg-blue-50 border border-blue-200 rounded-xl flex items-center gap-2.5",children:[a.jsx(Ti,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Part of a recurring series"}),b.recurringInterval&&a.jsxs("p",{className:"text-xs text-blue-600 mt-0.5",children:["Repeats every ",b.recurringInterval==="weekly"?"week":b.recurringInterval==="biweekly"?"2 weeks":b.recurringInterval==="fourweekly"?"4 weeks":b.recurringInterval==="monthly"?"month":b.recurringInterval]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${Mt.color}`,children:[a.jsx(xt,{className:"w-3.5 h-3.5"}),Mt.label]})]}),b.serviceName&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Tn,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.servicePrice!=null&&a.jsx("span",{className:"font-bold text-blue-600",children:ne(b.servicePrice)})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(S1,{name:b.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Ct,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[it(b.date)," at ",Bt(b.time)]})]}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(os,{className:"w-4 h-4 text-slate-500"})}),a.jsx("span",{children:je(b.serviceDuration||b.duration)})]})]}),$e&&!ye&&a.jsx("div",{className:"space-y-3",children:I?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(ia,{className:"w-5 h-5 text-red-500"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-slate-900",children:"Are you sure?"}),a.jsx("p",{className:"text-sm text-slate-600",children:"This action cannot be undone."})]})]}),b.recurringGroupId&&!O&&a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsxs("button",{onClick:()=>C("single"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(Ha,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this appointment only"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments in the series remain active"})]})]}),a.jsxs("button",{onClick:()=>C("future"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(Ti,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future appointments"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments in the series"})]})]}),a.jsx("button",{onClick:()=>k(!1),className:"w-full px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Go Back"})]}),(!b.recurringGroupId||O)&&a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>Fe(O||"single"),disabled:le,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold transition-all disabled:opacity-50",children:[le?a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}):a.jsx(Ha,{className:"w-4 h-4"}),le?"Cancelling":O==="future"?"Cancel All Future":"Yes, Cancel"]}),a.jsx("button",{onClick:()=>{O?C(null):k(!1)},disabled:le,className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Go Back"})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{S(!0),z("")},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(Lu,{className:"w-4 h-4"}),"Reschedule Booking"]}),a.jsxs("button",{onClick:()=>{k(!0),C(null)},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-white hover:bg-red-50 text-red-600 rounded-xl font-semibold border border-red-200 hover:border-red-300 transition-all",children:[a.jsx(Ha,{className:"w-4 h-4"}),"Cancel Booking"]})]})}),(Ze||Et)&&a.jsx("div",{className:"text-center",children:a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(Ct,{className:"w-4 h-4"}),"Book Again"]})})]}),E&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:()=>{S(!1),L(null),K(null)},className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(ba,{className:"w-3.5 h-3.5"}),"Back to Booking"]}),b.serviceName&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Tn,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName}),b.servicePrice!=null&&a.jsx("span",{className:"text-blue-600 font-bold",children:ne(b.servicePrice)})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[a.jsx(S1,{name:b.staffName,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a New Time"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Pick a new date and time for your appointment"})]}),de.length===0?a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(Ct,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),a.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"No time slots are currently available. Check back soon!"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-8",children:a.jsx(Q2,{availableDates:de,selectedDate:$,onSelectDate:Ie=>{L(Ie),K(null)}})}),$&&a.jsxs("div",{className:"animate-slide-down",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",it($)]}),a.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[Ce.length," slot",Ce.length!==1?"s":""]})]}),Ce.length===0?a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:a.jsx("p",{className:"text-slate-500",children:"No slots available for this date"})}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:Ce.sort((Ie,Be)=>Ie.time.localeCompare(Be.time)).map(Ie=>{const Be=P?.id===Ie.id;return a.jsxs("button",{onClick:()=>K(Ie),className:`group border rounded-xl p-4 transition-all duration-200 text-center ${Be?"bg-blue-600 border-blue-600 text-white shadow-md shadow-blue-600/30":"bg-white border-slate-200 hover:border-blue-400 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5"}`,children:[a.jsx("div",{className:`text-lg font-bold mb-1 ${Be?"text-white":"text-slate-900 group-hover:text-blue-700"} transition-colors`,children:Bt(Ie.time)}),Ie.staffName&&a.jsxs("div",{className:`text-xs mb-0.5 flex items-center justify-center gap-1 ${Be?"text-blue-100":"text-violet-600"}`,children:[a.jsx(Ft,{className:"w-3 h-3"}),Ie.staffName]}),a.jsx("div",{className:`text-xs ${Be?"text-blue-200":"text-slate-400"}`,children:je(b.serviceDuration||b.duration)})]},Ie.id)})}),P&&a.jsxs("div",{className:"mt-6 animate-fade-in",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-blue-200 shadow-sm p-5 mb-4",children:[a.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"New Appointment Time"}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm",children:[a.jsx(Ct,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[it(P.date)," at ",Bt(P.time)]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:Rt,disabled:le,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed",children:le?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Rescheduling"]}):a.jsxs(a.Fragment,{children:[a.jsx(Vs,{className:"w-4 h-4"}),"Confirm Reschedule"]})}),a.jsx("button",{onClick:()=>K(null),className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]})]}),!$&&a.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]})]}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(at,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})})]})}function T1(){return a.jsxs(at,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(Na,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function B9(n){if(!n)return"Any time";const e=t=>{const[i,o]=t.split(":").map(Number),c=i>=12?"PM":"AM",d=i%12||12;return o===0?`${d}${c}`:`${d}:${o.toString().padStart(2,"0")}${c}`};return n.start==="00:00"&&n.end==="23:59"?"Any time":`${e(n.start)}  ${e(n.end)}`}function z9(n){if(!n||n.length===0)return"Any day";const e={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return n.map(t=>e[t]||t).join(", ")}function F9(n){if(!n)return"";const e=new Date,t=new Date(n),i=e-t,o=Math.floor(i/6e4);if(o<60)return`${o}m ago`;const c=Math.floor(o/60);return c<24?`${c}h ago`:`${Math.floor(c/24)}d ago`}function $9(){const{slug:n,refCode:e}=Wo(),[t,i]=j.useState(null),[o,c]=j.useState(null),[d,m]=j.useState(!0),[x,g]=j.useState(!1),[b,w]=j.useState(null),[_,R]=j.useState(!1),[B,V]=j.useState(null);if(j.useEffect(()=>{(async()=>{m(!0);try{const W=Fn(Xe(pe,"shops"),jn("slug","==",n)),T=await Ls(W);if(T.empty)g(!0);else{const E=T.docs[0];i(E.data()),c(E.id)}}catch(W){console.error("Error looking up shop:",W),g(!0)}finally{m(!1)}})()},[n]),j.useEffect(()=>{if(!o)return;(async()=>{try{const W=Fn(Xe(pe,"shops",o,"waitlist"),jn("refCode","==",e.toUpperCase())),T=await Ls(W);if(T.empty){R(!0);return}const E=T.docs[0],S={id:E.id,...E.data()};w(S);const I=Fn(Xe(pe,"shops",o,"waitlist"),jn("serviceId","==",S.serviceId),jn("status","==","waiting")),C=(await Ls(I)).docs.map($=>({id:$.id,...$.data()})).sort(($,L)=>($.createdAt||"").localeCompare(L.createdAt||"")).findIndex($=>$.id===S.id);C>=0&&V(C+1)}catch(W){console.error("Error looking up waitlist entry:",W),R(!0)}})()},[o,e]),d)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(x)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Ct,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(ba,{className:"w-4 h-4"}),"Go Home"]})]})});if(_)return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),a.jsx(T1,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(ia,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Waitlist Entry Not Found"}),a.jsx("p",{className:"text-slate-600 mb-2",children:"No waitlist entry found with reference code"}),a.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Ct,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading waitlist"})]})});const U={waiting:{label:"Waiting",color:"bg-blue-100 text-blue-700 border-blue-200",icon:os},notified:{label:"Slot Available!",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Eo},booked:{label:"Booked",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Vs},expired:{label:"Expired",color:"bg-slate-100 text-slate-500 border-slate-200",icon:os}},F=U[b.status]||U.waiting,Q=F.icon,H=he=>he?new Date(he+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):"",re=he=>{if(!he)return"";const[W,T]=he.split(":"),E=parseInt(W),S=E>=12?"PM":"AM";return`${E%12||12}:${T} ${S}`};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),a.jsx(T1,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[b.status==="notified"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Eo,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"A Slot Is Available!"}),a.jsxs("p",{className:"text-slate-600 mb-4",children:["A slot has opened up for ",b.serviceName,". Book now before it's taken!"]}),b.notifiedSlot&&a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-xl text-sm text-emerald-700 font-medium mb-4",children:[a.jsx(Ct,{className:"w-4 h-4"}),H(b.notifiedSlot.date)," at"," ",re(b.notifiedSlot.time),b.notifiedSlot.staffName&&a.jsxs("span",{className:"text-emerald-600",children:[" ","with ",b.notifiedSlot.staffName]})]}),a.jsx("div",{children:a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-emerald-600/20 hover:shadow-lg",children:[a.jsx(Ct,{className:"w-4 h-4"}),"Book Now "]})})]})}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Waitlist Status"}),a.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference:"," ",a.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${F.color}`,children:[a.jsx(Q,{className:"w-3.5 h-3.5"}),F.label]})]}),b.status==="waiting"&&B!=null&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Position"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(hx,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-bold text-slate-900 text-lg",children:["#",B]}),a.jsx("span",{className:"text-sm text-slate-500",children:"in line"})]})]}),b.serviceName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Tn,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center",children:a.jsx(Ft,{className:"w-4 h-4 text-violet-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),b.preferredDate&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Ct,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Preferred: ",H(b.preferredDate)]})]}),b.preferredDays&&b.preferredDays.length>0&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Ct,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Days: ",z9(b.preferredDays)]})]}),b.preferredTimeRange&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(os,{className:"w-4 h-4 text-slate-500"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Time: ",B9(b.preferredTimeRange)]})]}),b.createdAt&&a.jsxs("div",{className:"pt-2 border-t border-slate-100 text-xs text-slate-400",children:["Joined ",F9(b.createdAt)]})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(Ct,{className:"w-4 h-4"}),b.status==="notified"?"Book Now":"Check Available Slots"]})})]})}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(at,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})})]})}function q9(){return a.jsxs(at,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(Na,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function A1(n){if(n==null)return"";if(n<1)return"Next up!";if(n<60)return`~${n} min`;const e=Math.floor(n/60),t=n%60;return t>0?`~${e}h ${t}m`:`~${e}h`}function H9(){const{slug:n}=Wo(),[e,t]=j.useState(null),[i,o]=j.useState(null),[c,d]=j.useState(!0),[m,x]=j.useState(!1),[g,b]=j.useState([]),[w,_]=j.useState([]),[R,B]=j.useState([]),[V,U]=j.useState(!1),[F,Q]=j.useState(!1),[H,re]=j.useState(!1),[he,W]=j.useState(""),[T,E]=j.useState(0),[S,I]=j.useState({clientName:"",serviceId:""}),[k,O]=j.useState(Date.now());j.useEffect(()=>{const ye=setInterval(()=>O(Date.now()),3e4);return()=>clearInterval(ye)},[]),j.useEffect(()=>{(async()=>{d(!0);try{const z=Fn(Xe(pe,"shops"),jn("slug","==",n)),Z=await Ls(z);if(Z.empty)x(!0);else{const ce=Z.docs[0];t(ce.data()),o(ce.id)}}catch(z){console.error("Error looking up shop:",z),x(!0)}finally{d(!1)}})()},[n]),j.useEffect(()=>{if(!i)return;const ye=ss(Xe(pe,"shops",i,"walkins"),ce=>{const ge=ce.docs.map(de=>({id:de.id,...de.data()}));b(ge)}),z=ss(Xe(pe,"shops",i,"staff"),ce=>{const ge=ce.docs.map(de=>({id:de.id,...de.data()})).filter(de=>de.active!==!1);_(ge)}),Z=ss(Xe(pe,"shops",i,"services"),ce=>{const ge=ce.docs.map(de=>({id:de.id,...de.data()})).filter(de=>de.active!==!1).sort((de,Ce)=>(de.name||"").localeCompare(Ce.name||""));B(ge)});return()=>{ye(),z(),Z()}},[i]);const C=j.useMemo(()=>g.filter(ye=>ye.status==="waiting").sort((ye,z)=>(ye.position||0)-(z.position||0)),[g]),$=j.useMemo(()=>g.filter(ye=>ye.status==="in-progress"),[g]),L=j.useMemo(()=>Math.max(w.length,1),[w]),P=j.useMemo(()=>hS({waitingQueue:C,inProgress:$,staffCount:L,defaultDuration:30}),[C,$,L]),K=j.useMemo(()=>dS({waitingAhead:C,inProgress:$,staffCount:L,defaultDuration:30}),[C,$,L]),le=j.useMemo(()=>{const ye=new Date;return ye.setHours(0,0,0,0),g.filter(z=>{const Z=z.joinedAt?.toDate?.()||(z.joinedAt?new Date(z.joinedAt):null);return Z&&Z>=ye}).length},[g]),Ee=async ye=>{ye.preventDefault(),Q(!0);const z=R.find(de=>de.id===S.serviceId),ce=(C.length>0?Math.max(...C.map(de=>de.position||0)):0)+1,ge=S.clientName.trim()||`Walk-in #${le+1}`;try{await Sa(Xe(pe,"shops",i,"walkins"),{clientName:ge,serviceId:S.serviceId||null,serviceName:z?.name||null,staffId:null,staffName:null,estimatedDuration:z?.duration||30,status:"waiting",position:ce,joinedAt:zt.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),W(ge),E(ce),re(!0),U(!1),I({clientName:"",serviceId:""})}catch(de){console.error("Error joining queue:",de)}finally{Q(!1)}};return c?a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):m?a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Ct,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(ba,{className:"w-4 h-4"}),"Go Home"]})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Live Queue"})]})]}),a.jsx(q9,{})]})}),a.jsxs("div",{className:"max-w-2xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[H&&a.jsxs("div",{className:"mb-6 bg-emerald-50 border border-emerald-200 rounded-2xl p-6 text-center animate-scale-in",children:[a.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(Ft,{className:"w-7 h-7 text-emerald-600"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"You're in the queue!"}),a.jsxs("p",{className:"text-slate-600 text-sm mb-2",children:[a.jsx("strong",{children:he}),"  Position #",T]}),a.jsx("button",{onClick:()=>re(!1),className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"Dismiss"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Ft,{className:"w-6 h-6 text-blue-600"})}),a.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:C.length}),a.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"People Waiting"})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Y2,{className:"w-6 h-6 text-amber-600"})}),a.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:A1(K)}),a.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"Est. Wait (New)"})]})]}),$.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(Scissors,{className:"w-5 h-5 text-emerald-500"}),"Currently Being Served"]}),a.jsx("div",{className:"space-y-2",children:$.map(ye=>a.jsxs("div",{className:"bg-white rounded-xl border border-emerald-200 p-4 flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:a.jsx(Scissors,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-slate-900",children:ye.clientName}),a.jsx("div",{className:"text-xs text-slate-500",children:ye.serviceName||"Service in progress"})]})]},ye.id))})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(os,{className:"w-5 h-5 text-blue-500"}),"Queue"]}),C.length===0?a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-10 text-center",children:[a.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Ft,{className:"w-7 h-7 text-emerald-500"})}),a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"No Wait!"}),a.jsx("p",{className:"text-sm text-slate-500",children:"The queue is empty  you can walk right in!"})]}):a.jsx("div",{className:"space-y-2",children:C.map((ye,z)=>{const Z=P.get(ye.id);return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4 flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center font-extrabold text-blue-700 text-lg flex-shrink-0",children:z+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-semibold text-slate-900 text-lg truncate",children:ye.clientName}),ye.serviceName&&a.jsxs("div",{className:"text-sm text-slate-500 flex items-center gap-1",children:[a.jsx(Tn,{className:"w-3 h-3"}),ye.serviceName]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsx("div",{className:"text-lg font-bold text-amber-600",children:A1(Z)}),a.jsx("div",{className:"text-xs text-slate-400",children:"est. wait"})]})]},ye.id)})})]}),!H&&a.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:V?a.jsxs("form",{onSubmit:Ee,children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Join the Queue"}),a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Your Name"}),a.jsx("input",{type:"text",value:S.clientName,onChange:ye=>I(z=>({...z,clientName:ye.target.value})),placeholder:"Optional",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg"})]}),R.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Service"}),a.jsxs("select",{value:S.serviceId,onChange:ye=>I(z=>({...z,serviceId:ye.target.value})),className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg",children:[a.jsx("option",{value:"",children:"Select a service"}),R.map(ye=>a.jsxs("option",{value:ye.id,children:[ye.name," (",ye.duration,"min  $",Number(ye.price).toFixed(2),")"]},ye.id))]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{type:"submit",disabled:F,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[a.jsx(tr,{className:"w-5 h-5"}),F?"Joining":"Join Queue"]}),a.jsx("button",{type:"button",onClick:()=>{U(!1),I({clientName:"",serviceId:""})},className:"px-6 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]}):a.jsxs("button",{onClick:()=>U(!0),className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[a.jsx(tr,{className:"w-5 h-5"}),"Join the Queue"]})})]}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-between",children:[a.jsxs(at,{to:`/shop/${n}`,className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[a.jsx(Ct,{className:"w-4 h-4"}),"Book Online"]}),a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(at,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})]})})]})}const G9="type.googleapis.com/google.protobuf.Int64Value",Y9="type.googleapis.com/google.protobuf.UInt64Value";function fS(n,e){const t={};for(const i in n)n.hasOwnProperty(i)&&(t[i]=e(n[i]));return t}function kf(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>kf(e));if(typeof n=="function"||typeof n=="object")return fS(n,e=>kf(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Ho(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case G9:case Y9:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Ho(e)):typeof n=="function"||typeof n=="object"?fS(n,e=>Ho(e)):n}const Mg="functions";const k1={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Sn extends Ta{constructor(e,t,i){super(`${Mg}/${e}`,t||""),this.details=i,Object.setPrototypeOf(this,Sn.prototype)}}function W9(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Cf(n,e){let t=W9(n),i=t,o;try{const c=e&&e.error;if(c){const d=c.status;if(typeof d=="string"){if(!k1[d])return new Sn("internal","internal");t=k1[d],i=d}const m=c.message;typeof m=="string"&&(i=m),o=c.details,o!==void 0&&(o=Ho(o))}}catch{}return t==="ok"?null:new Sn(t,i,o)}class Q9{constructor(e,t,i,o){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,wn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=i.getImmediate({optional:!0}),this.auth||t.get().then(c=>this.auth=c,()=>{}),this.messaging||i.get().then(c=>this.messaging=c,()=>{}),this.appCheck||o?.get().then(c=>this.appCheck=c,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),i=await this.getMessagingToken(),o=await this.getAppCheckToken(e);return{authToken:t,messagingToken:i,appCheckToken:o}}}const yx="us-central1",K9=/^data: (.*?)(?:\n|$)/;function X9(n){let e=null;return{promise:new Promise((t,i)=>{e=setTimeout(()=>{i(new Sn("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class J9{constructor(e,t,i,o,c=yx,d=(...m)=>fetch(...m)){this.app=e,this.fetchImpl=d,this.emulatorOrigin=null,this.contextProvider=new Q9(e,t,i,o),this.cancelAllRequests=new Promise(m=>{this.deleteService=()=>Promise.resolve(m())});try{const m=new URL(c);this.customDomain=m.origin+(m.pathname==="/"?"":m.pathname),this.region=yx}catch{this.customDomain=null,this.region=c}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function Z9(n,e,t){const i=sr(e);n.emulatorOrigin=`http${i?"s":""}://${e}:${t}`,i&&(Mf(n.emulatorOrigin+"/backends"),Of("Functions",!0))}function eP(n,e,t){const i=o=>sP(n,e,o,{});return i.stream=(o,c)=>aP(n,e,o,c),i}function mS(n){return n.emulatorOrigin&&sr(n.emulatorOrigin)?"include":void 0}async function tP(n,e,t,i,o){t["Content-Type"]="application/json";let c;try{c=await i(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:mS(o)})}catch{return{status:0,json:null}}let d=null;try{d=await c.json()}catch{}return{status:c.status,json:d}}async function pS(n,e){const t={},i=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return i.authToken&&(t.Authorization="Bearer "+i.authToken),i.messagingToken&&(t["Firebase-Instance-ID-Token"]=i.messagingToken),i.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=i.appCheckToken),t}function sP(n,e,t,i){const o=n._url(e);return nP(n,o,t,i)}async function nP(n,e,t,i){t=kf(t);const o={data:t},c=await pS(n,i),d=i.timeout||7e4,m=X9(d),x=await Promise.race([tP(e,o,c,n.fetchImpl,n),m.promise,n.cancelAllRequests]);if(m.cancel(),!x)throw new Sn("cancelled","Firebase Functions instance was deleted.");const g=Cf(x.status,x.json);if(g)throw g;if(!x.json)throw new Sn("internal","Response is not valid JSON object.");let b=x.json.data;if(typeof b>"u"&&(b=x.json.result),typeof b>"u")throw new Sn("internal","Response is missing data field.");return{data:Ho(b)}}function aP(n,e,t,i){const o=n._url(e);return rP(n,o,t,i||{})}async function rP(n,e,t,i){t=kf(t);const o={data:t},c=await pS(n,i);c["Content-Type"]="application/json",c.Accept="text/event-stream";let d;try{d=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(o),headers:c,signal:i?.signal,credentials:mS(n)})}catch(_){if(_ instanceof Error&&_.name==="AbortError"){const B=new Sn("cancelled","Request was cancelled.");return{data:Promise.reject(B),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(B)}}}}}}const R=Cf(0,null);return{data:Promise.reject(R),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(R)}}}}}}let m,x;const g=new Promise((_,R)=>{m=_,x=R});i?.signal?.addEventListener("abort",()=>{const _=new Sn("cancelled","Request was cancelled.");x(_)});const b=d.body.getReader(),w=iP(b,m,x,i?.signal);return{stream:{[Symbol.asyncIterator](){const _=w.getReader();return{async next(){const{value:R,done:B}=await _.read();return{value:R,done:B}},async return(){return await _.cancel(),{done:!0,value:void 0}}}}},data:g}}function iP(n,e,t,i){const o=(d,m)=>{const x=d.match(K9);if(!x)return;const g=x[1];try{const b=JSON.parse(g);if("result"in b){e(Ho(b.result));return}if("message"in b){m.enqueue(Ho(b.message));return}if("error"in b){const w=Cf(0,b);m.error(w),t(w);return}}catch(b){if(b instanceof Sn){m.error(b),t(b);return}}},c=new TextDecoder;return new ReadableStream({start(d){let m="";return x();async function x(){if(i?.aborted){const g=new Sn("cancelled","Request was cancelled");return d.error(g),t(g),Promise.resolve()}try{const{value:g,done:b}=await n.read();if(b){m.trim()&&o(m.trim(),d),d.close();return}if(i?.aborted){const _=new Sn("cancelled","Request was cancelled");d.error(_),t(_),await n.cancel();return}m+=c.decode(g,{stream:!0});const w=m.split(`
`);m=w.pop()||"";for(const _ of w)_.trim()&&o(_.trim(),d);return x()}catch(g){const b=g instanceof Sn?g:Cf(0,null);d.error(b),t(b)}}},cancel(){return n.cancel()}})}const C1="@firebase/functions",R1="0.13.1";const lP="auth-internal",oP="app-check-internal",cP="messaging-internal";function uP(n){const e=(t,{instanceIdentifier:i})=>{const o=t.getProvider("app").getImmediate(),c=t.getProvider(lP),d=t.getProvider(cP),m=t.getProvider(oP);return new J9(o,c,d,m,i)};Ai(new Rr(Mg,e,"PUBLIC").setMultipleInstances(!0)),la(C1,R1,n),la(C1,R1,"esm2020")}function dP(n=Pf(),e=yx){const i=Fu(ns(n),Mg).getImmediate({identifier:e}),o=kx("functions");return o&&hP(i,...o),i}function hP(n,e,t){Z9(ns(n),e,t)}function fP(n,e,t){return eP(ns(n),e)}uP();const mP=dP(),pP=["aaron.sharp2011@gmail.com"],lu={free:0,pro:29,unlimited:79},fl={free:{label:"Free",color:"bg-slate-100 text-slate-700 border-slate-200"},pro:{label:"Pro",color:"bg-blue-100 text-blue-700 border-blue-200"},unlimited:{label:"Unlimited",color:"bg-violet-100 text-violet-700 border-violet-200"}};function xP({user:n}){const e=Oi(),[t,i]=Q1(),[o,c]=j.useState(!0),[d,m]=j.useState([]),[x,g]=j.useState([]),b=["overview","shops","users","revenue","support"],w=t.get("tab"),_=b.includes(w)?w:"overview",R=J=>{i({tab:J})},[B,V]=j.useState(""),[U,F]=j.useState(null),[Q,H]=j.useState(null),[re,he]=j.useState(null),[W,T]=j.useState(""),[E,S]=j.useState({}),[I,k]=j.useState(!1),[O,C]=j.useState(null),[$,L]=j.useState(!0),[P,K]=j.useState(!1),[le,Ee]=j.useState(""),[ye,z]=j.useState(""),[Z,ce]=j.useState(""),[ge,de]=j.useState(""),[Ce,Fe]=j.useState(!1),[Rt,it]=j.useState(!1),Bt=n&&pP.includes(n.email?.toLowerCase());j.useEffect(()=>{!n||!Bt||ne()},[n,Bt]);const ne=async()=>{c(!0);try{const Ae=(await Ls(Xe(pe,"shops"))).docs.map(It=>({id:It.id,...It.data()}));m(Ae);const tt=(await Ls(Xe(pe,"users"))).docs.map(It=>({id:It.id,...It.data()}));g(tt)}catch(J){console.error("Error fetching admin data:",J)}finally{c(!1)}},je=async()=>{await of(wa),e("/",{replace:!0})},Se=j.useMemo(()=>{const J={free:0,pro:0,unlimited:0};let Ae=0,We=0;d.forEach(gt=>{const hs=gt.subscriptionTier||"free";J[hs]=(J[hs]||0)+1,gt.stripeConnectAccountId&&(gt.stripeConnectComplete?Ae++:We++)});const tt=J.pro*lu.pro+J.unlimited*lu.unlimited,It=new Date;It.setDate(It.getDate()-30);const rs=d.filter(gt=>gt.createdAt?(gt.createdAt.toDate?gt.createdAt.toDate():new Date(gt.createdAt))>It:!1);return{totalShops:d.length,tierCounts:J,mrr:tt,stripeConnectedCount:Ae,stripePendingCount:We,recentShops:rs.length}},[d]),$e=j.useMemo(()=>{if(!B.trim())return d;const J=B.toLowerCase();return d.filter(Ae=>Ae.name?.toLowerCase().includes(J)||Ae.slug?.toLowerCase().includes(J)||Ae.ownerEmail?.toLowerCase().includes(J))},[d,B]),Ze=j.useMemo(()=>[...$e].sort((J,Ae)=>{const We=J.createdAt?.toDate?J.createdAt.toDate():new Date(J.createdAt||0);return(Ae.createdAt?.toDate?Ae.createdAt.toDate():new Date(Ae.createdAt||0))-We}),[$e]),Et=async(J,Ae)=>{H(J);try{await Ye(Oe(pe,"shops",J),{subscriptionTier:Ae}),m(We=>We.map(tt=>tt.id===J?{...tt,subscriptionTier:Ae}:tt))}catch(We){console.error("Error changing tier:",We)}finally{H(null)}},Bs=async(J,Ae)=>{H(J);try{await Ye(Oe(pe,"shops",J),{disabled:!Ae}),m(We=>We.map(tt=>tt.id===J?{...tt,disabled:!Ae}:tt))}catch(We){console.error("Error toggling shop status:",We)}finally{H(null)}},Mt=async(J,Ae)=>{H(J);try{await Ye(Oe(pe,"shops",J),{archived:!Ae,archivedAt:Ae?null:kr()}),m(We=>We.map(tt=>tt.id===J?{...tt,archived:!Ae,archivedAt:Ae?null:new Date().toISOString()}:tt)),U?.id===J&&F(We=>({...We,archived:!Ae}))}catch(We){console.error("Error toggling shop archive status:",We)}finally{H(null)}},xt=async J=>{try{const Ae=await Ls(Xe(pe,"shops",J,"bookings")),We=new Date().toISOString().split("T")[0],tt=Ae.docs.filter(It=>{const rs=It.data();return rs.date>=We&&(rs.status==="pending"||rs.status==="confirmed"||!rs.status)});return S(It=>({...It,[J]:tt.length})),tt.length}catch(Ae){return console.error("Error checking bookings:",Ae),0}},Ie=async J=>{H(J);try{const Ae=["staff","bookings","availability","waitlist","schedulePresets","services","walkins","clientNotes"];for(const We of Ae){const tt=await Ls(Xe(pe,"shops",J,We));for(const It of tt.docs)await Io(Oe(pe,"shops",J,We,It.id))}await Io(Oe(pe,"shops",J)),m(We=>We.filter(tt=>tt.id!==J)),F(null),he(null),T(""),k(!1)}catch(Ae){console.error("Error deleting shop:",Ae),alert("An error occurred while deleting the shop. Please try again.")}finally{H(null)}},Be=async J=>{K(!0);try{const We=await fP(mP,"adminDeleteUser")({userId:J,deleteShops:$});if(We.data.success){if(g(tt=>tt.filter(It=>It.id!==J)),$&&We.data.shopsDeleted>0){const tt=await Ls(Xe(pe,"shops"));m(tt.docs.map(It=>({id:It.id,...It.data()})))}C(null),L(!0),alert(`User deleted successfully. ${We.data.shopsDeleted} shop(s) deleted.`)}}catch(Ae){console.error("Error deleting user:",Ae),alert(Ae.message||"Failed to delete user")}finally{K(!1)}},xe=J=>d.filter(Ae=>Ae.ownerId===J),qe=j.useMemo(()=>{if(!le)return x;const J=le.toLowerCase();return x.filter(Ae=>Ae.email?.toLowerCase().includes(J)||Ae.displayName?.toLowerCase().includes(J)||Ae.id.toLowerCase().includes(J))},[x,le]),Le=J=>J?(J.toDate?J.toDate():new Date(J)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",De=J=>J.stripeConnectAccountId?J.stripeConnectComplete?{label:"Connected",color:"bg-emerald-100 text-emerald-700",icon:Vs}:{label:"Pending",color:"bg-amber-100 text-amber-700",icon:os}:{label:"None",color:"bg-slate-100 text-slate-500",icon:null},Ge=async J=>{J.preventDefault(),de(""),Fe(!0);try{await Vx(wa,ye,Z)}catch(Ae){console.error("Login error:",Ae),Ae.code==="auth/user-not-found"||Ae.code==="auth/wrong-password"||Ae.code==="auth/invalid-credential"?de("Invalid email or password"):Ae.code==="auth/invalid-email"?de("Invalid email address"):de(Ae.message)}finally{Fe(!1)}};if(!n)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-violet-600 to-purple-600 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-violet-600/30 mx-auto mb-4",children:a.jsx(Kh,{className:"w-8 h-8"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Admin Access"}),a.jsx("p",{className:"text-slate-500 text-sm",children:"Sign in with your admin credentials"})]}),a.jsxs("form",{onSubmit:Ge,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:ye,onChange:J=>z(J.target.value),placeholder:"admin@example.com",required:!0,className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:Z,onChange:J=>ce(J.target.value),placeholder:"",required:!0,className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),ge&&a.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-600",children:ge}),a.jsx("button",{type:"submit",disabled:Ce,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-violet-600 hover:bg-violet-700 disabled:bg-violet-400 text-white rounded-xl font-semibold transition-all shadow-lg shadow-violet-600/20",children:Ce?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Sign In"})]})]})});if(!Bt)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-6",children:a.jsx(ZN,{className:"w-8 h-8 text-red-600"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Access Denied"}),a.jsx("p",{className:"text-slate-500 mb-2",children:"You don't have permission to access the admin panel."}),a.jsxs("p",{className:"text-sm text-slate-400 mb-6",children:["Signed in as: ",n.email]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>of(wa),className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all",children:"Sign Out"}),a.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-5 py-3 bg-violet-600 hover:bg-violet-700 text-white rounded-xl font-semibold text-sm transition-all",children:"Go Home"})]})]})});if(o)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading admin panel"})]})});if(!Bt)return null;const He=[{key:"overview",label:"Overview",icon:U2},{key:"shops",label:"Shops",icon:Nr},{key:"users",label:"Users",icon:Ft},{key:"revenue",label:"Revenue",icon:Mo},{key:"support",label:"Support",icon:Qh}];return a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"h-14 sm:h-16 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[a.jsx("button",{onClick:()=>it(!0),className:"lg:hidden p-2 -ml-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:a.jsx(z2,{className:"w-6 h-6"})}),a.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-violet-600 to-purple-600 rounded-lg sm:rounded-xl flex items-center justify-center text-white shadow-md shadow-violet-600/20 flex-shrink-0",children:a.jsx(Kh,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h1",{className:"text-sm sm:text-base font-bold text-slate-900 leading-tight truncate",children:"Admin"}),a.jsx("p",{className:"text-xs text-slate-500 hidden sm:block",children:"Platform Management"})]})]}),a.jsx("div",{className:"hidden lg:flex items-center bg-slate-100 p-1 rounded-xl",children:He.map(J=>{const Ae=J.icon;return a.jsxs("button",{onClick:()=>R(J.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${_===J.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(Ae,{className:"w-4 h-4"}),a.jsx("span",{children:J.label})]},J.key)})}),a.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 flex-shrink-0",children:[a.jsxs("button",{onClick:ne,className:"flex items-center justify-center gap-1.5 p-2 sm:px-3.5 sm:py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all",title:"Refresh",children:[a.jsx(Lu,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),a.jsxs("button",{onClick:je,className:"flex items-center justify-center gap-1.5 p-2 sm:px-3.5 sm:py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",title:"Logout",children:[a.jsx(Ef,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),Rt&&a.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>it(!1)}),a.jsxs("div",{className:"fixed inset-y-0 left-0 w-72 bg-white shadow-2xl animate-slide-in-left",children:[a.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-slate-200",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-violet-600 to-purple-600 rounded-xl flex items-center justify-center text-white shadow-md",children:a.jsx(Kh,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-bold text-slate-900",children:"Admin Panel"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Platform Management"})]})]}),a.jsx("button",{onClick:()=>it(!1),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",children:a.jsx(Ds,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"p-3 space-y-1",children:He.map(J=>{const Ae=J.icon;return a.jsxs("button",{onClick:()=>{R(J.key),it(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left font-medium transition-all ${_===J.key?"bg-violet-50 text-violet-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,children:[a.jsx(Ae,{className:`w-5 h-5 ${_===J.key?"text-violet-600":"text-slate-400"}`}),a.jsx("span",{children:J.label})]},J.key)})}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 border-t border-slate-200 bg-slate-50",children:[a.jsxs("button",{onClick:()=>{it(!1),ne()},className:"w-full flex items-center gap-3 px-4 py-3 text-slate-600 hover:bg-white rounded-xl font-medium transition-all",children:[a.jsx(Lu,{className:"w-5 h-5 text-slate-400"}),"Refresh Data"]}),a.jsxs("button",{onClick:()=>{it(!1),je()},className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl font-medium transition-all",children:[a.jsx(Ef,{className:"w-5 h-5"}),"Logout"]})]})]})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[_==="overview"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(Nr,{className:"w-5 h-5 text-blue-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Se.totalShops}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Shops"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:a.jsx(Mo,{className:"w-5 h-5 text-emerald-600"})})}),a.jsxs("div",{className:"text-2xl font-extrabold text-slate-900",children:["$",Se.mrr]}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Monthly Recurring Revenue"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-violet-100 rounded-xl flex items-center justify-center",children:a.jsx(_n,{className:"w-5 h-5 text-violet-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Se.stripeConnectedCount}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Stripe Connected"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center",children:a.jsx($o,{className:"w-5 h-5 text-amber-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Se.recentShops}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"New (Last 30 Days)"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Fo,{className:"w-5 h-5 text-amber-500"}),"Subscription Tiers"]}),a.jsx("div",{className:"space-y-4",children:Object.entries(Se.tierCounts).map(([J,Ae])=>{const We=fl[J]||fl.free,tt=Se.totalShops>0?Math.round(Ae/Se.totalShops*100):0;return a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-24",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-bold border ${We.color}`,children:We.label})}),a.jsx("div",{className:"flex-1",children:a.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full transition-all ${J==="free"?"bg-slate-400":J==="pro"?"bg-blue-500":"bg-violet-500"}`,style:{width:`${tt}%`}})})}),a.jsxs("div",{className:"w-20 text-right",children:[a.jsx("span",{className:"text-sm font-bold text-slate-900",children:Ae}),a.jsxs("span",{className:"text-xs text-slate-500 ml-1",children:["(",tt,"%)"]})]})]},J)})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(_n,{className:"w-5 h-5 text-violet-500"}),"Payment Status"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Vs,{className:"w-5 h-5 text-emerald-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Stripe Connected"})]}),a.jsx("span",{className:"text-lg font-bold text-emerald-700",children:Se.stripeConnectedCount})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(os,{className:"w-5 h-5 text-amber-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Pending Setup"})]}),a.jsx("span",{className:"text-lg font-bold text-amber-700",children:Se.stripePendingCount})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Nr,{className:"w-5 h-5 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"No Payments"})]}),a.jsx("span",{className:"text-lg font-bold text-slate-700",children:Se.totalShops-Se.stripeConnectedCount-Se.stripePendingCount})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx($o,{className:"w-5 h-5 text-blue-500"}),"Recent Signups"]}),a.jsx("div",{className:"space-y-3",children:Ze.slice(0,5).map(J=>{const Ae=fl[J.subscriptionTier]||fl.free;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-xl border border-slate-200 hover:border-slate-300 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(Nr,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:J.name||"Unnamed Shop"}),a.jsx("div",{className:"text-xs text-slate-500",children:J.ownerEmail})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-bold border ${Ae.color}`,children:Ae.label}),a.jsx("span",{className:"text-xs text-slate-500",children:Le(J.createdAt)})]})]},J.id)})})]})]}),_==="shops"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-4 mb-6",children:a.jsxs("div",{className:"relative",children:[a.jsx(Yh,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by name, slug, or email...",value:B,onChange:J=>V(J.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Shops"}),a.jsxs("span",{className:"text-sm font-medium text-slate-500",children:[$e.length," shop",$e.length!==1?"s":""]})]}),a.jsxs("div",{className:"divide-y divide-slate-100",children:[Ze.map(J=>{const Ae=fl[J.subscriptionTier]||fl.free,We=De(J),tt=We.icon;return a.jsx("div",{className:`p-4 hover:bg-slate-50 transition-all ${J.disabled?"opacity-60":""}`,children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:(J.name||"S")[0].toUpperCase()}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:J.name||"Unnamed Shop"}),a.jsx("span",{className:`px-2 py-0.5 rounded-lg text-[10px] font-bold border ${Ae.color}`,children:Ae.label}),J.archived&&a.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold bg-amber-100 text-amber-700 border border-amber-200",children:"Archived"}),J.disabled&&a.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold bg-red-100 text-red-700 border border-red-200",children:"Disabled"})]}),a.jsxs("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:["/",J.slug,"  ",J.ownerEmail]}),a.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs",children:[a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-md ${We.color}`,children:[tt&&a.jsx(tt,{className:"w-3 h-3"}),"Stripe: ",We.label]}),a.jsxs("span",{className:"text-slate-400",children:["Created: ",Le(J.createdAt)]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(at,{to:`/shop/${J.slug}`,target:"_blank",className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"View public page",children:a.jsx(ju,{className:"w-4 h-4"})}),a.jsx(at,{to:`/shop/${J.slug}/dashboard`,target:"_blank",className:"p-2 text-slate-400 hover:text-violet-600 hover:bg-violet-50 rounded-lg transition-all",title:"View dashboard (impersonate)",children:a.jsx(Za,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>F(J),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",title:"Manage shop",children:a.jsx(Qh,{className:"w-4 h-4"})})]})]})},J.id)}),Ze.length===0&&a.jsxs("div",{className:"p-12 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Nr,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"No shops found"}),B&&a.jsx("button",{onClick:()=>V(""),className:"mt-2 text-sm text-violet-600 hover:underline",children:"Clear search"})]})]})]})]}),_==="revenue"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Mo,{className:"w-5 h-5 text-emerald-500"}),"MRR Breakdown"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-900",children:"Pro Plans"}),a.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[Se.tierCounts.pro," shops  $29/mo"]})]}),a.jsxs("span",{className:"text-lg font-bold text-blue-700",children:["$",Se.tierCounts.pro*lu.pro]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-violet-50 border border-violet-200 rounded-xl",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-900",children:"Unlimited Plans"}),a.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[Se.tierCounts.unlimited," shops  $79/mo"]})]}),a.jsxs("span",{className:"text-lg font-bold text-violet-700",children:["$",Se.tierCounts.unlimited*lu.unlimited]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsx("div",{children:a.jsx("span",{className:"font-bold text-slate-900",children:"Total MRR"})}),a.jsxs("span",{className:"text-2xl font-extrabold text-emerald-700",children:["$",Se.mrr]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(_n,{className:"w-5 h-5 text-violet-500"}),"Platform Fees"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(sM,{className:"w-4 h-4 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Free Tier"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"5% platform fee on deposit payments via Stripe Connect"})]}),a.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ec,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Pro & Unlimited"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"No platform fees  shops keep 100% of payments"})]})]}),a.jsx("div",{className:"mt-6 pt-4 border-t border-slate-200",children:a.jsxs("a",{href:"https://dashboard.stripe.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-violet-600 hover:bg-violet-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-violet-600/20 transition-all",children:[a.jsx(Za,{className:"w-4 h-4"}),"Open Stripe Dashboard"]})})]})]}),a.jsxs("div",{className:"mt-6 bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Nr,{className:"w-5 h-5 text-blue-500"}),"Stripe Connect Accounts"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-emerald-700",children:Se.stripeConnectedCount}),a.jsx("div",{className:"text-sm font-medium text-emerald-600 mt-1",children:"Fully Connected"})]}),a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-amber-700",children:Se.stripePendingCount}),a.jsx("div",{className:"text-sm font-medium text-amber-600 mt-1",children:"Pending Setup"})]}),a.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-slate-700",children:Se.totalShops-Se.stripeConnectedCount-Se.stripePendingCount}),a.jsx("div",{className:"text-sm font-medium text-slate-600 mt-1",children:"Not Started"})]})]})]})]}),_==="users"&&a.jsx("div",{className:"animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("div",{className:"flex items-center justify-between mb-6",children:a.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[a.jsx(Ft,{className:"w-5 h-5 text-violet-500"}),"All Users (",x.length,")"]})}),a.jsxs("div",{className:"relative mb-6",children:[a.jsx(Yh,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by email, name, or ID...",value:le,onChange:J=>Ee(J.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),a.jsx("div",{className:"space-y-3",children:qe.length===0?a.jsx("p",{className:"text-center text-slate-500 py-8",children:"No users found"}):qe.map(J=>{const Ae=xe(J.id);return a.jsx("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl hover:border-slate-300 transition-all",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-violet-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:(J.email?.[0]||"?").toUpperCase()}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-semibold text-slate-900 truncate",children:J.email||"No email"}),a.jsx("div",{className:"text-xs text-slate-500 font-mono truncate",children:J.id}),Ae.length>0&&a.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[a.jsx(Nr,{className:"w-3 h-3 text-blue-500"}),a.jsxs("span",{className:"text-xs text-blue-600",children:[Ae.length," shop",Ae.length>1?"s":""]})]})]})]}),a.jsxs("button",{onClick:()=>C(J),className:"px-3 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all flex items-center gap-1.5",children:[a.jsx(ya,{className:"w-3.5 h-3.5"}),"Delete"]})]})},J.id)})})]})}),_==="support"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Qh,{className:"w-5 h-5 text-violet-500"}),"Support Tools"]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Manage shops, impersonate dashboards, and take quick actions."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ju,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"View Dashboard"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Click the external link icon on any shop to view their dashboard. You must be logged in as an admin."})]}),a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Fo,{className:"w-4 h-4 text-amber-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Change Tier"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Click the settings icon on any shop to change their subscription tier or disable the account."})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Quick Shop Lookup"}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(Yh,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by name, slug, or email...",value:B,onChange:J=>V(J.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),B&&a.jsx("div",{className:"space-y-2",children:$e.slice(0,10).map(J=>a.jsxs("button",{onClick:()=>F(J),className:"w-full flex items-center justify-between p-3 bg-slate-50 hover:bg-slate-100 rounded-xl border border-slate-200 transition-all text-left",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Nr,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:J.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:["/",J.slug]})]})]}),a.jsx(V2,{className:"w-4 h-4 text-slate-400"})]},J.id))})]})]})]}),U&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl flex items-center justify-center text-white font-bold",children:(U.name||"S")[0].toUpperCase()}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:U.name}),a.jsxs("p",{className:"text-sm text-slate-500",children:["/",U.slug]})]})]}),a.jsx("button",{onClick:()=>F(null),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",children:a.jsx(Ds,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Tf,{className:"w-4 h-4 text-slate-400"}),a.jsx("span",{className:"text-slate-600",children:U.ownerEmail})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Ct,{className:"w-4 h-4 text-slate-400"}),a.jsxs("span",{className:"text-slate-600",children:["Created: ",Le(U.createdAt)]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(_n,{className:"w-4 h-4 text-slate-400"}),a.jsxs("span",{className:"text-slate-600",children:["Stripe: ",De(U).label,U.stripeConnectAccountId&&a.jsxs("span",{className:"ml-1 text-xs text-slate-400 font-mono",children:["(",U.stripeConnectAccountId,")"]})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2",children:"Subscription Tier"}),a.jsx("div",{className:"flex gap-2",children:["free","pro","unlimited"].map(J=>{const Ae=fl[J],We=(U.subscriptionTier||"free")===J;return a.jsxs("button",{onClick:()=>Et(U.id,J),disabled:Q===U.id,className:`flex-1 px-4 py-3 rounded-xl font-semibold text-sm transition-all border-2 ${We?J==="free"?"border-slate-400 bg-slate-100 text-slate-900":J==="pro"?"border-blue-500 bg-blue-50 text-blue-700":"border-violet-500 bg-violet-50 text-violet-700":"border-slate-200 bg-white text-slate-500 hover:border-slate-300"}`,children:[Ae.label,J!=="free"&&a.jsxs("span",{className:"block text-xs font-normal mt-0.5",children:["$",lu[J],"/mo"]})]},J)})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Quick Actions"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs(at,{to:`/shop/${U.slug}`,target:"_blank",className:"flex items-center justify-center gap-2 px-4 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-medium text-sm transition-all",children:[a.jsx(ju,{className:"w-4 h-4"}),"View Page"]}),a.jsxs(at,{to:`/shop/${U.slug}/dashboard`,target:"_blank",className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-xl font-medium text-sm transition-all",children:[a.jsx(Za,{className:"w-4 h-4"}),"Dashboard"]})]}),a.jsx("button",{onClick:()=>Bs(U.id,U.disabled),disabled:Q===U.id,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all ${U.disabled?"bg-emerald-100 hover:bg-emerald-200 text-emerald-700":"bg-red-100 hover:bg-red-200 text-red-700"}`,children:U.disabled?a.jsxs(a.Fragment,{children:[a.jsx(Vs,{className:"w-4 h-4"}),"Enable Shop"]}):a.jsxs(a.Fragment,{children:[a.jsx(ZN,{className:"w-4 h-4"}),"Disable Shop"]})}),a.jsxs("button",{onClick:()=>Mt(U.id,U.archived),disabled:Q===U.id,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all ${U.archived?"bg-emerald-100 hover:bg-emerald-200 text-emerald-700":"bg-amber-100 hover:bg-amber-200 text-amber-700"}`,children:[a.jsx(Nu,{className:"w-4 h-4"}),U.archived?"Unarchive Shop":"Archive Shop"]}),a.jsxs("div",{className:"pt-4 mt-4 border-t border-red-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(ia,{className:"w-4 h-4 text-red-500"}),a.jsx("span",{className:"text-xs font-bold text-red-600 uppercase tracking-wider",children:"Danger Zone"})]}),a.jsxs("button",{onClick:async()=>{await xt(U.id),he(U),T(""),k(!1)},disabled:Q===U.id,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-medium text-sm transition-all shadow-md shadow-red-600/20",children:[a.jsx(ya,{className:"w-4 h-4"}),"Delete Shop Forever"]})]})]})]})}),re&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(ia,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Delete Shop Permanently"}),a.jsxs("p",{className:"text-sm text-slate-500",children:["/",re.slug]})]})]}),E[re.id]>0&&a.jsxs("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ia,{className:"w-5 h-5 text-amber-600"}),a.jsxs("span",{className:"font-semibold text-amber-800",children:[E[re.id]," Upcoming Booking",E[re.id]!==1?"s":""]})]}),a.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"This shop has active bookings. Deleting it will cancel all bookings and notify no one."}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:I,onChange:J=>k(J.target.checked),className:"w-4 h-4 rounded border-amber-400 text-red-600 focus:ring-red-500"}),a.jsx("span",{className:"text-sm font-medium text-amber-800",children:"I understand and want to force delete anyway"})]})]}),a.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-xl",children:[a.jsx("p",{className:"text-sm text-red-700 mb-2",children:a.jsx("strong",{children:"This will permanently delete:"})}),a.jsxs("ul",{className:"text-sm text-red-600 space-y-1 ml-4 list-disc",children:[a.jsx("li",{children:"Shop and all settings"}),a.jsx("li",{children:"All staff members"}),a.jsx("li",{children:"All bookings (past and future)"}),a.jsx("li",{children:"All time slots and schedule presets"}),a.jsx("li",{children:"All waitlist entries"}),a.jsx("li",{children:"All client notes"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:['Type "',a.jsx("span",{className:"text-red-600",children:re.name}),'" to confirm:']}),a.jsx("input",{type:"text",value:W,onChange:J=>T(J.target.value),placeholder:"Enter shop name",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{he(null),T(""),k(!1)},className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all",children:"Cancel"}),a.jsx("button",{onClick:()=>Ie(re.id),disabled:W!==re.name||Q===re.id||E[re.id]>0&&!I,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 disabled:bg-slate-300 disabled:cursor-not-allowed text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-red-600/20",children:Q===re.id?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(ya,{className:"w-4 h-4"}),"Delete Forever"]})})]})]})}),O&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(ia,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Delete User Account"}),a.jsx("p",{className:"text-sm text-slate-500",children:O.email})]})]}),xe(O.id).length>0&&a.jsxs("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Nr,{className:"w-5 h-5 text-amber-600"}),a.jsxs("span",{className:"font-semibold text-amber-800",children:[xe(O.id).length," Shop",xe(O.id).length!==1?"s":""," Owned"]})]}),a.jsx("ul",{className:"text-sm text-amber-700 mb-3 space-y-1",children:xe(O.id).map(J=>a.jsxs("li",{children:[" ",J.name," (/",J.slug,")"]},J.id))}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:J=>L(J.target.checked),className:"w-4 h-4 rounded border-amber-400 text-red-600 focus:ring-red-500"}),a.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Also delete all shops owned by this user"})]})]}),a.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-xl",children:[a.jsx("p",{className:"text-sm text-red-700 mb-2",children:a.jsx("strong",{children:"This will permanently delete:"})}),a.jsxs("ul",{className:"text-sm text-red-600 space-y-1 ml-4 list-disc",children:[a.jsx("li",{children:"User's Firebase Auth account"}),a.jsx("li",{children:"User document in database"}),$&&a.jsx("li",{children:"All shops and their data (bookings, staff, etc.)"})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{C(null),L(!0)},disabled:P,className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:"Cancel"}),a.jsx("button",{onClick:()=>Be(O.id),disabled:P,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-red-600/20",children:P?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(ya,{className:"w-4 h-4"}),"Delete User"]})})]})]})})]})}function gP(){const[n,e]=j.useState(null),[t,i]=j.useState(!0);return j.useEffect(()=>{const o=xC(wa,c=>{e(c),i(!1)});return()=>o()},[]),t?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):a.jsx(S5,{children:a.jsxs(e5,{children:[a.jsx(na,{path:"/",element:a.jsx(eO,{})}),a.jsx(na,{path:"/register",element:a.jsx(sO,{})}),a.jsx(na,{path:"/login",element:a.jsx(nO,{user:n})}),a.jsx(na,{path:"/shop/:slug",element:a.jsx(t9,{})}),a.jsx(na,{path:"/shop/:slug/booking/:refCode",element:a.jsx(U9,{})}),a.jsx(na,{path:"/shop/:slug/waitlist/:refCode",element:a.jsx($9,{})}),a.jsx(na,{path:"/shop/:slug/queue",element:a.jsx(H9,{})}),a.jsx(na,{path:"/shop/:slug/login",element:a.jsx(V9,{user:n})}),a.jsx(na,{path:"/shop/:slug/dashboard",element:a.jsx(L9,{user:n})}),a.jsx(na,{path:"/admin",element:a.jsx(xP,{user:n})}),a.jsx(na,{path:"*",element:a.jsx(JT,{to:"/",replace:!0})})]})})}sT.createRoot(document.getElementById("root")).render(a.jsx(ts.StrictMode,{children:a.jsx(gP,{})}));
