(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();function Ax(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var f0={exports:{}},iu={};var uw;function uT(){if(uw)return iu;uw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var m in o)m!=="key"&&(c[m]=o[m])}else c=o;return o=c.ref,{$$typeof:n,type:i,key:d,ref:o!==void 0?o:null,props:c}}return iu.Fragment=e,iu.jsx=t,iu.jsxs=t,iu}var dw;function dT(){return dw||(dw=1,f0.exports=uT()),f0.exports}var a=dT(),m0={exports:{}},dt={};var hw;function hT(){if(hw)return dt;hw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function R(F){return F===null||typeof F!="object"?null:(F=_&&F[_]||F["@@iterator"],typeof F=="function"?F:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},L=Object.assign,O={};function z(F,J,de){this.props=F,this.context=J,this.refs=O,this.updater=de||B}z.prototype.isReactComponent={},z.prototype.setState=function(F,J){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,J,"setState")},z.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function G(){}G.prototype=z.prototype;function H(F,J,de){this.props=F,this.context=J,this.refs=O,this.updater=de||B}var ae=H.prototype=new G;ae.constructor=H,L(ae,z.prototype),ae.isPureReactComponent=!0;var ue=Array.isArray;function Y(){}var T={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function S(F,J,de){var xe=de.ref;return{$$typeof:n,type:F,key:J,ref:xe!==void 0?xe:null,props:de}}function k(F,J){return S(F.type,J,F.props)}function C(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function P(F){var J={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(de){return J[de]})}var I=/\/+/g;function $(F,J){return typeof F=="object"&&F!==null&&F.key!=null?P(""+F.key):J.toString(36)}function U(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(Y,Y):(F.status="pending",F.then(function(J){F.status==="pending"&&(F.status="fulfilled",F.value=J)},function(J){F.status==="pending"&&(F.status="rejected",F.reason=J)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function V(F,J,de,xe,le){var Ce=typeof F;(Ce==="undefined"||Ce==="boolean")&&(F=null);var $e=!1;if(F===null)$e=!0;else switch(Ce){case"bigint":case"string":case"number":$e=!0;break;case"object":switch(F.$$typeof){case n:case e:$e=!0;break;case b:return $e=F._init,V($e(F._payload),J,de,xe,le)}}if($e)return le=le(F),$e=xe===""?"."+$(F,0):xe,ue(le)?(de="",$e!=null&&(de=$e.replace(I,"$&/")+"/"),V(le,J,de,"",function(qt){return qt})):le!=null&&(C(le)&&(le=k(le,de+(le.key==null||F&&F.key===le.key?"":(""+le.key).replace(I,"$&/")+"/")+$e)),J.push(le)),1;$e=0;var Ct=xe===""?".":xe+":";if(ue(F))for(var ot=0;ot<F.length;ot++)xe=F[ot],Ce=Ct+$(xe,ot),$e+=V(xe,J,de,Ce,le);else if(ot=R(F),typeof ot=="function")for(F=ot.call(F),ot=0;!(xe=F.next()).done;)xe=xe.value,Ce=Ct+$(xe,ot++),$e+=V(xe,J,de,Ce,le);else if(Ce==="object"){if(typeof F.then=="function")return V(U(F),J,de,xe,le);throw J=String(F),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return $e}function K(F,J,de){if(F==null)return F;var xe=[],le=0;return V(F,xe,"","",function(Ce){return J.call(de,Ce,le++)}),xe}function oe(F){if(F._status===-1){var J=F._result;J=J(),J.then(function(de){(F._status===0||F._status===-1)&&(F._status=1,F._result=de)},function(de){(F._status===0||F._status===-1)&&(F._status=2,F._result=de)}),F._status===-1&&(F._status=0,F._result=J)}if(F._status===1)return F._result.default;throw F._result}var Ee=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},ye={map:K,forEach:function(F,J,de){K(F,function(){J.apply(this,arguments)},de)},count:function(F){var J=0;return K(F,function(){J++}),J},toArray:function(F){return K(F,function(J){return J})||[]},only:function(F){if(!C(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return dt.Activity=v,dt.Children=ye,dt.Component=z,dt.Fragment=t,dt.Profiler=o,dt.PureComponent=H,dt.StrictMode=i,dt.Suspense=x,dt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,dt.__COMPILER_RUNTIME={__proto__:null,c:function(F){return T.H.useMemoCache(F)}},dt.cache=function(F){return function(){return F.apply(null,arguments)}},dt.cacheSignal=function(){return null},dt.cloneElement=function(F,J,de){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var xe=L({},F.props),le=F.key;if(J!=null)for(Ce in J.key!==void 0&&(le=""+J.key),J)!E.call(J,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&J.ref===void 0||(xe[Ce]=J[Ce]);var Ce=arguments.length-2;if(Ce===1)xe.children=de;else if(1<Ce){for(var $e=Array(Ce),Ct=0;Ct<Ce;Ct++)$e[Ct]=arguments[Ct+2];xe.children=$e}return S(F.type,le,xe)},dt.createContext=function(F){return F={$$typeof:d,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:c,_context:F},F},dt.createElement=function(F,J,de){var xe,le={},Ce=null;if(J!=null)for(xe in J.key!==void 0&&(Ce=""+J.key),J)E.call(J,xe)&&xe!=="key"&&xe!=="__self"&&xe!=="__source"&&(le[xe]=J[xe]);var $e=arguments.length-2;if($e===1)le.children=de;else if(1<$e){for(var Ct=Array($e),ot=0;ot<$e;ot++)Ct[ot]=arguments[ot+2];le.children=Ct}if(F&&F.defaultProps)for(xe in $e=F.defaultProps,$e)le[xe]===void 0&&(le[xe]=$e[xe]);return S(F,Ce,le)},dt.createRef=function(){return{current:null}},dt.forwardRef=function(F){return{$$typeof:m,render:F}},dt.isValidElement=C,dt.lazy=function(F){return{$$typeof:b,_payload:{_status:-1,_result:F},_init:oe}},dt.memo=function(F,J){return{$$typeof:g,type:F,compare:J===void 0?null:J}},dt.startTransition=function(F){var J=T.T,de={};T.T=de;try{var xe=F(),le=T.S;le!==null&&le(de,xe),typeof xe=="object"&&xe!==null&&typeof xe.then=="function"&&xe.then(Y,Ee)}catch(Ce){Ee(Ce)}finally{J!==null&&de.types!==null&&(J.types=de.types),T.T=J}},dt.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},dt.use=function(F){return T.H.use(F)},dt.useActionState=function(F,J,de){return T.H.useActionState(F,J,de)},dt.useCallback=function(F,J){return T.H.useCallback(F,J)},dt.useContext=function(F){return T.H.useContext(F)},dt.useDebugValue=function(){},dt.useDeferredValue=function(F,J){return T.H.useDeferredValue(F,J)},dt.useEffect=function(F,J){return T.H.useEffect(F,J)},dt.useEffectEvent=function(F){return T.H.useEffectEvent(F)},dt.useId=function(){return T.H.useId()},dt.useImperativeHandle=function(F,J,de){return T.H.useImperativeHandle(F,J,de)},dt.useInsertionEffect=function(F,J){return T.H.useInsertionEffect(F,J)},dt.useLayoutEffect=function(F,J){return T.H.useLayoutEffect(F,J)},dt.useMemo=function(F,J){return T.H.useMemo(F,J)},dt.useOptimistic=function(F,J){return T.H.useOptimistic(F,J)},dt.useReducer=function(F,J,de){return T.H.useReducer(F,J,de)},dt.useRef=function(F){return T.H.useRef(F)},dt.useState=function(F){return T.H.useState(F)},dt.useSyncExternalStore=function(F,J,de){return T.H.useSyncExternalStore(F,J,de)},dt.useTransition=function(){return T.H.useTransition()},dt.version="19.2.4",dt}var fw;function kx(){return fw||(fw=1,m0.exports=hT()),m0.exports}var j=kx();const ss=Ax(j);var p0={exports:{}},lu={},x0={exports:{}},g0={};var mw;function fT(){return mw||(mw=1,(function(n){function e(V,K){var oe=V.length;V.push(K);e:for(;0<oe;){var Ee=oe-1>>>1,ye=V[Ee];if(0<o(ye,K))V[Ee]=K,V[oe]=ye,oe=Ee;else break e}}function t(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var K=V[0],oe=V.pop();if(oe!==K){V[0]=oe;e:for(var Ee=0,ye=V.length,F=ye>>>1;Ee<F;){var J=2*(Ee+1)-1,de=V[J],xe=J+1,le=V[xe];if(0>o(de,oe))xe<ye&&0>o(le,de)?(V[Ee]=le,V[xe]=oe,Ee=xe):(V[Ee]=de,V[J]=oe,Ee=J);else if(xe<ye&&0>o(le,oe))V[Ee]=le,V[xe]=oe,Ee=xe;else break e}}return K}function o(V,K){var oe=V.sortIndex-K.sortIndex;return oe!==0?oe:V.id-K.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,m=d.now();n.unstable_now=function(){return d.now()-m}}var x=[],g=[],b=1,v=null,_=3,R=!1,B=!1,L=!1,O=!1,z=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function ae(V){for(var K=t(g);K!==null;){if(K.callback===null)i(g);else if(K.startTime<=V)i(g),K.sortIndex=K.expirationTime,e(x,K);else break;K=t(g)}}function ue(V){if(L=!1,ae(V),!B)if(t(x)!==null)B=!0,Y||(Y=!0,P());else{var K=t(g);K!==null&&U(ue,K.startTime-V)}}var Y=!1,T=-1,E=5,S=-1;function k(){return O?!0:!(n.unstable_now()-S<E)}function C(){if(O=!1,Y){var V=n.unstable_now();S=V;var K=!0;try{e:{B=!1,L&&(L=!1,G(T),T=-1),R=!0;var oe=_;try{t:{for(ae(V),v=t(x);v!==null&&!(v.expirationTime>V&&k());){var Ee=v.callback;if(typeof Ee=="function"){v.callback=null,_=v.priorityLevel;var ye=Ee(v.expirationTime<=V);if(V=n.unstable_now(),typeof ye=="function"){v.callback=ye,ae(V),K=!0;break t}v===t(x)&&i(x),ae(V)}else i(x);v=t(x)}if(v!==null)K=!0;else{var F=t(g);F!==null&&U(ue,F.startTime-V),K=!1}}break e}finally{v=null,_=oe,R=!1}K=void 0}}finally{K?P():Y=!1}}}var P;if(typeof H=="function")P=function(){H(C)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,$=I.port2;I.port1.onmessage=C,P=function(){$.postMessage(null)}}else P=function(){z(C,0)};function U(V,K){T=z(function(){V(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(V){V.callback=null},n.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<V?Math.floor(1e3/V):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_next=function(V){switch(_){case 1:case 2:case 3:var K=3;break;default:K=_}var oe=_;_=K;try{return V()}finally{_=oe}},n.unstable_requestPaint=function(){O=!0},n.unstable_runWithPriority=function(V,K){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var oe=_;_=V;try{return K()}finally{_=oe}},n.unstable_scheduleCallback=function(V,K,oe){var Ee=n.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?Ee+oe:Ee):oe=Ee,V){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=oe+ye,V={id:b++,callback:K,priorityLevel:V,startTime:oe,expirationTime:ye,sortIndex:-1},oe>Ee?(V.sortIndex=oe,e(g,V),t(x)===null&&V===t(g)&&(L?(G(T),T=-1):L=!0,U(ue,oe-Ee))):(V.sortIndex=ye,e(x,V),B||R||(B=!0,Y||(Y=!0,P()))),V},n.unstable_shouldYield=k,n.unstable_wrapCallback=function(V){var K=_;return function(){var oe=_;_=K;try{return V.apply(this,arguments)}finally{_=oe}}}})(g0)),g0}var pw;function mT(){return pw||(pw=1,x0.exports=fT()),x0.exports}var b0={exports:{}},dn={};var xw;function pT(){if(xw)return dn;xw=1;var n=kx();function e(x){var g="https://react.dev/errors/"+x;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+x+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(x,g,b){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:x,containerInfo:g,implementation:b}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(x,g){if(x==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,dn.createPortal=function(x,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(x,g,null,b)},dn.flushSync=function(x){var g=d.T,b=i.p;try{if(d.T=null,i.p=2,x)return x()}finally{d.T=g,i.p=b,i.d.f()}},dn.preconnect=function(x,g){typeof x=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(x,g))},dn.prefetchDNS=function(x){typeof x=="string"&&i.d.D(x)},dn.preinit=function(x,g){if(typeof x=="string"&&g&&typeof g.as=="string"){var b=g.as,v=m(b,g.crossOrigin),_=typeof g.integrity=="string"?g.integrity:void 0,R=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?i.d.S(x,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:R}):b==="script"&&i.d.X(x,{crossOrigin:v,integrity:_,fetchPriority:R,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},dn.preinitModule=function(x,g){if(typeof x=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=m(g.as,g.crossOrigin);i.d.M(x,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(x)},dn.preload=function(x,g){if(typeof x=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,v=m(b,g.crossOrigin);i.d.L(x,b,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},dn.preloadModule=function(x,g){if(typeof x=="string")if(g){var b=m(g.as,g.crossOrigin);i.d.m(x,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(x)},dn.requestFormReset=function(x){i.d.r(x)},dn.unstable_batchedUpdates=function(x,g){return x(g)},dn.useFormState=function(x,g,b){return d.H.useFormState(x,g,b)},dn.useFormStatus=function(){return d.H.useHostTransitionStatus()},dn.version="19.2.4",dn}var gw;function xT(){if(gw)return b0.exports;gw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),b0.exports=pT(),b0.exports}var bw;function gT(){if(bw)return lu;bw=1;var n=mT(),e=kx(),t=xT();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var r=s,l=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(l=r.return),s=r.return;while(s)}return r.tag===3?l:null}function d(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function m(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function x(s){if(c(s)!==s)throw Error(i(188))}function g(s){var r=s.alternate;if(!r){if(r=c(s),r===null)throw Error(i(188));return r!==s?null:s}for(var l=s,u=r;;){var f=l.return;if(f===null)break;var p=f.alternate;if(p===null){if(u=f.return,u!==null){l=u;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===l)return x(f),s;if(p===u)return x(f),r;p=p.sibling}throw Error(i(188))}if(l.return!==u.return)l=f,u=p;else{for(var w=!1,A=f.child;A;){if(A===l){w=!0,l=f,u=p;break}if(A===u){w=!0,u=f,l=p;break}A=A.sibling}if(!w){for(A=p.child;A;){if(A===l){w=!0,l=p,u=f;break}if(A===u){w=!0,u=p,l=f;break}A=A.sibling}if(!w)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:r}function b(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=b(s),r!==null)return r;s=s.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),B=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),H=Symbol.for("react.context"),ae=Symbol.for("react.forward_ref"),ue=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),k=Symbol.for("react.memo_cache_sentinel"),C=Symbol.iterator;function P(s){return s===null||typeof s!="object"?null:(s=C&&s[C]||s["@@iterator"],typeof s=="function"?s:null)}var I=Symbol.for("react.client.reference");function $(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===I?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case L:return"Fragment";case z:return"Profiler";case O:return"StrictMode";case ue:return"Suspense";case Y:return"SuspenseList";case S:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case B:return"Portal";case H:return s.displayName||"Context";case G:return(s._context.displayName||"Context")+".Consumer";case ae:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case T:return r=s.displayName||null,r!==null?r:$(s.type)||"Memo";case E:r=s._payload,s=s._init;try{return $(s(r))}catch{}}return null}var U=Array.isArray,V=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},Ee=[],ye=-1;function F(s){return{current:s}}function J(s){0>ye||(s.current=Ee[ye],Ee[ye]=null,ye--)}function de(s,r){ye++,Ee[ye]=s.current,s.current=r}var xe=F(null),le=F(null),Ce=F(null),$e=F(null);function Ct(s,r){switch(de(Ce,r),de(le,s),de(xe,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?Dv(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=Dv(r),s=Mv(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}J(xe),de(xe,s)}function ot(){J(xe),J(le),J(Ce)}function qt(s){s.memoizedState!==null&&de($e,s);var r=xe.current,l=Mv(r,s.type);r!==l&&(de(le,s),de(xe,l))}function Z(s){le.current===s&&(J(xe),J(le)),$e.current===s&&(J($e),su._currentValue=oe)}var je,Se;function qe(s){if(je===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);je=r&&r[1]||"",Se=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+je+s+Se}var tt=!1;function gt(s,r){if(!s||tt)return"";tt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(ce){var re=ce}Reflect.construct(s,[],ve)}else{try{ve.call()}catch(ce){re=ce}s.call(ve.prototype)}}else{try{throw Error()}catch(ce){re=ce}(ve=s())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(ce){if(ce&&re&&typeof ce.stack=="string")return[ce.stack,re.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=u.DetermineComponentFrameRoot(),w=p[0],A=p[1];if(w&&A){var q=w.split(`
`),ne=A.split(`
`);for(f=u=0;u<q.length&&!q[u].includes("DetermineComponentFrameRoot");)u++;for(;f<ne.length&&!ne[f].includes("DetermineComponentFrameRoot");)f++;if(u===q.length||f===ne.length)for(u=q.length-1,f=ne.length-1;1<=u&&0<=f&&q[u]!==ne[f];)f--;for(;1<=u&&0<=f;u--,f--)if(q[u]!==ne[f]){if(u!==1||f!==1)do if(u--,f--,0>f||q[u]!==ne[f]){var me=`
`+q[u].replace(" at new "," at ");return s.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",s.displayName)),me}while(1<=u&&0<=f);break}}}finally{tt=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?qe(l):""}function Ks(s,r){switch(s.tag){case 26:case 27:case 5:return qe(s.type);case 16:return qe("Lazy");case 13:return s.child!==r&&r!==null?qe("Suspense Fallback"):qe("Suspense");case 19:return qe("SuspenseList");case 0:case 15:return gt(s.type,!1);case 11:return gt(s.type.render,!1);case 1:return gt(s.type,!0);case 31:return qe("Activity");default:return""}}function Ot(s){try{var r="",l=null;do r+=Ks(s,l),l=s,s=s.return;while(s);return r}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var bt=Object.prototype.hasOwnProperty,Re=n.unstable_scheduleCallback,Be=n.unstable_cancelCallback,pe=n.unstable_shouldYield,We=n.unstable_requestPaint,Le=n.unstable_now,De=n.unstable_getCurrentPriorityLevel,Ge=n.unstable_ImmediatePriority,He=n.unstable_UserBlockingPriority,ee=n.unstable_NormalPriority,ke=n.unstable_LowPriority,nt=n.unstable_IdlePriority,it=n.log,Bt=n.unstable_setDisableYieldValue,is=null,yt=null;function gs(s){if(typeof it=="function"&&Bt(s),yt&&typeof yt.setStrictMode=="function")try{yt.setStrictMode(is,s)}catch{}}var hs=Math.clz32?Math.clz32:ra,ws=Math.log,Ps=Math.LN2;function ra(s){return s>>>=0,s===0?32:31-(ws(s)/Ps|0)|0}var Vs=256,_e=262144,Ie=4194304;function ft(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function vt(s,r,l){var u=s.pendingLanes;if(u===0)return 0;var f=0,p=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var A=u&134217727;return A!==0?(u=A&~p,u!==0?f=ft(u):(w&=A,w!==0?f=ft(w):l||(l=A&~s,l!==0&&(f=ft(l))))):(A=u&~p,A!==0?f=ft(A):w!==0?f=ft(w):l||(l=u&~s,l!==0&&(f=ft(l)))),f===0?0:r!==0&&r!==f&&(r&p)===0&&(p=f&-f,l=r&-r,p>=l||p===32&&(l&4194048)!==0)?r:f}function Rt(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function Qe(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function st(){var s=Ie;return Ie<<=1,(Ie&62914560)===0&&(Ie=4194304),s}function Mt(s){for(var r=[],l=0;31>l;l++)r.push(s);return r}function Ns(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function bn(s,r,l,u,f,p){var w=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var A=s.entanglements,q=s.expirationTimes,ne=s.hiddenUpdates;for(l=w&~l;0<l;){var me=31-hs(l),ve=1<<me;A[me]=0,q[me]=-1;var re=ne[me];if(re!==null)for(ne[me]=null,me=0;me<re.length;me++){var ce=re[me];ce!==null&&(ce.lane&=-536870913)}l&=~ve}u!==0&&ls(s,u,0),p!==0&&f===0&&s.tag!==0&&(s.suspendedLanes|=p&~(w&~r))}function ls(s,r,l){s.pendingLanes|=r,s.suspendedLanes&=~r;var u=31-hs(r);s.entangledLanes|=r,s.entanglements[u]=s.entanglements[u]|1073741824|l&261930}function $n(s,r){var l=s.entangledLanes|=r;for(s=s.entanglements;l;){var u=31-hs(l),f=1<<u;f&r|s[u]&r&&(s[u]|=r),l&=~f}}function _a(s,r){var l=r&-r;return l=(l&42)!==0?1:qn(l),(l&(s.suspendedLanes|r))!==0?0:l}function qn(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function bs(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Fa(){var s=K.p;return s!==0?s:(s=window.event,s===void 0?32:nw(s.type))}function js(s,r){var l=K.p;try{return K.p=s,r()}finally{K.p=l}}var Qs=Math.random().toString(36).slice(2),os="__reactFiber$"+Qs,D="__reactProps$"+Qs,Q="__reactContainer$"+Qs,be="__reactEvents$"+Qs,he="__reactListeners$"+Qs,ze="__reactHandles$"+Qs,lt="__reactResources$"+Qs,ut="__reactMarker$"+Qs;function Xe(s){delete s[os],delete s[D],delete s[be],delete s[he],delete s[ze]}function wt(s){var r=s[os];if(r)return r;for(var l=s.parentNode;l;){if(r=l[Q]||l[os]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(s=zv(s);s!==null;){if(l=s[os])return l;s=zv(s)}return r}s=l,l=s.parentNode}return null}function as(s){if(s=s[os]||s[Q]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function cs(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function _s(s){var r=s[lt];return r||(r=s[lt]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function fs(s){s[ut]=!0}var $a=new Set,Ki={};function ia(s,r){la(s,r),la(s+"Capture",r)}function la(s,r){for(Ki[s]=r,s=0;s<r.length;s++)$a.add(r[s])}var pr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qi={},Xi={};function pd(s){return bt.call(Xi,s)?!0:bt.call(Qi,s)?!1:pr.test(s)?Xi[s]=!0:(Qi[s]=!0,!1)}function Fl(s,r,l){if(pd(r))if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+l)}}function Hn(s,r,l){if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+l)}}function Ls(s,r,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(r,l,""+u)}}function Xs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Qr(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function mc(s,r,l){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var f=u.get,p=u.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return f.call(this)},set:function(w){l=""+w,p.call(this,w)}}),Object.defineProperty(s,r,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(w){l=""+w},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Ht(s){if(!s._valueTracker){var r=Qr(s)?"checked":"value";s._valueTracker=mc(s,r,""+s[r])}}function Ji(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return s&&(u=Qr(s)?s.checked?"true":"false":s.value),s=u,s!==l?(r.setValue(s),!0):!1}function qa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Zi=/[\n"\\]/g;function _n(s){return s.replace(Zi,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function $l(s,r,l,u,f,p,w,A){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),r!=null?w==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+Xs(r)):s.value!==""+Xs(r)&&(s.value=""+Xs(r)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),r!=null?pc(s,w,Xs(r)):l!=null?pc(s,w,Xs(l)):u!=null&&s.removeAttribute("value"),f==null&&p!=null&&(s.defaultChecked=!!p),f!=null&&(s.checked=f&&typeof f!="function"&&typeof f!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.name=""+Xs(A):s.removeAttribute("name")}function xd(s,r,l,u,f,p,w,A){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(s.type=p),r!=null||l!=null){if(!(p!=="submit"&&p!=="reset"||r!=null)){Ht(s);return}l=l!=null?""+Xs(l):"",r=r!=null?""+Xs(r):l,A||r===s.value||(s.value=r),s.defaultValue=r}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=A?s.checked:!!u,s.defaultChecked=!!u,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),Ht(s)}function pc(s,r,l){r==="number"&&qa(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function Xr(s,r,l,u){if(s=s.options,r){r={};for(var f=0;f<l.length;f++)r["$"+l[f]]=!0;for(l=0;l<s.length;l++)f=r.hasOwnProperty("$"+s[l].value),s[l].selected!==f&&(s[l].selected=f),f&&u&&(s[l].defaultSelected=!0)}else{for(l=""+Xs(l),r=null,f=0;f<s.length;f++){if(s[f].value===l){s[f].selected=!0,u&&(s[f].defaultSelected=!0);return}r!==null||s[f].disabled||(r=s[f])}r!==null&&(r.selected=!0)}}function gd(s,r,l){if(r!=null&&(r=""+Xs(r),r!==s.value&&(s.value=r),l==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=l!=null?""+Xs(l):""}function Jr(s,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(i(92));if(U(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=Xs(r),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u),Ht(s)}function Sn(s,r){if(r){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=r;return}}s.textContent=r}var bd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xc(s,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":u?s.setProperty(r,l):typeof l!="number"||l===0||bd.has(r)?r==="float"?s.cssFloat=l:s[r]=(""+l).trim():s[r]=l+"px"}function gc(s,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var f in r)u=r[f],r.hasOwnProperty(f)&&l[f]!==u&&xc(s,f,u)}else for(var p in r)r.hasOwnProperty(p)&&xc(s,p,r[p])}function ql(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Hl(s){return Zr.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Sa(){}var bc=null;function oa(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ei=null,Ha=null;function el(s){var r=as(s);if(r&&(s=r.stateNode)){var l=s[D]||null;e:switch(s=r.stateNode,r.type){case"input":if($l(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+_n(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==s&&u.form===s.form){var f=u[D]||null;if(!f)throw Error(i(90));$l(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===s.form&&Ji(u)}break e;case"textarea":gd(s,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&Xr(s,!!l.multiple,r,!1)}}}var Gl=!1;function ti(s,r,l){if(Gl)return s(r,l);Gl=!0;try{var u=s(r);return u}finally{if(Gl=!1,(ei!==null||Ha!==null)&&(hh(),ei&&(r=ei,s=Ha,Ha=ei=null,el(r),s)))for(r=0;r<s.length;r++)el(s[r])}}function Ea(s,r){var l=s.stateNode;if(l===null)return null;var u=l[D]||null;if(u===null)return null;l=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var ca=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tl=!1;if(ca)try{var Kt={};Object.defineProperty(Kt,"passive",{get:function(){tl=!0}}),window.addEventListener("test",Kt,Kt),window.removeEventListener("test",Kt,Kt)}catch{tl=!1}var Ga=null,yc=null,sl=null;function vc(){if(sl)return sl;var s,r=yc,l=r.length,u,f="value"in Ga?Ga.value:Ga.textContent,p=f.length;for(s=0;s<l&&r[s]===f[s];s++);var w=l-s;for(u=1;u<=w&&r[l-u]===f[p-u];u++);return sl=f.slice(s,1<u?1-u:void 0)}function nl(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function xr(){return!0}function Ta(){return!1}function tn(s){function r(l,u,f,p,w){this._reactName=l,this._targetInst=f,this.type=u,this.nativeEvent=p,this.target=w,this.currentTarget=null;for(var A in s)s.hasOwnProperty(A)&&(l=s[A],this[A]=l?l(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?xr:Ta,this.isPropagationStopped=Ta,this}return v(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=xr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=xr)},persist:function(){},isPersistent:xr}),r}var gr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ya=tn(gr),si=v({},gr,{view:0,detail:0}),wc=tn(si),ni,Yl,Wa,Wl=v({},si,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ai,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Wa&&(Wa&&s.type==="mousemove"?(ni=s.screenX-Wa.screenX,Yl=s.screenY-Wa.screenY):Yl=ni=0,Wa=s),ni)},movementY:function(s){return"movementY"in s?s.movementY:Yl}}),Nc=tn(Wl),al=v({},Wl,{dataTransfer:0}),vd=tn(al),wd=v({},si,{relatedTarget:0}),rl=tn(wd),jc=v({},gr,{animationName:0,elapsedTime:0,pseudoElement:0}),Nd=tn(jc),Kl=v({},gr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),jd=tn(Kl),_d=v({},gr,{data:0}),Ka=tn(_d),Sd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ed={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Td={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ad(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=Td[s])?!!r[s]:!1}function ai(){return Ad}var yn=v({},si,{key:function(s){if(s.key){var r=Sd[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=nl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ed[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ai,charCode:function(s){return s.type==="keypress"?nl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?nl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),kd=tn(yn),Cd=v({},Wl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),br=tn(Cd),h=v({},si,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ai}),y=tn(h),N=v({},gr,{propertyName:0,elapsedTime:0,pseudoElement:0}),M=tn(N),te=v({},Wl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ie=tn(te),Te=v({},gr,{newState:0,oldState:0}),mt=tn(Te),Cs=[9,13,27,32],Lt=ca&&"CompositionEvent"in window,ms=null;ca&&"documentMode"in document&&(ms=document.documentMode);var ua=ca&&"TextEvent"in window&&!ms,Qa=ca&&(!Lt||ms&&8<ms&&11>=ms),Aa=" ",ka=!1;function il(s,r){switch(s){case"keyup":return Cs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ql(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Xl=!1;function MS(s,r){switch(s){case"compositionend":return Ql(r);case"keypress":return r.which!==32?null:(ka=!0,Aa);case"textInput":return s=r.data,s===Aa&&ka?null:s;default:return null}}function OS(s,r){if(Xl)return s==="compositionend"||!Lt&&il(s,r)?(s=vc(),sl=yc=Ga=null,Xl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Qa&&r.locale!=="ko"?null:r.data;default:return null}}var PS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qg(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!PS[s.type]:r==="textarea"}function Hg(s,r,l,u){ei?Ha?Ha.push(u):Ha=[u]:ei=u,r=yh(r,"onChange"),0<r.length&&(l=new Ya("onChange","change",null,l,u),s.push({event:l,listeners:r}))}var _c=null,Sc=null;function VS(s){Tv(s,0)}function Rd(s){var r=cs(s);if(Ji(r))return s}function Gg(s,r){if(s==="change")return r}var Yg=!1;if(ca){var vm;if(ca){var wm="oninput"in document;if(!wm){var Wg=document.createElement("div");Wg.setAttribute("oninput","return;"),wm=typeof Wg.oninput=="function"}vm=wm}else vm=!1;Yg=vm&&(!document.documentMode||9<document.documentMode)}function Kg(){_c&&(_c.detachEvent("onpropertychange",Qg),Sc=_c=null)}function Qg(s){if(s.propertyName==="value"&&Rd(Sc)){var r=[];Hg(r,Sc,s,oa(s)),ti(VS,r)}}function LS(s,r,l){s==="focusin"?(Kg(),_c=r,Sc=l,_c.attachEvent("onpropertychange",Qg)):s==="focusout"&&Kg()}function US(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Rd(Sc)}function BS(s,r){if(s==="click")return Rd(r)}function zS(s,r){if(s==="input"||s==="change")return Rd(r)}function FS(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Gn=typeof Object.is=="function"?Object.is:FS;function Ec(s,r){if(Gn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var l=Object.keys(s),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var f=l[u];if(!bt.call(r,f)||!Gn(s[f],r[f]))return!1}return!0}function Xg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Jg(s,r){var l=Xg(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=r&&u>=r)return{node:l,offset:r-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Xg(l)}}function Zg(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?Zg(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function eb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=qa(s.document);r instanceof s.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)s=r.contentWindow;else break;r=qa(s.document)}return r}function Nm(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var $S=ca&&"documentMode"in document&&11>=document.documentMode,Jl=null,jm=null,Tc=null,_m=!1;function tb(s,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;_m||Jl==null||Jl!==qa(u)||(u=Jl,"selectionStart"in u&&Nm(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Tc&&Ec(Tc,u)||(Tc=u,u=yh(jm,"onSelect"),0<u.length&&(r=new Ya("onSelect","select",null,r,l),s.push({event:r,listeners:u}),r.target=Jl)))}function ll(s,r){var l={};return l[s.toLowerCase()]=r.toLowerCase(),l["Webkit"+s]="webkit"+r,l["Moz"+s]="moz"+r,l}var Zl={animationend:ll("Animation","AnimationEnd"),animationiteration:ll("Animation","AnimationIteration"),animationstart:ll("Animation","AnimationStart"),transitionrun:ll("Transition","TransitionRun"),transitionstart:ll("Transition","TransitionStart"),transitioncancel:ll("Transition","TransitionCancel"),transitionend:ll("Transition","TransitionEnd")},Sm={},sb={};ca&&(sb=document.createElement("div").style,"AnimationEvent"in window||(delete Zl.animationend.animation,delete Zl.animationiteration.animation,delete Zl.animationstart.animation),"TransitionEvent"in window||delete Zl.transitionend.transition);function ol(s){if(Sm[s])return Sm[s];if(!Zl[s])return s;var r=Zl[s],l;for(l in r)if(r.hasOwnProperty(l)&&l in sb)return Sm[s]=r[l];return s}var nb=ol("animationend"),ab=ol("animationiteration"),rb=ol("animationstart"),qS=ol("transitionrun"),HS=ol("transitionstart"),GS=ol("transitioncancel"),ib=ol("transitionend"),lb=new Map,Em="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Em.push("scrollEnd");function Ca(s,r){lb.set(s,r),ia(r,[s])}var Id=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},da=[],eo=0,Tm=0;function Dd(){for(var s=eo,r=Tm=eo=0;r<s;){var l=da[r];da[r++]=null;var u=da[r];da[r++]=null;var f=da[r];da[r++]=null;var p=da[r];if(da[r++]=null,u!==null&&f!==null){var w=u.pending;w===null?f.next=f:(f.next=w.next,w.next=f),u.pending=f}p!==0&&ob(l,f,p)}}function Md(s,r,l,u){da[eo++]=s,da[eo++]=r,da[eo++]=l,da[eo++]=u,Tm|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Am(s,r,l,u){return Md(s,r,l,u),Od(s)}function cl(s,r){return Md(s,null,null,r),Od(s)}function ob(s,r,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var f=!1,p=s.return;p!==null;)p.childLanes|=l,u=p.alternate,u!==null&&(u.childLanes|=l),p.tag===22&&(s=p.stateNode,s===null||s._visibility&1||(f=!0)),s=p,p=p.return;return s.tag===3?(p=s.stateNode,f&&r!==null&&(f=31-hs(l),s=p.hiddenUpdates,u=s[f],u===null?s[f]=[r]:u.push(r),r.lane=l|536870912),p):null}function Od(s){if(50<Kc)throw Kc=0,Vp=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var to={};function YS(s,r,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yn(s,r,l,u){return new YS(s,r,l,u)}function km(s){return s=s.prototype,!(!s||!s.isReactComponent)}function yr(s,r){var l=s.alternate;return l===null?(l=Yn(s.tag,r,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=r,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,r=s.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function cb(s,r){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,r=l.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function Pd(s,r,l,u,f,p){var w=0;if(u=s,typeof s=="function")km(s)&&(w=1);else if(typeof s=="string")w=JE(s,l,xe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case S:return s=Yn(31,l,r,f),s.elementType=S,s.lanes=p,s;case L:return ul(l.children,f,p,r);case O:w=8,f|=24;break;case z:return s=Yn(12,l,r,f|2),s.elementType=z,s.lanes=p,s;case ue:return s=Yn(13,l,r,f),s.elementType=ue,s.lanes=p,s;case Y:return s=Yn(19,l,r,f),s.elementType=Y,s.lanes=p,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case H:w=10;break e;case G:w=9;break e;case ae:w=11;break e;case T:w=14;break e;case E:w=16,u=null;break e}w=29,l=Error(i(130,s===null?"null":typeof s,"")),u=null}return r=Yn(w,l,r,f),r.elementType=s,r.type=u,r.lanes=p,r}function ul(s,r,l,u){return s=Yn(7,s,u,r),s.lanes=l,s}function Cm(s,r,l){return s=Yn(6,s,null,r),s.lanes=l,s}function ub(s){var r=Yn(18,null,null,0);return r.stateNode=s,r}function Rm(s,r,l){return r=Yn(4,s.children!==null?s.children:[],s.key,r),r.lanes=l,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var db=new WeakMap;function ha(s,r){if(typeof s=="object"&&s!==null){var l=db.get(s);return l!==void 0?l:(r={value:s,source:r,stack:Ot(r)},db.set(s,r),r)}return{value:s,source:r,stack:Ot(r)}}var so=[],no=0,Vd=null,Ac=0,fa=[],ma=0,ri=null,Xa=1,Ja="";function vr(s,r){so[no++]=Ac,so[no++]=Vd,Vd=s,Ac=r}function hb(s,r,l){fa[ma++]=Xa,fa[ma++]=Ja,fa[ma++]=ri,ri=s;var u=Xa;s=Ja;var f=32-hs(u)-1;u&=~(1<<f),l+=1;var p=32-hs(r)+f;if(30<p){var w=f-f%5;p=(u&(1<<w)-1).toString(32),u>>=w,f-=w,Xa=1<<32-hs(r)+f|l<<f|u,Ja=p+s}else Xa=1<<p|l<<f|u,Ja=s}function Im(s){s.return!==null&&(vr(s,1),hb(s,1,0))}function Dm(s){for(;s===Vd;)Vd=so[--no],so[no]=null,Ac=so[--no],so[no]=null;for(;s===ri;)ri=fa[--ma],fa[ma]=null,Ja=fa[--ma],fa[ma]=null,Xa=fa[--ma],fa[ma]=null}function fb(s,r){fa[ma++]=Xa,fa[ma++]=Ja,fa[ma++]=ri,Xa=r.id,Ja=r.overflow,ri=s}var sn=null,us=null,It=!1,ii=null,pa=!1,Mm=Error(i(519));function li(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw kc(ha(r,s)),Mm}function mb(s){var r=s.stateNode,l=s.type,u=s.memoizedProps;switch(r[os]=s,r[D]=u,l){case"dialog":jt("cancel",r),jt("close",r);break;case"iframe":case"object":case"embed":jt("load",r);break;case"video":case"audio":for(l=0;l<Xc.length;l++)jt(Xc[l],r);break;case"source":jt("error",r);break;case"img":case"image":case"link":jt("error",r),jt("load",r);break;case"details":jt("toggle",r);break;case"input":jt("invalid",r),xd(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":jt("invalid",r);break;case"textarea":jt("invalid",r),Jr(r,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||Rv(r.textContent,l)?(u.popover!=null&&(jt("beforetoggle",r),jt("toggle",r)),u.onScroll!=null&&jt("scroll",r),u.onScrollEnd!=null&&jt("scrollend",r),u.onClick!=null&&(r.onclick=Sa),r=!0):r=!1,r||li(s,!0)}function pb(s){for(sn=s.return;sn;)switch(sn.tag){case 5:case 31:case 13:pa=!1;return;case 27:case 3:pa=!0;return;default:sn=sn.return}}function ao(s){if(s!==sn)return!1;if(!It)return pb(s),It=!0,!1;var r=s.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||Jp(s.type,s.memoizedProps)),l=!l),l&&us&&li(s),pb(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));us=Bv(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));us=Bv(s)}else r===27?(r=us,wi(s.type)?(s=n0,n0=null,us=s):us=r):us=sn?ga(s.stateNode.nextSibling):null;return!0}function dl(){us=sn=null,It=!1}function Om(){var s=ii;return s!==null&&(kn===null?kn=s:kn.push.apply(kn,s),ii=null),s}function kc(s){ii===null?ii=[s]:ii.push(s)}var Pm=F(null),hl=null,wr=null;function oi(s,r,l){de(Pm,r._currentValue),r._currentValue=l}function Nr(s){s._currentValue=Pm.current,J(Pm)}function Vm(s,r,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),s===l)break;s=s.return}}function Lm(s,r,l,u){var f=s.child;for(f!==null&&(f.return=s);f!==null;){var p=f.dependencies;if(p!==null){var w=f.child;p=p.firstContext;e:for(;p!==null;){var A=p;p=f;for(var q=0;q<r.length;q++)if(A.context===r[q]){p.lanes|=l,A=p.alternate,A!==null&&(A.lanes|=l),Vm(p.return,l,s),u||(w=null);break e}p=A.next}}else if(f.tag===18){if(w=f.return,w===null)throw Error(i(341));w.lanes|=l,p=w.alternate,p!==null&&(p.lanes|=l),Vm(w,l,s),w=null}else w=f.child;if(w!==null)w.return=f;else for(w=f;w!==null;){if(w===s){w=null;break}if(f=w.sibling,f!==null){f.return=w.return,w=f;break}w=w.return}f=w}}function ro(s,r,l,u){s=null;for(var f=r,p=!1;f!==null;){if(!p){if((f.flags&524288)!==0)p=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var w=f.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var A=f.type;Gn(f.pendingProps.value,w.value)||(s!==null?s.push(A):s=[A])}}else if(f===$e.current){if(w=f.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(s!==null?s.push(su):s=[su])}f=f.return}s!==null&&Lm(r,s,l,u),r.flags|=262144}function Ld(s){for(s=s.firstContext;s!==null;){if(!Gn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function fl(s){hl=s,wr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function nn(s){return xb(hl,s)}function Ud(s,r){return hl===null&&fl(s),xb(s,r)}function xb(s,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},wr===null){if(s===null)throw Error(i(308));wr=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else wr=wr.next=r;return l}var WS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){r.aborted=!0,s.forEach(function(l){return l()})}},KS=n.unstable_scheduleCallback,QS=n.unstable_NormalPriority,Us={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Um(){return{controller:new WS,data:new Map,refCount:0}}function Cc(s){s.refCount--,s.refCount===0&&KS(QS,function(){s.controller.abort()})}var Rc=null,Bm=0,io=0,lo=null;function XS(s,r){if(Rc===null){var l=Rc=[];Bm=0,io=$p(),lo={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Bm++,r.then(gb,gb),r}function gb(){if(--Bm===0&&Rc!==null){lo!==null&&(lo.status="fulfilled");var s=Rc;Rc=null,io=0,lo=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function JS(s,r){var l=[],u={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return s.then(function(){u.status="fulfilled",u.value=r;for(var f=0;f<l.length;f++)(0,l[f])(r)},function(f){for(u.status="rejected",u.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),u}var bb=V.S;V.S=function(s,r){tv=Le(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&XS(s,r),bb!==null&&bb(s,r)};var ml=F(null);function zm(){var s=ml.current;return s!==null?s:es.pooledCache}function Bd(s,r){r===null?de(ml,ml.current):de(ml,r.pool)}function yb(){var s=zm();return s===null?null:{parent:Us._currentValue,pool:s}}var oo=Error(i(460)),Fm=Error(i(474)),zd=Error(i(542)),Fd={then:function(){}};function vb(s){return s=s.status,s==="fulfilled"||s==="rejected"}function wb(s,r,l){switch(l=s[l],l===void 0?s.push(r):l!==r&&(r.then(Sa,Sa),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,jb(s),s;default:if(typeof r.status=="string")r.then(Sa,Sa);else{if(s=es,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(u){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=u}},function(u){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,jb(s),s}throw xl=r,oo}}function pl(s){try{var r=s._init;return r(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(xl=l,oo):l}}var xl=null;function Nb(){if(xl===null)throw Error(i(459));var s=xl;return xl=null,s}function jb(s){if(s===oo||s===zd)throw Error(i(483))}var co=null,Ic=0;function $d(s){var r=Ic;return Ic+=1,co===null&&(co=[]),wb(co,s,r)}function Dc(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function qd(s,r){throw r.$$typeof===_?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function _b(s){function r(X,W){if(s){var se=X.deletions;se===null?(X.deletions=[W],X.flags|=16):se.push(W)}}function l(X,W){if(!s)return null;for(;W!==null;)r(X,W),W=W.sibling;return null}function u(X){for(var W=new Map;X!==null;)X.key!==null?W.set(X.key,X):W.set(X.index,X),X=X.sibling;return W}function f(X,W){return X=yr(X,W),X.index=0,X.sibling=null,X}function p(X,W,se){return X.index=se,s?(se=X.alternate,se!==null?(se=se.index,se<W?(X.flags|=67108866,W):se):(X.flags|=67108866,W)):(X.flags|=1048576,W)}function w(X){return s&&X.alternate===null&&(X.flags|=67108866),X}function A(X,W,se,ge){return W===null||W.tag!==6?(W=Cm(se,X.mode,ge),W.return=X,W):(W=f(W,se),W.return=X,W)}function q(X,W,se,ge){var Je=se.type;return Je===L?me(X,W,se.props.children,ge,se.key):W!==null&&(W.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===E&&pl(Je)===W.type)?(W=f(W,se.props),Dc(W,se),W.return=X,W):(W=Pd(se.type,se.key,se.props,null,X.mode,ge),Dc(W,se),W.return=X,W)}function ne(X,W,se,ge){return W===null||W.tag!==4||W.stateNode.containerInfo!==se.containerInfo||W.stateNode.implementation!==se.implementation?(W=Rm(se,X.mode,ge),W.return=X,W):(W=f(W,se.children||[]),W.return=X,W)}function me(X,W,se,ge,Je){return W===null||W.tag!==7?(W=ul(se,X.mode,ge,Je),W.return=X,W):(W=f(W,se),W.return=X,W)}function ve(X,W,se){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Cm(""+W,X.mode,se),W.return=X,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case R:return se=Pd(W.type,W.key,W.props,null,X.mode,se),Dc(se,W),se.return=X,se;case B:return W=Rm(W,X.mode,se),W.return=X,W;case E:return W=pl(W),ve(X,W,se)}if(U(W)||P(W))return W=ul(W,X.mode,se,null),W.return=X,W;if(typeof W.then=="function")return ve(X,$d(W),se);if(W.$$typeof===H)return ve(X,Ud(X,W),se);qd(X,W)}return null}function re(X,W,se,ge){var Je=W!==null?W.key:null;if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return Je!==null?null:A(X,W,""+se,ge);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case R:return se.key===Je?q(X,W,se,ge):null;case B:return se.key===Je?ne(X,W,se,ge):null;case E:return se=pl(se),re(X,W,se,ge)}if(U(se)||P(se))return Je!==null?null:me(X,W,se,ge,null);if(typeof se.then=="function")return re(X,W,$d(se),ge);if(se.$$typeof===H)return re(X,W,Ud(X,se),ge);qd(X,se)}return null}function ce(X,W,se,ge,Je){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return X=X.get(se)||null,A(W,X,""+ge,Je);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case R:return X=X.get(ge.key===null?se:ge.key)||null,q(W,X,ge,Je);case B:return X=X.get(ge.key===null?se:ge.key)||null,ne(W,X,ge,Je);case E:return ge=pl(ge),ce(X,W,se,ge,Je)}if(U(ge)||P(ge))return X=X.get(se)||null,me(W,X,ge,Je,null);if(typeof ge.then=="function")return ce(X,W,se,$d(ge),Je);if(ge.$$typeof===H)return ce(X,W,se,Ud(W,ge),Je);qd(W,ge)}return null}function Ue(X,W,se,ge){for(var Je=null,Pt=null,Fe=W,xt=W=0,Et=null;Fe!==null&&xt<se.length;xt++){Fe.index>xt?(Et=Fe,Fe=null):Et=Fe.sibling;var Vt=re(X,Fe,se[xt],ge);if(Vt===null){Fe===null&&(Fe=Et);break}s&&Fe&&Vt.alternate===null&&r(X,Fe),W=p(Vt,W,xt),Pt===null?Je=Vt:Pt.sibling=Vt,Pt=Vt,Fe=Et}if(xt===se.length)return l(X,Fe),It&&vr(X,xt),Je;if(Fe===null){for(;xt<se.length;xt++)Fe=ve(X,se[xt],ge),Fe!==null&&(W=p(Fe,W,xt),Pt===null?Je=Fe:Pt.sibling=Fe,Pt=Fe);return It&&vr(X,xt),Je}for(Fe=u(Fe);xt<se.length;xt++)Et=ce(Fe,X,xt,se[xt],ge),Et!==null&&(s&&Et.alternate!==null&&Fe.delete(Et.key===null?xt:Et.key),W=p(Et,W,xt),Pt===null?Je=Et:Pt.sibling=Et,Pt=Et);return s&&Fe.forEach(function(Ei){return r(X,Ei)}),It&&vr(X,xt),Je}function at(X,W,se,ge){if(se==null)throw Error(i(151));for(var Je=null,Pt=null,Fe=W,xt=W=0,Et=null,Vt=se.next();Fe!==null&&!Vt.done;xt++,Vt=se.next()){Fe.index>xt?(Et=Fe,Fe=null):Et=Fe.sibling;var Ei=re(X,Fe,Vt.value,ge);if(Ei===null){Fe===null&&(Fe=Et);break}s&&Fe&&Ei.alternate===null&&r(X,Fe),W=p(Ei,W,xt),Pt===null?Je=Ei:Pt.sibling=Ei,Pt=Ei,Fe=Et}if(Vt.done)return l(X,Fe),It&&vr(X,xt),Je;if(Fe===null){for(;!Vt.done;xt++,Vt=se.next())Vt=ve(X,Vt.value,ge),Vt!==null&&(W=p(Vt,W,xt),Pt===null?Je=Vt:Pt.sibling=Vt,Pt=Vt);return It&&vr(X,xt),Je}for(Fe=u(Fe);!Vt.done;xt++,Vt=se.next())Vt=ce(Fe,X,xt,Vt.value,ge),Vt!==null&&(s&&Vt.alternate!==null&&Fe.delete(Vt.key===null?xt:Vt.key),W=p(Vt,W,xt),Pt===null?Je=Vt:Pt.sibling=Vt,Pt=Vt);return s&&Fe.forEach(function(cT){return r(X,cT)}),It&&vr(X,xt),Je}function Jt(X,W,se,ge){if(typeof se=="object"&&se!==null&&se.type===L&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case R:e:{for(var Je=se.key;W!==null;){if(W.key===Je){if(Je=se.type,Je===L){if(W.tag===7){l(X,W.sibling),ge=f(W,se.props.children),ge.return=X,X=ge;break e}}else if(W.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===E&&pl(Je)===W.type){l(X,W.sibling),ge=f(W,se.props),Dc(ge,se),ge.return=X,X=ge;break e}l(X,W);break}else r(X,W);W=W.sibling}se.type===L?(ge=ul(se.props.children,X.mode,ge,se.key),ge.return=X,X=ge):(ge=Pd(se.type,se.key,se.props,null,X.mode,ge),Dc(ge,se),ge.return=X,X=ge)}return w(X);case B:e:{for(Je=se.key;W!==null;){if(W.key===Je)if(W.tag===4&&W.stateNode.containerInfo===se.containerInfo&&W.stateNode.implementation===se.implementation){l(X,W.sibling),ge=f(W,se.children||[]),ge.return=X,X=ge;break e}else{l(X,W);break}else r(X,W);W=W.sibling}ge=Rm(se,X.mode,ge),ge.return=X,X=ge}return w(X);case E:return se=pl(se),Jt(X,W,se,ge)}if(U(se))return Ue(X,W,se,ge);if(P(se)){if(Je=P(se),typeof Je!="function")throw Error(i(150));return se=Je.call(se),at(X,W,se,ge)}if(typeof se.then=="function")return Jt(X,W,$d(se),ge);if(se.$$typeof===H)return Jt(X,W,Ud(X,se),ge);qd(X,se)}return typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint"?(se=""+se,W!==null&&W.tag===6?(l(X,W.sibling),ge=f(W,se),ge.return=X,X=ge):(l(X,W),ge=Cm(se,X.mode,ge),ge.return=X,X=ge),w(X)):l(X,W)}return function(X,W,se,ge){try{Ic=0;var Je=Jt(X,W,se,ge);return co=null,Je}catch(Fe){if(Fe===oo||Fe===zd)throw Fe;var Pt=Yn(29,Fe,null,X.mode);return Pt.lanes=ge,Pt.return=X,Pt}}}var gl=_b(!0),Sb=_b(!1),ci=!1;function $m(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qm(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ui(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function di(s,r,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(Ut&2)!==0){var f=u.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),u.pending=r,r=Od(s),ob(s,null,l),r}return Md(s,u,r,l),Od(s)}function Mc(s,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,$n(s,l)}}function Hm(s,r){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var f=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};p===null?f=p=w:p=p.next=w,l=l.next}while(l!==null);p===null?f=p=r:p=p.next=r}else f=p=r;l={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=r:s.next=r,l.lastBaseUpdate=r}var Gm=!1;function Oc(){if(Gm){var s=lo;if(s!==null)throw s}}function Pc(s,r,l,u){Gm=!1;var f=s.updateQueue;ci=!1;var p=f.firstBaseUpdate,w=f.lastBaseUpdate,A=f.shared.pending;if(A!==null){f.shared.pending=null;var q=A,ne=q.next;q.next=null,w===null?p=ne:w.next=ne,w=q;var me=s.alternate;me!==null&&(me=me.updateQueue,A=me.lastBaseUpdate,A!==w&&(A===null?me.firstBaseUpdate=ne:A.next=ne,me.lastBaseUpdate=q))}if(p!==null){var ve=f.baseState;w=0,me=ne=q=null,A=p;do{var re=A.lane&-536870913,ce=re!==A.lane;if(ce?(St&re)===re:(u&re)===re){re!==0&&re===io&&(Gm=!0),me!==null&&(me=me.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var Ue=s,at=A;re=r;var Jt=l;switch(at.tag){case 1:if(Ue=at.payload,typeof Ue=="function"){ve=Ue.call(Jt,ve,re);break e}ve=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=at.payload,re=typeof Ue=="function"?Ue.call(Jt,ve,re):Ue,re==null)break e;ve=v({},ve,re);break e;case 2:ci=!0}}re=A.callback,re!==null&&(s.flags|=64,ce&&(s.flags|=8192),ce=f.callbacks,ce===null?f.callbacks=[re]:ce.push(re))}else ce={lane:re,tag:A.tag,payload:A.payload,callback:A.callback,next:null},me===null?(ne=me=ce,q=ve):me=me.next=ce,w|=re;if(A=A.next,A===null){if(A=f.shared.pending,A===null)break;ce=A,A=ce.next,ce.next=null,f.lastBaseUpdate=ce,f.shared.pending=null}}while(!0);me===null&&(q=ve),f.baseState=q,f.firstBaseUpdate=ne,f.lastBaseUpdate=me,p===null&&(f.shared.lanes=0),xi|=w,s.lanes=w,s.memoizedState=ve}}function Eb(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function Tb(s,r){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Eb(l[s],r)}var uo=F(null),Hd=F(0);function Ab(s,r){s=Rr,de(Hd,s),de(uo,r),Rr=s|r.baseLanes}function Ym(){de(Hd,Rr),de(uo,uo.current)}function Wm(){Rr=Hd.current,J(uo),J(Hd)}var Wn=F(null),xa=null;function hi(s){var r=s.alternate;de(Rs,Rs.current&1),de(Wn,s),xa===null&&(r===null||uo.current!==null||r.memoizedState!==null)&&(xa=s)}function Km(s){de(Rs,Rs.current),de(Wn,s),xa===null&&(xa=s)}function kb(s){s.tag===22?(de(Rs,Rs.current),de(Wn,s),xa===null&&(xa=s)):fi()}function fi(){de(Rs,Rs.current),de(Wn,Wn.current)}function Kn(s){J(Wn),xa===s&&(xa=null),J(Rs)}var Rs=F(0);function Gd(s){for(var r=s;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||t0(l)||s0(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var jr=0,pt=null,Qt=null,Bs=null,Yd=!1,ho=!1,bl=!1,Wd=0,Vc=0,fo=null,ZS=0;function Ss(){throw Error(i(321))}function Qm(s,r){if(r===null)return!1;for(var l=0;l<r.length&&l<s.length;l++)if(!Gn(s[l],r[l]))return!1;return!0}function Xm(s,r,l,u,f,p){return jr=p,pt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,V.H=s===null||s.memoizedState===null?hy:hp,bl=!1,p=l(u,f),bl=!1,ho&&(p=Rb(r,l,u,f)),Cb(s),p}function Cb(s){V.H=Bc;var r=Qt!==null&&Qt.next!==null;if(jr=0,Bs=Qt=pt=null,Yd=!1,Vc=0,fo=null,r)throw Error(i(300));s===null||zs||(s=s.dependencies,s!==null&&Ld(s)&&(zs=!0))}function Rb(s,r,l,u){pt=s;var f=0;do{if(ho&&(fo=null),Vc=0,ho=!1,25<=f)throw Error(i(301));if(f+=1,Bs=Qt=null,s.updateQueue!=null){var p=s.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}V.H=fy,p=r(l,u)}while(ho);return p}function eE(){var s=V.H,r=s.useState()[0];return r=typeof r.then=="function"?Lc(r):r,s=s.useState()[0],(Qt!==null?Qt.memoizedState:null)!==s&&(pt.flags|=1024),r}function Jm(){var s=Wd!==0;return Wd=0,s}function Zm(s,r,l){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~l}function ep(s){if(Yd){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Yd=!1}jr=0,Bs=Qt=pt=null,ho=!1,Vc=Wd=0,fo=null}function vn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bs===null?pt.memoizedState=Bs=s:Bs=Bs.next=s,Bs}function Is(){if(Qt===null){var s=pt.alternate;s=s!==null?s.memoizedState:null}else s=Qt.next;var r=Bs===null?pt.memoizedState:Bs.next;if(r!==null)Bs=r,Qt=s;else{if(s===null)throw pt.alternate===null?Error(i(467)):Error(i(310));Qt=s,s={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},Bs===null?pt.memoizedState=Bs=s:Bs=Bs.next=s}return Bs}function Kd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Lc(s){var r=Vc;return Vc+=1,fo===null&&(fo=[]),s=wb(fo,s,r),r=pt,(Bs===null?r.memoizedState:Bs.next)===null&&(r=r.alternate,V.H=r===null||r.memoizedState===null?hy:hp),s}function Qd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Lc(s);if(s.$$typeof===H)return nn(s)}throw Error(i(438,String(s)))}function tp(s){var r=null,l=pt.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=pt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=Kd(),pt.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(s),u=0;u<s;u++)l[u]=k;return r.index++,l}function _r(s,r){return typeof r=="function"?r(s):r}function Xd(s){var r=Is();return sp(r,Qt,s)}function sp(s,r,l){var u=s.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var f=s.baseQueue,p=u.pending;if(p!==null){if(f!==null){var w=f.next;f.next=p.next,p.next=w}r.baseQueue=f=p,u.pending=null}if(p=s.baseState,f===null)s.memoizedState=p;else{r=f.next;var A=w=null,q=null,ne=r,me=!1;do{var ve=ne.lane&-536870913;if(ve!==ne.lane?(St&ve)===ve:(jr&ve)===ve){var re=ne.revertLane;if(re===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),ve===io&&(me=!0);else if((jr&re)===re){ne=ne.next,re===io&&(me=!0);continue}else ve={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},q===null?(A=q=ve,w=p):q=q.next=ve,pt.lanes|=re,xi|=re;ve=ne.action,bl&&l(p,ve),p=ne.hasEagerState?ne.eagerState:l(p,ve)}else re={lane:ve,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},q===null?(A=q=re,w=p):q=q.next=re,pt.lanes|=ve,xi|=ve;ne=ne.next}while(ne!==null&&ne!==r);if(q===null?w=p:q.next=A,!Gn(p,s.memoizedState)&&(zs=!0,me&&(l=lo,l!==null)))throw l;s.memoizedState=p,s.baseState=w,s.baseQueue=q,u.lastRenderedState=p}return f===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function np(s){var r=Is(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var u=l.dispatch,f=l.pending,p=r.memoizedState;if(f!==null){l.pending=null;var w=f=f.next;do p=s(p,w.action),w=w.next;while(w!==f);Gn(p,r.memoizedState)||(zs=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),l.lastRenderedState=p}return[p,u]}function Ib(s,r,l){var u=pt,f=Is(),p=It;if(p){if(l===void 0)throw Error(i(407));l=l()}else l=r();var w=!Gn((Qt||f).memoizedState,l);if(w&&(f.memoizedState=l,zs=!0),f=f.queue,ip(Ob.bind(null,u,f,s),[s]),f.getSnapshot!==r||w||Bs!==null&&Bs.memoizedState.tag&1){if(u.flags|=2048,mo(9,{destroy:void 0},Mb.bind(null,u,f,l,r),null),es===null)throw Error(i(349));p||(jr&127)!==0||Db(u,r,l)}return l}function Db(s,r,l){s.flags|=16384,s={getSnapshot:r,value:l},r=pt.updateQueue,r===null?(r=Kd(),pt.updateQueue=r,r.stores=[s]):(l=r.stores,l===null?r.stores=[s]:l.push(s))}function Mb(s,r,l,u){r.value=l,r.getSnapshot=u,Pb(r)&&Vb(s)}function Ob(s,r,l){return l(function(){Pb(r)&&Vb(s)})}function Pb(s){var r=s.getSnapshot;s=s.value;try{var l=r();return!Gn(s,l)}catch{return!0}}function Vb(s){var r=cl(s,2);r!==null&&Cn(r,s,2)}function ap(s){var r=vn();if(typeof s=="function"){var l=s;if(s=l(),bl){gs(!0);try{l()}finally{gs(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:s},r}function Lb(s,r,l,u){return s.baseState=l,sp(s,Qt,typeof u=="function"?u:_r)}function tE(s,r,l,u,f){if(eh(s))throw Error(i(485));if(s=r.action,s!==null){var p={payload:f,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){p.listeners.push(w)}};V.T!==null?l(!0):p.isTransition=!1,u(p),l=r.pending,l===null?(p.next=r.pending=p,Ub(r,p)):(p.next=l.next,r.pending=l.next=p)}}function Ub(s,r){var l=r.action,u=r.payload,f=s.state;if(r.isTransition){var p=V.T,w={};V.T=w;try{var A=l(f,u),q=V.S;q!==null&&q(w,A),Bb(s,r,A)}catch(ne){rp(s,r,ne)}finally{p!==null&&w.types!==null&&(p.types=w.types),V.T=p}}else try{p=l(f,u),Bb(s,r,p)}catch(ne){rp(s,r,ne)}}function Bb(s,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){zb(s,r,u)},function(u){return rp(s,r,u)}):zb(s,r,l)}function zb(s,r,l){r.status="fulfilled",r.value=l,Fb(r),s.state=l,r=s.pending,r!==null&&(l=r.next,l===r?s.pending=null:(l=l.next,r.next=l,Ub(s,l)))}function rp(s,r,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,Fb(r),r=r.next;while(r!==u)}s.action=null}function Fb(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function $b(s,r){return r}function qb(s,r){if(It){var l=es.formState;if(l!==null){e:{var u=pt;if(It){if(us){t:{for(var f=us,p=pa;f.nodeType!==8;){if(!p){f=null;break t}if(f=ga(f.nextSibling),f===null){f=null;break t}}p=f.data,f=p==="F!"||p==="F"?f:null}if(f){us=ga(f.nextSibling),u=f.data==="F!";break e}}li(u)}u=!1}u&&(r=l[0])}}return l=vn(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$b,lastRenderedState:r},l.queue=u,l=cy.bind(null,pt,u),u.dispatch=l,u=ap(!1),p=dp.bind(null,pt,!1,u.queue),u=vn(),f={state:r,dispatch:null,action:s,pending:null},u.queue=f,l=tE.bind(null,pt,f,p,l),f.dispatch=l,u.memoizedState=s,[r,l,!1]}function Hb(s){var r=Is();return Gb(r,Qt,s)}function Gb(s,r,l){if(r=sp(s,r,$b)[0],s=Xd(_r)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=Lc(r)}catch(w){throw w===oo?zd:w}else u=r;r=Is();var f=r.queue,p=f.dispatch;return l!==r.memoizedState&&(pt.flags|=2048,mo(9,{destroy:void 0},sE.bind(null,f,l),null)),[u,p,s]}function sE(s,r){s.action=r}function Yb(s){var r=Is(),l=Qt;if(l!==null)return Gb(r,l,s);Is(),r=r.memoizedState,l=Is();var u=l.queue.dispatch;return l.memoizedState=s,[r,u,!1]}function mo(s,r,l,u){return s={tag:s,create:l,deps:u,inst:r,next:null},r=pt.updateQueue,r===null&&(r=Kd(),pt.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,r.lastEffect=s),s}function Wb(){return Is().memoizedState}function Jd(s,r,l,u){var f=vn();pt.flags|=s,f.memoizedState=mo(1|r,{destroy:void 0},l,u===void 0?null:u)}function Zd(s,r,l,u){var f=Is();u=u===void 0?null:u;var p=f.memoizedState.inst;Qt!==null&&u!==null&&Qm(u,Qt.memoizedState.deps)?f.memoizedState=mo(r,p,l,u):(pt.flags|=s,f.memoizedState=mo(1|r,p,l,u))}function Kb(s,r){Jd(8390656,8,s,r)}function ip(s,r){Zd(2048,8,s,r)}function nE(s){pt.flags|=4;var r=pt.updateQueue;if(r===null)r=Kd(),pt.updateQueue=r,r.events=[s];else{var l=r.events;l===null?r.events=[s]:l.push(s)}}function Qb(s){var r=Is().memoizedState;return nE({ref:r,nextImpl:s}),function(){if((Ut&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Xb(s,r){return Zd(4,2,s,r)}function Jb(s,r){return Zd(4,4,s,r)}function Zb(s,r){if(typeof r=="function"){s=s();var l=r(s);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function ey(s,r,l){l=l!=null?l.concat([s]):null,Zd(4,4,Zb.bind(null,r,s),l)}function lp(){}function ty(s,r){var l=Is();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&Qm(r,u[1])?u[0]:(l.memoizedState=[s,r],s)}function sy(s,r){var l=Is();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&Qm(r,u[1]))return u[0];if(u=s(),bl){gs(!0);try{s()}finally{gs(!1)}}return l.memoizedState=[u,r],u}function op(s,r,l){return l===void 0||(jr&1073741824)!==0&&(St&261930)===0?s.memoizedState=r:(s.memoizedState=l,s=nv(),pt.lanes|=s,xi|=s,l)}function ny(s,r,l,u){return Gn(l,r)?l:uo.current!==null?(s=op(s,l,u),Gn(s,r)||(zs=!0),s):(jr&42)===0||(jr&1073741824)!==0&&(St&261930)===0?(zs=!0,s.memoizedState=l):(s=nv(),pt.lanes|=s,xi|=s,r)}function ay(s,r,l,u,f){var p=K.p;K.p=p!==0&&8>p?p:8;var w=V.T,A={};V.T=A,dp(s,!1,r,l);try{var q=f(),ne=V.S;if(ne!==null&&ne(A,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var me=JS(q,u);Uc(s,r,me,Jn(s))}else Uc(s,r,u,Jn(s))}catch(ve){Uc(s,r,{then:function(){},status:"rejected",reason:ve},Jn())}finally{K.p=p,w!==null&&A.types!==null&&(w.types=A.types),V.T=w}}function aE(){}function cp(s,r,l,u){if(s.tag!==5)throw Error(i(476));var f=ry(s).queue;ay(s,f,r,oe,l===null?aE:function(){return iy(s),l(u)})}function ry(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:oe},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:l},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function iy(s){var r=ry(s);r.next===null&&(r=s.alternate.memoizedState),Uc(s,r.next.queue,{},Jn())}function up(){return nn(su)}function ly(){return Is().memoizedState}function oy(){return Is().memoizedState}function rE(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var l=Jn();s=ui(l);var u=di(r,s,l);u!==null&&(Cn(u,r,l),Mc(u,r,l)),r={cache:Um()},s.payload=r;return}r=r.return}}function iE(s,r,l){var u=Jn();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},eh(s)?uy(r,l):(l=Am(s,r,l,u),l!==null&&(Cn(l,s,u),dy(l,r,u)))}function cy(s,r,l){var u=Jn();Uc(s,r,l,u)}function Uc(s,r,l,u){var f={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(eh(s))uy(r,f);else{var p=s.alternate;if(s.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var w=r.lastRenderedState,A=p(w,l);if(f.hasEagerState=!0,f.eagerState=A,Gn(A,w))return Md(s,r,f,0),es===null&&Dd(),!1}catch{}if(l=Am(s,r,f,u),l!==null)return Cn(l,s,u),dy(l,r,u),!0}return!1}function dp(s,r,l,u){if(u={lane:2,revertLane:$p(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},eh(s)){if(r)throw Error(i(479))}else r=Am(s,l,u,2),r!==null&&Cn(r,s,2)}function eh(s){var r=s.alternate;return s===pt||r!==null&&r===pt}function uy(s,r){ho=Yd=!0;var l=s.pending;l===null?r.next=r:(r.next=l.next,l.next=r),s.pending=r}function dy(s,r,l){if((l&4194048)!==0){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,$n(s,l)}}var Bc={readContext:nn,use:Qd,useCallback:Ss,useContext:Ss,useEffect:Ss,useImperativeHandle:Ss,useLayoutEffect:Ss,useInsertionEffect:Ss,useMemo:Ss,useReducer:Ss,useRef:Ss,useState:Ss,useDebugValue:Ss,useDeferredValue:Ss,useTransition:Ss,useSyncExternalStore:Ss,useId:Ss,useHostTransitionStatus:Ss,useFormState:Ss,useActionState:Ss,useOptimistic:Ss,useMemoCache:Ss,useCacheRefresh:Ss};Bc.useEffectEvent=Ss;var hy={readContext:nn,use:Qd,useCallback:function(s,r){return vn().memoizedState=[s,r===void 0?null:r],s},useContext:nn,useEffect:Kb,useImperativeHandle:function(s,r,l){l=l!=null?l.concat([s]):null,Jd(4194308,4,Zb.bind(null,r,s),l)},useLayoutEffect:function(s,r){return Jd(4194308,4,s,r)},useInsertionEffect:function(s,r){Jd(4,2,s,r)},useMemo:function(s,r){var l=vn();r=r===void 0?null:r;var u=s();if(bl){gs(!0);try{s()}finally{gs(!1)}}return l.memoizedState=[u,r],u},useReducer:function(s,r,l){var u=vn();if(l!==void 0){var f=l(r);if(bl){gs(!0);try{l(r)}finally{gs(!1)}}}else f=r;return u.memoizedState=u.baseState=f,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:f},u.queue=s,s=s.dispatch=iE.bind(null,pt,s),[u.memoizedState,s]},useRef:function(s){var r=vn();return s={current:s},r.memoizedState=s},useState:function(s){s=ap(s);var r=s.queue,l=cy.bind(null,pt,r);return r.dispatch=l,[s.memoizedState,l]},useDebugValue:lp,useDeferredValue:function(s,r){var l=vn();return op(l,s,r)},useTransition:function(){var s=ap(!1);return s=ay.bind(null,pt,s.queue,!0,!1),vn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,l){var u=pt,f=vn();if(It){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),es===null)throw Error(i(349));(St&127)!==0||Db(u,r,l)}f.memoizedState=l;var p={value:l,getSnapshot:r};return f.queue=p,Kb(Ob.bind(null,u,p,s),[s]),u.flags|=2048,mo(9,{destroy:void 0},Mb.bind(null,u,p,l,r),null),l},useId:function(){var s=vn(),r=es.identifierPrefix;if(It){var l=Ja,u=Xa;l=(u&~(1<<32-hs(u)-1)).toString(32)+l,r="_"+r+"R_"+l,l=Wd++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=ZS++,r="_"+r+"r_"+l.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:up,useFormState:qb,useActionState:qb,useOptimistic:function(s){var r=vn();r.memoizedState=r.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=dp.bind(null,pt,!0,l),l.dispatch=r,[s,r]},useMemoCache:tp,useCacheRefresh:function(){return vn().memoizedState=rE.bind(null,pt)},useEffectEvent:function(s){var r=vn(),l={impl:s};return r.memoizedState=l,function(){if((Ut&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},hp={readContext:nn,use:Qd,useCallback:ty,useContext:nn,useEffect:ip,useImperativeHandle:ey,useInsertionEffect:Xb,useLayoutEffect:Jb,useMemo:sy,useReducer:Xd,useRef:Wb,useState:function(){return Xd(_r)},useDebugValue:lp,useDeferredValue:function(s,r){var l=Is();return ny(l,Qt.memoizedState,s,r)},useTransition:function(){var s=Xd(_r)[0],r=Is().memoizedState;return[typeof s=="boolean"?s:Lc(s),r]},useSyncExternalStore:Ib,useId:ly,useHostTransitionStatus:up,useFormState:Hb,useActionState:Hb,useOptimistic:function(s,r){var l=Is();return Lb(l,Qt,s,r)},useMemoCache:tp,useCacheRefresh:oy};hp.useEffectEvent=Qb;var fy={readContext:nn,use:Qd,useCallback:ty,useContext:nn,useEffect:ip,useImperativeHandle:ey,useInsertionEffect:Xb,useLayoutEffect:Jb,useMemo:sy,useReducer:np,useRef:Wb,useState:function(){return np(_r)},useDebugValue:lp,useDeferredValue:function(s,r){var l=Is();return Qt===null?op(l,s,r):ny(l,Qt.memoizedState,s,r)},useTransition:function(){var s=np(_r)[0],r=Is().memoizedState;return[typeof s=="boolean"?s:Lc(s),r]},useSyncExternalStore:Ib,useId:ly,useHostTransitionStatus:up,useFormState:Yb,useActionState:Yb,useOptimistic:function(s,r){var l=Is();return Qt!==null?Lb(l,Qt,s,r):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:tp,useCacheRefresh:oy};fy.useEffectEvent=Qb;function fp(s,r,l,u){r=s.memoizedState,l=l(u,r),l=l==null?r:v({},r,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var mp={enqueueSetState:function(s,r,l){s=s._reactInternals;var u=Jn(),f=ui(u);f.payload=r,l!=null&&(f.callback=l),r=di(s,f,u),r!==null&&(Cn(r,s,u),Mc(r,s,u))},enqueueReplaceState:function(s,r,l){s=s._reactInternals;var u=Jn(),f=ui(u);f.tag=1,f.payload=r,l!=null&&(f.callback=l),r=di(s,f,u),r!==null&&(Cn(r,s,u),Mc(r,s,u))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var l=Jn(),u=ui(l);u.tag=2,r!=null&&(u.callback=r),r=di(s,u,l),r!==null&&(Cn(r,s,l),Mc(r,s,l))}};function my(s,r,l,u,f,p,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,p,w):r.prototype&&r.prototype.isPureReactComponent?!Ec(l,u)||!Ec(f,p):!0}function py(s,r,l,u){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==s&&mp.enqueueReplaceState(r,r.state,null)}function yl(s,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(s=s.defaultProps){l===r&&(l=v({},l));for(var f in s)l[f]===void 0&&(l[f]=s[f])}return l}function xy(s){Id(s)}function gy(s){console.error(s)}function by(s){Id(s)}function th(s,r){try{var l=s.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function yy(s,r,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function pp(s,r,l){return l=ui(l),l.tag=3,l.payload={element:null},l.callback=function(){th(s,r)},l}function vy(s){return s=ui(s),s.tag=3,s}function wy(s,r,l,u){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var p=u.value;s.payload=function(){return f(p)},s.callback=function(){yy(r,l,u)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){yy(r,l,u),typeof f!="function"&&(gi===null?gi=new Set([this]):gi.add(this));var A=u.stack;this.componentDidCatch(u.value,{componentStack:A!==null?A:""})})}function lE(s,r,l,u,f){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&ro(r,l,f,!0),l=Wn.current,l!==null){switch(l.tag){case 31:case 13:return xa===null?fh():l.alternate===null&&Es===0&&(Es=3),l.flags&=-257,l.flags|=65536,l.lanes=f,u===Fd?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),Bp(s,u,f)),!1;case 22:return l.flags|=65536,u===Fd?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),Bp(s,u,f)),!1}throw Error(i(435,l.tag))}return Bp(s,u,f),fh(),!1}if(It)return r=Wn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,u!==Mm&&(s=Error(i(422),{cause:u}),kc(ha(s,l)))):(u!==Mm&&(r=Error(i(423),{cause:u}),kc(ha(r,l))),s=s.current.alternate,s.flags|=65536,f&=-f,s.lanes|=f,u=ha(u,l),f=pp(s.stateNode,u,f),Hm(s,f),Es!==4&&(Es=2)),!1;var p=Error(i(520),{cause:u});if(p=ha(p,l),Wc===null?Wc=[p]:Wc.push(p),Es!==4&&(Es=2),r===null)return!0;u=ha(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,s=f&-f,l.lanes|=s,s=pp(l.stateNode,u,s),Hm(l,s),!1;case 1:if(r=l.type,p=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(gi===null||!gi.has(p))))return l.flags|=65536,f&=-f,l.lanes|=f,f=vy(f),wy(f,s,l,u),Hm(l,f),!1}l=l.return}while(l!==null);return!1}var xp=Error(i(461)),zs=!1;function an(s,r,l,u){r.child=s===null?Sb(r,null,l,u):gl(r,s.child,l,u)}function Ny(s,r,l,u,f){l=l.render;var p=r.ref;if("ref"in u){var w={};for(var A in u)A!=="ref"&&(w[A]=u[A])}else w=u;return fl(r),u=Xm(s,r,l,w,p,f),A=Jm(),s!==null&&!zs?(Zm(s,r,f),Sr(s,r,f)):(It&&A&&Im(r),r.flags|=1,an(s,r,u,f),r.child)}function jy(s,r,l,u,f){if(s===null){var p=l.type;return typeof p=="function"&&!km(p)&&p.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=p,_y(s,r,p,u,f)):(s=Pd(l.type,null,u,r,r.mode,f),s.ref=r.ref,s.return=r,r.child=s)}if(p=s.child,!_p(s,f)){var w=p.memoizedProps;if(l=l.compare,l=l!==null?l:Ec,l(w,u)&&s.ref===r.ref)return Sr(s,r,f)}return r.flags|=1,s=yr(p,u),s.ref=r.ref,s.return=r,r.child=s}function _y(s,r,l,u,f){if(s!==null){var p=s.memoizedProps;if(Ec(p,u)&&s.ref===r.ref)if(zs=!1,r.pendingProps=u=p,_p(s,f))(s.flags&131072)!==0&&(zs=!0);else return r.lanes=s.lanes,Sr(s,r,f)}return gp(s,r,l,u,f)}function Sy(s,r,l,u){var f=u.children,p=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((r.flags&128)!==0){if(p=p!==null?p.baseLanes|l:l,s!==null){for(u=r.child=s.child,f=0;u!==null;)f=f|u.lanes|u.childLanes,u=u.sibling;u=f&~p}else u=0,r.child=null;return Ey(s,r,p,l,u)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&Bd(r,p!==null?p.cachePool:null),p!==null?Ab(r,p):Ym(),kb(r);else return u=r.lanes=536870912,Ey(s,r,p!==null?p.baseLanes|l:l,l,u)}else p!==null?(Bd(r,p.cachePool),Ab(r,p),fi(),r.memoizedState=null):(s!==null&&Bd(r,null),Ym(),fi());return an(s,r,f,l),r.child}function zc(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Ey(s,r,l,u,f){var p=zm();return p=p===null?null:{parent:Us._currentValue,pool:p},r.memoizedState={baseLanes:l,cachePool:p},s!==null&&Bd(r,null),Ym(),kb(r),s!==null&&ro(s,r,u,!0),r.childLanes=f,null}function sh(s,r){return r=ah({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function Ty(s,r,l){return gl(r,s.child,null,l),s=sh(r,r.pendingProps),s.flags|=2,Kn(r),r.memoizedState=null,s}function oE(s,r,l){var u=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(It){if(u.mode==="hidden")return s=sh(r,u),r.lanes=536870912,zc(null,s);if(Km(r),(s=us)?(s=Uv(s,pa),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:ri!==null?{id:Xa,overflow:Ja}:null,retryLane:536870912,hydrationErrors:null},l=ub(s),l.return=r,r.child=l,sn=r,us=null)):s=null,s===null)throw li(r);return r.lanes=536870912,null}return sh(r,u)}var p=s.memoizedState;if(p!==null){var w=p.dehydrated;if(Km(r),f)if(r.flags&256)r.flags&=-257,r=Ty(s,r,l);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(zs||ro(s,r,l,!1),f=(l&s.childLanes)!==0,zs||f){if(u=es,u!==null&&(w=_a(u,l),w!==0&&w!==p.retryLane))throw p.retryLane=w,cl(s,w),Cn(u,s,w),xp;fh(),r=Ty(s,r,l)}else s=p.treeContext,us=ga(w.nextSibling),sn=r,It=!0,ii=null,pa=!1,s!==null&&fb(r,s),r=sh(r,u),r.flags|=4096;return r}return s=yr(s.child,{mode:u.mode,children:u.children}),s.ref=r.ref,r.child=s,s.return=r,s}function nh(s,r){var l=r.ref;if(l===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(r.flags|=4194816)}}function gp(s,r,l,u,f){return fl(r),l=Xm(s,r,l,u,void 0,f),u=Jm(),s!==null&&!zs?(Zm(s,r,f),Sr(s,r,f)):(It&&u&&Im(r),r.flags|=1,an(s,r,l,f),r.child)}function Ay(s,r,l,u,f,p){return fl(r),r.updateQueue=null,l=Rb(r,u,l,f),Cb(s),u=Jm(),s!==null&&!zs?(Zm(s,r,p),Sr(s,r,p)):(It&&u&&Im(r),r.flags|=1,an(s,r,l,p),r.child)}function ky(s,r,l,u,f){if(fl(r),r.stateNode===null){var p=to,w=l.contextType;typeof w=="object"&&w!==null&&(p=nn(w)),p=new l(u,p),r.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=mp,r.stateNode=p,p._reactInternals=r,p=r.stateNode,p.props=u,p.state=r.memoizedState,p.refs={},$m(r),w=l.contextType,p.context=typeof w=="object"&&w!==null?nn(w):to,p.state=r.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(fp(r,l,w,u),p.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(w=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),w!==p.state&&mp.enqueueReplaceState(p,p.state,null),Pc(r,u,p,f),Oc(),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(s===null){p=r.stateNode;var A=r.memoizedProps,q=yl(l,A);p.props=q;var ne=p.context,me=l.contextType;w=to,typeof me=="object"&&me!==null&&(w=nn(me));var ve=l.getDerivedStateFromProps;me=typeof ve=="function"||typeof p.getSnapshotBeforeUpdate=="function",A=r.pendingProps!==A,me||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(A||ne!==w)&&py(r,p,u,w),ci=!1;var re=r.memoizedState;p.state=re,Pc(r,u,p,f),Oc(),ne=r.memoizedState,A||re!==ne||ci?(typeof ve=="function"&&(fp(r,l,ve,u),ne=r.memoizedState),(q=ci||my(r,l,q,u,re,ne,w))?(me||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(r.flags|=4194308)):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=ne),p.props=u,p.state=ne,p.context=w,u=q):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{p=r.stateNode,qm(s,r),w=r.memoizedProps,me=yl(l,w),p.props=me,ve=r.pendingProps,re=p.context,ne=l.contextType,q=to,typeof ne=="object"&&ne!==null&&(q=nn(ne)),A=l.getDerivedStateFromProps,(ne=typeof A=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(w!==ve||re!==q)&&py(r,p,u,q),ci=!1,re=r.memoizedState,p.state=re,Pc(r,u,p,f),Oc();var ce=r.memoizedState;w!==ve||re!==ce||ci||s!==null&&s.dependencies!==null&&Ld(s.dependencies)?(typeof A=="function"&&(fp(r,l,A,u),ce=r.memoizedState),(me=ci||my(r,l,me,u,re,ce,q)||s!==null&&s.dependencies!==null&&Ld(s.dependencies))?(ne||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,ce,q),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,ce,q)),typeof p.componentDidUpdate=="function"&&(r.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof p.componentDidUpdate!="function"||w===s.memoizedProps&&re===s.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&re===s.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=ce),p.props=u,p.state=ce,p.context=q,u=me):(typeof p.componentDidUpdate!="function"||w===s.memoizedProps&&re===s.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&re===s.memoizedState||(r.flags|=1024),u=!1)}return p=u,nh(s,r),u=(r.flags&128)!==0,p||u?(p=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:p.render(),r.flags|=1,s!==null&&u?(r.child=gl(r,s.child,null,f),r.child=gl(r,null,l,f)):an(s,r,l,f),r.memoizedState=p.state,s=r.child):s=Sr(s,r,f),s}function Cy(s,r,l,u){return dl(),r.flags|=256,an(s,r,l,u),r.child}var bp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function yp(s){return{baseLanes:s,cachePool:yb()}}function vp(s,r,l){return s=s!==null?s.childLanes&~l:0,r&&(s|=Xn),s}function Ry(s,r,l){var u=r.pendingProps,f=!1,p=(r.flags&128)!==0,w;if((w=p)||(w=s!==null&&s.memoizedState===null?!1:(Rs.current&2)!==0),w&&(f=!0,r.flags&=-129),w=(r.flags&32)!==0,r.flags&=-33,s===null){if(It){if(f?hi(r):fi(),(s=us)?(s=Uv(s,pa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:ri!==null?{id:Xa,overflow:Ja}:null,retryLane:536870912,hydrationErrors:null},l=ub(s),l.return=r,r.child=l,sn=r,us=null)):s=null,s===null)throw li(r);return s0(s)?r.lanes=32:r.lanes=536870912,null}var A=u.children;return u=u.fallback,f?(fi(),f=r.mode,A=ah({mode:"hidden",children:A},f),u=ul(u,f,l,null),A.return=r,u.return=r,A.sibling=u,r.child=A,u=r.child,u.memoizedState=yp(l),u.childLanes=vp(s,w,l),r.memoizedState=bp,zc(null,u)):(hi(r),wp(r,A))}var q=s.memoizedState;if(q!==null&&(A=q.dehydrated,A!==null)){if(p)r.flags&256?(hi(r),r.flags&=-257,r=Np(s,r,l)):r.memoizedState!==null?(fi(),r.child=s.child,r.flags|=128,r=null):(fi(),A=u.fallback,f=r.mode,u=ah({mode:"visible",children:u.children},f),A=ul(A,f,l,null),A.flags|=2,u.return=r,A.return=r,u.sibling=A,r.child=u,gl(r,s.child,null,l),u=r.child,u.memoizedState=yp(l),u.childLanes=vp(s,w,l),r.memoizedState=bp,r=zc(null,u));else if(hi(r),s0(A)){if(w=A.nextSibling&&A.nextSibling.dataset,w)var ne=w.dgst;w=ne,u=Error(i(419)),u.stack="",u.digest=w,kc({value:u,source:null,stack:null}),r=Np(s,r,l)}else if(zs||ro(s,r,l,!1),w=(l&s.childLanes)!==0,zs||w){if(w=es,w!==null&&(u=_a(w,l),u!==0&&u!==q.retryLane))throw q.retryLane=u,cl(s,u),Cn(w,s,u),xp;t0(A)||fh(),r=Np(s,r,l)}else t0(A)?(r.flags|=192,r.child=s.child,r=null):(s=q.treeContext,us=ga(A.nextSibling),sn=r,It=!0,ii=null,pa=!1,s!==null&&fb(r,s),r=wp(r,u.children),r.flags|=4096);return r}return f?(fi(),A=u.fallback,f=r.mode,q=s.child,ne=q.sibling,u=yr(q,{mode:"hidden",children:u.children}),u.subtreeFlags=q.subtreeFlags&65011712,ne!==null?A=yr(ne,A):(A=ul(A,f,l,null),A.flags|=2),A.return=r,u.return=r,u.sibling=A,r.child=u,zc(null,u),u=r.child,A=s.child.memoizedState,A===null?A=yp(l):(f=A.cachePool,f!==null?(q=Us._currentValue,f=f.parent!==q?{parent:q,pool:q}:f):f=yb(),A={baseLanes:A.baseLanes|l,cachePool:f}),u.memoizedState=A,u.childLanes=vp(s,w,l),r.memoizedState=bp,zc(s.child,u)):(hi(r),l=s.child,s=l.sibling,l=yr(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,s!==null&&(w=r.deletions,w===null?(r.deletions=[s],r.flags|=16):w.push(s)),r.child=l,r.memoizedState=null,l)}function wp(s,r){return r=ah({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function ah(s,r){return s=Yn(22,s,null,r),s.lanes=0,s}function Np(s,r,l){return gl(r,s.child,null,l),s=wp(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function Iy(s,r,l){s.lanes|=r;var u=s.alternate;u!==null&&(u.lanes|=r),Vm(s.return,r,l)}function jp(s,r,l,u,f,p){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:f,treeForkCount:p}:(w.isBackwards=r,w.rendering=null,w.renderingStartTime=0,w.last=u,w.tail=l,w.tailMode=f,w.treeForkCount=p)}function Dy(s,r,l){var u=r.pendingProps,f=u.revealOrder,p=u.tail;u=u.children;var w=Rs.current,A=(w&2)!==0;if(A?(w=w&1|2,r.flags|=128):w&=1,de(Rs,w),an(s,r,u,l),u=It?Ac:0,!A&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Iy(s,l,r);else if(s.tag===19)Iy(s,l,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(f){case"forwards":for(l=r.child,f=null;l!==null;)s=l.alternate,s!==null&&Gd(s)===null&&(f=l),l=l.sibling;l=f,l===null?(f=r.child,r.child=null):(f=l.sibling,l.sibling=null),jp(r,!1,f,l,p,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,f=r.child,r.child=null;f!==null;){if(s=f.alternate,s!==null&&Gd(s)===null){r.child=f;break}s=f.sibling,f.sibling=l,l=f,f=s}jp(r,!0,l,null,p,u);break;case"together":jp(r,!1,null,null,void 0,u);break;default:r.memoizedState=null}return r.child}function Sr(s,r,l){if(s!==null&&(r.dependencies=s.dependencies),xi|=r.lanes,(l&r.childLanes)===0)if(s!==null){if(ro(s,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,l=yr(s,s.pendingProps),r.child=l,l.return=r;s.sibling!==null;)s=s.sibling,l=l.sibling=yr(s,s.pendingProps),l.return=r;l.sibling=null}return r.child}function _p(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&Ld(s)))}function cE(s,r,l){switch(r.tag){case 3:Ct(r,r.stateNode.containerInfo),oi(r,Us,s.memoizedState.cache),dl();break;case 27:case 5:qt(r);break;case 4:Ct(r,r.stateNode.containerInfo);break;case 10:oi(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Km(r),null;break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(hi(r),r.flags|=128,null):(l&r.child.childLanes)!==0?Ry(s,r,l):(hi(r),s=Sr(s,r,l),s!==null?s.sibling:null);hi(r);break;case 19:var f=(s.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||(ro(s,r,l,!1),u=(l&r.childLanes)!==0),f){if(u)return Dy(s,r,l);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),de(Rs,Rs.current),u)break;return null;case 22:return r.lanes=0,Sy(s,r,l,r.pendingProps);case 24:oi(r,Us,s.memoizedState.cache)}return Sr(s,r,l)}function My(s,r,l){if(s!==null)if(s.memoizedProps!==r.pendingProps)zs=!0;else{if(!_p(s,l)&&(r.flags&128)===0)return zs=!1,cE(s,r,l);zs=(s.flags&131072)!==0}else zs=!1,It&&(r.flags&1048576)!==0&&hb(r,Ac,r.index);switch(r.lanes=0,r.tag){case 16:e:{var u=r.pendingProps;if(s=pl(r.elementType),r.type=s,typeof s=="function")km(s)?(u=yl(s,u),r.tag=1,r=ky(null,r,s,u,l)):(r.tag=0,r=gp(null,r,s,u,l));else{if(s!=null){var f=s.$$typeof;if(f===ae){r.tag=11,r=Ny(null,r,s,u,l);break e}else if(f===T){r.tag=14,r=jy(null,r,s,u,l);break e}}throw r=$(s)||s,Error(i(306,r,""))}}return r;case 0:return gp(s,r,r.type,r.pendingProps,l);case 1:return u=r.type,f=yl(u,r.pendingProps),ky(s,r,u,f,l);case 3:e:{if(Ct(r,r.stateNode.containerInfo),s===null)throw Error(i(387));u=r.pendingProps;var p=r.memoizedState;f=p.element,qm(s,r),Pc(r,u,null,l);var w=r.memoizedState;if(u=w.cache,oi(r,Us,u),u!==p.cache&&Lm(r,[Us],l,!0),Oc(),u=w.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:w.cache},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){r=Cy(s,r,u,l);break e}else if(u!==f){f=ha(Error(i(424)),r),kc(f),r=Cy(s,r,u,l);break e}else for(s=r.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,us=ga(s.firstChild),sn=r,It=!0,ii=null,pa=!0,l=Sb(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(dl(),u===f){r=Sr(s,r,l);break e}an(s,r,u,l)}r=r.child}return r;case 26:return nh(s,r),s===null?(l=Hv(r.type,null,r.pendingProps,null))?r.memoizedState=l:It||(l=r.type,s=r.pendingProps,u=vh(Ce.current).createElement(l),u[os]=r,u[D]=s,rn(u,l,s),fs(u),r.stateNode=u):r.memoizedState=Hv(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return qt(r),s===null&&It&&(u=r.stateNode=Fv(r.type,r.pendingProps,Ce.current),sn=r,pa=!0,f=us,wi(r.type)?(n0=f,us=ga(u.firstChild)):us=f),an(s,r,r.pendingProps.children,l),nh(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&It&&((f=u=us)&&(u=UE(u,r.type,r.pendingProps,pa),u!==null?(r.stateNode=u,sn=r,us=ga(u.firstChild),pa=!1,f=!0):f=!1),f||li(r)),qt(r),f=r.type,p=r.pendingProps,w=s!==null?s.memoizedProps:null,u=p.children,Jp(f,p)?u=null:w!==null&&Jp(f,w)&&(r.flags|=32),r.memoizedState!==null&&(f=Xm(s,r,eE,null,null,l),su._currentValue=f),nh(s,r),an(s,r,u,l),r.child;case 6:return s===null&&It&&((s=l=us)&&(l=BE(l,r.pendingProps,pa),l!==null?(r.stateNode=l,sn=r,us=null,s=!0):s=!1),s||li(r)),null;case 13:return Ry(s,r,l);case 4:return Ct(r,r.stateNode.containerInfo),u=r.pendingProps,s===null?r.child=gl(r,null,u,l):an(s,r,u,l),r.child;case 11:return Ny(s,r,r.type,r.pendingProps,l);case 7:return an(s,r,r.pendingProps,l),r.child;case 8:return an(s,r,r.pendingProps.children,l),r.child;case 12:return an(s,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,oi(r,r.type,u.value),an(s,r,u.children,l),r.child;case 9:return f=r.type._context,u=r.pendingProps.children,fl(r),f=nn(f),u=u(f),r.flags|=1,an(s,r,u,l),r.child;case 14:return jy(s,r,r.type,r.pendingProps,l);case 15:return _y(s,r,r.type,r.pendingProps,l);case 19:return Dy(s,r,l);case 31:return oE(s,r,l);case 22:return Sy(s,r,l,r.pendingProps);case 24:return fl(r),u=nn(Us),s===null?(f=zm(),f===null&&(f=es,p=Um(),f.pooledCache=p,p.refCount++,p!==null&&(f.pooledCacheLanes|=l),f=p),r.memoizedState={parent:u,cache:f},$m(r),oi(r,Us,f)):((s.lanes&l)!==0&&(qm(s,r),Pc(r,null,null,l),Oc()),f=s.memoizedState,p=r.memoizedState,f.parent!==u?(f={parent:u,cache:u},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),oi(r,Us,u)):(u=p.cache,oi(r,Us,u),u!==f.cache&&Lm(r,[Us],l,!0))),an(s,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Er(s){s.flags|=4}function Sp(s,r,l,u,f){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(f&335544128)===f)if(s.stateNode.complete)s.flags|=8192;else if(lv())s.flags|=8192;else throw xl=Fd,Fm}else s.flags&=-16777217}function Oy(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Qv(r))if(lv())s.flags|=8192;else throw xl=Fd,Fm}function rh(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?st():536870912,s.lanes|=r,bo|=r)}function Fc(s,r){if(!It)switch(s.tailMode){case"hidden":r=s.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function ds(s){var r=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(r)for(var f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=s,f=f.sibling;else for(f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=s,f=f.sibling;return s.subtreeFlags|=u,s.childLanes=l,r}function uE(s,r,l){var u=r.pendingProps;switch(Dm(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ds(r),null;case 1:return ds(r),null;case 3:return l=r.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),Nr(Us),ot(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(ao(r)?Er(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Om())),ds(r),null;case 26:var f=r.type,p=r.memoizedState;return s===null?(Er(r),p!==null?(ds(r),Oy(r,p)):(ds(r),Sp(r,f,null,u,l))):p?p!==s.memoizedState?(Er(r),ds(r),Oy(r,p)):(ds(r),r.flags&=-16777217):(s=s.memoizedProps,s!==u&&Er(r),ds(r),Sp(r,f,s,u,l)),null;case 27:if(Z(r),l=Ce.current,f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&Er(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return ds(r),null}s=xe.current,ao(r)?mb(r):(s=Fv(f,u,l),r.stateNode=s,Er(r))}return ds(r),null;case 5:if(Z(r),f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&Er(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return ds(r),null}if(p=xe.current,ao(r))mb(r);else{var w=vh(Ce.current);switch(p){case 1:p=w.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:p=w.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":p=w.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":p=w.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":p=w.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof u.is=="string"?w.createElement("select",{is:u.is}):w.createElement("select"),u.multiple?p.multiple=!0:u.size&&(p.size=u.size);break;default:p=typeof u.is=="string"?w.createElement(f,{is:u.is}):w.createElement(f)}}p[os]=r,p[D]=u;e:for(w=r.child;w!==null;){if(w.tag===5||w.tag===6)p.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===r)break e;for(;w.sibling===null;){if(w.return===null||w.return===r)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}r.stateNode=p;e:switch(rn(p,f,u),f){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Er(r)}}return ds(r),Sp(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,l),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==u&&Er(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(s=Ce.current,ao(r)){if(s=r.stateNode,l=r.memoizedProps,u=null,f=sn,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}s[os]=r,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||Rv(s.nodeValue,l)),s||li(r,!0)}else s=vh(s).createTextNode(u),s[os]=r,r.stateNode=s}return ds(r),null;case 31:if(l=r.memoizedState,s===null||s.memoizedState!==null){if(u=ao(r),l!==null){if(s===null){if(!u)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[os]=r}else dl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ds(r),s=!1}else l=Om(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return r.flags&256?(Kn(r),r):(Kn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return ds(r),null;case 13:if(u=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(f=ao(r),u!==null&&u.dehydrated!==null){if(s===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[os]=r}else dl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ds(r),f=!1}else f=Om(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Kn(r),r):(Kn(r),null)}return Kn(r),(r.flags&128)!==0?(r.lanes=l,r):(l=u!==null,s=s!==null&&s.memoizedState!==null,l&&(u=r.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==f&&(u.flags|=2048)),l!==s&&l&&(r.child.flags|=8192),rh(r,r.updateQueue),ds(r),null);case 4:return ot(),s===null&&Yp(r.stateNode.containerInfo),ds(r),null;case 10:return Nr(r.type),ds(r),null;case 19:if(J(Rs),u=r.memoizedState,u===null)return ds(r),null;if(f=(r.flags&128)!==0,p=u.rendering,p===null)if(f)Fc(u,!1);else{if(Es!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(p=Gd(s),p!==null){for(r.flags|=128,Fc(u,!1),s=p.updateQueue,r.updateQueue=s,rh(r,s),r.subtreeFlags=0,s=l,l=r.child;l!==null;)cb(l,s),l=l.sibling;return de(Rs,Rs.current&1|2),It&&vr(r,u.treeForkCount),r.child}s=s.sibling}u.tail!==null&&Le()>uh&&(r.flags|=128,f=!0,Fc(u,!1),r.lanes=4194304)}else{if(!f)if(s=Gd(p),s!==null){if(r.flags|=128,f=!0,s=s.updateQueue,r.updateQueue=s,rh(r,s),Fc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!p.alternate&&!It)return ds(r),null}else 2*Le()-u.renderingStartTime>uh&&l!==536870912&&(r.flags|=128,f=!0,Fc(u,!1),r.lanes=4194304);u.isBackwards?(p.sibling=r.child,r.child=p):(s=u.last,s!==null?s.sibling=p:r.child=p,u.last=p)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=Le(),s.sibling=null,l=Rs.current,de(Rs,f?l&1|2:l&1),It&&vr(r,u.treeForkCount),s):(ds(r),null);case 22:case 23:return Kn(r),Wm(),u=r.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(ds(r),r.subtreeFlags&6&&(r.flags|=8192)):ds(r),l=r.updateQueue,l!==null&&rh(r,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),s!==null&&J(ml),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),Nr(Us),ds(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function dE(s,r){switch(Dm(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return Nr(Us),ot(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return Z(r),null;case 31:if(r.memoizedState!==null){if(Kn(r),r.alternate===null)throw Error(i(340));dl()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(Kn(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));dl()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return J(Rs),null;case 4:return ot(),null;case 10:return Nr(r.type),null;case 22:case 23:return Kn(r),Wm(),s!==null&&J(ml),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return Nr(Us),null;case 25:return null;default:return null}}function Py(s,r){switch(Dm(r),r.tag){case 3:Nr(Us),ot();break;case 26:case 27:case 5:Z(r);break;case 4:ot();break;case 31:r.memoizedState!==null&&Kn(r);break;case 13:Kn(r);break;case 19:J(Rs);break;case 10:Nr(r.type);break;case 22:case 23:Kn(r),Wm(),s!==null&&J(ml);break;case 24:Nr(Us)}}function $c(s,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&s)===s){u=void 0;var p=l.create,w=l.inst;u=p(),w.destroy=u}l=l.next}while(l!==f)}}catch(A){Yt(r,r.return,A)}}function mi(s,r,l){try{var u=r.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var p=f.next;u=p;do{if((u.tag&s)===s){var w=u.inst,A=w.destroy;if(A!==void 0){w.destroy=void 0,f=r;var q=l,ne=A;try{ne()}catch(me){Yt(f,q,me)}}}u=u.next}while(u!==p)}}catch(me){Yt(r,r.return,me)}}function Vy(s){var r=s.updateQueue;if(r!==null){var l=s.stateNode;try{Tb(r,l)}catch(u){Yt(s,s.return,u)}}}function Ly(s,r,l){l.props=yl(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){Yt(s,r,u)}}function qc(s,r){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(f){Yt(s,r,f)}}function Za(s,r){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(f){Yt(s,r,f)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){Yt(s,r,f)}else l.current=null}function Uy(s){var r=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(f){Yt(s,s.return,f)}}function Ep(s,r,l){try{var u=s.stateNode;DE(u,s.type,l,r),u[D]=r}catch(f){Yt(s,s.return,f)}}function By(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&wi(s.type)||s.tag===4}function Tp(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||By(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&wi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Ap(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(s),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Sa));else if(u!==4&&(u===27&&wi(s.type)&&(l=s.stateNode,r=null),s=s.child,s!==null))for(Ap(s,r,l),s=s.sibling;s!==null;)Ap(s,r,l),s=s.sibling}function ih(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?l.insertBefore(s,r):l.appendChild(s);else if(u!==4&&(u===27&&wi(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(ih(s,r,l),s=s.sibling;s!==null;)ih(s,r,l),s=s.sibling}function zy(s){var r=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);rn(r,u,l),r[os]=s,r[D]=l}catch(p){Yt(s,s.return,p)}}var Tr=!1,Fs=!1,kp=!1,Fy=typeof WeakSet=="function"?WeakSet:Set,Js=null;function hE(s,r){if(s=s.containerInfo,Qp=Th,s=eb(s),Nm(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var f=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var w=0,A=-1,q=-1,ne=0,me=0,ve=s,re=null;t:for(;;){for(var ce;ve!==l||f!==0&&ve.nodeType!==3||(A=w+f),ve!==p||u!==0&&ve.nodeType!==3||(q=w+u),ve.nodeType===3&&(w+=ve.nodeValue.length),(ce=ve.firstChild)!==null;)re=ve,ve=ce;for(;;){if(ve===s)break t;if(re===l&&++ne===f&&(A=w),re===p&&++me===u&&(q=w),(ce=ve.nextSibling)!==null)break;ve=re,re=ve.parentNode}ve=ce}l=A===-1||q===-1?null:{start:A,end:q}}else l=null}l=l||{start:0,end:0}}else l=null;for(Xp={focusedElem:s,selectionRange:l},Th=!1,Js=r;Js!==null;)if(r=Js,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,Js=s;else for(;Js!==null;){switch(r=Js,p=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)f=s[l],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&p!==null){s=void 0,l=r,f=p.memoizedProps,p=p.memoizedState,u=l.stateNode;try{var Ue=yl(l.type,f);s=u.getSnapshotBeforeUpdate(Ue,p),u.__reactInternalSnapshotBeforeUpdate=s}catch(at){Yt(l,l.return,at)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,l=s.nodeType,l===9)e0(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":e0(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,Js=s;break}Js=r.return}}function $y(s,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:kr(s,l),u&4&&$c(5,l);break;case 1:if(kr(s,l),u&4)if(s=l.stateNode,r===null)try{s.componentDidMount()}catch(w){Yt(l,l.return,w)}else{var f=yl(l.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(f,r,s.__reactInternalSnapshotBeforeUpdate)}catch(w){Yt(l,l.return,w)}}u&64&&Vy(l),u&512&&qc(l,l.return);break;case 3:if(kr(s,l),u&64&&(s=l.updateQueue,s!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Tb(s,r)}catch(w){Yt(l,l.return,w)}}break;case 27:r===null&&u&4&&zy(l);case 26:case 5:kr(s,l),r===null&&u&4&&Uy(l),u&512&&qc(l,l.return);break;case 12:kr(s,l);break;case 31:kr(s,l),u&4&&Gy(s,l);break;case 13:kr(s,l),u&4&&Yy(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=wE.bind(null,l),zE(s,l))));break;case 22:if(u=l.memoizedState!==null||Tr,!u){r=r!==null&&r.memoizedState!==null||Fs,f=Tr;var p=Fs;Tr=u,(Fs=r)&&!p?Cr(s,l,(l.subtreeFlags&8772)!==0):kr(s,l),Tr=f,Fs=p}break;case 30:break;default:kr(s,l)}}function qy(s){var r=s.alternate;r!==null&&(s.alternate=null,qy(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Xe(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ps=null,En=!1;function Ar(s,r,l){for(l=l.child;l!==null;)Hy(s,r,l),l=l.sibling}function Hy(s,r,l){if(yt&&typeof yt.onCommitFiberUnmount=="function")try{yt.onCommitFiberUnmount(is,l)}catch{}switch(l.tag){case 26:Fs||Za(l,r),Ar(s,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Fs||Za(l,r);var u=ps,f=En;wi(l.type)&&(ps=l.stateNode,En=!1),Ar(s,r,l),Zc(l.stateNode),ps=u,En=f;break;case 5:Fs||Za(l,r);case 6:if(u=ps,f=En,ps=null,Ar(s,r,l),ps=u,En=f,ps!==null)if(En)try{(ps.nodeType===9?ps.body:ps.nodeName==="HTML"?ps.ownerDocument.body:ps).removeChild(l.stateNode)}catch(p){Yt(l,r,p)}else try{ps.removeChild(l.stateNode)}catch(p){Yt(l,r,p)}break;case 18:ps!==null&&(En?(s=ps,Vv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Eo(s)):Vv(ps,l.stateNode));break;case 4:u=ps,f=En,ps=l.stateNode.containerInfo,En=!0,Ar(s,r,l),ps=u,En=f;break;case 0:case 11:case 14:case 15:mi(2,l,r),Fs||mi(4,l,r),Ar(s,r,l);break;case 1:Fs||(Za(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&Ly(l,r,u)),Ar(s,r,l);break;case 21:Ar(s,r,l);break;case 22:Fs=(u=Fs)||l.memoizedState!==null,Ar(s,r,l),Fs=u;break;default:Ar(s,r,l)}}function Gy(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Eo(s)}catch(l){Yt(r,r.return,l)}}}function Yy(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Eo(s)}catch(l){Yt(r,r.return,l)}}function fE(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new Fy),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new Fy),r;default:throw Error(i(435,s.tag))}}function lh(s,r){var l=fE(s);r.forEach(function(u){if(!l.has(u)){l.add(u);var f=NE.bind(null,s,u);u.then(f,f)}})}function Tn(s,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var f=l[u],p=s,w=r,A=w;e:for(;A!==null;){switch(A.tag){case 27:if(wi(A.type)){ps=A.stateNode,En=!1;break e}break;case 5:ps=A.stateNode,En=!1;break e;case 3:case 4:ps=A.stateNode.containerInfo,En=!0;break e}A=A.return}if(ps===null)throw Error(i(160));Hy(p,w,f),ps=null,En=!1,p=f.alternate,p!==null&&(p.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Wy(r,s),r=r.sibling}var Ra=null;function Wy(s,r){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Tn(r,s),An(s),u&4&&(mi(3,s,s.return),$c(3,s),mi(5,s,s.return));break;case 1:Tn(r,s),An(s),u&512&&(Fs||l===null||Za(l,l.return)),u&64&&Tr&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var f=Ra;if(Tn(r,s),An(s),u&512&&(Fs||l===null||Za(l,l.return)),u&4){var p=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":p=f.getElementsByTagName("title")[0],(!p||p[ut]||p[os]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=f.createElement(u),f.head.insertBefore(p,f.querySelector("head > title"))),rn(p,u,l),p[os]=s,fs(p),u=p;break e;case"link":var w=Wv("link","href",f).get(u+(l.href||""));if(w){for(var A=0;A<w.length;A++)if(p=w[A],p.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&p.getAttribute("rel")===(l.rel==null?null:l.rel)&&p.getAttribute("title")===(l.title==null?null:l.title)&&p.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(A,1);break t}}p=f.createElement(u),rn(p,u,l),f.head.appendChild(p);break;case"meta":if(w=Wv("meta","content",f).get(u+(l.content||""))){for(A=0;A<w.length;A++)if(p=w[A],p.getAttribute("content")===(l.content==null?null:""+l.content)&&p.getAttribute("name")===(l.name==null?null:l.name)&&p.getAttribute("property")===(l.property==null?null:l.property)&&p.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&p.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(A,1);break t}}p=f.createElement(u),rn(p,u,l),f.head.appendChild(p);break;default:throw Error(i(468,u))}p[os]=s,fs(p),u=p}s.stateNode=u}else Kv(f,s.type,s.stateNode);else s.stateNode=Yv(f,u,s.memoizedProps);else p!==u?(p===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):p.count--,u===null?Kv(f,s.type,s.stateNode):Yv(f,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Ep(s,s.memoizedProps,l.memoizedProps)}break;case 27:Tn(r,s),An(s),u&512&&(Fs||l===null||Za(l,l.return)),l!==null&&u&4&&Ep(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Tn(r,s),An(s),u&512&&(Fs||l===null||Za(l,l.return)),s.flags&32){f=s.stateNode;try{Sn(f,"")}catch(Ue){Yt(s,s.return,Ue)}}u&4&&s.stateNode!=null&&(f=s.memoizedProps,Ep(s,f,l!==null?l.memoizedProps:f)),u&1024&&(kp=!0);break;case 6:if(Tn(r,s),An(s),u&4){if(s.stateNode===null)throw Error(i(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(Ue){Yt(s,s.return,Ue)}}break;case 3:if(jh=null,f=Ra,Ra=wh(r.containerInfo),Tn(r,s),Ra=f,An(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Eo(r.containerInfo)}catch(Ue){Yt(s,s.return,Ue)}kp&&(kp=!1,Ky(s));break;case 4:u=Ra,Ra=wh(s.stateNode.containerInfo),Tn(r,s),An(s),Ra=u;break;case 12:Tn(r,s),An(s);break;case 31:Tn(r,s),An(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,lh(s,u)));break;case 13:Tn(r,s),An(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(ch=Le()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,lh(s,u)));break;case 22:f=s.memoizedState!==null;var q=l!==null&&l.memoizedState!==null,ne=Tr,me=Fs;if(Tr=ne||f,Fs=me||q,Tn(r,s),Fs=me,Tr=ne,An(s),u&8192)e:for(r=s.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(l===null||q||Tr||Fs||vl(s)),l=null,r=s;;){if(r.tag===5||r.tag===26){if(l===null){q=l=r;try{if(p=q.stateNode,f)w=p.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{A=q.stateNode;var ve=q.memoizedProps.style,re=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;A.style.display=re==null||typeof re=="boolean"?"":(""+re).trim()}}catch(Ue){Yt(q,q.return,Ue)}}}else if(r.tag===6){if(l===null){q=r;try{q.stateNode.nodeValue=f?"":q.memoizedProps}catch(Ue){Yt(q,q.return,Ue)}}}else if(r.tag===18){if(l===null){q=r;try{var ce=q.stateNode;f?Lv(ce,!0):Lv(q.stateNode,!1)}catch(Ue){Yt(q,q.return,Ue)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,lh(s,l))));break;case 19:Tn(r,s),An(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,lh(s,u)));break;case 30:break;case 21:break;default:Tn(r,s),An(s)}}function An(s){var r=s.flags;if(r&2){try{for(var l,u=s.return;u!==null;){if(By(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var f=l.stateNode,p=Tp(s);ih(s,p,f);break;case 5:var w=l.stateNode;l.flags&32&&(Sn(w,""),l.flags&=-33);var A=Tp(s);ih(s,A,w);break;case 3:case 4:var q=l.stateNode.containerInfo,ne=Tp(s);Ap(s,ne,q);break;default:throw Error(i(161))}}catch(me){Yt(s,s.return,me)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function Ky(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;Ky(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function kr(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)$y(s,r.alternate,r),r=r.sibling}function vl(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:mi(4,r,r.return),vl(r);break;case 1:Za(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&Ly(r,r.return,l),vl(r);break;case 27:Zc(r.stateNode);case 26:case 5:Za(r,r.return),vl(r);break;case 22:r.memoizedState===null&&vl(r);break;case 30:vl(r);break;default:vl(r)}s=s.sibling}}function Cr(s,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,f=s,p=r,w=p.flags;switch(p.tag){case 0:case 11:case 15:Cr(f,p,l),$c(4,p);break;case 1:if(Cr(f,p,l),u=p,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ne){Yt(u,u.return,ne)}if(u=p,f=u.updateQueue,f!==null){var A=u.stateNode;try{var q=f.shared.hiddenCallbacks;if(q!==null)for(f.shared.hiddenCallbacks=null,f=0;f<q.length;f++)Eb(q[f],A)}catch(ne){Yt(u,u.return,ne)}}l&&w&64&&Vy(p),qc(p,p.return);break;case 27:zy(p);case 26:case 5:Cr(f,p,l),l&&u===null&&w&4&&Uy(p),qc(p,p.return);break;case 12:Cr(f,p,l);break;case 31:Cr(f,p,l),l&&w&4&&Gy(f,p);break;case 13:Cr(f,p,l),l&&w&4&&Yy(f,p);break;case 22:p.memoizedState===null&&Cr(f,p,l),qc(p,p.return);break;case 30:break;default:Cr(f,p,l)}r=r.sibling}}function Cp(s,r){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Cc(l))}function Rp(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Cc(s))}function Ia(s,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Qy(s,r,l,u),r=r.sibling}function Qy(s,r,l,u){var f=r.flags;switch(r.tag){case 0:case 11:case 15:Ia(s,r,l,u),f&2048&&$c(9,r);break;case 1:Ia(s,r,l,u);break;case 3:Ia(s,r,l,u),f&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Cc(s)));break;case 12:if(f&2048){Ia(s,r,l,u),s=r.stateNode;try{var p=r.memoizedProps,w=p.id,A=p.onPostCommit;typeof A=="function"&&A(w,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(q){Yt(r,r.return,q)}}else Ia(s,r,l,u);break;case 31:Ia(s,r,l,u);break;case 13:Ia(s,r,l,u);break;case 23:break;case 22:p=r.stateNode,w=r.alternate,r.memoizedState!==null?p._visibility&2?Ia(s,r,l,u):Hc(s,r):p._visibility&2?Ia(s,r,l,u):(p._visibility|=2,po(s,r,l,u,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Cp(w,r);break;case 24:Ia(s,r,l,u),f&2048&&Rp(r.alternate,r);break;default:Ia(s,r,l,u)}}function po(s,r,l,u,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var p=s,w=r,A=l,q=u,ne=w.flags;switch(w.tag){case 0:case 11:case 15:po(p,w,A,q,f),$c(8,w);break;case 23:break;case 22:var me=w.stateNode;w.memoizedState!==null?me._visibility&2?po(p,w,A,q,f):Hc(p,w):(me._visibility|=2,po(p,w,A,q,f)),f&&ne&2048&&Cp(w.alternate,w);break;case 24:po(p,w,A,q,f),f&&ne&2048&&Rp(w.alternate,w);break;default:po(p,w,A,q,f)}r=r.sibling}}function Hc(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=s,u=r,f=u.flags;switch(u.tag){case 22:Hc(l,u),f&2048&&Cp(u.alternate,u);break;case 24:Hc(l,u),f&2048&&Rp(u.alternate,u);break;default:Hc(l,u)}r=r.sibling}}var Gc=8192;function xo(s,r,l){if(s.subtreeFlags&Gc)for(s=s.child;s!==null;)Xy(s,r,l),s=s.sibling}function Xy(s,r,l){switch(s.tag){case 26:xo(s,r,l),s.flags&Gc&&s.memoizedState!==null&&ZE(l,Ra,s.memoizedState,s.memoizedProps);break;case 5:xo(s,r,l);break;case 3:case 4:var u=Ra;Ra=wh(s.stateNode.containerInfo),xo(s,r,l),Ra=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Gc,Gc=16777216,xo(s,r,l),Gc=u):xo(s,r,l));break;default:xo(s,r,l)}}function Jy(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Yc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Js=u,ev(u,s)}Jy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Zy(s),s=s.sibling}function Zy(s){switch(s.tag){case 0:case 11:case 15:Yc(s),s.flags&2048&&mi(9,s,s.return);break;case 3:Yc(s);break;case 12:Yc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,oh(s)):Yc(s);break;default:Yc(s)}}function oh(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Js=u,ev(u,s)}Jy(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:mi(8,r,r.return),oh(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,oh(r));break;default:oh(r)}s=s.sibling}}function ev(s,r){for(;Js!==null;){var l=Js;switch(l.tag){case 0:case 11:case 15:mi(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Cc(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Js=u;else e:for(l=s;Js!==null;){u=Js;var f=u.sibling,p=u.return;if(qy(u),u===l){Js=null;break e}if(f!==null){f.return=p,Js=f;break e}Js=p}}}var mE={getCacheForType:function(s){var r=nn(Us),l=r.data.get(s);return l===void 0&&(l=s(),r.data.set(s,l)),l},cacheSignal:function(){return nn(Us).controller.signal}},pE=typeof WeakMap=="function"?WeakMap:Map,Ut=0,es=null,Nt=null,St=0,Gt=0,Qn=null,pi=!1,go=!1,Ip=!1,Rr=0,Es=0,xi=0,wl=0,Dp=0,Xn=0,bo=0,Wc=null,kn=null,Mp=!1,ch=0,tv=0,uh=1/0,dh=null,gi=null,Ys=0,bi=null,yo=null,Ir=0,Op=0,Pp=null,sv=null,Kc=0,Vp=null;function Jn(){return(Ut&2)!==0&&St!==0?St&-St:V.T!==null?$p():Fa()}function nv(){if(Xn===0)if((St&536870912)===0||It){var s=_e;_e<<=1,(_e&3932160)===0&&(_e=262144),Xn=s}else Xn=536870912;return s=Wn.current,s!==null&&(s.flags|=32),Xn}function Cn(s,r,l){(s===es&&(Gt===2||Gt===9)||s.cancelPendingCommit!==null)&&(vo(s,0),yi(s,St,Xn,!1)),Ns(s,l),((Ut&2)===0||s!==es)&&(s===es&&((Ut&2)===0&&(wl|=l),Es===4&&yi(s,St,Xn,!1)),er(s))}function av(s,r,l){if((Ut&6)!==0)throw Error(i(327));var u=!l&&(r&127)===0&&(r&s.expiredLanes)===0||Rt(s,r),f=u?bE(s,r):Up(s,r,!0),p=u;do{if(f===0){go&&!u&&yi(s,r,0,!1);break}else{if(l=s.current.alternate,p&&!xE(l)){f=Up(s,r,!1),p=!1;continue}if(f===2){if(p=r,s.errorRecoveryDisabledLanes&p)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){r=w;e:{var A=s;f=Wc;var q=A.current.memoizedState.isDehydrated;if(q&&(vo(A,w).flags|=256),w=Up(A,w,!1),w!==2){if(Ip&&!q){A.errorRecoveryDisabledLanes|=p,wl|=p,f=4;break e}p=kn,kn=f,p!==null&&(kn===null?kn=p:kn.push.apply(kn,p))}f=w}if(p=!1,f!==2)continue}}if(f===1){vo(s,0),yi(s,r,0,!0);break}e:{switch(u=s,p=f,p){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:yi(u,r,Xn,!pi);break e;case 2:kn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=ch+300-Le(),10<f)){if(yi(u,r,Xn,!pi),vt(u,0,!0)!==0)break e;Ir=r,u.timeoutHandle=Ov(rv.bind(null,u,l,kn,dh,Mp,r,Xn,wl,bo,pi,p,"Throttled",-0,0),f);break e}rv(u,l,kn,dh,Mp,r,Xn,wl,bo,pi,p,null,-0,0)}}break}while(!0);er(s)}function rv(s,r,l,u,f,p,w,A,q,ne,me,ve,re,ce){if(s.timeoutHandle=-1,ve=r.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Sa},Xy(r,p,ve);var Ue=(p&62914560)===p?ch-Le():(p&4194048)===p?tv-Le():0;if(Ue=eT(ve,Ue),Ue!==null){Ir=p,s.cancelPendingCommit=Ue(fv.bind(null,s,r,p,l,u,f,w,A,q,me,ve,null,re,ce)),yi(s,p,w,!ne);return}}fv(s,r,p,l,u,f,w,A,q)}function xE(s){for(var r=s;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var f=l[u],p=f.getSnapshot;f=f.value;try{if(!Gn(p(),f))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function yi(s,r,l,u){r&=~Dp,r&=~wl,s.suspendedLanes|=r,s.pingedLanes&=~r,u&&(s.warmLanes|=r),u=s.expirationTimes;for(var f=r;0<f;){var p=31-hs(f),w=1<<p;u[p]=-1,f&=~w}l!==0&&ls(s,l,r)}function hh(){return(Ut&6)===0?(Qc(0),!1):!0}function Lp(){if(Nt!==null){if(Gt===0)var s=Nt.return;else s=Nt,wr=hl=null,ep(s),co=null,Ic=0,s=Nt;for(;s!==null;)Py(s.alternate,s),s=s.return;Nt=null}}function vo(s,r){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,PE(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Ir=0,Lp(),es=s,Nt=l=yr(s.current,null),St=r,Gt=0,Qn=null,pi=!1,go=Rt(s,r),Ip=!1,bo=Xn=Dp=wl=xi=Es=0,kn=Wc=null,Mp=!1,(r&8)!==0&&(r|=r&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=r;0<u;){var f=31-hs(u),p=1<<f;r|=s[f],u&=~p}return Rr=r,Dd(),l}function iv(s,r){pt=null,V.H=Bc,r===oo||r===zd?(r=Nb(),Gt=3):r===Fm?(r=Nb(),Gt=4):Gt=r===xp?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Qn=r,Nt===null&&(Es=1,th(s,ha(r,s.current)))}function lv(){var s=Wn.current;return s===null?!0:(St&4194048)===St?xa===null:(St&62914560)===St||(St&536870912)!==0?s===xa:!1}function ov(){var s=V.H;return V.H=Bc,s===null?Bc:s}function cv(){var s=V.A;return V.A=mE,s}function fh(){Es=4,pi||(St&4194048)!==St&&Wn.current!==null||(go=!0),(xi&134217727)===0&&(wl&134217727)===0||es===null||yi(es,St,Xn,!1)}function Up(s,r,l){var u=Ut;Ut|=2;var f=ov(),p=cv();(es!==s||St!==r)&&(dh=null,vo(s,r)),r=!1;var w=Es;e:do try{if(Gt!==0&&Nt!==null){var A=Nt,q=Qn;switch(Gt){case 8:Lp(),w=6;break e;case 3:case 2:case 9:case 6:Wn.current===null&&(r=!0);var ne=Gt;if(Gt=0,Qn=null,wo(s,A,q,ne),l&&go){w=0;break e}break;default:ne=Gt,Gt=0,Qn=null,wo(s,A,q,ne)}}gE(),w=Es;break}catch(me){iv(s,me)}while(!0);return r&&s.shellSuspendCounter++,wr=hl=null,Ut=u,V.H=f,V.A=p,Nt===null&&(es=null,St=0,Dd()),w}function gE(){for(;Nt!==null;)uv(Nt)}function bE(s,r){var l=Ut;Ut|=2;var u=ov(),f=cv();es!==s||St!==r?(dh=null,uh=Le()+500,vo(s,r)):go=Rt(s,r);e:do try{if(Gt!==0&&Nt!==null){r=Nt;var p=Qn;t:switch(Gt){case 1:Gt=0,Qn=null,wo(s,r,p,1);break;case 2:case 9:if(vb(p)){Gt=0,Qn=null,dv(r);break}r=function(){Gt!==2&&Gt!==9||es!==s||(Gt=7),er(s)},p.then(r,r);break e;case 3:Gt=7;break e;case 4:Gt=5;break e;case 7:vb(p)?(Gt=0,Qn=null,dv(r)):(Gt=0,Qn=null,wo(s,r,p,7));break;case 5:var w=null;switch(Nt.tag){case 26:w=Nt.memoizedState;case 5:case 27:var A=Nt;if(w?Qv(w):A.stateNode.complete){Gt=0,Qn=null;var q=A.sibling;if(q!==null)Nt=q;else{var ne=A.return;ne!==null?(Nt=ne,mh(ne)):Nt=null}break t}}Gt=0,Qn=null,wo(s,r,p,5);break;case 6:Gt=0,Qn=null,wo(s,r,p,6);break;case 8:Lp(),Es=6;break e;default:throw Error(i(462))}}yE();break}catch(me){iv(s,me)}while(!0);return wr=hl=null,V.H=u,V.A=f,Ut=l,Nt!==null?0:(es=null,St=0,Dd(),Es)}function yE(){for(;Nt!==null&&!pe();)uv(Nt)}function uv(s){var r=My(s.alternate,s,Rr);s.memoizedProps=s.pendingProps,r===null?mh(s):Nt=r}function dv(s){var r=s,l=r.alternate;switch(r.tag){case 15:case 0:r=Ay(l,r,r.pendingProps,r.type,void 0,St);break;case 11:r=Ay(l,r,r.pendingProps,r.type.render,r.ref,St);break;case 5:ep(r);default:Py(l,r),r=Nt=cb(r,Rr),r=My(l,r,Rr)}s.memoizedProps=s.pendingProps,r===null?mh(s):Nt=r}function wo(s,r,l,u){wr=hl=null,ep(r),co=null,Ic=0;var f=r.return;try{if(lE(s,f,r,l,St)){Es=1,th(s,ha(l,s.current)),Nt=null;return}}catch(p){if(f!==null)throw Nt=f,p;Es=1,th(s,ha(l,s.current)),Nt=null;return}r.flags&32768?(It||u===1?s=!0:go||(St&536870912)!==0?s=!1:(pi=s=!0,(u===2||u===9||u===3||u===6)&&(u=Wn.current,u!==null&&u.tag===13&&(u.flags|=16384))),hv(r,s)):mh(r)}function mh(s){var r=s;do{if((r.flags&32768)!==0){hv(r,pi);return}s=r.return;var l=uE(r.alternate,r,Rr);if(l!==null){Nt=l;return}if(r=r.sibling,r!==null){Nt=r;return}Nt=r=s}while(r!==null);Es===0&&(Es=5)}function hv(s,r){do{var l=dE(s.alternate,s);if(l!==null){l.flags&=32767,Nt=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(s=s.sibling,s!==null)){Nt=s;return}Nt=s=l}while(s!==null);Es=6,Nt=null}function fv(s,r,l,u,f,p,w,A,q){s.cancelPendingCommit=null;do ph();while(Ys!==0);if((Ut&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(p=r.lanes|r.childLanes,p|=Tm,bn(s,l,p,w,A,q),s===es&&(Nt=es=null,St=0),yo=r,bi=s,Ir=l,Op=p,Pp=f,sv=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,jE(ee,function(){return bv(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=V.T,V.T=null,f=K.p,K.p=2,w=Ut,Ut|=4;try{hE(s,r,l)}finally{Ut=w,K.p=f,V.T=u}}Ys=1,mv(),pv(),xv()}}function mv(){if(Ys===1){Ys=0;var s=bi,r=yo,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=V.T,V.T=null;var u=K.p;K.p=2;var f=Ut;Ut|=4;try{Wy(r,s);var p=Xp,w=eb(s.containerInfo),A=p.focusedElem,q=p.selectionRange;if(w!==A&&A&&A.ownerDocument&&Zg(A.ownerDocument.documentElement,A)){if(q!==null&&Nm(A)){var ne=q.start,me=q.end;if(me===void 0&&(me=ne),"selectionStart"in A)A.selectionStart=ne,A.selectionEnd=Math.min(me,A.value.length);else{var ve=A.ownerDocument||document,re=ve&&ve.defaultView||window;if(re.getSelection){var ce=re.getSelection(),Ue=A.textContent.length,at=Math.min(q.start,Ue),Jt=q.end===void 0?at:Math.min(q.end,Ue);!ce.extend&&at>Jt&&(w=Jt,Jt=at,at=w);var X=Jg(A,at),W=Jg(A,Jt);if(X&&W&&(ce.rangeCount!==1||ce.anchorNode!==X.node||ce.anchorOffset!==X.offset||ce.focusNode!==W.node||ce.focusOffset!==W.offset)){var se=ve.createRange();se.setStart(X.node,X.offset),ce.removeAllRanges(),at>Jt?(ce.addRange(se),ce.extend(W.node,W.offset)):(se.setEnd(W.node,W.offset),ce.addRange(se))}}}}for(ve=[],ce=A;ce=ce.parentNode;)ce.nodeType===1&&ve.push({element:ce,left:ce.scrollLeft,top:ce.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<ve.length;A++){var ge=ve[A];ge.element.scrollLeft=ge.left,ge.element.scrollTop=ge.top}}Th=!!Qp,Xp=Qp=null}finally{Ut=f,K.p=u,V.T=l}}s.current=r,Ys=2}}function pv(){if(Ys===2){Ys=0;var s=bi,r=yo,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=V.T,V.T=null;var u=K.p;K.p=2;var f=Ut;Ut|=4;try{$y(s,r.alternate,r)}finally{Ut=f,K.p=u,V.T=l}}Ys=3}}function xv(){if(Ys===4||Ys===3){Ys=0,We();var s=bi,r=yo,l=Ir,u=sv;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ys=5:(Ys=0,yo=bi=null,gv(s,s.pendingLanes));var f=s.pendingLanes;if(f===0&&(gi=null),bs(l),r=r.stateNode,yt&&typeof yt.onCommitFiberRoot=="function")try{yt.onCommitFiberRoot(is,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=V.T,f=K.p,K.p=2,V.T=null;try{for(var p=s.onRecoverableError,w=0;w<u.length;w++){var A=u[w];p(A.value,{componentStack:A.stack})}}finally{V.T=r,K.p=f}}(Ir&3)!==0&&ph(),er(s),f=s.pendingLanes,(l&261930)!==0&&(f&42)!==0?s===Vp?Kc++:(Kc=0,Vp=s):Kc=0,Qc(0)}}function gv(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Cc(r)))}function ph(){return mv(),pv(),xv(),bv()}function bv(){if(Ys!==5)return!1;var s=bi,r=Op;Op=0;var l=bs(Ir),u=V.T,f=K.p;try{K.p=32>l?32:l,V.T=null,l=Pp,Pp=null;var p=bi,w=Ir;if(Ys=0,yo=bi=null,Ir=0,(Ut&6)!==0)throw Error(i(331));var A=Ut;if(Ut|=4,Zy(p.current),Qy(p,p.current,w,l),Ut=A,Qc(0,!1),yt&&typeof yt.onPostCommitFiberRoot=="function")try{yt.onPostCommitFiberRoot(is,p)}catch{}return!0}finally{K.p=f,V.T=u,gv(s,r)}}function yv(s,r,l){r=ha(l,r),r=pp(s.stateNode,r,2),s=di(s,r,2),s!==null&&(Ns(s,2),er(s))}function Yt(s,r,l){if(s.tag===3)yv(s,s,l);else for(;r!==null;){if(r.tag===3){yv(r,s,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(gi===null||!gi.has(u))){s=ha(l,s),l=vy(2),u=di(r,l,2),u!==null&&(wy(l,u,r,s),Ns(u,2),er(u));break}}r=r.return}}function Bp(s,r,l){var u=s.pingCache;if(u===null){u=s.pingCache=new pE;var f=new Set;u.set(r,f)}else f=u.get(r),f===void 0&&(f=new Set,u.set(r,f));f.has(l)||(Ip=!0,f.add(l),s=vE.bind(null,s,r,l),r.then(s,s))}function vE(s,r,l){var u=s.pingCache;u!==null&&u.delete(r),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,es===s&&(St&l)===l&&(Es===4||Es===3&&(St&62914560)===St&&300>Le()-ch?(Ut&2)===0&&vo(s,0):Dp|=l,bo===St&&(bo=0)),er(s)}function vv(s,r){r===0&&(r=st()),s=cl(s,r),s!==null&&(Ns(s,r),er(s))}function wE(s){var r=s.memoizedState,l=0;r!==null&&(l=r.retryLane),vv(s,l)}function NE(s,r){var l=0;switch(s.tag){case 31:case 13:var u=s.stateNode,f=s.memoizedState;f!==null&&(l=f.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),vv(s,l)}function jE(s,r){return Re(s,r)}var xh=null,No=null,zp=!1,gh=!1,Fp=!1,vi=0;function er(s){s!==No&&s.next===null&&(No===null?xh=No=s:No=No.next=s),gh=!0,zp||(zp=!0,SE())}function Qc(s,r){if(!Fp&&gh){Fp=!0;do for(var l=!1,u=xh;u!==null;){if(s!==0){var f=u.pendingLanes;if(f===0)var p=0;else{var w=u.suspendedLanes,A=u.pingedLanes;p=(1<<31-hs(42|s)+1)-1,p&=f&~(w&~A),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(l=!0,_v(u,p))}else p=St,p=vt(u,u===es?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(p&3)===0||Rt(u,p)||(l=!0,_v(u,p));u=u.next}while(l);Fp=!1}}function _E(){wv()}function wv(){gh=zp=!1;var s=0;vi!==0&&OE()&&(s=vi);for(var r=Le(),l=null,u=xh;u!==null;){var f=u.next,p=Nv(u,r);p===0?(u.next=null,l===null?xh=f:l.next=f,f===null&&(No=l)):(l=u,(s!==0||(p&3)!==0)&&(gh=!0)),u=f}Ys!==0&&Ys!==5||Qc(s),vi!==0&&(vi=0)}function Nv(s,r){for(var l=s.suspendedLanes,u=s.pingedLanes,f=s.expirationTimes,p=s.pendingLanes&-62914561;0<p;){var w=31-hs(p),A=1<<w,q=f[w];q===-1?((A&l)===0||(A&u)!==0)&&(f[w]=Qe(A,r)):q<=r&&(s.expiredLanes|=A),p&=~A}if(r=es,l=St,l=vt(s,s===r?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===r&&(Gt===2||Gt===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Be(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Rt(s,l)){if(r=l&-l,r===s.callbackPriority)return r;switch(u!==null&&Be(u),bs(l)){case 2:case 8:l=He;break;case 32:l=ee;break;case 268435456:l=nt;break;default:l=ee}return u=jv.bind(null,s),l=Re(l,u),s.callbackPriority=r,s.callbackNode=l,r}return u!==null&&u!==null&&Be(u),s.callbackPriority=2,s.callbackNode=null,2}function jv(s,r){if(Ys!==0&&Ys!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(ph()&&s.callbackNode!==l)return null;var u=St;return u=vt(s,s===es?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(av(s,u,r),Nv(s,Le()),s.callbackNode!=null&&s.callbackNode===l?jv.bind(null,s):null)}function _v(s,r){if(ph())return null;av(s,r,!0)}function SE(){VE(function(){(Ut&6)!==0?Re(Ge,_E):wv()})}function $p(){if(vi===0){var s=io;s===0&&(s=Vs,Vs<<=1,(Vs&261888)===0&&(Vs=256)),vi=s}return vi}function Sv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Hl(""+s)}function Ev(s,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,s.id&&l.setAttribute("form",s.id),r.parentNode.insertBefore(l,r),s=new FormData(s),l.parentNode.removeChild(l),s}function EE(s,r,l,u,f){if(r==="submit"&&l&&l.stateNode===f){var p=Sv((f[D]||null).action),w=u.submitter;w&&(r=(r=w[D]||null)?Sv(r.formAction):w.getAttribute("formAction"),r!==null&&(p=r,w=null));var A=new Ya("action","action",null,u,f);s.push({event:A,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(vi!==0){var q=w?Ev(f,w):new FormData(f);cp(l,{pending:!0,data:q,method:f.method,action:p},null,q)}}else typeof p=="function"&&(A.preventDefault(),q=w?Ev(f,w):new FormData(f),cp(l,{pending:!0,data:q,method:f.method,action:p},p,q))},currentTarget:f}]})}}for(var qp=0;qp<Em.length;qp++){var Hp=Em[qp],TE=Hp.toLowerCase(),AE=Hp[0].toUpperCase()+Hp.slice(1);Ca(TE,"on"+AE)}Ca(nb,"onAnimationEnd"),Ca(ab,"onAnimationIteration"),Ca(rb,"onAnimationStart"),Ca("dblclick","onDoubleClick"),Ca("focusin","onFocus"),Ca("focusout","onBlur"),Ca(qS,"onTransitionRun"),Ca(HS,"onTransitionStart"),Ca(GS,"onTransitionCancel"),Ca(ib,"onTransitionEnd"),la("onMouseEnter",["mouseout","mouseover"]),la("onMouseLeave",["mouseout","mouseover"]),la("onPointerEnter",["pointerout","pointerover"]),la("onPointerLeave",["pointerout","pointerover"]),ia("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ia("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ia("onBeforeInput",["compositionend","keypress","textInput","paste"]),ia("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ia("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ia("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xc));function Tv(s,r){r=(r&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],f=u.event;u=u.listeners;e:{var p=void 0;if(r)for(var w=u.length-1;0<=w;w--){var A=u[w],q=A.instance,ne=A.currentTarget;if(A=A.listener,q!==p&&f.isPropagationStopped())break e;p=A,f.currentTarget=ne;try{p(f)}catch(me){Id(me)}f.currentTarget=null,p=q}else for(w=0;w<u.length;w++){if(A=u[w],q=A.instance,ne=A.currentTarget,A=A.listener,q!==p&&f.isPropagationStopped())break e;p=A,f.currentTarget=ne;try{p(f)}catch(me){Id(me)}f.currentTarget=null,p=q}}}}function jt(s,r){var l=r[be];l===void 0&&(l=r[be]=new Set);var u=s+"__bubble";l.has(u)||(Av(r,s,2,!1),l.add(u))}function Gp(s,r,l){var u=0;r&&(u|=4),Av(l,s,u,r)}var bh="_reactListening"+Math.random().toString(36).slice(2);function Yp(s){if(!s[bh]){s[bh]=!0,$a.forEach(function(l){l!=="selectionchange"&&(kE.has(l)||Gp(l,!1,s),Gp(l,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[bh]||(r[bh]=!0,Gp("selectionchange",!1,r))}}function Av(s,r,l,u){switch(nw(r)){case 2:var f=nT;break;case 8:f=aT;break;default:f=o0}l=f.bind(null,r,l,s),f=void 0,!tl||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),u?f!==void 0?s.addEventListener(r,l,{capture:!0,passive:f}):s.addEventListener(r,l,!0):f!==void 0?s.addEventListener(r,l,{passive:f}):s.addEventListener(r,l,!1)}function Wp(s,r,l,u,f){var p=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var w=u.tag;if(w===3||w===4){var A=u.stateNode.containerInfo;if(A===f)break;if(w===4)for(w=u.return;w!==null;){var q=w.tag;if((q===3||q===4)&&w.stateNode.containerInfo===f)return;w=w.return}for(;A!==null;){if(w=wt(A),w===null)return;if(q=w.tag,q===5||q===6||q===26||q===27){u=p=w;continue e}A=A.parentNode}}u=u.return}ti(function(){var ne=p,me=oa(l),ve=[];e:{var re=lb.get(s);if(re!==void 0){var ce=Ya,Ue=s;switch(s){case"keypress":if(nl(l)===0)break e;case"keydown":case"keyup":ce=kd;break;case"focusin":Ue="focus",ce=rl;break;case"focusout":Ue="blur",ce=rl;break;case"beforeblur":case"afterblur":ce=rl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=Nc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=vd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=y;break;case nb:case ab:case rb:ce=Nd;break;case ib:ce=M;break;case"scroll":case"scrollend":ce=wc;break;case"wheel":ce=ie;break;case"copy":case"cut":case"paste":ce=jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=br;break;case"toggle":case"beforetoggle":ce=mt}var at=(r&4)!==0,Jt=!at&&(s==="scroll"||s==="scrollend"),X=at?re!==null?re+"Capture":null:re;at=[];for(var W=ne,se;W!==null;){var ge=W;if(se=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||se===null||X===null||(ge=Ea(W,X),ge!=null&&at.push(Jc(W,ge,se))),Jt)break;W=W.return}0<at.length&&(re=new ce(re,Ue,null,l,me),ve.push({event:re,listeners:at}))}}if((r&7)===0){e:{if(re=s==="mouseover"||s==="pointerover",ce=s==="mouseout"||s==="pointerout",re&&l!==bc&&(Ue=l.relatedTarget||l.fromElement)&&(wt(Ue)||Ue[Q]))break e;if((ce||re)&&(re=me.window===me?me:(re=me.ownerDocument)?re.defaultView||re.parentWindow:window,ce?(Ue=l.relatedTarget||l.toElement,ce=ne,Ue=Ue?wt(Ue):null,Ue!==null&&(Jt=c(Ue),at=Ue.tag,Ue!==Jt||at!==5&&at!==27&&at!==6)&&(Ue=null)):(ce=null,Ue=ne),ce!==Ue)){if(at=Nc,ge="onMouseLeave",X="onMouseEnter",W="mouse",(s==="pointerout"||s==="pointerover")&&(at=br,ge="onPointerLeave",X="onPointerEnter",W="pointer"),Jt=ce==null?re:cs(ce),se=Ue==null?re:cs(Ue),re=new at(ge,W+"leave",ce,l,me),re.target=Jt,re.relatedTarget=se,ge=null,wt(me)===ne&&(at=new at(X,W+"enter",Ue,l,me),at.target=se,at.relatedTarget=Jt,ge=at),Jt=ge,ce&&Ue)t:{for(at=CE,X=ce,W=Ue,se=0,ge=X;ge;ge=at(ge))se++;ge=0;for(var Je=W;Je;Je=at(Je))ge++;for(;0<se-ge;)X=at(X),se--;for(;0<ge-se;)W=at(W),ge--;for(;se--;){if(X===W||W!==null&&X===W.alternate){at=X;break t}X=at(X),W=at(W)}at=null}else at=null;ce!==null&&kv(ve,re,ce,at,!1),Ue!==null&&Jt!==null&&kv(ve,Jt,Ue,at,!0)}}e:{if(re=ne?cs(ne):window,ce=re.nodeName&&re.nodeName.toLowerCase(),ce==="select"||ce==="input"&&re.type==="file")var Pt=Gg;else if(qg(re))if(Yg)Pt=zS;else{Pt=US;var Fe=LS}else ce=re.nodeName,!ce||ce.toLowerCase()!=="input"||re.type!=="checkbox"&&re.type!=="radio"?ne&&ql(ne.elementType)&&(Pt=Gg):Pt=BS;if(Pt&&(Pt=Pt(s,ne))){Hg(ve,Pt,l,me);break e}Fe&&Fe(s,re,ne),s==="focusout"&&ne&&re.type==="number"&&ne.memoizedProps.value!=null&&pc(re,"number",re.value)}switch(Fe=ne?cs(ne):window,s){case"focusin":(qg(Fe)||Fe.contentEditable==="true")&&(Jl=Fe,jm=ne,Tc=null);break;case"focusout":Tc=jm=Jl=null;break;case"mousedown":_m=!0;break;case"contextmenu":case"mouseup":case"dragend":_m=!1,tb(ve,l,me);break;case"selectionchange":if($S)break;case"keydown":case"keyup":tb(ve,l,me)}var xt;if(Lt)e:{switch(s){case"compositionstart":var Et="onCompositionStart";break e;case"compositionend":Et="onCompositionEnd";break e;case"compositionupdate":Et="onCompositionUpdate";break e}Et=void 0}else Xl?il(s,l)&&(Et="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Et="onCompositionStart");Et&&(Qa&&l.locale!=="ko"&&(Xl||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&Xl&&(xt=vc()):(Ga=me,yc="value"in Ga?Ga.value:Ga.textContent,Xl=!0)),Fe=yh(ne,Et),0<Fe.length&&(Et=new Ka(Et,s,null,l,me),ve.push({event:Et,listeners:Fe}),xt?Et.data=xt:(xt=Ql(l),xt!==null&&(Et.data=xt)))),(xt=ua?MS(s,l):OS(s,l))&&(Et=yh(ne,"onBeforeInput"),0<Et.length&&(Fe=new Ka("onBeforeInput","beforeinput",null,l,me),ve.push({event:Fe,listeners:Et}),Fe.data=xt)),EE(ve,s,ne,l,me)}Tv(ve,r)})}function Jc(s,r,l){return{instance:s,listener:r,currentTarget:l}}function yh(s,r){for(var l=r+"Capture",u=[];s!==null;){var f=s,p=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||p===null||(f=Ea(s,l),f!=null&&u.unshift(Jc(s,f,p)),f=Ea(s,r),f!=null&&u.push(Jc(s,f,p))),s.tag===3)return u;s=s.return}return[]}function CE(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function kv(s,r,l,u,f){for(var p=r._reactName,w=[];l!==null&&l!==u;){var A=l,q=A.alternate,ne=A.stateNode;if(A=A.tag,q!==null&&q===u)break;A!==5&&A!==26&&A!==27||ne===null||(q=ne,f?(ne=Ea(l,p),ne!=null&&w.unshift(Jc(l,ne,q))):f||(ne=Ea(l,p),ne!=null&&w.push(Jc(l,ne,q)))),l=l.return}w.length!==0&&s.push({event:r,listeners:w})}var RE=/\r\n?/g,IE=/\u0000|\uFFFD/g;function Cv(s){return(typeof s=="string"?s:""+s).replace(RE,`
`).replace(IE,"")}function Rv(s,r){return r=Cv(r),Cv(s)===r}function Xt(s,r,l,u,f,p){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||Sn(s,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&Sn(s,""+u);break;case"className":Hn(s,"class",u);break;case"tabIndex":Hn(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Hn(s,l,u);break;case"style":gc(s,u,p);break;case"data":if(r!=="object"){Hn(s,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Hl(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(l==="formAction"?(r!=="input"&&Xt(s,r,"name",f.name,f,null),Xt(s,r,"formEncType",f.formEncType,f,null),Xt(s,r,"formMethod",f.formMethod,f,null),Xt(s,r,"formTarget",f.formTarget,f,null)):(Xt(s,r,"encType",f.encType,f,null),Xt(s,r,"method",f.method,f,null),Xt(s,r,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Hl(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=Sa);break;case"onScroll":u!=null&&jt("scroll",s);break;case"onScrollEnd":u!=null&&jt("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Hl(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":jt("beforetoggle",s),jt("toggle",s),Fl(s,"popover",u);break;case"xlinkActuate":Ls(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ls(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ls(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ls(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ls(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ls(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ls(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ls(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ls(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Fl(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=yd.get(l)||l,Fl(s,l,u))}}function Kp(s,r,l,u,f,p){switch(l){case"style":gc(s,u,p);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof u=="string"?Sn(s,u):(typeof u=="number"||typeof u=="bigint")&&Sn(s,""+u);break;case"onScroll":u!=null&&jt("scroll",s);break;case"onScrollEnd":u!=null&&jt("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Sa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ki.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),r=l.slice(2,f?l.length-7:void 0),p=s[D]||null,p=p!=null?p[l]:null,typeof p=="function"&&s.removeEventListener(r,p,f),typeof u=="function")){typeof p!="function"&&p!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(r,u,f);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Fl(s,l,u)}}}function rn(s,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":jt("error",s),jt("load",s);var u=!1,f=!1,p;for(p in l)if(l.hasOwnProperty(p)){var w=l[p];if(w!=null)switch(p){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Xt(s,r,p,w,l,null)}}f&&Xt(s,r,"srcSet",l.srcSet,l,null),u&&Xt(s,r,"src",l.src,l,null);return;case"input":jt("invalid",s);var A=p=w=f=null,q=null,ne=null;for(u in l)if(l.hasOwnProperty(u)){var me=l[u];if(me!=null)switch(u){case"name":f=me;break;case"type":w=me;break;case"checked":q=me;break;case"defaultChecked":ne=me;break;case"value":p=me;break;case"defaultValue":A=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,r));break;default:Xt(s,r,u,me,l,null)}}xd(s,p,A,q,ne,w,f,!1);return;case"select":jt("invalid",s),u=w=p=null;for(f in l)if(l.hasOwnProperty(f)&&(A=l[f],A!=null))switch(f){case"value":p=A;break;case"defaultValue":w=A;break;case"multiple":u=A;default:Xt(s,r,f,A,l,null)}r=p,l=w,s.multiple=!!u,r!=null?Xr(s,!!u,r,!1):l!=null&&Xr(s,!!u,l,!0);return;case"textarea":jt("invalid",s),p=f=u=null;for(w in l)if(l.hasOwnProperty(w)&&(A=l[w],A!=null))switch(w){case"value":u=A;break;case"defaultValue":f=A;break;case"children":p=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(i(91));break;default:Xt(s,r,w,A,l,null)}Jr(s,u,f,p);return;case"option":for(q in l)l.hasOwnProperty(q)&&(u=l[q],u!=null)&&(q==="selected"?s.selected=u&&typeof u!="function"&&typeof u!="symbol":Xt(s,r,q,u,l,null));return;case"dialog":jt("beforetoggle",s),jt("toggle",s),jt("cancel",s),jt("close",s);break;case"iframe":case"object":jt("load",s);break;case"video":case"audio":for(u=0;u<Xc.length;u++)jt(Xc[u],s);break;case"image":jt("error",s),jt("load",s);break;case"details":jt("toggle",s);break;case"embed":case"source":case"link":jt("error",s),jt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in l)if(l.hasOwnProperty(ne)&&(u=l[ne],u!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Xt(s,r,ne,u,l,null)}return;default:if(ql(r)){for(me in l)l.hasOwnProperty(me)&&(u=l[me],u!==void 0&&Kp(s,r,me,u,l,void 0));return}}for(A in l)l.hasOwnProperty(A)&&(u=l[A],u!=null&&Xt(s,r,A,u,l,null))}function DE(s,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,p=null,w=null,A=null,q=null,ne=null,me=null;for(ce in l){var ve=l[ce];if(l.hasOwnProperty(ce)&&ve!=null)switch(ce){case"checked":break;case"value":break;case"defaultValue":q=ve;default:u.hasOwnProperty(ce)||Xt(s,r,ce,null,u,ve)}}for(var re in u){var ce=u[re];if(ve=l[re],u.hasOwnProperty(re)&&(ce!=null||ve!=null))switch(re){case"type":p=ce;break;case"name":f=ce;break;case"checked":ne=ce;break;case"defaultChecked":me=ce;break;case"value":w=ce;break;case"defaultValue":A=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,r));break;default:ce!==ve&&Xt(s,r,re,ce,u,ve)}}$l(s,w,A,q,ne,me,p,f);return;case"select":ce=w=A=re=null;for(p in l)if(q=l[p],l.hasOwnProperty(p)&&q!=null)switch(p){case"value":break;case"multiple":ce=q;default:u.hasOwnProperty(p)||Xt(s,r,p,null,u,q)}for(f in u)if(p=u[f],q=l[f],u.hasOwnProperty(f)&&(p!=null||q!=null))switch(f){case"value":re=p;break;case"defaultValue":A=p;break;case"multiple":w=p;default:p!==q&&Xt(s,r,f,p,u,q)}r=A,l=w,u=ce,re!=null?Xr(s,!!l,re,!1):!!u!=!!l&&(r!=null?Xr(s,!!l,r,!0):Xr(s,!!l,l?[]:"",!1));return;case"textarea":ce=re=null;for(A in l)if(f=l[A],l.hasOwnProperty(A)&&f!=null&&!u.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:Xt(s,r,A,null,u,f)}for(w in u)if(f=u[w],p=l[w],u.hasOwnProperty(w)&&(f!=null||p!=null))switch(w){case"value":re=f;break;case"defaultValue":ce=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==p&&Xt(s,r,w,f,u,p)}gd(s,re,ce);return;case"option":for(var Ue in l)re=l[Ue],l.hasOwnProperty(Ue)&&re!=null&&!u.hasOwnProperty(Ue)&&(Ue==="selected"?s.selected=!1:Xt(s,r,Ue,null,u,re));for(q in u)re=u[q],ce=l[q],u.hasOwnProperty(q)&&re!==ce&&(re!=null||ce!=null)&&(q==="selected"?s.selected=re&&typeof re!="function"&&typeof re!="symbol":Xt(s,r,q,re,u,ce));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var at in l)re=l[at],l.hasOwnProperty(at)&&re!=null&&!u.hasOwnProperty(at)&&Xt(s,r,at,null,u,re);for(ne in u)if(re=u[ne],ce=l[ne],u.hasOwnProperty(ne)&&re!==ce&&(re!=null||ce!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(i(137,r));break;default:Xt(s,r,ne,re,u,ce)}return;default:if(ql(r)){for(var Jt in l)re=l[Jt],l.hasOwnProperty(Jt)&&re!==void 0&&!u.hasOwnProperty(Jt)&&Kp(s,r,Jt,void 0,u,re);for(me in u)re=u[me],ce=l[me],!u.hasOwnProperty(me)||re===ce||re===void 0&&ce===void 0||Kp(s,r,me,re,u,ce);return}}for(var X in l)re=l[X],l.hasOwnProperty(X)&&re!=null&&!u.hasOwnProperty(X)&&Xt(s,r,X,null,u,re);for(ve in u)re=u[ve],ce=l[ve],!u.hasOwnProperty(ve)||re===ce||re==null&&ce==null||Xt(s,r,ve,re,u,ce)}function Iv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ME(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var f=l[u],p=f.transferSize,w=f.initiatorType,A=f.duration;if(p&&A&&Iv(w)){for(w=0,A=f.responseEnd,u+=1;u<l.length;u++){var q=l[u],ne=q.startTime;if(ne>A)break;var me=q.transferSize,ve=q.initiatorType;me&&Iv(ve)&&(q=q.responseEnd,w+=me*(q<A?1:(A-ne)/(q-ne)))}if(--u,r+=8*(p+w)/(f.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Qp=null,Xp=null;function vh(s){return s.nodeType===9?s:s.ownerDocument}function Dv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Mv(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function Jp(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Zp=null;function OE(){var s=window.event;return s&&s.type==="popstate"?s===Zp?!1:(Zp=s,!0):(Zp=null,!1)}var Ov=typeof setTimeout=="function"?setTimeout:void 0,PE=typeof clearTimeout=="function"?clearTimeout:void 0,Pv=typeof Promise=="function"?Promise:void 0,VE=typeof queueMicrotask=="function"?queueMicrotask:typeof Pv<"u"?function(s){return Pv.resolve(null).then(s).catch(LE)}:Ov;function LE(s){setTimeout(function(){throw s})}function wi(s){return s==="head"}function Vv(s,r){var l=r,u=0;do{var f=l.nextSibling;if(s.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"||l==="/&"){if(u===0){s.removeChild(f),Eo(r);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")Zc(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,Zc(l);for(var p=l.firstChild;p;){var w=p.nextSibling,A=p.nodeName;p[ut]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&p.rel.toLowerCase()==="stylesheet"||l.removeChild(p),p=w}}else l==="body"&&Zc(s.ownerDocument.body);l=f}while(l);Eo(r)}function Lv(s,r){var l=s;s=0;do{var u=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=u}while(l)}function e0(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":e0(l),Xe(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function UE(s,r,l,u){for(;s.nodeType===1;){var f=l;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[ut])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(p=s.getAttribute("rel"),p==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(p!==f.rel||s.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||s.getAttribute("title")!==(f.title==null?null:f.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(p=s.getAttribute("src"),(p!==(f.src==null?null:f.src)||s.getAttribute("type")!==(f.type==null?null:f.type)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&p&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var p=f.name==null?null:""+f.name;if(f.type==="hidden"&&s.getAttribute("name")===p)return s}else return s;if(s=ga(s.nextSibling),s===null)break}return null}function BE(s,r,l){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=ga(s.nextSibling),s===null))return null;return s}function Uv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=ga(s.nextSibling),s===null))return null;return s}function t0(s){return s.data==="$?"||s.data==="$~"}function s0(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function zE(s,r){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||l.readyState!=="loading")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function ga(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var n0=null;function Bv(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(r===0)return ga(s.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}s=s.nextSibling}return null}function zv(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return s;r--}else l!=="/$"&&l!=="/&"||r++}s=s.previousSibling}return null}function Fv(s,r,l){switch(r=vh(l),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Zc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Xe(s)}var ba=new Map,$v=new Set;function wh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Dr=K.d;K.d={f:FE,r:$E,D:qE,C:HE,L:GE,m:YE,X:KE,S:WE,M:QE};function FE(){var s=Dr.f(),r=hh();return s||r}function $E(s){var r=as(s);r!==null&&r.tag===5&&r.type==="form"?iy(r):Dr.r(s)}var jo=typeof document>"u"?null:document;function qv(s,r,l){var u=jo;if(u&&typeof r=="string"&&r){var f=_n(r);f='link[rel="'+s+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),$v.has(f)||($v.add(f),s={rel:s,crossOrigin:l,href:r},u.querySelector(f)===null&&(r=u.createElement("link"),rn(r,"link",s),fs(r),u.head.appendChild(r)))}}function qE(s){Dr.D(s),qv("dns-prefetch",s,null)}function HE(s,r){Dr.C(s,r),qv("preconnect",s,r)}function GE(s,r,l){Dr.L(s,r,l);var u=jo;if(u&&s&&r){var f='link[rel="preload"][as="'+_n(r)+'"]';r==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+_n(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+_n(l.imageSizes)+'"]')):f+='[href="'+_n(s)+'"]';var p=f;switch(r){case"style":p=_o(s);break;case"script":p=So(s)}ba.has(p)||(s=v({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:s,as:r},l),ba.set(p,s),u.querySelector(f)!==null||r==="style"&&u.querySelector(eu(p))||r==="script"&&u.querySelector(tu(p))||(r=u.createElement("link"),rn(r,"link",s),fs(r),u.head.appendChild(r)))}}function YE(s,r){Dr.m(s,r);var l=jo;if(l&&s){var u=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+_n(u)+'"][href="'+_n(s)+'"]',p=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=So(s)}if(!ba.has(p)&&(s=v({rel:"modulepreload",href:s},r),ba.set(p,s),l.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(tu(p)))return}u=l.createElement("link"),rn(u,"link",s),fs(u),l.head.appendChild(u)}}}function WE(s,r,l){Dr.S(s,r,l);var u=jo;if(u&&s){var f=_s(u).hoistableStyles,p=_o(s);r=r||"default";var w=f.get(p);if(!w){var A={loading:0,preload:null};if(w=u.querySelector(eu(p)))A.loading=5;else{s=v({rel:"stylesheet",href:s,"data-precedence":r},l),(l=ba.get(p))&&a0(s,l);var q=w=u.createElement("link");fs(q),rn(q,"link",s),q._p=new Promise(function(ne,me){q.onload=ne,q.onerror=me}),q.addEventListener("load",function(){A.loading|=1}),q.addEventListener("error",function(){A.loading|=2}),A.loading|=4,Nh(w,r,u)}w={type:"stylesheet",instance:w,count:1,state:A},f.set(p,w)}}}function KE(s,r){Dr.X(s,r);var l=jo;if(l&&s){var u=_s(l).hoistableScripts,f=So(s),p=u.get(f);p||(p=l.querySelector(tu(f)),p||(s=v({src:s,async:!0},r),(r=ba.get(f))&&r0(s,r),p=l.createElement("script"),fs(p),rn(p,"link",s),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function QE(s,r){Dr.M(s,r);var l=jo;if(l&&s){var u=_s(l).hoistableScripts,f=So(s),p=u.get(f);p||(p=l.querySelector(tu(f)),p||(s=v({src:s,async:!0,type:"module"},r),(r=ba.get(f))&&r0(s,r),p=l.createElement("script"),fs(p),rn(p,"link",s),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function Hv(s,r,l,u){var f=(f=Ce.current)?wh(f):null;if(!f)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=_o(l.href),l=_s(f).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=_o(l.href);var p=_s(f).hoistableStyles,w=p.get(s);if(w||(f=f.ownerDocument||f,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(s,w),(p=f.querySelector(eu(s)))&&!p._p&&(w.instance=p,w.state.loading=5),ba.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ba.set(s,l),p||XE(f,s,l,w.state))),r&&u===null)throw Error(i(528,""));return w}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=So(l),l=_s(f).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function _o(s){return'href="'+_n(s)+'"'}function eu(s){return'link[rel="stylesheet"]['+s+"]"}function Gv(s){return v({},s,{"data-precedence":s.precedence,precedence:null})}function XE(s,r,l,u){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=s.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),rn(r,"link",l),fs(r),s.head.appendChild(r))}function So(s){return'[src="'+_n(s)+'"]'}function tu(s){return"script[async]"+s}function Yv(s,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=s.querySelector('style[data-href~="'+_n(l.href)+'"]');if(u)return r.instance=u,fs(u),u;var f=v({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),fs(u),rn(u,"style",f),Nh(u,l.precedence,s),r.instance=u;case"stylesheet":f=_o(l.href);var p=s.querySelector(eu(f));if(p)return r.state.loading|=4,r.instance=p,fs(p),p;u=Gv(l),(f=ba.get(f))&&a0(u,f),p=(s.ownerDocument||s).createElement("link"),fs(p);var w=p;return w._p=new Promise(function(A,q){w.onload=A,w.onerror=q}),rn(p,"link",u),r.state.loading|=4,Nh(p,l.precedence,s),r.instance=p;case"script":return p=So(l.src),(f=s.querySelector(tu(p)))?(r.instance=f,fs(f),f):(u=l,(f=ba.get(p))&&(u=v({},l),r0(u,f)),s=s.ownerDocument||s,f=s.createElement("script"),fs(f),rn(f,"link",u),s.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Nh(u,l.precedence,s));return r.instance}function Nh(s,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,p=f,w=0;w<u.length;w++){var A=u[w];if(A.dataset.precedence===r)p=A;else if(p!==f)break}p?p.parentNode.insertBefore(s,p.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(s,r.firstChild))}function a0(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function r0(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var jh=null;function Wv(s,r,l){if(jh===null){var u=new Map,f=jh=new Map;f.set(l,u)}else f=jh,u=f.get(l),u||(u=new Map,f.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),f=0;f<l.length;f++){var p=l[f];if(!(p[ut]||p[os]||s==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var w=p.getAttribute(r)||"";w=s+w;var A=u.get(w);A?A.push(p):u.set(w,[p])}}return u}function Kv(s,r,l){s=s.ownerDocument||s,s.head.insertBefore(l,r==="title"?s.querySelector("head > title"):null)}function JE(s,r,l){if(l===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(s=r.disabled,typeof r.precedence=="string"&&s==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Qv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function ZE(s,r,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var f=_o(u.href),p=r.querySelector(eu(f));if(p){r=p._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=_h.bind(s),r.then(s,s)),l.state.loading|=4,l.instance=p,fs(p);return}p=r.ownerDocument||r,u=Gv(u),(f=ba.get(f))&&a0(u,f),p=p.createElement("link"),fs(p);var w=p;w._p=new Promise(function(A,q){w.onload=A,w.onerror=q}),rn(p,"link",u),l.instance=p}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=_h.bind(s),r.addEventListener("load",l),r.addEventListener("error",l))}}var i0=0;function eT(s,r){return s.stylesheets&&s.count===0&&Eh(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var u=setTimeout(function(){if(s.stylesheets&&Eh(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4+r);0<s.imgBytes&&i0===0&&(i0=62500*ME());var f=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Eh(s,s.stylesheets),s.unsuspend)){var p=s.unsuspend;s.unsuspend=null,p()}},(s.imgBytes>i0?50:800)+r);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(f)}}:null}function _h(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Eh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Sh=null;function Eh(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Sh=new Map,r.forEach(tT,s),Sh=null,_h.call(s))}function tT(s,r){if(!(r.state.loading&4)){var l=Sh.get(s);if(l)var u=l.get(null);else{l=new Map,Sh.set(s,l);for(var f=s.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<f.length;p++){var w=f[p];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),u=w)}u&&l.set(null,u)}f=r.instance,w=f.getAttribute("data-precedence"),p=l.get(w)||u,p===u&&l.set(null,f),l.set(w,f),this.count++,u=_h.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),p?p.parentNode.insertBefore(f,p.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(f,s.firstChild)),r.state.loading|=4}}var su={$$typeof:H,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function sT(s,r,l,u,f,p,w,A,q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Mt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mt(0),this.hiddenUpdates=Mt(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=p,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function Xv(s,r,l,u,f,p,w,A,q,ne,me,ve){return s=new sT(s,r,l,w,q,ne,me,ve,A),r=1,p===!0&&(r|=24),p=Yn(3,null,null,r),s.current=p,p.stateNode=s,r=Um(),r.refCount++,s.pooledCache=r,r.refCount++,p.memoizedState={element:u,isDehydrated:l,cache:r},$m(p),s}function Jv(s){return s?(s=to,s):to}function Zv(s,r,l,u,f,p){f=Jv(f),u.context===null?u.context=f:u.pendingContext=f,u=ui(r),u.payload={element:l},p=p===void 0?null:p,p!==null&&(u.callback=p),l=di(s,u,r),l!==null&&(Cn(l,s,r),Mc(l,s,r))}function ew(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<r?l:r}}function l0(s,r){ew(s,r),(s=s.alternate)&&ew(s,r)}function tw(s){if(s.tag===13||s.tag===31){var r=cl(s,67108864);r!==null&&Cn(r,s,67108864),l0(s,67108864)}}function sw(s){if(s.tag===13||s.tag===31){var r=Jn();r=qn(r);var l=cl(s,r);l!==null&&Cn(l,s,r),l0(s,r)}}var Th=!0;function nT(s,r,l,u){var f=V.T;V.T=null;var p=K.p;try{K.p=2,o0(s,r,l,u)}finally{K.p=p,V.T=f}}function aT(s,r,l,u){var f=V.T;V.T=null;var p=K.p;try{K.p=8,o0(s,r,l,u)}finally{K.p=p,V.T=f}}function o0(s,r,l,u){if(Th){var f=c0(u);if(f===null)Wp(s,r,u,Ah,l),aw(s,u);else if(iT(f,s,r,l,u))u.stopPropagation();else if(aw(s,u),r&4&&-1<rT.indexOf(s)){for(;f!==null;){var p=as(f);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var w=ft(p.pendingLanes);if(w!==0){var A=p;for(A.pendingLanes|=2,A.entangledLanes|=2;w;){var q=1<<31-hs(w);A.entanglements[1]|=q,w&=~q}er(p),(Ut&6)===0&&(uh=Le()+500,Qc(0))}}break;case 31:case 13:A=cl(p,2),A!==null&&Cn(A,p,2),hh(),l0(p,2)}if(p=c0(u),p===null&&Wp(s,r,u,Ah,l),p===f)break;f=p}f!==null&&u.stopPropagation()}else Wp(s,r,u,null,l)}}function c0(s){return s=oa(s),u0(s)}var Ah=null;function u0(s){if(Ah=null,s=wt(s),s!==null){var r=c(s);if(r===null)s=null;else{var l=r.tag;if(l===13){if(s=d(r),s!==null)return s;s=null}else if(l===31){if(s=m(r),s!==null)return s;s=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return Ah=s,null}function nw(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(De()){case Ge:return 2;case He:return 8;case ee:case ke:return 32;case nt:return 268435456;default:return 32}default:return 32}}var d0=!1,Ni=null,ji=null,_i=null,nu=new Map,au=new Map,Si=[],rT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function aw(s,r){switch(s){case"focusin":case"focusout":Ni=null;break;case"dragenter":case"dragleave":ji=null;break;case"mouseover":case"mouseout":_i=null;break;case"pointerover":case"pointerout":nu.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":au.delete(r.pointerId)}}function ru(s,r,l,u,f,p){return s===null||s.nativeEvent!==p?(s={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:p,targetContainers:[f]},r!==null&&(r=as(r),r!==null&&tw(r)),s):(s.eventSystemFlags|=u,r=s.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),s)}function iT(s,r,l,u,f){switch(r){case"focusin":return Ni=ru(Ni,s,r,l,u,f),!0;case"dragenter":return ji=ru(ji,s,r,l,u,f),!0;case"mouseover":return _i=ru(_i,s,r,l,u,f),!0;case"pointerover":var p=f.pointerId;return nu.set(p,ru(nu.get(p)||null,s,r,l,u,f)),!0;case"gotpointercapture":return p=f.pointerId,au.set(p,ru(au.get(p)||null,s,r,l,u,f)),!0}return!1}function rw(s){var r=wt(s.target);if(r!==null){var l=c(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){s.blockedOn=r,js(s.priority,function(){sw(l)});return}}else if(r===31){if(r=m(l),r!==null){s.blockedOn=r,js(s.priority,function(){sw(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function kh(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var l=c0(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);bc=u,l.target.dispatchEvent(u),bc=null}else return r=as(l),r!==null&&tw(r),s.blockedOn=l,!1;r.shift()}return!0}function iw(s,r,l){kh(s)&&l.delete(r)}function lT(){d0=!1,Ni!==null&&kh(Ni)&&(Ni=null),ji!==null&&kh(ji)&&(ji=null),_i!==null&&kh(_i)&&(_i=null),nu.forEach(iw),au.forEach(iw)}function Ch(s,r){s.blockedOn===r&&(s.blockedOn=null,d0||(d0=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,lT)))}var Rh=null;function lw(s){Rh!==s&&(Rh=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Rh===s&&(Rh=null);for(var r=0;r<s.length;r+=3){var l=s[r],u=s[r+1],f=s[r+2];if(typeof u!="function"){if(u0(u||l)===null)continue;break}var p=as(l);p!==null&&(s.splice(r,3),r-=3,cp(p,{pending:!0,data:f,method:l.method,action:u},u,f))}}))}function Eo(s){function r(q){return Ch(q,s)}Ni!==null&&Ch(Ni,s),ji!==null&&Ch(ji,s),_i!==null&&Ch(_i,s),nu.forEach(r),au.forEach(r);for(var l=0;l<Si.length;l++){var u=Si[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<Si.length&&(l=Si[0],l.blockedOn===null);)rw(l),l.blockedOn===null&&Si.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var f=l[u],p=l[u+1],w=f[D]||null;if(typeof p=="function")w||lw(l);else if(w){var A=null;if(p&&p.hasAttribute("formAction")){if(f=p,w=p[D]||null)A=w.formAction;else if(u0(f)!==null)continue}else A=w.action;typeof A=="function"?l[u+1]=A:(l.splice(u,3),u-=3),lw(l)}}}function ow(){function s(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(w){return f=w})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,f=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function h0(s){this._internalRoot=s}Ih.prototype.render=h0.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,u=Jn();Zv(l,u,s,r,null,null)},Ih.prototype.unmount=h0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;Zv(s.current,2,null,s,null,null),hh(),r[Q]=null}};function Ih(s){this._internalRoot=s}Ih.prototype.unstable_scheduleHydration=function(s){if(s){var r=Fa();s={blockedOn:null,target:s,priority:r};for(var l=0;l<Si.length&&r!==0&&r<Si[l].priority;l++);Si.splice(l,0,s),l===0&&rw(s)}};var cw=e.version;if(cw!=="19.2.4")throw Error(i(527,cw,"19.2.4"));K.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=g(r),s=s!==null?b(s):null,s=s===null?null:s.stateNode,s};var oT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dh.isDisabled&&Dh.supportsFiber)try{is=Dh.inject(oT),yt=Dh}catch{}}return lu.createRoot=function(s,r){if(!o(s))throw Error(i(299));var l=!1,u="",f=xy,p=gy,w=by;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(p=r.onCaughtError),r.onRecoverableError!==void 0&&(w=r.onRecoverableError)),r=Xv(s,1,!1,null,null,l,u,null,f,p,w,ow),s[Q]=r.current,Yp(s),new h0(r)},lu.hydrateRoot=function(s,r,l){if(!o(s))throw Error(i(299));var u=!1,f="",p=xy,w=gy,A=by,q=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(p=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(A=l.onRecoverableError),l.formState!==void 0&&(q=l.formState)),r=Xv(s,1,!0,r,l??null,u,f,q,p,w,A,ow),r.context=Jv(null),l=r.current,u=Jn(),u=qn(u),f=ui(u),f.callback=null,di(l,f,u),l=u,r.current.lanes=l,Ns(r,l),er(r),s[Q]=r.current,Yp(s),new Ih(r)},lu.version="19.2.4",lu}var yw;function bT(){if(yw)return p0.exports;yw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),p0.exports=gT(),p0.exports}var yT=bT();const vT=Ax(yT);var vw="popstate";function wT(n={}){function e(o,c){let{pathname:d="/",search:m="",hash:x=""}=Vl(o.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),$0("",{pathname:d,search:m,hash:x},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function t(o,c){let d=o.document.querySelector("base"),m="";if(d&&d.getAttribute("href")){let x=o.location.href,g=x.indexOf("#");m=g===-1?x:x.slice(0,g)}return m+"#"+(typeof c=="string"?c:Uu(c))}function i(o,c){na(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(c)})`)}return jT(e,t,i,n)}function xs(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function na(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function NT(){return Math.random().toString(36).substring(2,10)}function ww(n,e){return{usr:n.state,key:n.key,idx:e}}function $0(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Vl(e):e,state:t,key:e&&e.key||i||NT()}}function Uu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Vl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function jT(n,e,t,i={}){let{window:o=document.defaultView,v5Compat:c=!1}=i,d=o.history,m="POP",x=null,g=b();g==null&&(g=0,d.replaceState({...d.state,idx:g},""));function b(){return(d.state||{idx:null}).idx}function v(){m="POP";let O=b(),z=O==null?null:O-g;g=O,x&&x({action:m,location:L.location,delta:z})}function _(O,z){m="PUSH";let G=$0(L.location,O,z);t&&t(G,O),g=b()+1;let H=ww(G,g),ae=L.createHref(G);try{d.pushState(H,"",ae)}catch(ue){if(ue instanceof DOMException&&ue.name==="DataCloneError")throw ue;o.location.assign(ae)}c&&x&&x({action:m,location:L.location,delta:1})}function R(O,z){m="REPLACE";let G=$0(L.location,O,z);t&&t(G,O),g=b();let H=ww(G,g),ae=L.createHref(G);d.replaceState(H,"",ae),c&&x&&x({action:m,location:L.location,delta:0})}function B(O){return _T(O)}let L={get action(){return m},get location(){return n(o,d)},listen(O){if(x)throw new Error("A history only accepts one active listener");return o.addEventListener(vw,v),x=O,()=>{o.removeEventListener(vw,v),x=null}},createHref(O){return e(o,O)},createURL:B,encodeLocation(O){let z=B(O);return{pathname:z.pathname,search:z.search,hash:z.hash}},push:_,replace:R,go(O){return d.go(O)}};return L}function _T(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),xs(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:Uu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function G1(n,e,t="/"){return ST(n,e,t,!1)}function ST(n,e,t,i){let o=typeof e=="string"?Vl(e):e,c=Fr(o.pathname||"/",t);if(c==null)return null;let d=Y1(n);ET(d);let m=null;for(let x=0;m==null&&x<d.length;++x){let g=VT(c);m=OT(d[x],g,i)}return m}function Y1(n,e=[],t=[],i="",o=!1){let c=(d,m,x=o,g)=>{let b={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:m,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&x)return;xs(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let v=Ur([i,b.relativePath]),_=t.concat(b);d.children&&d.children.length>0&&(xs(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),Y1(d.children,e,_,v,x)),!(d.path==null&&!d.index)&&e.push({path:v,score:DT(v,d.index),routesMeta:_})};return n.forEach((d,m)=>{if(d.path===""||!d.path?.includes("?"))c(d,m);else for(let x of W1(d.path))c(d,m,!0,x)}),e}function W1(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,o=t.endsWith("?"),c=t.replace(/\?$/,"");if(i.length===0)return o?[c,""]:[c];let d=W1(i.join("/")),m=[];return m.push(...d.map(x=>x===""?c:[c,x].join("/"))),o&&m.push(...d),m.map(x=>n.startsWith("/")&&x===""?"/":x)}function ET(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:MT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var TT=/^:[\w-]+$/,AT=3,kT=2,CT=1,RT=10,IT=-2,Nw=n=>n==="*";function DT(n,e){let t=n.split("/"),i=t.length;return t.some(Nw)&&(i+=IT),e&&(i+=kT),t.filter(o=>!Nw(o)).reduce((o,c)=>o+(TT.test(c)?AT:c===""?CT:RT),i)}function MT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,o)=>i===e[o])?n[n.length-1]-e[e.length-1]:0}function OT(n,e,t=!1){let{routesMeta:i}=n,o={},c="/",d=[];for(let m=0;m<i.length;++m){let x=i[m],g=m===i.length-1,b=c==="/"?e:e.slice(c.length)||"/",v=mf({path:x.relativePath,caseSensitive:x.caseSensitive,end:g},b),_=x.route;if(!v&&g&&t&&!i[i.length-1].route.index&&(v=mf({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},b)),!v)return null;Object.assign(o,v.params),d.push({params:o,pathname:Ur([c,v.pathname]),pathnameBase:zT(Ur([c,v.pathnameBase])),route:_}),v.pathnameBase!=="/"&&(c=Ur([c,v.pathnameBase]))}return d}function mf(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=PT(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),m=o.slice(1);return{params:i.reduce((g,{paramName:b,isOptional:v},_)=>{if(b==="*"){let B=m[_]||"";d=c.slice(0,c.length-B.length).replace(/(.)\/+$/,"$1")}const R=m[_];return v&&!R?g[b]=void 0:g[b]=(R||"").replace(/%2F/g,"/"),g},{}),pathname:c,pathnameBase:d,pattern:n}}function PT(n,e=!1,t=!0){na(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,m,x)=>(i.push({paramName:m,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function VT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return na(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Fr(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var LT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function UT(n,e="/"){let{pathname:t,search:i="",hash:o=""}=typeof n=="string"?Vl(n):n,c;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?c=jw(t.substring(1),"/"):c=jw(t,e)):c=e,{pathname:c,search:FT(i),hash:$T(o)}}function jw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function y0(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function BT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Cx(n){let e=BT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Rx(n,e,t,i=!1){let o;typeof n=="string"?o=Vl(n):(o={...n},xs(!o.pathname||!o.pathname.includes("?"),y0("?","pathname","search",o)),xs(!o.pathname||!o.pathname.includes("#"),y0("#","pathname","hash",o)),xs(!o.search||!o.search.includes("#"),y0("#","search","hash",o)));let c=n===""||o.pathname==="",d=c?"/":o.pathname,m;if(d==null)m=t;else{let v=e.length-1;if(!i&&d.startsWith("..")){let _=d.split("/");for(;_[0]==="..";)_.shift(),v-=1;o.pathname=_.join("/")}m=v>=0?e[v]:"/"}let x=UT(o,m),g=d&&d!=="/"&&d.endsWith("/"),b=(c||d===".")&&t.endsWith("/");return!x.pathname.endsWith("/")&&(g||b)&&(x.pathname+="/"),x}var Ur=n=>n.join("/").replace(/\/\/+/g,"/"),zT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),FT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,$T=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,qT=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function HT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function GT(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var K1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Q1(n,e){let t=n;if(typeof t!="string"||!LT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,o=!1;if(K1)try{let c=new URL(window.location.href),d=t.startsWith("//")?new URL(c.protocol+t):new URL(t),m=Fr(d.pathname,e);d.origin===c.origin&&m!=null?t=m+d.search+d.hash:o=!0}catch{na(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:o,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var X1=["POST","PUT","PATCH","DELETE"];new Set(X1);var YT=["GET",...X1];new Set(YT);var nc=j.createContext(null);nc.displayName="DataRouter";var Ff=j.createContext(null);Ff.displayName="DataRouterState";var WT=j.createContext(!1),J1=j.createContext({isTransitioning:!1});J1.displayName="ViewTransition";var KT=j.createContext(new Map);KT.displayName="Fetchers";var QT=j.createContext(null);QT.displayName="Await";var aa=j.createContext(null);aa.displayName="Navigation";var ed=j.createContext(null);ed.displayName="Location";var Ba=j.createContext({outlet:null,matches:[],isDataRoute:!1});Ba.displayName="Route";var Ix=j.createContext(null);Ix.displayName="RouteError";var Z1="REACT_ROUTER_ERROR",XT="REDIRECT",JT="ROUTE_ERROR_RESPONSE";function ZT(n){if(n.startsWith(`${Z1}:${XT}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function e5(n){if(n.startsWith(`${Z1}:${JT}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new qT(e.status,e.statusText,e.data)}catch{}}function t5(n,{relative:e}={}){xs(ac(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=j.useContext(aa),{hash:o,pathname:c,search:d}=td(n,{relative:e}),m=c;return t!=="/"&&(m=c==="/"?t:Ur([t,c])),i.createHref({pathname:m,search:d,hash:o})}function ac(){return j.useContext(ed)!=null}function Kr(){return xs(ac(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(ed).location}var ej="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function tj(n){j.useContext(aa).static||j.useLayoutEffect(n)}function hr(){let{isDataRoute:n}=j.useContext(Ba);return n?m5():s5()}function s5(){xs(ac(),"useNavigate() may be used only in the context of a <Router> component.");let n=j.useContext(nc),{basename:e,navigator:t}=j.useContext(aa),{matches:i}=j.useContext(Ba),{pathname:o}=Kr(),c=JSON.stringify(Cx(i)),d=j.useRef(!1);return tj(()=>{d.current=!0}),j.useCallback((x,g={})=>{if(na(d.current,ej),!d.current)return;if(typeof x=="number"){t.go(x);return}let b=Rx(x,JSON.parse(c),o,g.relative==="path");n==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Ur([e,b.pathname])),(g.replace?t.replace:t.push)(b,g.state,g)},[e,t,c,o,n])}j.createContext(null);function rc(){let{matches:n}=j.useContext(Ba),e=n[n.length-1];return e?e.params:{}}function td(n,{relative:e}={}){let{matches:t}=j.useContext(Ba),{pathname:i}=Kr(),o=JSON.stringify(Cx(t));return j.useMemo(()=>Rx(n,JSON.parse(o),i,e==="path"),[n,o,i,e])}function n5(n,e){return sj(n,e)}function sj(n,e,t,i,o){xs(ac(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=j.useContext(aa),{matches:d}=j.useContext(Ba),m=d[d.length-1],x=m?m.params:{},g=m?m.pathname:"/",b=m?m.pathnameBase:"/",v=m&&m.route;{let G=v&&v.path||"";aj(g,!v||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let _=Kr(),R;if(e){let G=typeof e=="string"?Vl(e):e;xs(b==="/"||G.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${G.pathname}" was given in the \`location\` prop.`),R=G}else R=_;let B=R.pathname||"/",L=B;if(b!=="/"){let G=b.replace(/^\//,"").split("/");L="/"+B.replace(/^\//,"").split("/").slice(G.length).join("/")}let O=G1(n,{pathname:L});na(v||O!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),na(O==null||O[O.length-1].route.element!==void 0||O[O.length-1].route.Component!==void 0||O[O.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let z=o5(O&&O.map(G=>Object.assign({},G,{params:Object.assign({},x,G.params),pathname:Ur([b,c.encodeLocation?c.encodeLocation(G.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?b:Ur([b,c.encodeLocation?c.encodeLocation(G.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathnameBase])})),d,t,i,o);return e&&z?j.createElement(ed.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...R},navigationType:"POP"}},z):z}function a5(){let n=f5(),e=HT(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},c={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:c},"ErrorBoundary")," or"," ",j.createElement("code",{style:c},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:o},t):null,d)}var r5=j.createElement(a5,null),nj=class extends j.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=e5(n.digest);t&&(n=t)}let e=n!==void 0?j.createElement(Ba.Provider,{value:this.props.routeContext},j.createElement(Ix.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?j.createElement(i5,{error:n},e):e}};nj.contextType=WT;var v0=new WeakMap;function i5({children:n,error:e}){let{basename:t}=j.useContext(aa);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=ZT(e.digest);if(i){let o=v0.get(e);if(o)throw o;let c=Q1(i.location,t);if(K1&&!v0.get(e))if(c.isExternal||i.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:i.replace}));throw v0.set(e,d),d}return j.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return n}function l5({routeContext:n,match:e,children:t}){let i=j.useContext(nc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),j.createElement(Ba.Provider,{value:n},t)}function o5(n,e=[],t=null,i=null,o=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,d=t?.errors;if(d!=null){let b=c.findIndex(v=>v.route.id&&d?.[v.route.id]!==void 0);xs(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,b+1))}let m=!1,x=-1;if(t)for(let b=0;b<c.length;b++){let v=c[b];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(x=b),v.route.id){let{loaderData:_,errors:R}=t,B=v.route.loader&&!_.hasOwnProperty(v.route.id)&&(!R||R[v.route.id]===void 0);if(v.route.lazy||B){m=!0,x>=0?c=c.slice(0,x+1):c=[c[0]];break}}}let g=t&&i?(b,v)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:GT(t.matches),errorInfo:v})}:void 0;return c.reduceRight((b,v,_)=>{let R,B=!1,L=null,O=null;t&&(R=d&&v.route.id?d[v.route.id]:void 0,L=v.route.errorElement||r5,m&&(x<0&&_===0?(aj("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),B=!0,O=null):x===_&&(B=!0,O=v.route.hydrateFallbackElement||null)));let z=e.concat(c.slice(0,_+1)),G=()=>{let H;return R?H=L:B?H=O:v.route.Component?H=j.createElement(v.route.Component,null):v.route.element?H=v.route.element:H=b,j.createElement(l5,{match:v,routeContext:{outlet:b,matches:z,isDataRoute:t!=null},children:H})};return t&&(v.route.ErrorBoundary||v.route.errorElement||_===0)?j.createElement(nj,{location:t.location,revalidation:t.revalidation,component:L,error:R,children:G(),routeContext:{outlet:null,matches:z,isDataRoute:!0},onError:g}):G()},null)}function Dx(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function c5(n){let e=j.useContext(nc);return xs(e,Dx(n)),e}function u5(n){let e=j.useContext(Ff);return xs(e,Dx(n)),e}function d5(n){let e=j.useContext(Ba);return xs(e,Dx(n)),e}function Mx(n){let e=d5(n),t=e.matches[e.matches.length-1];return xs(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function h5(){return Mx("useRouteId")}function f5(){let n=j.useContext(Ix),e=u5("useRouteError"),t=Mx("useRouteError");return n!==void 0?n:e.errors?.[t]}function m5(){let{router:n}=c5("useNavigate"),e=Mx("useNavigate"),t=j.useRef(!1);return tj(()=>{t.current=!0}),j.useCallback(async(o,c={})=>{na(t.current,ej),t.current&&(typeof o=="number"?await n.navigate(o):await n.navigate(o,{fromRouteId:e,...c}))},[n,e])}var _w={};function aj(n,e,t){!e&&!_w[n]&&(_w[n]=!0,na(!1,t))}j.memo(p5);function p5({routes:n,future:e,state:t,onError:i}){return sj(n,void 0,t,i,e)}function x5({to:n,replace:e,state:t,relative:i}){xs(ac(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=j.useContext(aa);na(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=j.useContext(Ba),{pathname:d}=Kr(),m=hr(),x=Rx(n,Cx(c),d,i==="path"),g=JSON.stringify(x);return j.useEffect(()=>{m(JSON.parse(g),{replace:e,state:t,relative:i})},[m,g,i,e,t]),null}function Rn(n){xs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function g5({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:o,static:c=!1,unstable_useTransitions:d}){xs(!ac(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let m=n.replace(/^\/*/,"/"),x=j.useMemo(()=>({basename:m,navigator:o,static:c,unstable_useTransitions:d,future:{}}),[m,o,c,d]);typeof t=="string"&&(t=Vl(t));let{pathname:g="/",search:b="",hash:v="",state:_=null,key:R="default"}=t,B=j.useMemo(()=>{let L=Fr(g,m);return L==null?null:{location:{pathname:L,search:b,hash:v,state:_,key:R},navigationType:i}},[m,g,b,v,_,R,i]);return na(B!=null,`<Router basename="${m}"> is not able to match the URL "${g}${b}${v}" because it does not start with the basename, so the <Router> won't render anything.`),B==null?null:j.createElement(aa.Provider,{value:x},j.createElement(ed.Provider,{children:e,value:B}))}function b5({children:n,location:e}){return n5(q0(n),e)}function q0(n,e=[]){let t=[];return j.Children.forEach(n,(i,o)=>{if(!j.isValidElement(i))return;let c=[...e,o];if(i.type===j.Fragment){t.push.apply(t,q0(i.props.children,c));return}xs(i.type===Rn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xs(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||c.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=q0(i.props.children,c)),t.push(d)}),t}var Kh="get",Qh="application/x-www-form-urlencoded";function $f(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function y5(n){return $f(n)&&n.tagName.toLowerCase()==="button"}function v5(n){return $f(n)&&n.tagName.toLowerCase()==="form"}function w5(n){return $f(n)&&n.tagName.toLowerCase()==="input"}function N5(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function j5(n,e){return n.button===0&&(!e||e==="_self")&&!N5(n)}function H0(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(o=>[t,o]):[[t,i]])},[]))}function _5(n,e){let t=H0(n);return e&&e.forEach((i,o)=>{t.has(o)||e.getAll(o).forEach(c=>{t.append(o,c)})}),t}var Mh=null;function S5(){if(Mh===null)try{new FormData(document.createElement("form"),0),Mh=!1}catch{Mh=!0}return Mh}var E5=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function w0(n){return n!=null&&!E5.has(n)?(na(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Qh}"`),null):n}function T5(n,e){let t,i,o,c,d;if(v5(n)){let m=n.getAttribute("action");i=m?Fr(m,e):null,t=n.getAttribute("method")||Kh,o=w0(n.getAttribute("enctype"))||Qh,c=new FormData(n)}else if(y5(n)||w5(n)&&(n.type==="submit"||n.type==="image")){let m=n.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let x=n.getAttribute("formaction")||m.getAttribute("action");if(i=x?Fr(x,e):null,t=n.getAttribute("formmethod")||m.getAttribute("method")||Kh,o=w0(n.getAttribute("formenctype"))||w0(m.getAttribute("enctype"))||Qh,c=new FormData(m,n),!S5()){let{name:g,type:b,value:v}=n;if(b==="image"){let _=g?`${g}.`:"";c.append(`${_}x`,"0"),c.append(`${_}y`,"0")}else g&&c.append(g,v)}}else{if($f(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Kh,i=null,o=Qh,d=n}return c&&o==="text/plain"&&(d=c,c=void 0),{action:i,method:t.toLowerCase(),encType:o,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ox(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function A5(n,e,t,i){let o=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${i}`:o.pathname=`${o.pathname}.${i}`:o.pathname==="/"?o.pathname=`_root.${i}`:e&&Fr(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${i}`,o}async function k5(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function C5(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function R5(n,e,t){let i=await Promise.all(n.map(async o=>{let c=e.routes[o.route.id];if(c){let d=await k5(c,t);return d.links?d.links():[]}return[]}));return O5(i.flat(1).filter(C5).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Sw(n,e,t,i,o,c){let d=(x,g)=>t[g]?x.route.id!==t[g].route.id:!0,m=(x,g)=>t[g].pathname!==x.pathname||t[g].route.path?.endsWith("*")&&t[g].params["*"]!==x.params["*"];return c==="assets"?e.filter((x,g)=>d(x,g)||m(x,g)):c==="data"?e.filter((x,g)=>{let b=i.routes[x.route.id];if(!b||!b.hasLoader)return!1;if(d(x,g)||m(x,g))return!0;if(x.route.shouldRevalidate){let v=x.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:x.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function I5(n,e,{includeHydrateFallback:t}={}){return D5(n.map(i=>{let o=e.routes[i.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function D5(n){return[...new Set(n)]}function M5(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function O5(n,e){let t=new Set;return new Set(e),n.reduce((i,o)=>{let c=JSON.stringify(M5(o));return t.has(c)||(t.add(c),i.push({key:c,link:o})),i},[])}function rj(){let n=j.useContext(nc);return Ox(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function P5(){let n=j.useContext(Ff);return Ox(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Px=j.createContext(void 0);Px.displayName="FrameworkContext";function ij(){let n=j.useContext(Px);return Ox(n,"You must render this element inside a <HydratedRouter> element"),n}function V5(n,e){let t=j.useContext(Px),[i,o]=j.useState(!1),[c,d]=j.useState(!1),{onFocus:m,onBlur:x,onMouseEnter:g,onMouseLeave:b,onTouchStart:v}=e,_=j.useRef(null);j.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let L=z=>{z.forEach(G=>{d(G.isIntersecting)})},O=new IntersectionObserver(L,{threshold:.5});return _.current&&O.observe(_.current),()=>{O.disconnect()}}},[n]),j.useEffect(()=>{if(i){let L=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(L)}}},[i]);let R=()=>{o(!0)},B=()=>{o(!1),d(!1)};return t?n!=="intent"?[c,_,{}]:[c,_,{onFocus:ou(m,R),onBlur:ou(x,B),onMouseEnter:ou(g,R),onMouseLeave:ou(b,B),onTouchStart:ou(v,R)}]:[!1,_,{}]}function ou(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function L5({page:n,...e}){let{router:t}=rj(),i=j.useMemo(()=>G1(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?j.createElement(B5,{page:n,matches:i,...e}):null}function U5(n){let{manifest:e,routeModules:t}=ij(),[i,o]=j.useState([]);return j.useEffect(()=>{let c=!1;return R5(n,e,t).then(d=>{c||o(d)}),()=>{c=!0}},[n,e,t]),i}function B5({page:n,matches:e,...t}){let i=Kr(),{future:o,manifest:c,routeModules:d}=ij(),{basename:m}=rj(),{loaderData:x,matches:g}=P5(),b=j.useMemo(()=>Sw(n,e,g,c,i,"data"),[n,e,g,c,i]),v=j.useMemo(()=>Sw(n,e,g,c,i,"assets"),[n,e,g,c,i]),_=j.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let L=new Set,O=!1;if(e.forEach(G=>{let H=c.routes[G.route.id];!H||!H.hasLoader||(!b.some(ae=>ae.route.id===G.route.id)&&G.route.id in x&&d[G.route.id]?.shouldRevalidate||H.hasClientLoader?O=!0:L.add(G.route.id))}),L.size===0)return[];let z=A5(n,m,o.unstable_trailingSlashAwareDataRequests,"data");return O&&L.size>0&&z.searchParams.set("_routes",e.filter(G=>L.has(G.route.id)).map(G=>G.route.id).join(",")),[z.pathname+z.search]},[m,o.unstable_trailingSlashAwareDataRequests,x,i,c,b,e,n,d]),R=j.useMemo(()=>I5(v,c),[v,c]),B=U5(v);return j.createElement(j.Fragment,null,_.map(L=>j.createElement("link",{key:L,rel:"prefetch",as:"fetch",href:L,...t})),R.map(L=>j.createElement("link",{key:L,rel:"modulepreload",href:L,...t})),B.map(({key:L,link:O})=>j.createElement("link",{key:L,nonce:t.nonce,...O,crossOrigin:O.crossOrigin??t.crossOrigin})))}function z5(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var F5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{F5&&(window.__reactRouterVersion="7.13.0")}catch{}function $5({basename:n,children:e,unstable_useTransitions:t,window:i}){let o=j.useRef();o.current==null&&(o.current=wT({window:i,v5Compat:!0}));let c=o.current,[d,m]=j.useState({action:c.action,location:c.location}),x=j.useCallback(g=>{t===!1?m(g):j.startTransition(()=>m(g))},[t]);return j.useLayoutEffect(()=>c.listen(x),[c,x]),j.createElement(g5,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:c,unstable_useTransitions:t})}var lj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ze=j.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:o,reloadDocument:c,replace:d,state:m,target:x,to:g,preventScrollReset:b,viewTransition:v,unstable_defaultShouldRevalidate:_,...R},B){let{basename:L,unstable_useTransitions:O}=j.useContext(aa),z=typeof g=="string"&&lj.test(g),G=Q1(g,L);g=G.to;let H=t5(g,{relative:o}),[ae,ue,Y]=V5(i,R),T=Y5(g,{replace:d,state:m,target:x,preventScrollReset:b,relative:o,viewTransition:v,unstable_defaultShouldRevalidate:_,unstable_useTransitions:O});function E(k){e&&e(k),k.defaultPrevented||T(k)}let S=j.createElement("a",{...R,...Y,href:G.absoluteURL||H,onClick:G.isExternal||c?e:E,ref:z5(B,ue),target:x,"data-discover":!z&&t==="render"?"true":void 0});return ae&&!z?j.createElement(j.Fragment,null,S,j.createElement(L5,{page:H})):S});Ze.displayName="Link";var q5=j.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:o=!1,style:c,to:d,viewTransition:m,children:x,...g},b){let v=td(d,{relative:g.relative}),_=Kr(),R=j.useContext(Ff),{navigator:B,basename:L}=j.useContext(aa),O=R!=null&&J5(v)&&m===!0,z=B.encodeLocation?B.encodeLocation(v).pathname:v.pathname,G=_.pathname,H=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;t||(G=G.toLowerCase(),H=H?H.toLowerCase():null,z=z.toLowerCase()),H&&L&&(H=Fr(H,L)||H);const ae=z!=="/"&&z.endsWith("/")?z.length-1:z.length;let ue=G===z||!o&&G.startsWith(z)&&G.charAt(ae)==="/",Y=H!=null&&(H===z||!o&&H.startsWith(z)&&H.charAt(z.length)==="/"),T={isActive:ue,isPending:Y,isTransitioning:O},E=ue?e:void 0,S;typeof i=="function"?S=i(T):S=[i,ue?"active":null,Y?"pending":null,O?"transitioning":null].filter(Boolean).join(" ");let k=typeof c=="function"?c(T):c;return j.createElement(Ze,{...g,"aria-current":E,className:S,ref:b,style:k,to:d,viewTransition:m},typeof x=="function"?x(T):x)});q5.displayName="NavLink";var H5=j.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:o,state:c,method:d=Kh,action:m,onSubmit:x,relative:g,preventScrollReset:b,viewTransition:v,unstable_defaultShouldRevalidate:_,...R},B)=>{let{unstable_useTransitions:L}=j.useContext(aa),O=Q5(),z=X5(m,{relative:g}),G=d.toLowerCase()==="get"?"get":"post",H=typeof m=="string"&&lj.test(m),ae=ue=>{if(x&&x(ue),ue.defaultPrevented)return;ue.preventDefault();let Y=ue.nativeEvent.submitter,T=Y?.getAttribute("formmethod")||d,E=()=>O(Y||ue.currentTarget,{fetcherKey:e,method:T,navigate:t,replace:o,state:c,relative:g,preventScrollReset:b,viewTransition:v,unstable_defaultShouldRevalidate:_});L&&t!==!1?j.startTransition(()=>E()):E()};return j.createElement("form",{ref:B,method:G,action:z,onSubmit:i?x:ae,...R,"data-discover":!H&&n==="render"?"true":void 0})});H5.displayName="Form";function G5(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oj(n){let e=j.useContext(nc);return xs(e,G5(n)),e}function Y5(n,{target:e,replace:t,state:i,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:m,unstable_useTransitions:x}={}){let g=hr(),b=Kr(),v=td(n,{relative:c});return j.useCallback(_=>{if(j5(_,e)){_.preventDefault();let R=t!==void 0?t:Uu(b)===Uu(v),B=()=>g(n,{replace:R,state:i,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:m});x?j.startTransition(()=>B()):B()}},[b,g,v,t,i,e,n,o,c,d,m,x])}function cj(n){na(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=j.useRef(H0(n)),t=j.useRef(!1),i=Kr(),o=j.useMemo(()=>_5(i.search,t.current?null:e.current),[i.search]),c=hr(),d=j.useCallback((m,x)=>{const g=H0(typeof m=="function"?m(new URLSearchParams(o)):m);t.current=!0,c("?"+g,x)},[c,o]);return[o,d]}var W5=0,K5=()=>`__${String(++W5)}__`;function Q5(){let{router:n}=oj("useSubmit"),{basename:e}=j.useContext(aa),t=h5(),i=n.fetch,o=n.navigate;return j.useCallback(async(c,d={})=>{let{action:m,method:x,encType:g,formData:b,body:v}=T5(c,e);if(d.navigate===!1){let _=d.fetcherKey||K5();await i(_,t,d.action||m,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:v,formMethod:d.method||x,formEncType:d.encType||g,flushSync:d.flushSync})}else await o(d.action||m,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:v,formMethod:d.method||x,formEncType:d.encType||g,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,o,e,t])}function X5(n,{relative:e}={}){let{basename:t}=j.useContext(aa),i=j.useContext(Ba);xs(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),c={...td(n||".",{relative:e})},d=Kr();if(n==null){c.search=d.search;let m=new URLSearchParams(c.search),x=m.getAll("index");if(x.some(b=>b==="")){m.delete("index"),x.filter(v=>v).forEach(v=>m.append("index",v));let b=m.toString();c.search=b?`?${b}`:""}}return(!n||n===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(c.pathname=c.pathname==="/"?t:Ur([t,c.pathname])),Uu(c)}function J5(n,{relative:e}={}){let t=j.useContext(J1);xs(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=oj("useViewTransitionState"),o=td(n,{relative:e});if(!t.isTransitioning)return!1;let c=Fr(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=Fr(t.nextLocation.pathname,i)||t.nextLocation.pathname;return mf(o.pathname,d)!=null||mf(o.pathname,c)!=null}const Z5=()=>{};var Ew={};const uj=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},eA=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[i++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],m=n[t++],x=((o&7)<<18|(c&63)<<12|(d&63)<<6|m&63)-65536;e[i++]=String.fromCharCode(55296+(x>>10)),e[i++]=String.fromCharCode(56320+(x&1023))}else{const c=n[t++],d=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},dj={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,m=d?n[o+1]:0,x=o+2<n.length,g=x?n[o+2]:0,b=c>>2,v=(c&3)<<4|m>>4;let _=(m&15)<<2|g>>6,R=g&63;x||(R=64,d||(_=64)),i.push(t[b],t[v],t[_],t[R])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(uj(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):eA(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],m=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const v=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||m==null||g==null||v==null)throw new tA;const _=c<<2|m>>4;if(i.push(_),g!==64){const R=m<<4&240|g>>2;if(i.push(R),v!==64){const B=g<<6&192|v;i.push(B)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class tA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const sA=function(n){const e=uj(n);return dj.encodeByteArray(e,!0)},pf=function(n){return sA(n).replace(/\./g,"")},hj=function(n){try{return dj.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function nA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const aA=()=>nA().__FIREBASE_DEFAULTS__,rA=()=>{if(typeof process>"u"||typeof Ew>"u")return;const n=Ew.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},iA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&hj(n[1]);return e&&JSON.parse(e)},qf=()=>{try{return Z5()||aA()||rA()||iA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},fj=n=>qf()?.emulatorHosts?.[n],Vx=n=>{const e=fj(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},mj=()=>qf()?.config,pj=n=>qf()?.[`_${n}`];class lA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function fr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Hf(n){return(await fetch(n,{credentials:"include"})).ok}function xj(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}},...n};return[pf(JSON.stringify(t)),pf(JSON.stringify(d)),""].join(".")}const Su={};function oA(){const n={prod:[],emulator:[]};for(const e of Object.keys(Su))Su[e]?n.emulator.push(e):n.prod.push(e);return n}function cA(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Tw=!1;function Gf(n,e){if(typeof window>"u"||typeof document>"u"||!fr(window.location.host)||Su[n]===e||Su[n]||Tw)return;Su[n]=e;function t(_){return`__firebase__banner__${_}`}const i="__firebase__banner",c=oA().prod.length>0;function d(){const _=document.getElementById(i);_&&_.remove()}function m(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function x(_,R){_.setAttribute("width","24"),_.setAttribute("id",R),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function g(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Tw=!0,d()},_}function b(_,R){_.setAttribute("id",R),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function v(){const _=cA(i),R=t("text"),B=document.getElementById(R)||document.createElement("span"),L=t("learnmore"),O=document.getElementById(L)||document.createElement("a"),z=t("preprendIcon"),G=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const H=_.element;m(H),b(O,L);const ae=g();x(G,z),H.append(G,B,O,ae),document.body.appendChild(H)}c?(B.innerText="Preview backend disconnected.",G.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(G.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function uA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gn())}function dA(){const n=qf()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function fA(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function mA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function pA(){const n=gn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function xA(){return!dA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gA(){try{return typeof indexedDB=="object"}catch{return!1}}function bA(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}const yA="FirebaseError";class za extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=yA,Object.setPrototypeOf(this,za.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,sd.prototype.create)}}class sd{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?vA(c,i):"Error",m=`${this.serviceName}: ${d} (${o}).`;return new za(o,m,i)}}function vA(n,e){return n.replace(wA,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const wA=/\{\$([^}]+)}/g;function NA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Rl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const c=n[o],d=e[o];if(Aw(c)&&Aw(d)){if(!Rl(c,d))return!1}else if(c!==d)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function Aw(n){return n!==null&&typeof n=="object"}function ic(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function gu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,c]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function bu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function jA(n,e){const t=new _A(n,e);return t.subscribe.bind(t)}class _A{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");SA(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=N0),o.error===void 0&&(o.error=N0),o.complete===void 0&&(o.complete=N0);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function N0(){}function Zt(n){return n&&n._delegate?n._delegate:n}class $r{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Sl="[DEFAULT]";class EA{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new lA;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AA(e))try{this.getOrInitializeService({instanceIdentifier:Sl})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});i.resolve(c)}catch{}}}}clearInstance(e=Sl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Sl){return this.instances.has(e)}getOptions(e=Sl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[c,d]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(c);i===m&&d.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const c=this.instances.get(i);return c&&e(c,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:TA(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Sl){return this.component?this.component.multipleInstances?e:Sl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function TA(n){return n===Sl?void 0:n}function AA(n){return n.instantiationMode==="EAGER"}class kA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new EA(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Tt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Tt||(Tt={}));const CA={debug:Tt.DEBUG,verbose:Tt.VERBOSE,info:Tt.INFO,warn:Tt.WARN,error:Tt.ERROR,silent:Tt.SILENT},RA=Tt.INFO,IA={[Tt.DEBUG]:"log",[Tt.VERBOSE]:"log",[Tt.INFO]:"info",[Tt.WARN]:"warn",[Tt.ERROR]:"error"},DA=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=IA[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Lx{constructor(e){this.name=e,this._logLevel=RA,this._logHandler=DA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?CA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Tt.DEBUG,...e),this._logHandler(this,Tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Tt.VERBOSE,...e),this._logHandler(this,Tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Tt.INFO,...e),this._logHandler(this,Tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Tt.WARN,...e),this._logHandler(this,Tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Tt.ERROR,...e),this._logHandler(this,Tt.ERROR,...e)}}const MA=(n,e)=>e.some(t=>n instanceof t);let kw,Cw;function OA(){return kw||(kw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function PA(){return Cw||(Cw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gj=new WeakMap,G0=new WeakMap,bj=new WeakMap,j0=new WeakMap,Ux=new WeakMap;function VA(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(Mi(n.result)),o()},d=()=>{i(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&gj.set(t,n)}).catch(()=>{}),Ux.set(e,n),e}function LA(n){if(G0.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});G0.set(n,e)}let Y0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return G0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||bj.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Mi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function UA(n){Y0=n(Y0)}function BA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(_0(this),e,...t);return bj.set(i,e.sort?e.sort():[e]),Mi(i)}:PA().includes(n)?function(...e){return n.apply(_0(this),e),Mi(gj.get(this))}:function(...e){return Mi(n.apply(_0(this),e))}}function zA(n){return typeof n=="function"?BA(n):(n instanceof IDBTransaction&&LA(n),MA(n,OA())?new Proxy(n,Y0):n)}function Mi(n){if(n instanceof IDBRequest)return VA(n);if(j0.has(n))return j0.get(n);const e=zA(n);return e!==n&&(j0.set(n,e),Ux.set(e,n)),e}const _0=n=>Ux.get(n);function FA(n,e,{blocked:t,upgrade:i,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),m=Mi(d);return i&&d.addEventListener("upgradeneeded",x=>{i(Mi(d.result),x.oldVersion,x.newVersion,Mi(d.transaction),x)}),t&&d.addEventListener("blocked",x=>t(x.oldVersion,x.newVersion,x)),m.then(x=>{c&&x.addEventListener("close",()=>c()),o&&x.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),m}const $A=["get","getKey","getAll","getAllKeys","count"],qA=["put","add","delete","clear"],S0=new Map;function Rw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(S0.get(e))return S0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=qA.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||$A.includes(t)))return;const c=async function(d,...m){const x=this.transaction(d,o?"readwrite":"readonly");let g=x.store;return i&&(g=g.index(m.shift())),(await Promise.all([g[t](...m),o&&x.done]))[0]};return S0.set(e,c),c}UA(n=>({...n,get:(e,t,i)=>Rw(e,t)||n.get(e,t,i),has:(e,t)=>!!Rw(e,t)||n.has(e,t)}));class HA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(GA(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function GA(n){return n.getComponent()?.type==="VERSION"}const W0="@firebase/app",Iw="0.14.7";const qr=new Lx("@firebase/app"),YA="@firebase/app-compat",WA="@firebase/analytics-compat",KA="@firebase/analytics",QA="@firebase/app-check-compat",XA="@firebase/app-check",JA="@firebase/auth",ZA="@firebase/auth-compat",ek="@firebase/database",tk="@firebase/data-connect",sk="@firebase/database-compat",nk="@firebase/functions",ak="@firebase/functions-compat",rk="@firebase/installations",ik="@firebase/installations-compat",lk="@firebase/messaging",ok="@firebase/messaging-compat",ck="@firebase/performance",uk="@firebase/performance-compat",dk="@firebase/remote-config",hk="@firebase/remote-config-compat",fk="@firebase/storage",mk="@firebase/storage-compat",pk="@firebase/firestore",xk="@firebase/ai",gk="@firebase/firestore-compat",bk="firebase",yk="12.8.0";const K0="[DEFAULT]",vk={[W0]:"fire-core",[YA]:"fire-core-compat",[KA]:"fire-analytics",[WA]:"fire-analytics-compat",[XA]:"fire-app-check",[QA]:"fire-app-check-compat",[JA]:"fire-auth",[ZA]:"fire-auth-compat",[ek]:"fire-rtdb",[tk]:"fire-data-connect",[sk]:"fire-rtdb-compat",[nk]:"fire-fn",[ak]:"fire-fn-compat",[rk]:"fire-iid",[ik]:"fire-iid-compat",[lk]:"fire-fcm",[ok]:"fire-fcm-compat",[ck]:"fire-perf",[uk]:"fire-perf-compat",[dk]:"fire-rc",[hk]:"fire-rc-compat",[fk]:"fire-gcs",[mk]:"fire-gcs-compat",[pk]:"fire-fst",[gk]:"fire-fst-compat",[xk]:"fire-vertex","fire-js":"fire-js",[bk]:"fire-js-all"};const xf=new Map,wk=new Map,Q0=new Map;function Dw(n,e){try{n.container.addComponent(e)}catch(t){qr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ui(n){const e=n.name;if(Q0.has(e))return qr.debug(`There were multiple attempts to register component ${e}.`),!1;Q0.set(e,n);for(const t of xf.values())Dw(t,n);for(const t of wk.values())Dw(t,n);return!0}function nd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function jn(n){return n==null?!1:n.settings!==void 0}const Nk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Oi=new sd("app","Firebase",Nk);class jk{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new $r("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Oi.create("app-deleted",{appName:this._name})}}const Ll=yk;function yj(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:K0,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw Oi.create("bad-app-name",{appName:String(o)});if(t||(t=mj()),!t)throw Oi.create("no-options");const c=xf.get(o);if(c){if(Rl(t,c.options)&&Rl(i,c.config))return c;throw Oi.create("duplicate-app",{appName:o})}const d=new kA(o);for(const x of Q0.values())d.addComponent(x);const m=new jk(t,i,d);return xf.set(o,m),m}function Yf(n=K0){const e=xf.get(n);if(!e&&n===K0&&mj())return yj();if(!e)throw Oi.create("no-app",{appName:n});return e}function wa(n,e,t){let i=vk[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const d=[`Unable to register library "${i}" with version "${e}":`];o&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qr.warn(d.join(" "));return}Ui(new $r(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const _k="firebase-heartbeat-database",Sk=1,Bu="firebase-heartbeat-store";let E0=null;function vj(){return E0||(E0=FA(_k,Sk,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Bu)}catch(t){console.warn(t)}}}}).catch(n=>{throw Oi.create("idb-open",{originalErrorMessage:n.message})})),E0}async function Ek(n){try{const t=(await vj()).transaction(Bu),i=await t.objectStore(Bu).get(wj(n));return await t.done,i}catch(e){if(e instanceof za)qr.warn(e.message);else{const t=Oi.create("idb-get",{originalErrorMessage:e?.message});qr.warn(t.message)}}}async function Mw(n,e){try{const i=(await vj()).transaction(Bu,"readwrite");await i.objectStore(Bu).put(e,wj(n)),await i.done}catch(t){if(t instanceof za)qr.warn(t.message);else{const i=Oi.create("idb-set",{originalErrorMessage:t?.message});qr.warn(i.message)}}}function wj(n){return`${n.name}!${n.options.appId}`}const Tk=1024,Ak=30;class kk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Rk(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Ow();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>Ak){const o=Ik(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){qr.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ow(),{heartbeatsToSend:t,unsentEntries:i}=Ck(this._heartbeatsCache.heartbeats),o=pf(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return qr.warn(e),""}}}function Ow(){return new Date().toISOString().substring(0,10)}function Ck(n,e=Tk){const t=[];let i=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),Pw(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Pw(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Rk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gA()?bA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Ek(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Mw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Mw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Pw(n){return pf(JSON.stringify({version:2,heartbeats:n})).length}function Ik(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function Dk(n){Ui(new $r("platform-logger",e=>new HA(e),"PRIVATE")),Ui(new $r("heartbeat",e=>new kk(e),"PRIVATE")),wa(W0,Iw,n),wa(W0,Iw,"esm2020"),wa("fire-js","")}Dk("");function Nj(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Mk=Nj,jj=new sd("auth","Firebase",Nj());const gf=new Lx("@firebase/auth");function Ok(n,...e){gf.logLevel<=Tt.WARN&&gf.warn(`Auth (${Ll}): ${n}`,...e)}function Xh(n,...e){gf.logLevel<=Tt.ERROR&&gf.error(`Auth (${Ll}): ${n}`,...e)}function Va(n,...e){throw Bx(n,...e)}function ta(n,...e){return Bx(n,...e)}function _j(n,e,t){const i={...Mk(),[e]:t};return new sd("auth","Firebase",i).create(e,{appName:n.name})}function rr(n){return _j(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Bx(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return jj.create(n,...e)}function Ve(n,e,...t){if(!n)throw Bx(e,...t)}function Pr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Xh(e),new Error(e)}function Hr(n,e){n||Pr(e)}function X0(){return typeof self<"u"&&self.location?.href||""}function Sj(){return Vw()==="http:"||Vw()==="https:"}function Vw(){return typeof self<"u"&&self.location?.protocol||null}function Pk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Sj()||fA()||"connection"in navigator)?navigator.onLine:!0}function Vk(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class ad{constructor(e,t){this.shortDelay=e,this.longDelay=t,Hr(t>e,"Short delay should be less than long delay!"),this.isMobile=uA()||mA()}get(){return Pk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function zx(n,e){Hr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Ej{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Lk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Uk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Bk=new ad(3e4,6e4);function Bn(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ja(n,e,t,i,o={}){return Tj(n,o,async()=>{let c={},d={};i&&(e==="GET"?d=i:c={body:JSON.stringify(i)});const m=ic({key:n.config.apiKey,...d}).slice(1),x=await n._getAdditionalHeaders();x["Content-Type"]="application/json",n.languageCode&&(x["X-Firebase-Locale"]=n.languageCode);const g={method:e,headers:x,...c};return hA()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&fr(n.emulatorConfig.host)&&(g.credentials="include"),Ej.fetch()(await Aj(n,n.config.apiHost,t,m),g)})}async function Tj(n,e,t){n._canInitEmulator=!1;const i={...Lk,...e};try{const o=new Fk(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw yu(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const m=c.ok?d.errorMessage:d.error.message,[x,g]=m.split(" : ");if(x==="FEDERATED_USER_ID_ALREADY_LINKED")throw yu(n,"credential-already-in-use",d);if(x==="EMAIL_EXISTS")throw yu(n,"email-already-in-use",d);if(x==="USER_DISABLED")throw yu(n,"user-disabled",d);const b=i[x]||x.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw _j(n,b,g);Va(n,b)}}catch(o){if(o instanceof za)throw o;Va(n,"network-request-failed",{message:String(o)})}}async function Gi(n,e,t,i,o={}){const c=await ja(n,e,t,i,o);return"mfaPendingCredential"in c&&Va(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function Aj(n,e,t,i){const o=`${e}${t}?${i}`,c=n,d=c.config.emulator?zx(n.config,o):`${n.config.apiScheme}://${o}`;return Uk.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function zk(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Fk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(ta(this.auth,"network-request-failed")),Bk.get())})}}function yu(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=ta(n,e,i);return o.customData._tokenResponse=t,o}function Lw(n){return n!==void 0&&n.getResponse!==void 0}function Uw(n){return n!==void 0&&n.enterprise!==void 0}class kj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return zk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function $k(n){return(await ja(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function Cj(n,e){return ja(n,"GET","/v2/recaptchaConfig",Bn(n,e))}async function qk(n,e){return ja(n,"POST","/v1/accounts:delete",e)}async function bf(n,e){return ja(n,"POST","/v1/accounts:lookup",e)}function Eu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Hk(n,e=!1){const t=Zt(n),i=await t.getIdToken(e),o=Fx(i);Ve(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:i,authTime:Eu(T0(o.auth_time)),issuedAtTime:Eu(T0(o.iat)),expirationTime:Eu(T0(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function T0(n){return Number(n)*1e3}function Fx(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Xh("JWT malformed, contained fewer than 3 sections"),null;try{const o=hj(t);return o?JSON.parse(o):(Xh("Failed to decode base64 JWT payload"),null)}catch(o){return Xh("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Bw(n){const e=Fx(n);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function zu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof za&&Gk(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Gk({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Yk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class J0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Eu(this.lastLoginAt),this.creationTime=Eu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function yf(n){const e=n.auth,t=await n.getIdToken(),i=await zu(n,bf(e,{idToken:t}));Ve(i?.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const c=o.providerUserInfo?.length?Rj(o.providerUserInfo):[],d=Kk(n.providerData,c),m=n.isAnonymous,x=!(n.email&&o.passwordHash)&&!d?.length,g=m?x:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new J0(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(n,b)}async function Wk(n){const e=Zt(n);await yf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Kk(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function Rj(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function Qk(n,e){const t=await Tj(n,{},async()=>{const i=ic({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await Aj(n,o,"/v1/token",`key=${c}`),m=await n._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const x={method:"POST",headers:m,body:i};return n.emulatorConfig&&fr(n.emulatorConfig.host)&&(x.credentials="include"),Ej.fetch()(d,x)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Xk(n,e){return ja(n,"POST","/v2/accounts:revokeToken",Bn(n,e))}class Mo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Bw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ve(e.length!==0,"internal-error");const t=Bw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:c}=await Qk(e,t);this.updateTokensAndExpiration(i,o,Number(c))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:c}=t,d=new Mo;return i&&(Ve(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),o&&(Ve(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(Ve(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Mo,this.toJSON())}_performRefresh(){return Pr("not implemented")}}function Ti(n,e){Ve(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Da{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new Yk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new J0(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await zu(this,this.stsTokenManager.getToken(this.auth,e));return Ve(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Hk(this,e)}reload(){return Wk(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Da({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await yf(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(jn(this.auth.app))return Promise.reject(rr(this.auth));const e=await this.getIdToken();return await zu(this,qk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,c=t.phoneNumber??void 0,d=t.photoURL??void 0,m=t.tenantId??void 0,x=t._redirectEventId??void 0,g=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:v,emailVerified:_,isAnonymous:R,providerData:B,stsTokenManager:L}=t;Ve(v&&L,e,"internal-error");const O=Mo.fromJSON(this.name,L);Ve(typeof v=="string",e,"internal-error"),Ti(i,e.name),Ti(o,e.name),Ve(typeof _=="boolean",e,"internal-error"),Ve(typeof R=="boolean",e,"internal-error"),Ti(c,e.name),Ti(d,e.name),Ti(m,e.name),Ti(x,e.name),Ti(g,e.name),Ti(b,e.name);const z=new Da({uid:v,auth:e,email:o,emailVerified:_,displayName:i,isAnonymous:R,photoURL:d,phoneNumber:c,tenantId:m,stsTokenManager:O,createdAt:g,lastLoginAt:b});return B&&Array.isArray(B)&&(z.providerData=B.map(G=>({...G}))),x&&(z._redirectEventId=x),z}static async _fromIdTokenResponse(e,t,i=!1){const o=new Mo;o.updateFromServerResponse(t);const c=new Da({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await yf(c),c}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];Ve(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?Rj(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,m=new Mo;m.updateFromIdToken(i);const x=new Da({uid:o.localId,auth:e,stsTokenManager:m,isAnonymous:d}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new J0(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(x,g),x}}const zw=new Map;function Vr(n){Hr(n instanceof Function,"Expected a class definition");let e=zw.get(n);return e?(Hr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,zw.set(n,e),e)}class Ij{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ij.type="NONE";const Fw=Ij;function Jh(n,e,t){return`firebase:${n}:${e}:${t}`}class Oo{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:c}=this.auth;this.fullUserKey=Jh(this.userKey,o.apiKey,c),this.fullPersistenceKey=Jh("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await bf(this.auth,{idToken:e}).catch(()=>{});return t?Da._fromGetAccountInfoResponse(this.auth,t,e):null}return Da._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Oo(Vr(Fw),e,i);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||Vr(Fw);const d=Jh(i,e.config.apiKey,e.name);let m=null;for(const g of t)try{const b=await g._get(d);if(b){let v;if(typeof b=="string"){const _=await bf(e,{idToken:b}).catch(()=>{});if(!_)break;v=await Da._fromGetAccountInfoResponse(e,_,b)}else v=Da._fromJSON(e,b);g!==c&&(m=v),c=g;break}}catch{}const x=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!x.length?new Oo(c,e,i):(c=x[0],m&&await c._set(d,m.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(d)}catch{}})),new Oo(c,e,i))}}function $w(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Pj(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Dj(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Lj(e))return"Blackberry";if(Uj(e))return"Webos";if(Mj(e))return"Safari";if((e.includes("chrome/")||Oj(e))&&!e.includes("edge/"))return"Chrome";if(Vj(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Dj(n=gn()){return/firefox\//i.test(n)}function Mj(n=gn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Oj(n=gn()){return/crios\//i.test(n)}function Pj(n=gn()){return/iemobile/i.test(n)}function Vj(n=gn()){return/android/i.test(n)}function Lj(n=gn()){return/blackberry/i.test(n)}function Uj(n=gn()){return/webos/i.test(n)}function $x(n=gn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Jk(n=gn()){return $x(n)&&!!window.navigator?.standalone}function Zk(){return pA()&&document.documentMode===10}function Bj(n=gn()){return $x(n)||Vj(n)||Uj(n)||Lj(n)||/windows phone/i.test(n)||Pj(n)}function zj(n,e=[]){let t;switch(n){case"Browser":t=$w(gn());break;case"Worker":t=`${$w(gn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ll}/${i}`}class eC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=c=>new Promise((d,m)=>{try{const x=e(c);d(x)}catch(x){m(x)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function tC(n,e={}){return ja(n,"GET","/v2/passwordPolicy",Bn(n,e))}const sC=6;class nC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??sC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}class aC{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qw(this),this.idTokenSubscription=new qw(this),this.beforeStateQueue=new eC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jj,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Oo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await bf(this,{idToken:e}),i=await Da._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(jn(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=this.redirectUser?._redirectEventId,d=i?._redirectEventId,m=await this.tryRedirectSignIn(e);(!c||c===d)&&m?.user&&(i=m.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await yf(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Vk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(jn(this.app))return Promise.reject(rr(this));const t=e?Zt(e):null;return t&&Ve(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return jn(this.app)?Promise.reject(rr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return jn(this.app)?Promise.reject(rr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await tC(this),t=new nC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new sd("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await Xk(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vr(e)||this._popupRedirectResolver;Ve(t,this,"argument-error"),this.redirectPersistenceManager=await Oo.create(this,[Vr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(m,this,"internal-error"),m.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const x=e.addObserver(t,i,o);return()=>{d=!0,x()}}else{const x=e.addObserver(t);return()=>{d=!0,x()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zj(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(jn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Ok(`Error while retrieving App Check token: ${e.error}`),e?.token}}function mr(n){return Zt(n)}class qw{constructor(e){this.auth=e,this.observer=null,this.addObserver=jA(t=>this.observer=t)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let rd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rC(n){rd=n}function qx(n){return rd.loadJS(n)}function iC(){return rd.recaptchaV2Script}function lC(){return rd.recaptchaEnterpriseScript}function oC(){return rd.gapiScript}function Fj(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const cC=500,uC=6e4,Oh=1e12;class dC{constructor(e){this.auth=e,this.counter=Oh,this._widgets=new Map}render(e,t){const i=this.counter;return this._widgets.set(i,new mC(e,this.auth.name,t||{})),this.counter++,i}reset(e){const t=e||Oh;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||Oh;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||Oh;return this._widgets.get(t)?.execute(),""}}class hC{constructor(){this.enterprise=new fC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class fC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class mC{constructor(e,t,i){this.params=i,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const o=typeof e=="string"?document.getElementById(e):e;Ve(o,"argument-error",{appName:t}),this.container=o,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=pC(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},uC)},cC))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function pC(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<n;i++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const xC="recaptcha-enterprise",Tu="NO_RECAPTCHA";class $j{constructor(e){this.type=xC,this.auth=mr(e)}async verify(e="verify",t=!1){async function i(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,m)=>{Cj(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(x=>{if(x.recaptchaKey===void 0)m(new Error("recaptcha Enterprise site key undefined"));else{const g=new kj(x);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,d(g.siteKey)}}).catch(x=>{m(x)})})}function o(c,d,m){const x=window.grecaptcha;Uw(x)?x.enterprise.ready(()=>{x.enterprise.execute(c,{action:e}).then(g=>{d(g)}).catch(()=>{d(Tu)})}):m(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new hC().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{i(this.auth).then(m=>{if(!t&&Uw(window.grecaptcha))o(m,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let x=lC();x.length!==0&&(x+=m),qx(x).then(()=>{o(m,c,d)}).catch(g=>{d(g)})}}).catch(m=>{d(m)})})}}async function cu(n,e,t,i=!1,o=!1){const c=new $j(n);let d;if(o)d=Tu;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const m={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in m){const x=m.phoneEnrollmentInfo.phoneNumber,g=m.phoneEnrollmentInfo.recaptchaToken;Object.assign(m,{phoneEnrollmentInfo:{phoneNumber:x,recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in m){const x=m.phoneSignInInfo.recaptchaToken;Object.assign(m,{phoneSignInInfo:{recaptchaToken:x,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return m}return i?Object.assign(m,{captchaResp:d}):Object.assign(m,{captchaResponse:d}),Object.assign(m,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(m,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),m}async function Po(n,e,t,i,o){if(o==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await cu(n,e,t,t==="getOobCode");return i(n,c)}else return i(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await cu(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(c)});else if(o==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const c=await cu(n,e,t);return i(n,c).catch(async d=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(d.code==="auth/missing-recaptcha-token"||d.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const m=await cu(n,e,t,!1,!0);return i(n,m)}return Promise.reject(d)})}else{const c=await cu(n,e,t,!1,!0);return i(n,c)}else return Promise.reject(o+" provider is not supported.")}async function gC(n){const e=mr(n),t=await Cj(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new kj(t);e.tenantId==null?e._agentRecaptchaConfig=i:e._tenantRecaptchaConfigs[e.tenantId]=i,i.isAnyProviderEnabled()&&new $j(e).verify()}function bC(n,e){const t=nd(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Rl(c,e??{}))return o;Va(o,"already-initialized")}return t.initialize({options:e})}function yC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Vr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function vC(n,e,t){const i=mr(n);Ve(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,c=qj(e),{host:d,port:m}=wC(e),x=m===null?"":`:${m}`,g={url:`${c}//${d}${x}/`},b=Object.freeze({host:d,port:m,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){Ve(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ve(Rl(g,i.config.emulator)&&Rl(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,fr(d)?(Hf(`${c}//${d}${x}`),Gf("Auth",!0)):NC()}function qj(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function wC(n){const e=qj(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const c=o[1];return{host:c,port:Hw(i.substr(c.length+1))}}else{const[c,d]=i.split(":");return{host:c,port:Hw(d)}}}function Hw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function NC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Wf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Pr("not implemented")}_getIdTokenResponse(e){return Pr("not implemented")}_linkToIdToken(e,t){return Pr("not implemented")}_getReauthenticationResolver(e){return Pr("not implemented")}}async function jC(n,e){return ja(n,"POST","/v1/accounts:signUp",e)}async function _C(n,e){return Gi(n,"POST","/v1/accounts:signInWithPassword",Bn(n,e))}async function SC(n,e){return Gi(n,"POST","/v1/accounts:signInWithEmailLink",Bn(n,e))}async function EC(n,e){return Gi(n,"POST","/v1/accounts:signInWithEmailLink",Bn(n,e))}class Fu extends Wf{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Fu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Fu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Po(e,t,"signInWithPassword",_C,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return SC(e,{email:this._email,oobCode:this._password});default:Va(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Po(e,i,"signUpPassword",jC,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return EC(e,{idToken:t,email:this._email,oobCode:this._password});default:Va(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Vo(n,e){return Gi(n,"POST","/v1/accounts:signInWithIdp",Bn(n,e))}const TC="http://localhost";class Il extends Wf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Il(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Va("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...c}=t;if(!i||!o)return null;const d=new Il(i,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Vo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Vo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Vo(e,t)}buildRequest(){const e={requestUri:TC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ic(t)}return e}}async function Gw(n,e){return ja(n,"POST","/v1/accounts:sendVerificationCode",Bn(n,e))}async function AC(n,e){return Gi(n,"POST","/v1/accounts:signInWithPhoneNumber",Bn(n,e))}async function kC(n,e){const t=await Gi(n,"POST","/v1/accounts:signInWithPhoneNumber",Bn(n,e));if(t.temporaryProof)throw yu(n,"account-exists-with-different-credential",t);return t}const CC={USER_NOT_FOUND:"user-not-found"};async function RC(n,e){const t={...e,operation:"REAUTH"};return Gi(n,"POST","/v1/accounts:signInWithPhoneNumber",Bn(n,t),CC)}class Au extends Wf{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Au({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Au({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return AC(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return kC(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return RC(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:i,verificationCode:o}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:i,code:o}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:i,phoneNumber:o,temporaryProof:c}=e;return!i&&!t&&!o&&!c?null:new Au({verificationId:t,verificationCode:i,phoneNumber:o,temporaryProof:c})}}function IC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DC(n){const e=gu(bu(n)).link,t=e?gu(bu(e)).deep_link_id:null,i=gu(bu(n)).deep_link_id;return(i?gu(bu(i)).link:null)||i||t||e||n}class Hx{constructor(e){const t=gu(bu(e)),i=t.apiKey??null,o=t.oobCode??null,c=IC(t.mode??null);Ve(i&&o&&c,"argument-error"),this.apiKey=i,this.operation=c,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=DC(e);try{return new Hx(t)}catch{return null}}}class lc{constructor(){this.providerId=lc.PROVIDER_ID}static credential(e,t){return Fu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Hx.parseLink(t);return Ve(i,"argument-error"),Fu._fromEmailAndCode(e,i.code,i.tenantId)}}lc.PROVIDER_ID="password";lc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";lc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Hj{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class id extends Hj{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ai extends id{constructor(){super("facebook.com")}static credential(e){return Il._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ai.credential(e.oauthAccessToken)}catch{return null}}}Ai.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ai.PROVIDER_ID="facebook.com";class ki extends id{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Il._fromParams({providerId:ki.PROVIDER_ID,signInMethod:ki.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ki.credentialFromTaggedObject(e)}static credentialFromError(e){return ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ki.credential(t,i)}catch{return null}}}ki.GOOGLE_SIGN_IN_METHOD="google.com";ki.PROVIDER_ID="google.com";class Ci extends id{constructor(){super("github.com")}static credential(e){return Il._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ci.credential(e.oauthAccessToken)}catch{return null}}}Ci.GITHUB_SIGN_IN_METHOD="github.com";Ci.PROVIDER_ID="github.com";class Ri extends id{constructor(){super("twitter.com")}static credential(e,t){return Il._fromParams({providerId:Ri.PROVIDER_ID,signInMethod:Ri.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ri.credentialFromTaggedObject(e)}static credentialFromError(e){return Ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ri.credential(t,i)}catch{return null}}}Ri.TWITTER_SIGN_IN_METHOD="twitter.com";Ri.PROVIDER_ID="twitter.com";async function MC(n,e){return Gi(n,"POST","/v1/accounts:signUp",Bn(n,e))}class Dl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const c=await Da._fromIdTokenResponse(e,i,o),d=Yw(i);return new Dl({user:c,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=Yw(i);return new Dl({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function Yw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class vf extends za{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,vf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new vf(e,t,i,o)}}function Gj(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?vf._fromErrorAndOperation(n,c,e,i):c})}async function OC(n,e,t=!1){const i=await zu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Dl._forOperation(n,"link",i)}async function PC(n,e,t=!1){const{auth:i}=n;if(jn(i.app))return Promise.reject(rr(i));const o="reauthenticate";try{const c=await zu(n,Gj(i,o,e,n),t);Ve(c.idToken,i,"internal-error");const d=Fx(c.idToken);Ve(d,i,"internal-error");const{sub:m}=d;return Ve(n.uid===m,i,"user-mismatch"),Dl._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&Va(i,"user-mismatch"),c}}async function Yj(n,e,t=!1){if(jn(n.app))return Promise.reject(rr(n));const i="signIn",o=await Gj(n,i,e),c=await Dl._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(c.user),c}async function Wj(n,e){return Yj(mr(n),e)}async function Kj(n){const e=mr(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function VC(n,e,t){if(jn(n.app))return Promise.reject(rr(n));const i=mr(n),d=await Po(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",MC,"EMAIL_PASSWORD_PROVIDER").catch(x=>{throw x.code==="auth/password-does-not-meet-requirements"&&Kj(n),x}),m=await Dl._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(m.user),m}function Gx(n,e,t){return jn(n.app)?Promise.reject(rr(n)):Wj(Zt(n),lc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Kj(n),i})}function LC(n,e,t,i){return Zt(n).onIdTokenChanged(e,t,i)}function UC(n,e,t){return Zt(n).beforeAuthStateChanged(e,t)}function Qj(n,e,t,i){return Zt(n).onAuthStateChanged(e,t,i)}function $u(n){return Zt(n).signOut()}function Ww(n,e){return ja(n,"POST","/v2/accounts/mfaEnrollment:start",Bn(n,e))}const wf="__sak";class Xj{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(wf,"1"),this.storage.removeItem(wf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const BC=1e3,zC=10;class Jj extends Xj{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Bj(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,m,x)=>{this.notifyListeners(d,x)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},c=this.storage.getItem(i);Zk()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,zC):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},BC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Jj.type="LOCAL";const FC=Jj;class Zj extends Xj{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Zj.type="SESSION";const e2=Zj;function $C(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Kf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Kf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const m=Array.from(d).map(async g=>g(t.origin,c)),x=await $C(m);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:x})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Kf.receivers=[];function Yx(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class qC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((m,x)=>{const g=Yx("",20);o.port1.start();const b=setTimeout(()=>{x(new Error("unsupported_event"))},i);d={messageChannel:o,onMessage(v){const _=v;if(_.data.eventId===g)switch(_.data.status){case"ack":clearTimeout(b),c=setTimeout(()=>{x(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),m(_.data.response);break;default:clearTimeout(b),clearTimeout(c),x(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function qs(){return window}function HC(n){qs().location.href=n}function Wx(){return typeof qs().WorkerGlobalScope<"u"&&typeof qs().importScripts=="function"}async function GC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function YC(){return navigator?.serviceWorker?.controller||null}function WC(){return Wx()?self:null}const t2="firebaseLocalStorageDb",KC=1,Nf="firebaseLocalStorage",s2="fbase_key";class ld{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Qf(n,e){return n.transaction([Nf],e?"readwrite":"readonly").objectStore(Nf)}function QC(){const n=indexedDB.deleteDatabase(t2);return new ld(n).toPromise()}function Z0(){const n=indexedDB.open(t2,KC);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Nf,{keyPath:s2})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Nf)?e(i):(i.close(),await QC(),e(await Z0()))})})}async function Kw(n,e,t){const i=Qf(n,!0).put({[s2]:e,value:t});return new ld(i).toPromise()}async function XC(n,e){const t=Qf(n,!1).get(e),i=await new ld(t).toPromise();return i===void 0?null:i.value}function Qw(n,e){const t=Qf(n,!0).delete(e);return new ld(t).toPromise()}const JC=800,ZC=3;class n2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Z0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>ZC)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Wx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Kf._getInstance(WC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await GC(),!this.activeServiceWorker)return;this.sender=new qC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||YC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Z0();return await Kw(e,wf,"1"),await Qw(e,wf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Kw(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>XC(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Qw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Qf(o,!1).getAll();return new ld(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),JC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}n2.type="LOCAL";const e4=n2;function Xw(n,e){return ja(n,"POST","/v2/accounts/mfaSignIn:start",Bn(n,e))}const A0=Fj("rcb"),t4=new ad(3e4,6e4);class s4{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!qs().grecaptcha?.render}load(e,t=""){return Ve(n4(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Lw(qs().grecaptcha)?Promise.resolve(qs().grecaptcha):new Promise((i,o)=>{const c=qs().setTimeout(()=>{o(ta(e,"network-request-failed"))},t4.get());qs()[A0]=()=>{qs().clearTimeout(c),delete qs()[A0];const m=qs().grecaptcha;if(!m||!Lw(m)){o(ta(e,"internal-error"));return}const x=m.render;m.render=(g,b)=>{const v=x(g,b);return this.counter++,v},this.hostLanguage=t,i(m)};const d=`${iC()}?${ic({onload:A0,render:"explicit",hl:t})}`;qx(d).catch(()=>{clearTimeout(c),o(ta(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!qs().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function n4(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class a4{async load(e){return new dC(e)}clearedOneInstance(){}}const ku="recaptcha",r4={theme:"light",type:"image"};class Jw{constructor(e,t,i={...r4}){this.parameters=i,this.type=ku,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=mr(e),this.isInvisible=this.parameters.size==="invisible",Ve(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const o=typeof t=="string"?document.getElementById(t):t;Ve(o,this.auth,"argument-error"),this.container=o,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new a4:new s4,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),i=t.getResponse(e);return i||new Promise(o=>{const c=d=>{d&&(this.tokenChangeListeners.delete(c),o(d))};this.tokenChangeListeners.add(c),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Ve(!this.parameters.sitekey,this.auth,"argument-error"),Ve(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ve(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(i=>i(t)),typeof e=="function")e(t);else if(typeof e=="string"){const i=qs()[e];typeof i=="function"&&i(t)}}}assertNotDestroyed(){Ve(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Ve(Sj()&&!Wx(),this.auth,"internal-error"),await i4(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await $k(this.auth);Ve(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Ve(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function i4(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}class l4{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Au._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function o4(n,e,t){if(jn(n.app))return Promise.reject(rr(n));const i=mr(n),o=await c4(i,e,Zt(t));return new l4(o,c=>Wj(i,c))}async function c4(n,e,t){if(!n._getRecaptchaConfig())try{await gC(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i){Ve(o.type==="enroll",n,"internal-error");const c={idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Po(n,c,"mfaSmsEnrollment",async(g,b)=>{if(b.phoneEnrollmentInfo.captchaResponse===Tu){Ve(t?.type===ku,g,"argument-error");const v=await k0(g,b,t);return Ww(g,v)}return Ww(g,b)},"PHONE_PROVIDER").catch(g=>Promise.reject(g))).phoneSessionInfo.sessionInfo}else{Ve(o.type==="signin",n,"internal-error");const c=i.multiFactorHint?.uid||i.multiFactorUid;Ve(c,n,"missing-multi-factor-info");const d={mfaPendingCredential:o.credential,mfaEnrollmentId:c,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Po(n,d,"mfaSmsSignIn",async(b,v)=>{if(v.phoneSignInInfo.captchaResponse===Tu){Ve(t?.type===ku,b,"argument-error");const _=await k0(b,v,t);return Xw(b,_)}return Xw(b,v)},"PHONE_PROVIDER").catch(b=>Promise.reject(b))).phoneResponseInfo.sessionInfo}}else{const o={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Po(n,o,"sendVerificationCode",async(x,g)=>{if(g.captchaResponse===Tu){Ve(t?.type===ku,x,"argument-error");const b=await k0(x,g,t);return Gw(x,b)}return Gw(x,g)},"PHONE_PROVIDER").catch(x=>Promise.reject(x))).sessionInfo}}finally{t?._reset()}}async function k0(n,e,t){Ve(t.type===ku,n,"argument-error");const i=await t.verify();Ve(typeof i=="string",n,"argument-error");const o={...e};if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,d=o.phoneEnrollmentInfo.captchaResponse,m=o.phoneEnrollmentInfo.clientType,x=o.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:i,captchaResponse:d,clientType:m,recaptchaVersion:x}}),o}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.captchaResponse,d=o.phoneSignInInfo.clientType,m=o.phoneSignInInfo.recaptchaVersion;return Object.assign(o,{phoneSignInInfo:{recaptchaToken:i,captchaResponse:c,clientType:d,recaptchaVersion:m}}),o}else return Object.assign(o,{recaptchaToken:i}),o}function u4(n,e){return e?Vr(e):(Ve(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Kx extends Wf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Vo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Vo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function d4(n){return Yj(n.auth,new Kx(n),n.bypassAuthState)}function h4(n){const{auth:e,user:t}=n;return Ve(t,e,"internal-error"),PC(t,new Kx(n),n.bypassAuthState)}async function f4(n){const{auth:e,user:t}=n;return Ve(t,e,"internal-error"),OC(t,new Kx(n),n.bypassAuthState)}class a2{constructor(e,t,i,o,c=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:c,error:d,type:m}=e;if(d){this.reject(d);return}const x={auth:this.auth,requestUri:t,sessionId:i,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(x))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return d4;case"linkViaPopup":case"linkViaRedirect":return f4;case"reauthViaPopup":case"reauthViaRedirect":return h4;default:Va(this.auth,"internal-error")}}resolve(e){Hr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Hr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const m4=new ad(2e3,1e4);class Io extends a2{constructor(e,t,i,o,c){super(e,t,o,c),this.provider=i,this.authWindow=null,this.pollId=null,Io.currentPopupAction&&Io.currentPopupAction.cancel(),Io.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ve(e,this.auth,"internal-error"),e}async onExecution(){Hr(this.filter.length===1,"Popup operations only handle one event");const e=Yx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ta(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ta(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Io.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ta(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,m4.get())};e()}}Io.currentPopupAction=null;const p4="pendingRedirect",Zh=new Map;class x4 extends a2{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Zh.get(this.auth._key());if(!e){try{const i=await g4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Zh.set(this.auth._key(),e)}return this.bypassAuthState||Zh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function g4(n,e){const t=v4(e),i=y4(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function b4(n,e){Zh.set(n._key(),e)}function y4(n){return Vr(n._redirectPersistence)}function v4(n){return Jh(p4,n.config.apiKey,n.name)}async function w4(n,e,t=!1){if(jn(n.app))return Promise.reject(rr(n));const i=mr(n),o=u4(i,e),d=await new x4(i,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const N4=600*1e3;class j4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!r2(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ta(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=N4&&this.cachedEventUids.clear(),this.cachedEventUids.has(Zw(e))}saveEventToCache(e){this.cachedEventUids.add(Zw(e)),this.lastProcessedEventTime=Date.now()}}function Zw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function r2({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function _4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return r2(n);default:return!1}}async function S4(n,e={}){return ja(n,"GET","/v1/projects",e)}const E4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,T4=/^https?/;async function A4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await S4(n);for(const t of e)try{if(k4(t))return}catch{}Va(n,"unauthorized-domain")}function k4(n){const e=X0(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!T4.test(t))return!1;if(E4.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}const C4=new ad(3e4,6e4);function eN(){const n=qs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function R4(n){return new Promise((e,t)=>{function i(){eN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{eN(),t(ta(n,"network-request-failed"))},timeout:C4.get()})}if(qs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(qs().gapi?.load)i();else{const o=Fj("iframefcb");return qs()[o]=()=>{gapi.load?i():t(ta(n,"network-request-failed"))},qx(`${oC()}?onload=${o}`).catch(c=>t(c))}}).catch(e=>{throw ef=null,e})}let ef=null;function I4(n){return ef=ef||R4(n),ef}const D4=new ad(5e3,15e3),M4="__/auth/iframe",O4="emulator/auth/iframe",P4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},V4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function L4(n){const e=n.config;Ve(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?zx(e,O4):`https://${n.config.authDomain}/${M4}`,i={apiKey:e.apiKey,appName:n.name,v:Ll},o=V4.get(n.config.apiHost);o&&(i.eid=o);const c=n._getFrameworks();return c.length&&(i.fw=c.join(",")),`${t}?${ic(i).slice(1)}`}async function U4(n){const e=await I4(n),t=qs().gapi;return Ve(t,n,"internal-error"),e.open({where:document.body,url:L4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:P4,dontclear:!0},i=>new Promise(async(o,c)=>{await i.restyle({setHideOnLeave:!1});const d=ta(n,"network-request-failed"),m=qs().setTimeout(()=>{c(d)},D4.get());function x(){qs().clearTimeout(m),o(i)}i.ping(x).then(x,()=>{c(d)})}))}const B4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},z4=500,F4=600,$4="_blank",q4="http://localhost";class tN{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function H4(n,e,t,i=z4,o=F4){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let m="";const x={...B4,width:i.toString(),height:o.toString(),top:c,left:d},g=gn().toLowerCase();t&&(m=Oj(g)?$4:t),Dj(g)&&(e=e||q4,x.scrollbars="yes");const b=Object.entries(x).reduce((_,[R,B])=>`${_}${R}=${B},`,"");if(Jk(g)&&m!=="_self")return G4(e||"",m),new tN(null);const v=window.open(e||"",m,b);Ve(v,n,"popup-blocked");try{v.focus()}catch{}return new tN(v)}function G4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const Y4="__/auth/handler",W4="emulator/auth/handler",K4=encodeURIComponent("fac");async function sN(n,e,t,i,o,c){Ve(n.config.authDomain,n,"auth-domain-config-required"),Ve(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ll,eventId:o};if(e instanceof Hj){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",NA(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,v]of Object.entries({}))d[b]=v}if(e instanceof id){const b=e.getScopes().filter(v=>v!=="");b.length>0&&(d.scopes=b.join(","))}n.tenantId&&(d.tid=n.tenantId);const m=d;for(const b of Object.keys(m))m[b]===void 0&&delete m[b];const x=await n._getAppCheckToken(),g=x?`#${K4}=${encodeURIComponent(x)}`:"";return`${Q4(n)}?${ic(m).slice(1)}${g}`}function Q4({config:n}){return n.emulator?zx(n,W4):`https://${n.authDomain}/${Y4}`}const C0="webStorageSupport";class X4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=e2,this._completeRedirectFn=w4,this._overrideRedirectResult=b4}async _openPopup(e,t,i,o){Hr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const c=await sN(e,t,i,X0(),o);return H4(e,c,Yx())}async _openRedirect(e,t,i,o){await this._originValidation(e);const c=await sN(e,t,i,X0(),o);return HC(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Hr(c,"If manager is not set, promise should be"),c)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await U4(e),i=new j4(e);return t.register("authEvent",o=>(Ve(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(C0,{type:C0},o=>{const c=o?.[0]?.[C0];c!==void 0&&t(!!c),Va(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=A4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Bj()||Mj()||$x()}}const J4=X4;var nN="@firebase/auth",aN="1.12.0";class Z4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function eR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function tR(n){Ui(new $r("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:m}=i.options;Ve(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const x={apiKey:d,authDomain:m,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zj(n)},g=new aC(i,o,c,x);return yC(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ui(new $r("auth-internal",e=>{const t=mr(e.getProvider("auth").getImmediate());return(i=>new Z4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),wa(nN,aN,eR(n)),wa(nN,aN,"esm2020")}const sR=300,nR=pj("authIdTokenMaxAge")||sR;let rN=null;const aR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>nR)return;const o=t?.token;rN!==o&&(rN=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function rR(n=Yf()){const e=nd(n,"auth");if(e.isInitialized())return e.getImmediate();const t=bC(n,{popupRedirectResolver:J4,persistence:[e4,FC,e2]}),i=pj("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(i,location.origin);if(location.origin===c.origin){const d=aR(c.toString());UC(t,d,()=>d(t.currentUser)),LC(t,m=>d(m))}}const o=fj("auth");return o&&vC(t,`http://${o}`),t}function iR(){return document.getElementsByTagName("head")?.[0]??document}rC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const c=ta("internal-error");c.customData=o,t(c)},i.type="text/javascript",i.charset="UTF-8",iR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});tR("Browser");var iN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Pi,i2;(function(){var n;function e(T,E){function S(){}S.prototype=E.prototype,T.F=E.prototype,T.prototype=new S,T.prototype.constructor=T,T.D=function(k,C,P){for(var I=Array(arguments.length-2),$=2;$<arguments.length;$++)I[$-2]=arguments[$];return E.prototype[C].apply(k,I)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(T,E,S){S||(S=0);const k=Array(16);if(typeof E=="string")for(var C=0;C<16;++C)k[C]=E.charCodeAt(S++)|E.charCodeAt(S++)<<8|E.charCodeAt(S++)<<16|E.charCodeAt(S++)<<24;else for(C=0;C<16;++C)k[C]=E[S++]|E[S++]<<8|E[S++]<<16|E[S++]<<24;E=T.g[0],S=T.g[1],C=T.g[2];let P=T.g[3],I;I=E+(P^S&(C^P))+k[0]+3614090360&4294967295,E=S+(I<<7&4294967295|I>>>25),I=P+(C^E&(S^C))+k[1]+3905402710&4294967295,P=E+(I<<12&4294967295|I>>>20),I=C+(S^P&(E^S))+k[2]+606105819&4294967295,C=P+(I<<17&4294967295|I>>>15),I=S+(E^C&(P^E))+k[3]+3250441966&4294967295,S=C+(I<<22&4294967295|I>>>10),I=E+(P^S&(C^P))+k[4]+4118548399&4294967295,E=S+(I<<7&4294967295|I>>>25),I=P+(C^E&(S^C))+k[5]+1200080426&4294967295,P=E+(I<<12&4294967295|I>>>20),I=C+(S^P&(E^S))+k[6]+2821735955&4294967295,C=P+(I<<17&4294967295|I>>>15),I=S+(E^C&(P^E))+k[7]+4249261313&4294967295,S=C+(I<<22&4294967295|I>>>10),I=E+(P^S&(C^P))+k[8]+1770035416&4294967295,E=S+(I<<7&4294967295|I>>>25),I=P+(C^E&(S^C))+k[9]+2336552879&4294967295,P=E+(I<<12&4294967295|I>>>20),I=C+(S^P&(E^S))+k[10]+4294925233&4294967295,C=P+(I<<17&4294967295|I>>>15),I=S+(E^C&(P^E))+k[11]+2304563134&4294967295,S=C+(I<<22&4294967295|I>>>10),I=E+(P^S&(C^P))+k[12]+1804603682&4294967295,E=S+(I<<7&4294967295|I>>>25),I=P+(C^E&(S^C))+k[13]+4254626195&4294967295,P=E+(I<<12&4294967295|I>>>20),I=C+(S^P&(E^S))+k[14]+2792965006&4294967295,C=P+(I<<17&4294967295|I>>>15),I=S+(E^C&(P^E))+k[15]+1236535329&4294967295,S=C+(I<<22&4294967295|I>>>10),I=E+(C^P&(S^C))+k[1]+4129170786&4294967295,E=S+(I<<5&4294967295|I>>>27),I=P+(S^C&(E^S))+k[6]+3225465664&4294967295,P=E+(I<<9&4294967295|I>>>23),I=C+(E^S&(P^E))+k[11]+643717713&4294967295,C=P+(I<<14&4294967295|I>>>18),I=S+(P^E&(C^P))+k[0]+3921069994&4294967295,S=C+(I<<20&4294967295|I>>>12),I=E+(C^P&(S^C))+k[5]+3593408605&4294967295,E=S+(I<<5&4294967295|I>>>27),I=P+(S^C&(E^S))+k[10]+38016083&4294967295,P=E+(I<<9&4294967295|I>>>23),I=C+(E^S&(P^E))+k[15]+3634488961&4294967295,C=P+(I<<14&4294967295|I>>>18),I=S+(P^E&(C^P))+k[4]+3889429448&4294967295,S=C+(I<<20&4294967295|I>>>12),I=E+(C^P&(S^C))+k[9]+568446438&4294967295,E=S+(I<<5&4294967295|I>>>27),I=P+(S^C&(E^S))+k[14]+3275163606&4294967295,P=E+(I<<9&4294967295|I>>>23),I=C+(E^S&(P^E))+k[3]+4107603335&4294967295,C=P+(I<<14&4294967295|I>>>18),I=S+(P^E&(C^P))+k[8]+1163531501&4294967295,S=C+(I<<20&4294967295|I>>>12),I=E+(C^P&(S^C))+k[13]+2850285829&4294967295,E=S+(I<<5&4294967295|I>>>27),I=P+(S^C&(E^S))+k[2]+4243563512&4294967295,P=E+(I<<9&4294967295|I>>>23),I=C+(E^S&(P^E))+k[7]+1735328473&4294967295,C=P+(I<<14&4294967295|I>>>18),I=S+(P^E&(C^P))+k[12]+2368359562&4294967295,S=C+(I<<20&4294967295|I>>>12),I=E+(S^C^P)+k[5]+4294588738&4294967295,E=S+(I<<4&4294967295|I>>>28),I=P+(E^S^C)+k[8]+2272392833&4294967295,P=E+(I<<11&4294967295|I>>>21),I=C+(P^E^S)+k[11]+1839030562&4294967295,C=P+(I<<16&4294967295|I>>>16),I=S+(C^P^E)+k[14]+4259657740&4294967295,S=C+(I<<23&4294967295|I>>>9),I=E+(S^C^P)+k[1]+2763975236&4294967295,E=S+(I<<4&4294967295|I>>>28),I=P+(E^S^C)+k[4]+1272893353&4294967295,P=E+(I<<11&4294967295|I>>>21),I=C+(P^E^S)+k[7]+4139469664&4294967295,C=P+(I<<16&4294967295|I>>>16),I=S+(C^P^E)+k[10]+3200236656&4294967295,S=C+(I<<23&4294967295|I>>>9),I=E+(S^C^P)+k[13]+681279174&4294967295,E=S+(I<<4&4294967295|I>>>28),I=P+(E^S^C)+k[0]+3936430074&4294967295,P=E+(I<<11&4294967295|I>>>21),I=C+(P^E^S)+k[3]+3572445317&4294967295,C=P+(I<<16&4294967295|I>>>16),I=S+(C^P^E)+k[6]+76029189&4294967295,S=C+(I<<23&4294967295|I>>>9),I=E+(S^C^P)+k[9]+3654602809&4294967295,E=S+(I<<4&4294967295|I>>>28),I=P+(E^S^C)+k[12]+3873151461&4294967295,P=E+(I<<11&4294967295|I>>>21),I=C+(P^E^S)+k[15]+530742520&4294967295,C=P+(I<<16&4294967295|I>>>16),I=S+(C^P^E)+k[2]+3299628645&4294967295,S=C+(I<<23&4294967295|I>>>9),I=E+(C^(S|~P))+k[0]+4096336452&4294967295,E=S+(I<<6&4294967295|I>>>26),I=P+(S^(E|~C))+k[7]+1126891415&4294967295,P=E+(I<<10&4294967295|I>>>22),I=C+(E^(P|~S))+k[14]+2878612391&4294967295,C=P+(I<<15&4294967295|I>>>17),I=S+(P^(C|~E))+k[5]+4237533241&4294967295,S=C+(I<<21&4294967295|I>>>11),I=E+(C^(S|~P))+k[12]+1700485571&4294967295,E=S+(I<<6&4294967295|I>>>26),I=P+(S^(E|~C))+k[3]+2399980690&4294967295,P=E+(I<<10&4294967295|I>>>22),I=C+(E^(P|~S))+k[10]+4293915773&4294967295,C=P+(I<<15&4294967295|I>>>17),I=S+(P^(C|~E))+k[1]+2240044497&4294967295,S=C+(I<<21&4294967295|I>>>11),I=E+(C^(S|~P))+k[8]+1873313359&4294967295,E=S+(I<<6&4294967295|I>>>26),I=P+(S^(E|~C))+k[15]+4264355552&4294967295,P=E+(I<<10&4294967295|I>>>22),I=C+(E^(P|~S))+k[6]+2734768916&4294967295,C=P+(I<<15&4294967295|I>>>17),I=S+(P^(C|~E))+k[13]+1309151649&4294967295,S=C+(I<<21&4294967295|I>>>11),I=E+(C^(S|~P))+k[4]+4149444226&4294967295,E=S+(I<<6&4294967295|I>>>26),I=P+(S^(E|~C))+k[11]+3174756917&4294967295,P=E+(I<<10&4294967295|I>>>22),I=C+(E^(P|~S))+k[2]+718787259&4294967295,C=P+(I<<15&4294967295|I>>>17),I=S+(P^(C|~E))+k[9]+3951481745&4294967295,T.g[0]=T.g[0]+E&4294967295,T.g[1]=T.g[1]+(C+(I<<21&4294967295|I>>>11))&4294967295,T.g[2]=T.g[2]+C&4294967295,T.g[3]=T.g[3]+P&4294967295}i.prototype.v=function(T,E){E===void 0&&(E=T.length);const S=E-this.blockSize,k=this.C;let C=this.h,P=0;for(;P<E;){if(C==0)for(;P<=S;)o(this,T,P),P+=this.blockSize;if(typeof T=="string"){for(;P<E;)if(k[C++]=T.charCodeAt(P++),C==this.blockSize){o(this,k),C=0;break}}else for(;P<E;)if(k[C++]=T[P++],C==this.blockSize){o(this,k),C=0;break}}this.h=C,this.o+=E},i.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var E=1;E<T.length-8;++E)T[E]=0;E=this.o*8;for(var S=T.length-8;S<T.length;++S)T[S]=E&255,E/=256;for(this.v(T),T=Array(16),E=0,S=0;S<4;++S)for(let k=0;k<32;k+=8)T[E++]=this.g[S]>>>k&255;return T};function c(T,E){var S=m;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=E(T)}function d(T,E){this.h=E;const S=[];let k=!0;for(let C=T.length-1;C>=0;C--){const P=T[C]|0;k&&P==E||(S[C]=P,k=!1)}this.g=S}var m={};function x(T){return-128<=T&&T<128?c(T,function(E){return new d([E|0],E<0?-1:0)}):new d([T|0],T<0?-1:0)}function g(T){if(isNaN(T)||!isFinite(T))return v;if(T<0)return O(g(-T));const E=[];let S=1;for(let k=0;T>=S;k++)E[k]=T/S|0,S*=4294967296;return new d(E,0)}function b(T,E){if(T.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(T.charAt(0)=="-")return O(b(T.substring(1),E));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=g(Math.pow(E,8));let k=v;for(let P=0;P<T.length;P+=8){var C=Math.min(8,T.length-P);const I=parseInt(T.substring(P,P+C),E);C<8?(C=g(Math.pow(E,C)),k=k.j(C).add(g(I))):(k=k.j(S),k=k.add(g(I)))}return k}var v=x(0),_=x(1),R=x(16777216);n=d.prototype,n.m=function(){if(L(this))return-O(this).m();let T=0,E=1;for(let S=0;S<this.g.length;S++){const k=this.i(S);T+=(k>=0?k:4294967296+k)*E,E*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(B(this))return"0";if(L(this))return"-"+O(this).toString(T);const E=g(Math.pow(T,6));var S=this;let k="";for(;;){const C=ae(S,E).g;S=z(S,C.j(E));let P=((S.g.length>0?S.g[0]:S.h)>>>0).toString(T);if(S=C,B(S))return P+k;for(;P.length<6;)P="0"+P;k=P+k}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function B(T){if(T.h!=0)return!1;for(let E=0;E<T.g.length;E++)if(T.g[E]!=0)return!1;return!0}function L(T){return T.h==-1}n.l=function(T){return T=z(this,T),L(T)?-1:B(T)?0:1};function O(T){const E=T.g.length,S=[];for(let k=0;k<E;k++)S[k]=~T.g[k];return new d(S,~T.h).add(_)}n.abs=function(){return L(this)?O(this):this},n.add=function(T){const E=Math.max(this.g.length,T.g.length),S=[];let k=0;for(let C=0;C<=E;C++){let P=k+(this.i(C)&65535)+(T.i(C)&65535),I=(P>>>16)+(this.i(C)>>>16)+(T.i(C)>>>16);k=I>>>16,P&=65535,I&=65535,S[C]=I<<16|P}return new d(S,S[S.length-1]&-2147483648?-1:0)};function z(T,E){return T.add(O(E))}n.j=function(T){if(B(this)||B(T))return v;if(L(this))return L(T)?O(this).j(O(T)):O(O(this).j(T));if(L(T))return O(this.j(O(T)));if(this.l(R)<0&&T.l(R)<0)return g(this.m()*T.m());const E=this.g.length+T.g.length,S=[];for(var k=0;k<2*E;k++)S[k]=0;for(k=0;k<this.g.length;k++)for(let C=0;C<T.g.length;C++){const P=this.i(k)>>>16,I=this.i(k)&65535,$=T.i(C)>>>16,U=T.i(C)&65535;S[2*k+2*C]+=I*U,G(S,2*k+2*C),S[2*k+2*C+1]+=P*U,G(S,2*k+2*C+1),S[2*k+2*C+1]+=I*$,G(S,2*k+2*C+1),S[2*k+2*C+2]+=P*$,G(S,2*k+2*C+2)}for(T=0;T<E;T++)S[T]=S[2*T+1]<<16|S[2*T];for(T=E;T<2*E;T++)S[T]=0;return new d(S,0)};function G(T,E){for(;(T[E]&65535)!=T[E];)T[E+1]+=T[E]>>>16,T[E]&=65535,E++}function H(T,E){this.g=T,this.h=E}function ae(T,E){if(B(E))throw Error("division by zero");if(B(T))return new H(v,v);if(L(T))return E=ae(O(T),E),new H(O(E.g),O(E.h));if(L(E))return E=ae(T,O(E)),new H(O(E.g),E.h);if(T.g.length>30){if(L(T)||L(E))throw Error("slowDivide_ only works with positive integers.");for(var S=_,k=E;k.l(T)<=0;)S=ue(S),k=ue(k);var C=Y(S,1),P=Y(k,1);for(k=Y(k,2),S=Y(S,2);!B(k);){var I=P.add(k);I.l(T)<=0&&(C=C.add(S),P=I),k=Y(k,1),S=Y(S,1)}return E=z(T,C.j(E)),new H(C,E)}for(C=v;T.l(E)>=0;){for(S=Math.max(1,Math.floor(T.m()/E.m())),k=Math.ceil(Math.log(S)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),P=g(S),I=P.j(E);L(I)||I.l(T)>0;)S-=k,P=g(S),I=P.j(E);B(P)&&(P=_),C=C.add(P),T=z(T,I)}return new H(C,T)}n.B=function(T){return ae(this,T).h},n.and=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let k=0;k<E;k++)S[k]=this.i(k)&T.i(k);return new d(S,this.h&T.h)},n.or=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let k=0;k<E;k++)S[k]=this.i(k)|T.i(k);return new d(S,this.h|T.h)},n.xor=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let k=0;k<E;k++)S[k]=this.i(k)^T.i(k);return new d(S,this.h^T.h)};function ue(T){const E=T.g.length+1,S=[];for(let k=0;k<E;k++)S[k]=T.i(k)<<1|T.i(k-1)>>>31;return new d(S,T.h)}function Y(T,E){const S=E>>5;E%=32;const k=T.g.length-S,C=[];for(let P=0;P<k;P++)C[P]=E>0?T.i(P+S)>>>E|T.i(P+S+1)<<32-E:T.i(P+S);return new d(C,T.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,i2=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=g,d.fromString=b,Pi=d}).apply(typeof iN<"u"?iN:typeof self<"u"?self:typeof window<"u"?window:{});var Ph=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var l2,vu,o2,tf,ex,c2,u2,d2;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ph=="object"&&Ph];for(var y=0;y<h.length;++y){var N=h[y];if(N&&N.Math==Math)return N}throw Error("Cannot find global object")}var i=t(this);function o(h,y){if(y)e:{var N=i;h=h.split(".");for(var M=0;M<h.length-1;M++){var te=h[M];if(!(te in N))break e;N=N[te]}h=h[h.length-1],M=N[h],y=y(M),y!=M&&y!=null&&e(N,h,{configurable:!0,writable:!0,value:y})}}o("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(h){return h||function(y){var N=[],M;for(M in y)Object.prototype.hasOwnProperty.call(y,M)&&N.push([M,y[M]]);return N}});var c=c||{},d=this||self;function m(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function x(h,y,N){return h.call.apply(h.bind,arguments)}function g(h,y,N){return g=x,g.apply(null,arguments)}function b(h,y){var N=Array.prototype.slice.call(arguments,1);return function(){var M=N.slice();return M.push.apply(M,arguments),h.apply(this,M)}}function v(h,y){function N(){}N.prototype=y.prototype,h.Z=y.prototype,h.prototype=new N,h.prototype.constructor=h,h.Ob=function(M,te,ie){for(var Te=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)Te[mt-2]=arguments[mt];return y.prototype[te].apply(M,Te)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function R(h){const y=h.length;if(y>0){const N=Array(y);for(let M=0;M<y;M++)N[M]=h[M];return N}return[]}function B(h,y){for(let M=1;M<arguments.length;M++){const te=arguments[M];var N=typeof te;if(N=N!="object"?N:te?Array.isArray(te)?"array":N:"null",N=="array"||N=="object"&&typeof te.length=="number"){N=h.length||0;const ie=te.length||0;h.length=N+ie;for(let Te=0;Te<ie;Te++)h[N+Te]=te[Te]}else h.push(te)}}class L{constructor(y,N){this.i=y,this.j=N,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function O(h){d.setTimeout(()=>{throw h},0)}function z(){var h=T;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class G{constructor(){this.h=this.g=null}add(y,N){const M=H.get();M.set(y,N),this.h?this.h.next=M:this.g=M,this.h=M}}var H=new L(()=>new ae,h=>h.reset());class ae{constructor(){this.next=this.g=this.h=null}set(y,N){this.h=y,this.g=N,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,Y=!1,T=new G,E=()=>{const h=Promise.resolve(void 0);ue=()=>{h.then(S)}};function S(){for(var h;h=z();){try{h.h.call(h.g)}catch(N){O(N)}var y=H;y.j(h),y.h<100&&(y.h++,h.next=y.g,y.g=h)}Y=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var P=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const N=()=>{};d.addEventListener("test",N,y),d.removeEventListener("test",N,y)}catch{}return h})();function I(h){return/^[\s\xa0]*$/.test(h)}function $(h,y){C.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,y)}v($,C),$.prototype.init=function(h,y){const N=this.type=h.type,M=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget,y||(N=="mouseover"?y=h.fromElement:N=="mouseout"&&(y=h.toElement)),this.relatedTarget=y,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&$.Z.h.call(this)},$.prototype.h=function(){$.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var U="closure_listenable_"+(Math.random()*1e6|0),V=0;function K(h,y,N,M,te){this.listener=h,this.proxy=null,this.src=y,this.type=N,this.capture=!!M,this.ha=te,this.key=++V,this.da=this.fa=!1}function oe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ee(h,y,N){for(const M in h)y.call(N,h[M],M,h)}function ye(h,y){for(const N in h)y.call(void 0,h[N],N,h)}function F(h){const y={};for(const N in h)y[N]=h[N];return y}const J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(h,y){let N,M;for(let te=1;te<arguments.length;te++){M=arguments[te];for(N in M)h[N]=M[N];for(let ie=0;ie<J.length;ie++)N=J[ie],Object.prototype.hasOwnProperty.call(M,N)&&(h[N]=M[N])}}function xe(h){this.src=h,this.g={},this.h=0}xe.prototype.add=function(h,y,N,M,te){const ie=h.toString();h=this.g[ie],h||(h=this.g[ie]=[],this.h++);const Te=Ce(h,y,M,te);return Te>-1?(y=h[Te],N||(y.fa=!1)):(y=new K(y,this.src,ie,!!M,te),y.fa=N,h.push(y)),y};function le(h,y){const N=y.type;if(N in h.g){var M=h.g[N],te=Array.prototype.indexOf.call(M,y,void 0),ie;(ie=te>=0)&&Array.prototype.splice.call(M,te,1),ie&&(oe(y),h.g[N].length==0&&(delete h.g[N],h.h--))}}function Ce(h,y,N,M){for(let te=0;te<h.length;++te){const ie=h[te];if(!ie.da&&ie.listener==y&&ie.capture==!!N&&ie.ha==M)return te}return-1}var $e="closure_lm_"+(Math.random()*1e6|0),Ct={};function ot(h,y,N,M,te){if(Array.isArray(y)){for(let ie=0;ie<y.length;ie++)ot(h,y[ie],N,M,te);return null}return N=Ot(N),h&&h[U]?h.J(y,N,m(M)?!!M.capture:!1,te):qt(h,y,N,!1,M,te)}function qt(h,y,N,M,te,ie){if(!y)throw Error("Invalid event type");const Te=m(te)?!!te.capture:!!te;let mt=gt(h);if(mt||(h[$e]=mt=new xe(h)),N=mt.add(y,N,M,Te,ie),N.proxy)return N;if(M=Z(),N.proxy=M,M.src=h,M.listener=N,h.addEventListener)P||(te=Te),te===void 0&&(te=!1),h.addEventListener(y.toString(),M,te);else if(h.attachEvent)h.attachEvent(qe(y.toString()),M);else if(h.addListener&&h.removeListener)h.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return N}function Z(){function h(N){return y.call(h.src,h.listener,N)}const y=tt;return h}function je(h,y,N,M,te){if(Array.isArray(y))for(var ie=0;ie<y.length;ie++)je(h,y[ie],N,M,te);else M=m(M)?!!M.capture:!!M,N=Ot(N),h&&h[U]?(h=h.i,ie=String(y).toString(),ie in h.g&&(y=h.g[ie],N=Ce(y,N,M,te),N>-1&&(oe(y[N]),Array.prototype.splice.call(y,N,1),y.length==0&&(delete h.g[ie],h.h--)))):h&&(h=gt(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Ce(y,N,M,te)),(N=h>-1?y[h]:null)&&Se(N))}function Se(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[U])le(y.i,h);else{var N=h.type,M=h.proxy;y.removeEventListener?y.removeEventListener(N,M,h.capture):y.detachEvent?y.detachEvent(qe(N),M):y.addListener&&y.removeListener&&y.removeListener(M),(N=gt(y))?(le(N,h),N.h==0&&(N.src=null,y[$e]=null)):oe(h)}}}function qe(h){return h in Ct?Ct[h]:Ct[h]="on"+h}function tt(h,y){if(h.da)h=!0;else{y=new $(y,this);const N=h.listener,M=h.ha||h.src;h.fa&&Se(h),h=N.call(M,y)}return h}function gt(h){return h=h[$e],h instanceof xe?h:null}var Ks="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ot(h){return typeof h=="function"?h:(h[Ks]||(h[Ks]=function(y){return h.handleEvent(y)}),h[Ks])}function bt(){k.call(this),this.i=new xe(this),this.M=this,this.G=null}v(bt,k),bt.prototype[U]=!0,bt.prototype.removeEventListener=function(h,y,N,M){je(this,h,y,N,M)};function Re(h,y){var N,M=h.G;if(M)for(N=[];M;M=M.G)N.push(M);if(h=h.M,M=y.type||y,typeof y=="string")y=new C(y,h);else if(y instanceof C)y.target=y.target||h;else{var te=y;y=new C(M,h),de(y,te)}te=!0;let ie,Te;if(N)for(Te=N.length-1;Te>=0;Te--)ie=y.g=N[Te],te=Be(ie,M,!0,y)&&te;if(ie=y.g=h,te=Be(ie,M,!0,y)&&te,te=Be(ie,M,!1,y)&&te,N)for(Te=0;Te<N.length;Te++)ie=y.g=N[Te],te=Be(ie,M,!1,y)&&te}bt.prototype.N=function(){if(bt.Z.N.call(this),this.i){var h=this.i;for(const y in h.g){const N=h.g[y];for(let M=0;M<N.length;M++)oe(N[M]);delete h.g[y],h.h--}}this.G=null},bt.prototype.J=function(h,y,N,M){return this.i.add(String(h),y,!1,N,M)},bt.prototype.K=function(h,y,N,M){return this.i.add(String(h),y,!0,N,M)};function Be(h,y,N,M){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();let te=!0;for(let ie=0;ie<y.length;++ie){const Te=y[ie];if(Te&&!Te.da&&Te.capture==N){const mt=Te.listener,Cs=Te.ha||Te.src;Te.fa&&le(h.i,Te),te=mt.call(Cs,M)!==!1&&te}}return te&&!M.defaultPrevented}function pe(h,y){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:d.setTimeout(h,y||0)}function We(h){h.g=pe(()=>{h.g=null,h.i&&(h.i=!1,We(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Le extends k{constructor(y,N){super(),this.m=y,this.l=N,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:We(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function De(h){k.call(this),this.h=h,this.g={}}v(De,k);var Ge=[];function He(h){Ee(h.g,function(y,N){this.g.hasOwnProperty(N)&&Se(y)},h),h.g={}}De.prototype.N=function(){De.Z.N.call(this),He(this)},De.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ee=d.JSON.stringify,ke=d.JSON.parse,nt=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function it(){}function Bt(){}var is={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function yt(){C.call(this,"d")}v(yt,C);function gs(){C.call(this,"c")}v(gs,C);var hs={},ws=null;function Ps(){return ws=ws||new bt}hs.Ia="serverreachability";function ra(h){C.call(this,hs.Ia,h)}v(ra,C);function Vs(h){const y=Ps();Re(y,new ra(y))}hs.STAT_EVENT="statevent";function _e(h,y){C.call(this,hs.STAT_EVENT,h),this.stat=y}v(_e,C);function Ie(h){const y=Ps();Re(y,new _e(y,h))}hs.Ja="timingevent";function ft(h,y){C.call(this,hs.Ja,h),this.size=y}v(ft,C);function vt(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},y)}function Rt(){this.g=!0}Rt.prototype.ua=function(){this.g=!1};function Qe(h,y,N,M,te,ie){h.info(function(){if(h.g)if(ie){var Te="",mt=ie.split("&");for(let Lt=0;Lt<mt.length;Lt++){var Cs=mt[Lt].split("=");if(Cs.length>1){const ms=Cs[0];Cs=Cs[1];const ua=ms.split("_");Te=ua.length>=2&&ua[1]=="type"?Te+(ms+"="+Cs+"&"):Te+(ms+"=redacted&")}}}else Te=null;else Te=ie;return"XMLHTTP REQ ("+M+") [attempt "+te+"]: "+y+`
`+N+`
`+Te})}function st(h,y,N,M,te,ie,Te){h.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+te+"]: "+y+`
`+N+`
`+ie+" "+Te})}function Mt(h,y,N,M){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+bn(h,N)+(M?" "+M:"")})}function Ns(h,y){h.info(function(){return"TIMEOUT: "+y})}Rt.prototype.info=function(){};function bn(h,y){if(!h.g)return y;if(!y)return null;try{const ie=JSON.parse(y);if(ie){for(h=0;h<ie.length;h++)if(Array.isArray(ie[h])){var N=ie[h];if(!(N.length<2)){var M=N[1];if(Array.isArray(M)&&!(M.length<1)){var te=M[0];if(te!="noop"&&te!="stop"&&te!="close")for(let Te=1;Te<M.length;Te++)M[Te]=""}}}}return ee(ie)}catch{return y}}var ls={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},$n={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},_a;function qn(){}v(qn,it),qn.prototype.g=function(){return new XMLHttpRequest},_a=new qn;function bs(h){return encodeURIComponent(String(h))}function Fa(h){var y=1;h=h.split(":");const N=[];for(;y>0&&h.length;)N.push(h.shift()),y--;return h.length&&N.push(h.join(":")),N}function js(h,y,N,M){this.j=h,this.i=y,this.l=N,this.S=M||1,this.V=new De(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Qs}function Qs(){this.i=null,this.g="",this.h=!1}var os={},D={};function Q(h,y,N){h.M=1,h.A=Ji(Ls(y)),h.u=N,h.R=!0,be(h,null)}function be(h,y){h.F=Date.now(),ut(h),h.B=Ls(h.A);var N=h.B,M=h.S;Array.isArray(M)||(M=[String(M)]),ql(N.i,"t",M),h.C=0,N=h.j.L,h.h=new Qs,h.g=Td(h.j,N?y:null,!h.u),h.P>0&&(h.O=new Le(g(h.Y,h,h.g),h.P)),y=h.V,N=h.g,M=h.ba;var te="readystatechange";Array.isArray(te)||(te&&(Ge[0]=te.toString()),te=Ge);for(let ie=0;ie<te.length;ie++){const Te=ot(N,te[ie],M||y.handleEvent,!1,y.h||y);if(!Te)break;y.g[Te.key]=Te}y=h.J?F(h.J):{},h.u?(h.v||(h.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,y)):(h.v="GET",h.g.ea(h.B,h.v,null,y)),Vs(),Qe(h.i,h.v,h.B,h.l,h.S,h.u)}js.prototype.ba=function(h){h=h.target;const y=this.O;y&&Ta(h)==3?y.j():this.Y(h)},js.prototype.Y=function(h){try{if(h==this.g)e:{const mt=Ta(this.g),Cs=this.g.ya(),Lt=this.g.ca();if(!(mt<3)&&(mt!=3||this.g&&(this.h.h||this.g.la()||tn(this.g)))){this.K||mt!=4||Cs==7||(Cs==8||Lt<=0?Vs(3):Vs(2)),wt(this);var y=this.g.ca();this.X=y;var N=he(this);if(this.o=y==200,st(this.i,this.v,this.B,this.l,this.S,mt,y),this.o){if(this.U&&!this.L){t:{if(this.g){var M,te=this.g;if((M=te.g?te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(M)){var ie=M;break t}}ie=null}if(h=ie)Mt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,_s(this,h);else{this.o=!1,this.m=3,Ie(12),cs(this),as(this);break e}}if(this.R){h=!0;let ms;for(;!this.K&&this.C<N.length;)if(ms=lt(this,N),ms==D){mt==4&&(this.m=4,Ie(14),h=!1),Mt(this.i,this.l,null,"[Incomplete Response]");break}else if(ms==os){this.m=4,Ie(15),Mt(this.i,this.l,N,"[Invalid Chunk]"),h=!1;break}else Mt(this.i,this.l,ms,null),_s(this,ms);if(ze(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||N.length!=0||this.h.h||(this.m=1,Ie(16),h=!1),this.o=this.o&&h,!h)Mt(this.i,this.l,N,"[Invalid Chunked Response]"),cs(this),as(this);else if(N.length>0&&!this.W){this.W=!0;var Te=this.j;Te.g==this&&Te.aa&&!Te.P&&(Te.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),jc(Te),Te.P=!0,Ie(11))}}else Mt(this.i,this.l,N,null),_s(this,N);mt==4&&cs(this),this.o&&!this.K&&(mt==4?jd(this.j,this):(this.o=!1,ut(this)))}else gr(this.g),y==400&&N.indexOf("Unknown SID")>0?(this.m=3,Ie(12)):(this.m=0,Ie(13)),cs(this),as(this)}}}catch{}};function he(h){if(!ze(h))return h.g.la();const y=tn(h.g);if(y==="")return"";let N="";const M=y.length,te=Ta(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return cs(h),as(h),"";h.h.i=new d.TextDecoder}for(let ie=0;ie<M;ie++)h.h.h=!0,N+=h.h.i.decode(y[ie],{stream:!(te&&ie==M-1)});return y.length=0,h.h.g+=N,h.C=0,h.h.g}function ze(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function lt(h,y){var N=h.C,M=y.indexOf(`
`,N);return M==-1?D:(N=Number(y.substring(N,M)),isNaN(N)?os:(M+=1,M+N>y.length?D:(y=y.slice(M,M+N),h.C=M+N,y)))}js.prototype.cancel=function(){this.K=!0,cs(this)};function ut(h){h.T=Date.now()+h.H,Xe(h,h.H)}function Xe(h,y){if(h.D!=null)throw Error("WatchDog timer not null");h.D=vt(g(h.aa,h),y)}function wt(h){h.D&&(d.clearTimeout(h.D),h.D=null)}js.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Ns(this.i,this.B),this.M!=2&&(Vs(),Ie(17)),cs(this),this.m=2,as(this)):Xe(this,this.T-h)};function as(h){h.j.I==0||h.K||jd(h.j,h)}function cs(h){wt(h);var y=h.O;y&&typeof y.dispose=="function"&&y.dispose(),h.O=null,He(h.V),h.g&&(y=h.g,h.g=null,y.abort(),y.dispose())}function _s(h,y){try{var N=h.j;if(N.I!=0&&(N.g==h||la(N.h,h))){if(!h.L&&la(N.h,h)&&N.I==3){try{var M=N.Ba.g.parse(y)}catch{M=null}if(Array.isArray(M)&&M.length==3){var te=M;if(te[0]==0){e:if(!N.v){if(N.g)if(N.g.F+3e3<h.F)Kl(N),ni(N);else break e;rl(N),Ie(18)}}else N.xa=te[1],0<N.xa-N.K&&te[2]<37500&&N.F&&N.A==0&&!N.C&&(N.C=vt(g(N.Va,N),6e3));ia(N.h)<=1&&N.ta&&(N.ta=void 0)}else Ka(N,11)}else if((h.L||N.g==h)&&Kl(N),!I(y))for(te=N.Ba.g.parse(y),y=0;y<te.length;y++){let Lt=te[y];const ms=Lt[0];if(!(ms<=N.K))if(N.K=ms,Lt=Lt[1],N.I==2)if(Lt[0]=="c"){N.M=Lt[1],N.ba=Lt[2];const ua=Lt[3];ua!=null&&(N.ka=ua,N.j.info("VER="+N.ka));const Qa=Lt[4];Qa!=null&&(N.za=Qa,N.j.info("SVER="+N.za));const Aa=Lt[5];Aa!=null&&typeof Aa=="number"&&Aa>0&&(M=1.5*Aa,N.O=M,N.j.info("backChannelRequestTimeoutMs_="+M)),M=N;const ka=h.g;if(ka){const il=ka.g?ka.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(il){var ie=M.h;ie.g||il.indexOf("spdy")==-1&&il.indexOf("quic")==-1&&il.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(pr(ie,ie.h),ie.h=null))}if(M.G){const Ql=ka.g?ka.g.getResponseHeader("X-HTTP-Session-Id"):null;Ql&&(M.wa=Ql,Ht(M.J,M.G,Ql))}}N.I=3,N.l&&N.l.ra(),N.aa&&(N.T=Date.now()-h.F,N.j.info("Handshake RTT: "+N.T+"ms")),M=N;var Te=h;if(M.na=Ed(M,M.L?M.ba:null,M.W),Te.L){Qi(M.h,Te);var mt=Te,Cs=M.O;Cs&&(mt.H=Cs),mt.D&&(wt(mt),ut(mt)),M.g=Te}else wd(M);N.i.length>0&&Wa(N)}else Lt[0]!="stop"&&Lt[0]!="close"||Ka(N,7);else N.I==3&&(Lt[0]=="stop"||Lt[0]=="close"?Lt[0]=="stop"?Ka(N,7):wc(N):Lt[0]!="noop"&&N.l&&N.l.qa(Lt),N.A=0)}}Vs(4)}catch{}}var fs=class{constructor(h,y){this.g=h,this.map=y}};function $a(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ki(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ia(h){return h.h?1:h.g?h.g.size:0}function la(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function pr(h,y){h.g?h.g.add(y):h.h=y}function Qi(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}$a.prototype.cancel=function(){if(this.i=Xi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Xi(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const N of h.g.values())y=y.concat(N.G);return y}return R(h.i)}var pd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fl(h,y){if(h){h=h.split("&");for(let N=0;N<h.length;N++){const M=h[N].indexOf("=");let te,ie=null;M>=0?(te=h[N].substring(0,M),ie=h[N].substring(M+1)):te=h[N],y(te,ie?decodeURIComponent(ie.replace(/\+/g," ")):"")}}}function Hn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;h instanceof Hn?(this.l=h.l,Xs(this,h.j),this.o=h.o,this.g=h.g,Qr(this,h.u),this.h=h.h,mc(this,yd(h.i)),this.m=h.m):h&&(y=String(h).match(pd))?(this.l=!1,Xs(this,y[1]||"",!0),this.o=qa(y[2]||""),this.g=qa(y[3]||"",!0),Qr(this,y[4]),this.h=qa(y[5]||"",!0),mc(this,y[6]||"",!0),this.m=qa(y[7]||"")):(this.l=!1,this.i=new Jr(null,this.l))}Hn.prototype.toString=function(){const h=[];var y=this.j;y&&h.push(Zi(y,$l,!0),":");var N=this.g;return(N||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Zi(y,$l,!0),"@"),h.push(bs(N).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N=this.u,N!=null&&h.push(":",String(N))),(N=this.h)&&(this.g&&N.charAt(0)!="/"&&h.push("/"),h.push(Zi(N,N.charAt(0)=="/"?pc:xd,!0))),(N=this.i.toString())&&h.push("?",N),(N=this.m)&&h.push("#",Zi(N,gd)),h.join("")},Hn.prototype.resolve=function(h){const y=Ls(this);let N=!!h.j;N?Xs(y,h.j):N=!!h.o,N?y.o=h.o:N=!!h.g,N?y.g=h.g:N=h.u!=null;var M=h.h;if(N)Qr(y,h.u);else if(N=!!h.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var te=y.h.lastIndexOf("/");te!=-1&&(M=y.h.slice(0,te+1)+M)}if(te=M,te==".."||te==".")M="";else if(te.indexOf("./")!=-1||te.indexOf("/.")!=-1){M=te.lastIndexOf("/",0)==0,te=te.split("/");const ie=[];for(let Te=0;Te<te.length;){const mt=te[Te++];mt=="."?M&&Te==te.length&&ie.push(""):mt==".."?((ie.length>1||ie.length==1&&ie[0]!="")&&ie.pop(),M&&Te==te.length&&ie.push("")):(ie.push(mt),M=!0)}M=ie.join("/")}else M=te}return N?y.h=M:N=h.i.toString()!=="",N?mc(y,yd(h.i)):N=!!h.m,N&&(y.m=h.m),y};function Ls(h){return new Hn(h)}function Xs(h,y,N){h.j=N?qa(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Qr(h,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);h.u=y}else h.u=null}function mc(h,y,N){y instanceof Jr?(h.i=y,Hl(h.i,h.l)):(N||(y=Zi(y,Xr)),h.i=new Jr(y,h.l))}function Ht(h,y,N){h.i.set(y,N)}function Ji(h){return Ht(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function qa(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Zi(h,y,N){return typeof h=="string"?(h=encodeURI(h).replace(y,_n),N&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function _n(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var $l=/[#\/\?@]/g,xd=/[#\?:]/g,pc=/[#\?]/g,Xr=/[#\?@]/g,gd=/#/g;function Jr(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Sn(h){h.g||(h.g=new Map,h.h=0,h.i&&Fl(h.i,function(y,N){h.add(decodeURIComponent(y.replace(/\+/g," ")),N)}))}n=Jr.prototype,n.add=function(h,y){Sn(this),this.i=null,h=Zr(this,h);let N=this.g.get(h);return N||this.g.set(h,N=[]),N.push(y),this.h+=1,this};function bd(h,y){Sn(h),y=Zr(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function xc(h,y){return Sn(h),y=Zr(h,y),h.g.has(y)}n.forEach=function(h,y){Sn(this),this.g.forEach(function(N,M){N.forEach(function(te){h.call(y,te,M,this)},this)},this)};function gc(h,y){Sn(h);let N=[];if(typeof y=="string")xc(h,y)&&(N=N.concat(h.g.get(Zr(h,y))));else for(h=Array.from(h.g.values()),y=0;y<h.length;y++)N=N.concat(h[y]);return N}n.set=function(h,y){return Sn(this),this.i=null,h=Zr(this,h),xc(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=gc(this,h),h.length>0?String(h[0]):y):y};function ql(h,y,N){bd(h,y),N.length>0&&(h.i=null,h.g.set(Zr(h,y),R(N)),h.h+=N.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(let M=0;M<y.length;M++){var N=y[M];const te=bs(N);N=gc(this,N);for(let ie=0;ie<N.length;ie++){let Te=te;N[ie]!==""&&(Te+="="+bs(N[ie])),h.push(Te)}}return this.i=h.join("&")};function yd(h){const y=new Jr;return y.i=h.i,h.g&&(y.g=new Map(h.g),y.h=h.h),y}function Zr(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Hl(h,y){y&&!h.j&&(Sn(h),h.i=null,h.g.forEach(function(N,M){const te=M.toLowerCase();M!=te&&(bd(this,M),ql(this,te,N))},h)),h.j=y}function Sa(h,y){const N=new Rt;if(d.Image){const M=new Image;M.onload=b(oa,N,"TestLoadImage: loaded",!0,y,M),M.onerror=b(oa,N,"TestLoadImage: error",!1,y,M),M.onabort=b(oa,N,"TestLoadImage: abort",!1,y,M),M.ontimeout=b(oa,N,"TestLoadImage: timeout",!1,y,M),d.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=h}else y(!1)}function bc(h,y){const N=new Rt,M=new AbortController,te=setTimeout(()=>{M.abort(),oa(N,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:M.signal}).then(ie=>{clearTimeout(te),ie.ok?oa(N,"TestPingServer: ok",!0,y):oa(N,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(te),oa(N,"TestPingServer: error",!1,y)})}function oa(h,y,N,M,te){try{te&&(te.onload=null,te.onerror=null,te.onabort=null,te.ontimeout=null),M(N)}catch{}}function ei(){this.g=new nt}function Ha(h){this.i=h.Sb||null,this.h=h.ab||!1}v(Ha,it),Ha.prototype.g=function(){return new el(this.i,this.h)};function el(h,y){bt.call(this),this.H=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(el,bt),n=el.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=y,this.readyState=1,Ea(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(y.body=h),(this.H||d).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ti(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ea(this)),this.g&&(this.readyState=3,Ea(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Gl(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Gl(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?ti(this):Ea(this),this.readyState==3&&Gl(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,ti(this))},n.Na=function(h){this.g&&(this.response=h,ti(this))},n.ga=function(){this.g&&ti(this)};function ti(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Ea(h)}n.setRequestHeader=function(h,y){this.A.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var N=y.next();!N.done;)N=N.value,h.push(N[0]+": "+N[1]),N=y.next();return h.join(`\r
`)};function Ea(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(el.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function ca(h){let y="";return Ee(h,function(N,M){y+=M,y+=":",y+=N,y+=`\r
`}),y}function tl(h,y,N){e:{for(M in N){var M=!1;break e}M=!0}M||(N=ca(N),typeof h=="string"?N!=null&&bs(N):Ht(h,y,N))}function Kt(h){bt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(Kt,bt);var Ga=/^https?$/i,yc=["POST","PUT"];n=Kt.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,y,N,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():_a.g(),this.g.onreadystatechange=_(g(this.Ca,this));try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(ie){sl(this,ie);return}if(h=N||"",N=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var te in M)N.set(te,M[te]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const ie of M.keys())N.set(ie,M.get(ie));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(N.keys()).find(ie=>ie.toLowerCase()=="content-type"),te=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(yc,y,void 0)>=0)||M||te||N.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,Te]of N)this.g.setRequestHeader(ie,Te);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ie){sl(this,ie)}};function sl(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.o=5,vc(h),xr(h)}function vc(h){h.A||(h.A=!0,Re(h,"complete"),Re(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Re(this,"complete"),Re(this,"abort"),xr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xr(this,!0)),Kt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?nl(this):this.Xa())},n.Xa=function(){nl(this)};function nl(h){if(h.h&&typeof c<"u"){if(h.v&&Ta(h)==4)setTimeout(h.Ca.bind(h),0);else if(Re(h,"readystatechange"),Ta(h)==4){h.h=!1;try{const ie=h.ca();e:switch(ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var N;if(!(N=y)){var M;if(M=ie===0){let Te=String(h.D).match(pd)[1]||null;!Te&&d.self&&d.self.location&&(Te=d.self.location.protocol.slice(0,-1)),M=!Ga.test(Te?Te.toLowerCase():"")}N=M}if(N)Re(h,"complete"),Re(h,"success");else{h.o=6;try{var te=Ta(h)>2?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.ca()+"]",vc(h)}}finally{xr(h)}}}}function xr(h,y){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const N=h.g;h.g=null,y||Re(h,"ready");try{N.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ta(h){return h.g?h.g.readyState:0}n.ca=function(){try{return Ta(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),ke(y)}};function tn(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function gr(h){const y={};h=(h.g&&Ta(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<h.length;M++){if(I(h[M]))continue;var N=Fa(h[M]);const te=N[0];if(N=N[1],typeof N!="string")continue;N=N.trim();const ie=y[te]||[];y[te]=ie,ie.push(N)}ye(y,function(M){return M.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ya(h,y,N){return N&&N.internalChannelParams&&N.internalChannelParams[h]||y}function si(h){this.za=0,this.i=[],this.j=new Rt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ya("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ya("baseRetryDelayMs",5e3,h),this.Za=Ya("retryDelaySeedMs",1e4,h),this.Ta=Ya("forwardChannelMaxRetries",2,h),this.va=Ya("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new $a(h&&h.concurrentRequestLimit),this.Ba=new ei,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=si.prototype,n.ka=8,n.I=1,n.connect=function(h,y,N,M){Ie(0),this.W=h,this.H=y||{},N&&M!==void 0&&(this.H.OSID=N,this.H.OAID=M),this.F=this.X,this.J=Ed(this,null,this.W),Wa(this)};function wc(h){if(Yl(h),h.I==3){var y=h.V++,N=Ls(h.J);if(Ht(N,"SID",h.M),Ht(N,"RID",y),Ht(N,"TYPE","terminate"),al(h,N),y=new js(h,h.j,y),y.M=2,y.A=Ji(Ls(N)),N=!1,d.navigator&&d.navigator.sendBeacon)try{N=d.navigator.sendBeacon(y.A.toString(),"")}catch{}!N&&d.Image&&(new Image().src=y.A,N=!0),N||(y.g=Td(y.j,null),y.g.ea(y.A)),y.F=Date.now(),ut(y)}Sd(h)}function ni(h){h.g&&(jc(h),h.g.cancel(),h.g=null)}function Yl(h){ni(h),h.v&&(d.clearTimeout(h.v),h.v=null),Kl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Wa(h){if(!Ki(h.h)&&!h.m){h.m=!0;var y=h.Ea;ue||E(),Y||(ue(),Y=!0),T.add(y,h),h.D=0}}function Wl(h,y){return ia(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=y.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=vt(g(h.Ea,h,y),_d(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const te=new js(this,this.j,h);let ie=this.o;if(this.U&&(ie?(ie=F(ie),de(ie,this.U)):ie=this.U),this.u!==null||this.R||(te.J=ie,ie=null),this.S)e:{for(var y=0,N=0;N<this.i.length;N++){t:{var M=this.i[N];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(y+=M,y>4096){y=N;break e}if(y===4096||N===this.i.length-1){y=N+1;break e}}y=1e3}else y=1e3;y=vd(this,te,y),N=Ls(this.J),Ht(N,"RID",h),Ht(N,"CVER",22),this.G&&Ht(N,"X-HTTP-Session-Id",this.G),al(this,N),ie&&(this.R?y="headers="+bs(ca(ie))+"&"+y:this.u&&tl(N,this.u,ie)),pr(this.h,te),this.Ra&&Ht(N,"TYPE","init"),this.S?(Ht(N,"$req",y),Ht(N,"SID","null"),te.U=!0,Q(te,N,null)):Q(te,N,y),this.I=2}}else this.I==3&&(h?Nc(this,h):this.i.length==0||Ki(this.h)||Nc(this))};function Nc(h,y){var N;y?N=y.l:N=h.V++;const M=Ls(h.J);Ht(M,"SID",h.M),Ht(M,"RID",N),Ht(M,"AID",h.K),al(h,M),h.u&&h.o&&tl(M,h.u,h.o),N=new js(h,h.j,N,h.D+1),h.u===null&&(N.J=h.o),y&&(h.i=y.G.concat(h.i)),y=vd(h,N,1e3),N.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),pr(h.h,N),Q(N,M,y)}function al(h,y){h.H&&Ee(h.H,function(N,M){Ht(y,M,N)}),h.l&&Ee({},function(N,M){Ht(y,M,N)})}function vd(h,y,N){N=Math.min(h.i.length,N);const M=h.l?g(h.l.Ka,h.l,h):null;e:{var te=h.i;let mt=-1;for(;;){const Cs=["count="+N];mt==-1?N>0?(mt=te[0].g,Cs.push("ofs="+mt)):mt=0:Cs.push("ofs="+mt);let Lt=!0;for(let ms=0;ms<N;ms++){var ie=te[ms].g;const ua=te[ms].map;if(ie-=mt,ie<0)mt=Math.max(0,te[ms].g-100),Lt=!1;else try{ie="req"+ie+"_"||"";try{var Te=ua instanceof Map?ua:Object.entries(ua);for(const[Qa,Aa]of Te){let ka=Aa;m(Aa)&&(ka=ee(Aa)),Cs.push(ie+Qa+"="+encodeURIComponent(ka))}}catch(Qa){throw Cs.push(ie+"type="+encodeURIComponent("_badmap")),Qa}}catch{M&&M(ua)}}if(Lt){Te=Cs.join("&");break e}}Te=void 0}return h=h.i.splice(0,N),y.G=h,Te}function wd(h){if(!h.g&&!h.v){h.Y=1;var y=h.Da;ue||E(),Y||(ue(),Y=!0),T.add(y,h),h.A=0}}function rl(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=vt(g(h.Da,h),_d(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Nd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=vt(g(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ie(10),ni(this),Nd(this))};function jc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Nd(h){h.g=new js(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var y=Ls(h.na);Ht(y,"RID","rpc"),Ht(y,"SID",h.M),Ht(y,"AID",h.K),Ht(y,"CI",h.F?"0":"1"),!h.F&&h.ia&&Ht(y,"TO",h.ia),Ht(y,"TYPE","xmlhttp"),al(h,y),h.u&&h.o&&tl(y,h.u,h.o),h.O&&(h.g.H=h.O);var N=h.g;h=h.ba,N.M=1,N.A=Ji(Ls(y)),N.u=null,N.R=!0,be(N,h)}n.Va=function(){this.C!=null&&(this.C=null,ni(this),rl(this),Ie(19))};function Kl(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function jd(h,y){var N=null;if(h.g==y){Kl(h),jc(h),h.g=null;var M=2}else if(la(h.h,y))N=y.G,Qi(h.h,y),M=1;else return;if(h.I!=0){if(y.o)if(M==1){N=y.u?y.u.length:0,y=Date.now()-y.F;var te=h.D;M=Ps(),Re(M,new ft(M,N)),Wa(h)}else wd(h);else if(te=y.m,te==3||te==0&&y.X>0||!(M==1&&Wl(h,y)||M==2&&rl(h)))switch(N&&N.length>0&&(y=h.h,y.i=y.i.concat(N)),te){case 1:Ka(h,5);break;case 4:Ka(h,10);break;case 3:Ka(h,6);break;default:Ka(h,2)}}}function _d(h,y){let N=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(N*=2),N*y}function Ka(h,y){if(h.j.info("Error code "+y),y==2){var N=g(h.bb,h),M=h.Ua;const te=!M;M=new Hn(M||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Xs(M,"https"),Ji(M),te?Sa(M.toString(),N):bc(M.toString(),N)}else Ie(2);h.I=0,h.l&&h.l.pa(y),Sd(h),Yl(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Ie(2)):(this.j.info("Failed to ping google.com"),Ie(1))};function Sd(h){if(h.I=0,h.ja=[],h.l){const y=Xi(h.h);(y.length!=0||h.i.length!=0)&&(B(h.ja,y),B(h.ja,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.oa()}}function Ed(h,y,N){var M=N instanceof Hn?Ls(N):new Hn(N);if(M.g!="")y&&(M.g=y+"."+M.g),Qr(M,M.u);else{var te=d.location;M=te.protocol,y=y?y+"."+te.hostname:te.hostname,te=+te.port;const ie=new Hn(null);M&&Xs(ie,M),y&&(ie.g=y),te&&Qr(ie,te),N&&(ie.h=N),M=ie}return N=h.G,y=h.wa,N&&y&&Ht(M,N,y),Ht(M,"VER",h.ka),al(h,M),M}function Td(h,y,N){if(y&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Aa&&!h.ma?new Kt(new Ha({ab:N})):new Kt(h.ma),y.Fa(h.L),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ad(){}n=Ad.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ai(){}ai.prototype.g=function(h,y){return new yn(h,y)};function yn(h,y){bt.call(this),this.g=new si(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(h?h["X-WebChannel-Client-Profile"]=y.sa:h={"X-WebChannel-Client-Profile":y.sa}),this.g.U=h,(h=y&&y.Qb)&&!I(h)&&(this.g.u=h),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!I(y)&&(this.g.G=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new br(this)}v(yn,bt),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){wc(this.g)},yn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var N={};N.__data__=h,h=N}else this.v&&(N={},N.__data__=ee(h),h=N);y.i.push(new fs(y.Ya++,h)),y.I==3&&Wa(y)},yn.prototype.N=function(){this.g.l=null,delete this.j,wc(this.g),delete this.g,yn.Z.N.call(this)};function kd(h){yt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const N in y){h=N;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}v(kd,yt);function Cd(){gs.call(this),this.status=1}v(Cd,gs);function br(h){this.g=h}v(br,Ad),br.prototype.ra=function(){Re(this.g,"a")},br.prototype.qa=function(h){Re(this.g,new kd(h))},br.prototype.pa=function(h){Re(this.g,new Cd)},br.prototype.oa=function(){Re(this.g,"b")},ai.prototype.createWebChannel=ai.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,d2=function(){return new ai},u2=function(){return Ps()},c2=hs,ex={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ls.NO_ERROR=0,ls.TIMEOUT=8,ls.HTTP_ERROR=6,tf=ls,$n.COMPLETE="complete",o2=$n,Bt.EventType=is,is.OPEN="a",is.CLOSE="b",is.ERROR="c",is.MESSAGE="d",bt.prototype.listen=bt.prototype.J,vu=Bt,Kt.prototype.listenOnce=Kt.prototype.K,Kt.prototype.getLastError=Kt.prototype.Ha,Kt.prototype.getLastErrorCode=Kt.prototype.ya,Kt.prototype.getStatus=Kt.prototype.ca,Kt.prototype.getResponseJson=Kt.prototype.La,Kt.prototype.getResponseText=Kt.prototype.la,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Fa,l2=Kt}).apply(typeof Ph<"u"?Ph:typeof self<"u"?self:typeof window<"u"?window:{});let fn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");let oc="12.8.0";function lR(n){oc=n}const Ml=new Lx("@firebase/firestore");function Ao(){return Ml.logLevel}function Pe(n,...e){if(Ml.logLevel<=Tt.DEBUG){const t=e.map(Qx);Ml.debug(`Firestore (${oc}): ${n}`,...t)}}function Gr(n,...e){if(Ml.logLevel<=Tt.ERROR){const t=e.map(Qx);Ml.error(`Firestore (${oc}): ${n}`,...t)}}function Ho(n,...e){if(Ml.logLevel<=Tt.WARN){const t=e.map(Qx);Ml.warn(`Firestore (${oc}): ${n}`,...t)}}function Qx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function rt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,h2(n,i,t)}function h2(n,e,t){let i=`FIRESTORE (${oc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Gr(i),new Error(i)}function $t(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||h2(e,o,i)}function ht(n,e){return n}const we={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Oe extends za{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Br{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class f2{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(fn.UNAUTHENTICATED)))}shutdown(){}}class cR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class uR{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){$t(this.o===void 0,42304);let i=this.i;const o=x=>this.i!==i?(i=this.i,t(x)):Promise.resolve();let c=new Br;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Br,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const x=c;e.enqueueRetryable((async()=>{await x.promise,await o(this.currentUser)}))},m=x=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=x,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((x=>m(x))),setTimeout((()=>{if(!this.auth){const x=this.t.getImmediate({optional:!0});x?m(x):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Br)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?($t(typeof i.accessToken=="string",31837,{l:i}),new f2(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $t(e===null||typeof e=="string",2055,{h:e}),new fn(e)}}class dR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class hR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new dR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class lN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,jn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){$t(this.o===void 0,3512);const i=c=>{c.error!=null&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,Pe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>i(c)))};const o=c=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>o(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new lN(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?($t(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new lN(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function mR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Xx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=mR(40);for(let c=0;c<o.length;++c)i.length<20&&o[c]<t&&(i+=e.charAt(o[c]%62))}return i}}function At(n,e){return n<e?-1:n>e?1:0}function tx(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),c=e.charAt(i);if(o!==c)return R0(o)===R0(c)?At(o,c):R0(o)?1:-1}return At(n.length,e.length)}const pR=55296,xR=57343;function R0(n){const e=n.charCodeAt(0);return e>=pR&&e<=xR}function Go(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}const oN="__name__";class tr{constructor(e,t,i){t===void 0?t=0:t>e.length&&rt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&rt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return tr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof tr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const c=tr.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return At(e.length,t.length)}static compareSegments(e,t){const i=tr.isNumericId(e),o=tr.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?tr.extractNumericId(e).compare(tr.extractNumericId(t)):tx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pi.fromString(e.substring(4,e.length-2))}}class rs extends tr{construct(e,t,i){return new rs(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Oe(we.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new rs(t)}static emptyPath(){return new rs([])}}const gR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class on extends tr{construct(e,t,i){return new on(e,t,i)}static isValidIdentifier(e){return gR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),on.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===oN}static keyField(){return new on([oN])}static fromServerFormat(e){const t=[];let i="",o=0;const c=()=>{if(i.length===0)throw new Oe(we.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;o<e.length;){const m=e[o];if(m==="\\"){if(o+1===e.length)throw new Oe(we.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const x=e[o+1];if(x!=="\\"&&x!=="."&&x!=="`")throw new Oe(we.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=x,o+=2}else m==="`"?(d=!d,o++):m!=="."||d?(i+=m,o++):(c(),o++)}if(c(),d)throw new Oe(we.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new on(t)}static emptyPath(){return new on([])}}class et{constructor(e){this.path=e}static fromPath(e){return new et(rs.fromString(e))}static fromName(e){return new et(rs.fromString(e).popFirst(5))}static empty(){return new et(rs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&rs.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return rs.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new et(new rs(e.slice()))}}function m2(n,e,t){if(!t)throw new Oe(we.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function bR(n,e,t,i){if(e===!0&&i===!0)throw new Oe(we.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function cN(n){if(!et.isDocumentKey(n))throw new Oe(we.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function uN(n){if(et.isDocumentKey(n))throw new Oe(we.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function p2(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Xf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":rt(12329,{type:typeof n})}function Ln(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Oe(we.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Xf(n);throw new Oe(we.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Gs(n,e){const t={typeString:n};return e&&(t.value=e),t}function od(n,e){if(!p2(n))throw new Oe(we.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,c="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(o&&typeof d!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(c!==void 0&&d!==c.value){t=`Expected '${i}' field to equal '${c.value}'`;break}}if(t)throw new Oe(we.INVALID_ARGUMENT,t);return!0}const dN=-62135596800,hN=1e6;class zt{static now(){return zt.fromMillis(Date.now())}static fromDate(e){return zt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*hN);return new zt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Oe(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Oe(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<dN)throw new Oe(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Oe(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hN}_compareTo(e){return this.seconds===e.seconds?At(this.nanoseconds,e.nanoseconds):At(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:zt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(od(e,zt._jsonSchema))return new zt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-dN;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}zt._jsonSchemaVersion="firestore/timestamp/1.0",zt._jsonSchema={type:Gs("string",zt._jsonSchemaVersion),seconds:Gs("number"),nanoseconds:Gs("number")};class ct{static fromTimestamp(e){return new ct(e)}static min(){return new ct(new zt(0,0))}static max(){return new ct(new zt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const qu=-1;function yR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=ct.fromTimestamp(i===1e9?new zt(t+1,0):new zt(t,i));return new Bi(o,et.empty(),e)}function vR(n){return new Bi(n.readTime,n.key,qu)}class Bi{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Bi(ct.min(),et.empty(),qu)}static max(){return new Bi(ct.max(),et.empty(),qu)}}function wR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=et.comparator(n.documentKey,e.documentKey),t!==0?t:At(n.largestBatchId,e.largestBatchId))}const NR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function cc(n){if(n.code!==we.FAILED_PRECONDITION||n.message!==NR)throw n;Pe("LocalStore","Unexpectedly lost primary lease")}class Ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&rt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ne(((i,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(i,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ne?t:Ne.resolve(t)}catch(t){return Ne.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.reject(t)}static resolve(e){return new Ne(((t,i)=>{t(e)}))}static reject(e){return new Ne(((t,i)=>{i(e)}))}static waitFor(e){return new Ne(((t,i)=>{let o=0,c=0,d=!1;e.forEach((m=>{++o,m.next((()=>{++c,d&&c===o&&t()}),(x=>i(x)))})),d=!0,c===o&&t()}))}static or(e){let t=Ne.resolve(!1);for(const i of e)t=t.next((o=>o?Ne.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,c)=>{i.push(t.call(this,o,c))})),this.waitFor(i)}static mapArray(e,t){return new Ne(((i,o)=>{const c=e.length,d=new Array(c);let m=0;for(let x=0;x<c;x++){const g=x;t(e[g]).next((b=>{d[g]=b,++m,m===c&&i(d)}),(b=>o(b)))}}))}static doWhile(e,t){return new Ne(((i,o)=>{const c=()=>{e()===!0?t().next((()=>{c()}),o):i()};c()}))}}function _R(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function uc(n){return n.name==="IndexedDbTransactionError"}class Jf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Jf.ce=-1;const Jx=-1;function Zf(n){return n==null}function jf(n){return n===0&&1/n==-1/0}function SR(n){return typeof n=="number"&&Number.isInteger(n)&&!jf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const x2="";function ER(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=fN(e)),e=TR(n.get(t),e);return fN(e)}function TR(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case x2:t+="";break;default:t+=c}}return t}function fN(n){return n+x2+""}function mN(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function g2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class vs{constructor(e,t){this.comparator=e,this.root=t||ln.EMPTY}insert(e,t){return new vs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ln.BLACK,null,null))}remove(e){return new vs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vh(this.root,e,this.comparator,!0)}}class Vh{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?i(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ln{constructor(e,t,i,o,c){this.key=e,this.value=t,this.color=i??ln.RED,this.left=o??ln.EMPTY,this.right=c??ln.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,c){return new ln(e??this.key,t??this.value,i??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const c=i(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,i),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return ln.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return ln.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw rt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw rt(27949);return e+(this.isRed()?0:1)}}ln.EMPTY=null,ln.RED=!0,ln.BLACK=!1;ln.EMPTY=new class{constructor(){this.size=0}get key(){throw rt(57766)}get value(){throw rt(16141)}get color(){throw rt(16727)}get left(){throw rt(29726)}get right(){throw rt(36894)}copy(e,t,i,o,c){return this}insert(e,t,i){return new ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ws{constructor(e){this.comparator=e,this.data=new vs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new pN(this.data.getIterator())}getIteratorFrom(e){return new pN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ws)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ws(this.comparator);return t.data=e,t}}class pN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Zn{constructor(e){this.fields=e,e.sort(on.comparator)}static empty(){return new Zn([])}unionWith(e){let t=new Ws(on.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Zn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Go(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class b2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class un{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new b2("Invalid base64 string: "+c):c}})(e);return new un(t)}static fromUint8Array(e){const t=(function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c})(e);return new un(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return At(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}un.EMPTY_BYTE_STRING=new un("");const AR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zi(n){if($t(!!n,39018),typeof n=="string"){let e=0;const t=AR.exec(n);if($t(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ds(n.seconds),nanos:Ds(n.nanos)}}function Ds(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Fi(n){return typeof n=="string"?un.fromBase64String(n):un.fromUint8Array(n)}const y2="server_timestamp",v2="__type__",w2="__previous_value__",N2="__local_write_time__";function Zx(n){return(n?.mapValue?.fields||{})[v2]?.stringValue===y2}function em(n){const e=n.mapValue.fields[w2];return Zx(e)?em(e):e}function Hu(n){const e=zi(n.mapValue.fields[N2].timestampValue);return new zt(e.seconds,e.nanos)}class kR{constructor(e,t,i,o,c,d,m,x,g,b,v){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=m,this.longPollingOptions=x,this.useFetchStreams=g,this.isUsingEmulator=b,this.apiKey=v}}const _f="(default)";class Gu{constructor(e,t){this.projectId=e,this.database=t||_f}static empty(){return new Gu("","")}get isDefaultDatabase(){return this.database===_f}isEqual(e){return e instanceof Gu&&e.projectId===this.projectId&&e.database===this.database}}function CR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Oe(we.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gu(n.options.projectId,e)}const j2="__type__",RR="__max__",Lh={mapValue:{}},_2="__vector__",Sf="value";function $i(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Zx(n)?4:DR(n)?9007199254740991:IR(n)?10:11:rt(28295,{value:n})}function ur(n,e){if(n===e)return!0;const t=$i(n);if(t!==$i(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Hu(n).isEqual(Hu(e));case 3:return(function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=zi(o.timestampValue),m=zi(c.timestampValue);return d.seconds===m.seconds&&d.nanos===m.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,c){return Fi(o.bytesValue).isEqual(Fi(c.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,c){return Ds(o.geoPointValue.latitude)===Ds(c.geoPointValue.latitude)&&Ds(o.geoPointValue.longitude)===Ds(c.geoPointValue.longitude)})(n,e);case 2:return(function(o,c){if("integerValue"in o&&"integerValue"in c)return Ds(o.integerValue)===Ds(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=Ds(o.doubleValue),m=Ds(c.doubleValue);return d===m?jf(d)===jf(m):isNaN(d)&&isNaN(m)}return!1})(n,e);case 9:return Go(n.arrayValue.values||[],e.arrayValue.values||[],ur);case 10:case 11:return(function(o,c){const d=o.mapValue.fields||{},m=c.mapValue.fields||{};if(mN(d)!==mN(m))return!1;for(const x in d)if(d.hasOwnProperty(x)&&(m[x]===void 0||!ur(d[x],m[x])))return!1;return!0})(n,e);default:return rt(52216,{left:n})}}function Yu(n,e){return(n.values||[]).find((t=>ur(t,e)))!==void 0}function Yo(n,e){if(n===e)return 0;const t=$i(n),i=$i(e);if(t!==i)return At(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return At(n.booleanValue,e.booleanValue);case 2:return(function(c,d){const m=Ds(c.integerValue||c.doubleValue),x=Ds(d.integerValue||d.doubleValue);return m<x?-1:m>x?1:m===x?0:isNaN(m)?isNaN(x)?0:-1:1})(n,e);case 3:return xN(n.timestampValue,e.timestampValue);case 4:return xN(Hu(n),Hu(e));case 5:return tx(n.stringValue,e.stringValue);case 6:return(function(c,d){const m=Fi(c),x=Fi(d);return m.compareTo(x)})(n.bytesValue,e.bytesValue);case 7:return(function(c,d){const m=c.split("/"),x=d.split("/");for(let g=0;g<m.length&&g<x.length;g++){const b=At(m[g],x[g]);if(b!==0)return b}return At(m.length,x.length)})(n.referenceValue,e.referenceValue);case 8:return(function(c,d){const m=At(Ds(c.latitude),Ds(d.latitude));return m!==0?m:At(Ds(c.longitude),Ds(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return gN(n.arrayValue,e.arrayValue);case 10:return(function(c,d){const m=c.fields||{},x=d.fields||{},g=m[Sf]?.arrayValue,b=x[Sf]?.arrayValue,v=At(g?.values?.length||0,b?.values?.length||0);return v!==0?v:gN(g,b)})(n.mapValue,e.mapValue);case 11:return(function(c,d){if(c===Lh.mapValue&&d===Lh.mapValue)return 0;if(c===Lh.mapValue)return 1;if(d===Lh.mapValue)return-1;const m=c.fields||{},x=Object.keys(m),g=d.fields||{},b=Object.keys(g);x.sort(),b.sort();for(let v=0;v<x.length&&v<b.length;++v){const _=tx(x[v],b[v]);if(_!==0)return _;const R=Yo(m[x[v]],g[b[v]]);if(R!==0)return R}return At(x.length,b.length)})(n.mapValue,e.mapValue);default:throw rt(23264,{he:t})}}function xN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return At(n,e);const t=zi(n),i=zi(e),o=At(t.seconds,i.seconds);return o!==0?o:At(t.nanos,i.nanos)}function gN(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const c=Yo(t[o],i[o]);if(c)return c}return At(t.length,i.length)}function Wo(n){return sx(n)}function sx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=zi(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Fi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return et.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const c of t.values||[])o?o=!1:i+=",",i+=sx(c);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of i)c?c=!1:o+=",",o+=`${d}:${sx(t.fields[d])}`;return o+"}"})(n.mapValue):rt(61005,{value:n})}function sf(n){switch($i(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=em(n);return e?16+sf(e):16;case 5:return 2*n.stringValue.length;case 6:return Fi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,c)=>o+sf(c)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return Yi(i.fields,((c,d)=>{o+=c.length+sf(d)})),o})(n.mapValue);default:throw rt(13486,{value:n})}}function bN(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function nx(n){return!!n&&"integerValue"in n}function eg(n){return!!n&&"arrayValue"in n}function yN(n){return!!n&&"nullValue"in n}function vN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function nf(n){return!!n&&"mapValue"in n}function IR(n){return(n?.mapValue?.fields||{})[j2]?.stringValue===_2}function Cu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Yi(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Cu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Cu(n.arrayValue.values[t]);return e}return{...n}}function DR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===RR}class Dn{constructor(e){this.value=e}static empty(){return new Dn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!nf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cu(t)}setAll(e){let t=on.emptyPath(),i={},o=[];e.forEach(((d,m)=>{if(!t.isImmediateParentOf(m)){const x=this.getFieldsMap(t);this.applyChanges(x,i,o),i={},o=[],t=m.popLast()}d?i[m.lastSegment()]=Cu(d):o.push(m.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,i,o)}delete(e){const t=this.field(e.popLast());nf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ur(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];nf(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Yi(t,((o,c)=>e[o]=c));for(const o of i)delete e[o]}clone(){return new Dn(Cu(this.value))}}function S2(n){const e=[];return Yi(n.fields,((t,i)=>{const o=new on([t]);if(nf(i)){const c=S2(i.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)})),new Zn(e)}class mn{constructor(e,t,i,o,c,d,m){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=c,this.data=d,this.documentState=m}static newInvalidDocument(e){return new mn(e,0,ct.min(),ct.min(),ct.min(),Dn.empty(),0)}static newFoundDocument(e,t,i,o){return new mn(e,1,t,ct.min(),i,o,0)}static newNoDocument(e,t){return new mn(e,2,t,ct.min(),ct.min(),Dn.empty(),0)}static newUnknownDocument(e,t){return new mn(e,3,t,ct.min(),ct.min(),Dn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ct.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof mn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ef{constructor(e,t){this.position=e,this.inclusive=t}}function wN(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?i=et.comparator(et.fromName(d.referenceValue),t.key):i=Yo(d,t.data.field(c.field)),c.dir==="desc"&&(i*=-1),i!==0)break}return i}function NN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ur(n.position[t],e.position[t]))return!1;return!0}class Tf{constructor(e,t="asc"){this.field=e,this.dir=t}}function MR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class E2{}class Hs extends E2{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new PR(e,t,i):t==="array-contains"?new UR(e,i):t==="in"?new BR(e,i):t==="not-in"?new zR(e,i):t==="array-contains-any"?new FR(e,i):new Hs(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new VR(e,i):new LR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yo(t,this.value)):t!==null&&$i(this.value)===$i(t)&&this.matchesComparison(Yo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return rt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class La extends E2{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new La(e,t)}matches(e){return T2(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function T2(n){return n.op==="and"}function A2(n){return OR(n)&&T2(n)}function OR(n){for(const e of n.filters)if(e instanceof La)return!1;return!0}function ax(n){if(n instanceof Hs)return n.field.canonicalString()+n.op.toString()+Wo(n.value);if(A2(n))return n.filters.map((e=>ax(e))).join(",");{const e=n.filters.map((t=>ax(t))).join(",");return`${n.op}(${e})`}}function k2(n,e){return n instanceof Hs?(function(i,o){return o instanceof Hs&&i.op===o.op&&i.field.isEqual(o.field)&&ur(i.value,o.value)})(n,e):n instanceof La?(function(i,o){return o instanceof La&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((c,d,m)=>c&&k2(d,o.filters[m])),!0):!1})(n,e):void rt(19439)}function C2(n){return n instanceof Hs?(function(t){return`${t.field.canonicalString()} ${t.op} ${Wo(t.value)}`})(n):n instanceof La?(function(t){return t.op.toString()+" {"+t.getFilters().map(C2).join(" ,")+"}"})(n):"Filter"}class PR extends Hs{constructor(e,t,i){super(e,t,i),this.key=et.fromName(i.referenceValue)}matches(e){const t=et.comparator(e.key,this.key);return this.matchesComparison(t)}}class VR extends Hs{constructor(e,t){super(e,"in",t),this.keys=R2("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class LR extends Hs{constructor(e,t){super(e,"not-in",t),this.keys=R2("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function R2(n,e){return(e.arrayValue?.values||[]).map((t=>et.fromName(t.referenceValue)))}class UR extends Hs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return eg(t)&&Yu(t.arrayValue,this.value)}}class BR extends Hs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Yu(this.value.arrayValue,t)}}class zR extends Hs{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Yu(this.value.arrayValue,t)}}class FR extends Hs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!eg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Yu(this.value.arrayValue,i)))}}class $R{constructor(e,t=null,i=[],o=[],c=null,d=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=c,this.startAt=d,this.endAt=m,this.Te=null}}function jN(n,e=null,t=[],i=[],o=null,c=null,d=null){return new $R(n,e,t,i,o,c,d)}function tg(n){const e=ht(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>ax(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(c){return c.field.canonicalString()+c.dir})(i))).join(","),Zf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Wo(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Wo(i))).join(",")),e.Te=t}return e.Te}function sg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!MR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!k2(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!NN(n.startAt,e.startAt)&&NN(n.endAt,e.endAt)}function rx(n){return et.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class cd{constructor(e,t=null,i=[],o=[],c=null,d="F",m=null,x=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=c,this.limitType=d,this.startAt=m,this.endAt=x,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function qR(n,e,t,i,o,c,d,m){return new cd(n,e,t,i,o,c,d,m)}function tm(n){return new cd(n)}function _N(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function HR(n){return et.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function I2(n){return n.collectionGroup!==null}function Ru(n){const e=ht(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),t.add(c.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let m=new Ws(on.comparator);return d.filters.forEach((x=>{x.getFlattenedFilters().forEach((g=>{g.isInequality()&&(m=m.add(g.field))}))})),m})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new Tf(c,i))})),t.has(on.keyField().canonicalString())||e.Ie.push(new Tf(on.keyField(),i))}return e.Ie}function ir(n){const e=ht(n);return e.Ee||(e.Ee=GR(e,Ru(n))),e.Ee}function GR(n,e){if(n.limitType==="F")return jN(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const c=o.dir==="desc"?"asc":"desc";return new Tf(o.field,c)}));const t=n.endAt?new Ef(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ef(n.startAt.position,n.startAt.inclusive):null;return jN(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function ix(n,e){const t=n.filters.concat([e]);return new cd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function lx(n,e,t){return new cd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function sm(n,e){return sg(ir(n),ir(e))&&n.limitType===e.limitType}function D2(n){return`${tg(ir(n))}|lt:${n.limitType}`}function ko(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>C2(o))).join(", ")}]`),Zf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>Wo(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>Wo(o))).join(",")),`Target(${i})`})(ir(n))}; limitType=${n.limitType})`}function nm(n,e){return e.isFoundDocument()&&(function(i,o){const c=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(c):et.isDocumentKey(i.path)?i.path.isEqual(c):i.path.isImmediateParentOf(c)})(n,e)&&(function(i,o){for(const c of Ru(i))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const c of i.filters)if(!c.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(d,m,x){const g=wN(d,m,x);return d.inclusive?g<=0:g<0})(i.startAt,Ru(i),o)||i.endAt&&!(function(d,m,x){const g=wN(d,m,x);return d.inclusive?g>=0:g>0})(i.endAt,Ru(i),o))})(n,e)}function YR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function M2(n){return(e,t)=>{let i=!1;for(const o of Ru(n)){const c=WR(o,e,t);if(c!==0)return c;i=i||o.field.isKeyField()}return 0}}function WR(n,e,t){const i=n.field.isKeyField()?et.comparator(e.key,t.key):(function(c,d,m){const x=d.data.field(c),g=m.data.field(c);return x!==null&&g!==null?Yo(x,g):rt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return rt(19790,{direction:n.dir})}}class Ul{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,c]of i)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Yi(this.inner,((t,i)=>{for(const[o,c]of i)e(o,c)}))}isEmpty(){return g2(this.inner)}size(){return this.innerSize}}const KR=new vs(et.comparator);function Yr(){return KR}const O2=new vs(et.comparator);function wu(...n){let e=O2;for(const t of n)e=e.insert(t.key,t);return e}function P2(n){let e=O2;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function El(){return Iu()}function V2(){return Iu()}function Iu(){return new Ul((n=>n.toString()),((n,e)=>n.isEqual(e)))}const QR=new vs(et.comparator),XR=new Ws(et.comparator);function kt(...n){let e=XR;for(const t of n)e=e.add(t);return e}const JR=new Ws(At);function ZR(){return JR}function ng(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jf(e)?"-0":e}}function L2(n){return{integerValue:""+n}}function e6(n,e){return SR(e)?L2(e):ng(n,e)}class am{constructor(){this._=void 0}}function t6(n,e,t){return n instanceof Wu?(function(o,c){const d={fields:{[v2]:{stringValue:y2},[N2]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Zx(c)&&(c=em(c)),c&&(d.fields[w2]=c),{mapValue:d}})(t,e):n instanceof Ku?B2(n,e):n instanceof Qu?z2(n,e):(function(o,c){const d=U2(o,c),m=SN(d)+SN(o.Ae);return nx(d)&&nx(o.Ae)?L2(m):ng(o.serializer,m)})(n,e)}function s6(n,e,t){return n instanceof Ku?B2(n,e):n instanceof Qu?z2(n,e):t}function U2(n,e){return n instanceof Af?(function(i){return nx(i)||(function(c){return!!c&&"doubleValue"in c})(i)})(e)?e:{integerValue:0}:null}class Wu extends am{}class Ku extends am{constructor(e){super(),this.elements=e}}function B2(n,e){const t=F2(e);for(const i of n.elements)t.some((o=>ur(o,i)))||t.push(i);return{arrayValue:{values:t}}}class Qu extends am{constructor(e){super(),this.elements=e}}function z2(n,e){let t=F2(e);for(const i of n.elements)t=t.filter((o=>!ur(o,i)));return{arrayValue:{values:t}}}class Af extends am{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function SN(n){return Ds(n.integerValue||n.doubleValue)}function F2(n){return eg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class n6{constructor(e,t){this.field=e,this.transform=t}}function a6(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof Ku&&o instanceof Ku||i instanceof Qu&&o instanceof Qu?Go(i.elements,o.elements,ur):i instanceof Af&&o instanceof Af?ur(i.Ae,o.Ae):i instanceof Wu&&o instanceof Wu})(n.transform,e.transform)}class r6{constructor(e,t){this.version=e,this.transformResults=t}}class Na{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Na}static exists(e){return new Na(void 0,e)}static updateTime(e){return new Na(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function af(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class rm{}function $2(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ag(n.key,Na.none()):new ud(n.key,n.data,Na.none());{const t=n.data,i=Dn.empty();let o=new Ws(on.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?i.delete(c):i.set(c,d),o=o.add(c)}return new Wi(n.key,i,new Zn(o.toArray()),Na.none())}}function i6(n,e,t){n instanceof ud?(function(o,c,d){const m=o.value.clone(),x=TN(o.fieldTransforms,c,d.transformResults);m.setAll(x),c.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):n instanceof Wi?(function(o,c,d){if(!af(o.precondition,c))return void c.convertToUnknownDocument(d.version);const m=TN(o.fieldTransforms,c,d.transformResults),x=c.data;x.setAll(q2(o)),x.setAll(m),c.convertToFoundDocument(d.version,x).setHasCommittedMutations()})(n,e,t):(function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function Du(n,e,t,i){return n instanceof ud?(function(c,d,m,x){if(!af(c.precondition,d))return m;const g=c.value.clone(),b=AN(c.fieldTransforms,x,d);return g.setAll(b),d.convertToFoundDocument(d.version,g).setHasLocalMutations(),null})(n,e,t,i):n instanceof Wi?(function(c,d,m,x){if(!af(c.precondition,d))return m;const g=AN(c.fieldTransforms,x,d),b=d.data;return b.setAll(q2(c)),b.setAll(g),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),m===null?null:m.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((v=>v.field)))})(n,e,t,i):(function(c,d,m){return af(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):m})(n,e,t)}function l6(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),c=U2(i.transform,o||null);c!=null&&(t===null&&(t=Dn.empty()),t.set(i.field,c))}return t||null}function EN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Go(i,o,((c,d)=>a6(c,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ud extends rm{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Wi extends rm{constructor(e,t,i,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function q2(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function TN(n,e,t){const i=new Map;$t(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,m=e.data.field(c.field);i.set(c.field,s6(d,m,t[o]))}return i}function AN(n,e,t){const i=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);i.set(o.field,t6(c,d,e))}return i}class ag extends rm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class o6 extends rm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class c6{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&i6(c,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Du(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Du(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=V2();return this.mutations.forEach((o=>{const c=e.get(o.key),d=c.overlayedDocument;let m=this.applyToLocalView(d,c.mutatedFields);m=t.has(o.key)?null:m;const x=$2(d,m);x!==null&&i.set(o.key,x),d.isValidDocument()||d.convertToNoDocument(ct.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),kt())}isEqual(e){return this.batchId===e.batchId&&Go(this.mutations,e.mutations,((t,i)=>EN(t,i)))&&Go(this.baseMutations,e.baseMutations,((t,i)=>EN(t,i)))}}class rg{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){$t(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return QR})();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,i[d].version);return new rg(e,t,i,o)}}class u6{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class d6{constructor(e,t){this.count=e,this.unchangedNames=t}}var $s,Dt;function h6(n){switch(n){case we.OK:return rt(64938);case we.CANCELLED:case we.UNKNOWN:case we.DEADLINE_EXCEEDED:case we.RESOURCE_EXHAUSTED:case we.INTERNAL:case we.UNAVAILABLE:case we.UNAUTHENTICATED:return!1;case we.INVALID_ARGUMENT:case we.NOT_FOUND:case we.ALREADY_EXISTS:case we.PERMISSION_DENIED:case we.FAILED_PRECONDITION:case we.ABORTED:case we.OUT_OF_RANGE:case we.UNIMPLEMENTED:case we.DATA_LOSS:return!0;default:return rt(15467,{code:n})}}function H2(n){if(n===void 0)return Gr("GRPC error has no .code"),we.UNKNOWN;switch(n){case $s.OK:return we.OK;case $s.CANCELLED:return we.CANCELLED;case $s.UNKNOWN:return we.UNKNOWN;case $s.DEADLINE_EXCEEDED:return we.DEADLINE_EXCEEDED;case $s.RESOURCE_EXHAUSTED:return we.RESOURCE_EXHAUSTED;case $s.INTERNAL:return we.INTERNAL;case $s.UNAVAILABLE:return we.UNAVAILABLE;case $s.UNAUTHENTICATED:return we.UNAUTHENTICATED;case $s.INVALID_ARGUMENT:return we.INVALID_ARGUMENT;case $s.NOT_FOUND:return we.NOT_FOUND;case $s.ALREADY_EXISTS:return we.ALREADY_EXISTS;case $s.PERMISSION_DENIED:return we.PERMISSION_DENIED;case $s.FAILED_PRECONDITION:return we.FAILED_PRECONDITION;case $s.ABORTED:return we.ABORTED;case $s.OUT_OF_RANGE:return we.OUT_OF_RANGE;case $s.UNIMPLEMENTED:return we.UNIMPLEMENTED;case $s.DATA_LOSS:return we.DATA_LOSS;default:return rt(39323,{code:n})}}(Dt=$s||($s={}))[Dt.OK=0]="OK",Dt[Dt.CANCELLED=1]="CANCELLED",Dt[Dt.UNKNOWN=2]="UNKNOWN",Dt[Dt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Dt[Dt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Dt[Dt.NOT_FOUND=5]="NOT_FOUND",Dt[Dt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Dt[Dt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Dt[Dt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Dt[Dt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Dt[Dt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Dt[Dt.ABORTED=10]="ABORTED",Dt[Dt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Dt[Dt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Dt[Dt.INTERNAL=13]="INTERNAL",Dt[Dt.UNAVAILABLE=14]="UNAVAILABLE",Dt[Dt.DATA_LOSS=15]="DATA_LOSS";function f6(){return new TextEncoder}const m6=new Pi([4294967295,4294967295],0);function kN(n){const e=f6().encode(n),t=new i2;return t.update(e),new Uint8Array(t.digest())}function CN(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new Pi([t,i],0),new Pi([o,c],0)]}class ig{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Nu(`Invalid padding: ${t}`);if(i<0)throw new Nu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Nu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Nu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Pi.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(Pi.fromNumber(i)));return o.compare(m6)===1&&(o=new Pi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=kN(e),[i,o]=CN(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(i,o,c);if(!this.we(d))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new ig(c,o,t);return i.forEach((m=>d.insert(m))),d}insert(e){if(this.ge===0)return;const t=kN(e),[i,o]=CN(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(i,o,c);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Nu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class im{constructor(e,t,i,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,dd.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new im(ct.min(),o,new vs(At),Yr(),kt())}}class dd{constructor(e,t,i,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new dd(i,t,kt(),kt(),kt())}}class rf{constructor(e,t,i,o){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=o}}class G2{constructor(e,t){this.targetId=e,this.Ce=t}}class Y2{constructor(e,t,i=un.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class RN{constructor(){this.ve=0,this.Fe=IN(),this.Me=un.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=kt(),t=kt(),i=kt();return this.Fe.forEach(((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:rt(38017,{changeType:c})}})),new dd(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=IN()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,$t(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class p6{constructor(e){this.Ge=e,this.ze=new Map,this.je=Yr(),this.He=Uh(),this.Je=Uh(),this.Ze=new vs(At)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:rt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const c=o.target;if(rx(c))if(i===0){const d=new et(c.path);this.et(t,d,mn.newNoDocument(d,ct.min()))}else $t(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const m=this.ut(e),x=m?this.ct(m,e,d):1;if(x!==0){this.it(t);const g=x===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:c=0}=t;let d,m;try{d=Fi(i).toUint8Array()}catch(x){if(x instanceof b2)return Ho("Decoding the base64 bloom filter in existence filter failed ("+x.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw x}try{m=new ig(d,o,c)}catch(x){return Ho(x instanceof Nu?"BloomFilter error: ":"Applying bloom filter failed: ",x),null}return m.ge===0?null:m}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((c=>{const d=this.Ge.ht(),m=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(m)||(this.et(t,c,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((c,d)=>{const m=this.ot(d);if(m){if(c.current&&rx(m.target)){const x=new et(m.target.path);this.It(x).has(d)||this.Et(d,x)||this.et(d,x,mn.newNoDocument(x,e))}c.Be&&(t.set(d,c.ke()),c.Ke())}}));let i=kt();this.Je.forEach(((c,d)=>{let m=!0;d.forEachWhile((x=>{const g=this.ot(x);return!g||g.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(i=i.add(c))})),this.je.forEach(((c,d)=>d.setReadTime(e)));const o=new im(e,t,this.Ze,this.je,i);return this.je=Yr(),this.He=Uh(),this.Je=Uh(),this.Ze=new vs(At),o}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.qe(t,1):o.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new RN,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ws(At),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ws(At),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new RN),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Uh(){return new vs(et.comparator)}function IN(){return new vs(et.comparator)}const x6={asc:"ASCENDING",desc:"DESCENDING"},g6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},b6={and:"AND",or:"OR"};class y6{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ox(n,e){return n.useProto3Json||Zf(e)?e:{value:e}}function kf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function W2(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function v6(n,e){return kf(n,e.toTimestamp())}function lr(n){return $t(!!n,49232),ct.fromTimestamp((function(t){const i=zi(t);return new zt(i.seconds,i.nanos)})(n))}function lg(n,e){return cx(n,e).canonicalString()}function cx(n,e){const t=(function(o){return new rs(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function K2(n){const e=rs.fromString(n);return $t(e_(e),10190,{key:e.toString()}),e}function ux(n,e){return lg(n.databaseId,e.path)}function I0(n,e){const t=K2(e);if(t.get(1)!==n.databaseId.projectId)throw new Oe(we.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Oe(we.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new et(X2(t))}function Q2(n,e){return lg(n.databaseId,e)}function w6(n){const e=K2(n);return e.length===4?rs.emptyPath():X2(e)}function dx(n){return new rs(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function X2(n){return $t(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function DN(n,e,t){return{name:ux(n,e),fields:t.value.mapValue.fields}}function N6(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:rt(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=(function(g,b){return g.useProto3Json?($t(b===void 0||typeof b=="string",58123),un.fromBase64String(b||"")):($t(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),un.fromUint8Array(b||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,m=d&&(function(g){const b=g.code===void 0?we.UNKNOWN:H2(g.code);return new Oe(b,g.message||"")})(d);t=new Y2(i,o,c,m||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=I0(n,i.document.name),c=lr(i.document.updateTime),d=i.document.createTime?lr(i.document.createTime):ct.min(),m=new Dn({mapValue:{fields:i.document.fields}}),x=mn.newFoundDocument(o,c,d,m),g=i.targetIds||[],b=i.removedTargetIds||[];t=new rf(g,b,x.key,x)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=I0(n,i.document),c=i.readTime?lr(i.readTime):ct.min(),d=mn.newNoDocument(o,c),m=i.removedTargetIds||[];t=new rf([],m,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=I0(n,i.document),c=i.removedTargetIds||[];t=new rf([],c,o,null)}else{if(!("filter"in e))return rt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:c}=i,d=new d6(o,c),m=i.targetId;t=new G2(m,d)}}return t}function j6(n,e){let t;if(e instanceof ud)t={update:DN(n,e.key,e.value)};else if(e instanceof ag)t={delete:ux(n,e.key)};else if(e instanceof Wi)t={update:DN(n,e.key,e.data),updateMask:I6(e.fieldMask)};else{if(!(e instanceof o6))return rt(16599,{dt:e.type});t={verify:ux(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(c,d){const m=d.transform;if(m instanceof Wu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Ku)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Qu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof Af)return{fieldPath:d.field.canonicalString(),increment:m.Ae};throw rt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(o,c){return c.updateTime!==void 0?{updateTime:v6(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:rt(27497)})(n,e.precondition)),t}function _6(n,e){return n&&n.length>0?($t(e!==void 0,14353),n.map((t=>(function(o,c){let d=o.updateTime?lr(o.updateTime):lr(c);return d.isEqual(ct.min())&&(d=lr(c)),new r6(d,o.transformResults||[])})(t,e)))):[]}function S6(n,e){return{documents:[Q2(n,e.path)]}}function E6(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Q2(n,o);const c=(function(g){if(g.length!==0)return Z2(La.create(g,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const d=(function(g){if(g.length!==0)return g.map((b=>(function(_){return{field:Co(_.field),direction:k6(_.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const m=ox(n,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:o}}function T6(n){let e=w6(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){$t(i===1,65062);const b=t.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let c=[];t.where&&(c=(function(v){const _=J2(v);return _ instanceof La&&A2(_)?_.getFilters():[_]})(t.where));let d=[];t.orderBy&&(d=(function(v){return v.map((_=>(function(B){return new Tf(Ro(B.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(_)))})(t.orderBy));let m=null;t.limit&&(m=(function(v){let _;return _=typeof v=="object"?v.value:v,Zf(_)?null:_})(t.limit));let x=null;t.startAt&&(x=(function(v){const _=!!v.before,R=v.values||[];return new Ef(R,_)})(t.startAt));let g=null;return t.endAt&&(g=(function(v){const _=!v.before,R=v.values||[];return new Ef(R,_)})(t.endAt)),qR(e,o,d,c,m,"F",x,g)}function A6(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function J2(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ro(t.unaryFilter.field);return Hs.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=Ro(t.unaryFilter.field);return Hs.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Ro(t.unaryFilter.field);return Hs.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Ro(t.unaryFilter.field);return Hs.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return rt(61313);default:return rt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Hs.create(Ro(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return rt(58110);default:return rt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return La.create(t.compositeFilter.filters.map((i=>J2(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return rt(1026)}})(t.compositeFilter.op))})(n):rt(30097,{filter:n})}function k6(n){return x6[n]}function C6(n){return g6[n]}function R6(n){return b6[n]}function Co(n){return{fieldPath:n.canonicalString()}}function Ro(n){return on.fromServerFormat(n.fieldPath)}function Z2(n){return n instanceof Hs?(function(t){if(t.op==="=="){if(vN(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NAN"}};if(yN(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(vN(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NOT_NAN"}};if(yN(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Co(t.field),op:C6(t.op),value:t.value}}})(n):n instanceof La?(function(t){const i=t.getFilters().map((o=>Z2(o)));return i.length===1?i[0]:{compositeFilter:{op:R6(t.op),filters:i}}})(n):rt(54877,{filter:n})}function I6(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function e_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function t_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class Di{constructor(e,t,i,o,c=ct.min(),d=ct.min(),m=un.EMPTY_BYTE_STRING,x=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=m,this.expectedCount=x}withSequenceNumber(e){return new Di(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class D6{constructor(e){this.yt=e}}function M6(n){const e=T6({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?lx(e,e.limit,"L"):e}class O6{constructor(){this.Sn=new P6}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ne.resolve()}getCollectionParents(e,t){return Ne.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ne.resolve()}deleteFieldIndex(e,t){return Ne.resolve()}deleteAllFieldIndexes(e){return Ne.resolve()}createTargetIndexes(e,t){return Ne.resolve()}getDocumentsMatchingTarget(e,t){return Ne.resolve(null)}getIndexType(e,t){return Ne.resolve(0)}getFieldIndexes(e,t){return Ne.resolve([])}getNextCollectionGroupToUpdate(e){return Ne.resolve(null)}getMinOffset(e,t){return Ne.resolve(Bi.min())}getMinOffsetFromCollectionGroup(e,t){return Ne.resolve(Bi.min())}updateCollectionGroup(e,t,i){return Ne.resolve()}updateIndexEntries(e,t){return Ne.resolve()}}class P6{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new Ws(rs.comparator),c=!o.has(i);return this.index[t]=o.add(i),c}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new Ws(rs.comparator)).toArray()}}const MN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},s_=41943040;class In{static withCacheSize(e){return new In(e,In.DEFAULT_COLLECTION_PERCENTILE,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}In.DEFAULT_COLLECTION_PERCENTILE=10,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,In.DEFAULT=new In(s_,In.DEFAULT_COLLECTION_PERCENTILE,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),In.DISABLED=new In(-1,0,0);class Ko{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Ko(0)}static ar(){return new Ko(-1)}}const ON="LruGarbageCollector",V6=1048576;function PN([n,e],[t,i]){const o=At(n,t);return o===0?At(e,i):o}class L6{constructor(e){this.Pr=e,this.buffer=new Ws(PN),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();PN(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class U6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Pe(ON,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){uc(t)?Pe(ON,"Ignoring IndexedDB error during garbage collection: ",t):await cc(t)}await this.Ar(3e5)}))}}class B6{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ne.resolve(Jf.ce);const i=new L6(t);return this.Vr.forEachTarget(e,(o=>i.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>i.Er(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Pe("LruGarbageCollector","Garbage collection skipped; disabled"),Ne.resolve(MN)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),MN):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,o,c,d,m,x,g;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),o=this.params.maximumSequenceNumbersToCollect):o=v,d=Date.now(),this.nthSequenceNumber(e,o)))).next((v=>(i=v,m=Date.now(),this.removeTargets(e,i,t)))).next((v=>(c=v,x=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(g=Date.now(),Ao()<=Tt.DEBUG&&Pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${o} in `+(m-d)+`ms
	Removed ${c} targets in `+(x-m)+`ms
	Removed ${v} documents in `+(g-x)+`ms
Total Duration: ${g-b}ms`),Ne.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:v}))))}}function z6(n,e){return new B6(n,e)}class F6{constructor(){this.changes=new Ul((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,mn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ne.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class $6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class q6{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&Du(i.mutation,o,Zn.empty(),zt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,kt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=kt()){const o=El();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((c=>{let d=wu();return c.forEach(((m,x)=>{d=d.insert(m,x.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=El();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,kt())))}populateOverlays(e,t,i){const o=[];return i.forEach((c=>{t.has(c)||o.push(c)})),this.documentOverlayCache.getOverlays(e,o).next((c=>{c.forEach(((d,m)=>{t.set(d,m)}))}))}computeViews(e,t,i,o){let c=Yr();const d=Iu(),m=(function(){return Iu()})();return t.forEach(((x,g)=>{const b=i.get(g.key);o.has(g.key)&&(b===void 0||b.mutation instanceof Wi)?c=c.insert(g.key,g):b!==void 0?(d.set(g.key,b.mutation.getFieldMask()),Du(b.mutation,g,b.mutation.getFieldMask(),zt.now())):d.set(g.key,Zn.empty())})),this.recalculateAndSaveOverlays(e,c).next((x=>(x.forEach(((g,b)=>d.set(g,b))),t.forEach(((g,b)=>m.set(g,new $6(b,d.get(g)??null)))),m)))}recalculateAndSaveOverlays(e,t){const i=Iu();let o=new vs(((d,m)=>d-m)),c=kt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const m of d)m.keys().forEach((x=>{const g=t.get(x);if(g===null)return;let b=i.get(x)||Zn.empty();b=m.applyToLocalView(g,b),i.set(x,b);const v=(o.get(m.batchId)||kt()).add(x);o=o.insert(m.batchId,v)}))})).next((()=>{const d=[],m=o.getReverseIterator();for(;m.hasNext();){const x=m.getNext(),g=x.key,b=x.value,v=V2();b.forEach((_=>{if(!c.has(_)){const R=$2(t.get(_),i.get(_));R!==null&&v.set(_,R),c=c.add(_)}})),d.push(this.documentOverlayCache.saveOverlays(e,g,v))}return Ne.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return HR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):I2(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-c.size):Ne.resolve(El());let m=qu,x=c;return d.next((g=>Ne.forEach(g,((b,v)=>(m<v.largestBatchId&&(m=v.largestBatchId),c.get(b)?Ne.resolve():this.remoteDocumentCache.getEntry(e,b).next((_=>{x=x.insert(b,_)}))))).next((()=>this.populateOverlays(e,g,c))).next((()=>this.computeViews(e,x,g,kt()))).next((b=>({batchId:m,changes:P2(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new et(t)).next((i=>{let o=wu();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const c=t.collectionGroup;let d=wu();return this.indexManager.getCollectionParents(e,c).next((m=>Ne.forEach(m,(x=>{const g=(function(v,_){return new cd(_,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,x.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,i,o).next((b=>{b.forEach(((v,_)=>{d=d.insert(v,_)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,c,o)))).next((d=>{c.forEach(((x,g)=>{const b=g.getKey();d.get(b)===null&&(d=d.insert(b,mn.newInvalidDocument(b)))}));let m=wu();return d.forEach(((x,g)=>{const b=c.get(x);b!==void 0&&Du(b.mutation,g,Zn.empty(),zt.now()),nm(t,g)&&(m=m.insert(x,g))})),m}))}}class H6{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ne.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:lr(o.createTime)}})(t)),Ne.resolve()}getNamedQuery(e,t){return Ne.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(o){return{name:o.name,query:M6(o.bundledQuery),readTime:lr(o.readTime)}})(t)),Ne.resolve()}}class G6{constructor(){this.overlays=new vs(et.comparator),this.Lr=new Map}getOverlay(e,t){return Ne.resolve(this.overlays.get(t))}getOverlays(e,t){const i=El();return Ne.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&i.set(o,c)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,c)=>{this.bt(e,t,c)})),Ne.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.Lr.get(i);return o!==void 0&&(o.forEach((c=>this.overlays=this.overlays.remove(c))),this.Lr.delete(i)),Ne.resolve()}getOverlaysForCollection(e,t,i){const o=El(),c=t.length+1,d=new et(t.child("")),m=this.overlays.getIteratorFrom(d);for(;m.hasNext();){const x=m.getNext().value,g=x.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&x.largestBatchId>i&&o.set(x.getKey(),x)}return Ne.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let c=new vs(((g,b)=>g-b));const d=this.overlays.getIterator();for(;d.hasNext();){const g=d.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>i){let b=c.get(g.largestBatchId);b===null&&(b=El(),c=c.insert(g.largestBatchId,b)),b.set(g.getKey(),g)}}const m=El(),x=c.getIterator();for(;x.hasNext()&&(x.getNext().value.forEach(((g,b)=>m.set(g,b))),!(m.size()>=o)););return Ne.resolve(m)}bt(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const d=this.Lr.get(o.largestBatchId).delete(i.key);this.Lr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new u6(t,i));let c=this.Lr.get(t);c===void 0&&(c=kt(),this.Lr.set(t,c)),this.Lr.set(t,c.add(i.key))}}class Y6{constructor(){this.sessionToken=un.EMPTY_BYTE_STRING}getSessionToken(e){return Ne.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ne.resolve()}}class og{constructor(){this.kr=new Ws(Zs.Kr),this.qr=new Ws(Zs.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Zs(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Zs(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new et(new rs([])),i=new Zs(t,e),o=new Zs(t,e+1),c=[];return this.qr.forEachInRange([i,o],(d=>{this.Wr(d),c.push(d.key)})),c}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new et(new rs([])),i=new Zs(t,e),o=new Zs(t,e+1);let c=kt();return this.qr.forEachInRange([i,o],(d=>{c=c.add(d.key)})),c}containsKey(e){const t=new Zs(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Zs{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return et.comparator(e.key,t.key)||At(e.Hr,t.Hr)}static Ur(e,t){return At(e.Hr,t.Hr)||et.comparator(e.key,t.key)}}class W6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ws(Zs.Kr)}checkEmpty(e){return Ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const c=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new c6(c,t,i,o);this.mutationQueue.push(d);for(const m of o)this.Jr=this.Jr.add(new Zs(m.key,c)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return Ne.resolve(d)}lookupMutationBatch(e,t){return Ne.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.Xr(i),c=o<0?0:o;return Ne.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return Ne.resolve(this.mutationQueue.length===0?Jx:this.Yn-1)}getAllMutationBatches(e){return Ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Zs(t,0),o=new Zs(t,Number.POSITIVE_INFINITY),c=[];return this.Jr.forEachInRange([i,o],(d=>{const m=this.Zr(d.Hr);c.push(m)})),Ne.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ws(At);return t.forEach((o=>{const c=new Zs(o,0),d=new Zs(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([c,d],(m=>{i=i.add(m.Hr)}))})),Ne.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let c=i;et.isDocumentKey(c)||(c=c.child(""));const d=new Zs(new et(c),0);let m=new Ws(At);return this.Jr.forEachWhile((x=>{const g=x.key.path;return!!i.isPrefixOf(g)&&(g.length===o&&(m=m.add(x.Hr)),!0)}),d),Ne.resolve(this.Yr(m))}Yr(e){const t=[];return e.forEach((i=>{const o=this.Zr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){$t(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ne.forEach(t.mutations,(o=>{const c=new Zs(o.key,t.batchId);return i=i.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Zs(t,0),o=this.Jr.firstAfterOrEqual(i);return Ne.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ne.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class K6{constructor(e){this.ti=e,this.docs=(function(){return new vs(et.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),c=o?o.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ne.resolve(i?i.document.mutableCopy():mn.newInvalidDocument(t))}getEntries(e,t){let i=Yr();return t.forEach((o=>{const c=this.docs.get(o);i=i.insert(o,c?c.document.mutableCopy():mn.newInvalidDocument(o))})),Ne.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let c=Yr();const d=t.path,m=new et(d.child("__id-9223372036854775808__")),x=this.docs.getIteratorFrom(m);for(;x.hasNext();){const{key:g,value:{document:b}}=x.getNext();if(!d.isPrefixOf(g.path))break;g.path.length>d.length+1||wR(vR(b),i)<=0||(o.has(b.key)||nm(t,b))&&(c=c.insert(b.key,b.mutableCopy()))}return Ne.resolve(c)}getAllFromCollectionGroup(e,t,i,o){rt(9500)}ni(e,t){return Ne.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new Q6(this)}getSize(e){return Ne.resolve(this.size)}}class Q6 extends F6{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(i)})),Ne.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class X6{constructor(e){this.persistence=e,this.ri=new Ul((t=>tg(t)),sg),this.lastRemoteSnapshotVersion=ct.min(),this.highestTargetId=0,this.ii=0,this.si=new og,this.targetCount=0,this.oi=Ko._r()}forEachTarget(e,t){return this.ri.forEach(((i,o)=>t(o))),Ne.resolve()}getLastRemoteSnapshotVersion(e){return Ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ne.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ne.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ne.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Ko(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ne.resolve()}updateTargetData(e,t){return this.lr(t),Ne.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ne.resolve()}removeTargets(e,t,i){let o=0;const c=[];return this.ri.forEach(((d,m)=>{m.sequenceNumber<=t&&i.get(m.targetId)===null&&(this.ri.delete(d),c.push(this.removeMatchingKeysForTargetId(e,m.targetId)),o++)})),Ne.waitFor(c).next((()=>o))}getTargetCount(e){return Ne.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ne.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ne.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach((d=>{c.push(o.markPotentiallyOrphaned(e,d))})),Ne.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ne.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ne.resolve(i)}containsKey(e,t){return Ne.resolve(this.si.containsKey(t))}}class n_{constructor(e,t){this._i={},this.overlays={},this.ai=new Jf(0),this.ui=!1,this.ui=!0,this.ci=new Y6,this.referenceDelegate=e(this),this.li=new X6(this),this.indexManager=new O6,this.remoteDocumentCache=(function(o){return new K6(o)})((i=>this.referenceDelegate.hi(i))),this.serializer=new D6(t),this.Pi=new H6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new G6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new W6(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Pe("MemoryPersistence","Starting transaction:",e);const o=new J6(this.ai.next());return this.referenceDelegate.Ti(),i(o).next((c=>this.referenceDelegate.Ii(o).next((()=>c)))).toPromise().then((c=>(o.raiseOnCommittedEvent(),c)))}Ei(e,t){return Ne.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class J6 extends jR{constructor(e){super(),this.currentSequenceNumber=e}}class cg{constructor(e){this.persistence=e,this.Ri=new og,this.Ai=null}static Vi(e){return new cg(e)}get di(){if(this.Ai)return this.Ai;throw rt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ne.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ne.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ne.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((o=>this.di.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((c=>this.di.add(c.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ne.forEach(this.di,(i=>{const o=et.fromPath(i);return this.mi(e,o).next((c=>{c||t.removeEntry(o,ct.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ne.or([()=>Ne.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Cf{constructor(e,t){this.persistence=e,this.fi=new Ul((i=>ER(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=z6(this,t)}static Vi(e,t){return new Cf(e,t)}Ti(){}Ii(e){return Ne.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ne.forEach(this.fi,((i,o)=>this.wr(e,i,o).next((c=>c?Ne.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ni(e,(d=>this.wr(e,d,t).next((m=>{m||(i++,c.removeEntry(d,ct.min()))})))).next((()=>c.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=sf(e.data.value)),t}wr(e,t,i){return Ne.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.fi.get(t);return Ne.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ug{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=o}static Es(e,t){let i=kt(),o=kt();for(const c of t.docChanges)switch(c.type){case 0:i=i.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new ug(e,t.fromCache,i,o)}}class Z6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class e3{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return xA()?8:_R(gn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const c={result:null};return this.gs(e,t).next((d=>{c.result=d})).next((()=>{if(!c.result)return this.ps(e,t,o,i).next((d=>{c.result=d}))})).next((()=>{if(c.result)return;const d=new Z6;return this.ys(e,t,d).next((m=>{if(c.result=m,this.As)return this.ws(e,t,d,m.size)}))})).next((()=>c.result))}ws(e,t,i,o){return i.documentReadCount<this.Vs?(Ao()<=Tt.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",ko(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ne.resolve()):(Ao()<=Tt.DEBUG&&Pe("QueryEngine","Query:",ko(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.ds*o?(Ao()<=Tt.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",ko(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ir(t))):Ne.resolve())}gs(e,t){if(_N(t))return Ne.resolve(null);let i=ir(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=lx(t,null,"F"),i=ir(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((c=>{const d=kt(...c);return this.fs.getDocuments(e,d).next((m=>this.indexManager.getMinOffset(e,i).next((x=>{const g=this.bs(t,m);return this.Ss(t,g,d,x.readTime)?this.gs(e,lx(t,null,"F")):this.Ds(e,g,t,x)}))))})))))}ps(e,t,i,o){return _N(t)||o.isEqual(ct.min())?Ne.resolve(null):this.fs.getDocuments(e,i).next((c=>{const d=this.bs(t,c);return this.Ss(t,d,i,o)?Ne.resolve(null):(Ao()<=Tt.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),ko(t)),this.Ds(e,d,t,yR(o,qu)).next((m=>m)))}))}bs(e,t){let i=new Ws(M2(e));return t.forEach(((o,c)=>{nm(e,c)&&(i=i.add(c))})),i}Ss(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}ys(e,t,i){return Ao()<=Tt.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",ko(t)),this.fs.getDocumentsMatchingQuery(e,t,Bi.min(),i)}Ds(e,t,i,o){return this.fs.getDocumentsMatchingQuery(e,i,o).next((c=>(t.forEach((d=>{c=c.insert(d.key,d)})),c)))}}const dg="LocalStore",t3=3e8;class s3{constructor(e,t,i,o){this.persistence=e,this.Cs=t,this.serializer=o,this.vs=new vs(At),this.Fs=new Ul((c=>tg(c)),sg),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new q6(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function n3(n,e,t,i){return new s3(n,e,t,i)}async function a_(n,e){const t=ht(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((c=>(o=c,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((c=>{const d=[],m=[];let x=kt();for(const g of o){d.push(g.batchId);for(const b of g.mutations)x=x.add(b.key)}for(const g of c){m.push(g.batchId);for(const b of g.mutations)x=x.add(b.key)}return t.localDocuments.getDocuments(i,x).next((g=>({Ns:g,removedBatchIds:d,addedBatchIds:m})))}))}))}function a3(n,e){const t=ht(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),c=t.xs.newChangeBuffer({trackRemovals:!0});return(function(m,x,g,b){const v=g.batch,_=v.keys();let R=Ne.resolve();return _.forEach((B=>{R=R.next((()=>b.getEntry(x,B))).next((L=>{const O=g.docVersions.get(B);$t(O!==null,48541),L.version.compareTo(O)<0&&(v.applyToRemoteDocument(L,g),L.isValidDocument()&&(L.setReadTime(g.commitVersion),b.addEntry(L)))}))})),R.next((()=>m.mutationQueue.removeMutationBatch(x,v)))})(t,i,e,c).next((()=>c.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(m){let x=kt();for(let g=0;g<m.mutationResults.length;++g)m.mutationResults[g].transformResults.length>0&&(x=x.add(m.batch.mutations[g].key));return x})(e)))).next((()=>t.localDocuments.getDocuments(i,o)))}))}function r_(n){const e=ht(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function r3(n,e){const t=ht(n),i=e.snapshotVersion;let o=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});o=t.vs;const m=[];e.targetChanges.forEach(((b,v)=>{const _=o.get(v);if(!_)return;m.push(t.li.removeMatchingKeys(c,b.removedDocuments,v).next((()=>t.li.addMatchingKeys(c,b.addedDocuments,v))));let R=_.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(v)!==null?R=R.withResumeToken(un.EMPTY_BYTE_STRING,ct.min()).withLastLimboFreeSnapshotVersion(ct.min()):b.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(b.resumeToken,i)),o=o.insert(v,R),(function(L,O,z){return L.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=t3?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0})(_,R,b)&&m.push(t.li.updateTargetData(c,R))}));let x=Yr(),g=kt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(c,b))})),m.push(i3(c,d,e.documentUpdates).next((b=>{x=b.Bs,g=b.Ls}))),!i.isEqual(ct.min())){const b=t.li.getLastRemoteSnapshotVersion(c).next((v=>t.li.setTargetsMetadata(c,c.currentSequenceNumber,i)));m.push(b)}return Ne.waitFor(m).next((()=>d.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,x,g))).next((()=>x))})).then((c=>(t.vs=o,c)))}function i3(n,e,t){let i=kt(),o=kt();return t.forEach((c=>i=i.add(c))),e.getEntries(n,i).next((c=>{let d=Yr();return t.forEach(((m,x)=>{const g=c.get(m);x.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(m)),x.isNoDocument()&&x.version.isEqual(ct.min())?(e.removeEntry(m,x.readTime),d=d.insert(m,x)):!g.isValidDocument()||x.version.compareTo(g.version)>0||x.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(x),d=d.insert(m,x)):Pe(dg,"Ignoring outdated watch update for ",m,". Current version:",g.version," Watch version:",x.version)})),{Bs:d,Ls:o}}))}function l3(n,e){const t=ht(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Jx),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function o3(n,e){const t=ht(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.li.getTargetData(i,e).next((c=>c?(o=c,Ne.resolve(o)):t.li.allocateTargetId(i).next((d=>(o=new Di(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.vs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function hx(n,e,t){const i=ht(n),o=i.vs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",c,(d=>i.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!uc(d))throw d;Pe(dg,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(o.target)}function VN(n,e,t){const i=ht(n);let o=ct.min(),c=kt();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(x,g,b){const v=ht(x),_=v.Fs.get(b);return _!==void 0?Ne.resolve(v.vs.get(_)):v.li.getTargetData(g,b)})(i,d,ir(e)).next((m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,m.targetId).next((x=>{c=x}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?o:ct.min(),t?c:kt()))).next((m=>(c3(i,YR(e),m),{documents:m,ks:c})))))}function c3(n,e,t){let i=n.Ms.get(e)||ct.min();t.forEach(((o,c)=>{c.readTime.compareTo(i)>0&&(i=c.readTime)})),n.Ms.set(e,i)}class LN{constructor(){this.activeTargetIds=ZR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class u3{constructor(){this.vo=new LN,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new LN,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class d3{Mo(e){}shutdown(){}}const UN="ConnectivityMonitor";class BN{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Pe(UN,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Pe(UN,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Bh=null;function fx(){return Bh===null?Bh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Bh++,"0x"+Bh.toString(16)}const D0="RestConnection",h3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class f3{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${o}`,this.$o=this.databaseId.database===_f?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Wo(e,t,i,o,c){const d=fx(),m=this.Qo(e,t.toUriEncodedString());Pe(D0,`Sending RPC '${e}' ${d}:`,m,i);const x={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(x,o,c);const{host:g}=new URL(m),b=fr(g);return this.zo(e,m,x,i,b).then((v=>(Pe(D0,`Received RPC '${e}' ${d}: `,v),v)),(v=>{throw Ho(D0,`RPC '${e}' ${d} failed with error: `,v,"url: ",m,"request:",i),v}))}jo(e,t,i,o,c,d){return this.Wo(e,t,i,o,c)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+oc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,c)=>e[c]=o)),i&&i.headers.forEach(((o,c)=>e[c]=o))}Qo(e,t){const i=h3[e];let o=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class m3{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const hn="WebChannelConnection",uu=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(o){setTimeout((()=>{throw o}),0)}}))};class Lo extends f3{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Lo.c_){const e=u2();uu(e,c2.STAT_EVENT,(t=>{t.stat===ex.PROXY?Pe(hn,"STAT_EVENT: detected buffering proxy"):t.stat===ex.NOPROXY&&Pe(hn,"STAT_EVENT: detected no buffering proxy")})),Lo.c_=!0}}zo(e,t,i,o,c){const d=fx();return new Promise(((m,x)=>{const g=new l2;g.setWithCredentials(!0),g.listenOnce(o2.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case tf.NO_ERROR:const v=g.getResponseJson();Pe(hn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(v)),m(v);break;case tf.TIMEOUT:Pe(hn,`RPC '${e}' ${d} timed out`),x(new Oe(we.DEADLINE_EXCEEDED,"Request time out"));break;case tf.HTTP_ERROR:const _=g.getStatus();if(Pe(hn,`RPC '${e}' ${d} failed with status:`,_,"response text:",g.getResponseText()),_>0){let R=g.getResponseJson();Array.isArray(R)&&(R=R[0]);const B=R?.error;if(B&&B.status&&B.message){const L=(function(z){const G=z.toLowerCase().replace(/_/g,"-");return Object.values(we).indexOf(G)>=0?G:we.UNKNOWN})(B.status);x(new Oe(L,B.message))}else x(new Oe(we.UNKNOWN,"Server responded with status "+g.getStatus()))}else x(new Oe(we.UNAVAILABLE,"Connection failed."));break;default:rt(9055,{l_:e,streamId:d,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Pe(hn,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(o);Pe(hn,`RPC '${e}' ${d} sending request:`,o),g.send(t,"POST",b,i,15)}))}T_(e,t,i){const o=fx(),c=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},x=this.longPollingOptions.timeoutSeconds;x!==void 0&&(m.longPollingTimeout=Math.round(1e3*x)),this.useFetchStreams&&(m.useFetchStreams=!0),this.Go(m.initMessageHeaders,t,i),m.encodeInitMessageHeaders=!0;const g=c.join("");Pe(hn,`Creating RPC '${e}' stream ${o}: ${g}`,m);const b=d.createWebChannel(g,m);this.I_(b);let v=!1,_=!1;const R=new m3({Ho:B=>{_?Pe(hn,`Not sending because RPC '${e}' stream ${o} is closed:`,B):(v||(Pe(hn,`Opening RPC '${e}' stream ${o} transport.`),b.open(),v=!0),Pe(hn,`RPC '${e}' stream ${o} sending:`,B),b.send(B))},Jo:()=>b.close()});return uu(b,vu.EventType.OPEN,(()=>{_||(Pe(hn,`RPC '${e}' stream ${o} transport opened.`),R.i_())})),uu(b,vu.EventType.CLOSE,(()=>{_||(_=!0,Pe(hn,`RPC '${e}' stream ${o} transport closed`),R.o_(),this.E_(b))})),uu(b,vu.EventType.ERROR,(B=>{_||(_=!0,Ho(hn,`RPC '${e}' stream ${o} transport errored. Name:`,B.name,"Message:",B.message),R.o_(new Oe(we.UNAVAILABLE,"The operation could not be completed")))})),uu(b,vu.EventType.MESSAGE,(B=>{if(!_){const L=B.data[0];$t(!!L,16349);const O=L,z=O?.error||O[0]?.error;if(z){Pe(hn,`RPC '${e}' stream ${o} received error:`,z);const G=z.status;let H=(function(Y){const T=$s[Y];if(T!==void 0)return H2(T)})(G),ae=z.message;H===void 0&&(H=we.INTERNAL,ae="Unknown error status: "+G+" with message "+z.message),_=!0,R.o_(new Oe(H,ae)),b.close()}else Pe(hn,`RPC '${e}' stream ${o} received:`,L),R.__(L)}})),Lo.u_(),setTimeout((()=>{R.s_()}),0),R}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return d2()}}function p3(n){return new Lo(n)}function M0(){return typeof document<"u"?document:null}function lm(n){return new y6(n,!0)}Lo.c_=!1;class i_{constructor(e,t,i=1e3,o=1.5,c=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=o,this.V_=c,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&Pe("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const zN="PersistentStream";class l_{constructor(e,t,i,o,c,d,m,x){this.Ci=e,this.b_=i,this.S_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=m,this.listener=x,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new i_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===we.RESOURCE_EXHAUSTED?(Gr(t.toString()),Gr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===we.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new Oe(we.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Pe(zN,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Pe(zN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class x3 extends l_{constructor(e,t,i,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=N6(this.serializer,e),i=(function(c){if(!("targetChange"in c))return ct.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?ct.min():d.readTime?lr(d.readTime):ct.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=dx(this.serializer),t.addTarget=(function(c,d){let m;const x=d.target;if(m=rx(x)?{documents:S6(c,x)}:{query:E6(c,x).ft},m.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){m.resumeToken=W2(c,d.resumeToken);const g=ox(c,d.expectedCount);g!==null&&(m.expectedCount=g)}else if(d.snapshotVersion.compareTo(ct.min())>0){m.readTime=kf(c,d.snapshotVersion.toTimestamp());const g=ox(c,d.expectedCount);g!==null&&(m.expectedCount=g)}return m})(this.serializer,e);const i=A6(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=dx(this.serializer),t.removeTarget=e,this.K_(t)}}class g3 extends l_{constructor(e,t,i,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return $t(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$t(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){$t(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=_6(e.writeResults,e.commitTime),i=lr(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=dx(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>j6(this.serializer,i)))};this.K_(t)}}class b3{}class y3 extends b3{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Oe(we.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Wo(e,cx(t,i),o,c,d))).catch((c=>{throw c.name==="FirebaseError"?(c.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Oe(we.UNKNOWN,c.toString())}))}jo(e,t,i,o,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,m])=>this.connection.jo(e,cx(t,i),o,d,m,c))).catch((d=>{throw d.name==="FirebaseError"?(d.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Oe(we.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function v3(n,e,t,i){return new y3(n,e,t,i)}class w3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Gr(t),this.aa=!1):Pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ol="RemoteStore";class N3{constructor(e,t,i,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=c,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{Bl(this)&&(Pe(Ol,"Restarting streams for network reachability change."),await(async function(x){const g=ht(x);g.Ea.add(4),await hd(g),g.Va.set("Unknown"),g.Ea.delete(4),await om(g)})(this))}))})),this.Va=new w3(i,o)}}async function om(n){if(Bl(n))for(const e of n.Ra)await e(!0)}async function hd(n){for(const e of n.Ra)await e(!1)}function o_(n,e){const t=ht(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),pg(t)?mg(t):dc(t).O_()&&fg(t,e))}function hg(n,e){const t=ht(n),i=dc(t);t.Ia.delete(e),i.O_()&&c_(t,e),t.Ia.size===0&&(i.O_()?i.L_():Bl(t)&&t.Va.set("Unknown"))}function fg(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ct.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}dc(n).Z_(e)}function c_(n,e){n.da.$e(e),dc(n).X_(e)}function mg(n){n.da=new p6({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),dc(n).start(),n.Va.ua()}function pg(n){return Bl(n)&&!dc(n).x_()&&n.Ia.size>0}function Bl(n){return ht(n).Ea.size===0}function u_(n){n.da=void 0}async function j3(n){n.Va.set("Online")}async function _3(n){n.Ia.forEach(((e,t)=>{fg(n,e)}))}async function S3(n,e){u_(n),pg(n)?(n.Va.ha(e),mg(n)):n.Va.set("Unknown")}async function E3(n,e,t){if(n.Va.set("Online"),e instanceof Y2&&e.state===2&&e.cause)try{await(async function(o,c){const d=c.cause;for(const m of c.targetIds)o.Ia.has(m)&&(await o.remoteSyncer.rejectListen(m,d),o.Ia.delete(m),o.da.removeTarget(m))})(n,e)}catch(i){Pe(Ol,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Rf(n,i)}else if(e instanceof rf?n.da.Xe(e):e instanceof G2?n.da.st(e):n.da.tt(e),!t.isEqual(ct.min()))try{const i=await r_(n.localStore);t.compareTo(i)>=0&&await(function(c,d){const m=c.da.Tt(d);return m.targetChanges.forEach(((x,g)=>{if(x.resumeToken.approximateByteSize()>0){const b=c.Ia.get(g);b&&c.Ia.set(g,b.withResumeToken(x.resumeToken,d))}})),m.targetMismatches.forEach(((x,g)=>{const b=c.Ia.get(x);if(!b)return;c.Ia.set(x,b.withResumeToken(un.EMPTY_BYTE_STRING,b.snapshotVersion)),c_(c,x);const v=new Di(b.target,x,g,b.sequenceNumber);fg(c,v)})),c.remoteSyncer.applyRemoteEvent(m)})(n,t)}catch(i){Pe(Ol,"Failed to raise snapshot:",i),await Rf(n,i)}}async function Rf(n,e,t){if(!uc(e))throw e;n.Ea.add(1),await hd(n),n.Va.set("Offline"),t||(t=()=>r_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Pe(Ol,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await om(n)}))}function d_(n,e){return e().catch((t=>Rf(n,t,e)))}async function cm(n){const e=ht(n),t=qi(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Jx;for(;T3(e);)try{const o=await l3(e.localStore,i);if(o===null){e.Ta.length===0&&t.L_();break}i=o.batchId,A3(e,o)}catch(o){await Rf(e,o)}h_(e)&&f_(e)}function T3(n){return Bl(n)&&n.Ta.length<10}function A3(n,e){n.Ta.push(e);const t=qi(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function h_(n){return Bl(n)&&!qi(n).x_()&&n.Ta.length>0}function f_(n){qi(n).start()}async function k3(n){qi(n).ra()}async function C3(n){const e=qi(n);for(const t of n.Ta)e.ea(t.mutations)}async function R3(n,e,t){const i=n.Ta.shift(),o=rg.from(i,e,t);await d_(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await cm(n)}async function I3(n,e){e&&qi(n).Y_&&await(async function(i,o){if((function(d){return h6(d)&&d!==we.ABORTED})(o.code)){const c=i.Ta.shift();qi(i).B_(),await d_(i,(()=>i.remoteSyncer.rejectFailedWrite(c.batchId,o))),await cm(i)}})(n,e),h_(n)&&f_(n)}async function FN(n,e){const t=ht(n);t.asyncQueue.verifyOperationInProgress(),Pe(Ol,"RemoteStore received new credentials");const i=Bl(t);t.Ea.add(3),await hd(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await om(t)}async function D3(n,e){const t=ht(n);e?(t.Ea.delete(2),await om(t)):e||(t.Ea.add(2),await hd(t),t.Va.set("Unknown"))}function dc(n){return n.ma||(n.ma=(function(t,i,o){const c=ht(t);return c.sa(),new x3(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:j3.bind(null,n),Yo:_3.bind(null,n),t_:S3.bind(null,n),J_:E3.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),pg(n)?mg(n):n.Va.set("Unknown")):(await n.ma.stop(),u_(n))}))),n.ma}function qi(n){return n.fa||(n.fa=(function(t,i,o){const c=ht(t);return c.sa(),new g3(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:k3.bind(null,n),t_:I3.bind(null,n),ta:C3.bind(null,n),na:R3.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await cm(n)):(await n.fa.stop(),n.Ta.length>0&&(Pe(Ol,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class xg{constructor(e,t,i,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=c,this.deferred=new Br,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,c){const d=Date.now()+i,m=new xg(e,t,d,o,c);return m.start(i),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Oe(we.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gg(n,e){if(Gr("AsyncQueue",`${e}: ${n}`),uc(n))return new Oe(we.UNAVAILABLE,`${e}: ${n}`);throw n}class Uo{static emptySet(e){return new Uo(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||et.comparator(t.key,i.key):(t,i)=>et.comparator(t.key,i.key),this.keyedMap=wu(),this.sortedSet=new vs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Uo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Uo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class $N{constructor(){this.ga=new vs(et.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):rt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Qo{constructor(e,t,i,o,c,d,m,x,g){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=m,this.excludesMetadataChanges=x,this.hasCachedResults=g}static fromInitialDocuments(e,t,i,o,c){const d=[];return t.forEach((m=>{d.push({type:0,doc:m})})),new Qo(e,t,Uo.emptySet(t),d,i,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}class M3{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class O3{constructor(){this.queries=qN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=ht(t),c=o.queries;o.queries=qN(),c.forEach(((d,m)=>{for(const x of m.ba)x.onError(i)}))})(this,new Oe(we.ABORTED,"Firestore shutting down"))}}function qN(){return new Ul((n=>D2(n)),sm)}async function bg(n,e){const t=ht(n);let i=3;const o=e.query;let c=t.queries.get(o);c?!c.Sa()&&e.Da()&&(i=2):(c=new M3,i=e.Da()?0:1);try{switch(i){case 0:c.wa=await t.onListen(o,!0);break;case 1:c.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const m=gg(d,`Initialization of query '${ko(e.query)}' failed`);return void e.onError(m)}t.queries.set(o,c),c.ba.push(e),e.va(t.onlineState),c.wa&&e.Fa(c.wa)&&vg(t)}async function yg(n,e){const t=ht(n),i=e.query;let o=3;const c=t.queries.get(i);if(c){const d=c.ba.indexOf(e);d>=0&&(c.ba.splice(d,1),c.ba.length===0?o=e.Da()?0:1:!c.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function P3(n,e){const t=ht(n);let i=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const m of d.ba)m.Fa(o)&&(i=!0);d.wa=o}}i&&vg(t)}function V3(n,e,t){const i=ht(n),o=i.queries.get(e);if(o)for(const c of o.ba)c.onError(t);i.queries.delete(e)}function vg(n){n.Ca.forEach((e=>{e.next()}))}var mx,HN;(HN=mx||(mx={})).Ma="default",HN.Cache="cache";class wg{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new Qo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Qo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==mx.Cache}}class m_{constructor(e){this.key=e}}class p_{constructor(e){this.key=e}}class L3{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=kt(),this.mutatedKeys=kt(),this.eu=M2(e),this.tu=new Uo(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new $N,o=t?t.tu:this.tu;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,m=!1;const x=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,v)=>{const _=o.get(b),R=nm(this.query,v)?v:null,B=!!_&&this.mutatedKeys.has(_.key),L=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let O=!1;_&&R?_.data.isEqual(R.data)?B!==L&&(i.track({type:3,doc:R}),O=!0):this.su(_,R)||(i.track({type:2,doc:R}),O=!0,(x&&this.eu(R,x)>0||g&&this.eu(R,g)<0)&&(m=!0)):!_&&R?(i.track({type:0,doc:R}),O=!0):_&&!R&&(i.track({type:1,doc:_}),O=!0,(x||g)&&(m=!0)),O&&(R?(d=d.add(R),c=L?c.add(b):c.delete(b)):(d=d.delete(b),c=c.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),c=c.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:m,mutatedKeys:c}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,v)=>(function(R,B){const L=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt(20277,{Vt:O})}};return L(R)-L(B)})(b.type,v.type)||this.eu(b.doc,v.doc))),this.ou(i),o=o??!1;const m=t&&!o?this._u():[],x=this.Ya.size===0&&this.current&&!o?1:0,g=x!==this.Xa;return this.Xa=x,d.length!==0||g?{snapshot:new Qo(this.query,e.tu,c,d,e.mutatedKeys,x===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new $N,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=kt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new p_(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new m_(i))})),t}cu(e){this.Za=e.ks,this.Ya=kt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Qo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Ng="SyncEngine";class U3{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class B3{constructor(e){this.key=e,this.hu=!1}}class z3{constructor(e,t,i,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Ul((m=>D2(m)),sm),this.Iu=new Map,this.Eu=new Set,this.Ru=new vs(et.comparator),this.Au=new Map,this.Vu=new og,this.du={},this.mu=new Map,this.fu=Ko.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function F3(n,e,t=!0){const i=w_(n);let o;const c=i.Tu.get(e);return c?(i.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.lu()):o=await x_(i,e,t,!0),o}async function $3(n,e){const t=w_(n);await x_(t,e,!0,!1)}async function x_(n,e,t,i){const o=await o3(n.localStore,ir(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let m;return i&&(m=await q3(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&o_(n.remoteStore,o),m}async function q3(n,e,t,i,o){n.pu=(v,_,R)=>(async function(L,O,z,G){let H=O.view.ru(z);H.Ss&&(H=await VN(L.localStore,O.query,!1).then((({documents:T})=>O.view.ru(T,H))));const ae=G&&G.targetChanges.get(O.targetId),ue=G&&G.targetMismatches.get(O.targetId)!=null,Y=O.view.applyChanges(H,L.isPrimaryClient,ae,ue);return YN(L,O.targetId,Y.au),Y.snapshot})(n,v,_,R);const c=await VN(n.localStore,e,!0),d=new L3(e,c.ks),m=d.ru(c.documents),x=dd.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),g=d.applyChanges(m,n.isPrimaryClient,x);YN(n,t,g.au);const b=new U3(e,t,d);return n.Tu.set(e,b),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),g.snapshot}async function H3(n,e,t){const i=ht(n),o=i.Tu.get(e),c=i.Iu.get(o.targetId);if(c.length>1)return i.Iu.set(o.targetId,c.filter((d=>!sm(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await hx(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&hg(i.remoteStore,o.targetId),px(i,o.targetId)})).catch(cc)):(px(i,o.targetId),await hx(i.localStore,o.targetId,!0))}async function G3(n,e){const t=ht(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),hg(t.remoteStore,i.targetId))}async function Y3(n,e,t){const i=eI(n);try{const o=await(function(d,m){const x=ht(d),g=zt.now(),b=m.reduce(((R,B)=>R.add(B.key)),kt());let v,_;return x.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let B=Yr(),L=kt();return x.xs.getEntries(R,b).next((O=>{B=O,B.forEach(((z,G)=>{G.isValidDocument()||(L=L.add(z))}))})).next((()=>x.localDocuments.getOverlayedDocuments(R,B))).next((O=>{v=O;const z=[];for(const G of m){const H=l6(G,v.get(G.key).overlayedDocument);H!=null&&z.push(new Wi(G.key,H,S2(H.value.mapValue),Na.exists(!0)))}return x.mutationQueue.addMutationBatch(R,g,z,m)})).next((O=>{_=O;const z=O.applyToLocalDocumentSet(v,L);return x.documentOverlayCache.saveOverlays(R,O.batchId,z)}))})).then((()=>({batchId:_.batchId,changes:P2(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(d,m,x){let g=d.du[d.currentUser.toKey()];g||(g=new vs(At)),g=g.insert(m,x),d.du[d.currentUser.toKey()]=g})(i,o.batchId,t),await fd(i,o.changes),await cm(i.remoteStore)}catch(o){const c=gg(o,"Failed to persist write");t.reject(c)}}async function g_(n,e){const t=ht(n);try{const i=await r3(t.localStore,e);e.targetChanges.forEach(((o,c)=>{const d=t.Au.get(c);d&&($t(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?$t(d.hu,14607):o.removedDocuments.size>0&&($t(d.hu,42227),d.hu=!1))})),await fd(t,i,e)}catch(i){await cc(i)}}function GN(n,e,t){const i=ht(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((c,d)=>{const m=d.view.va(e);m.snapshot&&o.push(m.snapshot)})),(function(d,m){const x=ht(d);x.onlineState=m;let g=!1;x.queries.forEach(((b,v)=>{for(const _ of v.ba)_.va(m)&&(g=!0)})),g&&vg(x)})(i.eventManager,e),o.length&&i.Pu.J_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function W3(n,e,t){const i=ht(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),c=o&&o.key;if(c){let d=new vs(et.comparator);d=d.insert(c,mn.newNoDocument(c,ct.min()));const m=kt().add(c),x=new im(ct.min(),new Map,new vs(At),d,m);await g_(i,x),i.Ru=i.Ru.remove(c),i.Au.delete(e),jg(i)}else await hx(i.localStore,e,!1).then((()=>px(i,e,t))).catch(cc)}async function K3(n,e){const t=ht(n),i=e.batch.batchId;try{const o=await a3(t.localStore,e);y_(t,i,null),b_(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await fd(t,o)}catch(o){await cc(o)}}async function Q3(n,e,t){const i=ht(n);try{const o=await(function(d,m){const x=ht(d);return x.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let b;return x.mutationQueue.lookupMutationBatch(g,m).next((v=>($t(v!==null,37113),b=v.keys(),x.mutationQueue.removeMutationBatch(g,v)))).next((()=>x.mutationQueue.performConsistencyCheck(g))).next((()=>x.documentOverlayCache.removeOverlaysForBatchId(g,b,m))).next((()=>x.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,b))).next((()=>x.localDocuments.getDocuments(g,b)))}))})(i.localStore,e);y_(i,e,t),b_(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await fd(i,o)}catch(o){await cc(o)}}function b_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function y_(n,e,t){const i=ht(n);let o=i.du[i.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),i.du[i.currentUser.toKey()]=o}}function px(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||v_(n,i)}))}function v_(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(hg(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),jg(n))}function YN(n,e,t){for(const i of t)i instanceof m_?(n.Vu.addReference(i.key,e),X3(n,i)):i instanceof p_?(Pe(Ng,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||v_(n,i.key)):rt(19791,{wu:i})}function X3(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(Pe(Ng,"New document in limbo: "+t),n.Eu.add(i),jg(n))}function jg(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new et(rs.fromString(e)),i=n.fu.next();n.Au.set(i,new B3(t)),n.Ru=n.Ru.insert(t,i),o_(n.remoteStore,new Di(ir(tm(t.path)),i,"TargetPurposeLimboResolution",Jf.ce))}}async function fd(n,e,t){const i=ht(n),o=[],c=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((m,x)=>{d.push(i.pu(x,e,t).then((g=>{if((g||t)&&i.isPrimaryClient){const b=g?!g.fromCache:t?.targetChanges.get(x.targetId)?.current;i.sharedClientState.updateQueryState(x.targetId,b?"current":"not-current")}if(g){o.push(g);const b=ug.Es(x.targetId,g);c.push(b)}})))})),await Promise.all(d),i.Pu.J_(o),await(async function(x,g){const b=ht(x);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>Ne.forEach(g,(_=>Ne.forEach(_.Ts,(R=>b.persistence.referenceDelegate.addReference(v,_.targetId,R))).next((()=>Ne.forEach(_.Is,(R=>b.persistence.referenceDelegate.removeReference(v,_.targetId,R)))))))))}catch(v){if(!uc(v))throw v;Pe(dg,"Failed to update sequence numbers: "+v)}for(const v of g){const _=v.targetId;if(!v.fromCache){const R=b.vs.get(_),B=R.snapshotVersion,L=R.withLastLimboFreeSnapshotVersion(B);b.vs=b.vs.insert(_,L)}}})(i.localStore,c))}async function J3(n,e){const t=ht(n);if(!t.currentUser.isEqual(e)){Pe(Ng,"User change. New user:",e.toKey());const i=await a_(t.localStore,e);t.currentUser=e,(function(c,d){c.mu.forEach((m=>{m.forEach((x=>{x.reject(new Oe(we.CANCELLED,d))}))})),c.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await fd(t,i.Ns)}}function Z3(n,e){const t=ht(n),i=t.Au.get(e);if(i&&i.hu)return kt().add(i.key);{let o=kt();const c=t.Iu.get(e);if(!c)return o;for(const d of c){const m=t.Tu.get(d);o=o.unionWith(m.view.nu)}return o}}function w_(n){const e=ht(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=g_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Z3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=W3.bind(null,e),e.Pu.J_=P3.bind(null,e.eventManager),e.Pu.yu=V3.bind(null,e.eventManager),e}function eI(n){const e=ht(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=K3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Q3.bind(null,e),e}class If{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return n3(this.persistence,new e3,e.initialUser,this.serializer)}Cu(e){return new n_(cg.Vi,this.serializer)}Du(e){return new u3}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}If.provider={build:()=>new If};class tI extends If{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){$t(this.persistence.referenceDelegate instanceof Cf,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new U6(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?In.withCacheSize(this.cacheSizeBytes):In.DEFAULT;return new n_((i=>Cf.Vi(i,t)),this.serializer)}}class xx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>GN(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=J3.bind(null,this.syncEngine),await D3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new O3})()}createDatastore(e){const t=lm(e.databaseInfo.databaseId),i=p3(e.databaseInfo);return v3(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,c,d,m){return new N3(i,o,c,d,m)})(this.localStore,this.datastore,e.asyncQueue,(t=>GN(this.syncEngine,t,0)),(function(){return BN.v()?new BN:new d3})())}createSyncEngine(e,t){return(function(o,c,d,m,x,g,b){const v=new z3(o,c,d,m,x,g);return b&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=ht(t);Pe(Ol,"RemoteStore shutting down."),i.Ea.add(5),await hd(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}xx.provider={build:()=>new xx};class _g{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Gr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Hi="FirestoreClient";class sI{constructor(e,t,i,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=o,this.user=fn.UNAUTHENTICATED,this.clientId=Xx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(i,(async d=>{Pe(Hi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Pe(Hi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Br;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=gg(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function O0(n,e){n.asyncQueue.verifyOperationInProgress(),Pe(Hi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await a_(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function WN(n,e){n.asyncQueue.verifyOperationInProgress();const t=await nI(n);Pe(Hi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>FN(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>FN(e.remoteStore,o))),n._onlineComponents=e}async function nI(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Pe(Hi,"Using user provided OfflineComponentProvider");try{await O0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===we.FAILED_PRECONDITION||o.code===we.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Ho("Error using user provided cache. Falling back to memory cache: "+t),await O0(n,new If)}}else Pe(Hi,"Using default OfflineComponentProvider"),await O0(n,new tI(void 0));return n._offlineComponents}async function N_(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Pe(Hi,"Using user provided OnlineComponentProvider"),await WN(n,n._uninitializedComponentsProvider._online)):(Pe(Hi,"Using default OnlineComponentProvider"),await WN(n,new xx))),n._onlineComponents}function aI(n){return N_(n).then((e=>e.syncEngine))}async function Df(n){const e=await N_(n),t=e.eventManager;return t.onListen=F3.bind(null,e.syncEngine),t.onUnlisten=H3.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=$3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=G3.bind(null,e.syncEngine),t}function rI(n,e,t,i){const o=new _g(i),c=new wg(e,o,t);return n.asyncQueue.enqueueAndForget((async()=>bg(await Df(n),c))),()=>{o.Nu(),n.asyncQueue.enqueueAndForget((async()=>yg(await Df(n),c)))}}function iI(n,e,t={}){const i=new Br;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,m,x,g){const b=new _g({next:_=>{b.Nu(),d.enqueueAndForget((()=>yg(c,v)));const R=_.docs.has(m);!R&&_.fromCache?g.reject(new Oe(we.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&_.fromCache&&x&&x.source==="server"?g.reject(new Oe(we.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(_)},error:_=>g.reject(_)}),v=new wg(tm(m.path),b,{includeMetadataChanges:!0,Ka:!0});return bg(c,v)})(await Df(n),n.asyncQueue,e,t,i))),i.promise}function lI(n,e,t={}){const i=new Br;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,m,x,g){const b=new _g({next:_=>{b.Nu(),d.enqueueAndForget((()=>yg(c,v))),_.fromCache&&x.source==="server"?g.reject(new Oe(we.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(_)},error:_=>g.reject(_)}),v=new wg(m,b,{includeMetadataChanges:!0,Ka:!0});return bg(c,v)})(await Df(n),n.asyncQueue,e,t,i))),i.promise}function oI(n,e){const t=new Br;return n.asyncQueue.enqueueAndForget((async()=>Y3(await aI(n),e,t))),t.promise}function j_(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const cI="ComponentProvider",KN=new Map;function uI(n,e,t,i,o){return new kR(n,e,t,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,j_(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,i)}const __="firestore.googleapis.com",QN=!0;class XN{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Oe(we.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=__,this.ssl=QN}else this.host=e.host,this.ssl=e.ssl??QN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=s_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<V6)throw new Oe(we.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}bR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=j_(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Oe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Oe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Oe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class um{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new XN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Oe(we.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Oe(we.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new XN(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new oR;switch(i.type){case"firstParty":return new hR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Oe(we.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=KN.get(t);i&&(Pe(cI,"Removing Datastore"),KN.delete(t),i.terminate())})(this),Promise.resolve()}}function dI(n,e,t,i={}){n=Ln(n,um);const o=fr(e),c=n._getSettings(),d={...c,emulatorOptions:n._getEmulatorOptions()},m=`${e}:${t}`;o&&(Hf(`https://${m}`),Gf("Firestore",!0)),c.host!==__&&c.host!==m&&Ho("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const x={...c,host:m,ssl:o,emulatorOptions:i};if(!Rl(x,d)&&(n._setSettings(x),i.mockUserToken)){let g,b;if(typeof i.mockUserToken=="string")g=i.mockUserToken,b=fn.MOCK_USER;else{g=xj(i.mockUserToken,n._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new Oe(we.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new fn(v)}n._authCredentials=new cR(new f2(g,b))}}class zl{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new zl(this.firestore,e,this._query)}}class Ts{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ts(this.firestore,e,this._key)}toJSON(){return{type:Ts._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(od(t,Ts._jsonSchema))return new Ts(e,i||null,new et(rs.fromString(t.referencePath)))}}Ts._jsonSchemaVersion="firestore/documentReference/1.0",Ts._jsonSchema={type:Gs("string",Ts._jsonSchemaVersion),referencePath:Gs("string")};class Vi extends zl{constructor(e,t,i){super(e,t,tm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ts(this.firestore,null,new et(e))}withConverter(e){return new Vi(this.firestore,e,this._path)}}function Ye(n,e,...t){if(n=Zt(n),m2("collection","path",e),n instanceof um){const i=rs.fromString(e,...t);return uN(i),new Vi(n,null,i)}{if(!(n instanceof Ts||n instanceof Vi))throw new Oe(we.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(rs.fromString(e,...t));return uN(i),new Vi(n.firestore,null,i)}}function Me(n,e,...t){if(n=Zt(n),arguments.length===1&&(e=Xx.newId()),m2("doc","path",e),n instanceof um){const i=rs.fromString(e,...t);return cN(i),new Ts(n,null,new et(i))}{if(!(n instanceof Ts||n instanceof Vi))throw new Oe(we.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(rs.fromString(e,...t));return cN(i),new Ts(n.firestore,n instanceof Vi?n.converter:null,new et(i))}}const JN="AsyncQueue";class ZN{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new i_(this,"async_queue_retry"),this._c=()=>{const i=M0();i&&Pe(JN,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=M0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=M0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Br;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!uc(e))throw e;Pe(JN,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Gr("INTERNAL UNHANDLED ERROR: ",e1(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=xg.createAndSchedule(this,e,t,i,(c=>this.hc(c)));return this.tc.push(o),o}uc(){this.nc&&rt(47125,{Pc:e1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function e1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Wr extends um{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new ZN,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ZN(e),this._firestoreClient=void 0,await e}}}function hI(n,e){const t=typeof n=="object"?n:Yf(),i=typeof n=="string"?n:_f,o=nd(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const c=Vx("firestore");c&&dI(o,...c)}return o}function dm(n){if(n._terminated)throw new Oe(we.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||fI(n),n._firestoreClient}function fI(n){const e=n._freezeSettings(),t=uI(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new sI(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(o){const c=o?._online.build();return{_offline:o?._offline.build(c),_online:c}})(n._componentsProvider))}class ya{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ya(un.fromBase64String(e))}catch(t){throw new Oe(we.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ya(un.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ya._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(od(e,ya._jsonSchema))return ya.fromBase64String(e.bytes)}}ya._jsonSchemaVersion="firestore/bytes/1.0",ya._jsonSchema={type:Gs("string",ya._jsonSchemaVersion),bytes:Gs("string")};class Sg{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Oe(we.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new on(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hm{constructor(e){this._methodName=e}}class or{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Oe(we.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Oe(we.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return At(this._lat,e._lat)||At(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:or._jsonSchemaVersion}}static fromJSON(e){if(od(e,or._jsonSchema))return new or(e.latitude,e.longitude)}}or._jsonSchemaVersion="firestore/geoPoint/1.0",or._jsonSchema={type:Gs("string",or._jsonSchemaVersion),latitude:Gs("number"),longitude:Gs("number")};class Pa{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let c=0;c<i.length;++c)if(i[c]!==o[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Pa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(od(e,Pa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Pa(e.vectorValues);throw new Oe(we.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Pa._jsonSchemaVersion="firestore/vectorValue/1.0",Pa._jsonSchema={type:Gs("string",Pa._jsonSchemaVersion),vectorValues:Gs("object")};const mI=/^__.*__$/;class pI{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Wi(e,this.data,this.fieldMask,t,this.fieldTransforms):new ud(e,this.data,t,this.fieldTransforms)}}class S_{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Wi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function E_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt(40011,{dataSource:n})}}class Eg{constructor(e,t,i,o,c,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,c===void 0&&this.validatePath(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Eg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Mf(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(E_(this.dataSource)&&mI.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class xI{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||lm(e)}createContext(e,t,i,o=!1){return new Eg({dataSource:e,methodName:t,targetDoc:i,path:on.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fm(n){const e=n._freezeSettings(),t=lm(n._databaseId);return new xI(n._databaseId,!!e.ignoreUndefinedProperties,t)}function T_(n,e,t,i,o,c={}){const d=n.createContext(c.merge||c.mergeFields?2:0,e,t,o);Ag("Data must be an object, but it was:",d,i);const m=A_(i,d);let x,g;if(c.merge)x=new Zn(d.fieldMask),g=d.fieldTransforms;else if(c.mergeFields){const b=[];for(const v of c.mergeFields){const _=Xo(e,v,t);if(!d.contains(_))throw new Oe(we.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);R_(b,_)||b.push(_)}x=new Zn(b),g=d.fieldTransforms.filter((v=>x.covers(v.field)))}else x=null,g=d.fieldTransforms;return new pI(new Dn(m),x,g)}class mm extends hm{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof mm}}class Tg extends hm{_toFieldTransform(e){return new n6(e.path,new Wu)}isEqual(e){return e instanceof Tg}}function gI(n,e,t,i){const o=n.createContext(1,e,t);Ag("Data must be an object, but it was:",o,i);const c=[],d=Dn.empty();Yi(i,((x,g)=>{const b=C_(e,x,t);g=Zt(g);const v=o.childContextForFieldPath(b);if(g instanceof mm)c.push(b);else{const _=md(g,v);_!=null&&(c.push(b),d.set(b,_))}}));const m=new Zn(c);return new S_(d,m,o.fieldTransforms)}function bI(n,e,t,i,o,c){const d=n.createContext(1,e,t),m=[Xo(e,i,t)],x=[o];if(c.length%2!=0)throw new Oe(we.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<c.length;_+=2)m.push(Xo(e,c[_])),x.push(c[_+1]);const g=[],b=Dn.empty();for(let _=m.length-1;_>=0;--_)if(!R_(g,m[_])){const R=m[_];let B=x[_];B=Zt(B);const L=d.childContextForFieldPath(R);if(B instanceof mm)g.push(R);else{const O=md(B,L);O!=null&&(g.push(R),b.set(R,O))}}const v=new Zn(g);return new S_(b,v,d.fieldTransforms)}function yI(n,e,t,i=!1){return md(t,n.createContext(i?4:3,e))}function md(n,e){if(k_(n=Zt(n)))return Ag("Unsupported field value:",e,n),A_(n,e);if(n instanceof hm)return(function(i,o){if(!E_(o.dataSource))throw o.createError(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${i._methodName}() is not currently supported inside arrays`);const c=i._toFieldTransform(o);c&&o.fieldTransforms.push(c)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,o){const c=[];let d=0;for(const m of i){let x=md(m,o.childContextForArray(d));x==null&&(x={nullValue:"NULL_VALUE"}),c.push(x),d++}return{arrayValue:{values:c}}})(n,e)}return(function(i,o){if((i=Zt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return e6(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const c=zt.fromDate(i);return{timestampValue:kf(o.serializer,c)}}if(i instanceof zt){const c=new zt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:kf(o.serializer,c)}}if(i instanceof or)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ya)return{bytesValue:W2(o.serializer,i._byteString)};if(i instanceof Ts){const c=o.databaseId,d=i.firestore._databaseId;if(!d.isEqual(c))throw o.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:lg(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof Pa)return(function(d,m){const x=d instanceof Pa?d.toArray():d;return{mapValue:{fields:{[j2]:{stringValue:_2},[Sf]:{arrayValue:{values:x.map((b=>{if(typeof b!="number")throw m.createError("VectorValues must only contain numeric values.");return ng(m.serializer,b)}))}}}}}})(i,o);if(t_(i))return i._toProto(o.serializer);throw o.createError(`Unsupported field value: ${Xf(i)}`)})(n,e)}function A_(n,e){const t={};return g2(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yi(n,((i,o)=>{const c=md(o,e.childContextForField(i));c!=null&&(t[i]=c)})),{mapValue:{fields:t}}}function k_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof zt||n instanceof or||n instanceof ya||n instanceof Ts||n instanceof hm||n instanceof Pa||t_(n))}function Ag(n,e,t){if(!k_(t)||!p2(t)){const i=Xf(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Xo(n,e,t){if((e=Zt(e))instanceof Sg)return e._internalPath;if(typeof e=="string")return C_(n,e);throw Mf("Field path arguments must be of type string or ",n,!1,void 0,t)}const vI=new RegExp("[~\\*/\\[\\]]");function C_(n,e,t){if(e.search(vI)>=0)throw Mf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Sg(...e.split("."))._internalPath}catch{throw Mf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Mf(n,e,t,i,o){const c=i&&!i.isEmpty(),d=o!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let x="";return(c||d)&&(x+=" (found",c&&(x+=` in field ${i}`),d&&(x+=` in document ${o}`),x+=")"),new Oe(we.INVALID_ARGUMENT,m+n+x)}function R_(n,e){return n.some((t=>t.isEqual(e)))}class wI{convertValue(e,t="none"){switch($i(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ds(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw rt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Yi(e,((o,c)=>{i[o]=this.convertValue(c,t)})),i}convertVectorValue(e){const t=e.fields?.[Sf].arrayValue?.values?.map((i=>Ds(i.doubleValue)));return new Pa(t)}convertGeoPoint(e){return new or(Ds(e.latitude),Ds(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=em(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Hu(e));default:return null}}convertTimestamp(e){const t=zi(e);return new zt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=rs.fromString(e);$t(e_(i),9688,{name:e});const o=new Gu(i.get(1),i.get(3)),c=new et(i.popFirst(5));return o.isEqual(t)||Gr(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}class kg extends wI{constructor(e){super(),this.firestore=e}convertBytes(e){return new ya(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ts(this.firestore,null,t)}}function On(){return new Tg("serverTimestamp")}const t1="@firebase/firestore",s1="4.10.0";function n1(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of i)if(c in o&&typeof o[c]=="function")return!0;return!1})(n,["next","error","complete"])}class I_{constructor(e,t,i,o,c){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new Ts(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new NI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Xo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class NI extends I_{data(){return super.data()}}function D_(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Oe(we.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cg{}class jI extends Cg{}function pn(n,e,...t){let i=[];e instanceof Cg&&i.push(e),i=i.concat(t),(function(c){const d=c.filter((x=>x instanceof Rg)).length,m=c.filter((x=>x instanceof pm)).length;if(d>1||d>0&&m>0)throw new Oe(we.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const o of i)n=o._apply(n);return n}class pm extends jI{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new pm(e,t,i)}_apply(e){const t=this._parse(e);return M_(e._query,t),new zl(e.firestore,e.converter,ix(e._query,t))}_parse(e){const t=fm(e.firestore);return(function(c,d,m,x,g,b,v){let _;if(g.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Oe(we.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){r1(v,b);const B=[];for(const L of v)B.push(a1(x,c,L));_={arrayValue:{values:B}}}else _=a1(x,c,v)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||r1(v,b),_=yI(m,d,v,b==="in"||b==="not-in");return Hs.create(g,b,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function cn(n,e,t){const i=e,o=Xo("where",n);return pm._create(o,i,t)}class Rg extends Cg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Rg(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:La.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,c){let d=o;const m=c.getFlattenedFilters();for(const x of m)M_(d,x),d=ix(d,x)})(e._query,t),new zl(e.firestore,e.converter,ix(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function a1(n,e,t){if(typeof(t=Zt(t))=="string"){if(t==="")throw new Oe(we.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!I2(e)&&t.indexOf("/")!==-1)throw new Oe(we.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(rs.fromString(t));if(!et.isDocumentKey(i))throw new Oe(we.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return bN(n,new et(i))}if(t instanceof Ts)return bN(n,t._key);throw new Oe(we.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xf(t)}.`)}function r1(n,e){if(!Array.isArray(n)||n.length===0)throw new Oe(we.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function M_(n,e){const t=(function(o,c){for(const d of o)for(const m of d.getFlattenedFilters())if(c.indexOf(m.op)>=0)return m.op;return null})(n.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Oe(we.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Oe(we.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function O_(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class ju{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Tl extends I_{constructor(e,t,i,o,c,d){super(e,t,i,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new lf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Xo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Oe(we.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Tl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Tl._jsonSchemaVersion="firestore/documentSnapshot/1.0",Tl._jsonSchema={type:Gs("string",Tl._jsonSchemaVersion),bundleSource:Gs("string","DocumentSnapshot"),bundleName:Gs("string"),bundle:Gs("string")};class lf extends Tl{data(e={}){return super.data(e)}}class Al{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new ju(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new lf(this._firestore,this._userDataWriter,i.key,i,new ju(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Oe(we.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((m=>{const x=new lf(o._firestore,o._userDataWriter,m.doc.key,m.doc,new ju(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:x,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((m=>c||m.type!==3)).map((m=>{const x=new lf(o._firestore,o._userDataWriter,m.doc.key,m.doc,new ju(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,b=-1;return m.type!==0&&(g=d.indexOf(m.doc.key),d=d.delete(m.doc.key)),m.type!==1&&(d=d.add(m.doc),b=d.indexOf(m.doc.key)),{type:_I(m.type),doc:x,oldIndex:g,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Oe(we.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Al._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Xx.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),i.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function _I(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt(61501,{type:n})}}Al._jsonSchemaVersion="firestore/querySnapshot/1.0",Al._jsonSchema={type:Gs("string",Al._jsonSchemaVersion),bundleSource:Gs("string","QuerySnapshot"),bundleName:Gs("string"),bundle:Gs("string")};function Bo(n){n=Ln(n,Ts);const e=Ln(n.firestore,Wr),t=dm(e);return iI(t,n._key).then((i=>P_(e,n,i)))}function ys(n){n=Ln(n,zl);const e=Ln(n.firestore,Wr),t=dm(e),i=new kg(e);return D_(n._query),lI(t,n._query).then((o=>new Al(e,i,n,o)))}function Mu(n,e,t){n=Ln(n,Ts);const i=Ln(n.firestore,Wr),o=O_(n.converter,e,t),c=fm(i);return xm(i,[T_(c,"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,Na.none())])}function Ke(n,e,t,...i){n=Ln(n,Ts);const o=Ln(n.firestore,Wr),c=fm(o);let d;return d=typeof(e=Zt(e))=="string"||e instanceof Sg?bI(c,"updateDoc",n._key,e,t,i):gI(c,"updateDoc",n._key,e),xm(o,[d.toMutation(n._key,Na.exists(!0))])}function zo(n){return xm(Ln(n.firestore,Wr),[new ag(n._key,Na.none())])}function Ua(n,e){const t=Ln(n.firestore,Wr),i=Me(n),o=O_(n.converter,e),c=fm(n.firestore);return xm(t,[T_(c,"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,Na.exists(!1))]).then((()=>i))}function ns(n,...e){n=Zt(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||n1(e[i])||(t=e[i++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(n1(e[i])){const g=e[i];e[i]=g.next?.bind(g),e[i+1]=g.error?.bind(g),e[i+2]=g.complete?.bind(g)}let c,d,m;if(n instanceof Ts)d=Ln(n.firestore,Wr),m=tm(n._key.path),c={next:g=>{e[i]&&e[i](P_(d,n,g))},error:e[i+1],complete:e[i+2]};else{const g=Ln(n,zl);d=Ln(g.firestore,Wr),m=g._query;const b=new kg(d);c={next:v=>{e[i]&&e[i](new Al(d,b,g,v))},error:e[i+1],complete:e[i+2]},D_(n._query)}const x=dm(d);return rI(x,m,o,c)}function xm(n,e){const t=dm(n);return oI(t,e)}function P_(n,e,t){const i=t.docs.get(e._key),o=new kg(n);return new Tl(n,o,e._key,i,new ju(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){lR(Ll),Ui(new $r("firestore",((i,{instanceIdentifier:o,options:c})=>{const d=i.getProvider("app").getImmediate(),m=new Wr(new uR(i.getProvider("auth-internal")),new fR(d,i.getProvider("app-check-internal")),CR(d,o),d);return c={useFetchStreams:t,...c},m._setSettings(c),m}),"PUBLIC").setMultipleInstances(!0)),wa(t1,s1,e),wa(t1,s1,"esm2020")})();var SI="firebase",EI="12.8.0";wa(SI,EI,"app");const V_="firebasestorage.googleapis.com",L_="storageBucket",TI=120*1e3,AI=600*1e3;class ks extends za{constructor(e,t,i=0){super(P0(e),`Firebase Storage: ${t} (${P0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ks.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return P0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var As;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(As||(As={}));function P0(n){return"storage/"+n}function Ig(){const n="An unknown error occurred, please check the error payload for server response.";return new ks(As.UNKNOWN,n)}function kI(n){return new ks(As.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function CI(n){return new ks(As.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function RI(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ks(As.UNAUTHENTICATED,n)}function II(){return new ks(As.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function DI(n){return new ks(As.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function MI(){return new ks(As.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function OI(){return new ks(As.CANCELED,"User canceled the upload/download.")}function PI(n){return new ks(As.INVALID_URL,"Invalid URL '"+n+"'.")}function VI(n){return new ks(As.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function LI(){return new ks(As.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+L_+"' property when initializing the app?")}function UI(){return new ks(As.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function BI(){return new ks(As.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function zI(n){return new ks(As.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function gx(n){return new ks(As.INVALID_ARGUMENT,n)}function U_(){return new ks(As.APP_DELETED,"The Firebase app was deleted.")}function FI(n){return new ks(As.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ou(n,e){return new ks(As.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function du(n){throw new ks(As.INTERNAL_ERROR,"Internal error: "+n)}class ea{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=ea.makeFromUrl(e,t)}catch{return new ea(e,"")}if(i.path==="")return i;throw VI(e)}static makeFromUrl(e,t){let i=null;const o="([A-Za-z0-9.\\-_]+)";function c(ae){ae.path.charAt(ae.path.length-1)==="/"&&(ae.path_=ae.path_.slice(0,-1))}const d="(/(.*))?$",m=new RegExp("^gs://"+o+d,"i"),x={bucket:1,path:3};function g(ae){ae.path_=decodeURIComponent(ae.path)}const b="v[A-Za-z0-9_]+",v=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",R=new RegExp(`^https?://${v}/${b}/b/${o}/o${_}`,"i"),B={bucket:1,path:3},L=t===V_?"(?:storage.googleapis.com|storage.cloud.google.com)":t,O="([^?#]*)",z=new RegExp(`^https?://${L}/${o}/${O}`,"i"),H=[{regex:m,indices:x,postModify:c},{regex:R,indices:B,postModify:g},{regex:z,indices:{bucket:1,path:2},postModify:g}];for(let ae=0;ae<H.length;ae++){const ue=H[ae],Y=ue.regex.exec(e);if(Y){const T=Y[ue.indices.bucket];let E=Y[ue.indices.path];E||(E=""),i=new ea(T,E),ue.postModify(i);break}}if(i==null)throw PI(e);return i}}class $I{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function qI(n,e,t){let i=1,o=null,c=null,d=!1,m=0;function x(){return m===2}let g=!1;function b(...O){g||(g=!0,e.apply(null,O))}function v(O){o=setTimeout(()=>{o=null,n(R,x())},O)}function _(){c&&clearTimeout(c)}function R(O,...z){if(g){_();return}if(O){_(),b.call(null,O,...z);return}if(x()||d){_(),b.call(null,O,...z);return}i<64&&(i*=2);let H;m===1?(m=2,H=0):H=(i+Math.random())*1e3,v(H)}let B=!1;function L(O){B||(B=!0,_(),!g&&(o!==null?(O||(m=2),clearTimeout(o),v(0)):O||(m=1)))}return v(0),c=setTimeout(()=>{d=!0,L(!0)},t),L}function HI(n){n(!1)}function GI(n){return n!==void 0}function YI(n){return typeof n=="object"&&!Array.isArray(n)}function Dg(n){return typeof n=="string"||n instanceof String}function i1(n){return Mg()&&n instanceof Blob}function Mg(){return typeof Blob<"u"}function l1(n,e,t,i){if(i<e)throw gx(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw gx(`Invalid value for '${n}'. Expected ${t} or less.`)}function gm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function B_(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const o=e(i)+"="+e(n[i]);t=t+o+"&"}return t=t.slice(0,-1),t}var kl;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(kl||(kl={}));function WI(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}class KI{constructor(e,t,i,o,c,d,m,x,g,b,v,_=!0,R=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=m,this.errorCallback_=x,this.timeout_=g,this.progressCallback_=b,this.connectionFactory_=v,this.retry=_,this.isUsingEmulator=R,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((B,L)=>{this.resolve_=B,this.reject_=L,this.start_()})}start_(){const e=(i,o)=>{if(o){i(!1,new zh(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=m=>{const x=m.loaded,g=m.lengthComputable?m.total:-1;this.progressCallback_!==null&&this.progressCallback_(x,g)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const m=c.getErrorCode()===kl.NO_ERROR,x=c.getStatus();if(!m||WI(x,this.additionalRetryCodes_)&&this.retry){const b=c.getErrorCode()===kl.ABORT;i(!1,new zh(!1,null,b));return}const g=this.successCodes_.indexOf(x)!==-1;i(!0,new zh(g,c))})},t=(i,o)=>{const c=this.resolve_,d=this.reject_,m=o.connection;if(o.wasSuccessCode)try{const x=this.callback_(m,m.getResponse());GI(x)?c(x):c()}catch(x){d(x)}else if(m!==null){const x=Ig();x.serverResponse=m.getErrorText(),this.errorCallback_?d(this.errorCallback_(m,x)):d(x)}else if(o.canceled){const x=this.appDelete_?U_():OI();d(x)}else{const x=MI();d(x)}};this.canceled_?t(!1,new zh(!1,null,!0)):this.backoffId_=qI(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&HI(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class zh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function QI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function XI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function JI(n,e){e&&(n["X-Firebase-GMPID"]=e)}function ZI(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function eD(n,e,t,i,o,c,d=!0,m=!1){const x=B_(n.urlParams),g=n.url+x,b=Object.assign({},n.headers);return JI(b,e),QI(b,t),XI(b,c),ZI(b,i),new KI(g,n.method,b,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,m)}function tD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function sD(...n){const e=tD();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Mg())return new Blob(n);throw new ks(As.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function nD(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function aD(n){if(typeof atob>"u")throw zI("base-64");return atob(n)}const nr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class V0{constructor(e,t){this.data=e,this.contentType=t||null}}function rD(n,e){switch(n){case nr.RAW:return new V0(z_(e));case nr.BASE64:case nr.BASE64URL:return new V0(F_(n,e));case nr.DATA_URL:return new V0(lD(e),oD(e))}throw Ig()}function z_(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const c=i,d=n.charCodeAt(++t);i=65536|(c&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function iD(n){let e;try{e=decodeURIComponent(n)}catch{throw Ou(nr.DATA_URL,"Malformed data URL.")}return z_(e)}function F_(n,e){switch(n){case nr.BASE64:{const o=e.indexOf("-")!==-1,c=e.indexOf("_")!==-1;if(o||c)throw Ou(n,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case nr.BASE64URL:{const o=e.indexOf("+")!==-1,c=e.indexOf("/")!==-1;if(o||c)throw Ou(n,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=aD(e)}catch(o){throw o.message.includes("polyfill")?o:Ou(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}class $_{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Ou(nr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=cD(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function lD(n){const e=new $_(n);return e.base64?F_(nr.BASE64,e.rest):iD(e.rest)}function oD(n){return new $_(n).contentType}function cD(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Ii{constructor(e,t){let i=0,o="";i1(e)?(this.data_=e,i=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(i1(this.data_)){const i=this.data_,o=nD(i,e,t);return o===null?null:new Ii(o)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ii(i,!0)}}static getBlob(...e){if(Mg()){const t=e.map(i=>i instanceof Ii?i.data_:i);return new Ii(sD.apply(null,t))}else{const t=e.map(d=>Dg(d)?rD(nr.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const o=new Uint8Array(i);let c=0;return t.forEach(d=>{for(let m=0;m<d.length;m++)o[c++]=d[m]}),new Ii(o,!0)}}uploadData(){return this.data_}}function q_(n){let e;try{e=JSON.parse(n)}catch{return null}return YI(e)?e:null}function uD(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function dD(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function H_(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function hD(n,e){return e}class wn{constructor(e,t,i,o){this.server=e,this.local=t||e,this.writable=!!i,this.xform=o||hD}}let Fh=null;function fD(n){return!Dg(n)||n.length<2?n:H_(n)}function G_(){if(Fh)return Fh;const n=[];n.push(new wn("bucket")),n.push(new wn("generation")),n.push(new wn("metageneration")),n.push(new wn("name","fullPath",!0));function e(c,d){return fD(d)}const t=new wn("name");t.xform=e,n.push(t);function i(c,d){return d!==void 0?Number(d):d}const o=new wn("size");return o.xform=i,n.push(o),n.push(new wn("timeCreated")),n.push(new wn("updated")),n.push(new wn("md5Hash",null,!0)),n.push(new wn("cacheControl",null,!0)),n.push(new wn("contentDisposition",null,!0)),n.push(new wn("contentEncoding",null,!0)),n.push(new wn("contentLanguage",null,!0)),n.push(new wn("contentType",null,!0)),n.push(new wn("metadata","customMetadata",!0)),Fh=n,Fh}function mD(n,e){function t(){const i=n.bucket,o=n.fullPath,c=new ea(i,o);return e._makeStorageReference(c)}Object.defineProperty(n,"ref",{get:t})}function pD(n,e,t){const i={};i.type="file";const o=t.length;for(let c=0;c<o;c++){const d=t[c];i[d.local]=d.xform(i,e[d.server])}return mD(i,n),i}function Y_(n,e,t){const i=q_(e);return i===null?null:pD(n,i,t)}function xD(n,e,t,i){const o=q_(e);if(o===null||!Dg(o.downloadTokens))return null;const c=o.downloadTokens;if(c.length===0)return null;const d=encodeURIComponent;return c.split(",").map(g=>{const b=n.bucket,v=n.fullPath,_="/b/"+d(b)+"/o/"+d(v),R=gm(_,t,i),B=B_({alt:"media",token:g});return R+B})[0]}function gD(n,e){const t={},i=e.length;for(let o=0;o<i;o++){const c=e[o];c.writable&&(t[c.server]=n[c.local])}return JSON.stringify(t)}class Og{constructor(e,t,i,o){this.url=e,this.method=t,this.handler=i,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function W_(n){if(!n)throw Ig()}function bD(n,e){function t(i,o){const c=Y_(n,o,e);return W_(c!==null),c}return t}function yD(n,e){function t(i,o){const c=Y_(n,o,e);return W_(c!==null),xD(c,o,n.host,n._protocol)}return t}function K_(n){function e(t,i){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=II():o=RI():t.getStatus()===402?o=CI(n.bucket):t.getStatus()===403?o=DI(n.path):o=i,o.status=t.getStatus(),o.serverResponse=i.serverResponse,o}return e}function Q_(n){const e=K_(n);function t(i,o){let c=e(i,o);return i.getStatus()===404&&(c=kI(n.path)),c.serverResponse=o.serverResponse,c}return t}function vD(n,e,t){const i=e.fullServerUrl(),o=gm(i,n.host,n._protocol),c="GET",d=n.maxOperationRetryTime,m=new Og(o,c,yD(n,t),d);return m.errorHandler=Q_(e),m}function wD(n,e){const t=e.fullServerUrl(),i=gm(t,n.host,n._protocol),o="DELETE",c=n.maxOperationRetryTime;function d(x,g){}const m=new Og(i,o,d,c);return m.successCodes=[200,204],m.errorHandler=Q_(e),m}function ND(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function jD(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=ND(null,e)),i}function _D(n,e,t,i,o){const c=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function m(){let H="";for(let ae=0;ae<2;ae++)H=H+Math.random().toString().slice(2);return H}const x=m();d["Content-Type"]="multipart/related; boundary="+x;const g=jD(e,i,o),b=gD(g,t),v="--"+x+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+x+`\r
Content-Type: `+g.contentType+`\r
\r
`,_=`\r
--`+x+"--",R=Ii.getBlob(v,i,_);if(R===null)throw UI();const B={name:g.fullPath},L=gm(c,n.host,n._protocol),O="POST",z=n.maxUploadRetryTime,G=new Og(L,O,bD(n,t),z);return G.urlParams=B,G.headers=d,G.body=R.uploadData(),G.errorHandler=K_(e),G}class SD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=kl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=kl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=kl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,o,c){if(this.sent_)throw du("cannot .send() more than once");if(fr(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),c!==void 0)for(const d in c)c.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,c[d].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw du("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw du("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw du("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw du("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class ED extends SD{initXhr(){this.xhr_.responseType="text"}}function Pg(){return new ED}class Pl{constructor(e,t){this._service=e,t instanceof ea?this._location=t:this._location=ea.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Pl(e,t)}get root(){const e=new ea(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return H_(this._location.path)}get storage(){return this._service}get parent(){const e=uD(this._location.path);if(e===null)return null;const t=new ea(this._location.bucket,e);return new Pl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw FI(e)}}function TD(n,e,t){n._throwIfRoot("uploadBytes");const i=_D(n.storage,n._location,G_(),new Ii(e,!0),t);return n.storage.makeRequestWithTokens(i,Pg).then(o=>({metadata:o,ref:n}))}function AD(n){n._throwIfRoot("getDownloadURL");const e=vD(n.storage,n._location,G_());return n.storage.makeRequestWithTokens(e,Pg).then(t=>{if(t===null)throw BI();return t})}function kD(n){n._throwIfRoot("deleteObject");const e=wD(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Pg)}function CD(n,e){const t=dD(n._location.path,e),i=new ea(n._location.bucket,t);return new Pl(n.storage,i)}function RD(n){return/^[A-Za-z]+:\/\//.test(n)}function ID(n,e){return new Pl(n,e)}function X_(n,e){if(n instanceof Vg){const t=n;if(t._bucket==null)throw LI();const i=new Pl(t,t._bucket);return e!=null?X_(i,e):i}else return e!==void 0?CD(n,e):n}function DD(n,e){if(e&&RD(e)){if(n instanceof Vg)return ID(n,e);throw gx("To use ref(service, url), the first argument must be a Storage instance.")}else return X_(n,e)}function o1(n,e){const t=e?.[L_];return t==null?null:ea.makeFromBucketSpec(t,n)}function MD(n,e,t,i={}){n.host=`${e}:${t}`;const o=fr(e);o&&(Hf(`https://${n.host}/b`),Gf("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=i;c&&(n._overrideAuthToken=typeof c=="string"?c:xj(c,n.app.options.projectId))}class Vg{constructor(e,t,i,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=V_,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=TI,this._maxUploadRetryTime=AI,this._requests=new Set,o!=null?this._bucket=ea.makeFromBucketSpec(o,this._host):this._bucket=o1(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ea.makeFromBucketSpec(this._url,e):this._bucket=o1(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){l1("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){l1("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(jn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Pl(this,e)}_makeRequest(e,t,i,o,c=!0){if(this._deleted)return new $I(U_());{const d=eD(e,this._appId,i,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,o).getPromise()}}const c1="@firebase/storage",u1="0.14.0";const J_="storage";function Z_(n,e,t){return n=Zt(n),TD(n,e,t)}function eS(n){return n=Zt(n),AD(n)}function OD(n){return n=Zt(n),kD(n)}function bx(n,e){return n=Zt(n),DD(n,e)}function PD(n=Yf(),e){n=Zt(n);const i=nd(n,J_).getImmediate({identifier:e}),o=Vx("storage");return o&&VD(i,...o),i}function VD(n,e,t,i={}){MD(n,e,t,i)}function LD(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new Vg(t,i,o,e,Ll)}function UD(){Ui(new $r(J_,LD,"PUBLIC").setMultipleInstances(!0)),wa(c1,u1,""),wa(c1,u1,"esm2020")}UD();const BD={apiKey:"AIzaSyC1qZ9fK-6LFBxVWZsAD4dZq-KVg36A7f8",authDomain:"scheduler-65e51.firebaseapp.com",projectId:"scheduler-65e51",storageBucket:"scheduler-65e51.firebasestorage.app",messagingSenderId:"93993791456",appId:"1:93993791456:web:3a777a2da0dad4b8b74585"},Lg=yj(BD),fe=hI(Lg),xn=rR(Lg),yx=PD(Lg);const tS=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();const zD=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const FD=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase());const d1=n=>{const e=FD(n);return e.charAt(0).toUpperCase()+e.slice(1)};var $D={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const qD=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const HD=j.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:o="",children:c,iconNode:d,...m},x)=>j.createElement("svg",{ref:x,...$D,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:tS("lucide",o),...!c&&!qD(m)&&{"aria-hidden":"true"},...m},[...d.map(([g,b])=>j.createElement(g,b)),...Array.isArray(c)?c:[c]]));const Ae=(n,e)=>{const t=j.forwardRef(({className:i,...o},c)=>j.createElement(HD,{ref:c,iconNode:e,className:tS(`lucide-${zD(d1(n))}`,`lucide-${n}`,i),...o}));return t.displayName=d1(n),t};const GD=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Pu=Ae("archive",GD);const YD=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],WD=Ae("arrow-down-right",YD);const KD=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ma=Ae("arrow-left",KD);const QD=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Cl=Ae("arrow-right",QD);const XD=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],JD=Ae("arrow-up-down",XD);const ZD=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],sS=Ae("arrow-up-right",ZD);const eM=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],h1=Ae("ban",eM);const tM=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Do=Ae("bell",tM);const sM=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],nM=Ae("bot",sM);const aM=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],rM=Ae("building-2",aM);const iM=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],sa=Ae("calendar-check",iM);const lM=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],f1=Ae("calendar-days",lM);const oM=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],_t=Ae("calendar",oM);const cM=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],uM=Ae("camera",cM);const dM=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ug=Ae("chart-column",dM);const hM=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],nS=Ae("chart-pie",hM);const fM=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],en=Ae("check",fM);const mM=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Xu=Ae("chevron-down",mM);const pM=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Bg=Ae("chevron-left",pM);const xM=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],hc=Ae("chevron-right",xM);const gM=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],vx=Ae("chevron-up",gM);const bM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ju=Ae("circle-alert",bM);const yM=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ms=Ae("circle-check-big",yM);const vM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],sr=Ae("circle-x",vM);const wM=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Wt=Ae("clock",wM);const NM=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],jM=Ae("code",NM);const _M=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],Of=Ae("coffee",_M);const SM=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],aS=Ae("copy",SM);const EM=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Pn=Ae("credit-card",EM);const TM=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Jo=Ae("crown",TM);const AM=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Fo=Ae("dollar-sign",AM);const kM=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],cr=Ae("external-link",kM);const CM=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Vu=Ae("eye",CM);const RM=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],m1=Ae("file-text",RM);const IM=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],DM=Ae("ghost",IM);const MM=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],OM=Ae("gift",MM);const PM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],VM=Ae("globe",PM);const LM=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],UM=Ae("headphones",LM);const BM=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],zg=Ae("heart",BM);const zM=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],bm=Ae("image",zM);const FM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],p1=Ae("info",FM);const $M=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],wx=Ae("list-ordered",$M);const qM=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]],Pf=Ae("list-plus",qM);const HM=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Mn=Ae("loader-circle",HM);const GM=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Vf=Ae("lock",GM);const YM=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Zu=Ae("log-out",YM);const WM=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Lf=Ae("mail",WM);const KM=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],QM=Ae("map-pin",KM);const XM=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],rS=Ae("menu",XM);const JM=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Uf=Ae("message-circle",JM);const ZM=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Nx=Ae("message-square",ZM);const eO=[["path",{d:"M5 12h14",key:"1ays0h"}]],tO=Ae("minus",eO);const sO=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],iS=Ae("palette",sO);const nO=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],lS=Ae("party-popper",nO);const aO=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Fg=Ae("pen-line",aO);const rO=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Lu=Ae("phone",rO);const iO=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],$o=Ae("play",iO);const lO=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],dr=Ae("plus",lO);const oO=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Zo=Ae("refresh-cw",oO);const cO=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],Li=Ae("repeat",cO);const uO=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],oS=Ae("save",uO);const dO=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],of=Ae("search",dO);const hO=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],cf=Ae("send",hO);const fO=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],uf=Ae("settings",fO);const mO=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],qo=Ae("shield",mO);const pO=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],cS=Ae("sparkles",pO);const xO=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],jx=Ae("star",xO);const gO=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],x1=Ae("sticky-note",gO);const bO=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],Mr=Ae("store",bO);const yO=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Un=Ae("tag",yO);const vO=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],uS=Ae("thermometer",vO);const wO=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],dS=Ae("timer",wO);const NO=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Oa=Ae("trash-2",NO);const jO=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ec=Ae("trending-up",jO);const _O=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],va=Ae("triangle-alert",_O);const SO=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],EO=Ae("upload",SO);const TO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],hS=Ae("user-plus",TO);const AO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],zr=Ae("user",AO);const kO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ft=Ae("users",kO);const CO=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],g1=Ae("wallet",CO);const RO=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Os=Ae("x",RO);const IO=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],fc=Ae("zap",IO);function b1({className:n=""}){return a.jsxs(Ze,{to:"/",className:`flex items-center gap-2.5 ${n}`,children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(sa,{className:"w-[18px] h-[18px] text-white"})}),a.jsxs("span",{className:"text-xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function DO(){return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-100",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsx(b1,{}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ze,{to:"/login",className:"px-4 py-2.5 text-sm font-semibold text-slate-600 hover:text-slate-900 transition-colors",children:"Sign In"}),a.jsxs(Ze,{to:"/register",className:"hidden sm:inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:["Get Started Free",a.jsx(Cl,{className:"w-4 h-4"})]}),a.jsx(Ze,{to:"/register",className:"sm:hidden px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all",children:"Start Free"})]})]})}),a.jsxs("section",{className:"relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 -z-10",children:[a.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-blue-50 rounded-full blur-3xl opacity-60 -translate-y-1/2 translate-x-1/3"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-violet-50 rounded-full blur-3xl opacity-50 translate-y-1/3 -translate-x-1/4"})]}),a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 pt-16 sm:pt-24 pb-16 sm:pb-20",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-16 items-center",children:[a.jsxs("div",{className:"animate-fade-in-up",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 px-3.5 py-1.5 bg-blue-50 border border-blue-100 rounded-full text-sm font-medium text-blue-700 mb-6",children:[a.jsx(cS,{className:"w-3.5 h-3.5"}),"Free for beauty professionals"]}),a.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-[3.5rem] font-extrabold text-slate-900 leading-[1.1] mb-6 tracking-tight",children:["Online booking",a.jsx("br",{}),a.jsx("span",{className:"text-blue-600",children:"made effortless"})]}),a.jsx("p",{className:"text-lg sm:text-xl text-slate-600 leading-relaxed mb-8 max-w-lg",children:"Let clients book 24/7. Manage your team, services, and schedule from one beautiful dashboard. No more phone tag."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-10",children:[a.jsxs(Ze,{to:"/register",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-base shadow-lg shadow-blue-600/25 hover:shadow-xl hover:shadow-blue-600/30 transition-all hover:-translate-y-0.5",children:["Start for Free",a.jsx(Cl,{className:"w-4 h-4"})]}),a.jsx("a",{href:"#how-it-works",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-base border border-slate-200 transition-all",children:"See How It Works"})]}),a.jsxs("div",{className:"flex items-center gap-5 text-sm text-slate-500",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ms,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"Free to use"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ms,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"No credit card"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ms,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"Setup in 2 min"})]})]})]}),a.jsxs("div",{className:"relative animate-fade-in-up",style:{animationDelay:"150ms"},children:[a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl shadow-slate-200/60 border border-slate-200/80 overflow-hidden",children:[a.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-slate-50 border-b border-slate-100",children:[a.jsxs("div",{className:"flex gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"})]}),a.jsx("div",{className:"flex-1 mx-4",children:a.jsx("div",{className:"bg-white border border-slate-200 rounded-lg px-3 py-1.5 text-xs text-slate-400 font-mono",children:"bookflow.app/shop/janes-salon"})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-sm font-bold",children:"J"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-slate-900",children:"Jane's Salon"}),a.jsx("div",{className:"text-xs text-slate-500",children:"Book your next appointment"})]})]}),a.jsx("div",{className:"space-y-2.5",children:[{name:"Haircut & Style",price:"$45",time:"45 min",color:"bg-blue-500"},{name:"Color Treatment",price:"$120",time:"2 hours",color:"bg-violet-500"},{name:"Blowout",price:"$35",time:"30 min",color:"bg-emerald-500"}].map(n=>a.jsxs("div",{className:"flex items-center justify-between p-3.5 bg-slate-50 rounded-xl border border-slate-100 group hover:border-blue-200 hover:bg-blue-50/50 transition-all cursor-default",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-2 h-8 ${n.color} rounded-full`}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-800",children:n.name}),a.jsx("div",{className:"text-xs text-slate-500",children:n.time})]})]}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:n.price})]},n.name))})]})]}),a.jsxs("div",{className:"absolute -bottom-4 -left-4 bg-white rounded-xl shadow-lg shadow-slate-200/60 border border-slate-100 px-4 py-3 flex items-center gap-3 animate-float",children:[a.jsx("div",{className:"w-9 h-9 bg-emerald-100 rounded-full flex items-center justify-center",children:a.jsx(Ms,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-slate-500",children:"Booking confirmed"}),a.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Tomorrow at 2:00 PM"})]})]})]})]})})]}),a.jsx("section",{className:"border-y border-slate-100 bg-slate-50/50",children:a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-8 sm:py-10",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-8 sm:gap-16 text-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"500+"}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Businesses trust SpotBookie"})]}),a.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"10,000+"}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Appointments booked"})]}),a.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl sm:text-3xl font-extrabold text-slate-900",children:["4.9 ",a.jsx(jx,{className:"w-5 h-5 text-amber-400 fill-amber-400"})]}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Average rating"})]})]})})}),a.jsx("section",{className:"py-20 sm:py-28",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Everything you need to run your bookings"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Built specifically for beauty professionals, salons, and service businesses. Simple, powerful, and free."})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 stagger-children",children:[{icon:a.jsx(_t,{className:"w-6 h-6"}),title:"Smart Scheduling",desc:"Set weekly hours with breaks. Slots auto-generate so your calendar is always up to date.",color:"bg-blue-100 text-blue-600"},{icon:a.jsx(Ft,{className:"w-6 h-6"}),title:"Multi-Staff Support",desc:"Add your whole team. Each member gets their own schedule, hours, and bookings.",color:"bg-violet-100 text-violet-600"},{icon:a.jsx(fc,{className:"w-6 h-6"}),title:"Instant Booking",desc:"Clients pick a service, choose a stylist, and book  all in under a minute.",color:"bg-amber-100 text-amber-600"},{icon:a.jsx(VM,{className:"w-6 h-6"}),title:"Your Own Booking Page",desc:"Get a unique link to share anywhere. No app downloads needed for your clients.",color:"bg-emerald-100 text-emerald-600"}].map(n=>a.jsxs("div",{className:"group bg-white rounded-2xl p-7 border border-slate-200/80 hover:border-slate-300 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[a.jsx("div",{className:`w-12 h-12 ${n.color} rounded-xl flex items-center justify-center mb-5 group-hover:scale-110 transition-transform duration-300`,children:n.icon}),a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:n.title}),a.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:n.desc})]},n.title))})]})}),a.jsx("section",{id:"how-it-works",className:"py-20 sm:py-28 bg-slate-50 border-y border-slate-100",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Up and running in minutes"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Three simple steps to start accepting online bookings today."})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-8 lg:gap-12 relative",children:[a.jsx("div",{className:"hidden md:block absolute top-14 left-[calc(16.67%+1rem)] right-[calc(16.67%+1rem)] h-px bg-gradient-to-r from-blue-200 via-violet-200 to-emerald-200"}),[{step:"1",title:"Create your account",desc:"Sign up free in 30 seconds. Name your shop and you're in.",color:"from-blue-500 to-blue-600",shadow:"shadow-blue-500/30"},{step:"2",title:"Set up your shop",desc:"Add your services, team, and weekly hours. SpotBookie handles the rest.",color:"from-violet-500 to-violet-600",shadow:"shadow-violet-500/30"},{step:"3",title:"Share your link",desc:"Send your booking page to clients. They book, you get notified.",color:"from-emerald-500 to-emerald-600",shadow:"shadow-emerald-500/30"}].map(n=>a.jsxs("div",{className:"relative text-center",children:[a.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${n.color} rounded-2xl flex items-center justify-center mx-auto mb-6 text-white text-xl font-extrabold shadow-lg ${n.shadow} relative z-10`,children:n.step}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:n.title}),a.jsx("p",{className:"text-slate-600 leading-relaxed max-w-xs mx-auto",children:n.desc})]},n.step))]})]})}),a.jsx("section",{className:"py-20 sm:py-28",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Loved by professionals"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"See why salons and stylists are switching to SpotBookie."})]}),a.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{quote:"SpotBookie replaced our paper appointment book. Clients love being able to book online anytime.",name:"Maria Santos",role:"Salon Owner",initials:"MS",color:"bg-blue-100 text-blue-700"},{quote:"Setting up was incredibly easy. I had my booking page live and shared with clients in under 10 minutes.",name:"David Chen",role:"Barber",initials:"DC",color:"bg-violet-100 text-violet-700"},{quote:"The multi-staff feature is perfect. Each stylist manages their own schedule and clients can pick who they want.",name:"Lisa Park",role:"Studio Manager",initials:"LP",color:"bg-emerald-100 text-emerald-700"}].map(n=>a.jsxs("div",{className:"bg-white rounded-2xl p-7 border border-slate-200/80 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[a.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(5)].map((e,t)=>a.jsx(jx,{className:"w-4 h-4 text-amber-400 fill-amber-400"},t))}),a.jsxs("p",{className:"text-slate-700 leading-relaxed mb-6",children:['"',n.quote,'"']}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 ${n.color} rounded-full flex items-center justify-center text-sm font-bold`,children:n.initials}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:n.name}),a.jsx("div",{className:"text-xs text-slate-500",children:n.role})]})]})]},n.name))})]})}),a.jsxs("section",{className:"py-20 sm:py-28 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 -z-0",children:[a.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-violet-500/10 rounded-full blur-3xl"})]}),a.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto px-5 sm:px-8 text-center",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-extrabold text-white mb-6 leading-tight",children:"Ready to streamline your bookings?"}),a.jsx("p",{className:"text-lg text-slate-400 mb-10 max-w-xl mx-auto",children:"Join hundreds of professionals who have ditched the old appointment book. Set up in minutes, free forever."}),a.jsxs(Ze,{to:"/register",className:"inline-flex items-center gap-2 px-8 py-4 bg-white hover:bg-slate-50 text-slate-900 rounded-xl font-bold text-lg transition-all hover:shadow-xl hover:shadow-white/10 hover:-translate-y-0.5",children:["Create Your Free Account",a.jsx(Cl,{className:"w-5 h-5"})]})]})]}),a.jsx("footer",{className:"bg-white border-t border-slate-100",children:a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-10",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[a.jsx(b1,{}),a.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500",children:[a.jsx(Ze,{to:"/register",className:"hover:text-slate-900 transition-colors",children:"Sign Up"}),a.jsx("span",{className:"text-slate-200",children:""}),a.jsx(Ze,{to:"/login",className:"hover:text-slate-900 transition-colors",children:"Sign In"}),a.jsx("span",{className:"text-slate-200",children:""}),a.jsx("a",{href:"#how-it-works",className:"hover:text-slate-900 transition-colors",children:"How It Works"})]}),a.jsxs("p",{className:"text-xs text-slate-400",children:[" ",new Date().getFullYear()," SpotBookie. All rights reserved."]})]})})})]})}function MO(n){return n.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function OO(){const n=hr(),[e,t]=j.useState(""),[i,o]=j.useState(""),[c,d]=j.useState(""),[m,x]=j.useState(""),[g,b]=j.useState(!1),v=MO(e),_=async R=>{if(R.preventDefault(),x(""),!v){x("Please enter a valid shop name");return}if(c.length<6){x("Password must be at least 6 characters");return}b(!0);try{const B=pn(Ye(fe,"shops"),cn("slug","==",v));if(!(await ys(B)).empty){x("A shop with that name already exists. Please choose a different name."),b(!1);return}const z=(await VC(xn,i,c)).user;await Ua(Ye(fe,"shops"),{name:e.trim(),slug:v,ownerUid:z.uid,ownerEmail:i,createdAt:On()}),n(`/shop/${v}/dashboard`)}catch(B){switch(B.code){case"auth/email-already-in-use":x("An account with this email already exists");break;case"auth/invalid-email":x("Please enter a valid email address");break;case"auth/weak-password":x("Password must be at least 6 characters");break;default:x("Registration failed. Please try again.")}}finally{b(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(Ze,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(sa,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Create your shop"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Set up your booking page in seconds  it's free"})]}),a.jsxs("form",{onSubmit:_,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Shop Name"}),a.jsx("input",{type:"text",value:e,onChange:R=>{t(R.target.value),x("")},placeholder:"Jane's Salon",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),v&&a.jsxs("p",{className:"mt-1.5 text-xs text-slate-400",children:["Your page: ",a.jsxs("span",{className:"font-mono text-blue-600 font-medium",children:["bookflow.app/shop/",v]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:i,onChange:R=>{o(R.target.value),x("")},placeholder:"you@example.com",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:c,onChange:R=>{d(R.target.value),x("")},placeholder:"At least 6 characters",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${m?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),m&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",m]})]}),a.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Creating your shop"]}):a.jsxs(a.Fragment,{children:["Create Shop",a.jsx(Cl,{className:"w-4 h-4"})]})})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Already have an account?"," ",a.jsx(Ze,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Sign in"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(Ze,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(Ma,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function PO({user:n}){const e=hr(),[t,i]=j.useState(""),[o,c]=j.useState(""),[d,m]=j.useState(""),[x,g]=j.useState(!1);j.useState(()=>{if(!n)return;(async()=>{const _=pn(Ye(fe,"shops"),cn("ownerUid","==",n.uid)),R=await ys(_);if(!R.empty){const B=R.docs[0].data();e(`/shop/${B.slug}/dashboard`,{replace:!0})}})()},[n,e]);const b=async v=>{v.preventDefault(),m(""),g(!0);try{const R=(await Gx(xn,t,o)).user,B=pn(Ye(fe,"shops"),cn("ownerUid","==",R.uid)),L=await ys(B);if(L.empty){m("No shop found for this account. Need to create one?"),await xn.signOut(),g(!1);return}const O=L.docs[0].data();e(`/shop/${O.slug}/dashboard`,{replace:!0})}catch(_){switch(_.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":m("Invalid email or password");break;case"auth/invalid-email":m("Please enter a valid email address");break;case"auth/too-many-requests":m("Too many failed attempts. Please try again later.");break;default:m("Login failed. Please try again.")}c("")}finally{g(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(Ze,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(sa,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:t,onChange:v=>{i(v.target.value),m("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:o,onChange:v=>{c(v.target.value),m("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${d?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),d&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",d]})]}),a.jsx("button",{type:"submit",disabled:x,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:x?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):a.jsxs(a.Fragment,{children:["Sign In",a.jsx(Cl,{className:"w-4 h-4"})]})})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",a.jsx(Ze,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(Ze,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(Ma,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function fS({availableDates:n,selectedDate:e,onSelectDate:t}){const[i,o]=j.useState(new Date),c=z=>{const G=z.getFullYear(),H=z.getMonth(),ae=new Date(G,H,1),Y=new Date(G,H+1,0).getDate(),T=ae.getDay();return{daysInMonth:Y,startingDayOfWeek:T,year:G,month:H}},{daysInMonth:d,startingDayOfWeek:m,year:x,month:g}=c(i),b=()=>{o(new Date(i.getFullYear(),i.getMonth()-1))},v=()=>{o(new Date(i.getFullYear(),i.getMonth()+1))},_=z=>{const G=`${x}-${String(g+1).padStart(2,"0")}-${String(z).padStart(2,"0")}`;return n.includes(G)},R=z=>`${x}-${String(g+1).padStart(2,"0")}-${String(z).padStart(2,"0")}`===e,B=z=>{if(_(z)){const G=`${x}-${String(g+1).padStart(2,"0")}-${String(z).padStart(2,"0")}`;t(G)}},L=["January","February","March","April","May","June","July","August","September","October","November","December"],O=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return a.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-5 sm:p-6 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-5",children:[a.jsx("button",{onClick:b,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Bg,{className:"w-5 h-5 text-slate-600"})}),a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[L[g]," ",x]}),a.jsx("button",{onClick:v,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(hc,{className:"w-5 h-5 text-slate-600"})})]}),a.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:O.map(z=>a.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:z},z))}),a.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:m}).map((z,G)=>a.jsx("div",{},`empty-${G}`)),Array.from({length:d}).map((z,G)=>{const H=G+1,ae=_(H),ue=R(H),Y=new Date,T=Y.getDate()===H&&Y.getMonth()===g&&Y.getFullYear()===x;return a.jsxs("button",{onClick:()=>B(H),disabled:!ae,className:`
                relative p-2.5 sm:p-3 text-center rounded-lg text-sm font-semibold transition-all duration-200
                ${ue?"bg-blue-600 text-white shadow-md shadow-blue-600/30":ae?"bg-emerald-50 text-emerald-700 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-300 cursor-pointer":T?"text-slate-900 font-bold":"text-slate-300 cursor-not-allowed"}
              `,children:[H,T&&!ue&&a.jsx("span",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]},H)})]}),a.jsxs("div",{className:"mt-4 flex gap-5 text-xs text-slate-500",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 bg-emerald-50 border border-emerald-200 rounded"}),a.jsx("span",{children:"Available"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded"}),a.jsx("span",{children:"Selected"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-1 h-1 bg-blue-500 rounded-full"}),a.jsx("span",{children:"Today"})]})]})]})}const VO=[{key:"monday",label:"Mon"},{key:"tuesday",label:"Tue"},{key:"wednesday",label:"Wed"},{key:"thursday",label:"Thu"},{key:"friday",label:"Fri"},{key:"saturday",label:"Sat"},{key:"sunday",label:"Sun"}],y1=[{key:"morning",label:"Morning (9AM12PM)",start:"09:00",end:"12:00"},{key:"afternoon",label:"Afternoon (12PM5PM)",start:"12:00",end:"17:00"},{key:"evening",label:"Evening (5PM9PM)",start:"17:00",end:"21:00"},{key:"any",label:"Any time",start:"00:00",end:"23:59"}];function LO(){const n="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="WL";for(let t=0;t<4;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}function v1({shopId:n,slug:e,selectedService:t,selectedStaff:i,staffMembers:o,preferredDate:c,onSuccess:d,onCancel:m}){const[x,g]=j.useState({name:"",email:"",phone:""}),[b,v]=j.useState([]),[_,R]=j.useState("any"),[B,L]=j.useState(!1),[O,z]=j.useState(!1),[G,H]=j.useState(""),ae=Y=>{v(T=>T.includes(Y)?T.filter(E=>E!==Y):[...T,Y])},ue=async Y=>{Y.preventDefault(),L(!0);try{const T=LO(),E=y1.find(P=>P.key===_),S=i&&i!=="any"?i.id:"any",k=i&&i!=="any"?i.name:"Any Available",C={clientName:x.name,clientEmail:x.email,clientPhone:x.phone,serviceId:t?.id||null,serviceName:t?.name||"Any Service",staffId:S,staffName:k,preferredDate:c||null,preferredDays:b.length>0?b:null,preferredTimeRange:E?{start:E.start,end:E.end}:null,status:"waiting",refCode:T,createdAt:new Date().toISOString(),notifiedAt:null,notifiedSlot:null};await Ua(Ye(fe,"shops",n,"waitlist"),C),H(T),z(!0),d&&d(T)}catch(T){console.error("Waitlist error:",T)}finally{L(!1)}};return O?a.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg shadow-blue-100/50 p-8 text-center animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Ms,{className:"w-8 h-8 text-blue-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"You're on the Waitlist!"}),a.jsxs("p",{className:"text-slate-600 mb-4",children:["We'll notify you when a slot opens up",t?` for ${t.name}`:"","."]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your waitlist reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:G})]}),a.jsxs("a",{href:`#/shop/${e}/waitlist/${G}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(Wt,{className:"w-4 h-4"}),"Check Waitlist Status"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to check your position and get notified"})]}):a.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg p-6 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(Pf,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Join the Waitlist"}),a.jsx("p",{className:"text-sm text-slate-500",children:"We'll notify you when a slot opens up"})]})]}),a.jsxs("form",{onSubmit:ue,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),a.jsx("input",{type:"text",value:x.name,onChange:Y=>g({...x,name:Y.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:x.email,onChange:Y=>g({...x,email:Y.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),a.jsx("input",{type:"tel",value:x.phone,onChange:Y=>g({...x,phone:Y.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["Preferred Days ",a.jsx("span",{className:"text-slate-400 font-normal",children:"(optional)"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:VO.map(Y=>a.jsx("button",{type:"button",onClick:()=>ae(Y.key),className:`px-3.5 py-2 rounded-lg text-sm font-semibold transition-all border ${b.includes(Y.key)?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:Y.label},Y.key))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preferred Time"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:y1.map(Y=>a.jsx("button",{type:"button",onClick:()=>R(Y.key),className:`px-3.5 py-2.5 rounded-lg text-sm font-medium transition-all border text-left ${_===Y.key?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:Y.label},Y.key))})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:B,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:B?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Joining"]}):a.jsxs(a.Fragment,{children:[a.jsx(Pf,{className:"w-4 h-4"}),"Join Waitlist"]})}),m&&a.jsx("button",{type:"button",onClick:m,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]})}function UO(){return a.jsxs("div",{className:"flex items-end gap-2 mb-3",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:a.jsx(Uf,{className:"w-3.5 h-3.5 text-white"})}),a.jsx("div",{className:"bg-slate-100 rounded-2xl rounded-bl-md px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})}function BO({message:n,onSelectService:e,onQuickReply:t}){const i=n.sender==="bot";return a.jsxs("div",{className:`flex items-end gap-2 mb-3 ${i?"":"flex-row-reverse"}`,children:[i&&a.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:a.jsx(Uf,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("div",{className:"max-w-[85%] space-y-2",children:[a.jsx("div",{className:`px-4 py-2.5 text-sm leading-relaxed whitespace-pre-line ${i?"bg-slate-100 text-slate-800 rounded-2xl rounded-bl-md":"bg-blue-600 text-white rounded-2xl rounded-br-md"}`,children:n.text}),n.serviceCards&&n.serviceCards.length>0&&a.jsx("div",{className:"space-y-1.5",children:n.serviceCards.map(o=>a.jsxs("button",{onClick:()=>e(o),className:"w-full flex items-center justify-between gap-2 px-3.5 py-2.5 bg-white border border-slate-200 hover:border-blue-400 rounded-xl text-left transition-all hover:shadow-sm group",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold text-slate-800 group-hover:text-blue-700 truncate",children:o.name}),a.jsxs("p",{className:"text-xs text-slate-500",children:[df(o.duration),"  ",_x(o.price)]})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 whitespace-nowrap flex items-center gap-0.5",children:["Book ",a.jsx(hc,{className:"w-3 h-3"})]})]},o.id))}),n.quickReplies&&n.quickReplies.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5 pt-1",children:n.quickReplies.map((o,c)=>a.jsx("button",{onClick:()=>t(o),className:"px-3 py-1.5 text-xs font-medium text-blue-600 bg-white border border-blue-200 hover:bg-blue-50 hover:border-blue-400 rounded-full transition-all",children:o},c))})]})]})}function _x(n){return n==null?"":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(n)}function df(n){if(!n)return"";if(n<60)return`${n} min`;const e=Math.floor(n/60),t=n%60;return t?`${e}h ${t}m`:`${e} hour${e>1?"s":""}`}function zO(n,{services:e,staffMembers:t,shop:i}){const o=n.toLowerCase().trim(),c=i?.name||"our shop";if(/^(hi|hello|hey|howdy|sup|yo|hiya|good\s*(morning|afternoon|evening))/.test(o))return{text:`Hi!  I'm here to help you book an appointment at ${c}. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]};if(/how (do i|to|can i) book|help.*(book|appoint)|booking help/i.test(o))return{text:`Booking is easy! Here's how:

1 Choose a service
2 Pick your stylist
3 Select a date & time
4 Fill in your details

That's it! Would you like to start?`,quickReplies:["View Services","View Staff"]};if(/what (services|do you offer)|menu|prices|how much|service list|your services/i.test(o)||o==="view services")return!e||e.length===0?{text:"We don't have any services listed right now. Please check back later!"}:{text:`Here are our services:

${e.map(m=>` ${m.name}  ${df(m.duration)}  ${_x(m.price)}`).join(`
`)}

Would you like to book one of these? Just tap below! `,serviceCards:e};if(e&&e.length>0){const d=e.find(m=>{const x=m.name.toLowerCase();return o.includes(x)||x.includes(o)});if(d&&o.length>2)return{text:`Great choice! Here are the details for **${d.name}**:

 Duration: ${df(d.duration)}
 Price: ${_x(d.price)}${d.description?`
 ${d.description}`:""}

Would you like to book this service? Tap "Book" below!`,serviceCards:[d],quickReplies:["View All Services","View Staff"]}}if(/how long|how much time|duration/i.test(o))return!e||e.length===0?{text:"No services are listed right now. Check back soon!"}:{text:`Here's how long each service takes:

${e.map(m=>` ${m.name}: ${df(m.duration)}`).join(`
`)}`,quickReplies:["View Services","How to Book"]};if(/who works|stylists?|staff|team|barber|who('s| is) (here|available)|your (team|people)/i.test(o)||o==="view staff")return!t||t.length===0?{text:"We don't have any team members listed right now."}:{text:`Meet our team! 

${t.map(m=>{let x=` ${m.name}`;return m.role&&(x+=`  ${m.role}`),m.bio&&(x+=`
  "${m.bio.slice(0,80)}${m.bio.length>80?"":""}"`),x}).join(`
`)}

You can pick your preferred stylist during booking.`,quickReplies:["View Services","How to Book"]};if(/available|open slot|when can i|next available|free slot|any opening/i.test(o)){const d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],m=new Set;return t&&t.length>0&&t.forEach(g=>{g.weeklyHours&&Object.entries(g.weeklyHours).forEach(([b,v])=>{v&&v.enabled&&m.add(b)})}),{text:`You can check available times by selecting a service and date in the booking flow above. We're generally available on ${m.size>0?[...m].sort((g,b)=>d.indexOf(g)-d.indexOf(b)).join(", "):"most days"}. `,quickReplies:["View Services","How to Book"]}}if(/hours|when are you open|business hours|open hours|what time|operating/i.test(o)){const d=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],m={};if(t&&t.length>0&&t.forEach(x=>{x.weeklyHours&&Object.entries(x.weeklyHours).forEach(([g,b])=>{b&&b.enabled&&b.start&&b.end&&(m[g]?(b.start<m[g].start&&(m[g].start=b.start),b.end>m[g].end&&(m[g].end=b.end)):m[g]={start:b.start,end:b.end})})}),Object.keys(m).length>0){const x=b=>{const[v,_]=b.split(":"),R=parseInt(v),B=R>=12?"PM":"AM";return`${R%12||12}:${_} ${B}`};return{text:`Here are our general hours:

${d.filter(b=>m[b]).map(b=>` ${b}: ${x(m[b].start)}  ${x(m[b].end)}`).join(`
`)}

Hours may vary by stylist. Select a service to see exact availability.`,quickReplies:["View Services","View Staff"]}}return{text:"Our hours vary by stylist. You can see exact availability by selecting a service above.",quickReplies:["View Services","How to Book"]}}return/phone|address|contact|where|location|email|reach/i.test(o)?{text:"For contact information, please reach out to the shop directly. You can also find us through the booking confirmation email after you book! ",quickReplies:["View Services","How to Book"]}:/cancel|reschedule|change my (booking|appointment)|modify/i.test(o)?{text:"You can manage your booking using the reference code you received. Go to your confirmation email and click 'Manage Booking' to reschedule or cancel. ",quickReplies:["How to Book","View Services"]}:/waitlist|no availability|fully booked|no slots|all booked|sold out/i.test(o)?{text:"If there are no available slots, you can join our waitlist and we'll notify you when something opens up! Look for the 'Join Waitlist' button when viewing available times. ",quickReplies:["View Services","How to Book"]}:/^(thanks?|thank you|thx|ty|cheers|appreciate)/i.test(o)?{text:"You're welcome!  Let me know if you need anything else.",quickReplies:["View Services","View Staff","How to Book"]}:{text:"I'm not sure about that. You can browse our services above, or try asking about our services, staff, or availability! ",quickReplies:["View Services","View Staff","How to Book"]}}function FO({services:n,staffMembers:e,shop:t,onSelectService:i}){const[o,c]=j.useState(!1),[d,m]=j.useState([]),[x,g]=j.useState(""),[b,v]=j.useState(!1),[_,R]=j.useState(!1),[B,L]=j.useState(!1),[O,z]=j.useState(!1),G=j.useRef(null),H=j.useRef(null),ae=t?.name||"our shop";j.useEffect(()=>{G.current?.scrollIntoView({behavior:"smooth"})},[d,b]),j.useEffect(()=>{o&&setTimeout(()=>H.current?.focus(),100)},[o]);const ue=j.useCallback(()=>{L(!1),z(!0),c(!0),d.length===0&&m([{id:"welcome",sender:"bot",text:`Hi!  Welcome to ${ae}. I can help you find the right service and book an appointment. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]}])},[d.length,ae]),Y=j.useCallback(C=>{v(!0);const P=400+Math.random()*600;setTimeout(()=>{const I=zO(C,{services:n,staffMembers:e,shop:t});m($=>[...$,{id:`bot-${Date.now()}`,sender:"bot",text:I.text,serviceCards:I.serviceCards||null,quickReplies:I.quickReplies||null}]),v(!1)},P)},[n,e,t]),T=j.useCallback(()=>{const C=x.trim();C&&(m(P=>[...P,{id:`user-${Date.now()}`,sender:"user",text:C}]),g(""),Y(C))},[x,Y]),E=j.useCallback(C=>{m(P=>[...P,{id:`user-${Date.now()}`,sender:"user",text:C}]),Y(C)},[Y]),S=j.useCallback(C=>{i&&(i(C),m(P=>[...P,{id:`bot-${Date.now()}`,sender:"bot",text:`Great! I've selected "${C.name}" for you. You can now pick your stylist and time above. `}]),setTimeout(()=>c(!1),1500))},[i]),k=C=>{C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),T())};return a.jsxs(a.Fragment,{children:[B&&!o&&a.jsxs("div",{className:"fixed bottom-24 right-5 z-50 animate-fade-in",children:[a.jsx("button",{onClick:ue,className:"bg-white border border-slate-200 shadow-lg rounded-2xl rounded-br-md px-4 py-3 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all max-w-[220px]",children:"Need help booking? "}),a.jsx("button",{onClick:()=>{L(!1),z(!0)},className:"absolute -top-2 -right-2 w-5 h-5 bg-slate-200 hover:bg-slate-300 rounded-full flex items-center justify-center text-slate-500 transition-colors",children:a.jsx(Os,{className:"w-3 h-3"})})]}),o&&a.jsxs("div",{className:`fixed bottom-20 right-5 z-50 bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden animate-scale-in
                     w-[calc(100vw-2.5rem)] max-w-[380px] h-[min(500px,calc(100vh-7rem))]
                     sm:w-[380px] sm:right-5 sm:bottom-20`,style:{transformOrigin:"bottom right"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Uf,{className:"w-4 h-4"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-bold leading-tight",children:"SpotBookie Assistant"}),a.jsx("p",{className:"text-[11px] text-blue-100",children:"Ask me anything about booking"})]})]}),a.jsx("button",{onClick:()=>c(!1),className:"w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors","aria-label":"Close chat",children:a.jsx(Os,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-0 bg-slate-50/50",children:[d.map(C=>a.jsx(BO,{message:C,onSelectService:S,onQuickReply:E},C.id)),b&&a.jsx(UO,{}),a.jsx("div",{ref:G})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 border-t border-slate-200 bg-white flex-shrink-0",children:[a.jsx("input",{ref:H,type:"text",value:x,onChange:C=>g(C.target.value),onKeyDown:k,placeholder:"Type a message",className:"flex-1 px-3.5 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder:text-slate-400"}),a.jsx("button",{onClick:T,disabled:!x.trim(),className:"w-10 h-10 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-200 disabled:cursor-not-allowed text-white disabled:text-slate-400 rounded-xl flex items-center justify-center transition-all flex-shrink-0","aria-label":"Send message",children:a.jsx(cf,{className:"w-4 h-4"})})]})]}),a.jsx("button",{onClick:()=>{o?c(!1):ue()},className:`fixed bottom-5 right-5 z-50 w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 hover:scale-105 hover:shadow-xl ${o?"bg-slate-700 hover:bg-slate-800":"bg-blue-600 hover:bg-blue-700 chat-bubble-pulse"}`,"aria-label":o?"Close chat assistant":"Open chat assistant",children:o?a.jsx(Os,{className:"w-6 h-6 text-white"}):a.jsx(Uf,{className:"w-6 h-6 text-white"})})]})}var L0={exports:{}},U0,w1;function $O(){if(w1)return U0;w1=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return U0=n,U0}var B0,N1;function qO(){if(N1)return B0;N1=1;var n=$O();function e(){}function t(){}return t.resetWarningCache=e,B0=function(){function i(d,m,x,g,b,v){if(v!==n){var _=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw _.name="Invariant Violation",_}}i.isRequired=i;function o(){return i}var c={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:o,element:i,elementType:i,instanceOf:o,node:i,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:t,resetWarningCache:e};return c.PropTypes=c,c},B0}var j1;function HO(){return j1||(j1=1,L0.exports=qO()()),L0.exports}var GO=HO();const ts=Ax(GO);function _1(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,i)}return t}function S1(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?_1(Object(t),!0).forEach(function(i){mS(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):_1(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function hf(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?hf=function(e){return typeof e}:hf=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hf(n)}function mS(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YO(n,e){if(n==null)return{};var t={},i=Object.keys(n),o,c;for(c=0;c<i.length;c++)o=i[c],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function WO(n,e){if(n==null)return{};var t=YO(n,e),i,o;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(o=0;o<c.length;o++)i=c[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function pS(n,e){return KO(n)||QO(n,e)||XO(n,e)||JO()}function KO(n){if(Array.isArray(n))return n}function QO(n,e){var t=n&&(typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"]);if(t!=null){var i=[],o=!0,c=!1,d,m;try{for(t=t.call(n);!(o=(d=t.next()).done)&&(i.push(d.value),!(e&&i.length===e));o=!0);}catch(x){c=!0,m=x}finally{try{!o&&t.return!=null&&t.return()}finally{if(c)throw m}}return i}}function XO(n,e){if(n){if(typeof n=="string")return E1(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return E1(n,e)}}function E1(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function JO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Nn=function(e,t,i){var o=!!i,c=ss.useRef(i);ss.useEffect(function(){c.current=i},[i]),ss.useEffect(function(){if(!o||!e)return function(){};var d=function(){c.current&&c.current.apply(c,arguments)};return e.on(t,d),function(){e.off(t,d)}},[o,t,e,c])},Sx=function(e){var t=ss.useRef(e);return ss.useEffect(function(){t.current=e},[e]),t.current},tc=function(e){return e!==null&&hf(e)==="object"},ZO=function(e){return tc(e)&&typeof e.then=="function"},eP=function(e){return tc(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},T1="[object Object]",tP=function n(e,t){if(!tc(e)||!tc(t))return e===t;var i=Array.isArray(e),o=Array.isArray(t);if(i!==o)return!1;var c=Object.prototype.toString.call(e)===T1,d=Object.prototype.toString.call(t)===T1;if(c!==d)return!1;if(!c&&!i)return e===t;var m=Object.keys(e),x=Object.keys(t);if(m.length!==x.length)return!1;for(var g={},b=0;b<m.length;b+=1)g[m[b]]=!0;for(var v=0;v<x.length;v+=1)g[x[v]]=!0;var _=Object.keys(g);if(_.length!==m.length)return!1;var R=e,B=t,L=function(z){return n(R[z],B[z])};return _.every(L)},xS=function(e,t,i){return tc(e)?Object.keys(e).reduce(function(o,c){var d=!tc(t)||!tP(e[c],t[c]);return i.includes(c)?(d&&console.warn("Unsupported prop change: options.".concat(c," is not a mutable property.")),o):d?S1(S1({},o||{}),{},mS({},c,e[c])):o},null):null},gS="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",A1=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gS;if(e===null||eP(e))return e;throw new Error(t)},sP=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gS;if(ZO(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(o){return A1(o,t)})};var i=A1(e,t);return i===null?{tag:"empty"}:{tag:"sync",stripe:i}},nP=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.6.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.6.0",url:"https://stripe.com/docs/stripe-js/react"}))},ym=ss.createContext(null);ym.displayName="ElementsContext";var bS=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},yS=function(e){var t=e.stripe,i=e.options,o=e.children,c=ss.useMemo(function(){return sP(t)},[t]),d=ss.useState(function(){return{stripe:c.tag==="sync"?c.stripe:null,elements:c.tag==="sync"?c.stripe.elements(i):null}}),m=pS(d,2),x=m[0],g=m[1];ss.useEffect(function(){var _=!0,R=function(L){g(function(O){return O.stripe?O:{stripe:L,elements:L.elements(i)}})};return c.tag==="async"&&!x.stripe?c.stripePromise.then(function(B){B&&_&&R(B)}):c.tag==="sync"&&!x.stripe&&R(c.stripe),function(){_=!1}},[c,x,i]);var b=Sx(t);ss.useEffect(function(){b!==null&&b!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[b,t]);var v=Sx(i);return ss.useEffect(function(){if(x.elements){var _=xS(i,v,["clientSecret","fonts"]);_&&x.elements.update(_)}},[i,v,x.elements]),ss.useEffect(function(){nP(x.stripe)},[x.stripe]),ss.createElement(ym.Provider,{value:x},o)};yS.propTypes={stripe:ts.any,options:ts.object};var aP=function(e){var t=ss.useContext(ym);return bS(t,e)},rP=function(){var e=aP("calls useElements()"),t=e.elements;return t};ts.func.isRequired;var vS=ss.createContext(null);vS.displayName="CheckoutContext";ts.any,ts.shape({clientSecret:ts.oneOfType([ts.string,ts.instanceOf(Promise)]).isRequired,elementsOptions:ts.object}).isRequired;var Ex=function(e){var t=ss.useContext(vS),i=ss.useContext(ym);if(t){if(i)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t}else return bS(i,e)},iP=["mode"],lP=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},zn=function(e,t){var i="".concat(lP(e),"Element"),o=function(x){var g=x.id,b=x.className,v=x.options,_=v===void 0?{}:v,R=x.onBlur,B=x.onFocus,L=x.onReady,O=x.onChange,z=x.onEscape,G=x.onClick,H=x.onLoadError,ae=x.onLoaderStart,ue=x.onNetworksChange,Y=x.onConfirm,T=x.onCancel,E=x.onShippingAddressChange,S=x.onShippingRateChange,k=x.onSavedPaymentMethodRemove,C=x.onSavedPaymentMethodUpdate,P=Ex("mounts <".concat(i,">")),I="elements"in P?P.elements:null,$="checkoutState"in P?P.checkoutState:null,U=$?.type==="success"||$?.type==="loading"?$.sdk:null,V=ss.useState(null),K=pS(V,2),oe=K[0],Ee=K[1],ye=ss.useRef(null),F=ss.useRef(null);Nn(oe,"blur",R),Nn(oe,"focus",B),Nn(oe,"escape",z),Nn(oe,"click",G),Nn(oe,"loaderror",H),Nn(oe,"loaderstart",ae),Nn(oe,"networkschange",ue),Nn(oe,"confirm",Y),Nn(oe,"cancel",T),Nn(oe,"shippingaddresschange",E),Nn(oe,"shippingratechange",S),Nn(oe,"savedpaymentmethodremove",k),Nn(oe,"savedpaymentmethodupdate",C),Nn(oe,"change",O);var J;L&&(e==="expressCheckout"?J=L:J=function(){L(oe)}),Nn(oe,"ready",J),ss.useLayoutEffect(function(){if(ye.current===null&&F.current!==null&&(I||U)){var xe=null;if(U)switch(e){case"paymentForm":xe=U.createPaymentFormElement(_);break;case"payment":xe=U.createPaymentElement(_);break;case"address":if("mode"in _){var le=_.mode,Ce=WO(_,iP);if(le==="shipping")xe=U.createShippingAddressElement(Ce);else if(le==="billing")xe=U.createBillingAddressElement(Ce);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":xe=U.createExpressCheckoutElement(_);break;case"currencySelector":xe=U.createCurrencySelectorElement();break;case"taxId":xe=U.createTaxIdElement(_);break;default:throw new Error("Invalid Element type ".concat(i,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else I&&(xe=I.create(e,_));ye.current=xe,Ee(xe),xe&&xe.mount(F.current)}},[I,U,_]);var de=Sx(_);return ss.useEffect(function(){if(ye.current){var xe=xS(_,de,["paymentRequest"]);xe&&"update"in ye.current&&ye.current.update(xe)}},[_,de]),ss.useLayoutEffect(function(){return function(){if(ye.current&&typeof ye.current.destroy=="function")try{ye.current.destroy(),ye.current=null}catch{}}},[]),ss.createElement("div",{id:g,className:b,ref:F})},c=function(x){Ex("mounts <".concat(i,">"));var g=x.id,b=x.className;return ss.createElement("div",{id:g,className:b})},d=t?c:o;return d.propTypes={id:ts.string,className:ts.string,onChange:ts.func,onBlur:ts.func,onFocus:ts.func,onReady:ts.func,onEscape:ts.func,onClick:ts.func,onLoadError:ts.func,onLoaderStart:ts.func,onNetworksChange:ts.func,onConfirm:ts.func,onCancel:ts.func,onShippingAddressChange:ts.func,onShippingRateChange:ts.func,onSavedPaymentMethodRemove:ts.func,onSavedPaymentMethodUpdate:ts.func,options:ts.object},d.displayName=i,d.__elementType=e,d},Fn=typeof window>"u",oP=ss.createContext(null);oP.displayName="EmbeddedCheckoutProviderContext";var cP=function(){var e=Ex("calls useStripe()"),t=e.stripe;return t};zn("auBankAccount",Fn);var k1=zn("card",Fn);zn("cardNumber",Fn);zn("cardExpiry",Fn);zn("cardCvc",Fn);zn("iban",Fn);zn("payment",Fn);zn("expressCheckout",Fn);zn("paymentRequestButton",Fn);zn("linkAuthentication",Fn);zn("address",Fn);zn("shippingAddress",Fn);zn("paymentMethodMessaging",Fn);zn("taxId",Fn);function ff(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ff=function(e){return typeof e}:ff=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ff(n)}var wS="clover",uP=function(e){return e===3?"v3":e},NS="https://js.stripe.com",dP="".concat(NS,"/").concat(wS,"/stripe.js"),hP=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,fP=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var mP=function(e){return hP.test(e)||fP.test(e)},pP=function(){for(var e=document.querySelectorAll('script[src^="'.concat(NS,'"]')),t=0;t<e.length;t++){var i=e[t];if(mP(i.src))return i}return null},C1=function(e){var t="",i=document.createElement("script");i.src="".concat(dP).concat(t);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(i),i},xP=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.7.0",startTime:t})},hu=null,$h=null,qh=null,gP=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},bP=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},yP=function(e){return hu!==null?hu:(hu=new Promise(function(t,i){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var o=pP();if(!(o&&e)){if(!o)o=C1(e);else if(o&&qh!==null&&$h!==null){var c;o.removeEventListener("load",qh),o.removeEventListener("error",$h),(c=o.parentNode)===null||c===void 0||c.removeChild(o),o=C1(e)}}qh=bP(t,i),$h=gP(i),o.addEventListener("load",qh),o.addEventListener("error",$h)}catch(d){i(d);return}}),hu.catch(function(t){return hu=null,Promise.reject(t)}))},vP=function(e,t,i){if(e===null)return null;var o=t[0];if(typeof o!="string")throw new Error("Expected publishable key to be of type string, got type ".concat(ff(o)," instead."));var c=o.match(/^pk_test/),d=uP(e.version),m=wS;c&&d!==m&&console.warn("Stripe.js@".concat(d," was loaded on the page, but @stripe/stripe-js@").concat("8.7.0"," expected Stripe.js@").concat(m,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var x=e.apply(void 0,t);return xP(x,i),x},fu,jS=!1,_S=function(){return fu||(fu=yP(null).catch(function(e){return fu=null,Promise.reject(e)}),fu)};Promise.resolve().then(function(){return _S()}).catch(function(n){jS||console.warn(n)});var wP=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];jS=!0;var o=Date.now();return _S().then(function(c){return vP(c,t,o)})};const NP=wP("pk_test_51NXZytLhwB1Jyzw82kEuknbGp3F4vTdnqmBrVmzsHqKYeldrpbiWInM6U2v2ojnsLW4u251zbpRk2UiXnwBgiQZo00bK99q5kj"),jP="https://us-central1-scheduler-65e51.cloudfunctions.net",_P={style:{base:{fontSize:"16px",color:"#1e293b",fontFamily:"system-ui, -apple-system, sans-serif","::placeholder":{color:"#94a3b8"}},invalid:{color:"#ef4444",iconColor:"#ef4444"}}};function SP({amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:m=!0}){const x=cP(),g=rP(),[b,v]=j.useState(!1),[_,R]=j.useState(null),[B,L]=j.useState(!1),O=async G=>{if(G.preventDefault(),!x||!g)return;v(!0),R(null);const H=g.getElement(k1),{error:ae,paymentMethod:ue}=await x.createPaymentMethod({type:"card",card:H,billing_details:{name:i.name,email:i.email,phone:i.phone}});if(ae){R(ae.message),v(!1);return}if(m&&c)try{const Y=await fetch(`${jP}/createDepositPaymentIntent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:c,amount:n,serviceName:o,clientName:i.name,clientEmail:i.email,bookingRefCode:d,paymentMethodId:ue.id})}),T=await Y.json();if(!Y.ok){T.needsConnect?R("This shop has not connected Stripe yet. Please contact the shop owner."):T.needsOnboarding?R("This shop is still setting up payments. Please try again later."):R(T.error||"Payment failed. Please try again."),v(!1);return}console.log("Payment processed:",T.paymentIntentId),v(!1),e({paymentMethodId:ue.id,paymentIntentId:T.paymentIntentId,last4:ue.card.last4,brand:ue.card.brand,amount:T.amount})}catch(Y){console.error("Payment error:",Y),R("Payment failed. Please try again."),v(!1)}else console.log("Payment method created (no Connect):",ue.id),await new Promise(Y=>setTimeout(Y,500)),v(!1),e({paymentMethodId:ue.id,last4:ue.card.last4,brand:ue.card.brand})},z=G=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(G/100);return a.jsxs("form",{onSubmit:O,className:"space-y-5",children:[a.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 rounded-xl p-5 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-emerald-100 text-sm font-medium",children:["Deposit for ",o]}),a.jsx("p",{className:"text-3xl font-bold mt-1",children:z(n)})]}),a.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:a.jsx(Pn,{className:"w-6 h-6"})})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Card Details"}),a.jsx("div",{className:"p-4 border-2 border-slate-200 rounded-xl focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-500/20 transition-all bg-white",children:a.jsx(k1,{options:_P,onChange:G=>{L(G.complete),G.error?R(G.error.message):R(null)}})})]}),_&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:[a.jsx(Ju,{className:"w-4 h-4 flex-shrink-0"}),_]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[a.jsx(Vf,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:"Your payment is secured with 256-bit encryption"})]}),a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-700",children:[a.jsx(Ju,{className:"w-4 h-4 flex-shrink-0"}),a.jsxs("span",{children:[a.jsx("strong",{children:"Test Mode:"})," Use card number ",a.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"4242 4242 4242 4242"})," with any future date and CVC."]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:b||!x||!B,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold shadow-md shadow-emerald-600/20 hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:b?a.jsxs(a.Fragment,{children:[a.jsx(Mn,{className:"w-4 h-4 animate-spin"}),"Processing"]}):a.jsxs(a.Fragment,{children:[a.jsx(Vf,{className:"w-4 h-4"}),"Pay ",z(n)]})}),a.jsx("button",{type:"button",onClick:t,disabled:b,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 disabled:opacity-50",children:"Back"})]})]})}function EP({amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:m=!0}){return a.jsx(yS,{stripe:NP,children:a.jsx(SP,{amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:m})})}const TP=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function ar(n){const[e,t]=n.split(":").map(Number);return e*60+t}function R1(n){const e=Math.floor(n/60),t=n%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}function AP(n){const e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${i}`}function kP(n,e,t){if(!t||t.length===0)return!1;for(const i of t){if(!i||!i.start||!i.end)continue;const o=ar(i.start),c=ar(i.end);if(n<c&&e>o)return!0}return!1}function CP(n,e){if(!e||e.length===0)return n;const t=[...e].filter(o=>o&&o.start&&o.end).sort((o,c)=>ar(o.start)-ar(c.start));let i=n;for(const o of t){const c=ar(o.start),d=ar(o.end);if(i<c)break;i<d&&(i=d)}return i}function RP(n,e,t,i,o,c){if(!n)return[];const m=new Date(e+"T12:00:00").getDay(),x=TP[m],g=n[x];if(!g||!g.enabled)return[];const b=ar(g.start),v=ar(g.end),_=g.breaks||(g.break?[g.break]:[]),R=t+i,B=[];let L=b;for(;L+t<=v;){const O=L+t;if(kP(L,O,_)){L=CP(L,_);continue}B.push({id:`wh-${o}-${e}-${R1(L)}`,date:e,time:R1(L),duration:t,available:!0,staffId:o,staffName:c,generated:!0}),L+=R}return B}function SS(n,e,t=0,i=4){const o=[],c=new Date;c.setHours(0,0,0,0);const d=new Date(c);d.setDate(d.getDate()+i*7);for(const m of n){if(!m.weeklyHours)continue;const x=new Date(c);for(;x<d;){const g=AP(x),b=RP(m.weeklyHours,g,e,t,m.id,m.name);o.push(...b),x.setDate(x.getDate()+1)}}return o}function ES(n,e,t=0){const i=e.filter(o=>!o.status||o.status==="pending"||o.status==="confirmed");return n.filter(o=>{const c=ar(o.time),d=c+o.duration;return!i.some(x=>{if(o.staffId&&x.staffId&&x.staffId!==o.staffId||x.date!==o.date)return!1;const g=ar(x.time),b=x.serviceDuration||x.duration||o.duration,v=g+b;return!(d+t<=g||v+t<=c)})})}function TS(n,e){const t=new Set(e.map(o=>`${o.staffId||""}-${o.date}-${o.time}`)),i=n.filter(o=>{const c=`${o.staffId||""}-${o.date}-${o.time}`;return!t.has(c)});return[...e,...i]}function _u({name:n,className:e="w-12 h-12",bgClass:t="bg-blue-100 text-blue-700"}){const i=(n||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return a.jsx("div",{className:`${e} ${t} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function IP(){return a.jsxs(Ze,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(sa,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function DP({member:n,onClose:e}){const[t,i]=j.useState(null),o=n.portfolio||[];return j.useEffect(()=>{const c=d=>{d.key==="Escape"&&(t!==null?i(null):e())};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,e]),a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in",children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center text-slate-600 transition-all z-10",children:a.jsx(Os,{className:"w-4 h-4"})}),a.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(_u,{name:n.name,className:"w-14 h-14",bgClass:"bg-violet-100 text-violet-700"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name}),n.role&&a.jsx("p",{className:"text-sm text-violet-600 font-medium",children:n.role})]})]}),n.bio&&a.jsx("p",{className:"mt-3 text-sm text-slate-600 leading-relaxed",children:n.bio})]}),a.jsx("div",{className:"p-6",children:o.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(bm,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:o.map((c,d)=>a.jsxs("button",{onClick:()=>i(d),className:"group relative aspect-square rounded-xl overflow-hidden bg-slate-100 shadow-sm hover:shadow-md transition-all hover:-translate-y-0.5",children:[a.jsx("img",{src:c.url,alt:c.caption||"Portfolio",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),c.caption&&a.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/70 to-transparent p-2.5 pt-6",children:a.jsx("p",{className:"text-xs text-white font-medium truncate",children:c.caption})})]},d))})})]}),t!==null&&o[t]&&a.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/90",children:[a.jsx("button",{onClick:()=>i(null),className:"absolute top-4 right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(Os,{className:"w-5 h-5"})}),t>0&&a.jsx("button",{onClick:()=>i(t-1),className:"absolute left-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(Bg,{className:"w-5 h-5"})}),t<o.length-1&&a.jsx("button",{onClick:()=>i(t+1),className:"absolute right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(hc,{className:"w-5 h-5"})}),a.jsxs("div",{className:"max-w-4xl max-h-[85vh] flex flex-col items-center",children:[a.jsx("img",{src:o[t].url,alt:o[t].caption||"Portfolio",className:"max-w-full max-h-[75vh] object-contain rounded-lg"}),o[t].caption&&a.jsx("p",{className:"mt-3 text-sm text-white/90 font-medium text-center px-4",children:o[t].caption}),a.jsxs("p",{className:"mt-1 text-xs text-white/50",children:[t+1," / ",o.length]})]})]})]})}function MP(){const{slug:n}=rc(),[e,t]=j.useState(null),[i,o]=j.useState(null),[c,d]=j.useState(!0),[m,x]=j.useState(!1),[g,b]=j.useState([]),[v,_]=j.useState([]),[R,B]=j.useState(null),[L,O]=j.useState(null),[z,G]=j.useState([]),[H,ae]=j.useState([]),[ue,Y]=j.useState(!1),[T,E]=j.useState(null),[S,k]=j.useState(null),[C,P]=j.useState(""),[I,$]=j.useState(!1),[U,V]=j.useState({name:"",email:"",phone:""}),[K,oe]=j.useState(""),[Ee,ye]=j.useState(!1),[F,J]=j.useState(null),[de,xe]=j.useState(!1),[le,Ce]=j.useState("biweekly"),[$e,Ct]=j.useState(null),[ot,qt]=j.useState(!1),[Z,je]=j.useState(null);j.useEffect(()=>{(async()=>{d(!0),x(!1);try{const Ie=pn(Ye(fe,"shops"),cn("slug","==",n)),ft=await ys(Ie);if(ft.empty)x(!0);else{const vt=ft.docs[0];t(vt.data()),o(vt.id)}}catch(Ie){console.error("Error looking up shop:",Ie),x(!0)}finally{d(!1)}})()},[n]),j.useEffect(()=>{if(!i)return;const _e=ns(Ye(fe,"shops",i,"services"),Rt=>{const Qe=Rt.docs.map(st=>({id:st.id,...st.data()})).filter(st=>st.active!==!1).sort((st,Mt)=>(st.name||"").localeCompare(Mt.name||""));b(Qe)}),Ie=ns(Ye(fe,"shops",i,"availability"),Rt=>{const Qe=new Date,st=Rt.docs.map(Mt=>({id:Mt.id,...Mt.data()})).filter(Mt=>new Date(`${Mt.date}T${Mt.time}`)>Qe);G(st)}),ft=ns(Ye(fe,"shops",i,"bookings"),Rt=>{const Qe=Rt.docs.map(st=>({id:st.id,...st.data()}));ae(Qe)}),vt=ns(Ye(fe,"shops",i,"staff"),Rt=>{const Qe=Rt.docs.map(st=>({id:st.id,...st.data()})).filter(st=>st.active!==!1).sort((st,Mt)=>(st.name||"").localeCompare(Mt.name||""));_(Qe)});return()=>{_e(),Ie(),ft(),vt()}},[i]),j.useEffect(()=>{v.length===1?O(v[0]):v.length===0&&O(null)},[v]);const Se=g.length>0;v.length>0;const qe=v.length>1,tt=e?.bufferMinutes||0,gt=j.useMemo(()=>{const _e=new Date;let Ie=z.filter(Qe=>Qe.available);if(R&&(Ie=Ie.filter(Qe=>Qe.duration>=R.duration)),L&&L!=="any"&&(Ie=Ie.filter(Qe=>Qe.staffId===L.id||!Qe.staffId)),!R)return Ie;const ft=L&&L!=="any"?v.filter(Qe=>Qe.id===L.id):v,vt=SS(ft,R.duration,tt,4).filter(Qe=>new Date(`${Qe.date}T${Qe.time}`)>_e),Rt=TS(vt,Ie);return ES(Rt,H,tt)},[z,R,L,v,H,tt]),Ks=(_e,Ie,ft=3)=>{const vt=[],Rt=new Date(_e+"T12:00:00"),Qe=new Date(Rt);Qe.setMonth(Qe.getMonth()+ft);let st=new Date(Rt);for(Ie==="weekly"?st.setDate(st.getDate()+7):Ie==="biweekly"?st.setDate(st.getDate()+14):Ie==="fourweekly"?st.setDate(st.getDate()+28):Ie==="monthly"&&st.setMonth(st.getMonth()+1);st<=Qe;){const Mt=st.getFullYear(),Ns=String(st.getMonth()+1).padStart(2,"0"),bn=String(st.getDate()).padStart(2,"0");vt.push(`${Mt}-${Ns}-${bn}`),Ie==="weekly"?st.setDate(st.getDate()+7):Ie==="biweekly"?st.setDate(st.getDate()+14):Ie==="fourweekly"?st.setDate(st.getDate()+28):Ie==="monthly"&&st.setMonth(st.getMonth()+1)}return vt},Ot=j.useMemo(()=>{if(!de||!T)return null;const _e=Ks(T.date,le),Ie=R?R.duration:T.duration||60,ft=L&&L!=="any"?L.id:T.staffId,vt=T.time,Rt=H.filter(bs=>!bs.status||bs.status==="pending"||bs.status==="confirmed"),Qe=bs=>{const[Fa,js]=bs.split(":").map(Number);return Fa*60+js},st=Qe(vt),Mt=st+Ie;let Ns=[],bn=[];const ls=new Set;_e.forEach(bs=>{Rt.some(js=>{if(ft&&js.staffId&&js.staffId!==ft||js.date!==bs)return!1;const Qs=Qe(js.time),os=js.serviceDuration||js.duration||Ie,D=Qs+os,Q=tt||0;return!(Mt+Q<=Qs||D+Q<=st)})||ls.has(bs)?bn.push(bs):(Ns.push(bs),ls.add(bs))});const $n=_e.length>0?_e[_e.length-1]:T.date,_a=new Date($n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),qn={weekly:"week",biweekly:"2 weeks",fourweekly:"4 weeks",monthly:"month"};return{available:Ns,conflicts:bn,total:Ns.length+1,skipped:bn.length,endDate:_a,intervalLabel:qn[le]||le}},[de,le,T,R,L,H,tt]),bt=_e=>{B(_e),v.length>1&&O(null),k(null),E(null),Y(!1),P("")},Re=_e=>{O(_e),k(null),E(null),Y(!1),P("")},Be=()=>{B(null),v.length>1&&O(null),k(null),E(null),Y(!1)},pe=()=>{k(null),E(null),Y(!1),qe?O(null):Se&&B(null)},We=_e=>{E(_e),Y(!0),P("")},Le=()=>{const _e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let Ie="BK";for(let ft=0;ft<4;ft++)Ie+=_e.charAt(Math.floor(Math.random()*_e.length));return Ie},De=_e=>{_e.preventDefault(),yt?qt(!0):He()},Ge=_e=>{je(_e),He(_e)},He=async(_e=null)=>{$(!0),Ct(null);try{const Ie=Le(),ft=e?.requireApproval?"pending":"confirmed",vt=de?`rg-${Date.now()}-${Math.random().toString(36).slice(2,8)}`:null,Rt=de&&Ot?Ot.endDate:null,Qe={slotId:T.id,date:T.date,time:T.time,duration:R?R.duration:T.duration,clientName:U.name,clientEmail:U.email,clientPhone:U.phone,bookedAt:new Date().toISOString(),status:ft,refCode:Ie};if(R&&(Qe.serviceId=R.id,Qe.serviceName=R.name,Qe.servicePrice=R.price,Qe.serviceDuration=R.duration,Qe.depositPercent=R.depositPercent||0),_e||Z){const Ns=_e||Z;Qe.depositPaid=!0,Qe.depositAmount=gs/100,Qe.paymentMethodId=Ns.paymentMethodId,Qe.cardLast4=Ns.last4,Qe.cardBrand=Ns.brand}L&&L!=="any"?(Qe.staffId=L.id,Qe.staffName=L.name):T.staffId&&(Qe.staffId=T.staffId,Qe.staffName=T.staffName||""),de&&vt&&(Qe.recurring=!0,Qe.recurringInterval=le,Qe.recurringGroupId=vt,Qe.recurringUntil=Rt),await Ua(Ye(fe,"shops",i,"bookings"),Qe),T.generated||await Ke(Me(fe,"shops",i,"availability",T.id),{available:!1});let st=1,Mt=0;if(de&&Ot){const Ns=Ot.available;Mt=Ot.skipped;for(const bn of Ns){const ls=Le(),$n={...Qe,date:bn,slotId:`recurring-${vt}-${bn}`,refCode:ls,bookedAt:new Date().toISOString()};await Ua(Ye(fe,"shops",i,"bookings"),$n),st++}Ct({created:st,skipped:Mt})}V({name:"",email:"",phone:""}),Y(!1),qt(!1),je(null),E(null),B(null),k(null),O(v.length===1?v[0]:null),xe(!1),oe(Ie),e?.requireApproval?P(" Your booking request has been submitted! The shop will review and confirm it shortly."):P(" Booking confirmed! You will receive a confirmation email shortly.")}catch(Ie){console.error("Booking error:",Ie),P(" Something went wrong. Please try again.")}finally{$(!1)}},ee=_e=>new Date(_e+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),ke=_e=>{const[Ie,ft]=_e.split(":"),vt=parseInt(Ie),Rt=vt>=12?"PM":"AM";return`${vt%12||12}:${ft} ${Rt}`},nt=_e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(_e),it=_e=>{if(_e<60)return`${_e} min`;const Ie=Math.floor(_e/60),ft=_e%60;return ft?`${Ie}h ${ft}m`:`${Ie} hour${Ie>1?"s":""}`};if(c)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking page"})]})});if(m)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(_t,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(Ze,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Ma,{className:"w-4 h-4"}),"Go Home"]})]})});if(e?.archived)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-amber-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Pu,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Unavailable"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[a.jsx("span",{className:"font-semibold",children:e.name})," is currently not accepting new bookings. Please check back later or contact the shop directly."]}),a.jsxs(Ze,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Ma,{className:"w-4 h-4"}),"Go Home"]})]})});const Bt=[...new Set(gt.map(_e=>_e.date))].sort(),is=S?gt.filter(_e=>_e.date===S):gt,yt=R&&R.depositPercent>0,gs=yt?Math.round(R.price*(R.depositPercent/100)*100):0,ws=ot?"payment":ue?"form":Se&&!R?"services":qe&&!L?"staff":"calendar",Ps=[];Se&&Ps.push({key:"services",label:"Service"}),qe&&Ps.push({key:"staff",label:"Stylist"}),Ps.push({key:"calendar",label:"Date & Time"}),Ps.push({key:"form",label:"Details"}),yt&&Ps.push({key:"payment",label:"Payment"});const ra=Ps.findIndex(_e=>_e.key===ws),Vs=["border-l-blue-500","border-l-violet-500","border-l-emerald-500","border-l-amber-500","border-l-rose-500","border-l-cyan-500","border-l-indigo-500","border-l-pink-500","border-l-teal-500"];return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[e.logoUrl?a.jsx("img",{src:e.logoUrl,alt:`${e.name} logo`,className:"w-10 h-10 rounded-xl object-cover shadow-md"}):a.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md",style:{backgroundColor:e.brandColor||"#3B82F6"},children:(e.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e.name}),a.jsx("p",{className:"text-xs text-slate-500",children:e.tagline||"Book your appointment"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(Ze,{to:`/shop/${n}/login`,className:"flex items-center gap-1.5 px-3.5 py-2 text-xs font-medium text-slate-500 hover:text-slate-700 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[a.jsx(Vf,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Owner"})]}),a.jsx(IP,{})]})]})}),a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[Ps.length>1&&a.jsx("div",{className:"flex items-center justify-center gap-0 mb-8 animate-fade-in",children:Ps.map((_e,Ie)=>{const ft=_e.key===ws,vt=Ie<ra;return a.jsxs(j.Fragment,{children:[Ie>0&&a.jsx("div",{className:`w-8 sm:w-14 h-0.5 transition-colors duration-300 ${Ie<=ra?"bg-blue-500":"bg-slate-200"}`}),a.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[a.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 ${ft?"bg-blue-600 text-white shadow-md shadow-blue-600/30 scale-110":vt?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:vt?a.jsx(Ms,{className:"w-5 h-5"}):Ie+1}),a.jsx("span",{className:`text-xs font-medium hidden sm:block transition-colors ${ft?"text-blue-700":vt?"text-blue-600":"text-slate-400"}`,children:_e.label})]})]},_e.key)})}),C&&a.jsx("div",{className:"mb-8 animate-scale-in",children:C.startsWith("")?a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(lS,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Confirmed!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"You're all set. We'll send a confirmation to your email."}),$e&&a.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[a.jsx(Li,{className:"w-4 h-4"}),"Recurring Series Created"]}),a.jsxs("p",{className:"text-sm text-slate-700",children:[$e.created," appointment",$e.created!==1?"s":""," booked"]}),$e.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",$e.skipped," date",$e.skipped!==1?"s":""," skipped due to conflicts"]})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:K})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsxs(Ze,{to:`/shop/${n}/booking/${K}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(sa,{className:"w-4 h-4"}),"Manage Your Booking"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-lg text-sm text-emerald-700 font-medium",children:[a.jsx(sa,{className:"w-4 h-4"}),"Add to your calendar to remember"]})]}):C.startsWith("")?a.jsxs("div",{className:"bg-white rounded-2xl border border-amber-200 shadow-lg shadow-amber-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Wt,{className:"w-8 h-8 text-amber-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Request Submitted!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking request has been submitted! The shop will review and confirm it shortly."}),$e&&a.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[a.jsx(Li,{className:"w-4 h-4"}),"Recurring Series Created"]}),a.jsxs("p",{className:"text-sm text-slate-700",children:[$e.created," appointment",$e.created!==1?"s":""," submitted"]}),$e.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",$e.skipped," date",$e.skipped!==1?"s":""," skipped due to conflicts"]})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:K})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsxs(Ze,{to:`/shop/${n}/booking/${K}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(sa,{className:"w-4 h-4"}),"Manage Your Booking"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-700 font-medium",children:[a.jsx(Wt,{className:"w-4 h-4"}),"You'll be notified once it's confirmed"]})]}):a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Something went wrong. Please try again."})]})}),ws==="services"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a Service"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select the service you'd like to book"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 stagger-children",children:g.map((_e,Ie)=>a.jsxs("button",{onClick:()=>bt(_e),className:`group text-left bg-white border-l-4 ${Vs[Ie%Vs.length]} border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5`,children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors pr-2",children:_e.name}),a.jsx("span",{className:"text-xl font-extrabold text-blue-600 whitespace-nowrap",children:nt(_e.price)})]}),_e.description&&a.jsx("p",{className:"text-sm text-slate-500 mb-3 line-clamp-2 leading-relaxed",children:_e.description}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-400",children:[a.jsx(Wt,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:it(_e.duration)})]}),a.jsx("span",{className:"text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]})]},_e.id))})]}),ws==="staff"&&a.jsxs("div",{className:"animate-fade-in",children:[Se&&R&&a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:Be,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(Ma,{className:"w-3.5 h-3.5"}),"Back"]}),a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Un,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:R.name}),a.jsx("span",{className:"text-blue-600 font-bold",children:nt(R.price)})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose Your Stylist"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select your preferred professional"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 stagger-children",children:[a.jsxs("button",{onClick:()=>Re("any"),className:"group text-left bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-3.5 mb-3",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Ft,{className:"w-5 h-5 text-slate-500"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:"Any Available"}),a.jsx("p",{className:"text-xs text-slate-500",children:"First available professional"})]})]}),a.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),v.map(_e=>{const Ie=_e.portfolio||[];return a.jsxs("div",{className:"group bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[a.jsxs("button",{onClick:()=>Re(_e),className:"w-full text-left",children:[a.jsxs("div",{className:"flex items-center gap-3.5 mb-2",children:[a.jsx(_u,{name:_e.name}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:_e.name}),_e.role&&a.jsx("p",{className:"text-xs text-slate-500",children:_e.role})]})]}),_e.bio&&a.jsx("p",{className:"text-xs text-slate-500 leading-relaxed mb-2 line-clamp-2",children:_e.bio}),Ie.length>0&&a.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[Ie.slice(0,3).map((ft,vt)=>a.jsx("img",{src:ft.url,alt:ft.caption||"Work",className:"w-10 h-10 rounded-md object-cover border border-slate-200"},vt)),Ie.length>3&&a.jsxs("span",{className:"w-10 h-10 rounded-md bg-slate-100 border border-slate-200 flex items-center justify-center text-xs text-slate-500 font-semibold",children:["+",Ie.length-3]})]}),a.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),Ie.length>0&&a.jsxs("button",{onClick:ft=>{ft.stopPropagation(),J(_e)},className:"mt-2 w-full flex items-center justify-center gap-1.5 py-1.5 text-xs font-semibold text-violet-600 hover:text-violet-700 hover:bg-violet-50 rounded-lg transition-all",children:[a.jsx(bm,{className:"w-3.5 h-3.5"}),"View Portfolio (",Ie.length,")"]})]},_e.id)})]})]}),ws==="calendar"&&a.jsxs("div",{className:"animate-fade-in",children:[(Se||qe)&&a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:pe,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(Ma,{className:"w-3.5 h-3.5"}),"Back"]}),R&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Un,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:R.name}),a.jsx("span",{className:"text-blue-600 font-bold",children:nt(R.price)}),a.jsxs("span",{className:"text-slate-400",children:[" ",it(R.duration)]})]}),L&&L!=="any"&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[a.jsx(_u,{name:L.name,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:L.name})]}),L==="any"&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm",children:[a.jsx(Ft,{className:"w-3.5 h-3.5 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-700",children:"Any Available"})]})]}),Bt.length===0?a.jsx("div",{children:Ee?a.jsx("div",{className:"max-w-lg mx-auto",children:a.jsx(v1,{shopId:i,slug:n,selectedService:R,selectedStaff:L,staffMembers:v,preferredDate:null,onCancel:()=>ye(!1)})}):a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(_t,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),a.jsx("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:R?`No time slots available for ${R.name} (${it(R.duration)}). Join the waitlist to be notified when a slot opens up!`:"Check back soon for new availability, or join the waitlist!"}),a.jsxs("button",{onClick:()=>ye(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:[a.jsx(Pf,{className:"w-4 h-4"}),"Join Waitlist"]})]})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Select a Date"}),a.jsx("p",{className:"text-slate-500 text-sm",children:"Pick a day that works for you"})]}),a.jsx("div",{className:"mb-8",children:a.jsx(fS,{availableDates:Bt,selectedDate:S,onSelectDate:k})}),S&&a.jsxs("div",{className:"animate-slide-down",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",ee(S)]}),a.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[is.length," slot",is.length!==1?"s":""]})]}),is.length===0?a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:[a.jsx("p",{className:"text-slate-500 mb-4",children:"No times available for this date"}),Ee?a.jsx("div",{className:"mt-4 text-left",children:a.jsx(v1,{shopId:i,slug:n,selectedService:R,selectedStaff:L,staffMembers:v,preferredDate:S,onCancel:()=>ye(!1)})}):a.jsxs("button",{onClick:()=>ye(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(Pf,{className:"w-4 h-4"}),"Join the Waitlist"]})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:is.sort((_e,Ie)=>_e.time.localeCompare(Ie.time)).map(_e=>a.jsxs("button",{onClick:()=>We(_e),className:"group bg-white border border-slate-200 hover:border-blue-400 rounded-xl p-4 transition-all duration-200 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-slate-900 group-hover:text-blue-700 transition-colors mb-1",children:ke(_e.time)}),_e.staffName&&L==="any"&&a.jsxs("div",{className:"text-xs text-violet-600 mb-0.5 flex items-center justify-center gap-1",children:[a.jsx(Ft,{className:"w-3 h-3"}),_e.staffName]}),a.jsx("div",{className:"text-xs text-slate-400",children:R?it(R.duration):`${_e.duration} min`})]},_e.id))})]}),!S&&a.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]}),ws==="form"&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Complete Your Booking"}),a.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Review your details and confirm"}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[R&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Un,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:R.name})]}),a.jsx("span",{className:"font-bold text-blue-600",children:nt(R.price)})]}),L&&L!=="any"&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(_u,{name:L.name,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-800",children:L.name}),L.role&&a.jsxs("span",{className:"text-slate-400 text-sm ml-1.5",children:[" ",L.role]})]})]}),L==="any"&&T?.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(_u,{name:T.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:T.staffName})]}),a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(_t,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[ee(T.date)," at ",ke(T.time)]})]}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Wt,{className:"w-4 h-4 text-slate-500"})}),a.jsx("span",{children:R?it(R.duration):`${T.duration} min`})]})]}),a.jsxs("form",{onSubmit:De,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),a.jsx("input",{type:"text",value:U.name,onChange:_e=>V({...U,name:_e.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:U.email,onChange:_e=>V({...U,email:_e.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),a.jsx("input",{type:"tel",value:U.phone,onChange:_e=>V({...U,phone:_e.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Li,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Make this recurring"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Book the same slot on a regular schedule"})]})]}),a.jsx("button",{type:"button",onClick:()=>xe(!de),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${de?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${de?"translate-x-6":"translate-x-1"}`})})]}),de&&a.jsxs("div",{className:"space-y-3 pt-1 animate-fade-in",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Repeat every"}),a.jsxs("select",{value:le,onChange:_e=>Ce(_e.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[a.jsx("option",{value:"weekly",children:"Week"}),a.jsx("option",{value:"biweekly",children:"2 Weeks"}),a.jsx("option",{value:"fourweekly",children:"4 Weeks"}),a.jsx("option",{value:"monthly",children:"Month"})]})]}),Ot&&a.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:[" Every ",Ot.intervalLabel," through ",Ot.endDate]}),a.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[Ot.total," total appointment",Ot.total!==1?"s":""]}),Ot.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1 font-medium",children:[" ",Ot.skipped," date",Ot.skipped!==1?"s":""," will be skipped due to existing bookings"]})]})]})]}),yt&&a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Pn,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm font-semibold text-emerald-800",children:["$",(gs/100).toFixed(2)," deposit required"]}),a.jsxs("p",{className:"text-xs text-emerald-600",children:[R.depositPercent,"% of service price  Remaining $",(R.price-gs/100).toFixed(2)," due at appointment"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:I,className:`flex-1 flex items-center justify-center gap-2 px-6 py-3.5 ${yt?"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-600/20 hover:shadow-emerald-600/25":""} text-white rounded-xl font-semibold shadow-md hover:shadow-lg transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0`,style:yt?{}:{backgroundColor:e.brandColor||"#3B82F6"},children:I?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):yt?a.jsxs(a.Fragment,{children:[a.jsx(Pn,{className:"w-4 h-4"}),"Continue to Payment"]}):a.jsxs(a.Fragment,{children:[a.jsx(Ms,{className:"w-4 h-4"}),"Confirm Booking"]})}),a.jsx("button",{type:"button",onClick:()=>{Y(!1),E(null)},className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]}),ws==="payment"&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Secure Payment"}),a.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Complete your deposit to confirm your booking"}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(_t,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-800",children:R?.name}),a.jsxs("p",{className:"text-sm text-slate-500",children:[T&&ee(T.date)," at ",T&&ke(T.time)]})]})]}),a.jsxs("div",{className:"text-sm text-slate-600 pl-13",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Client:"})," ",U.name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",U.email]})]})]}),!e?.payoutsEnabled&&(!e?.subscriptionTier||e?.subscriptionTier==="free")&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(Pn,{className:"w-4 h-4 text-red-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800 text-sm",children:"Booking Unavailable"}),a.jsx("p",{className:"text-xs text-red-700 mt-1",children:"This shop is still setting up their payment system and cannot accept bookings yet. Please check back later or contact the shop directly."})]})]})}),!e?.payoutsEnabled&&e?.subscriptionTier&&e?.subscriptionTier!=="free"&&a.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(Pn,{className:"w-4 h-4 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-amber-800 text-sm",children:"Payment Setup in Progress"}),a.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"This shop is still setting up their payment system. You can still book, but payment will be collected at the time of your appointment."}),a.jsx("button",{onClick:()=>He(),disabled:I,className:"mt-3 flex items-center gap-2 px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg font-semibold text-sm transition-all disabled:opacity-50",children:I?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):a.jsxs(a.Fragment,{children:[a.jsx(Ms,{className:"w-4 h-4"}),"Book Without Deposit"]})})]})]})}),e?.payoutsEnabled&&a.jsx(EP,{amount:gs,serviceName:R?.name||"Service",clientInfo:U,onSuccess:Ge,onCancel:()=>qt(!1),shopId:i,bookingRefCode:null,shopHasConnect:e?.payoutsEnabled}),!e?.payoutsEnabled&&a.jsx("button",{onClick:()=>qt(!1),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 mt-4",children:" Back"})]})]}),F&&a.jsx(DP,{member:F,onClose:()=>J(null)}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(Ze,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})}),a.jsx(FO,{services:g,staffMembers:v,shop:e,onSelectService:bt})]})}function OP({slotsByDate:n,bookingsByDate:e,selectedDate:t,onSelectDate:i,recurringDayFlags:o={},breaksByDate:c={}}){const[d,m]=j.useState(new Date),x=ue=>{const Y=ue.getFullYear(),T=ue.getMonth(),E=new Date(Y,T,1),k=new Date(Y,T+1,0).getDate(),C=E.getDay();return{daysInMonth:k,startingDayOfWeek:C,year:Y,month:T}},{daysInMonth:g,startingDayOfWeek:b,year:v,month:_}=x(d),R=()=>{m(new Date(d.getFullYear(),d.getMonth()-1))},B=()=>{m(new Date(d.getFullYear(),d.getMonth()+1))},L=ue=>`${v}-${String(_+1).padStart(2,"0")}-${String(ue).padStart(2,"0")}`,O=ue=>{const Y=L(ue),T=n[Y]||[],E=e[Y]||[],S=c[Y]||[],k=T.filter(I=>I.available).length,C=E.length,P=S.length;return{availableCount:k,bookedCount:C,breakCount:P,hasData:T.length>0||E.length>0||P>0}},z=ue=>{const Y=L(ue);i(Y===t?null:Y)},G=["January","February","March","April","May","June","July","August","September","October","November","December"],H=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ae=new Date;return ae.setHours(0,0,0,0),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-5",children:[a.jsx("button",{onClick:R,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Bg,{className:"w-5 h-5 text-slate-600"})}),a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[G[_]," ",v]}),a.jsx("button",{onClick:B,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(hc,{className:"w-5 h-5 text-slate-600"})})]}),a.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:H.map(ue=>a.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:ue},ue))}),a.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:b}).map((ue,Y)=>a.jsx("div",{},`empty-${Y}`)),Array.from({length:g}).map((ue,Y)=>{const T=Y+1,E=L(T),{availableCount:S,bookedCount:k,breakCount:C,hasData:P}=O(T),I=E===t,$=new Date,U=$.getDate()===T&&$.getMonth()===_&&$.getFullYear()===v,V=new Date(v,_,T),K=V.getDay(),oe=o[K]&&V>=ae;return a.jsxs("button",{onClick:()=>z(T),className:`
                relative p-2 text-center rounded-lg text-sm font-semibold transition-all duration-200 min-h-[56px] flex flex-col items-center justify-start cursor-pointer
                ${I?"bg-blue-600 text-white shadow-md shadow-blue-600/30":P||oe?"bg-slate-50 hover:bg-slate-100 text-slate-900 border border-slate-200 hover:border-slate-300":U?"text-slate-900 font-bold hover:bg-slate-50":"text-slate-400 hover:bg-slate-50"}
              `,children:[a.jsxs("span",{className:`text-sm ${U&&!I?"relative":""}`,children:[T,U&&!I&&a.jsx("span",{className:"absolute -bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]}),(P||oe)&&a.jsxs("div",{className:"flex gap-0.5 mt-1 flex-wrap justify-center",children:[oe&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${I?"bg-white/20 text-white":"bg-violet-100 text-violet-700"}`,children:"R"}),C>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${I?"bg-white/20 text-white":"bg-amber-100 text-amber-700"}`,children:""}),S>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${I?"bg-white/20 text-white":"bg-emerald-100 text-emerald-700"}`,children:S}),k>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${I?"bg-white/20 text-white":"bg-blue-100 text-blue-700"}`,children:k})]})]},T)})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-xs text-slate-500",children:[Object.keys(o).length>0&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-violet-100 border border-violet-200 rounded flex items-center justify-center text-[7px] font-bold text-violet-700",children:"R"}),a.jsx("span",{children:"Recurring"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-amber-100 border border-amber-200 rounded flex items-center justify-center text-[8px]",children:""}),a.jsx("span",{children:"Break"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-emerald-100 border border-emerald-200 rounded"}),a.jsx("span",{children:"Available"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-blue-100 border border-blue-200 rounded"}),a.jsx("span",{children:"Booked"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-blue-600 rounded"}),a.jsx("span",{children:"Selected"})]})]})]})}const PP=[{value:15,label:"15 min"},{value:30,label:"30 min"},{value:45,label:"45 min"},{value:60,label:"1 hour"},{value:90,label:"1.5 hours"},{value:120,label:"2 hours"}],VP=[{value:0,label:"No deposit required"},{value:10,label:"10%"},{value:20,label:"20%"},{value:25,label:"25%"},{value:50,label:"50%"},{value:100,label:"Full payment upfront"}];function LP({shopId:n}){const[e,t]=j.useState([]),[i,o]=j.useState(!1),[c,d]=j.useState(null),[m,x]=j.useState({name:"",description:"",duration:30,price:"",depositPercent:0}),[g,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;const z=ns(Ye(fe,"shops",n,"services"),G=>{const H=G.docs.map(ae=>({id:ae.id,...ae.data()})).filter(ae=>ae.active!==!1).sort((ae,ue)=>(ae.name||"").localeCompare(ue.name||""));t(H)});return()=>z()},[n]);const v=()=>{x({name:"",description:"",duration:30,price:"",depositPercent:0}),o(!1),d(null)},_=async z=>{z.preventDefault(),b(!0);const G={name:m.name.trim(),description:m.description.trim(),duration:parseInt(m.duration),price:parseFloat(m.price),depositPercent:parseInt(m.depositPercent)||0,active:!0};try{c?await Ke(Me(fe,"shops",n,"services",c),G):await Ua(Ye(fe,"shops",n,"services"),{...G,createdAt:On()}),v()}catch(H){console.error("Error saving service:",H)}finally{b(!1)}},R=z=>{x({name:z.name,description:z.description||"",duration:z.duration,price:z.price.toString(),depositPercent:z.depositPercent||0}),d(z.id),o(!0)},B=async z=>{try{await Ke(Me(fe,"shops",n,"services",z),{active:!1})}catch(G){console.error("Error deleting service:",G)}},L=z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(z),O=z=>{if(z<60)return`${z} min`;const G=Math.floor(z/60),H=z%60;return H?`${G}h ${H}m`:`${G}h`};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Services"}),a.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Define the services you offer  clients will pick one before booking"})]}),!i&&a.jsxs("button",{onClick:()=>{v(),o(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(dr,{className:"w-4 h-4"}),"Add Service"]})]}),i&&a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:c?"Edit Service":"New Service"}),a.jsxs("form",{onSubmit:_,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Service Name *"}),a.jsx("input",{type:"text",value:m.name,onChange:z=>x({...m,name:z.target.value}),required:!0,placeholder:"e.g. Haircut",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description (optional)"}),a.jsx("input",{type:"text",value:m.description,onChange:z=>x({...m,description:z.target.value}),placeholder:"e.g. Classic cut and style",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Duration *"}),a.jsx("select",{value:m.duration,onChange:z=>x({...m,duration:z.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:PP.map(z=>a.jsx("option",{value:z.value,children:z.label},z.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Price (USD) *"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-semibold",children:"$"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:m.price,onChange:z=>x({...m,price:z.target.value}),required:!0,placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx(Pn,{className:"w-4 h-4 text-emerald-500"}),"Deposit Required"]})}),a.jsx("select",{value:m.depositPercent,onChange:z=>x({...m,depositPercent:z.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:VP.map(z=>a.jsx("option",{value:z.value,children:z.label},z.value))})]})]}),m.depositPercent>0&&m.price&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-emerald-50 border border-emerald-200 rounded-lg text-sm",children:[a.jsx(Pn,{className:"w-4 h-4 text-emerald-600"}),a.jsxs("span",{className:"text-emerald-800",children:["Clients will pay ",a.jsxs("strong",{children:["$",((parseFloat(m.price)||0)*(parseInt(m.depositPercent)/100)).toFixed(2)]})," deposit at booking",parseInt(m.depositPercent)<100&&a.jsxs("span",{children:[" ($",((parseFloat(m.price)||0)*(1-parseInt(m.depositPercent)/100)).toFixed(2)," remaining due at appointment)"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:g,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(en,{className:"w-4 h-4"}),g?"Saving":c?"Update Service":"Add Service"]}),a.jsxs("button",{type:"button",onClick:v,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Os,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"text-5xl mb-3",children:""}),a.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No services yet"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Add your first service so clients can choose what to book"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(z=>a.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:z.name}),z.description&&a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:z.description})]}),a.jsx("span",{className:"text-xl font-bold text-blue-600 whitespace-nowrap ml-3",children:L(z.price)})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500 mb-4 flex-wrap",children:[a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx(Wt,{className:"w-4 h-4"}),O(z.duration)]}),z.depositPercent>0&&a.jsxs("span",{className:"flex items-center gap-1.5 text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full text-xs font-medium",children:[a.jsx(Pn,{className:"w-3 h-3"}),z.depositPercent,"% deposit"]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>R(z),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:[a.jsx(Fg,{className:"w-3.5 h-3.5"}),"Edit"]}),a.jsx("button",{onClick:()=>B(z.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:a.jsx(Oa,{className:"w-3.5 h-3.5"})})]})]},z.id))})]})}const mu=[{key:"monday",label:"Monday",short:"Mon"},{key:"tuesday",label:"Tuesday",short:"Tue"},{key:"wednesday",label:"Wednesday",short:"Wed"},{key:"thursday",label:"Thursday",short:"Thu"},{key:"friday",label:"Friday",short:"Fri"},{key:"saturday",label:"Saturday",short:"Sat"},{key:"sunday",label:"Sunday",short:"Sun"}],I1={enabled:!1,start:"09:00",end:"17:00",breaks:[]};function UP({shopId:n,staffId:e,staffName:t,weeklyHours:i,onClose:o}){const[c,d]=j.useState(()=>{const E={};for(const S of mu){const k=i?.[S.key];if(k){const C=k.breaks||(k.break?[k.break]:[]);E[S.key]={enabled:!!k.enabled,start:k.start||"09:00",end:k.end||"17:00",breaks:C}}else E[S.key]={...I1,breaks:[]}}return E}),[m,x]=j.useState(!1),[g,b]=j.useState(null),[v,_]=j.useState([]),[R,B]=j.useState(!1),[L,O]=j.useState(null);j.useEffect(()=>{if(!n)return;const E=ns(Ye(fe,"shops",n,"schedulePresets"),S=>{const k=S.docs.map(C=>({id:C.id,...C.data()})).sort((C,P)=>C.isDefault&&!P.isDefault?-1:!C.isDefault&&P.isDefault?1:(C.name||"").localeCompare(P.name||""));_(k)});return()=>E()},[n]);const z=(E,S,k)=>{d(C=>({...C,[E]:{...C[E],[S]:k}})),O(null)},G=E=>{d(S=>({...S,[E]:{...S[E],breaks:[...S[E].breaks||[],{start:"12:00",end:"13:00"}]}})),O(null)},H=(E,S,k,C)=>{d(P=>{const I=[...P[E].breaks||[]];return I[S]={...I[S],[k]:C},{...P,[E]:{...P[E],breaks:I}}}),O(null)},ae=(E,S)=>{d(k=>({...k,[E]:{...k[E],breaks:k[E].breaks.filter((C,P)=>P!==S)}})),O(null)},ue=E=>{const S=c[E];d(k=>{const C={...k};for(const P of mu)P.key!==E&&(C[P.key]={enabled:S.enabled,start:S.start,end:S.end,breaks:S.breaks.map(I=>({...I}))});return C}),b(E),O(null),setTimeout(()=>b(null),1500)},Y=E=>{if(!E.days)return;const S={};for(const k of mu){const C=E.days[k.key];if(C){const P=C.breaks||(C.break?[C.break]:[]);S[k.key]={enabled:!!C.enabled,start:C.start||"09:00",end:C.end||"17:00",breaks:P.map(I=>({...I}))}}else S[k.key]={...I1,breaks:[]}}d(S),B(!1),O(E.name),setTimeout(()=>O(null),2e3)},T=async()=>{x(!0);try{const E={};for(const S of mu){const k=c[S.key];E[S.key]={enabled:k.enabled,start:k.start,end:k.end,breaks:k.breaks||[],break:k.breaks&&k.breaks.length>0?k.breaks[0]:null}}await Ke(Me(fe,"shops",n,"staff",e),{weeklyHours:E}),o()}catch(E){console.error("Error saving weekly hours:",E)}finally{x(!1)}};return a.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Weekly Hours"}),a.jsx("p",{className:"text-sm text-slate-500",children:t})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[v.length>0&&a.jsxs("div",{className:"relative",children:[a.jsxs("button",{type:"button",onClick:()=>B(!R),className:"flex items-center gap-2 px-4 py-2 bg-violet-50 hover:bg-violet-100 text-violet-700 border border-violet-200 rounded-xl text-sm font-semibold transition-all",children:[a.jsx(_t,{className:"w-4 h-4"}),"Apply Preset",a.jsx(Xu,{className:`w-4 h-4 transition-transform ${R?"rotate-180":""}`})]}),R&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>B(!1)}),a.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white border border-slate-200 rounded-xl shadow-xl z-20 py-2 max-h-80 overflow-y-auto",children:v.map(E=>a.jsxs("button",{onClick:()=>Y(E),className:"w-full px-4 py-3 text-left hover:bg-blue-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:E.name}),E.isDefault&&a.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded",children:"DEFAULT"})]}),E.description&&a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:E.description})]},E.id))})]})]}),a.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Os,{className:"w-5 h-5 text-slate-400"})})]})]}),L&&a.jsxs("div",{className:"mb-4 px-4 py-3 bg-green-50 border border-green-200 rounded-xl flex items-center gap-2 text-sm text-green-700 font-medium animate-fade-in",children:[a.jsx(en,{className:"w-4 h-4"}),'Applied "',L,'" preset  click Save to keep changes']}),a.jsx("div",{className:"space-y-3",children:mu.map(({key:E,label:S})=>{const k=c[E],C=k.breaks||[];return a.jsxs("div",{className:`rounded-xl p-4 transition-all ${k.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{type:"button",onClick:()=>z(E,"enabled",!k.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${k.enabled?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${k.enabled?"translate-x-6":"translate-x-1"}`})}),a.jsx("span",{className:`font-semibold text-sm ${k.enabled?"text-slate-900":"text-slate-400"}`,children:S}),!k.enabled&&a.jsx("span",{className:"text-sm text-slate-400 italic ml-2",children:"Day off"})]}),k.enabled&&a.jsxs("div",{className:"mt-3 ml-14 space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx(Wt,{className:"w-4 h-4 text-blue-500"}),a.jsx("input",{type:"time",value:k.start,onChange:P=>z(E,"start",P.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),a.jsx("input",{type:"time",value:k.end,onChange:P=>z(E,"end",P.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{type:"button",onClick:()=>G(E),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${C.length>0?"bg-amber-100 text-amber-700 border border-amber-200":"bg-slate-100 text-slate-500 border border-slate-200 hover:bg-amber-50 hover:text-amber-600 hover:border-amber-200"}`,children:[a.jsx(Of,{className:"w-3.5 h-3.5"}),C.length>0?`${C.length} Break${C.length>1?"s":""}`:"+ Break"]}),a.jsx("button",{type:"button",onClick:()=>ue(E),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:g===E?" Copied!":"Copy to all"})]})]}),k.enabled&&C.length>0&&a.jsx("div",{className:"mt-2 ml-14 space-y-2",children:C.map((P,I)=>a.jsxs("div",{className:"flex items-start gap-2 animate-fade-in",children:[a.jsx(Of,{className:"w-3.5 h-3.5 text-amber-500 mt-2"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("span",{className:"text-xs text-slate-500 block mb-1",children:["Break ",I+1]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("input",{type:"time",value:P.start,onChange:$=>H(E,I,"start",$.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("span",{className:"text-slate-400 text-xs",children:"to"}),a.jsx("input",{type:"time",value:P.end,onChange:$=>H(E,I,"end",$.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("button",{type:"button",onClick:()=>ae(E,I),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",title:"Remove break",children:a.jsx(Os,{className:"w-3.5 h-3.5"})})]})]})]},I))})]},E)})}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t border-slate-200",children:[a.jsxs("button",{onClick:T,disabled:m,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(oS,{className:"w-4 h-4"}),m?"Saving":"Save Hours"]}),a.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Os,{className:"w-4 h-4"}),"Cancel"]})]})]})}const To=[{key:"monday",short:"Mon",label:"Monday"},{key:"tuesday",short:"Tue",label:"Tuesday"},{key:"wednesday",short:"Wed",label:"Wednesday"},{key:"thursday",short:"Thu",label:"Thursday"},{key:"friday",short:"Fri",label:"Friday"},{key:"saturday",short:"Sat",label:"Saturday"},{key:"sunday",short:"Sun",label:"Sunday"}],BP=[{name:"Full-time 9-5",description:"Monday to Friday, 9am to 5pm with lunch break",days:{monday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},tuesday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},wednesday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},thursday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},friday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},saturday:{enabled:!1,start:"09:00",end:"17:00",breaks:[]},sunday:{enabled:!1,start:"09:00",end:"17:00",breaks:[]}},isDefault:!0},{name:"Part-time Mornings",description:"Monday to Friday, 9am to 1pm",days:{monday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},tuesday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},wednesday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},thursday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},friday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},saturday:{enabled:!1,start:"09:00",end:"13:00",breaks:[]},sunday:{enabled:!1,start:"09:00",end:"13:00",breaks:[]}},isDefault:!0},{name:"Weekends Only",description:"Saturday and Sunday, 10am to 6pm",days:{monday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},tuesday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},wednesday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},thursday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},friday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},saturday:{enabled:!0,start:"10:00",end:"18:00",breaks:[{start:"13:00",end:"14:00"}]},sunday:{enabled:!0,start:"10:00",end:"18:00",breaks:[{start:"13:00",end:"14:00"}]}},isDefault:!0}],Hh={enabled:!1,start:"09:00",end:"17:00",breaks:[]};function D1(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return t===0?`${o}${i}`:`${o}:${t.toString().padStart(2,"0")}${i}`}function zP({shopId:n}){const[e,t]=j.useState([]),[i,o]=j.useState(!0),[c,d]=j.useState(!1),[m,x]=j.useState(null),[g,b]=j.useState(!1),[v,_]=j.useState({name:"",description:"",days:{}});j.useEffect(()=>{R()},[]),j.useEffect(()=>{if(!n)return;const S=ns(Ye(fe,"shops",n,"schedulePresets"),k=>{const C=k.docs.map(P=>({id:P.id,...P.data()})).sort((P,I)=>P.isDefault&&!I.isDefault?-1:!P.isDefault&&I.isDefault?1:(P.name||"").localeCompare(I.name||""));t(C),o(!1)});return()=>S()},[n]);const R=()=>{const S={};To.forEach(k=>{S[k.key]={...Hh,breaks:[]}}),_({name:"",description:"",days:S}),x(null),d(!1)},B=async()=>{try{for(const S of BP)await Ua(Ye(fe,"shops",n,"schedulePresets"),{...S,createdAt:On()})}catch(S){console.error("Error initializing default presets:",S)}},L=async S=>{if(S.preventDefault(),!!v.name.trim()){b(!0);try{const k={name:v.name.trim(),description:v.description.trim(),days:v.days,isDefault:!1,updatedAt:On()};m?await Ke(Me(fe,"shops",n,"schedulePresets",m.id),k):await Ua(Ye(fe,"shops",n,"schedulePresets"),{...k,createdAt:On()}),R()}catch(k){console.error("Error saving preset:",k)}finally{b(!1)}}},O=S=>{const k={};To.forEach(C=>{const P=S.days?.[C.key];P?k[C.key]={enabled:!!P.enabled,start:P.start||"09:00",end:P.end||"17:00",breaks:P.breaks||(P.break?[P.break]:[])}:k[C.key]={...Hh,breaks:[]}}),_({name:S.name,description:S.description||"",days:k}),x(S),d(!0)},z=async S=>{if(confirm("Delete this schedule preset?"))try{await zo(Me(fe,"shops",n,"schedulePresets",S))}catch(k){console.error("Error deleting preset:",k)}},G=S=>{const k={};To.forEach(C=>{const P=S.days?.[C.key];P?k[C.key]={enabled:!!P.enabled,start:P.start||"09:00",end:P.end||"17:00",breaks:[...P.breaks||(P.break?[P.break]:[])]}:k[C.key]={...Hh,breaks:[]}}),_({name:`${S.name} (Copy)`,description:S.description||"",days:k}),x(null),d(!0)},H=(S,k,C)=>{_(P=>({...P,days:{...P.days,[S]:{...P.days[S],[k]:C}}}))},ae=S=>{_(k=>({...k,days:{...k.days,[S]:{...k.days[S],breaks:[...k.days[S].breaks||[],{start:"12:00",end:"13:00"}]}}}))},ue=(S,k,C,P)=>{_(I=>{const $=[...I.days[S].breaks||[]];return $[k]={...$[k],[C]:P},{...I,days:{...I.days,[S]:{...I.days[S],breaks:$}}}})},Y=(S,k)=>{_(C=>({...C,days:{...C.days,[S]:{...C.days[S],breaks:C.days[S].breaks.filter((P,I)=>I!==k)}}}))},T=S=>{const k=v.days[S];_(C=>{const P={...C.days};return To.forEach(I=>{I.key!==S&&(P[I.key]={enabled:k.enabled,start:k.start,end:k.end,breaks:k.breaks.map($=>({...$}))})}),{...C,days:P}})},E=S=>{if(!S.days)return"No schedule configured";const k=To.filter(P=>S.days[P.key]?.enabled);return k.length===0?"No working days":k.map(P=>{const I=S.days[P.key],$=I.breaks||(I.break?[I.break]:[]),U=$.length>0?` (${$.length} break${$.length>1?"s":""})`:"";return`${P.short} ${D1(I.start)}${D1(I.end)}${U}`}).join("  ")};return i?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"spinner"})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Schedule Presets"}),a.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create reusable schedule templates with breaks to quickly apply to staff"})]}),!c&&a.jsxs("button",{onClick:()=>{R(),d(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(dr,{className:"w-4 h-4"}),"New Preset"]})]}),e.length===0&&!c&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 text-center mb-6",children:[a.jsx(_t,{className:"w-10 h-10 text-blue-500 mx-auto mb-3"}),a.jsx("h3",{className:"font-bold text-slate-900 mb-2",children:"Get started with presets"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:'Add common schedule templates like "Full-time 9-5" or "Weekends Only"'}),a.jsxs("button",{onClick:B,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(dr,{className:"w-4 h-4"}),"Add Default Presets"]})]}),c&&a.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 mb-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:m?"Edit Preset":"New Schedule Preset"}),a.jsx("button",{onClick:R,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Os,{className:"w-5 h-5 text-slate-400"})})]}),a.jsxs("form",{onSubmit:L,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preset Name *"}),a.jsx("input",{type:"text",value:v.name,onChange:S=>_({...v,name:S.target.value}),placeholder:"e.g., Full-time 9-5",required:!0,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description"}),a.jsx("input",{type:"text",value:v.description,onChange:S=>_({...v,description:S.target.value}),placeholder:"e.g., Standard work week with lunch break",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Weekly Schedule"}),To.map(({key:S,label:k})=>{const C=v.days[S]||Hh;return a.jsxs("div",{className:`rounded-xl p-4 transition-all ${C.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-[140px]",children:[a.jsx("button",{type:"button",onClick:()=>H(S,"enabled",!C.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${C.enabled?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${C.enabled?"translate-x-6":"translate-x-1"}`})}),a.jsx("span",{className:`font-semibold text-sm ${C.enabled?"text-slate-900":"text-slate-400"}`,children:k})]}),C.enabled?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Wt,{className:"w-4 h-4 text-blue-500"}),a.jsx("input",{type:"time",value:C.start,onChange:P=>H(S,"start",P.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),a.jsx("input",{type:"time",value:C.end,onChange:P=>H(S,"end",P.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("button",{type:"button",onClick:()=>ae(S),className:"flex items-center gap-1.5 px-3 py-1.5 bg-amber-100 hover:bg-amber-200 text-amber-700 border border-amber-200 rounded-lg text-xs font-semibold transition-all",children:[a.jsx(Of,{className:"w-3.5 h-3.5"}),"+ Break"]}),a.jsx("button",{type:"button",onClick:()=>T(S),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:"Copy to all"})]}):a.jsx("span",{className:"text-sm text-slate-400 italic",children:"Day off"})]}),C.enabled&&C.breaks&&C.breaks.length>0&&a.jsx("div",{className:"mt-3 ml-[140px] space-y-2",children:C.breaks.map((P,I)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Of,{className:"w-3.5 h-3.5 text-amber-500"}),a.jsx("span",{className:"text-xs text-slate-500",children:"Break:"}),a.jsx("input",{type:"time",value:P.start,onChange:$=>ue(S,I,"start",$.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("span",{className:"text-slate-400 text-xs",children:""}),a.jsx("input",{type:"time",value:P.end,onChange:$=>ue(S,I,"end",$.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("button",{type:"button",onClick:()=>Y(S,I),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",children:a.jsx(Os,{className:"w-3.5 h-3.5"})})]},I))})]},S)})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:g,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(oS,{className:"w-4 h-4"}),g?"Saving":m?"Update Preset":"Save Preset"]}),a.jsxs("button",{type:"button",onClick:R,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Os,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length>0&&a.jsx("div",{className:"space-y-3",children:e.map(S=>a.jsx("div",{className:"bg-white border border-slate-200 rounded-xl p-5 hover:shadow-md transition-all",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900",children:S.name}),S.isDefault&&a.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-[10px] font-bold rounded-md",children:"DEFAULT"})]}),S.description&&a.jsx("p",{className:"text-sm text-slate-500 mb-2",children:S.description}),a.jsx("p",{className:"text-xs text-slate-400 leading-relaxed",children:E(S)})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx("button",{onClick:()=>G(S),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"Duplicate preset",children:a.jsx(aS,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>O(S),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"Edit preset",children:a.jsx(Fg,{className:"w-4 h-4"})}),!S.isDefault&&a.jsx("button",{onClick:()=>z(S.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Delete preset",children:a.jsx(Oa,{className:"w-4 h-4"})})]})]})},S.id))})]})}const Lr={free:{name:"Free",price:0,staffLimit:1,platformFeePercent:5,features:["basicBooking","emailNotifications"]},pro:{name:"Pro",price:29,priceId:null,staffLimit:5,platformFeePercent:0,features:["basicBooking","emailNotifications","aiAssistant","recurringBookings","waitlist","crm","analytics","smsNotifications","customBranding"]},unlimited:{name:"Unlimited",price:79,priceId:null,staffLimit:1/0,platformFeePercent:0,features:["basicBooking","emailNotifications","aiAssistant","recurringBookings","waitlist","crm","analytics","smsNotifications","customBranding","walkIns","multiLocation","noBranding","apiAccess","prioritySupport"]}},FP={basicBooking:{name:"Online Booking",description:"Accept bookings through your booking page"},emailNotifications:{name:"Email Notifications",description:"Automatic booking confirmations and reminders"},aiAssistant:{name:"AI Booking Assistant",description:"Smart suggestions and automated responses"},recurringBookings:{name:"Recurring Bookings",description:"Schedule repeating appointments"},waitlist:{name:"Waitlist",description:"Let clients join a waitlist when fully booked"},crm:{name:"Client CRM",description:"Client notes, history, and win-back tracking"},analytics:{name:"Analytics",description:"Detailed booking and revenue analytics"},smsNotifications:{name:"SMS Notifications",description:"Send text message reminders to clients"},customBranding:{name:"Custom Branding",description:"Customize colors and branding on your booking page"},walkIns:{name:"Walk-in Queue",description:"Manage walk-in clients with live queue"},multiLocation:{name:"Multi-Location",description:"Manage multiple business locations"},noBranding:{name:"Remove SpotBookie Branding",description:"White-label your booking experience"},apiAccess:{name:"API Access",description:"Integrate with external tools and systems"},prioritySupport:{name:"Priority Support",description:"24/7 priority customer support"}};function AS(n){const e=n?.subscriptionTier||"free";return Lr[e]?.staffLimit||1}function $P(n,e){const t=AS(n);return e<t}function qP(n,e){const t=Lr[n]||Lr.free,i=Lr[e];return i?i.features.filter(o=>!t.features.includes(o)):[]}function HP(n){const e=["free","pro","unlimited"],t=e.indexOf(n||"free");return e.slice(t+1).map(i=>({key:i,...Lr[i],newFeatures:qP(n,i)}))}const GP="https://us-central1-scheduler-65e51.cloudfunctions.net",YP={pro:"price_1Sxx7ILhwB1Jyzw8UvRxE5FT",unlimited:"price_1Sxx7JLhwB1Jyzw8uw9BRYhO"};function WP({isOpen:n,onClose:e,shopId:t,slug:i,currentTier:o="free",feature:c,title:d,description:m}){const[x,g]=j.useState(null),[b,v]=j.useState(null);if(!n)return null;const _=HP(o),R=async B=>{g(B),v(null);try{const L=await fetch(`${GP}/createCheckoutSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:t,priceId:YP[B],successUrl:`${window.location.origin}/#/shop/${i}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/#/shop/${i}/dashboard?subscription=canceled`})}),O=await L.json();if(!L.ok)throw new Error(O.error||"Failed to create checkout session");window.location.href=O.url}catch(L){console.error("Upgrade error:",L),v(L.message),g(null)}};return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-violet-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20",children:a.jsx(Jo,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:d||"Upgrade Required"}),a.jsx("p",{className:"text-sm text-slate-500",children:m||"Unlock more features with a premium plan"})]})]}),a.jsx("button",{onClick:e,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",children:a.jsx(Os,{className:"w-5 h-5"})})]}),b&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:b}),a.jsx("div",{className:"space-y-3",children:_.map(B=>a.jsxs("div",{className:`border-2 rounded-xl p-4 transition-all ${B.key==="pro"?"border-blue-300 bg-blue-50/50":"border-violet-300 bg-violet-50/50"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-slate-900",children:B.name}),a.jsxs("p",{className:"text-lg font-extrabold text-slate-900",children:["$",B.price,a.jsx("span",{className:"text-sm font-normal text-slate-500",children:"/month"})]})]}),a.jsx("button",{onClick:()=>R(B.key),disabled:x,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-semibold text-sm transition-all disabled:opacity-50 ${B.key==="pro"?"bg-blue-500 hover:bg-blue-600 text-white shadow-md shadow-blue-500/20":"bg-violet-500 hover:bg-violet-600 text-white shadow-md shadow-violet-500/20"}`,children:x===B.key?a.jsx(Mn,{className:"w-4 h-4 animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(fc,{className:"w-4 h-4"}),"Upgrade"]})})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[B.key==="pro"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-blue-200 rounded-lg text-xs font-medium text-blue-700",children:[a.jsx(Ft,{className:"w-3 h-3"}),"5 staff"]}),B.key==="unlimited"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-violet-200 rounded-lg text-xs font-medium text-violet-700",children:[a.jsx(Ft,{className:"w-3 h-3"}),"Unlimited staff"]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-emerald-50 border border-emerald-200 rounded-lg text-xs font-medium text-emerald-700",children:[a.jsx(en,{className:"w-3 h-3"}),"No platform fees"]})]})]},B.key))}),a.jsx("p",{className:"text-xs text-slate-400 text-center mt-4",children:"Cancel anytime  14-day money-back guarantee"})]})})}function KP({currentCount:n,limit:e,onUpgradeClick:t}){const i=n>=e,o=n>=e-1&&n<e;return!i&&!o?null:a.jsxs("div",{className:`rounded-xl p-4 flex items-center justify-between gap-4 mb-4 ${i?"bg-amber-50 border border-amber-200":"bg-blue-50 border border-blue-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${i?"bg-amber-100":"bg-blue-100"}`,children:a.jsx(Ft,{className:`w-5 h-5 ${i?"text-amber-600":"text-blue-600"}`})}),a.jsxs("div",{children:[a.jsx("p",{className:`font-semibold text-sm ${i?"text-amber-900":"text-blue-900"}`,children:i?"Staff limit reached":"Almost at staff limit"}),a.jsxs("p",{className:"text-xs text-slate-600",children:["You have ",n," of ",e," staff member",e!==1?"s":"",".",i?" Upgrade to add more.":" Upgrade before you need more."]})]})]}),a.jsxs("button",{onClick:t,className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-semibold text-sm transition-all shadow-md flex-shrink-0 ${i?"bg-amber-500 hover:bg-amber-600 text-white shadow-amber-500/20":"bg-blue-500 hover:bg-blue-600 text-white shadow-blue-500/20"}`,children:[a.jsx(fc,{className:"w-4 h-4"}),"Upgrade"]})]})}const QP=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}],XP=5*1024*1024,JP=["image/jpeg","image/png","image/webp"];function M1(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return t===0?`${o}${i}`:`${o}:${t.toString().padStart(2,"0")}${i}`}function ZP({shopId:n,shop:e,slug:t}){const[i,o]=j.useState([]),[c,d]=j.useState(!1),[m,x]=j.useState(null),[g,b]=j.useState(null),[v,_]=j.useState(null),[R,B]=j.useState({name:"",role:""}),[L,O]=j.useState(!1),[z,G]=j.useState(!1),[H,ae]=j.useState("staff"),[ue,Y]=j.useState([]),[T,E]=j.useState(null),[S,k]=j.useState(null),C=AS(e),P=$P(e,i.length),[I,$]=j.useState(null),[U,V]=j.useState(""),[K,oe]=j.useState(!1),[Ee,ye]=j.useState(!1),[F,J]=j.useState(""),[de,xe]=j.useState(null),[le,Ce]=j.useState(null),[$e,Ct]=j.useState(null),ot=j.useRef(null);j.useEffect(()=>{if(!n)return;const pe=ns(Ye(fe,"shops",n,"staff"),Le=>{const De=Le.docs.map(Ge=>({id:Ge.id,...Ge.data()})).filter(Ge=>Ge.active!==!1).sort((Ge,He)=>(Ge.name||"").localeCompare(He.name||""));o(De)}),We=ns(Ye(fe,"shops",n,"schedulePresets"),Le=>{const De=Le.docs.map(Ge=>({id:Ge.id,...Ge.data()})).sort((Ge,He)=>Ge.isDefault&&!He.isDefault?-1:!Ge.isDefault&&He.isDefault?1:(Ge.name||"").localeCompare(He.name||""));Y(De)});return()=>{pe(),We()}},[n]);const qt=async(pe,We)=>{if(We.days)try{const Le={},De=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];for(const Ge of De){const He=We.days[Ge];if(He){const ee=He.breaks||(He.break?[He.break]:[]);Le[Ge]={enabled:!!He.enabled,start:He.start||"09:00",end:He.end||"17:00",breaks:ee,break:ee.length>0?ee[0]:null}}else Le[Ge]={enabled:!1,start:"09:00",end:"17:00",breaks:[],break:null}}await Ke(Me(fe,"shops",n,"staff",pe),{weeklyHours:Le}),E(null),k({staffId:pe,presetName:We.name}),setTimeout(()=>k(null),2500)}catch(Le){console.error("Error applying preset:",Le)}},Z=()=>{B({name:"",role:""}),d(!1),x(null)},je=async pe=>{pe.preventDefault(),O(!0);const We={name:R.name.trim(),role:R.role.trim(),active:!0};try{m?await Ke(Me(fe,"shops",n,"staff",m),We):await Ua(Ye(fe,"shops",n,"staff"),{...We,email:"",bio:"",portfolio:[],createdAt:On()}),Z()}catch(Le){console.error("Error saving staff member:",Le)}finally{O(!1)}},Se=pe=>{B({name:pe.name,role:pe.role||""}),x(pe.id),d(!0)},qe=async pe=>{try{await Ke(Me(fe,"shops",n,"staff",pe),{active:!1})}catch(We){console.error("Error deleting staff member:",We)}},tt=pe=>{$(pe.id),V(pe.bio||"")},gt=async pe=>{oe(!0);try{await Ke(Me(fe,"shops",n,"staff",pe),{bio:U.trim()}),$(null),V("")}catch(We){console.error("Error saving bio:",We)}finally{oe(!1)}},Ks=pe=>{xe(pe),J(""),Ce(null),setTimeout(()=>{ot.current&&(ot.current.value="",ot.current.click())},50)},Ot=pe=>{const We=pe.target.files?.[0];if(We){if(!JP.includes(We.type)){alert("Please select a JPG, PNG, or WebP image.");return}if(We.size>XP){alert("File size must be under 5MB.");return}Ce(We)}},bt=async pe=>{if(le){ye(!0);try{const We=Date.now(),Le=le.name.split(".").pop(),De=`${We}.${Le}`,Ge=`shops/${n}/staff/${pe}/portfolio/${De}`,He=bx(yx,Ge);await Z_(He,le);const ee=await eS(He),nt=i.find(it=>it.id===pe)?.portfolio||[];await Ke(Me(fe,"shops",n,"staff",pe),{portfolio:[...nt,{url:ee,storagePath:Ge,caption:F.trim(),uploadedAt:new Date().toISOString()}]}),xe(null),J(""),Ce(null)}catch(We){console.error("Error uploading photo:",We),alert("Upload failed. Please try again.")}finally{ye(!1)}}},Re=async(pe,We)=>{const Le=i.find(Ge=>Ge.id===pe);if(!Le)return;const De=Le.portfolio[We];if(De){Ct(`${pe}-${We}`);try{if(De.storagePath)try{const He=bx(yx,De.storagePath);await OD(He)}catch(He){console.warn("Storage delete warning:",He)}const Ge=Le.portfolio.filter((He,ee)=>ee!==We);await Ke(Me(fe,"shops",n,"staff",pe),{portfolio:Ge})}catch(Ge){console.error("Error deleting photo:",Ge),alert("Failed to delete photo.")}finally{Ct(null)}}},Be=pe=>{if(!pe)return null;const We=QP.filter(Le=>pe[Le.key]?.enabled);return We.length===0?null:We.map(Le=>{const De=pe[Le.key],Ge=De.breaks||(De.break?[De.break]:[]),He=Ge.length>0?` ${Ge.length>1?Ge.length:""}`:"";return`${Le.short} ${M1(De.start)}${M1(De.end)}${He}`})};return a.jsxs("div",{children:[a.jsx("input",{ref:ot,type:"file",accept:".jpg,.jpeg,.png,.webp",className:"hidden",onChange:Ot}),a.jsxs("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl mb-6 w-fit",children:[a.jsxs("button",{onClick:()=>ae("staff"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${H==="staff"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(Ft,{className:"w-4 h-4"}),"Staff Members"]}),a.jsxs("button",{onClick:()=>ae("presets"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${H==="presets"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(_t,{className:"w-4 h-4"}),"Schedule Presets"]})]}),H==="presets"&&a.jsx(zP,{shopId:n}),H==="staff"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Staff"}),a.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Manage your team  assign availability and bookings per staff member"})]}),!c&&(P?a.jsxs("button",{onClick:()=>{Z(),d(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(dr,{className:"w-4 h-4"}),"Add Staff"]}):a.jsxs("button",{onClick:()=>G(!0),className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white rounded-xl font-semibold shadow-lg shadow-amber-500/30 hover:shadow-xl hover:shadow-amber-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(Jo,{className:"w-4 h-4"}),"Upgrade to Add More"]}))]}),a.jsx(KP,{currentCount:i.length,limit:C,onUpgradeClick:()=>G(!0)}),a.jsx(WP,{isOpen:z,onClose:()=>G(!1),shopId:n,slug:t,currentTier:e?.subscriptionTier||"free",title:"Add More Staff Members",description:`Your ${e?.subscriptionTier||"Free"} plan allows ${C} staff member${C!==1?"s":""}. Upgrade to add more.`}),c&&a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:m?"Edit Staff Member":"New Staff Member"}),a.jsxs("form",{onSubmit:je,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Name *"}),a.jsx("input",{type:"text",value:R.name,onChange:pe=>B({...R,name:pe.target.value}),required:!0,placeholder:"e.g. Jane Smith",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Role (optional)"}),a.jsx("input",{type:"text",value:R.role,onChange:pe=>B({...R,role:pe.target.value}),placeholder:"e.g. Senior Stylist",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:L,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(en,{className:"w-4 h-4"}),L?"Saving":m?"Update Staff":"Add Staff"]}),a.jsxs("button",{type:"button",onClick:Z,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Os,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),i.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"text-5xl mb-3",children:""}),a.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No staff members yet"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Add your team members to assign them availability and bookings"})]}):a.jsx("div",{className:"space-y-4",children:i.map(pe=>{const We=Be(pe.weeklyHours),Le=pe.portfolio||[];return a.jsxs("div",{children:[a.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:pe.name}),pe.role&&a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:pe.role})]}),a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Ft,{className:"w-5 h-5 text-blue-600"})})]}),a.jsx("div",{className:"mb-3",children:I===pe.id?a.jsxs("div",{className:"space-y-2",children:[a.jsx("textarea",{value:U,onChange:De=>V(De.target.value),placeholder:"Write a short bio  specialties, experience, personality",rows:3,maxLength:500,className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none transition-all"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>gt(pe.id),disabled:K,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[K?a.jsx(Mn,{className:"w-3 h-3 animate-spin"}):a.jsx(en,{className:"w-3 h-3"}),"Save Bio"]}),a.jsx("button",{onClick:()=>{$(null),V("")},className:"px-3 py-1.5 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"}),a.jsxs("span",{className:"text-xs text-slate-400 ml-auto",children:[U.length,"/500"]})]})]}):a.jsx("div",{onClick:()=>tt(pe),className:"cursor-pointer group",children:pe.bio?a.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed group-hover:text-slate-800 transition-colors",children:[pe.bio,a.jsx("span",{className:"ml-1.5 text-xs text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",children:"edit"})]}):a.jsx("p",{className:"text-sm text-slate-400 italic group-hover:text-blue-500 transition-colors",children:"+ Add a bio"})})}),We?a.jsx("div",{className:"mb-3 flex flex-wrap gap-1.5",children:We.map((De,Ge)=>a.jsx("span",{className:"inline-block px-2 py-0.5 bg-green-50 text-green-700 border border-green-200 rounded text-xs font-medium",children:De},Ge))}):a.jsx("p",{className:"text-xs text-slate-400 mb-3 italic",children:"No weekly hours set"}),Le.length>0&&v!==pe.id&&a.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[a.jsx("div",{className:"flex -space-x-1",children:Le.slice(0,4).map((De,Ge)=>a.jsx("img",{src:De.url,alt:De.caption||"Portfolio",className:"w-10 h-10 rounded-lg object-cover border-2 border-white shadow-sm"},Ge))}),a.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[Le.length," photo",Le.length!==1?"s":""]})]}),S?.staffId===pe.id&&a.jsxs("div",{className:"mb-3 px-3 py-2 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-xs text-green-700 font-medium animate-fade-in",children:[a.jsx(en,{className:"w-3.5 h-3.5"}),'Applied "',S.presetName,'" schedule']}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs("button",{onClick:()=>b(g===pe.id?null:pe.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${g===pe.id?"bg-blue-100 text-blue-700 border-blue-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:[a.jsx(Wt,{className:"w-3.5 h-3.5"}),"Set Hours"]}),ue.length>0&&a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>E(T===pe.id?null:pe.id),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${T===pe.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-violet-50 hover:bg-violet-100 text-violet-700 border-violet-200"}`,children:[a.jsx(_t,{className:"w-3.5 h-3.5"}),"Apply Preset",a.jsx(Xu,{className:`w-3 h-3 transition-transform ${T===pe.id?"rotate-180":""}`})]}),T===pe.id&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>E(null)}),a.jsx("div",{className:"absolute top-full right-0 mt-1 w-56 bg-white border border-slate-200 rounded-xl shadow-xl z-20 py-2 max-h-64 overflow-y-auto",children:ue.map(De=>a.jsxs("button",{onClick:()=>qt(pe.id,De),className:"w-full px-4 py-2.5 text-left hover:bg-blue-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-900 text-sm",children:De.name}),De.isDefault&&a.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded",children:"DEFAULT"})]}),De.description&&a.jsx("p",{className:"text-xs text-slate-500 mt-0.5 line-clamp-1",children:De.description})]},De.id))})]})]}),a.jsx("button",{onClick:()=>_(v===pe.id?null:pe.id),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${v===pe.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:a.jsx(uM,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>Se(pe),className:"flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:a.jsx(Fg,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>qe(pe.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:a.jsx(Oa,{className:"w-3.5 h-3.5"})})]})]}),g===pe.id&&a.jsx("div",{className:"mt-2",children:a.jsx(UP,{shopId:n,staffId:pe.id,staffName:pe.name,weeklyHours:pe.weeklyHours,onClose:()=>b(null)})}),v===pe.id&&a.jsxs("div",{className:"mt-2 bg-white border-2 border-violet-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[a.jsx(bm,{className:"w-4 h-4 text-violet-600"}),"Portfolio  ",pe.name]}),a.jsxs("button",{onClick:()=>Ks(pe.id),disabled:Ee,className:"flex items-center gap-1.5 px-3 py-1.5 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[a.jsx(dr,{className:"w-3 h-3"}),"Add Photo"]})]}),de===pe.id&&le&&a.jsxs("div",{className:"mb-4 p-3 bg-violet-50 border border-violet-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-16 h-16 rounded-lg bg-slate-200 overflow-hidden flex-shrink-0",children:a.jsx("img",{src:URL.createObjectURL(le),alt:"Preview",className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-xs text-slate-600 font-medium mb-1 truncate",children:le.name}),a.jsxs("p",{className:"text-xs text-slate-400",children:[(le.size/1024/1024).toFixed(1)," MB"]})]})]}),a.jsx("input",{type:"text",value:F,onChange:De=>J(De.target.value),placeholder:"Add a caption (optional)",maxLength:200,className:"w-full px-3 py-2 text-sm border border-violet-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-400 focus:border-transparent mb-2"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>bt(pe.id),disabled:Ee,className:"flex items-center gap-1.5 px-4 py-2 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:Ee?a.jsxs(a.Fragment,{children:[a.jsx(Mn,{className:"w-3 h-3 animate-spin"}),"Uploading"]}):a.jsxs(a.Fragment,{children:[a.jsx(en,{className:"w-3 h-3"}),"Upload"]})}),a.jsx("button",{onClick:()=>{xe(null),Ce(null),J("")},className:"px-3 py-2 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}),Le.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-3xl mb-2",children:""}),a.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet. Add some to showcase work!"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:Le.map((De,Ge)=>a.jsxs("div",{className:"group relative bg-slate-50 rounded-lg overflow-hidden border border-slate-200 shadow-sm",children:[a.jsx("div",{className:"aspect-square",children:a.jsx("img",{src:De.url,alt:De.caption||"Portfolio photo",className:"w-full h-full object-cover"})}),De.caption&&a.jsx("div",{className:"px-2 py-1.5",children:a.jsx("p",{className:"text-xs text-slate-600 truncate",children:De.caption})}),a.jsx("button",{onClick:()=>Re(pe.id,Ge),disabled:$e===`${pe.id}-${Ge}`,className:"absolute top-1.5 right-1.5 w-7 h-7 bg-red-500/90 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-md disabled:opacity-50",title:"Delete photo",children:$e===`${pe.id}-${Ge}`?a.jsx(Mn,{className:"w-3.5 h-3.5 animate-spin"}):a.jsx(Oa,{className:"w-3.5 h-3.5"})})]},Ge))})]})]},pe.id)})})]})]})}function Nl(n){return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}function e9(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function jl(n){return`$${Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function O1(n){return new Date(n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}function P1(n){return new Date(n+"T12:00:00").toLocaleDateString("en-US",{weekday:"short"})}function z0(n,e){return e===0&&n===0?0:e===0?100:(n-e)/e*100}function t9({bookings:n}){const[e,t]=j.useState(null),[i,o]=j.useState(null),c=j.useMemo(()=>n.filter($=>$.status==="confirmed"||$.status==="pending"||!$.status),[n]),d=j.useMemo(()=>{const $=new Date;return $.setHours(0,0,0,0),$},[]),m=j.useMemo(()=>Nl(d),[d]),x=j.useMemo(()=>e9(d),[d]),g=j.useMemo(()=>{const $=new Date(x);return $.setDate($.getDate()+6),$},[x]),b=j.useMemo(()=>{const $=new Date(x);return $.setDate($.getDate()-7),$},[x]),v=j.useMemo(()=>{const $=new Date(b);return $.setDate($.getDate()+6),$},[b]),_=j.useMemo(()=>new Date(d.getFullYear(),d.getMonth(),1),[d]),R=j.useMemo(()=>new Date(d.getFullYear(),d.getMonth()-1,1),[d]),B=j.useMemo(()=>{const $=new Date(_);return $.setDate($.getDate()-1),$},[_]),L=j.useMemo(()=>{const $=new Date(d);return $.setDate($.getDate()-1),Nl($)},[d]),O=j.useMemo(()=>{const $=de=>de.reduce((xe,le)=>xe+(Number(le.servicePrice)||0),0),U=(de,xe,le)=>de.date>=Nl(xe)&&de.date<=Nl(le),V=$(c.filter(de=>de.date===m)),K=$(c.filter(de=>de.date===L)),oe=$(c.filter(de=>U(de,x,g))),Ee=$(c.filter(de=>U(de,b,v))),ye=$(c.filter(de=>U(de,_,d))),F=$(c.filter(de=>U(de,R,B))),J=$(c);return{today:V,todayChange:z0(V,K),week:oe,weekChange:z0(oe,Ee),month:ye,monthChange:z0(ye,F),allTime:J}},[c,m,L,x,g,b,v,_,B,d]),z=j.useMemo(()=>{const $=[];for(let U=13;U>=0;U--){const V=new Date(d);V.setDate(V.getDate()-U),$.push(Nl(V))}return $},[d]),G=j.useMemo(()=>{const $={};return z.forEach(U=>{$[U]=0}),c.forEach(U=>{$[U.date]!==void 0&&($[U.date]+=Number(U.servicePrice)||0)}),z.map(U=>({date:U,value:$[U]}))},[c,z]),H=j.useMemo(()=>Math.max(...G.map($=>$.value),1),[G]),ae=j.useMemo(()=>{const $={},U={};return z.forEach(V=>{$[V]=0,U[V]=0}),n.forEach(V=>{$[V.date]!==void 0&&(V.status==="cancelled"||V.status==="rejected"?U[V.date]++:$[V.date]++)}),z.map(V=>({date:V,confirmed:$[V],cancelled:U[V],total:$[V]+U[V]}))},[n,z]),ue=j.useMemo(()=>Math.max(...ae.map($=>$.total),1),[ae]),Y=j.useMemo(()=>{const $=n.length;if($===0)return 100;const U=n.filter(V=>V.status==="cancelled"||V.status==="rejected").length;return Math.round(($-U)/$*100)},[n]),T=j.useMemo(()=>{const $=Array.from({length:7},()=>Array(24).fill(0));c.forEach(V=>{if(!V.date||!V.time)return;const oe=new Date(V.date+"T12:00:00").getDay(),Ee=parseInt(V.time.split(":")[0],10);!isNaN(oe)&&!isNaN(Ee)&&$[oe][Ee]++});let U=0;return $.forEach(V=>V.forEach(K=>{K>U&&(U=K)})),{grid:$,max:U}},[c]),E=j.useMemo(()=>{const $={};return c.forEach(U=>{const V=U.serviceName||"Unknown";$[V]||($[V]={name:V,count:0,revenue:0}),$[V].count++,$[V].revenue+=Number(U.servicePrice)||0}),Object.values($).map(U=>({...U,avgRevenue:U.count>0?U.revenue/U.count:0})).sort((U,V)=>V.revenue-U.revenue)},[c]),S=j.useMemo(()=>{const $={};return c.forEach(U=>{const V=U.staffName||"Unassigned";$[V]||($[V]={name:V,count:0,revenue:0,clients:new Set}),$[V].count++,$[V].revenue+=Number(U.servicePrice)||0,U.clientEmail&&$[V].clients.add(U.clientEmail.toLowerCase())}),Object.values($).map(U=>({...U,clientCount:U.clients.size})).sort((U,V)=>V.revenue-U.revenue)},[c]),k=j.useMemo(()=>{const $=c.map(le=>le.clientEmail?.toLowerCase()).filter(Boolean),U=new Set($).size,V=c.filter(le=>le.date>=Nl(_)&&le.date<=m),K=new Set(V.map(le=>le.clientEmail?.toLowerCase()).filter(Boolean)),oe=c.filter(le=>le.date<Nl(_)),Ee=new Set(oe.map(le=>le.clientEmail?.toLowerCase()).filter(Boolean));let ye=0,F=0;K.forEach(le=>{Ee.has(le)?F++:ye++});const J={};c.forEach(le=>{const Ce=le.clientEmail?.toLowerCase();Ce&&(J[Ce]||(J[Ce]={email:Ce,name:le.clientName||Ce,count:0}),J[Ce].count++,le.clientName&&(J[Ce].name=le.clientName))});const de=Object.values(J).sort((le,Ce)=>Ce.count-le.count).slice(0,10),xe=U>0?c.length/U:0;return{uniqueClients:U,newThisMonth:ye,returningThisMonth:F,topClients:de,avgBookingsPerClient:xe}},[c,_,m]),C=({value:$,suffix:U="vs prev"})=>{if($===0)return a.jsxs("span",{className:"flex items-center gap-0.5 text-xs font-medium text-slate-400",children:[a.jsx(tO,{className:"w-3 h-3"})," 0% ",U]});const V=$>0;return a.jsxs("span",{className:`flex items-center gap-0.5 text-xs font-semibold ${V?"text-emerald-600":"text-red-500"}`,children:[V?a.jsx(sS,{className:"w-3 h-3"}):a.jsx(WD,{className:"w-3 h-3"}),V?"+":"",Math.round($),"% ",U]})},P=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],I=Array.from({length:15},($,U)=>U+7);return a.jsxs("div",{className:"animate-fade-in space-y-6",children:[a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Today's Revenue",value:O.today,change:O.todayChange,suffix:"vs yesterday",icon:Fo,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:O.week,change:O.weekChange,suffix:"vs last week",icon:ec,color:"bg-violet-100 text-violet-600"},{label:"This Month",value:O.month,change:O.monthChange,suffix:"vs last month",icon:_t,color:"bg-emerald-100 text-emerald-600"},{label:"All-time Revenue",value:O.allTime,change:null,icon:Ug,color:"bg-amber-100 text-amber-600"}].map($=>{const U=$.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${$.color} rounded-xl flex items-center justify-center`,children:a.jsx(U,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:jl($.value)}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5 mb-1",children:$.label}),$.change!==null&&a.jsx(C,{value:$.change,suffix:$.suffix})]},$.label)})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Revenue"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Last 14 days  confirmed & pending bookings"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("div",{className:"flex items-end gap-0",children:[a.jsxs("div",{className:"flex flex-col justify-between h-48 pr-2 text-right flex-shrink-0 w-16",children:[a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:jl(H)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:jl(H/2)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"$0"})]}),a.jsx("div",{className:"flex-1 flex items-end gap-1 h-48 border-b border-l border-slate-200 pl-1 pb-0 relative",children:G.map(($,U)=>{const V=H>0?$.value/H*100:0,K=e===U;return a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative group",onMouseEnter:()=>t(U),onMouseLeave:()=>t(null),onTouchStart:()=>t(U),children:[K&&a.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[jl($.value),a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),a.jsx("div",{className:"w-full rounded-t-md transition-all duration-200 cursor-pointer",style:{height:`${Math.max(V,$.value>0?2:0)}%`,background:K?"linear-gradient(to top, #2563eb, #60a5fa)":"linear-gradient(to top, #3b82f6, #93c5fd)",minHeight:$.value>0?"4px":"0px"}})]},$.date)})})]}),a.jsx("div",{className:"flex ml-16 pl-1",children:G.map($=>a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:P1($.date)}),a.jsx("div",{className:"text-[9px] text-slate-400",children:O1($.date)})]},$.date))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-5",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Booking Trends"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Last 14 days breakdown"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-blue-500"})," Confirmed"]}),a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-red-400"})," Cancelled"]}),a.jsxs("span",{className:"px-2.5 py-1 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-lg font-semibold",children:[Y,"% completion"]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("div",{className:"flex items-end gap-0",children:[a.jsxs("div",{className:"flex flex-col justify-between h-40 pr-2 text-right flex-shrink-0 w-16",children:[a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:ue}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:Math.round(ue/2)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"0"})]}),a.jsx("div",{className:"flex-1 flex items-end gap-1 h-40 border-b border-l border-slate-200 pl-1 relative",children:ae.map(($,U)=>{const V=ue>0?$.confirmed/ue*100:0,K=ue>0?$.cancelled/ue*100:0,oe=i===U;return a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative",onMouseEnter:()=>o(U),onMouseLeave:()=>o(null),onTouchStart:()=>o(U),children:[oe&&a.jsxs("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[$.confirmed," confirmed, ",$.cancelled," cancelled",a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),a.jsxs("div",{className:"w-full flex flex-col items-stretch",children:[$.cancelled>0&&a.jsx("div",{className:"w-full rounded-t-md bg-red-400 transition-all duration-200",style:{height:`${Math.max(K,2)}%`}}),$.confirmed>0&&a.jsx("div",{className:`w-full bg-blue-500 transition-all duration-200 ${$.cancelled===0?"rounded-t-md":""}`,style:{height:`${Math.max(V,2)}%`}})]})]},$.date)})})]}),a.jsx("div",{className:"flex ml-16 pl-1",children:ae.map($=>a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:P1($.date)}),a.jsx("div",{className:"text-[9px] text-slate-400",children:O1($.date)})]},$.date))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Busiest Times"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Booking density by day of week and hour"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"w-12"}),I.map($=>a.jsxs("th",{className:"text-[10px] text-slate-400 font-medium pb-2 text-center px-0.5",children:[$%12||12,$>=12?"p":"a"]},$))]})}),a.jsx("tbody",{children:[1,2,3,4,5,6,0].map($=>a.jsxs("tr",{children:[a.jsx("td",{className:"text-[11px] text-slate-500 font-semibold pr-2 py-0.5 text-right",children:P[$]}),I.map(U=>{const V=T.grid[$][U],K=T.max||1,oe=V/K;let Ee="bg-slate-50";return V>0&&(oe<=.2?Ee="bg-blue-100":oe<=.4?Ee="bg-blue-200":oe<=.6?Ee="bg-blue-300":oe<=.8?Ee="bg-blue-500 text-white":Ee="bg-blue-700 text-white"),a.jsx("td",{className:"px-0.5 py-0.5",children:a.jsx("div",{className:`w-full aspect-square rounded-sm ${Ee} flex items-center justify-center text-[9px] font-bold transition-all hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 cursor-default`,title:`${P[$]} ${U}:00  ${V} booking${V!==1?"s":""}`,children:V>0?V:""})},U)})]},$))})]}),a.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-3",children:[a.jsx("span",{className:"text-[10px] text-slate-400",children:"Less"}),["bg-slate-50","bg-blue-100","bg-blue-200","bg-blue-300","bg-blue-500","bg-blue-700"].map(($,U)=>a.jsx("div",{className:`w-4 h-4 rounded-sm ${$} border border-slate-200`},U)),a.jsx("span",{className:"text-[10px] text-slate-400",children:"More"})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Top Services"}),a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Ranked by revenue from confirmed & pending bookings"}),E.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Un,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No service data yet"})]}):a.jsx("div",{className:"space-y-2",children:E.map(($,U)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm flex-shrink-0",children:U+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:$.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:[$.count," booking",$.count!==1?"s":"","  avg ",jl($.avgRevenue)]})]}),a.jsx("div",{className:"text-sm font-bold text-blue-600 flex-shrink-0",children:jl($.revenue)})]},$.name))})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Staff Performance"}),a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Bookings, revenue & clients per staff member"}),S.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Ft,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No staff data yet"})]}):a.jsx("div",{className:"space-y-2",children:S.map(($,U)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center text-violet-600 font-bold text-sm flex-shrink-0",children:U+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:$.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:[$.count," booking",$.count!==1?"s":"","  ",$.clientCount," client",$.clientCount!==1?"s":""]})]}),a.jsx("div",{className:"text-sm font-bold text-violet-600 flex-shrink-0",children:jl($.revenue)})]},$.name))})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Insights"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Understanding your client base"}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[a.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:k.uniqueClients}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Unique Clients"})]}),a.jsxs("div",{className:"bg-emerald-50 rounded-xl border border-emerald-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-emerald-700",children:k.newThisMonth}),a.jsx("div",{className:"text-xs font-medium text-emerald-600 mt-0.5",children:"New This Month"})]}),a.jsxs("div",{className:"bg-blue-50 rounded-xl border border-blue-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-blue-700",children:k.returningThisMonth}),a.jsx("div",{className:"text-xs font-medium text-blue-600 mt-0.5",children:"Returning This Month"})]}),a.jsxs("div",{className:"bg-violet-50 rounded-xl border border-violet-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-violet-700",children:k.avgBookingsPerClient.toFixed(1)}),a.jsx("div",{className:"text-xs font-medium text-violet-600 mt-0.5",children:"Avg Bookings / Client"})]})]}),a.jsx("h4",{className:"text-sm font-bold text-slate-700 mb-3",children:"Top Clients by Frequency"}),k.topClients.length===0?a.jsxs("div",{className:"text-center py-6",children:[a.jsx(zr,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No client data yet"})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:k.topClients.map(($,U)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center text-amber-700 font-bold text-xs flex-shrink-0",children:U+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:$.name}),a.jsx("div",{className:"text-xs text-slate-400 truncate",children:$.email})]}),a.jsxs("div",{className:"flex-shrink-0 px-2.5 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-bold",children:[$.count," visit",$.count!==1?"s":""]})]},$.email))})]})]})}function kS({waitingAhead:n=[],inProgress:e=[],staffCount:t=1,upcomingBookings:i=[],defaultDuration:o=30}){const c=Math.max(t,1),d=Date.now(),m=e.map(b=>{const v=b.startedAt?.toDate?.()||(b.startedAt?new Date(b.startedAt):null);if(!v)return 0;const _=(d-v.getTime())/6e4,R=b.estimatedDuration||o;return Math.max(0,R-_)});m.sort((b,v)=>b-v);const x=[];for(let b=0;b<c;b++)x.push(m[b]||0);x.sort((b,v)=>b-v);const g=n.map(b=>b.estimatedDuration||o);for(const b of g)x[0]+=b,x.sort((v,_)=>v-_);return Math.round(x[0])}function CS({waitingQueue:n=[],inProgress:e=[],staffCount:t=1,upcomingBookings:i=[],defaultDuration:o=30}){const c=new Map;for(let d=0;d<n.length;d++){const m=n.slice(0,d),x=kS({waitingAhead:m,inProgress:e,staffCount:t,upcomingBookings:i,defaultDuration:o});c.set(n[d].id,x)}return c}function s9(n=[],e=3){const t=new Date,i=new Date(t.getTime()+e*60*60*1e3),o=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return n.filter(c=>{if(c.status==="cancelled"||c.status==="rejected"||c.date!==o)return!1;const d=new Date(`${c.date}T${c.time}`);return d>=t&&d<=i}).sort((c,d)=>`${c.time}`.localeCompare(`${d.time}`))}function n9(n){if(!n)return"0m";const e=n?.toDate?.()||new Date(n),t=Math.floor((Date.now()-e.getTime())/6e4);if(t<1)return"<1m";if(t<60)return`${t}m`;const i=Math.floor(t/60),o=t%60;return o>0?`${i}h ${o}m`:`${i}h`}function a9(n){if(n==null)return"";if(n<1)return"Next up";if(n<60)return`~${n}m`;const e=Math.floor(n/60),t=n%60;return t>0?`~${e}h ${t}m`:`~${e}h`}function r9({shopId:n,services:e,staff:t,bookings:i}){const[o,c]=j.useState([]),[d,m]=j.useState(!1),[x,g]=j.useState(!1),[b,v]=j.useState(!1),[_,R]=j.useState({clientName:"",serviceId:"",staffId:"",estimatedDuration:30});j.useEffect(()=>{if(!n)return;const U=ns(Ye(fe,"shops",n,"walkins"),V=>{const K=V.docs.map(oe=>({id:oe.id,...oe.data()}));c(K)});return()=>U()},[n]);const B=j.useMemo(()=>o.filter(U=>U.status==="waiting").sort((U,V)=>(U.position||0)-(V.position||0)),[o]),L=j.useMemo(()=>o.filter(U=>U.status==="in-progress").sort((U,V)=>{const K=U.startedAt?.toDate?.()?.getTime()||0,oe=V.startedAt?.toDate?.()?.getTime()||0;return K-oe}),[o]),O=j.useMemo(()=>{const U=new Date;return U.setHours(0,0,0,0),U},[]),z=j.useMemo(()=>o.filter(U=>{if(U.status!=="completed"&&U.status!=="no-show")return!1;const V=U.completedAt?.toDate?.()||(U.completedAt?new Date(U.completedAt):null);return V?V>=O:!1}).sort((U,V)=>{const K=U.completedAt?.toDate?.()?.getTime()||0;return(V.completedAt?.toDate?.()?.getTime()||0)-K}),[o,O]),G=j.useMemo(()=>Math.max(t.filter(U=>U.active!==!1).length,1),[t]),H=j.useMemo(()=>s9(i,3),[i]),ae=j.useMemo(()=>CS({waitingQueue:B,inProgress:L,staffCount:G,upcomingBookings:H,defaultDuration:30}),[B,L,G,H]),ue=j.useMemo(()=>{const U=z.filter(K=>K.status==="completed"&&K.joinedAt&&K.startedAt).map(K=>{const oe=K.joinedAt?.toDate?.()||new Date(K.joinedAt),Ee=K.startedAt?.toDate?.()||new Date(K.startedAt);return Math.floor((Ee.getTime()-oe.getTime())/6e4)}).filter(K=>K>=0),V=U.length>0?Math.round(U.reduce((K,oe)=>K+oe,0)/U.length):0;return{waiting:B.length,avgWait:V,completedToday:z.filter(K=>K.status==="completed").length}},[B,z]),Y=U=>{const V=e.find(K=>K.id===U);R(K=>({...K,serviceId:U,estimatedDuration:V?.duration||30}))},T=()=>B.length===0?1:Math.max(...B.map(U=>U.position||0))+1,E=j.useMemo(()=>o.filter(U=>{const V=U.joinedAt?.toDate?.()||(U.joinedAt?new Date(U.joinedAt):null);return V&&V>=O}).length,[o,O]),S=async U=>{U.preventDefault(),v(!0);const V=e.find(ye=>ye.id===_.serviceId),K=t.find(ye=>ye.id===_.staffId),oe=T(),Ee=_.clientName.trim()||`Walk-in #${E+1}`;try{await Ua(Ye(fe,"shops",n,"walkins"),{clientName:Ee,serviceId:_.serviceId||null,serviceName:V?.name||null,staffId:_.staffId||null,staffName:K?.name||null,estimatedDuration:parseInt(_.estimatedDuration)||30,status:"waiting",position:oe,joinedAt:zt.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),R({clientName:"",serviceId:"",staffId:"",estimatedDuration:30}),m(!1)}catch(ye){console.error("Error adding walk-in:",ye)}finally{v(!1)}},k=async U=>{try{await Ke(Me(fe,"shops",n,"walkins",U),{status:"in-progress",startedAt:zt.now()});const V=B.filter(K=>K.id!==U).sort((K,oe)=>(K.position||0)-(oe.position||0));for(let K=0;K<V.length;K++)await Ke(Me(fe,"shops",n,"walkins",V[K].id),{position:K+1})}catch(V){console.error("Error starting service:",V)}},C=async U=>{try{await Ke(Me(fe,"shops",n,"walkins",U),{status:"completed",completedAt:zt.now()})}catch(V){console.error("Error completing service:",V)}},P=async U=>{try{await Ke(Me(fe,"shops",n,"walkins",U),{status:"no-show",completedAt:zt.now()});const V=B.filter(K=>K.id!==U).sort((K,oe)=>(K.position||0)-(oe.position||0));for(let K=0;K<V.length;K++)await Ke(Me(fe,"shops",n,"walkins",V[K].id),{position:K+1})}catch(V){console.error("Error marking no-show:",V)}},I=async U=>{const V=B.findIndex(Ee=>Ee.id===U);if(V<=0)return;const K=B[V-1],oe=B[V];try{await Ke(Me(fe,"shops",n,"walkins",oe.id),{position:K.position}),await Ke(Me(fe,"shops",n,"walkins",K.id),{position:oe.position})}catch(Ee){console.error("Error reordering:",Ee)}},$=async U=>{const V=B.findIndex(Ee=>Ee.id===U);if(V<0||V>=B.length-1)return;const K=B[V+1],oe=B[V];try{await Ke(Me(fe,"shops",n,"walkins",oe.id),{position:K.position}),await Ke(Me(fe,"shops",n,"walkins",K.id),{position:oe.position})}catch(Ee){console.error("Error reordering:",Ee)}};return a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[{label:"Currently Waiting",value:ue.waiting,icon:Ft,color:"bg-blue-100 text-blue-600"},{label:"Avg Wait",value:ue.avgWait>0?`${ue.avgWait}m`:"",icon:dS,color:"bg-amber-100 text-amber-600"},{label:"Completed Today",value:ue.completedToday,icon:ec,color:"bg-emerald-100 text-emerald-600"}].map(U=>{const V=U.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${U.color} rounded-xl flex items-center justify-center`,children:a.jsx(V,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:U.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:U.label})]},U.label)})}),H.length>0&&a.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(va,{className:"w-4 h-4 text-amber-600"}),a.jsx("span",{className:"text-sm font-bold text-amber-800",children:"Upcoming Online Bookings"})]}),a.jsx("div",{className:"space-y-1",children:H.slice(0,5).map(U=>{const[V,K]=(U.time||"").split(":"),oe=parseInt(V),Ee=`${oe%12||12}:${K} ${oe>=12?"PM":"AM"}`;return a.jsxs("div",{className:"text-xs text-amber-700 flex items-center gap-2",children:[a.jsx(Wt,{className:"w-3 h-3"}),a.jsx("span",{className:"font-medium",children:Ee}),a.jsx("span",{children:""}),a.jsx("span",{children:U.clientName}),U.serviceName&&a.jsxs("span",{className:"text-amber-500",children:["(",U.serviceName,")"]}),U.staffName&&a.jsxs("span",{className:"text-violet-600",children:["with ",U.staffName]})]},U.id)})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Walk-in Queue"}),!d&&a.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[a.jsx(dr,{className:"w-4 h-4"}),"Add Walk-in"]})]}),d&&a.jsxs("form",{onSubmit:S,className:"mb-5 p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3",children:"New Walk-in"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Client Name"}),a.jsx("input",{type:"text",value:_.clientName,onChange:U=>R(V=>({...V,clientName:U.target.value})),placeholder:`Walk-in #${E+1}`,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Service"}),a.jsxs("select",{value:_.serviceId,onChange:U=>Y(U.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"No service selected"}),e.map(U=>a.jsxs("option",{value:U.id,children:[U.name," (",U.duration,"min)"]},U.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Staff Preference"}),a.jsxs("select",{value:_.staffId,onChange:U=>R(V=>({...V,staffId:U.target.value})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"Next available"}),t.map(U=>a.jsx("option",{value:U.id,children:U.name},U.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Est. Duration (min)"}),a.jsx("select",{value:_.estimatedDuration,onChange:U=>R(V=>({...V,estimatedDuration:parseInt(U.target.value)})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[15,30,45,60,90,120].map(U=>a.jsx("option",{value:U,children:U<60?`${U} min`:`${U/60}h${U%60?` ${U%60}m`:""}`},U))})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{type:"submit",disabled:b,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[a.jsx(dr,{className:"w-4 h-4"}),b?"Adding":"Add to Queue"]}),a.jsx("button",{type:"button",onClick:()=>{m(!1),R({clientName:"",serviceId:"",staffId:"",estimatedDuration:30})},className:"px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Cancel"})]})]}),B.length===0&&L.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Ft,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No walk-ins in queue"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Add a walk-in client to start the queue."})]}):a.jsxs(a.Fragment,{children:[B.length>0&&a.jsxs("div",{className:"mb-5",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx(Wt,{className:"w-4 h-4 text-blue-500"}),"Waiting",a.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:B.length})]}),a.jsx("div",{className:"space-y-2",children:B.map((U,V)=>{const K=ae.get(U.id);return a.jsxs("div",{className:"group flex items-center gap-3 border border-slate-200 rounded-xl p-3.5 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[a.jsx("button",{onClick:()=>I(U.id),disabled:V===0,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:a.jsx(vx,{className:"w-4 h-4"})}),a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center font-bold text-blue-700 text-sm",children:V+1}),a.jsx("button",{onClick:()=>$(U.id),disabled:V===B.length-1,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:a.jsx(Xu,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:U.clientName}),a.jsx("span",{className:"px-2 py-0.5 bg-blue-50 text-blue-600 border border-blue-200 text-[10px] font-bold rounded-md",children:"WAITING"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[U.serviceName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Un,{className:"w-3 h-3 text-blue-400"}),U.serviceName]}),U.staffName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(zr,{className:"w-3 h-3 text-violet-400"}),U.staffName]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Wt,{className:"w-3 h-3"}),U.estimatedDuration||30,"min"]})]})]}),a.jsxs("div",{className:"text-right mr-2",children:[a.jsx("div",{className:"text-sm font-bold text-amber-600",children:a9(K)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"est. wait"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs("button",{onClick:()=>k(U.id),className:"flex items-center gap-1 px-3 py-2 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 border border-emerald-200 rounded-lg text-xs font-semibold transition-all",title:"Start Service",children:[a.jsx($o,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Start"})]}),a.jsxs("button",{onClick:()=>P(U.id),className:"flex items-center gap-1 px-3 py-2 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all",title:"No-show",children:[a.jsx(sr,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"No-show"})]})]})]},U.id)})})]}),L.length>0&&a.jsxs("div",{className:"mb-5",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx($o,{className:"w-4 h-4 text-emerald-500"}),"In Progress",a.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 border border-emerald-200 text-xs font-bold rounded-full",children:L.length})]}),a.jsx("div",{className:"space-y-2",children:L.map(U=>a.jsxs("div",{className:"flex items-center gap-3 border border-emerald-200 bg-emerald-50/50 rounded-xl p-3.5 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center",children:a.jsx($o,{className:"w-4 h-4 text-emerald-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:U.clientName}),a.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 text-[10px] font-bold rounded-md",children:"IN PROGRESS"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[U.serviceName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Un,{className:"w-3 h-3 text-blue-400"}),U.serviceName]}),U.staffName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(zr,{className:"w-3 h-3 text-violet-400"}),U.staffName]})]})]}),a.jsxs("div",{className:"text-right mr-2",children:[a.jsx("div",{className:"text-sm font-bold text-emerald-600",children:n9(U.startedAt)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"elapsed"})]}),a.jsxs("button",{onClick:()=>C(U.id),className:"flex items-center gap-1 px-3 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 rounded-lg text-xs font-semibold transition-all",title:"Complete",children:[a.jsx(Ms,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Complete"})]})]},U.id))})]})]})]}),z.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("button",{onClick:()=>g(!x),className:"w-full flex items-center justify-between",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[a.jsx(Ms,{className:"w-4 h-4 text-slate-400"}),"Completed Today",a.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-500 border border-slate-200 text-xs font-bold rounded-full",children:z.length})]}),a.jsx(hc,{className:`w-4 h-4 text-slate-400 transition-transform ${x?"rotate-90":""}`})]}),x&&a.jsx("div",{className:"mt-3 space-y-2",children:z.map(U=>a.jsxs("div",{className:"flex items-center gap-3 border border-slate-100 rounded-lg p-3 bg-slate-50/50",children:[a.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center bg-slate-100",children:U.status==="no-show"?a.jsx(sr,{className:"w-3.5 h-3.5 text-red-400"}):a.jsx(Ms,{className:"w-3.5 h-3.5 text-emerald-400"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-700 text-sm truncate",children:U.clientName}),a.jsx("span",{className:`text-[10px] font-bold rounded-md px-1.5 py-0.5 border ${U.status==="no-show"?"bg-red-50 text-red-600 border-red-200":"bg-emerald-50 text-emerald-600 border-emerald-200"}`,children:U.status==="no-show"?"NO-SHOW":"COMPLETED"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[U.serviceName&&a.jsx("span",{children:U.serviceName}),U.staffName&&a.jsxs("span",{children:[" ",U.staffName]})]})]})]},U.id))})]})]})}function i9(n,e){const t=new Date(n+"T12:00:00"),i=e.getTime()-t.getTime();return Math.floor(i/864e5)}function Gh(n){return`$${Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function pu(n){return n?new Date(n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function l9(n,e,t){return n>90?"lost":n>t?"at-risk":n>e?"getting-cold":"active"}const Yh={active:{label:"Active",bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200",icon:zg,iconColor:"text-emerald-500"},"getting-cold":{label:"Getting Cold",bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",icon:uS,iconColor:"text-amber-500"},"at-risk":{label:"At Risk",bg:"bg-orange-50",text:"text-orange-700",border:"border-orange-200",icon:va,iconColor:"text-orange-500"},lost:{label:"Lost",bg:"bg-red-50",text:"text-red-700",border:"border-red-200",icon:DM,iconColor:"text-red-500"}};function o9({shopId:n,bookings:e,shop:t,slug:i}){const[o,c]=j.useState({}),[d,m]=j.useState(null),[x,g]=j.useState(null),[b,v]=j.useState(""),[_,R]=j.useState(""),[B,L]=j.useState("all"),[O,z]=j.useState("lastVisit"),[G,H]=j.useState("asc"),[ae,ue]=j.useState(null),[Y,T]=j.useState(!1),[E,S]=j.useState(null),[k,C]=j.useState(!1),[P,I]=j.useState(null),$=t?.winbackSettings?.warningDays||30,U=t?.winbackSettings?.inactiveDays||60,V=t?.winbackSettings?.enabled!==!1,K=Z=>Z.toLowerCase().replace(/\./g,"_dot_").replace(/@/g,"_at_");j.useEffect(()=>{if(!n)return;const Z=ns(Ye(fe,"shops",n,"clientNotes"),je=>{const Se={};je.docs.forEach(qe=>{Se[qe.id]=qe.data()}),c(Se)});return()=>Z()},[n]);const oe=j.useMemo(()=>new Date,[]),Ee=j.useMemo(()=>e.filter(Z=>Z.status==="confirmed"||Z.status==="pending"||!Z.status),[e]),ye=j.useMemo(()=>{const Z={};return Ee.forEach(je=>{const Se=je.clientEmail?.toLowerCase();if(!Se)return;Z[Se]||(Z[Se]={email:Se,name:je.clientName||Se,phone:je.clientPhone||"",totalVisits:0,totalSpent:0,lastVisitDate:null,firstVisitDate:null,bookings:[],serviceFrequency:{},staffFrequency:{}});const qe=Z[Se];je.clientName&&(qe.name=je.clientName),je.clientPhone&&(qe.phone=je.clientPhone),qe.totalVisits++,qe.totalSpent+=Number(je.servicePrice)||0,qe.bookings.push(je),(!qe.lastVisitDate||je.date>qe.lastVisitDate)&&(qe.lastVisitDate=je.date),(!qe.firstVisitDate||je.date<qe.firstVisitDate)&&(qe.firstVisitDate=je.date),je.serviceName&&(qe.serviceFrequency[je.serviceName]=(qe.serviceFrequency[je.serviceName]||0)+1),je.staffName&&(qe.staffFrequency[je.staffName]=(qe.staffFrequency[je.staffName]||0)+1)}),Object.values(Z).map(je=>{const Se=je.lastVisitDate?i9(je.lastVisitDate,oe):999,qe=l9(Se,$,U),tt=Object.entries(je.serviceFrequency).sort((Re,Be)=>Be[1]-Re[1])[0]?.[0]||null,gt=Object.entries(je.staffFrequency).sort((Re,Be)=>Be[1]-Re[1])[0]?.[0]||null,Ks=je.totalVisits>0?je.totalSpent/je.totalVisits:0,Ot=K(je.email),bt=o[Ot];return{...je,daysSinceLastVisit:Se,status:qe,favoriteService:tt,favoriteStaff:gt,avgSpending:Ks,encodedEmail:Ot,notes:bt?.notes||"",contacted:bt?.contacted||!1,contactedAt:bt?.contactedAt||null,tags:bt?.tags||[]}})},[Ee,oe,$,U,o]),F=j.useMemo(()=>{const Z={all:ye.length,active:0,"getting-cold":0,"at-risk":0,lost:0};return ye.forEach(je=>{Z[je.status]++}),Z},[ye]),J=j.useMemo(()=>ye.filter(Z=>(Z.status==="at-risk"||Z.status==="lost")&&!Z.contacted),[ye]),de=j.useMemo(()=>{let Z=ye;if(_.trim()){const je=_.toLowerCase();Z=Z.filter(Se=>Se.name.toLowerCase().includes(je)||Se.email.includes(je)||Se.phone.includes(je))}return B!=="all"&&(Z=Z.filter(je=>je.status===B)),Z=[...Z].sort((je,Se)=>{if(O==="lastVisit"){const qe=(je.lastVisitDate||"").localeCompare(Se.lastVisitDate||"");return G==="asc"?qe:-qe}return O==="totalVisits"?G==="desc"?Se.totalVisits-je.totalVisits:je.totalVisits-Se.totalVisits:O==="totalSpent"?G==="desc"?Se.totalSpent-je.totalSpent:je.totalSpent-Se.totalSpent:0}),Z},[ye,_,B,O,G]),xe=Z=>{O===Z?H(je=>je==="asc"?"desc":"asc"):(z(Z),H(Z==="lastVisit"?"asc":"desc"))},le=j.useCallback(Z=>{const je=t?.name||"our shop",Se=`${window.location.origin}${window.location.pathname}#/shop/${i}`;return`Hi ${Z.name.split(" ")[0]}, we miss you at ${je}! It's been ${Z.daysSinceLastVisit} days since your last visit.${Z.favoriteService?` Book your next ${Z.favoriteService} today:`:" Book your next appointment:"} ${Se}`},[t,i]),Ce=Z=>{const je=le(Z);S({email:Z.email,encodedEmail:Z.encodedEmail,name:Z.name,message:je})},$e=async(Z,je)=>{try{await navigator.clipboard.writeText(Z),ue(je),setTimeout(()=>ue(null),2e3)}catch(Se){console.error("Failed to copy:",Se)}},Ct=async Z=>{I(Z);try{const je=Me(fe,"shops",n,"clientNotes",Z),Se=await Bo(je),qe=Se.exists()?Se.data():{};await Mu(je,{...qe,contacted:!0,contactedAt:new Date().toISOString()}),S(null)}catch(je){console.error("Error marking as contacted:",je)}finally{I(null)}},ot=async Z=>{try{const je=Me(fe,"shops",n,"clientNotes",Z),Se=await Bo(je),qe=Se.exists()?Se.data():{};await Mu(je,{...qe,contacted:!1,contactedAt:null})}catch(je){console.error("Error resetting contacted status:",je)}},qt=async Z=>{C(!0);try{const je=Me(fe,"shops",n,"clientNotes",Z),Se=await Bo(je),qe=Se.exists()?Se.data():{};await Mu(je,{...qe,notes:b}),g(null)}catch(je){console.error("Error saving notes:",je)}finally{C(!1)}};return a.jsxs("div",{className:"animate-fade-in space-y-6",children:[V&&J.length>0&&a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>T(!Y),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:a.jsx(va,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[J.length," client",J.length!==1?"s":""," need",J.length===1?"s":""," attention"]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Haven't visited in over ",U," days  send a win-back message to re-engage"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-2.5 py-1 bg-orange-100 text-orange-700 border border-orange-200 text-xs font-bold rounded-lg",children:J.length}),Y?a.jsx(vx,{className:"w-5 h-5 text-slate-400"}):a.jsx(Xu,{className:"w-5 h-5 text-slate-400"})]})]}),Y&&a.jsx("div",{className:"mt-4 space-y-2.5",children:J.sort((Z,je)=>je.daysSinceLastVisit-Z.daysSinceLastVisit).map(Z=>a.jsxs("div",{className:"bg-white rounded-xl border border-orange-100 p-4 flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx("div",{className:"w-9 h-9 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(zr,{className:"w-4 h-4 text-orange-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:Z.name}),a.jsxs("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Yh[Z.status].bg} ${Yh[Z.status].text} ${Yh[Z.status].border}`,children:[Z.daysSinceLastVisit," days ago"]})]}),a.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 flex-wrap mt-0.5",children:[a.jsxs("span",{children:["Last: ",pu(Z.lastVisitDate)]}),Z.favoriteService&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-slate-300",children:""}),a.jsxs("span",{className:"text-blue-600",children:["Loves ",Z.favoriteService]})]}),a.jsx("span",{className:"text-slate-300",children:""}),a.jsxs("span",{children:[Z.totalVisits," visit",Z.totalVisits!==1?"s":""]})]})]})]}),a.jsxs("button",{onClick:je=>{je.stopPropagation(),Ce(Z)},className:"flex items-center gap-1.5 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-xl text-xs font-semibold transition-all shadow-sm flex-shrink-0",children:[a.jsx(cf,{className:"w-3.5 h-3.5"}),"Send Win-back"]})]},Z.email))})]}),E&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:a.jsx(Nx,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Win-back Message"}),a.jsxs("p",{className:"text-sm text-slate-500",children:["Send to ",E.name]})]})]}),a.jsx("div",{className:"bg-slate-50 rounded-xl p-4 mb-4 border border-slate-200",children:a.jsx("textarea",{value:E.message,onChange:Z=>S({...E,message:Z.target.value}),rows:4,className:"w-full bg-transparent text-sm text-slate-700 resize-none focus:outline-none leading-relaxed"})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{$e(E.message,E.email)},className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:ae===E.email?a.jsxs(a.Fragment,{children:[a.jsx(en,{className:"w-4 h-4"}),"Copied!"]}):a.jsxs(a.Fragment,{children:[a.jsx(aS,{className:"w-4 h-4"}),"Copy to Clipboard"]})}),a.jsxs("button",{onClick:()=>Ct(E.encodedEmail),disabled:P===E.encodedEmail,className:"flex items-center justify-center gap-2 px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-emerald-600/20 disabled:opacity-50",children:[a.jsx(en,{className:"w-4 h-4"}),"Mark Contacted"]}),a.jsx("button",{onClick:()=>S(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Close"})]})]})}),a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Clients",value:F.all,icon:Ft,color:"bg-blue-100 text-blue-600"},{label:"Active",value:F.active,icon:zg,color:"bg-emerald-100 text-emerald-600"},{label:"Getting Cold",value:F["getting-cold"],icon:uS,color:"bg-amber-100 text-amber-600"},{label:"At Risk / Lost",value:F["at-risk"]+F.lost,icon:va,color:"bg-red-100 text-red-600"}].map(Z=>{const je=Z.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${Z.color} rounded-xl flex items-center justify-center`,children:a.jsx(je,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Z.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:Z.label})]},Z.label)})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Clients"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Derived from booking history"})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[de.length," client",de.length!==1?"s":""]})]}),a.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[a.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[a.jsx(of,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2"}),a.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:_,onChange:Z=>R(Z.target.value),className:"w-full pl-10 pr-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),_&&a.jsx("button",{onClick:()=>R(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:a.jsx(Os,{className:"w-4 h-4 text-slate-400 hover:text-slate-600"})})]}),a.jsx("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl overflow-x-auto",children:[{key:"all",label:"All"},{key:"active",label:"Active"},{key:"getting-cold",label:"Cold"},{key:"at-risk",label:"At Risk"},{key:"lost",label:"Lost"}].map(Z=>a.jsxs("button",{onClick:()=>L(Z.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap ${B===Z.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[Z.label,a.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${B===Z.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:F[Z.key]??0})]},Z.key))}),a.jsx("div",{className:"flex items-center gap-1",children:[{key:"lastVisit",label:"Last Visit"},{key:"totalVisits",label:"Visits"},{key:"totalSpent",label:"Spent"}].map(Z=>a.jsxs("button",{onClick:()=>xe(Z.key),className:`flex items-center gap-1 px-3 py-2 rounded-lg text-xs font-semibold transition-all border ${O===Z.key?"bg-blue-50 text-blue-700 border-blue-200":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[Z.label,O===Z.key&&a.jsx(JD,{className:"w-3 h-3"})]},Z.key))})]}),de.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Ft,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No clients found"}),a.jsx("p",{className:"text-xs text-slate-400",children:_?"Try a different search term":"Client data will appear as bookings come in"})]}):a.jsx("div",{className:"space-y-2",children:de.map(Z=>{const je=d===Z.email,Se=Yh[Z.status],qe=Se.icon;return a.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden hover:border-slate-300 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 cursor-pointer hover:bg-slate-50/50 transition-all",onClick:()=>m(je?null:Z.email),children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(zr,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:Z.name}),a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-bold rounded-md border ${Se.bg} ${Se.text} ${Se.border}`,children:[a.jsx(qe,{className:"w-3 h-3"}),Se.label]}),Z.contacted&&a.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",children:[a.jsx(cf,{className:"w-2.5 h-2.5"}),"Contacted"]}),Z.notes&&a.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-violet-50 text-violet-600 border-violet-200",children:a.jsx(x1,{className:"w-2.5 h-2.5"})})]}),a.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-3 mt-0.5 flex-wrap",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Lf,{className:"w-3 h-3"}),Z.email]}),Z.phone&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Lu,{className:"w-3 h-3"}),Z.phone]})]})]}),a.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-shrink-0",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900",children:Z.totalVisits}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-blue-600",children:Gh(Z.totalSpent)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-700",children:pu(Z.lastVisitDate)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(Z.status==="at-risk"||Z.status==="lost")&&!Z.contacted&&a.jsx("button",{onClick:tt=>{tt.stopPropagation(),Ce(Z)},className:"p-2 text-orange-500 hover:text-orange-700 hover:bg-orange-50 rounded-lg transition-all",title:"Send win-back message",children:a.jsx(cf,{className:"w-4 h-4"})}),je?a.jsx(vx,{className:"w-4 h-4 text-slate-400"}):a.jsx(Xu,{className:"w-4 h-4 text-slate-400"})]})]}),je&&a.jsxs("div",{className:"border-t border-slate-200 bg-slate-50/50 p-5 space-y-5",children:[a.jsxs("div",{className:"sm:hidden grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-slate-900",children:Z.totalVisits}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-blue-600",children:Gh(Z.totalSpent)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-700",children:pu(Z.lastVisitDate)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Avg per Visit"}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:Gh(Z.avgSpending)})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"First Visit"}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:pu(Z.firstVisitDate)})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Days Since Last Visit"}),a.jsxs("div",{className:"text-sm font-bold text-slate-900",children:[Z.daysSinceLastVisit,"d"]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Favorite Service"}),a.jsx("div",{className:"text-sm font-bold text-blue-600 truncate",children:Z.favoriteService||""})]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Un,{className:"w-3.5 h-3.5 text-blue-500"}),"Services Used"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(Z.serviceFrequency).sort((tt,gt)=>gt[1]-tt[1]).map(([tt,gt])=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg text-xs font-medium",children:[tt,a.jsxs("span",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[gt,""]})]},tt))})]}),Object.keys(Z.staffFrequency).length>0&&a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Ft,{className:"w-3.5 h-3.5 text-violet-500"}),"Staff Members Seen"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(Z.staffFrequency).sort((tt,gt)=>gt[1]-tt[1]).map(([tt,gt])=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-violet-50 text-violet-700 border border-violet-200 rounded-lg text-xs font-medium",children:[tt,a.jsxs("span",{className:"bg-violet-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[gt,""]})]},tt))})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(_t,{className:"w-3.5 h-3.5 text-emerald-500"}),"Booking History",a.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",Z.bookings.length,")"]})]}),a.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:Z.bookings.sort((tt,gt)=>(gt.date+gt.time).localeCompare(tt.date+tt.time)).map((tt,gt)=>a.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded-lg hover:bg-slate-50 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-700",children:pu(tt.date)}),a.jsx("span",{className:"text-slate-400",children:tt.time}),tt.serviceName&&a.jsx("span",{className:"text-blue-600",children:tt.serviceName})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[tt.staffName&&a.jsx("span",{className:"text-violet-600",children:tt.staffName}),tt.servicePrice!=null&&a.jsx("span",{className:"font-semibold text-slate-900",children:Gh(tt.servicePrice)})]})]},gt))})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 flex items-center gap-1.5",children:[a.jsx(x1,{className:"w-3.5 h-3.5 text-amber-500"}),"Notes"]}),x!==Z.encodedEmail&&a.jsx("button",{onClick:()=>{g(Z.encodedEmail),v(Z.notes||"")},className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:Z.notes?"Edit":"Add Notes"})]}),x===Z.encodedEmail?a.jsxs("div",{className:"space-y-2",children:[a.jsx("textarea",{value:b,onChange:tt=>v(tt.target.value),placeholder:"Add notes about this client (e.g., preferences, allergies, favorite styles...)",rows:3,className:"w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>qt(Z.encodedEmail),disabled:k,className:"px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:k?"Saving...":"Save"}),a.jsx("button",{onClick:()=>g(null),className:"px-4 py-1.5 bg-white hover:bg-slate-50 text-slate-600 border border-slate-200 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}):a.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:Z.notes||'No notes yet. Click "Add Notes" to save preferences, allergies, or anything useful.'})]}),Z.contacted&&a.jsxs("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[a.jsx(en,{className:"w-4 h-4"}),a.jsxs("span",{className:"font-medium",children:["Contacted",Z.contactedAt?` on ${new Date(Z.contactedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`:""]})]}),a.jsx("button",{onClick:()=>ot(Z.encodedEmail),className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:"Reset"})]})]})]},Z.email)})})]})]})}const V1="https://us-central1-scheduler-65e51.cloudfunctions.net",c9={pro:"price_1Sxx7ILhwB1Jyzw8UvRxE5FT",unlimited:"price_1Sxx7JLhwB1Jyzw8uw9BRYhO"},u9={basicBooking:_t,emailNotifications:Nx,aiAssistant:nM,recurringBookings:Wt,waitlist:Ft,crm:Ft,analytics:Ug,smsNotifications:Nx,customBranding:iS,walkIns:hS,multiLocation:QM,noBranding:cS,apiAccess:jM,prioritySupport:UM};function d9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState(e),[c,d]=j.useState(!1),[m,x]=j.useState(null),[g,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;const H=ns(Me(fe,"shops",n),ae=>{ae.exists()&&o(ae.data())});return()=>H()},[n]);const v=i?.subscriptionTier||"free",_=Lr[v],R=i?.subscriptionStatus,B=i?.subscriptionEndsAt,L=H=>H?(H.toDate?H.toDate():new Date(H)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):null,O=async H=>{d(H),x(null);try{const ae=await fetch(`${V1}/createCheckoutSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,priceId:c9[H],successUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?subscription=canceled`})}),ue=await ae.json();if(!ae.ok)throw new Error(ue.error||"Failed to create checkout session");window.location.href=ue.url}catch(ae){console.error("Upgrade error:",ae),x(ae.message),d(null)}},z=async()=>{b(!0),x(null);try{const H=await fetch(`${V1}/createBillingPortalSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,returnUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard`})}),ae=await H.json();if(!H.ok)throw new Error(ae.error||"Failed to open billing portal");window.location.href=ae.url}catch(H){console.error("Billing portal error:",H),x(H.message),b(!1)}},G=[{key:"free",name:"Free",price:"$0",period:"forever",description:"Perfect for getting started",color:"slate",features:[{key:"staff",text:"1 staff member"},{key:"basicBooking",text:"Online booking"},{key:"emailNotifications",text:"Email notifications"},{key:"fee",text:"5% platform fee on deposits",negative:!0}]},{key:"pro",name:"Pro",price:"$29",period:"/month",description:"For growing businesses",color:"blue",popular:!0,features:[{key:"staff",text:"Up to 5 staff members"},{key:"basicBooking",text:"Online booking"},{key:"emailNotifications",text:"Email notifications"},{key:"aiAssistant",text:"AI booking assistant"},{key:"recurringBookings",text:"Recurring bookings"},{key:"waitlist",text:"Waitlist management"},{key:"crm",text:"Client CRM & notes"},{key:"analytics",text:"Analytics dashboard"},{key:"smsNotifications",text:"SMS notifications"},{key:"fee",text:"No platform fees",highlight:!0}]},{key:"unlimited",name:"Unlimited",price:"$79",period:"/month",description:"For established businesses",color:"violet",features:[{key:"staff",text:"Unlimited staff members"},{key:"everything",text:"Everything in Pro, plus:"},{key:"walkIns",text:"Walk-in queue management"},{key:"multiLocation",text:"Multi-location support"},{key:"noBranding",text:"Remove SpotBookie branding"},{key:"apiAccess",text:"API access"},{key:"prioritySupport",text:"Priority support"}]}];return a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:`rounded-2xl p-6 mb-8 ${v==="unlimited"?"bg-gradient-to-r from-violet-500 to-purple-600":v==="pro"?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gradient-to-r from-slate-600 to-slate-700"}`,children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:a.jsx(Jo,{className:"w-7 h-7 text-white"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("h2",{className:"text-xl font-bold text-white",children:[_.name," Plan"]}),R==="past_due"&&a.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full",children:"Payment Failed"}),B&&a.jsx("span",{className:"px-2 py-0.5 bg-amber-500 text-white text-xs font-bold rounded-full",children:"Canceling"})]}),a.jsx("p",{className:"text-white/80 text-sm mt-0.5",children:v==="free"?"Upgrade to unlock more features":B?`Access until ${L(B)}`:"Your subscription is active"})]})]}),v!=="free"&&a.jsxs("button",{onClick:z,disabled:g,className:"flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 text-white rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[g?a.jsx(Mn,{className:"w-4 h-4 animate-spin"}):a.jsx(cr,{className:"w-4 h-4"}),"Manage Billing"]})]})}),m&&a.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[a.jsx(Ju,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800",children:"Something went wrong"}),a.jsx("p",{className:"text-sm text-red-600",children:m})]})]}),R==="past_due"&&a.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl flex items-start gap-3",children:[a.jsx(Ju,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-amber-800",children:"Payment Failed"}),a.jsx("p",{className:"text-sm text-amber-600",children:"Your last payment failed. Please update your payment method to keep your subscription active."}),a.jsx("button",{onClick:z,className:"mt-2 text-sm font-semibold text-amber-700 hover:text-amber-800 underline",children:"Update Payment Method "})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:G.map(H=>{const ae=H.key===v,ue=["free","pro","unlimited"].indexOf(H.key)<["free","pro","unlimited"].indexOf(v),Y=!ae&&!ue;return a.jsxs("div",{className:`relative bg-white rounded-2xl border-2 p-6 transition-all ${H.popular?"border-blue-500 shadow-lg shadow-blue-500/10":ae?"border-emerald-500":"border-slate-200 hover:border-slate-300"}`,children:[H.popular&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsx("span",{className:"px-3 py-1 bg-blue-500 text-white text-xs font-bold rounded-full",children:"Most Popular"})}),ae&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsx("span",{className:"px-3 py-1 bg-emerald-500 text-white text-xs font-bold rounded-full",children:"Current Plan"})}),a.jsxs("div",{className:"text-center mb-6 pt-2",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:H.name}),a.jsxs("div",{className:"mt-2 flex items-baseline justify-center gap-1",children:[a.jsx("span",{className:"text-4xl font-extrabold text-slate-900",children:H.price}),a.jsx("span",{className:"text-slate-500 text-sm",children:H.period})]}),a.jsx("p",{className:"text-sm text-slate-500 mt-2",children:H.description})]}),a.jsx("ul",{className:"space-y-3 mb-6",children:H.features.map((T,E)=>(u9[T.key],a.jsxs("li",{className:"flex items-start gap-2.5",children:[a.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5 ${T.negative?"bg-red-100 text-red-500":T.highlight?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-600"}`,children:T.negative?a.jsx("span",{className:"text-xs font-bold",children:"%"}):a.jsx(en,{className:"w-3 h-3"})}),a.jsx("span",{className:`text-sm ${T.negative?"text-red-600":T.highlight?"text-emerald-700 font-medium":"text-slate-700"}`,children:T.text})]},E)))}),Y?a.jsx("button",{onClick:()=>O(H.key),disabled:c,className:`w-full flex items-center justify-center gap-2 py-3 rounded-xl font-semibold text-sm transition-all ${H.key==="unlimited"?"bg-gradient-to-r from-violet-500 to-purple-600 hover:from-violet-600 hover:to-purple-700 text-white shadow-lg shadow-violet-500/20":H.key==="pro"?"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg shadow-blue-500/20":"bg-slate-100 hover:bg-slate-200 text-slate-700"} disabled:opacity-50`,children:c===H.key?a.jsxs(a.Fragment,{children:[a.jsx(Mn,{className:"w-4 h-4 animate-spin"}),"Redirecting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(fc,{className:"w-4 h-4"}),"Upgrade to ",H.name]})}):ae?a.jsx("div",{className:"w-full py-3 text-center text-sm font-semibold text-emerald-600 bg-emerald-50 rounded-xl border border-emerald-200",children:" Your Current Plan"}):a.jsx("div",{className:"w-full py-3 text-center text-sm font-medium text-slate-400 bg-slate-50 rounded-xl",children:"Included in your plan"})]},H.key)})}),a.jsxs("div",{className:"mt-12",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Feature Comparison"}),a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Feature"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-slate-700",children:"Free"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-blue-600",children:"Pro"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-violet-600",children:"Unlimited"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b border-slate-100",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:"Staff Members"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"1"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"5"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"Unlimited"})]}),a.jsxs("tr",{className:"border-b border-slate-100",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:"Platform Fee"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-red-500",children:"5%"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-emerald-600",children:"0%"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-emerald-600",children:"0%"})]}),Object.entries(FP).map(([H,ae])=>a.jsxs("tr",{className:"border-b border-slate-100 last:border-b-0",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:ae.name}),a.jsx("td",{className:"py-3 px-4 text-center",children:Lr.free.features.includes(H)?a.jsx(en,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})}),a.jsx("td",{className:"py-3 px-4 text-center",children:Lr.pro.features.includes(H)?a.jsx(en,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})}),a.jsx("td",{className:"py-3 px-4 text-center",children:Lr.unlimited.features.includes(H)?a.jsx(en,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})})]},H))]})]})})]}),a.jsxs("div",{className:"mt-12",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Frequently Asked Questions"}),a.jsx("div",{className:"space-y-4",children:[{q:"Can I cancel anytime?",a:"Yes! You can cancel your subscription at any time. You'll continue to have access until the end of your billing period."},{q:"What happens if I downgrade?",a:"When you downgrade, you'll keep your current plan until the end of the billing period. After that, feature limits (like staff count) will apply."},{q:"What is the platform fee?",a:"On the Free plan, we charge a 5% fee on any deposits collected through SpotBookie. Pro and Unlimited plans have no platform fees."},{q:"Do you offer refunds?",a:"We offer a 14-day money-back guarantee for first-time subscribers. Contact us if you're not satisfied."}].map((H,ae)=>a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:H.q}),a.jsx("p",{className:"text-sm text-slate-600",children:H.a})]},ae))})]})]})}const Wh="https://us-central1-scheduler-65e51.cloudfunctions.net";function h9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState(e),[c,d]=j.useState(null),[m,x]=j.useState(null),[g,b]=j.useState(null);j.useEffect(()=>{if(!n)return;const Y=ns(Me(fe,"shops",n),T=>{T.exists()&&o(T.data())});return()=>Y()},[n]);const v=!!i?.stripeAccountId,_=i?.stripeOnboardingComplete,R=i?.payoutsEnabled;i?.stripeAccountStatus;const B=i?.subscriptionTier||"free",L=B==="free"?"5%":"0%",O=async()=>{d("create"),x(null);try{const Y=await fetch(`${Wh}/createConnectAccount`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,email:i.ownerEmail,businessName:i.name})}),T=await Y.json();if(!Y.ok)throw new Error(T.error||"Failed to create account");(!T.alreadyExists||!i.stripeOnboardingComplete)&&await z()}catch(Y){console.error("Create account error:",Y),x(Y.message)}finally{d(null)}},z=async()=>{d("onboard"),x(null);try{const Y=await fetch(`${Wh}/createAccountLink`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,returnUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?connect=return`,refreshUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?connect=refresh`})}),T=await Y.json();if(!Y.ok)throw new Error(T.error||"Failed to create onboarding link");window.location.href=T.url}catch(Y){console.error("Onboarding error:",Y),x(Y.message),d(null)}},G=async()=>{d("dashboard"),x(null);try{const Y=await fetch(`${Wh}/getConnectDashboardLink`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n})}),T=await Y.json();if(!Y.ok)throw new Error(T.error||"Failed to get dashboard link");window.open(T.url,"_blank")}catch(Y){console.error("Dashboard link error:",Y),x(Y.message)}finally{d(null)}},H=async()=>{d("balance"),x(null);try{const Y=await fetch(`${Wh}/getConnectBalance`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n})}),T=await Y.json();if(!Y.ok)throw new Error(T.error||"Failed to fetch balance");b(T)}catch(Y){console.error("Balance fetch error:",Y),x(Y.message)}finally{d(null)}};j.useEffect(()=>{R&&!g&&H()},[R]);const ae=(Y,T="usd")=>new Intl.NumberFormat("en-US",{style:"currency",currency:T.toUpperCase()}).format(Y/100),ue=Y=>new Date(Y*1e3).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Payments"}),a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:"Connect Stripe to accept deposits and get paid"})]}),v&&R&&a.jsxs("button",{onClick:H,disabled:c==="balance",className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-all",children:[c==="balance"?a.jsx(Mn,{className:"w-3.5 h-3.5 animate-spin"}):a.jsx(Zo,{className:"w-3.5 h-3.5"}),"Refresh"]})]}),m&&a.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[a.jsx(Ju,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800 text-sm",children:"Something went wrong"}),a.jsx("p",{className:"text-sm text-red-600",children:m})]})]}),!v&&a.jsx("div",{className:"bg-gradient-to-br from-violet-50 to-blue-50 rounded-2xl border border-violet-200 p-8",children:a.jsxs("div",{className:"flex flex-col items-center text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-lg flex items-center justify-center mb-5",children:a.jsx(Pn,{className:"w-8 h-8 text-violet-600"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"Accept Payments"}),a.jsx("p",{className:"text-slate-600 max-w-md mb-6",children:"Connect your Stripe account to accept deposit payments from clients when they book. Funds are transferred directly to your bank account."}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 w-full max-w-xl mb-8",children:[{icon:qo,label:"Secure payments",desc:"256-bit encryption"},{icon:fc,label:"Fast payouts",desc:"2-day transfers"},{icon:Fo,label:"Low fees",desc:"2.9% + 30"}].map(({icon:Y,label:T,desc:E})=>a.jsxs("div",{className:"bg-white/70 rounded-xl p-4 text-center",children:[a.jsx(Y,{className:"w-5 h-5 text-violet-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm font-semibold text-slate-900",children:T}),a.jsx("p",{className:"text-xs text-slate-500",children:E})]},T))}),a.jsx("button",{onClick:O,disabled:c==="create",className:"flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-violet-600 to-blue-600 hover:from-violet-700 hover:to-blue-700 text-white rounded-xl font-bold text-base shadow-lg shadow-violet-600/25 transition-all disabled:opacity-50",children:c==="create"?a.jsxs(a.Fragment,{children:[a.jsx(Mn,{className:"w-5 h-5 animate-spin"}),"Setting up..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Pn,{className:"w-5 h-5"}),"Connect with Stripe",a.jsx(Cl,{className:"w-5 h-5"})]})}),B==="free"&&a.jsxs("p",{className:"mt-4 text-xs text-slate-500 flex items-center gap-1",children:[a.jsx(p1,{className:"w-3.5 h-3.5"}),"Free tier: ",L," platform fee on deposits.",a.jsx("a",{href:"#",className:"text-violet-600 hover:underline",children:"Upgrade to remove"})]})]})}),v&&!_&&a.jsx("div",{className:"bg-amber-50 rounded-2xl border border-amber-200 p-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(Wt,{className:"w-6 h-6 text-amber-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Complete Your Setup"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Your Stripe account is created, but you need to complete the onboarding process to start accepting payments."}),a.jsx("button",{onClick:z,disabled:c==="onboard",className:"flex items-center gap-2 px-5 py-2.5 bg-amber-600 hover:bg-amber-700 text-white rounded-xl font-semibold text-sm shadow-md transition-all disabled:opacity-50",children:c==="onboard"?a.jsxs(a.Fragment,{children:[a.jsx(Mn,{className:"w-4 h-4 animate-spin"}),"Redirecting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(cr,{className:"w-4 h-4"}),"Complete Setup"]})})]})]})}),v&&_&&!R&&a.jsx("div",{className:"bg-blue-50 rounded-2xl border border-blue-200 p-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(rM,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Verification in Progress"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Stripe is reviewing your account. This usually takes a few minutes. Once approved, you'll be able to accept payments."}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("button",{onClick:z,disabled:c==="onboard",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[c==="onboard"?a.jsx(Mn,{className:"w-4 h-4 animate-spin"}):a.jsx(cr,{className:"w-4 h-4"}),"Check Status"]})})]})]})}),v&&R&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:a.jsx(Ms,{className:"w-7 h-7"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Stripe Connected"}),a.jsx("span",{className:"px-2 py-0.5 bg-white/20 text-xs font-bold rounded-full",children:"Active"})]}),a.jsx("p",{className:"text-white/80 text-sm mt-0.5",children:"You're ready to accept deposit payments"})]})]}),a.jsxs("button",{onClick:G,disabled:c==="dashboard",className:"flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[c==="dashboard"?a.jsx(Mn,{className:"w-4 h-4 animate-spin"}):a.jsx(cr,{className:"w-4 h-4"}),"Stripe Dashboard"]})]})}),g&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Available"}),a.jsx(g1,{className:"w-4 h-4 text-emerald-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:g.balance.available[0]?ae(g.balance.available[0].amount,g.balance.available[0].currency):"$0.00"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Ready to pay out"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Pending"}),a.jsx(Wt,{className:"w-4 h-4 text-blue-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:g.balance.pending[0]?ae(g.balance.pending[0].amount,g.balance.pending[0].currency):"$0.00"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Processing"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Platform Fee"}),a.jsx(Fo,{className:"w-4 h-4 text-violet-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:L}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:B==="free"?"Upgrade to remove":"No platform fees"})]})]}),g?.recentCharges?.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-bold text-slate-900",children:"Recent Payments"}),a.jsx("button",{onClick:G,className:"text-xs font-medium text-blue-600 hover:text-blue-700",children:"View All "})]}),a.jsx("div",{className:"space-y-3",children:g.recentCharges.slice(0,5).map(Y=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${Y.status==="succeeded"?"bg-emerald-100":"bg-slate-100"}`,children:Y.status==="succeeded"?a.jsx(Ms,{className:"w-4 h-4 text-emerald-600"}):a.jsx(Wt,{className:"w-4 h-4 text-slate-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:Y.metadata?.clientName||"Payment"}),a.jsxs("p",{className:"text-xs text-slate-400",children:[ue(Y.created),Y.metadata?.serviceName&&`  ${Y.metadata.serviceName}`]})]})]}),a.jsx("span",{className:"text-sm font-bold text-slate-900",children:ae(Y.amount,Y.currency)})]},Y.id))})]}),g?.recentPayouts?.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-bold text-slate-900",children:"Recent Payouts"}),a.jsx(ec,{className:"w-4 h-4 text-slate-400"})]}),a.jsx("div",{className:"space-y-3",children:g.recentPayouts.slice(0,3).map(Y=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${Y.status==="paid"?"bg-emerald-100":"bg-amber-100"}`,children:a.jsx(g1,{className:`w-4 h-4 ${Y.status==="paid"?"text-emerald-600":"text-amber-600"}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900 capitalize",children:Y.status}),a.jsx("p",{className:"text-xs text-slate-400",children:Y.arrivalDate?`Arrives ${ue(Y.arrivalDate)}`:ue(Y.created)})]})]}),a.jsx("span",{className:"text-sm font-bold text-emerald-600",children:ae(Y.amount,Y.currency)})]},Y.id))})]})]}),a.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-5",children:[a.jsxs("h3",{className:"font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(p1,{className:"w-4 h-4 text-blue-500"}),"How it works"]}),a.jsxs("ul",{className:"space-y-2 text-sm text-slate-600",children:[a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"1"}),a.jsx("span",{children:"Client books an appointment and pays the deposit"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"2"}),a.jsxs("span",{children:["Payment goes directly to your Stripe account (minus Stripe's 2.9% + 30 fee",B==="free"&&` and ${L} platform fee`,")"]})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"3"}),a.jsx("span",{children:"Stripe automatically transfers funds to your bank (usually within 2 days)"})]})]})]})]})}const f9=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function F0(n){const[e,t]=n.split(":").map(Number);return e*60+t}function m9(n,e){if(n.status!=="waiting"||n.serviceId&&e.serviceId&&n.serviceId!==e.serviceId||n.staffId&&n.staffId!=="any"&&e.staffId&&n.staffId!==e.staffId)return!1;if(e.date){if(n.preferredDate&&n.preferredDate!==e.date)return!1;if(n.preferredDays&&n.preferredDays.length>0){const t=new Date(e.date+"T12:00:00"),i=f9[t.getDay()];if(!n.preferredDays.includes(i))return!1}}if(e.time&&n.preferredTimeRange){const t=F0(e.time),i=F0(n.preferredTimeRange.start),o=F0(n.preferredTimeRange.end);if(!(n.preferredTimeRange.start==="00:00"&&n.preferredTimeRange.end==="23:59")&&(t<i||t>o))return!1}return!0}function p9(n,e){return n.filter(t=>m9(t,e)).sort((t,i)=>(t.createdAt||"").localeCompare(i.createdAt||""))}const L1=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}];function Or(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"PM":"AM";return`${e%12||12}:${t.toString().padStart(2,"0")} ${i}`}function x9({user:n}){const{slug:e}=rc(),t=hr(),[i,o]=cj(),[c,d]=j.useState(null),[m,x]=j.useState(null),[g,b]=j.useState(!0),[v,_]=j.useState(!1),[R,B]=j.useState([]),[L,O]=j.useState([]),[z,G]=j.useState([]),[H,ae]=j.useState([]),ue=["schedule","clients","walkins","analytics","waitlist","staff","services","subscription","settings"],Y=i.get("tab"),T=ue.includes(Y)?Y:"schedule",E=D=>{o({tab:D})},[S,k]=j.useState(null),[C,P]=j.useState("all"),[I,$]=j.useState("all"),[U,V]=j.useState([]),[K,oe]=j.useState(null),[Ee,ye]=j.useState(null),[F,J]=j.useState(!1),[de,xe]=j.useState(!1),[le,Ce]=j.useState(null),[$e,Ct]=j.useState([]),[ot,qt]=j.useState([]),[Z,je]=j.useState({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""});j.useEffect(()=>{if(!n){t(`/shop/${e}/login`,{replace:!0});return}(async()=>{b(!0);try{const Q=pn(Ye(fe,"shops"),cn("slug","==",e)),be=await ys(Q);if(be.empty){_(!0),b(!1);return}const he=be.docs[0],ze=he.data();if(ze.ownerUid!==n.uid){_(!0),b(!1);return}d(ze),x(he.id)}catch(Q){console.error("Error checking ownership:",Q),_(!0)}finally{b(!1)}})()},[n,e,t]),j.useEffect(()=>{if(!m)return;const D=ns(Ye(fe,"shops",m,"availability"),lt=>{const ut=lt.docs.map(Xe=>({id:Xe.id,...Xe.data()}));B(ut)}),Q=ns(Ye(fe,"shops",m,"bookings"),lt=>{const ut=lt.docs.map(Xe=>({id:Xe.id,...Xe.data()}));O(ut)}),be=ns(Ye(fe,"shops",m,"staff"),lt=>{const ut=lt.docs.map(Xe=>({id:Xe.id,...Xe.data()})).filter(Xe=>Xe.active!==!1).sort((Xe,wt)=>(Xe.name||"").localeCompare(wt.name||""));G(ut)}),he=ns(Ye(fe,"shops",m,"waitlist"),lt=>{const ut=lt.docs.map(Xe=>({id:Xe.id,...Xe.data()})).sort((Xe,wt)=>(Xe.createdAt||"").localeCompare(wt.createdAt||""));V(ut)}),ze=ns(Ye(fe,"shops",m,"services"),lt=>{const ut=lt.docs.map(Xe=>({id:Xe.id,...Xe.data()})).filter(Xe=>Xe.active!==!1).sort((Xe,wt)=>(Xe.name||"").localeCompare(wt.name||""));ae(ut)});return()=>{D(),Q(),be(),he(),ze()}},[m]);const Se=async()=>{await $u(xn),t(`/shop/${e}`,{replace:!0})},qe=async D=>{D.preventDefault();const{date:Q,startTime:be,endTime:he,slotDuration:ze,staffId:lt}=Z,ut=parseInt(ze),[Xe,wt]=be.split(":").map(Number),[as,cs]=he.split(":").map(Number),_s=Xe*60+wt,fs=as*60+cs;let $a=_s;for(;$a+ut<=fs;){const Ki=Math.floor($a/60),ia=$a%60,la=`${Ki.toString().padStart(2,"0")}:${ia.toString().padStart(2,"0")}`,pr={date:Q,time:la,duration:ut,available:!0};if(lt){const Qi=z.find(Xi=>Xi.id===lt);pr.staffId=lt,pr.staffName=Qi?.name||""}await Ua(Ye(fe,"shops",m,"availability"),pr),$a+=ut}je({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""})},tt=async D=>{await zo(Me(fe,"shops",m,"availability",D))},gt=D=>{const Q={date:D.date,time:D.time,staffId:D.staffId||null,serviceId:D.serviceId||null},be=p9(U,Q);be.length>0&&oe({matches:be,slot:Q})},Ks=async(D,Q)=>{for(const be of D)await Ke(Me(fe,"shops",m,"waitlist",be.id),{status:"notified",notifiedAt:new Date().toISOString(),notifiedSlot:{date:Q.date,time:Q.time,staffId:Q.staffId||null,staffName:Q.staffName||null}});oe(null)},Ot=async D=>{await Ke(Me(fe,"shops",m,"waitlist",D),{status:"notified",notifiedAt:new Date().toISOString()})},bt=async D=>{await Ke(Me(fe,"shops",m,"waitlist",D),{status:"expired"})},Re=async D=>{const Q=L.find(be=>be.id===D);if(Q&&Q.recurringGroupId){ye({bookingId:D,recurringGroupId:Q.recurringGroupId});return}if(await Ke(Me(fe,"shops",m,"bookings",D),{status:"cancelled"}),Q&&Q.slotId&&!Q.slotId.startsWith("wh-")&&!Q.slotId.startsWith("recurring-"))try{await Ke(Me(fe,"shops",m,"availability",Q.slotId),{available:!0})}catch(be){console.warn("Could not re-open slot:",be)}Q&&gt(Q)},Be=async D=>{const Q=L.find(be=>be.id===D);if(await Ke(Me(fe,"shops",m,"bookings",D),{status:"cancelled"}),Q&&Q.slotId&&!Q.slotId.startsWith("wh-")&&!Q.slotId.startsWith("recurring-"))try{await Ke(Me(fe,"shops",m,"availability",Q.slotId),{available:!0})}catch(be){console.warn("Could not re-open slot:",be)}Q&&gt(Q),ye(null)},pe=async(D,Q)=>{const be=L.find(ze=>ze.id===D);if(!be)return;const he=L.filter(ze=>ze.recurringGroupId===Q&&ze.date>=be.date&&(ze.status==="pending"||ze.status==="confirmed"));for(const ze of he)if(await Ke(Me(fe,"shops",m,"bookings",ze.id),{status:"cancelled"}),ze.slotId&&!ze.slotId.startsWith("wh-")&&!ze.slotId.startsWith("recurring-"))try{await Ke(Me(fe,"shops",m,"availability",ze.slotId),{available:!0})}catch(lt){console.warn("Could not re-open slot:",lt)}be&&gt(be),ye(null)},We=async D=>{await Ke(Me(fe,"shops",m,"bookings",D),{status:"confirmed"})},Le=async D=>{const Q=L.find(be=>be.id===D);if(await Ke(Me(fe,"shops",m,"bookings",D),{status:"rejected"}),Q&&Q.slotId&&!Q.slotId.startsWith("wh-"))try{await Ke(Me(fe,"shops",m,"availability",Q.slotId),{available:!0})}catch(be){console.warn("Could not re-open slot:",be)}Q&&gt(Q)},De=async D=>{await Ke(Me(fe,"shops",m,"bookings",D),{status:"completed",completedAt:On()}),Ce(null)},Ge=async D=>{await Ke(Me(fe,"shops",m,"bookings",D),{status:"in_progress",startedAt:On()}),le&&le.id===D&&Ce(Q=>({...Q,status:"in_progress"}))},He=async D=>{Ce(D);try{const be=(await ys(pn(Ye(fe,"shops",m,"clientNotes"),cn("clientEmail","==",D.clientEmail)))).docs.map(he=>({id:he.id,...he.data()}));Ct(be)}catch(Q){console.error("Error fetching client notes:",Q),Ct([])}try{const be=(await ys(pn(Ye(fe,"shops",m,"bookings"),cn("clientEmail","==",D.clientEmail)))).docs.map(he=>({id:he.id,...he.data()})).filter(he=>he.id!==D.id&&(he.status==="completed"||he.status==="confirmed"||!he.status)).sort((he,ze)=>ze.date.localeCompare(he.date)).slice(0,5);qt(be)}catch(Q){console.error("Error fetching client history:",Q),qt([])}},ee=()=>{Ce(null),Ct([]),qt([])},ke=async()=>{const D=!c?.requireApproval;try{await Ke(Me(fe,"shops",m),{requireApproval:D}),d(Q=>({...Q,requireApproval:D}))}catch(Q){console.error("Error updating requireApproval:",Q)}},nt=async D=>{const Q=parseInt(D);try{await Ke(Me(fe,"shops",m),{bufferMinutes:Q}),d(be=>({...be,bufferMinutes:Q}))}catch(be){console.error("Error updating buffer minutes:",be)}},it=async D=>{const Q=D.target.files?.[0];if(Q){if(!Q.type.startsWith("image/")){alert("Please select an image file");return}if(Q.size>2*1024*1024){alert("Image must be smaller than 2MB");return}xe(!0);try{const be=bx(yx,`shops/${m}/logo-${Date.now()}`);await Z_(be,Q);const he=await eS(be);await Ke(Me(fe,"shops",m),{logoUrl:he}),d(ze=>({...ze,logoUrl:he}))}catch(be){console.error("Error uploading logo:",be),alert("Failed to upload logo. Please try again.")}finally{xe(!1)}}},Bt=async D=>{try{await Ke(Me(fe,"shops",m),{brandColor:D}),d(Q=>({...Q,brandColor:D}))}catch(Q){console.error("Error updating brand color:",Q)}},is=async D=>{try{await Ke(Me(fe,"shops",m),{tagline:D}),d(Q=>({...Q,tagline:D}))}catch(Q){console.error("Error updating tagline:",Q)}},yt=(D,Q)=>{const[be,he,ze]=D.split("-").map(Number),[lt,ut]=(Q||"00:00").split(":").map(Number);return new Date(be,he-1,ze,lt,ut).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})},gs=j.useMemo(()=>{const D={},Q=C==="all"?z:z.filter(he=>he.id===C),be=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(const he of Q)he.weeklyHours&&be.forEach((ze,lt)=>{he.weeklyHours[ze]?.enabled&&(D[lt]=!0)});return D},[z,C]),hs=j.useMemo(()=>{const D={},Q=C==="all"?z:z.filter(ze=>ze.id===C),be=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],he=new Date;he.setHours(0,0,0,0);for(let ze=0;ze<60;ze++){const lt=new Date(he);lt.setDate(lt.getDate()+ze);const ut=lt.getDay(),Xe=be[ut],wt=`${lt.getFullYear()}-${String(lt.getMonth()+1).padStart(2,"0")}-${String(lt.getDate()).padStart(2,"0")}`;for(const as of Q){if(!as.weeklyHours||!as.weeklyHours[Xe]?.enabled)continue;const cs=as.weeklyHours[Xe],_s=cs.breaks||(cs.break?[cs.break]:[]);_s.length>0&&(D[wt]||(D[wt]=[]),D[wt].push(..._s.map(fs=>({...fs,staffId:as.id,staffName:as.name}))))}}return D},[z,C]),ws=j.useMemo(()=>(C==="all"?z:z.filter(Q=>Q.id===C)).filter(Q=>Q.weeklyHours?L1.some(be=>Q.weeklyHours[be.key]?.enabled):!1),[z,C]),Ps=j.useMemo(()=>{const D=new Date,Q=`${D.getFullYear()}-${String(D.getMonth()+1).padStart(2,"0")}-${String(D.getDate()).padStart(2,"0")}`,be=D.getDay(),he=be===0?-6:1-be,ze=new Date(D);ze.setDate(D.getDate()+he),ze.setHours(0,0,0,0);const lt=new Date(ze);lt.setDate(ze.getDate()+6),lt.setHours(23,59,59,999);const ut=`${ze.getFullYear()}-${String(ze.getMonth()+1).padStart(2,"0")}-${String(ze.getDate()).padStart(2,"0")}`,Xe=`${lt.getFullYear()}-${String(lt.getMonth()+1).padStart(2,"0")}-${String(lt.getDate()).padStart(2,"0")}`,wt=L.filter(_s=>_s.date===Q).length,as=L.filter(_s=>_s.date>=ut&&_s.date<=Xe).length,cs=new Set(L.map(_s=>_s.clientEmail?.toLowerCase()).filter(Boolean)).size;return{todayBookings:wt,weekBookings:as,uniqueClients:cs,totalBookings:L.length}},[L]),ra=j.useMemo(()=>L.filter(D=>D.status==="pending").length,[L]),Vs=j.useMemo(()=>U.filter(D=>D.status==="waiting").length,[U]),[_e,Ie]=j.useState(0),[ft,vt]=j.useState({}),Rt=j.useMemo(()=>{if(!c)return 0;c?.winbackSettings?.warningDays;const D=c?.winbackSettings?.inactiveDays||60;if(!(c?.winbackSettings?.enabled!==!1))return 0;const be=new Date,he=L.filter(Xe=>Xe.status==="confirmed"||Xe.status==="pending"||!Xe.status),ze={};he.forEach(Xe=>{const wt=Xe.clientEmail?.toLowerCase();wt&&(!ze[wt]||Xe.date>ze[wt])&&(ze[wt]=Xe.date)});let lt=0;const ut=Xe=>Xe.replace(/\./g,"_dot_").replace(/@/g,"_at_");return Object.entries(ze).forEach(([Xe,wt])=>{if(Math.floor((be.getTime()-new Date(wt+"T12:00:00").getTime())/864e5)>D){const cs=ut(Xe);ft[cs]?.contacted||lt++}}),lt},[L,c,ft]);if(j.useEffect(()=>{if(!m)return;const D=ns(Ye(fe,"shops",m,"clientNotes"),Q=>{const be={};Q.docs.forEach(he=>{be[he.id]=he.data()}),vt(be)});return()=>D()},[m]),j.useEffect(()=>{if(!m)return;const D=ns(Ye(fe,"shops",m,"walkins"),Q=>{const be=Q.docs.filter(he=>he.data().status==="waiting").length;Ie(be)});return()=>D()},[m]),g)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading dashboard"})]})});if(v)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Vf,{className:"w-8 h-8 text-red-500"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Unauthorized"}),a.jsx("p",{className:"text-slate-600 mb-6",children:"You don't have access to this dashboard."}),a.jsx(Ze,{to:`/shop/${e}/login`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:"Login"})]})});const Qe=C==="all"?R:R.filter(D=>D.staffId===C),st=C==="all"?L:L.filter(D=>D.staffId===C),Mt=Qe.reduce((D,Q)=>(D[Q.date]||(D[Q.date]=[]),D[Q.date].push(Q),D),{}),Ns=st.reduce((D,Q)=>(D[Q.date]||(D[Q.date]=[]),D[Q.date].push(Q),D),{}),bn=S?Object.keys(Mt).filter(D=>D===S).sort():Object.keys(Mt).sort(),ls=S?st.filter(D=>D.date===S):st,$n=I==="all"?ls:I==="pending"?ls.filter(D=>D.status==="pending"):I==="confirmed"?ls.filter(D=>!D.status||D.status==="confirmed"):I==="in_progress"?ls.filter(D=>D.status==="in_progress"):I==="completed"?ls.filter(D=>D.status==="completed"):ls.filter(D=>D.status==="cancelled"||D.status==="rejected"),_a={all:ls.length,pending:ls.filter(D=>D.status==="pending").length,confirmed:ls.filter(D=>!D.status||D.status==="confirmed").length,in_progress:ls.filter(D=>D.status==="in_progress").length,completed:ls.filter(D=>D.status==="completed").length,cancelled:ls.filter(D=>D.status==="cancelled"||D.status==="rejected").length},qn=L.filter(D=>D.status==="in_progress"),bs=new Date().toISOString().split("T")[0],Fa=new Date,js=Fa.getHours()*60+Fa.getMinutes(),Qs=L.filter(D=>{if(D.date!==bs||D.status!=="confirmed"&&D.status!==void 0&&D.status!==null)return!1;const[Q,be]=(D.time||"00:00").split(":").map(Number);return Q*60+be>=js-15}).sort((D,Q)=>D.time.localeCompare(Q.time)).slice(0,2),os=[{key:"schedule",label:"Schedule",icon:_t},{key:"clients",label:"Clients",icon:zg},{key:"walkins",label:"Walk-ins",icon:hS},{key:"analytics",label:"Analytics",icon:nS},{key:"waitlist",label:"Waitlist",icon:wx},{key:"staff",label:"Staff",icon:Ft},{key:"services",label:"Services",icon:Un},{key:"subscription",label:"Plan",icon:Jo},{key:"settings",label:"Settings",icon:uf}];return a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>J(!0),className:"lg:hidden p-2 -ml-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:a.jsx(rS,{className:"w-6 h-6"})}),a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(c.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{className:"hidden sm:block",children:[a.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:c.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),a.jsx("div",{className:"hidden lg:flex items-center bg-slate-100 p-1 rounded-xl",children:os.map(D=>{const Q=D.icon,he=D.key==="schedule"&&ra>0?{count:ra,color:"bg-amber-500"}:D.key==="clients"&&Rt>0?{count:Rt,color:"bg-orange-500"}:D.key==="walkins"&&_e>0?{count:_e,color:"bg-emerald-500"}:D.key==="waitlist"&&Vs>0?{count:Vs,color:"bg-blue-500"}:null;return a.jsxs("button",{onClick:()=>E(D.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${T===D.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(Q,{className:"w-4 h-4"}),a.jsx("span",{children:D.label}),he&&a.jsx("span",{className:`ml-1 px-1.5 py-0.5 ${he.color} text-white text-[10px] font-bold rounded-full leading-none`,children:he.count})]},D.key)})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Ze,{to:`/shop/${e}`,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[a.jsx(Vu,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"View Page"})]}),a.jsxs("button",{onClick:Se,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",children:[a.jsx(Zu,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),F&&a.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>J(!1)}),a.jsxs("div",{className:"fixed inset-y-0 left-0 w-72 bg-white shadow-2xl animate-slide-in-left",children:[a.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-slate-200",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm",children:(c.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-bold text-slate-900",children:c.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),a.jsx("button",{onClick:()=>J(!1),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",children:a.jsx(Os,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"p-3 space-y-1",children:os.map(D=>{const Q=D.icon,he=D.key==="schedule"&&ra>0?{count:ra,color:"bg-amber-500"}:D.key==="clients"&&Rt>0?{count:Rt,color:"bg-orange-500"}:D.key==="walkins"&&_e>0?{count:_e,color:"bg-emerald-500"}:D.key==="waitlist"&&Vs>0?{count:Vs,color:"bg-blue-500"}:null;return a.jsxs("button",{onClick:()=>{E(D.key),J(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left font-medium transition-all ${T===D.key?"bg-blue-50 text-blue-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,children:[a.jsx(Q,{className:`w-5 h-5 ${T===D.key?"text-blue-600":"text-slate-400"}`}),a.jsx("span",{className:"flex-1",children:D.label}),he&&a.jsx("span",{className:`px-2 py-0.5 ${he.color} text-white text-xs font-bold rounded-full`,children:he.count})]},D.key)})}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 border-t border-slate-200 bg-slate-50",children:[a.jsxs(Ze,{to:`/shop/${e}`,onClick:()=>J(!1),className:"flex items-center gap-3 px-4 py-3 text-slate-600 hover:bg-white rounded-xl font-medium transition-all",children:[a.jsx(Vu,{className:"w-5 h-5 text-slate-400"}),"View Public Page"]}),a.jsxs("button",{onClick:()=>{J(!1),Se()},className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl font-medium transition-all",children:[a.jsx(Zu,{className:"w-5 h-5"}),"Logout"]})]})]})]}),le&&a.jsxs("div",{className:"fixed inset-0 z-50",children:[a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:ee}),a.jsxs("div",{className:"fixed inset-y-0 right-0 w-full max-w-md bg-white shadow-2xl animate-slide-in-right overflow-y-auto",children:[a.jsx("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 z-10",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Appointment Check-In"}),a.jsx("p",{className:"text-sm text-slate-500",children:le.serviceName||"Appointment"})]}),a.jsx("button",{onClick:ee,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",children:a.jsx(Os,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-slate-50 rounded-xl p-4",children:[a.jsxs("h3",{className:"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx(zr,{className:"w-4 h-4"}),"Client Information"]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-blue-700 font-bold",children:(le.clientName||"").split(" ").map(D=>D[0]).join("").toUpperCase().slice(0,2)})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-900",children:le.clientName}),a.jsx("p",{className:"text-sm text-slate-500",children:le.clientEmail})]})]}),le.clientPhone&&a.jsxs("p",{className:"text-sm text-slate-600 flex items-center gap-2 ml-15",children:[a.jsx(Lu,{className:"w-4 h-4 text-slate-400"}),le.clientPhone]})]})]}),a.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[a.jsxs("h3",{className:"text-sm font-semibold text-blue-700 mb-3 flex items-center gap-2",children:[a.jsx(_t,{className:"w-4 h-4"}),"Appointment Details"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:"Service"}),a.jsx("span",{className:"font-medium text-slate-900",children:le.serviceName||"N/A"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:"Date & Time"}),a.jsx("span",{className:"font-medium text-slate-900",children:yt(le.date,le.time)})]}),le.servicePrice!=null&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:"Price"}),a.jsxs("span",{className:"font-semibold text-blue-600",children:["$",Number(le.servicePrice).toFixed(2)]})]}),le.staffName&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:"Staff"}),a.jsx("span",{className:"font-medium text-slate-900",children:le.staffName})]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx(m1,{className:"w-4 h-4"}),"Client Notes"]}),$e.length>0?a.jsx("div",{className:"space-y-2",children:$e.map(D=>a.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:[a.jsx("p",{className:"text-sm text-amber-900",children:D.note}),D.createdAt&&a.jsx("p",{className:"text-xs text-amber-600 mt-1",children:new Date(D.createdAt.toDate?.()||D.createdAt).toLocaleDateString()})]},D.id))}):a.jsx("p",{className:"text-sm text-slate-400 italic",children:"No notes for this client"})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx(Wt,{className:"w-4 h-4"}),"Visit History"]}),ot.length>0?a.jsx("div",{className:"space-y-2",children:ot.map(D=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:D.serviceName||"Appointment"}),a.jsx("p",{className:"text-xs text-slate-500",children:yt(D.date,D.time)})]}),a.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${D.status==="completed"?"bg-blue-100 text-blue-700":"bg-emerald-100 text-emerald-700"}`,children:D.status==="completed"?"Completed":"Confirmed"})]},D.id))}):a.jsx("p",{className:"text-sm text-slate-400 italic",children:"First visit!"})]})]}),a.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-slate-200 p-4 space-y-2",children:[le.status==="confirmed"||!le.status?a.jsxs("button",{onClick:()=>Ge(le.id),className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white rounded-xl font-semibold transition-all shadow-md shadow-orange-500/20",children:[a.jsx($o,{className:"w-5 h-5"}),"Start Appointment"]}):le.status==="in_progress"?a.jsxs("button",{onClick:()=>De(le.id),className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-xl font-semibold transition-all shadow-md shadow-emerald-500/20",children:[a.jsx(en,{className:"w-5 h-5"}),"Complete Appointment"]}):null,a.jsx("button",{onClick:ee,className:"w-full px-6 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all",children:"Close"})]})]})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[T==="schedule"&&a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8 animate-fade-in",children:[{label:"Today's Bookings",value:Ps.todayBookings,icon:f1,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:Ps.weekBookings,icon:ec,color:"bg-violet-100 text-violet-600"},{label:"Total Bookings",value:Ps.totalBookings,icon:Ug,color:"bg-emerald-100 text-emerald-600"},{label:"Unique Clients",value:Ps.uniqueClients,icon:Ft,color:"bg-amber-100 text-amber-600"}].map(D=>{const Q=D.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${D.color} rounded-xl flex items-center justify-center`,children:a.jsx(Q,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:D.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:D.label})]},D.label)})}),T==="schedule"&&(qn.length>0||Qs.length>0)&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6 animate-fade-in",children:[qn.length>0&&a.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-amber-500 rounded-xl p-5 text-white shadow-lg shadow-orange-500/20",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:a.jsx($o,{className:"w-4 h-4"})}),a.jsx("h3",{className:"font-bold",children:"Now Serving"})]}),a.jsx("div",{className:"space-y-2",children:qn.slice(0,2).map(D=>a.jsx("div",{className:"bg-white/10 backdrop-blur rounded-lg p-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:D.clientName}),a.jsx("p",{className:"text-sm text-white/80",children:D.serviceName||"Appointment"})]}),a.jsx("button",{onClick:()=>De(D.id),className:"px-3 py-1.5 bg-white text-orange-600 rounded-lg text-sm font-semibold hover:bg-orange-50 transition-all",children:"Complete"})]})},D.id))})]}),Qs.length>0&&a.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl p-5 text-white shadow-lg shadow-blue-500/20",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:a.jsx(Wt,{className:"w-4 h-4"})}),a.jsx("h3",{className:"font-bold",children:"Up Next"})]}),a.jsx("div",{className:"space-y-2",children:Qs.map((D,Q)=>a.jsx("div",{className:"bg-white/10 backdrop-blur rounded-lg p-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:D.clientName}),a.jsxs("p",{className:"text-sm text-white/80",children:[D.serviceName||"Appointment","  ",Or(D.time)]})]}),Q===0&&a.jsx("button",{onClick:async()=>{await Ge(D.id),He({...D,status:"in_progress"})},className:"px-3 py-1.5 bg-white text-blue-600 rounded-lg text-sm font-semibold hover:bg-blue-50 transition-all",children:"Start"})]})},D.id))})]})]}),T==="clients"&&a.jsx(o9,{shopId:m,bookings:L,shop:c,slug:e}),T==="walkins"&&a.jsx(r9,{shopId:m,services:H,staff:z,bookings:L}),T==="analytics"&&a.jsx(t9,{bookings:L}),T==="staff"&&a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:a.jsx(ZP,{shopId:m,shop:c,slug:e})}),T==="services"&&a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:a.jsx(LP,{shopId:m})}),T==="subscription"&&a.jsx(d9,{shopId:m,shop:c,slug:e}),K&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(Do,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Waitlist Match!"}),a.jsxs("p",{className:"text-sm text-slate-500",children:[K.matches.length," client",K.matches.length!==1?"s":""," on the waitlist match this freed slot"]})]})]}),a.jsx("div",{className:"bg-slate-50 rounded-xl p-3 mb-4 text-sm",children:a.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[a.jsx(_t,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-medium",children:[new Date(K.slot.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})," at ",(()=>{const[D,Q]=K.slot.time.split(":"),be=parseInt(D);return`${be%12||12}:${Q} ${be>=12?"PM":"AM"}`})()]})]})}),a.jsx("div",{className:"space-y-2 mb-5 max-h-48 overflow-y-auto",children:K.matches.map(D=>a.jsx("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-50 border border-blue-100 rounded-lg",children:a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:D.clientName}),a.jsx("span",{className:"text-xs text-slate-500 ml-2",children:D.serviceName})]})},D.id))}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>Ks(K.matches,K.slot),className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:[a.jsx(Do,{className:"w-4 h-4"}),"Notify All"]}),a.jsx("button",{onClick:()=>oe(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Dismiss"})]})]})}),Ee&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center",children:a.jsx(Li,{className:"w-5 h-5 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Cancel Recurring Booking"}),a.jsx("p",{className:"text-sm text-slate-500",children:"This booking is part of a recurring series"})]})]}),a.jsxs("div",{className:"space-y-2 mb-5",children:[a.jsxs("button",{onClick:()=>Be(Ee.bookingId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(sr,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this one only"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments stay active"})]})]}),a.jsxs("button",{onClick:()=>pe(Ee.bookingId,Ee.recurringGroupId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(Li,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future in series"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments"})]})]})]}),a.jsx("button",{onClick:()=>ye(null),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Never mind"})]})}),T==="waitlist"&&a.jsx("div",{className:"animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-5",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Waitlist"}),Vs>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:[Vs," waiting"]})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[U.length," total"]})]}),U.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(wx,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No waitlist entries yet"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Clients can join the waitlist when no slots are available on your booking page."})]}):a.jsx("div",{children:(()=>{const D={};return U.forEach(Q=>{const be=Q.serviceName||"Other";D[be]||(D[be]=[]),D[be].push(Q)}),Object.entries(D).sort(([Q],[be])=>Q.localeCompare(be)).map(([Q,be])=>a.jsxs("div",{className:"mb-6 last:mb-0",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100 flex items-center gap-2",children:[a.jsx(Un,{className:"w-3.5 h-3.5 text-blue-500"}),Q,a.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",be.filter(he=>he.status==="waiting").length," waiting)"]})]}),a.jsx("div",{className:"space-y-2.5",children:be.sort((he,ze)=>(he.createdAt||"").localeCompare(ze.createdAt||"")).map(he=>{const ze={waiting:"bg-blue-50 text-blue-700 border-blue-200",notified:"bg-emerald-50 text-emerald-700 border-emerald-200",booked:"bg-emerald-50 text-emerald-700 border-emerald-200",expired:"bg-slate-100 text-slate-500 border-slate-200"},lt={waiting:"Waiting",notified:"Notified",booked:"Booked",expired:"Removed"},ut=he.createdAt?(()=>{const wt=Date.now()-new Date(he.createdAt).getTime(),as=Math.floor(wt/864e5),cs=Math.floor(wt/36e5);return as>0?`${as}d`:`${cs}h`})():"",Xe={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return a.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(zr,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:he.clientName}),a.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${ze[he.status]||ze.waiting}`,children:lt[he.status]||"Waiting"})]}),a.jsxs("div",{className:"text-xs text-slate-500",children:["Joined ",ut," ago",he.refCode&&a.jsx("span",{className:"font-mono text-slate-400 ml-2",children:he.refCode})]})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[he.status==="waiting"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>Ot(he.id),className:"p-1.5 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-all",title:"Notify client",children:a.jsx(Do,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>bt(he.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove from waitlist",children:a.jsx(Os,{className:"w-4 h-4"})})]}),he.status==="notified"&&a.jsx("button",{onClick:()=>bt(he.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove",children:a.jsx(Os,{className:"w-3.5 h-3.5"})})]})]}),a.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[he.staffName&&he.staffName!=="Any Available"&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ft,{className:"w-3 h-3 text-violet-400"}),a.jsx("span",{className:"text-violet-600",children:he.staffName})]}),he.preferredDate&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(_t,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Preferred: ",new Date(he.preferredDate+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]})]}),he.preferredDays&&he.preferredDays.length>0&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(_t,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Days: ",he.preferredDays.map(wt=>Xe[wt]||wt).join(", ")]})]}),he.preferredTimeRange&&!(he.preferredTimeRange.start==="00:00"&&he.preferredTimeRange.end==="23:59")&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Wt,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Time: ",Or(he.preferredTimeRange.start),"",Or(he.preferredTimeRange.end)]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Lf,{className:"w-3 h-3"}),he.clientEmail]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Lu,{className:"w-3 h-3"}),he.clientPhone]})]}),he.status==="notified"&&he.notifiedSlot&&a.jsxs("div",{className:"mt-1.5 px-2.5 py-1.5 bg-emerald-50 border border-emerald-200 rounded-lg inline-flex items-center gap-1.5",children:[a.jsx(Do,{className:"w-3 h-3 text-emerald-500"}),a.jsxs("span",{className:"text-emerald-700 font-medium",children:["Notified about ",new Date(he.notifiedSlot.date+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})," at ",Or(he.notifiedSlot.time)]})]})]})]},he.id)})})]},Q))})()})]})}),T==="settings"&&a.jsxs("div",{className:"max-w-2xl animate-fade-in space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Settings"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure your booking preferences"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Require Booking Approval"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Review and approve bookings before they're confirmed"})]}),a.jsx("button",{type:"button",onClick:ke,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${c?.requireApproval?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${c?.requireApproval?"translate-x-6":"translate-x-1"}`})})]}),c?.requireApproval&&a.jsxs("div",{className:"p-3.5 bg-amber-50 border border-amber-200 rounded-xl text-xs text-amber-800 leading-relaxed",children:[a.jsx("strong",{children:" Approval mode is on."}),' New bookings will appear as "Pending" until you approve or reject them. Time slots are held while pending to prevent double-booking.']}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Buffer Time Between Bookings"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Add a gap between consecutive appointments"})]}),a.jsxs("select",{value:c?.bufferMinutes||0,onChange:D=>nt(D.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"0",children:"No buffer"}),a.jsx("option",{value:"5",children:"5 minutes"}),a.jsx("option",{value:"10",children:"10 minutes"}),a.jsx("option",{value:"15",children:"15 minutes"}),a.jsx("option",{value:"30",children:"30 minutes"})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Retention"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure win-back alerts to re-engage inactive clients"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Enable Win-back Alerts"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Show alerts when clients haven't visited in a while"})]}),a.jsx("button",{type:"button",onClick:async()=>{const D=c?.winbackSettings||{},Q=D.enabled===!1;try{await Ke(Me(fe,"shops",m),{winbackSettings:{...D,enabled:Q}}),d(be=>({...be,winbackSettings:{...be.winbackSettings||{},enabled:Q}}))}catch(be){console.error("Error updating winback settings:",be)}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${c?.winbackSettings?.enabled!==!1?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${c?.winbackSettings?.enabled!==!1?"translate-x-6":"translate-x-1"}`})})]}),c?.winbackSettings?.enabled!==!1&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Getting Cold Threshold"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "Getting Cold" after this many days without a booking'})]}),a.jsxs("select",{value:c?.winbackSettings?.warningDays||30,onChange:async D=>{const Q=parseInt(D.target.value),be=c?.winbackSettings||{};try{await Ke(Me(fe,"shops",m),{winbackSettings:{...be,warningDays:Q}}),d(he=>({...he,winbackSettings:{...he.winbackSettings||{},warningDays:Q}}))}catch(he){console.error("Error updating warning days:",he)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"14",children:"14 days"}),a.jsx("option",{value:"21",children:"21 days"}),a.jsx("option",{value:"30",children:"30 days"}),a.jsx("option",{value:"45",children:"45 days"}),a.jsx("option",{value:"60",children:"60 days"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"At Risk Threshold"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "At Risk" after this many days without a booking'})]}),a.jsxs("select",{value:c?.winbackSettings?.inactiveDays||60,onChange:async D=>{const Q=parseInt(D.target.value),be=c?.winbackSettings||{};try{await Ke(Me(fe,"shops",m),{winbackSettings:{...be,inactiveDays:Q}}),d(he=>({...he,winbackSettings:{...he.winbackSettings||{},inactiveDays:Q}}))}catch(he){console.error("Error updating inactive days:",he)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"30",children:"30 days"}),a.jsx("option",{value:"45",children:"45 days"}),a.jsx("option",{value:"60",children:"60 days"}),a.jsx("option",{value:"90",children:"90 days"}),a.jsx("option",{value:"120",children:"120 days"})]})]}),a.jsxs("div",{className:"p-3.5 bg-orange-50 border border-orange-200 rounded-xl text-xs text-orange-800 leading-relaxed",children:[a.jsx("strong",{children:" Tip:"}),' Clients flagged as "Lost" (over 90 days) will also appear in win-back alerts. Visit the ',a.jsx("strong",{children:"Clients"})," tab to view at-risk clients and send win-back messages."]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-1 flex items-center gap-2",children:[a.jsx(iS,{className:"w-5 h-5 text-violet-500"}),"Branding"]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Customize how your booking page looks to customers"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Shop Logo"}),a.jsxs("div",{className:"flex items-center gap-4",children:[c?.logoUrl?a.jsx("img",{src:c.logoUrl,alt:"Shop logo",className:"w-20 h-20 rounded-xl object-cover border-2 border-slate-200"}):a.jsx("div",{className:"w-20 h-20 rounded-xl bg-slate-100 border-2 border-dashed border-slate-300 flex items-center justify-center",children:a.jsx(bm,{className:"w-8 h-8 text-slate-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("label",{className:"relative cursor-pointer",children:[a.jsx("input",{type:"file",accept:"image/*",onChange:it,className:"hidden",disabled:de}),a.jsxs("span",{className:`inline-flex items-center gap-2 px-4 py-2.5 rounded-xl font-medium text-sm transition-all ${de?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-blue-50 text-blue-600 hover:bg-blue-100"}`,children:[a.jsx(EO,{className:"w-4 h-4"}),de?"Uploading...":c?.logoUrl?"Change Logo":"Upload Logo"]})]}),a.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Recommended: Square image, at least 200x200px. Max 2MB."})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Brand Color"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("input",{type:"color",value:c?.brandColor||"#3B82F6",onChange:D=>Bt(D.target.value),className:"w-12 h-12 rounded-xl cursor-pointer border-2 border-slate-200"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm text-slate-600",children:"Used for buttons and accents on your booking page"}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("span",{className:"text-xs text-slate-500",children:"Preview:"}),a.jsx("button",{className:"px-4 py-1.5 rounded-lg text-white text-sm font-medium",style:{backgroundColor:c?.brandColor||"#3B82F6"},children:"Book Now"})]})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Tagline"}),a.jsx("input",{type:"text",value:c?.tagline||"",onChange:D=>is(D.target.value),placeholder:"e.g., Your neighborhood barbershop since 2010",maxLength:100,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Appears below your shop name on the booking page (max 100 chars)"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-1 flex items-center gap-2",children:[a.jsx(jx,{className:"w-5 h-5 text-amber-500"}),"Review Requests"]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Automatically ask clients to leave reviews after their appointment"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Enable Review Requests"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Send an email asking for reviews after completed appointments"})]}),a.jsx("button",{type:"button",onClick:async()=>{const D=c?.reviewSettings||{},Q=!D.enabled;try{await Ke(Me(fe,"shops",m),{reviewSettings:{...D,enabled:Q}}),d(be=>({...be,reviewSettings:{...be.reviewSettings||{},enabled:Q}}))}catch(be){console.error("Error updating review settings:",be)}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${c?.reviewSettings?.enabled?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${c?.reviewSettings?.enabled?"translate-x-6":"translate-x-1"}`})})]}),c?.reviewSettings?.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Send After"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"How long after the appointment to send the review request"})]}),a.jsxs("select",{value:c?.reviewSettings?.delayHours||2,onChange:async D=>{const Q=parseInt(D.target.value),be=c?.reviewSettings||{};try{await Ke(Me(fe,"shops",m),{reviewSettings:{...be,delayHours:Q}}),d(he=>({...he,reviewSettings:{...he.reviewSettings||{},delayHours:Q}}))}catch(he){console.error("Error updating delay hours:",he)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"1",children:"1 hour"}),a.jsx("option",{value:"2",children:"2 hours"}),a.jsx("option",{value:"4",children:"4 hours"}),a.jsx("option",{value:"24",children:"24 hours"}),a.jsx("option",{value:"48",children:"48 hours"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Google Place ID"}),a.jsx("input",{type:"text",value:c?.reviewSettings?.googlePlaceId||"",onChange:async D=>{const Q=D.target.value,be=c?.reviewSettings||{};try{await Ke(Me(fe,"shops",m),{reviewSettings:{...be,googlePlaceId:Q}}),d(he=>({...he,reviewSettings:{...he.reviewSettings||{},googlePlaceId:Q}}))}catch(he){console.error("Error updating Google Place ID:",he)}},placeholder:"e.g., ChIJN1t_tDeuEmsRUsoyG83frY4",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),a.jsx("p",{className:"text-xs text-slate-500",children:a.jsxs("a",{href:"https://developers.google.com/maps/documentation/places/web-service/place-id",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["How to find your Place ID ",a.jsx(cr,{className:"w-3 h-3"})]})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("h3",{className:"font-semibold text-slate-900 text-sm",children:["Yelp Business ID ",a.jsx("span",{className:"text-slate-400 font-normal",children:"(optional)"})]}),a.jsx("input",{type:"text",value:c?.reviewSettings?.yelpBusinessId||"",onChange:async D=>{const Q=D.target.value,be=c?.reviewSettings||{};try{await Ke(Me(fe,"shops",m),{reviewSettings:{...be,yelpBusinessId:Q}}),d(he=>({...he,reviewSettings:{...he.reviewSettings||{},yelpBusinessId:Q}}))}catch(he){console.error("Error updating Yelp Business ID:",he)}},placeholder:"e.g., joes-barbershop-new-york",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Found in your Yelp business page URL: yelp.com/biz/",a.jsx("strong",{children:"your-business-id"})]})]}),(c?.reviewSettings?.googlePlaceId||c?.reviewSettings?.yelpBusinessId)&&a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsx("p",{className:"text-sm font-medium text-amber-800 mb-2",children:" Review links will go to:"}),a.jsxs("div",{className:"space-y-1 text-sm",children:[c?.reviewSettings?.googlePlaceId&&a.jsxs("a",{href:`https://search.google.com/local/writereview?placeid=${c.reviewSettings.googlePlaceId}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:["Google Reviews ",a.jsx(cr,{className:"w-3 h-3"})]}),c?.reviewSettings?.yelpBusinessId&&a.jsxs("a",{href:`https://www.yelp.com/writeareview/biz/${c.reviewSettings.yelpBusinessId}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:["Yelp Reviews ",a.jsx(cr,{className:"w-3 h-3"})]})]})]})]})]})]}),a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:a.jsx(h9,{shopId:m,shop:c,slug:e})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Visibility"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Temporarily hide your shop from public view"}),c?.archived?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Pu,{className:"w-5 h-5 text-amber-600"}),a.jsx("span",{className:"font-semibold text-amber-800",children:"Shop is Archived"})]}),a.jsx("p",{className:"text-sm text-amber-700",children:"Your shop is currently hidden from the public booking page. You can still access your dashboard to view history."})]}),a.jsxs("button",{onClick:async()=>{try{await Ke(Me(fe,"shops",m),{archived:!1,archivedAt:null}),d(D=>({...D,archived:!1,archivedAt:null}))}catch(D){console.error("Error unarchiving shop:",D)}},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-emerald-600/20 transition-all",children:[a.jsx(Pu,{className:"w-4 h-4"}),"Unarchive Shop"]})]}):a.jsxs("button",{onClick:async()=>{if(window.confirm("Are you sure you want to archive your shop? It will be hidden from the public booking page."))try{await Ke(Me(fe,"shops",m),{archived:!0,archivedAt:On()}),d(D=>({...D,archived:!0,archivedAt:new Date().toISOString()}))}catch(D){console.error("Error archiving shop:",D)}},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-amber-500 hover:bg-amber-600 text-white rounded-xl font-semibold text-sm shadow-md shadow-amber-500/20 transition-all",children:[a.jsx(Pu,{className:"w-4 h-4"}),"Archive Shop"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-3",children:"Archiving hides your shop but preserves all data. You can unarchive at any time."})]}),a.jsxs("div",{className:"bg-white rounded-xl border-2 border-red-200 p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(va,{className:"w-5 h-5 text-red-500"}),a.jsx("h2",{className:"text-lg font-bold text-red-600",children:"Danger Zone"})]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Irreversible actions that will permanently affect your shop"}),a.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl mb-4",children:[a.jsx("h3",{className:"font-semibold text-red-800 mb-2",children:"Delete Shop Permanently"}),a.jsxs("p",{className:"text-sm text-red-700 mb-3",children:["This will permanently delete your shop, all staff, bookings, time slots, and settings.",a.jsx("strong",{children:" This cannot be undone."})]}),a.jsxs("button",{onClick:()=>{const D=new Date().toISOString().split("T")[0],Q=L.filter(he=>he.date>=D&&(he.status==="pending"||he.status==="confirmed"||!he.status));if(Q.length>0){alert(`Cannot delete shop: You have ${Q.length} upcoming booking${Q.length!==1?"s":""}. Please cancel or complete all upcoming bookings before deleting your shop.`);return}const be=window.prompt(`To delete your shop, type "${c.name}" below:

 WARNING: This will permanently delete:
 Your shop and all settings
 All staff members
 All bookings (past and future)
 All time slots
 All waitlist entries
 All schedule presets`);be===c.name?(async()=>{try{const ze=["staff","bookings","availability","waitlist","schedulePresets","services","walkins","clientNotes"];for(const lt of ze){const ut=await ys(Ye(fe,"shops",m,lt));for(const Xe of ut.docs)await zo(Me(fe,"shops",m,lt,Xe.id))}await zo(Me(fe,"shops",m)),await $u(xn),t("/",{replace:!0})}catch(ze){console.error("Error deleting shop:",ze),alert("An error occurred while deleting the shop. Please try again.")}})():be!==null&&alert("Shop name did not match. Deletion cancelled.")},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-red-600/20 transition-all",children:[a.jsx(Oa,{className:"w-4 h-4"}),"Delete Shop Forever"]})]})]})]}),T==="schedule"&&a.jsxs("div",{className:"animate-fade-in",children:[z.length>0&&a.jsx("div",{className:"flex flex-wrap gap-4 mb-6",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5",children:"Filter by Staff"}),a.jsxs("select",{value:C,onChange:D=>P(D.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[a.jsx("option",{value:"all",children:"All Staff"}),z.map(D=>a.jsxs("option",{value:D.id,children:[D.name,D.role?`  ${D.role}`:""]},D.id))]})]})}),ws.length>0&&a.jsxs("div",{className:"mb-6 bg-violet-50 border border-violet-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Zo,{className:"w-4 h-4 text-violet-600"}),a.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Recurring Weekly Hours"})]}),a.jsx("div",{className:"space-y-2.5",children:ws.map(D=>{const Q=L1.filter(be=>D.weeklyHours[be.key]?.enabled);return a.jsxs("div",{className:"flex items-start gap-2.5",children:[a.jsx("div",{className:"w-7 h-7 bg-violet-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(Ft,{className:"w-3.5 h-3.5 text-violet-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-900 text-sm",children:D.name}),a.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:Q.map(be=>{const he=D.weeklyHours[be.key];return a.jsxs("span",{className:"inline-block px-2 py-0.5 bg-white text-violet-700 border border-violet-200 rounded text-xs font-medium",children:[be.short," ",Or(he.start),"",Or(he.end),he.break&&a.jsxs("span",{className:"text-amber-600 ml-1",children:["(break ",Or(he.break.start),"",Or(he.break.end),")"]})]},be.key)})})]})]},D.id)})}),a.jsx("p",{className:"text-xs text-violet-500 mt-3",children:"Slots auto-generate on the booking page. Manage hours in the Staff tab."})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Monthly Overview"}),a.jsx(OP,{slotsByDate:Mt,bookingsByDate:Ns,selectedDate:S,onSelectDate:k,recurringDayFlags:gs,breaksByDate:hs}),S&&a.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[a.jsxs("span",{className:"text-sm text-slate-600",children:["Showing: ",a.jsx("strong",{className:"text-slate-900",children:new Date(S+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),a.jsx("button",{onClick:()=>k(null),className:"text-xs px-3 py-1 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-medium transition-all border border-slate-200",children:"Show All"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:ws.length>0?"Add Custom Slots":"Create Time Slots"}),ws.length>0&&a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Use this for one-off availability outside regular hours."}),!ws.length&&a.jsx("div",{className:"mb-4"}),a.jsxs("form",{onSubmit:qe,className:"space-y-4",children:[z.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Staff Member"}),a.jsxs("select",{value:Z.staffId,onChange:D=>je({...Z,staffId:D.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"Select a staff member"}),z.map(D=>a.jsxs("option",{value:D.id,children:[D.name,D.role?`  ${D.role}`:""]},D.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Date"}),a.jsx("input",{type:"date",value:Z.date,onChange:D=>je({...Z,date:D.target.value}),required:!0,min:new Date().toISOString().split("T")[0],className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Start"}),a.jsx("input",{type:"time",value:Z.startTime,onChange:D=>je({...Z,startTime:D.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"End"}),a.jsx("input",{type:"time",value:Z.endTime,onChange:D=>je({...Z,endTime:D.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Slot Duration"}),(()=>{const[D,Q]=Z.startTime.split(":").map(Number),[be,he]=Z.endTime.split(":").map(Number),ze=be*60+he-(D*60+Q),lt=[{value:"15",label:"15 minutes"},{value:"30",label:"30 minutes"},{value:"45",label:"45 minutes"},{value:"60",label:"1 hour"},{value:"90",label:"1.5 hours"},{value:"120",label:"2 hours"}].filter(ut=>parseInt(ut.value)<=ze);return a.jsx("select",{value:Z.slotDuration,onChange:ut=>je({...Z,slotDuration:ut.target.value}),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:lt.length>0?lt.map(ut=>a.jsx("option",{value:ut.value,children:ut.label},ut.value)):a.jsx("option",{value:"15",children:"15 minutes"})})})()]}),a.jsxs("button",{type:"submit",className:"w-full flex items-center justify-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(dr,{className:"w-4 h-4"}),"Generate Slots"]})]}),a.jsxs("div",{className:"mt-4 p-3.5 bg-blue-50 border border-blue-100 rounded-xl text-xs text-slate-600 leading-relaxed",children:[a.jsx("strong",{className:"text-slate-700",children:" Tip:"})," ",ws.length>0?"Weekly hours auto-generate slots. Use this for one-off slots outside regular hours.":z.length>0?"Select a staff member, pick a date, and set working hours to create slots.":"Set your hours and slot duration. We'll create all the time slots for that day."]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:S?"Bookings":"All Bookings"}),_a.pending>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 border border-amber-200 text-xs font-bold rounded-full",children:[_a.pending," pending"]})]}),a.jsx("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:$n.length})]}),a.jsx("div",{className:"flex items-center gap-1 mb-4 p-1 bg-slate-100 rounded-lg overflow-x-auto",children:[{key:"all",label:"All"},{key:"pending",label:"Pending"},{key:"confirmed",label:"Confirmed"},{key:"in_progress",label:"In Progress"},{key:"completed",label:"Completed"},{key:"cancelled",label:"Cancelled"}].map(D=>a.jsxs("button",{onClick:()=>$(D.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-semibold transition-all whitespace-nowrap ${I===D.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[D.label,a.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${I===D.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:_a[D.key]})]},D.key))}),$n.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(f1,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium",children:I!=="all"?`No ${I} bookings`:S?"No bookings for this date":"No bookings yet"})]}):a.jsx("div",{className:"space-y-2.5 max-h-[500px] overflow-y-auto pr-1",children:$n.sort((D,Q)=>`${D.date}${D.time}`.localeCompare(`${Q.date}${Q.time}`)).map(D=>{const Q=D.status||"confirmed",be={pending:"bg-amber-50 text-amber-700 border-amber-200",confirmed:"bg-emerald-50 text-emerald-700 border-emerald-200",in_progress:"bg-orange-50 text-orange-700 border-orange-200",completed:"bg-blue-50 text-blue-700 border-blue-200",rejected:"bg-red-50 text-red-700 border-red-200",cancelled:"bg-slate-100 text-slate-500 border-slate-200"},he={pending:"Pending",confirmed:"Confirmed",in_progress:"In Progress",completed:"Completed",rejected:"Rejected",cancelled:"Cancelled"};return a.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(zr,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:D.clientName}),a.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${be[Q]}`,children:he[Q]}),D.recurring&&a.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",title:"Recurring appointment",children:a.jsx(Li,{className:"w-2.5 h-2.5"})})]}),a.jsx("div",{className:"text-xs text-slate-500",children:yt(D.date,D.time)})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[Q==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>We(D.id),className:"p-1.5 text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50 rounded-lg transition-all",title:"Approve booking",children:a.jsx(en,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Le(D.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Reject booking",children:a.jsx(sr,{className:"w-4 h-4"})})]}),Q==="confirmed"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:async()=>{await Ge(D.id),He({...D,status:"in_progress"})},className:"opacity-0 group-hover:opacity-100 flex items-center gap-1 px-2 py-1 text-orange-600 hover:text-orange-700 bg-orange-50 hover:bg-orange-100 rounded-lg transition-all text-xs font-medium",title:"Start appointment",children:[a.jsx($o,{className:"w-3 h-3"}),"Start"]}),a.jsx("button",{onClick:()=>Re(D.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Cancel booking",children:a.jsx(Oa,{className:"w-3.5 h-3.5"})})]}),Q==="in_progress"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>De(D.id),className:"flex items-center gap-1 px-2 py-1 text-emerald-600 hover:text-emerald-700 bg-emerald-50 hover:bg-emerald-100 rounded-lg transition-all text-xs font-medium",title:"Complete appointment",children:[a.jsx(en,{className:"w-3 h-3"}),"Complete"]}),a.jsx("button",{onClick:()=>He(D),className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",title:"View client info",children:a.jsx(m1,{className:"w-3.5 h-3.5"})})]})]})]}),a.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[D.serviceName&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Un,{className:"w-3 h-3 text-blue-400"}),a.jsx("span",{className:"font-medium text-slate-700",children:D.serviceName}),D.servicePrice!=null&&a.jsxs("span",{className:"text-blue-600 font-semibold",children:["$",Number(D.servicePrice).toFixed(2)]})]}),D.staffName&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ft,{className:"w-3 h-3 text-violet-400"}),a.jsx("span",{className:"text-violet-600",children:D.staffName})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Lf,{className:"w-3 h-3"}),D.clientEmail]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Lu,{className:"w-3 h-3"}),D.clientPhone]})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[D.refCode&&a.jsxs("span",{className:"font-mono text-[10px] text-slate-400",children:["REF: ",D.refCode]}),D.recurring&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-indigo-50 border border-indigo-200 rounded text-[10px] font-semibold text-indigo-600",children:" Recurring"})]})]})]},D.id)})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:S?"Custom Time Slots":"All Custom Time Slots"}),a.jsx("span",{className:"text-xs font-semibold text-slate-500 bg-slate-100 px-2.5 py-1 rounded-lg",children:S?(Mt[S]||[]).length:Qe.length})]}),ws.length>0&&a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Recurring slots from weekly hours auto-generate  not shown here."}),!ws.length&&a.jsx("div",{className:"mb-4"}),bn.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(_t,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:S?"No custom slots for this date":"No custom slots yet"}),a.jsx("p",{className:"text-xs text-slate-400",children:ws.length>0?"Recurring hours handle most scheduling.":"Use the form above to generate availability."})]}):a.jsx("div",{className:"space-y-6",children:bn.map(D=>a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100",children:new Date(D+"T12:00:00").toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-2.5",children:Mt[D].sort((Q,be)=>Q.time.localeCompare(be.time)).map(Q=>a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-3.5 text-center group hover:border-slate-300 transition-all",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900 mb-0.5",children:Or(Q.time)}),a.jsxs("div",{className:"text-xs text-slate-500 mb-1",children:[Q.duration," min"]}),Q.staffName&&a.jsxs("div",{className:"text-xs text-violet-600 mb-1.5 flex items-center justify-center gap-1",children:[a.jsx(Ft,{className:"w-3 h-3"}),Q.staffName]}),a.jsx("div",{className:"mb-2",children:Q.available?a.jsx("span",{className:"inline-block px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-md text-xs font-medium",children:"Available"}):a.jsx("span",{className:"inline-block px-2 py-0.5 bg-red-50 text-red-700 border border-red-200 rounded-md text-xs font-medium",children:"Booked"})}),Q.available&&a.jsxs("button",{onClick:()=>tt(Q.id),className:"opacity-0 group-hover:opacity-100 flex items-center justify-center gap-1 w-full px-2 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-xs font-medium transition-all border border-red-200",children:[a.jsx(Oa,{className:"w-3 h-3"}),"Remove"]})]},Q.id))})]},D))})]})]})]})]})}function g9({user:n}){const{slug:e}=rc(),t=hr(),[i,o]=j.useState(""),[c,d]=j.useState(""),[m,x]=j.useState(""),[g,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;(async()=>{const R=pn(Ye(fe,"shops"),cn("slug","==",e)),B=await ys(R);B.empty||B.docs[0].data().ownerUid===n.uid&&t(`/shop/${e}/dashboard`,{replace:!0})})()},[n,e,t]);const v=async _=>{_.preventDefault(),x(""),b(!0);try{const B=(await Gx(xn,i,c)).user,L=pn(Ye(fe,"shops"),cn("slug","==",e)),O=await ys(L);if(O.empty){x("Shop not found"),b(!1);return}if(O.docs[0].data().ownerUid!==B.uid){x("You are not the owner of this shop"),await xn.signOut(),b(!1);return}t(`/shop/${e}/dashboard`,{replace:!0})}catch(R){switch(R.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":x("Invalid email or password");break;case"auth/invalid-email":x("Please enter a valid email address");break;case"auth/too-many-requests":x("Too many failed attempts. Please try again later.");break;default:x("Login failed. Please try again.")}d("")}finally{b(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(Ze,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(sa,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),a.jsxs("form",{onSubmit:v,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:i,onChange:_=>{o(_.target.value),x("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:c,onChange:_=>{d(_.target.value),x("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${m?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),m&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",m]})]}),a.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):"Sign In"})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",a.jsx(Ze,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(Ze,{to:`/shop/${e}`,className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(Ma,{className:"w-3.5 h-3.5"}),"Back to booking page"]})})]})})}function U1({name:n,className:e="w-12 h-12",bgClass:t="bg-blue-100 text-blue-700"}){const i=(n||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return a.jsx("div",{className:`${e} ${t} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function B1(){return a.jsxs(Ze,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(sa,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function b9(){const{slug:n,refCode:e}=rc(),[t,i]=j.useState(null),[o,c]=j.useState(null),[d,m]=j.useState(!0),[x,g]=j.useState(!1),[b,v]=j.useState(null),[_,R]=j.useState(null),[B,L]=j.useState(!1),[O,z]=j.useState([]),[G,H]=j.useState([]),[ae,ue]=j.useState([]),[Y,T]=j.useState([]),[E,S]=j.useState(!1),[k,C]=j.useState(!1),[P,I]=j.useState(null),[$,U]=j.useState(null),[V,K]=j.useState(null),[oe,Ee]=j.useState(!1),[ye,F]=j.useState("");j.useEffect(()=>{(async()=>{m(!0);try{const Be=pn(Ye(fe,"shops"),cn("slug","==",n)),pe=await ys(Be);if(pe.empty)g(!0);else{const We=pe.docs[0];i(We.data()),c(We.id)}}catch(Be){console.error("Error looking up shop:",Be),g(!0)}finally{m(!1)}})()},[n]),j.useEffect(()=>{if(!o)return;(async()=>{try{const Be=pn(Ye(fe,"shops",o,"bookings"),cn("refCode","==",e.toUpperCase())),pe=await ys(Be);if(pe.empty)L(!0);else{const We=pe.docs[0];v(We.data()),R(We.id)}}catch(Be){console.error("Error looking up booking:",Be),L(!0)}})()},[o,e]),j.useEffect(()=>{if(!o||!b)return;const Re=ns(Ye(fe,"shops",o,"bookings"),Le=>{z(Le.docs.map(De=>({id:De.id,...De.data()})))}),Be=ns(Ye(fe,"shops",o,"availability"),Le=>{const De=new Date,Ge=Le.docs.map(He=>({id:He.id,...He.data()})).filter(He=>new Date(`${He.date}T${He.time}`)>De);H(Ge)}),pe=ns(Ye(fe,"shops",o,"staff"),Le=>{ue(Le.docs.map(De=>({id:De.id,...De.data()})).filter(De=>De.active!==!1).sort((De,Ge)=>(De.name||"").localeCompare(Ge.name||"")))}),We=ns(Ye(fe,"shops",o,"services"),Le=>{T(Le.docs.map(De=>({id:De.id,...De.data()})).filter(De=>De.active!==!1))});return()=>{Re(),Be(),pe(),We()}},[o,b]);const J=t?.bufferMinutes||0,de=j.useMemo(()=>{if(!b)return null;if(b.serviceId){const Re=Y.find(Be=>Be.id===b.serviceId);if(Re)return Re}return b.serviceName?{id:b.serviceId,name:b.serviceName,price:b.servicePrice,duration:b.serviceDuration||b.duration}:null},[b,Y]),xe=j.useMemo(()=>{if(!E||!b)return[];const Re=new Date,Be=de?.duration||b.duration||60;let pe=G.filter(He=>He.available);pe=pe.filter(He=>He.duration>=Be),b.staffId&&(pe=pe.filter(He=>He.staffId===b.staffId||!He.staffId));const We=b.staffId?ae.filter(He=>He.id===b.staffId):ae,Le=SS(We,Be,J,4).filter(He=>new Date(`${He.date}T${He.time}`)>Re),De=TS(Le,pe),Ge=O.filter(He=>He.id!==_);return ES(De,Ge,J)},[E,b,_,G,ae,O,J,de]),le=j.useMemo(()=>[...new Set(xe.map(Re=>Re.date))].sort(),[xe]),Ce=j.useMemo(()=>$?xe.filter(Re=>Re.date===$):[],[$,xe]),$e=async(Re="single")=>{Ee(!0);try{if(await Ke(Me(fe,"shops",o,"bookings",_),{status:"cancelled"}),b.slotId&&!b.slotId.startsWith("wh-")&&!b.slotId.startsWith("recurring-"))try{await Ke(Me(fe,"shops",o,"availability",b.slotId),{available:!0})}catch(Be){console.warn("Could not re-open slot:",Be)}if(Re==="future"&&b.recurringGroupId){const Be=O.filter(pe=>pe.recurringGroupId===b.recurringGroupId&&pe.id!==_&&pe.date>=b.date&&(pe.status==="pending"||pe.status==="confirmed"));for(const pe of Be)if(await Ke(Me(fe,"shops",o,"bookings",pe.id),{status:"cancelled"}),pe.slotId&&!pe.slotId.startsWith("wh-")&&!pe.slotId.startsWith("recurring-"))try{await Ke(Me(fe,"shops",o,"availability",pe.slotId),{available:!0})}catch(We){console.warn("Could not re-open slot:",We)}}v(Be=>({...Be,status:"cancelled"})),C(!1),I(null),F("cancelled")}catch(Be){console.error("Cancel error:",Be),F("error")}finally{Ee(!1)}},Ct=async()=>{if(V){Ee(!0);try{const Re={date:V.date,time:V.time,slotId:V.id};if(V.staffId&&(Re.staffId=V.staffId,Re.staffName=V.staffName||""),t?.requireApproval&&(Re.status="pending"),b.slotId&&!b.slotId.startsWith("wh-"))try{await Ke(Me(fe,"shops",o,"availability",b.slotId),{available:!0})}catch(Be){console.warn("Could not re-open old slot:",Be)}if(!V.generated&&V.id)try{await Ke(Me(fe,"shops",o,"availability",V.id),{available:!1})}catch(Be){console.warn("Could not block new slot:",Be)}await Ke(Me(fe,"shops",o,"bookings",_),Re),v(Be=>({...Be,...Re})),S(!1),U(null),K(null),F("rescheduled")}catch(Re){console.error("Reschedule error:",Re),F("error")}finally{Ee(!1)}}},ot=Re=>new Date(Re+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),qt=Re=>{const[Be,pe]=Re.split(":"),We=parseInt(Be),Le=We>=12?"PM":"AM";return`${We%12||12}:${pe} ${Le}`},Z=Re=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(Re),je=Re=>{if(!Re)return"";if(Re<60)return`${Re} min`;const Be=Math.floor(Re/60),pe=Re%60;return pe?`${Be}h ${pe}m`:`${Be} hour${Be>1?"s":""}`};if(d)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(x)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(_t,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(Ze,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Ma,{className:"w-4 h-4"}),"Go Home"]})]})});if(B)return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),a.jsx(B1,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(va,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Not Found"}),a.jsx("p",{className:"text-slate-600 mb-2",children:"No booking found with reference code"}),a.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),a.jsxs(Ze,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(_t,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking"})]})});const Se=b.status||"confirmed",qe=Se==="pending"||Se==="confirmed",tt=Se==="cancelled",gt=Se==="rejected",Ks={pending:{label:"Pending Approval",color:"bg-amber-100 text-amber-700 border-amber-200",icon:Wt},confirmed:{label:"Confirmed",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Ms},cancelled:{label:"Cancelled",color:"bg-slate-100 text-slate-500 border-slate-200",icon:sr},rejected:{label:"Rejected",color:"bg-red-100 text-red-700 border-red-200",icon:sr}},Ot=Ks[Se]||Ks.confirmed,bt=Ot.icon;return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),a.jsx(B1,{})]})}),a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[ye==="rescheduled"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(lS,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Rescheduled!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:t?.requireApproval?"Your booking has been rescheduled and is pending approval.":"Your booking has been successfully rescheduled."}),a.jsx("button",{onClick:()=>F(""),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View updated details "})]})}),ye==="cancelled"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(sr,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Cancelled"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking has been cancelled."}),a.jsxs(Ze,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[a.jsx(_t,{className:"w-4 h-4"}),"Book a new appointment"]})]})}),ye==="error"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Something went wrong. Please try again."})]})}),!E&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Your Booking"}),a.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference: ",a.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),(tt||gt)&&a.jsxs("div",{className:`mb-4 p-4 rounded-xl border flex items-center gap-3 ${tt?"bg-slate-50 border-slate-200":"bg-red-50 border-red-200"}`,children:[a.jsx(bt,{className:`w-5 h-5 ${tt?"text-slate-400":"text-red-500"}`}),a.jsx("span",{className:`font-medium text-sm ${tt?"text-slate-600":"text-red-700"}`,children:tt?"This booking has been cancelled.":"This booking has been rejected by the shop."})]}),b.recurringGroupId&&a.jsxs("div",{className:"mb-4 p-3.5 bg-blue-50 border border-blue-200 rounded-xl flex items-center gap-2.5",children:[a.jsx(Li,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Part of a recurring series"}),b.recurringInterval&&a.jsxs("p",{className:"text-xs text-blue-600 mt-0.5",children:["Repeats every ",b.recurringInterval==="weekly"?"week":b.recurringInterval==="biweekly"?"2 weeks":b.recurringInterval==="fourweekly"?"4 weeks":b.recurringInterval==="monthly"?"month":b.recurringInterval]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${Ot.color}`,children:[a.jsx(bt,{className:"w-3.5 h-3.5"}),Ot.label]})]}),b.serviceName&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Un,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.servicePrice!=null&&a.jsx("span",{className:"font-bold text-blue-600",children:Z(b.servicePrice)})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(U1,{name:b.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(_t,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[ot(b.date)," at ",qt(b.time)]})]}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Wt,{className:"w-4 h-4 text-slate-500"})}),a.jsx("span",{children:je(b.serviceDuration||b.duration)})]})]}),qe&&!ye&&a.jsx("div",{className:"space-y-3",children:k?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(va,{className:"w-5 h-5 text-red-500"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-slate-900",children:"Are you sure?"}),a.jsx("p",{className:"text-sm text-slate-600",children:"This action cannot be undone."})]})]}),b.recurringGroupId&&!P&&a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsxs("button",{onClick:()=>I("single"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(sr,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this appointment only"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments in the series remain active"})]})]}),a.jsxs("button",{onClick:()=>I("future"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(Li,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future appointments"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments in the series"})]})]}),a.jsx("button",{onClick:()=>C(!1),className:"w-full px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Go Back"})]}),(!b.recurringGroupId||P)&&a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>$e(P||"single"),disabled:oe,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold transition-all disabled:opacity-50",children:[oe?a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}):a.jsx(sr,{className:"w-4 h-4"}),oe?"Cancelling":P==="future"?"Cancel All Future":"Yes, Cancel"]}),a.jsx("button",{onClick:()=>{P?I(null):C(!1)},disabled:oe,className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Go Back"})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{S(!0),F("")},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(Zo,{className:"w-4 h-4"}),"Reschedule Booking"]}),a.jsxs("button",{onClick:()=>{C(!0),I(null)},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-white hover:bg-red-50 text-red-600 rounded-xl font-semibold border border-red-200 hover:border-red-300 transition-all",children:[a.jsx(sr,{className:"w-4 h-4"}),"Cancel Booking"]})]})}),(tt||gt)&&a.jsx("div",{className:"text-center",children:a.jsxs(Ze,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(_t,{className:"w-4 h-4"}),"Book Again"]})})]}),E&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:()=>{S(!1),U(null),K(null)},className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(Ma,{className:"w-3.5 h-3.5"}),"Back to Booking"]}),b.serviceName&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Un,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName}),b.servicePrice!=null&&a.jsx("span",{className:"text-blue-600 font-bold",children:Z(b.servicePrice)})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[a.jsx(U1,{name:b.staffName,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a New Time"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Pick a new date and time for your appointment"})]}),le.length===0?a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(_t,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),a.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"No time slots are currently available. Check back soon!"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-8",children:a.jsx(fS,{availableDates:le,selectedDate:$,onSelectDate:Re=>{U(Re),K(null)}})}),$&&a.jsxs("div",{className:"animate-slide-down",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",ot($)]}),a.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[Ce.length," slot",Ce.length!==1?"s":""]})]}),Ce.length===0?a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:a.jsx("p",{className:"text-slate-500",children:"No slots available for this date"})}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:Ce.sort((Re,Be)=>Re.time.localeCompare(Be.time)).map(Re=>{const Be=V?.id===Re.id;return a.jsxs("button",{onClick:()=>K(Re),className:`group border rounded-xl p-4 transition-all duration-200 text-center ${Be?"bg-blue-600 border-blue-600 text-white shadow-md shadow-blue-600/30":"bg-white border-slate-200 hover:border-blue-400 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5"}`,children:[a.jsx("div",{className:`text-lg font-bold mb-1 ${Be?"text-white":"text-slate-900 group-hover:text-blue-700"} transition-colors`,children:qt(Re.time)}),Re.staffName&&a.jsxs("div",{className:`text-xs mb-0.5 flex items-center justify-center gap-1 ${Be?"text-blue-100":"text-violet-600"}`,children:[a.jsx(Ft,{className:"w-3 h-3"}),Re.staffName]}),a.jsx("div",{className:`text-xs ${Be?"text-blue-200":"text-slate-400"}`,children:je(b.serviceDuration||b.duration)})]},Re.id)})}),V&&a.jsxs("div",{className:"mt-6 animate-fade-in",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-blue-200 shadow-sm p-5 mb-4",children:[a.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"New Appointment Time"}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm",children:[a.jsx(_t,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[ot(V.date)," at ",qt(V.time)]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:Ct,disabled:oe,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed",children:oe?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Rescheduling"]}):a.jsxs(a.Fragment,{children:[a.jsx(Ms,{className:"w-4 h-4"}),"Confirm Reschedule"]})}),a.jsx("button",{onClick:()=>K(null),className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]})]}),!$&&a.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]})]}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(Ze,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})})]})}function z1(){return a.jsxs(Ze,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(sa,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function y9(n){if(!n)return"Any time";const e=t=>{const[i,o]=t.split(":").map(Number),c=i>=12?"PM":"AM",d=i%12||12;return o===0?`${d}${c}`:`${d}:${o.toString().padStart(2,"0")}${c}`};return n.start==="00:00"&&n.end==="23:59"?"Any time":`${e(n.start)}  ${e(n.end)}`}function v9(n){if(!n||n.length===0)return"Any day";const e={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return n.map(t=>e[t]||t).join(", ")}function w9(n){if(!n)return"";const e=new Date,t=new Date(n),i=e-t,o=Math.floor(i/6e4);if(o<60)return`${o}m ago`;const c=Math.floor(o/60);return c<24?`${c}h ago`:`${Math.floor(c/24)}d ago`}function N9(){const{slug:n,refCode:e}=rc(),[t,i]=j.useState(null),[o,c]=j.useState(null),[d,m]=j.useState(!0),[x,g]=j.useState(!1),[b,v]=j.useState(null),[_,R]=j.useState(!1),[B,L]=j.useState(null);if(j.useEffect(()=>{(async()=>{m(!0);try{const Y=pn(Ye(fe,"shops"),cn("slug","==",n)),T=await ys(Y);if(T.empty)g(!0);else{const E=T.docs[0];i(E.data()),c(E.id)}}catch(Y){console.error("Error looking up shop:",Y),g(!0)}finally{m(!1)}})()},[n]),j.useEffect(()=>{if(!o)return;(async()=>{try{const Y=pn(Ye(fe,"shops",o,"waitlist"),cn("refCode","==",e.toUpperCase())),T=await ys(Y);if(T.empty){R(!0);return}const E=T.docs[0],S={id:E.id,...E.data()};v(S);const k=pn(Ye(fe,"shops",o,"waitlist"),cn("serviceId","==",S.serviceId),cn("status","==","waiting")),I=(await ys(k)).docs.map($=>({id:$.id,...$.data()})).sort(($,U)=>($.createdAt||"").localeCompare(U.createdAt||"")).findIndex($=>$.id===S.id);I>=0&&L(I+1)}catch(Y){console.error("Error looking up waitlist entry:",Y),R(!0)}})()},[o,e]),d)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(x)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(_t,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(Ze,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Ma,{className:"w-4 h-4"}),"Go Home"]})]})});if(_)return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),a.jsx(z1,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(va,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Waitlist Entry Not Found"}),a.jsx("p",{className:"text-slate-600 mb-2",children:"No waitlist entry found with reference code"}),a.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),a.jsxs(Ze,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(_t,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading waitlist"})]})});const O={waiting:{label:"Waiting",color:"bg-blue-100 text-blue-700 border-blue-200",icon:Wt},notified:{label:"Slot Available!",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Do},booked:{label:"Booked",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Ms},expired:{label:"Expired",color:"bg-slate-100 text-slate-500 border-slate-200",icon:Wt}},z=O[b.status]||O.waiting,G=z.icon,H=ue=>ue?new Date(ue+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):"",ae=ue=>{if(!ue)return"";const[Y,T]=ue.split(":"),E=parseInt(Y),S=E>=12?"PM":"AM";return`${E%12||12}:${T} ${S}`};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),a.jsx(z1,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[b.status==="notified"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Do,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"A Slot Is Available!"}),a.jsxs("p",{className:"text-slate-600 mb-4",children:["A slot has opened up for ",b.serviceName,". Book now before it's taken!"]}),b.notifiedSlot&&a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-xl text-sm text-emerald-700 font-medium mb-4",children:[a.jsx(_t,{className:"w-4 h-4"}),H(b.notifiedSlot.date)," at"," ",ae(b.notifiedSlot.time),b.notifiedSlot.staffName&&a.jsxs("span",{className:"text-emerald-600",children:[" ","with ",b.notifiedSlot.staffName]})]}),a.jsx("div",{children:a.jsxs(Ze,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-emerald-600/20 hover:shadow-lg",children:[a.jsx(_t,{className:"w-4 h-4"}),"Book Now "]})})]})}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Waitlist Status"}),a.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference:"," ",a.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${z.color}`,children:[a.jsx(G,{className:"w-3.5 h-3.5"}),z.label]})]}),b.status==="waiting"&&B!=null&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Position"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(wx,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-bold text-slate-900 text-lg",children:["#",B]}),a.jsx("span",{className:"text-sm text-slate-500",children:"in line"})]})]}),b.serviceName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Un,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center",children:a.jsx(Ft,{className:"w-4 h-4 text-violet-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),b.preferredDate&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(_t,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Preferred: ",H(b.preferredDate)]})]}),b.preferredDays&&b.preferredDays.length>0&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(_t,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Days: ",v9(b.preferredDays)]})]}),b.preferredTimeRange&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Wt,{className:"w-4 h-4 text-slate-500"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Time: ",y9(b.preferredTimeRange)]})]}),b.createdAt&&a.jsxs("div",{className:"pt-2 border-t border-slate-100 text-xs text-slate-400",children:["Joined ",w9(b.createdAt)]})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(Ze,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(_t,{className:"w-4 h-4"}),b.status==="notified"?"Book Now":"Check Available Slots"]})})]})}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(Ze,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})})]})}function j9(){return a.jsxs(Ze,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(sa,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function F1(n){if(n==null)return"";if(n<1)return"Next up!";if(n<60)return`~${n} min`;const e=Math.floor(n/60),t=n%60;return t>0?`~${e}h ${t}m`:`~${e}h`}function _9(){const{slug:n}=rc(),[e,t]=j.useState(null),[i,o]=j.useState(null),[c,d]=j.useState(!0),[m,x]=j.useState(!1),[g,b]=j.useState([]),[v,_]=j.useState([]),[R,B]=j.useState([]),[L,O]=j.useState(!1),[z,G]=j.useState(!1),[H,ae]=j.useState(!1),[ue,Y]=j.useState(""),[T,E]=j.useState(0),[S,k]=j.useState({clientName:"",serviceId:""}),[C,P]=j.useState(Date.now());j.useEffect(()=>{const ye=setInterval(()=>P(Date.now()),3e4);return()=>clearInterval(ye)},[]),j.useEffect(()=>{(async()=>{d(!0);try{const F=pn(Ye(fe,"shops"),cn("slug","==",n)),J=await ys(F);if(J.empty)x(!0);else{const de=J.docs[0];t(de.data()),o(de.id)}}catch(F){console.error("Error looking up shop:",F),x(!0)}finally{d(!1)}})()},[n]),j.useEffect(()=>{if(!i)return;const ye=ns(Ye(fe,"shops",i,"walkins"),de=>{const xe=de.docs.map(le=>({id:le.id,...le.data()}));b(xe)}),F=ns(Ye(fe,"shops",i,"staff"),de=>{const xe=de.docs.map(le=>({id:le.id,...le.data()})).filter(le=>le.active!==!1);_(xe)}),J=ns(Ye(fe,"shops",i,"services"),de=>{const xe=de.docs.map(le=>({id:le.id,...le.data()})).filter(le=>le.active!==!1).sort((le,Ce)=>(le.name||"").localeCompare(Ce.name||""));B(xe)});return()=>{ye(),F(),J()}},[i]);const I=j.useMemo(()=>g.filter(ye=>ye.status==="waiting").sort((ye,F)=>(ye.position||0)-(F.position||0)),[g]),$=j.useMemo(()=>g.filter(ye=>ye.status==="in-progress"),[g]),U=j.useMemo(()=>Math.max(v.length,1),[v]),V=j.useMemo(()=>CS({waitingQueue:I,inProgress:$,staffCount:U,defaultDuration:30}),[I,$,U]),K=j.useMemo(()=>kS({waitingAhead:I,inProgress:$,staffCount:U,defaultDuration:30}),[I,$,U]),oe=j.useMemo(()=>{const ye=new Date;return ye.setHours(0,0,0,0),g.filter(F=>{const J=F.joinedAt?.toDate?.()||(F.joinedAt?new Date(F.joinedAt):null);return J&&J>=ye}).length},[g]),Ee=async ye=>{ye.preventDefault(),G(!0);const F=R.find(le=>le.id===S.serviceId),de=(I.length>0?Math.max(...I.map(le=>le.position||0)):0)+1,xe=S.clientName.trim()||`Walk-in #${oe+1}`;try{await Ua(Ye(fe,"shops",i,"walkins"),{clientName:xe,serviceId:S.serviceId||null,serviceName:F?.name||null,staffId:null,staffName:null,estimatedDuration:F?.duration||30,status:"waiting",position:de,joinedAt:zt.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),Y(xe),E(de),ae(!0),O(!1),k({clientName:"",serviceId:""})}catch(le){console.error("Error joining queue:",le)}finally{G(!1)}};return c?a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):m?a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(_t,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(Ze,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Ma,{className:"w-4 h-4"}),"Go Home"]})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Live Queue"})]})]}),a.jsx(j9,{})]})}),a.jsxs("div",{className:"max-w-2xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[H&&a.jsxs("div",{className:"mb-6 bg-emerald-50 border border-emerald-200 rounded-2xl p-6 text-center animate-scale-in",children:[a.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(Ft,{className:"w-7 h-7 text-emerald-600"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"You're in the queue!"}),a.jsxs("p",{className:"text-slate-600 text-sm mb-2",children:[a.jsx("strong",{children:ue}),"  Position #",T]}),a.jsx("button",{onClick:()=>ae(!1),className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"Dismiss"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Ft,{className:"w-6 h-6 text-blue-600"})}),a.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:I.length}),a.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"People Waiting"})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(dS,{className:"w-6 h-6 text-amber-600"})}),a.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:F1(K)}),a.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"Est. Wait (New)"})]})]}),$.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(Scissors,{className:"w-5 h-5 text-emerald-500"}),"Currently Being Served"]}),a.jsx("div",{className:"space-y-2",children:$.map(ye=>a.jsxs("div",{className:"bg-white rounded-xl border border-emerald-200 p-4 flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:a.jsx(Scissors,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-slate-900",children:ye.clientName}),a.jsx("div",{className:"text-xs text-slate-500",children:ye.serviceName||"Service in progress"})]})]},ye.id))})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(Wt,{className:"w-5 h-5 text-blue-500"}),"Queue"]}),I.length===0?a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-10 text-center",children:[a.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Ft,{className:"w-7 h-7 text-emerald-500"})}),a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"No Wait!"}),a.jsx("p",{className:"text-sm text-slate-500",children:"The queue is empty  you can walk right in!"})]}):a.jsx("div",{className:"space-y-2",children:I.map((ye,F)=>{const J=V.get(ye.id);return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4 flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center font-extrabold text-blue-700 text-lg flex-shrink-0",children:F+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-semibold text-slate-900 text-lg truncate",children:ye.clientName}),ye.serviceName&&a.jsxs("div",{className:"text-sm text-slate-500 flex items-center gap-1",children:[a.jsx(Un,{className:"w-3 h-3"}),ye.serviceName]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsx("div",{className:"text-lg font-bold text-amber-600",children:F1(J)}),a.jsx("div",{className:"text-xs text-slate-400",children:"est. wait"})]})]},ye.id)})})]}),!H&&a.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:L?a.jsxs("form",{onSubmit:Ee,children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Join the Queue"}),a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Your Name"}),a.jsx("input",{type:"text",value:S.clientName,onChange:ye=>k(F=>({...F,clientName:ye.target.value})),placeholder:"Optional",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg"})]}),R.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Service"}),a.jsxs("select",{value:S.serviceId,onChange:ye=>k(F=>({...F,serviceId:ye.target.value})),className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg",children:[a.jsx("option",{value:"",children:"Select a service"}),R.map(ye=>a.jsxs("option",{value:ye.id,children:[ye.name," (",ye.duration,"min  $",Number(ye.price).toFixed(2),")"]},ye.id))]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{type:"submit",disabled:z,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[a.jsx(dr,{className:"w-5 h-5"}),z?"Joining":"Join Queue"]}),a.jsx("button",{type:"button",onClick:()=>{O(!1),k({clientName:"",serviceId:""})},className:"px-6 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]}):a.jsxs("button",{onClick:()=>O(!0),className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[a.jsx(dr,{className:"w-5 h-5"}),"Join the Queue"]})})]}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-between",children:[a.jsxs(Ze,{to:`/shop/${n}`,className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[a.jsx(_t,{className:"w-4 h-4"}),"Book Online"]}),a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(Ze,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})]})})]})}const S9="type.googleapis.com/google.protobuf.Int64Value",E9="type.googleapis.com/google.protobuf.UInt64Value";function RS(n,e){const t={};for(const i in n)n.hasOwnProperty(i)&&(t[i]=e(n[i]));return t}function Bf(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>Bf(e));if(typeof n=="function"||typeof n=="object")return RS(n,e=>Bf(e));throw new Error("Data cannot be encoded in JSON: "+n)}function sc(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case S9:case E9:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>sc(e)):typeof n=="function"||typeof n=="object"?RS(n,e=>sc(e)):n}const $g="functions";const $1={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Vn extends za{constructor(e,t,i){super(`${$g}/${e}`,t||""),this.details=i,Object.setPrototypeOf(this,Vn.prototype)}}function T9(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function zf(n,e){let t=T9(n),i=t,o;try{const c=e&&e.error;if(c){const d=c.status;if(typeof d=="string"){if(!$1[d])return new Vn("internal","internal");t=$1[d],i=d}const m=c.message;typeof m=="string"&&(i=m),o=c.details,o!==void 0&&(o=sc(o))}}catch{}return t==="ok"?null:new Vn(t,i,o)}class A9{constructor(e,t,i,o){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,jn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=i.getImmediate({optional:!0}),this.auth||t.get().then(c=>this.auth=c,()=>{}),this.messaging||i.get().then(c=>this.messaging=c,()=>{}),this.appCheck||o?.get().then(c=>this.appCheck=c,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),i=await this.getMessagingToken(),o=await this.getAppCheckToken(e);return{authToken:t,messagingToken:i,appCheckToken:o}}}const Tx="us-central1",k9=/^data: (.*?)(?:\n|$)/;function C9(n){let e=null;return{promise:new Promise((t,i)=>{e=setTimeout(()=>{i(new Vn("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class R9{constructor(e,t,i,o,c=Tx,d=(...m)=>fetch(...m)){this.app=e,this.fetchImpl=d,this.emulatorOrigin=null,this.contextProvider=new A9(e,t,i,o),this.cancelAllRequests=new Promise(m=>{this.deleteService=()=>Promise.resolve(m())});try{const m=new URL(c);this.customDomain=m.origin+(m.pathname==="/"?"":m.pathname),this.region=Tx}catch{this.customDomain=null,this.region=c}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function I9(n,e,t){const i=fr(e);n.emulatorOrigin=`http${i?"s":""}://${e}:${t}`,i&&(Hf(n.emulatorOrigin+"/backends"),Gf("Functions",!0))}function D9(n,e,t){const i=o=>O9(n,e,o,{});return i.stream=(o,c)=>V9(n,e,o,c),i}function IS(n){return n.emulatorOrigin&&fr(n.emulatorOrigin)?"include":void 0}async function M9(n,e,t,i,o){t["Content-Type"]="application/json";let c;try{c=await i(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:IS(o)})}catch{return{status:0,json:null}}let d=null;try{d=await c.json()}catch{}return{status:c.status,json:d}}async function DS(n,e){const t={},i=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return i.authToken&&(t.Authorization="Bearer "+i.authToken),i.messagingToken&&(t["Firebase-Instance-ID-Token"]=i.messagingToken),i.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=i.appCheckToken),t}function O9(n,e,t,i){const o=n._url(e);return P9(n,o,t,i)}async function P9(n,e,t,i){t=Bf(t);const o={data:t},c=await DS(n,i),d=i.timeout||7e4,m=C9(d),x=await Promise.race([M9(e,o,c,n.fetchImpl,n),m.promise,n.cancelAllRequests]);if(m.cancel(),!x)throw new Vn("cancelled","Firebase Functions instance was deleted.");const g=zf(x.status,x.json);if(g)throw g;if(!x.json)throw new Vn("internal","Response is not valid JSON object.");let b=x.json.data;if(typeof b>"u"&&(b=x.json.result),typeof b>"u")throw new Vn("internal","Response is missing data field.");return{data:sc(b)}}function V9(n,e,t,i){const o=n._url(e);return L9(n,o,t,i||{})}async function L9(n,e,t,i){t=Bf(t);const o={data:t},c=await DS(n,i);c["Content-Type"]="application/json",c.Accept="text/event-stream";let d;try{d=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(o),headers:c,signal:i?.signal,credentials:IS(n)})}catch(_){if(_ instanceof Error&&_.name==="AbortError"){const B=new Vn("cancelled","Request was cancelled.");return{data:Promise.reject(B),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(B)}}}}}}const R=zf(0,null);return{data:Promise.reject(R),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(R)}}}}}}let m,x;const g=new Promise((_,R)=>{m=_,x=R});i?.signal?.addEventListener("abort",()=>{const _=new Vn("cancelled","Request was cancelled.");x(_)});const b=d.body.getReader(),v=U9(b,m,x,i?.signal);return{stream:{[Symbol.asyncIterator](){const _=v.getReader();return{async next(){const{value:R,done:B}=await _.read();return{value:R,done:B}},async return(){return await _.cancel(),{done:!0,value:void 0}}}}},data:g}}function U9(n,e,t,i){const o=(d,m)=>{const x=d.match(k9);if(!x)return;const g=x[1];try{const b=JSON.parse(g);if("result"in b){e(sc(b.result));return}if("message"in b){m.enqueue(sc(b.message));return}if("error"in b){const v=zf(0,b);m.error(v),t(v);return}}catch(b){if(b instanceof Vn){m.error(b),t(b);return}}},c=new TextDecoder;return new ReadableStream({start(d){let m="";return x();async function x(){if(i?.aborted){const g=new Vn("cancelled","Request was cancelled");return d.error(g),t(g),Promise.resolve()}try{const{value:g,done:b}=await n.read();if(b){m.trim()&&o(m.trim(),d),d.close();return}if(i?.aborted){const _=new Vn("cancelled","Request was cancelled");d.error(_),t(_),await n.cancel();return}m+=c.decode(g,{stream:!0});const v=m.split(`
`);m=v.pop()||"";for(const _ of v)_.trim()&&o(_.trim(),d);return x()}catch(g){const b=g instanceof Vn?g:zf(0,null);d.error(b),t(b)}}},cancel(){return n.cancel()}})}const q1="@firebase/functions",H1="0.13.1";const B9="auth-internal",z9="app-check-internal",F9="messaging-internal";function $9(n){const e=(t,{instanceIdentifier:i})=>{const o=t.getProvider("app").getImmediate(),c=t.getProvider(B9),d=t.getProvider(F9),m=t.getProvider(z9);return new R9(o,c,d,m,i)};Ui(new $r($g,e,"PUBLIC").setMultipleInstances(!0)),wa(q1,H1,n),wa(q1,H1,"esm2020")}function q9(n=Yf(),e=Tx){const i=nd(Zt(n),$g).getImmediate({identifier:e}),o=Vx("functions");return o&&H9(i,...o),i}function H9(n,e,t){I9(Zt(n),e,t)}function G9(n,e,t){return D9(Zt(n),e)}$9();const Y9=q9(),W9=["aaron.sharp2011@gmail.com"],xu={free:0,pro:29,unlimited:79},_l={free:{label:"Free",color:"bg-slate-100 text-slate-700 border-slate-200"},pro:{label:"Pro",color:"bg-blue-100 text-blue-700 border-blue-200"},unlimited:{label:"Unlimited",color:"bg-violet-100 text-violet-700 border-violet-200"}};function K9({user:n}){const e=hr(),[t,i]=cj(),[o,c]=j.useState(!0),[d,m]=j.useState([]),[x,g]=j.useState([]),b=["overview","shops","users","revenue","support"],v=t.get("tab"),_=b.includes(v)?v:"overview",R=ee=>{i({tab:ee})},[B,L]=j.useState(""),[O,z]=j.useState(null),[G,H]=j.useState(null),[ae,ue]=j.useState(null),[Y,T]=j.useState(""),[E,S]=j.useState({}),[k,C]=j.useState(!1),[P,I]=j.useState(null),[$,U]=j.useState(!0),[V,K]=j.useState(!1),[oe,Ee]=j.useState(""),[ye,F]=j.useState(""),[J,de]=j.useState(""),[xe,le]=j.useState(""),[Ce,$e]=j.useState(!1),[Ct,ot]=j.useState(!1),qt=n&&W9.includes(n.email?.toLowerCase());j.useEffect(()=>{!n||!qt||Z()},[n,qt]);const Z=async()=>{c(!0);try{const ke=(await ys(Ye(fe,"shops"))).docs.map(Bt=>({id:Bt.id,...Bt.data()}));m(ke);const it=(await ys(Ye(fe,"users"))).docs.map(Bt=>({id:Bt.id,...Bt.data()}));g(it)}catch(ee){console.error("Error fetching admin data:",ee)}finally{c(!1)}},je=async()=>{await $u(xn),e("/",{replace:!0})},Se=j.useMemo(()=>{const ee={free:0,pro:0,unlimited:0};let ke=0,nt=0;d.forEach(yt=>{const gs=yt.subscriptionTier||"free";ee[gs]=(ee[gs]||0)+1,yt.stripeConnectAccountId&&(yt.stripeConnectComplete?ke++:nt++)});const it=ee.pro*xu.pro+ee.unlimited*xu.unlimited,Bt=new Date;Bt.setDate(Bt.getDate()-30);const is=d.filter(yt=>yt.createdAt?(yt.createdAt.toDate?yt.createdAt.toDate():new Date(yt.createdAt))>Bt:!1);return{totalShops:d.length,tierCounts:ee,mrr:it,stripeConnectedCount:ke,stripePendingCount:nt,recentShops:is.length}},[d]),qe=j.useMemo(()=>{if(!B.trim())return d;const ee=B.toLowerCase();return d.filter(ke=>ke.name?.toLowerCase().includes(ee)||ke.slug?.toLowerCase().includes(ee)||ke.ownerEmail?.toLowerCase().includes(ee))},[d,B]),tt=j.useMemo(()=>[...qe].sort((ee,ke)=>{const nt=ee.createdAt?.toDate?ee.createdAt.toDate():new Date(ee.createdAt||0);return(ke.createdAt?.toDate?ke.createdAt.toDate():new Date(ke.createdAt||0))-nt}),[qe]),gt=async(ee,ke)=>{H(ee);try{await Ke(Me(fe,"shops",ee),{subscriptionTier:ke}),m(nt=>nt.map(it=>it.id===ee?{...it,subscriptionTier:ke}:it))}catch(nt){console.error("Error changing tier:",nt)}finally{H(null)}},Ks=async(ee,ke)=>{H(ee);try{await Ke(Me(fe,"shops",ee),{disabled:!ke}),m(nt=>nt.map(it=>it.id===ee?{...it,disabled:!ke}:it))}catch(nt){console.error("Error toggling shop status:",nt)}finally{H(null)}},Ot=async(ee,ke)=>{H(ee);try{await Ke(Me(fe,"shops",ee),{archived:!ke,archivedAt:ke?null:On()}),m(nt=>nt.map(it=>it.id===ee?{...it,archived:!ke,archivedAt:ke?null:new Date().toISOString()}:it)),O?.id===ee&&z(nt=>({...nt,archived:!ke}))}catch(nt){console.error("Error toggling shop archive status:",nt)}finally{H(null)}},bt=async ee=>{try{const ke=await ys(Ye(fe,"shops",ee,"bookings")),nt=new Date().toISOString().split("T")[0],it=ke.docs.filter(Bt=>{const is=Bt.data();return is.date>=nt&&(is.status==="pending"||is.status==="confirmed"||!is.status)});return S(Bt=>({...Bt,[ee]:it.length})),it.length}catch(ke){return console.error("Error checking bookings:",ke),0}},Re=async ee=>{H(ee);try{const ke=["staff","bookings","availability","waitlist","schedulePresets","services","walkins","clientNotes"];for(const nt of ke){const it=await ys(Ye(fe,"shops",ee,nt));for(const Bt of it.docs)await zo(Me(fe,"shops",ee,nt,Bt.id))}await zo(Me(fe,"shops",ee)),m(nt=>nt.filter(it=>it.id!==ee)),z(null),ue(null),T(""),C(!1)}catch(ke){console.error("Error deleting shop:",ke),alert("An error occurred while deleting the shop. Please try again.")}finally{H(null)}},Be=async ee=>{K(!0);try{const nt=await G9(Y9,"adminDeleteUser")({userId:ee,deleteShops:$});if(nt.data.success){if(g(it=>it.filter(Bt=>Bt.id!==ee)),$&&nt.data.shopsDeleted>0){const it=await ys(Ye(fe,"shops"));m(it.docs.map(Bt=>({id:Bt.id,...Bt.data()})))}I(null),U(!0),alert(`User deleted successfully. ${nt.data.shopsDeleted} shop(s) deleted.`)}}catch(ke){console.error("Error deleting user:",ke),alert(ke.message||"Failed to delete user")}finally{K(!1)}},pe=ee=>d.filter(ke=>ke.ownerId===ee),We=j.useMemo(()=>{if(!oe)return x;const ee=oe.toLowerCase();return x.filter(ke=>ke.email?.toLowerCase().includes(ee)||ke.displayName?.toLowerCase().includes(ee)||ke.id.toLowerCase().includes(ee))},[x,oe]),Le=ee=>ee?(ee.toDate?ee.toDate():new Date(ee)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",De=ee=>ee.stripeConnectAccountId?ee.stripeConnectComplete?{label:"Connected",color:"bg-emerald-100 text-emerald-700",icon:Ms}:{label:"Pending",color:"bg-amber-100 text-amber-700",icon:Wt}:{label:"None",color:"bg-slate-100 text-slate-500",icon:null},Ge=async ee=>{ee.preventDefault(),le(""),$e(!0);try{await Gx(xn,ye,J)}catch(ke){console.error("Login error:",ke),ke.code==="auth/user-not-found"||ke.code==="auth/wrong-password"||ke.code==="auth/invalid-credential"?le("Invalid email or password"):ke.code==="auth/invalid-email"?le("Invalid email address"):le(ke.message)}finally{$e(!1)}};if(!n)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-violet-600 to-purple-600 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-violet-600/30 mx-auto mb-4",children:a.jsx(qo,{className:"w-8 h-8"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Admin Access"}),a.jsx("p",{className:"text-slate-500 text-sm",children:"Sign in with your admin credentials"})]}),a.jsxs("form",{onSubmit:Ge,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:ye,onChange:ee=>F(ee.target.value),placeholder:"admin@example.com",required:!0,className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:J,onChange:ee=>de(ee.target.value),placeholder:"",required:!0,className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),xe&&a.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-600",children:xe}),a.jsx("button",{type:"submit",disabled:Ce,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-violet-600 hover:bg-violet-700 disabled:bg-violet-400 text-white rounded-xl font-semibold transition-all shadow-lg shadow-violet-600/20",children:Ce?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Sign In"})]})]})});if(!qt)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-6",children:a.jsx(h1,{className:"w-8 h-8 text-red-600"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Access Denied"}),a.jsx("p",{className:"text-slate-500 mb-2",children:"You don't have permission to access the admin panel."}),a.jsxs("p",{className:"text-sm text-slate-400 mb-6",children:["Signed in as: ",n.email]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>$u(xn),className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all",children:"Sign Out"}),a.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-5 py-3 bg-violet-600 hover:bg-violet-700 text-white rounded-xl font-semibold text-sm transition-all",children:"Go Home"})]})]})});if(o)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading admin panel"})]})});if(!qt)return null;const He=[{key:"overview",label:"Overview",icon:nS},{key:"shops",label:"Shops",icon:Mr},{key:"users",label:"Users",icon:Ft},{key:"revenue",label:"Revenue",icon:Fo},{key:"support",label:"Support",icon:uf}];return a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"h-14 sm:h-16 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[a.jsx("button",{onClick:()=>ot(!0),className:"lg:hidden p-2 -ml-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:a.jsx(rS,{className:"w-6 h-6"})}),a.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-violet-600 to-purple-600 rounded-lg sm:rounded-xl flex items-center justify-center text-white shadow-md shadow-violet-600/20 flex-shrink-0",children:a.jsx(qo,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h1",{className:"text-sm sm:text-base font-bold text-slate-900 leading-tight truncate",children:"Admin"}),a.jsx("p",{className:"text-xs text-slate-500 hidden sm:block",children:"Platform Management"})]})]}),a.jsx("div",{className:"hidden lg:flex items-center bg-slate-100 p-1 rounded-xl",children:He.map(ee=>{const ke=ee.icon;return a.jsxs("button",{onClick:()=>R(ee.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${_===ee.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(ke,{className:"w-4 h-4"}),a.jsx("span",{children:ee.label})]},ee.key)})}),a.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 flex-shrink-0",children:[a.jsxs("button",{onClick:Z,className:"flex items-center justify-center gap-1.5 p-2 sm:px-3.5 sm:py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all",title:"Refresh",children:[a.jsx(Zo,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),a.jsxs("button",{onClick:je,className:"flex items-center justify-center gap-1.5 p-2 sm:px-3.5 sm:py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",title:"Logout",children:[a.jsx(Zu,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),Ct&&a.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>ot(!1)}),a.jsxs("div",{className:"fixed inset-y-0 left-0 w-72 bg-white shadow-2xl animate-slide-in-left",children:[a.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-slate-200",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-violet-600 to-purple-600 rounded-xl flex items-center justify-center text-white shadow-md",children:a.jsx(qo,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-bold text-slate-900",children:"Admin Panel"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Platform Management"})]})]}),a.jsx("button",{onClick:()=>ot(!1),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",children:a.jsx(Os,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"p-3 space-y-1",children:He.map(ee=>{const ke=ee.icon;return a.jsxs("button",{onClick:()=>{R(ee.key),ot(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left font-medium transition-all ${_===ee.key?"bg-violet-50 text-violet-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,children:[a.jsx(ke,{className:`w-5 h-5 ${_===ee.key?"text-violet-600":"text-slate-400"}`}),a.jsx("span",{children:ee.label})]},ee.key)})}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 border-t border-slate-200 bg-slate-50",children:[a.jsxs("button",{onClick:()=>{ot(!1),Z()},className:"w-full flex items-center gap-3 px-4 py-3 text-slate-600 hover:bg-white rounded-xl font-medium transition-all",children:[a.jsx(Zo,{className:"w-5 h-5 text-slate-400"}),"Refresh Data"]}),a.jsxs("button",{onClick:()=>{ot(!1),je()},className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl font-medium transition-all",children:[a.jsx(Zu,{className:"w-5 h-5"}),"Logout"]})]})]})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[_==="overview"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(Mr,{className:"w-5 h-5 text-blue-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Se.totalShops}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Shops"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:a.jsx(Fo,{className:"w-5 h-5 text-emerald-600"})})}),a.jsxs("div",{className:"text-2xl font-extrabold text-slate-900",children:["$",Se.mrr]}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Monthly Recurring Revenue"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-violet-100 rounded-xl flex items-center justify-center",children:a.jsx(Pn,{className:"w-5 h-5 text-violet-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Se.stripeConnectedCount}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Stripe Connected"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center",children:a.jsx(ec,{className:"w-5 h-5 text-amber-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Se.recentShops}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"New (Last 30 Days)"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Jo,{className:"w-5 h-5 text-amber-500"}),"Subscription Tiers"]}),a.jsx("div",{className:"space-y-4",children:Object.entries(Se.tierCounts).map(([ee,ke])=>{const nt=_l[ee]||_l.free,it=Se.totalShops>0?Math.round(ke/Se.totalShops*100):0;return a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-24",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-bold border ${nt.color}`,children:nt.label})}),a.jsx("div",{className:"flex-1",children:a.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full transition-all ${ee==="free"?"bg-slate-400":ee==="pro"?"bg-blue-500":"bg-violet-500"}`,style:{width:`${it}%`}})})}),a.jsxs("div",{className:"w-20 text-right",children:[a.jsx("span",{className:"text-sm font-bold text-slate-900",children:ke}),a.jsxs("span",{className:"text-xs text-slate-500 ml-1",children:["(",it,"%)"]})]})]},ee)})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Pn,{className:"w-5 h-5 text-violet-500"}),"Payment Status"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ms,{className:"w-5 h-5 text-emerald-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Stripe Connected"})]}),a.jsx("span",{className:"text-lg font-bold text-emerald-700",children:Se.stripeConnectedCount})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Wt,{className:"w-5 h-5 text-amber-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Pending Setup"})]}),a.jsx("span",{className:"text-lg font-bold text-amber-700",children:Se.stripePendingCount})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Mr,{className:"w-5 h-5 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"No Payments"})]}),a.jsx("span",{className:"text-lg font-bold text-slate-700",children:Se.totalShops-Se.stripeConnectedCount-Se.stripePendingCount})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(ec,{className:"w-5 h-5 text-blue-500"}),"Recent Signups"]}),a.jsx("div",{className:"space-y-3",children:tt.slice(0,5).map(ee=>{const ke=_l[ee.subscriptionTier]||_l.free;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-xl border border-slate-200 hover:border-slate-300 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(Mr,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:ee.name||"Unnamed Shop"}),a.jsx("div",{className:"text-xs text-slate-500",children:ee.ownerEmail})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-bold border ${ke.color}`,children:ke.label}),a.jsx("span",{className:"text-xs text-slate-500",children:Le(ee.createdAt)})]})]},ee.id)})})]})]}),_==="shops"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-4 mb-6",children:a.jsxs("div",{className:"relative",children:[a.jsx(of,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by name, slug, or email...",value:B,onChange:ee=>L(ee.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Shops"}),a.jsxs("span",{className:"text-sm font-medium text-slate-500",children:[qe.length," shop",qe.length!==1?"s":""]})]}),a.jsxs("div",{className:"divide-y divide-slate-100",children:[tt.map(ee=>{const ke=_l[ee.subscriptionTier]||_l.free,nt=De(ee),it=nt.icon;return a.jsx("div",{className:`p-4 hover:bg-slate-50 transition-all ${ee.disabled?"opacity-60":""}`,children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:(ee.name||"S")[0].toUpperCase()}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:ee.name||"Unnamed Shop"}),a.jsx("span",{className:`px-2 py-0.5 rounded-lg text-[10px] font-bold border ${ke.color}`,children:ke.label}),ee.archived&&a.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold bg-amber-100 text-amber-700 border border-amber-200",children:"Archived"}),ee.disabled&&a.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold bg-red-100 text-red-700 border border-red-200",children:"Disabled"})]}),a.jsxs("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:["/",ee.slug,"  ",ee.ownerEmail]}),a.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs",children:[a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-md ${nt.color}`,children:[it&&a.jsx(it,{className:"w-3 h-3"}),"Stripe: ",nt.label]}),a.jsxs("span",{className:"text-slate-400",children:["Created: ",Le(ee.createdAt)]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(Ze,{to:`/shop/${ee.slug}`,target:"_blank",className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"View public page",children:a.jsx(Vu,{className:"w-4 h-4"})}),a.jsx(Ze,{to:`/shop/${ee.slug}/dashboard`,target:"_blank",className:"p-2 text-slate-400 hover:text-violet-600 hover:bg-violet-50 rounded-lg transition-all",title:"View dashboard (impersonate)",children:a.jsx(cr,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>z(ee),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",title:"Manage shop",children:a.jsx(uf,{className:"w-4 h-4"})})]})]})},ee.id)}),tt.length===0&&a.jsxs("div",{className:"p-12 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Mr,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"No shops found"}),B&&a.jsx("button",{onClick:()=>L(""),className:"mt-2 text-sm text-violet-600 hover:underline",children:"Clear search"})]})]})]})]}),_==="revenue"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Fo,{className:"w-5 h-5 text-emerald-500"}),"MRR Breakdown"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-900",children:"Pro Plans"}),a.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[Se.tierCounts.pro," shops  $29/mo"]})]}),a.jsxs("span",{className:"text-lg font-bold text-blue-700",children:["$",Se.tierCounts.pro*xu.pro]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-violet-50 border border-violet-200 rounded-xl",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-900",children:"Unlimited Plans"}),a.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[Se.tierCounts.unlimited," shops  $79/mo"]})]}),a.jsxs("span",{className:"text-lg font-bold text-violet-700",children:["$",Se.tierCounts.unlimited*xu.unlimited]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsx("div",{children:a.jsx("span",{className:"font-bold text-slate-900",children:"Total MRR"})}),a.jsxs("span",{className:"text-2xl font-extrabold text-emerald-700",children:["$",Se.mrr]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Pn,{className:"w-5 h-5 text-violet-500"}),"Platform Fees"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(OM,{className:"w-4 h-4 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Free Tier"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"5% platform fee on deposit payments via Stripe Connect"})]}),a.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(fc,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Pro & Unlimited"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"No platform fees  shops keep 100% of payments"})]})]}),a.jsx("div",{className:"mt-6 pt-4 border-t border-slate-200",children:a.jsxs("a",{href:"https://dashboard.stripe.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-violet-600 hover:bg-violet-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-violet-600/20 transition-all",children:[a.jsx(cr,{className:"w-4 h-4"}),"Open Stripe Dashboard"]})})]})]}),a.jsxs("div",{className:"mt-6 bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Mr,{className:"w-5 h-5 text-blue-500"}),"Stripe Connect Accounts"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-emerald-700",children:Se.stripeConnectedCount}),a.jsx("div",{className:"text-sm font-medium text-emerald-600 mt-1",children:"Fully Connected"})]}),a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-amber-700",children:Se.stripePendingCount}),a.jsx("div",{className:"text-sm font-medium text-amber-600 mt-1",children:"Pending Setup"})]}),a.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-slate-700",children:Se.totalShops-Se.stripeConnectedCount-Se.stripePendingCount}),a.jsx("div",{className:"text-sm font-medium text-slate-600 mt-1",children:"Not Started"})]})]})]})]}),_==="users"&&a.jsx("div",{className:"animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("div",{className:"flex items-center justify-between mb-6",children:a.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[a.jsx(Ft,{className:"w-5 h-5 text-violet-500"}),"All Users (",x.length,")"]})}),a.jsxs("div",{className:"relative mb-6",children:[a.jsx(of,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by email, name, or ID...",value:oe,onChange:ee=>Ee(ee.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),a.jsx("div",{className:"space-y-3",children:We.length===0?a.jsx("p",{className:"text-center text-slate-500 py-8",children:"No users found"}):We.map(ee=>{const ke=pe(ee.id);return a.jsx("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl hover:border-slate-300 transition-all",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-violet-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:(ee.email?.[0]||"?").toUpperCase()}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-semibold text-slate-900 truncate",children:ee.email||"No email"}),a.jsx("div",{className:"text-xs text-slate-500 font-mono truncate",children:ee.id}),ke.length>0&&a.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[a.jsx(Mr,{className:"w-3 h-3 text-blue-500"}),a.jsxs("span",{className:"text-xs text-blue-600",children:[ke.length," shop",ke.length>1?"s":""]})]})]})]}),a.jsxs("button",{onClick:()=>I(ee),className:"px-3 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all flex items-center gap-1.5",children:[a.jsx(Oa,{className:"w-3.5 h-3.5"}),"Delete"]})]})},ee.id)})})]})}),_==="support"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(uf,{className:"w-5 h-5 text-violet-500"}),"Support Tools"]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Manage shops, impersonate dashboards, and take quick actions."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Vu,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"View Dashboard"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Click the external link icon on any shop to view their dashboard. You must be logged in as an admin."})]}),a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Jo,{className:"w-4 h-4 text-amber-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Change Tier"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Click the settings icon on any shop to change their subscription tier or disable the account."})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Quick Shop Lookup"}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(of,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by name, slug, or email...",value:B,onChange:ee=>L(ee.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),B&&a.jsx("div",{className:"space-y-2",children:qe.slice(0,10).map(ee=>a.jsxs("button",{onClick:()=>z(ee),className:"w-full flex items-center justify-between p-3 bg-slate-50 hover:bg-slate-100 rounded-xl border border-slate-200 transition-all text-left",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Mr,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:ee.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:["/",ee.slug]})]})]}),a.jsx(sS,{className:"w-4 h-4 text-slate-400"})]},ee.id))})]})]})]}),O&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl flex items-center justify-center text-white font-bold",children:(O.name||"S")[0].toUpperCase()}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:O.name}),a.jsxs("p",{className:"text-sm text-slate-500",children:["/",O.slug]})]})]}),a.jsx("button",{onClick:()=>z(null),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",children:a.jsx(Os,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Lf,{className:"w-4 h-4 text-slate-400"}),a.jsx("span",{className:"text-slate-600",children:O.ownerEmail})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(_t,{className:"w-4 h-4 text-slate-400"}),a.jsxs("span",{className:"text-slate-600",children:["Created: ",Le(O.createdAt)]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Pn,{className:"w-4 h-4 text-slate-400"}),a.jsxs("span",{className:"text-slate-600",children:["Stripe: ",De(O).label,O.stripeConnectAccountId&&a.jsxs("span",{className:"ml-1 text-xs text-slate-400 font-mono",children:["(",O.stripeConnectAccountId,")"]})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2",children:"Subscription Tier"}),a.jsx("div",{className:"flex gap-2",children:["free","pro","unlimited"].map(ee=>{const ke=_l[ee],nt=(O.subscriptionTier||"free")===ee;return a.jsxs("button",{onClick:()=>gt(O.id,ee),disabled:G===O.id,className:`flex-1 px-4 py-3 rounded-xl font-semibold text-sm transition-all border-2 ${nt?ee==="free"?"border-slate-400 bg-slate-100 text-slate-900":ee==="pro"?"border-blue-500 bg-blue-50 text-blue-700":"border-violet-500 bg-violet-50 text-violet-700":"border-slate-200 bg-white text-slate-500 hover:border-slate-300"}`,children:[ke.label,ee!=="free"&&a.jsxs("span",{className:"block text-xs font-normal mt-0.5",children:["$",xu[ee],"/mo"]})]},ee)})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Quick Actions"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs(Ze,{to:`/shop/${O.slug}`,target:"_blank",className:"flex items-center justify-center gap-2 px-4 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-medium text-sm transition-all",children:[a.jsx(Vu,{className:"w-4 h-4"}),"View Page"]}),a.jsxs(Ze,{to:`/shop/${O.slug}/dashboard`,target:"_blank",className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-xl font-medium text-sm transition-all",children:[a.jsx(cr,{className:"w-4 h-4"}),"Dashboard"]})]}),a.jsx("button",{onClick:()=>Ks(O.id,O.disabled),disabled:G===O.id,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all ${O.disabled?"bg-emerald-100 hover:bg-emerald-200 text-emerald-700":"bg-red-100 hover:bg-red-200 text-red-700"}`,children:O.disabled?a.jsxs(a.Fragment,{children:[a.jsx(Ms,{className:"w-4 h-4"}),"Enable Shop"]}):a.jsxs(a.Fragment,{children:[a.jsx(h1,{className:"w-4 h-4"}),"Disable Shop"]})}),a.jsxs("button",{onClick:()=>Ot(O.id,O.archived),disabled:G===O.id,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all ${O.archived?"bg-emerald-100 hover:bg-emerald-200 text-emerald-700":"bg-amber-100 hover:bg-amber-200 text-amber-700"}`,children:[a.jsx(Pu,{className:"w-4 h-4"}),O.archived?"Unarchive Shop":"Archive Shop"]}),a.jsxs("div",{className:"pt-4 mt-4 border-t border-red-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(va,{className:"w-4 h-4 text-red-500"}),a.jsx("span",{className:"text-xs font-bold text-red-600 uppercase tracking-wider",children:"Danger Zone"})]}),a.jsxs("button",{onClick:async()=>{await bt(O.id),ue(O),T(""),C(!1)},disabled:G===O.id,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-medium text-sm transition-all shadow-md shadow-red-600/20",children:[a.jsx(Oa,{className:"w-4 h-4"}),"Delete Shop Forever"]})]})]})]})}),ae&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(va,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Delete Shop Permanently"}),a.jsxs("p",{className:"text-sm text-slate-500",children:["/",ae.slug]})]})]}),E[ae.id]>0&&a.jsxs("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(va,{className:"w-5 h-5 text-amber-600"}),a.jsxs("span",{className:"font-semibold text-amber-800",children:[E[ae.id]," Upcoming Booking",E[ae.id]!==1?"s":""]})]}),a.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"This shop has active bookings. Deleting it will cancel all bookings and notify no one."}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:k,onChange:ee=>C(ee.target.checked),className:"w-4 h-4 rounded border-amber-400 text-red-600 focus:ring-red-500"}),a.jsx("span",{className:"text-sm font-medium text-amber-800",children:"I understand and want to force delete anyway"})]})]}),a.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-xl",children:[a.jsx("p",{className:"text-sm text-red-700 mb-2",children:a.jsx("strong",{children:"This will permanently delete:"})}),a.jsxs("ul",{className:"text-sm text-red-600 space-y-1 ml-4 list-disc",children:[a.jsx("li",{children:"Shop and all settings"}),a.jsx("li",{children:"All staff members"}),a.jsx("li",{children:"All bookings (past and future)"}),a.jsx("li",{children:"All time slots and schedule presets"}),a.jsx("li",{children:"All waitlist entries"}),a.jsx("li",{children:"All client notes"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:['Type "',a.jsx("span",{className:"text-red-600",children:ae.name}),'" to confirm:']}),a.jsx("input",{type:"text",value:Y,onChange:ee=>T(ee.target.value),placeholder:"Enter shop name",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{ue(null),T(""),C(!1)},className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all",children:"Cancel"}),a.jsx("button",{onClick:()=>Re(ae.id),disabled:Y!==ae.name||G===ae.id||E[ae.id]>0&&!k,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 disabled:bg-slate-300 disabled:cursor-not-allowed text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-red-600/20",children:G===ae.id?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(Oa,{className:"w-4 h-4"}),"Delete Forever"]})})]})]})}),P&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(va,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Delete User Account"}),a.jsx("p",{className:"text-sm text-slate-500",children:P.email})]})]}),pe(P.id).length>0&&a.jsxs("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Mr,{className:"w-5 h-5 text-amber-600"}),a.jsxs("span",{className:"font-semibold text-amber-800",children:[pe(P.id).length," Shop",pe(P.id).length!==1?"s":""," Owned"]})]}),a.jsx("ul",{className:"text-sm text-amber-700 mb-3 space-y-1",children:pe(P.id).map(ee=>a.jsxs("li",{children:[" ",ee.name," (/",ee.slug,")"]},ee.id))}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:ee=>U(ee.target.checked),className:"w-4 h-4 rounded border-amber-400 text-red-600 focus:ring-red-500"}),a.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Also delete all shops owned by this user"})]})]}),a.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-xl",children:[a.jsx("p",{className:"text-sm text-red-700 mb-2",children:a.jsx("strong",{children:"This will permanently delete:"})}),a.jsxs("ul",{className:"text-sm text-red-600 space-y-1 ml-4 list-disc",children:[a.jsx("li",{children:"User's Firebase Auth account"}),a.jsx("li",{children:"User document in database"}),$&&a.jsx("li",{children:"All shops and their data (bookings, staff, etc.)"})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{I(null),U(!0)},disabled:V,className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:"Cancel"}),a.jsx("button",{onClick:()=>Be(P.id),disabled:V,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-red-600/20",children:V?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(Oa,{className:"w-4 h-4"}),"Delete User"]})})]})]})})]})}function Q9({onVerified:n,onCancel:e,initialPhone:t="",shopId:i=null}){const[o,c]=j.useState("phone"),[d,m]=j.useState(t),[x,g]=j.useState("+1"),[b,v]=j.useState(""),[_,R]=j.useState(!1),[B,L]=j.useState(""),[O,z]=j.useState(null),[G,H]=j.useState(0),ae=S=>{const k=S.replace(/\D/g,"");return k.length<=3?k:k.length<=6?`(${k.slice(0,3)}) ${k.slice(3)}`:`(${k.slice(0,3)}) ${k.slice(3,6)}-${k.slice(6,10)}`},ue=()=>{const S=d.replace(/\D/g,"");return`${x}${S}`};j.useEffect(()=>(o==="phone"&&!window.recaptchaVerifier&&(window.recaptchaVerifier=new Jw(xn,"recaptcha-container",{size:"invisible",callback:()=>{},"expired-callback":()=>{L("reCAPTCHA expired. Please try again.")}})),()=>{window.recaptchaVerifier&&(window.recaptchaVerifier.clear(),window.recaptchaVerifier=null)}),[o]),j.useEffect(()=>{if(G>0){const S=setTimeout(()=>H(G-1),1e3);return()=>clearTimeout(S)}},[G]);const Y=async()=>{const S=ue();if(d.replace(/\D/g,"").length<10){L("Please enter a valid 10-digit phone number");return}R(!0),L("");try{const k=await o4(xn,S,window.recaptchaVerifier);z(k),c("otp"),H(60)}catch(k){console.error("Error sending OTP:",k),k.code==="auth/invalid-phone-number"?L("Invalid phone number format"):k.code==="auth/too-many-requests"?L("Too many attempts. Please try again later."):L("Failed to send verification code. Please try again."),window.recaptchaVerifier&&(window.recaptchaVerifier.clear(),window.recaptchaVerifier=null)}finally{R(!1)}},T=async()=>{if(b.length!==6){L("Please enter the 6-digit code");return}R(!0),L("");try{const k=(await O.confirm(b)).user,C=ue(),P=Me(fe,"clients",k.uid),I=await Bo(P);let $;I.exists()?($=I.data(),await Mu(P,{updatedAt:On(),lastLoginAt:On()},{merge:!0})):($={uid:k.uid,phone:C,phoneVerified:!0,createdAt:On(),updatedAt:On()},await Mu(P,$)),c("verified"),setTimeout(()=>{n({user:k,client:{id:k.uid,...$}})},1e3)}catch(S){console.error("Error verifying OTP:",S),S.code==="auth/invalid-verification-code"?L("Invalid code. Please check and try again."):S.code==="auth/code-expired"?L("Code expired. Please request a new one."):L("Verification failed. Please try again.")}finally{R(!1)}},E=async()=>{G>0||(window.recaptchaVerifier&&(window.recaptchaVerifier.clear(),window.recaptchaVerifier=null),window.recaptchaVerifier=new Jw(xn,"recaptcha-container",{size:"invisible"}),await Y())};return a.jsxs("div",{className:"w-full max-w-sm mx-auto",children:[a.jsx("div",{id:"recaptcha-container"}),o==="phone"&&a.jsxs("div",{className:"space-y-4 animate-fade-in",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(Lu,{className:"w-8 h-8 text-blue-600"})}),a.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Enter your phone number"}),a.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"We'll send you a verification code"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{value:x,onChange:S=>g(S.target.value),className:"px-3 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm font-medium",children:[a.jsx("option",{value:"+1",children:" +1"}),a.jsx("option",{value:"+44",children:" +44"}),a.jsx("option",{value:"+61",children:" +61"}),a.jsx("option",{value:"+91",children:" +91"}),a.jsx("option",{value:"+81",children:" +81"}),a.jsx("option",{value:"+49",children:" +49"}),a.jsx("option",{value:"+33",children:" +33"}),a.jsx("option",{value:"+52",children:" +52"}),a.jsx("option",{value:"+55",children:" +55"})]}),a.jsx("input",{type:"tel",value:ae(d),onChange:S=>m(S.target.value.replace(/\D/g,"").slice(0,10)),placeholder:"(555) 123-4567",className:"flex-1 px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg tracking-wide",autoFocus:!0})]}),B&&a.jsx("p",{className:"text-sm text-red-600 bg-red-50 px-4 py-2 rounded-lg",children:B}),a.jsx("button",{onClick:Y,disabled:_||d.replace(/\D/g,"").length<10,className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:_?a.jsxs(a.Fragment,{children:[a.jsx(Mn,{className:"w-5 h-5 animate-spin"}),"Sending..."]}):a.jsxs(a.Fragment,{children:["Continue",a.jsx(Cl,{className:"w-5 h-5"})]})}),e&&a.jsx("button",{onClick:e,className:"w-full px-6 py-3 text-slate-600 hover:text-slate-900 font-medium transition-all",children:"Cancel"}),a.jsxs("p",{className:"text-xs text-slate-400 text-center flex items-center justify-center gap-1",children:[a.jsx(qo,{className:"w-3 h-3"}),"Your number is only used for verification"]})]}),o==="otp"&&a.jsxs("div",{className:"space-y-4 animate-fade-in",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(qo,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Enter verification code"}),a.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:["Sent to ",x," ",ae(d)]})]}),a.jsx("input",{type:"text",inputMode:"numeric",value:b,onChange:S=>v(S.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,className:"w-full px-4 py-4 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-2xl text-center tracking-[0.5em] font-mono",autoFocus:!0}),B&&a.jsx("p",{className:"text-sm text-red-600 bg-red-50 px-4 py-2 rounded-lg",children:B}),a.jsx("button",{onClick:T,disabled:_||b.length!==6,className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:_?a.jsxs(a.Fragment,{children:[a.jsx(Mn,{className:"w-5 h-5 animate-spin"}),"Verifying..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ms,{className:"w-5 h-5"}),"Verify"]})}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("button",{onClick:()=>{c("phone"),v(""),L("")},className:"text-sm text-slate-500 hover:text-slate-700",children:" Change number"}),a.jsxs("button",{onClick:E,disabled:G>0,className:"text-sm text-blue-600 hover:text-blue-700 disabled:text-slate-400 flex items-center gap-1",children:[a.jsx(Zo,{className:"w-3 h-3"}),G>0?`Resend in ${G}s`:"Resend code"]})]})]}),o==="verified"&&a.jsxs("div",{className:"text-center animate-fade-in",children:[a.jsx("div",{className:"w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Ms,{className:"w-10 h-10 text-emerald-600"})}),a.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Verified!"}),a.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Redirecting..."})]})]})}function X9({onLogin:n}){const e=hr(),[t,i]=j.useState(!0);j.useEffect(()=>{const c=Qj(xn,async d=>{if(d&&d.phoneNumber){const m=await Bo(Me(fe,"clients",d.uid));m.exists()&&(n({user:d,client:{id:d.uid,...m.data()}}),e("/client/dashboard"))}i(!1)});return()=>c()},[e,n]);const o=({user:c,client:d})=>{n({user:c,client:d}),e("/client/dashboard")};return t?a.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100 flex items-center justify-center",children:a.jsx("div",{className:"w-10 h-10 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100 flex flex-col",children:[a.jsx("header",{className:"p-4",children:a.jsxs(Ze,{to:"/",className:"flex items-center gap-2 w-fit",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-violet-600 rounded-lg flex items-center justify-center",children:a.jsx(sa,{className:"w-4 h-4 text-white"})}),a.jsxs("span",{className:"text-lg font-bold text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsx("main",{className:"flex-1 flex items-center justify-center p-4",children:a.jsxs("div",{className:"w-full max-w-sm",children:[a.jsx("div",{className:"bg-white rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-200 p-8",children:a.jsx(Q9,{onVerified:o,onCancel:()=>e("/")})}),a.jsx("p",{className:"text-center text-sm text-slate-500 mt-6",children:"View and manage your appointments across all businesses"})]})}),a.jsx("footer",{className:"p-4 text-center",children:a.jsxs("p",{className:"text-xs text-slate-400",children:["By continuing, you agree to our"," ",a.jsx(Ze,{to:"/terms.html",className:"text-blue-600 hover:underline",children:"Terms"})," ","and"," ",a.jsx(Ze,{to:"/privacy-policy.html",className:"text-blue-600 hover:underline",children:"Privacy Policy"})]})})]})}function J9({user:n,client:e}){const t=hr(),[i,o]=j.useState([]),[c,d]=j.useState(!0);j.useEffect(()=>{if(!n||!e){t("/client/login");return}m()},[n,e]);const m=async()=>{d(!0);try{const O=await ys(Ye(fe,"shops")),z=[];for(const G of O.docs){const H=G.data(),ae=Ye(fe,"shops",G.id,"bookings"),ue=pn(ae,cn("clientPhone","==",e.phone));(await ys(ue)).docs.forEach(T=>{z.push({id:T.id,shopId:G.id,shopName:H.name,shopSlug:H.slug,...T.data()})})}z.sort((G,H)=>{const ae=`${G.date}T${G.time}`;return`${H.date}T${H.time}`.localeCompare(ae)}),o(z)}catch(O){console.error("Error fetching bookings:",O)}finally{d(!1)}},x=async()=>{await $u(xn),t("/")},g=O=>{const[z,G,H]=O.split("-").map(Number);return new Date(z,G-1,H).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})},b=O=>{const[z,G]=O.split(":"),H=parseInt(z),ae=H>=12?"PM":"AM";return`${H%12||12}:${G} ${ae}`},v=O=>{switch(O){case"confirmed":return"bg-emerald-100 text-emerald-700 border-emerald-200";case"pending":return"bg-amber-100 text-amber-700 border-amber-200";case"completed":return"bg-blue-100 text-blue-700 border-blue-200";case"cancelled":case"rejected":return"bg-red-100 text-red-700 border-red-200";default:return"bg-slate-100 text-slate-700 border-slate-200"}},_=O=>{switch(O){case"confirmed":return"Confirmed";case"pending":return"Pending";case"completed":return"Completed";case"in_progress":return"In Progress";case"cancelled":return"Cancelled";case"rejected":return"Rejected";default:return"Confirmed"}},R=new Date().toISOString().split("T")[0],B=i.filter(O=>O.date>=R&&!["cancelled","rejected","completed"].includes(O.status)),L=i.filter(O=>O.date<R||["cancelled","rejected","completed"].includes(O.status));return c?a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"}),a.jsx("p",{className:"text-slate-500",children:"Loading your bookings..."})]})}):a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-2xl mx-auto px-4 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white",children:a.jsx(zr,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"font-bold text-slate-900",children:e?.name||"My Account"}),a.jsx("p",{className:"text-xs text-slate-500",children:e?.phone})]})]}),a.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-3 py-2 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all text-sm font-medium",children:[a.jsx(Zu,{className:"w-4 h-4"}),"Logout"]})]})}),a.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-6",children:[a.jsxs("section",{className:"mb-8",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(_t,{className:"w-5 h-5 text-blue-600"}),"Upcoming Appointments"]}),B.length===0?a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:[a.jsx(sa,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),a.jsx("p",{className:"text-slate-500 mb-4",children:"No upcoming appointments"}),a.jsx(Ze,{to:"/",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all",children:"Book an Appointment"})]}):a.jsx("div",{className:"space-y-3",children:B.map(O=>a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4 hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-slate-900",children:O.serviceName||"Appointment"}),a.jsx("p",{className:"text-sm text-slate-500",children:O.shopName})]}),a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-lg border ${v(O.status)}`,children:_(O.status)})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-600",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(_t,{className:"w-4 h-4 text-slate-400"}),g(O.date)]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Wt,{className:"w-4 h-4 text-slate-400"}),b(O.time)]})]}),O.refCode&&a.jsx("div",{className:"mt-3 pt-3 border-t border-slate-100",children:a.jsxs(Ze,{to:`/shop/${O.shopSlug}/booking/${O.refCode}`,className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:["Manage Booking",a.jsx(hc,{className:"w-4 h-4"})]})})]},`${O.shopId}-${O.id}`))})]}),L.length>0&&a.jsxs("section",{children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Wt,{className:"w-5 h-5 text-slate-400"}),"Past Appointments"]}),a.jsx("div",{className:"space-y-3",children:L.slice(0,10).map(O=>a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4 opacity-75",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-slate-700",children:O.serviceName||"Appointment"}),a.jsx("p",{className:"text-sm text-slate-500",children:O.shopName})]}),a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-lg border ${v(O.status)}`,children:_(O.status)})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500",children:[a.jsx("span",{children:g(O.date)}),a.jsx("span",{children:b(O.time)})]})]},`${O.shopId}-${O.id}`))})]})]}),a.jsx("footer",{className:"text-center py-6",children:a.jsxs(Ze,{to:"/",className:"text-sm text-slate-400 hover:text-slate-600",children:["Powered by ",a.jsx("span",{className:"font-semibold",children:"SpotBookie"})]})})]})}function Z9(){const[n,e]=j.useState(null),[t,i]=j.useState(null),[o,c]=j.useState(!0);j.useEffect(()=>{const m=Qj(xn,async x=>{if(e(x),x&&x.phoneNumber)try{const g=await Bo(Me(fe,"clients",x.uid));g.exists()&&i({id:x.uid,...g.data()})}catch(g){console.error("Error fetching client:",g)}else i(null);c(!1)});return()=>m()},[]);const d=({user:m,client:x})=>{e(m),i(x)};return o?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):a.jsx($5,{children:a.jsxs(b5,{children:[a.jsx(Rn,{path:"/",element:a.jsx(DO,{})}),a.jsx(Rn,{path:"/register",element:a.jsx(OO,{})}),a.jsx(Rn,{path:"/login",element:a.jsx(PO,{user:n})}),a.jsx(Rn,{path:"/shop/:slug",element:a.jsx(MP,{})}),a.jsx(Rn,{path:"/shop/:slug/booking/:refCode",element:a.jsx(b9,{})}),a.jsx(Rn,{path:"/shop/:slug/waitlist/:refCode",element:a.jsx(N9,{})}),a.jsx(Rn,{path:"/shop/:slug/queue",element:a.jsx(_9,{})}),a.jsx(Rn,{path:"/shop/:slug/login",element:a.jsx(g9,{user:n})}),a.jsx(Rn,{path:"/shop/:slug/dashboard",element:a.jsx(x9,{user:n})}),a.jsx(Rn,{path:"/admin",element:a.jsx(K9,{user:n})}),a.jsx(Rn,{path:"/client/login",element:a.jsx(X9,{onLogin:d})}),a.jsx(Rn,{path:"/client/dashboard",element:a.jsx(J9,{user:n,client:t})}),a.jsx(Rn,{path:"*",element:a.jsx(x5,{to:"/",replace:!0})})]})})}vT.createRoot(document.getElementById("root")).render(a.jsx(ss.StrictMode,{children:a.jsx(Z9,{})}));
