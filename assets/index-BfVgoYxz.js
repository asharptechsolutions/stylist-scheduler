(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=n(o);fetch(o.href,u)}})();function Lg(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var wp={exports:{}},Mc={};var bv;function KS(){if(bv)return Mc;bv=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,o,u){var d=null;if(u!==void 0&&(d=""+u),o.key!==void 0&&(d=""+o.key),"key"in o){u={};for(var p in o)p!=="key"&&(u[p]=o[p])}else u=o;return o=u.ref,{$$typeof:s,type:r,key:d,ref:o!==void 0?o:null,props:u}}return Mc.Fragment=e,Mc.jsx=n,Mc.jsxs=n,Mc}var yv;function QS(){return yv||(yv=1,wp.exports=KS()),wp.exports}var i=QS(),_p={exports:{}},nt={};var vv;function XS(){if(vv)return nt;vv=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),E=Symbol.iterator;function A(P){return P===null||typeof P!="object"?null:(P=E&&P[E]||P["@@iterator"],typeof P=="function"?P:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},L=Object.assign,O={};function U(P,ee,le){this.props=P,this.context=ee,this.refs=O,this.updater=le||F}U.prototype.isReactComponent={},U.prototype.setState=function(P,ee){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,ee,"setState")},U.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function G(){}G.prototype=U.prototype;function K(P,ee,le){this.props=P,this.context=ee,this.refs=O,this.updater=le||F}var fe=K.prototype=new G;fe.constructor=K,L(fe,U.prototype),fe.isPureReactComponent=!0;var he=Array.isArray;function oe(){}var j={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function R(P,ee,le){var xe=le.ref;return{$$typeof:s,type:P,key:ee,ref:xe!==void 0?xe:null,props:le}}function V(P,ee){return R(P.type,ee,P.props)}function M(P){return typeof P=="object"&&P!==null&&P.$$typeof===s}function z(P){var ee={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(le){return ee[le]})}var I=/\/+/g;function q(P,ee){return typeof P=="object"&&P!==null&&P.key!=null?z(""+P.key):ee.toString(36)}function D(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(oe,oe):(P.status="pending",P.then(function(ee){P.status==="pending"&&(P.status="fulfilled",P.value=ee)},function(ee){P.status==="pending"&&(P.status="rejected",P.reason=ee)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function k(P,ee,le,xe,be){var Re=typeof P;(Re==="undefined"||Re==="boolean")&&(P=null);var ue=!1;if(P===null)ue=!0;else switch(Re){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(P.$$typeof){case s:case e:ue=!0;break;case b:return ue=P._init,k(ue(P._payload),ee,le,xe,be)}}if(ue)return be=be(P),ue=xe===""?"."+q(P,0):xe,he(be)?(le="",ue!=null&&(le=ue.replace(I,"$&/")+"/"),k(be,ee,le,"",function(We){return We})):be!=null&&(M(be)&&(be=V(be,le+(be.key==null||P&&P.key===be.key?"":(""+be.key).replace(I,"$&/")+"/")+ue)),ee.push(be)),1;ue=0;var Ue=xe===""?".":xe+":";if(he(P))for(var Be=0;Be<P.length;Be++)xe=P[Be],Re=Ue+q(xe,Be),ue+=k(xe,ee,le,Re,be);else if(Be=A(P),typeof Be=="function")for(P=Be.call(P),Be=0;!(xe=P.next()).done;)xe=xe.value,Re=Ue+q(xe,Be++),ue+=k(xe,ee,le,Re,be);else if(Re==="object"){if(typeof P.then=="function")return k(D(P),ee,le,xe,be);throw ee=String(P),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return ue}function Y(P,ee,le){if(P==null)return P;var xe=[],be=0;return k(P,xe,"","",function(Re){return ee.call(le,Re,be++)}),xe}function ie(P){if(P._status===-1){var ee=P._result;ee=ee(),ee.then(function(le){(P._status===0||P._status===-1)&&(P._status=1,P._result=le)},function(le){(P._status===0||P._status===-1)&&(P._status=2,P._result=le)}),P._status===-1&&(P._status=0,P._result=ee)}if(P._status===1)return P._result.default;throw P._result}var Te=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},ve={map:Y,forEach:function(P,ee,le){Y(P,function(){ee.apply(this,arguments)},le)},count:function(P){var ee=0;return Y(P,function(){ee++}),ee},toArray:function(P){return Y(P,function(ee){return ee})||[]},only:function(P){if(!M(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return nt.Activity=_,nt.Children=ve,nt.Component=U,nt.Fragment=n,nt.Profiler=o,nt.PureComponent=K,nt.StrictMode=r,nt.Suspense=g,nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,nt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return j.H.useMemoCache(P)}},nt.cache=function(P){return function(){return P.apply(null,arguments)}},nt.cacheSignal=function(){return null},nt.cloneElement=function(P,ee,le){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var xe=L({},P.props),be=P.key;if(ee!=null)for(Re in ee.key!==void 0&&(be=""+ee.key),ee)!T.call(ee,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&ee.ref===void 0||(xe[Re]=ee[Re]);var Re=arguments.length-2;if(Re===1)xe.children=le;else if(1<Re){for(var ue=Array(Re),Ue=0;Ue<Re;Ue++)ue[Ue]=arguments[Ue+2];xe.children=ue}return R(P.type,be,xe)},nt.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:u,_context:P},P},nt.createElement=function(P,ee,le){var xe,be={},Re=null;if(ee!=null)for(xe in ee.key!==void 0&&(Re=""+ee.key),ee)T.call(ee,xe)&&xe!=="key"&&xe!=="__self"&&xe!=="__source"&&(be[xe]=ee[xe]);var ue=arguments.length-2;if(ue===1)be.children=le;else if(1<ue){for(var Ue=Array(ue),Be=0;Be<ue;Be++)Ue[Be]=arguments[Be+2];be.children=Ue}if(P&&P.defaultProps)for(xe in ue=P.defaultProps,ue)be[xe]===void 0&&(be[xe]=ue[xe]);return R(P,Re,be)},nt.createRef=function(){return{current:null}},nt.forwardRef=function(P){return{$$typeof:p,render:P}},nt.isValidElement=M,nt.lazy=function(P){return{$$typeof:b,_payload:{_status:-1,_result:P},_init:ie}},nt.memo=function(P,ee){return{$$typeof:x,type:P,compare:ee===void 0?null:ee}},nt.startTransition=function(P){var ee=j.T,le={};j.T=le;try{var xe=P(),be=j.S;be!==null&&be(le,xe),typeof xe=="object"&&xe!==null&&typeof xe.then=="function"&&xe.then(oe,Te)}catch(Re){Te(Re)}finally{ee!==null&&le.types!==null&&(ee.types=le.types),j.T=ee}},nt.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},nt.use=function(P){return j.H.use(P)},nt.useActionState=function(P,ee,le){return j.H.useActionState(P,ee,le)},nt.useCallback=function(P,ee){return j.H.useCallback(P,ee)},nt.useContext=function(P){return j.H.useContext(P)},nt.useDebugValue=function(){},nt.useDeferredValue=function(P,ee){return j.H.useDeferredValue(P,ee)},nt.useEffect=function(P,ee){return j.H.useEffect(P,ee)},nt.useEffectEvent=function(P){return j.H.useEffectEvent(P)},nt.useId=function(){return j.H.useId()},nt.useImperativeHandle=function(P,ee,le){return j.H.useImperativeHandle(P,ee,le)},nt.useInsertionEffect=function(P,ee){return j.H.useInsertionEffect(P,ee)},nt.useLayoutEffect=function(P,ee){return j.H.useLayoutEffect(P,ee)},nt.useMemo=function(P,ee){return j.H.useMemo(P,ee)},nt.useOptimistic=function(P,ee){return j.H.useOptimistic(P,ee)},nt.useReducer=function(P,ee,le){return j.H.useReducer(P,ee,le)},nt.useRef=function(P){return j.H.useRef(P)},nt.useState=function(P){return j.H.useState(P)},nt.useSyncExternalStore=function(P,ee,le){return j.H.useSyncExternalStore(P,ee,le)},nt.useTransition=function(){return j.H.useTransition()},nt.version="19.2.4",nt}var wv;function Ug(){return wv||(wv=1,_p.exports=XS()),_p.exports}var N=Ug();const $t=Lg(N);var Np={exports:{}},Oc={},Ep={exports:{}},Sp={};var _v;function JS(){return _v||(_v=1,(function(s){function e(k,Y){var ie=k.length;k.push(Y);e:for(;0<ie;){var Te=ie-1>>>1,ve=k[Te];if(0<o(ve,Y))k[Te]=Y,k[ie]=ve,ie=Te;else break e}}function n(k){return k.length===0?null:k[0]}function r(k){if(k.length===0)return null;var Y=k[0],ie=k.pop();if(ie!==Y){k[0]=ie;e:for(var Te=0,ve=k.length,P=ve>>>1;Te<P;){var ee=2*(Te+1)-1,le=k[ee],xe=ee+1,be=k[xe];if(0>o(le,ie))xe<ve&&0>o(be,le)?(k[Te]=be,k[xe]=ie,Te=xe):(k[Te]=le,k[ee]=ie,Te=ee);else if(xe<ve&&0>o(be,ie))k[Te]=be,k[xe]=ie,Te=xe;else break e}}return Y}function o(k,Y){var ie=k.sortIndex-Y.sortIndex;return ie!==0?ie:k.id-Y.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();s.unstable_now=function(){return d.now()-p}}var g=[],x=[],b=1,_=null,E=3,A=!1,F=!1,L=!1,O=!1,U=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;function fe(k){for(var Y=n(x);Y!==null;){if(Y.callback===null)r(x);else if(Y.startTime<=k)r(x),Y.sortIndex=Y.expirationTime,e(g,Y);else break;Y=n(x)}}function he(k){if(L=!1,fe(k),!F)if(n(g)!==null)F=!0,oe||(oe=!0,z());else{var Y=n(x);Y!==null&&D(he,Y.startTime-k)}}var oe=!1,j=-1,T=5,R=-1;function V(){return O?!0:!(s.unstable_now()-R<T)}function M(){if(O=!1,oe){var k=s.unstable_now();R=k;var Y=!0;try{e:{F=!1,L&&(L=!1,G(j),j=-1),A=!0;var ie=E;try{t:{for(fe(k),_=n(g);_!==null&&!(_.expirationTime>k&&V());){var Te=_.callback;if(typeof Te=="function"){_.callback=null,E=_.priorityLevel;var ve=Te(_.expirationTime<=k);if(k=s.unstable_now(),typeof ve=="function"){_.callback=ve,fe(k),Y=!0;break t}_===n(g)&&r(g),fe(k)}else r(g);_=n(g)}if(_!==null)Y=!0;else{var P=n(x);P!==null&&D(he,P.startTime-k),Y=!1}}break e}finally{_=null,E=ie,A=!1}Y=void 0}}finally{Y?z():oe=!1}}}var z;if(typeof K=="function")z=function(){K(M)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,q=I.port2;I.port1.onmessage=M,z=function(){q.postMessage(null)}}else z=function(){U(M,0)};function D(k,Y){j=U(function(){k(s.unstable_now())},Y)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(k){k.callback=null},s.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<k?Math.floor(1e3/k):5},s.unstable_getCurrentPriorityLevel=function(){return E},s.unstable_next=function(k){switch(E){case 1:case 2:case 3:var Y=3;break;default:Y=E}var ie=E;E=Y;try{return k()}finally{E=ie}},s.unstable_requestPaint=function(){O=!0},s.unstable_runWithPriority=function(k,Y){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var ie=E;E=k;try{return Y()}finally{E=ie}},s.unstable_scheduleCallback=function(k,Y,ie){var Te=s.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?Te+ie:Te):ie=Te,k){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=ie+ve,k={id:b++,callback:Y,priorityLevel:k,startTime:ie,expirationTime:ve,sortIndex:-1},ie>Te?(k.sortIndex=ie,e(x,k),n(g)===null&&k===n(x)&&(L?(G(j),j=-1):L=!0,D(he,ie-Te))):(k.sortIndex=ve,e(g,k),F||A||(F=!0,oe||(oe=!0,z()))),k},s.unstable_shouldYield=V,s.unstable_wrapCallback=function(k){var Y=E;return function(){var ie=E;E=Y;try{return k.apply(this,arguments)}finally{E=ie}}}})(Sp)),Sp}var Nv;function ZS(){return Nv||(Nv=1,Ep.exports=JS()),Ep.exports}var jp={exports:{}},Hn={};var Ev;function ej(){if(Ev)return Hn;Ev=1;var s=Ug();function e(g){var x="https://react.dev/errors/"+g;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)x+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+g+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");function u(g,x,b){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:_==null?null:""+_,children:g,containerInfo:x,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,x){if(g==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return Hn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Hn.createPortal=function(g,x){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(e(299));return u(g,x,null,b)},Hn.flushSync=function(g){var x=d.T,b=r.p;try{if(d.T=null,r.p=2,g)return g()}finally{d.T=x,r.p=b,r.d.f()}},Hn.preconnect=function(g,x){typeof g=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,r.d.C(g,x))},Hn.prefetchDNS=function(g){typeof g=="string"&&r.d.D(g)},Hn.preinit=function(g,x){if(typeof g=="string"&&x&&typeof x.as=="string"){var b=x.as,_=p(b,x.crossOrigin),E=typeof x.integrity=="string"?x.integrity:void 0,A=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;b==="style"?r.d.S(g,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:_,integrity:E,fetchPriority:A}):b==="script"&&r.d.X(g,{crossOrigin:_,integrity:E,fetchPriority:A,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},Hn.preinitModule=function(g,x){if(typeof g=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var b=p(x.as,x.crossOrigin);r.d.M(g,{crossOrigin:b,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&r.d.M(g)},Hn.preload=function(g,x){if(typeof g=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var b=x.as,_=p(b,x.crossOrigin);r.d.L(g,b,{crossOrigin:_,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},Hn.preloadModule=function(g,x){if(typeof g=="string")if(x){var b=p(x.as,x.crossOrigin);r.d.m(g,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:b,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else r.d.m(g)},Hn.requestFormReset=function(g){r.d.r(g)},Hn.unstable_batchedUpdates=function(g,x){return g(x)},Hn.useFormState=function(g,x,b){return d.H.useFormState(g,x,b)},Hn.useFormStatus=function(){return d.H.useHostTransitionStatus()},Hn.version="19.2.4",Hn}var Sv;function tj(){if(Sv)return jp.exports;Sv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),jp.exports=ej(),jp.exports}var jv;function nj(){if(jv)return Oc;jv=1;var s=ZS(),e=Ug(),n=tj();function r(t){var a="https://react.dev/errors/"+t;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function u(t){var a=t,l=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,(a.flags&4098)!==0&&(l=a.return),t=a.return;while(t)}return a.tag===3?l:null}function d(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function p(t){if(t.tag===31){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function g(t){if(u(t)!==t)throw Error(r(188))}function x(t){var a=t.alternate;if(!a){if(a=u(t),a===null)throw Error(r(188));return a!==t?null:t}for(var l=t,c=a;;){var f=l.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){l=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===l)return g(f),t;if(m===c)return g(f),a;m=m.sibling}throw Error(r(188))}if(l.return!==c.return)l=f,c=m;else{for(var v=!1,S=f.child;S;){if(S===l){v=!0,l=f,c=m;break}if(S===c){v=!0,c=f,l=m;break}S=S.sibling}if(!v){for(S=m.child;S;){if(S===l){v=!0,l=m,c=f;break}if(S===c){v=!0,c=m,l=f;break}S=S.sibling}if(!v)throw Error(r(189))}}if(l.alternate!==c)throw Error(r(190))}if(l.tag!==3)throw Error(r(188));return l.stateNode.current===l?t:a}function b(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(a=b(t),a!==null)return a;t=t.sibling}return null}var _=Object.assign,E=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),K=Symbol.for("react.context"),fe=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function z(t){return t===null||typeof t!="object"?null:(t=M&&t[M]||t["@@iterator"],typeof t=="function"?t:null)}var I=Symbol.for("react.client.reference");function q(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===I?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case L:return"Fragment";case U:return"Profiler";case O:return"StrictMode";case he:return"Suspense";case oe:return"SuspenseList";case R:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case F:return"Portal";case K:return t.displayName||"Context";case G:return(t._context.displayName||"Context")+".Consumer";case fe:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case j:return a=t.displayName||null,a!==null?a:q(t.type)||"Memo";case T:a=t._payload,t=t._init;try{return q(t(a))}catch{}}return null}var D=Array.isArray,k=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie={pending:!1,data:null,method:null,action:null},Te=[],ve=-1;function P(t){return{current:t}}function ee(t){0>ve||(t.current=Te[ve],Te[ve]=null,ve--)}function le(t,a){ve++,Te[ve]=t.current,t.current=a}var xe=P(null),be=P(null),Re=P(null),ue=P(null);function Ue(t,a){switch(le(Re,a),le(be,t),le(xe,null),a.nodeType){case 9:case 11:t=(t=a.documentElement)&&(t=t.namespaceURI)?zy(t):0;break;default:if(t=a.tagName,a=a.namespaceURI)a=zy(a),t=qy(a,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}ee(xe),le(xe,t)}function Be(){ee(xe),ee(be),ee(Re)}function We(t){t.memoizedState!==null&&le(ue,t);var a=xe.current,l=qy(a,t.type);a!==l&&(le(be,t),le(xe,l))}function Q(t){be.current===t&&(ee(xe),ee(be)),ue.current===t&&(ee(ue),Rc._currentValue=ie)}var we,Ie;function He(t){if(we===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);we=a&&a[1]||"",Ie=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+we+t+Ie}var Ve=!1;function ft(t,a){if(!t||Ve)return"";Ve=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var pe=function(){throw Error()};if(Object.defineProperty(pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pe,[])}catch(re){var ne=re}Reflect.construct(t,[],pe)}else{try{pe.call()}catch(re){ne=re}t.call(pe.prototype)}}else{try{throw Error()}catch(re){ne=re}(pe=t())&&typeof pe.catch=="function"&&pe.catch(function(){})}}catch(re){if(re&&ne&&typeof re.stack=="string")return[re.stack,ne.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),v=m[0],S=m[1];if(v&&S){var B=v.split(`
`),te=S.split(`
`);for(f=c=0;c<B.length&&!B[c].includes("DetermineComponentFrameRoot");)c++;for(;f<te.length&&!te[f].includes("DetermineComponentFrameRoot");)f++;if(c===B.length||f===te.length)for(c=B.length-1,f=te.length-1;1<=c&&0<=f&&B[c]!==te[f];)f--;for(;1<=c&&0<=f;c--,f--)if(B[c]!==te[f]){if(c!==1||f!==1)do if(c--,f--,0>f||B[c]!==te[f]){var ce=`
`+B[c].replace(" at new "," at ");return t.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",t.displayName)),ce}while(1<=c&&0<=f);break}}}finally{Ve=!1,Error.prepareStackTrace=l}return(l=t?t.displayName||t.name:"")?He(l):""}function Kn(t,a){switch(t.tag){case 26:case 27:case 5:return He(t.type);case 16:return He("Lazy");case 13:return t.child!==a&&a!==null?He("Suspense Fallback"):He("Suspense");case 19:return He("SuspenseList");case 0:case 15:return ft(t.type,!1);case 11:return ft(t.type.render,!1);case 1:return ft(t.type,!0);case 31:return He("Activity");default:return""}}function Tt(t){try{var a="",l=null;do a+=Kn(t,l),l=t,t=t.return;while(t);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var vt=Object.prototype.hasOwnProperty,Ae=s.unstable_scheduleCallback,Pe=s.unstable_cancelCallback,ut=s.unstable_shouldYield,Kt=s.unstable_requestPaint,_t=s.unstable_now,Nt=s.unstable_getCurrentPriorityLevel,Tn=s.unstable_ImmediatePriority,Rt=s.unstable_UserBlockingPriority,Qn=s.unstable_NormalPriority,qn=s.unstable_LowPriority,bs=s.unstable_IdlePriority,ts=s.log,qa=s.unstable_setDisableYieldValue,H=null,se=null;function Ne(t){if(typeof ts=="function"&&qa(t),se&&typeof se.setStrictMode=="function")try{se.setStrictMode(H,t)}catch{}}var _e=Math.clz32?Math.clz32:qt,$e=Math.log,et=Math.LN2;function qt(t){return t>>>=0,t===0?32:31-($e(t)/et|0)|0}var ze=256,me=262144,Se=4194304;function Xe(t){var a=t&42;if(a!==0)return a;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function tt(t,a,l){var c=t.pendingLanes;if(c===0)return 0;var f=0,m=t.suspendedLanes,v=t.pingedLanes;t=t.warmLanes;var S=c&134217727;return S!==0?(c=S&~m,c!==0?f=Xe(c):(v&=S,v!==0?f=Xe(v):l||(l=S&~t,l!==0&&(f=Xe(l))))):(S=c&~m,S!==0?f=Xe(S):v!==0?f=Xe(v):l||(l=c&~t,l!==0&&(f=Xe(l)))),f===0?0:a!==0&&a!==f&&(a&m)===0&&(m=f&-f,l=a&-a,m>=l||m===32&&(l&4194048)!==0)?a:f}function Et(t,a){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&a)===0}function Le(t,a){switch(t){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ge(){var t=Se;return Se<<=1,(Se&62914560)===0&&(Se=4194304),t}function Dt(t){for(var a=[],l=0;31>l;l++)a.push(t);return a}function tn(t,a){t.pendingLanes|=a,a!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Fn(t,a,l,c,f,m){var v=t.pendingLanes;t.pendingLanes=l,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=l,t.entangledLanes&=l,t.errorRecoveryDisabledLanes&=l,t.shellSuspendCounter=0;var S=t.entanglements,B=t.expirationTimes,te=t.hiddenUpdates;for(l=v&~l;0<l;){var ce=31-_e(l),pe=1<<ce;S[ce]=0,B[ce]=-1;var ne=te[ce];if(ne!==null)for(te[ce]=null,ce=0;ce<ne.length;ce++){var re=ne[ce];re!==null&&(re.lane&=-536870913)}l&=~pe}c!==0&&ns(t,c,0),m!==0&&f===0&&t.tag!==0&&(t.suspendedLanes|=m&~(v&~a))}function ns(t,a,l){t.pendingLanes|=a,t.suspendedLanes&=~a;var c=31-_e(a);t.entangledLanes|=a,t.entanglements[c]=t.entanglements[c]|1073741824|l&261930}function Xs(t,a){var l=t.entangledLanes|=a;for(t=t.entanglements;l;){var c=31-_e(l),f=1<<c;f&a|t[c]&a&&(t[c]|=a),l&=~f}}function Ei(t,a){var l=a&-a;return l=(l&42)!==0?1:Fa(l),(l&(t.suspendedLanes|a))!==0?0:l}function Fa(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function dn(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Si(){var t=Y.p;return t!==0?t:(t=window.event,t===void 0?32:dv(t.type))}function gn(t,a){var l=Y.p;try{return Y.p=t,a()}finally{Y.p=l}}var ss=Math.random().toString(36).slice(2),nn="__reactFiber$"+ss,xn="__reactProps$"+ss,ys="__reactContainer$"+ss,ji="__reactEvents$"+ss,Tf="__reactListeners$"+ss,Ru="__reactHandles$"+ss,ku="__reactResources$"+ss,ha="__reactMarker$"+ss;function wl(t){delete t[nn],delete t[xn],delete t[ji],delete t[Tf],delete t[Ru]}function fa(t){var a=t[nn];if(a)return a;for(var l=t.parentNode;l;){if(a=l[ys]||l[nn]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(t=Ky(t);t!==null;){if(l=t[nn])return l;t=Ky(t)}return a}t=l,l=t.parentNode}return null}function Ps(t){if(t=t[nn]||t[ys]){var a=t.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return t}return null}function vs(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t.stateNode;throw Error(r(33))}function ma(t){var a=t[ku];return a||(a=t[ku]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function bn(t){t[ha]=!0}var Vo=new Set,Lo={};function pa(t,a){ga(t,a),ga(t+"Capture",a)}function ga(t,a){for(Lo[t]=a,t=0;t<a.length;t++)Vo.add(a[t])}var Uo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Bo={},zo={};function Iu(t){return vt.call(zo,t)?!0:vt.call(Bo,t)?!1:Uo.test(t)?zo[t]=!0:(Bo[t]=!0,!1)}function _l(t,a,l){if(Iu(a))if(l===null)t.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":t.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(a);return}}t.setAttribute(a,""+l)}}function ws(t,a,l){if(l===null)t.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttribute(a,""+l)}}function yn(t,a,l,c){if(c===null)t.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(l);return}t.setAttributeNS(a,l,""+c)}}function Rn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function vr(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function qo(t,a,l){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,a);if(!t.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return f.call(this)},set:function(v){l=""+v,m.call(this,v)}}),Object.defineProperty(t,a,{enumerable:c.enumerable}),{getValue:function(){return l},setValue:function(v){l=""+v},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function Mt(t){if(!t._valueTracker){var a=vr(t)?"checked":"value";t._valueTracker=qo(t,a,""+t[a])}}function Ti(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var l=a.getValue(),c="";return t&&(c=vr(t)?t.checked?"true":"false":t.value),t=c,t!==l?(a.setValue(t),!0):!1}function xa(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Ai=/[\n"\\]/g;function as(t){return t.replace(Ai,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Nl(t,a,l,c,f,m,v,S){t.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?t.type=v:t.removeAttribute("type"),a!=null?v==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+Rn(a)):t.value!==""+Rn(a)&&(t.value=""+Rn(a)):v!=="submit"&&v!=="reset"||t.removeAttribute("value"),a!=null?Fo(t,v,Rn(a)):l!=null?Fo(t,v,Rn(l)):c!=null&&t.removeAttribute("value"),f==null&&m!=null&&(t.defaultChecked=!!m),f!=null&&(t.checked=f&&typeof f!="function"&&typeof f!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?t.name=""+Rn(S):t.removeAttribute("name")}function Du(t,a,l,c,f,m,v,S){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(t.type=m),a!=null||l!=null){if(!(m!=="submit"&&m!=="reset"||a!=null)){Mt(t);return}l=l!=null?""+Rn(l):"",a=a!=null?""+Rn(a):l,S||a===t.value||(t.value=a),t.defaultValue=a}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=S?t.checked:!!c,t.defaultChecked=!!c,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(t.name=v),Mt(t)}function Fo(t,a,l){a==="number"&&xa(t.ownerDocument)===t||t.defaultValue===""+l||(t.defaultValue=""+l)}function wr(t,a,l,c){if(t=t.options,a){a={};for(var f=0;f<l.length;f++)a["$"+l[f]]=!0;for(l=0;l<t.length;l++)f=a.hasOwnProperty("$"+t[l].value),t[l].selected!==f&&(t[l].selected=f),f&&c&&(t[l].defaultSelected=!0)}else{for(l=""+Rn(l),a=null,f=0;f<t.length;f++){if(t[f].value===l){t[f].selected=!0,c&&(t[f].defaultSelected=!0);return}a!==null||t[f].disabled||(a=t[f])}a!==null&&(a.selected=!0)}}function Mu(t,a,l){if(a!=null&&(a=""+Rn(a),a!==t.value&&(t.value=a),l==null)){t.defaultValue!==a&&(t.defaultValue=a);return}t.defaultValue=l!=null?""+Rn(l):""}function _r(t,a,l,c){if(a==null){if(c!=null){if(l!=null)throw Error(r(92));if(D(c)){if(1<c.length)throw Error(r(93));c=c[0]}l=c}l==null&&(l=""),a=l}l=Rn(a),t.defaultValue=l,c=t.textContent,c===l&&c!==""&&c!==null&&(t.value=c),Mt(t)}function rs(t,a){if(a){var l=t.firstChild;if(l&&l===t.lastChild&&l.nodeType===3){l.nodeValue=a;return}}t.textContent=a}var Ou=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ho(t,a,l){var c=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?t.setProperty(a,""):a==="float"?t.cssFloat="":t[a]="":c?t.setProperty(a,l):typeof l!="number"||l===0||Ou.has(a)?a==="float"?t.cssFloat=l:t[a]=(""+l).trim():t[a]=l+"px"}function $o(t,a,l){if(a!=null&&typeof a!="object")throw Error(r(62));if(t=t.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var f in a)c=a[f],a.hasOwnProperty(f)&&l[f]!==c&&Ho(t,f,c)}else for(var m in a)a.hasOwnProperty(m)&&Ho(t,m,a[m])}function El(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Nr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Sl(t){return Nr.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Js(){}var Go=null;function Vs(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Er=null,ba=null;function Ci(t){var a=Ps(t);if(a&&(t=a.stateNode)){var l=t[xn]||null;e:switch(t=a.stateNode,a.type){case"input":if(Nl(t,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=t;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+as(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var c=l[a];if(c!==t&&c.form===t.form){var f=c[xn]||null;if(!f)throw Error(r(90));Nl(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(a=0;a<l.length;a++)c=l[a],c.form===t.form&&Ti(c)}break e;case"textarea":Mu(t,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&wr(t,!!l.multiple,a,!1)}}}var jl=!1;function Sr(t,a,l){if(jl)return t(a,l);jl=!0;try{var c=t(a);return c}finally{if(jl=!1,(Er!==null||ba!==null)&&(Cd(),Er&&(a=Er,t=ba,ba=Er=null,Ci(a),t)))for(a=0;a<t.length;a++)Ci(t[a])}}function Zs(t,a){var l=t.stateNode;if(l===null)return null;var c=l[xn]||null;if(c===null)return null;l=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(l&&typeof l!="function")throw Error(r(231,a,typeof l));return l}var Ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ri=!1;if(Ls)try{var Vt={};Object.defineProperty(Vt,"passive",{get:function(){Ri=!0}}),window.addEventListener("test",Vt,Vt),window.removeEventListener("test",Vt,Vt)}catch{Ri=!1}var ya=null,Yo=null,ki=null;function Wo(){if(ki)return ki;var t,a=Yo,l=a.length,c,f="value"in ya?ya.value:ya.textContent,m=f.length;for(t=0;t<l&&a[t]===f[t];t++);var v=l-t;for(c=1;c<=v&&a[l-c]===f[m-c];c++);return ki=f.slice(t,1<c?1-c:void 0)}function Ii(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function Ha(){return!0}function ea(){return!1}function Mn(t){function a(l,c,f,m,v){this._reactName=l,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var S in t)t.hasOwnProperty(S)&&(l=t[S],this[S]=l?l(m):m[S]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Ha:ea,this.isPropagationStopped=ea,this}return _(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ha)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ha)},persist:function(){},isPersistent:Ha}),a}var $a={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},va=Mn($a),jr=_({},$a,{view:0,detail:0}),Ko=Mn(jr),Tr,Tl,wa,Al=_({},jr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ar,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wa&&(wa&&t.type==="mousemove"?(Tr=t.screenX-wa.screenX,Tl=t.screenY-wa.screenY):Tl=Tr=0,wa=t),Tr)},movementY:function(t){return"movementY"in t?t.movementY:Tl}}),Qo=Mn(Al),Di=_({},Al,{dataTransfer:0}),Vu=Mn(Di),Lu=_({},jr,{relatedTarget:0}),Mi=Mn(Lu),Xo=_({},$a,{animationName:0,elapsedTime:0,pseudoElement:0}),Uu=Mn(Xo),Cl=_({},$a,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Bu=Mn(Cl),zu=_({},$a,{data:0}),_a=Mn(zu),qu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $u(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=Hu[t])?!!a[t]:!1}function Ar(){return $u}var Xn=_({},jr,{key:function(t){if(t.key){var a=qu[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=Ii(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Fu[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ar,charCode:function(t){return t.type==="keypress"?Ii(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ii(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Gu=Mn(Xn),Yu=_({},Al,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ga=Mn(Yu),h=_({},jr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ar}),y=Mn(h),w=_({},$a,{propertyName:0,elapsedTime:0,pseudoElement:0}),C=Mn(w),J=_({},Al,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ae=Mn(J),je=_({},$a,{newState:0,oldState:0}),it=Mn(je),hn=[9,13,27,32],At=Ls&&"CompositionEvent"in window,Qt=null;Ls&&"documentMode"in document&&(Qt=document.documentMode);var Us=Ls&&"TextEvent"in window&&!Qt,Na=Ls&&(!At||Qt&&8<Qt&&11>=Qt),ta=" ",na=!1;function Oi(t,a){switch(t){case"keyup":return hn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rl(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var kl=!1;function yE(t,a){switch(t){case"compositionend":return Rl(a);case"keypress":return a.which!==32?null:(na=!0,ta);case"textInput":return t=a.data,t===ta&&na?null:t;default:return null}}function vE(t,a){if(kl)return t==="compositionend"||!At&&Oi(t,a)?(t=Wo(),ki=Yo=ya=null,kl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Na&&a.locale!=="ko"?null:a.data;default:return null}}var wE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function J0(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!wE[t.type]:a==="textarea"}function Z0(t,a,l,c){Er?ba?ba.push(c):ba=[c]:Er=c,a=Pd(a,"onChange"),0<a.length&&(l=new va("onChange","change",null,l,c),t.push({event:l,listeners:a}))}var Jo=null,Zo=null;function _E(t){Oy(t,0)}function Wu(t){var a=vs(t);if(Ti(a))return t}function ex(t,a){if(t==="change")return a}var tx=!1;if(Ls){var Af;if(Ls){var Cf="oninput"in document;if(!Cf){var nx=document.createElement("div");nx.setAttribute("oninput","return;"),Cf=typeof nx.oninput=="function"}Af=Cf}else Af=!1;tx=Af&&(!document.documentMode||9<document.documentMode)}function sx(){Jo&&(Jo.detachEvent("onpropertychange",ax),Zo=Jo=null)}function ax(t){if(t.propertyName==="value"&&Wu(Zo)){var a=[];Z0(a,Zo,t,Vs(t)),Sr(_E,a)}}function NE(t,a,l){t==="focusin"?(sx(),Jo=a,Zo=l,Jo.attachEvent("onpropertychange",ax)):t==="focusout"&&sx()}function EE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Wu(Zo)}function SE(t,a){if(t==="click")return Wu(a)}function jE(t,a){if(t==="input"||t==="change")return Wu(a)}function TE(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var _s=typeof Object.is=="function"?Object.is:TE;function ec(t,a){if(_s(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var l=Object.keys(t),c=Object.keys(a);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var f=l[c];if(!vt.call(a,f)||!_s(t[f],a[f]))return!1}return!0}function rx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ix(t,a){var l=rx(t);t=0;for(var c;l;){if(l.nodeType===3){if(c=t+l.textContent.length,t<=a&&c>=a)return{node:l,offset:a-t};t=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=rx(l)}}function lx(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?lx(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function ox(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var a=xa(t.document);a instanceof t.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)t=a.contentWindow;else break;a=xa(t.document)}return a}function Rf(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}var AE=Ls&&"documentMode"in document&&11>=document.documentMode,Il=null,kf=null,tc=null,If=!1;function cx(t,a,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;If||Il==null||Il!==xa(c)||(c=Il,"selectionStart"in c&&Rf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),tc&&ec(tc,c)||(tc=c,c=Pd(kf,"onSelect"),0<c.length&&(a=new va("onSelect","select",null,a,l),t.push({event:a,listeners:c}),a.target=Il)))}function Pi(t,a){var l={};return l[t.toLowerCase()]=a.toLowerCase(),l["Webkit"+t]="webkit"+a,l["Moz"+t]="moz"+a,l}var Dl={animationend:Pi("Animation","AnimationEnd"),animationiteration:Pi("Animation","AnimationIteration"),animationstart:Pi("Animation","AnimationStart"),transitionrun:Pi("Transition","TransitionRun"),transitionstart:Pi("Transition","TransitionStart"),transitioncancel:Pi("Transition","TransitionCancel"),transitionend:Pi("Transition","TransitionEnd")},Df={},ux={};Ls&&(ux=document.createElement("div").style,"AnimationEvent"in window||(delete Dl.animationend.animation,delete Dl.animationiteration.animation,delete Dl.animationstart.animation),"TransitionEvent"in window||delete Dl.transitionend.transition);function Vi(t){if(Df[t])return Df[t];if(!Dl[t])return t;var a=Dl[t],l;for(l in a)if(a.hasOwnProperty(l)&&l in ux)return Df[t]=a[l];return t}var dx=Vi("animationend"),hx=Vi("animationiteration"),fx=Vi("animationstart"),CE=Vi("transitionrun"),RE=Vi("transitionstart"),kE=Vi("transitioncancel"),mx=Vi("transitionend"),px=new Map,Mf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Mf.push("scrollEnd");function sa(t,a){px.set(t,a),pa(a,[t])}var Ku=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Bs=[],Ml=0,Of=0;function Qu(){for(var t=Ml,a=Of=Ml=0;a<t;){var l=Bs[a];Bs[a++]=null;var c=Bs[a];Bs[a++]=null;var f=Bs[a];Bs[a++]=null;var m=Bs[a];if(Bs[a++]=null,c!==null&&f!==null){var v=c.pending;v===null?f.next=f:(f.next=v.next,v.next=f),c.pending=f}m!==0&&gx(l,f,m)}}function Xu(t,a,l,c){Bs[Ml++]=t,Bs[Ml++]=a,Bs[Ml++]=l,Bs[Ml++]=c,Of|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function Pf(t,a,l,c){return Xu(t,a,l,c),Ju(t)}function Li(t,a){return Xu(t,null,null,a),Ju(t)}function gx(t,a,l){t.lanes|=l;var c=t.alternate;c!==null&&(c.lanes|=l);for(var f=!1,m=t.return;m!==null;)m.childLanes|=l,c=m.alternate,c!==null&&(c.childLanes|=l),m.tag===22&&(t=m.stateNode,t===null||t._visibility&1||(f=!0)),t=m,m=m.return;return t.tag===3?(m=t.stateNode,f&&a!==null&&(f=31-_e(l),t=m.hiddenUpdates,c=t[f],c===null?t[f]=[a]:c.push(a),a.lane=l|536870912),m):null}function Ju(t){if(50<Nc)throw Nc=0,$m=null,Error(r(185));for(var a=t.return;a!==null;)t=a,a=t.return;return t.tag===3?t.stateNode:null}var Ol={};function IE(t,a,l,c){this.tag=t,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ns(t,a,l,c){return new IE(t,a,l,c)}function Vf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ya(t,a){var l=t.alternate;return l===null?(l=Ns(t.tag,a,t.key,t.mode),l.elementType=t.elementType,l.type=t.type,l.stateNode=t.stateNode,l.alternate=t,t.alternate=l):(l.pendingProps=a,l.type=t.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=t.flags&65011712,l.childLanes=t.childLanes,l.lanes=t.lanes,l.child=t.child,l.memoizedProps=t.memoizedProps,l.memoizedState=t.memoizedState,l.updateQueue=t.updateQueue,a=t.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=t.sibling,l.index=t.index,l.ref=t.ref,l.refCleanup=t.refCleanup,l}function xx(t,a){t.flags&=65011714;var l=t.alternate;return l===null?(t.childLanes=0,t.lanes=a,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=l.childLanes,t.lanes=l.lanes,t.child=l.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=l.memoizedProps,t.memoizedState=l.memoizedState,t.updateQueue=l.updateQueue,t.type=l.type,a=l.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),t}function Zu(t,a,l,c,f,m){var v=0;if(c=t,typeof t=="function")Vf(t)&&(v=1);else if(typeof t=="string")v=VS(t,l,xe.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case R:return t=Ns(31,l,a,f),t.elementType=R,t.lanes=m,t;case L:return Ui(l.children,f,m,a);case O:v=8,f|=24;break;case U:return t=Ns(12,l,a,f|2),t.elementType=U,t.lanes=m,t;case he:return t=Ns(13,l,a,f),t.elementType=he,t.lanes=m,t;case oe:return t=Ns(19,l,a,f),t.elementType=oe,t.lanes=m,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case K:v=10;break e;case G:v=9;break e;case fe:v=11;break e;case j:v=14;break e;case T:v=16,c=null;break e}v=29,l=Error(r(130,t===null?"null":typeof t,"")),c=null}return a=Ns(v,l,a,f),a.elementType=t,a.type=c,a.lanes=m,a}function Ui(t,a,l,c){return t=Ns(7,t,c,a),t.lanes=l,t}function Lf(t,a,l){return t=Ns(6,t,null,a),t.lanes=l,t}function bx(t){var a=Ns(18,null,null,0);return a.stateNode=t,a}function Uf(t,a,l){return a=Ns(4,t.children!==null?t.children:[],t.key,a),a.lanes=l,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}var yx=new WeakMap;function zs(t,a){if(typeof t=="object"&&t!==null){var l=yx.get(t);return l!==void 0?l:(a={value:t,source:a,stack:Tt(a)},yx.set(t,a),a)}return{value:t,source:a,stack:Tt(a)}}var Pl=[],Vl=0,ed=null,nc=0,qs=[],Fs=0,Cr=null,Ea=1,Sa="";function Wa(t,a){Pl[Vl++]=nc,Pl[Vl++]=ed,ed=t,nc=a}function vx(t,a,l){qs[Fs++]=Ea,qs[Fs++]=Sa,qs[Fs++]=Cr,Cr=t;var c=Ea;t=Sa;var f=32-_e(c)-1;c&=~(1<<f),l+=1;var m=32-_e(a)+f;if(30<m){var v=f-f%5;m=(c&(1<<v)-1).toString(32),c>>=v,f-=v,Ea=1<<32-_e(a)+f|l<<f|c,Sa=m+t}else Ea=1<<m|l<<f|c,Sa=t}function Bf(t){t.return!==null&&(Wa(t,1),vx(t,1,0))}function zf(t){for(;t===ed;)ed=Pl[--Vl],Pl[Vl]=null,nc=Pl[--Vl],Pl[Vl]=null;for(;t===Cr;)Cr=qs[--Fs],qs[Fs]=null,Sa=qs[--Fs],qs[Fs]=null,Ea=qs[--Fs],qs[Fs]=null}function wx(t,a){qs[Fs++]=Ea,qs[Fs++]=Sa,qs[Fs++]=Cr,Ea=a.id,Sa=a.overflow,Cr=t}var On=null,Yt=null,yt=!1,Rr=null,Hs=!1,qf=Error(r(519));function kr(t){var a=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw sc(zs(a,t)),qf}function _x(t){var a=t.stateNode,l=t.type,c=t.memoizedProps;switch(a[nn]=t,a[xn]=c,l){case"dialog":ht("cancel",a),ht("close",a);break;case"iframe":case"object":case"embed":ht("load",a);break;case"video":case"audio":for(l=0;l<Sc.length;l++)ht(Sc[l],a);break;case"source":ht("error",a);break;case"img":case"image":case"link":ht("error",a),ht("load",a);break;case"details":ht("toggle",a);break;case"input":ht("invalid",a),Du(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ht("invalid",a);break;case"textarea":ht("invalid",a),_r(a,c.value,c.defaultValue,c.children)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||c.suppressHydrationWarning===!0||Uy(a.textContent,l)?(c.popover!=null&&(ht("beforetoggle",a),ht("toggle",a)),c.onScroll!=null&&ht("scroll",a),c.onScrollEnd!=null&&ht("scrollend",a),c.onClick!=null&&(a.onclick=Js),a=!0):a=!1,a||kr(t,!0)}function Nx(t){for(On=t.return;On;)switch(On.tag){case 5:case 31:case 13:Hs=!1;return;case 27:case 3:Hs=!0;return;default:On=On.return}}function Ll(t){if(t!==On)return!1;if(!yt)return Nx(t),yt=!0,!1;var a=t.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=t.type,l=!(l!=="form"&&l!=="button")||ip(t.type,t.memoizedProps)),l=!l),l&&Yt&&kr(t),Nx(t),a===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));Yt=Wy(t)}else if(a===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));Yt=Wy(t)}else a===27?(a=Yt,$r(t.type)?(t=dp,dp=null,Yt=t):Yt=a):Yt=On?Gs(t.stateNode.nextSibling):null;return!0}function Bi(){Yt=On=null,yt=!1}function Ff(){var t=Rr;return t!==null&&(cs===null?cs=t:cs.push.apply(cs,t),Rr=null),t}function sc(t){Rr===null?Rr=[t]:Rr.push(t)}var Hf=P(null),zi=null,Ka=null;function Ir(t,a,l){le(Hf,a._currentValue),a._currentValue=l}function Qa(t){t._currentValue=Hf.current,ee(Hf)}function $f(t,a,l){for(;t!==null;){var c=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),t===l)break;t=t.return}}function Gf(t,a,l,c){var f=t.child;for(f!==null&&(f.return=t);f!==null;){var m=f.dependencies;if(m!==null){var v=f.child;m=m.firstContext;e:for(;m!==null;){var S=m;m=f;for(var B=0;B<a.length;B++)if(S.context===a[B]){m.lanes|=l,S=m.alternate,S!==null&&(S.lanes|=l),$f(m.return,l,t),c||(v=null);break e}m=S.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(r(341));v.lanes|=l,m=v.alternate,m!==null&&(m.lanes|=l),$f(v,l,t),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===t){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function Ul(t,a,l,c){t=null;for(var f=a,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(r(387));if(v=v.memoizedProps,v!==null){var S=f.type;_s(f.pendingProps.value,v.value)||(t!==null?t.push(S):t=[S])}}else if(f===ue.current){if(v=f.alternate,v===null)throw Error(r(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(t!==null?t.push(Rc):t=[Rc])}f=f.return}t!==null&&Gf(a,t,l,c),a.flags|=262144}function td(t){for(t=t.firstContext;t!==null;){if(!_s(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function qi(t){zi=t,Ka=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Pn(t){return Ex(zi,t)}function nd(t,a){return zi===null&&qi(t),Ex(t,a)}function Ex(t,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Ka===null){if(t===null)throw Error(r(308));Ka=a,t.dependencies={lanes:0,firstContext:a},t.flags|=524288}else Ka=Ka.next=a;return l}var DE=typeof AbortController<"u"?AbortController:function(){var t=[],a=this.signal={aborted:!1,addEventListener:function(l,c){t.push(c)}};this.abort=function(){a.aborted=!0,t.forEach(function(l){return l()})}},ME=s.unstable_scheduleCallback,OE=s.unstable_NormalPriority,vn={$$typeof:K,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yf(){return{controller:new DE,data:new Map,refCount:0}}function ac(t){t.refCount--,t.refCount===0&&ME(OE,function(){t.controller.abort()})}var rc=null,Wf=0,Bl=0,zl=null;function PE(t,a){if(rc===null){var l=rc=[];Wf=0,Bl=Xm(),zl={status:"pending",value:void 0,then:function(c){l.push(c)}}}return Wf++,a.then(Sx,Sx),a}function Sx(){if(--Wf===0&&rc!==null){zl!==null&&(zl.status="fulfilled");var t=rc;rc=null,Bl=0,zl=null;for(var a=0;a<t.length;a++)(0,t[a])()}}function VE(t,a){var l=[],c={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return t.then(function(){c.status="fulfilled",c.value=a;for(var f=0;f<l.length;f++)(0,l[f])(a)},function(f){for(c.status="rejected",c.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),c}var jx=k.S;k.S=function(t,a){cy=_t(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&PE(t,a),jx!==null&&jx(t,a)};var Fi=P(null);function Kf(){var t=Fi.current;return t!==null?t:Ft.pooledCache}function sd(t,a){a===null?le(Fi,Fi.current):le(Fi,a.pool)}function Tx(){var t=Kf();return t===null?null:{parent:vn._currentValue,pool:t}}var ql=Error(r(460)),Qf=Error(r(474)),ad=Error(r(542)),rd={then:function(){}};function Ax(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Cx(t,a,l){switch(l=t[l],l===void 0?t.push(a):l!==a&&(a.then(Js,Js),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,kx(t),t;default:if(typeof a.status=="string")a.then(Js,Js);else{if(t=Ft,t!==null&&100<t.shellSuspendCounter)throw Error(r(482));t=a,t.status="pending",t.then(function(c){if(a.status==="pending"){var f=a;f.status="fulfilled",f.value=c}},function(c){if(a.status==="pending"){var f=a;f.status="rejected",f.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,kx(t),t}throw $i=a,ql}}function Hi(t){try{var a=t._init;return a(t._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?($i=l,ql):l}}var $i=null;function Rx(){if($i===null)throw Error(r(459));var t=$i;return $i=null,t}function kx(t){if(t===ql||t===ad)throw Error(r(483))}var Fl=null,ic=0;function id(t){var a=ic;return ic+=1,Fl===null&&(Fl=[]),Cx(Fl,t,a)}function lc(t,a){a=a.props.ref,t.ref=a!==void 0?a:null}function ld(t,a){throw a.$$typeof===E?Error(r(525)):(t=Object.prototype.toString.call(a),Error(r(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t)))}function Ix(t){function a(W,$){if(t){var Z=W.deletions;Z===null?(W.deletions=[$],W.flags|=16):Z.push($)}}function l(W,$){if(!t)return null;for(;$!==null;)a(W,$),$=$.sibling;return null}function c(W){for(var $=new Map;W!==null;)W.key!==null?$.set(W.key,W):$.set(W.index,W),W=W.sibling;return $}function f(W,$){return W=Ya(W,$),W.index=0,W.sibling=null,W}function m(W,$,Z){return W.index=Z,t?(Z=W.alternate,Z!==null?(Z=Z.index,Z<$?(W.flags|=67108866,$):Z):(W.flags|=67108866,$)):(W.flags|=1048576,$)}function v(W){return t&&W.alternate===null&&(W.flags|=67108866),W}function S(W,$,Z,de){return $===null||$.tag!==6?($=Lf(Z,W.mode,de),$.return=W,$):($=f($,Z),$.return=W,$)}function B(W,$,Z,de){var qe=Z.type;return qe===L?ce(W,$,Z.props.children,de,Z.key):$!==null&&($.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===T&&Hi(qe)===$.type)?($=f($,Z.props),lc($,Z),$.return=W,$):($=Zu(Z.type,Z.key,Z.props,null,W.mode,de),lc($,Z),$.return=W,$)}function te(W,$,Z,de){return $===null||$.tag!==4||$.stateNode.containerInfo!==Z.containerInfo||$.stateNode.implementation!==Z.implementation?($=Uf(Z,W.mode,de),$.return=W,$):($=f($,Z.children||[]),$.return=W,$)}function ce(W,$,Z,de,qe){return $===null||$.tag!==7?($=Ui(Z,W.mode,de,qe),$.return=W,$):($=f($,Z),$.return=W,$)}function pe(W,$,Z){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Lf(""+$,W.mode,Z),$.return=W,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case A:return Z=Zu($.type,$.key,$.props,null,W.mode,Z),lc(Z,$),Z.return=W,Z;case F:return $=Uf($,W.mode,Z),$.return=W,$;case T:return $=Hi($),pe(W,$,Z)}if(D($)||z($))return $=Ui($,W.mode,Z,null),$.return=W,$;if(typeof $.then=="function")return pe(W,id($),Z);if($.$$typeof===K)return pe(W,nd(W,$),Z);ld(W,$)}return null}function ne(W,$,Z,de){var qe=$!==null?$.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return qe!==null?null:S(W,$,""+Z,de);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case A:return Z.key===qe?B(W,$,Z,de):null;case F:return Z.key===qe?te(W,$,Z,de):null;case T:return Z=Hi(Z),ne(W,$,Z,de)}if(D(Z)||z(Z))return qe!==null?null:ce(W,$,Z,de,null);if(typeof Z.then=="function")return ne(W,$,id(Z),de);if(Z.$$typeof===K)return ne(W,$,nd(W,Z),de);ld(W,Z)}return null}function re(W,$,Z,de,qe){if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return W=W.get(Z)||null,S($,W,""+de,qe);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case A:return W=W.get(de.key===null?Z:de.key)||null,B($,W,de,qe);case F:return W=W.get(de.key===null?Z:de.key)||null,te($,W,de,qe);case T:return de=Hi(de),re(W,$,Z,de,qe)}if(D(de)||z(de))return W=W.get(Z)||null,ce($,W,de,qe,null);if(typeof de.then=="function")return re(W,$,Z,id(de),qe);if(de.$$typeof===K)return re(W,$,Z,nd($,de),qe);ld($,de)}return null}function De(W,$,Z,de){for(var qe=null,St=null,Oe=$,ct=$=0,pt=null;Oe!==null&&ct<Z.length;ct++){Oe.index>ct?(pt=Oe,Oe=null):pt=Oe.sibling;var jt=ne(W,Oe,Z[ct],de);if(jt===null){Oe===null&&(Oe=pt);break}t&&Oe&&jt.alternate===null&&a(W,Oe),$=m(jt,$,ct),St===null?qe=jt:St.sibling=jt,St=jt,Oe=pt}if(ct===Z.length)return l(W,Oe),yt&&Wa(W,ct),qe;if(Oe===null){for(;ct<Z.length;ct++)Oe=pe(W,Z[ct],de),Oe!==null&&($=m(Oe,$,ct),St===null?qe=Oe:St.sibling=Oe,St=Oe);return yt&&Wa(W,ct),qe}for(Oe=c(Oe);ct<Z.length;ct++)pt=re(Oe,W,ct,Z[ct],de),pt!==null&&(t&&pt.alternate!==null&&Oe.delete(pt.key===null?ct:pt.key),$=m(pt,$,ct),St===null?qe=pt:St.sibling=pt,St=pt);return t&&Oe.forEach(function(Qr){return a(W,Qr)}),yt&&Wa(W,ct),qe}function Ye(W,$,Z,de){if(Z==null)throw Error(r(151));for(var qe=null,St=null,Oe=$,ct=$=0,pt=null,jt=Z.next();Oe!==null&&!jt.done;ct++,jt=Z.next()){Oe.index>ct?(pt=Oe,Oe=null):pt=Oe.sibling;var Qr=ne(W,Oe,jt.value,de);if(Qr===null){Oe===null&&(Oe=pt);break}t&&Oe&&Qr.alternate===null&&a(W,Oe),$=m(Qr,$,ct),St===null?qe=Qr:St.sibling=Qr,St=Qr,Oe=pt}if(jt.done)return l(W,Oe),yt&&Wa(W,ct),qe;if(Oe===null){for(;!jt.done;ct++,jt=Z.next())jt=pe(W,jt.value,de),jt!==null&&($=m(jt,$,ct),St===null?qe=jt:St.sibling=jt,St=jt);return yt&&Wa(W,ct),qe}for(Oe=c(Oe);!jt.done;ct++,jt=Z.next())jt=re(Oe,W,ct,jt.value,de),jt!==null&&(t&&jt.alternate!==null&&Oe.delete(jt.key===null?ct:jt.key),$=m(jt,$,ct),St===null?qe=jt:St.sibling=jt,St=jt);return t&&Oe.forEach(function(WS){return a(W,WS)}),yt&&Wa(W,ct),qe}function Bt(W,$,Z,de){if(typeof Z=="object"&&Z!==null&&Z.type===L&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case A:e:{for(var qe=Z.key;$!==null;){if($.key===qe){if(qe=Z.type,qe===L){if($.tag===7){l(W,$.sibling),de=f($,Z.props.children),de.return=W,W=de;break e}}else if($.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===T&&Hi(qe)===$.type){l(W,$.sibling),de=f($,Z.props),lc(de,Z),de.return=W,W=de;break e}l(W,$);break}else a(W,$);$=$.sibling}Z.type===L?(de=Ui(Z.props.children,W.mode,de,Z.key),de.return=W,W=de):(de=Zu(Z.type,Z.key,Z.props,null,W.mode,de),lc(de,Z),de.return=W,W=de)}return v(W);case F:e:{for(qe=Z.key;$!==null;){if($.key===qe)if($.tag===4&&$.stateNode.containerInfo===Z.containerInfo&&$.stateNode.implementation===Z.implementation){l(W,$.sibling),de=f($,Z.children||[]),de.return=W,W=de;break e}else{l(W,$);break}else a(W,$);$=$.sibling}de=Uf(Z,W.mode,de),de.return=W,W=de}return v(W);case T:return Z=Hi(Z),Bt(W,$,Z,de)}if(D(Z))return De(W,$,Z,de);if(z(Z)){if(qe=z(Z),typeof qe!="function")throw Error(r(150));return Z=qe.call(Z),Ye(W,$,Z,de)}if(typeof Z.then=="function")return Bt(W,$,id(Z),de);if(Z.$$typeof===K)return Bt(W,$,nd(W,Z),de);ld(W,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,$!==null&&$.tag===6?(l(W,$.sibling),de=f($,Z),de.return=W,W=de):(l(W,$),de=Lf(Z,W.mode,de),de.return=W,W=de),v(W)):l(W,$)}return function(W,$,Z,de){try{ic=0;var qe=Bt(W,$,Z,de);return Fl=null,qe}catch(Oe){if(Oe===ql||Oe===ad)throw Oe;var St=Ns(29,Oe,null,W.mode);return St.lanes=de,St.return=W,St}}}var Gi=Ix(!0),Dx=Ix(!1),Dr=!1;function Xf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jf(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Mr(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Or(t,a,l){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(Ct&2)!==0){var f=c.pending;return f===null?a.next=a:(a.next=f.next,f.next=a),c.pending=a,a=Ju(t),gx(t,null,l),a}return Xu(t,c,a,l),Ju(t)}function oc(t,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var c=a.lanes;c&=t.pendingLanes,l|=c,a.lanes=l,Xs(t,l)}}function Zf(t,a){var l=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var f=null,m=null;if(l=l.firstBaseUpdate,l!==null){do{var v={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};m===null?f=m=v:m=m.next=v,l=l.next}while(l!==null);m===null?f=m=a:m=m.next=a}else f=m=a;l={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},t.updateQueue=l;return}t=l.lastBaseUpdate,t===null?l.firstBaseUpdate=a:t.next=a,l.lastBaseUpdate=a}var em=!1;function cc(){if(em){var t=zl;if(t!==null)throw t}}function uc(t,a,l,c){em=!1;var f=t.updateQueue;Dr=!1;var m=f.firstBaseUpdate,v=f.lastBaseUpdate,S=f.shared.pending;if(S!==null){f.shared.pending=null;var B=S,te=B.next;B.next=null,v===null?m=te:v.next=te,v=B;var ce=t.alternate;ce!==null&&(ce=ce.updateQueue,S=ce.lastBaseUpdate,S!==v&&(S===null?ce.firstBaseUpdate=te:S.next=te,ce.lastBaseUpdate=B))}if(m!==null){var pe=f.baseState;v=0,ce=te=B=null,S=m;do{var ne=S.lane&-536870913,re=ne!==S.lane;if(re?(mt&ne)===ne:(c&ne)===ne){ne!==0&&ne===Bl&&(em=!0),ce!==null&&(ce=ce.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var De=t,Ye=S;ne=a;var Bt=l;switch(Ye.tag){case 1:if(De=Ye.payload,typeof De=="function"){pe=De.call(Bt,pe,ne);break e}pe=De;break e;case 3:De.flags=De.flags&-65537|128;case 0:if(De=Ye.payload,ne=typeof De=="function"?De.call(Bt,pe,ne):De,ne==null)break e;pe=_({},pe,ne);break e;case 2:Dr=!0}}ne=S.callback,ne!==null&&(t.flags|=64,re&&(t.flags|=8192),re=f.callbacks,re===null?f.callbacks=[ne]:re.push(ne))}else re={lane:ne,tag:S.tag,payload:S.payload,callback:S.callback,next:null},ce===null?(te=ce=re,B=pe):ce=ce.next=re,v|=ne;if(S=S.next,S===null){if(S=f.shared.pending,S===null)break;re=S,S=re.next,re.next=null,f.lastBaseUpdate=re,f.shared.pending=null}}while(!0);ce===null&&(B=pe),f.baseState=B,f.firstBaseUpdate=te,f.lastBaseUpdate=ce,m===null&&(f.shared.lanes=0),Br|=v,t.lanes=v,t.memoizedState=pe}}function Mx(t,a){if(typeof t!="function")throw Error(r(191,t));t.call(a)}function Ox(t,a){var l=t.callbacks;if(l!==null)for(t.callbacks=null,t=0;t<l.length;t++)Mx(l[t],a)}var Hl=P(null),od=P(0);function Px(t,a){t=rr,le(od,t),le(Hl,a),rr=t|a.baseLanes}function tm(){le(od,rr),le(Hl,Hl.current)}function nm(){rr=od.current,ee(Hl),ee(od)}var Es=P(null),$s=null;function Pr(t){var a=t.alternate;le(fn,fn.current&1),le(Es,t),$s===null&&(a===null||Hl.current!==null||a.memoizedState!==null)&&($s=t)}function sm(t){le(fn,fn.current),le(Es,t),$s===null&&($s=t)}function Vx(t){t.tag===22?(le(fn,fn.current),le(Es,t),$s===null&&($s=t)):Vr()}function Vr(){le(fn,fn.current),le(Es,Es.current)}function Ss(t){ee(Es),$s===t&&($s=null),ee(fn)}var fn=P(0);function cd(t){for(var a=t;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||cp(l)||up(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Xa=0,lt=null,Lt=null,wn=null,ud=!1,$l=!1,Yi=!1,dd=0,dc=0,Gl=null,LE=0;function sn(){throw Error(r(321))}function am(t,a){if(a===null)return!1;for(var l=0;l<a.length&&l<t.length;l++)if(!_s(t[l],a[l]))return!1;return!0}function rm(t,a,l,c,f,m){return Xa=m,lt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,k.H=t===null||t.memoizedState===null?vb:vm,Yi=!1,m=l(c,f),Yi=!1,$l&&(m=Ux(a,l,c,f)),Lx(t),m}function Lx(t){k.H=mc;var a=Lt!==null&&Lt.next!==null;if(Xa=0,wn=Lt=lt=null,ud=!1,dc=0,Gl=null,a)throw Error(r(300));t===null||_n||(t=t.dependencies,t!==null&&td(t)&&(_n=!0))}function Ux(t,a,l,c){lt=t;var f=0;do{if($l&&(Gl=null),dc=0,$l=!1,25<=f)throw Error(r(301));if(f+=1,wn=Lt=null,t.updateQueue!=null){var m=t.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}k.H=wb,m=a(l,c)}while($l);return m}function UE(){var t=k.H,a=t.useState()[0];return a=typeof a.then=="function"?hc(a):a,t=t.useState()[0],(Lt!==null?Lt.memoizedState:null)!==t&&(lt.flags|=1024),a}function im(){var t=dd!==0;return dd=0,t}function lm(t,a,l){a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~l}function om(t){if(ud){for(t=t.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}ud=!1}Xa=0,wn=Lt=lt=null,$l=!1,dc=dd=0,Gl=null}function Jn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?lt.memoizedState=wn=t:wn=wn.next=t,wn}function mn(){if(Lt===null){var t=lt.alternate;t=t!==null?t.memoizedState:null}else t=Lt.next;var a=wn===null?lt.memoizedState:wn.next;if(a!==null)wn=a,Lt=t;else{if(t===null)throw lt.alternate===null?Error(r(467)):Error(r(310));Lt=t,t={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},wn===null?lt.memoizedState=wn=t:wn=wn.next=t}return wn}function hd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function hc(t){var a=dc;return dc+=1,Gl===null&&(Gl=[]),t=Cx(Gl,t,a),a=lt,(wn===null?a.memoizedState:wn.next)===null&&(a=a.alternate,k.H=a===null||a.memoizedState===null?vb:vm),t}function fd(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return hc(t);if(t.$$typeof===K)return Pn(t)}throw Error(r(438,String(t)))}function cm(t){var a=null,l=lt.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var c=lt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(f){return f.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=hd(),lt.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(t),c=0;c<t;c++)l[c]=V;return a.index++,l}function Ja(t,a){return typeof a=="function"?a(t):a}function md(t){var a=mn();return um(a,Lt,t)}function um(t,a,l){var c=t.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=l;var f=t.baseQueue,m=c.pending;if(m!==null){if(f!==null){var v=f.next;f.next=m.next,m.next=v}a.baseQueue=f=m,c.pending=null}if(m=t.baseState,f===null)t.memoizedState=m;else{a=f.next;var S=v=null,B=null,te=a,ce=!1;do{var pe=te.lane&-536870913;if(pe!==te.lane?(mt&pe)===pe:(Xa&pe)===pe){var ne=te.revertLane;if(ne===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),pe===Bl&&(ce=!0);else if((Xa&ne)===ne){te=te.next,ne===Bl&&(ce=!0);continue}else pe={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},B===null?(S=B=pe,v=m):B=B.next=pe,lt.lanes|=ne,Br|=ne;pe=te.action,Yi&&l(m,pe),m=te.hasEagerState?te.eagerState:l(m,pe)}else ne={lane:pe,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},B===null?(S=B=ne,v=m):B=B.next=ne,lt.lanes|=pe,Br|=pe;te=te.next}while(te!==null&&te!==a);if(B===null?v=m:B.next=S,!_s(m,t.memoizedState)&&(_n=!0,ce&&(l=zl,l!==null)))throw l;t.memoizedState=m,t.baseState=v,t.baseQueue=B,c.lastRenderedState=m}return f===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function dm(t){var a=mn(),l=a.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=t;var c=l.dispatch,f=l.pending,m=a.memoizedState;if(f!==null){l.pending=null;var v=f=f.next;do m=t(m,v.action),v=v.next;while(v!==f);_s(m,a.memoizedState)||(_n=!0),a.memoizedState=m,a.baseQueue===null&&(a.baseState=m),l.lastRenderedState=m}return[m,c]}function Bx(t,a,l){var c=lt,f=mn(),m=yt;if(m){if(l===void 0)throw Error(r(407));l=l()}else l=a();var v=!_s((Lt||f).memoizedState,l);if(v&&(f.memoizedState=l,_n=!0),f=f.queue,mm(Fx.bind(null,c,f,t),[t]),f.getSnapshot!==a||v||wn!==null&&wn.memoizedState.tag&1){if(c.flags|=2048,Yl(9,{destroy:void 0},qx.bind(null,c,f,l,a),null),Ft===null)throw Error(r(349));m||(Xa&127)!==0||zx(c,a,l)}return l}function zx(t,a,l){t.flags|=16384,t={getSnapshot:a,value:l},a=lt.updateQueue,a===null?(a=hd(),lt.updateQueue=a,a.stores=[t]):(l=a.stores,l===null?a.stores=[t]:l.push(t))}function qx(t,a,l,c){a.value=l,a.getSnapshot=c,Hx(a)&&$x(t)}function Fx(t,a,l){return l(function(){Hx(a)&&$x(t)})}function Hx(t){var a=t.getSnapshot;t=t.value;try{var l=a();return!_s(t,l)}catch{return!0}}function $x(t){var a=Li(t,2);a!==null&&us(a,t,2)}function hm(t){var a=Jn();if(typeof t=="function"){var l=t;if(t=l(),Yi){Ne(!0);try{l()}finally{Ne(!1)}}}return a.memoizedState=a.baseState=t,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:t},a}function Gx(t,a,l,c){return t.baseState=l,um(t,Lt,typeof c=="function"?c:Ja)}function BE(t,a,l,c,f){if(xd(t))throw Error(r(485));if(t=a.action,t!==null){var m={payload:f,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){m.listeners.push(v)}};k.T!==null?l(!0):m.isTransition=!1,c(m),l=a.pending,l===null?(m.next=a.pending=m,Yx(a,m)):(m.next=l.next,a.pending=l.next=m)}}function Yx(t,a){var l=a.action,c=a.payload,f=t.state;if(a.isTransition){var m=k.T,v={};k.T=v;try{var S=l(f,c),B=k.S;B!==null&&B(v,S),Wx(t,a,S)}catch(te){fm(t,a,te)}finally{m!==null&&v.types!==null&&(m.types=v.types),k.T=m}}else try{m=l(f,c),Wx(t,a,m)}catch(te){fm(t,a,te)}}function Wx(t,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){Kx(t,a,c)},function(c){return fm(t,a,c)}):Kx(t,a,l)}function Kx(t,a,l){a.status="fulfilled",a.value=l,Qx(a),t.state=l,a=t.pending,a!==null&&(l=a.next,l===a?t.pending=null:(l=l.next,a.next=l,Yx(t,l)))}function fm(t,a,l){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=l,Qx(a),a=a.next;while(a!==c)}t.action=null}function Qx(t){t=t.listeners;for(var a=0;a<t.length;a++)(0,t[a])()}function Xx(t,a){return a}function Jx(t,a){if(yt){var l=Ft.formState;if(l!==null){e:{var c=lt;if(yt){if(Yt){t:{for(var f=Yt,m=Hs;f.nodeType!==8;){if(!m){f=null;break t}if(f=Gs(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Yt=Gs(f.nextSibling),c=f.data==="F!";break e}}kr(c)}c=!1}c&&(a=l[0])}}return l=Jn(),l.memoizedState=l.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xx,lastRenderedState:a},l.queue=c,l=xb.bind(null,lt,c),c.dispatch=l,c=hm(!1),m=ym.bind(null,lt,!1,c.queue),c=Jn(),f={state:a,dispatch:null,action:t,pending:null},c.queue=f,l=BE.bind(null,lt,f,m,l),f.dispatch=l,c.memoizedState=t,[a,l,!1]}function Zx(t){var a=mn();return eb(a,Lt,t)}function eb(t,a,l){if(a=um(t,a,Xx)[0],t=md(Ja)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=hc(a)}catch(v){throw v===ql?ad:v}else c=a;a=mn();var f=a.queue,m=f.dispatch;return l!==a.memoizedState&&(lt.flags|=2048,Yl(9,{destroy:void 0},zE.bind(null,f,l),null)),[c,m,t]}function zE(t,a){t.action=a}function tb(t){var a=mn(),l=Lt;if(l!==null)return eb(a,l,t);mn(),a=a.memoizedState,l=mn();var c=l.queue.dispatch;return l.memoizedState=t,[a,c,!1]}function Yl(t,a,l,c){return t={tag:t,create:l,deps:c,inst:a,next:null},a=lt.updateQueue,a===null&&(a=hd(),lt.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=t.next=t:(c=l.next,l.next=t,t.next=c,a.lastEffect=t),t}function nb(){return mn().memoizedState}function pd(t,a,l,c){var f=Jn();lt.flags|=t,f.memoizedState=Yl(1|a,{destroy:void 0},l,c===void 0?null:c)}function gd(t,a,l,c){var f=mn();c=c===void 0?null:c;var m=f.memoizedState.inst;Lt!==null&&c!==null&&am(c,Lt.memoizedState.deps)?f.memoizedState=Yl(a,m,l,c):(lt.flags|=t,f.memoizedState=Yl(1|a,m,l,c))}function sb(t,a){pd(8390656,8,t,a)}function mm(t,a){gd(2048,8,t,a)}function qE(t){lt.flags|=4;var a=lt.updateQueue;if(a===null)a=hd(),lt.updateQueue=a,a.events=[t];else{var l=a.events;l===null?a.events=[t]:l.push(t)}}function ab(t){var a=mn().memoizedState;return qE({ref:a,nextImpl:t}),function(){if((Ct&2)!==0)throw Error(r(440));return a.impl.apply(void 0,arguments)}}function rb(t,a){return gd(4,2,t,a)}function ib(t,a){return gd(4,4,t,a)}function lb(t,a){if(typeof a=="function"){t=t();var l=a(t);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function ob(t,a,l){l=l!=null?l.concat([t]):null,gd(4,4,lb.bind(null,a,t),l)}function pm(){}function cb(t,a){var l=mn();a=a===void 0?null:a;var c=l.memoizedState;return a!==null&&am(a,c[1])?c[0]:(l.memoizedState=[t,a],t)}function ub(t,a){var l=mn();a=a===void 0?null:a;var c=l.memoizedState;if(a!==null&&am(a,c[1]))return c[0];if(c=t(),Yi){Ne(!0);try{t()}finally{Ne(!1)}}return l.memoizedState=[c,a],c}function gm(t,a,l){return l===void 0||(Xa&1073741824)!==0&&(mt&261930)===0?t.memoizedState=a:(t.memoizedState=l,t=dy(),lt.lanes|=t,Br|=t,l)}function db(t,a,l,c){return _s(l,a)?l:Hl.current!==null?(t=gm(t,l,c),_s(t,a)||(_n=!0),t):(Xa&42)===0||(Xa&1073741824)!==0&&(mt&261930)===0?(_n=!0,t.memoizedState=l):(t=dy(),lt.lanes|=t,Br|=t,a)}function hb(t,a,l,c,f){var m=Y.p;Y.p=m!==0&&8>m?m:8;var v=k.T,S={};k.T=S,ym(t,!1,a,l);try{var B=f(),te=k.S;if(te!==null&&te(S,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var ce=VE(B,c);fc(t,a,ce,As(t))}else fc(t,a,c,As(t))}catch(pe){fc(t,a,{then:function(){},status:"rejected",reason:pe},As())}finally{Y.p=m,v!==null&&S.types!==null&&(v.types=S.types),k.T=v}}function FE(){}function xm(t,a,l,c){if(t.tag!==5)throw Error(r(476));var f=fb(t).queue;hb(t,f,a,ie,l===null?FE:function(){return mb(t),l(c)})}function fb(t){var a=t.memoizedState;if(a!==null)return a;a={memoizedState:ie,baseState:ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:ie},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:l},next:null},t.memoizedState=a,t=t.alternate,t!==null&&(t.memoizedState=a),a}function mb(t){var a=fb(t);a.next===null&&(a=t.alternate.memoizedState),fc(t,a.next.queue,{},As())}function bm(){return Pn(Rc)}function pb(){return mn().memoizedState}function gb(){return mn().memoizedState}function HE(t){for(var a=t.return;a!==null;){switch(a.tag){case 24:case 3:var l=As();t=Mr(l);var c=Or(a,t,l);c!==null&&(us(c,a,l),oc(c,a,l)),a={cache:Yf()},t.payload=a;return}a=a.return}}function $E(t,a,l){var c=As();l={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},xd(t)?bb(a,l):(l=Pf(t,a,l,c),l!==null&&(us(l,t,c),yb(l,a,c)))}function xb(t,a,l){var c=As();fc(t,a,l,c)}function fc(t,a,l,c){var f={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(xd(t))bb(a,f);else{var m=t.alternate;if(t.lanes===0&&(m===null||m.lanes===0)&&(m=a.lastRenderedReducer,m!==null))try{var v=a.lastRenderedState,S=m(v,l);if(f.hasEagerState=!0,f.eagerState=S,_s(S,v))return Xu(t,a,f,0),Ft===null&&Qu(),!1}catch{}if(l=Pf(t,a,f,c),l!==null)return us(l,t,c),yb(l,a,c),!0}return!1}function ym(t,a,l,c){if(c={lane:2,revertLane:Xm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},xd(t)){if(a)throw Error(r(479))}else a=Pf(t,l,c,2),a!==null&&us(a,t,2)}function xd(t){var a=t.alternate;return t===lt||a!==null&&a===lt}function bb(t,a){$l=ud=!0;var l=t.pending;l===null?a.next=a:(a.next=l.next,l.next=a),t.pending=a}function yb(t,a,l){if((l&4194048)!==0){var c=a.lanes;c&=t.pendingLanes,l|=c,a.lanes=l,Xs(t,l)}}var mc={readContext:Pn,use:fd,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useLayoutEffect:sn,useInsertionEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useSyncExternalStore:sn,useId:sn,useHostTransitionStatus:sn,useFormState:sn,useActionState:sn,useOptimistic:sn,useMemoCache:sn,useCacheRefresh:sn};mc.useEffectEvent=sn;var vb={readContext:Pn,use:fd,useCallback:function(t,a){return Jn().memoizedState=[t,a===void 0?null:a],t},useContext:Pn,useEffect:sb,useImperativeHandle:function(t,a,l){l=l!=null?l.concat([t]):null,pd(4194308,4,lb.bind(null,a,t),l)},useLayoutEffect:function(t,a){return pd(4194308,4,t,a)},useInsertionEffect:function(t,a){pd(4,2,t,a)},useMemo:function(t,a){var l=Jn();a=a===void 0?null:a;var c=t();if(Yi){Ne(!0);try{t()}finally{Ne(!1)}}return l.memoizedState=[c,a],c},useReducer:function(t,a,l){var c=Jn();if(l!==void 0){var f=l(a);if(Yi){Ne(!0);try{l(a)}finally{Ne(!1)}}}else f=a;return c.memoizedState=c.baseState=f,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:f},c.queue=t,t=t.dispatch=$E.bind(null,lt,t),[c.memoizedState,t]},useRef:function(t){var a=Jn();return t={current:t},a.memoizedState=t},useState:function(t){t=hm(t);var a=t.queue,l=xb.bind(null,lt,a);return a.dispatch=l,[t.memoizedState,l]},useDebugValue:pm,useDeferredValue:function(t,a){var l=Jn();return gm(l,t,a)},useTransition:function(){var t=hm(!1);return t=hb.bind(null,lt,t.queue,!0,!1),Jn().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,a,l){var c=lt,f=Jn();if(yt){if(l===void 0)throw Error(r(407));l=l()}else{if(l=a(),Ft===null)throw Error(r(349));(mt&127)!==0||zx(c,a,l)}f.memoizedState=l;var m={value:l,getSnapshot:a};return f.queue=m,sb(Fx.bind(null,c,m,t),[t]),c.flags|=2048,Yl(9,{destroy:void 0},qx.bind(null,c,m,l,a),null),l},useId:function(){var t=Jn(),a=Ft.identifierPrefix;if(yt){var l=Sa,c=Ea;l=(c&~(1<<32-_e(c)-1)).toString(32)+l,a="_"+a+"R_"+l,l=dd++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=LE++,a="_"+a+"r_"+l.toString(32)+"_";return t.memoizedState=a},useHostTransitionStatus:bm,useFormState:Jx,useActionState:Jx,useOptimistic:function(t){var a=Jn();a.memoizedState=a.baseState=t;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=ym.bind(null,lt,!0,l),l.dispatch=a,[t,a]},useMemoCache:cm,useCacheRefresh:function(){return Jn().memoizedState=HE.bind(null,lt)},useEffectEvent:function(t){var a=Jn(),l={impl:t};return a.memoizedState=l,function(){if((Ct&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}},vm={readContext:Pn,use:fd,useCallback:cb,useContext:Pn,useEffect:mm,useImperativeHandle:ob,useInsertionEffect:rb,useLayoutEffect:ib,useMemo:ub,useReducer:md,useRef:nb,useState:function(){return md(Ja)},useDebugValue:pm,useDeferredValue:function(t,a){var l=mn();return db(l,Lt.memoizedState,t,a)},useTransition:function(){var t=md(Ja)[0],a=mn().memoizedState;return[typeof t=="boolean"?t:hc(t),a]},useSyncExternalStore:Bx,useId:pb,useHostTransitionStatus:bm,useFormState:Zx,useActionState:Zx,useOptimistic:function(t,a){var l=mn();return Gx(l,Lt,t,a)},useMemoCache:cm,useCacheRefresh:gb};vm.useEffectEvent=ab;var wb={readContext:Pn,use:fd,useCallback:cb,useContext:Pn,useEffect:mm,useImperativeHandle:ob,useInsertionEffect:rb,useLayoutEffect:ib,useMemo:ub,useReducer:dm,useRef:nb,useState:function(){return dm(Ja)},useDebugValue:pm,useDeferredValue:function(t,a){var l=mn();return Lt===null?gm(l,t,a):db(l,Lt.memoizedState,t,a)},useTransition:function(){var t=dm(Ja)[0],a=mn().memoizedState;return[typeof t=="boolean"?t:hc(t),a]},useSyncExternalStore:Bx,useId:pb,useHostTransitionStatus:bm,useFormState:tb,useActionState:tb,useOptimistic:function(t,a){var l=mn();return Lt!==null?Gx(l,Lt,t,a):(l.baseState=t,[t,l.queue.dispatch])},useMemoCache:cm,useCacheRefresh:gb};wb.useEffectEvent=ab;function wm(t,a,l,c){a=t.memoizedState,l=l(c,a),l=l==null?a:_({},a,l),t.memoizedState=l,t.lanes===0&&(t.updateQueue.baseState=l)}var _m={enqueueSetState:function(t,a,l){t=t._reactInternals;var c=As(),f=Mr(c);f.payload=a,l!=null&&(f.callback=l),a=Or(t,f,c),a!==null&&(us(a,t,c),oc(a,t,c))},enqueueReplaceState:function(t,a,l){t=t._reactInternals;var c=As(),f=Mr(c);f.tag=1,f.payload=a,l!=null&&(f.callback=l),a=Or(t,f,c),a!==null&&(us(a,t,c),oc(a,t,c))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var l=As(),c=Mr(l);c.tag=2,a!=null&&(c.callback=a),a=Or(t,c,l),a!==null&&(us(a,t,l),oc(a,t,l))}};function _b(t,a,l,c,f,m,v){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,m,v):a.prototype&&a.prototype.isPureReactComponent?!ec(l,c)||!ec(f,m):!0}function Nb(t,a,l,c){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,c),a.state!==t&&_m.enqueueReplaceState(a,a.state,null)}function Wi(t,a){var l=a;if("ref"in a){l={};for(var c in a)c!=="ref"&&(l[c]=a[c])}if(t=t.defaultProps){l===a&&(l=_({},l));for(var f in t)l[f]===void 0&&(l[f]=t[f])}return l}function Eb(t){Ku(t)}function Sb(t){console.error(t)}function jb(t){Ku(t)}function bd(t,a){try{var l=t.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Tb(t,a,l){try{var c=t.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Nm(t,a,l){return l=Mr(l),l.tag=3,l.payload={element:null},l.callback=function(){bd(t,a)},l}function Ab(t){return t=Mr(t),t.tag=3,t}function Cb(t,a,l,c){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;t.payload=function(){return f(m)},t.callback=function(){Tb(a,l,c)}}var v=l.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(t.callback=function(){Tb(a,l,c),typeof f!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function GE(t,a,l,c,f){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=l.alternate,a!==null&&Ul(a,l,f,!0),l=Es.current,l!==null){switch(l.tag){case 31:case 13:return $s===null?Rd():l.alternate===null&&an===0&&(an=3),l.flags&=-257,l.flags|=65536,l.lanes=f,c===rd?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([c]):a.add(c),Wm(t,c,f)),!1;case 22:return l.flags|=65536,c===rd?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([c]):l.add(c)),Wm(t,c,f)),!1}throw Error(r(435,l.tag))}return Wm(t,c,f),Rd(),!1}if(yt)return a=Es.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=f,c!==qf&&(t=Error(r(422),{cause:c}),sc(zs(t,l)))):(c!==qf&&(a=Error(r(423),{cause:c}),sc(zs(a,l))),t=t.current.alternate,t.flags|=65536,f&=-f,t.lanes|=f,c=zs(c,l),f=Nm(t.stateNode,c,f),Zf(t,f),an!==4&&(an=2)),!1;var m=Error(r(520),{cause:c});if(m=zs(m,l),_c===null?_c=[m]:_c.push(m),an!==4&&(an=2),a===null)return!0;c=zs(c,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,t=f&-f,l.lanes|=t,t=Nm(l.stateNode,c,t),Zf(l,t),!1;case 1:if(a=l.type,m=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(zr===null||!zr.has(m))))return l.flags|=65536,f&=-f,l.lanes|=f,f=Ab(f),Cb(f,t,l,c),Zf(l,f),!1}l=l.return}while(l!==null);return!1}var Em=Error(r(461)),_n=!1;function Vn(t,a,l,c){a.child=t===null?Dx(a,null,l,c):Gi(a,t.child,l,c)}function Rb(t,a,l,c,f){l=l.render;var m=a.ref;if("ref"in c){var v={};for(var S in c)S!=="ref"&&(v[S]=c[S])}else v=c;return qi(a),c=rm(t,a,l,v,m,f),S=im(),t!==null&&!_n?(lm(t,a,f),Za(t,a,f)):(yt&&S&&Bf(a),a.flags|=1,Vn(t,a,c,f),a.child)}function kb(t,a,l,c,f){if(t===null){var m=l.type;return typeof m=="function"&&!Vf(m)&&m.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=m,Ib(t,a,m,c,f)):(t=Zu(l.type,null,c,a,a.mode,f),t.ref=a.ref,t.return=a,a.child=t)}if(m=t.child,!Im(t,f)){var v=m.memoizedProps;if(l=l.compare,l=l!==null?l:ec,l(v,c)&&t.ref===a.ref)return Za(t,a,f)}return a.flags|=1,t=Ya(m,c),t.ref=a.ref,t.return=a,a.child=t}function Ib(t,a,l,c,f){if(t!==null){var m=t.memoizedProps;if(ec(m,c)&&t.ref===a.ref)if(_n=!1,a.pendingProps=c=m,Im(t,f))(t.flags&131072)!==0&&(_n=!0);else return a.lanes=t.lanes,Za(t,a,f)}return Sm(t,a,l,c,f)}function Db(t,a,l,c){var f=c.children,m=t!==null?t.memoizedState:null;if(t===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(m=m!==null?m.baseLanes|l:l,t!==null){for(c=a.child=t.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,a.child=null;return Mb(t,a,m,l,c)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},t!==null&&sd(a,m!==null?m.cachePool:null),m!==null?Px(a,m):tm(),Vx(a);else return c=a.lanes=536870912,Mb(t,a,m!==null?m.baseLanes|l:l,l,c)}else m!==null?(sd(a,m.cachePool),Px(a,m),Vr(),a.memoizedState=null):(t!==null&&sd(a,null),tm(),Vr());return Vn(t,a,f,l),a.child}function pc(t,a){return t!==null&&t.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Mb(t,a,l,c,f){var m=Kf();return m=m===null?null:{parent:vn._currentValue,pool:m},a.memoizedState={baseLanes:l,cachePool:m},t!==null&&sd(a,null),tm(),Vx(a),t!==null&&Ul(t,a,c,!0),a.childLanes=f,null}function yd(t,a){return a=wd({mode:a.mode,children:a.children},t.mode),a.ref=t.ref,t.child=a,a.return=t,a}function Ob(t,a,l){return Gi(a,t.child,null,l),t=yd(a,a.pendingProps),t.flags|=2,Ss(a),a.memoizedState=null,t}function YE(t,a,l){var c=a.pendingProps,f=(a.flags&128)!==0;if(a.flags&=-129,t===null){if(yt){if(c.mode==="hidden")return t=yd(a,c),a.lanes=536870912,pc(null,t);if(sm(a),(t=Yt)?(t=Yy(t,Hs),t=t!==null&&t.data==="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Cr!==null?{id:Ea,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},l=bx(t),l.return=a,a.child=l,On=a,Yt=null)):t=null,t===null)throw kr(a);return a.lanes=536870912,null}return yd(a,c)}var m=t.memoizedState;if(m!==null){var v=m.dehydrated;if(sm(a),f)if(a.flags&256)a.flags&=-257,a=Ob(t,a,l);else if(a.memoizedState!==null)a.child=t.child,a.flags|=128,a=null;else throw Error(r(558));else if(_n||Ul(t,a,l,!1),f=(l&t.childLanes)!==0,_n||f){if(c=Ft,c!==null&&(v=Ei(c,l),v!==0&&v!==m.retryLane))throw m.retryLane=v,Li(t,v),us(c,t,v),Em;Rd(),a=Ob(t,a,l)}else t=m.treeContext,Yt=Gs(v.nextSibling),On=a,yt=!0,Rr=null,Hs=!1,t!==null&&wx(a,t),a=yd(a,c),a.flags|=4096;return a}return t=Ya(t.child,{mode:c.mode,children:c.children}),t.ref=a.ref,a.child=t,t.return=a,t}function vd(t,a){var l=a.ref;if(l===null)t!==null&&t.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(r(284));(t===null||t.ref!==l)&&(a.flags|=4194816)}}function Sm(t,a,l,c,f){return qi(a),l=rm(t,a,l,c,void 0,f),c=im(),t!==null&&!_n?(lm(t,a,f),Za(t,a,f)):(yt&&c&&Bf(a),a.flags|=1,Vn(t,a,l,f),a.child)}function Pb(t,a,l,c,f,m){return qi(a),a.updateQueue=null,l=Ux(a,c,l,f),Lx(t),c=im(),t!==null&&!_n?(lm(t,a,m),Za(t,a,m)):(yt&&c&&Bf(a),a.flags|=1,Vn(t,a,l,m),a.child)}function Vb(t,a,l,c,f){if(qi(a),a.stateNode===null){var m=Ol,v=l.contextType;typeof v=="object"&&v!==null&&(m=Pn(v)),m=new l(c,m),a.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=_m,a.stateNode=m,m._reactInternals=a,m=a.stateNode,m.props=c,m.state=a.memoizedState,m.refs={},Xf(a),v=l.contextType,m.context=typeof v=="object"&&v!==null?Pn(v):Ol,m.state=a.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(wm(a,l,v,c),m.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(v=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),v!==m.state&&_m.enqueueReplaceState(m,m.state,null),uc(a,c,m,f),cc(),m.state=a.memoizedState),typeof m.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(t===null){m=a.stateNode;var S=a.memoizedProps,B=Wi(l,S);m.props=B;var te=m.context,ce=l.contextType;v=Ol,typeof ce=="object"&&ce!==null&&(v=Pn(ce));var pe=l.getDerivedStateFromProps;ce=typeof pe=="function"||typeof m.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,ce||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(S||te!==v)&&Nb(a,m,c,v),Dr=!1;var ne=a.memoizedState;m.state=ne,uc(a,c,m,f),cc(),te=a.memoizedState,S||ne!==te||Dr?(typeof pe=="function"&&(wm(a,l,pe,c),te=a.memoizedState),(B=Dr||_b(a,l,B,c,ne,te,v))?(ce||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(a.flags|=4194308)):(typeof m.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=te),m.props=c,m.state=te,m.context=v,c=B):(typeof m.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{m=a.stateNode,Jf(t,a),v=a.memoizedProps,ce=Wi(l,v),m.props=ce,pe=a.pendingProps,ne=m.context,te=l.contextType,B=Ol,typeof te=="object"&&te!==null&&(B=Pn(te)),S=l.getDerivedStateFromProps,(te=typeof S=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==pe||ne!==B)&&Nb(a,m,c,B),Dr=!1,ne=a.memoizedState,m.state=ne,uc(a,c,m,f),cc();var re=a.memoizedState;v!==pe||ne!==re||Dr||t!==null&&t.dependencies!==null&&td(t.dependencies)?(typeof S=="function"&&(wm(a,l,S,c),re=a.memoizedState),(ce=Dr||_b(a,l,ce,c,ne,re,B)||t!==null&&t.dependencies!==null&&td(t.dependencies))?(te||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,re,B),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,re,B)),typeof m.componentDidUpdate=="function"&&(a.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===t.memoizedProps&&ne===t.memoizedState||(a.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===t.memoizedProps&&ne===t.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=re),m.props=c,m.state=re,m.context=B,c=ce):(typeof m.componentDidUpdate!="function"||v===t.memoizedProps&&ne===t.memoizedState||(a.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===t.memoizedProps&&ne===t.memoizedState||(a.flags|=1024),c=!1)}return m=c,vd(t,a),c=(a.flags&128)!==0,m||c?(m=a.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:m.render(),a.flags|=1,t!==null&&c?(a.child=Gi(a,t.child,null,f),a.child=Gi(a,null,l,f)):Vn(t,a,l,f),a.memoizedState=m.state,t=a.child):t=Za(t,a,f),t}function Lb(t,a,l,c){return Bi(),a.flags|=256,Vn(t,a,l,c),a.child}var jm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Tm(t){return{baseLanes:t,cachePool:Tx()}}function Am(t,a,l){return t=t!==null?t.childLanes&~l:0,a&&(t|=Ts),t}function Ub(t,a,l){var c=a.pendingProps,f=!1,m=(a.flags&128)!==0,v;if((v=m)||(v=t!==null&&t.memoizedState===null?!1:(fn.current&2)!==0),v&&(f=!0,a.flags&=-129),v=(a.flags&32)!==0,a.flags&=-33,t===null){if(yt){if(f?Pr(a):Vr(),(t=Yt)?(t=Yy(t,Hs),t=t!==null&&t.data!=="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Cr!==null?{id:Ea,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},l=bx(t),l.return=a,a.child=l,On=a,Yt=null)):t=null,t===null)throw kr(a);return up(t)?a.lanes=32:a.lanes=536870912,null}var S=c.children;return c=c.fallback,f?(Vr(),f=a.mode,S=wd({mode:"hidden",children:S},f),c=Ui(c,f,l,null),S.return=a,c.return=a,S.sibling=c,a.child=S,c=a.child,c.memoizedState=Tm(l),c.childLanes=Am(t,v,l),a.memoizedState=jm,pc(null,c)):(Pr(a),Cm(a,S))}var B=t.memoizedState;if(B!==null&&(S=B.dehydrated,S!==null)){if(m)a.flags&256?(Pr(a),a.flags&=-257,a=Rm(t,a,l)):a.memoizedState!==null?(Vr(),a.child=t.child,a.flags|=128,a=null):(Vr(),S=c.fallback,f=a.mode,c=wd({mode:"visible",children:c.children},f),S=Ui(S,f,l,null),S.flags|=2,c.return=a,S.return=a,c.sibling=S,a.child=c,Gi(a,t.child,null,l),c=a.child,c.memoizedState=Tm(l),c.childLanes=Am(t,v,l),a.memoizedState=jm,a=pc(null,c));else if(Pr(a),up(S)){if(v=S.nextSibling&&S.nextSibling.dataset,v)var te=v.dgst;v=te,c=Error(r(419)),c.stack="",c.digest=v,sc({value:c,source:null,stack:null}),a=Rm(t,a,l)}else if(_n||Ul(t,a,l,!1),v=(l&t.childLanes)!==0,_n||v){if(v=Ft,v!==null&&(c=Ei(v,l),c!==0&&c!==B.retryLane))throw B.retryLane=c,Li(t,c),us(v,t,c),Em;cp(S)||Rd(),a=Rm(t,a,l)}else cp(S)?(a.flags|=192,a.child=t.child,a=null):(t=B.treeContext,Yt=Gs(S.nextSibling),On=a,yt=!0,Rr=null,Hs=!1,t!==null&&wx(a,t),a=Cm(a,c.children),a.flags|=4096);return a}return f?(Vr(),S=c.fallback,f=a.mode,B=t.child,te=B.sibling,c=Ya(B,{mode:"hidden",children:c.children}),c.subtreeFlags=B.subtreeFlags&65011712,te!==null?S=Ya(te,S):(S=Ui(S,f,l,null),S.flags|=2),S.return=a,c.return=a,c.sibling=S,a.child=c,pc(null,c),c=a.child,S=t.child.memoizedState,S===null?S=Tm(l):(f=S.cachePool,f!==null?(B=vn._currentValue,f=f.parent!==B?{parent:B,pool:B}:f):f=Tx(),S={baseLanes:S.baseLanes|l,cachePool:f}),c.memoizedState=S,c.childLanes=Am(t,v,l),a.memoizedState=jm,pc(t.child,c)):(Pr(a),l=t.child,t=l.sibling,l=Ya(l,{mode:"visible",children:c.children}),l.return=a,l.sibling=null,t!==null&&(v=a.deletions,v===null?(a.deletions=[t],a.flags|=16):v.push(t)),a.child=l,a.memoizedState=null,l)}function Cm(t,a){return a=wd({mode:"visible",children:a},t.mode),a.return=t,t.child=a}function wd(t,a){return t=Ns(22,t,null,a),t.lanes=0,t}function Rm(t,a,l){return Gi(a,t.child,null,l),t=Cm(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function Bb(t,a,l){t.lanes|=a;var c=t.alternate;c!==null&&(c.lanes|=a),$f(t.return,a,l)}function km(t,a,l,c,f,m){var v=t.memoizedState;v===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:f,treeForkCount:m}:(v.isBackwards=a,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=l,v.tailMode=f,v.treeForkCount=m)}function zb(t,a,l){var c=a.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var v=fn.current,S=(v&2)!==0;if(S?(v=v&1|2,a.flags|=128):v&=1,le(fn,v),Vn(t,a,c,l),c=yt?nc:0,!S&&t!==null&&(t.flags&128)!==0)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Bb(t,l,a);else if(t.tag===19)Bb(t,l,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(f){case"forwards":for(l=a.child,f=null;l!==null;)t=l.alternate,t!==null&&cd(t)===null&&(f=l),l=l.sibling;l=f,l===null?(f=a.child,a.child=null):(f=l.sibling,l.sibling=null),km(a,!1,f,l,m,c);break;case"backwards":case"unstable_legacy-backwards":for(l=null,f=a.child,a.child=null;f!==null;){if(t=f.alternate,t!==null&&cd(t)===null){a.child=f;break}t=f.sibling,f.sibling=l,l=f,f=t}km(a,!0,l,null,m,c);break;case"together":km(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function Za(t,a,l){if(t!==null&&(a.dependencies=t.dependencies),Br|=a.lanes,(l&a.childLanes)===0)if(t!==null){if(Ul(t,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(t!==null&&a.child!==t.child)throw Error(r(153));if(a.child!==null){for(t=a.child,l=Ya(t,t.pendingProps),a.child=l,l.return=a;t.sibling!==null;)t=t.sibling,l=l.sibling=Ya(t,t.pendingProps),l.return=a;l.sibling=null}return a.child}function Im(t,a){return(t.lanes&a)!==0?!0:(t=t.dependencies,!!(t!==null&&td(t)))}function WE(t,a,l){switch(a.tag){case 3:Ue(a,a.stateNode.containerInfo),Ir(a,vn,t.memoizedState.cache),Bi();break;case 27:case 5:We(a);break;case 4:Ue(a,a.stateNode.containerInfo);break;case 10:Ir(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,sm(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Pr(a),a.flags|=128,null):(l&a.child.childLanes)!==0?Ub(t,a,l):(Pr(a),t=Za(t,a,l),t!==null?t.sibling:null);Pr(a);break;case 19:var f=(t.flags&128)!==0;if(c=(l&a.childLanes)!==0,c||(Ul(t,a,l,!1),c=(l&a.childLanes)!==0),f){if(c)return zb(t,a,l);a.flags|=128}if(f=a.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),le(fn,fn.current),c)break;return null;case 22:return a.lanes=0,Db(t,a,l,a.pendingProps);case 24:Ir(a,vn,t.memoizedState.cache)}return Za(t,a,l)}function qb(t,a,l){if(t!==null)if(t.memoizedProps!==a.pendingProps)_n=!0;else{if(!Im(t,l)&&(a.flags&128)===0)return _n=!1,WE(t,a,l);_n=(t.flags&131072)!==0}else _n=!1,yt&&(a.flags&1048576)!==0&&vx(a,nc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(t=Hi(a.elementType),a.type=t,typeof t=="function")Vf(t)?(c=Wi(t,c),a.tag=1,a=Vb(null,a,t,c,l)):(a.tag=0,a=Sm(null,a,t,c,l));else{if(t!=null){var f=t.$$typeof;if(f===fe){a.tag=11,a=Rb(null,a,t,c,l);break e}else if(f===j){a.tag=14,a=kb(null,a,t,c,l);break e}}throw a=q(t)||t,Error(r(306,a,""))}}return a;case 0:return Sm(t,a,a.type,a.pendingProps,l);case 1:return c=a.type,f=Wi(c,a.pendingProps),Vb(t,a,c,f,l);case 3:e:{if(Ue(a,a.stateNode.containerInfo),t===null)throw Error(r(387));c=a.pendingProps;var m=a.memoizedState;f=m.element,Jf(t,a),uc(a,c,null,l);var v=a.memoizedState;if(c=v.cache,Ir(a,vn,c),c!==m.cache&&Gf(a,[vn],l,!0),cc(),c=v.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:v.cache},a.updateQueue.baseState=m,a.memoizedState=m,a.flags&256){a=Lb(t,a,c,l);break e}else if(c!==f){f=zs(Error(r(424)),a),sc(f),a=Lb(t,a,c,l);break e}else for(t=a.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,Yt=Gs(t.firstChild),On=a,yt=!0,Rr=null,Hs=!0,l=Dx(a,null,c,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Bi(),c===f){a=Za(t,a,l);break e}Vn(t,a,c,l)}a=a.child}return a;case 26:return vd(t,a),t===null?(l=Zy(a.type,null,a.pendingProps,null))?a.memoizedState=l:yt||(l=a.type,t=a.pendingProps,c=Vd(Re.current).createElement(l),c[nn]=a,c[xn]=t,Ln(c,l,t),bn(c),a.stateNode=c):a.memoizedState=Zy(a.type,t.memoizedProps,a.pendingProps,t.memoizedState),null;case 27:return We(a),t===null&&yt&&(c=a.stateNode=Qy(a.type,a.pendingProps,Re.current),On=a,Hs=!0,f=Yt,$r(a.type)?(dp=f,Yt=Gs(c.firstChild)):Yt=f),Vn(t,a,a.pendingProps.children,l),vd(t,a),t===null&&(a.flags|=4194304),a.child;case 5:return t===null&&yt&&((f=c=Yt)&&(c=ES(c,a.type,a.pendingProps,Hs),c!==null?(a.stateNode=c,On=a,Yt=Gs(c.firstChild),Hs=!1,f=!0):f=!1),f||kr(a)),We(a),f=a.type,m=a.pendingProps,v=t!==null?t.memoizedProps:null,c=m.children,ip(f,m)?c=null:v!==null&&ip(f,v)&&(a.flags|=32),a.memoizedState!==null&&(f=rm(t,a,UE,null,null,l),Rc._currentValue=f),vd(t,a),Vn(t,a,c,l),a.child;case 6:return t===null&&yt&&((t=l=Yt)&&(l=SS(l,a.pendingProps,Hs),l!==null?(a.stateNode=l,On=a,Yt=null,t=!0):t=!1),t||kr(a)),null;case 13:return Ub(t,a,l);case 4:return Ue(a,a.stateNode.containerInfo),c=a.pendingProps,t===null?a.child=Gi(a,null,c,l):Vn(t,a,c,l),a.child;case 11:return Rb(t,a,a.type,a.pendingProps,l);case 7:return Vn(t,a,a.pendingProps,l),a.child;case 8:return Vn(t,a,a.pendingProps.children,l),a.child;case 12:return Vn(t,a,a.pendingProps.children,l),a.child;case 10:return c=a.pendingProps,Ir(a,a.type,c.value),Vn(t,a,c.children,l),a.child;case 9:return f=a.type._context,c=a.pendingProps.children,qi(a),f=Pn(f),c=c(f),a.flags|=1,Vn(t,a,c,l),a.child;case 14:return kb(t,a,a.type,a.pendingProps,l);case 15:return Ib(t,a,a.type,a.pendingProps,l);case 19:return zb(t,a,l);case 31:return YE(t,a,l);case 22:return Db(t,a,l,a.pendingProps);case 24:return qi(a),c=Pn(vn),t===null?(f=Kf(),f===null&&(f=Ft,m=Yf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=l),f=m),a.memoizedState={parent:c,cache:f},Xf(a),Ir(a,vn,f)):((t.lanes&l)!==0&&(Jf(t,a),uc(a,null,null,l),cc()),f=t.memoizedState,m=a.memoizedState,f.parent!==c?(f={parent:c,cache:c},a.memoizedState=f,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=f),Ir(a,vn,c)):(c=m.cache,Ir(a,vn,c),c!==f.cache&&Gf(a,[vn],l,!0))),Vn(t,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(r(156,a.tag))}function er(t){t.flags|=4}function Dm(t,a,l,c,f){if((a=(t.mode&32)!==0)&&(a=!1),a){if(t.flags|=16777216,(f&335544128)===f)if(t.stateNode.complete)t.flags|=8192;else if(py())t.flags|=8192;else throw $i=rd,Qf}else t.flags&=-16777217}function Fb(t,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!av(a))if(py())t.flags|=8192;else throw $i=rd,Qf}function _d(t,a){a!==null&&(t.flags|=4),t.flags&16384&&(a=t.tag!==22?Ge():536870912,t.lanes|=a,Xl|=a)}function gc(t,a){if(!yt)switch(t.tailMode){case"hidden":a=t.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?t.tail=null:l.sibling=null;break;case"collapsed":l=t.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Wt(t){var a=t.alternate!==null&&t.alternate.child===t.child,l=0,c=0;if(a)for(var f=t.child;f!==null;)l|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)l|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=c,t.childLanes=l,a}function KE(t,a,l){var c=a.pendingProps;switch(zf(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(a),null;case 1:return Wt(a),null;case 3:return l=a.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Qa(vn),Be(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(t===null||t.child===null)&&(Ll(a)?er(a):t===null||t.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Ff())),Wt(a),null;case 26:var f=a.type,m=a.memoizedState;return t===null?(er(a),m!==null?(Wt(a),Fb(a,m)):(Wt(a),Dm(a,f,null,c,l))):m?m!==t.memoizedState?(er(a),Wt(a),Fb(a,m)):(Wt(a),a.flags&=-16777217):(t=t.memoizedProps,t!==c&&er(a),Wt(a),Dm(a,f,t,c,l)),null;case 27:if(Q(a),l=Re.current,f=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==c&&er(a);else{if(!c){if(a.stateNode===null)throw Error(r(166));return Wt(a),null}t=xe.current,Ll(a)?_x(a):(t=Qy(f,c,l),a.stateNode=t,er(a))}return Wt(a),null;case 5:if(Q(a),f=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==c&&er(a);else{if(!c){if(a.stateNode===null)throw Error(r(166));return Wt(a),null}if(m=xe.current,Ll(a))_x(a);else{var v=Vd(Re.current);switch(m){case 1:m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=v.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?v.createElement("select",{is:c.is}):v.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?v.createElement(f,{is:c.is}):v.createElement(f)}}m[nn]=a,m[xn]=c;e:for(v=a.child;v!==null;){if(v.tag===5||v.tag===6)m.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===a)break e;for(;v.sibling===null;){if(v.return===null||v.return===a)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}a.stateNode=m;e:switch(Ln(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&er(a)}}return Wt(a),Dm(a,a.type,t===null?null:t.memoizedProps,a.pendingProps,l),null;case 6:if(t&&a.stateNode!=null)t.memoizedProps!==c&&er(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(r(166));if(t=Re.current,Ll(a)){if(t=a.stateNode,l=a.memoizedProps,c=null,f=On,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}t[nn]=a,t=!!(t.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||Uy(t.nodeValue,l)),t||kr(a,!0)}else t=Vd(t).createTextNode(c),t[nn]=a,a.stateNode=t}return Wt(a),null;case 31:if(l=a.memoizedState,t===null||t.memoizedState!==null){if(c=Ll(a),l!==null){if(t===null){if(!c)throw Error(r(318));if(t=a.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(557));t[nn]=a}else Bi(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Wt(a),t=!1}else l=Ff(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=l),t=!0;if(!t)return a.flags&256?(Ss(a),a):(Ss(a),null);if((a.flags&128)!==0)throw Error(r(558))}return Wt(a),null;case 13:if(c=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(f=Ll(a),c!==null&&c.dehydrated!==null){if(t===null){if(!f)throw Error(r(318));if(f=a.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));f[nn]=a}else Bi(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Wt(a),f=!1}else f=Ff(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=f),f=!0;if(!f)return a.flags&256?(Ss(a),a):(Ss(a),null)}return Ss(a),(a.flags&128)!==0?(a.lanes=l,a):(l=c!==null,t=t!==null&&t.memoizedState!==null,l&&(c=a.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),l!==t&&l&&(a.child.flags|=8192),_d(a,a.updateQueue),Wt(a),null);case 4:return Be(),t===null&&tp(a.stateNode.containerInfo),Wt(a),null;case 10:return Qa(a.type),Wt(a),null;case 19:if(ee(fn),c=a.memoizedState,c===null)return Wt(a),null;if(f=(a.flags&128)!==0,m=c.rendering,m===null)if(f)gc(c,!1);else{if(an!==0||t!==null&&(t.flags&128)!==0)for(t=a.child;t!==null;){if(m=cd(t),m!==null){for(a.flags|=128,gc(c,!1),t=m.updateQueue,a.updateQueue=t,_d(a,t),a.subtreeFlags=0,t=l,l=a.child;l!==null;)xx(l,t),l=l.sibling;return le(fn,fn.current&1|2),yt&&Wa(a,c.treeForkCount),a.child}t=t.sibling}c.tail!==null&&_t()>Td&&(a.flags|=128,f=!0,gc(c,!1),a.lanes=4194304)}else{if(!f)if(t=cd(m),t!==null){if(a.flags|=128,f=!0,t=t.updateQueue,a.updateQueue=t,_d(a,t),gc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!yt)return Wt(a),null}else 2*_t()-c.renderingStartTime>Td&&l!==536870912&&(a.flags|=128,f=!0,gc(c,!1),a.lanes=4194304);c.isBackwards?(m.sibling=a.child,a.child=m):(t=c.last,t!==null?t.sibling=m:a.child=m,c.last=m)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=_t(),t.sibling=null,l=fn.current,le(fn,f?l&1|2:l&1),yt&&Wa(a,c.treeForkCount),t):(Wt(a),null);case 22:case 23:return Ss(a),nm(),c=a.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(l&536870912)!==0&&(a.flags&128)===0&&(Wt(a),a.subtreeFlags&6&&(a.flags|=8192)):Wt(a),l=a.updateQueue,l!==null&&_d(a,l.retryQueue),l=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==l&&(a.flags|=2048),t!==null&&ee(Fi),null;case 24:return l=null,t!==null&&(l=t.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Qa(vn),Wt(a),null;case 25:return null;case 30:return null}throw Error(r(156,a.tag))}function QE(t,a){switch(zf(a),a.tag){case 1:return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return Qa(vn),Be(),t=a.flags,(t&65536)!==0&&(t&128)===0?(a.flags=t&-65537|128,a):null;case 26:case 27:case 5:return Q(a),null;case 31:if(a.memoizedState!==null){if(Ss(a),a.alternate===null)throw Error(r(340));Bi()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 13:if(Ss(a),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(r(340));Bi()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return ee(fn),null;case 4:return Be(),null;case 10:return Qa(a.type),null;case 22:case 23:return Ss(a),nm(),t!==null&&ee(Fi),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 24:return Qa(vn),null;case 25:return null;default:return null}}function Hb(t,a){switch(zf(a),a.tag){case 3:Qa(vn),Be();break;case 26:case 27:case 5:Q(a);break;case 4:Be();break;case 31:a.memoizedState!==null&&Ss(a);break;case 13:Ss(a);break;case 19:ee(fn);break;case 10:Qa(a.type);break;case 22:case 23:Ss(a),nm(),t!==null&&ee(Fi);break;case 24:Qa(vn)}}function xc(t,a){try{var l=a.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var f=c.next;l=f;do{if((l.tag&t)===t){c=void 0;var m=l.create,v=l.inst;c=m(),v.destroy=c}l=l.next}while(l!==f)}}catch(S){Pt(a,a.return,S)}}function Lr(t,a,l){try{var c=a.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&t)===t){var v=c.inst,S=v.destroy;if(S!==void 0){v.destroy=void 0,f=a;var B=l,te=S;try{te()}catch(ce){Pt(f,B,ce)}}}c=c.next}while(c!==m)}}catch(ce){Pt(a,a.return,ce)}}function $b(t){var a=t.updateQueue;if(a!==null){var l=t.stateNode;try{Ox(a,l)}catch(c){Pt(t,t.return,c)}}}function Gb(t,a,l){l.props=Wi(t.type,t.memoizedProps),l.state=t.memoizedState;try{l.componentWillUnmount()}catch(c){Pt(t,a,c)}}function bc(t,a){try{var l=t.ref;if(l!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof l=="function"?t.refCleanup=l(c):l.current=c}}catch(f){Pt(t,a,f)}}function ja(t,a){var l=t.ref,c=t.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(f){Pt(t,a,f)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){Pt(t,a,f)}else l.current=null}function Yb(t){var a=t.type,l=t.memoizedProps,c=t.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(f){Pt(t,t.return,f)}}function Mm(t,a,l){try{var c=t.stateNode;bS(c,t.type,l,a),c[xn]=a}catch(f){Pt(t,t.return,f)}}function Wb(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&$r(t.type)||t.tag===4}function Om(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Wb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&$r(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pm(t,a,l){var c=t.tag;if(c===5||c===6)t=t.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(t,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(t),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=Js));else if(c!==4&&(c===27&&$r(t.type)&&(l=t.stateNode,a=null),t=t.child,t!==null))for(Pm(t,a,l),t=t.sibling;t!==null;)Pm(t,a,l),t=t.sibling}function Nd(t,a,l){var c=t.tag;if(c===5||c===6)t=t.stateNode,a?l.insertBefore(t,a):l.appendChild(t);else if(c!==4&&(c===27&&$r(t.type)&&(l=t.stateNode),t=t.child,t!==null))for(Nd(t,a,l),t=t.sibling;t!==null;)Nd(t,a,l),t=t.sibling}function Kb(t){var a=t.stateNode,l=t.memoizedProps;try{for(var c=t.type,f=a.attributes;f.length;)a.removeAttributeNode(f[0]);Ln(a,c,l),a[nn]=t,a[xn]=l}catch(m){Pt(t,t.return,m)}}var tr=!1,Nn=!1,Vm=!1,Qb=typeof WeakSet=="function"?WeakSet:Set,kn=null;function XE(t,a){if(t=t.containerInfo,ap=Hd,t=ox(t),Rf(t)){if("selectionStart"in t)var l={start:t.selectionStart,end:t.selectionEnd};else e:{l=(l=t.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{l.nodeType,m.nodeType}catch{l=null;break e}var v=0,S=-1,B=-1,te=0,ce=0,pe=t,ne=null;t:for(;;){for(var re;pe!==l||f!==0&&pe.nodeType!==3||(S=v+f),pe!==m||c!==0&&pe.nodeType!==3||(B=v+c),pe.nodeType===3&&(v+=pe.nodeValue.length),(re=pe.firstChild)!==null;)ne=pe,pe=re;for(;;){if(pe===t)break t;if(ne===l&&++te===f&&(S=v),ne===m&&++ce===c&&(B=v),(re=pe.nextSibling)!==null)break;pe=ne,ne=pe.parentNode}pe=re}l=S===-1||B===-1?null:{start:S,end:B}}else l=null}l=l||{start:0,end:0}}else l=null;for(rp={focusedElem:t,selectionRange:l},Hd=!1,kn=a;kn!==null;)if(a=kn,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,kn=t;else for(;kn!==null;){switch(a=kn,m=a.alternate,t=a.flags,a.tag){case 0:if((t&4)!==0&&(t=a.updateQueue,t=t!==null?t.events:null,t!==null))for(l=0;l<t.length;l++)f=t[l],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&m!==null){t=void 0,l=a,f=m.memoizedProps,m=m.memoizedState,c=l.stateNode;try{var De=Wi(l.type,f);t=c.getSnapshotBeforeUpdate(De,m),c.__reactInternalSnapshotBeforeUpdate=t}catch(Ye){Pt(l,l.return,Ye)}}break;case 3:if((t&1024)!==0){if(t=a.stateNode.containerInfo,l=t.nodeType,l===9)op(t);else if(l===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":op(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(r(163))}if(t=a.sibling,t!==null){t.return=a.return,kn=t;break}kn=a.return}}function Xb(t,a,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:sr(t,l),c&4&&xc(5,l);break;case 1:if(sr(t,l),c&4)if(t=l.stateNode,a===null)try{t.componentDidMount()}catch(v){Pt(l,l.return,v)}else{var f=Wi(l.type,a.memoizedProps);a=a.memoizedState;try{t.componentDidUpdate(f,a,t.__reactInternalSnapshotBeforeUpdate)}catch(v){Pt(l,l.return,v)}}c&64&&$b(l),c&512&&bc(l,l.return);break;case 3:if(sr(t,l),c&64&&(t=l.updateQueue,t!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{Ox(t,a)}catch(v){Pt(l,l.return,v)}}break;case 27:a===null&&c&4&&Kb(l);case 26:case 5:sr(t,l),a===null&&c&4&&Yb(l),c&512&&bc(l,l.return);break;case 12:sr(t,l);break;case 31:sr(t,l),c&4&&ey(t,l);break;case 13:sr(t,l),c&4&&ty(t,l),c&64&&(t=l.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(l=iS.bind(null,l),jS(t,l))));break;case 22:if(c=l.memoizedState!==null||tr,!c){a=a!==null&&a.memoizedState!==null||Nn,f=tr;var m=Nn;tr=c,(Nn=a)&&!m?ar(t,l,(l.subtreeFlags&8772)!==0):sr(t,l),tr=f,Nn=m}break;case 30:break;default:sr(t,l)}}function Jb(t){var a=t.alternate;a!==null&&(t.alternate=null,Jb(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&wl(a)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Xt=null,is=!1;function nr(t,a,l){for(l=l.child;l!==null;)Zb(t,a,l),l=l.sibling}function Zb(t,a,l){if(se&&typeof se.onCommitFiberUnmount=="function")try{se.onCommitFiberUnmount(H,l)}catch{}switch(l.tag){case 26:Nn||ja(l,a),nr(t,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Nn||ja(l,a);var c=Xt,f=is;$r(l.type)&&(Xt=l.stateNode,is=!1),nr(t,a,l),Tc(l.stateNode),Xt=c,is=f;break;case 5:Nn||ja(l,a);case 6:if(c=Xt,f=is,Xt=null,nr(t,a,l),Xt=c,is=f,Xt!==null)if(is)try{(Xt.nodeType===9?Xt.body:Xt.nodeName==="HTML"?Xt.ownerDocument.body:Xt).removeChild(l.stateNode)}catch(m){Pt(l,a,m)}else try{Xt.removeChild(l.stateNode)}catch(m){Pt(l,a,m)}break;case 18:Xt!==null&&(is?(t=Xt,$y(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,l.stateNode),ro(t)):$y(Xt,l.stateNode));break;case 4:c=Xt,f=is,Xt=l.stateNode.containerInfo,is=!0,nr(t,a,l),Xt=c,is=f;break;case 0:case 11:case 14:case 15:Lr(2,l,a),Nn||Lr(4,l,a),nr(t,a,l);break;case 1:Nn||(ja(l,a),c=l.stateNode,typeof c.componentWillUnmount=="function"&&Gb(l,a,c)),nr(t,a,l);break;case 21:nr(t,a,l);break;case 22:Nn=(c=Nn)||l.memoizedState!==null,nr(t,a,l),Nn=c;break;default:nr(t,a,l)}}function ey(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{ro(t)}catch(l){Pt(a,a.return,l)}}}function ty(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{ro(t)}catch(l){Pt(a,a.return,l)}}function JE(t){switch(t.tag){case 31:case 13:case 19:var a=t.stateNode;return a===null&&(a=t.stateNode=new Qb),a;case 22:return t=t.stateNode,a=t._retryCache,a===null&&(a=t._retryCache=new Qb),a;default:throw Error(r(435,t.tag))}}function Ed(t,a){var l=JE(t);a.forEach(function(c){if(!l.has(c)){l.add(c);var f=lS.bind(null,t,c);c.then(f,f)}})}function ls(t,a){var l=a.deletions;if(l!==null)for(var c=0;c<l.length;c++){var f=l[c],m=t,v=a,S=v;e:for(;S!==null;){switch(S.tag){case 27:if($r(S.type)){Xt=S.stateNode,is=!1;break e}break;case 5:Xt=S.stateNode,is=!1;break e;case 3:case 4:Xt=S.stateNode.containerInfo,is=!0;break e}S=S.return}if(Xt===null)throw Error(r(160));Zb(m,v,f),Xt=null,is=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)ny(a,t),a=a.sibling}var aa=null;function ny(t,a){var l=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:ls(a,t),os(t),c&4&&(Lr(3,t,t.return),xc(3,t),Lr(5,t,t.return));break;case 1:ls(a,t),os(t),c&512&&(Nn||l===null||ja(l,l.return)),c&64&&tr&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(l=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var f=aa;if(ls(a,t),os(t),c&512&&(Nn||l===null||ja(l,l.return)),c&4){var m=l!==null?l.memoizedState:null;if(c=t.memoizedState,l===null)if(c===null)if(t.stateNode===null){e:{c=t.type,l=t.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[ha]||m[nn]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Ln(m,c,l),m[nn]=t,bn(m),c=m;break e;case"link":var v=nv("link","href",f).get(c+(l.href||""));if(v){for(var S=0;S<v.length;S++)if(m=v[S],m.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&m.getAttribute("rel")===(l.rel==null?null:l.rel)&&m.getAttribute("title")===(l.title==null?null:l.title)&&m.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){v.splice(S,1);break t}}m=f.createElement(c),Ln(m,c,l),f.head.appendChild(m);break;case"meta":if(v=nv("meta","content",f).get(c+(l.content||""))){for(S=0;S<v.length;S++)if(m=v[S],m.getAttribute("content")===(l.content==null?null:""+l.content)&&m.getAttribute("name")===(l.name==null?null:l.name)&&m.getAttribute("property")===(l.property==null?null:l.property)&&m.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&m.getAttribute("charset")===(l.charSet==null?null:l.charSet)){v.splice(S,1);break t}}m=f.createElement(c),Ln(m,c,l),f.head.appendChild(m);break;default:throw Error(r(468,c))}m[nn]=t,bn(m),c=m}t.stateNode=c}else sv(f,t.type,t.stateNode);else t.stateNode=tv(f,c,t.memoizedProps);else m!==c?(m===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):m.count--,c===null?sv(f,t.type,t.stateNode):tv(f,c,t.memoizedProps)):c===null&&t.stateNode!==null&&Mm(t,t.memoizedProps,l.memoizedProps)}break;case 27:ls(a,t),os(t),c&512&&(Nn||l===null||ja(l,l.return)),l!==null&&c&4&&Mm(t,t.memoizedProps,l.memoizedProps);break;case 5:if(ls(a,t),os(t),c&512&&(Nn||l===null||ja(l,l.return)),t.flags&32){f=t.stateNode;try{rs(f,"")}catch(De){Pt(t,t.return,De)}}c&4&&t.stateNode!=null&&(f=t.memoizedProps,Mm(t,f,l!==null?l.memoizedProps:f)),c&1024&&(Vm=!0);break;case 6:if(ls(a,t),os(t),c&4){if(t.stateNode===null)throw Error(r(162));c=t.memoizedProps,l=t.stateNode;try{l.nodeValue=c}catch(De){Pt(t,t.return,De)}}break;case 3:if(Bd=null,f=aa,aa=Ld(a.containerInfo),ls(a,t),aa=f,os(t),c&4&&l!==null&&l.memoizedState.isDehydrated)try{ro(a.containerInfo)}catch(De){Pt(t,t.return,De)}Vm&&(Vm=!1,sy(t));break;case 4:c=aa,aa=Ld(t.stateNode.containerInfo),ls(a,t),os(t),aa=c;break;case 12:ls(a,t),os(t);break;case 31:ls(a,t),os(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Ed(t,c)));break;case 13:ls(a,t),os(t),t.child.flags&8192&&t.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(jd=_t()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Ed(t,c)));break;case 22:f=t.memoizedState!==null;var B=l!==null&&l.memoizedState!==null,te=tr,ce=Nn;if(tr=te||f,Nn=ce||B,ls(a,t),Nn=ce,tr=te,os(t),c&8192)e:for(a=t.stateNode,a._visibility=f?a._visibility&-2:a._visibility|1,f&&(l===null||B||tr||Nn||Ki(t)),l=null,a=t;;){if(a.tag===5||a.tag===26){if(l===null){B=l=a;try{if(m=B.stateNode,f)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{S=B.stateNode;var pe=B.memoizedProps.style,ne=pe!=null&&pe.hasOwnProperty("display")?pe.display:null;S.style.display=ne==null||typeof ne=="boolean"?"":(""+ne).trim()}}catch(De){Pt(B,B.return,De)}}}else if(a.tag===6){if(l===null){B=a;try{B.stateNode.nodeValue=f?"":B.memoizedProps}catch(De){Pt(B,B.return,De)}}}else if(a.tag===18){if(l===null){B=a;try{var re=B.stateNode;f?Gy(re,!0):Gy(B.stateNode,!1)}catch(De){Pt(B,B.return,De)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;a.sibling===null;){if(a.return===null||a.return===t)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=t.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,Ed(t,l))));break;case 19:ls(a,t),os(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Ed(t,c)));break;case 30:break;case 21:break;default:ls(a,t),os(t)}}function os(t){var a=t.flags;if(a&2){try{for(var l,c=t.return;c!==null;){if(Wb(c)){l=c;break}c=c.return}if(l==null)throw Error(r(160));switch(l.tag){case 27:var f=l.stateNode,m=Om(t);Nd(t,m,f);break;case 5:var v=l.stateNode;l.flags&32&&(rs(v,""),l.flags&=-33);var S=Om(t);Nd(t,S,v);break;case 3:case 4:var B=l.stateNode.containerInfo,te=Om(t);Pm(t,te,B);break;default:throw Error(r(161))}}catch(ce){Pt(t,t.return,ce)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function sy(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var a=t;sy(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),t=t.sibling}}function sr(t,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Xb(t,a.alternate,a),a=a.sibling}function Ki(t){for(t=t.child;t!==null;){var a=t;switch(a.tag){case 0:case 11:case 14:case 15:Lr(4,a,a.return),Ki(a);break;case 1:ja(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&Gb(a,a.return,l),Ki(a);break;case 27:Tc(a.stateNode);case 26:case 5:ja(a,a.return),Ki(a);break;case 22:a.memoizedState===null&&Ki(a);break;case 30:Ki(a);break;default:Ki(a)}t=t.sibling}}function ar(t,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,f=t,m=a,v=m.flags;switch(m.tag){case 0:case 11:case 15:ar(f,m,l),xc(4,m);break;case 1:if(ar(f,m,l),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(te){Pt(c,c.return,te)}if(c=m,f=c.updateQueue,f!==null){var S=c.stateNode;try{var B=f.shared.hiddenCallbacks;if(B!==null)for(f.shared.hiddenCallbacks=null,f=0;f<B.length;f++)Mx(B[f],S)}catch(te){Pt(c,c.return,te)}}l&&v&64&&$b(m),bc(m,m.return);break;case 27:Kb(m);case 26:case 5:ar(f,m,l),l&&c===null&&v&4&&Yb(m),bc(m,m.return);break;case 12:ar(f,m,l);break;case 31:ar(f,m,l),l&&v&4&&ey(f,m);break;case 13:ar(f,m,l),l&&v&4&&ty(f,m);break;case 22:m.memoizedState===null&&ar(f,m,l),bc(m,m.return);break;case 30:break;default:ar(f,m,l)}a=a.sibling}}function Lm(t,a){var l=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),t=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(t=a.memoizedState.cachePool.pool),t!==l&&(t!=null&&t.refCount++,l!=null&&ac(l))}function Um(t,a){t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&ac(t))}function ra(t,a,l,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ay(t,a,l,c),a=a.sibling}function ay(t,a,l,c){var f=a.flags;switch(a.tag){case 0:case 11:case 15:ra(t,a,l,c),f&2048&&xc(9,a);break;case 1:ra(t,a,l,c);break;case 3:ra(t,a,l,c),f&2048&&(t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&ac(t)));break;case 12:if(f&2048){ra(t,a,l,c),t=a.stateNode;try{var m=a.memoizedProps,v=m.id,S=m.onPostCommit;typeof S=="function"&&S(v,a.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(B){Pt(a,a.return,B)}}else ra(t,a,l,c);break;case 31:ra(t,a,l,c);break;case 13:ra(t,a,l,c);break;case 23:break;case 22:m=a.stateNode,v=a.alternate,a.memoizedState!==null?m._visibility&2?ra(t,a,l,c):yc(t,a):m._visibility&2?ra(t,a,l,c):(m._visibility|=2,Wl(t,a,l,c,(a.subtreeFlags&10256)!==0||!1)),f&2048&&Lm(v,a);break;case 24:ra(t,a,l,c),f&2048&&Um(a.alternate,a);break;default:ra(t,a,l,c)}}function Wl(t,a,l,c,f){for(f=f&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var m=t,v=a,S=l,B=c,te=v.flags;switch(v.tag){case 0:case 11:case 15:Wl(m,v,S,B,f),xc(8,v);break;case 23:break;case 22:var ce=v.stateNode;v.memoizedState!==null?ce._visibility&2?Wl(m,v,S,B,f):yc(m,v):(ce._visibility|=2,Wl(m,v,S,B,f)),f&&te&2048&&Lm(v.alternate,v);break;case 24:Wl(m,v,S,B,f),f&&te&2048&&Um(v.alternate,v);break;default:Wl(m,v,S,B,f)}a=a.sibling}}function yc(t,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=t,c=a,f=c.flags;switch(c.tag){case 22:yc(l,c),f&2048&&Lm(c.alternate,c);break;case 24:yc(l,c),f&2048&&Um(c.alternate,c);break;default:yc(l,c)}a=a.sibling}}var vc=8192;function Kl(t,a,l){if(t.subtreeFlags&vc)for(t=t.child;t!==null;)ry(t,a,l),t=t.sibling}function ry(t,a,l){switch(t.tag){case 26:Kl(t,a,l),t.flags&vc&&t.memoizedState!==null&&LS(l,aa,t.memoizedState,t.memoizedProps);break;case 5:Kl(t,a,l);break;case 3:case 4:var c=aa;aa=Ld(t.stateNode.containerInfo),Kl(t,a,l),aa=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=vc,vc=16777216,Kl(t,a,l),vc=c):Kl(t,a,l));break;default:Kl(t,a,l)}}function iy(t){var a=t.alternate;if(a!==null&&(t=a.child,t!==null)){a.child=null;do a=t.sibling,t.sibling=null,t=a;while(t!==null)}}function wc(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];kn=c,oy(c,t)}iy(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ly(t),t=t.sibling}function ly(t){switch(t.tag){case 0:case 11:case 15:wc(t),t.flags&2048&&Lr(9,t,t.return);break;case 3:wc(t);break;case 12:wc(t);break;case 22:var a=t.stateNode;t.memoizedState!==null&&a._visibility&2&&(t.return===null||t.return.tag!==13)?(a._visibility&=-3,Sd(t)):wc(t);break;default:wc(t)}}function Sd(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];kn=c,oy(c,t)}iy(t)}for(t=t.child;t!==null;){switch(a=t,a.tag){case 0:case 11:case 15:Lr(8,a,a.return),Sd(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,Sd(a));break;default:Sd(a)}t=t.sibling}}function oy(t,a){for(;kn!==null;){var l=kn;switch(l.tag){case 0:case 11:case 15:Lr(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:ac(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,kn=c;else e:for(l=t;kn!==null;){c=kn;var f=c.sibling,m=c.return;if(Jb(c),c===l){kn=null;break e}if(f!==null){f.return=m,kn=f;break e}kn=m}}}var ZE={getCacheForType:function(t){var a=Pn(vn),l=a.data.get(t);return l===void 0&&(l=t(),a.data.set(t,l)),l},cacheSignal:function(){return Pn(vn).controller.signal}},eS=typeof WeakMap=="function"?WeakMap:Map,Ct=0,Ft=null,dt=null,mt=0,Ot=0,js=null,Ur=!1,Ql=!1,Bm=!1,rr=0,an=0,Br=0,Qi=0,zm=0,Ts=0,Xl=0,_c=null,cs=null,qm=!1,jd=0,cy=0,Td=1/0,Ad=null,zr=null,An=0,qr=null,Jl=null,ir=0,Fm=0,Hm=null,uy=null,Nc=0,$m=null;function As(){return(Ct&2)!==0&&mt!==0?mt&-mt:k.T!==null?Xm():Si()}function dy(){if(Ts===0)if((mt&536870912)===0||yt){var t=me;me<<=1,(me&3932160)===0&&(me=262144),Ts=t}else Ts=536870912;return t=Es.current,t!==null&&(t.flags|=32),Ts}function us(t,a,l){(t===Ft&&(Ot===2||Ot===9)||t.cancelPendingCommit!==null)&&(Zl(t,0),Fr(t,mt,Ts,!1)),tn(t,l),((Ct&2)===0||t!==Ft)&&(t===Ft&&((Ct&2)===0&&(Qi|=l),an===4&&Fr(t,mt,Ts,!1)),Ta(t))}function hy(t,a,l){if((Ct&6)!==0)throw Error(r(327));var c=!l&&(a&127)===0&&(a&t.expiredLanes)===0||Et(t,a),f=c?sS(t,a):Ym(t,a,!0),m=c;do{if(f===0){Ql&&!c&&Fr(t,a,0,!1);break}else{if(l=t.current.alternate,m&&!tS(l)){f=Ym(t,a,!1),m=!1;continue}if(f===2){if(m=a,t.errorRecoveryDisabledLanes&m)var v=0;else v=t.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){a=v;e:{var S=t;f=_c;var B=S.current.memoizedState.isDehydrated;if(B&&(Zl(S,v).flags|=256),v=Ym(S,v,!1),v!==2){if(Bm&&!B){S.errorRecoveryDisabledLanes|=m,Qi|=m,f=4;break e}m=cs,cs=f,m!==null&&(cs===null?cs=m:cs.push.apply(cs,m))}f=v}if(m=!1,f!==2)continue}}if(f===1){Zl(t,0),Fr(t,a,0,!0);break}e:{switch(c=t,m=f,m){case 0:case 1:throw Error(r(345));case 4:if((a&4194048)!==a)break;case 6:Fr(c,a,Ts,!Ur);break e;case 2:cs=null;break;case 3:case 5:break;default:throw Error(r(329))}if((a&62914560)===a&&(f=jd+300-_t(),10<f)){if(Fr(c,a,Ts,!Ur),tt(c,0,!0)!==0)break e;ir=a,c.timeoutHandle=Fy(fy.bind(null,c,l,cs,Ad,qm,a,Ts,Qi,Xl,Ur,m,"Throttled",-0,0),f);break e}fy(c,l,cs,Ad,qm,a,Ts,Qi,Xl,Ur,m,null,-0,0)}}break}while(!0);Ta(t)}function fy(t,a,l,c,f,m,v,S,B,te,ce,pe,ne,re){if(t.timeoutHandle=-1,pe=a.subtreeFlags,pe&8192||(pe&16785408)===16785408){pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Js},ry(a,m,pe);var De=(m&62914560)===m?jd-_t():(m&4194048)===m?cy-_t():0;if(De=US(pe,De),De!==null){ir=m,t.cancelPendingCommit=De(wy.bind(null,t,a,m,l,c,f,v,S,B,ce,pe,null,ne,re)),Fr(t,m,v,!te);return}}wy(t,a,m,l,c,f,v,S,B)}function tS(t){for(var a=t;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var f=l[c],m=f.getSnapshot;f=f.value;try{if(!_s(m(),f))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Fr(t,a,l,c){a&=~zm,a&=~Qi,t.suspendedLanes|=a,t.pingedLanes&=~a,c&&(t.warmLanes|=a),c=t.expirationTimes;for(var f=a;0<f;){var m=31-_e(f),v=1<<m;c[m]=-1,f&=~v}l!==0&&ns(t,l,a)}function Cd(){return(Ct&6)===0?(Ec(0),!1):!0}function Gm(){if(dt!==null){if(Ot===0)var t=dt.return;else t=dt,Ka=zi=null,om(t),Fl=null,ic=0,t=dt;for(;t!==null;)Hb(t.alternate,t),t=t.return;dt=null}}function Zl(t,a){var l=t.timeoutHandle;l!==-1&&(t.timeoutHandle=-1,wS(l)),l=t.cancelPendingCommit,l!==null&&(t.cancelPendingCommit=null,l()),ir=0,Gm(),Ft=t,dt=l=Ya(t.current,null),mt=a,Ot=0,js=null,Ur=!1,Ql=Et(t,a),Bm=!1,Xl=Ts=zm=Qi=Br=an=0,cs=_c=null,qm=!1,(a&8)!==0&&(a|=a&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=a;0<c;){var f=31-_e(c),m=1<<f;a|=t[f],c&=~m}return rr=a,Qu(),l}function my(t,a){lt=null,k.H=mc,a===ql||a===ad?(a=Rx(),Ot=3):a===Qf?(a=Rx(),Ot=4):Ot=a===Em?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,js=a,dt===null&&(an=1,bd(t,zs(a,t.current)))}function py(){var t=Es.current;return t===null?!0:(mt&4194048)===mt?$s===null:(mt&62914560)===mt||(mt&536870912)!==0?t===$s:!1}function gy(){var t=k.H;return k.H=mc,t===null?mc:t}function xy(){var t=k.A;return k.A=ZE,t}function Rd(){an=4,Ur||(mt&4194048)!==mt&&Es.current!==null||(Ql=!0),(Br&134217727)===0&&(Qi&134217727)===0||Ft===null||Fr(Ft,mt,Ts,!1)}function Ym(t,a,l){var c=Ct;Ct|=2;var f=gy(),m=xy();(Ft!==t||mt!==a)&&(Ad=null,Zl(t,a)),a=!1;var v=an;e:do try{if(Ot!==0&&dt!==null){var S=dt,B=js;switch(Ot){case 8:Gm(),v=6;break e;case 3:case 2:case 9:case 6:Es.current===null&&(a=!0);var te=Ot;if(Ot=0,js=null,eo(t,S,B,te),l&&Ql){v=0;break e}break;default:te=Ot,Ot=0,js=null,eo(t,S,B,te)}}nS(),v=an;break}catch(ce){my(t,ce)}while(!0);return a&&t.shellSuspendCounter++,Ka=zi=null,Ct=c,k.H=f,k.A=m,dt===null&&(Ft=null,mt=0,Qu()),v}function nS(){for(;dt!==null;)by(dt)}function sS(t,a){var l=Ct;Ct|=2;var c=gy(),f=xy();Ft!==t||mt!==a?(Ad=null,Td=_t()+500,Zl(t,a)):Ql=Et(t,a);e:do try{if(Ot!==0&&dt!==null){a=dt;var m=js;t:switch(Ot){case 1:Ot=0,js=null,eo(t,a,m,1);break;case 2:case 9:if(Ax(m)){Ot=0,js=null,yy(a);break}a=function(){Ot!==2&&Ot!==9||Ft!==t||(Ot=7),Ta(t)},m.then(a,a);break e;case 3:Ot=7;break e;case 4:Ot=5;break e;case 7:Ax(m)?(Ot=0,js=null,yy(a)):(Ot=0,js=null,eo(t,a,m,7));break;case 5:var v=null;switch(dt.tag){case 26:v=dt.memoizedState;case 5:case 27:var S=dt;if(v?av(v):S.stateNode.complete){Ot=0,js=null;var B=S.sibling;if(B!==null)dt=B;else{var te=S.return;te!==null?(dt=te,kd(te)):dt=null}break t}}Ot=0,js=null,eo(t,a,m,5);break;case 6:Ot=0,js=null,eo(t,a,m,6);break;case 8:Gm(),an=6;break e;default:throw Error(r(462))}}aS();break}catch(ce){my(t,ce)}while(!0);return Ka=zi=null,k.H=c,k.A=f,Ct=l,dt!==null?0:(Ft=null,mt=0,Qu(),an)}function aS(){for(;dt!==null&&!ut();)by(dt)}function by(t){var a=qb(t.alternate,t,rr);t.memoizedProps=t.pendingProps,a===null?kd(t):dt=a}function yy(t){var a=t,l=a.alternate;switch(a.tag){case 15:case 0:a=Pb(l,a,a.pendingProps,a.type,void 0,mt);break;case 11:a=Pb(l,a,a.pendingProps,a.type.render,a.ref,mt);break;case 5:om(a);default:Hb(l,a),a=dt=xx(a,rr),a=qb(l,a,rr)}t.memoizedProps=t.pendingProps,a===null?kd(t):dt=a}function eo(t,a,l,c){Ka=zi=null,om(a),Fl=null,ic=0;var f=a.return;try{if(GE(t,f,a,l,mt)){an=1,bd(t,zs(l,t.current)),dt=null;return}}catch(m){if(f!==null)throw dt=f,m;an=1,bd(t,zs(l,t.current)),dt=null;return}a.flags&32768?(yt||c===1?t=!0:Ql||(mt&536870912)!==0?t=!1:(Ur=t=!0,(c===2||c===9||c===3||c===6)&&(c=Es.current,c!==null&&c.tag===13&&(c.flags|=16384))),vy(a,t)):kd(a)}function kd(t){var a=t;do{if((a.flags&32768)!==0){vy(a,Ur);return}t=a.return;var l=KE(a.alternate,a,rr);if(l!==null){dt=l;return}if(a=a.sibling,a!==null){dt=a;return}dt=a=t}while(a!==null);an===0&&(an=5)}function vy(t,a){do{var l=QE(t.alternate,t);if(l!==null){l.flags&=32767,dt=l;return}if(l=t.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(t=t.sibling,t!==null)){dt=t;return}dt=t=l}while(t!==null);an=6,dt=null}function wy(t,a,l,c,f,m,v,S,B){t.cancelPendingCommit=null;do Id();while(An!==0);if((Ct&6)!==0)throw Error(r(327));if(a!==null){if(a===t.current)throw Error(r(177));if(m=a.lanes|a.childLanes,m|=Of,Fn(t,l,m,v,S,B),t===Ft&&(dt=Ft=null,mt=0),Jl=a,qr=t,ir=l,Fm=m,Hm=f,uy=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,oS(Qn,function(){return jy(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=k.T,k.T=null,f=Y.p,Y.p=2,v=Ct,Ct|=4;try{XE(t,a,l)}finally{Ct=v,Y.p=f,k.T=c}}An=1,_y(),Ny(),Ey()}}function _y(){if(An===1){An=0;var t=qr,a=Jl,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=k.T,k.T=null;var c=Y.p;Y.p=2;var f=Ct;Ct|=4;try{ny(a,t);var m=rp,v=ox(t.containerInfo),S=m.focusedElem,B=m.selectionRange;if(v!==S&&S&&S.ownerDocument&&lx(S.ownerDocument.documentElement,S)){if(B!==null&&Rf(S)){var te=B.start,ce=B.end;if(ce===void 0&&(ce=te),"selectionStart"in S)S.selectionStart=te,S.selectionEnd=Math.min(ce,S.value.length);else{var pe=S.ownerDocument||document,ne=pe&&pe.defaultView||window;if(ne.getSelection){var re=ne.getSelection(),De=S.textContent.length,Ye=Math.min(B.start,De),Bt=B.end===void 0?Ye:Math.min(B.end,De);!re.extend&&Ye>Bt&&(v=Bt,Bt=Ye,Ye=v);var W=ix(S,Ye),$=ix(S,Bt);if(W&&$&&(re.rangeCount!==1||re.anchorNode!==W.node||re.anchorOffset!==W.offset||re.focusNode!==$.node||re.focusOffset!==$.offset)){var Z=pe.createRange();Z.setStart(W.node,W.offset),re.removeAllRanges(),Ye>Bt?(re.addRange(Z),re.extend($.node,$.offset)):(Z.setEnd($.node,$.offset),re.addRange(Z))}}}}for(pe=[],re=S;re=re.parentNode;)re.nodeType===1&&pe.push({element:re,left:re.scrollLeft,top:re.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<pe.length;S++){var de=pe[S];de.element.scrollLeft=de.left,de.element.scrollTop=de.top}}Hd=!!ap,rp=ap=null}finally{Ct=f,Y.p=c,k.T=l}}t.current=a,An=2}}function Ny(){if(An===2){An=0;var t=qr,a=Jl,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=k.T,k.T=null;var c=Y.p;Y.p=2;var f=Ct;Ct|=4;try{Xb(t,a.alternate,a)}finally{Ct=f,Y.p=c,k.T=l}}An=3}}function Ey(){if(An===4||An===3){An=0,Kt();var t=qr,a=Jl,l=ir,c=uy;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?An=5:(An=0,Jl=qr=null,Sy(t,t.pendingLanes));var f=t.pendingLanes;if(f===0&&(zr=null),dn(l),a=a.stateNode,se&&typeof se.onCommitFiberRoot=="function")try{se.onCommitFiberRoot(H,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=k.T,f=Y.p,Y.p=2,k.T=null;try{for(var m=t.onRecoverableError,v=0;v<c.length;v++){var S=c[v];m(S.value,{componentStack:S.stack})}}finally{k.T=a,Y.p=f}}(ir&3)!==0&&Id(),Ta(t),f=t.pendingLanes,(l&261930)!==0&&(f&42)!==0?t===$m?Nc++:(Nc=0,$m=t):Nc=0,Ec(0)}}function Sy(t,a){(t.pooledCacheLanes&=a)===0&&(a=t.pooledCache,a!=null&&(t.pooledCache=null,ac(a)))}function Id(){return _y(),Ny(),Ey(),jy()}function jy(){if(An!==5)return!1;var t=qr,a=Fm;Fm=0;var l=dn(ir),c=k.T,f=Y.p;try{Y.p=32>l?32:l,k.T=null,l=Hm,Hm=null;var m=qr,v=ir;if(An=0,Jl=qr=null,ir=0,(Ct&6)!==0)throw Error(r(331));var S=Ct;if(Ct|=4,ly(m.current),ay(m,m.current,v,l),Ct=S,Ec(0,!1),se&&typeof se.onPostCommitFiberRoot=="function")try{se.onPostCommitFiberRoot(H,m)}catch{}return!0}finally{Y.p=f,k.T=c,Sy(t,a)}}function Ty(t,a,l){a=zs(l,a),a=Nm(t.stateNode,a,2),t=Or(t,a,2),t!==null&&(tn(t,2),Ta(t))}function Pt(t,a,l){if(t.tag===3)Ty(t,t,l);else for(;a!==null;){if(a.tag===3){Ty(a,t,l);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(zr===null||!zr.has(c))){t=zs(l,t),l=Ab(2),c=Or(a,l,2),c!==null&&(Cb(l,c,a,t),tn(c,2),Ta(c));break}}a=a.return}}function Wm(t,a,l){var c=t.pingCache;if(c===null){c=t.pingCache=new eS;var f=new Set;c.set(a,f)}else f=c.get(a),f===void 0&&(f=new Set,c.set(a,f));f.has(l)||(Bm=!0,f.add(l),t=rS.bind(null,t,a,l),a.then(t,t))}function rS(t,a,l){var c=t.pingCache;c!==null&&c.delete(a),t.pingedLanes|=t.suspendedLanes&l,t.warmLanes&=~l,Ft===t&&(mt&l)===l&&(an===4||an===3&&(mt&62914560)===mt&&300>_t()-jd?(Ct&2)===0&&Zl(t,0):zm|=l,Xl===mt&&(Xl=0)),Ta(t)}function Ay(t,a){a===0&&(a=Ge()),t=Li(t,a),t!==null&&(tn(t,a),Ta(t))}function iS(t){var a=t.memoizedState,l=0;a!==null&&(l=a.retryLane),Ay(t,l)}function lS(t,a){var l=0;switch(t.tag){case 31:case 13:var c=t.stateNode,f=t.memoizedState;f!==null&&(l=f.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(a),Ay(t,l)}function oS(t,a){return Ae(t,a)}var Dd=null,to=null,Km=!1,Md=!1,Qm=!1,Hr=0;function Ta(t){t!==to&&t.next===null&&(to===null?Dd=to=t:to=to.next=t),Md=!0,Km||(Km=!0,uS())}function Ec(t,a){if(!Qm&&Md){Qm=!0;do for(var l=!1,c=Dd;c!==null;){if(t!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var v=c.suspendedLanes,S=c.pingedLanes;m=(1<<31-_e(42|t)+1)-1,m&=f&~(v&~S),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(l=!0,Iy(c,m))}else m=mt,m=tt(c,c===Ft?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Et(c,m)||(l=!0,Iy(c,m));c=c.next}while(l);Qm=!1}}function cS(){Cy()}function Cy(){Md=Km=!1;var t=0;Hr!==0&&vS()&&(t=Hr);for(var a=_t(),l=null,c=Dd;c!==null;){var f=c.next,m=Ry(c,a);m===0?(c.next=null,l===null?Dd=f:l.next=f,f===null&&(to=l)):(l=c,(t!==0||(m&3)!==0)&&(Md=!0)),c=f}An!==0&&An!==5||Ec(t),Hr!==0&&(Hr=0)}function Ry(t,a){for(var l=t.suspendedLanes,c=t.pingedLanes,f=t.expirationTimes,m=t.pendingLanes&-62914561;0<m;){var v=31-_e(m),S=1<<v,B=f[v];B===-1?((S&l)===0||(S&c)!==0)&&(f[v]=Le(S,a)):B<=a&&(t.expiredLanes|=S),m&=~S}if(a=Ft,l=mt,l=tt(t,t===a?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,l===0||t===a&&(Ot===2||Ot===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&Pe(c),t.callbackNode=null,t.callbackPriority=0;if((l&3)===0||Et(t,l)){if(a=l&-l,a===t.callbackPriority)return a;switch(c!==null&&Pe(c),dn(l)){case 2:case 8:l=Rt;break;case 32:l=Qn;break;case 268435456:l=bs;break;default:l=Qn}return c=ky.bind(null,t),l=Ae(l,c),t.callbackPriority=a,t.callbackNode=l,a}return c!==null&&c!==null&&Pe(c),t.callbackPriority=2,t.callbackNode=null,2}function ky(t,a){if(An!==0&&An!==5)return t.callbackNode=null,t.callbackPriority=0,null;var l=t.callbackNode;if(Id()&&t.callbackNode!==l)return null;var c=mt;return c=tt(t,t===Ft?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(hy(t,c,a),Ry(t,_t()),t.callbackNode!=null&&t.callbackNode===l?ky.bind(null,t):null)}function Iy(t,a){if(Id())return null;hy(t,a,!0)}function uS(){_S(function(){(Ct&6)!==0?Ae(Tn,cS):Cy()})}function Xm(){if(Hr===0){var t=Bl;t===0&&(t=ze,ze<<=1,(ze&261888)===0&&(ze=256)),Hr=t}return Hr}function Dy(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Sl(""+t)}function My(t,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,t.id&&l.setAttribute("form",t.id),a.parentNode.insertBefore(l,a),t=new FormData(t),l.parentNode.removeChild(l),t}function dS(t,a,l,c,f){if(a==="submit"&&l&&l.stateNode===f){var m=Dy((f[xn]||null).action),v=c.submitter;v&&(a=(a=v[xn]||null)?Dy(a.formAction):v.getAttribute("formAction"),a!==null&&(m=a,v=null));var S=new va("action","action",null,c,f);t.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Hr!==0){var B=v?My(f,v):new FormData(f);xm(l,{pending:!0,data:B,method:f.method,action:m},null,B)}}else typeof m=="function"&&(S.preventDefault(),B=v?My(f,v):new FormData(f),xm(l,{pending:!0,data:B,method:f.method,action:m},m,B))},currentTarget:f}]})}}for(var Jm=0;Jm<Mf.length;Jm++){var Zm=Mf[Jm],hS=Zm.toLowerCase(),fS=Zm[0].toUpperCase()+Zm.slice(1);sa(hS,"on"+fS)}sa(dx,"onAnimationEnd"),sa(hx,"onAnimationIteration"),sa(fx,"onAnimationStart"),sa("dblclick","onDoubleClick"),sa("focusin","onFocus"),sa("focusout","onBlur"),sa(CE,"onTransitionRun"),sa(RE,"onTransitionStart"),sa(kE,"onTransitionCancel"),sa(mx,"onTransitionEnd"),ga("onMouseEnter",["mouseout","mouseover"]),ga("onMouseLeave",["mouseout","mouseover"]),ga("onPointerEnter",["pointerout","pointerover"]),ga("onPointerLeave",["pointerout","pointerover"]),pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),pa("onBeforeInput",["compositionend","keypress","textInput","paste"]),pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sc));function Oy(t,a){a=(a&4)!==0;for(var l=0;l<t.length;l++){var c=t[l],f=c.event;c=c.listeners;e:{var m=void 0;if(a)for(var v=c.length-1;0<=v;v--){var S=c[v],B=S.instance,te=S.currentTarget;if(S=S.listener,B!==m&&f.isPropagationStopped())break e;m=S,f.currentTarget=te;try{m(f)}catch(ce){Ku(ce)}f.currentTarget=null,m=B}else for(v=0;v<c.length;v++){if(S=c[v],B=S.instance,te=S.currentTarget,S=S.listener,B!==m&&f.isPropagationStopped())break e;m=S,f.currentTarget=te;try{m(f)}catch(ce){Ku(ce)}f.currentTarget=null,m=B}}}}function ht(t,a){var l=a[ji];l===void 0&&(l=a[ji]=new Set);var c=t+"__bubble";l.has(c)||(Py(a,t,2,!1),l.add(c))}function ep(t,a,l){var c=0;a&&(c|=4),Py(l,t,c,a)}var Od="_reactListening"+Math.random().toString(36).slice(2);function tp(t){if(!t[Od]){t[Od]=!0,Vo.forEach(function(l){l!=="selectionchange"&&(mS.has(l)||ep(l,!1,t),ep(l,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[Od]||(a[Od]=!0,ep("selectionchange",!1,a))}}function Py(t,a,l,c){switch(dv(a)){case 2:var f=qS;break;case 8:f=FS;break;default:f=gp}l=f.bind(null,a,l,t),f=void 0,!Ri||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(f=!0),c?f!==void 0?t.addEventListener(a,l,{capture:!0,passive:f}):t.addEventListener(a,l,!0):f!==void 0?t.addEventListener(a,l,{passive:f}):t.addEventListener(a,l,!1)}function np(t,a,l,c,f){var m=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var S=c.stateNode.containerInfo;if(S===f)break;if(v===4)for(v=c.return;v!==null;){var B=v.tag;if((B===3||B===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;S!==null;){if(v=fa(S),v===null)return;if(B=v.tag,B===5||B===6||B===26||B===27){c=m=v;continue e}S=S.parentNode}}c=c.return}Sr(function(){var te=m,ce=Vs(l),pe=[];e:{var ne=px.get(t);if(ne!==void 0){var re=va,De=t;switch(t){case"keypress":if(Ii(l)===0)break e;case"keydown":case"keyup":re=Gu;break;case"focusin":De="focus",re=Mi;break;case"focusout":De="blur",re=Mi;break;case"beforeblur":case"afterblur":re=Mi;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=Qo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=Vu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=y;break;case dx:case hx:case fx:re=Uu;break;case mx:re=C;break;case"scroll":case"scrollend":re=Ko;break;case"wheel":re=ae;break;case"copy":case"cut":case"paste":re=Bu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=Ga;break;case"toggle":case"beforetoggle":re=it}var Ye=(a&4)!==0,Bt=!Ye&&(t==="scroll"||t==="scrollend"),W=Ye?ne!==null?ne+"Capture":null:ne;Ye=[];for(var $=te,Z;$!==null;){var de=$;if(Z=de.stateNode,de=de.tag,de!==5&&de!==26&&de!==27||Z===null||W===null||(de=Zs($,W),de!=null&&Ye.push(jc($,de,Z))),Bt)break;$=$.return}0<Ye.length&&(ne=new re(ne,De,null,l,ce),pe.push({event:ne,listeners:Ye}))}}if((a&7)===0){e:{if(ne=t==="mouseover"||t==="pointerover",re=t==="mouseout"||t==="pointerout",ne&&l!==Go&&(De=l.relatedTarget||l.fromElement)&&(fa(De)||De[ys]))break e;if((re||ne)&&(ne=ce.window===ce?ce:(ne=ce.ownerDocument)?ne.defaultView||ne.parentWindow:window,re?(De=l.relatedTarget||l.toElement,re=te,De=De?fa(De):null,De!==null&&(Bt=u(De),Ye=De.tag,De!==Bt||Ye!==5&&Ye!==27&&Ye!==6)&&(De=null)):(re=null,De=te),re!==De)){if(Ye=Qo,de="onMouseLeave",W="onMouseEnter",$="mouse",(t==="pointerout"||t==="pointerover")&&(Ye=Ga,de="onPointerLeave",W="onPointerEnter",$="pointer"),Bt=re==null?ne:vs(re),Z=De==null?ne:vs(De),ne=new Ye(de,$+"leave",re,l,ce),ne.target=Bt,ne.relatedTarget=Z,de=null,fa(ce)===te&&(Ye=new Ye(W,$+"enter",De,l,ce),Ye.target=Z,Ye.relatedTarget=Bt,de=Ye),Bt=de,re&&De)t:{for(Ye=pS,W=re,$=De,Z=0,de=W;de;de=Ye(de))Z++;de=0;for(var qe=$;qe;qe=Ye(qe))de++;for(;0<Z-de;)W=Ye(W),Z--;for(;0<de-Z;)$=Ye($),de--;for(;Z--;){if(W===$||$!==null&&W===$.alternate){Ye=W;break t}W=Ye(W),$=Ye($)}Ye=null}else Ye=null;re!==null&&Vy(pe,ne,re,Ye,!1),De!==null&&Bt!==null&&Vy(pe,Bt,De,Ye,!0)}}e:{if(ne=te?vs(te):window,re=ne.nodeName&&ne.nodeName.toLowerCase(),re==="select"||re==="input"&&ne.type==="file")var St=ex;else if(J0(ne))if(tx)St=jE;else{St=EE;var Oe=NE}else re=ne.nodeName,!re||re.toLowerCase()!=="input"||ne.type!=="checkbox"&&ne.type!=="radio"?te&&El(te.elementType)&&(St=ex):St=SE;if(St&&(St=St(t,te))){Z0(pe,St,l,ce);break e}Oe&&Oe(t,ne,te),t==="focusout"&&te&&ne.type==="number"&&te.memoizedProps.value!=null&&Fo(ne,"number",ne.value)}switch(Oe=te?vs(te):window,t){case"focusin":(J0(Oe)||Oe.contentEditable==="true")&&(Il=Oe,kf=te,tc=null);break;case"focusout":tc=kf=Il=null;break;case"mousedown":If=!0;break;case"contextmenu":case"mouseup":case"dragend":If=!1,cx(pe,l,ce);break;case"selectionchange":if(AE)break;case"keydown":case"keyup":cx(pe,l,ce)}var ct;if(At)e:{switch(t){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else kl?Oi(t,l)&&(pt="onCompositionEnd"):t==="keydown"&&l.keyCode===229&&(pt="onCompositionStart");pt&&(Na&&l.locale!=="ko"&&(kl||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&kl&&(ct=Wo()):(ya=ce,Yo="value"in ya?ya.value:ya.textContent,kl=!0)),Oe=Pd(te,pt),0<Oe.length&&(pt=new _a(pt,t,null,l,ce),pe.push({event:pt,listeners:Oe}),ct?pt.data=ct:(ct=Rl(l),ct!==null&&(pt.data=ct)))),(ct=Us?yE(t,l):vE(t,l))&&(pt=Pd(te,"onBeforeInput"),0<pt.length&&(Oe=new _a("onBeforeInput","beforeinput",null,l,ce),pe.push({event:Oe,listeners:pt}),Oe.data=ct)),dS(pe,t,te,l,ce)}Oy(pe,a)})}function jc(t,a,l){return{instance:t,listener:a,currentTarget:l}}function Pd(t,a){for(var l=a+"Capture",c=[];t!==null;){var f=t,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=Zs(t,l),f!=null&&c.unshift(jc(t,f,m)),f=Zs(t,a),f!=null&&c.push(jc(t,f,m))),t.tag===3)return c;t=t.return}return[]}function pS(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Vy(t,a,l,c,f){for(var m=a._reactName,v=[];l!==null&&l!==c;){var S=l,B=S.alternate,te=S.stateNode;if(S=S.tag,B!==null&&B===c)break;S!==5&&S!==26&&S!==27||te===null||(B=te,f?(te=Zs(l,m),te!=null&&v.unshift(jc(l,te,B))):f||(te=Zs(l,m),te!=null&&v.push(jc(l,te,B)))),l=l.return}v.length!==0&&t.push({event:a,listeners:v})}var gS=/\r\n?/g,xS=/\u0000|\uFFFD/g;function Ly(t){return(typeof t=="string"?t:""+t).replace(gS,`
`).replace(xS,"")}function Uy(t,a){return a=Ly(a),Ly(t)===a}function Ut(t,a,l,c,f,m){switch(l){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||rs(t,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&rs(t,""+c);break;case"className":ws(t,"class",c);break;case"tabIndex":ws(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ws(t,l,c);break;case"style":$o(t,c,m);break;case"data":if(a!=="object"){ws(t,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||l!=="href")){t.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(l);break}c=Sl(""+c),t.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(l==="formAction"?(a!=="input"&&Ut(t,a,"name",f.name,f,null),Ut(t,a,"formEncType",f.formEncType,f,null),Ut(t,a,"formMethod",f.formMethod,f,null),Ut(t,a,"formTarget",f.formTarget,f,null)):(Ut(t,a,"encType",f.encType,f,null),Ut(t,a,"method",f.method,f,null),Ut(t,a,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(l);break}c=Sl(""+c),t.setAttribute(l,c);break;case"onClick":c!=null&&(t.onclick=Js);break;case"onScroll":c!=null&&ht("scroll",t);break;case"onScrollEnd":c!=null&&ht("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(l=c.__html,l!=null){if(f.children!=null)throw Error(r(60));t.innerHTML=l}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}l=Sl(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(l,""+c):t.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(l,""):t.removeAttribute(l);break;case"capture":case"download":c===!0?t.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(l,c):t.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(l,c):t.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(l):t.setAttribute(l,c);break;case"popover":ht("beforetoggle",t),ht("toggle",t),_l(t,"popover",c);break;case"xlinkActuate":yn(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":yn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":yn(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":yn(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":yn(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":yn(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":yn(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":yn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":yn(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":_l(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Pu.get(l)||l,_l(t,l,c))}}function sp(t,a,l,c,f,m){switch(l){case"style":$o(t,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(l=c.__html,l!=null){if(f.children!=null)throw Error(r(60));t.innerHTML=l}}break;case"children":typeof c=="string"?rs(t,c):(typeof c=="number"||typeof c=="bigint")&&rs(t,""+c);break;case"onScroll":c!=null&&ht("scroll",t);break;case"onScrollEnd":c!=null&&ht("scrollend",t);break;case"onClick":c!=null&&(t.onclick=Js);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lo.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),a=l.slice(2,f?l.length-7:void 0),m=t[xn]||null,m=m!=null?m[l]:null,typeof m=="function"&&t.removeEventListener(a,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(l in t?t[l]=null:t.hasAttribute(l)&&t.removeAttribute(l)),t.addEventListener(a,c,f);break e}l in t?t[l]=c:c===!0?t.setAttribute(l,""):_l(t,l,c)}}}function Ln(t,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ht("error",t),ht("load",t);var c=!1,f=!1,m;for(m in l)if(l.hasOwnProperty(m)){var v=l[m];if(v!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Ut(t,a,m,v,l,null)}}f&&Ut(t,a,"srcSet",l.srcSet,l,null),c&&Ut(t,a,"src",l.src,l,null);return;case"input":ht("invalid",t);var S=m=v=f=null,B=null,te=null;for(c in l)if(l.hasOwnProperty(c)){var ce=l[c];if(ce!=null)switch(c){case"name":f=ce;break;case"type":v=ce;break;case"checked":B=ce;break;case"defaultChecked":te=ce;break;case"value":m=ce;break;case"defaultValue":S=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(r(137,a));break;default:Ut(t,a,c,ce,l,null)}}Du(t,m,S,B,te,v,f,!1);return;case"select":ht("invalid",t),c=v=m=null;for(f in l)if(l.hasOwnProperty(f)&&(S=l[f],S!=null))switch(f){case"value":m=S;break;case"defaultValue":v=S;break;case"multiple":c=S;default:Ut(t,a,f,S,l,null)}a=m,l=v,t.multiple=!!c,a!=null?wr(t,!!c,a,!1):l!=null&&wr(t,!!c,l,!0);return;case"textarea":ht("invalid",t),m=f=c=null;for(v in l)if(l.hasOwnProperty(v)&&(S=l[v],S!=null))switch(v){case"value":c=S;break;case"defaultValue":f=S;break;case"children":m=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(r(91));break;default:Ut(t,a,v,S,l,null)}_r(t,c,f,m);return;case"option":for(B in l)l.hasOwnProperty(B)&&(c=l[B],c!=null)&&(B==="selected"?t.selected=c&&typeof c!="function"&&typeof c!="symbol":Ut(t,a,B,c,l,null));return;case"dialog":ht("beforetoggle",t),ht("toggle",t),ht("cancel",t),ht("close",t);break;case"iframe":case"object":ht("load",t);break;case"video":case"audio":for(c=0;c<Sc.length;c++)ht(Sc[c],t);break;case"image":ht("error",t),ht("load",t);break;case"details":ht("toggle",t);break;case"embed":case"source":case"link":ht("error",t),ht("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in l)if(l.hasOwnProperty(te)&&(c=l[te],c!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Ut(t,a,te,c,l,null)}return;default:if(El(a)){for(ce in l)l.hasOwnProperty(ce)&&(c=l[ce],c!==void 0&&sp(t,a,ce,c,l,void 0));return}}for(S in l)l.hasOwnProperty(S)&&(c=l[S],c!=null&&Ut(t,a,S,c,l,null))}function bS(t,a,l,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,v=null,S=null,B=null,te=null,ce=null;for(re in l){var pe=l[re];if(l.hasOwnProperty(re)&&pe!=null)switch(re){case"checked":break;case"value":break;case"defaultValue":B=pe;default:c.hasOwnProperty(re)||Ut(t,a,re,null,c,pe)}}for(var ne in c){var re=c[ne];if(pe=l[ne],c.hasOwnProperty(ne)&&(re!=null||pe!=null))switch(ne){case"type":m=re;break;case"name":f=re;break;case"checked":te=re;break;case"defaultChecked":ce=re;break;case"value":v=re;break;case"defaultValue":S=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(137,a));break;default:re!==pe&&Ut(t,a,ne,re,c,pe)}}Nl(t,v,S,B,te,ce,m,f);return;case"select":re=v=S=ne=null;for(m in l)if(B=l[m],l.hasOwnProperty(m)&&B!=null)switch(m){case"value":break;case"multiple":re=B;default:c.hasOwnProperty(m)||Ut(t,a,m,null,c,B)}for(f in c)if(m=c[f],B=l[f],c.hasOwnProperty(f)&&(m!=null||B!=null))switch(f){case"value":ne=m;break;case"defaultValue":S=m;break;case"multiple":v=m;default:m!==B&&Ut(t,a,f,m,c,B)}a=S,l=v,c=re,ne!=null?wr(t,!!l,ne,!1):!!c!=!!l&&(a!=null?wr(t,!!l,a,!0):wr(t,!!l,l?[]:"",!1));return;case"textarea":re=ne=null;for(S in l)if(f=l[S],l.hasOwnProperty(S)&&f!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Ut(t,a,S,null,c,f)}for(v in c)if(f=c[v],m=l[v],c.hasOwnProperty(v)&&(f!=null||m!=null))switch(v){case"value":ne=f;break;case"defaultValue":re=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(r(91));break;default:f!==m&&Ut(t,a,v,f,c,m)}Mu(t,ne,re);return;case"option":for(var De in l)ne=l[De],l.hasOwnProperty(De)&&ne!=null&&!c.hasOwnProperty(De)&&(De==="selected"?t.selected=!1:Ut(t,a,De,null,c,ne));for(B in c)ne=c[B],re=l[B],c.hasOwnProperty(B)&&ne!==re&&(ne!=null||re!=null)&&(B==="selected"?t.selected=ne&&typeof ne!="function"&&typeof ne!="symbol":Ut(t,a,B,ne,c,re));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ye in l)ne=l[Ye],l.hasOwnProperty(Ye)&&ne!=null&&!c.hasOwnProperty(Ye)&&Ut(t,a,Ye,null,c,ne);for(te in c)if(ne=c[te],re=l[te],c.hasOwnProperty(te)&&ne!==re&&(ne!=null||re!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(r(137,a));break;default:Ut(t,a,te,ne,c,re)}return;default:if(El(a)){for(var Bt in l)ne=l[Bt],l.hasOwnProperty(Bt)&&ne!==void 0&&!c.hasOwnProperty(Bt)&&sp(t,a,Bt,void 0,c,ne);for(ce in c)ne=c[ce],re=l[ce],!c.hasOwnProperty(ce)||ne===re||ne===void 0&&re===void 0||sp(t,a,ce,ne,c,re);return}}for(var W in l)ne=l[W],l.hasOwnProperty(W)&&ne!=null&&!c.hasOwnProperty(W)&&Ut(t,a,W,null,c,ne);for(pe in c)ne=c[pe],re=l[pe],!c.hasOwnProperty(pe)||ne===re||ne==null&&re==null||Ut(t,a,pe,ne,c,re)}function By(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function yS(){if(typeof performance.getEntriesByType=="function"){for(var t=0,a=0,l=performance.getEntriesByType("resource"),c=0;c<l.length;c++){var f=l[c],m=f.transferSize,v=f.initiatorType,S=f.duration;if(m&&S&&By(v)){for(v=0,S=f.responseEnd,c+=1;c<l.length;c++){var B=l[c],te=B.startTime;if(te>S)break;var ce=B.transferSize,pe=B.initiatorType;ce&&By(pe)&&(B=B.responseEnd,v+=ce*(B<S?1:(S-te)/(B-te)))}if(--c,a+=8*(m+v)/(f.duration/1e3),t++,10<t)break}}if(0<t)return a/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var ap=null,rp=null;function Vd(t){return t.nodeType===9?t:t.ownerDocument}function zy(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qy(t,a){if(t===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&a==="foreignObject"?0:t}function ip(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var lp=null;function vS(){var t=window.event;return t&&t.type==="popstate"?t===lp?!1:(lp=t,!0):(lp=null,!1)}var Fy=typeof setTimeout=="function"?setTimeout:void 0,wS=typeof clearTimeout=="function"?clearTimeout:void 0,Hy=typeof Promise=="function"?Promise:void 0,_S=typeof queueMicrotask=="function"?queueMicrotask:typeof Hy<"u"?function(t){return Hy.resolve(null).then(t).catch(NS)}:Fy;function NS(t){setTimeout(function(){throw t})}function $r(t){return t==="head"}function $y(t,a){var l=a,c=0;do{var f=l.nextSibling;if(t.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"||l==="/&"){if(c===0){t.removeChild(f),ro(a);return}c--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")c++;else if(l==="html")Tc(t.ownerDocument.documentElement);else if(l==="head"){l=t.ownerDocument.head,Tc(l);for(var m=l.firstChild;m;){var v=m.nextSibling,S=m.nodeName;m[ha]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&m.rel.toLowerCase()==="stylesheet"||l.removeChild(m),m=v}}else l==="body"&&Tc(t.ownerDocument.body);l=f}while(l);ro(a)}function Gy(t,a){var l=t;t=0;do{var c=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),c&&c.nodeType===8)if(l=c.data,l==="/$"){if(t===0)break;t--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||t++;l=c}while(l)}function op(t){var a=t.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":op(l),wl(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}t.removeChild(l)}}function ES(t,a,l,c){for(;t.nodeType===1;){var f=l;if(t.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[ha])switch(a){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(m=t.getAttribute("rel"),m==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(m!==f.rel||t.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||t.getAttribute("title")!==(f.title==null?null:f.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(m=t.getAttribute("src"),(m!==(f.src==null?null:f.src)||t.getAttribute("type")!==(f.type==null?null:f.type)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(a==="input"&&t.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&t.getAttribute("name")===m)return t}else return t;if(t=Gs(t.nextSibling),t===null)break}return null}function SS(t,a,l){if(a==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!l||(t=Gs(t.nextSibling),t===null))return null;return t}function Yy(t,a){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=Gs(t.nextSibling),t===null))return null;return t}function cp(t){return t.data==="$?"||t.data==="$~"}function up(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function jS(t,a){var l=t.ownerDocument;if(t.data==="$~")t._reactRetry=a;else if(t.data!=="$?"||l.readyState!=="loading")a();else{var c=function(){a(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function Gs(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return t}var dp=null;function Wy(t){t=t.nextSibling;for(var a=0;t;){if(t.nodeType===8){var l=t.data;if(l==="/$"||l==="/&"){if(a===0)return Gs(t.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}t=t.nextSibling}return null}function Ky(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var l=t.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return t;a--}else l!=="/$"&&l!=="/&"||a++}t=t.previousSibling}return null}function Qy(t,a,l){switch(a=Vd(l),t){case"html":if(t=a.documentElement,!t)throw Error(r(452));return t;case"head":if(t=a.head,!t)throw Error(r(453));return t;case"body":if(t=a.body,!t)throw Error(r(454));return t;default:throw Error(r(451))}}function Tc(t){for(var a=t.attributes;a.length;)t.removeAttributeNode(a[0]);wl(t)}var Ys=new Map,Xy=new Set;function Ld(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var lr=Y.d;Y.d={f:TS,r:AS,D:CS,C:RS,L:kS,m:IS,X:MS,S:DS,M:OS};function TS(){var t=lr.f(),a=Cd();return t||a}function AS(t){var a=Ps(t);a!==null&&a.tag===5&&a.type==="form"?mb(a):lr.r(t)}var no=typeof document>"u"?null:document;function Jy(t,a,l){var c=no;if(c&&typeof a=="string"&&a){var f=as(a);f='link[rel="'+t+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),Xy.has(f)||(Xy.add(f),t={rel:t,crossOrigin:l,href:a},c.querySelector(f)===null&&(a=c.createElement("link"),Ln(a,"link",t),bn(a),c.head.appendChild(a)))}}function CS(t){lr.D(t),Jy("dns-prefetch",t,null)}function RS(t,a){lr.C(t,a),Jy("preconnect",t,a)}function kS(t,a,l){lr.L(t,a,l);var c=no;if(c&&t&&a){var f='link[rel="preload"][as="'+as(a)+'"]';a==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+as(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+as(l.imageSizes)+'"]')):f+='[href="'+as(t)+'"]';var m=f;switch(a){case"style":m=so(t);break;case"script":m=ao(t)}Ys.has(m)||(t=_({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:t,as:a},l),Ys.set(m,t),c.querySelector(f)!==null||a==="style"&&c.querySelector(Ac(m))||a==="script"&&c.querySelector(Cc(m))||(a=c.createElement("link"),Ln(a,"link",t),bn(a),c.head.appendChild(a)))}}function IS(t,a){lr.m(t,a);var l=no;if(l&&t){var c=a&&typeof a.as=="string"?a.as:"script",f='link[rel="modulepreload"][as="'+as(c)+'"][href="'+as(t)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=ao(t)}if(!Ys.has(m)&&(t=_({rel:"modulepreload",href:t},a),Ys.set(m,t),l.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Cc(m)))return}c=l.createElement("link"),Ln(c,"link",t),bn(c),l.head.appendChild(c)}}}function DS(t,a,l){lr.S(t,a,l);var c=no;if(c&&t){var f=ma(c).hoistableStyles,m=so(t);a=a||"default";var v=f.get(m);if(!v){var S={loading:0,preload:null};if(v=c.querySelector(Ac(m)))S.loading=5;else{t=_({rel:"stylesheet",href:t,"data-precedence":a},l),(l=Ys.get(m))&&hp(t,l);var B=v=c.createElement("link");bn(B),Ln(B,"link",t),B._p=new Promise(function(te,ce){B.onload=te,B.onerror=ce}),B.addEventListener("load",function(){S.loading|=1}),B.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Ud(v,a,c)}v={type:"stylesheet",instance:v,count:1,state:S},f.set(m,v)}}}function MS(t,a){lr.X(t,a);var l=no;if(l&&t){var c=ma(l).hoistableScripts,f=ao(t),m=c.get(f);m||(m=l.querySelector(Cc(f)),m||(t=_({src:t,async:!0},a),(a=Ys.get(f))&&fp(t,a),m=l.createElement("script"),bn(m),Ln(m,"link",t),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function OS(t,a){lr.M(t,a);var l=no;if(l&&t){var c=ma(l).hoistableScripts,f=ao(t),m=c.get(f);m||(m=l.querySelector(Cc(f)),m||(t=_({src:t,async:!0,type:"module"},a),(a=Ys.get(f))&&fp(t,a),m=l.createElement("script"),bn(m),Ln(m,"link",t),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function Zy(t,a,l,c){var f=(f=Re.current)?Ld(f):null;if(!f)throw Error(r(446));switch(t){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=so(l.href),l=ma(f).hoistableStyles,c=l.get(a),c||(c={type:"style",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){t=so(l.href);var m=ma(f).hoistableStyles,v=m.get(t);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(t,v),(m=f.querySelector(Ac(t)))&&!m._p&&(v.instance=m,v.state.loading=5),Ys.has(t)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Ys.set(t,l),m||PS(f,t,l,v.state))),a&&c===null)throw Error(r(528,""));return v}if(a&&c!==null)throw Error(r(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=ao(l),l=ma(f).hoistableScripts,c=l.get(a),c||(c={type:"script",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,t))}}function so(t){return'href="'+as(t)+'"'}function Ac(t){return'link[rel="stylesheet"]['+t+"]"}function ev(t){return _({},t,{"data-precedence":t.precedence,precedence:null})}function PS(t,a,l,c){t.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=t.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),Ln(a,"link",l),bn(a),t.head.appendChild(a))}function ao(t){return'[src="'+as(t)+'"]'}function Cc(t){return"script[async]"+t}function tv(t,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var c=t.querySelector('style[data-href~="'+as(l.href)+'"]');if(c)return a.instance=c,bn(c),c;var f=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),bn(c),Ln(c,"style",f),Ud(c,l.precedence,t),a.instance=c;case"stylesheet":f=so(l.href);var m=t.querySelector(Ac(f));if(m)return a.state.loading|=4,a.instance=m,bn(m),m;c=ev(l),(f=Ys.get(f))&&hp(c,f),m=(t.ownerDocument||t).createElement("link"),bn(m);var v=m;return v._p=new Promise(function(S,B){v.onload=S,v.onerror=B}),Ln(m,"link",c),a.state.loading|=4,Ud(m,l.precedence,t),a.instance=m;case"script":return m=ao(l.src),(f=t.querySelector(Cc(m)))?(a.instance=f,bn(f),f):(c=l,(f=Ys.get(m))&&(c=_({},l),fp(c,f)),t=t.ownerDocument||t,f=t.createElement("script"),bn(f),Ln(f,"link",c),t.head.appendChild(f),a.instance=f);case"void":return null;default:throw Error(r(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Ud(c,l.precedence,t));return a.instance}function Ud(t,a,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,v=0;v<c.length;v++){var S=c[v];if(S.dataset.precedence===a)m=S;else if(m!==f)break}m?m.parentNode.insertBefore(t,m.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(t,a.firstChild))}function hp(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.title==null&&(t.title=a.title)}function fp(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.integrity==null&&(t.integrity=a.integrity)}var Bd=null;function nv(t,a,l){if(Bd===null){var c=new Map,f=Bd=new Map;f.set(l,c)}else f=Bd,c=f.get(l),c||(c=new Map,f.set(l,c));if(c.has(t))return c;for(c.set(t,null),l=l.getElementsByTagName(t),f=0;f<l.length;f++){var m=l[f];if(!(m[ha]||m[nn]||t==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var v=m.getAttribute(a)||"";v=t+v;var S=c.get(v);S?S.push(m):c.set(v,[m])}}return c}function sv(t,a,l){t=t.ownerDocument||t,t.head.insertBefore(l,a==="title"?t.querySelector("head > title"):null)}function VS(t,a,l){if(l===1||a.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(t=a.disabled,typeof a.precedence=="string"&&t==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function av(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function LS(t,a,l,c){if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var f=so(c.href),m=a.querySelector(Ac(f));if(m){a=m._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(t.count++,t=zd.bind(t),a.then(t,t)),l.state.loading|=4,l.instance=m,bn(m);return}m=a.ownerDocument||a,c=ev(c),(f=Ys.get(f))&&hp(c,f),m=m.createElement("link"),bn(m);var v=m;v._p=new Promise(function(S,B){v.onload=S,v.onerror=B}),Ln(m,"link",c),l.instance=m}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(t.count++,l=zd.bind(t),a.addEventListener("load",l),a.addEventListener("error",l))}}var mp=0;function US(t,a){return t.stylesheets&&t.count===0&&Fd(t,t.stylesheets),0<t.count||0<t.imgCount?function(l){var c=setTimeout(function(){if(t.stylesheets&&Fd(t,t.stylesheets),t.unsuspend){var m=t.unsuspend;t.unsuspend=null,m()}},6e4+a);0<t.imgBytes&&mp===0&&(mp=62500*yS());var f=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Fd(t,t.stylesheets),t.unsuspend)){var m=t.unsuspend;t.unsuspend=null,m()}},(t.imgBytes>mp?50:800)+a);return t.unsuspend=l,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function zd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Fd(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var qd=null;function Fd(t,a){t.stylesheets=null,t.unsuspend!==null&&(t.count++,qd=new Map,a.forEach(BS,t),qd=null,zd.call(t))}function BS(t,a){if(!(a.state.loading&4)){var l=qd.get(t);if(l)var c=l.get(null);else{l=new Map,qd.set(t,l);for(var f=t.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var v=f[m];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(l.set(v.dataset.precedence,v),c=v)}c&&l.set(null,c)}f=a.instance,v=f.getAttribute("data-precedence"),m=l.get(v)||c,m===c&&l.set(null,f),l.set(v,f),this.count++,c=zd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(f,t.firstChild)),a.state.loading|=4}}var Rc={$$typeof:K,Provider:null,Consumer:null,_currentValue:ie,_currentValue2:ie,_threadCount:0};function zS(t,a,l,c,f,m,v,S,B){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Dt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dt(0),this.hiddenUpdates=Dt(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function rv(t,a,l,c,f,m,v,S,B,te,ce,pe){return t=new zS(t,a,l,v,B,te,ce,pe,S),a=1,m===!0&&(a|=24),m=Ns(3,null,null,a),t.current=m,m.stateNode=t,a=Yf(),a.refCount++,t.pooledCache=a,a.refCount++,m.memoizedState={element:c,isDehydrated:l,cache:a},Xf(m),t}function iv(t){return t?(t=Ol,t):Ol}function lv(t,a,l,c,f,m){f=iv(f),c.context===null?c.context=f:c.pendingContext=f,c=Mr(a),c.payload={element:l},m=m===void 0?null:m,m!==null&&(c.callback=m),l=Or(t,c,a),l!==null&&(us(l,t,a),oc(l,t,a))}function ov(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var l=t.retryLane;t.retryLane=l!==0&&l<a?l:a}}function pp(t,a){ov(t,a),(t=t.alternate)&&ov(t,a)}function cv(t){if(t.tag===13||t.tag===31){var a=Li(t,67108864);a!==null&&us(a,t,67108864),pp(t,67108864)}}function uv(t){if(t.tag===13||t.tag===31){var a=As();a=Fa(a);var l=Li(t,a);l!==null&&us(l,t,a),pp(t,a)}}var Hd=!0;function qS(t,a,l,c){var f=k.T;k.T=null;var m=Y.p;try{Y.p=2,gp(t,a,l,c)}finally{Y.p=m,k.T=f}}function FS(t,a,l,c){var f=k.T;k.T=null;var m=Y.p;try{Y.p=8,gp(t,a,l,c)}finally{Y.p=m,k.T=f}}function gp(t,a,l,c){if(Hd){var f=xp(c);if(f===null)np(t,a,c,$d,l),hv(t,c);else if($S(f,t,a,l,c))c.stopPropagation();else if(hv(t,c),a&4&&-1<HS.indexOf(t)){for(;f!==null;){var m=Ps(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var v=Xe(m.pendingLanes);if(v!==0){var S=m;for(S.pendingLanes|=2,S.entangledLanes|=2;v;){var B=1<<31-_e(v);S.entanglements[1]|=B,v&=~B}Ta(m),(Ct&6)===0&&(Td=_t()+500,Ec(0))}}break;case 31:case 13:S=Li(m,2),S!==null&&us(S,m,2),Cd(),pp(m,2)}if(m=xp(c),m===null&&np(t,a,c,$d,l),m===f)break;f=m}f!==null&&c.stopPropagation()}else np(t,a,c,null,l)}}function xp(t){return t=Vs(t),bp(t)}var $d=null;function bp(t){if($d=null,t=fa(t),t!==null){var a=u(t);if(a===null)t=null;else{var l=a.tag;if(l===13){if(t=d(a),t!==null)return t;t=null}else if(l===31){if(t=p(a),t!==null)return t;t=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null)}}return $d=t,null}function dv(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Nt()){case Tn:return 2;case Rt:return 8;case Qn:case qn:return 32;case bs:return 268435456;default:return 32}default:return 32}}var yp=!1,Gr=null,Yr=null,Wr=null,kc=new Map,Ic=new Map,Kr=[],HS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function hv(t,a){switch(t){case"focusin":case"focusout":Gr=null;break;case"dragenter":case"dragleave":Yr=null;break;case"mouseover":case"mouseout":Wr=null;break;case"pointerover":case"pointerout":kc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ic.delete(a.pointerId)}}function Dc(t,a,l,c,f,m){return t===null||t.nativeEvent!==m?(t={blockedOn:a,domEventName:l,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},a!==null&&(a=Ps(a),a!==null&&cv(a)),t):(t.eventSystemFlags|=c,a=t.targetContainers,f!==null&&a.indexOf(f)===-1&&a.push(f),t)}function $S(t,a,l,c,f){switch(a){case"focusin":return Gr=Dc(Gr,t,a,l,c,f),!0;case"dragenter":return Yr=Dc(Yr,t,a,l,c,f),!0;case"mouseover":return Wr=Dc(Wr,t,a,l,c,f),!0;case"pointerover":var m=f.pointerId;return kc.set(m,Dc(kc.get(m)||null,t,a,l,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Ic.set(m,Dc(Ic.get(m)||null,t,a,l,c,f)),!0}return!1}function fv(t){var a=fa(t.target);if(a!==null){var l=u(a);if(l!==null){if(a=l.tag,a===13){if(a=d(l),a!==null){t.blockedOn=a,gn(t.priority,function(){uv(l)});return}}else if(a===31){if(a=p(l),a!==null){t.blockedOn=a,gn(t.priority,function(){uv(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){t.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Gd(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var l=xp(t.nativeEvent);if(l===null){l=t.nativeEvent;var c=new l.constructor(l.type,l);Go=c,l.target.dispatchEvent(c),Go=null}else return a=Ps(l),a!==null&&cv(a),t.blockedOn=l,!1;a.shift()}return!0}function mv(t,a,l){Gd(t)&&l.delete(a)}function GS(){yp=!1,Gr!==null&&Gd(Gr)&&(Gr=null),Yr!==null&&Gd(Yr)&&(Yr=null),Wr!==null&&Gd(Wr)&&(Wr=null),kc.forEach(mv),Ic.forEach(mv)}function Yd(t,a){t.blockedOn===a&&(t.blockedOn=null,yp||(yp=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,GS)))}var Wd=null;function pv(t){Wd!==t&&(Wd=t,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Wd===t&&(Wd=null);for(var a=0;a<t.length;a+=3){var l=t[a],c=t[a+1],f=t[a+2];if(typeof c!="function"){if(bp(c||l)===null)continue;break}var m=Ps(l);m!==null&&(t.splice(a,3),a-=3,xm(m,{pending:!0,data:f,method:l.method,action:c},c,f))}}))}function ro(t){function a(B){return Yd(B,t)}Gr!==null&&Yd(Gr,t),Yr!==null&&Yd(Yr,t),Wr!==null&&Yd(Wr,t),kc.forEach(a),Ic.forEach(a);for(var l=0;l<Kr.length;l++){var c=Kr[l];c.blockedOn===t&&(c.blockedOn=null)}for(;0<Kr.length&&(l=Kr[0],l.blockedOn===null);)fv(l),l.blockedOn===null&&Kr.shift();if(l=(t.ownerDocument||t).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var f=l[c],m=l[c+1],v=f[xn]||null;if(typeof m=="function")v||pv(l);else if(v){var S=null;if(m&&m.hasAttribute("formAction")){if(f=m,v=m[xn]||null)S=v.formAction;else if(bp(f)!==null)continue}else S=v.action;typeof S=="function"?l[c+1]=S:(l.splice(c,3),c-=3),pv(l)}}}function gv(){function t(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function a(){f!==null&&(f(),f=null),c||setTimeout(l,20)}function l(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),f!==null&&(f(),f=null)}}}function vp(t){this._internalRoot=t}Kd.prototype.render=vp.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(r(409));var l=a.current,c=As();lv(l,c,t,a,null,null)},Kd.prototype.unmount=vp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;lv(t.current,2,null,t,null,null),Cd(),a[ys]=null}};function Kd(t){this._internalRoot=t}Kd.prototype.unstable_scheduleHydration=function(t){if(t){var a=Si();t={blockedOn:null,target:t,priority:a};for(var l=0;l<Kr.length&&a!==0&&a<Kr[l].priority;l++);Kr.splice(l,0,t),l===0&&fv(t)}};var xv=e.version;if(xv!=="19.2.4")throw Error(r(527,xv,"19.2.4"));Y.findDOMNode=function(t){var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(r(188)):(t=Object.keys(t).join(","),Error(r(268,t)));return t=x(a),t=t!==null?b(t):null,t=t===null?null:t.stateNode,t};var YS={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:k,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qd.isDisabled&&Qd.supportsFiber)try{H=Qd.inject(YS),se=Qd}catch{}}return Oc.createRoot=function(t,a){if(!o(t))throw Error(r(299));var l=!1,c="",f=Eb,m=Sb,v=jb;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(f=a.onUncaughtError),a.onCaughtError!==void 0&&(m=a.onCaughtError),a.onRecoverableError!==void 0&&(v=a.onRecoverableError)),a=rv(t,1,!1,null,null,l,c,null,f,m,v,gv),t[ys]=a.current,tp(t),new vp(a)},Oc.hydrateRoot=function(t,a,l){if(!o(t))throw Error(r(299));var c=!1,f="",m=Eb,v=Sb,S=jb,B=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(S=l.onRecoverableError),l.formState!==void 0&&(B=l.formState)),a=rv(t,1,!0,a,l??null,c,f,B,m,v,S,gv),a.context=iv(null),l=a.current,c=As(),c=Fa(c),f=Mr(c),f.callback=null,Or(l,f,c),l=c,a.current.lanes=l,tn(a,l),Ta(a),t[ys]=a.current,tp(t),new Kd(a)},Oc.version="19.2.4",Oc}var Tv;function sj(){if(Tv)return Np.exports;Tv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Np.exports=nj(),Np.exports}var aj=sj();const rj=Lg(aj);var Av="popstate";function ij(s={}){function e(o,u){let{pathname:d="/",search:p="",hash:g=""}=pl(o.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),tg("",{pathname:d,search:p,hash:g},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function n(o,u){let d=o.document.querySelector("base"),p="";if(d&&d.getAttribute("href")){let g=o.location.href,x=g.indexOf("#");p=x===-1?g:g.slice(0,x)}return p+"#"+(typeof u=="string"?u:su(u))}function r(o,u){Qs(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(u)})`)}return oj(e,n,r,s)}function Jt(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Qs(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function lj(){return Math.random().toString(36).substring(2,10)}function Cv(s,e){return{usr:s.state,key:s.key,idx:e}}function tg(s,e,n=null,r){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?pl(e):e,state:n,key:e&&e.key||r||lj()}}function su({pathname:s="/",search:e="",hash:n=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(s+=n.charAt(0)==="#"?n:"#"+n),s}function pl(s){let e={};if(s){let n=s.indexOf("#");n>=0&&(e.hash=s.substring(n),s=s.substring(0,n));let r=s.indexOf("?");r>=0&&(e.search=s.substring(r),s=s.substring(0,r)),s&&(e.pathname=s)}return e}function oj(s,e,n,r={}){let{window:o=document.defaultView,v5Compat:u=!1}=r,d=o.history,p="POP",g=null,x=b();x==null&&(x=0,d.replaceState({...d.state,idx:x},""));function b(){return(d.state||{idx:null}).idx}function _(){p="POP";let O=b(),U=O==null?null:O-x;x=O,g&&g({action:p,location:L.location,delta:U})}function E(O,U){p="PUSH";let G=tg(L.location,O,U);n&&n(G,O),x=b()+1;let K=Cv(G,x),fe=L.createHref(G);try{d.pushState(K,"",fe)}catch(he){if(he instanceof DOMException&&he.name==="DataCloneError")throw he;o.location.assign(fe)}u&&g&&g({action:p,location:L.location,delta:1})}function A(O,U){p="REPLACE";let G=tg(L.location,O,U);n&&n(G,O),x=b();let K=Cv(G,x),fe=L.createHref(G);d.replaceState(K,"",fe),u&&g&&g({action:p,location:L.location,delta:0})}function F(O){return cj(O)}let L={get action(){return p},get location(){return s(o,d)},listen(O){if(g)throw new Error("A history only accepts one active listener");return o.addEventListener(Av,_),g=O,()=>{o.removeEventListener(Av,_),g=null}},createHref(O){return e(o,O)},createURL:F,encodeLocation(O){let U=F(O);return{pathname:U.pathname,search:U.search,hash:U.hash}},push:E,replace:A,go(O){return d.go(O)}};return L}function cj(s,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Jt(n,"No window.location.(origin|href) available to create URL");let r=typeof s=="string"?s:su(s);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function H_(s,e,n="/"){return uj(s,e,n,!1)}function uj(s,e,n,r){let o=typeof e=="string"?pl(e):e,u=fr(o.pathname||"/",n);if(u==null)return null;let d=$_(s);dj(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let x=_j(u);p=vj(d[g],x,r)}return p}function $_(s,e=[],n=[],r="",o=!1){let u=(d,p,g=o,x)=>{let b={relativePath:x===void 0?d.path||"":x,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(r)&&g)return;Jt(b.relativePath.startsWith(r),`Absolute route path "${b.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(r.length)}let _=ur([r,b.relativePath]),E=n.concat(b);d.children&&d.children.length>0&&(Jt(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),$_(d.children,e,E,_,g)),!(d.path==null&&!d.index)&&e.push({path:_,score:bj(_,d.index),routesMeta:E})};return s.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of G_(d.path))u(d,p,!0,g)}),e}function G_(s){let e=s.split("/");if(e.length===0)return[];let[n,...r]=e,o=n.endsWith("?"),u=n.replace(/\?$/,"");if(r.length===0)return o?[u,""]:[u];let d=G_(r.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),o&&p.push(...d),p.map(g=>s.startsWith("/")&&g===""?"/":g)}function dj(s){s.sort((e,n)=>e.score!==n.score?n.score-e.score:yj(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var hj=/^:[\w-]+$/,fj=3,mj=2,pj=1,gj=10,xj=-2,Rv=s=>s==="*";function bj(s,e){let n=s.split("/"),r=n.length;return n.some(Rv)&&(r+=xj),e&&(r+=mj),n.filter(o=>!Rv(o)).reduce((o,u)=>o+(hj.test(u)?fj:u===""?pj:gj),r)}function yj(s,e){return s.length===e.length&&s.slice(0,-1).every((r,o)=>r===e[o])?s[s.length-1]-e[e.length-1]:0}function vj(s,e,n=!1){let{routesMeta:r}=s,o={},u="/",d=[];for(let p=0;p<r.length;++p){let g=r[p],x=p===r.length-1,b=u==="/"?e:e.slice(u.length)||"/",_=jh({path:g.relativePath,caseSensitive:g.caseSensitive,end:x},b),E=g.route;if(!_&&x&&n&&!r[r.length-1].route.index&&(_=jh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},b)),!_)return null;Object.assign(o,_.params),d.push({params:o,pathname:ur([u,_.pathname]),pathnameBase:jj(ur([u,_.pathnameBase])),route:E}),_.pathnameBase!=="/"&&(u=ur([u,_.pathnameBase]))}return d}function jh(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[n,r]=wj(s.path,s.caseSensitive,s.end),o=e.match(n);if(!o)return null;let u=o[0],d=u.replace(/(.)\/+$/,"$1"),p=o.slice(1);return{params:r.reduce((x,{paramName:b,isOptional:_},E)=>{if(b==="*"){let F=p[E]||"";d=u.slice(0,u.length-F.length).replace(/(.)\/+$/,"$1")}const A=p[E];return _&&!A?x[b]=void 0:x[b]=(A||"").replace(/%2F/g,"/"),x},{}),pathname:u,pathnameBase:d,pattern:s}}function wj(s,e=!1,n=!0){Qs(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let r=[],o="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(r.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(r.push({paramName:"*"}),o+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":s!==""&&s!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function _j(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qs(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function fr(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=s.charAt(n);return r&&r!=="/"?null:s.slice(n)||"/"}var Nj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Ej(s,e="/"){let{pathname:n,search:r="",hash:o=""}=typeof s=="string"?pl(s):s,u;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?u=kv(n.substring(1),"/"):u=kv(n,e)):u=e,{pathname:u,search:Tj(r),hash:Aj(o)}}function kv(s,e){let n=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function Tp(s,e,n,r){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Sj(s){return s.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Bg(s){let e=Sj(s);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function zg(s,e,n,r=!1){let o;typeof s=="string"?o=pl(s):(o={...s},Jt(!o.pathname||!o.pathname.includes("?"),Tp("?","pathname","search",o)),Jt(!o.pathname||!o.pathname.includes("#"),Tp("#","pathname","hash",o)),Jt(!o.search||!o.search.includes("#"),Tp("#","search","hash",o)));let u=s===""||o.pathname==="",d=u?"/":o.pathname,p;if(d==null)p=n;else{let _=e.length-1;if(!r&&d.startsWith("..")){let E=d.split("/");for(;E[0]==="..";)E.shift(),_-=1;o.pathname=E.join("/")}p=_>=0?e[_]:"/"}let g=Ej(o,p),x=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(x||b)&&(g.pathname+="/"),g}var ur=s=>s.join("/").replace(/\/\/+/g,"/"),jj=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),Tj=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,Aj=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,Cj=class{constructor(s,e,n,r=!1){this.status=s,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function Rj(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function kj(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Y_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function W_(s,e){let n=s;if(typeof n!="string"||!Nj.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,o=!1;if(Y_)try{let u=new URL(window.location.href),d=n.startsWith("//")?new URL(u.protocol+n):new URL(n),p=fr(d.pathname,e);d.origin===u.origin&&p!=null?n=p+d.search+d.hash:o=!0}catch{Qs(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:o,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var K_=["POST","PUT","PATCH","DELETE"];new Set(K_);var Ij=["GET",...K_];new Set(Ij);var Ao=N.createContext(null);Ao.displayName="DataRouter";var Qh=N.createContext(null);Qh.displayName="DataRouterState";var Dj=N.createContext(!1),Q_=N.createContext({isTransitioning:!1});Q_.displayName="ViewTransition";var Mj=N.createContext(new Map);Mj.displayName="Fetchers";var Oj=N.createContext(null);Oj.displayName="Await";var Os=N.createContext(null);Os.displayName="Navigation";var pu=N.createContext(null);pu.displayName="Location";var da=N.createContext({outlet:null,matches:[],isDataRoute:!1});da.displayName="Route";var qg=N.createContext(null);qg.displayName="RouteError";var X_="REACT_ROUTER_ERROR",Pj="REDIRECT",Vj="ROUTE_ERROR_RESPONSE";function Lj(s){if(s.startsWith(`${X_}:${Pj}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function Uj(s){if(s.startsWith(`${X_}:${Vj}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new Cj(e.status,e.statusText,e.data)}catch{}}function Bj(s,{relative:e}={}){Jt(Co(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=N.useContext(Os),{hash:o,pathname:u,search:d}=gu(s,{relative:e}),p=u;return n!=="/"&&(p=u==="/"?n:ur([n,u])),r.createHref({pathname:p,search:d,hash:o})}function Co(){return N.useContext(pu)!=null}function bi(){return Jt(Co(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(pu).location}var J_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Z_(s){N.useContext(Os).static||N.useLayoutEffect(s)}function Ro(){let{isDataRoute:s}=N.useContext(da);return s?Zj():zj()}function zj(){Jt(Co(),"useNavigate() may be used only in the context of a <Router> component.");let s=N.useContext(Ao),{basename:e,navigator:n}=N.useContext(Os),{matches:r}=N.useContext(da),{pathname:o}=bi(),u=JSON.stringify(Bg(r)),d=N.useRef(!1);return Z_(()=>{d.current=!0}),N.useCallback((g,x={})=>{if(Qs(d.current,J_),!d.current)return;if(typeof g=="number"){n.go(g);return}let b=zg(g,JSON.parse(u),o,x.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:ur([e,b.pathname])),(x.replace?n.replace:n.push)(b,x.state,x)},[e,n,u,o,s])}N.createContext(null);function ko(){let{matches:s}=N.useContext(da),e=s[s.length-1];return e?e.params:{}}function gu(s,{relative:e}={}){let{matches:n}=N.useContext(da),{pathname:r}=bi(),o=JSON.stringify(Bg(n));return N.useMemo(()=>zg(s,JSON.parse(o),r,e==="path"),[s,o,r,e])}function qj(s,e){return e1(s,e)}function e1(s,e,n,r,o){Jt(Co(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=N.useContext(Os),{matches:d}=N.useContext(da),p=d[d.length-1],g=p?p.params:{},x=p?p.pathname:"/",b=p?p.pathnameBase:"/",_=p&&p.route;{let G=_&&_.path||"";n1(x,!_||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${x}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let E=bi(),A;if(e){let G=typeof e=="string"?pl(e):e;Jt(b==="/"||G.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${G.pathname}" was given in the \`location\` prop.`),A=G}else A=E;let F=A.pathname||"/",L=F;if(b!=="/"){let G=b.replace(/^\//,"").split("/");L="/"+F.replace(/^\//,"").split("/").slice(G.length).join("/")}let O=H_(s,{pathname:L});Qs(_||O!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),Qs(O==null||O[O.length-1].route.element!==void 0||O[O.length-1].route.Component!==void 0||O[O.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let U=Yj(O&&O.map(G=>Object.assign({},G,{params:Object.assign({},g,G.params),pathname:ur([b,u.encodeLocation?u.encodeLocation(G.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?b:ur([b,u.encodeLocation?u.encodeLocation(G.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathnameBase])})),d,n,r,o);return e&&U?N.createElement(pu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},U):U}function Fj(){let s=Jj(),e=Rj(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),n=s instanceof Error?s.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},u={padding:"2px 4px",backgroundColor:r},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:u},"ErrorBoundary")," or"," ",N.createElement("code",{style:u},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:o},n):null,d)}var Hj=N.createElement(Fj,null),t1=class extends N.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const n=Uj(s.digest);n&&(s=n)}let e=s!==void 0?N.createElement(da.Provider,{value:this.props.routeContext},N.createElement(qg.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?N.createElement($j,{error:s},e):e}};t1.contextType=Dj;var Ap=new WeakMap;function $j({children:s,error:e}){let{basename:n}=N.useContext(Os);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=Lj(e.digest);if(r){let o=Ap.get(e);if(o)throw o;let u=W_(r.location,n);if(Y_&&!Ap.get(e))if(u.isExternal||r.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:r.replace}));throw Ap.set(e,d),d}return N.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function Gj({routeContext:s,match:e,children:n}){let r=N.useContext(Ao);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(da.Provider,{value:s},n)}function Yj(s,e=[],n=null,r=null,o=null){if(s==null){if(!n)return null;if(n.errors)s=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)s=n.matches;else return null}let u=s,d=n?.errors;if(d!=null){let b=u.findIndex(_=>_.route.id&&d?.[_.route.id]!==void 0);Jt(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let p=!1,g=-1;if(n)for(let b=0;b<u.length;b++){let _=u[b];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(g=b),_.route.id){let{loaderData:E,errors:A}=n,F=_.route.loader&&!E.hasOwnProperty(_.route.id)&&(!A||A[_.route.id]===void 0);if(_.route.lazy||F){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let x=n&&r?(b,_)=>{r(b,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:kj(n.matches),errorInfo:_})}:void 0;return u.reduceRight((b,_,E)=>{let A,F=!1,L=null,O=null;n&&(A=d&&_.route.id?d[_.route.id]:void 0,L=_.route.errorElement||Hj,p&&(g<0&&E===0?(n1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),F=!0,O=null):g===E&&(F=!0,O=_.route.hydrateFallbackElement||null)));let U=e.concat(u.slice(0,E+1)),G=()=>{let K;return A?K=L:F?K=O:_.route.Component?K=N.createElement(_.route.Component,null):_.route.element?K=_.route.element:K=b,N.createElement(Gj,{match:_,routeContext:{outlet:b,matches:U,isDataRoute:n!=null},children:K})};return n&&(_.route.ErrorBoundary||_.route.errorElement||E===0)?N.createElement(t1,{location:n.location,revalidation:n.revalidation,component:L,error:A,children:G(),routeContext:{outlet:null,matches:U,isDataRoute:!0},onError:x}):G()},null)}function Fg(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Wj(s){let e=N.useContext(Ao);return Jt(e,Fg(s)),e}function Kj(s){let e=N.useContext(Qh);return Jt(e,Fg(s)),e}function Qj(s){let e=N.useContext(da);return Jt(e,Fg(s)),e}function Hg(s){let e=Qj(s),n=e.matches[e.matches.length-1];return Jt(n.route.id,`${s} can only be used on routes that contain a unique "id"`),n.route.id}function Xj(){return Hg("useRouteId")}function Jj(){let s=N.useContext(qg),e=Kj("useRouteError"),n=Hg("useRouteError");return s!==void 0?s:e.errors?.[n]}function Zj(){let{router:s}=Wj("useNavigate"),e=Hg("useNavigate"),n=N.useRef(!1);return Z_(()=>{n.current=!0}),N.useCallback(async(o,u={})=>{Qs(n.current,J_),n.current&&(typeof o=="number"?await s.navigate(o):await s.navigate(o,{fromRouteId:e,...u}))},[s,e])}var Iv={};function n1(s,e,n){!e&&!Iv[s]&&(Iv[s]=!0,Qs(!1,n))}N.memo(eT);function eT({routes:s,future:e,state:n,onError:r}){return e1(s,void 0,n,r,e)}function tT({to:s,replace:e,state:n,relative:r}){Jt(Co(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=N.useContext(Os);Qs(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=N.useContext(da),{pathname:d}=bi(),p=Ro(),g=zg(s,Bg(u),d,r==="path"),x=JSON.stringify(g);return N.useEffect(()=>{p(JSON.parse(x),{replace:e,state:n,relative:r})},[p,x,r,e,n]),null}function ia(s){Jt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function nT({basename:s="/",children:e=null,location:n,navigationType:r="POP",navigator:o,static:u=!1,unstable_useTransitions:d}){Jt(!Co(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),g=N.useMemo(()=>({basename:p,navigator:o,static:u,unstable_useTransitions:d,future:{}}),[p,o,u,d]);typeof n=="string"&&(n=pl(n));let{pathname:x="/",search:b="",hash:_="",state:E=null,key:A="default"}=n,F=N.useMemo(()=>{let L=fr(x,p);return L==null?null:{location:{pathname:L,search:b,hash:_,state:E,key:A},navigationType:r}},[p,x,b,_,E,A,r]);return Qs(F!=null,`<Router basename="${p}"> is not able to match the URL "${x}${b}${_}" because it does not start with the basename, so the <Router> won't render anything.`),F==null?null:N.createElement(Os.Provider,{value:g},N.createElement(pu.Provider,{children:e,value:F}))}function sT({children:s,location:e}){return qj(ng(s),e)}function ng(s,e=[]){let n=[];return N.Children.forEach(s,(r,o)=>{if(!N.isValidElement(r))return;let u=[...e,o];if(r.type===N.Fragment){n.push.apply(n,ng(r.props.children,u));return}Jt(r.type===ia,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Jt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let d={id:r.props.id||u.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(d.children=ng(r.props.children,u)),n.push(d)}),n}var uh="get",dh="application/x-www-form-urlencoded";function Xh(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function aT(s){return Xh(s)&&s.tagName.toLowerCase()==="button"}function rT(s){return Xh(s)&&s.tagName.toLowerCase()==="form"}function iT(s){return Xh(s)&&s.tagName.toLowerCase()==="input"}function lT(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function oT(s,e){return s.button===0&&(!e||e==="_self")&&!lT(s)}var Xd=null;function cT(){if(Xd===null)try{new FormData(document.createElement("form"),0),Xd=!1}catch{Xd=!0}return Xd}var uT=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Cp(s){return s!=null&&!uT.has(s)?(Qs(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${dh}"`),null):s}function dT(s,e){let n,r,o,u,d;if(rT(s)){let p=s.getAttribute("action");r=p?fr(p,e):null,n=s.getAttribute("method")||uh,o=Cp(s.getAttribute("enctype"))||dh,u=new FormData(s)}else if(aT(s)||iT(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||p.getAttribute("action");if(r=g?fr(g,e):null,n=s.getAttribute("formmethod")||p.getAttribute("method")||uh,o=Cp(s.getAttribute("formenctype"))||Cp(p.getAttribute("enctype"))||dh,u=new FormData(p,s),!cT()){let{name:x,type:b,value:_}=s;if(b==="image"){let E=x?`${x}.`:"";u.append(`${E}x`,"0"),u.append(`${E}y`,"0")}else x&&u.append(x,_)}}else{if(Xh(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=uh,r=null,o=dh,d=s}return u&&o==="text/plain"&&(d=u,u=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function $g(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function hT(s,e,n,r){let o=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return n?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${r}`:o.pathname=`${o.pathname}.${r}`:o.pathname==="/"?o.pathname=`_root.${r}`:e&&fr(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${r}`,o}async function fT(s,e){if(s.id in e)return e[s.id];try{let n=await import(s.module);return e[s.id]=n,n}catch(n){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function mT(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function pT(s,e,n){let r=await Promise.all(s.map(async o=>{let u=e.routes[o.route.id];if(u){let d=await fT(u,n);return d.links?d.links():[]}return[]}));return yT(r.flat(1).filter(mT).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Dv(s,e,n,r,o,u){let d=(g,x)=>n[x]?g.route.id!==n[x].route.id:!0,p=(g,x)=>n[x].pathname!==g.pathname||n[x].route.path?.endsWith("*")&&n[x].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,x)=>d(g,x)||p(g,x)):u==="data"?e.filter((g,x)=>{let b=r.routes[g.route.id];if(!b||!b.hasLoader)return!1;if(d(g,x)||p(g,x))return!0;if(g.route.shouldRevalidate){let _=g.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function gT(s,e,{includeHydrateFallback:n}={}){return xT(s.map(r=>{let o=e.routes[r.route.id];if(!o)return[];let u=[o.module];return o.clientActionModule&&(u=u.concat(o.clientActionModule)),o.clientLoaderModule&&(u=u.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(u=u.concat(o.hydrateFallbackModule)),o.imports&&(u=u.concat(o.imports)),u}).flat(1))}function xT(s){return[...new Set(s)]}function bT(s){let e={},n=Object.keys(s).sort();for(let r of n)e[r]=s[r];return e}function yT(s,e){let n=new Set;return new Set(e),s.reduce((r,o)=>{let u=JSON.stringify(bT(o));return n.has(u)||(n.add(u),r.push({key:u,link:o})),r},[])}function s1(){let s=N.useContext(Ao);return $g(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function vT(){let s=N.useContext(Qh);return $g(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Gg=N.createContext(void 0);Gg.displayName="FrameworkContext";function a1(){let s=N.useContext(Gg);return $g(s,"You must render this element inside a <HydratedRouter> element"),s}function wT(s,e){let n=N.useContext(Gg),[r,o]=N.useState(!1),[u,d]=N.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:x,onMouseLeave:b,onTouchStart:_}=e,E=N.useRef(null);N.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let L=U=>{U.forEach(G=>{d(G.isIntersecting)})},O=new IntersectionObserver(L,{threshold:.5});return E.current&&O.observe(E.current),()=>{O.disconnect()}}},[s]),N.useEffect(()=>{if(r){let L=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(L)}}},[r]);let A=()=>{o(!0)},F=()=>{o(!1),d(!1)};return n?s!=="intent"?[u,E,{}]:[u,E,{onFocus:Pc(p,A),onBlur:Pc(g,F),onMouseEnter:Pc(x,A),onMouseLeave:Pc(b,F),onTouchStart:Pc(_,A)}]:[!1,E,{}]}function Pc(s,e){return n=>{s&&s(n),n.defaultPrevented||e(n)}}function _T({page:s,...e}){let{router:n}=s1(),r=N.useMemo(()=>H_(n.routes,s,n.basename),[n.routes,s,n.basename]);return r?N.createElement(ET,{page:s,matches:r,...e}):null}function NT(s){let{manifest:e,routeModules:n}=a1(),[r,o]=N.useState([]);return N.useEffect(()=>{let u=!1;return pT(s,e,n).then(d=>{u||o(d)}),()=>{u=!0}},[s,e,n]),r}function ET({page:s,matches:e,...n}){let r=bi(),{future:o,manifest:u,routeModules:d}=a1(),{basename:p}=s1(),{loaderData:g,matches:x}=vT(),b=N.useMemo(()=>Dv(s,e,x,u,r,"data"),[s,e,x,u,r]),_=N.useMemo(()=>Dv(s,e,x,u,r,"assets"),[s,e,x,u,r]),E=N.useMemo(()=>{if(s===r.pathname+r.search+r.hash)return[];let L=new Set,O=!1;if(e.forEach(G=>{let K=u.routes[G.route.id];!K||!K.hasLoader||(!b.some(fe=>fe.route.id===G.route.id)&&G.route.id in g&&d[G.route.id]?.shouldRevalidate||K.hasClientLoader?O=!0:L.add(G.route.id))}),L.size===0)return[];let U=hT(s,p,o.unstable_trailingSlashAwareDataRequests,"data");return O&&L.size>0&&U.searchParams.set("_routes",e.filter(G=>L.has(G.route.id)).map(G=>G.route.id).join(",")),[U.pathname+U.search]},[p,o.unstable_trailingSlashAwareDataRequests,g,r,u,b,e,s,d]),A=N.useMemo(()=>gT(_,u),[_,u]),F=NT(_);return N.createElement(N.Fragment,null,E.map(L=>N.createElement("link",{key:L,rel:"prefetch",as:"fetch",href:L,...n})),A.map(L=>N.createElement("link",{key:L,rel:"modulepreload",href:L,...n})),F.map(({key:L,link:O})=>N.createElement("link",{key:L,nonce:n.nonce,...O,crossOrigin:O.crossOrigin??n.crossOrigin})))}function ST(...s){return e=>{s.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var jT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{jT&&(window.__reactRouterVersion="7.13.0")}catch{}function TT({basename:s,children:e,unstable_useTransitions:n,window:r}){let o=N.useRef();o.current==null&&(o.current=ij({window:r,v5Compat:!0}));let u=o.current,[d,p]=N.useState({action:u.action,location:u.location}),g=N.useCallback(x=>{n===!1?p(x):N.startTransition(()=>p(x))},[n]);return N.useLayoutEffect(()=>u.listen(g),[u,g]),N.createElement(nT,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:n})}var r1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rt=N.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:o,reloadDocument:u,replace:d,state:p,target:g,to:x,preventScrollReset:b,viewTransition:_,unstable_defaultShouldRevalidate:E,...A},F){let{basename:L,unstable_useTransitions:O}=N.useContext(Os),U=typeof x=="string"&&r1.test(x),G=W_(x,L);x=G.to;let K=Bj(x,{relative:o}),[fe,he,oe]=wT(r,A),j=kT(x,{replace:d,state:p,target:g,preventScrollReset:b,relative:o,viewTransition:_,unstable_defaultShouldRevalidate:E,unstable_useTransitions:O});function T(V){e&&e(V),V.defaultPrevented||j(V)}let R=N.createElement("a",{...A,...oe,href:G.absoluteURL||K,onClick:G.isExternal||u?e:T,ref:ST(F,he),target:g,"data-discover":!U&&n==="render"?"true":void 0});return fe&&!U?N.createElement(N.Fragment,null,R,N.createElement(_T,{page:K})):R});rt.displayName="Link";var AT=N.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:o=!1,style:u,to:d,viewTransition:p,children:g,...x},b){let _=gu(d,{relative:x.relative}),E=bi(),A=N.useContext(Qh),{navigator:F,basename:L}=N.useContext(Os),O=A!=null&&PT(_)&&p===!0,U=F.encodeLocation?F.encodeLocation(_).pathname:_.pathname,G=E.pathname,K=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;n||(G=G.toLowerCase(),K=K?K.toLowerCase():null,U=U.toLowerCase()),K&&L&&(K=fr(K,L)||K);const fe=U!=="/"&&U.endsWith("/")?U.length-1:U.length;let he=G===U||!o&&G.startsWith(U)&&G.charAt(fe)==="/",oe=K!=null&&(K===U||!o&&K.startsWith(U)&&K.charAt(U.length)==="/"),j={isActive:he,isPending:oe,isTransitioning:O},T=he?e:void 0,R;typeof r=="function"?R=r(j):R=[r,he?"active":null,oe?"pending":null,O?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(j):u;return N.createElement(rt,{...x,"aria-current":T,className:R,ref:b,style:V,to:d,viewTransition:p},typeof g=="function"?g(j):g)});AT.displayName="NavLink";var CT=N.forwardRef(({discover:s="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:o,state:u,method:d=uh,action:p,onSubmit:g,relative:x,preventScrollReset:b,viewTransition:_,unstable_defaultShouldRevalidate:E,...A},F)=>{let{unstable_useTransitions:L}=N.useContext(Os),O=MT(),U=OT(p,{relative:x}),G=d.toLowerCase()==="get"?"get":"post",K=typeof p=="string"&&r1.test(p),fe=he=>{if(g&&g(he),he.defaultPrevented)return;he.preventDefault();let oe=he.nativeEvent.submitter,j=oe?.getAttribute("formmethod")||d,T=()=>O(oe||he.currentTarget,{fetcherKey:e,method:j,navigate:n,replace:o,state:u,relative:x,preventScrollReset:b,viewTransition:_,unstable_defaultShouldRevalidate:E});L&&n!==!1?N.startTransition(()=>T()):T()};return N.createElement("form",{ref:F,method:G,action:U,onSubmit:r?g:fe,...A,"data-discover":!K&&s==="render"?"true":void 0})});CT.displayName="Form";function RT(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function i1(s){let e=N.useContext(Ao);return Jt(e,RT(s)),e}function kT(s,{target:e,replace:n,state:r,preventScrollReset:o,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let x=Ro(),b=bi(),_=gu(s,{relative:u});return N.useCallback(E=>{if(oT(E,e)){E.preventDefault();let A=n!==void 0?n:su(b)===su(_),F=()=>x(s,{replace:A,state:r,preventScrollReset:o,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?N.startTransition(()=>F()):F()}},[b,x,_,n,r,e,s,o,u,d,p,g])}var IT=0,DT=()=>`__${String(++IT)}__`;function MT(){let{router:s}=i1("useSubmit"),{basename:e}=N.useContext(Os),n=Xj(),r=s.fetch,o=s.navigate;return N.useCallback(async(u,d={})=>{let{action:p,method:g,encType:x,formData:b,body:_}=dT(u,e);if(d.navigate===!1){let E=d.fetcherKey||DT();await r(E,n,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:_,formMethod:d.method||g,formEncType:d.encType||x,flushSync:d.flushSync})}else await o(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:_,formMethod:d.method||g,formEncType:d.encType||x,replace:d.replace,state:d.state,fromRouteId:n,flushSync:d.flushSync,viewTransition:d.viewTransition})},[r,o,e,n])}function OT(s,{relative:e}={}){let{basename:n}=N.useContext(Os),r=N.useContext(da);Jt(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),u={...gu(s||".",{relative:e})},d=bi();if(s==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(b=>b==="")){p.delete("index"),g.filter(_=>_).forEach(_=>p.append("index",_));let b=p.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&o.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(u.pathname=u.pathname==="/"?n:ur([n,u.pathname])),su(u)}function PT(s,{relative:e}={}){let n=N.useContext(Q_);Jt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=i1("useViewTransitionState"),o=gu(s,{relative:e});if(!n.isTransitioning)return!1;let u=fr(n.currentLocation.pathname,r)||n.currentLocation.pathname,d=fr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return jh(o.pathname,d)!=null||jh(o.pathname,u)!=null}const VT=()=>{};var Mv={};const l1=function(s){const e=[];let n=0;for(let r=0;r<s.length;r++){let o=s.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&r+1<s.length&&(s.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(s.charCodeAt(++r)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},LT=function(s){const e=[];let n=0,r=0;for(;n<s.length;){const o=s[n++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const u=s[n++];e[r++]=String.fromCharCode((o&31)<<6|u&63)}else if(o>239&&o<365){const u=s[n++],d=s[n++],p=s[n++],g=((o&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[r++]=String.fromCharCode(55296+(g>>10)),e[r++]=String.fromCharCode(56320+(g&1023))}else{const u=s[n++],d=s[n++];e[r++]=String.fromCharCode((o&15)<<12|(u&63)<<6|d&63)}}return e.join("")},o1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<s.length;o+=3){const u=s[o],d=o+1<s.length,p=d?s[o+1]:0,g=o+2<s.length,x=g?s[o+2]:0,b=u>>2,_=(u&3)<<4|p>>4;let E=(p&15)<<2|x>>6,A=x&63;g||(A=64,d||(E=64)),r.push(n[b],n[_],n[E],n[A])}return r.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(l1(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):LT(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<s.length;){const u=n[s.charAt(o++)],p=o<s.length?n[s.charAt(o)]:0;++o;const x=o<s.length?n[s.charAt(o)]:64;++o;const _=o<s.length?n[s.charAt(o)]:64;if(++o,u==null||p==null||x==null||_==null)throw new UT;const E=u<<2|p>>4;if(r.push(E),x!==64){const A=p<<4&240|x>>2;if(r.push(A),_!==64){const F=x<<6&192|_;r.push(F)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class UT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const BT=function(s){const e=l1(s);return o1.encodeByteArray(e,!0)},Th=function(s){return BT(s).replace(/\./g,"")},c1=function(s){try{return o1.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function zT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const qT=()=>zT().__FIREBASE_DEFAULTS__,FT=()=>{if(typeof process>"u"||typeof Mv>"u")return;const s=Mv.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},HT=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&c1(s[1]);return e&&JSON.parse(e)},Jh=()=>{try{return VT()||qT()||FT()||HT()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},u1=s=>Jh()?.emulatorHosts?.[s],d1=s=>{const e=u1(s);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},h1=()=>Jh()?.config,f1=s=>Jh()?.[`_${s}`];class $T{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}function yi(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Yg(s){return(await fetch(s,{credentials:"include"})).ok}function m1(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",o=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Th(JSON.stringify(n)),Th(JSON.stringify(d)),""].join(".")}const Kc={};function GT(){const s={prod:[],emulator:[]};for(const e of Object.keys(Kc))Kc[e]?s.emulator.push(e):s.prod.push(e);return s}function YT(s){let e=document.getElementById(s),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),n=!0),{created:n,element:e}}let Ov=!1;function Wg(s,e){if(typeof window>"u"||typeof document>"u"||!yi(window.location.host)||Kc[s]===e||Kc[s]||Ov)return;Kc[s]=e;function n(E){return`__firebase__banner__${E}`}const r="__firebase__banner",u=GT().prod.length>0;function d(){const E=document.getElementById(r);E&&E.remove()}function p(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function g(E,A){E.setAttribute("width","24"),E.setAttribute("id",A),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function x(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Ov=!0,d()},E}function b(E,A){E.setAttribute("id",A),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function _(){const E=YT(r),A=n("text"),F=document.getElementById(A)||document.createElement("span"),L=n("learnmore"),O=document.getElementById(L)||document.createElement("a"),U=n("preprendIcon"),G=document.getElementById(U)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const K=E.element;p(K),b(O,L);const fe=x();g(G,U),K.append(G,F,O,fe),document.body.appendChild(K)}u?(F.innerText="Preview backend disconnected.",G.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(G.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,F.innerText="Preview backend running in this workspace."),F.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function Wn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function WT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wn())}function KT(){const s=Jh()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function QT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function XT(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function JT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ZT(){const s=Wn();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function eA(){return!KT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function tA(){try{return typeof indexedDB=="object"}catch{return!1}}function nA(){return new Promise((s,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(r),s(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(n){e(n)}})}const sA="FirebaseError";class za extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=sA,Object.setPrototypeOf(this,za.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xu.prototype.create)}}class xu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},o=`${this.service}/${e}`,u=this.errors[e],d=u?aA(u,r):"Error",p=`${this.serviceName}: ${d} (${o}).`;return new za(o,p,r)}}function aA(s,e){return s.replace(rA,(n,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const rA=/\{\$([^}]+)}/g;function iA(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function rl(s,e){if(s===e)return!0;const n=Object.keys(s),r=Object.keys(e);for(const o of n){if(!r.includes(o))return!1;const u=s[o],d=e[o];if(Pv(u)&&Pv(d)){if(!rl(u,d))return!1}else if(u!==d)return!1}for(const o of r)if(!n.includes(o))return!1;return!0}function Pv(s){return s!==null&&typeof s=="object"}function bu(s){const e=[];for(const[n,r]of Object.entries(s))Array.isArray(r)?r.forEach(o=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function qc(s){const e={};return s.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[o,u]=r.split("=");e[decodeURIComponent(o)]=decodeURIComponent(u)}}),e}function Fc(s){const e=s.indexOf("?");if(!e)return"";const n=s.indexOf("#",e);return s.substring(e,n>0?n:void 0)}function lA(s,e){const n=new oA(s,e);return n.subscribe.bind(n)}class oA{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let o;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");cA(e,["next","error","complete"])?o=e:o={next:e,error:n,complete:r},o.next===void 0&&(o.next=Rp),o.error===void 0&&(o.error=Rp),o.complete===void 0&&(o.complete=Rp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cA(s,e){if(typeof s!="object"||s===null)return!1;for(const n of e)if(n in s&&typeof s[n]=="function")return!0;return!1}function Rp(){}function Zt(s){return s&&s._delegate?s._delegate:s}class ui{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const el="[DEFAULT]";class uA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new $T;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:n});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hA(e))try{this.getOrInitializeService({instanceIdentifier:el})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(n);try{const u=this.getOrInitializeService({instanceIdentifier:o});r.resolve(u)}catch{}}}}clearInstance(e=el){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=el){return this.instances.has(e)}getOptions(e=el){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);r===p&&d.resolve(o)}return o}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),o=this.onInitCallbacks.get(r)??new Set;o.add(e),this.onInitCallbacks.set(r,o);const u=this.instances.get(r);return u&&e(u,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const o of r)try{o(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:dA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=el){return this.component?this.component.multipleInstances?e:el:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function dA(s){return s===el?void 0:s}function hA(s){return s.instantiationMode==="EAGER"}class fA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new uA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var gt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(gt||(gt={}));const mA={debug:gt.DEBUG,verbose:gt.VERBOSE,info:gt.INFO,warn:gt.WARN,error:gt.ERROR,silent:gt.SILENT},pA=gt.INFO,gA={[gt.DEBUG]:"log",[gt.VERBOSE]:"log",[gt.INFO]:"info",[gt.WARN]:"warn",[gt.ERROR]:"error"},xA=(s,e,...n)=>{if(e<s.logLevel)return;const r=new Date().toISOString(),o=gA[e];if(o)console[o](`[${r}]  ${s.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kg{constructor(e){this.name=e,this._logLevel=pA,this._logHandler=xA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in gt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,gt.DEBUG,...e),this._logHandler(this,gt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,gt.VERBOSE,...e),this._logHandler(this,gt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,gt.INFO,...e),this._logHandler(this,gt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,gt.WARN,...e),this._logHandler(this,gt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,gt.ERROR,...e),this._logHandler(this,gt.ERROR,...e)}}const bA=(s,e)=>e.some(n=>s instanceof n);let Vv,Lv;function yA(){return Vv||(Vv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vA(){return Lv||(Lv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const p1=new WeakMap,sg=new WeakMap,g1=new WeakMap,kp=new WeakMap,Qg=new WeakMap;function wA(s){const e=new Promise((n,r)=>{const o=()=>{s.removeEventListener("success",u),s.removeEventListener("error",d)},u=()=>{n(ai(s.result)),o()},d=()=>{r(s.error),o()};s.addEventListener("success",u),s.addEventListener("error",d)});return e.then(n=>{n instanceof IDBCursor&&p1.set(n,s)}).catch(()=>{}),Qg.set(e,s),e}function _A(s){if(sg.has(s))return;const e=new Promise((n,r)=>{const o=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",d),s.removeEventListener("abort",d)},u=()=>{n(),o()},d=()=>{r(s.error||new DOMException("AbortError","AbortError")),o()};s.addEventListener("complete",u),s.addEventListener("error",d),s.addEventListener("abort",d)});sg.set(s,e)}let ag={get(s,e,n){if(s instanceof IDBTransaction){if(e==="done")return sg.get(s);if(e==="objectStoreNames")return s.objectStoreNames||g1.get(s);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ai(s[e])},set(s,e,n){return s[e]=n,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function NA(s){ag=s(ag)}function EA(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=s.call(Ip(this),e,...n);return g1.set(r,e.sort?e.sort():[e]),ai(r)}:vA().includes(s)?function(...e){return s.apply(Ip(this),e),ai(p1.get(this))}:function(...e){return ai(s.apply(Ip(this),e))}}function SA(s){return typeof s=="function"?EA(s):(s instanceof IDBTransaction&&_A(s),bA(s,yA())?new Proxy(s,ag):s)}function ai(s){if(s instanceof IDBRequest)return wA(s);if(kp.has(s))return kp.get(s);const e=SA(s);return e!==s&&(kp.set(s,e),Qg.set(e,s)),e}const Ip=s=>Qg.get(s);function jA(s,e,{blocked:n,upgrade:r,blocking:o,terminated:u}={}){const d=indexedDB.open(s,e),p=ai(d);return r&&d.addEventListener("upgradeneeded",g=>{r(ai(d.result),g.oldVersion,g.newVersion,ai(d.transaction),g)}),n&&d.addEventListener("blocked",g=>n(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),o&&g.addEventListener("versionchange",x=>o(x.oldVersion,x.newVersion,x))}).catch(()=>{}),p}const TA=["get","getKey","getAll","getAllKeys","count"],AA=["put","add","delete","clear"],Dp=new Map;function Uv(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Dp.get(e))return Dp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=AA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||TA.includes(n)))return;const u=async function(d,...p){const g=this.transaction(d,o?"readwrite":"readonly");let x=g.store;return r&&(x=x.index(p.shift())),(await Promise.all([x[n](...p),o&&g.done]))[0]};return Dp.set(e,u),u}NA(s=>({...s,get:(e,n,r)=>Uv(e,n)||s.get(e,n,r),has:(e,n)=>!!Uv(e,n)||s.has(e,n)}));class CA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(RA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function RA(s){return s.getComponent()?.type==="VERSION"}const rg="@firebase/app",Bv="0.14.7";const mr=new Kg("@firebase/app"),kA="@firebase/app-compat",IA="@firebase/analytics-compat",DA="@firebase/analytics",MA="@firebase/app-check-compat",OA="@firebase/app-check",PA="@firebase/auth",VA="@firebase/auth-compat",LA="@firebase/database",UA="@firebase/data-connect",BA="@firebase/database-compat",zA="@firebase/functions",qA="@firebase/functions-compat",FA="@firebase/installations",HA="@firebase/installations-compat",$A="@firebase/messaging",GA="@firebase/messaging-compat",YA="@firebase/performance",WA="@firebase/performance-compat",KA="@firebase/remote-config",QA="@firebase/remote-config-compat",XA="@firebase/storage",JA="@firebase/storage-compat",ZA="@firebase/firestore",e5="@firebase/ai",t5="@firebase/firestore-compat",n5="firebase",s5="12.8.0";const ig="[DEFAULT]",a5={[rg]:"fire-core",[kA]:"fire-core-compat",[DA]:"fire-analytics",[IA]:"fire-analytics-compat",[OA]:"fire-app-check",[MA]:"fire-app-check-compat",[PA]:"fire-auth",[VA]:"fire-auth-compat",[LA]:"fire-rtdb",[UA]:"fire-data-connect",[BA]:"fire-rtdb-compat",[zA]:"fire-fn",[qA]:"fire-fn-compat",[FA]:"fire-iid",[HA]:"fire-iid-compat",[$A]:"fire-fcm",[GA]:"fire-fcm-compat",[YA]:"fire-perf",[WA]:"fire-perf-compat",[KA]:"fire-rc",[QA]:"fire-rc-compat",[XA]:"fire-gcs",[JA]:"fire-gcs-compat",[ZA]:"fire-fst",[t5]:"fire-fst-compat",[e5]:"fire-vertex","fire-js":"fire-js",[n5]:"fire-js-all"};const Ah=new Map,r5=new Map,lg=new Map;function zv(s,e){try{s.container.addComponent(e)}catch(n){mr.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,n)}}function il(s){const e=s.name;if(lg.has(e))return mr.debug(`There were multiple attempts to register component ${e}.`),!1;lg.set(e,s);for(const n of Ah.values())zv(n,s);for(const n of r5.values())zv(n,s);return!0}function Zh(s,e){const n=s.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),s.container.getProvider(e)}function Cs(s){return s==null?!1:s.settings!==void 0}const i5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ri=new xu("app","Firebase",i5);class l5{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ui("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ri.create("app-deleted",{appName:this._name})}}const gl=s5;function x1(s,e={}){let n=s;typeof e!="object"&&(e={name:e});const r={name:ig,automaticDataCollectionEnabled:!0,...e},o=r.name;if(typeof o!="string"||!o)throw ri.create("bad-app-name",{appName:String(o)});if(n||(n=h1()),!n)throw ri.create("no-options");const u=Ah.get(o);if(u){if(rl(n,u.options)&&rl(r,u.config))return u;throw ri.create("duplicate-app",{appName:o})}const d=new fA(o);for(const g of lg.values())d.addComponent(g);const p=new l5(n,r,d);return Ah.set(o,p),p}function Xg(s=ig){const e=Ah.get(s);if(!e&&s===ig&&h1())return x1();if(!e)throw ri.create("no-app",{appName:s});return e}function ka(s,e,n){let r=a5[s]??s;n&&(r+=`-${n}`);const o=r.match(/\s|\//),u=e.match(/\s|\//);if(o||u){const d=[`Unable to register library "${r}" with version "${e}":`];o&&d.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),mr.warn(d.join(" "));return}il(new ui(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const o5="firebase-heartbeat-database",c5=1,au="firebase-heartbeat-store";let Mp=null;function b1(){return Mp||(Mp=jA(o5,c5,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(au)}catch(n){console.warn(n)}}}}).catch(s=>{throw ri.create("idb-open",{originalErrorMessage:s.message})})),Mp}async function u5(s){try{const n=(await b1()).transaction(au),r=await n.objectStore(au).get(y1(s));return await n.done,r}catch(e){if(e instanceof za)mr.warn(e.message);else{const n=ri.create("idb-get",{originalErrorMessage:e?.message});mr.warn(n.message)}}}async function qv(s,e){try{const r=(await b1()).transaction(au,"readwrite");await r.objectStore(au).put(e,y1(s)),await r.done}catch(n){if(n instanceof za)mr.warn(n.message);else{const r=ri.create("idb-set",{originalErrorMessage:n?.message});mr.warn(r.message)}}}function y1(s){return`${s.name}!${s.options.appId}`}const d5=1024,h5=30;class f5{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new p5(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Fv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>h5){const o=g5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){mr.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Fv(),{heartbeatsToSend:n,unsentEntries:r}=m5(this._heartbeatsCache.heartbeats),o=Th(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return mr.warn(e),""}}}function Fv(){return new Date().toISOString().substring(0,10)}function m5(s,e=d5){const n=[];let r=s.slice();for(const o of s){const u=n.find(d=>d.agent===o.agent);if(u){if(u.dates.push(o.date),Hv(n)>e){u.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),Hv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class p5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return tA()?nA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await u5(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return qv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return qv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Hv(s){return Th(JSON.stringify({version:2,heartbeats:s})).length}function g5(s){if(s.length===0)return-1;let e=0,n=s[0].date;for(let r=1;r<s.length;r++)s[r].date<n&&(n=s[r].date,e=r);return e}function x5(s){il(new ui("platform-logger",e=>new CA(e),"PRIVATE")),il(new ui("heartbeat",e=>new f5(e),"PRIVATE")),ka(rg,Bv,s),ka(rg,Bv,"esm2020"),ka("fire-js","")}x5("");function v1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const b5=v1,w1=new xu("auth","Firebase",v1());const Ch=new Kg("@firebase/auth");function y5(s,...e){Ch.logLevel<=gt.WARN&&Ch.warn(`Auth (${gl}): ${s}`,...e)}function hh(s,...e){Ch.logLevel<=gt.ERROR&&Ch.error(`Auth (${gl}): ${s}`,...e)}function ca(s,...e){throw Jg(s,...e)}function Ia(s,...e){return Jg(s,...e)}function _1(s,e,n){const r={...b5(),[e]:n};return new xu("auth","Firebase",r).create(e,{appName:s.name})}function dr(s){return _1(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Jg(s,...e){if(typeof s!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=s.name),s._errorFactory.create(n,...r)}return w1.create(s,...e)}function Ke(s,e,...n){if(!s)throw Jg(e,...n)}function or(s){const e="INTERNAL ASSERTION FAILED: "+s;throw hh(e),new Error(e)}function pr(s,e){s||or(e)}function og(){return typeof self<"u"&&self.location?.href||""}function v5(){return $v()==="http:"||$v()==="https:"}function $v(){return typeof self<"u"&&self.location?.protocol||null}function w5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(v5()||XT()||"connection"in navigator)?navigator.onLine:!0}function _5(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class yu{constructor(e,n){this.shortDelay=e,this.longDelay=n,pr(n>e,"Short delay should be less than long delay!"),this.isMobile=WT()||JT()}get(){return w5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Zg(s,e){pr(s.emulator,"Emulator should always be set here");const{url:n}=s.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class N1{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;or("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;or("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;or("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const N5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const E5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],S5=new yu(3e4,6e4);function vi(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function wi(s,e,n,r,o={}){return E1(s,o,async()=>{let u={},d={};r&&(e==="GET"?d=r:u={body:JSON.stringify(r)});const p=bu({key:s.config.apiKey,...d}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const x={method:e,headers:g,...u};return QT()||(x.referrerPolicy="no-referrer"),s.emulatorConfig&&yi(s.emulatorConfig.host)&&(x.credentials="include"),N1.fetch()(await S1(s,s.config.apiHost,n,p),x)})}async function E1(s,e,n){s._canInitEmulator=!1;const r={...N5,...e};try{const o=new T5(s),u=await Promise.race([n(),o.promise]);o.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw Jd(s,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,x]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jd(s,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw Jd(s,"email-already-in-use",d);if(g==="USER_DISABLED")throw Jd(s,"user-disabled",d);const b=r[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(x)throw _1(s,b,x);ca(s,b)}}catch(o){if(o instanceof za)throw o;ca(s,"network-request-failed",{message:String(o)})}}async function vu(s,e,n,r,o={}){const u=await wi(s,e,n,r,o);return"mfaPendingCredential"in u&&ca(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function S1(s,e,n,r){const o=`${e}${n}?${r}`,u=s,d=u.config.emulator?Zg(s.config,o):`${s.config.apiScheme}://${o}`;return E5.includes(n)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function j5(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class T5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ia(this.auth,"network-request-failed")),S5.get())})}}function Jd(s,e,n){const r={appName:s.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const o=Ia(s,e,r);return o.customData._tokenResponse=n,o}function Gv(s){return s!==void 0&&s.enterprise!==void 0}class A5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return j5(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function C5(s,e){return wi(s,"GET","/v2/recaptchaConfig",vi(s,e))}async function R5(s,e){return wi(s,"POST","/v1/accounts:delete",e)}async function Rh(s,e){return wi(s,"POST","/v1/accounts:lookup",e)}function Qc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function k5(s,e=!1){const n=Zt(s),r=await n.getIdToken(e),o=e0(r);Ke(o&&o.exp&&o.auth_time&&o.iat,n.auth,"internal-error");const u=typeof o.firebase=="object"?o.firebase:void 0,d=u?.sign_in_provider;return{claims:o,token:r,authTime:Qc(Op(o.auth_time)),issuedAtTime:Qc(Op(o.iat)),expirationTime:Qc(Op(o.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Op(s){return Number(s)*1e3}function e0(s){const[e,n,r]=s.split(".");if(e===void 0||n===void 0||r===void 0)return hh("JWT malformed, contained fewer than 3 sections"),null;try{const o=c1(n);return o?JSON.parse(o):(hh("Failed to decode base64 JWT payload"),null)}catch(o){return hh("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Yv(s){const e=e0(s);return Ke(e,"internal-error"),Ke(typeof e.exp<"u","internal-error"),Ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ru(s,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof za&&I5(r)&&s.auth.currentUser===s&&await s.auth.signOut(),r}}function I5({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class D5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class cg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qc(this.lastLoginAt),this.creationTime=Qc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function kh(s){const e=s.auth,n=await s.getIdToken(),r=await ru(s,Rh(e,{idToken:n}));Ke(r?.users.length,e,"internal-error");const o=r.users[0];s._notifyReloadListener(o);const u=o.providerUserInfo?.length?j1(o.providerUserInfo):[],d=O5(s.providerData,u),p=s.isAnonymous,g=!(s.email&&o.passwordHash)&&!d?.length,x=p?g:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new cg(o.createdAt,o.lastLoginAt),isAnonymous:x};Object.assign(s,b)}async function M5(s){const e=Zt(s);await kh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function O5(s,e){return[...s.filter(r=>!e.some(o=>o.providerId===r.providerId)),...e]}function j1(s){return s.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function P5(s,e){const n=await E1(s,{},async()=>{const r=bu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:u}=s.config,d=await S1(s,o,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:r};return s.emulatorConfig&&yi(s.emulatorConfig.host)&&(g.credentials="include"),N1.fetch()(d,g)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function V5(s,e){return wi(s,"POST","/v2/accounts:revokeToken",vi(s,e))}class mo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ke(e.idToken,"internal-error"),Ke(typeof e.idToken<"u","internal-error"),Ke(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ke(e.length!==0,"internal-error");const n=Yv(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:o,expiresIn:u}=await P5(e,n);this.updateTokensAndExpiration(r,o,Number(u))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:o,expirationTime:u}=n,d=new mo;return r&&(Ke(typeof r=="string","internal-error",{appName:e}),d.refreshToken=r),o&&(Ke(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),u&&(Ke(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new mo,this.toJSON())}_performRefresh(){return or("not implemented")}}function Xr(s,e){Ke(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class la{constructor({uid:e,auth:n,stsTokenManager:r,...o}){this.providerId="firebase",this.proactiveRefresh=new D5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new cg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await ru(this,this.stsTokenManager.getToken(this.auth,e));return Ke(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return k5(this,e)}reload(){return M5(this)}_assign(e){this!==e&&(Ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new la({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await kh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Cs(this.auth.app))return Promise.reject(dr(this.auth));const e=await this.getIdToken();return await ru(this,R5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,o=n.email??void 0,u=n.phoneNumber??void 0,d=n.photoURL??void 0,p=n.tenantId??void 0,g=n._redirectEventId??void 0,x=n.createdAt??void 0,b=n.lastLoginAt??void 0,{uid:_,emailVerified:E,isAnonymous:A,providerData:F,stsTokenManager:L}=n;Ke(_&&L,e,"internal-error");const O=mo.fromJSON(this.name,L);Ke(typeof _=="string",e,"internal-error"),Xr(r,e.name),Xr(o,e.name),Ke(typeof E=="boolean",e,"internal-error"),Ke(typeof A=="boolean",e,"internal-error"),Xr(u,e.name),Xr(d,e.name),Xr(p,e.name),Xr(g,e.name),Xr(x,e.name),Xr(b,e.name);const U=new la({uid:_,auth:e,email:o,emailVerified:E,displayName:r,isAnonymous:A,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:O,createdAt:x,lastLoginAt:b});return F&&Array.isArray(F)&&(U.providerData=F.map(G=>({...G}))),g&&(U._redirectEventId=g),U}static async _fromIdTokenResponse(e,n,r=!1){const o=new mo;o.updateFromServerResponse(n);const u=new la({uid:n.localId,auth:e,stsTokenManager:o,isAnonymous:r});return await kh(u),u}static async _fromGetAccountInfoResponse(e,n,r){const o=n.users[0];Ke(o.localId!==void 0,"internal-error");const u=o.providerUserInfo!==void 0?j1(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!u?.length,p=new mo;p.updateFromIdToken(r);const g=new la({uid:o.localId,auth:e,stsTokenManager:p,isAnonymous:d}),x={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new cg(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!u?.length};return Object.assign(g,x),g}}const Wv=new Map;function cr(s){pr(s instanceof Function,"Expected a class definition");let e=Wv.get(s);return e?(pr(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,Wv.set(s,e),e)}class T1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}T1.type="NONE";const Kv=T1;function fh(s,e,n){return`firebase:${s}:${e}:${n}`}class po{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:o,name:u}=this.auth;this.fullUserKey=fh(this.userKey,o.apiKey,u),this.fullPersistenceKey=fh("persistence",o.apiKey,u),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Rh(this.auth,{idToken:e}).catch(()=>{});return n?la._fromGetAccountInfoResponse(this.auth,n,e):null}return la._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new po(cr(Kv),e,r);const o=(await Promise.all(n.map(async x=>{if(await x._isAvailable())return x}))).filter(x=>x);let u=o[0]||cr(Kv);const d=fh(r,e.config.apiKey,e.name);let p=null;for(const x of n)try{const b=await x._get(d);if(b){let _;if(typeof b=="string"){const E=await Rh(e,{idToken:b}).catch(()=>{});if(!E)break;_=await la._fromGetAccountInfoResponse(e,E,b)}else _=la._fromJSON(e,b);x!==u&&(p=_),u=x;break}}catch{}const g=o.filter(x=>x._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new po(u,e,r):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(n.map(async x=>{if(x!==u)try{await x._remove(d)}catch{}})),new po(u,e,r))}}function Qv(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(k1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(A1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(D1(e))return"Blackberry";if(M1(e))return"Webos";if(C1(e))return"Safari";if((e.includes("chrome/")||R1(e))&&!e.includes("edge/"))return"Chrome";if(I1(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=s.match(n);if(r?.length===2)return r[1]}return"Other"}function A1(s=Wn()){return/firefox\//i.test(s)}function C1(s=Wn()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function R1(s=Wn()){return/crios\//i.test(s)}function k1(s=Wn()){return/iemobile/i.test(s)}function I1(s=Wn()){return/android/i.test(s)}function D1(s=Wn()){return/blackberry/i.test(s)}function M1(s=Wn()){return/webos/i.test(s)}function t0(s=Wn()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function L5(s=Wn()){return t0(s)&&!!window.navigator?.standalone}function U5(){return ZT()&&document.documentMode===10}function O1(s=Wn()){return t0(s)||I1(s)||M1(s)||D1(s)||/windows phone/i.test(s)||k1(s)}function P1(s,e=[]){let n;switch(s){case"Browser":n=Qv(Wn());break;case"Worker":n=`${Qv(Wn())}-${s}`;break;default:n=s}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${gl}/${r}`}class B5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});r.onAbort=n,this.queue.push(r);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const o of n)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function z5(s,e={}){return wi(s,"GET","/v2/passwordPolicy",vi(s,e))}const q5=6;class F5{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??q5,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),o&&(n.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let o=0;o<e.length;o++)r=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,o,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class H5{constructor(e,n,r,o){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Xv(this),this.idTokenSubscription=new Xv(this),this.beforeStateQueue=new B5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=w1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=cr(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await po.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Rh(this,{idToken:e}),r=await la._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Cs(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=r?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(r=p.user,o=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(r)}catch(u){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await kh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Cs(this.app))return Promise.reject(dr(this));const n=e?Zt(e):null;return n&&Ke(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Cs(this.app)?Promise.reject(dr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Cs(this.app)?Promise.reject(dr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(cr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await z5(this),n=new F5(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await V5(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&cr(e)||this._popupRedirectResolver;Ke(n,this,"argument-error"),this.redirectPersistenceManager=await po.create(this,[cr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,o){if(this._deleted)return()=>{};const u=typeof n=="function"?n:n.next.bind(n);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ke(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof n=="function"){const g=e.addObserver(n,r,o);return()=>{d=!0,g()}}else{const g=e.addObserver(n);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=P1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Cs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&y5(`Error while retrieving App Check token: ${e.error}`),e?.token}}function xl(s){return Zt(s)}class Xv{constructor(e){this.auth=e,this.observer=null,this.addObserver=lA(n=>this.observer=n)}get next(){return Ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ef={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $5(s){ef=s}function V1(s){return ef.loadJS(s)}function G5(){return ef.recaptchaEnterpriseScript}function Y5(){return ef.gapiScript}function W5(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class K5{constructor(){this.enterprise=new Q5}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Q5{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const X5="recaptcha-enterprise",L1="NO_RECAPTCHA";class J5{constructor(e){this.type=X5,this.auth=xl(e)}async verify(e="verify",n=!1){async function r(u){if(!n){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{C5(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const x=new A5(g);return u.tenantId==null?u._agentRecaptchaConfig=x:u._tenantRecaptchaConfigs[u.tenantId]=x,d(x.siteKey)}}).catch(g=>{p(g)})})}function o(u,d,p){const g=window.grecaptcha;Gv(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(x=>{d(x)}).catch(()=>{d(L1)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new K5().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{r(this.auth).then(p=>{if(!n&&Gv(window.grecaptcha))o(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=G5();g.length!==0&&(g+=p),V1(g).then(()=>{o(p,u,d)}).catch(x=>{d(x)})}}).catch(p=>{d(p)})})}}async function Jv(s,e,n,r=!1,o=!1){const u=new J5(s);let d;if(o)d=L1;else try{d=await u.verify(n)}catch{d=await u.verify(n,!0)}const p={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,x=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:x,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return r?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function ug(s,e,n,r,o){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await Jv(s,e,n,n==="getOobCode");return r(s,u)}else return r(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Jv(s,e,n,n==="getOobCode");return r(s,d)}else return Promise.reject(u)})}function Z5(s,e){const n=Zh(s,"auth");if(n.isInitialized()){const o=n.getImmediate(),u=n.getOptions();if(rl(u,e??{}))return o;ca(o,"already-initialized")}return n.initialize({options:e})}function eC(s,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(cr);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(r,e?.popupRedirectResolver)}function tC(s,e,n){const r=xl(s);Ke(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const o=!1,u=U1(e),{host:d,port:p}=nC(e),g=p===null?"":`:${p}`,x={url:`${u}//${d}${g}/`},b=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!r._canInitEmulator){Ke(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ke(rl(x,r.config.emulator)&&rl(b,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=x,r.emulatorConfig=b,r.settings.appVerificationDisabledForTesting=!0,yi(d)?(Yg(`${u}//${d}${g}`),Wg("Auth",!0)):sC()}function U1(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function nC(s){const e=U1(s),n=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(r);if(o){const u=o[1];return{host:u,port:Zv(r.substr(u.length+1))}}else{const[u,d]=r.split(":");return{host:u,port:Zv(d)}}}function Zv(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function sC(){function s(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class n0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return or("not implemented")}_getIdTokenResponse(e){return or("not implemented")}_linkToIdToken(e,n){return or("not implemented")}_getReauthenticationResolver(e){return or("not implemented")}}async function aC(s,e){return wi(s,"POST","/v1/accounts:signUp",e)}async function rC(s,e){return vu(s,"POST","/v1/accounts:signInWithPassword",vi(s,e))}async function iC(s,e){return vu(s,"POST","/v1/accounts:signInWithEmailLink",vi(s,e))}async function lC(s,e){return vu(s,"POST","/v1/accounts:signInWithEmailLink",vi(s,e))}class iu extends n0{constructor(e,n,r,o=null){super("password",r),this._email=e,this._password=n,this._tenantId=o}static _fromEmailAndPassword(e,n){return new iu(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new iu(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ug(e,n,"signInWithPassword",rC);case"emailLink":return iC(e,{email:this._email,oobCode:this._password});default:ca(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ug(e,r,"signUpPassword",aC);case"emailLink":return lC(e,{idToken:n,email:this._email,oobCode:this._password});default:ca(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function go(s,e){return vu(s,"POST","/v1/accounts:signInWithIdp",vi(s,e))}const oC="http://localhost";class ll extends n0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ll(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ca("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:o,...u}=n;if(!r||!o)return null;const d=new ll(r,o);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const n=this.buildRequest();return go(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,go(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,go(e,n)}buildRequest(){const e={requestUri:oC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=bu(n)}return e}}function cC(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function uC(s){const e=qc(Fc(s)).link,n=e?qc(Fc(e)).deep_link_id:null,r=qc(Fc(s)).deep_link_id;return(r?qc(Fc(r)).link:null)||r||n||e||s}class s0{constructor(e){const n=qc(Fc(e)),r=n.apiKey??null,o=n.oobCode??null,u=cC(n.mode??null);Ke(r&&o&&u,"argument-error"),this.apiKey=r,this.operation=u,this.code=o,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=uC(e);try{return new s0(n)}catch{return null}}}class Io{constructor(){this.providerId=Io.PROVIDER_ID}static credential(e,n){return iu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=s0.parseLink(n);return Ke(r,"argument-error"),iu._fromEmailAndCode(e,r.code,r.tenantId)}}Io.PROVIDER_ID="password";Io.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Io.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class B1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class wu extends B1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Jr extends wu{constructor(){super("facebook.com")}static credential(e){return ll._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Jr.credential(e.oauthAccessToken)}catch{return null}}}Jr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Jr.PROVIDER_ID="facebook.com";class Zr extends wu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ll._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Zr.credential(n,r)}catch{return null}}}Zr.GOOGLE_SIGN_IN_METHOD="google.com";Zr.PROVIDER_ID="google.com";class ei extends wu{constructor(){super("github.com")}static credential(e){return ll._fromParams({providerId:ei.PROVIDER_ID,signInMethod:ei.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ei.credentialFromTaggedObject(e)}static credentialFromError(e){return ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ei.credential(e.oauthAccessToken)}catch{return null}}}ei.GITHUB_SIGN_IN_METHOD="github.com";ei.PROVIDER_ID="github.com";class ti extends wu{constructor(){super("twitter.com")}static credential(e,n){return ll._fromParams({providerId:ti.PROVIDER_ID,signInMethod:ti.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ti.credentialFromTaggedObject(e)}static credentialFromError(e){return ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ti.credential(n,r)}catch{return null}}}ti.TWITTER_SIGN_IN_METHOD="twitter.com";ti.PROVIDER_ID="twitter.com";async function dC(s,e){return vu(s,"POST","/v1/accounts:signUp",vi(s,e))}class ol{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,o=!1){const u=await la._fromIdTokenResponse(e,r,o),d=ew(r);return new ol({user:u,providerId:d,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const o=ew(r);return new ol({user:e,providerId:o,_tokenResponse:r,operationType:n})}}function ew(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Ih extends za{constructor(e,n,r,o){super(n.code,n.message),this.operationType=r,this.user=o,Object.setPrototypeOf(this,Ih.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,o){return new Ih(e,n,r,o)}}function z1(s,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(s):n._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Ih._fromErrorAndOperation(s,u,e,r):u})}async function hC(s,e,n=!1){const r=await ru(s,e._linkToIdToken(s.auth,await s.getIdToken()),n);return ol._forOperation(s,"link",r)}async function fC(s,e,n=!1){const{auth:r}=s;if(Cs(r.app))return Promise.reject(dr(r));const o="reauthenticate";try{const u=await ru(s,z1(r,o,e,s),n);Ke(u.idToken,r,"internal-error");const d=e0(u.idToken);Ke(d,r,"internal-error");const{sub:p}=d;return Ke(s.uid===p,r,"user-mismatch"),ol._forOperation(s,o,u)}catch(u){throw u?.code==="auth/user-not-found"&&ca(r,"user-mismatch"),u}}async function q1(s,e,n=!1){if(Cs(s.app))return Promise.reject(dr(s));const r="signIn",o=await z1(s,r,e),u=await ol._fromIdTokenResponse(s,r,o);return n||await s._updateCurrentUser(u.user),u}async function mC(s,e){return q1(xl(s),e)}async function F1(s){const e=xl(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function pC(s,e,n){if(Cs(s.app))return Promise.reject(dr(s));const r=xl(s),d=await ug(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",dC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&F1(s),g}),p=await ol._fromIdTokenResponse(r,"signIn",d);return await r._updateCurrentUser(p.user),p}function H1(s,e,n){return Cs(s.app)?Promise.reject(dr(s)):mC(Zt(s),Io.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&F1(s),r})}function gC(s,e,n,r){return Zt(s).onIdTokenChanged(e,n,r)}function xC(s,e,n){return Zt(s).beforeAuthStateChanged(e,n)}function bC(s,e,n,r){return Zt(s).onAuthStateChanged(e,n,r)}function yC(s){return Zt(s).signOut()}const Dh="__sak";class $1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Dh,"1"),this.storage.removeItem(Dh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const vC=1e3,wC=10;class G1 extends $1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=O1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),o=this.localCache[n];r!==o&&e(n,o,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const r=e.key;n?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(r);!n&&this.localCache[r]===d||this.notifyListeners(r,d)},u=this.storage.getItem(r);U5()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,wC):o()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},vC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}G1.type="LOCAL";const _C=G1;class Y1 extends $1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Y1.type="SESSION";const W1=Y1;function NC(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class tf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(o=>o.isListeningto(e));if(n)return n;const r=new tf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:o,data:u}=n.data,d=this.handlersMap[o];if(!d?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:o});const p=Array.from(d).map(async x=>x(n.origin,u)),g=await NC(p);n.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:g})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tf.receivers=[];function a0(s="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return s+n}class EC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const x=a0("",20);o.port1.start();const b=setTimeout(()=>{g(new Error("unsupported_event"))},r);d={messageChannel:o,onMessage(_){const E=_;if(E.data.eventId===x)switch(E.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(E.data.response);break;default:clearTimeout(b),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:x,data:n},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Da(){return window}function SC(s){Da().location.href=s}function K1(){return typeof Da().WorkerGlobalScope<"u"&&typeof Da().importScripts=="function"}async function jC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function TC(){return navigator?.serviceWorker?.controller||null}function AC(){return K1()?self:null}const Q1="firebaseLocalStorageDb",CC=1,Mh="firebaseLocalStorage",X1="fbase_key";class _u{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function nf(s,e){return s.transaction([Mh],e?"readwrite":"readonly").objectStore(Mh)}function RC(){const s=indexedDB.deleteDatabase(Q1);return new _u(s).toPromise()}function dg(){const s=indexedDB.open(Q1,CC);return new Promise((e,n)=>{s.addEventListener("error",()=>{n(s.error)}),s.addEventListener("upgradeneeded",()=>{const r=s.result;try{r.createObjectStore(Mh,{keyPath:X1})}catch(o){n(o)}}),s.addEventListener("success",async()=>{const r=s.result;r.objectStoreNames.contains(Mh)?e(r):(r.close(),await RC(),e(await dg()))})})}async function tw(s,e,n){const r=nf(s,!0).put({[X1]:e,value:n});return new _u(r).toPromise()}async function kC(s,e){const n=nf(s,!1).get(e),r=await new _u(n).toPromise();return r===void 0?null:r.value}function nw(s,e){const n=nf(s,!0).delete(e);return new _u(n).toPromise()}const IC=800,DC=3;class J1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>DC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return K1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tf._getInstance(AC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await jC(),!this.activeServiceWorker)return;this.sender=new EC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||TC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await dg();return await tw(e,Dh,"1"),await nw(e,Dh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>tw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>kC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>nw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const u=nf(o,!1).getAll();return new _u(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:o,value:u}of e)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(u)&&(this.notifyListeners(o,u),n.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),n.push(o));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),IC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}J1.type="LOCAL";const MC=J1;new yu(3e4,6e4);function OC(s,e){return e?cr(e):(Ke(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class r0 extends n0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return go(e,this._buildIdpRequest())}_linkToIdToken(e,n){return go(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return go(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function PC(s){return q1(s.auth,new r0(s),s.bypassAuthState)}function VC(s){const{auth:e,user:n}=s;return Ke(n,e,"internal-error"),fC(n,new r0(s),s.bypassAuthState)}async function LC(s){const{auth:e,user:n}=s;return Ke(n,e,"internal-error"),hC(n,new r0(s),s.bypassAuthState)}class Z1{constructor(e,n,r,o,u=!1){this.auth=e,this.resolver=r,this.user=o,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:o,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:n,sessionId:r,tenantId:u||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(x){this.reject(x)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return PC;case"linkViaPopup":case"linkViaRedirect":return LC;case"reauthViaPopup":case"reauthViaRedirect":return VC;default:ca(this.auth,"internal-error")}}resolve(e){pr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const UC=new yu(2e3,1e4);class uo extends Z1{constructor(e,n,r,o,u){super(e,n,o,u),this.provider=r,this.authWindow=null,this.pollId=null,uo.currentPopupAction&&uo.currentPopupAction.cancel(),uo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ke(e,this.auth,"internal-error"),e}async onExecution(){pr(this.filter.length===1,"Popup operations only handle one event");const e=a0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ia(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ia(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,uo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ia(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,UC.get())};e()}}uo.currentPopupAction=null;const BC="pendingRedirect",mh=new Map;class zC extends Z1{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=mh.get(this.auth._key());if(!e){try{const r=await qC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}mh.set(this.auth._key(),e)}return this.bypassAuthState||mh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qC(s,e){const n=$C(e),r=HC(s);if(!await r._isAvailable())return!1;const o=await r._get(n)==="true";return await r._remove(n),o}function FC(s,e){mh.set(s._key(),e)}function HC(s){return cr(s._redirectPersistence)}function $C(s){return fh(BC,s.config.apiKey,s.name)}async function GC(s,e,n=!1){if(Cs(s.app))return Promise.reject(dr(s));const r=xl(s),o=OC(r,e),d=await new zC(r,o,n).execute();return d&&!n&&(delete d.user._redirectEventId,await r._persistUserIfCurrent(d.user),await r._setRedirectUser(null,e)),d}const YC=600*1e3;class WC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KC(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!eN(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Ia(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=YC&&this.cachedEventUids.clear(),this.cachedEventUids.has(sw(e))}saveEventToCache(e){this.cachedEventUids.add(sw(e)),this.lastProcessedEventTime=Date.now()}}function sw(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function eN({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function KC(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eN(s);default:return!1}}async function QC(s,e={}){return wi(s,"GET","/v1/projects",e)}const XC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,JC=/^https?/;async function ZC(s){if(s.config.emulator)return;const{authorizedDomains:e}=await QC(s);for(const n of e)try{if(eR(n))return}catch{}ca(s,"unauthorized-domain")}function eR(s){const e=og(),{protocol:n,hostname:r}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&r===""?n==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&d.hostname===r}if(!JC.test(n))return!1;if(XC.test(s))return r===s;const o=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(r)}const tR=new yu(3e4,6e4);function aw(){const s=Da().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let n=0;n<s.CP.length;n++)s.CP[n]=null}}function nR(s){return new Promise((e,n)=>{function r(){aw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{aw(),n(Ia(s,"network-request-failed"))},timeout:tR.get()})}if(Da().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Da().gapi?.load)r();else{const o=W5("iframefcb");return Da()[o]=()=>{gapi.load?r():n(Ia(s,"network-request-failed"))},V1(`${Y5()}?onload=${o}`).catch(u=>n(u))}}).catch(e=>{throw ph=null,e})}let ph=null;function sR(s){return ph=ph||nR(s),ph}const aR=new yu(5e3,15e3),rR="__/auth/iframe",iR="emulator/auth/iframe",lR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function cR(s){const e=s.config;Ke(e.authDomain,s,"auth-domain-config-required");const n=e.emulator?Zg(e,iR):`https://${s.config.authDomain}/${rR}`,r={apiKey:e.apiKey,appName:s.name,v:gl},o=oR.get(s.config.apiHost);o&&(r.eid=o);const u=s._getFrameworks();return u.length&&(r.fw=u.join(",")),`${n}?${bu(r).slice(1)}`}async function uR(s){const e=await sR(s),n=Da().gapi;return Ke(n,s,"internal-error"),e.open({where:document.body,url:cR(s),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lR,dontclear:!0},r=>new Promise(async(o,u)=>{await r.restyle({setHideOnLeave:!1});const d=Ia(s,"network-request-failed"),p=Da().setTimeout(()=>{u(d)},aR.get());function g(){Da().clearTimeout(p),o(r)}r.ping(g).then(g,()=>{u(d)})}))}const dR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hR=500,fR=600,mR="_blank",pR="http://localhost";class rw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function gR(s,e,n,r=hR,o=fR){const u=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-r)/2,0).toString();let p="";const g={...dR,width:r.toString(),height:o.toString(),top:u,left:d},x=Wn().toLowerCase();n&&(p=R1(x)?mR:n),A1(x)&&(e=e||pR,g.scrollbars="yes");const b=Object.entries(g).reduce((E,[A,F])=>`${E}${A}=${F},`,"");if(L5(x)&&p!=="_self")return xR(e||"",p),new rw(null);const _=window.open(e||"",p,b);Ke(_,s,"popup-blocked");try{_.focus()}catch{}return new rw(_)}function xR(s,e){const n=document.createElement("a");n.href=s,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const bR="__/auth/handler",yR="emulator/auth/handler",vR=encodeURIComponent("fac");async function iw(s,e,n,r,o,u){Ke(s.config.authDomain,s,"auth-domain-config-required"),Ke(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:n,redirectUrl:r,v:gl,eventId:o};if(e instanceof B1){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",iA(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,_]of Object.entries({}))d[b]=_}if(e instanceof wu){const b=e.getScopes().filter(_=>_!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const p=d;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const g=await s._getAppCheckToken(),x=g?`#${vR}=${encodeURIComponent(g)}`:"";return`${wR(s)}?${bu(p).slice(1)}${x}`}function wR({config:s}){return s.emulator?Zg(s,yR):`https://${s.authDomain}/${bR}`}const Pp="webStorageSupport";class _R{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=W1,this._completeRedirectFn=GC,this._overrideRedirectResult=FC}async _openPopup(e,n,r,o){pr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await iw(e,n,r,og(),o);return gR(e,u,a0())}async _openRedirect(e,n,r,o){await this._originValidation(e);const u=await iw(e,n,r,og(),o);return SC(u),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:o,promise:u}=this.eventManagers[n];return o?Promise.resolve(o):(pr(u,"If manager is not set, promise should be"),u)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await uR(e),r=new WC(e);return n.register("authEvent",o=>(Ke(o?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Pp,{type:Pp},o=>{const u=o?.[0]?.[Pp];u!==void 0&&n(!!u),ca(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=ZC(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return O1()||C1()||t0()}}const NR=_R;var lw="@firebase/auth",ow="1.12.0";class ER{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function SR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function jR(s){il(new ui("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=r.options;Ke(d&&!d.includes(":"),"invalid-api-key",{appName:r.name});const g={apiKey:d,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:P1(s)},x=new H5(r,o,u,g);return eC(x,n),x},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),il(new ui("auth-internal",e=>{const n=xl(e.getProvider("auth").getImmediate());return(r=>new ER(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ka(lw,ow,SR(s)),ka(lw,ow,"esm2020")}const TR=300,AR=f1("authIdTokenMaxAge")||TR;let cw=null;const CR=s=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>AR)return;const o=n?.token;cw!==o&&(cw=o,await fetch(s,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function RR(s=Xg()){const e=Zh(s,"auth");if(e.isInitialized())return e.getImmediate();const n=Z5(s,{popupRedirectResolver:NR,persistence:[MC,_C,W1]}),r=f1("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(r,location.origin);if(location.origin===u.origin){const d=CR(u.toString());xC(n,d,()=>d(n.currentUser)),gC(n,p=>d(p))}}const o=u1("auth");return o&&tC(n,`http://${o}`),n}function kR(){return document.getElementsByTagName("head")?.[0]??document}$5({loadJS(s){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",s),r.onload=e,r.onerror=o=>{const u=Ia("internal-error");u.customData=o,n(u)},r.type="text/javascript",r.charset="UTF-8",kR().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});jR("Browser");var IR="firebase",DR="12.8.0";ka(IR,DR,"app");var uw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ii,tN;(function(){var s;function e(j,T){function R(){}R.prototype=T.prototype,j.F=T.prototype,j.prototype=new R,j.prototype.constructor=j,j.D=function(V,M,z){for(var I=Array(arguments.length-2),q=2;q<arguments.length;q++)I[q-2]=arguments[q];return T.prototype[M].apply(V,I)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(j,T,R){R||(R=0);const V=Array(16);if(typeof T=="string")for(var M=0;M<16;++M)V[M]=T.charCodeAt(R++)|T.charCodeAt(R++)<<8|T.charCodeAt(R++)<<16|T.charCodeAt(R++)<<24;else for(M=0;M<16;++M)V[M]=T[R++]|T[R++]<<8|T[R++]<<16|T[R++]<<24;T=j.g[0],R=j.g[1],M=j.g[2];let z=j.g[3],I;I=T+(z^R&(M^z))+V[0]+3614090360&4294967295,T=R+(I<<7&4294967295|I>>>25),I=z+(M^T&(R^M))+V[1]+3905402710&4294967295,z=T+(I<<12&4294967295|I>>>20),I=M+(R^z&(T^R))+V[2]+606105819&4294967295,M=z+(I<<17&4294967295|I>>>15),I=R+(T^M&(z^T))+V[3]+3250441966&4294967295,R=M+(I<<22&4294967295|I>>>10),I=T+(z^R&(M^z))+V[4]+4118548399&4294967295,T=R+(I<<7&4294967295|I>>>25),I=z+(M^T&(R^M))+V[5]+1200080426&4294967295,z=T+(I<<12&4294967295|I>>>20),I=M+(R^z&(T^R))+V[6]+2821735955&4294967295,M=z+(I<<17&4294967295|I>>>15),I=R+(T^M&(z^T))+V[7]+4249261313&4294967295,R=M+(I<<22&4294967295|I>>>10),I=T+(z^R&(M^z))+V[8]+1770035416&4294967295,T=R+(I<<7&4294967295|I>>>25),I=z+(M^T&(R^M))+V[9]+2336552879&4294967295,z=T+(I<<12&4294967295|I>>>20),I=M+(R^z&(T^R))+V[10]+4294925233&4294967295,M=z+(I<<17&4294967295|I>>>15),I=R+(T^M&(z^T))+V[11]+2304563134&4294967295,R=M+(I<<22&4294967295|I>>>10),I=T+(z^R&(M^z))+V[12]+1804603682&4294967295,T=R+(I<<7&4294967295|I>>>25),I=z+(M^T&(R^M))+V[13]+4254626195&4294967295,z=T+(I<<12&4294967295|I>>>20),I=M+(R^z&(T^R))+V[14]+2792965006&4294967295,M=z+(I<<17&4294967295|I>>>15),I=R+(T^M&(z^T))+V[15]+1236535329&4294967295,R=M+(I<<22&4294967295|I>>>10),I=T+(M^z&(R^M))+V[1]+4129170786&4294967295,T=R+(I<<5&4294967295|I>>>27),I=z+(R^M&(T^R))+V[6]+3225465664&4294967295,z=T+(I<<9&4294967295|I>>>23),I=M+(T^R&(z^T))+V[11]+643717713&4294967295,M=z+(I<<14&4294967295|I>>>18),I=R+(z^T&(M^z))+V[0]+3921069994&4294967295,R=M+(I<<20&4294967295|I>>>12),I=T+(M^z&(R^M))+V[5]+3593408605&4294967295,T=R+(I<<5&4294967295|I>>>27),I=z+(R^M&(T^R))+V[10]+38016083&4294967295,z=T+(I<<9&4294967295|I>>>23),I=M+(T^R&(z^T))+V[15]+3634488961&4294967295,M=z+(I<<14&4294967295|I>>>18),I=R+(z^T&(M^z))+V[4]+3889429448&4294967295,R=M+(I<<20&4294967295|I>>>12),I=T+(M^z&(R^M))+V[9]+568446438&4294967295,T=R+(I<<5&4294967295|I>>>27),I=z+(R^M&(T^R))+V[14]+3275163606&4294967295,z=T+(I<<9&4294967295|I>>>23),I=M+(T^R&(z^T))+V[3]+4107603335&4294967295,M=z+(I<<14&4294967295|I>>>18),I=R+(z^T&(M^z))+V[8]+1163531501&4294967295,R=M+(I<<20&4294967295|I>>>12),I=T+(M^z&(R^M))+V[13]+2850285829&4294967295,T=R+(I<<5&4294967295|I>>>27),I=z+(R^M&(T^R))+V[2]+4243563512&4294967295,z=T+(I<<9&4294967295|I>>>23),I=M+(T^R&(z^T))+V[7]+1735328473&4294967295,M=z+(I<<14&4294967295|I>>>18),I=R+(z^T&(M^z))+V[12]+2368359562&4294967295,R=M+(I<<20&4294967295|I>>>12),I=T+(R^M^z)+V[5]+4294588738&4294967295,T=R+(I<<4&4294967295|I>>>28),I=z+(T^R^M)+V[8]+2272392833&4294967295,z=T+(I<<11&4294967295|I>>>21),I=M+(z^T^R)+V[11]+1839030562&4294967295,M=z+(I<<16&4294967295|I>>>16),I=R+(M^z^T)+V[14]+4259657740&4294967295,R=M+(I<<23&4294967295|I>>>9),I=T+(R^M^z)+V[1]+2763975236&4294967295,T=R+(I<<4&4294967295|I>>>28),I=z+(T^R^M)+V[4]+1272893353&4294967295,z=T+(I<<11&4294967295|I>>>21),I=M+(z^T^R)+V[7]+4139469664&4294967295,M=z+(I<<16&4294967295|I>>>16),I=R+(M^z^T)+V[10]+3200236656&4294967295,R=M+(I<<23&4294967295|I>>>9),I=T+(R^M^z)+V[13]+681279174&4294967295,T=R+(I<<4&4294967295|I>>>28),I=z+(T^R^M)+V[0]+3936430074&4294967295,z=T+(I<<11&4294967295|I>>>21),I=M+(z^T^R)+V[3]+3572445317&4294967295,M=z+(I<<16&4294967295|I>>>16),I=R+(M^z^T)+V[6]+76029189&4294967295,R=M+(I<<23&4294967295|I>>>9),I=T+(R^M^z)+V[9]+3654602809&4294967295,T=R+(I<<4&4294967295|I>>>28),I=z+(T^R^M)+V[12]+3873151461&4294967295,z=T+(I<<11&4294967295|I>>>21),I=M+(z^T^R)+V[15]+530742520&4294967295,M=z+(I<<16&4294967295|I>>>16),I=R+(M^z^T)+V[2]+3299628645&4294967295,R=M+(I<<23&4294967295|I>>>9),I=T+(M^(R|~z))+V[0]+4096336452&4294967295,T=R+(I<<6&4294967295|I>>>26),I=z+(R^(T|~M))+V[7]+1126891415&4294967295,z=T+(I<<10&4294967295|I>>>22),I=M+(T^(z|~R))+V[14]+2878612391&4294967295,M=z+(I<<15&4294967295|I>>>17),I=R+(z^(M|~T))+V[5]+4237533241&4294967295,R=M+(I<<21&4294967295|I>>>11),I=T+(M^(R|~z))+V[12]+1700485571&4294967295,T=R+(I<<6&4294967295|I>>>26),I=z+(R^(T|~M))+V[3]+2399980690&4294967295,z=T+(I<<10&4294967295|I>>>22),I=M+(T^(z|~R))+V[10]+4293915773&4294967295,M=z+(I<<15&4294967295|I>>>17),I=R+(z^(M|~T))+V[1]+2240044497&4294967295,R=M+(I<<21&4294967295|I>>>11),I=T+(M^(R|~z))+V[8]+1873313359&4294967295,T=R+(I<<6&4294967295|I>>>26),I=z+(R^(T|~M))+V[15]+4264355552&4294967295,z=T+(I<<10&4294967295|I>>>22),I=M+(T^(z|~R))+V[6]+2734768916&4294967295,M=z+(I<<15&4294967295|I>>>17),I=R+(z^(M|~T))+V[13]+1309151649&4294967295,R=M+(I<<21&4294967295|I>>>11),I=T+(M^(R|~z))+V[4]+4149444226&4294967295,T=R+(I<<6&4294967295|I>>>26),I=z+(R^(T|~M))+V[11]+3174756917&4294967295,z=T+(I<<10&4294967295|I>>>22),I=M+(T^(z|~R))+V[2]+718787259&4294967295,M=z+(I<<15&4294967295|I>>>17),I=R+(z^(M|~T))+V[9]+3951481745&4294967295,j.g[0]=j.g[0]+T&4294967295,j.g[1]=j.g[1]+(M+(I<<21&4294967295|I>>>11))&4294967295,j.g[2]=j.g[2]+M&4294967295,j.g[3]=j.g[3]+z&4294967295}r.prototype.v=function(j,T){T===void 0&&(T=j.length);const R=T-this.blockSize,V=this.C;let M=this.h,z=0;for(;z<T;){if(M==0)for(;z<=R;)o(this,j,z),z+=this.blockSize;if(typeof j=="string"){for(;z<T;)if(V[M++]=j.charCodeAt(z++),M==this.blockSize){o(this,V),M=0;break}}else for(;z<T;)if(V[M++]=j[z++],M==this.blockSize){o(this,V),M=0;break}}this.h=M,this.o+=T},r.prototype.A=function(){var j=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);j[0]=128;for(var T=1;T<j.length-8;++T)j[T]=0;T=this.o*8;for(var R=j.length-8;R<j.length;++R)j[R]=T&255,T/=256;for(this.v(j),j=Array(16),T=0,R=0;R<4;++R)for(let V=0;V<32;V+=8)j[T++]=this.g[R]>>>V&255;return j};function u(j,T){var R=p;return Object.prototype.hasOwnProperty.call(R,j)?R[j]:R[j]=T(j)}function d(j,T){this.h=T;const R=[];let V=!0;for(let M=j.length-1;M>=0;M--){const z=j[M]|0;V&&z==T||(R[M]=z,V=!1)}this.g=R}var p={};function g(j){return-128<=j&&j<128?u(j,function(T){return new d([T|0],T<0?-1:0)}):new d([j|0],j<0?-1:0)}function x(j){if(isNaN(j)||!isFinite(j))return _;if(j<0)return O(x(-j));const T=[];let R=1;for(let V=0;j>=R;V++)T[V]=j/R|0,R*=4294967296;return new d(T,0)}function b(j,T){if(j.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(j.charAt(0)=="-")return O(b(j.substring(1),T));if(j.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=x(Math.pow(T,8));let V=_;for(let z=0;z<j.length;z+=8){var M=Math.min(8,j.length-z);const I=parseInt(j.substring(z,z+M),T);M<8?(M=x(Math.pow(T,M)),V=V.j(M).add(x(I))):(V=V.j(R),V=V.add(x(I)))}return V}var _=g(0),E=g(1),A=g(16777216);s=d.prototype,s.m=function(){if(L(this))return-O(this).m();let j=0,T=1;for(let R=0;R<this.g.length;R++){const V=this.i(R);j+=(V>=0?V:4294967296+V)*T,T*=4294967296}return j},s.toString=function(j){if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(F(this))return"0";if(L(this))return"-"+O(this).toString(j);const T=x(Math.pow(j,6));var R=this;let V="";for(;;){const M=fe(R,T).g;R=U(R,M.j(T));let z=((R.g.length>0?R.g[0]:R.h)>>>0).toString(j);if(R=M,F(R))return z+V;for(;z.length<6;)z="0"+z;V=z+V}},s.i=function(j){return j<0?0:j<this.g.length?this.g[j]:this.h};function F(j){if(j.h!=0)return!1;for(let T=0;T<j.g.length;T++)if(j.g[T]!=0)return!1;return!0}function L(j){return j.h==-1}s.l=function(j){return j=U(this,j),L(j)?-1:F(j)?0:1};function O(j){const T=j.g.length,R=[];for(let V=0;V<T;V++)R[V]=~j.g[V];return new d(R,~j.h).add(E)}s.abs=function(){return L(this)?O(this):this},s.add=function(j){const T=Math.max(this.g.length,j.g.length),R=[];let V=0;for(let M=0;M<=T;M++){let z=V+(this.i(M)&65535)+(j.i(M)&65535),I=(z>>>16)+(this.i(M)>>>16)+(j.i(M)>>>16);V=I>>>16,z&=65535,I&=65535,R[M]=I<<16|z}return new d(R,R[R.length-1]&-2147483648?-1:0)};function U(j,T){return j.add(O(T))}s.j=function(j){if(F(this)||F(j))return _;if(L(this))return L(j)?O(this).j(O(j)):O(O(this).j(j));if(L(j))return O(this.j(O(j)));if(this.l(A)<0&&j.l(A)<0)return x(this.m()*j.m());const T=this.g.length+j.g.length,R=[];for(var V=0;V<2*T;V++)R[V]=0;for(V=0;V<this.g.length;V++)for(let M=0;M<j.g.length;M++){const z=this.i(V)>>>16,I=this.i(V)&65535,q=j.i(M)>>>16,D=j.i(M)&65535;R[2*V+2*M]+=I*D,G(R,2*V+2*M),R[2*V+2*M+1]+=z*D,G(R,2*V+2*M+1),R[2*V+2*M+1]+=I*q,G(R,2*V+2*M+1),R[2*V+2*M+2]+=z*q,G(R,2*V+2*M+2)}for(j=0;j<T;j++)R[j]=R[2*j+1]<<16|R[2*j];for(j=T;j<2*T;j++)R[j]=0;return new d(R,0)};function G(j,T){for(;(j[T]&65535)!=j[T];)j[T+1]+=j[T]>>>16,j[T]&=65535,T++}function K(j,T){this.g=j,this.h=T}function fe(j,T){if(F(T))throw Error("division by zero");if(F(j))return new K(_,_);if(L(j))return T=fe(O(j),T),new K(O(T.g),O(T.h));if(L(T))return T=fe(j,O(T)),new K(O(T.g),T.h);if(j.g.length>30){if(L(j)||L(T))throw Error("slowDivide_ only works with positive integers.");for(var R=E,V=T;V.l(j)<=0;)R=he(R),V=he(V);var M=oe(R,1),z=oe(V,1);for(V=oe(V,2),R=oe(R,2);!F(V);){var I=z.add(V);I.l(j)<=0&&(M=M.add(R),z=I),V=oe(V,1),R=oe(R,1)}return T=U(j,M.j(T)),new K(M,T)}for(M=_;j.l(T)>=0;){for(R=Math.max(1,Math.floor(j.m()/T.m())),V=Math.ceil(Math.log(R)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),z=x(R),I=z.j(T);L(I)||I.l(j)>0;)R-=V,z=x(R),I=z.j(T);F(z)&&(z=E),M=M.add(z),j=U(j,I)}return new K(M,j)}s.B=function(j){return fe(this,j).h},s.and=function(j){const T=Math.max(this.g.length,j.g.length),R=[];for(let V=0;V<T;V++)R[V]=this.i(V)&j.i(V);return new d(R,this.h&j.h)},s.or=function(j){const T=Math.max(this.g.length,j.g.length),R=[];for(let V=0;V<T;V++)R[V]=this.i(V)|j.i(V);return new d(R,this.h|j.h)},s.xor=function(j){const T=Math.max(this.g.length,j.g.length),R=[];for(let V=0;V<T;V++)R[V]=this.i(V)^j.i(V);return new d(R,this.h^j.h)};function he(j){const T=j.g.length+1,R=[];for(let V=0;V<T;V++)R[V]=j.i(V)<<1|j.i(V-1)>>>31;return new d(R,j.h)}function oe(j,T){const R=T>>5;T%=32;const V=j.g.length-R,M=[];for(let z=0;z<V;z++)M[z]=T>0?j.i(z+R)>>>T|j.i(z+R+1)<<32-T:j.i(z+R);return new d(M,j.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,tN=r,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=x,d.fromString=b,ii=d}).apply(typeof uw<"u"?uw:typeof self<"u"?self:typeof window<"u"?window:{});var Zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var nN,Hc,sN,gh,hg,aN,rN,iN;(function(){var s,e=Object.defineProperty;function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zd=="object"&&Zd];for(var y=0;y<h.length;++y){var w=h[y];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=n(this);function o(h,y){if(y)e:{var w=r;h=h.split(".");for(var C=0;C<h.length-1;C++){var J=h[C];if(!(J in w))break e;w=w[J]}h=h[h.length-1],C=w[h],y=y(C),y!=C&&y!=null&&e(w,h,{configurable:!0,writable:!0,value:y})}}o("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(h){return h||function(y){var w=[],C;for(C in y)Object.prototype.hasOwnProperty.call(y,C)&&w.push([C,y[C]]);return w}});var u=u||{},d=this||self;function p(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function g(h,y,w){return h.call.apply(h.bind,arguments)}function x(h,y,w){return x=g,x.apply(null,arguments)}function b(h,y){var w=Array.prototype.slice.call(arguments,1);return function(){var C=w.slice();return C.push.apply(C,arguments),h.apply(this,C)}}function _(h,y){function w(){}w.prototype=y.prototype,h.Z=y.prototype,h.prototype=new w,h.prototype.constructor=h,h.Ob=function(C,J,ae){for(var je=Array(arguments.length-2),it=2;it<arguments.length;it++)je[it-2]=arguments[it];return y.prototype[J].apply(C,je)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function A(h){const y=h.length;if(y>0){const w=Array(y);for(let C=0;C<y;C++)w[C]=h[C];return w}return[]}function F(h,y){for(let C=1;C<arguments.length;C++){const J=arguments[C];var w=typeof J;if(w=w!="object"?w:J?Array.isArray(J)?"array":w:"null",w=="array"||w=="object"&&typeof J.length=="number"){w=h.length||0;const ae=J.length||0;h.length=w+ae;for(let je=0;je<ae;je++)h[w+je]=J[je]}else h.push(J)}}class L{constructor(y,w){this.i=y,this.j=w,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function O(h){d.setTimeout(()=>{throw h},0)}function U(){var h=j;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class G{constructor(){this.h=this.g=null}add(y,w){const C=K.get();C.set(y,w),this.h?this.h.next=C:this.g=C,this.h=C}}var K=new L(()=>new fe,h=>h.reset());class fe{constructor(){this.next=this.g=this.h=null}set(y,w){this.h=y,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let he,oe=!1,j=new G,T=()=>{const h=Promise.resolve(void 0);he=()=>{h.then(R)}};function R(){for(var h;h=U();){try{h.h.call(h.g)}catch(w){O(w)}var y=K;y.j(h),y.h<100&&(y.h++,h.next=y.g,y.g=h)}oe=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};d.addEventListener("test",w,y),d.removeEventListener("test",w,y)}catch{}return h})();function I(h){return/^[\s\xa0]*$/.test(h)}function q(h,y){M.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,y)}_(q,M),q.prototype.init=function(h,y){const w=this.type=h.type,C=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget,y||(w=="mouseover"?y=h.fromElement:w=="mouseout"&&(y=h.toElement)),this.relatedTarget=y,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&q.Z.h.call(this)},q.prototype.h=function(){q.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var D="closure_listenable_"+(Math.random()*1e6|0),k=0;function Y(h,y,w,C,J){this.listener=h,this.proxy=null,this.src=y,this.type=w,this.capture=!!C,this.ha=J,this.key=++k,this.da=this.fa=!1}function ie(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Te(h,y,w){for(const C in h)y.call(w,h[C],C,h)}function ve(h,y){for(const w in h)y.call(void 0,h[w],w,h)}function P(h){const y={};for(const w in h)y[w]=h[w];return y}const ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function le(h,y){let w,C;for(let J=1;J<arguments.length;J++){C=arguments[J];for(w in C)h[w]=C[w];for(let ae=0;ae<ee.length;ae++)w=ee[ae],Object.prototype.hasOwnProperty.call(C,w)&&(h[w]=C[w])}}function xe(h){this.src=h,this.g={},this.h=0}xe.prototype.add=function(h,y,w,C,J){const ae=h.toString();h=this.g[ae],h||(h=this.g[ae]=[],this.h++);const je=Re(h,y,C,J);return je>-1?(y=h[je],w||(y.fa=!1)):(y=new Y(y,this.src,ae,!!C,J),y.fa=w,h.push(y)),y};function be(h,y){const w=y.type;if(w in h.g){var C=h.g[w],J=Array.prototype.indexOf.call(C,y,void 0),ae;(ae=J>=0)&&Array.prototype.splice.call(C,J,1),ae&&(ie(y),h.g[w].length==0&&(delete h.g[w],h.h--))}}function Re(h,y,w,C){for(let J=0;J<h.length;++J){const ae=h[J];if(!ae.da&&ae.listener==y&&ae.capture==!!w&&ae.ha==C)return J}return-1}var ue="closure_lm_"+(Math.random()*1e6|0),Ue={};function Be(h,y,w,C,J){if(Array.isArray(y)){for(let ae=0;ae<y.length;ae++)Be(h,y[ae],w,C,J);return null}return w=Tt(w),h&&h[D]?h.J(y,w,p(C)?!!C.capture:!1,J):We(h,y,w,!1,C,J)}function We(h,y,w,C,J,ae){if(!y)throw Error("Invalid event type");const je=p(J)?!!J.capture:!!J;let it=ft(h);if(it||(h[ue]=it=new xe(h)),w=it.add(y,w,C,je,ae),w.proxy)return w;if(C=Q(),w.proxy=C,C.src=h,C.listener=w,h.addEventListener)z||(J=je),J===void 0&&(J=!1),h.addEventListener(y.toString(),C,J);else if(h.attachEvent)h.attachEvent(He(y.toString()),C);else if(h.addListener&&h.removeListener)h.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Q(){function h(w){return y.call(h.src,h.listener,w)}const y=Ve;return h}function we(h,y,w,C,J){if(Array.isArray(y))for(var ae=0;ae<y.length;ae++)we(h,y[ae],w,C,J);else C=p(C)?!!C.capture:!!C,w=Tt(w),h&&h[D]?(h=h.i,ae=String(y).toString(),ae in h.g&&(y=h.g[ae],w=Re(y,w,C,J),w>-1&&(ie(y[w]),Array.prototype.splice.call(y,w,1),y.length==0&&(delete h.g[ae],h.h--)))):h&&(h=ft(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Re(y,w,C,J)),(w=h>-1?y[h]:null)&&Ie(w))}function Ie(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[D])be(y.i,h);else{var w=h.type,C=h.proxy;y.removeEventListener?y.removeEventListener(w,C,h.capture):y.detachEvent?y.detachEvent(He(w),C):y.addListener&&y.removeListener&&y.removeListener(C),(w=ft(y))?(be(w,h),w.h==0&&(w.src=null,y[ue]=null)):ie(h)}}}function He(h){return h in Ue?Ue[h]:Ue[h]="on"+h}function Ve(h,y){if(h.da)h=!0;else{y=new q(y,this);const w=h.listener,C=h.ha||h.src;h.fa&&Ie(h),h=w.call(C,y)}return h}function ft(h){return h=h[ue],h instanceof xe?h:null}var Kn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Tt(h){return typeof h=="function"?h:(h[Kn]||(h[Kn]=function(y){return h.handleEvent(y)}),h[Kn])}function vt(){V.call(this),this.i=new xe(this),this.M=this,this.G=null}_(vt,V),vt.prototype[D]=!0,vt.prototype.removeEventListener=function(h,y,w,C){we(this,h,y,w,C)};function Ae(h,y){var w,C=h.G;if(C)for(w=[];C;C=C.G)w.push(C);if(h=h.M,C=y.type||y,typeof y=="string")y=new M(y,h);else if(y instanceof M)y.target=y.target||h;else{var J=y;y=new M(C,h),le(y,J)}J=!0;let ae,je;if(w)for(je=w.length-1;je>=0;je--)ae=y.g=w[je],J=Pe(ae,C,!0,y)&&J;if(ae=y.g=h,J=Pe(ae,C,!0,y)&&J,J=Pe(ae,C,!1,y)&&J,w)for(je=0;je<w.length;je++)ae=y.g=w[je],J=Pe(ae,C,!1,y)&&J}vt.prototype.N=function(){if(vt.Z.N.call(this),this.i){var h=this.i;for(const y in h.g){const w=h.g[y];for(let C=0;C<w.length;C++)ie(w[C]);delete h.g[y],h.h--}}this.G=null},vt.prototype.J=function(h,y,w,C){return this.i.add(String(h),y,!1,w,C)},vt.prototype.K=function(h,y,w,C){return this.i.add(String(h),y,!0,w,C)};function Pe(h,y,w,C){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();let J=!0;for(let ae=0;ae<y.length;++ae){const je=y[ae];if(je&&!je.da&&je.capture==w){const it=je.listener,hn=je.ha||je.src;je.fa&&be(h.i,je),J=it.call(hn,C)!==!1&&J}}return J&&!C.defaultPrevented}function ut(h,y){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=x(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:d.setTimeout(h,y||0)}function Kt(h){h.g=ut(()=>{h.g=null,h.i&&(h.i=!1,Kt(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class _t extends V{constructor(y,w){super(),this.m=y,this.l=w,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Kt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nt(h){V.call(this),this.h=h,this.g={}}_(Nt,V);var Tn=[];function Rt(h){Te(h.g,function(y,w){this.g.hasOwnProperty(w)&&Ie(y)},h),h.g={}}Nt.prototype.N=function(){Nt.Z.N.call(this),Rt(this)},Nt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qn=d.JSON.stringify,qn=d.JSON.parse,bs=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function ts(){}function qa(){}var H={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function se(){M.call(this,"d")}_(se,M);function Ne(){M.call(this,"c")}_(Ne,M);var _e={},$e=null;function et(){return $e=$e||new vt}_e.Ia="serverreachability";function qt(h){M.call(this,_e.Ia,h)}_(qt,M);function ze(h){const y=et();Ae(y,new qt(y))}_e.STAT_EVENT="statevent";function me(h,y){M.call(this,_e.STAT_EVENT,h),this.stat=y}_(me,M);function Se(h){const y=et();Ae(y,new me(y,h))}_e.Ja="timingevent";function Xe(h,y){M.call(this,_e.Ja,h),this.size=y}_(Xe,M);function tt(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},y)}function Et(){this.g=!0}Et.prototype.ua=function(){this.g=!1};function Le(h,y,w,C,J,ae){h.info(function(){if(h.g)if(ae){var je="",it=ae.split("&");for(let At=0;At<it.length;At++){var hn=it[At].split("=");if(hn.length>1){const Qt=hn[0];hn=hn[1];const Us=Qt.split("_");je=Us.length>=2&&Us[1]=="type"?je+(Qt+"="+hn+"&"):je+(Qt+"=redacted&")}}}else je=null;else je=ae;return"XMLHTTP REQ ("+C+") [attempt "+J+"]: "+y+`
`+w+`
`+je})}function Ge(h,y,w,C,J,ae,je){h.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+J+"]: "+y+`
`+w+`
`+ae+" "+je})}function Dt(h,y,w,C){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+Fn(h,w)+(C?" "+C:"")})}function tn(h,y){h.info(function(){return"TIMEOUT: "+y})}Et.prototype.info=function(){};function Fn(h,y){if(!h.g)return y;if(!y)return null;try{const ae=JSON.parse(y);if(ae){for(h=0;h<ae.length;h++)if(Array.isArray(ae[h])){var w=ae[h];if(!(w.length<2)){var C=w[1];if(Array.isArray(C)&&!(C.length<1)){var J=C[0];if(J!="noop"&&J!="stop"&&J!="close")for(let je=1;je<C.length;je++)C[je]=""}}}}return Qn(ae)}catch{return y}}var ns={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Xs={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ei;function Fa(){}_(Fa,ts),Fa.prototype.g=function(){return new XMLHttpRequest},Ei=new Fa;function dn(h){return encodeURIComponent(String(h))}function Si(h){var y=1;h=h.split(":");const w=[];for(;y>0&&h.length;)w.push(h.shift()),y--;return h.length&&w.push(h.join(":")),w}function gn(h,y,w,C){this.j=h,this.i=y,this.l=w,this.S=C||1,this.V=new Nt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ss}function ss(){this.i=null,this.g="",this.h=!1}var nn={},xn={};function ys(h,y,w){h.M=1,h.A=Ti(yn(y)),h.u=w,h.R=!0,ji(h,null)}function ji(h,y){h.F=Date.now(),ha(h),h.B=yn(h.A);var w=h.B,C=h.S;Array.isArray(C)||(C=[String(C)]),El(w.i,"t",C),h.C=0,w=h.j.L,h.h=new ss,h.g=Hu(h.j,w?y:null,!h.u),h.P>0&&(h.O=new _t(x(h.Y,h,h.g),h.P)),y=h.V,w=h.g,C=h.ba;var J="readystatechange";Array.isArray(J)||(J&&(Tn[0]=J.toString()),J=Tn);for(let ae=0;ae<J.length;ae++){const je=Be(w,J[ae],C||y.handleEvent,!1,y.h||y);if(!je)break;y.g[je.key]=je}y=h.J?P(h.J):{},h.u?(h.v||(h.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,y)):(h.v="GET",h.g.ea(h.B,h.v,null,y)),ze(),Le(h.i,h.v,h.B,h.l,h.S,h.u)}gn.prototype.ba=function(h){h=h.target;const y=this.O;y&&ea(h)==3?y.j():this.Y(h)},gn.prototype.Y=function(h){try{if(h==this.g)e:{const it=ea(this.g),hn=this.g.ya(),At=this.g.ca();if(!(it<3)&&(it!=3||this.g&&(this.h.h||this.g.la()||Mn(this.g)))){this.K||it!=4||hn==7||(hn==8||At<=0?ze(3):ze(2)),fa(this);var y=this.g.ca();this.X=y;var w=Tf(this);if(this.o=y==200,Ge(this.i,this.v,this.B,this.l,this.S,it,y),this.o){if(this.U&&!this.L){t:{if(this.g){var C,J=this.g;if((C=J.g?J.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(C)){var ae=C;break t}}ae=null}if(h=ae)Dt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ma(this,h);else{this.o=!1,this.m=3,Se(12),vs(this),Ps(this);break e}}if(this.R){h=!0;let Qt;for(;!this.K&&this.C<w.length;)if(Qt=ku(this,w),Qt==xn){it==4&&(this.m=4,Se(14),h=!1),Dt(this.i,this.l,null,"[Incomplete Response]");break}else if(Qt==nn){this.m=4,Se(15),Dt(this.i,this.l,w,"[Invalid Chunk]"),h=!1;break}else Dt(this.i,this.l,Qt,null),ma(this,Qt);if(Ru(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),it!=4||w.length!=0||this.h.h||(this.m=1,Se(16),h=!1),this.o=this.o&&h,!h)Dt(this.i,this.l,w,"[Invalid Chunked Response]"),vs(this),Ps(this);else if(w.length>0&&!this.W){this.W=!0;var je=this.j;je.g==this&&je.aa&&!je.P&&(je.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Xo(je),je.P=!0,Se(11))}}else Dt(this.i,this.l,w,null),ma(this,w);it==4&&vs(this),this.o&&!this.K&&(it==4?Bu(this.j,this):(this.o=!1,ha(this)))}else $a(this.g),y==400&&w.indexOf("Unknown SID")>0?(this.m=3,Se(12)):(this.m=0,Se(13)),vs(this),Ps(this)}}}catch{}};function Tf(h){if(!Ru(h))return h.g.la();const y=Mn(h.g);if(y==="")return"";let w="";const C=y.length,J=ea(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return vs(h),Ps(h),"";h.h.i=new d.TextDecoder}for(let ae=0;ae<C;ae++)h.h.h=!0,w+=h.h.i.decode(y[ae],{stream:!(J&&ae==C-1)});return y.length=0,h.h.g+=w,h.C=0,h.h.g}function Ru(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function ku(h,y){var w=h.C,C=y.indexOf(`
`,w);return C==-1?xn:(w=Number(y.substring(w,C)),isNaN(w)?nn:(C+=1,C+w>y.length?xn:(y=y.slice(C,C+w),h.C=C+w,y)))}gn.prototype.cancel=function(){this.K=!0,vs(this)};function ha(h){h.T=Date.now()+h.H,wl(h,h.H)}function wl(h,y){if(h.D!=null)throw Error("WatchDog timer not null");h.D=tt(x(h.aa,h),y)}function fa(h){h.D&&(d.clearTimeout(h.D),h.D=null)}gn.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(tn(this.i,this.B),this.M!=2&&(ze(),Se(17)),vs(this),this.m=2,Ps(this)):wl(this,this.T-h)};function Ps(h){h.j.I==0||h.K||Bu(h.j,h)}function vs(h){fa(h);var y=h.O;y&&typeof y.dispose=="function"&&y.dispose(),h.O=null,Rt(h.V),h.g&&(y=h.g,h.g=null,y.abort(),y.dispose())}function ma(h,y){try{var w=h.j;if(w.I!=0&&(w.g==h||ga(w.h,h))){if(!h.L&&ga(w.h,h)&&w.I==3){try{var C=w.Ba.g.parse(y)}catch{C=null}if(Array.isArray(C)&&C.length==3){var J=C;if(J[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<h.F)Cl(w),Tr(w);else break e;Mi(w),Se(18)}}else w.xa=J[1],0<w.xa-w.K&&J[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=tt(x(w.Va,w),6e3));pa(w.h)<=1&&w.ta&&(w.ta=void 0)}else _a(w,11)}else if((h.L||w.g==h)&&Cl(w),!I(y))for(J=w.Ba.g.parse(y),y=0;y<J.length;y++){let At=J[y];const Qt=At[0];if(!(Qt<=w.K))if(w.K=Qt,At=At[1],w.I==2)if(At[0]=="c"){w.M=At[1],w.ba=At[2];const Us=At[3];Us!=null&&(w.ka=Us,w.j.info("VER="+w.ka));const Na=At[4];Na!=null&&(w.za=Na,w.j.info("SVER="+w.za));const ta=At[5];ta!=null&&typeof ta=="number"&&ta>0&&(C=1.5*ta,w.O=C,w.j.info("backChannelRequestTimeoutMs_="+C)),C=w;const na=h.g;if(na){const Oi=na.g?na.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Oi){var ae=C.h;ae.g||Oi.indexOf("spdy")==-1&&Oi.indexOf("quic")==-1&&Oi.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(Uo(ae,ae.h),ae.h=null))}if(C.G){const Rl=na.g?na.g.getResponseHeader("X-HTTP-Session-Id"):null;Rl&&(C.wa=Rl,Mt(C.J,C.G,Rl))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-h.F,w.j.info("Handshake RTT: "+w.T+"ms")),C=w;var je=h;if(C.na=Fu(C,C.L?C.ba:null,C.W),je.L){Bo(C.h,je);var it=je,hn=C.O;hn&&(it.H=hn),it.D&&(fa(it),ha(it)),C.g=je}else Lu(C);w.i.length>0&&wa(w)}else At[0]!="stop"&&At[0]!="close"||_a(w,7);else w.I==3&&(At[0]=="stop"||At[0]=="close"?At[0]=="stop"?_a(w,7):Ko(w):At[0]!="noop"&&w.l&&w.l.qa(At),w.A=0)}}ze(4)}catch{}}var bn=class{constructor(h,y){this.g=h,this.map=y}};function Vo(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Lo(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function pa(h){return h.h?1:h.g?h.g.size:0}function ga(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Uo(h,y){h.g?h.g.add(y):h.h=y}function Bo(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Vo.prototype.cancel=function(){if(this.i=zo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function zo(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const w of h.g.values())y=y.concat(w.G);return y}return A(h.i)}var Iu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _l(h,y){if(h){h=h.split("&");for(let w=0;w<h.length;w++){const C=h[w].indexOf("=");let J,ae=null;C>=0?(J=h[w].substring(0,C),ae=h[w].substring(C+1)):J=h[w],y(J,ae?decodeURIComponent(ae.replace(/\+/g," ")):"")}}}function ws(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;h instanceof ws?(this.l=h.l,Rn(this,h.j),this.o=h.o,this.g=h.g,vr(this,h.u),this.h=h.h,qo(this,Pu(h.i)),this.m=h.m):h&&(y=String(h).match(Iu))?(this.l=!1,Rn(this,y[1]||"",!0),this.o=xa(y[2]||""),this.g=xa(y[3]||"",!0),vr(this,y[4]),this.h=xa(y[5]||"",!0),qo(this,y[6]||"",!0),this.m=xa(y[7]||"")):(this.l=!1,this.i=new _r(null,this.l))}ws.prototype.toString=function(){const h=[];var y=this.j;y&&h.push(Ai(y,Nl,!0),":");var w=this.g;return(w||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Ai(y,Nl,!0),"@"),h.push(dn(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&h.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(Ai(w,w.charAt(0)=="/"?Fo:Du,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",Ai(w,Mu)),h.join("")},ws.prototype.resolve=function(h){const y=yn(this);let w=!!h.j;w?Rn(y,h.j):w=!!h.o,w?y.o=h.o:w=!!h.g,w?y.g=h.g:w=h.u!=null;var C=h.h;if(w)vr(y,h.u);else if(w=!!h.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var J=y.h.lastIndexOf("/");J!=-1&&(C=y.h.slice(0,J+1)+C)}if(J=C,J==".."||J==".")C="";else if(J.indexOf("./")!=-1||J.indexOf("/.")!=-1){C=J.lastIndexOf("/",0)==0,J=J.split("/");const ae=[];for(let je=0;je<J.length;){const it=J[je++];it=="."?C&&je==J.length&&ae.push(""):it==".."?((ae.length>1||ae.length==1&&ae[0]!="")&&ae.pop(),C&&je==J.length&&ae.push("")):(ae.push(it),C=!0)}C=ae.join("/")}else C=J}return w?y.h=C:w=h.i.toString()!=="",w?qo(y,Pu(h.i)):w=!!h.m,w&&(y.m=h.m),y};function yn(h){return new ws(h)}function Rn(h,y,w){h.j=w?xa(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function vr(h,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);h.u=y}else h.u=null}function qo(h,y,w){y instanceof _r?(h.i=y,Sl(h.i,h.l)):(w||(y=Ai(y,wr)),h.i=new _r(y,h.l))}function Mt(h,y,w){h.i.set(y,w)}function Ti(h){return Mt(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function xa(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ai(h,y,w){return typeof h=="string"?(h=encodeURI(h).replace(y,as),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function as(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Nl=/[#\/\?@]/g,Du=/[#\?:]/g,Fo=/[#\?]/g,wr=/[#\?@]/g,Mu=/#/g;function _r(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function rs(h){h.g||(h.g=new Map,h.h=0,h.i&&_l(h.i,function(y,w){h.add(decodeURIComponent(y.replace(/\+/g," ")),w)}))}s=_r.prototype,s.add=function(h,y){rs(this),this.i=null,h=Nr(this,h);let w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(y),this.h+=1,this};function Ou(h,y){rs(h),y=Nr(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function Ho(h,y){return rs(h),y=Nr(h,y),h.g.has(y)}s.forEach=function(h,y){rs(this),this.g.forEach(function(w,C){w.forEach(function(J){h.call(y,J,C,this)},this)},this)};function $o(h,y){rs(h);let w=[];if(typeof y=="string")Ho(h,y)&&(w=w.concat(h.g.get(Nr(h,y))));else for(h=Array.from(h.g.values()),y=0;y<h.length;y++)w=w.concat(h[y]);return w}s.set=function(h,y){return rs(this),this.i=null,h=Nr(this,h),Ho(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},s.get=function(h,y){return h?(h=$o(this,h),h.length>0?String(h[0]):y):y};function El(h,y,w){Ou(h,y),w.length>0&&(h.i=null,h.g.set(Nr(h,y),A(w)),h.h+=w.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(let C=0;C<y.length;C++){var w=y[C];const J=dn(w);w=$o(this,w);for(let ae=0;ae<w.length;ae++){let je=J;w[ae]!==""&&(je+="="+dn(w[ae])),h.push(je)}}return this.i=h.join("&")};function Pu(h){const y=new _r;return y.i=h.i,h.g&&(y.g=new Map(h.g),y.h=h.h),y}function Nr(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Sl(h,y){y&&!h.j&&(rs(h),h.i=null,h.g.forEach(function(w,C){const J=C.toLowerCase();C!=J&&(Ou(this,C),El(this,J,w))},h)),h.j=y}function Js(h,y){const w=new Et;if(d.Image){const C=new Image;C.onload=b(Vs,w,"TestLoadImage: loaded",!0,y,C),C.onerror=b(Vs,w,"TestLoadImage: error",!1,y,C),C.onabort=b(Vs,w,"TestLoadImage: abort",!1,y,C),C.ontimeout=b(Vs,w,"TestLoadImage: timeout",!1,y,C),d.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=h}else y(!1)}function Go(h,y){const w=new Et,C=new AbortController,J=setTimeout(()=>{C.abort(),Vs(w,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:C.signal}).then(ae=>{clearTimeout(J),ae.ok?Vs(w,"TestPingServer: ok",!0,y):Vs(w,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(J),Vs(w,"TestPingServer: error",!1,y)})}function Vs(h,y,w,C,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),C(w)}catch{}}function Er(){this.g=new bs}function ba(h){this.i=h.Sb||null,this.h=h.ab||!1}_(ba,ts),ba.prototype.g=function(){return new Ci(this.i,this.h)};function Ci(h,y){vt.call(this),this.H=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(Ci,vt),s=Ci.prototype,s.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=y,this.readyState=1,Zs(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(y.body=h),(this.H||d).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Sr(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Zs(this)),this.g&&(this.readyState=3,Zs(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;jl(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function jl(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Sr(this):Zs(this),this.readyState==3&&jl(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,Sr(this))},s.Na=function(h){this.g&&(this.response=h,Sr(this))},s.ga=function(){this.g&&Sr(this)};function Sr(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Zs(h)}s.setRequestHeader=function(h,y){this.A.append(h,y)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var w=y.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=y.next();return h.join(`\r
`)};function Zs(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ci.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Ls(h){let y="";return Te(h,function(w,C){y+=C,y+=":",y+=w,y+=`\r
`}),y}function Ri(h,y,w){e:{for(C in w){var C=!1;break e}C=!0}C||(w=Ls(w),typeof h=="string"?w!=null&&dn(w):Mt(h,y,w))}function Vt(h){vt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(Vt,vt);var ya=/^https?$/i,Yo=["POST","PUT"];s=Vt.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,y,w,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ei.g(),this.g.onreadystatechange=E(x(this.Ca,this));try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(ae){ki(this,ae);return}if(h=w||"",w=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var J in C)w.set(J,C[J]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const ae of C.keys())w.set(ae,C.get(ae));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(w.keys()).find(ae=>ae.toLowerCase()=="content-type"),J=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(Yo,y,void 0)>=0)||C||J||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,je]of w)this.g.setRequestHeader(ae,je);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ae){ki(this,ae)}};function ki(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.o=5,Wo(h),Ha(h)}function Wo(h){h.A||(h.A=!0,Ae(h,"complete"),Ae(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ae(this,"complete"),Ae(this,"abort"),Ha(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ha(this,!0)),Vt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Ii(this):this.Xa())},s.Xa=function(){Ii(this)};function Ii(h){if(h.h&&typeof u<"u"){if(h.v&&ea(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ae(h,"readystatechange"),ea(h)==4){h.h=!1;try{const ae=h.ca();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var w;if(!(w=y)){var C;if(C=ae===0){let je=String(h.D).match(Iu)[1]||null;!je&&d.self&&d.self.location&&(je=d.self.location.protocol.slice(0,-1)),C=!ya.test(je?je.toLowerCase():"")}w=C}if(w)Ae(h,"complete"),Ae(h,"success");else{h.o=6;try{var J=ea(h)>2?h.g.statusText:""}catch{J=""}h.l=J+" ["+h.ca()+"]",Wo(h)}}finally{Ha(h)}}}}function Ha(h,y){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const w=h.g;h.g=null,y||Ae(h,"ready");try{w.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function ea(h){return h.g?h.g.readyState:0}s.ca=function(){try{return ea(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),qn(y)}};function Mn(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function $a(h){const y={};h=(h.g&&ea(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<h.length;C++){if(I(h[C]))continue;var w=Si(h[C]);const J=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const ae=y[J]||[];y[J]=ae,ae.push(w)}ve(y,function(C){return C.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function va(h,y,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||y}function jr(h){this.za=0,this.i=[],this.j=new Et,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=va("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=va("baseRetryDelayMs",5e3,h),this.Za=va("retryDelaySeedMs",1e4,h),this.Ta=va("forwardChannelMaxRetries",2,h),this.va=va("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Vo(h&&h.concurrentRequestLimit),this.Ba=new Er,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=jr.prototype,s.ka=8,s.I=1,s.connect=function(h,y,w,C){Se(0),this.W=h,this.H=y||{},w&&C!==void 0&&(this.H.OSID=w,this.H.OAID=C),this.F=this.X,this.J=Fu(this,null,this.W),wa(this)};function Ko(h){if(Tl(h),h.I==3){var y=h.V++,w=yn(h.J);if(Mt(w,"SID",h.M),Mt(w,"RID",y),Mt(w,"TYPE","terminate"),Di(h,w),y=new gn(h,h.j,y),y.M=2,y.A=Ti(yn(w)),w=!1,d.navigator&&d.navigator.sendBeacon)try{w=d.navigator.sendBeacon(y.A.toString(),"")}catch{}!w&&d.Image&&(new Image().src=y.A,w=!0),w||(y.g=Hu(y.j,null),y.g.ea(y.A)),y.F=Date.now(),ha(y)}qu(h)}function Tr(h){h.g&&(Xo(h),h.g.cancel(),h.g=null)}function Tl(h){Tr(h),h.v&&(d.clearTimeout(h.v),h.v=null),Cl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function wa(h){if(!Lo(h.h)&&!h.m){h.m=!0;var y=h.Ea;he||T(),oe||(he(),oe=!0),j.add(y,h),h.D=0}}function Al(h,y){return pa(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=y.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=tt(x(h.Ea,h,y),zu(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const J=new gn(this,this.j,h);let ae=this.o;if(this.U&&(ae?(ae=P(ae),le(ae,this.U)):ae=this.U),this.u!==null||this.R||(J.J=ae,ae=null),this.S)e:{for(var y=0,w=0;w<this.i.length;w++){t:{var C=this.i[w];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(y+=C,y>4096){y=w;break e}if(y===4096||w===this.i.length-1){y=w+1;break e}}y=1e3}else y=1e3;y=Vu(this,J,y),w=yn(this.J),Mt(w,"RID",h),Mt(w,"CVER",22),this.G&&Mt(w,"X-HTTP-Session-Id",this.G),Di(this,w),ae&&(this.R?y="headers="+dn(Ls(ae))+"&"+y:this.u&&Ri(w,this.u,ae)),Uo(this.h,J),this.Ra&&Mt(w,"TYPE","init"),this.S?(Mt(w,"$req",y),Mt(w,"SID","null"),J.U=!0,ys(J,w,null)):ys(J,w,y),this.I=2}}else this.I==3&&(h?Qo(this,h):this.i.length==0||Lo(this.h)||Qo(this))};function Qo(h,y){var w;y?w=y.l:w=h.V++;const C=yn(h.J);Mt(C,"SID",h.M),Mt(C,"RID",w),Mt(C,"AID",h.K),Di(h,C),h.u&&h.o&&Ri(C,h.u,h.o),w=new gn(h,h.j,w,h.D+1),h.u===null&&(w.J=h.o),y&&(h.i=y.G.concat(h.i)),y=Vu(h,w,1e3),w.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Uo(h.h,w),ys(w,C,y)}function Di(h,y){h.H&&Te(h.H,function(w,C){Mt(y,C,w)}),h.l&&Te({},function(w,C){Mt(y,C,w)})}function Vu(h,y,w){w=Math.min(h.i.length,w);const C=h.l?x(h.l.Ka,h.l,h):null;e:{var J=h.i;let it=-1;for(;;){const hn=["count="+w];it==-1?w>0?(it=J[0].g,hn.push("ofs="+it)):it=0:hn.push("ofs="+it);let At=!0;for(let Qt=0;Qt<w;Qt++){var ae=J[Qt].g;const Us=J[Qt].map;if(ae-=it,ae<0)it=Math.max(0,J[Qt].g-100),At=!1;else try{ae="req"+ae+"_"||"";try{var je=Us instanceof Map?Us:Object.entries(Us);for(const[Na,ta]of je){let na=ta;p(ta)&&(na=Qn(ta)),hn.push(ae+Na+"="+encodeURIComponent(na))}}catch(Na){throw hn.push(ae+"type="+encodeURIComponent("_badmap")),Na}}catch{C&&C(Us)}}if(At){je=hn.join("&");break e}}je=void 0}return h=h.i.splice(0,w),y.G=h,je}function Lu(h){if(!h.g&&!h.v){h.Y=1;var y=h.Da;he||T(),oe||(he(),oe=!0),j.add(y,h),h.A=0}}function Mi(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=tt(x(h.Da,h),zu(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Uu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=tt(x(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Se(10),Tr(this),Uu(this))};function Xo(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Uu(h){h.g=new gn(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var y=yn(h.na);Mt(y,"RID","rpc"),Mt(y,"SID",h.M),Mt(y,"AID",h.K),Mt(y,"CI",h.F?"0":"1"),!h.F&&h.ia&&Mt(y,"TO",h.ia),Mt(y,"TYPE","xmlhttp"),Di(h,y),h.u&&h.o&&Ri(y,h.u,h.o),h.O&&(h.g.H=h.O);var w=h.g;h=h.ba,w.M=1,w.A=Ti(yn(y)),w.u=null,w.R=!0,ji(w,h)}s.Va=function(){this.C!=null&&(this.C=null,Tr(this),Mi(this),Se(19))};function Cl(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Bu(h,y){var w=null;if(h.g==y){Cl(h),Xo(h),h.g=null;var C=2}else if(ga(h.h,y))w=y.G,Bo(h.h,y),C=1;else return;if(h.I!=0){if(y.o)if(C==1){w=y.u?y.u.length:0,y=Date.now()-y.F;var J=h.D;C=et(),Ae(C,new Xe(C,w)),wa(h)}else Lu(h);else if(J=y.m,J==3||J==0&&y.X>0||!(C==1&&Al(h,y)||C==2&&Mi(h)))switch(w&&w.length>0&&(y=h.h,y.i=y.i.concat(w)),J){case 1:_a(h,5);break;case 4:_a(h,10);break;case 3:_a(h,6);break;default:_a(h,2)}}}function zu(h,y){let w=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(w*=2),w*y}function _a(h,y){if(h.j.info("Error code "+y),y==2){var w=x(h.bb,h),C=h.Ua;const J=!C;C=new ws(C||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Rn(C,"https"),Ti(C),J?Js(C.toString(),w):Go(C.toString(),w)}else Se(2);h.I=0,h.l&&h.l.pa(y),qu(h),Tl(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Se(2)):(this.j.info("Failed to ping google.com"),Se(1))};function qu(h){if(h.I=0,h.ja=[],h.l){const y=zo(h.h);(y.length!=0||h.i.length!=0)&&(F(h.ja,y),F(h.ja,h.i),h.h.i.length=0,A(h.i),h.i.length=0),h.l.oa()}}function Fu(h,y,w){var C=w instanceof ws?yn(w):new ws(w);if(C.g!="")y&&(C.g=y+"."+C.g),vr(C,C.u);else{var J=d.location;C=J.protocol,y=y?y+"."+J.hostname:J.hostname,J=+J.port;const ae=new ws(null);C&&Rn(ae,C),y&&(ae.g=y),J&&vr(ae,J),w&&(ae.h=w),C=ae}return w=h.G,y=h.wa,w&&y&&Mt(C,w,y),Mt(C,"VER",h.ka),Di(h,C),C}function Hu(h,y,w){if(y&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Aa&&!h.ma?new Vt(new ba({ab:w})):new Vt(h.ma),y.Fa(h.L),y}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function $u(){}s=$u.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function Ar(){}Ar.prototype.g=function(h,y){return new Xn(h,y)};function Xn(h,y){vt.call(this),this.g=new jr(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(h?h["X-WebChannel-Client-Profile"]=y.sa:h={"X-WebChannel-Client-Profile":y.sa}),this.g.U=h,(h=y&&y.Qb)&&!I(h)&&(this.g.u=h),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!I(y)&&(this.g.G=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new Ga(this)}_(Xn,vt),Xn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Xn.prototype.close=function(){Ko(this.g)},Xn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.v&&(w={},w.__data__=Qn(h),h=w);y.i.push(new bn(y.Ya++,h)),y.I==3&&wa(y)},Xn.prototype.N=function(){this.g.l=null,delete this.j,Ko(this.g),delete this.g,Xn.Z.N.call(this)};function Gu(h){se.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const w in y){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}_(Gu,se);function Yu(){Ne.call(this),this.status=1}_(Yu,Ne);function Ga(h){this.g=h}_(Ga,$u),Ga.prototype.ra=function(){Ae(this.g,"a")},Ga.prototype.qa=function(h){Ae(this.g,new Gu(h))},Ga.prototype.pa=function(h){Ae(this.g,new Yu)},Ga.prototype.oa=function(){Ae(this.g,"b")},Ar.prototype.createWebChannel=Ar.prototype.g,Xn.prototype.send=Xn.prototype.o,Xn.prototype.open=Xn.prototype.m,Xn.prototype.close=Xn.prototype.close,iN=function(){return new Ar},rN=function(){return et()},aN=_e,hg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ns.NO_ERROR=0,ns.TIMEOUT=8,ns.HTTP_ERROR=6,gh=ns,Xs.COMPLETE="complete",sN=Xs,qa.EventType=H,H.OPEN="a",H.CLOSE="b",H.ERROR="c",H.MESSAGE="d",vt.prototype.listen=vt.prototype.J,Hc=qa,Vt.prototype.listenOnce=Vt.prototype.K,Vt.prototype.getLastError=Vt.prototype.Ha,Vt.prototype.getLastErrorCode=Vt.prototype.ya,Vt.prototype.getStatus=Vt.prototype.ca,Vt.prototype.getResponseJson=Vt.prototype.La,Vt.prototype.getResponseText=Vt.prototype.la,Vt.prototype.send=Vt.prototype.ea,Vt.prototype.setWithCredentials=Vt.prototype.Fa,nN=Vt}).apply(typeof Zd<"u"?Zd:typeof self<"u"?self:typeof window<"u"?window:{});let Gn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Gn.UNAUTHENTICATED=new Gn(null),Gn.GOOGLE_CREDENTIALS=new Gn("google-credentials-uid"),Gn.FIRST_PARTY=new Gn("first-party-uid"),Gn.MOCK_USER=new Gn("mock-user");let Do="12.8.0";function MR(s){Do=s}const cl=new Kg("@firebase/firestore");function io(){return cl.logLevel}function ke(s,...e){if(cl.logLevel<=gt.DEBUG){const n=e.map(i0);cl.debug(`Firestore (${Do}): ${s}`,...n)}}function gr(s,...e){if(cl.logLevel<=gt.ERROR){const n=e.map(i0);cl.error(`Firestore (${Do}): ${s}`,...n)}}function vo(s,...e){if(cl.logLevel<=gt.WARN){const n=e.map(i0);cl.warn(`Firestore (${Do}): ${s}`,...n)}}function i0(s){if(typeof s=="string")return s;try{return(function(n){return JSON.stringify(n)})(s)}catch{return s}}function Qe(s,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,lN(s,r,n)}function lN(s,e,n){let r=`FIRESTORE (${Do}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw gr(r),new Error(r)}function It(s,e,n,r){let o="Unexpected state";typeof n=="string"?o=n:r=n,s||lN(e,o,r)}function at(s,e){return s}const ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends za{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class hr{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class oN{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class OR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Gn.UNAUTHENTICATED)))}shutdown(){}}class PR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class VR{constructor(e){this.t=e,this.currentUser=Gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){It(this.o===void 0,42304);let r=this.i;const o=g=>this.i!==r?(r=this.i,n(g)):Promise.resolve();let u=new hr;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new hr,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await o(this.currentUser)}))},p=g=>{ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new hr)}}),0),d()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(It(typeof r.accessToken=="string",31837,{l:r}),new oN(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return It(e===null||typeof e=="string",2055,{h:e}),new Gn(e)}}class LR{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Gn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class UR{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new LR(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Gn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class BR{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Cs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){It(this.o===void 0,3512);const r=u=>{u.error!=null&&ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,ke("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?n(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>r(u)))};const o=u=>{ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>o(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?o(u):ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(It(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new dw(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function zR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<s;r++)n[r]=Math.floor(256*Math.random());return n}class l0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=zR(40);for(let u=0;u<o.length;++u)r.length<20&&o[u]<n&&(r+=e.charAt(o[u]%62))}return r}}function xt(s,e){return s<e?-1:s>e?1:0}function fg(s,e){const n=Math.min(s.length,e.length);for(let r=0;r<n;r++){const o=s.charAt(r),u=e.charAt(r);if(o!==u)return Vp(o)===Vp(u)?xt(o,u):Vp(o)?1:-1}return xt(s.length,e.length)}const qR=55296,FR=57343;function Vp(s){const e=s.charCodeAt(0);return e>=qR&&e<=FR}function wo(s,e,n){return s.length===e.length&&s.every(((r,o)=>n(r,e[o])))}const hw="__name__";class Aa{constructor(e,n,r){n===void 0?n=0:n>e.length&&Qe(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Qe(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Aa.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Aa?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let o=0;o<r;o++){const u=Aa.compareSegments(e.get(o),n.get(o));if(u!==0)return u}return xt(e.length,n.length)}static compareSegments(e,n){const r=Aa.isNumericId(e),o=Aa.isNumericId(n);return r&&!o?-1:!r&&o?1:r&&o?Aa.extractNumericId(e).compare(Aa.extractNumericId(n)):fg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ii.fromString(e.substring(4,e.length-2))}}class Gt extends Aa{construct(e,n,r){return new Gt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ce(ge.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((o=>o.length>0)))}return new Gt(n)}static emptyPath(){return new Gt([])}}const HR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bn extends Aa{construct(e,n,r){return new Bn(e,n,r)}static isValidIdentifier(e){return HR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hw}static keyField(){return new Bn([hw])}static fromServerFormat(e){const n=[];let r="",o=0;const u=()=>{if(r.length===0)throw new Ce(ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let d=!1;for(;o<e.length;){const p=e[o];if(p==="\\"){if(o+1===e.length)throw new Ce(ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[o+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ce(ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=g,o+=2}else p==="`"?(d=!d,o++):p!=="."||d?(r+=p,o++):(u(),o++)}if(u(),d)throw new Ce(ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bn(n)}static emptyPath(){return new Bn([])}}class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(Gt.fromString(e))}static fromName(e){return new Fe(Gt.fromString(e).popFirst(5))}static empty(){return new Fe(Gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Gt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new Gt(e.slice()))}}function cN(s,e,n){if(!n)throw new Ce(ge.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function $R(s,e,n,r){if(e===!0&&r===!0)throw new Ce(ge.INVALID_ARGUMENT,`${s} and ${n} cannot be used together.`)}function fw(s){if(!Fe.isDocumentKey(s))throw new Ce(ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function mw(s){if(Fe.isDocumentKey(s))throw new Ce(ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function uN(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function sf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Qe(12329,{type:typeof s})}function ms(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ce(ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=sf(s);throw new Ce(ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return s}function jn(s,e){const n={typeString:s};return e&&(n.value=e),n}function Nu(s,e){if(!uN(s))throw new Ce(ge.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const o=e[r].typeString,u="value"in e[r]?{value:e[r].value}:void 0;if(!(r in s)){n=`JSON missing required field: '${r}'`;break}const d=s[r];if(o&&typeof d!==o){n=`JSON field '${r}' must be a ${o}.`;break}if(u!==void 0&&d!==u.value){n=`Expected '${r}' field to equal '${u.value}'`;break}}if(n)throw new Ce(ge.INVALID_ARGUMENT,n);return!0}const pw=-62135596800,gw=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*gw);return new kt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Ce(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ce(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<pw)throw new Ce(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gw}_compareTo(e){return this.seconds===e.seconds?xt(this.nanoseconds,e.nanoseconds):xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Nu(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-pw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:jn("string",kt._jsonSchemaVersion),seconds:jn("number"),nanoseconds:jn("number")};class Ze{static fromTimestamp(e){return new Ze(e)}static min(){return new Ze(new kt(0,0))}static max(){return new Ze(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const lu=-1;function GR(s,e){const n=s.toTimestamp().seconds,r=s.toTimestamp().nanoseconds+1,o=Ze.fromTimestamp(r===1e9?new kt(n+1,0):new kt(n,r));return new di(o,Fe.empty(),e)}function YR(s){return new di(s.readTime,s.key,lu)}class di{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new di(Ze.min(),Fe.empty(),lu)}static max(){return new di(Ze.max(),Fe.empty(),lu)}}function WR(s,e){let n=s.readTime.compareTo(e.readTime);return n!==0?n:(n=Fe.comparator(s.documentKey,e.documentKey),n!==0?n:xt(s.largestBatchId,e.largestBatchId))}const KR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class QR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Mo(s){if(s.code!==ge.FAILED_PRECONDITION||s.message!==KR)throw s;ke("LocalStore","Unexpectedly lost primary lease")}class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Qe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ye(((r,o)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(r,o)},this.catchCallback=u=>{this.wrapFailure(n,u).next(r,o)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof ye?n:ye.resolve(n)}catch(n){return ye.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):ye.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):ye.reject(n)}static resolve(e){return new ye(((n,r)=>{n(e)}))}static reject(e){return new ye(((n,r)=>{r(e)}))}static waitFor(e){return new ye(((n,r)=>{let o=0,u=0,d=!1;e.forEach((p=>{++o,p.next((()=>{++u,d&&u===o&&n()}),(g=>r(g)))})),d=!0,u===o&&n()}))}static or(e){let n=ye.resolve(!1);for(const r of e)n=n.next((o=>o?ye.resolve(o):r()));return n}static forEach(e,n){const r=[];return e.forEach(((o,u)=>{r.push(n.call(this,o,u))})),this.waitFor(r)}static mapArray(e,n){return new ye(((r,o)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const x=g;n(e[x]).next((b=>{d[x]=b,++p,p===u&&r(d)}),(b=>o(b)))}}))}static doWhile(e,n){return new ye(((r,o)=>{const u=()=>{e()===!0?n().next((()=>{u()}),o):r()};u()}))}}function XR(s){const e=s.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Oo(s){return s.name==="IndexedDbTransactionError"}class af{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}af.ce=-1;const o0=-1;function rf(s){return s==null}function Oh(s){return s===0&&1/s==-1/0}function JR(s){return typeof s=="number"&&Number.isInteger(s)&&!Oh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const dN="";function ZR(s){let e="";for(let n=0;n<s.length;n++)e.length>0&&(e=xw(e)),e=ek(s.get(n),e);return xw(e)}function ek(s,e){let n=e;const r=s.length;for(let o=0;o<r;o++){const u=s.charAt(o);switch(u){case"\0":n+="";break;case dN:n+="";break;default:n+=u}}return n}function xw(s){return s+dN+""}function bw(s){let e=0;for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e++;return e}function _i(s,e){for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e(n,s[n])}function hN(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class en{constructor(e,n){this.comparator=e,this.root=n||Un.EMPTY}insert(e,n){return new en(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Un.BLACK,null,null))}remove(e){return new en(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Un.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(e,r.key);if(o===0)return n+r.left.size;o<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new eh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new eh(this.root,e,this.comparator,!1)}getReverseIterator(){return new eh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new eh(this.root,e,this.comparator,!0)}}class eh{constructor(e,n,r,o){this.isReverse=o,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=n?r(e.key,n):1,n&&o&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Un{constructor(e,n,r,o,u){this.key=e,this.value=n,this.color=r??Un.RED,this.left=o??Un.EMPTY,this.right=u??Un.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,o,u){return new Un(e??this.key,n??this.value,r??this.color,o??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let o=this;const u=r(e,o.key);return o=u<0?o.copy(null,null,null,o.left.insert(e,n,r),null):u===0?o.copy(null,n,null,null,null):o.copy(null,null,null,null,o.right.insert(e,n,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Un.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,o=this;if(n(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,n),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),n(e,o.key)===0){if(o.right.isEmpty())return Un.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,n))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Un.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Un.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Qe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Qe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Qe(27949);return e+(this.isRed()?0:1)}}Un.EMPTY=null,Un.RED=!0,Un.BLACK=!1;Un.EMPTY=new class{constructor(){this.size=0}get key(){throw Qe(57766)}get value(){throw Qe(16141)}get color(){throw Qe(16727)}get left(){throw Qe(29726)}get right(){throw Qe(36894)}copy(e,n,r,o,u){return this}insert(e,n,r){return new Un(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Cn{constructor(e){this.comparator=e,this.data=new en(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;n(o.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new yw(this.data.getIterator())}getIteratorFrom(e){return new yw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof Cn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const o=n.getNext().key,u=r.getNext().key;if(this.comparator(o,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Cn(this.comparator);return n.data=e,n}}class yw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Rs{constructor(e){this.fields=e,e.sort(Bn.comparator)}static empty(){return new Rs([])}unionWith(e){let n=new Cn(Bn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Rs(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return wo(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}class fN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class zn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(o){try{return atob(o)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new fN("Invalid base64 string: "+u):u}})(e);return new zn(n)}static fromUint8Array(e){const n=(function(o){let u="";for(let d=0;d<o.length;++d)u+=String.fromCharCode(o[d]);return u})(e);return new zn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zn.EMPTY_BYTE_STRING=new zn("");const tk=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hi(s){if(It(!!s,39018),typeof s=="string"){let e=0;const n=tk.exec(s);if(It(!!n,46558,{timestamp:s}),n[1]){let o=n[1];o=(o+"000000000").substr(0,9),e=Number(o)}const r=new Date(s);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:pn(s.seconds),nanos:pn(s.nanos)}}function pn(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function fi(s){return typeof s=="string"?zn.fromBase64String(s):zn.fromUint8Array(s)}const mN="server_timestamp",pN="__type__",gN="__previous_value__",xN="__local_write_time__";function c0(s){return(s?.mapValue?.fields||{})[pN]?.stringValue===mN}function lf(s){const e=s.mapValue.fields[gN];return c0(e)?lf(e):e}function ou(s){const e=hi(s.mapValue.fields[xN].timestampValue);return new kt(e.seconds,e.nanos)}class nk{constructor(e,n,r,o,u,d,p,g,x,b,_){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=o,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=x,this.isUsingEmulator=b,this.apiKey=_}}const Ph="(default)";class cu{constructor(e,n){this.projectId=e,this.database=n||Ph}static empty(){return new cu("","")}get isDefaultDatabase(){return this.database===Ph}isEqual(e){return e instanceof cu&&e.projectId===this.projectId&&e.database===this.database}}function sk(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new Ce(ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cu(s.options.projectId,e)}const bN="__type__",ak="__max__",th={mapValue:{}},yN="__vector__",Vh="value";function mi(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?c0(s)?4:ik(s)?9007199254740991:rk(s)?10:11:Qe(28295,{value:s})}function Ua(s,e){if(s===e)return!0;const n=mi(s);if(n!==mi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return ou(s).isEqual(ou(e));case 3:return(function(o,u){if(typeof o.timestampValue=="string"&&typeof u.timestampValue=="string"&&o.timestampValue.length===u.timestampValue.length)return o.timestampValue===u.timestampValue;const d=hi(o.timestampValue),p=hi(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(o,u){return fi(o.bytesValue).isEqual(fi(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(o,u){return pn(o.geoPointValue.latitude)===pn(u.geoPointValue.latitude)&&pn(o.geoPointValue.longitude)===pn(u.geoPointValue.longitude)})(s,e);case 2:return(function(o,u){if("integerValue"in o&&"integerValue"in u)return pn(o.integerValue)===pn(u.integerValue);if("doubleValue"in o&&"doubleValue"in u){const d=pn(o.doubleValue),p=pn(u.doubleValue);return d===p?Oh(d)===Oh(p):isNaN(d)&&isNaN(p)}return!1})(s,e);case 9:return wo(s.arrayValue.values||[],e.arrayValue.values||[],Ua);case 10:case 11:return(function(o,u){const d=o.mapValue.fields||{},p=u.mapValue.fields||{};if(bw(d)!==bw(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Ua(d[g],p[g])))return!1;return!0})(s,e);default:return Qe(52216,{left:s})}}function uu(s,e){return(s.values||[]).find((n=>Ua(n,e)))!==void 0}function _o(s,e){if(s===e)return 0;const n=mi(s),r=mi(e);if(n!==r)return xt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xt(s.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=pn(u.integerValue||u.doubleValue),g=pn(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return vw(s.timestampValue,e.timestampValue);case 4:return vw(ou(s),ou(e));case 5:return fg(s.stringValue,e.stringValue);case 6:return(function(u,d){const p=fi(u),g=fi(d);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let x=0;x<p.length&&x<g.length;x++){const b=xt(p[x],g[x]);if(b!==0)return b}return xt(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=xt(pn(u.latitude),pn(d.latitude));return p!==0?p:xt(pn(u.longitude),pn(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return ww(s.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},x=p[Vh]?.arrayValue,b=g[Vh]?.arrayValue,_=xt(x?.values?.length||0,b?.values?.length||0);return _!==0?_:ww(x,b)})(s.mapValue,e.mapValue);case 11:return(function(u,d){if(u===th.mapValue&&d===th.mapValue)return 0;if(u===th.mapValue)return 1;if(d===th.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),x=d.fields||{},b=Object.keys(x);g.sort(),b.sort();for(let _=0;_<g.length&&_<b.length;++_){const E=fg(g[_],b[_]);if(E!==0)return E;const A=_o(p[g[_]],x[b[_]]);if(A!==0)return A}return xt(g.length,b.length)})(s.mapValue,e.mapValue);default:throw Qe(23264,{he:n})}}function vw(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return xt(s,e);const n=hi(s),r=hi(e),o=xt(n.seconds,r.seconds);return o!==0?o:xt(n.nanos,r.nanos)}function ww(s,e){const n=s.values||[],r=e.values||[];for(let o=0;o<n.length&&o<r.length;++o){const u=_o(n[o],r[o]);if(u)return u}return xt(n.length,r.length)}function No(s){return mg(s)}function mg(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(n){const r=hi(n);return`time(${r.seconds},${r.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(n){return fi(n).toBase64()})(s.bytesValue):"referenceValue"in s?(function(n){return Fe.fromName(n).toString()})(s.referenceValue):"geoPointValue"in s?(function(n){return`geo(${n.latitude},${n.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(n){let r="[",o=!0;for(const u of n.values||[])o?o=!1:r+=",",r+=mg(u);return r+"]"})(s.arrayValue):"mapValue"in s?(function(n){const r=Object.keys(n.fields||{}).sort();let o="{",u=!0;for(const d of r)u?u=!1:o+=",",o+=`${d}:${mg(n.fields[d])}`;return o+"}"})(s.mapValue):Qe(61005,{value:s})}function xh(s){switch(mi(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lf(s);return e?16+xh(e):16;case 5:return 2*s.stringValue.length;case 6:return fi(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((o,u)=>o+xh(u)),0)})(s.arrayValue);case 10:case 11:return(function(r){let o=0;return _i(r.fields,((u,d)=>{o+=u.length+xh(d)})),o})(s.mapValue);default:throw Qe(13486,{value:s})}}function _w(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function pg(s){return!!s&&"integerValue"in s}function u0(s){return!!s&&"arrayValue"in s}function Nw(s){return!!s&&"nullValue"in s}function Ew(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function bh(s){return!!s&&"mapValue"in s}function rk(s){return(s?.mapValue?.fields||{})[bN]?.stringValue===yN}function Xc(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return _i(s.mapValue.fields,((n,r)=>e.mapValue.fields[n]=Xc(r))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(s.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Xc(s.arrayValue.values[n]);return e}return{...s}}function ik(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===ak}class hs{constructor(e){this.value=e}static empty(){return new hs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!bh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Xc(n)}setAll(e){let n=Bn.emptyPath(),r={},o=[];e.forEach(((d,p)=>{if(!n.isImmediateParentOf(p)){const g=this.getFieldsMap(n);this.applyChanges(g,r,o),r={},o=[],n=p.popLast()}d?r[p.lastSegment()]=Xc(d):o.push(p.lastSegment())}));const u=this.getFieldsMap(n);this.applyChanges(u,r,o)}delete(e){const n=this.field(e.popLast());bh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ua(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let o=n.mapValue.fields[e.get(r)];bh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=o),n=o}return n.mapValue.fields}applyChanges(e,n,r){_i(n,((o,u)=>e[o]=u));for(const o of r)delete e[o]}clone(){return new hs(Xc(this.value))}}function vN(s){const e=[];return _i(s.fields,((n,r)=>{const o=new Bn([n]);if(bh(r)){const u=vN(r.mapValue).fields;if(u.length===0)e.push(o);else for(const d of u)e.push(o.child(d))}else e.push(o)})),new Rs(e)}class Yn{constructor(e,n,r,o,u,d,p){this.key=e,this.documentType=n,this.version=r,this.readTime=o,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new Yn(e,0,Ze.min(),Ze.min(),Ze.min(),hs.empty(),0)}static newFoundDocument(e,n,r,o){return new Yn(e,1,n,Ze.min(),r,o,0)}static newNoDocument(e,n){return new Yn(e,2,n,Ze.min(),Ze.min(),hs.empty(),0)}static newUnknownDocument(e,n){return new Yn(e,3,n,Ze.min(),Ze.min(),hs.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ze.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=hs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=hs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ze.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Yn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Yn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Lh{constructor(e,n){this.position=e,this.inclusive=n}}function Sw(s,e,n){let r=0;for(let o=0;o<s.position.length;o++){const u=e[o],d=s.position[o];if(u.field.isKeyField()?r=Fe.comparator(Fe.fromName(d.referenceValue),n.key):r=_o(d,n.data.field(u.field)),u.dir==="desc"&&(r*=-1),r!==0)break}return r}function jw(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let n=0;n<s.position.length;n++)if(!Ua(s.position[n],e.position[n]))return!1;return!0}class Uh{constructor(e,n="asc"){this.field=e,this.dir=n}}function lk(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class wN{}class Sn extends wN{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new ck(e,n,r):n==="array-contains"?new hk(e,r):n==="in"?new fk(e,r):n==="not-in"?new mk(e,r):n==="array-contains-any"?new pk(e,r):new Sn(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new uk(e,r):new dk(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(_o(n,this.value)):n!==null&&mi(this.value)===mi(n)&&this.matchesComparison(_o(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Qe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ua extends wN{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new ua(e,n)}matches(e){return _N(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function _N(s){return s.op==="and"}function NN(s){return ok(s)&&_N(s)}function ok(s){for(const e of s.filters)if(e instanceof ua)return!1;return!0}function gg(s){if(s instanceof Sn)return s.field.canonicalString()+s.op.toString()+No(s.value);if(NN(s))return s.filters.map((e=>gg(e))).join(",");{const e=s.filters.map((n=>gg(n))).join(",");return`${s.op}(${e})`}}function EN(s,e){return s instanceof Sn?(function(r,o){return o instanceof Sn&&r.op===o.op&&r.field.isEqual(o.field)&&Ua(r.value,o.value)})(s,e):s instanceof ua?(function(r,o){return o instanceof ua&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce(((u,d,p)=>u&&EN(d,o.filters[p])),!0):!1})(s,e):void Qe(19439)}function SN(s){return s instanceof Sn?(function(n){return`${n.field.canonicalString()} ${n.op} ${No(n.value)}`})(s):s instanceof ua?(function(n){return n.op.toString()+" {"+n.getFilters().map(SN).join(" ,")+"}"})(s):"Filter"}class ck extends Sn{constructor(e,n,r){super(e,n,r),this.key=Fe.fromName(r.referenceValue)}matches(e){const n=Fe.comparator(e.key,this.key);return this.matchesComparison(n)}}class uk extends Sn{constructor(e,n){super(e,"in",n),this.keys=jN("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class dk extends Sn{constructor(e,n){super(e,"not-in",n),this.keys=jN("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function jN(s,e){return(e.arrayValue?.values||[]).map((n=>Fe.fromName(n.referenceValue)))}class hk extends Sn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return u0(n)&&uu(n.arrayValue,this.value)}}class fk extends Sn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&uu(this.value.arrayValue,n)}}class mk extends Sn{constructor(e,n){super(e,"not-in",n)}matches(e){if(uu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!uu(this.value.arrayValue,n)}}class pk extends Sn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!u0(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>uu(this.value.arrayValue,r)))}}class gk{constructor(e,n=null,r=[],o=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=o,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Tw(s,e=null,n=[],r=[],o=null,u=null,d=null){return new gk(s,e,n,r,o,u,d)}function d0(s){const e=at(s);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>gg(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(u){return u.field.canonicalString()+u.dir})(r))).join(","),rf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>No(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>No(r))).join(",")),e.Te=n}return e.Te}function h0(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<s.orderBy.length;n++)if(!lk(s.orderBy[n],e.orderBy[n]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let n=0;n<s.filters.length;n++)if(!EN(s.filters[n],e.filters[n]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!jw(s.startAt,e.startAt)&&jw(s.endAt,e.endAt)}function xg(s){return Fe.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class Eu{constructor(e,n=null,r=[],o=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=o,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function xk(s,e,n,r,o,u,d,p){return new Eu(s,e,n,r,o,u,d,p)}function of(s){return new Eu(s)}function Aw(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function bk(s){return Fe.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function TN(s){return s.collectionGroup!==null}function Jc(s){const e=at(s);if(e.Ie===null){e.Ie=[];const n=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),n.add(u.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Cn(Bn.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((x=>{x.isInequality()&&(p=p.add(x.field))}))})),p})(e).forEach((u=>{n.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Uh(u,r))})),n.has(Bn.keyField().canonicalString())||e.Ie.push(new Uh(Bn.keyField(),r))}return e.Ie}function Ma(s){const e=at(s);return e.Ee||(e.Ee=yk(e,Jc(s))),e.Ee}function yk(s,e){if(s.limitType==="F")return Tw(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((o=>{const u=o.dir==="desc"?"asc":"desc";return new Uh(o.field,u)}));const n=s.endAt?new Lh(s.endAt.position,s.endAt.inclusive):null,r=s.startAt?new Lh(s.startAt.position,s.startAt.inclusive):null;return Tw(s.path,s.collectionGroup,e,s.filters,s.limit,n,r)}}function bg(s,e){const n=s.filters.concat([e]);return new Eu(s.path,s.collectionGroup,s.explicitOrderBy.slice(),n,s.limit,s.limitType,s.startAt,s.endAt)}function yg(s,e,n){return new Eu(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,n,s.startAt,s.endAt)}function cf(s,e){return h0(Ma(s),Ma(e))&&s.limitType===e.limitType}function AN(s){return`${d0(Ma(s))}|lt:${s.limitType}`}function lo(s){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((o=>SN(o))).join(", ")}]`),rf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((o=>No(o))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((o=>No(o))).join(",")),`Target(${r})`})(Ma(s))}; limitType=${s.limitType})`}function uf(s,e){return e.isFoundDocument()&&(function(r,o){const u=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(u):Fe.isDocumentKey(r.path)?r.path.isEqual(u):r.path.isImmediateParentOf(u)})(s,e)&&(function(r,o){for(const u of Jc(r))if(!u.field.isKeyField()&&o.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(r,o){for(const u of r.filters)if(!u.matches(o))return!1;return!0})(s,e)&&(function(r,o){return!(r.startAt&&!(function(d,p,g){const x=Sw(d,p,g);return d.inclusive?x<=0:x<0})(r.startAt,Jc(r),o)||r.endAt&&!(function(d,p,g){const x=Sw(d,p,g);return d.inclusive?x>=0:x>0})(r.endAt,Jc(r),o))})(s,e)}function vk(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function CN(s){return(e,n)=>{let r=!1;for(const o of Jc(s)){const u=wk(o,e,n);if(u!==0)return u;r=r||o.field.isKeyField()}return 0}}function wk(s,e,n){const r=s.field.isKeyField()?Fe.comparator(e.key,n.key):(function(u,d,p){const g=d.data.field(u),x=p.data.field(u);return g!==null&&x!==null?_o(g,x):Qe(42886)})(s.field,e,n);switch(s.dir){case"asc":return r;case"desc":return-1*r;default:return Qe(19790,{direction:s.dir})}}class bl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[o,u]of r)if(this.equalsFn(o,e))return u}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),o=this.inner[r];if(o===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let u=0;u<o.length;u++)if(this.equalsFn(o[u][0],e))return void(o[u]=[e,n]);o.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return r.length===1?delete this.inner[n]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(e){_i(this.inner,((n,r)=>{for(const[o,u]of r)e(o,u)}))}isEmpty(){return hN(this.inner)}size(){return this.innerSize}}const _k=new en(Fe.comparator);function xr(){return _k}const RN=new en(Fe.comparator);function $c(...s){let e=RN;for(const n of s)e=e.insert(n.key,n);return e}function kN(s){let e=RN;return s.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function tl(){return Zc()}function IN(){return Zc()}function Zc(){return new bl((s=>s.toString()),((s,e)=>s.isEqual(e)))}const Nk=new en(Fe.comparator),Ek=new Cn(Fe.comparator);function bt(...s){let e=Ek;for(const n of s)e=e.add(n);return e}const Sk=new Cn(xt);function jk(){return Sk}function f0(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Oh(e)?"-0":e}}function DN(s){return{integerValue:""+s}}function Tk(s,e){return JR(e)?DN(e):f0(s,e)}class df{constructor(){this._=void 0}}function Ak(s,e,n){return s instanceof du?(function(o,u){const d={fields:{[pN]:{stringValue:mN},[xN]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return u&&c0(u)&&(u=lf(u)),u&&(d.fields[gN]=u),{mapValue:d}})(n,e):s instanceof hu?ON(s,e):s instanceof fu?PN(s,e):(function(o,u){const d=MN(o,u),p=Cw(d)+Cw(o.Ae);return pg(d)&&pg(o.Ae)?DN(p):f0(o.serializer,p)})(s,e)}function Ck(s,e,n){return s instanceof hu?ON(s,e):s instanceof fu?PN(s,e):n}function MN(s,e){return s instanceof Bh?(function(r){return pg(r)||(function(u){return!!u&&"doubleValue"in u})(r)})(e)?e:{integerValue:0}:null}class du extends df{}class hu extends df{constructor(e){super(),this.elements=e}}function ON(s,e){const n=VN(e);for(const r of s.elements)n.some((o=>Ua(o,r)))||n.push(r);return{arrayValue:{values:n}}}class fu extends df{constructor(e){super(),this.elements=e}}function PN(s,e){let n=VN(e);for(const r of s.elements)n=n.filter((o=>!Ua(o,r)));return{arrayValue:{values:n}}}class Bh extends df{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Cw(s){return pn(s.integerValue||s.doubleValue)}function VN(s){return u0(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class Rk{constructor(e,n){this.field=e,this.transform=n}}function kk(s,e){return s.field.isEqual(e.field)&&(function(r,o){return r instanceof hu&&o instanceof hu||r instanceof fu&&o instanceof fu?wo(r.elements,o.elements,Ua):r instanceof Bh&&o instanceof Bh?Ua(r.Ae,o.Ae):r instanceof du&&o instanceof du})(s.transform,e.transform)}class Ik{constructor(e,n){this.version=e,this.transformResults=n}}class Ks{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ks}static exists(e){return new Ks(void 0,e)}static updateTime(e){return new Ks(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yh(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class hf{}function LN(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new m0(s.key,Ks.none()):new Su(s.key,s.data,Ks.none());{const n=s.data,r=hs.empty();let o=new Cn(Bn.comparator);for(let u of e.fields)if(!o.has(u)){let d=n.field(u);d===null&&u.length>1&&(u=u.popLast(),d=n.field(u)),d===null?r.delete(u):r.set(u,d),o=o.add(u)}return new Ni(s.key,r,new Rs(o.toArray()),Ks.none())}}function Dk(s,e,n){s instanceof Su?(function(o,u,d){const p=o.value.clone(),g=kw(o.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(s,e,n):s instanceof Ni?(function(o,u,d){if(!yh(o.precondition,u))return void u.convertToUnknownDocument(d.version);const p=kw(o.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(UN(o)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(s,e,n):(function(o,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,n)}function eu(s,e,n,r){return s instanceof Su?(function(u,d,p,g){if(!yh(u.precondition,d))return p;const x=u.value.clone(),b=Iw(u.fieldTransforms,g,d);return x.setAll(b),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),null})(s,e,n,r):s instanceof Ni?(function(u,d,p,g){if(!yh(u.precondition,d))return p;const x=Iw(u.fieldTransforms,g,d),b=d.data;return b.setAll(UN(u)),b.setAll(x),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((_=>_.field)))})(s,e,n,r):(function(u,d,p){return yh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(s,e,n)}function Mk(s,e){let n=null;for(const r of s.fieldTransforms){const o=e.data.field(r.field),u=MN(r.transform,o||null);u!=null&&(n===null&&(n=hs.empty()),n.set(r.field,u))}return n||null}function Rw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&wo(r,o,((u,d)=>kk(u,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Su extends hf{constructor(e,n,r,o=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Ni extends hf{constructor(e,n,r,o,u=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=o,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function UN(s){const e=new Map;return s.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=s.data.field(n);e.set(n,r)}})),e}function kw(s,e,n){const r=new Map;It(s.length===n.length,32656,{Ve:n.length,de:s.length});for(let o=0;o<n.length;o++){const u=s[o],d=u.transform,p=e.data.field(u.field);r.set(u.field,Ck(d,p,n[o]))}return r}function Iw(s,e,n){const r=new Map;for(const o of s){const u=o.transform,d=n.data.field(o.field);r.set(o.field,Ak(u,d,e))}return r}class m0 extends hf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ok extends hf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Pk{constructor(e,n,r,o){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let o=0;o<this.mutations.length;o++){const u=this.mutations[o];u.key.isEqual(e.key)&&Dk(u,e,r[o])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=eu(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=eu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=IN();return this.mutations.forEach((o=>{const u=e.get(o.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=n.has(o.key)?null:p;const g=LN(d,p);g!==null&&r.set(o.key,g),d.isValidDocument()||d.convertToNoDocument(Ze.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),bt())}isEqual(e){return this.batchId===e.batchId&&wo(this.mutations,e.mutations,((n,r)=>Rw(n,r)))&&wo(this.baseMutations,e.baseMutations,((n,r)=>Rw(n,r)))}}class p0{constructor(e,n,r,o){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=o}static from(e,n,r){It(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let o=(function(){return Nk})();const u=e.mutations;for(let d=0;d<u.length;d++)o=o.insert(u[d].key,r[d].version);return new p0(e,n,r,o)}}class Vk{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Lk{constructor(e,n){this.count=e,this.unchangedNames=n}}var En,wt;function Uk(s){switch(s){case ge.OK:return Qe(64938);case ge.CANCELLED:case ge.UNKNOWN:case ge.DEADLINE_EXCEEDED:case ge.RESOURCE_EXHAUSTED:case ge.INTERNAL:case ge.UNAVAILABLE:case ge.UNAUTHENTICATED:return!1;case ge.INVALID_ARGUMENT:case ge.NOT_FOUND:case ge.ALREADY_EXISTS:case ge.PERMISSION_DENIED:case ge.FAILED_PRECONDITION:case ge.ABORTED:case ge.OUT_OF_RANGE:case ge.UNIMPLEMENTED:case ge.DATA_LOSS:return!0;default:return Qe(15467,{code:s})}}function BN(s){if(s===void 0)return gr("GRPC error has no .code"),ge.UNKNOWN;switch(s){case En.OK:return ge.OK;case En.CANCELLED:return ge.CANCELLED;case En.UNKNOWN:return ge.UNKNOWN;case En.DEADLINE_EXCEEDED:return ge.DEADLINE_EXCEEDED;case En.RESOURCE_EXHAUSTED:return ge.RESOURCE_EXHAUSTED;case En.INTERNAL:return ge.INTERNAL;case En.UNAVAILABLE:return ge.UNAVAILABLE;case En.UNAUTHENTICATED:return ge.UNAUTHENTICATED;case En.INVALID_ARGUMENT:return ge.INVALID_ARGUMENT;case En.NOT_FOUND:return ge.NOT_FOUND;case En.ALREADY_EXISTS:return ge.ALREADY_EXISTS;case En.PERMISSION_DENIED:return ge.PERMISSION_DENIED;case En.FAILED_PRECONDITION:return ge.FAILED_PRECONDITION;case En.ABORTED:return ge.ABORTED;case En.OUT_OF_RANGE:return ge.OUT_OF_RANGE;case En.UNIMPLEMENTED:return ge.UNIMPLEMENTED;case En.DATA_LOSS:return ge.DATA_LOSS;default:return Qe(39323,{code:s})}}(wt=En||(En={}))[wt.OK=0]="OK",wt[wt.CANCELLED=1]="CANCELLED",wt[wt.UNKNOWN=2]="UNKNOWN",wt[wt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wt[wt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wt[wt.NOT_FOUND=5]="NOT_FOUND",wt[wt.ALREADY_EXISTS=6]="ALREADY_EXISTS",wt[wt.PERMISSION_DENIED=7]="PERMISSION_DENIED",wt[wt.UNAUTHENTICATED=16]="UNAUTHENTICATED",wt[wt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wt[wt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wt[wt.ABORTED=10]="ABORTED",wt[wt.OUT_OF_RANGE=11]="OUT_OF_RANGE",wt[wt.UNIMPLEMENTED=12]="UNIMPLEMENTED",wt[wt.INTERNAL=13]="INTERNAL",wt[wt.UNAVAILABLE=14]="UNAVAILABLE",wt[wt.DATA_LOSS=15]="DATA_LOSS";function Bk(){return new TextEncoder}const zk=new ii([4294967295,4294967295],0);function Dw(s){const e=Bk().encode(s),n=new tN;return n.update(e),new Uint8Array(n.digest())}function Mw(s){const e=new DataView(s.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),o=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ii([n,r],0),new ii([o,u],0)]}class g0{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Gc(`Invalid padding: ${n}`);if(r<0)throw new Gc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Gc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Gc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ii.fromNumber(this.ge)}ye(e,n,r){let o=e.add(n.multiply(ii.fromNumber(r)));return o.compare(zk)===1&&(o=new ii([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Dw(e),[r,o]=Mw(n);for(let u=0;u<this.hashCount;u++){const d=this.ye(r,o,u);if(!this.we(d))return!1}return!0}static create(e,n,r){const o=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new g0(u,o,n);return r.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const n=Dw(e),[r,o]=Mw(n);for(let u=0;u<this.hashCount;u++){const d=this.ye(r,o,u);this.be(d)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Gc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ff{constructor(e,n,r,o,u){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const o=new Map;return o.set(e,ju.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ff(Ze.min(),o,new en(xt),xr(),bt())}}class ju{constructor(e,n,r,o,u){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ju(r,n,bt(),bt(),bt())}}class vh{constructor(e,n,r,o){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=o}}class zN{constructor(e,n){this.targetId=e,this.Ce=n}}class qN{constructor(e,n,r=zn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=o}}class Ow{constructor(){this.ve=0,this.Fe=Pw(),this.Me=zn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=bt(),n=bt(),r=bt();return this.Fe.forEach(((o,u)=>{switch(u){case 0:e=e.add(o);break;case 2:n=n.add(o);break;case 1:r=r.add(o);break;default:Qe(38017,{changeType:u})}})),new ju(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=Pw()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,It(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class qk{constructor(e){this.Ge=e,this.ze=new Map,this.je=xr(),this.He=nh(),this.Je=nh(),this.Ze=new en(xt)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Qe(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,o)=>{this.rt(o)&&n(o)}))}st(e){const n=e.targetId,r=e.Ce.count,o=this.ot(n);if(o){const u=o.target;if(xg(u))if(r===0){const d=new Fe(u.path);this.et(n,d,Yn.newNoDocument(d,Ze.min()))}else It(r===1,20013,{expectedCount:r});else{const d=this._t(n);if(d!==r){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(n);const x=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,x)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:o=0},hashCount:u=0}=n;let d,p;try{d=fi(r).toUint8Array()}catch(g){if(g instanceof fN)return vo("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new g0(d,o,u)}catch(g){return vo(g instanceof Gc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let o=0;return r.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(n,u,null),o++)})),o}Tt(e){const n=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&xg(p.target)){const g=new Fe(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,Yn.newNoDocument(g,e))}u.Be&&(n.set(d,u.ke()),u.Ke())}}));let r=bt();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const x=this.ot(g);return!x||x.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(r=r.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const o=new ff(e,n,this.Ze,this.je,r);return this.je=xr(),this.He=nh(),this.Je=nh(),this.Ze=new en(xt),o}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,n)?o.qe(n,1):o.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new Ow,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new Cn(xt),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new Cn(xt),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ke("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ow),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function nh(){return new en(Fe.comparator)}function Pw(){return new en(Fe.comparator)}const Fk={asc:"ASCENDING",desc:"DESCENDING"},Hk={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$k={and:"AND",or:"OR"};class Gk{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function vg(s,e){return s.useProto3Json||rf(e)?e:{value:e}}function zh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function FN(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function Yk(s,e){return zh(s,e.toTimestamp())}function Oa(s){return It(!!s,49232),Ze.fromTimestamp((function(n){const r=hi(n);return new kt(r.seconds,r.nanos)})(s))}function x0(s,e){return wg(s,e).canonicalString()}function wg(s,e){const n=(function(o){return new Gt(["projects",o.projectId,"databases",o.database])})(s).child("documents");return e===void 0?n:n.child(e)}function HN(s){const e=Gt.fromString(s);return It(KN(e),10190,{key:e.toString()}),e}function _g(s,e){return x0(s.databaseId,e.path)}function Lp(s,e){const n=HN(e);if(n.get(1)!==s.databaseId.projectId)throw new Ce(ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+s.databaseId.projectId);if(n.get(3)!==s.databaseId.database)throw new Ce(ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+s.databaseId.database);return new Fe(GN(n))}function $N(s,e){return x0(s.databaseId,e)}function Wk(s){const e=HN(s);return e.length===4?Gt.emptyPath():GN(e)}function Ng(s){return new Gt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function GN(s){return It(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Vw(s,e,n){return{name:_g(s,e),fields:n.value.mapValue.fields}}function Kk(s,e){let n;if("targetChange"in e){e.targetChange;const r=(function(x){return x==="NO_CHANGE"?0:x==="ADD"?1:x==="REMOVE"?2:x==="CURRENT"?3:x==="RESET"?4:Qe(39313,{state:x})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],u=(function(x,b){return x.useProto3Json?(It(b===void 0||typeof b=="string",58123),zn.fromBase64String(b||"")):(It(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),zn.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(x){const b=x.code===void 0?ge.UNKNOWN:BN(x.code);return new Ce(b,x.message||"")})(d);n=new qN(r,o,u,p||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const o=Lp(s,r.document.name),u=Oa(r.document.updateTime),d=r.document.createTime?Oa(r.document.createTime):Ze.min(),p=new hs({mapValue:{fields:r.document.fields}}),g=Yn.newFoundDocument(o,u,d,p),x=r.targetIds||[],b=r.removedTargetIds||[];n=new vh(x,b,g.key,g)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const o=Lp(s,r.document),u=r.readTime?Oa(r.readTime):Ze.min(),d=Yn.newNoDocument(o,u),p=r.removedTargetIds||[];n=new vh([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const o=Lp(s,r.document),u=r.removedTargetIds||[];n=new vh([],u,o,null)}else{if(!("filter"in e))return Qe(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:o=0,unchangedNames:u}=r,d=new Lk(o,u),p=r.targetId;n=new zN(p,d)}}return n}function Qk(s,e){let n;if(e instanceof Su)n={update:Vw(s,e.key,e.value)};else if(e instanceof m0)n={delete:_g(s,e.key)};else if(e instanceof Ni)n={update:Vw(s,e.key,e.data),updateMask:r4(e.fieldMask)};else{if(!(e instanceof Ok))return Qe(16599,{dt:e.type});n={verify:_g(s,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(u,d){const p=d.transform;if(p instanceof du)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof hu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof fu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Bh)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Qe(20930,{transform:d.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(o,u){return u.updateTime!==void 0?{updateTime:Yk(o,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Qe(27497)})(s,e.precondition)),n}function Xk(s,e){return s&&s.length>0?(It(e!==void 0,14353),s.map((n=>(function(o,u){let d=o.updateTime?Oa(o.updateTime):Oa(u);return d.isEqual(Ze.min())&&(d=Oa(u)),new Ik(d,o.transformResults||[])})(n,e)))):[]}function Jk(s,e){return{documents:[$N(s,e.path)]}}function Zk(s,e){const n={structuredQuery:{}},r=e.path;let o;e.collectionGroup!==null?(o=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$N(s,o);const u=(function(x){if(x.length!==0)return WN(ua.create(x,"and"))})(e.filters);u&&(n.structuredQuery.where=u);const d=(function(x){if(x.length!==0)return x.map((b=>(function(E){return{field:oo(E.field),direction:n4(E.dir)}})(b)))})(e.orderBy);d&&(n.structuredQuery.orderBy=d);const p=vg(s,e.limit);return p!==null&&(n.structuredQuery.limit=p),e.startAt&&(n.structuredQuery.startAt=(function(x){return{before:x.inclusive,values:x.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(x){return{before:!x.inclusive,values:x.position}})(e.endAt)),{ft:n,parent:o}}function e4(s){let e=Wk(s.parent);const n=s.structuredQuery,r=n.from?n.from.length:0;let o=null;if(r>0){It(r===1,65062);const b=n.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let u=[];n.where&&(u=(function(_){const E=YN(_);return E instanceof ua&&NN(E)?E.getFilters():[E]})(n.where));let d=[];n.orderBy&&(d=(function(_){return _.map((E=>(function(F){return new Uh(co(F.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(F.direction))})(E)))})(n.orderBy));let p=null;n.limit&&(p=(function(_){let E;return E=typeof _=="object"?_.value:_,rf(E)?null:E})(n.limit));let g=null;n.startAt&&(g=(function(_){const E=!!_.before,A=_.values||[];return new Lh(A,E)})(n.startAt));let x=null;return n.endAt&&(x=(function(_){const E=!_.before,A=_.values||[];return new Lh(A,E)})(n.endAt)),xk(e,o,d,u,p,"F",g,x)}function t4(s,e){const n=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Qe(28987,{purpose:o})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function YN(s){return s.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=co(n.unaryFilter.field);return Sn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=co(n.unaryFilter.field);return Sn.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=co(n.unaryFilter.field);return Sn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=co(n.unaryFilter.field);return Sn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Qe(61313);default:return Qe(60726)}})(s):s.fieldFilter!==void 0?(function(n){return Sn.create(co(n.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Qe(58110);default:return Qe(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(n){return ua.create(n.compositeFilter.filters.map((r=>YN(r))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Qe(1026)}})(n.compositeFilter.op))})(s):Qe(30097,{filter:s})}function n4(s){return Fk[s]}function s4(s){return Hk[s]}function a4(s){return $k[s]}function oo(s){return{fieldPath:s.canonicalString()}}function co(s){return Bn.fromServerFormat(s.fieldPath)}function WN(s){return s instanceof Sn?(function(n){if(n.op==="=="){if(Ew(n.value))return{unaryFilter:{field:oo(n.field),op:"IS_NAN"}};if(Nw(n.value))return{unaryFilter:{field:oo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Ew(n.value))return{unaryFilter:{field:oo(n.field),op:"IS_NOT_NAN"}};if(Nw(n.value))return{unaryFilter:{field:oo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oo(n.field),op:s4(n.op),value:n.value}}})(s):s instanceof ua?(function(n){const r=n.getFilters().map((o=>WN(o)));return r.length===1?r[0]:{compositeFilter:{op:a4(n.op),filters:r}}})(s):Qe(54877,{filter:s})}function r4(s){const e=[];return s.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function KN(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function QN(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class si{constructor(e,n,r,o,u=Ze.min(),d=Ze.min(),p=zn.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new si(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class i4{constructor(e){this.yt=e}}function l4(s){const e=e4({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?yg(e,e.limit,"L"):e}class o4{constructor(){this.Sn=new c4}addToCollectionParentIndex(e,n){return this.Sn.add(n),ye.resolve()}getCollectionParents(e,n){return ye.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return ye.resolve()}deleteFieldIndex(e,n){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,n){return ye.resolve()}getDocumentsMatchingTarget(e,n){return ye.resolve(null)}getIndexType(e,n){return ye.resolve(0)}getFieldIndexes(e,n){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,n){return ye.resolve(di.min())}getMinOffsetFromCollectionGroup(e,n){return ye.resolve(di.min())}updateCollectionGroup(e,n,r){return ye.resolve()}updateIndexEntries(e,n){return ye.resolve()}}class c4{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),o=this.index[n]||new Cn(Gt.comparator),u=!o.has(r);return this.index[n]=o.add(r),u}has(e){const n=e.lastSegment(),r=e.popLast(),o=this.index[n];return o&&o.has(r)}getEntries(e){return(this.index[e]||new Cn(Gt.comparator)).toArray()}}const Lw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},XN=41943040;class ds{static withCacheSize(e){return new ds(e,ds.DEFAULT_COLLECTION_PERCENTILE,ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}ds.DEFAULT_COLLECTION_PERCENTILE=10,ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ds.DEFAULT=new ds(XN,ds.DEFAULT_COLLECTION_PERCENTILE,ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ds.DISABLED=new ds(-1,0,0);class Eo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Eo(0)}static ar(){return new Eo(-1)}}const Uw="LruGarbageCollector",u4=1048576;function Bw([s,e],[n,r]){const o=xt(s,n);return o===0?xt(e,r):o}class d4{constructor(e){this.Pr=e,this.buffer=new Cn(Bw),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Bw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class h4{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ke(Uw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Oo(n)?ke(Uw,"Ignoring IndexedDB error during garbage collection: ",n):await Mo(n)}await this.Ar(3e5)}))}}class f4{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return ye.resolve(af.ce);const r=new d4(n);return this.Vr.forEachTarget(e,(o=>r.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>r.Er(o))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ke("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve(Lw)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ke("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Lw):this.gr(e,n)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,o,u,d,p,g,x;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(ke("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),o=this.params.maximumSequenceNumbersToCollect):o=_,d=Date.now(),this.nthSequenceNumber(e,o)))).next((_=>(r=_,p=Date.now(),this.removeTargets(e,r,n)))).next((_=>(u=_,g=Date.now(),this.removeOrphanedDocuments(e,r)))).next((_=>(x=Date.now(),io()<=gt.DEBUG&&ke("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${o} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${_} documents in `+(x-g)+`ms
Total Duration: ${x-b}ms`),ye.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:u,documentsRemoved:_}))))}}function m4(s,e){return new f4(s,e)}class p4{constructor(){this.changes=new bl((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Yn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ye.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class g4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class x4{constructor(e,n,r,o){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=o}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((o=>(r=o,this.remoteDocumentCache.getEntry(e,n)))).next((o=>(r!==null&&eu(r.mutation,o,Rs.empty(),kt.now()),o)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,bt()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=bt()){const o=tl();return this.populateOverlays(e,o,n).next((()=>this.computeViews(e,n,o,r).next((u=>{let d=$c();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,n){const r=tl();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,bt())))}populateOverlays(e,n,r){const o=[];return r.forEach((u=>{n.has(u)||o.push(u)})),this.documentOverlayCache.getOverlays(e,o).next((u=>{u.forEach(((d,p)=>{n.set(d,p)}))}))}computeViews(e,n,r,o){let u=xr();const d=Zc(),p=(function(){return Zc()})();return n.forEach(((g,x)=>{const b=r.get(x.key);o.has(x.key)&&(b===void 0||b.mutation instanceof Ni)?u=u.insert(x.key,x):b!==void 0?(d.set(x.key,b.mutation.getFieldMask()),eu(b.mutation,x,b.mutation.getFieldMask(),kt.now())):d.set(x.key,Rs.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((x,b)=>d.set(x,b))),n.forEach(((x,b)=>p.set(x,new g4(b,d.get(x)??null)))),p)))}recalculateAndSaveOverlays(e,n){const r=Zc();let o=new en(((d,p)=>d-p)),u=bt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((d=>{for(const p of d)p.keys().forEach((g=>{const x=n.get(g);if(x===null)return;let b=r.get(g)||Rs.empty();b=p.applyToLocalView(x,b),r.set(g,b);const _=(o.get(p.batchId)||bt()).add(g);o=o.insert(p.batchId,_)}))})).next((()=>{const d=[],p=o.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),x=g.key,b=g.value,_=IN();b.forEach((E=>{if(!u.has(E)){const A=LN(n.get(E),r.get(E));A!==null&&_.set(E,A),u=u.add(E)}})),d.push(this.documentOverlayCache.saveOverlays(e,x,_))}return ye.waitFor(d)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,o){return bk(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):TN(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,o):this.getDocumentsMatchingCollectionQuery(e,n,r,o)}getNextDocuments(e,n,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,o).next((u=>{const d=o-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,o-u.size):ye.resolve(tl());let p=lu,g=u;return d.next((x=>ye.forEach(x,((b,_)=>(p<_.largestBatchId&&(p=_.largestBatchId),u.get(b)?ye.resolve():this.remoteDocumentCache.getEntry(e,b).next((E=>{g=g.insert(b,E)}))))).next((()=>this.populateOverlays(e,x,u))).next((()=>this.computeViews(e,g,x,bt()))).next((b=>({batchId:p,changes:kN(b)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Fe(n)).next((r=>{let o=$c();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,o){const u=n.collectionGroup;let d=$c();return this.indexManager.getCollectionParents(e,u).next((p=>ye.forEach(p,(g=>{const x=(function(_,E){return new Eu(E,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(n,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,x,r,o).next((b=>{b.forEach(((_,E)=>{d=d.insert(_,E)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,n,r,o){let u;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,u,o)))).next((d=>{u.forEach(((g,x)=>{const b=x.getKey();d.get(b)===null&&(d=d.insert(b,Yn.newInvalidDocument(b)))}));let p=$c();return d.forEach(((g,x)=>{const b=u.get(g);b!==void 0&&eu(b.mutation,x,Rs.empty(),kt.now()),uf(n,x)&&(p=p.insert(g,x))})),p}))}}class b4{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return ye.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,(function(o){return{id:o.id,version:o.version,createTime:Oa(o.createTime)}})(n)),ye.resolve()}getNamedQuery(e,n){return ye.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,(function(o){return{name:o.name,query:l4(o.bundledQuery),readTime:Oa(o.readTime)}})(n)),ye.resolve()}}class y4{constructor(){this.overlays=new en(Fe.comparator),this.Lr=new Map}getOverlay(e,n){return ye.resolve(this.overlays.get(n))}getOverlays(e,n){const r=tl();return ye.forEach(n,(o=>this.getOverlay(e,o).next((u=>{u!==null&&r.set(o,u)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((o,u)=>{this.bt(e,n,u)})),ye.resolve()}removeOverlaysForBatchId(e,n,r){const o=this.Lr.get(r);return o!==void 0&&(o.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(r)),ye.resolve()}getOverlaysForCollection(e,n,r){const o=tl(),u=n.length+1,d=new Fe(n.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,x=g.getKey();if(!n.isPrefixOf(x.path))break;x.path.length===u&&g.largestBatchId>r&&o.set(g.getKey(),g)}return ye.resolve(o)}getOverlaysForCollectionGroup(e,n,r,o){let u=new en(((x,b)=>x-b));const d=this.overlays.getIterator();for(;d.hasNext();){const x=d.getNext().value;if(x.getKey().getCollectionGroup()===n&&x.largestBatchId>r){let b=u.get(x.largestBatchId);b===null&&(b=tl(),u=u.insert(x.largestBatchId,b)),b.set(x.getKey(),x)}}const p=tl(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((x,b)=>p.set(x,b))),!(p.size()>=o)););return ye.resolve(p)}bt(e,n,r){const o=this.overlays.get(r.key);if(o!==null){const d=this.Lr.get(o.largestBatchId).delete(r.key);this.Lr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(r.key,new Vk(n,r));let u=this.Lr.get(n);u===void 0&&(u=bt(),this.Lr.set(n,u)),this.Lr.set(n,u.add(r.key))}}class v4{constructor(){this.sessionToken=zn.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ye.resolve()}}class b0{constructor(){this.kr=new Cn(In.Kr),this.qr=new Cn(In.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new In(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Wr(new In(e,n))}Qr(e,n){e.forEach((r=>this.removeReference(r,n)))}Gr(e){const n=new Fe(new Gt([])),r=new In(n,e),o=new In(n,e+1),u=[];return this.qr.forEachInRange([r,o],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new Fe(new Gt([])),r=new In(n,e),o=new In(n,e+1);let u=bt();return this.qr.forEachInRange([r,o],(d=>{u=u.add(d.key)})),u}containsKey(e){const n=new In(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class In{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return Fe.comparator(e.key,n.key)||xt(e.Hr,n.Hr)}static Ur(e,n){return xt(e.Hr,n.Hr)||Fe.comparator(e.key,n.key)}}class w4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new Cn(In.Kr)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,o){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new Pk(u,n,r,o);this.mutationQueue.push(d);for(const p of o)this.Jr=this.Jr.add(new In(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return ye.resolve(d)}lookupMutationBatch(e,n){return ye.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,o=this.Xr(r),u=o<0?0:o;return ye.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?o0:this.Yn-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new In(n,0),o=new In(n,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([r,o],(d=>{const p=this.Zr(d.Hr);u.push(p)})),ye.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Cn(xt);return n.forEach((o=>{const u=new In(o,0),d=new In(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{r=r.add(p.Hr)}))})),ye.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,o=r.length+1;let u=r;Fe.isDocumentKey(u)||(u=u.child(""));const d=new In(new Fe(u),0);let p=new Cn(xt);return this.Jr.forEachWhile((g=>{const x=g.key.path;return!!r.isPrefixOf(x)&&(x.length===o&&(p=p.add(g.Hr)),!0)}),d),ye.resolve(this.Yr(p))}Yr(e){const n=[];return e.forEach((r=>{const o=this.Zr(r);o!==null&&n.push(o)})),n}removeMutationBatch(e,n){It(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return ye.forEach(n.mutations,(o=>{const u=new In(o.key,n.batchId);return r=r.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,n){const r=new In(n,0),o=this.Jr.firstAfterOrEqual(r);return ye.resolve(n.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class _4{constructor(e){this.ti=e,this.docs=(function(){return new en(Fe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,o=this.docs.get(r),u=o?o.size:0,d=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ye.resolve(r?r.document.mutableCopy():Yn.newInvalidDocument(n))}getEntries(e,n){let r=xr();return n.forEach((o=>{const u=this.docs.get(o);r=r.insert(o,u?u.document.mutableCopy():Yn.newInvalidDocument(o))})),ye.resolve(r)}getDocumentsMatchingQuery(e,n,r,o){let u=xr();const d=n.path,p=new Fe(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:x,value:{document:b}}=g.getNext();if(!d.isPrefixOf(x.path))break;x.path.length>d.length+1||WR(YR(b),r)<=0||(o.has(b.key)||uf(n,b))&&(u=u.insert(b.key,b.mutableCopy()))}return ye.resolve(u)}getAllFromCollectionGroup(e,n,r,o){Qe(9500)}ni(e,n){return ye.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new N4(this)}getSize(e){return ye.resolve(this.size)}}class N4 extends p4{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,o)=>{o.isValidDocument()?n.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(r)})),ye.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}class E4{constructor(e){this.persistence=e,this.ri=new bl((n=>d0(n)),h0),this.lastRemoteSnapshotVersion=Ze.min(),this.highestTargetId=0,this.ii=0,this.si=new b0,this.targetCount=0,this.oi=Eo._r()}forEachTarget(e,n){return this.ri.forEach(((r,o)=>n(o))),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),ye.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new Eo(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,ye.resolve()}updateTargetData(e,n){return this.lr(n),ye.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,n,r){let o=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=n&&r.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),o++)})),ye.waitFor(u).next((()=>o))}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return ye.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),ye.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const o=this.persistence.referenceDelegate,u=[];return o&&n.forEach((d=>{u.push(o.markPotentiallyOrphaned(e,d))})),ye.waitFor(u)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),ye.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return ye.resolve(r)}containsKey(e,n){return ye.resolve(this.si.containsKey(n))}}class JN{constructor(e,n){this._i={},this.overlays={},this.ai=new af(0),this.ui=!1,this.ui=!0,this.ci=new v4,this.referenceDelegate=e(this),this.li=new E4(this),this.indexManager=new o4,this.remoteDocumentCache=(function(o){return new _4(o)})((r=>this.referenceDelegate.hi(r))),this.serializer=new i4(n),this.Pi=new b4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new y4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new w4(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){ke("MemoryPersistence","Starting transaction:",e);const o=new S4(this.ai.next());return this.referenceDelegate.Ti(),r(o).next((u=>this.referenceDelegate.Ii(o).next((()=>u)))).toPromise().then((u=>(o.raiseOnCommittedEvent(),u)))}Ei(e,n){return ye.or(Object.values(this._i).map((r=>()=>r.containsKey(e,n))))}}class S4 extends QR{constructor(e){super(),this.currentSequenceNumber=e}}class y0{constructor(e){this.persistence=e,this.Ri=new b0,this.Ai=null}static Vi(e){return new y0(e)}get di(){if(this.Ai)return this.Ai;throw Qe(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),ye.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),ye.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),ye.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach((o=>this.di.add(o.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((o=>{o.forEach((u=>this.di.add(u.toString())))})).next((()=>r.removeTargetData(e,n)))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.di,(r=>{const o=Fe.fromPath(r);return this.mi(e,o).next((u=>{u||n.removeEntry(o,Ze.min())}))})).next((()=>(this.Ai=null,n.apply(e))))}updateLimboDocument(e,n){return this.mi(e,n).next((r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())}))}hi(e){return 0}mi(e,n){return ye.or([()=>ye.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class qh{constructor(e,n){this.persistence=e,this.fi=new bl((r=>ZR(r.path)),((r,o)=>r.isEqual(o))),this.garbageCollector=m4(this,n)}static Vi(e,n){return new qh(e,n)}Ti(){}Ii(e){return ye.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((o=>r+o))))}pr(e){let n=0;return this.mr(e,(r=>{n++})).next((()=>n))}mr(e,n){return ye.forEach(this.fi,((r,o)=>this.wr(e,r,o).next((u=>u?ye.resolve():n(o)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const o=this.persistence.getRemoteDocumentCache(),u=o.newChangeBuffer();return o.ni(e,(d=>this.wr(e,d,n).next((p=>{p||(r++,u.removeEntry(d,Ze.min()))})))).next((()=>u.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),ye.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),ye.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),ye.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=xh(e.data.value)),n}wr(e,n,r){return ye.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const o=this.fi.get(n);return ye.resolve(o!==void 0&&o>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class v0{constructor(e,n,r,o){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=o}static Es(e,n){let r=bt(),o=bt();for(const u of n.docChanges)switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:o=o.add(u.doc.key)}return new v0(e,n.fromCache,r,o)}}class j4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class T4{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return eA()?8:XR(Wn())>0?6:4})()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,o){const u={result:null};return this.gs(e,n).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,n,o,r).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new j4;return this.ys(e,n,d).next((p=>{if(u.result=p,this.As)return this.ws(e,n,d,p.size)}))})).next((()=>u.result))}ws(e,n,r,o){return r.documentReadCount<this.Vs?(io()<=gt.DEBUG&&ke("QueryEngine","SDK will not create cache indexes for query:",lo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ye.resolve()):(io()<=gt.DEBUG&&ke("QueryEngine","Query:",lo(n),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.ds*o?(io()<=gt.DEBUG&&ke("QueryEngine","The SDK decides to create cache indexes for query:",lo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ma(n))):ye.resolve())}gs(e,n){if(Aw(n))return ye.resolve(null);let r=Ma(n);return this.indexManager.getIndexType(e,r).next((o=>o===0?null:(n.limit!==null&&o===1&&(n=yg(n,null,"F"),r=Ma(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((u=>{const d=bt(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,r).next((g=>{const x=this.bs(n,p);return this.Ss(n,x,d,g.readTime)?this.gs(e,yg(n,null,"F")):this.Ds(e,x,n,g)}))))})))))}ps(e,n,r,o){return Aw(n)||o.isEqual(Ze.min())?ye.resolve(null):this.fs.getDocuments(e,r).next((u=>{const d=this.bs(n,u);return this.Ss(n,d,r,o)?ye.resolve(null):(io()<=gt.DEBUG&&ke("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),lo(n)),this.Ds(e,d,n,GR(o,lu)).next((p=>p)))}))}bs(e,n){let r=new Cn(CN(e));return n.forEach(((o,u)=>{uf(e,u)&&(r=r.add(u))})),r}Ss(e,n,r,o){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const u=e.limitType==="F"?n.last():n.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(o)>0)}ys(e,n,r){return io()<=gt.DEBUG&&ke("QueryEngine","Using full collection scan to execute query:",lo(n)),this.fs.getDocumentsMatchingQuery(e,n,di.min(),r)}Ds(e,n,r,o){return this.fs.getDocumentsMatchingQuery(e,r,o).next((u=>(n.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const w0="LocalStore",A4=3e8;class C4{constructor(e,n,r,o){this.persistence=e,this.Cs=n,this.serializer=o,this.vs=new en(xt),this.Fs=new bl((u=>d0(u)),h0),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new x4(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.vs)))}}function R4(s,e,n,r){return new C4(s,e,n,r)}async function ZN(s,e){const n=at(s);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let o;return n.mutationQueue.getAllMutationBatches(r).next((u=>(o=u,n.Os(e),n.mutationQueue.getAllMutationBatches(r)))).next((u=>{const d=[],p=[];let g=bt();for(const x of o){d.push(x.batchId);for(const b of x.mutations)g=g.add(b.key)}for(const x of u){p.push(x.batchId);for(const b of x.mutations)g=g.add(b.key)}return n.localDocuments.getDocuments(r,g).next((x=>({Ns:x,removedBatchIds:d,addedBatchIds:p})))}))}))}function k4(s,e){const n=at(s);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const o=e.batch.keys(),u=n.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,x,b){const _=x.batch,E=_.keys();let A=ye.resolve();return E.forEach((F=>{A=A.next((()=>b.getEntry(g,F))).next((L=>{const O=x.docVersions.get(F);It(O!==null,48541),L.version.compareTo(O)<0&&(_.applyToRemoteDocument(L,x),L.isValidDocument()&&(L.setReadTime(x.commitVersion),b.addEntry(L)))}))})),A.next((()=>p.mutationQueue.removeMutationBatch(g,_)))})(n,r,e,u).next((()=>u.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,o,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(p){let g=bt();for(let x=0;x<p.mutationResults.length;++x)p.mutationResults[x].transformResults.length>0&&(g=g.add(p.batch.mutations[x].key));return g})(e)))).next((()=>n.localDocuments.getDocuments(r,o)))}))}function e2(s){const e=at(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.li.getLastRemoteSnapshotVersion(n)))}function I4(s,e){const n=at(s),r=e.snapshotVersion;let o=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=n.xs.newChangeBuffer({trackRemovals:!0});o=n.vs;const p=[];e.targetChanges.forEach(((b,_)=>{const E=o.get(_);if(!E)return;p.push(n.li.removeMatchingKeys(u,b.removedDocuments,_).next((()=>n.li.addMatchingKeys(u,b.addedDocuments,_))));let A=E.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(_)!==null?A=A.withResumeToken(zn.EMPTY_BYTE_STRING,Ze.min()).withLastLimboFreeSnapshotVersion(Ze.min()):b.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(b.resumeToken,r)),o=o.insert(_,A),(function(L,O,U){return L.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=A4?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0})(E,A,b)&&p.push(n.li.updateTargetData(u,A))}));let g=xr(),x=bt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(n.persistence.referenceDelegate.updateLimboDocument(u,b))})),p.push(D4(u,d,e.documentUpdates).next((b=>{g=b.Bs,x=b.Ls}))),!r.isEqual(Ze.min())){const b=n.li.getLastRemoteSnapshotVersion(u).next((_=>n.li.setTargetsMetadata(u,u.currentSequenceNumber,r)));p.push(b)}return ye.waitFor(p).next((()=>d.apply(u))).next((()=>n.localDocuments.getLocalViewOfDocuments(u,g,x))).next((()=>g))})).then((u=>(n.vs=o,u)))}function D4(s,e,n){let r=bt(),o=bt();return n.forEach((u=>r=r.add(u))),e.getEntries(s,r).next((u=>{let d=xr();return n.forEach(((p,g)=>{const x=u.get(p);g.isFoundDocument()!==x.isFoundDocument()&&(o=o.add(p)),g.isNoDocument()&&g.version.isEqual(Ze.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!x.isValidDocument()||g.version.compareTo(x.version)>0||g.version.compareTo(x.version)===0&&x.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):ke(w0,"Ignoring outdated watch update for ",p,". Current version:",x.version," Watch version:",g.version)})),{Bs:d,Ls:o}}))}function M4(s,e){const n=at(s);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=o0),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function O4(s,e){const n=at(s);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let o;return n.li.getTargetData(r,e).next((u=>u?(o=u,ye.resolve(o)):n.li.allocateTargetId(r).next((d=>(o=new si(e,d,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,o).next((()=>o)))))))})).then((r=>{const o=n.vs.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r}))}async function Eg(s,e,n){const r=at(s),o=r.vs.get(e),u=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",u,(d=>r.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!Oo(d))throw d;ke(w0,`Failed to update sequence numbers for target ${e}: ${d}`)}r.vs=r.vs.remove(e),r.Fs.delete(o.target)}function zw(s,e,n){const r=at(s);let o=Ze.min(),u=bt();return r.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,x,b){const _=at(g),E=_.Fs.get(b);return E!==void 0?ye.resolve(_.vs.get(E)):_.li.getTargetData(x,b)})(r,d,Ma(e)).next((p=>{if(p)return o=p.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>r.Cs.getDocumentsMatchingQuery(d,e,n?o:Ze.min(),n?u:bt()))).next((p=>(P4(r,vk(e),p),{documents:p,ks:u})))))}function P4(s,e,n){let r=s.Ms.get(e)||Ze.min();n.forEach(((o,u)=>{u.readTime.compareTo(r)>0&&(r=u.readTime)})),s.Ms.set(e,r)}class qw{constructor(){this.activeTargetIds=jk()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class V4{constructor(){this.vo=new qw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new qw,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class L4{Mo(e){}shutdown(){}}const Fw="ConnectivityMonitor";class Hw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ke(Fw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ke(Fw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let sh=null;function Sg(){return sh===null?sh=(function(){return 268435456+Math.round(2147483648*Math.random())})():sh++,"0x"+sh.toString(16)}const Up="RestConnection",U4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class B4{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${o}`,this.$o=this.databaseId.database===Ph?`project_id=${r}`:`project_id=${r}&database_id=${o}`}Wo(e,n,r,o,u){const d=Sg(),p=this.Qo(e,n.toUriEncodedString());ke(Up,`Sending RPC '${e}' ${d}:`,p,r);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,o,u);const{host:x}=new URL(p),b=yi(x);return this.zo(e,p,g,r,b).then((_=>(ke(Up,`Received RPC '${e}' ${d}: `,_),_)),(_=>{throw vo(Up,`RPC '${e}' ${d} failed with error: `,_,"url: ",p,"request:",r),_}))}jo(e,n,r,o,u,d){return this.Wo(e,n,r,o,u)}Go(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Do})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((o,u)=>e[u]=o)),r&&r.headers.forEach(((o,u)=>e[u]=o))}Qo(e,n){const r=U4[e];let o=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class z4{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const $n="WebChannelConnection",Vc=(s,e,n)=>{s.listen(e,(r=>{try{n(r)}catch(o){setTimeout((()=>{throw o}),0)}}))};class xo extends B4{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!xo.c_){const e=rN();Vc(e,aN.STAT_EVENT,(n=>{n.stat===hg.PROXY?ke($n,"STAT_EVENT: detected buffering proxy"):n.stat===hg.NOPROXY&&ke($n,"STAT_EVENT: detected no buffering proxy")})),xo.c_=!0}}zo(e,n,r,o,u){const d=Sg();return new Promise(((p,g)=>{const x=new nN;x.setWithCredentials(!0),x.listenOnce(sN.COMPLETE,(()=>{try{switch(x.getLastErrorCode()){case gh.NO_ERROR:const _=x.getResponseJson();ke($n,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(_)),p(_);break;case gh.TIMEOUT:ke($n,`RPC '${e}' ${d} timed out`),g(new Ce(ge.DEADLINE_EXCEEDED,"Request time out"));break;case gh.HTTP_ERROR:const E=x.getStatus();if(ke($n,`RPC '${e}' ${d} failed with status:`,E,"response text:",x.getResponseText()),E>0){let A=x.getResponseJson();Array.isArray(A)&&(A=A[0]);const F=A?.error;if(F&&F.status&&F.message){const L=(function(U){const G=U.toLowerCase().replace(/_/g,"-");return Object.values(ge).indexOf(G)>=0?G:ge.UNKNOWN})(F.status);g(new Ce(L,F.message))}else g(new Ce(ge.UNKNOWN,"Server responded with status "+x.getStatus()))}else g(new Ce(ge.UNAVAILABLE,"Connection failed."));break;default:Qe(9055,{l_:e,streamId:d,h_:x.getLastErrorCode(),P_:x.getLastError()})}}finally{ke($n,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(o);ke($n,`RPC '${e}' ${d} sending request:`,o),x.send(n,"POST",b,r,15)}))}T_(e,n,r){const o=Sg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,n,r),p.encodeInitMessageHeaders=!0;const x=u.join("");ke($n,`Creating RPC '${e}' stream ${o}: ${x}`,p);const b=d.createWebChannel(x,p);this.I_(b);let _=!1,E=!1;const A=new z4({Ho:F=>{E?ke($n,`Not sending because RPC '${e}' stream ${o} is closed:`,F):(_||(ke($n,`Opening RPC '${e}' stream ${o} transport.`),b.open(),_=!0),ke($n,`RPC '${e}' stream ${o} sending:`,F),b.send(F))},Jo:()=>b.close()});return Vc(b,Hc.EventType.OPEN,(()=>{E||(ke($n,`RPC '${e}' stream ${o} transport opened.`),A.i_())})),Vc(b,Hc.EventType.CLOSE,(()=>{E||(E=!0,ke($n,`RPC '${e}' stream ${o} transport closed`),A.o_(),this.E_(b))})),Vc(b,Hc.EventType.ERROR,(F=>{E||(E=!0,vo($n,`RPC '${e}' stream ${o} transport errored. Name:`,F.name,"Message:",F.message),A.o_(new Ce(ge.UNAVAILABLE,"The operation could not be completed")))})),Vc(b,Hc.EventType.MESSAGE,(F=>{if(!E){const L=F.data[0];It(!!L,16349);const O=L,U=O?.error||O[0]?.error;if(U){ke($n,`RPC '${e}' stream ${o} received error:`,U);const G=U.status;let K=(function(oe){const j=En[oe];if(j!==void 0)return BN(j)})(G),fe=U.message;K===void 0&&(K=ge.INTERNAL,fe="Unknown error status: "+G+" with message "+U.message),E=!0,A.o_(new Ce(K,fe)),b.close()}else ke($n,`RPC '${e}' stream ${o} received:`,L),A.__(L)}})),xo.u_(),setTimeout((()=>{A.s_()}),0),A}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((n=>n===e))}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return iN()}}function q4(s){return new xo(s)}function Bp(){return typeof document<"u"?document:null}function mf(s){return new Gk(s,!0)}xo.c_=!1;class t2{constructor(e,n,r=1e3,o=1.5,u=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=o,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),o=Math.max(0,n-r);o>0&&ke("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const $w="PersistentStream";class n2{constructor(e,n,r,o,u,d,p,g){this.Ci=e,this.b_=r,this.S_=o,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new t2(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===ge.RESOURCE_EXHAUSTED?(gr(n.toString()),gr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,o])=>{this.D_===n&&this.G_(r,o)}),(r=>{e((()=>{const o=new Ce(ge.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(o)}))}))}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{r((()=>this.z_(o)))})),this.stream.onMessage((o=>{r((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ke($w,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget((()=>this.D_===e?n():(ke($w,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class F4 extends n2{constructor(e,n,r,o,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,o,d),this.serializer=u}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=Kk(this.serializer,e),r=(function(u){if(!("targetChange"in u))return Ze.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?Ze.min():d.readTime?Oa(d.readTime):Ze.min()})(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=Ng(this.serializer),n.addTarget=(function(u,d){let p;const g=d.target;if(p=xg(g)?{documents:Jk(u,g)}:{query:Zk(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=FN(u,d.resumeToken);const x=vg(u,d.expectedCount);x!==null&&(p.expectedCount=x)}else if(d.snapshotVersion.compareTo(Ze.min())>0){p.readTime=zh(u,d.snapshotVersion.toTimestamp());const x=vg(u,d.expectedCount);x!==null&&(p.expectedCount=x)}return p})(this.serializer,e);const r=t4(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=Ng(this.serializer),n.removeTarget=e,this.K_(n)}}class H4 extends n2{constructor(e,n,r,o,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,o,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return It(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,It(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){It(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=Xk(e.writeResults,e.commitTime),r=Oa(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Ng(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>Qk(this.serializer,r)))};this.K_(n)}}class $4{}class G4 extends $4{constructor(e,n,r,o){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ce(ge.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,wg(n,r),o,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ce(ge.UNKNOWN,u.toString())}))}jo(e,n,r,o,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,wg(n,r),o,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Ce(ge.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function Y4(s,e,n,r){return new G4(s,e,n,r)}class W4{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(gr(n),this.aa=!1):ke("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const ul="RemoteStore";class K4{constructor(e,n,r,o,u){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{r.enqueueAndForget((async()=>{yl(this)&&(ke(ul,"Restarting streams for network reachability change."),await(async function(g){const x=at(g);x.Ea.add(4),await Tu(x),x.Va.set("Unknown"),x.Ea.delete(4),await pf(x)})(this))}))})),this.Va=new W4(r,o)}}async function pf(s){if(yl(s))for(const e of s.Ra)await e(!0)}async function Tu(s){for(const e of s.Ra)await e(!1)}function s2(s,e){const n=at(s);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),S0(n)?E0(n):Po(n).O_()&&N0(n,e))}function _0(s,e){const n=at(s),r=Po(n);n.Ia.delete(e),r.O_()&&a2(n,e),n.Ia.size===0&&(r.O_()?r.L_():yl(n)&&n.Va.set("Unknown"))}function N0(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ze.min())>0){const n=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Po(s).Z_(e)}function a2(s,e){s.da.$e(e),Po(s).X_(e)}function E0(s){s.da=new qk({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Po(s).start(),s.Va.ua()}function S0(s){return yl(s)&&!Po(s).x_()&&s.Ia.size>0}function yl(s){return at(s).Ea.size===0}function r2(s){s.da=void 0}async function Q4(s){s.Va.set("Online")}async function X4(s){s.Ia.forEach(((e,n)=>{N0(s,e)}))}async function J4(s,e){r2(s),S0(s)?(s.Va.ha(e),E0(s)):s.Va.set("Unknown")}async function Z4(s,e,n){if(s.Va.set("Online"),e instanceof qN&&e.state===2&&e.cause)try{await(async function(o,u){const d=u.cause;for(const p of u.targetIds)o.Ia.has(p)&&(await o.remoteSyncer.rejectListen(p,d),o.Ia.delete(p),o.da.removeTarget(p))})(s,e)}catch(r){ke(ul,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Fh(s,r)}else if(e instanceof vh?s.da.Xe(e):e instanceof zN?s.da.st(e):s.da.tt(e),!n.isEqual(Ze.min()))try{const r=await e2(s.localStore);n.compareTo(r)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,x)=>{if(g.resumeToken.approximateByteSize()>0){const b=u.Ia.get(x);b&&u.Ia.set(x,b.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,x)=>{const b=u.Ia.get(g);if(!b)return;u.Ia.set(g,b.withResumeToken(zn.EMPTY_BYTE_STRING,b.snapshotVersion)),a2(u,g);const _=new si(b.target,g,x,b.sequenceNumber);N0(u,_)})),u.remoteSyncer.applyRemoteEvent(p)})(s,n)}catch(r){ke(ul,"Failed to raise snapshot:",r),await Fh(s,r)}}async function Fh(s,e,n){if(!Oo(e))throw e;s.Ea.add(1),await Tu(s),s.Va.set("Offline"),n||(n=()=>e2(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{ke(ul,"Retrying IndexedDB access"),await n(),s.Ea.delete(1),await pf(s)}))}function i2(s,e){return e().catch((n=>Fh(s,n,e)))}async function gf(s){const e=at(s),n=pi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:o0;for(;eI(e);)try{const o=await M4(e.localStore,r);if(o===null){e.Ta.length===0&&n.L_();break}r=o.batchId,tI(e,o)}catch(o){await Fh(e,o)}l2(e)&&o2(e)}function eI(s){return yl(s)&&s.Ta.length<10}function tI(s,e){s.Ta.push(e);const n=pi(s);n.O_()&&n.Y_&&n.ea(e.mutations)}function l2(s){return yl(s)&&!pi(s).x_()&&s.Ta.length>0}function o2(s){pi(s).start()}async function nI(s){pi(s).ra()}async function sI(s){const e=pi(s);for(const n of s.Ta)e.ea(n.mutations)}async function aI(s,e,n){const r=s.Ta.shift(),o=p0.from(r,e,n);await i2(s,(()=>s.remoteSyncer.applySuccessfulWrite(o))),await gf(s)}async function rI(s,e){e&&pi(s).Y_&&await(async function(r,o){if((function(d){return Uk(d)&&d!==ge.ABORTED})(o.code)){const u=r.Ta.shift();pi(r).B_(),await i2(r,(()=>r.remoteSyncer.rejectFailedWrite(u.batchId,o))),await gf(r)}})(s,e),l2(s)&&o2(s)}async function Gw(s,e){const n=at(s);n.asyncQueue.verifyOperationInProgress(),ke(ul,"RemoteStore received new credentials");const r=yl(n);n.Ea.add(3),await Tu(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await pf(n)}async function iI(s,e){const n=at(s);e?(n.Ea.delete(2),await pf(n)):e||(n.Ea.add(2),await Tu(n),n.Va.set("Unknown"))}function Po(s){return s.ma||(s.ma=(function(n,r,o){const u=at(n);return u.sa(),new F4(r,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(s.datastore,s.asyncQueue,{Zo:Q4.bind(null,s),Yo:X4.bind(null,s),t_:J4.bind(null,s),J_:Z4.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),S0(s)?E0(s):s.Va.set("Unknown")):(await s.ma.stop(),r2(s))}))),s.ma}function pi(s){return s.fa||(s.fa=(function(n,r,o){const u=at(n);return u.sa(),new H4(r,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:nI.bind(null,s),t_:rI.bind(null,s),ta:sI.bind(null,s),na:aI.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await gf(s)):(await s.fa.stop(),s.Ta.length>0&&(ke(ul,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class j0{constructor(e,n,r,o,u){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=o,this.removalCallback=u,this.deferred=new hr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,o,u){const d=Date.now()+r,p=new j0(e,n,d,o,u);return p.start(r),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function T0(s,e){if(gr("AsyncQueue",`${e}: ${s}`),Oo(s))return new Ce(ge.UNAVAILABLE,`${e}: ${s}`);throw s}class bo{static emptySet(e){return new bo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Fe.comparator(n.key,r.key):(n,r)=>Fe.comparator(n.key,r.key),this.keyedMap=$c(),this.sortedSet=new en(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof bo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const o=n.getNext().key,u=r.getNext().key;if(!o.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new bo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class Yw{constructor(){this.ga=new en(Fe.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Qe(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class So{constructor(e,n,r,o,u,d,p,g,x){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=x}static fromInitialDocuments(e,n,r,o,u){const d=[];return n.forEach((p=>{d.push({type:0,doc:p})})),new So(e,n,bo.emptySet(n),d,r,o,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let o=0;o<n.length;o++)if(n[o].type!==r[o].type||!n[o].doc.isEqual(r[o].doc))return!1;return!0}}class lI{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class oI{constructor(){this.queries=Ww(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const o=at(n),u=o.queries;o.queries=Ww(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(r)}))})(this,new Ce(ge.ABORTED,"Firestore shutting down"))}}function Ww(){return new bl((s=>AN(s)),cf)}async function A0(s,e){const n=at(s);let r=3;const o=e.query;let u=n.queries.get(o);u?!u.Sa()&&e.Da()&&(r=2):(u=new lI,r=e.Da()?0:1);try{switch(r){case 0:u.wa=await n.onListen(o,!0);break;case 1:u.wa=await n.onListen(o,!1);break;case 2:await n.onFirstRemoteStoreListen(o)}}catch(d){const p=T0(d,`Initialization of query '${lo(e.query)}' failed`);return void e.onError(p)}n.queries.set(o,u),u.ba.push(e),e.va(n.onlineState),u.wa&&e.Fa(u.wa)&&R0(n)}async function C0(s,e){const n=at(s),r=e.query;let o=3;const u=n.queries.get(r);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?o=e.Da()?0:1:!u.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function cI(s,e){const n=at(s);let r=!1;for(const o of e){const u=o.query,d=n.queries.get(u);if(d){for(const p of d.ba)p.Fa(o)&&(r=!0);d.wa=o}}r&&R0(n)}function uI(s,e,n){const r=at(s),o=r.queries.get(e);if(o)for(const u of o.ba)u.onError(n);r.queries.delete(e)}function R0(s){s.Ca.forEach((e=>{e.next()}))}var jg,Kw;(Kw=jg||(jg={})).Ma="default",Kw.Cache="cache";class k0{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const o of e.docChanges)o.type!==3&&r.push(o);e=new So(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=So.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==jg.Cache}}class c2{constructor(e){this.key=e}}class u2{constructor(e){this.key=e}}class dI{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=bt(),this.mutatedKeys=bt(),this.eu=CN(e),this.tu=new bo(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new Yw,o=n?n.tu:this.tu;let u=n?n.mutatedKeys:this.mutatedKeys,d=o,p=!1;const g=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,x=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,_)=>{const E=o.get(b),A=uf(this.query,_)?_:null,F=!!E&&this.mutatedKeys.has(E.key),L=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let O=!1;E&&A?E.data.isEqual(A.data)?F!==L&&(r.track({type:3,doc:A}),O=!0):this.su(E,A)||(r.track({type:2,doc:A}),O=!0,(g&&this.eu(A,g)>0||x&&this.eu(A,x)<0)&&(p=!0)):!E&&A?(r.track({type:0,doc:A}),O=!0):E&&!A&&(r.track({type:1,doc:E}),O=!0,(g||x)&&(p=!0)),O&&(A?(d=d.add(A),u=L?u.add(b):u.delete(b)):(d=d.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),u=u.delete(b.key),r.track({type:1,doc:b})}return{tu:d,iu:r,Ss:p,mutatedKeys:u}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,o){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,_)=>(function(A,F){const L=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qe(20277,{Vt:O})}};return L(A)-L(F)})(b.type,_.type)||this.eu(b.doc,_.doc))),this.ou(r),o=o??!1;const p=n&&!o?this._u():[],g=this.Ya.size===0&&this.current&&!o?1:0,x=g!==this.Xa;return this.Xa=g,d.length!==0||x?{snapshot:new So(this.query,e.tu,u,d,e.mutatedKeys,g===0,x,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Yw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Za=this.Za.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Za=this.Za.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=bt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const n=[];return e.forEach((r=>{this.Ya.has(r)||n.push(new u2(r))})),this.Ya.forEach((r=>{e.has(r)||n.push(new c2(r))})),n}cu(e){this.Za=e.ks,this.Ya=bt();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return So.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const I0="SyncEngine";class hI{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class fI{constructor(e){this.key=e,this.hu=!1}}class mI{constructor(e,n,r,o,u,d){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=o,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new bl((p=>AN(p)),cf),this.Iu=new Map,this.Eu=new Set,this.Ru=new en(Fe.comparator),this.Au=new Map,this.Vu=new b0,this.du={},this.mu=new Map,this.fu=Eo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function pI(s,e,n=!0){const r=g2(s);let o;const u=r.Tu.get(e);return u?(r.sharedClientState.addLocalQueryTarget(u.targetId),o=u.view.lu()):o=await d2(r,e,n,!0),o}async function gI(s,e){const n=g2(s);await d2(n,e,!0,!1)}async function d2(s,e,n,r){const o=await O4(s.localStore,Ma(e)),u=o.targetId,d=s.sharedClientState.addLocalQueryTarget(u,n);let p;return r&&(p=await xI(s,e,u,d==="current",o.resumeToken)),s.isPrimaryClient&&n&&s2(s.remoteStore,o),p}async function xI(s,e,n,r,o){s.pu=(_,E,A)=>(async function(L,O,U,G){let K=O.view.ru(U);K.Ss&&(K=await zw(L.localStore,O.query,!1).then((({documents:j})=>O.view.ru(j,K))));const fe=G&&G.targetChanges.get(O.targetId),he=G&&G.targetMismatches.get(O.targetId)!=null,oe=O.view.applyChanges(K,L.isPrimaryClient,fe,he);return Xw(L,O.targetId,oe.au),oe.snapshot})(s,_,E,A);const u=await zw(s.localStore,e,!0),d=new dI(e,u.ks),p=d.ru(u.documents),g=ju.createSynthesizedTargetChangeForCurrentChange(n,r&&s.onlineState!=="Offline",o),x=d.applyChanges(p,s.isPrimaryClient,g);Xw(s,n,x.au);const b=new hI(e,n,d);return s.Tu.set(e,b),s.Iu.has(n)?s.Iu.get(n).push(e):s.Iu.set(n,[e]),x.snapshot}async function bI(s,e,n){const r=at(s),o=r.Tu.get(e),u=r.Iu.get(o.targetId);if(u.length>1)return r.Iu.set(o.targetId,u.filter((d=>!cf(d,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||await Eg(r.localStore,o.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(o.targetId),n&&_0(r.remoteStore,o.targetId),Tg(r,o.targetId)})).catch(Mo)):(Tg(r,o.targetId),await Eg(r.localStore,o.targetId,!0))}async function yI(s,e){const n=at(s),r=n.Tu.get(e),o=n.Iu.get(r.targetId);n.isPrimaryClient&&o.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),_0(n.remoteStore,r.targetId))}async function vI(s,e,n){const r=TI(s);try{const o=await(function(d,p){const g=at(d),x=kt.now(),b=p.reduce(((A,F)=>A.add(F.key)),bt());let _,E;return g.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let F=xr(),L=bt();return g.xs.getEntries(A,b).next((O=>{F=O,F.forEach(((U,G)=>{G.isValidDocument()||(L=L.add(U))}))})).next((()=>g.localDocuments.getOverlayedDocuments(A,F))).next((O=>{_=O;const U=[];for(const G of p){const K=Mk(G,_.get(G.key).overlayedDocument);K!=null&&U.push(new Ni(G.key,K,vN(K.value.mapValue),Ks.exists(!0)))}return g.mutationQueue.addMutationBatch(A,x,U,p)})).next((O=>{E=O;const U=O.applyToLocalDocumentSet(_,L);return g.documentOverlayCache.saveOverlays(A,O.batchId,U)}))})).then((()=>({batchId:E.batchId,changes:kN(_)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(o.batchId),(function(d,p,g){let x=d.du[d.currentUser.toKey()];x||(x=new en(xt)),x=x.insert(p,g),d.du[d.currentUser.toKey()]=x})(r,o.batchId,n),await Au(r,o.changes),await gf(r.remoteStore)}catch(o){const u=T0(o,"Failed to persist write");n.reject(u)}}async function h2(s,e){const n=at(s);try{const r=await I4(n.localStore,e);e.targetChanges.forEach(((o,u)=>{const d=n.Au.get(u);d&&(It(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?It(d.hu,14607):o.removedDocuments.size>0&&(It(d.hu,42227),d.hu=!1))})),await Au(n,r,e)}catch(r){await Mo(r)}}function Qw(s,e,n){const r=at(s);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const o=[];r.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&o.push(p.snapshot)})),(function(d,p){const g=at(d);g.onlineState=p;let x=!1;g.queries.forEach(((b,_)=>{for(const E of _.ba)E.va(p)&&(x=!0)})),x&&R0(g)})(r.eventManager,e),o.length&&r.Pu.J_(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function wI(s,e,n){const r=at(s);r.sharedClientState.updateQueryState(e,"rejected",n);const o=r.Au.get(e),u=o&&o.key;if(u){let d=new en(Fe.comparator);d=d.insert(u,Yn.newNoDocument(u,Ze.min()));const p=bt().add(u),g=new ff(Ze.min(),new Map,new en(xt),d,p);await h2(r,g),r.Ru=r.Ru.remove(u),r.Au.delete(e),D0(r)}else await Eg(r.localStore,e,!1).then((()=>Tg(r,e,n))).catch(Mo)}async function _I(s,e){const n=at(s),r=e.batch.batchId;try{const o=await k4(n.localStore,e);m2(n,r,null),f2(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Au(n,o)}catch(o){await Mo(o)}}async function NI(s,e,n){const r=at(s);try{const o=await(function(d,p){const g=at(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(x=>{let b;return g.mutationQueue.lookupMutationBatch(x,p).next((_=>(It(_!==null,37113),b=_.keys(),g.mutationQueue.removeMutationBatch(x,_)))).next((()=>g.mutationQueue.performConsistencyCheck(x))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(x,b,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(x,b))).next((()=>g.localDocuments.getDocuments(x,b)))}))})(r.localStore,e);m2(r,e,n),f2(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Au(r,o)}catch(o){await Mo(o)}}function f2(s,e){(s.mu.get(e)||[]).forEach((n=>{n.resolve()})),s.mu.delete(e)}function m2(s,e,n){const r=at(s);let o=r.du[r.currentUser.toKey()];if(o){const u=o.get(e);u&&(n?u.reject(n):u.resolve(),o=o.remove(e)),r.du[r.currentUser.toKey()]=o}}function Tg(s,e,n=null){s.sharedClientState.removeLocalQueryTarget(e);for(const r of s.Iu.get(e))s.Tu.delete(r),n&&s.Pu.yu(r,n);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((r=>{s.Vu.containsKey(r)||p2(s,r)}))}function p2(s,e){s.Eu.delete(e.path.canonicalString());const n=s.Ru.get(e);n!==null&&(_0(s.remoteStore,n),s.Ru=s.Ru.remove(e),s.Au.delete(n),D0(s))}function Xw(s,e,n){for(const r of n)r instanceof c2?(s.Vu.addReference(r.key,e),EI(s,r)):r instanceof u2?(ke(I0,"Document no longer in limbo: "+r.key),s.Vu.removeReference(r.key,e),s.Vu.containsKey(r.key)||p2(s,r.key)):Qe(19791,{wu:r})}function EI(s,e){const n=e.key,r=n.path.canonicalString();s.Ru.get(n)||s.Eu.has(r)||(ke(I0,"New document in limbo: "+n),s.Eu.add(r),D0(s))}function D0(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const n=new Fe(Gt.fromString(e)),r=s.fu.next();s.Au.set(r,new fI(n)),s.Ru=s.Ru.insert(n,r),s2(s.remoteStore,new si(Ma(of(n.path)),r,"TargetPurposeLimboResolution",af.ce))}}async function Au(s,e,n){const r=at(s),o=[],u=[],d=[];r.Tu.isEmpty()||(r.Tu.forEach(((p,g)=>{d.push(r.pu(g,e,n).then((x=>{if((x||n)&&r.isPrimaryClient){const b=x?!x.fromCache:n?.targetChanges.get(g.targetId)?.current;r.sharedClientState.updateQueryState(g.targetId,b?"current":"not-current")}if(x){o.push(x);const b=v0.Es(g.targetId,x);u.push(b)}})))})),await Promise.all(d),r.Pu.J_(o),await(async function(g,x){const b=at(g);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>ye.forEach(x,(E=>ye.forEach(E.Ts,(A=>b.persistence.referenceDelegate.addReference(_,E.targetId,A))).next((()=>ye.forEach(E.Is,(A=>b.persistence.referenceDelegate.removeReference(_,E.targetId,A)))))))))}catch(_){if(!Oo(_))throw _;ke(w0,"Failed to update sequence numbers: "+_)}for(const _ of x){const E=_.targetId;if(!_.fromCache){const A=b.vs.get(E),F=A.snapshotVersion,L=A.withLastLimboFreeSnapshotVersion(F);b.vs=b.vs.insert(E,L)}}})(r.localStore,u))}async function SI(s,e){const n=at(s);if(!n.currentUser.isEqual(e)){ke(I0,"User change. New user:",e.toKey());const r=await ZN(n.localStore,e);n.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new Ce(ge.CANCELLED,d))}))})),u.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Au(n,r.Ns)}}function jI(s,e){const n=at(s),r=n.Au.get(e);if(r&&r.hu)return bt().add(r.key);{let o=bt();const u=n.Iu.get(e);if(!u)return o;for(const d of u){const p=n.Tu.get(d);o=o.unionWith(p.view.nu)}return o}}function g2(s){const e=at(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=h2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=jI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wI.bind(null,e),e.Pu.J_=cI.bind(null,e.eventManager),e.Pu.yu=uI.bind(null,e.eventManager),e}function TI(s){const e=at(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_I.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NI.bind(null,e),e}class Hh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return R4(this.persistence,new T4,e.initialUser,this.serializer)}Cu(e){return new JN(y0.Vi,this.serializer)}Du(e){return new V4}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hh.provider={build:()=>new Hh};class AI extends Hh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){It(this.persistence.referenceDelegate instanceof qh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new h4(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?ds.withCacheSize(this.cacheSizeBytes):ds.DEFAULT;return new JN((r=>qh.Vi(r,n)),this.serializer)}}class Ag{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Qw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=SI.bind(null,this.syncEngine),await iI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new oI})()}createDatastore(e){const n=mf(e.databaseInfo.databaseId),r=q4(e.databaseInfo);return Y4(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,o,u,d,p){return new K4(r,o,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(n=>Qw(this.syncEngine,n,0)),(function(){return Hw.v()?new Hw:new L4})())}createSyncEngine(e,n){return(function(o,u,d,p,g,x,b){const _=new mI(o,u,d,p,g,x);return b&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=at(n);ke(ul,"RemoteStore shutting down."),r.Ea.add(5),await Tu(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ag.provider={build:()=>new Ag};class M0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):gr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const gi="FirestoreClient";class CI{constructor(e,n,r,o,u){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=o,this.user=Gn.UNAUTHENTICATED,this.clientId=l0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(r,(async d=>{ke(gi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(r,(d=>(ke(gi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new hr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=T0(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function zp(s,e){s.asyncQueue.verifyOperationInProgress(),ke(gi,"Initializing OfflineComponentProvider");const n=s.configuration;await e.initialize(n);let r=n.initialUser;s.setCredentialChangeListener((async o=>{r.isEqual(o)||(await ZN(e.localStore,o),r=o)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Jw(s,e){s.asyncQueue.verifyOperationInProgress();const n=await RI(s);ke(gi,"Initializing OnlineComponentProvider"),await e.initialize(n,s.configuration),s.setCredentialChangeListener((r=>Gw(e.remoteStore,r))),s.setAppCheckTokenChangeListener(((r,o)=>Gw(e.remoteStore,o))),s._onlineComponents=e}async function RI(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){ke(gi,"Using user provided OfflineComponentProvider");try{await zp(s,s._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ge.FAILED_PRECONDITION||o.code===ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(n))throw n;vo("Error using user provided cache. Falling back to memory cache: "+n),await zp(s,new Hh)}}else ke(gi,"Using default OfflineComponentProvider"),await zp(s,new AI(void 0));return s._offlineComponents}async function x2(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(ke(gi,"Using user provided OnlineComponentProvider"),await Jw(s,s._uninitializedComponentsProvider._online)):(ke(gi,"Using default OnlineComponentProvider"),await Jw(s,new Ag))),s._onlineComponents}function kI(s){return x2(s).then((e=>e.syncEngine))}async function $h(s){const e=await x2(s),n=e.eventManager;return n.onListen=pI.bind(null,e.syncEngine),n.onUnlisten=bI.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=gI.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=yI.bind(null,e.syncEngine),n}function II(s,e,n,r){const o=new M0(r),u=new k0(e,o,n);return s.asyncQueue.enqueueAndForget((async()=>A0(await $h(s),u))),()=>{o.Nu(),s.asyncQueue.enqueueAndForget((async()=>C0(await $h(s),u)))}}function DI(s,e,n={}){const r=new hr;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,x){const b=new M0({next:E=>{b.Nu(),d.enqueueAndForget((()=>C0(u,_)));const A=E.docs.has(p);!A&&E.fromCache?x.reject(new Ce(ge.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&E.fromCache&&g&&g.source==="server"?x.reject(new Ce(ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):x.resolve(E)},error:E=>x.reject(E)}),_=new k0(of(p.path),b,{includeMetadataChanges:!0,Ka:!0});return A0(u,_)})(await $h(s),s.asyncQueue,e,n,r))),r.promise}function MI(s,e,n={}){const r=new hr;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,x){const b=new M0({next:E=>{b.Nu(),d.enqueueAndForget((()=>C0(u,_))),E.fromCache&&g.source==="server"?x.reject(new Ce(ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):x.resolve(E)},error:E=>x.reject(E)}),_=new k0(p,b,{includeMetadataChanges:!0,Ka:!0});return A0(u,_)})(await $h(s),s.asyncQueue,e,n,r))),r.promise}function OI(s,e){const n=new hr;return s.asyncQueue.enqueueAndForget((async()=>vI(await kI(s),e,n))),n.promise}function b2(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const PI="ComponentProvider",Zw=new Map;function VI(s,e,n,r,o){return new nk(s,e,n,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,b2(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,r)}const y2="firestore.googleapis.com",e_=!0;class t_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=y2,this.ssl=e_}else this.host=e.host,this.ssl=e.ssl??e_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=XN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<u4)throw new Ce(ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$R("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=b2(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ce(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ce(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ce(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,o){return r.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xf{constructor(e,n,r,o){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new t_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new t_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new OR;switch(r.type){case"firstParty":return new UR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ce(ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=Zw.get(n);r&&(ke(PI,"Removing Datastore"),Zw.delete(n),r.terminate())})(this),Promise.resolve()}}function LI(s,e,n,r={}){s=ms(s,xf);const o=yi(e),u=s._getSettings(),d={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${n}`;o&&(Yg(`https://${p}`),Wg("Firestore",!0)),u.host!==y2&&u.host!==p&&vo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:o,emulatorOptions:r};if(!rl(g,d)&&(s._setSettings(g),r.mockUserToken)){let x,b;if(typeof r.mockUserToken=="string")x=r.mockUserToken,b=Gn.MOCK_USER;else{x=m1(r.mockUserToken,s._app?.options.projectId);const _=r.mockUserToken.sub||r.mockUserToken.user_id;if(!_)throw new Ce(ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Gn(_)}s._authCredentials=new PR(new oN(x,b))}}class vl{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new vl(this.firestore,e,this._query)}}class on{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new li(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new on(this.firestore,e,this._key)}toJSON(){return{type:on._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Nu(n,on._jsonSchema))return new on(e,r||null,new Fe(Gt.fromString(n.referencePath)))}}on._jsonSchemaVersion="firestore/documentReference/1.0",on._jsonSchema={type:jn("string",on._jsonSchemaVersion),referencePath:jn("string")};class li extends vl{constructor(e,n,r){super(e,n,of(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new on(this.firestore,null,new Fe(e))}withConverter(e){return new li(this.firestore,e,this._path)}}function st(s,e,...n){if(s=Zt(s),cN("collection","path",e),s instanceof xf){const r=Gt.fromString(e,...n);return mw(r),new li(s,null,r)}{if(!(s instanceof on||s instanceof li))throw new Ce(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child(Gt.fromString(e,...n));return mw(r),new li(s.firestore,null,r)}}function Je(s,e,...n){if(s=Zt(s),arguments.length===1&&(e=l0.newId()),cN("doc","path",e),s instanceof xf){const r=Gt.fromString(e,...n);return fw(r),new on(s,null,new Fe(r))}{if(!(s instanceof on||s instanceof li))throw new Ce(ge.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child(Gt.fromString(e,...n));return fw(r),new on(s.firestore,s instanceof li?s.converter:null,new Fe(r))}}const n_="AsyncQueue";class s_{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new t2(this,"async_queue_retry"),this._c=()=>{const r=Bp();r&&ke(n_,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Bp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Bp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new hr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Oo(e))throw e;ke(n_,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,gr("INTERNAL UNHANDLED ERROR: ",a_(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const o=j0.createAndSchedule(this,e,n,r,(u=>this.hc(u)));return this.tc.push(o),o}uc(){this.nc&&Qe(47125,{Pc:a_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function a_(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class br extends xf{constructor(e,n,r,o){super(e,n,r,o),this.type="firestore",this._queue=new s_,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new s_(e),this._firestoreClient=void 0,await e}}}function UI(s,e){const n=typeof s=="object"?s:Xg(),r=typeof s=="string"?s:Ph,o=Zh(n,"firestore").getImmediate({identifier:r});if(!o._initialized){const u=d1("firestore");u&&LI(o,...u)}return o}function bf(s){if(s._terminated)throw new Ce(ge.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||BI(s),s._firestoreClient}function BI(s){const e=s._freezeSettings(),n=VI(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new CI(s._authCredentials,s._appCheckCredentials,s._queue,n,s._componentsProvider&&(function(o){const u=o?._online.build();return{_offline:o?._offline.build(u),_online:u}})(s._componentsProvider))}class Ws{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ws(zn.fromBase64String(e))}catch(n){throw new Ce(ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ws(zn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ws._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Nu(e,Ws._jsonSchema))return Ws.fromBase64String(e.bytes)}}Ws._jsonSchemaVersion="firestore/bytes/1.0",Ws._jsonSchema={type:jn("string",Ws._jsonSchemaVersion),bytes:jn("string")};class O0{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Ce(ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class yf{constructor(e){this._methodName=e}}class Pa{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Ce(ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Ce(ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xt(this._lat,e._lat)||xt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pa._jsonSchemaVersion}}static fromJSON(e){if(Nu(e,Pa._jsonSchema))return new Pa(e.latitude,e.longitude)}}Pa._jsonSchemaVersion="firestore/geoPoint/1.0",Pa._jsonSchema={type:jn("string",Pa._jsonSchemaVersion),latitude:jn("number"),longitude:jn("number")};class oa{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,o){if(r.length!==o.length)return!1;for(let u=0;u<r.length;++u)if(r[u]!==o[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:oa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Nu(e,oa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new oa(e.vectorValues);throw new Ce(ge.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}oa._jsonSchemaVersion="firestore/vectorValue/1.0",oa._jsonSchema={type:jn("string",oa._jsonSchemaVersion),vectorValues:jn("object")};const zI=/^__.*__$/;class qI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ni(e,this.data,this.fieldMask,n,this.fieldTransforms):new Su(e,this.data,n,this.fieldTransforms)}}class v2{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ni(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function w2(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Qe(40011,{dataSource:s})}}class P0{constructor(e,n,r,o,u,d){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=o,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new P0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const n=this.path?.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){const n=this.path?.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Gh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(w2(this.dataSource)&&zI.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class FI{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||mf(e)}createContext(e,n,r,o=!1){return new P0({dataSource:e,methodName:n,targetDoc:r,path:Bn.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function vf(s){const e=s._freezeSettings(),n=mf(s._databaseId);return new FI(s._databaseId,!!e.ignoreUndefinedProperties,n)}function _2(s,e,n,r,o,u={}){const d=s.createContext(u.merge||u.mergeFields?2:0,e,n,o);L0("Data must be an object, but it was:",d,r);const p=N2(r,d);let g,x;if(u.merge)g=new Rs(d.fieldMask),x=d.fieldTransforms;else if(u.mergeFields){const b=[];for(const _ of u.mergeFields){const E=jo(e,_,n);if(!d.contains(E))throw new Ce(ge.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);j2(b,E)||b.push(E)}g=new Rs(b),x=d.fieldTransforms.filter((_=>g.covers(_.field)))}else g=null,x=d.fieldTransforms;return new qI(new hs(p),g,x)}class wf extends yf{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wf}}class V0 extends yf{_toFieldTransform(e){return new Rk(e.path,new du)}isEqual(e){return e instanceof V0}}function HI(s,e,n,r){const o=s.createContext(1,e,n);L0("Data must be an object, but it was:",o,r);const u=[],d=hs.empty();_i(r,((g,x)=>{const b=S2(e,g,n);x=Zt(x);const _=o.childContextForFieldPath(b);if(x instanceof wf)u.push(b);else{const E=Cu(x,_);E!=null&&(u.push(b),d.set(b,E))}}));const p=new Rs(u);return new v2(d,p,o.fieldTransforms)}function $I(s,e,n,r,o,u){const d=s.createContext(1,e,n),p=[jo(e,r,n)],g=[o];if(u.length%2!=0)throw new Ce(ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<u.length;E+=2)p.push(jo(e,u[E])),g.push(u[E+1]);const x=[],b=hs.empty();for(let E=p.length-1;E>=0;--E)if(!j2(x,p[E])){const A=p[E];let F=g[E];F=Zt(F);const L=d.childContextForFieldPath(A);if(F instanceof wf)x.push(A);else{const O=Cu(F,L);O!=null&&(x.push(A),b.set(A,O))}}const _=new Rs(x);return new v2(b,_,d.fieldTransforms)}function GI(s,e,n,r=!1){return Cu(n,s.createContext(r?4:3,e))}function Cu(s,e){if(E2(s=Zt(s)))return L0("Unsupported field value:",e,s),N2(s,e);if(s instanceof yf)return(function(r,o){if(!w2(o.dataSource))throw o.createError(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${r._methodName}() is not currently supported inside arrays`);const u=r._toFieldTransform(o);u&&o.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,o){const u=[];let d=0;for(const p of r){let g=Cu(p,o.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(s,e)}return(function(r,o){if((r=Zt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Tk(o.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const u=kt.fromDate(r);return{timestampValue:zh(o.serializer,u)}}if(r instanceof kt){const u=new kt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:zh(o.serializer,u)}}if(r instanceof Pa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ws)return{bytesValue:FN(o.serializer,r._byteString)};if(r instanceof on){const u=o.databaseId,d=r.firestore._databaseId;if(!d.isEqual(u))throw o.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:x0(r.firestore._databaseId||o.databaseId,r._key.path)}}if(r instanceof oa)return(function(d,p){const g=d instanceof oa?d.toArray():d;return{mapValue:{fields:{[bN]:{stringValue:yN},[Vh]:{arrayValue:{values:g.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return f0(p.serializer,b)}))}}}}}})(r,o);if(QN(r))return r._toProto(o.serializer);throw o.createError(`Unsupported field value: ${sf(r)}`)})(s,e)}function N2(s,e){const n={};return hN(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_i(s,((r,o)=>{const u=Cu(o,e.childContextForField(r));u!=null&&(n[r]=u)})),{mapValue:{fields:n}}}function E2(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof kt||s instanceof Pa||s instanceof Ws||s instanceof on||s instanceof yf||s instanceof oa||QN(s))}function L0(s,e,n){if(!E2(n)||!uN(n)){const r=sf(n);throw r==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+r)}}function jo(s,e,n){if((e=Zt(e))instanceof O0)return e._internalPath;if(typeof e=="string")return S2(s,e);throw Gh("Field path arguments must be of type string or ",s,!1,void 0,n)}const YI=new RegExp("[~\\*/\\[\\]]");function S2(s,e,n){if(e.search(YI)>=0)throw Gh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,n);try{return new O0(...e.split("."))._internalPath}catch{throw Gh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,n)}}function Gh(s,e,n,r,o){const u=r&&!r.isEmpty(),d=o!==void 0;let p=`Function ${e}() called with invalid data`;n&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${r}`),d&&(g+=` in document ${o}`),g+=")"),new Ce(ge.INVALID_ARGUMENT,p+s+g)}function j2(s,e){return s.some((n=>n.isEqual(e)))}class WI{convertValue(e,n="none"){switch(mi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(fi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Qe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return _i(e,((o,u)=>{r[o]=this.convertValue(u,n)})),r}convertVectorValue(e){const n=e.fields?.[Vh].arrayValue?.values?.map((r=>pn(r.doubleValue)));return new oa(n)}convertGeoPoint(e){return new Pa(pn(e.latitude),pn(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=lf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ou(e));default:return null}}convertTimestamp(e){const n=hi(e);return new kt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Gt.fromString(e);It(KN(r),9688,{name:e});const o=new cu(r.get(1),r.get(3)),u=new Fe(r.popFirst(5));return o.isEqual(n)||gr(`Document ${u} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),u}}class U0 extends WI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ws(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,n)}}function B0(){return new V0("serverTimestamp")}const r_="@firebase/firestore",i_="4.10.0";function l_(s){return(function(n,r){if(typeof n!="object"||n===null)return!1;const o=n;for(const u of r)if(u in o&&typeof o[u]=="function")return!0;return!1})(s,["next","error","complete"])}class T2{constructor(e,n,r,o,u){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=o,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new KI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const n=this._document.data.field(jo("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class KI extends T2{data(){return super.data()}}function A2(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ce(ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class z0{}class QI extends z0{}function Ds(s,e,...n){let r=[];e instanceof z0&&r.push(e),r=r.concat(n),(function(u){const d=u.filter((g=>g instanceof q0)).length,p=u.filter((g=>g instanceof _f)).length;if(d>1||d>0&&p>0)throw new Ce(ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const o of r)s=o._apply(s);return s}class _f extends QI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new _f(e,n,r)}_apply(e){const n=this._parse(e);return C2(e._query,n),new vl(e.firestore,e.converter,bg(e._query,n))}_parse(e){const n=vf(e.firestore);return(function(u,d,p,g,x,b,_){let E;if(x.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Ce(ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){c_(_,b);const F=[];for(const L of _)F.push(o_(g,u,L));E={arrayValue:{values:F}}}else E=o_(g,u,_)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||c_(_,b),E=GI(p,d,_,b==="in"||b==="not-in");return Sn.create(x,b,E)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function fs(s,e,n){const r=e,o=jo("where",s);return _f._create(o,r,n)}class q0 extends z0{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new q0(e,n)}_parse(e){const n=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return n.length===1?n[0]:ua.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(o,u){let d=o;const p=u.getFlattenedFilters();for(const g of p)C2(d,g),d=bg(d,g)})(e._query,n),new vl(e.firestore,e.converter,bg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function o_(s,e,n){if(typeof(n=Zt(n))=="string"){if(n==="")throw new Ce(ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!TN(e)&&n.indexOf("/")!==-1)throw new Ce(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Gt.fromString(n));if(!Fe.isDocumentKey(r))throw new Ce(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _w(s,new Fe(r))}if(n instanceof on)return _w(s,n._key);throw new Ce(ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sf(n)}.`)}function c_(s,e){if(!Array.isArray(s)||s.length===0)throw new Ce(ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function C2(s,e){const n=(function(o,u){for(const d of o)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Ce(ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ce(ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function R2(s,e,n){let r;return r=s?s.toFirestore(e):e,r}class Yc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nl extends T2{constructor(e,n,r,o,u,d){super(e,n,r,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new wh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(jo("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(ge.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=nl._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}nl._jsonSchemaVersion="firestore/documentSnapshot/1.0",nl._jsonSchema={type:jn("string",nl._jsonSchemaVersion),bundleSource:jn("string","DocumentSnapshot"),bundleName:jn("string"),bundle:jn("string")};class wh extends nl{data(e={}){return super.data(e)}}class sl{constructor(e,n,r,o){this._firestore=e,this._userDataWriter=n,this._snapshot=o,this.metadata=new Yc(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new wh(this._firestore,this._userDataWriter,r.key,r,new Yc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Ce(ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(o,u){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((p=>{const g=new wh(o._firestore,o._userDataWriter,p.doc.key,p.doc,new Yc(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new wh(o._firestore,o._userDataWriter,p.doc.key,p.doc,new Yc(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);let x=-1,b=-1;return p.type!==0&&(x=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),b=d.indexOf(p.doc.key)),{type:XI(p.type),doc:g,oldIndex:x,newIndex:b}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(ge.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=sl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=l0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],o=[];return this.docs.forEach((u=>{u._document!==null&&(n.push(u._document),r.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),o.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function XI(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qe(61501,{type:s})}}sl._jsonSchemaVersion="firestore/querySnapshot/1.0",sl._jsonSchema={type:jn("string",sl._jsonSchemaVersion),bundleSource:jn("string","QuerySnapshot"),bundleName:jn("string"),bundle:jn("string")};function qp(s){s=ms(s,on);const e=ms(s.firestore,br),n=bf(e);return DI(n,s._key).then((r=>k2(e,s,r)))}function Ms(s){s=ms(s,vl);const e=ms(s.firestore,br),n=bf(e),r=new U0(e);return A2(s._query),MI(n,s._query).then((o=>new sl(e,r,s,o)))}function Fp(s,e,n){s=ms(s,on);const r=ms(s.firestore,br),o=R2(s.converter,e),u=vf(r);return Nf(r,[_2(u,"setDoc",s._key,o,s.converter!==null,n).toMutation(s._key,Ks.none())])}function ot(s,e,n,...r){s=ms(s,on);const o=ms(s.firestore,br),u=vf(o);let d;return d=typeof(e=Zt(e))=="string"||e instanceof O0?$I(u,"updateDoc",s._key,e,n,r):HI(u,"updateDoc",s._key,e),Nf(o,[d.toMutation(s._key,Ks.exists(!0))])}function JI(s){return Nf(ms(s.firestore,br),[new m0(s._key,Ks.none())])}function yr(s,e){const n=ms(s.firestore,br),r=Je(s),o=R2(s.converter,e),u=vf(s.firestore);return Nf(n,[_2(u,"addDoc",r._key,o,s.converter!==null,{}).toMutation(r._key,Ks.exists(!1))]).then((()=>r))}function rn(s,...e){s=Zt(s);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||l_(e[r])||(n=e[r++]);const o={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(l_(e[r])){const x=e[r];e[r]=x.next?.bind(x),e[r+1]=x.error?.bind(x),e[r+2]=x.complete?.bind(x)}let u,d,p;if(s instanceof on)d=ms(s.firestore,br),p=of(s._key.path),u={next:x=>{e[r]&&e[r](k2(d,s,x))},error:e[r+1],complete:e[r+2]};else{const x=ms(s,vl);d=ms(x.firestore,br),p=x._query;const b=new U0(d);u={next:_=>{e[r]&&e[r](new sl(d,b,x,_))},error:e[r+1],complete:e[r+2]},A2(s._query)}const g=bf(d);return II(g,p,o,u)}function Nf(s,e){const n=bf(s);return OI(n,e)}function k2(s,e,n){const r=n.docs.get(e._key),o=new U0(s);return new nl(s,o,e._key,r,new Yc(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){MR(gl),il(new ui("firestore",((r,{instanceIdentifier:o,options:u})=>{const d=r.getProvider("app").getImmediate(),p=new br(new VR(r.getProvider("auth-internal")),new BR(d,r.getProvider("app-check-internal")),sk(d,o),d);return u={useFetchStreams:n,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),ka(r_,i_,e),ka(r_,i_,"esm2020")})();const I2="firebasestorage.googleapis.com",D2="storageBucket",ZI=120*1e3,e6=600*1e3;class un extends za{constructor(e,n,r=0){super(Hp(e),`Firebase Storage: ${n} (${Hp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,un.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Hp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var cn;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(cn||(cn={}));function Hp(s){return"storage/"+s}function F0(){const s="An unknown error occurred, please check the error payload for server response.";return new un(cn.UNKNOWN,s)}function t6(s){return new un(cn.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function n6(s){return new un(cn.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function s6(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new un(cn.UNAUTHENTICATED,s)}function a6(){return new un(cn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function r6(s){return new un(cn.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function i6(){return new un(cn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function l6(){return new un(cn.CANCELED,"User canceled the upload/download.")}function o6(s){return new un(cn.INVALID_URL,"Invalid URL '"+s+"'.")}function c6(s){return new un(cn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function u6(){return new un(cn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+D2+"' property when initializing the app?")}function d6(){return new un(cn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function h6(){return new un(cn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function f6(s){return new un(cn.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Cg(s){return new un(cn.INVALID_ARGUMENT,s)}function M2(){return new un(cn.APP_DELETED,"The Firebase app was deleted.")}function m6(s){return new un(cn.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function tu(s,e){return new un(cn.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Lc(s){throw new un(cn.INTERNAL_ERROR,"Internal error: "+s)}class ks{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=ks.makeFromUrl(e,n)}catch{return new ks(e,"")}if(r.path==="")return r;throw c6(e)}static makeFromUrl(e,n){let r=null;const o="([A-Za-z0-9.\\-_]+)";function u(fe){fe.path.charAt(fe.path.length-1)==="/"&&(fe.path_=fe.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+o+d,"i"),g={bucket:1,path:3};function x(fe){fe.path_=decodeURIComponent(fe.path)}const b="v[A-Za-z0-9_]+",_=n.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",A=new RegExp(`^https?://${_}/${b}/b/${o}/o${E}`,"i"),F={bucket:1,path:3},L=n===I2?"(?:storage.googleapis.com|storage.cloud.google.com)":n,O="([^?#]*)",U=new RegExp(`^https?://${L}/${o}/${O}`,"i"),K=[{regex:p,indices:g,postModify:u},{regex:A,indices:F,postModify:x},{regex:U,indices:{bucket:1,path:2},postModify:x}];for(let fe=0;fe<K.length;fe++){const he=K[fe],oe=he.regex.exec(e);if(oe){const j=oe[he.indices.bucket];let T=oe[he.indices.path];T||(T=""),r=new ks(j,T),he.postModify(r);break}}if(r==null)throw o6(e);return r}}class p6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function g6(s,e,n){let r=1,o=null,u=null,d=!1,p=0;function g(){return p===2}let x=!1;function b(...O){x||(x=!0,e.apply(null,O))}function _(O){o=setTimeout(()=>{o=null,s(A,g())},O)}function E(){u&&clearTimeout(u)}function A(O,...U){if(x){E();return}if(O){E(),b.call(null,O,...U);return}if(g()||d){E(),b.call(null,O,...U);return}r<64&&(r*=2);let K;p===1?(p=2,K=0):K=(r+Math.random())*1e3,_(K)}let F=!1;function L(O){F||(F=!0,E(),!x&&(o!==null?(O||(p=2),clearTimeout(o),_(0)):O||(p=1)))}return _(0),u=setTimeout(()=>{d=!0,L(!0)},n),L}function x6(s){s(!1)}function b6(s){return s!==void 0}function y6(s){return typeof s=="object"&&!Array.isArray(s)}function H0(s){return typeof s=="string"||s instanceof String}function u_(s){return $0()&&s instanceof Blob}function $0(){return typeof Blob<"u"}function d_(s,e,n,r){if(r<e)throw Cg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(r>n)throw Cg(`Invalid value for '${s}'. Expected ${n} or less.`)}function Ef(s,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${s}`}function O2(s){const e=encodeURIComponent;let n="?";for(const r in s)if(s.hasOwnProperty(r)){const o=e(r)+"="+e(s[r]);n=n+o+"&"}return n=n.slice(0,-1),n}var al;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(al||(al={}));function v6(s,e){const n=s>=500&&s<600,o=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return n||o||u}class w6{constructor(e,n,r,o,u,d,p,g,x,b,_,E=!0,A=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=o,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=x,this.progressCallback_=b,this.connectionFactory_=_,this.retry=E,this.isUsingEmulator=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((F,L)=>{this.resolve_=F,this.reject_=L,this.start_()})}start_(){const e=(r,o)=>{if(o){r(!1,new ah(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,x=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,x)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===al.NO_ERROR,g=u.getStatus();if(!p||v6(g,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===al.ABORT;r(!1,new ah(!1,null,b));return}const x=this.successCodes_.indexOf(g)!==-1;r(!0,new ah(x,u))})},n=(r,o)=>{const u=this.resolve_,d=this.reject_,p=o.connection;if(o.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());b6(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=F0();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(o.canceled){const g=this.appDelete_?M2():l6();d(g)}else{const g=i6();d(g)}};this.canceled_?n(!1,new ah(!1,null,!0)):this.backoffId_=g6(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&x6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ah{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function _6(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function N6(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function E6(s,e){e&&(s["X-Firebase-GMPID"]=e)}function S6(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function j6(s,e,n,r,o,u,d=!0,p=!1){const g=O2(s.urlParams),x=s.url+g,b=Object.assign({},s.headers);return E6(b,e),_6(b,n),N6(b,u),S6(b,r),new w6(x,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,o,d,p)}function T6(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function A6(...s){const e=T6();if(e!==void 0){const n=new e;for(let r=0;r<s.length;r++)n.append(s[r]);return n.getBlob()}else{if($0())return new Blob(s);throw new un(cn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function C6(s,e,n){return s.webkitSlice?s.webkitSlice(e,n):s.mozSlice?s.mozSlice(e,n):s.slice?s.slice(e,n):null}function R6(s){if(typeof atob>"u")throw f6("base-64");return atob(s)}const Ra={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class $p{constructor(e,n){this.data=e,this.contentType=n||null}}function k6(s,e){switch(s){case Ra.RAW:return new $p(P2(e));case Ra.BASE64:case Ra.BASE64URL:return new $p(V2(s,e));case Ra.DATA_URL:return new $p(D6(e),M6(e))}throw F0()}function P2(s){const e=[];for(let n=0;n<s.length;n++){let r=s.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<s.length-1&&(s.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const u=r,d=s.charCodeAt(++n);r=65536|(u&1023)<<10|d&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function I6(s){let e;try{e=decodeURIComponent(s)}catch{throw tu(Ra.DATA_URL,"Malformed data URL.")}return P2(e)}function V2(s,e){switch(s){case Ra.BASE64:{const o=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(o||u)throw tu(s,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Ra.BASE64URL:{const o=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(o||u)throw tu(s,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=R6(e)}catch(o){throw o.message.includes("polyfill")?o:tu(s,"Invalid character found")}const r=new Uint8Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return r}class L2{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw tu(Ra.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=O6(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function D6(s){const e=new L2(s);return e.base64?V2(Ra.BASE64,e.rest):I6(e.rest)}function M6(s){return new L2(s).contentType}function O6(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class ni{constructor(e,n){let r=0,o="";u_(e)?(this.data_=e,r=e.size,o=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,n){if(u_(this.data_)){const r=this.data_,o=C6(r,e,n);return o===null?null:new ni(o)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new ni(r,!0)}}static getBlob(...e){if($0()){const n=e.map(r=>r instanceof ni?r.data_:r);return new ni(A6.apply(null,n))}else{const n=e.map(d=>H0(d)?k6(Ra.RAW,d).data:d.data_);let r=0;n.forEach(d=>{r+=d.byteLength});const o=new Uint8Array(r);let u=0;return n.forEach(d=>{for(let p=0;p<d.length;p++)o[u++]=d[p]}),new ni(o,!0)}}uploadData(){return this.data_}}function U2(s){let e;try{e=JSON.parse(s)}catch{return null}return y6(e)?e:null}function P6(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function V6(s,e){const n=e.split("/").filter(r=>r.length>0).join("/");return s.length===0?n:s+"/"+n}function B2(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function L6(s,e){return e}class Zn{constructor(e,n,r,o){this.server=e,this.local=n||e,this.writable=!!r,this.xform=o||L6}}let rh=null;function U6(s){return!H0(s)||s.length<2?s:B2(s)}function z2(){if(rh)return rh;const s=[];s.push(new Zn("bucket")),s.push(new Zn("generation")),s.push(new Zn("metageneration")),s.push(new Zn("name","fullPath",!0));function e(u,d){return U6(d)}const n=new Zn("name");n.xform=e,s.push(n);function r(u,d){return d!==void 0?Number(d):d}const o=new Zn("size");return o.xform=r,s.push(o),s.push(new Zn("timeCreated")),s.push(new Zn("updated")),s.push(new Zn("md5Hash",null,!0)),s.push(new Zn("cacheControl",null,!0)),s.push(new Zn("contentDisposition",null,!0)),s.push(new Zn("contentEncoding",null,!0)),s.push(new Zn("contentLanguage",null,!0)),s.push(new Zn("contentType",null,!0)),s.push(new Zn("metadata","customMetadata",!0)),rh=s,rh}function B6(s,e){function n(){const r=s.bucket,o=s.fullPath,u=new ks(r,o);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:n})}function z6(s,e,n){const r={};r.type="file";const o=n.length;for(let u=0;u<o;u++){const d=n[u];r[d.local]=d.xform(r,e[d.server])}return B6(r,s),r}function q2(s,e,n){const r=U2(e);return r===null?null:z6(s,r,n)}function q6(s,e,n,r){const o=U2(e);if(o===null||!H0(o.downloadTokens))return null;const u=o.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(x=>{const b=s.bucket,_=s.fullPath,E="/b/"+d(b)+"/o/"+d(_),A=Ef(E,n,r),F=O2({alt:"media",token:x});return A+F})[0]}function F6(s,e){const n={},r=e.length;for(let o=0;o<r;o++){const u=e[o];u.writable&&(n[u.server]=s[u.local])}return JSON.stringify(n)}class G0{constructor(e,n,r,o){this.url=e,this.method=n,this.handler=r,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function F2(s){if(!s)throw F0()}function H6(s,e){function n(r,o){const u=q2(s,o,e);return F2(u!==null),u}return n}function $6(s,e){function n(r,o){const u=q2(s,o,e);return F2(u!==null),q6(u,o,s.host,s._protocol)}return n}function H2(s){function e(n,r){let o;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?o=a6():o=s6():n.getStatus()===402?o=n6(s.bucket):n.getStatus()===403?o=r6(s.path):o=r,o.status=n.getStatus(),o.serverResponse=r.serverResponse,o}return e}function $2(s){const e=H2(s);function n(r,o){let u=e(r,o);return r.getStatus()===404&&(u=t6(s.path)),u.serverResponse=o.serverResponse,u}return n}function G6(s,e,n){const r=e.fullServerUrl(),o=Ef(r,s.host,s._protocol),u="GET",d=s.maxOperationRetryTime,p=new G0(o,u,$6(s,n),d);return p.errorHandler=$2(e),p}function Y6(s,e){const n=e.fullServerUrl(),r=Ef(n,s.host,s._protocol),o="DELETE",u=s.maxOperationRetryTime;function d(g,x){}const p=new G0(r,o,d,u);return p.successCodes=[200,204],p.errorHandler=$2(e),p}function W6(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function K6(s,e,n){const r=Object.assign({},n);return r.fullPath=s.path,r.size=e.size(),r.contentType||(r.contentType=W6(null,e)),r}function Q6(s,e,n,r,o){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let K="";for(let fe=0;fe<2;fe++)K=K+Math.random().toString().slice(2);return K}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const x=K6(e,r,o),b=F6(x,n),_="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+g+`\r
Content-Type: `+x.contentType+`\r
\r
`,E=`\r
--`+g+"--",A=ni.getBlob(_,r,E);if(A===null)throw d6();const F={name:x.fullPath},L=Ef(u,s.host,s._protocol),O="POST",U=s.maxUploadRetryTime,G=new G0(L,O,H6(s,n),U);return G.urlParams=F,G.headers=d,G.body=A.uploadData(),G.errorHandler=H2(e),G}class X6{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=al.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=al.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=al.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,o,u){if(this.sent_)throw Lc("cannot .send() more than once");if(yi(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Lc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Lc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Lc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Lc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class J6 extends X6{initXhr(){this.xhr_.responseType="text"}}function Y0(){return new J6}class dl{constructor(e,n){this._service=e,n instanceof ks?this._location=n:this._location=ks.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new dl(e,n)}get root(){const e=new ks(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return B2(this._location.path)}get storage(){return this._service}get parent(){const e=P6(this._location.path);if(e===null)return null;const n=new ks(this._location.bucket,e);return new dl(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw m6(e)}}function Z6(s,e,n){s._throwIfRoot("uploadBytes");const r=Q6(s.storage,s._location,z2(),new ni(e,!0),n);return s.storage.makeRequestWithTokens(r,Y0).then(o=>({metadata:o,ref:s}))}function e3(s){s._throwIfRoot("getDownloadURL");const e=G6(s.storage,s._location,z2());return s.storage.makeRequestWithTokens(e,Y0).then(n=>{if(n===null)throw h6();return n})}function t3(s){s._throwIfRoot("deleteObject");const e=Y6(s.storage,s._location);return s.storage.makeRequestWithTokens(e,Y0)}function n3(s,e){const n=V6(s._location.path,e),r=new ks(s._location.bucket,n);return new dl(s.storage,r)}function s3(s){return/^[A-Za-z]+:\/\//.test(s)}function a3(s,e){return new dl(s,e)}function G2(s,e){if(s instanceof W0){const n=s;if(n._bucket==null)throw u6();const r=new dl(n,n._bucket);return e!=null?G2(r,e):r}else return e!==void 0?n3(s,e):s}function r3(s,e){if(e&&s3(e)){if(s instanceof W0)return a3(s,e);throw Cg("To use ref(service, url), the first argument must be a Storage instance.")}else return G2(s,e)}function h_(s,e){const n=e?.[D2];return n==null?null:ks.makeFromBucketSpec(n,s)}function i3(s,e,n,r={}){s.host=`${e}:${n}`;const o=yi(e);o&&(Yg(`https://${s.host}/b`),Wg("Storage",!0)),s._isUsingEmulator=!0,s._protocol=o?"https":"http";const{mockUserToken:u}=r;u&&(s._overrideAuthToken=typeof u=="string"?u:m1(u,s.app.options.projectId))}class W0{constructor(e,n,r,o,u,d=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=o,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=I2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ZI,this._maxUploadRetryTime=e6,this._requests=new Set,o!=null?this._bucket=ks.makeFromBucketSpec(o,this._host):this._bucket=h_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ks.makeFromBucketSpec(this._url,e):this._bucket=h_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){d_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){d_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Cs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new dl(this,e)}_makeRequest(e,n,r,o,u=!0){if(this._deleted)return new p6(M2());{const d=j6(e,this._appId,r,o,n,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,n){const[r,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,o).getPromise()}}const f_="@firebase/storage",m_="0.14.0";const Y2="storage";function l3(s,e,n){return s=Zt(s),Z6(s,e,n)}function o3(s){return s=Zt(s),e3(s)}function c3(s){return s=Zt(s),t3(s)}function p_(s,e){return s=Zt(s),r3(s,e)}function u3(s=Xg(),e){s=Zt(s);const r=Zh(s,Y2).getImmediate({identifier:e}),o=d1("storage");return o&&d3(r,...o),r}function d3(s,e,n,r={}){i3(s,e,n,r)}function h3(s,{instanceIdentifier:e}){const n=s.getProvider("app").getImmediate(),r=s.getProvider("auth-internal"),o=s.getProvider("app-check-internal");return new W0(n,r,o,e,gl)}function f3(){il(new ui(Y2,h3,"PUBLIC").setMultipleInstances(!0)),ka(f_,m_,""),ka(f_,m_,"esm2020")}f3();const m3={apiKey:"AIzaSyC1qZ9fK-6LFBxVWZsAD4dZq-KVg36A7f8",authDomain:"scheduler-65e51.firebaseapp.com",projectId:"scheduler-65e51",storageBucket:"scheduler-65e51.firebasestorage.app",messagingSenderId:"93993791456",appId:"1:93993791456:web:3a777a2da0dad4b8b74585"},K0=x1(m3),Ee=UI(K0),hl=RR(K0),g_=u3(K0);const W2=(...s)=>s.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();const p3=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const g3=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase());const x_=s=>{const e=g3(s);return e.charAt(0).toUpperCase()+e.slice(1)};var x3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const b3=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const y3=N.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:u,iconNode:d,...p},g)=>N.createElement("svg",{ref:g,...x3,width:e,height:e,stroke:s,strokeWidth:r?Number(n)*24/Number(e):n,className:W2("lucide",o),...!u&&!b3(p)&&{"aria-hidden":"true"},...p},[...d.map(([x,b])=>N.createElement(x,b)),...Array.isArray(u)?u:[u]]));const Me=(s,e)=>{const n=N.forwardRef(({className:r,...o},u)=>N.createElement(y3,{ref:u,iconNode:e,className:W2(`lucide-${p3(x_(s))}`,`lucide-${s}`,r),...o}));return n.displayName=x_(s),n};const v3=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],w3=Me("arrow-down-right",v3);const _3=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Va=Me("arrow-left",_3);const N3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],nu=Me("arrow-right",N3);const E3=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],S3=Me("arrow-up-down",E3);const j3=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],T3=Me("arrow-up-right",j3);const A3=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],ho=Me("bell",A3);const C3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],Gp=Me("calendar-check",C3);const R3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],b_=Me("calendar-days",R3);const k3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],zt=Me("calendar",k3);const I3=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],D3=Me("camera",I3);const M3=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],K2=Me("chart-column",M3);const O3=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],P3=Me("chart-pie",O3);const V3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],oi=Me("check",V3);const L3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Rg=Me("chevron-down",L3);const U3=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Q2=Me("chevron-left",U3);const B3=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Sf=Me("chevron-right",B3);const z3=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],kg=Me("chevron-up",z3);const q3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],y_=Me("circle-alert",q3);const F3=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Is=Me("circle-check-big",F3);const H3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ca=Me("circle-x",H3);const $3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Dn=Me("clock",$3);const G3=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],Y3=Me("coffee",G3);const W3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],K3=Me("copy",W3);const Q3=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],yo=Me("credit-card",Q3);const X3=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],J3=Me("dollar-sign",X3);const Z3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],eD=Me("eye",Z3);const tD=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],nD=Me("ghost",tD);const sD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],aD=Me("globe",sD);const rD=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Q0=Me("heart",rD);const iD=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],lD=Me("image",iD);const oD=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],Ig=Me("list-ordered",oD);const cD=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]],Yh=Me("list-plus",cD);const uD=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Yp=Me("loader-circle",uD);const dD=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Wh=Me("lock",dD);const hD=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],fD=Me("log-out",hD);const mD=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Dg=Me("mail",mD);const pD=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Kh=Me("message-circle",pD);const gD=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],xD=Me("message-square",gD);const bD=[["path",{d:"M5 12h14",key:"1ays0h"}]],yD=Me("minus",bD);const vD=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],X2=Me("party-popper",vD);const wD=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],J2=Me("pen-line",wD);const _D=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Mg=Me("phone",_D);const ND=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Wp=Me("play",ND);const ED=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],xi=Me("plus",ED);const SD=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Z2=Me("refresh-cw",SD);const jD=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],ci=Me("repeat",jD);const TD=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],AD=Me("save",TD);const CD=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],Ba=Me("scissors",CD);const RD=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],kD=Me("search",RD);const ID=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],_h=Me("send",ID);const DD=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],MD=Me("settings",DD);const OD=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],PD=Me("sparkles",OD);const VD=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],v_=Me("star",VD);const LD=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],w_=Me("sticky-note",LD);const UD=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],ps=Me("tag",UD);const BD=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],eE=Me("thermometer",BD);const zD=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],tE=Me("timer",zD);const qD=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],mu=Me("trash-2",qD);const FD=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],X0=Me("trending-up",FD);const HD=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],fl=Me("triangle-alert",HD);const $D=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],GD=Me("user-plus",$D);const YD=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ml=Me("user",YD);const WD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ln=Me("users",WD);const KD=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],La=Me("x",KD);const QD=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],XD=Me("zap",QD);function __({className:s=""}){return i.jsxs(rt,{to:"/",className:`flex items-center gap-2.5 ${s}`,children:[i.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:i.jsx(Ba,{className:"w-[18px] h-[18px] text-white"})}),i.jsxs("span",{className:"text-xl font-extrabold tracking-tight text-slate-900",children:["Book",i.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}function JD(){return i.jsxs("div",{className:"min-h-screen bg-white",children:[i.jsx("nav",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-100",children:i.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[i.jsx(__,{}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(rt,{to:"/login",className:"px-4 py-2.5 text-sm font-semibold text-slate-600 hover:text-slate-900 transition-colors",children:"Sign In"}),i.jsxs(rt,{to:"/register",className:"hidden sm:inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:["Get Started Free",i.jsx(nu,{className:"w-4 h-4"})]}),i.jsx(rt,{to:"/register",className:"sm:hidden px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all",children:"Start Free"})]})]})}),i.jsxs("section",{className:"relative overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0 -z-10",children:[i.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-blue-50 rounded-full blur-3xl opacity-60 -translate-y-1/2 translate-x-1/3"}),i.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-violet-50 rounded-full blur-3xl opacity-50 translate-y-1/3 -translate-x-1/4"})]}),i.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 pt-16 sm:pt-24 pb-16 sm:pb-20",children:i.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-16 items-center",children:[i.jsxs("div",{className:"animate-fade-in-up",children:[i.jsxs("div",{className:"inline-flex items-center gap-2 px-3.5 py-1.5 bg-blue-50 border border-blue-100 rounded-full text-sm font-medium text-blue-700 mb-6",children:[i.jsx(PD,{className:"w-3.5 h-3.5"}),"Free for beauty professionals"]}),i.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-[3.5rem] font-extrabold text-slate-900 leading-[1.1] mb-6 tracking-tight",children:["Online booking",i.jsx("br",{}),i.jsx("span",{className:"text-blue-600",children:"made effortless"})]}),i.jsx("p",{className:"text-lg sm:text-xl text-slate-600 leading-relaxed mb-8 max-w-lg",children:"Let clients book 24/7. Manage your team, services, and schedule from one beautiful dashboard. No more phone tag."}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-10",children:[i.jsxs(rt,{to:"/register",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-base shadow-lg shadow-blue-600/25 hover:shadow-xl hover:shadow-blue-600/30 transition-all hover:-translate-y-0.5",children:["Start for Free",i.jsx(nu,{className:"w-4 h-4"})]}),i.jsx("a",{href:"#how-it-works",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-base border border-slate-200 transition-all",children:"See How It Works"})]}),i.jsxs("div",{className:"flex items-center gap-5 text-sm text-slate-500",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(Is,{className:"w-4 h-4 text-emerald-500"}),i.jsx("span",{children:"Free to use"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(Is,{className:"w-4 h-4 text-emerald-500"}),i.jsx("span",{children:"No credit card"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(Is,{className:"w-4 h-4 text-emerald-500"}),i.jsx("span",{children:"Setup in 2 min"})]})]})]}),i.jsxs("div",{className:"relative animate-fade-in-up",style:{animationDelay:"150ms"},children:[i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl shadow-slate-200/60 border border-slate-200/80 overflow-hidden",children:[i.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-slate-50 border-b border-slate-100",children:[i.jsxs("div",{className:"flex gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),i.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),i.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"})]}),i.jsx("div",{className:"flex-1 mx-4",children:i.jsx("div",{className:"bg-white border border-slate-200 rounded-lg px-3 py-1.5 text-xs text-slate-400 font-mono",children:"bookflow.app/shop/janes-salon"})})]}),i.jsxs("div",{className:"p-6 space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-sm font-bold",children:"J"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-bold text-slate-900",children:"Jane's Salon"}),i.jsx("div",{className:"text-xs text-slate-500",children:"Book your next appointment"})]})]}),i.jsx("div",{className:"space-y-2.5",children:[{name:"Haircut & Style",price:"$45",time:"45 min",color:"bg-blue-500"},{name:"Color Treatment",price:"$120",time:"2 hours",color:"bg-violet-500"},{name:"Blowout",price:"$35",time:"30 min",color:"bg-emerald-500"}].map(s=>i.jsxs("div",{className:"flex items-center justify-between p-3.5 bg-slate-50 rounded-xl border border-slate-100 group hover:border-blue-200 hover:bg-blue-50/50 transition-all cursor-default",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`w-2 h-8 ${s.color} rounded-full`}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold text-slate-800",children:s.name}),i.jsx("div",{className:"text-xs text-slate-500",children:s.time})]})]}),i.jsx("div",{className:"text-sm font-bold text-slate-900",children:s.price})]},s.name))})]})]}),i.jsxs("div",{className:"absolute -bottom-4 -left-4 bg-white rounded-xl shadow-lg shadow-slate-200/60 border border-slate-100 px-4 py-3 flex items-center gap-3 animate-float",children:[i.jsx("div",{className:"w-9 h-9 bg-emerald-100 rounded-full flex items-center justify-center",children:i.jsx(Is,{className:"w-5 h-5 text-emerald-600"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-slate-500",children:"Booking confirmed"}),i.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Tomorrow at 2:00 PM"})]})]})]})]})})]}),i.jsx("section",{className:"border-y border-slate-100 bg-slate-50/50",children:i.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-8 sm:py-10",children:i.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-8 sm:gap-16 text-center",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"500+"}),i.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Businesses trust BookFlow"})]}),i.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"10,000+"}),i.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Appointments booked"})]}),i.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl sm:text-3xl font-extrabold text-slate-900",children:["4.9 ",i.jsx(v_,{className:"w-5 h-5 text-amber-400 fill-amber-400"})]}),i.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Average rating"})]})]})})}),i.jsx("section",{className:"py-20 sm:py-28",children:i.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[i.jsxs("div",{className:"text-center mb-14",children:[i.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Everything you need to run your bookings"}),i.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Built specifically for beauty professionals, salons, and service businesses. Simple, powerful, and free."})]}),i.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 stagger-children",children:[{icon:i.jsx(zt,{className:"w-6 h-6"}),title:"Smart Scheduling",desc:"Set weekly hours with breaks. Slots auto-generate so your calendar is always up to date.",color:"bg-blue-100 text-blue-600"},{icon:i.jsx(ln,{className:"w-6 h-6"}),title:"Multi-Staff Support",desc:"Add your whole team. Each member gets their own schedule, hours, and bookings.",color:"bg-violet-100 text-violet-600"},{icon:i.jsx(XD,{className:"w-6 h-6"}),title:"Instant Booking",desc:"Clients pick a service, choose a stylist, and book  all in under a minute.",color:"bg-amber-100 text-amber-600"},{icon:i.jsx(aD,{className:"w-6 h-6"}),title:"Your Own Booking Page",desc:"Get a unique link to share anywhere. No app downloads needed for your clients.",color:"bg-emerald-100 text-emerald-600"}].map(s=>i.jsxs("div",{className:"group bg-white rounded-2xl p-7 border border-slate-200/80 hover:border-slate-300 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[i.jsx("div",{className:`w-12 h-12 ${s.color} rounded-xl flex items-center justify-center mb-5 group-hover:scale-110 transition-transform duration-300`,children:s.icon}),i.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:s.title}),i.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:s.desc})]},s.title))})]})}),i.jsx("section",{id:"how-it-works",className:"py-20 sm:py-28 bg-slate-50 border-y border-slate-100",children:i.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[i.jsxs("div",{className:"text-center mb-14",children:[i.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Up and running in minutes"}),i.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Three simple steps to start accepting online bookings today."})]}),i.jsxs("div",{className:"grid md:grid-cols-3 gap-8 lg:gap-12 relative",children:[i.jsx("div",{className:"hidden md:block absolute top-14 left-[calc(16.67%+1rem)] right-[calc(16.67%+1rem)] h-px bg-gradient-to-r from-blue-200 via-violet-200 to-emerald-200"}),[{step:"1",title:"Create your account",desc:"Sign up free in 30 seconds. Name your shop and you're in.",color:"from-blue-500 to-blue-600",shadow:"shadow-blue-500/30"},{step:"2",title:"Set up your shop",desc:"Add your services, team, and weekly hours. BookFlow handles the rest.",color:"from-violet-500 to-violet-600",shadow:"shadow-violet-500/30"},{step:"3",title:"Share your link",desc:"Send your booking page to clients. They book, you get notified.",color:"from-emerald-500 to-emerald-600",shadow:"shadow-emerald-500/30"}].map(s=>i.jsxs("div",{className:"relative text-center",children:[i.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${s.color} rounded-2xl flex items-center justify-center mx-auto mb-6 text-white text-xl font-extrabold shadow-lg ${s.shadow} relative z-10`,children:s.step}),i.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:s.title}),i.jsx("p",{className:"text-slate-600 leading-relaxed max-w-xs mx-auto",children:s.desc})]},s.step))]})]})}),i.jsx("section",{className:"py-20 sm:py-28",children:i.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[i.jsxs("div",{className:"text-center mb-14",children:[i.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Loved by professionals"}),i.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"See why salons and stylists are switching to BookFlow."})]}),i.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{quote:"BookFlow replaced our paper appointment book. Clients love being able to book online anytime.",name:"Maria Santos",role:"Salon Owner",initials:"MS",color:"bg-blue-100 text-blue-700"},{quote:"Setting up was incredibly easy. I had my booking page live and shared with clients in under 10 minutes.",name:"David Chen",role:"Barber",initials:"DC",color:"bg-violet-100 text-violet-700"},{quote:"The multi-staff feature is perfect. Each stylist manages their own schedule and clients can pick who they want.",name:"Lisa Park",role:"Studio Manager",initials:"LP",color:"bg-emerald-100 text-emerald-700"}].map(s=>i.jsxs("div",{className:"bg-white rounded-2xl p-7 border border-slate-200/80 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[i.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(5)].map((e,n)=>i.jsx(v_,{className:"w-4 h-4 text-amber-400 fill-amber-400"},n))}),i.jsxs("p",{className:"text-slate-700 leading-relaxed mb-6",children:['"',s.quote,'"']}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`w-10 h-10 ${s.color} rounded-full flex items-center justify-center text-sm font-bold`,children:s.initials}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s.name}),i.jsx("div",{className:"text-xs text-slate-500",children:s.role})]})]})]},s.name))})]})}),i.jsxs("section",{className:"py-20 sm:py-28 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 relative overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0 -z-0",children:[i.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),i.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-violet-500/10 rounded-full blur-3xl"})]}),i.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto px-5 sm:px-8 text-center",children:[i.jsx("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-extrabold text-white mb-6 leading-tight",children:"Ready to streamline your bookings?"}),i.jsx("p",{className:"text-lg text-slate-400 mb-10 max-w-xl mx-auto",children:"Join hundreds of professionals who have ditched the old appointment book. Set up in minutes, free forever."}),i.jsxs(rt,{to:"/register",className:"inline-flex items-center gap-2 px-8 py-4 bg-white hover:bg-slate-50 text-slate-900 rounded-xl font-bold text-lg transition-all hover:shadow-xl hover:shadow-white/10 hover:-translate-y-0.5",children:["Create Your Free Account",i.jsx(nu,{className:"w-5 h-5"})]})]})]}),i.jsx("footer",{className:"bg-white border-t border-slate-100",children:i.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-10",children:i.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsx(__,{}),i.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500",children:[i.jsx(rt,{to:"/register",className:"hover:text-slate-900 transition-colors",children:"Sign Up"}),i.jsx("span",{className:"text-slate-200",children:""}),i.jsx(rt,{to:"/login",className:"hover:text-slate-900 transition-colors",children:"Sign In"}),i.jsx("span",{className:"text-slate-200",children:""}),i.jsx("a",{href:"#how-it-works",className:"hover:text-slate-900 transition-colors",children:"How It Works"})]}),i.jsxs("p",{className:"text-xs text-slate-400",children:[" ",new Date().getFullYear()," BookFlow. All rights reserved."]})]})})})]})}function ZD(s){return s.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function eM(){const s=Ro(),[e,n]=N.useState(""),[r,o]=N.useState(""),[u,d]=N.useState(""),[p,g]=N.useState(""),[x,b]=N.useState(!1),_=ZD(e),E=async A=>{if(A.preventDefault(),g(""),!_){g("Please enter a valid shop name");return}if(u.length<6){g("Password must be at least 6 characters");return}b(!0);try{const F=Ds(st(Ee,"shops"),fs("slug","==",_));if(!(await Ms(F)).empty){g("A shop with that name already exists. Please choose a different name."),b(!1);return}const U=(await pC(hl,r,u)).user;await yr(st(Ee,"shops"),{name:e.trim(),slug:_,ownerUid:U.uid,ownerEmail:r,createdAt:B0()}),s(`/shop/${_}/dashboard`)}catch(F){switch(F.code){case"auth/email-already-in-use":g("An account with this email already exists");break;case"auth/invalid-email":g("Please enter a valid email address");break;case"auth/weak-password":g("Password must be at least 6 characters");break;default:g("Registration failed. Please try again.")}}finally{b(!1)}};return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:i.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[i.jsx("div",{className:"text-center mb-8",children:i.jsxs(rt,{to:"/",className:"inline-flex items-center gap-2.5",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:i.jsx(Ba,{className:"w-5 h-5 text-white"})}),i.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Book",i.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}),i.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Create your shop"}),i.jsx("p",{className:"text-sm text-slate-500",children:"Set up your booking page in seconds  it's free"})]}),i.jsxs("form",{onSubmit:E,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Shop Name"}),i.jsx("input",{type:"text",value:e,onChange:A=>{n(A.target.value),g("")},placeholder:"Jane's Salon",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),_&&i.jsxs("p",{className:"mt-1.5 text-xs text-slate-400",children:["Your page: ",i.jsxs("span",{className:"font-mono text-blue-600 font-medium",children:["bookflow.app/shop/",_]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),i.jsx("input",{type:"email",value:r,onChange:A=>{o(A.target.value),g("")},placeholder:"you@example.com",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),i.jsx("input",{type:"password",value:u,onChange:A=>{d(A.target.value),g("")},placeholder:"At least 6 characters",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${p?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),p&&i.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[i.jsx("span",{children:""})," ",p]})]}),i.jsx("button",{type:"submit",disabled:x,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:x?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Creating your shop"]}):i.jsxs(i.Fragment,{children:["Create Shop",i.jsx(nu,{className:"w-4 h-4"})]})})]}),i.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:i.jsxs("p",{className:"text-sm text-slate-500",children:["Already have an account?"," ",i.jsx(rt,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Sign in"})]})})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsxs(rt,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[i.jsx(Va,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function tM({user:s}){const e=Ro(),[n,r]=N.useState(""),[o,u]=N.useState(""),[d,p]=N.useState(""),[g,x]=N.useState(!1);N.useState(()=>{if(!s)return;(async()=>{const E=Ds(st(Ee,"shops"),fs("ownerUid","==",s.uid)),A=await Ms(E);if(!A.empty){const F=A.docs[0].data();e(`/shop/${F.slug}/dashboard`,{replace:!0})}})()},[s,e]);const b=async _=>{_.preventDefault(),p(""),x(!0);try{const A=(await H1(hl,n,o)).user,F=Ds(st(Ee,"shops"),fs("ownerUid","==",A.uid)),L=await Ms(F);if(L.empty){p("No shop found for this account. Need to create one?"),await hl.signOut(),x(!1);return}const O=L.docs[0].data();e(`/shop/${O.slug}/dashboard`,{replace:!0})}catch(E){switch(E.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":p("Invalid email or password");break;case"auth/invalid-email":p("Please enter a valid email address");break;case"auth/too-many-requests":p("Too many failed attempts. Please try again later.");break;default:p("Login failed. Please try again.")}u("")}finally{x(!1)}};return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:i.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[i.jsx("div",{className:"text-center mb-8",children:i.jsxs(rt,{to:"/",className:"inline-flex items-center gap-2.5",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:i.jsx(Ba,{className:"w-5 h-5 text-white"})}),i.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Book",i.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}),i.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),i.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),i.jsxs("form",{onSubmit:b,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),i.jsx("input",{type:"email",value:n,onChange:_=>{r(_.target.value),p("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),i.jsx("input",{type:"password",value:o,onChange:_=>{u(_.target.value),p("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${d?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),d&&i.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[i.jsx("span",{children:""})," ",d]})]}),i.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):i.jsxs(i.Fragment,{children:["Sign In",i.jsx(nu,{className:"w-4 h-4"})]})})]}),i.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:i.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",i.jsx(rt,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsxs(rt,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[i.jsx(Va,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function nE({availableDates:s,selectedDate:e,onSelectDate:n}){const[r,o]=N.useState(new Date),u=U=>{const G=U.getFullYear(),K=U.getMonth(),fe=new Date(G,K,1),oe=new Date(G,K+1,0).getDate(),j=fe.getDay();return{daysInMonth:oe,startingDayOfWeek:j,year:G,month:K}},{daysInMonth:d,startingDayOfWeek:p,year:g,month:x}=u(r),b=()=>{o(new Date(r.getFullYear(),r.getMonth()-1))},_=()=>{o(new Date(r.getFullYear(),r.getMonth()+1))},E=U=>{const G=`${g}-${String(x+1).padStart(2,"0")}-${String(U).padStart(2,"0")}`;return s.includes(G)},A=U=>`${g}-${String(x+1).padStart(2,"0")}-${String(U).padStart(2,"0")}`===e,F=U=>{if(E(U)){const G=`${g}-${String(x+1).padStart(2,"0")}-${String(U).padStart(2,"0")}`;n(G)}},L=["January","February","March","April","May","June","July","August","September","October","November","December"],O=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return i.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-5 sm:p-6 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-5",children:[i.jsx("button",{onClick:b,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:i.jsx(Q2,{className:"w-5 h-5 text-slate-600"})}),i.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[L[x]," ",g]}),i.jsx("button",{onClick:_,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:i.jsx(Sf,{className:"w-5 h-5 text-slate-600"})})]}),i.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:O.map(U=>i.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:U},U))}),i.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:p}).map((U,G)=>i.jsx("div",{},`empty-${G}`)),Array.from({length:d}).map((U,G)=>{const K=G+1,fe=E(K),he=A(K),oe=new Date,j=oe.getDate()===K&&oe.getMonth()===x&&oe.getFullYear()===g;return i.jsxs("button",{onClick:()=>F(K),disabled:!fe,className:`
                relative p-2.5 sm:p-3 text-center rounded-lg text-sm font-semibold transition-all duration-200
                ${he?"bg-blue-600 text-white shadow-md shadow-blue-600/30":fe?"bg-emerald-50 text-emerald-700 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-300 cursor-pointer":j?"text-slate-900 font-bold":"text-slate-300 cursor-not-allowed"}
              `,children:[K,j&&!he&&i.jsx("span",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]},K)})]}),i.jsxs("div",{className:"mt-4 flex gap-5 text-xs text-slate-500",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 bg-emerald-50 border border-emerald-200 rounded"}),i.jsx("span",{children:"Available"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded"}),i.jsx("span",{children:"Selected"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-1 h-1 bg-blue-500 rounded-full"}),i.jsx("span",{children:"Today"})]})]})]})}const nM=[{key:"monday",label:"Mon"},{key:"tuesday",label:"Tue"},{key:"wednesday",label:"Wed"},{key:"thursday",label:"Thu"},{key:"friday",label:"Fri"},{key:"saturday",label:"Sat"},{key:"sunday",label:"Sun"}],N_=[{key:"morning",label:"Morning (9AM12PM)",start:"09:00",end:"12:00"},{key:"afternoon",label:"Afternoon (12PM5PM)",start:"12:00",end:"17:00"},{key:"evening",label:"Evening (5PM9PM)",start:"17:00",end:"21:00"},{key:"any",label:"Any time",start:"00:00",end:"23:59"}];function sM(){const s="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="WL";for(let n=0;n<4;n++)e+=s.charAt(Math.floor(Math.random()*s.length));return e}function E_({shopId:s,slug:e,selectedService:n,selectedStaff:r,staffMembers:o,preferredDate:u,onSuccess:d,onCancel:p}){const[g,x]=N.useState({name:"",email:"",phone:""}),[b,_]=N.useState([]),[E,A]=N.useState("any"),[F,L]=N.useState(!1),[O,U]=N.useState(!1),[G,K]=N.useState(""),fe=oe=>{_(j=>j.includes(oe)?j.filter(T=>T!==oe):[...j,oe])},he=async oe=>{oe.preventDefault(),L(!0);try{const j=sM(),T=N_.find(z=>z.key===E),R=r&&r!=="any"?r.id:"any",V=r&&r!=="any"?r.name:"Any Available",M={clientName:g.name,clientEmail:g.email,clientPhone:g.phone,serviceId:n?.id||null,serviceName:n?.name||"Any Service",staffId:R,staffName:V,preferredDate:u||null,preferredDays:b.length>0?b:null,preferredTimeRange:T?{start:T.start,end:T.end}:null,status:"waiting",refCode:j,createdAt:new Date().toISOString(),notifiedAt:null,notifiedSlot:null};await yr(st(Ee,"shops",s,"waitlist"),M),K(j),U(!0),d&&d(j)}catch(j){console.error("Waitlist error:",j)}finally{L(!1)}};return O?i.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg shadow-blue-100/50 p-8 text-center animate-scale-in",children:[i.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Is,{className:"w-8 h-8 text-blue-600"})}),i.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"You're on the Waitlist!"}),i.jsxs("p",{className:"text-slate-600 mb-4",children:["We'll notify you when a slot opens up",n?` for ${n.name}`:"","."]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your waitlist reference"}),i.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:G})]}),i.jsxs("a",{href:`#/shop/${e}/waitlist/${G}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[i.jsx(Dn,{className:"w-4 h-4"}),"Check Waitlist Status"]}),i.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to check your position and get notified"})]}):i.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg p-6 animate-fade-in",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:i.jsx(Yh,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Join the Waitlist"}),i.jsx("p",{className:"text-sm text-slate-500",children:"We'll notify you when a slot opens up"})]})]}),i.jsxs("form",{onSubmit:he,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),i.jsx("input",{type:"text",value:g.name,onChange:oe=>x({...g,name:oe.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),i.jsx("input",{type:"email",value:g.email,onChange:oe=>x({...g,email:oe.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),i.jsx("input",{type:"tel",value:g.phone,onChange:oe=>x({...g,phone:oe.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["Preferred Days ",i.jsx("span",{className:"text-slate-400 font-normal",children:"(optional)"})]}),i.jsx("div",{className:"flex flex-wrap gap-2",children:nM.map(oe=>i.jsx("button",{type:"button",onClick:()=>fe(oe.key),className:`px-3.5 py-2 rounded-lg text-sm font-semibold transition-all border ${b.includes(oe.key)?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:oe.label},oe.key))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preferred Time"}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:N_.map(oe=>i.jsx("button",{type:"button",onClick:()=>A(oe.key),className:`px-3.5 py-2.5 rounded-lg text-sm font-medium transition-all border text-left ${E===oe.key?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:oe.label},oe.key))})]}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsx("button",{type:"submit",disabled:F,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:F?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Joining"]}):i.jsxs(i.Fragment,{children:[i.jsx(Yh,{className:"w-4 h-4"}),"Join Waitlist"]})}),p&&i.jsx("button",{type:"button",onClick:p,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]})}function aM(){return i.jsxs("div",{className:"flex items-end gap-2 mb-3",children:[i.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:i.jsx(Kh,{className:"w-3.5 h-3.5 text-white"})}),i.jsx("div",{className:"bg-slate-100 rounded-2xl rounded-bl-md px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),i.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),i.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})}function rM({message:s,onSelectService:e,onQuickReply:n}){const r=s.sender==="bot";return i.jsxs("div",{className:`flex items-end gap-2 mb-3 ${r?"":"flex-row-reverse"}`,children:[r&&i.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:i.jsx(Kh,{className:"w-3.5 h-3.5 text-white"})}),i.jsxs("div",{className:"max-w-[85%] space-y-2",children:[i.jsx("div",{className:`px-4 py-2.5 text-sm leading-relaxed whitespace-pre-line ${r?"bg-slate-100 text-slate-800 rounded-2xl rounded-bl-md":"bg-blue-600 text-white rounded-2xl rounded-br-md"}`,children:s.text}),s.serviceCards&&s.serviceCards.length>0&&i.jsx("div",{className:"space-y-1.5",children:s.serviceCards.map(o=>i.jsxs("button",{onClick:()=>e(o),className:"w-full flex items-center justify-between gap-2 px-3.5 py-2.5 bg-white border border-slate-200 hover:border-blue-400 rounded-xl text-left transition-all hover:shadow-sm group",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("p",{className:"text-sm font-semibold text-slate-800 group-hover:text-blue-700 truncate",children:o.name}),i.jsxs("p",{className:"text-xs text-slate-500",children:[Nh(o.duration),"  ",Og(o.price)]})]}),i.jsxs("span",{className:"text-xs font-semibold text-blue-600 whitespace-nowrap flex items-center gap-0.5",children:["Book ",i.jsx(Sf,{className:"w-3 h-3"})]})]},o.id))}),s.quickReplies&&s.quickReplies.length>0&&i.jsx("div",{className:"flex flex-wrap gap-1.5 pt-1",children:s.quickReplies.map((o,u)=>i.jsx("button",{onClick:()=>n(o),className:"px-3 py-1.5 text-xs font-medium text-blue-600 bg-white border border-blue-200 hover:bg-blue-50 hover:border-blue-400 rounded-full transition-all",children:o},u))})]})]})}function Og(s){return s==null?"":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(s)}function Nh(s){if(!s)return"";if(s<60)return`${s} min`;const e=Math.floor(s/60),n=s%60;return n?`${e}h ${n}m`:`${e} hour${e>1?"s":""}`}function iM(s,{services:e,staffMembers:n,shop:r}){const o=s.toLowerCase().trim(),u=r?.name||"our shop";if(/^(hi|hello|hey|howdy|sup|yo|hiya|good\s*(morning|afternoon|evening))/.test(o))return{text:`Hi!  I'm here to help you book an appointment at ${u}. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]};if(/how (do i|to|can i) book|help.*(book|appoint)|booking help/i.test(o))return{text:`Booking is easy! Here's how:

1 Choose a service
2 Pick your stylist
3 Select a date & time
4 Fill in your details

That's it! Would you like to start?`,quickReplies:["View Services","View Staff"]};if(/what (services|do you offer)|menu|prices|how much|service list|your services/i.test(o)||o==="view services")return!e||e.length===0?{text:"We don't have any services listed right now. Please check back later!"}:{text:`Here are our services:

${e.map(p=>` ${p.name}  ${Nh(p.duration)}  ${Og(p.price)}`).join(`
`)}

Would you like to book one of these? Just tap below! `,serviceCards:e};if(e&&e.length>0){const d=e.find(p=>{const g=p.name.toLowerCase();return o.includes(g)||g.includes(o)});if(d&&o.length>2)return{text:`Great choice! Here are the details for **${d.name}**:

 Duration: ${Nh(d.duration)}
 Price: ${Og(d.price)}${d.description?`
 ${d.description}`:""}

Would you like to book this service? Tap "Book" below!`,serviceCards:[d],quickReplies:["View All Services","View Staff"]}}if(/how long|how much time|duration/i.test(o))return!e||e.length===0?{text:"No services are listed right now. Check back soon!"}:{text:`Here's how long each service takes:

${e.map(p=>` ${p.name}: ${Nh(p.duration)}`).join(`
`)}`,quickReplies:["View Services","How to Book"]};if(/who works|stylists?|staff|team|barber|who('s| is) (here|available)|your (team|people)/i.test(o)||o==="view staff")return!n||n.length===0?{text:"We don't have any team members listed right now."}:{text:`Meet our team! 

${n.map(p=>{let g=` ${p.name}`;return p.role&&(g+=`  ${p.role}`),p.bio&&(g+=`
  "${p.bio.slice(0,80)}${p.bio.length>80?"":""}"`),g}).join(`
`)}

You can pick your preferred stylist during booking.`,quickReplies:["View Services","How to Book"]};if(/available|open slot|when can i|next available|free slot|any opening/i.test(o)){const d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],p=new Set;return n&&n.length>0&&n.forEach(x=>{x.weeklyHours&&Object.entries(x.weeklyHours).forEach(([b,_])=>{_&&_.enabled&&p.add(b)})}),{text:`You can check available times by selecting a service and date in the booking flow above. We're generally available on ${p.size>0?[...p].sort((x,b)=>d.indexOf(x)-d.indexOf(b)).join(", "):"most days"}. `,quickReplies:["View Services","How to Book"]}}if(/hours|when are you open|business hours|open hours|what time|operating/i.test(o)){const d=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],p={};if(n&&n.length>0&&n.forEach(g=>{g.weeklyHours&&Object.entries(g.weeklyHours).forEach(([x,b])=>{b&&b.enabled&&b.start&&b.end&&(p[x]?(b.start<p[x].start&&(p[x].start=b.start),b.end>p[x].end&&(p[x].end=b.end)):p[x]={start:b.start,end:b.end})})}),Object.keys(p).length>0){const g=b=>{const[_,E]=b.split(":"),A=parseInt(_),F=A>=12?"PM":"AM";return`${A%12||12}:${E} ${F}`};return{text:`Here are our general hours:

${d.filter(b=>p[b]).map(b=>` ${b}: ${g(p[b].start)}  ${g(p[b].end)}`).join(`
`)}

Hours may vary by stylist. Select a service to see exact availability.`,quickReplies:["View Services","View Staff"]}}return{text:"Our hours vary by stylist. You can see exact availability by selecting a service above.",quickReplies:["View Services","How to Book"]}}return/phone|address|contact|where|location|email|reach/i.test(o)?{text:"For contact information, please reach out to the shop directly. You can also find us through the booking confirmation email after you book! ",quickReplies:["View Services","How to Book"]}:/cancel|reschedule|change my (booking|appointment)|modify/i.test(o)?{text:"You can manage your booking using the reference code you received. Go to your confirmation email and click 'Manage Booking' to reschedule or cancel. ",quickReplies:["How to Book","View Services"]}:/waitlist|no availability|fully booked|no slots|all booked|sold out/i.test(o)?{text:"If there are no available slots, you can join our waitlist and we'll notify you when something opens up! Look for the 'Join Waitlist' button when viewing available times. ",quickReplies:["View Services","How to Book"]}:/^(thanks?|thank you|thx|ty|cheers|appreciate)/i.test(o)?{text:"You're welcome!  Let me know if you need anything else.",quickReplies:["View Services","View Staff","How to Book"]}:{text:"I'm not sure about that. You can browse our services above, or try asking about our services, staff, or availability! ",quickReplies:["View Services","View Staff","How to Book"]}}function lM({services:s,staffMembers:e,shop:n,onSelectService:r}){const[o,u]=N.useState(!1),[d,p]=N.useState([]),[g,x]=N.useState(""),[b,_]=N.useState(!1),[E,A]=N.useState(!1),[F,L]=N.useState(!1),[O,U]=N.useState(!1),G=N.useRef(null),K=N.useRef(null),fe=n?.name||"our shop";N.useEffect(()=>{G.current?.scrollIntoView({behavior:"smooth"})},[d,b]),N.useEffect(()=>{const M=setTimeout(()=>{!o&&!O&&L(!0)},3e3),z=setTimeout(()=>{E||(A(!0),L(!1),u(!0),p([{id:"welcome",sender:"bot",text:`Hi!  Welcome to ${fe}. I can help you find the right service and book an appointment. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]}]))},5e3);return()=>{clearTimeout(M),clearTimeout(z)}},[]),N.useEffect(()=>{o&&setTimeout(()=>K.current?.focus(),100)},[o]);const he=N.useCallback(()=>{L(!1),U(!0),u(!0),d.length===0&&p([{id:"welcome",sender:"bot",text:`Hi!  Welcome to ${fe}. I can help you find the right service and book an appointment. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]}])},[d.length,fe]),oe=N.useCallback(M=>{_(!0);const z=400+Math.random()*600;setTimeout(()=>{const I=iM(M,{services:s,staffMembers:e,shop:n});p(q=>[...q,{id:`bot-${Date.now()}`,sender:"bot",text:I.text,serviceCards:I.serviceCards||null,quickReplies:I.quickReplies||null}]),_(!1)},z)},[s,e,n]),j=N.useCallback(()=>{const M=g.trim();M&&(p(z=>[...z,{id:`user-${Date.now()}`,sender:"user",text:M}]),x(""),oe(M))},[g,oe]),T=N.useCallback(M=>{p(z=>[...z,{id:`user-${Date.now()}`,sender:"user",text:M}]),oe(M)},[oe]),R=N.useCallback(M=>{r&&(r(M),p(z=>[...z,{id:`bot-${Date.now()}`,sender:"bot",text:`Great! I've selected "${M.name}" for you. You can now pick your stylist and time above. `}]),setTimeout(()=>u(!1),1500))},[r]),V=M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),j())};return i.jsxs(i.Fragment,{children:[F&&!o&&i.jsxs("div",{className:"fixed bottom-24 right-5 z-50 animate-fade-in",children:[i.jsx("button",{onClick:he,className:"bg-white border border-slate-200 shadow-lg rounded-2xl rounded-br-md px-4 py-3 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all max-w-[220px]",children:"Need help booking? "}),i.jsx("button",{onClick:()=>{L(!1),U(!0)},className:"absolute -top-2 -right-2 w-5 h-5 bg-slate-200 hover:bg-slate-300 rounded-full flex items-center justify-center text-slate-500 transition-colors",children:i.jsx(La,{className:"w-3 h-3"})})]}),o&&i.jsxs("div",{className:`fixed bottom-20 right-5 z-50 bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden animate-scale-in
                     w-[calc(100vw-2.5rem)] max-w-[380px] h-[min(500px,calc(100vh-7rem))]
                     sm:w-[380px] sm:right-5 sm:bottom-20`,style:{transformOrigin:"bottom right"},children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:i.jsx(Kh,{className:"w-4 h-4"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-bold leading-tight",children:"BookFlow Assistant"}),i.jsx("p",{className:"text-[11px] text-blue-100",children:"Ask me anything about booking"})]})]}),i.jsx("button",{onClick:()=>u(!1),className:"w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors","aria-label":"Close chat",children:i.jsx(La,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-0 bg-slate-50/50",children:[d.map(M=>i.jsx(rM,{message:M,onSelectService:R,onQuickReply:T},M.id)),b&&i.jsx(aM,{}),i.jsx("div",{ref:G})]}),i.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 border-t border-slate-200 bg-white flex-shrink-0",children:[i.jsx("input",{ref:K,type:"text",value:g,onChange:M=>x(M.target.value),onKeyDown:V,placeholder:"Type a message",className:"flex-1 px-3.5 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder:text-slate-400"}),i.jsx("button",{onClick:j,disabled:!g.trim(),className:"w-10 h-10 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-200 disabled:cursor-not-allowed text-white disabled:text-slate-400 rounded-xl flex items-center justify-center transition-all flex-shrink-0","aria-label":"Send message",children:i.jsx(_h,{className:"w-4 h-4"})})]})]}),i.jsx("button",{onClick:()=>{o?u(!1):he()},className:`fixed bottom-5 right-5 z-50 w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 hover:scale-105 hover:shadow-xl ${o?"bg-slate-700 hover:bg-slate-800":"bg-blue-600 hover:bg-blue-700 chat-bubble-pulse"}`,"aria-label":o?"Close chat assistant":"Open chat assistant",children:o?i.jsx(La,{className:"w-6 h-6 text-white"}):i.jsx(Kh,{className:"w-6 h-6 text-white"})})]})}var Kp={exports:{}},Qp,S_;function oM(){if(S_)return Qp;S_=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Qp=s,Qp}var Xp,j_;function cM(){if(j_)return Xp;j_=1;var s=oM();function e(){}function n(){}return n.resetWarningCache=e,Xp=function(){function r(d,p,g,x,b,_){if(_!==s){var E=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw E.name="Invariant Violation",E}}r.isRequired=r;function o(){return r}var u={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:o,element:r,elementType:r,instanceOf:o,node:r,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:n,resetWarningCache:e};return u.PropTypes=u,u},Xp}var T_;function uM(){return T_||(T_=1,Kp.exports=cM()()),Kp.exports}var dM=uM();const Ht=Lg(dM);function A_(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),n.push.apply(n,r)}return n}function C_(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?A_(Object(n),!0).forEach(function(r){sE(s,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):A_(Object(n)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(n,r))})}return s}function Eh(s){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Eh=function(e){return typeof e}:Eh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eh(s)}function sE(s,e,n){return e in s?Object.defineProperty(s,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[e]=n,s}function hM(s,e){if(s==null)return{};var n={},r=Object.keys(s),o,u;for(u=0;u<r.length;u++)o=r[u],!(e.indexOf(o)>=0)&&(n[o]=s[o]);return n}function fM(s,e){if(s==null)return{};var n=hM(s,e),r,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(s);for(o=0;o<u.length;o++)r=u[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(s,r)&&(n[r]=s[r])}return n}function aE(s,e){return mM(s)||pM(s,e)||gM(s,e)||xM()}function mM(s){if(Array.isArray(s))return s}function pM(s,e){var n=s&&(typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"]);if(n!=null){var r=[],o=!0,u=!1,d,p;try{for(n=n.call(s);!(o=(d=n.next()).done)&&(r.push(d.value),!(e&&r.length===e));o=!0);}catch(g){u=!0,p=g}finally{try{!o&&n.return!=null&&n.return()}finally{if(u)throw p}}return r}}function gM(s,e){if(s){if(typeof s=="string")return R_(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R_(s,e)}}function R_(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=s[n];return r}function xM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var es=function(e,n,r){var o=!!r,u=$t.useRef(r);$t.useEffect(function(){u.current=r},[r]),$t.useEffect(function(){if(!o||!e)return function(){};var d=function(){u.current&&u.current.apply(u,arguments)};return e.on(n,d),function(){e.off(n,d)}},[o,n,e,u])},Pg=function(e){var n=$t.useRef(e);return $t.useEffect(function(){n.current=e},[e]),n.current},To=function(e){return e!==null&&Eh(e)==="object"},bM=function(e){return To(e)&&typeof e.then=="function"},yM=function(e){return To(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},k_="[object Object]",vM=function s(e,n){if(!To(e)||!To(n))return e===n;var r=Array.isArray(e),o=Array.isArray(n);if(r!==o)return!1;var u=Object.prototype.toString.call(e)===k_,d=Object.prototype.toString.call(n)===k_;if(u!==d)return!1;if(!u&&!r)return e===n;var p=Object.keys(e),g=Object.keys(n);if(p.length!==g.length)return!1;for(var x={},b=0;b<p.length;b+=1)x[p[b]]=!0;for(var _=0;_<g.length;_+=1)x[g[_]]=!0;var E=Object.keys(x);if(E.length!==p.length)return!1;var A=e,F=n,L=function(U){return s(A[U],F[U])};return E.every(L)},rE=function(e,n,r){return To(e)?Object.keys(e).reduce(function(o,u){var d=!To(n)||!vM(e[u],n[u]);return r.includes(u)?(d&&console.warn("Unsupported prop change: options.".concat(u," is not a mutable property.")),o):d?C_(C_({},o||{}),{},sE({},u,e[u])):o},null):null},iE="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",I_=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iE;if(e===null||yM(e))return e;throw new Error(n)},wM=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iE;if(bM(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(o){return I_(o,n)})};var r=I_(e,n);return r===null?{tag:"empty"}:{tag:"sync",stripe:r}},_M=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.6.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.6.0",url:"https://stripe.com/docs/stripe-js/react"}))},jf=$t.createContext(null);jf.displayName="ElementsContext";var lE=function(e,n){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(n," in an <Elements> provider."));return e},oE=function(e){var n=e.stripe,r=e.options,o=e.children,u=$t.useMemo(function(){return wM(n)},[n]),d=$t.useState(function(){return{stripe:u.tag==="sync"?u.stripe:null,elements:u.tag==="sync"?u.stripe.elements(r):null}}),p=aE(d,2),g=p[0],x=p[1];$t.useEffect(function(){var E=!0,A=function(L){x(function(O){return O.stripe?O:{stripe:L,elements:L.elements(r)}})};return u.tag==="async"&&!g.stripe?u.stripePromise.then(function(F){F&&E&&A(F)}):u.tag==="sync"&&!g.stripe&&A(u.stripe),function(){E=!1}},[u,g,r]);var b=Pg(n);$t.useEffect(function(){b!==null&&b!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[b,n]);var _=Pg(r);return $t.useEffect(function(){if(g.elements){var E=rE(r,_,["clientSecret","fonts"]);E&&g.elements.update(E)}},[r,_,g.elements]),$t.useEffect(function(){_M(g.stripe)},[g.stripe]),$t.createElement(jf.Provider,{value:g},o)};oE.propTypes={stripe:Ht.any,options:Ht.object};var NM=function(e){var n=$t.useContext(jf);return lE(n,e)},EM=function(){var e=NM("calls useElements()"),n=e.elements;return n};Ht.func.isRequired;var cE=$t.createContext(null);cE.displayName="CheckoutContext";Ht.any,Ht.shape({clientSecret:Ht.oneOfType([Ht.string,Ht.instanceOf(Promise)]).isRequired,elementsOptions:Ht.object}).isRequired;var Vg=function(e){var n=$t.useContext(cE),r=$t.useContext(jf);if(n){if(r)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return n}else return lE(r,e)},SM=["mode"],jM=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},gs=function(e,n){var r="".concat(jM(e),"Element"),o=function(g){var x=g.id,b=g.className,_=g.options,E=_===void 0?{}:_,A=g.onBlur,F=g.onFocus,L=g.onReady,O=g.onChange,U=g.onEscape,G=g.onClick,K=g.onLoadError,fe=g.onLoaderStart,he=g.onNetworksChange,oe=g.onConfirm,j=g.onCancel,T=g.onShippingAddressChange,R=g.onShippingRateChange,V=g.onSavedPaymentMethodRemove,M=g.onSavedPaymentMethodUpdate,z=Vg("mounts <".concat(r,">")),I="elements"in z?z.elements:null,q="checkoutState"in z?z.checkoutState:null,D=q?.type==="success"||q?.type==="loading"?q.sdk:null,k=$t.useState(null),Y=aE(k,2),ie=Y[0],Te=Y[1],ve=$t.useRef(null),P=$t.useRef(null);es(ie,"blur",A),es(ie,"focus",F),es(ie,"escape",U),es(ie,"click",G),es(ie,"loaderror",K),es(ie,"loaderstart",fe),es(ie,"networkschange",he),es(ie,"confirm",oe),es(ie,"cancel",j),es(ie,"shippingaddresschange",T),es(ie,"shippingratechange",R),es(ie,"savedpaymentmethodremove",V),es(ie,"savedpaymentmethodupdate",M),es(ie,"change",O);var ee;L&&(e==="expressCheckout"?ee=L:ee=function(){L(ie)}),es(ie,"ready",ee),$t.useLayoutEffect(function(){if(ve.current===null&&P.current!==null&&(I||D)){var xe=null;if(D)switch(e){case"paymentForm":xe=D.createPaymentFormElement(E);break;case"payment":xe=D.createPaymentElement(E);break;case"address":if("mode"in E){var be=E.mode,Re=fM(E,SM);if(be==="shipping")xe=D.createShippingAddressElement(Re);else if(be==="billing")xe=D.createBillingAddressElement(Re);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":xe=D.createExpressCheckoutElement(E);break;case"currencySelector":xe=D.createCurrencySelectorElement();break;case"taxId":xe=D.createTaxIdElement(E);break;default:throw new Error("Invalid Element type ".concat(r,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else I&&(xe=I.create(e,E));ve.current=xe,Te(xe),xe&&xe.mount(P.current)}},[I,D,E]);var le=Pg(E);return $t.useEffect(function(){if(ve.current){var xe=rE(E,le,["paymentRequest"]);xe&&"update"in ve.current&&ve.current.update(xe)}},[E,le]),$t.useLayoutEffect(function(){return function(){if(ve.current&&typeof ve.current.destroy=="function")try{ve.current.destroy(),ve.current=null}catch{}}},[]),$t.createElement("div",{id:x,className:b,ref:P})},u=function(g){Vg("mounts <".concat(r,">"));var x=g.id,b=g.className;return $t.createElement("div",{id:x,className:b})},d=n?u:o;return d.propTypes={id:Ht.string,className:Ht.string,onChange:Ht.func,onBlur:Ht.func,onFocus:Ht.func,onReady:Ht.func,onEscape:Ht.func,onClick:Ht.func,onLoadError:Ht.func,onLoaderStart:Ht.func,onNetworksChange:Ht.func,onConfirm:Ht.func,onCancel:Ht.func,onShippingAddressChange:Ht.func,onShippingRateChange:Ht.func,onSavedPaymentMethodRemove:Ht.func,onSavedPaymentMethodUpdate:Ht.func,options:Ht.object},d.displayName=r,d.__elementType=e,d},xs=typeof window>"u",TM=$t.createContext(null);TM.displayName="EmbeddedCheckoutProviderContext";var AM=function(){var e=Vg("calls useStripe()"),n=e.stripe;return n};gs("auBankAccount",xs);var D_=gs("card",xs);gs("cardNumber",xs);gs("cardExpiry",xs);gs("cardCvc",xs);gs("iban",xs);gs("payment",xs);gs("expressCheckout",xs);gs("paymentRequestButton",xs);gs("linkAuthentication",xs);gs("address",xs);gs("shippingAddress",xs);gs("paymentMethodMessaging",xs);gs("taxId",xs);function Sh(s){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Sh=function(e){return typeof e}:Sh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sh(s)}var uE="clover",CM=function(e){return e===3?"v3":e},dE="https://js.stripe.com",RM="".concat(dE,"/").concat(uE,"/stripe.js"),kM=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,IM=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var DM=function(e){return kM.test(e)||IM.test(e)},MM=function(){for(var e=document.querySelectorAll('script[src^="'.concat(dE,'"]')),n=0;n<e.length;n++){var r=e[n];if(DM(r.src))return r}return null},M_=function(e){var n="",r=document.createElement("script");r.src="".concat(RM).concat(n);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(r),r},OM=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.7.0",startTime:n})},Uc=null,ih=null,lh=null,PM=function(e){return function(n){e(new Error("Failed to load Stripe.js",{cause:n}))}},VM=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},LM=function(e){return Uc!==null?Uc:(Uc=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var o=MM();if(!(o&&e)){if(!o)o=M_(e);else if(o&&lh!==null&&ih!==null){var u;o.removeEventListener("load",lh),o.removeEventListener("error",ih),(u=o.parentNode)===null||u===void 0||u.removeChild(o),o=M_(e)}}lh=VM(n,r),ih=PM(r),o.addEventListener("load",lh),o.addEventListener("error",ih)}catch(d){r(d);return}}),Uc.catch(function(n){return Uc=null,Promise.reject(n)}))},UM=function(e,n,r){if(e===null)return null;var o=n[0];if(typeof o!="string")throw new Error("Expected publishable key to be of type string, got type ".concat(Sh(o)," instead."));var u=o.match(/^pk_test/),d=CM(e.version),p=uE;u&&d!==p&&console.warn("Stripe.js@".concat(d," was loaded on the page, but @stripe/stripe-js@").concat("8.7.0"," expected Stripe.js@").concat(p,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var g=e.apply(void 0,n);return OM(g,r),g},Bc,hE=!1,fE=function(){return Bc||(Bc=LM(null).catch(function(e){return Bc=null,Promise.reject(e)}),Bc)};Promise.resolve().then(function(){return fE()}).catch(function(s){hE||console.warn(s)});var BM=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];hE=!0;var o=Date.now();return fE().then(function(u){return UM(u,n,o)})};const zM=BM("pk_test_51NXZytLhwB1Jyzw82kEuknbGp3F4vTdnqmBrVmzsHqKYeldrpbiWInM6U2v2ojnsLW4u251zbpRk2UiXnwBgiQZo00bK99q5kj"),qM={style:{base:{fontSize:"16px",color:"#1e293b",fontFamily:"system-ui, -apple-system, sans-serif","::placeholder":{color:"#94a3b8"}},invalid:{color:"#ef4444",iconColor:"#ef4444"}}};function FM({amount:s,onSuccess:e,onCancel:n,clientInfo:r,serviceName:o}){const u=AM(),d=EM(),[p,g]=N.useState(!1),[x,b]=N.useState(null),[_,E]=N.useState(!1),A=async L=>{if(L.preventDefault(),!u||!d)return;g(!0),b(null);const O=d.getElement(D_),{error:U,paymentMethod:G}=await u.createPaymentMethod({type:"card",card:O,billing_details:{name:r.name,email:r.email,phone:r.phone}});if(U){b(U.message),g(!1);return}console.log("Payment method created:",G.id),await new Promise(K=>setTimeout(K,1e3)),g(!1),e({paymentMethodId:G.id,last4:G.card.last4,brand:G.card.brand})},F=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L/100);return i.jsxs("form",{onSubmit:A,className:"space-y-5",children:[i.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 rounded-xl p-5 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-emerald-100 text-sm font-medium",children:["Deposit for ",o]}),i.jsx("p",{className:"text-3xl font-bold mt-1",children:F(s)})]}),i.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:i.jsx(yo,{className:"w-6 h-6"})})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Card Details"}),i.jsx("div",{className:"p-4 border-2 border-slate-200 rounded-xl focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-500/20 transition-all bg-white",children:i.jsx(D_,{options:qM,onChange:L=>{E(L.complete),L.error?b(L.error.message):b(null)}})})]}),x&&i.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:[i.jsx(y_,{className:"w-4 h-4 flex-shrink-0"}),x]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[i.jsx(Wh,{className:"w-3.5 h-3.5"}),i.jsx("span",{children:"Your payment is secured with 256-bit encryption"})]}),i.jsxs("div",{className:"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-700",children:[i.jsx(y_,{className:"w-4 h-4 flex-shrink-0"}),i.jsxs("span",{children:[i.jsx("strong",{children:"Test Mode:"})," Use card number ",i.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"4242 4242 4242 4242"})," with any future date and CVC."]})]}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsx("button",{type:"submit",disabled:p||!u||!_,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold shadow-md shadow-emerald-600/20 hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:p?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Processing"]}):i.jsxs(i.Fragment,{children:[i.jsx(Wh,{className:"w-4 h-4"}),"Pay ",F(s)]})}),i.jsx("button",{type:"button",onClick:n,disabled:p,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 disabled:opacity-50",children:"Back"})]})]})}function HM({amount:s,onSuccess:e,onCancel:n,clientInfo:r,serviceName:o}){return i.jsx(oE,{stripe:zM,children:i.jsx(FM,{amount:s,onSuccess:e,onCancel:n,clientInfo:r,serviceName:o})})}const $M=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function fo(s){const[e,n]=s.split(":").map(Number);return e*60+n}function O_(s){const e=Math.floor(s/60),n=s%60;return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function GM(s){const e=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0");return`${e}-${n}-${r}`}function YM(s,e,n,r,o,u){if(!s)return[];const p=new Date(e+"T12:00:00").getDay(),g=$M[p],x=s[g];if(!x||!x.enabled)return[];const b=fo(x.start),_=fo(x.end),E=x.break?fo(x.break.start):null,A=x.break?fo(x.break.end):null,F=n+r,L=[];let O=b;for(;O+n<=_;){const U=O+n;if(E!==null&&A!==null&&O<A&&U>E){O=A;continue}L.push({id:`wh-${o}-${e}-${O_(O)}`,date:e,time:O_(O),duration:n,available:!0,staffId:o,staffName:u,generated:!0}),O+=F}return L}function mE(s,e,n=0,r=4){const o=[],u=new Date;u.setHours(0,0,0,0);const d=new Date(u);d.setDate(d.getDate()+r*7);for(const p of s){if(!p.weeklyHours)continue;const g=new Date(u);for(;g<d;){const x=GM(g),b=YM(p.weeklyHours,x,e,n,p.id,p.name);o.push(...b),g.setDate(g.getDate()+1)}}return o}function pE(s,e,n=0){const r=e.filter(o=>!o.status||o.status==="pending"||o.status==="confirmed");return s.filter(o=>{const u=fo(o.time),d=u+o.duration;return!r.some(g=>{if(o.staffId&&g.staffId&&g.staffId!==o.staffId||g.date!==o.date)return!1;const x=fo(g.time),b=g.serviceDuration||g.duration||o.duration,_=x+b;return!(d+n<=x||_+n<=u)})})}function gE(s,e){const n=new Set(e.map(o=>`${o.staffId||""}-${o.date}-${o.time}`)),r=s.filter(o=>{const u=`${o.staffId||""}-${o.date}-${o.time}`;return!n.has(u)});return[...e,...r]}function Wc({name:s,className:e="w-12 h-12",bgClass:n="bg-blue-100 text-blue-700"}){const r=(s||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return i.jsx("div",{className:`${e} ${n} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:r||"?"})}function WM(){return i.jsxs(rt,{to:"/",className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:i.jsx(Ba,{className:"w-3.5 h-3.5 text-white"})}),i.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Book",i.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}function KM({member:s,onClose:e}){const[n,r]=N.useState(null),o=s.portfolio||[];return N.useEffect(()=>{const u=d=>{d.key==="Escape"&&(n!==null?r(null):e())};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[n,e]),i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in",children:[i.jsx("button",{onClick:e,className:"absolute top-4 right-4 w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center text-slate-600 transition-all z-10",children:i.jsx(X,{className:"w-4 h-4"})}),i.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(Wc,{name:s.name,className:"w-14 h-14",bgClass:"bg-violet-100 text-violet-700"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-slate-900",children:s.name}),s.role&&i.jsx("p",{className:"text-sm text-violet-600 font-medium",children:s.role})]})]}),s.bio&&i.jsx("p",{className:"mt-3 text-sm text-slate-600 leading-relaxed",children:s.bio})]}),i.jsx("div",{className:"p-6",children:o.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:i.jsx(Image,{className:"w-6 h-6 text-slate-400"})}),i.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet"})]}):i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:o.map((u,d)=>i.jsxs("button",{onClick:()=>r(d),className:"group relative aspect-square rounded-xl overflow-hidden bg-slate-100 shadow-sm hover:shadow-md transition-all hover:-translate-y-0.5",children:[i.jsx("img",{src:u.url,alt:u.caption||"Portfolio",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),u.caption&&i.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/70 to-transparent p-2.5 pt-6",children:i.jsx("p",{className:"text-xs text-white font-medium truncate",children:u.caption})})]},d))})})]}),n!==null&&o[n]&&i.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/90",children:[i.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:i.jsx(X,{className:"w-5 h-5"})}),n>0&&i.jsx("button",{onClick:()=>r(n-1),className:"absolute left-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:i.jsx(ChevronLeft,{className:"w-5 h-5"})}),n<o.length-1&&i.jsx("button",{onClick:()=>r(n+1),className:"absolute right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:i.jsx(ChevronRight,{className:"w-5 h-5"})}),i.jsxs("div",{className:"max-w-4xl max-h-[85vh] flex flex-col items-center",children:[i.jsx("img",{src:o[n].url,alt:o[n].caption||"Portfolio",className:"max-w-full max-h-[75vh] object-contain rounded-lg"}),o[n].caption&&i.jsx("p",{className:"mt-3 text-sm text-white/90 font-medium text-center px-4",children:o[n].caption}),i.jsxs("p",{className:"mt-1 text-xs text-white/50",children:[n+1," / ",o.length]})]})]})]})}function QM(){const{slug:s}=ko(),[e,n]=N.useState(null),[r,o]=N.useState(null),[u,d]=N.useState(!0),[p,g]=N.useState(!1),[x,b]=N.useState([]),[_,E]=N.useState([]),[A,F]=N.useState(null),[L,O]=N.useState(null),[U,G]=N.useState([]),[K,fe]=N.useState([]),[he,oe]=N.useState(!1),[j,T]=N.useState(null),[R,V]=N.useState(null),[M,z]=N.useState(""),[I,q]=N.useState(!1),[D,k]=N.useState({name:"",email:"",phone:""}),[Y,ie]=N.useState(""),[Te,ve]=N.useState(!1),[P,ee]=N.useState(null),[le,xe]=N.useState(!1),[be,Re]=N.useState("biweekly"),[ue,Ue]=N.useState(null),[Be,We]=N.useState(!1),[Q,we]=N.useState(null);N.useEffect(()=>{(async()=>{d(!0),g(!1);try{const Se=Ds(st(Ee,"shops"),fs("slug","==",s)),Xe=await Ms(Se);if(Xe.empty)g(!0);else{const tt=Xe.docs[0];n(tt.data()),o(tt.id)}}catch(Se){console.error("Error looking up shop:",Se),g(!0)}finally{d(!1)}})()},[s]),N.useEffect(()=>{if(!r)return;const me=rn(st(Ee,"shops",r,"services"),Et=>{const Le=Et.docs.map(Ge=>({id:Ge.id,...Ge.data()})).filter(Ge=>Ge.active!==!1).sort((Ge,Dt)=>(Ge.name||"").localeCompare(Dt.name||""));b(Le)}),Se=rn(st(Ee,"shops",r,"availability"),Et=>{const Le=new Date,Ge=Et.docs.map(Dt=>({id:Dt.id,...Dt.data()})).filter(Dt=>new Date(`${Dt.date}T${Dt.time}`)>Le);G(Ge)}),Xe=rn(st(Ee,"shops",r,"bookings"),Et=>{const Le=Et.docs.map(Ge=>({id:Ge.id,...Ge.data()}));fe(Le)}),tt=rn(st(Ee,"shops",r,"staff"),Et=>{const Le=Et.docs.map(Ge=>({id:Ge.id,...Ge.data()})).filter(Ge=>Ge.active!==!1).sort((Ge,Dt)=>(Ge.name||"").localeCompare(Dt.name||""));E(Le)});return()=>{me(),Se(),Xe(),tt()}},[r]),N.useEffect(()=>{_.length===1?O(_[0]):_.length===0&&O(null)},[_]);const Ie=x.length>0;_.length>0;const He=_.length>1,Ve=e?.bufferMinutes||0,ft=N.useMemo(()=>{const me=new Date;let Se=U.filter(Le=>Le.available);if(A&&(Se=Se.filter(Le=>Le.duration>=A.duration)),L&&L!=="any"&&(Se=Se.filter(Le=>Le.staffId===L.id||!Le.staffId)),!A)return Se;const Xe=L&&L!=="any"?_.filter(Le=>Le.id===L.id):_,tt=mE(Xe,A.duration,Ve,4).filter(Le=>new Date(`${Le.date}T${Le.time}`)>me),Et=gE(tt,Se);return pE(Et,K,Ve)},[U,A,L,_,K,Ve]),Kn=(me,Se,Xe=3)=>{const tt=[],Et=new Date(me+"T12:00:00"),Le=new Date(Et);Le.setMonth(Le.getMonth()+Xe);let Ge=new Date(Et);for(Se==="weekly"?Ge.setDate(Ge.getDate()+7):Se==="biweekly"?Ge.setDate(Ge.getDate()+14):Se==="fourweekly"?Ge.setDate(Ge.getDate()+28):Se==="monthly"&&Ge.setMonth(Ge.getMonth()+1);Ge<=Le;){const Dt=Ge.getFullYear(),tn=String(Ge.getMonth()+1).padStart(2,"0"),Fn=String(Ge.getDate()).padStart(2,"0");tt.push(`${Dt}-${tn}-${Fn}`),Se==="weekly"?Ge.setDate(Ge.getDate()+7):Se==="biweekly"?Ge.setDate(Ge.getDate()+14):Se==="fourweekly"?Ge.setDate(Ge.getDate()+28):Se==="monthly"&&Ge.setMonth(Ge.getMonth()+1)}return tt},Tt=N.useMemo(()=>{if(!le||!j)return null;const me=Kn(j.date,be),Se=A?A.duration:j.duration||60,Xe=L&&L!=="any"?L.id:j.staffId,tt=j.time,Et=K.filter(dn=>!dn.status||dn.status==="pending"||dn.status==="confirmed"),Le=dn=>{const[Si,gn]=dn.split(":").map(Number);return Si*60+gn},Ge=Le(tt),Dt=Ge+Se;let tn=[],Fn=[];const ns=new Set;me.forEach(dn=>{Et.some(gn=>{if(Xe&&gn.staffId&&gn.staffId!==Xe||gn.date!==dn)return!1;const ss=Le(gn.time),nn=gn.serviceDuration||gn.duration||Se,xn=ss+nn,ys=Ve||0;return!(Dt+ys<=ss||xn+ys<=Ge)})||ns.has(dn)?Fn.push(dn):(tn.push(dn),ns.add(dn))});const Xs=me.length>0?me[me.length-1]:j.date,Ei=new Date(Xs+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),Fa={weekly:"week",biweekly:"2 weeks",fourweekly:"4 weeks",monthly:"month"};return{available:tn,conflicts:Fn,total:tn.length+1,skipped:Fn.length,endDate:Ei,intervalLabel:Fa[be]||be}},[le,be,j,A,L,K,Ve]),vt=me=>{F(me),_.length>1&&O(null),V(null),T(null),oe(!1),z("")},Ae=me=>{O(me),V(null),T(null),oe(!1),z("")},Pe=()=>{F(null),_.length>1&&O(null),V(null),T(null),oe(!1)},ut=()=>{V(null),T(null),oe(!1),He?O(null):Ie&&F(null)},Kt=me=>{T(me),oe(!0),z("")},_t=()=>{const me="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let Se="BK";for(let Xe=0;Xe<4;Xe++)Se+=me.charAt(Math.floor(Math.random()*me.length));return Se},Nt=me=>{me.preventDefault(),se?We(!0):Rt()},Tn=me=>{we(me),Rt(me)},Rt=async(me=null)=>{q(!0),Ue(null);try{const Se=_t(),Xe=e?.requireApproval?"pending":"confirmed",tt=le?`rg-${Date.now()}-${Math.random().toString(36).slice(2,8)}`:null,Et=le&&Tt?Tt.endDate:null,Le={slotId:j.id,date:j.date,time:j.time,duration:A?A.duration:j.duration,clientName:D.name,clientEmail:D.email,clientPhone:D.phone,bookedAt:new Date().toISOString(),status:Xe,refCode:Se};if(A&&(Le.serviceId=A.id,Le.serviceName=A.name,Le.servicePrice=A.price,Le.serviceDuration=A.duration,Le.depositPercent=A.depositPercent||0),me||Q){const tn=me||Q;Le.depositPaid=!0,Le.depositAmount=Ne/100,Le.paymentMethodId=tn.paymentMethodId,Le.cardLast4=tn.last4,Le.cardBrand=tn.brand}L&&L!=="any"?(Le.staffId=L.id,Le.staffName=L.name):j.staffId&&(Le.staffId=j.staffId,Le.staffName=j.staffName||""),le&&tt&&(Le.recurring=!0,Le.recurringInterval=be,Le.recurringGroupId=tt,Le.recurringUntil=Et),await yr(st(Ee,"shops",r,"bookings"),Le),j.generated||await ot(Je(Ee,"shops",r,"availability",j.id),{available:!1});let Ge=1,Dt=0;if(le&&Tt){const tn=Tt.available;Dt=Tt.skipped;for(const Fn of tn){const ns=_t(),Xs={...Le,date:Fn,slotId:`recurring-${tt}-${Fn}`,refCode:ns,bookedAt:new Date().toISOString()};await yr(st(Ee,"shops",r,"bookings"),Xs),Ge++}Ue({created:Ge,skipped:Dt})}k({name:"",email:"",phone:""}),oe(!1),We(!1),we(null),T(null),F(null),V(null),O(_.length===1?_[0]:null),xe(!1),ie(Se),e?.requireApproval?z(" Your booking request has been submitted! The shop will review and confirm it shortly."):z(" Booking confirmed! You will receive a confirmation email shortly.")}catch(Se){console.error("Booking error:",Se),z(" Something went wrong. Please try again.")}finally{q(!1)}},Qn=me=>new Date(me+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),qn=me=>{const[Se,Xe]=me.split(":"),tt=parseInt(Se),Et=tt>=12?"PM":"AM";return`${tt%12||12}:${Xe} ${Et}`},bs=me=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(me),ts=me=>{if(me<60)return`${me} min`;const Se=Math.floor(me/60),Xe=me%60;return Xe?`${Se}h ${Xe}m`:`${Se} hour${Se>1?"s":""}`};if(u)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:i.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[i.jsx("div",{className:"spinner"}),i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking page"})]})});if(p)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:i.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[i.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:i.jsx(zt,{className:"w-8 h-8 text-slate-400"})}),i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),i.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,i.jsx("span",{className:"font-mono text-blue-600",children:s}),'".']}),i.jsxs(rt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[i.jsx(Va,{className:"w-4 h-4"}),"Go Home"]})]})});const qa=[...new Set(ft.map(me=>me.date))].sort(),H=R?ft.filter(me=>me.date===R):ft,se=A&&A.depositPercent>0,Ne=se?Math.round(A.price*(A.depositPercent/100)*100):0,$e=Be?"payment":he?"form":Ie&&!A?"services":He&&!L?"staff":"calendar",et=[];Ie&&et.push({key:"services",label:"Service"}),He&&et.push({key:"staff",label:"Stylist"}),et.push({key:"calendar",label:"Date & Time"}),et.push({key:"form",label:"Details"}),se&&et.push({key:"payment",label:"Payment"});const qt=et.findIndex(me=>me.key===$e),ze=["border-l-blue-500","border-l-violet-500","border-l-emerald-500","border-l-amber-500","border-l-rose-500","border-l-cyan-500","border-l-indigo-500","border-l-pink-500","border-l-teal-500"];return i.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[i.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e.name||"")[0]?.toUpperCase()||"S"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e.name}),i.jsx("p",{className:"text-xs text-slate-500",children:"Book your appointment"})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(rt,{to:`/shop/${s}/login`,className:"flex items-center gap-1.5 px-3.5 py-2 text-xs font-medium text-slate-500 hover:text-slate-700 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[i.jsx(Wh,{className:"w-3.5 h-3.5"}),i.jsx("span",{className:"hidden sm:inline",children:"Owner"})]}),i.jsx(WM,{})]})]})}),i.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[et.length>1&&i.jsx("div",{className:"flex items-center justify-center gap-0 mb-8 animate-fade-in",children:et.map((me,Se)=>{const Xe=me.key===$e,tt=Se<qt;return i.jsxs(N.Fragment,{children:[Se>0&&i.jsx("div",{className:`w-8 sm:w-14 h-0.5 transition-colors duration-300 ${Se<=qt?"bg-blue-500":"bg-slate-200"}`}),i.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[i.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 ${Xe?"bg-blue-600 text-white shadow-md shadow-blue-600/30 scale-110":tt?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:tt?i.jsx(Is,{className:"w-5 h-5"}):Se+1}),i.jsx("span",{className:`text-xs font-medium hidden sm:block transition-colors ${Xe?"text-blue-700":tt?"text-blue-600":"text-slate-400"}`,children:me.label})]})]},me.key)})}),M&&i.jsx("div",{className:"mb-8 animate-scale-in",children:M.startsWith("")?i.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(X2,{className:"w-8 h-8 text-emerald-600"})}),i.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Confirmed!"}),i.jsx("p",{className:"text-slate-600 mb-4",children:"You're all set. We'll send a confirmation to your email."}),ue&&i.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[i.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[i.jsx(ci,{className:"w-4 h-4"}),"Recurring Series Created"]}),i.jsxs("p",{className:"text-sm text-slate-700",children:[ue.created," appointment",ue.created!==1?"s":""," booked"]}),ue.skipped>0&&i.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",ue.skipped," date",ue.skipped!==1?"s":""," skipped due to conflicts"]})]}),Y&&i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),i.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:Y})]}),Y&&i.jsxs("div",{className:"mb-4",children:[i.jsxs(rt,{to:`/shop/${s}/booking/${Y}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[i.jsx(Gp,{className:"w-4 h-4"}),"Manage Your Booking"]}),i.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),i.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-lg text-sm text-emerald-700 font-medium",children:[i.jsx(Gp,{className:"w-4 h-4"}),"Add to your calendar to remember"]})]}):M.startsWith("")?i.jsxs("div",{className:"bg-white rounded-2xl border border-amber-200 shadow-lg shadow-amber-100/50 p-8 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Dn,{className:"w-8 h-8 text-amber-600"})}),i.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Request Submitted!"}),i.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking request has been submitted! The shop will review and confirm it shortly."}),ue&&i.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[i.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[i.jsx(ci,{className:"w-4 h-4"}),"Recurring Series Created"]}),i.jsxs("p",{className:"text-sm text-slate-700",children:[ue.created," appointment",ue.created!==1?"s":""," submitted"]}),ue.skipped>0&&i.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",ue.skipped," date",ue.skipped!==1?"s":""," skipped due to conflicts"]})]}),Y&&i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),i.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:Y})]}),Y&&i.jsxs("div",{className:"mb-4",children:[i.jsxs(rt,{to:`/shop/${s}/booking/${Y}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[i.jsx(Gp,{className:"w-4 h-4"}),"Manage Your Booking"]}),i.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),i.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-700 font-medium",children:[i.jsx(Dn,{className:"w-4 h-4"}),"You'll be notified once it's confirmed"]})]}):i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[i.jsx("span",{children:""}),i.jsx("span",{children:"Something went wrong. Please try again."})]})}),$e==="services"&&i.jsxs("div",{className:"animate-fade-in",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a Service"}),i.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select the service you'd like to book"})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 stagger-children",children:x.map((me,Se)=>i.jsxs("button",{onClick:()=>vt(me),className:`group text-left bg-white border-l-4 ${ze[Se%ze.length]} border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5`,children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors pr-2",children:me.name}),i.jsx("span",{className:"text-xl font-extrabold text-blue-600 whitespace-nowrap",children:bs(me.price)})]}),me.description&&i.jsx("p",{className:"text-sm text-slate-500 mb-3 line-clamp-2 leading-relaxed",children:me.description}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-400",children:[i.jsx(Dn,{className:"w-3.5 h-3.5"}),i.jsx("span",{children:ts(me.duration)})]}),i.jsx("span",{className:"text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]})]},me.id))})]}),$e==="staff"&&i.jsxs("div",{className:"animate-fade-in",children:[Ie&&A&&i.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[i.jsxs("button",{onClick:Pe,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[i.jsx(Va,{className:"w-3.5 h-3.5"}),"Back"]}),i.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[i.jsx(ps,{className:"w-3.5 h-3.5 text-blue-500"}),i.jsx("span",{className:"font-semibold text-slate-800",children:A.name}),i.jsx("span",{className:"text-blue-600 font-bold",children:bs(A.price)})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose Your Stylist"}),i.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select your preferred professional"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 stagger-children",children:[i.jsxs("button",{onClick:()=>Ae("any"),className:"group text-left bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[i.jsxs("div",{className:"flex items-center gap-3.5 mb-3",children:[i.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(ln,{className:"w-5 h-5 text-slate-500"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:"Any Available"}),i.jsx("p",{className:"text-xs text-slate-500",children:"First available professional"})]})]}),i.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),_.map(me=>{const Se=me.portfolio||[];return i.jsxs("div",{className:"group bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[i.jsxs("button",{onClick:()=>Ae(me),className:"w-full text-left",children:[i.jsxs("div",{className:"flex items-center gap-3.5 mb-2",children:[i.jsx(Wc,{name:me.name}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:me.name}),me.role&&i.jsx("p",{className:"text-xs text-slate-500",children:me.role})]})]}),me.bio&&i.jsx("p",{className:"text-xs text-slate-500 leading-relaxed mb-2 line-clamp-2",children:me.bio}),Se.length>0&&i.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[Se.slice(0,3).map((Xe,tt)=>i.jsx("img",{src:Xe.url,alt:Xe.caption||"Work",className:"w-10 h-10 rounded-md object-cover border border-slate-200"},tt)),Se.length>3&&i.jsxs("span",{className:"w-10 h-10 rounded-md bg-slate-100 border border-slate-200 flex items-center justify-center text-xs text-slate-500 font-semibold",children:["+",Se.length-3]})]}),i.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),Se.length>0&&i.jsxs("button",{onClick:Xe=>{Xe.stopPropagation(),ee(me)},className:"mt-2 w-full flex items-center justify-center gap-1.5 py-1.5 text-xs font-semibold text-violet-600 hover:text-violet-700 hover:bg-violet-50 rounded-lg transition-all",children:[i.jsx(Image,{className:"w-3.5 h-3.5"}),"View Portfolio (",Se.length,")"]})]},me.id)})]})]}),$e==="calendar"&&i.jsxs("div",{className:"animate-fade-in",children:[(Ie||He)&&i.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[i.jsxs("button",{onClick:ut,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[i.jsx(Va,{className:"w-3.5 h-3.5"}),"Back"]}),A&&i.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[i.jsx(ps,{className:"w-3.5 h-3.5 text-blue-500"}),i.jsx("span",{className:"font-semibold text-slate-800",children:A.name}),i.jsx("span",{className:"text-blue-600 font-bold",children:bs(A.price)}),i.jsxs("span",{className:"text-slate-400",children:[" ",ts(A.duration)]})]}),L&&L!=="any"&&i.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[i.jsx(Wc,{name:L.name,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),i.jsx("span",{className:"font-semibold text-slate-800",children:L.name})]}),L==="any"&&i.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm",children:[i.jsx(ln,{className:"w-3.5 h-3.5 text-slate-500"}),i.jsx("span",{className:"font-semibold text-slate-700",children:"Any Available"})]})]}),qa.length===0?i.jsx("div",{children:Te?i.jsx("div",{className:"max-w-lg mx-auto",children:i.jsx(E_,{shopId:r,slug:s,selectedService:A,selectedStaff:L,staffMembers:_,preferredDate:null,onCancel:()=>ve(!1)})}):i.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:i.jsx(zt,{className:"w-8 h-8 text-slate-400"})}),i.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),i.jsx("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:A?`No time slots available for ${A.name} (${ts(A.duration)}). Join the waitlist to be notified when a slot opens up!`:"Check back soon for new availability, or join the waitlist!"}),i.jsxs("button",{onClick:()=>ve(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:[i.jsx(Yh,{className:"w-4 h-4"}),"Join Waitlist"]})]})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Select a Date"}),i.jsx("p",{className:"text-slate-500 text-sm",children:"Pick a day that works for you"})]}),i.jsx("div",{className:"mb-8",children:i.jsx(nE,{availableDates:qa,selectedDate:R,onSelectDate:V})}),R&&i.jsxs("div",{className:"animate-slide-down",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",Qn(R)]}),i.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[H.length," slot",H.length!==1?"s":""]})]}),H.length===0?i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:[i.jsx("p",{className:"text-slate-500 mb-4",children:"No times available for this date"}),Te?i.jsx("div",{className:"mt-4 text-left",children:i.jsx(E_,{shopId:r,slug:s,selectedService:A,selectedStaff:L,staffMembers:_,preferredDate:R,onCancel:()=>ve(!1)})}):i.jsxs("button",{onClick:()=>ve(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[i.jsx(Yh,{className:"w-4 h-4"}),"Join the Waitlist"]})]}):i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:H.sort((me,Se)=>me.time.localeCompare(Se.time)).map(me=>i.jsxs("button",{onClick:()=>Kt(me),className:"group bg-white border border-slate-200 hover:border-blue-400 rounded-xl p-4 transition-all duration-200 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5 text-center",children:[i.jsx("div",{className:"text-lg font-bold text-slate-900 group-hover:text-blue-700 transition-colors mb-1",children:qn(me.time)}),me.staffName&&L==="any"&&i.jsxs("div",{className:"text-xs text-violet-600 mb-0.5 flex items-center justify-center gap-1",children:[i.jsx(ln,{className:"w-3 h-3"}),me.staffName]}),i.jsx("div",{className:"text-xs text-slate-400",children:A?ts(A.duration):`${me.duration} min`})]},me.id))})]}),!R&&i.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]}),$e==="form"&&i.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[i.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Complete Your Booking"}),i.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Review your details and confirm"}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[A&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(ps,{className:"w-4 h-4 text-blue-600"})}),i.jsx("span",{className:"font-semibold text-slate-800",children:A.name})]}),i.jsx("span",{className:"font-bold text-blue-600",children:bs(A.price)})]}),L&&L!=="any"&&i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx(Wc,{name:L.name,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold text-slate-800",children:L.name}),L.role&&i.jsxs("span",{className:"text-slate-400 text-sm ml-1.5",children:[" ",L.role]})]})]}),L==="any"&&j?.staffName&&i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx(Wc,{name:j.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),i.jsx("span",{className:"font-semibold text-slate-800",children:j.staffName})]}),i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:i.jsx(zt,{className:"w-4 h-4 text-slate-600"})}),i.jsxs("span",{className:"font-semibold text-slate-800",children:[Qn(j.date)," at ",qn(j.time)]})]}),i.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[i.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:i.jsx(Dn,{className:"w-4 h-4 text-slate-500"})}),i.jsx("span",{children:A?ts(A.duration):`${j.duration} min`})]})]}),i.jsxs("form",{onSubmit:Nt,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),i.jsx("input",{type:"text",value:D.name,onChange:me=>k({...D,name:me.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),i.jsx("input",{type:"email",value:D.email,onChange:me=>k({...D,email:me.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),i.jsx("input",{type:"tel",value:D.phone,onChange:me=>k({...D,phone:me.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(ci,{className:"w-4 h-4 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Make this recurring"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Book the same slot on a regular schedule"})]})]}),i.jsx("button",{type:"button",onClick:()=>xe(!le),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${le?"bg-blue-500":"bg-slate-300"}`,children:i.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${le?"translate-x-6":"translate-x-1"}`})})]}),le&&i.jsxs("div",{className:"space-y-3 pt-1 animate-fade-in",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Repeat every"}),i.jsxs("select",{value:be,onChange:me=>Re(me.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[i.jsx("option",{value:"weekly",children:"Week"}),i.jsx("option",{value:"biweekly",children:"2 Weeks"}),i.jsx("option",{value:"fourweekly",children:"4 Weeks"}),i.jsx("option",{value:"monthly",children:"Month"})]})]}),Tt&&i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:[" Every ",Tt.intervalLabel," through ",Tt.endDate]}),i.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[Tt.total," total appointment",Tt.total!==1?"s":""]}),Tt.skipped>0&&i.jsxs("p",{className:"text-xs text-amber-600 mt-1 font-medium",children:[" ",Tt.skipped," date",Tt.skipped!==1?"s":""," will be skipped due to existing bookings"]})]})]})]}),se&&i.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[i.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:i.jsx(yo,{className:"w-5 h-5 text-emerald-600"})}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm font-semibold text-emerald-800",children:["$",(Ne/100).toFixed(2)," deposit required"]}),i.jsxs("p",{className:"text-xs text-emerald-600",children:[A.depositPercent,"% of service price  Remaining $",(A.price-Ne/100).toFixed(2)," due at appointment"]})]})]}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsx("button",{type:"submit",disabled:I,className:`flex-1 flex items-center justify-center gap-2 px-6 py-3.5 ${se?"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-600/20 hover:shadow-emerald-600/25":"bg-blue-600 hover:bg-blue-700 shadow-blue-600/20 hover:shadow-blue-600/25"} text-white rounded-xl font-semibold shadow-md hover:shadow-lg transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0`,children:I?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):se?i.jsxs(i.Fragment,{children:[i.jsx(yo,{className:"w-4 h-4"}),"Continue to Payment"]}):i.jsxs(i.Fragment,{children:[i.jsx(Is,{className:"w-4 h-4"}),"Confirm Booking"]})}),i.jsx("button",{type:"button",onClick:()=>{oe(!1),T(null)},className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]}),$e==="payment"&&i.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[i.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Secure Payment"}),i.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Complete your deposit to confirm your booking"}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(zt,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-slate-800",children:A?.name}),i.jsxs("p",{className:"text-sm text-slate-500",children:[j&&Qn(j.date)," at ",j&&qn(j.time)]})]})]}),i.jsxs("div",{className:"text-sm text-slate-600 pl-13",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Client:"})," ",D.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Email:"})," ",D.email]})]})]}),i.jsx(HM,{amount:Ne,serviceName:A?.name||"Service",clientInfo:D,onSuccess:Tn,onCancel:()=>We(!1)})]})]}),P&&i.jsx(KM,{member:P,onClose:()=>ee(null)}),i.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:i.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:i.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",i.jsx(rt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"BookFlow"})]})})}),i.jsx(lM,{services:x,staffMembers:_,shop:e,onSelectService:vt})]})}function XM({slotsByDate:s,bookingsByDate:e,selectedDate:n,onSelectDate:r,recurringDayFlags:o={}}){const[u,d]=N.useState(new Date),p=fe=>{const he=fe.getFullYear(),oe=fe.getMonth(),j=new Date(he,oe,1),R=new Date(he,oe+1,0).getDate(),V=j.getDay();return{daysInMonth:R,startingDayOfWeek:V,year:he,month:oe}},{daysInMonth:g,startingDayOfWeek:x,year:b,month:_}=p(u),E=()=>{d(new Date(u.getFullYear(),u.getMonth()-1))},A=()=>{d(new Date(u.getFullYear(),u.getMonth()+1))},F=fe=>`${b}-${String(_+1).padStart(2,"0")}-${String(fe).padStart(2,"0")}`,L=fe=>{const he=F(fe),oe=s[he]||[],j=e[he]||[],T=oe.filter(V=>V.available).length,R=j.length;return{availableCount:T,bookedCount:R,hasData:oe.length>0||j.length>0}},O=fe=>{const he=F(fe);r(he===n?null:he)},U=["January","February","March","April","May","June","July","August","September","October","November","December"],G=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],K=new Date;return K.setHours(0,0,0,0),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-5",children:[i.jsx("button",{onClick:E,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:i.jsx(Q2,{className:"w-5 h-5 text-slate-600"})}),i.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[U[_]," ",b]}),i.jsx("button",{onClick:A,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:i.jsx(Sf,{className:"w-5 h-5 text-slate-600"})})]}),i.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:G.map(fe=>i.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:fe},fe))}),i.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:x}).map((fe,he)=>i.jsx("div",{},`empty-${he}`)),Array.from({length:g}).map((fe,he)=>{const oe=he+1,j=F(oe),{availableCount:T,bookedCount:R,hasData:V}=L(oe),M=j===n,z=new Date,I=z.getDate()===oe&&z.getMonth()===_&&z.getFullYear()===b,q=new Date(b,_,oe),D=q.getDay(),k=o[D]&&q>=K;return i.jsxs("button",{onClick:()=>O(oe),className:`
                relative p-2 text-center rounded-lg text-sm font-semibold transition-all duration-200 min-h-[56px] flex flex-col items-center justify-start cursor-pointer
                ${M?"bg-blue-600 text-white shadow-md shadow-blue-600/30":V||k?"bg-slate-50 hover:bg-slate-100 text-slate-900 border border-slate-200 hover:border-slate-300":I?"text-slate-900 font-bold hover:bg-slate-50":"text-slate-400 hover:bg-slate-50"}
              `,children:[i.jsxs("span",{className:`text-sm ${I&&!M?"relative":""}`,children:[oe,I&&!M&&i.jsx("span",{className:"absolute -bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]}),(V||k)&&i.jsxs("div",{className:"flex gap-0.5 mt-1 flex-wrap justify-center",children:[k&&i.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${M?"bg-white/20 text-white":"bg-violet-100 text-violet-700"}`,children:"R"}),T>0&&i.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${M?"bg-white/20 text-white":"bg-emerald-100 text-emerald-700"}`,children:T}),R>0&&i.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${M?"bg-white/20 text-white":"bg-blue-100 text-blue-700"}`,children:R})]})]},oe)})]}),i.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-xs text-slate-500",children:[Object.keys(o).length>0&&i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3.5 h-3.5 bg-violet-100 border border-violet-200 rounded flex items-center justify-center text-[7px] font-bold text-violet-700",children:"R"}),i.jsx("span",{children:"Recurring"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3.5 h-3.5 bg-emerald-100 border border-emerald-200 rounded"}),i.jsx("span",{children:"Available"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3.5 h-3.5 bg-blue-100 border border-blue-200 rounded"}),i.jsx("span",{children:"Booked"})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-3.5 h-3.5 bg-blue-600 rounded"}),i.jsx("span",{children:"Selected"})]})]})]})}const JM=[{value:15,label:"15 min"},{value:30,label:"30 min"},{value:45,label:"45 min"},{value:60,label:"1 hour"},{value:90,label:"1.5 hours"},{value:120,label:"2 hours"}],ZM=[{value:0,label:"No deposit required"},{value:10,label:"10%"},{value:20,label:"20%"},{value:25,label:"25%"},{value:50,label:"50%"},{value:100,label:"Full payment upfront"}];function eO({shopId:s}){const[e,n]=N.useState([]),[r,o]=N.useState(!1),[u,d]=N.useState(null),[p,g]=N.useState({name:"",description:"",duration:30,price:"",depositPercent:0}),[x,b]=N.useState(!1);N.useEffect(()=>{if(!s)return;const U=rn(st(Ee,"shops",s,"services"),G=>{const K=G.docs.map(fe=>({id:fe.id,...fe.data()})).filter(fe=>fe.active!==!1).sort((fe,he)=>(fe.name||"").localeCompare(he.name||""));n(K)});return()=>U()},[s]);const _=()=>{g({name:"",description:"",duration:30,price:"",depositPercent:0}),o(!1),d(null)},E=async U=>{U.preventDefault(),b(!0);const G={name:p.name.trim(),description:p.description.trim(),duration:parseInt(p.duration),price:parseFloat(p.price),depositPercent:parseInt(p.depositPercent)||0,active:!0};try{u?await ot(Je(Ee,"shops",s,"services",u),G):await yr(st(Ee,"shops",s,"services"),{...G,createdAt:B0()}),_()}catch(K){console.error("Error saving service:",K)}finally{b(!1)}},A=U=>{g({name:U.name,description:U.description||"",duration:U.duration,price:U.price.toString(),depositPercent:U.depositPercent||0}),d(U.id),o(!0)},F=async U=>{try{await ot(Je(Ee,"shops",s,"services",U),{active:!1})}catch(G){console.error("Error deleting service:",G)}},L=U=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(U),O=U=>{if(U<60)return`${U} min`;const G=Math.floor(U/60),K=U%60;return K?`${G}h ${K}m`:`${G}h`};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Services"}),i.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Define the services you offer  clients will pick one before booking"})]}),!r&&i.jsxs("button",{onClick:()=>{_(),o(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[i.jsx(xi,{className:"w-4 h-4"}),"Add Service"]})]}),r&&i.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:u?"Edit Service":"New Service"}),i.jsxs("form",{onSubmit:E,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Service Name *"}),i.jsx("input",{type:"text",value:p.name,onChange:U=>g({...p,name:U.target.value}),required:!0,placeholder:"e.g. Haircut",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description (optional)"}),i.jsx("input",{type:"text",value:p.description,onChange:U=>g({...p,description:U.target.value}),placeholder:"e.g. Classic cut and style",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Duration *"}),i.jsx("select",{value:p.duration,onChange:U=>g({...p,duration:U.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:JM.map(U=>i.jsx("option",{value:U.value,children:U.label},U.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Price (USD) *"}),i.jsxs("div",{className:"relative",children:[i.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-semibold",children:"$"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:p.price,onChange:U=>g({...p,price:U.target.value}),required:!0,placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:i.jsxs("span",{className:"flex items-center gap-1.5",children:[i.jsx(yo,{className:"w-4 h-4 text-emerald-500"}),"Deposit Required"]})}),i.jsx("select",{value:p.depositPercent,onChange:U=>g({...p,depositPercent:U.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:ZM.map(U=>i.jsx("option",{value:U.value,children:U.label},U.value))})]})]}),p.depositPercent>0&&p.price&&i.jsxs("div",{className:"flex items-center gap-2 p-3 bg-emerald-50 border border-emerald-200 rounded-lg text-sm",children:[i.jsx(yo,{className:"w-4 h-4 text-emerald-600"}),i.jsxs("span",{className:"text-emerald-800",children:["Clients will pay ",i.jsxs("strong",{children:["$",((parseFloat(p.price)||0)*(parseInt(p.depositPercent)/100)).toFixed(2)]})," deposit at booking",parseInt(p.depositPercent)<100&&i.jsxs("span",{children:[" ($",((parseFloat(p.price)||0)*(1-parseInt(p.depositPercent)/100)).toFixed(2)," remaining due at appointment)"]})]})]}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsxs("button",{type:"submit",disabled:x,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[i.jsx(oi,{className:"w-4 h-4"}),x?"Saving":u?"Update Service":"Add Service"]}),i.jsxs("button",{type:"button",onClick:_,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[i.jsx(La,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length===0?i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-5xl mb-3",children:""}),i.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No services yet"}),i.jsx("p",{className:"text-sm text-slate-600",children:"Add your first service so clients can choose what to book"})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(U=>i.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:U.name}),U.description&&i.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:U.description})]}),i.jsx("span",{className:"text-xl font-bold text-blue-600 whitespace-nowrap ml-3",children:L(U.price)})]}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500 mb-4 flex-wrap",children:[i.jsxs("span",{className:"flex items-center gap-1.5",children:[i.jsx(Dn,{className:"w-4 h-4"}),O(U.duration)]}),U.depositPercent>0&&i.jsxs("span",{className:"flex items-center gap-1.5 text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full text-xs font-medium",children:[i.jsx(yo,{className:"w-3 h-3"}),U.depositPercent,"% deposit"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>A(U),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:[i.jsx(J2,{className:"w-3.5 h-3.5"}),"Edit"]}),i.jsx("button",{onClick:()=>F(U.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:i.jsx(mu,{className:"w-3.5 h-3.5"})})]})]},U.id))})]})}const Jp=[{key:"monday",label:"Monday",short:"Mon"},{key:"tuesday",label:"Tuesday",short:"Tue"},{key:"wednesday",label:"Wednesday",short:"Wed"},{key:"thursday",label:"Thursday",short:"Thu"},{key:"friday",label:"Friday",short:"Fri"},{key:"saturday",label:"Saturday",short:"Sat"},{key:"sunday",label:"Sunday",short:"Sun"}],tO={enabled:!1,start:"09:00",end:"17:00",break:null};function nO({shopId:s,staffId:e,staffName:n,weeklyHours:r,onClose:o}){const[u,d]=N.useState(()=>{const O={};for(const U of Jp){const G=r?.[U.key];G?O[U.key]={enabled:!!G.enabled,start:G.start||"09:00",end:G.end||"17:00",break:G.break?{start:G.break.start,end:G.break.end}:null}:O[U.key]={...tO}}return O}),[p,g]=N.useState(!1),[x,b]=N.useState(null),_=(O,U,G)=>{d(K=>({...K,[O]:{...K[O],[U]:G}}))},E=O=>{d(U=>({...U,[O]:{...U[O],break:U[O].break?null:{start:"12:00",end:"13:00"}}}))},A=(O,U,G)=>{d(K=>({...K,[O]:{...K[O],break:{...K[O].break,[U]:G}}}))},F=O=>{const U=u[O];d(G=>{const K={...G};for(const fe of Jp)fe.key!==O&&(K[fe.key]={enabled:U.enabled,start:U.start,end:U.end,break:U.break?{...U.break}:null});return K}),b(O),setTimeout(()=>b(null),1500)},L=async()=>{g(!0);try{await ot(Je(Ee,"shops",s,"staff",e),{weeklyHours:u}),o()}catch(O){console.error("Error saving weekly hours:",O)}finally{g(!1)}};return i.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Weekly Hours"}),i.jsx("p",{className:"text-sm text-slate-500",children:n})]}),i.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:i.jsx(La,{className:"w-5 h-5 text-slate-400"})})]}),i.jsx("div",{className:"space-y-3",children:Jp.map(({key:O,label:U})=>{const G=u[O];return i.jsx("div",{className:`rounded-xl p-4 transition-all ${G.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:i.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[i.jsxs("div",{className:"flex items-center gap-3 min-w-[140px]",children:[i.jsx("button",{type:"button",onClick:()=>_(O,"enabled",!G.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${G.enabled?"bg-blue-500":"bg-slate-300"}`,children:i.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${G.enabled?"translate-x-6":"translate-x-1"}`})}),i.jsx("span",{className:`font-semibold text-sm ${G.enabled?"text-slate-900":"text-slate-400"}`,children:U})]}),G.enabled?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Dn,{className:"w-4 h-4 text-blue-500"}),i.jsx("input",{type:"time",value:G.start,onChange:K=>_(O,"start",K.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),i.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),i.jsx("input",{type:"time",value:G.end,onChange:K=>_(O,"end",K.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{type:"button",onClick:()=>E(O),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${G.break?"bg-amber-100 text-amber-700 border border-amber-200":"bg-slate-100 text-slate-500 border border-slate-200 hover:bg-slate-200"}`,children:[i.jsx(Y3,{className:"w-3.5 h-3.5"}),G.break?"Break":"+ Break"]}),G.break&&i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("input",{type:"time",value:G.break.start,onChange:K=>A(O,"start",K.target.value),className:"px-2 py-1.5 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),i.jsx("span",{className:"text-slate-400 text-xs",children:""}),i.jsx("input",{type:"time",value:G.break.end,onChange:K=>A(O,"end",K.target.value),className:"px-2 py-1.5 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"})]})]}),i.jsx("button",{type:"button",onClick:()=>F(O),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:x===O?" Copied!":"Copy to all"})]}):i.jsx("span",{className:"text-sm text-slate-400 italic",children:"Day off"})]})},O)})}),i.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t border-slate-200",children:[i.jsxs("button",{onClick:L,disabled:p,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[i.jsx(AD,{className:"w-4 h-4"}),p?"Saving":"Save Hours"]}),i.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[i.jsx(La,{className:"w-4 h-4"}),"Cancel"]})]})]})}const sO=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}],aO=5*1024*1024,rO=["image/jpeg","image/png","image/webp"];function P_(s){if(!s)return"";const[e,n]=s.split(":").map(Number),r=e>=12?"p":"a",o=e%12||12;return n===0?`${o}${r}`:`${o}:${n.toString().padStart(2,"0")}${r}`}function iO({shopId:s}){const[e,n]=N.useState([]),[r,o]=N.useState(!1),[u,d]=N.useState(null),[p,g]=N.useState(null),[x,b]=N.useState(null),[_,E]=N.useState({name:"",role:""}),[A,F]=N.useState(!1),[L,O]=N.useState(null),[U,G]=N.useState(""),[K,fe]=N.useState(!1),[he,oe]=N.useState(!1),[j,T]=N.useState(""),[R,V]=N.useState(null),[M,z]=N.useState(null),[I,q]=N.useState(null),D=N.useRef(null);N.useEffect(()=>{if(!s)return;const ue=rn(st(Ee,"shops",s,"staff"),Ue=>{const Be=Ue.docs.map(We=>({id:We.id,...We.data()})).filter(We=>We.active!==!1).sort((We,Q)=>(We.name||"").localeCompare(Q.name||""));n(Be)});return()=>ue()},[s]);const k=()=>{E({name:"",role:""}),o(!1),d(null)},Y=async ue=>{ue.preventDefault(),F(!0);const Ue={name:_.name.trim(),role:_.role.trim(),active:!0};try{u?await ot(Je(Ee,"shops",s,"staff",u),Ue):await yr(st(Ee,"shops",s,"staff"),{...Ue,email:"",bio:"",portfolio:[],createdAt:B0()}),k()}catch(Be){console.error("Error saving staff member:",Be)}finally{F(!1)}},ie=ue=>{E({name:ue.name,role:ue.role||""}),d(ue.id),o(!0)},Te=async ue=>{try{await ot(Je(Ee,"shops",s,"staff",ue),{active:!1})}catch(Ue){console.error("Error deleting staff member:",Ue)}},ve=ue=>{O(ue.id),G(ue.bio||"")},P=async ue=>{fe(!0);try{await ot(Je(Ee,"shops",s,"staff",ue),{bio:U.trim()}),O(null),G("")}catch(Ue){console.error("Error saving bio:",Ue)}finally{fe(!1)}},ee=ue=>{V(ue),T(""),z(null),setTimeout(()=>{D.current&&(D.current.value="",D.current.click())},50)},le=ue=>{const Ue=ue.target.files?.[0];if(Ue){if(!rO.includes(Ue.type)){alert("Please select a JPG, PNG, or WebP image.");return}if(Ue.size>aO){alert("File size must be under 5MB.");return}z(Ue)}},xe=async ue=>{if(M){oe(!0);try{const Ue=Date.now(),Be=M.name.split(".").pop(),We=`${Ue}.${Be}`,Q=`shops/${s}/staff/${ue}/portfolio/${We}`,we=p_(g_,Q);await l3(we,M);const Ie=await o3(we),Ve=e.find(ft=>ft.id===ue)?.portfolio||[];await ot(Je(Ee,"shops",s,"staff",ue),{portfolio:[...Ve,{url:Ie,storagePath:Q,caption:j.trim(),uploadedAt:new Date().toISOString()}]}),V(null),T(""),z(null)}catch(Ue){console.error("Error uploading photo:",Ue),alert("Upload failed. Please try again.")}finally{oe(!1)}}},be=async(ue,Ue)=>{const Be=e.find(Q=>Q.id===ue);if(!Be)return;const We=Be.portfolio[Ue];if(We){q(`${ue}-${Ue}`);try{if(We.storagePath)try{const we=p_(g_,We.storagePath);await c3(we)}catch(we){console.warn("Storage delete warning:",we)}const Q=Be.portfolio.filter((we,Ie)=>Ie!==Ue);await ot(Je(Ee,"shops",s,"staff",ue),{portfolio:Q})}catch(Q){console.error("Error deleting photo:",Q),alert("Failed to delete photo.")}finally{q(null)}}},Re=ue=>{if(!ue)return null;const Ue=sO.filter(Be=>ue[Be.key]?.enabled);return Ue.length===0?null:Ue.map(Be=>{const We=ue[Be.key];return`${Be.short} ${P_(We.start)}${P_(We.end)}`})};return i.jsxs("div",{children:[i.jsx("input",{ref:D,type:"file",accept:".jpg,.jpeg,.png,.webp",className:"hidden",onChange:le}),i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Staff"}),i.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Manage your team  assign availability and bookings per staff member"})]}),!r&&i.jsxs("button",{onClick:()=>{k(),o(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[i.jsx(xi,{className:"w-4 h-4"}),"Add Staff"]})]}),r&&i.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:u?"Edit Staff Member":"New Staff Member"}),i.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Name *"}),i.jsx("input",{type:"text",value:_.name,onChange:ue=>E({..._,name:ue.target.value}),required:!0,placeholder:"e.g. Jane Smith",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Role (optional)"}),i.jsx("input",{type:"text",value:_.role,onChange:ue=>E({..._,role:ue.target.value}),placeholder:"e.g. Senior Stylist",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsxs("button",{type:"submit",disabled:A,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[i.jsx(oi,{className:"w-4 h-4"}),A?"Saving":u?"Update Staff":"Add Staff"]}),i.jsxs("button",{type:"button",onClick:k,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[i.jsx(La,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length===0?i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"text-5xl mb-3",children:""}),i.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No staff members yet"}),i.jsx("p",{className:"text-sm text-slate-600",children:"Add your team members to assign them availability and bookings"})]}):i.jsx("div",{className:"space-y-4",children:e.map(ue=>{const Ue=Re(ue.weeklyHours),Be=ue.portfolio||[];return i.jsxs("div",{children:[i.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:ue.name}),ue.role&&i.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:ue.role})]}),i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(ln,{className:"w-5 h-5 text-blue-600"})})]}),i.jsx("div",{className:"mb-3",children:L===ue.id?i.jsxs("div",{className:"space-y-2",children:[i.jsx("textarea",{value:U,onChange:We=>G(We.target.value),placeholder:"Write a short bio  specialties, experience, personality",rows:3,maxLength:500,className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none transition-all"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>P(ue.id),disabled:K,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[K?i.jsx(Yp,{className:"w-3 h-3 animate-spin"}):i.jsx(oi,{className:"w-3 h-3"}),"Save Bio"]}),i.jsx("button",{onClick:()=>{O(null),G("")},className:"px-3 py-1.5 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"}),i.jsxs("span",{className:"text-xs text-slate-400 ml-auto",children:[U.length,"/500"]})]})]}):i.jsx("div",{onClick:()=>ve(ue),className:"cursor-pointer group",children:ue.bio?i.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed group-hover:text-slate-800 transition-colors",children:[ue.bio,i.jsx("span",{className:"ml-1.5 text-xs text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",children:"edit"})]}):i.jsx("p",{className:"text-sm text-slate-400 italic group-hover:text-blue-500 transition-colors",children:"+ Add a bio"})})}),Ue?i.jsx("div",{className:"mb-3 flex flex-wrap gap-1.5",children:Ue.map((We,Q)=>i.jsx("span",{className:"inline-block px-2 py-0.5 bg-green-50 text-green-700 border border-green-200 rounded text-xs font-medium",children:We},Q))}):i.jsx("p",{className:"text-xs text-slate-400 mb-3 italic",children:"No weekly hours set"}),Be.length>0&&x!==ue.id&&i.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[i.jsx("div",{className:"flex -space-x-1",children:Be.slice(0,4).map((We,Q)=>i.jsx("img",{src:We.url,alt:We.caption||"Portfolio",className:"w-10 h-10 rounded-lg object-cover border-2 border-white shadow-sm"},Q))}),i.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[Be.length," photo",Be.length!==1?"s":""]})]}),i.jsxs("div",{className:"flex gap-2 flex-wrap",children:[i.jsxs("button",{onClick:()=>g(p===ue.id?null:ue.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${p===ue.id?"bg-blue-100 text-blue-700 border-blue-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:[i.jsx(Dn,{className:"w-3.5 h-3.5"}),"Set Hours"]}),i.jsxs("button",{onClick:()=>b(x===ue.id?null:ue.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${x===ue.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:[i.jsx(D3,{className:"w-3.5 h-3.5"}),"Portfolio"]}),i.jsx("button",{onClick:()=>ie(ue),className:"flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:i.jsx(J2,{className:"w-3.5 h-3.5"})}),i.jsx("button",{onClick:()=>Te(ue.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:i.jsx(mu,{className:"w-3.5 h-3.5"})})]})]}),p===ue.id&&i.jsx("div",{className:"mt-2",children:i.jsx(nO,{shopId:s,staffId:ue.id,staffName:ue.name,weeklyHours:ue.weeklyHours,onClose:()=>g(null)})}),x===ue.id&&i.jsxs("div",{className:"mt-2 bg-white border-2 border-violet-200 rounded-xl p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[i.jsx(lD,{className:"w-4 h-4 text-violet-600"}),"Portfolio  ",ue.name]}),i.jsxs("button",{onClick:()=>ee(ue.id),disabled:he,className:"flex items-center gap-1.5 px-3 py-1.5 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[i.jsx(xi,{className:"w-3 h-3"}),"Add Photo"]})]}),R===ue.id&&M&&i.jsxs("div",{className:"mb-4 p-3 bg-violet-50 border border-violet-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"w-16 h-16 rounded-lg bg-slate-200 overflow-hidden flex-shrink-0",children:i.jsx("img",{src:URL.createObjectURL(M),alt:"Preview",className:"w-full h-full object-cover"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-xs text-slate-600 font-medium mb-1 truncate",children:M.name}),i.jsxs("p",{className:"text-xs text-slate-400",children:[(M.size/1024/1024).toFixed(1)," MB"]})]})]}),i.jsx("input",{type:"text",value:j,onChange:We=>T(We.target.value),placeholder:"Add a caption (optional)",maxLength:200,className:"w-full px-3 py-2 text-sm border border-violet-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-400 focus:border-transparent mb-2"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>xe(ue.id),disabled:he,className:"flex items-center gap-1.5 px-4 py-2 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:he?i.jsxs(i.Fragment,{children:[i.jsx(Yp,{className:"w-3 h-3 animate-spin"}),"Uploading"]}):i.jsxs(i.Fragment,{children:[i.jsx(oi,{className:"w-3 h-3"}),"Upload"]})}),i.jsx("button",{onClick:()=>{V(null),z(null),T("")},className:"px-3 py-2 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}),Be.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"text-3xl mb-2",children:""}),i.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet. Add some to showcase work!"})]}):i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:Be.map((We,Q)=>i.jsxs("div",{className:"group relative bg-slate-50 rounded-lg overflow-hidden border border-slate-200 shadow-sm",children:[i.jsx("div",{className:"aspect-square",children:i.jsx("img",{src:We.url,alt:We.caption||"Portfolio photo",className:"w-full h-full object-cover"})}),We.caption&&i.jsx("div",{className:"px-2 py-1.5",children:i.jsx("p",{className:"text-xs text-slate-600 truncate",children:We.caption})}),i.jsx("button",{onClick:()=>be(ue.id,Q),disabled:I===`${ue.id}-${Q}`,className:"absolute top-1.5 right-1.5 w-7 h-7 bg-red-500/90 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-md disabled:opacity-50",title:"Delete photo",children:I===`${ue.id}-${Q}`?i.jsx(Yp,{className:"w-3.5 h-3.5 animate-spin"}):i.jsx(mu,{className:"w-3.5 h-3.5"})})]},Q))})]})]},ue.id)})})]})}function Xi(s){return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`}function lO(s){const e=new Date(s),n=e.getDay(),r=n===0?-6:1-n;return e.setDate(e.getDate()+r),e.setHours(0,0,0,0),e}function Ji(s){return`$${Number(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function V_(s){return new Date(s+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}function L_(s){return new Date(s+"T12:00:00").toLocaleDateString("en-US",{weekday:"short"})}function Zp(s,e){return e===0&&s===0?0:e===0?100:(s-e)/e*100}function oO({bookings:s}){const[e,n]=N.useState(null),[r,o]=N.useState(null),u=N.useMemo(()=>s.filter(q=>q.status==="confirmed"||q.status==="pending"||!q.status),[s]),d=N.useMemo(()=>{const q=new Date;return q.setHours(0,0,0,0),q},[]),p=N.useMemo(()=>Xi(d),[d]),g=N.useMemo(()=>lO(d),[d]),x=N.useMemo(()=>{const q=new Date(g);return q.setDate(q.getDate()+6),q},[g]),b=N.useMemo(()=>{const q=new Date(g);return q.setDate(q.getDate()-7),q},[g]),_=N.useMemo(()=>{const q=new Date(b);return q.setDate(q.getDate()+6),q},[b]),E=N.useMemo(()=>new Date(d.getFullYear(),d.getMonth(),1),[d]),A=N.useMemo(()=>new Date(d.getFullYear(),d.getMonth()-1,1),[d]),F=N.useMemo(()=>{const q=new Date(E);return q.setDate(q.getDate()-1),q},[E]),L=N.useMemo(()=>{const q=new Date(d);return q.setDate(q.getDate()-1),Xi(q)},[d]),O=N.useMemo(()=>{const q=le=>le.reduce((xe,be)=>xe+(Number(be.servicePrice)||0),0),D=(le,xe,be)=>le.date>=Xi(xe)&&le.date<=Xi(be),k=q(u.filter(le=>le.date===p)),Y=q(u.filter(le=>le.date===L)),ie=q(u.filter(le=>D(le,g,x))),Te=q(u.filter(le=>D(le,b,_))),ve=q(u.filter(le=>D(le,E,d))),P=q(u.filter(le=>D(le,A,F))),ee=q(u);return{today:k,todayChange:Zp(k,Y),week:ie,weekChange:Zp(ie,Te),month:ve,monthChange:Zp(ve,P),allTime:ee}},[u,p,L,g,x,b,_,E,F,d]),U=N.useMemo(()=>{const q=[];for(let D=13;D>=0;D--){const k=new Date(d);k.setDate(k.getDate()-D),q.push(Xi(k))}return q},[d]),G=N.useMemo(()=>{const q={};return U.forEach(D=>{q[D]=0}),u.forEach(D=>{q[D.date]!==void 0&&(q[D.date]+=Number(D.servicePrice)||0)}),U.map(D=>({date:D,value:q[D]}))},[u,U]),K=N.useMemo(()=>Math.max(...G.map(q=>q.value),1),[G]),fe=N.useMemo(()=>{const q={},D={};return U.forEach(k=>{q[k]=0,D[k]=0}),s.forEach(k=>{q[k.date]!==void 0&&(k.status==="cancelled"||k.status==="rejected"?D[k.date]++:q[k.date]++)}),U.map(k=>({date:k,confirmed:q[k],cancelled:D[k],total:q[k]+D[k]}))},[s,U]),he=N.useMemo(()=>Math.max(...fe.map(q=>q.total),1),[fe]),oe=N.useMemo(()=>{const q=s.length;if(q===0)return 100;const D=s.filter(k=>k.status==="cancelled"||k.status==="rejected").length;return Math.round((q-D)/q*100)},[s]),j=N.useMemo(()=>{const q=Array.from({length:7},()=>Array(24).fill(0));u.forEach(k=>{if(!k.date||!k.time)return;const ie=new Date(k.date+"T12:00:00").getDay(),Te=parseInt(k.time.split(":")[0],10);!isNaN(ie)&&!isNaN(Te)&&q[ie][Te]++});let D=0;return q.forEach(k=>k.forEach(Y=>{Y>D&&(D=Y)})),{grid:q,max:D}},[u]),T=N.useMemo(()=>{const q={};return u.forEach(D=>{const k=D.serviceName||"Unknown";q[k]||(q[k]={name:k,count:0,revenue:0}),q[k].count++,q[k].revenue+=Number(D.servicePrice)||0}),Object.values(q).map(D=>({...D,avgRevenue:D.count>0?D.revenue/D.count:0})).sort((D,k)=>k.revenue-D.revenue)},[u]),R=N.useMemo(()=>{const q={};return u.forEach(D=>{const k=D.staffName||"Unassigned";q[k]||(q[k]={name:k,count:0,revenue:0,clients:new Set}),q[k].count++,q[k].revenue+=Number(D.servicePrice)||0,D.clientEmail&&q[k].clients.add(D.clientEmail.toLowerCase())}),Object.values(q).map(D=>({...D,clientCount:D.clients.size})).sort((D,k)=>k.revenue-D.revenue)},[u]),V=N.useMemo(()=>{const q=u.map(be=>be.clientEmail?.toLowerCase()).filter(Boolean),D=new Set(q).size,k=u.filter(be=>be.date>=Xi(E)&&be.date<=p),Y=new Set(k.map(be=>be.clientEmail?.toLowerCase()).filter(Boolean)),ie=u.filter(be=>be.date<Xi(E)),Te=new Set(ie.map(be=>be.clientEmail?.toLowerCase()).filter(Boolean));let ve=0,P=0;Y.forEach(be=>{Te.has(be)?P++:ve++});const ee={};u.forEach(be=>{const Re=be.clientEmail?.toLowerCase();Re&&(ee[Re]||(ee[Re]={email:Re,name:be.clientName||Re,count:0}),ee[Re].count++,be.clientName&&(ee[Re].name=be.clientName))});const le=Object.values(ee).sort((be,Re)=>Re.count-be.count).slice(0,10),xe=D>0?u.length/D:0;return{uniqueClients:D,newThisMonth:ve,returningThisMonth:P,topClients:le,avgBookingsPerClient:xe}},[u,E,p]),M=({value:q,suffix:D="vs prev"})=>{if(q===0)return i.jsxs("span",{className:"flex items-center gap-0.5 text-xs font-medium text-slate-400",children:[i.jsx(yD,{className:"w-3 h-3"})," 0% ",D]});const k=q>0;return i.jsxs("span",{className:`flex items-center gap-0.5 text-xs font-semibold ${k?"text-emerald-600":"text-red-500"}`,children:[k?i.jsx(T3,{className:"w-3 h-3"}):i.jsx(w3,{className:"w-3 h-3"}),k?"+":"",Math.round(q),"% ",D]})},z=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],I=Array.from({length:15},(q,D)=>D+7);return i.jsxs("div",{className:"animate-fade-in space-y-6",children:[i.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Today's Revenue",value:O.today,change:O.todayChange,suffix:"vs yesterday",icon:J3,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:O.week,change:O.weekChange,suffix:"vs last week",icon:X0,color:"bg-violet-100 text-violet-600"},{label:"This Month",value:O.month,change:O.monthChange,suffix:"vs last month",icon:zt,color:"bg-emerald-100 text-emerald-600"},{label:"All-time Revenue",value:O.allTime,change:null,icon:K2,color:"bg-amber-100 text-amber-600"}].map(q=>{const D=q.icon;return i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("div",{className:`w-10 h-10 ${q.color} rounded-xl flex items-center justify-center`,children:i.jsx(D,{className:"w-5 h-5"})})}),i.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Ji(q.value)}),i.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5 mb-1",children:q.label}),q.change!==null&&i.jsx(M,{value:q.change,suffix:q.suffix})]},q.label)})}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Revenue  Last 14 Days"}),i.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Daily revenue from confirmed & pending bookings"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("div",{className:"min-w-[600px]",children:[i.jsxs("div",{className:"flex items-end gap-0",children:[i.jsxs("div",{className:"flex flex-col justify-between h-48 pr-2 text-right flex-shrink-0 w-16",children:[i.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:Ji(K)}),i.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:Ji(K/2)}),i.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"$0"})]}),i.jsx("div",{className:"flex-1 flex items-end gap-1 h-48 border-b border-l border-slate-200 pl-1 pb-0 relative",children:G.map((q,D)=>{const k=K>0?q.value/K*100:0,Y=e===D;return i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative group",onMouseEnter:()=>n(D),onMouseLeave:()=>n(null),onTouchStart:()=>n(D),children:[Y&&i.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[Ji(q.value),i.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),i.jsx("div",{className:"w-full rounded-t-md transition-all duration-200 cursor-pointer",style:{height:`${Math.max(k,q.value>0?2:0)}%`,background:Y?"linear-gradient(to top, #2563eb, #60a5fa)":"linear-gradient(to top, #3b82f6, #93c5fd)",minHeight:q.value>0?"4px":"0px"}})]},q.date)})})]}),i.jsx("div",{className:"flex ml-16 pl-1",children:G.map(q=>i.jsxs("div",{className:"flex-1 text-center",children:[i.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:L_(q.date)}),i.jsx("div",{className:"text-[9px] text-slate-400",children:V_(q.date)})]},q.date))})]})})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Booking Trends  Last 14 Days"}),i.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Daily bookings breakdown"})]}),i.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[i.jsxs("span",{className:"flex items-center gap-1.5",children:[i.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-blue-500"})," Confirmed"]}),i.jsxs("span",{className:"flex items-center gap-1.5",children:[i.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-red-400"})," Cancelled"]}),i.jsxs("span",{className:"px-2.5 py-1 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-lg font-semibold",children:[oe,"% completion"]})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("div",{className:"min-w-[600px]",children:[i.jsxs("div",{className:"flex items-end gap-0",children:[i.jsxs("div",{className:"flex flex-col justify-between h-40 pr-2 text-right flex-shrink-0 w-16",children:[i.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:he}),i.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:Math.round(he/2)}),i.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"0"})]}),i.jsx("div",{className:"flex-1 flex items-end gap-1 h-40 border-b border-l border-slate-200 pl-1 relative",children:fe.map((q,D)=>{const k=he>0?q.confirmed/he*100:0,Y=he>0?q.cancelled/he*100:0,ie=r===D;return i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative",onMouseEnter:()=>o(D),onMouseLeave:()=>o(null),onTouchStart:()=>o(D),children:[ie&&i.jsxs("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[q.confirmed," confirmed, ",q.cancelled," cancelled",i.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),i.jsxs("div",{className:"w-full flex flex-col items-stretch",children:[q.cancelled>0&&i.jsx("div",{className:"w-full rounded-t-md bg-red-400 transition-all duration-200",style:{height:`${Math.max(Y,2)}%`}}),q.confirmed>0&&i.jsx("div",{className:`w-full bg-blue-500 transition-all duration-200 ${q.cancelled===0?"rounded-t-md":""}`,style:{height:`${Math.max(k,2)}%`}})]})]},q.date)})})]}),i.jsx("div",{className:"flex ml-16 pl-1",children:fe.map(q=>i.jsxs("div",{className:"flex-1 text-center",children:[i.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:L_(q.date)}),i.jsx("div",{className:"text-[9px] text-slate-400",children:V_(q.date)})]},q.date))})]})})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Busiest Times"}),i.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Booking density by day of week and hour"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("div",{className:"min-w-[600px]",children:[i.jsxs("table",{className:"w-full border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"w-12"}),I.map(q=>i.jsxs("th",{className:"text-[10px] text-slate-400 font-medium pb-2 text-center px-0.5",children:[q%12||12,q>=12?"p":"a"]},q))]})}),i.jsx("tbody",{children:[1,2,3,4,5,6,0].map(q=>i.jsxs("tr",{children:[i.jsx("td",{className:"text-[11px] text-slate-500 font-semibold pr-2 py-0.5 text-right",children:z[q]}),I.map(D=>{const k=j.grid[q][D],Y=j.max||1,ie=k/Y;let Te="bg-slate-50";return k>0&&(ie<=.2?Te="bg-blue-100":ie<=.4?Te="bg-blue-200":ie<=.6?Te="bg-blue-300":ie<=.8?Te="bg-blue-500 text-white":Te="bg-blue-700 text-white"),i.jsx("td",{className:"px-0.5 py-0.5",children:i.jsx("div",{className:`w-full aspect-square rounded-sm ${Te} flex items-center justify-center text-[9px] font-bold transition-all hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 cursor-default`,title:`${z[q]} ${D}:00  ${k} booking${k!==1?"s":""}`,children:k>0?k:""})},D)})]},q))})]}),i.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-3",children:[i.jsx("span",{className:"text-[10px] text-slate-400",children:"Less"}),["bg-slate-50","bg-blue-100","bg-blue-200","bg-blue-300","bg-blue-500","bg-blue-700"].map((q,D)=>i.jsx("div",{className:`w-4 h-4 rounded-sm ${q} border border-slate-200`},D)),i.jsx("span",{className:"text-[10px] text-slate-400",children:"More"})]})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Top Services"}),i.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Ranked by revenue from confirmed & pending bookings"}),T.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx(ps,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),i.jsx("p",{className:"text-sm text-slate-400",children:"No service data yet"})]}):i.jsx("div",{className:"space-y-2",children:T.map((q,D)=>i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm flex-shrink-0",children:D+1}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:q.name}),i.jsxs("div",{className:"text-xs text-slate-500",children:[q.count," booking",q.count!==1?"s":"","  avg ",Ji(q.avgRevenue)]})]}),i.jsx("div",{className:"text-sm font-bold text-blue-600 flex-shrink-0",children:Ji(q.revenue)})]},q.name))})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Staff Performance"}),i.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Bookings, revenue & clients per staff member"}),R.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx(ln,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),i.jsx("p",{className:"text-sm text-slate-400",children:"No staff data yet"})]}):i.jsx("div",{className:"space-y-2",children:R.map((q,D)=>i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[i.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center text-violet-600 font-bold text-sm flex-shrink-0",children:D+1}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:q.name}),i.jsxs("div",{className:"text-xs text-slate-500",children:[q.count," booking",q.count!==1?"s":"","  ",q.clientCount," client",q.clientCount!==1?"s":""]})]}),i.jsx("div",{className:"text-sm font-bold text-violet-600 flex-shrink-0",children:Ji(q.revenue)})]},q.name))})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Insights"}),i.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Understanding your client base"}),i.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[i.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-100 p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:V.uniqueClients}),i.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Unique Clients"})]}),i.jsxs("div",{className:"bg-emerald-50 rounded-xl border border-emerald-100 p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-extrabold text-emerald-700",children:V.newThisMonth}),i.jsx("div",{className:"text-xs font-medium text-emerald-600 mt-0.5",children:"New This Month"})]}),i.jsxs("div",{className:"bg-blue-50 rounded-xl border border-blue-100 p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-extrabold text-blue-700",children:V.returningThisMonth}),i.jsx("div",{className:"text-xs font-medium text-blue-600 mt-0.5",children:"Returning This Month"})]}),i.jsxs("div",{className:"bg-violet-50 rounded-xl border border-violet-100 p-4 text-center",children:[i.jsx("div",{className:"text-2xl font-extrabold text-violet-700",children:V.avgBookingsPerClient.toFixed(1)}),i.jsx("div",{className:"text-xs font-medium text-violet-600 mt-0.5",children:"Avg Bookings / Client"})]})]}),i.jsx("h4",{className:"text-sm font-bold text-slate-700 mb-3",children:"Top Clients by Frequency"}),V.topClients.length===0?i.jsxs("div",{className:"text-center py-6",children:[i.jsx(ml,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),i.jsx("p",{className:"text-sm text-slate-400",children:"No client data yet"})]}):i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:V.topClients.map((q,D)=>i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[i.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center text-amber-700 font-bold text-xs flex-shrink-0",children:D+1}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:q.name}),i.jsx("div",{className:"text-xs text-slate-400 truncate",children:q.email})]}),i.jsxs("div",{className:"flex-shrink-0 px-2.5 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-bold",children:[q.count," visit",q.count!==1?"s":""]})]},q.email))})]})]})}function xE({waitingAhead:s=[],inProgress:e=[],staffCount:n=1,upcomingBookings:r=[],defaultDuration:o=30}){const u=Math.max(n,1),d=Date.now(),p=e.map(b=>{const _=b.startedAt?.toDate?.()||(b.startedAt?new Date(b.startedAt):null);if(!_)return 0;const E=(d-_.getTime())/6e4,A=b.estimatedDuration||o;return Math.max(0,A-E)});p.sort((b,_)=>b-_);const g=[];for(let b=0;b<u;b++)g.push(p[b]||0);g.sort((b,_)=>b-_);const x=s.map(b=>b.estimatedDuration||o);for(const b of x)g[0]+=b,g.sort((_,E)=>_-E);return Math.round(g[0])}function bE({waitingQueue:s=[],inProgress:e=[],staffCount:n=1,upcomingBookings:r=[],defaultDuration:o=30}){const u=new Map;for(let d=0;d<s.length;d++){const p=s.slice(0,d),g=xE({waitingAhead:p,inProgress:e,staffCount:n,upcomingBookings:r,defaultDuration:o});u.set(s[d].id,g)}return u}function cO(s=[],e=3){const n=new Date,r=new Date(n.getTime()+e*60*60*1e3),o=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`;return s.filter(u=>{if(u.status==="cancelled"||u.status==="rejected"||u.date!==o)return!1;const d=new Date(`${u.date}T${u.time}`);return d>=n&&d<=r}).sort((u,d)=>`${u.time}`.localeCompare(`${d.time}`))}function uO(s){if(!s)return"0m";const e=s?.toDate?.()||new Date(s),n=Math.floor((Date.now()-e.getTime())/6e4);if(n<1)return"<1m";if(n<60)return`${n}m`;const r=Math.floor(n/60),o=n%60;return o>0?`${r}h ${o}m`:`${r}h`}function dO(s){if(s==null)return"";if(s<1)return"Next up";if(s<60)return`~${s}m`;const e=Math.floor(s/60),n=s%60;return n>0?`~${e}h ${n}m`:`~${e}h`}function hO({shopId:s,services:e,staff:n,bookings:r}){const[o,u]=N.useState([]),[d,p]=N.useState(!1),[g,x]=N.useState(!1),[b,_]=N.useState(!1),[E,A]=N.useState({clientName:"",serviceId:"",staffId:"",estimatedDuration:30});N.useEffect(()=>{if(!s)return;const D=rn(st(Ee,"shops",s,"walkins"),k=>{const Y=k.docs.map(ie=>({id:ie.id,...ie.data()}));u(Y)});return()=>D()},[s]);const F=N.useMemo(()=>o.filter(D=>D.status==="waiting").sort((D,k)=>(D.position||0)-(k.position||0)),[o]),L=N.useMemo(()=>o.filter(D=>D.status==="in-progress").sort((D,k)=>{const Y=D.startedAt?.toDate?.()?.getTime()||0,ie=k.startedAt?.toDate?.()?.getTime()||0;return Y-ie}),[o]),O=N.useMemo(()=>{const D=new Date;return D.setHours(0,0,0,0),D},[]),U=N.useMemo(()=>o.filter(D=>{if(D.status!=="completed"&&D.status!=="no-show")return!1;const k=D.completedAt?.toDate?.()||(D.completedAt?new Date(D.completedAt):null);return k?k>=O:!1}).sort((D,k)=>{const Y=D.completedAt?.toDate?.()?.getTime()||0;return(k.completedAt?.toDate?.()?.getTime()||0)-Y}),[o,O]),G=N.useMemo(()=>Math.max(n.filter(D=>D.active!==!1).length,1),[n]),K=N.useMemo(()=>cO(r,3),[r]),fe=N.useMemo(()=>bE({waitingQueue:F,inProgress:L,staffCount:G,upcomingBookings:K,defaultDuration:30}),[F,L,G,K]),he=N.useMemo(()=>{const D=U.filter(Y=>Y.status==="completed"&&Y.joinedAt&&Y.startedAt).map(Y=>{const ie=Y.joinedAt?.toDate?.()||new Date(Y.joinedAt),Te=Y.startedAt?.toDate?.()||new Date(Y.startedAt);return Math.floor((Te.getTime()-ie.getTime())/6e4)}).filter(Y=>Y>=0),k=D.length>0?Math.round(D.reduce((Y,ie)=>Y+ie,0)/D.length):0;return{waiting:F.length,avgWait:k,completedToday:U.filter(Y=>Y.status==="completed").length}},[F,U]),oe=D=>{const k=e.find(Y=>Y.id===D);A(Y=>({...Y,serviceId:D,estimatedDuration:k?.duration||30}))},j=()=>F.length===0?1:Math.max(...F.map(D=>D.position||0))+1,T=N.useMemo(()=>o.filter(D=>{const k=D.joinedAt?.toDate?.()||(D.joinedAt?new Date(D.joinedAt):null);return k&&k>=O}).length,[o,O]),R=async D=>{D.preventDefault(),_(!0);const k=e.find(ve=>ve.id===E.serviceId),Y=n.find(ve=>ve.id===E.staffId),ie=j(),Te=E.clientName.trim()||`Walk-in #${T+1}`;try{await yr(st(Ee,"shops",s,"walkins"),{clientName:Te,serviceId:E.serviceId||null,serviceName:k?.name||null,staffId:E.staffId||null,staffName:Y?.name||null,estimatedDuration:parseInt(E.estimatedDuration)||30,status:"waiting",position:ie,joinedAt:kt.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),A({clientName:"",serviceId:"",staffId:"",estimatedDuration:30}),p(!1)}catch(ve){console.error("Error adding walk-in:",ve)}finally{_(!1)}},V=async D=>{try{await ot(Je(Ee,"shops",s,"walkins",D),{status:"in-progress",startedAt:kt.now()});const k=F.filter(Y=>Y.id!==D).sort((Y,ie)=>(Y.position||0)-(ie.position||0));for(let Y=0;Y<k.length;Y++)await ot(Je(Ee,"shops",s,"walkins",k[Y].id),{position:Y+1})}catch(k){console.error("Error starting service:",k)}},M=async D=>{try{await ot(Je(Ee,"shops",s,"walkins",D),{status:"completed",completedAt:kt.now()})}catch(k){console.error("Error completing service:",k)}},z=async D=>{try{await ot(Je(Ee,"shops",s,"walkins",D),{status:"no-show",completedAt:kt.now()});const k=F.filter(Y=>Y.id!==D).sort((Y,ie)=>(Y.position||0)-(ie.position||0));for(let Y=0;Y<k.length;Y++)await ot(Je(Ee,"shops",s,"walkins",k[Y].id),{position:Y+1})}catch(k){console.error("Error marking no-show:",k)}},I=async D=>{const k=F.findIndex(Te=>Te.id===D);if(k<=0)return;const Y=F[k-1],ie=F[k];try{await ot(Je(Ee,"shops",s,"walkins",ie.id),{position:Y.position}),await ot(Je(Ee,"shops",s,"walkins",Y.id),{position:ie.position})}catch(Te){console.error("Error reordering:",Te)}},q=async D=>{const k=F.findIndex(Te=>Te.id===D);if(k<0||k>=F.length-1)return;const Y=F[k+1],ie=F[k];try{await ot(Je(Ee,"shops",s,"walkins",ie.id),{position:Y.position}),await ot(Je(Ee,"shops",s,"walkins",Y.id),{position:ie.position})}catch(Te){console.error("Error reordering:",Te)}};return i.jsxs("div",{className:"animate-fade-in",children:[i.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[{label:"Currently Waiting",value:he.waiting,icon:ln,color:"bg-blue-100 text-blue-600"},{label:"Avg Wait",value:he.avgWait>0?`${he.avgWait}m`:"",icon:tE,color:"bg-amber-100 text-amber-600"},{label:"Completed Today",value:he.completedToday,icon:X0,color:"bg-emerald-100 text-emerald-600"}].map(D=>{const k=D.icon;return i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("div",{className:`w-10 h-10 ${D.color} rounded-xl flex items-center justify-center`,children:i.jsx(k,{className:"w-5 h-5"})})}),i.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:D.value}),i.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:D.label})]},D.label)})}),K.length>0&&i.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(fl,{className:"w-4 h-4 text-amber-600"}),i.jsx("span",{className:"text-sm font-bold text-amber-800",children:"Upcoming Online Bookings"})]}),i.jsx("div",{className:"space-y-1",children:K.slice(0,5).map(D=>{const[k,Y]=(D.time||"").split(":"),ie=parseInt(k),Te=`${ie%12||12}:${Y} ${ie>=12?"PM":"AM"}`;return i.jsxs("div",{className:"text-xs text-amber-700 flex items-center gap-2",children:[i.jsx(Dn,{className:"w-3 h-3"}),i.jsx("span",{className:"font-medium",children:Te}),i.jsx("span",{children:""}),i.jsx("span",{children:D.clientName}),D.serviceName&&i.jsxs("span",{className:"text-amber-500",children:["(",D.serviceName,")"]}),D.staffName&&i.jsxs("span",{className:"text-violet-600",children:["with ",D.staffName]})]},D.id)})})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Walk-in Queue"}),!d&&i.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[i.jsx(xi,{className:"w-4 h-4"}),"Add Walk-in"]})]}),d&&i.jsxs("form",{onSubmit:R,className:"mb-5 p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[i.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3",children:"New Walk-in"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Client Name"}),i.jsx("input",{type:"text",value:E.clientName,onChange:D=>A(k=>({...k,clientName:D.target.value})),placeholder:`Walk-in #${T+1}`,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Service"}),i.jsxs("select",{value:E.serviceId,onChange:D=>oe(D.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[i.jsx("option",{value:"",children:"No service selected"}),e.map(D=>i.jsxs("option",{value:D.id,children:[D.name," (",D.duration,"min)"]},D.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Staff Preference"}),i.jsxs("select",{value:E.staffId,onChange:D=>A(k=>({...k,staffId:D.target.value})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[i.jsx("option",{value:"",children:"Next available"}),n.map(D=>i.jsx("option",{value:D.id,children:D.name},D.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Est. Duration (min)"}),i.jsx("select",{value:E.estimatedDuration,onChange:D=>A(k=>({...k,estimatedDuration:parseInt(D.target.value)})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[15,30,45,60,90,120].map(D=>i.jsx("option",{value:D,children:D<60?`${D} min`:`${D/60}h${D%60?` ${D%60}m`:""}`},D))})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{type:"submit",disabled:b,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[i.jsx(xi,{className:"w-4 h-4"}),b?"Adding":"Add to Queue"]}),i.jsx("button",{type:"button",onClick:()=>{p(!1),A({clientName:"",serviceId:"",staffId:"",estimatedDuration:30})},className:"px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Cancel"})]})]}),F.length===0&&L.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:i.jsx(ln,{className:"w-6 h-6 text-slate-400"})}),i.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No walk-ins in queue"}),i.jsx("p",{className:"text-xs text-slate-400",children:"Add a walk-in client to start the queue."})]}):i.jsxs(i.Fragment,{children:[F.length>0&&i.jsxs("div",{className:"mb-5",children:[i.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[i.jsx(Dn,{className:"w-4 h-4 text-blue-500"}),"Waiting",i.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:F.length})]}),i.jsx("div",{className:"space-y-2",children:F.map((D,k)=>{const Y=fe.get(D.id);return i.jsxs("div",{className:"group flex items-center gap-3 border border-slate-200 rounded-xl p-3.5 hover:border-slate-300 hover:shadow-sm transition-all",children:[i.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[i.jsx("button",{onClick:()=>I(D.id),disabled:k===0,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:i.jsx(kg,{className:"w-4 h-4"})}),i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center font-bold text-blue-700 text-sm",children:k+1}),i.jsx("button",{onClick:()=>q(D.id),disabled:k===F.length-1,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:i.jsx(Rg,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[i.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:D.clientName}),i.jsx("span",{className:"px-2 py-0.5 bg-blue-50 text-blue-600 border border-blue-200 text-[10px] font-bold rounded-md",children:"WAITING"})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[D.serviceName&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ps,{className:"w-3 h-3 text-blue-400"}),D.serviceName]}),D.staffName&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ml,{className:"w-3 h-3 text-violet-400"}),D.staffName]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Dn,{className:"w-3 h-3"}),D.estimatedDuration||30,"min"]})]})]}),i.jsxs("div",{className:"text-right mr-2",children:[i.jsx("div",{className:"text-sm font-bold text-amber-600",children:dO(Y)}),i.jsx("div",{className:"text-[10px] text-slate-400",children:"est. wait"})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsxs("button",{onClick:()=>V(D.id),className:"flex items-center gap-1 px-3 py-2 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 border border-emerald-200 rounded-lg text-xs font-semibold transition-all",title:"Start Service",children:[i.jsx(Wp,{className:"w-3.5 h-3.5"}),i.jsx("span",{className:"hidden sm:inline",children:"Start"})]}),i.jsxs("button",{onClick:()=>z(D.id),className:"flex items-center gap-1 px-3 py-2 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all",title:"No-show",children:[i.jsx(Ca,{className:"w-3.5 h-3.5"}),i.jsx("span",{className:"hidden sm:inline",children:"No-show"})]})]})]},D.id)})})]}),L.length>0&&i.jsxs("div",{className:"mb-5",children:[i.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[i.jsx(Wp,{className:"w-4 h-4 text-emerald-500"}),"In Progress",i.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 border border-emerald-200 text-xs font-bold rounded-full",children:L.length})]}),i.jsx("div",{className:"space-y-2",children:L.map(D=>i.jsxs("div",{className:"flex items-center gap-3 border border-emerald-200 bg-emerald-50/50 rounded-xl p-3.5 transition-all",children:[i.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center",children:i.jsx(Wp,{className:"w-4 h-4 text-emerald-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[i.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:D.clientName}),i.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 text-[10px] font-bold rounded-md",children:"IN PROGRESS"})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[D.serviceName&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ps,{className:"w-3 h-3 text-blue-400"}),D.serviceName]}),D.staffName&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ml,{className:"w-3 h-3 text-violet-400"}),D.staffName]})]})]}),i.jsxs("div",{className:"text-right mr-2",children:[i.jsx("div",{className:"text-sm font-bold text-emerald-600",children:uO(D.startedAt)}),i.jsx("div",{className:"text-[10px] text-slate-400",children:"elapsed"})]}),i.jsxs("button",{onClick:()=>M(D.id),className:"flex items-center gap-1 px-3 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 rounded-lg text-xs font-semibold transition-all",title:"Complete",children:[i.jsx(Is,{className:"w-3.5 h-3.5"}),i.jsx("span",{className:"hidden sm:inline",children:"Complete"})]})]},D.id))})]})]})]}),U.length>0&&i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsxs("button",{onClick:()=>x(!g),className:"w-full flex items-center justify-between",children:[i.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[i.jsx(Is,{className:"w-4 h-4 text-slate-400"}),"Completed Today",i.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-500 border border-slate-200 text-xs font-bold rounded-full",children:U.length})]}),i.jsx(Sf,{className:`w-4 h-4 text-slate-400 transition-transform ${g?"rotate-90":""}`})]}),g&&i.jsx("div",{className:"mt-3 space-y-2",children:U.map(D=>i.jsxs("div",{className:"flex items-center gap-3 border border-slate-100 rounded-lg p-3 bg-slate-50/50",children:[i.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center bg-slate-100",children:D.status==="no-show"?i.jsx(Ca,{className:"w-3.5 h-3.5 text-red-400"}):i.jsx(Is,{className:"w-3.5 h-3.5 text-emerald-400"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-slate-700 text-sm truncate",children:D.clientName}),i.jsx("span",{className:`text-[10px] font-bold rounded-md px-1.5 py-0.5 border ${D.status==="no-show"?"bg-red-50 text-red-600 border-red-200":"bg-emerald-50 text-emerald-600 border-emerald-200"}`,children:D.status==="no-show"?"NO-SHOW":"COMPLETED"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[D.serviceName&&i.jsx("span",{children:D.serviceName}),D.staffName&&i.jsxs("span",{children:[" ",D.staffName]})]})]})]},D.id))})]})]})}function fO(s,e){const n=new Date(s+"T12:00:00"),r=e.getTime()-n.getTime();return Math.floor(r/864e5)}function oh(s){return`$${Number(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function zc(s){return s?new Date(s+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function mO(s,e,n){return s>90?"lost":s>n?"at-risk":s>e?"getting-cold":"active"}const ch={active:{label:"Active",bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200",icon:Q0,iconColor:"text-emerald-500"},"getting-cold":{label:"Getting Cold",bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",icon:eE,iconColor:"text-amber-500"},"at-risk":{label:"At Risk",bg:"bg-orange-50",text:"text-orange-700",border:"border-orange-200",icon:fl,iconColor:"text-orange-500"},lost:{label:"Lost",bg:"bg-red-50",text:"text-red-700",border:"border-red-200",icon:nD,iconColor:"text-red-500"}};function pO({shopId:s,bookings:e,shop:n,slug:r}){const[o,u]=N.useState({}),[d,p]=N.useState(null),[g,x]=N.useState(null),[b,_]=N.useState(""),[E,A]=N.useState(""),[F,L]=N.useState("all"),[O,U]=N.useState("lastVisit"),[G,K]=N.useState("asc"),[fe,he]=N.useState(null),[oe,j]=N.useState(!1),[T,R]=N.useState(null),[V,M]=N.useState(!1),[z,I]=N.useState(null),q=n?.winbackSettings?.warningDays||30,D=n?.winbackSettings?.inactiveDays||60,k=n?.winbackSettings?.enabled!==!1,Y=Q=>Q.toLowerCase().replace(/\./g,"_dot_").replace(/@/g,"_at_");N.useEffect(()=>{if(!s)return;const Q=rn(st(Ee,"shops",s,"clientNotes"),we=>{const Ie={};we.docs.forEach(He=>{Ie[He.id]=He.data()}),u(Ie)});return()=>Q()},[s]);const ie=N.useMemo(()=>new Date,[]),Te=N.useMemo(()=>e.filter(Q=>Q.status==="confirmed"||Q.status==="pending"||!Q.status),[e]),ve=N.useMemo(()=>{const Q={};return Te.forEach(we=>{const Ie=we.clientEmail?.toLowerCase();if(!Ie)return;Q[Ie]||(Q[Ie]={email:Ie,name:we.clientName||Ie,phone:we.clientPhone||"",totalVisits:0,totalSpent:0,lastVisitDate:null,firstVisitDate:null,bookings:[],serviceFrequency:{},staffFrequency:{}});const He=Q[Ie];we.clientName&&(He.name=we.clientName),we.clientPhone&&(He.phone=we.clientPhone),He.totalVisits++,He.totalSpent+=Number(we.servicePrice)||0,He.bookings.push(we),(!He.lastVisitDate||we.date>He.lastVisitDate)&&(He.lastVisitDate=we.date),(!He.firstVisitDate||we.date<He.firstVisitDate)&&(He.firstVisitDate=we.date),we.serviceName&&(He.serviceFrequency[we.serviceName]=(He.serviceFrequency[we.serviceName]||0)+1),we.staffName&&(He.staffFrequency[we.staffName]=(He.staffFrequency[we.staffName]||0)+1)}),Object.values(Q).map(we=>{const Ie=we.lastVisitDate?fO(we.lastVisitDate,ie):999,He=mO(Ie,q,D),Ve=Object.entries(we.serviceFrequency).sort((Ae,Pe)=>Pe[1]-Ae[1])[0]?.[0]||null,ft=Object.entries(we.staffFrequency).sort((Ae,Pe)=>Pe[1]-Ae[1])[0]?.[0]||null,Kn=we.totalVisits>0?we.totalSpent/we.totalVisits:0,Tt=Y(we.email),vt=o[Tt];return{...we,daysSinceLastVisit:Ie,status:He,favoriteService:Ve,favoriteStaff:ft,avgSpending:Kn,encodedEmail:Tt,notes:vt?.notes||"",contacted:vt?.contacted||!1,contactedAt:vt?.contactedAt||null,tags:vt?.tags||[]}})},[Te,ie,q,D,o]),P=N.useMemo(()=>{const Q={all:ve.length,active:0,"getting-cold":0,"at-risk":0,lost:0};return ve.forEach(we=>{Q[we.status]++}),Q},[ve]),ee=N.useMemo(()=>ve.filter(Q=>(Q.status==="at-risk"||Q.status==="lost")&&!Q.contacted),[ve]),le=N.useMemo(()=>{let Q=ve;if(E.trim()){const we=E.toLowerCase();Q=Q.filter(Ie=>Ie.name.toLowerCase().includes(we)||Ie.email.includes(we)||Ie.phone.includes(we))}return F!=="all"&&(Q=Q.filter(we=>we.status===F)),Q=[...Q].sort((we,Ie)=>{if(O==="lastVisit"){const He=(we.lastVisitDate||"").localeCompare(Ie.lastVisitDate||"");return G==="asc"?He:-He}return O==="totalVisits"?G==="desc"?Ie.totalVisits-we.totalVisits:we.totalVisits-Ie.totalVisits:O==="totalSpent"?G==="desc"?Ie.totalSpent-we.totalSpent:we.totalSpent-Ie.totalSpent:0}),Q},[ve,E,F,O,G]),xe=Q=>{O===Q?K(we=>we==="asc"?"desc":"asc"):(U(Q),K(Q==="lastVisit"?"asc":"desc"))},be=N.useCallback(Q=>{const we=n?.name||"our shop",Ie=`${window.location.origin}${window.location.pathname}#/shop/${r}`;return`Hi ${Q.name.split(" ")[0]}, we miss you at ${we}! It's been ${Q.daysSinceLastVisit} days since your last visit.${Q.favoriteService?` Book your next ${Q.favoriteService} today:`:" Book your next appointment:"} ${Ie}`},[n,r]),Re=Q=>{const we=be(Q);R({email:Q.email,encodedEmail:Q.encodedEmail,name:Q.name,message:we})},ue=async(Q,we)=>{try{await navigator.clipboard.writeText(Q),he(we),setTimeout(()=>he(null),2e3)}catch(Ie){console.error("Failed to copy:",Ie)}},Ue=async Q=>{I(Q);try{const we=Je(Ee,"shops",s,"clientNotes",Q),Ie=await qp(we),He=Ie.exists()?Ie.data():{};await Fp(we,{...He,contacted:!0,contactedAt:new Date().toISOString()}),R(null)}catch(we){console.error("Error marking as contacted:",we)}finally{I(null)}},Be=async Q=>{try{const we=Je(Ee,"shops",s,"clientNotes",Q),Ie=await qp(we),He=Ie.exists()?Ie.data():{};await Fp(we,{...He,contacted:!1,contactedAt:null})}catch(we){console.error("Error resetting contacted status:",we)}},We=async Q=>{M(!0);try{const we=Je(Ee,"shops",s,"clientNotes",Q),Ie=await qp(we),He=Ie.exists()?Ie.data():{};await Fp(we,{...He,notes:b}),x(null)}catch(we){console.error("Error saving notes:",we)}finally{M(!1)}};return i.jsxs("div",{className:"animate-fade-in space-y-6",children:[k&&ee.length>0&&i.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-5",children:[i.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>j(!oe),children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:i.jsx(fl,{className:"w-5 h-5 text-orange-600"})}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[ee.length," client",ee.length!==1?"s":""," need",ee.length===1?"s":""," attention"]}),i.jsxs("p",{className:"text-xs text-slate-500",children:["Haven't visited in over ",D," days  send a win-back message to re-engage"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"px-2.5 py-1 bg-orange-100 text-orange-700 border border-orange-200 text-xs font-bold rounded-lg",children:ee.length}),oe?i.jsx(kg,{className:"w-5 h-5 text-slate-400"}):i.jsx(Rg,{className:"w-5 h-5 text-slate-400"})]})]}),oe&&i.jsx("div",{className:"mt-4 space-y-2.5",children:ee.sort((Q,we)=>we.daysSinceLastVisit-Q.daysSinceLastVisit).map(Q=>i.jsxs("div",{className:"bg-white rounded-xl border border-orange-100 p-4 flex items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[i.jsx("div",{className:"w-9 h-9 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(ml,{className:"w-4 h-4 text-orange-600"})}),i.jsxs("div",{className:"min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:Q.name}),i.jsxs("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${ch[Q.status].bg} ${ch[Q.status].text} ${ch[Q.status].border}`,children:[Q.daysSinceLastVisit," days ago"]})]}),i.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 flex-wrap mt-0.5",children:[i.jsxs("span",{children:["Last: ",zc(Q.lastVisitDate)]}),Q.favoriteService&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-slate-300",children:""}),i.jsxs("span",{className:"text-blue-600",children:["Loves ",Q.favoriteService]})]}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsxs("span",{children:[Q.totalVisits," visit",Q.totalVisits!==1?"s":""]})]})]})]}),i.jsxs("button",{onClick:we=>{we.stopPropagation(),Re(Q)},className:"flex items-center gap-1.5 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-xl text-xs font-semibold transition-all shadow-sm flex-shrink-0",children:[i.jsx(_h,{className:"w-3.5 h-3.5"}),"Send Win-back"]})]},Q.email))})]}),T&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:i.jsx(xD,{className:"w-5 h-5 text-orange-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Win-back Message"}),i.jsxs("p",{className:"text-sm text-slate-500",children:["Send to ",T.name]})]})]}),i.jsx("div",{className:"bg-slate-50 rounded-xl p-4 mb-4 border border-slate-200",children:i.jsx("textarea",{value:T.message,onChange:Q=>R({...T,message:Q.target.value}),rows:4,className:"w-full bg-transparent text-sm text-slate-700 resize-none focus:outline-none leading-relaxed"})}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>{ue(T.message,T.email)},className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:fe===T.email?i.jsxs(i.Fragment,{children:[i.jsx(oi,{className:"w-4 h-4"}),"Copied!"]}):i.jsxs(i.Fragment,{children:[i.jsx(K3,{className:"w-4 h-4"}),"Copy to Clipboard"]})}),i.jsxs("button",{onClick:()=>Ue(T.encodedEmail),disabled:z===T.encodedEmail,className:"flex items-center justify-center gap-2 px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-emerald-600/20 disabled:opacity-50",children:[i.jsx(oi,{className:"w-4 h-4"}),"Mark Contacted"]}),i.jsx("button",{onClick:()=>R(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Close"})]})]})}),i.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Clients",value:P.all,icon:ln,color:"bg-blue-100 text-blue-600"},{label:"Active",value:P.active,icon:Q0,color:"bg-emerald-100 text-emerald-600"},{label:"Getting Cold",value:P["getting-cold"],icon:eE,color:"bg-amber-100 text-amber-600"},{label:"At Risk / Lost",value:P["at-risk"]+P.lost,icon:fl,color:"bg-red-100 text-red-600"}].map(Q=>{const we=Q.icon;return i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("div",{className:`w-10 h-10 ${Q.color} rounded-xl flex items-center justify-center`,children:i.jsx(we,{className:"w-5 h-5"})})}),i.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Q.value}),i.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:Q.label})]},Q.label)})}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Clients"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Derived from booking history"})]}),i.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[le.length," client",le.length!==1?"s":""]})]}),i.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[i.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[i.jsx(kD,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2"}),i.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:E,onChange:Q=>A(Q.target.value),className:"w-full pl-10 pr-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),E&&i.jsx("button",{onClick:()=>A(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:i.jsx(La,{className:"w-4 h-4 text-slate-400 hover:text-slate-600"})})]}),i.jsx("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl overflow-x-auto",children:[{key:"all",label:"All"},{key:"active",label:"Active"},{key:"getting-cold",label:"Cold"},{key:"at-risk",label:"At Risk"},{key:"lost",label:"Lost"}].map(Q=>i.jsxs("button",{onClick:()=>L(Q.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap ${F===Q.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[Q.label,i.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${F===Q.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:P[Q.key]??0})]},Q.key))}),i.jsx("div",{className:"flex items-center gap-1",children:[{key:"lastVisit",label:"Last Visit"},{key:"totalVisits",label:"Visits"},{key:"totalSpent",label:"Spent"}].map(Q=>i.jsxs("button",{onClick:()=>xe(Q.key),className:`flex items-center gap-1 px-3 py-2 rounded-lg text-xs font-semibold transition-all border ${O===Q.key?"bg-blue-50 text-blue-700 border-blue-200":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[Q.label,O===Q.key&&i.jsx(S3,{className:"w-3 h-3"})]},Q.key))})]}),le.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:i.jsx(ln,{className:"w-6 h-6 text-slate-400"})}),i.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No clients found"}),i.jsx("p",{className:"text-xs text-slate-400",children:E?"Try a different search term":"Client data will appear as bookings come in"})]}):i.jsx("div",{className:"space-y-2",children:le.map(Q=>{const we=d===Q.email,Ie=ch[Q.status],He=Ie.icon;return i.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden hover:border-slate-300 transition-all",children:[i.jsxs("div",{className:"flex items-center gap-3 p-4 cursor-pointer hover:bg-slate-50/50 transition-all",onClick:()=>p(we?null:Q.email),children:[i.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(ml,{className:"w-4 h-4 text-blue-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:Q.name}),i.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-bold rounded-md border ${Ie.bg} ${Ie.text} ${Ie.border}`,children:[i.jsx(He,{className:"w-3 h-3"}),Ie.label]}),Q.contacted&&i.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",children:[i.jsx(_h,{className:"w-2.5 h-2.5"}),"Contacted"]}),Q.notes&&i.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-violet-50 text-violet-600 border-violet-200",children:i.jsx(w_,{className:"w-2.5 h-2.5"})})]}),i.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-3 mt-0.5 flex-wrap",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Dg,{className:"w-3 h-3"}),Q.email]}),Q.phone&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Mg,{className:"w-3 h-3"}),Q.phone]})]})]}),i.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-shrink-0",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-sm font-bold text-slate-900",children:Q.totalVisits}),i.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-sm font-bold text-blue-600",children:oh(Q.totalSpent)}),i.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-sm font-bold text-slate-700",children:zc(Q.lastVisitDate)}),i.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),i.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(Q.status==="at-risk"||Q.status==="lost")&&!Q.contacted&&i.jsx("button",{onClick:Ve=>{Ve.stopPropagation(),Re(Q)},className:"p-2 text-orange-500 hover:text-orange-700 hover:bg-orange-50 rounded-lg transition-all",title:"Send win-back message",children:i.jsx(_h,{className:"w-4 h-4"})}),we?i.jsx(kg,{className:"w-4 h-4 text-slate-400"}):i.jsx(Rg,{className:"w-4 h-4 text-slate-400"})]})]}),we&&i.jsxs("div",{className:"border-t border-slate-200 bg-slate-50/50 p-5 space-y-5",children:[i.jsxs("div",{className:"sm:hidden grid grid-cols-3 gap-3",children:[i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[i.jsx("div",{className:"text-lg font-bold text-slate-900",children:Q.totalVisits}),i.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[i.jsx("div",{className:"text-lg font-bold text-blue-600",children:oh(Q.totalSpent)}),i.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[i.jsx("div",{className:"text-sm font-bold text-slate-700",children:zc(Q.lastVisitDate)}),i.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[i.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Avg per Visit"}),i.jsx("div",{className:"text-sm font-bold text-slate-900",children:oh(Q.avgSpending)})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[i.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"First Visit"}),i.jsx("div",{className:"text-sm font-bold text-slate-900",children:zc(Q.firstVisitDate)})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[i.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Days Since Last Visit"}),i.jsxs("div",{className:"text-sm font-bold text-slate-900",children:[Q.daysSinceLastVisit,"d"]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[i.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Favorite Service"}),i.jsx("div",{className:"text-sm font-bold text-blue-600 truncate",children:Q.favoriteService||""})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[i.jsx(ps,{className:"w-3.5 h-3.5 text-blue-500"}),"Services Used"]}),i.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(Q.serviceFrequency).sort((Ve,ft)=>ft[1]-Ve[1]).map(([Ve,ft])=>i.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg text-xs font-medium",children:[Ve,i.jsxs("span",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[ft,""]})]},Ve))})]}),Object.keys(Q.staffFrequency).length>0&&i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[i.jsx(ln,{className:"w-3.5 h-3.5 text-violet-500"}),"Staff Members Seen"]}),i.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(Q.staffFrequency).sort((Ve,ft)=>ft[1]-Ve[1]).map(([Ve,ft])=>i.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-violet-50 text-violet-700 border border-violet-200 rounded-lg text-xs font-medium",children:[Ve,i.jsxs("span",{className:"bg-violet-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[ft,""]})]},Ve))})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[i.jsx(zt,{className:"w-3.5 h-3.5 text-emerald-500"}),"Booking History",i.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",Q.bookings.length,")"]})]}),i.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:Q.bookings.sort((Ve,ft)=>(ft.date+ft.time).localeCompare(Ve.date+Ve.time)).map((Ve,ft)=>i.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded-lg hover:bg-slate-50 text-xs",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-slate-700",children:zc(Ve.date)}),i.jsx("span",{className:"text-slate-400",children:Ve.time}),Ve.serviceName&&i.jsx("span",{className:"text-blue-600",children:Ve.serviceName})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[Ve.staffName&&i.jsx("span",{className:"text-violet-600",children:Ve.staffName}),Ve.servicePrice!=null&&i.jsx("span",{className:"font-semibold text-slate-900",children:oh(Ve.servicePrice)})]})]},ft))})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-700 flex items-center gap-1.5",children:[i.jsx(w_,{className:"w-3.5 h-3.5 text-amber-500"}),"Notes"]}),g!==Q.encodedEmail&&i.jsx("button",{onClick:()=>{x(Q.encodedEmail),_(Q.notes||"")},className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:Q.notes?"Edit":"Add Notes"})]}),g===Q.encodedEmail?i.jsxs("div",{className:"space-y-2",children:[i.jsx("textarea",{value:b,onChange:Ve=>_(Ve.target.value),placeholder:"Add notes about this client (e.g., preferences, allergies, favorite styles...)",rows:3,className:"w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>We(Q.encodedEmail),disabled:V,className:"px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:V?"Saving...":"Save"}),i.jsx("button",{onClick:()=>x(null),className:"px-4 py-1.5 bg-white hover:bg-slate-50 text-slate-600 border border-slate-200 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}):i.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:Q.notes||'No notes yet. Click "Add Notes" to save preferences, allergies, or anything useful.'})]}),Q.contacted&&i.jsxs("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg px-4 py-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[i.jsx(oi,{className:"w-4 h-4"}),i.jsxs("span",{className:"font-medium",children:["Contacted",Q.contactedAt?` on ${new Date(Q.contactedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`:""]})]}),i.jsx("button",{onClick:()=>Be(Q.encodedEmail),className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:"Reset"})]})]})]},Q.email)})})]})]})}const gO=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function eg(s){const[e,n]=s.split(":").map(Number);return e*60+n}function xO(s,e){if(s.status!=="waiting"||s.serviceId&&e.serviceId&&s.serviceId!==e.serviceId||s.staffId&&s.staffId!=="any"&&e.staffId&&s.staffId!==e.staffId)return!1;if(e.date){if(s.preferredDate&&s.preferredDate!==e.date)return!1;if(s.preferredDays&&s.preferredDays.length>0){const n=new Date(e.date+"T12:00:00"),r=gO[n.getDay()];if(!s.preferredDays.includes(r))return!1}}if(e.time&&s.preferredTimeRange){const n=eg(e.time),r=eg(s.preferredTimeRange.start),o=eg(s.preferredTimeRange.end);if(!(s.preferredTimeRange.start==="00:00"&&s.preferredTimeRange.end==="23:59")&&(n<r||n>o))return!1}return!0}function bO(s,e){return s.filter(n=>xO(n,e)).sort((n,r)=>(n.createdAt||"").localeCompare(r.createdAt||""))}const U_=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}];function Zi(s){if(!s)return"";const[e,n]=s.split(":").map(Number),r=e>=12?"PM":"AM",o=e%12||12;return n===0?`${o}${r}`:`${o}:${n.toString().padStart(2,"0")}${r}`}function yO({user:s}){const{slug:e}=ko(),n=Ro(),[r,o]=N.useState(null),[u,d]=N.useState(null),[p,g]=N.useState(!0),[x,b]=N.useState(!1),[_,E]=N.useState([]),[A,F]=N.useState([]),[L,O]=N.useState([]),[U,G]=N.useState([]),[K,fe]=N.useState("schedule"),[he,oe]=N.useState(null),[j,T]=N.useState("all"),[R,V]=N.useState("all"),[M,z]=N.useState([]),[I,q]=N.useState(null),[D,k]=N.useState(null),[Y,ie]=N.useState({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""});N.useEffect(()=>{if(!s){n(`/shop/${e}/login`,{replace:!0});return}(async()=>{g(!0);try{const se=Ds(st(Ee,"shops"),fs("slug","==",e)),Ne=await Ms(se);if(Ne.empty){b(!0),g(!1);return}const _e=Ne.docs[0],$e=_e.data();if($e.ownerUid!==s.uid){b(!0),g(!1);return}o($e),d(_e.id)}catch(se){console.error("Error checking ownership:",se),b(!0)}finally{g(!1)}})()},[s,e,n]),N.useEffect(()=>{if(!u)return;const H=rn(st(Ee,"shops",u,"availability"),et=>{const qt=et.docs.map(ze=>({id:ze.id,...ze.data()}));E(qt)}),se=rn(st(Ee,"shops",u,"bookings"),et=>{const qt=et.docs.map(ze=>({id:ze.id,...ze.data()}));F(qt)}),Ne=rn(st(Ee,"shops",u,"staff"),et=>{const qt=et.docs.map(ze=>({id:ze.id,...ze.data()})).filter(ze=>ze.active!==!1).sort((ze,me)=>(ze.name||"").localeCompare(me.name||""));O(qt)}),_e=rn(st(Ee,"shops",u,"waitlist"),et=>{const qt=et.docs.map(ze=>({id:ze.id,...ze.data()})).sort((ze,me)=>(ze.createdAt||"").localeCompare(me.createdAt||""));z(qt)}),$e=rn(st(Ee,"shops",u,"services"),et=>{const qt=et.docs.map(ze=>({id:ze.id,...ze.data()})).filter(ze=>ze.active!==!1).sort((ze,me)=>(ze.name||"").localeCompare(me.name||""));G(qt)});return()=>{H(),se(),Ne(),_e(),$e()}},[u]);const Te=async()=>{await yC(hl),n(`/shop/${e}`,{replace:!0})},ve=async H=>{H.preventDefault();const{date:se,startTime:Ne,endTime:_e,slotDuration:$e,staffId:et}=Y,qt=parseInt($e),[ze,me]=Ne.split(":").map(Number),[Se,Xe]=_e.split(":").map(Number),tt=ze*60+me,Et=Se*60+Xe;let Le=tt;for(;Le+qt<=Et;){const Ge=Math.floor(Le/60),Dt=Le%60,tn=`${Ge.toString().padStart(2,"0")}:${Dt.toString().padStart(2,"0")}`,Fn={date:se,time:tn,duration:qt,available:!0};if(et){const ns=L.find(Xs=>Xs.id===et);Fn.staffId=et,Fn.staffName=ns?.name||""}await yr(st(Ee,"shops",u,"availability"),Fn),Le+=qt}ie({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""})},P=async H=>{await JI(Je(Ee,"shops",u,"availability",H))},ee=H=>{const se={date:H.date,time:H.time,staffId:H.staffId||null,serviceId:H.serviceId||null},Ne=bO(M,se);Ne.length>0&&q({matches:Ne,slot:se})},le=async(H,se)=>{for(const Ne of H)await ot(Je(Ee,"shops",u,"waitlist",Ne.id),{status:"notified",notifiedAt:new Date().toISOString(),notifiedSlot:{date:se.date,time:se.time,staffId:se.staffId||null,staffName:se.staffName||null}});q(null)},xe=async H=>{await ot(Je(Ee,"shops",u,"waitlist",H),{status:"notified",notifiedAt:new Date().toISOString()})},be=async H=>{await ot(Je(Ee,"shops",u,"waitlist",H),{status:"expired"})},Re=async H=>{const se=A.find(Ne=>Ne.id===H);if(se&&se.recurringGroupId){k({bookingId:H,recurringGroupId:se.recurringGroupId});return}if(await ot(Je(Ee,"shops",u,"bookings",H),{status:"cancelled"}),se&&se.slotId&&!se.slotId.startsWith("wh-")&&!se.slotId.startsWith("recurring-"))try{await ot(Je(Ee,"shops",u,"availability",se.slotId),{available:!0})}catch(Ne){console.warn("Could not re-open slot:",Ne)}se&&ee(se)},ue=async H=>{const se=A.find(Ne=>Ne.id===H);if(await ot(Je(Ee,"shops",u,"bookings",H),{status:"cancelled"}),se&&se.slotId&&!se.slotId.startsWith("wh-")&&!se.slotId.startsWith("recurring-"))try{await ot(Je(Ee,"shops",u,"availability",se.slotId),{available:!0})}catch(Ne){console.warn("Could not re-open slot:",Ne)}se&&ee(se),k(null)},Ue=async(H,se)=>{const Ne=A.find($e=>$e.id===H);if(!Ne)return;const _e=A.filter($e=>$e.recurringGroupId===se&&$e.date>=Ne.date&&($e.status==="pending"||$e.status==="confirmed"));for(const $e of _e)if(await ot(Je(Ee,"shops",u,"bookings",$e.id),{status:"cancelled"}),$e.slotId&&!$e.slotId.startsWith("wh-")&&!$e.slotId.startsWith("recurring-"))try{await ot(Je(Ee,"shops",u,"availability",$e.slotId),{available:!0})}catch(et){console.warn("Could not re-open slot:",et)}Ne&&ee(Ne),k(null)},Be=async H=>{await ot(Je(Ee,"shops",u,"bookings",H),{status:"confirmed"})},We=async H=>{const se=A.find(Ne=>Ne.id===H);if(await ot(Je(Ee,"shops",u,"bookings",H),{status:"rejected"}),se&&se.slotId&&!se.slotId.startsWith("wh-"))try{await ot(Je(Ee,"shops",u,"availability",se.slotId),{available:!0})}catch(Ne){console.warn("Could not re-open slot:",Ne)}se&&ee(se)},Q=async()=>{const H=!r?.requireApproval;try{await ot(Je(Ee,"shops",u),{requireApproval:H}),o(se=>({...se,requireApproval:H}))}catch(se){console.error("Error updating requireApproval:",se)}},we=async H=>{const se=parseInt(H);try{await ot(Je(Ee,"shops",u),{bufferMinutes:se}),o(Ne=>({...Ne,bufferMinutes:se}))}catch(Ne){console.error("Error updating buffer minutes:",Ne)}},Ie=(H,se)=>new Date(`${H}T${se}`).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),He=N.useMemo(()=>{const H={},se=j==="all"?L:L.filter(_e=>_e.id===j),Ne=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(const _e of se)_e.weeklyHours&&Ne.forEach(($e,et)=>{_e.weeklyHours[$e]?.enabled&&(H[et]=!0)});return H},[L,j]),Ve=N.useMemo(()=>(j==="all"?L:L.filter(se=>se.id===j)).filter(se=>se.weeklyHours?U_.some(Ne=>se.weeklyHours[Ne.key]?.enabled):!1),[L,j]),ft=N.useMemo(()=>{const H=new Date,se=`${H.getFullYear()}-${String(H.getMonth()+1).padStart(2,"0")}-${String(H.getDate()).padStart(2,"0")}`,Ne=H.getDay(),_e=Ne===0?-6:1-Ne,$e=new Date(H);$e.setDate(H.getDate()+_e),$e.setHours(0,0,0,0);const et=new Date($e);et.setDate($e.getDate()+6),et.setHours(23,59,59,999);const qt=`${$e.getFullYear()}-${String($e.getMonth()+1).padStart(2,"0")}-${String($e.getDate()).padStart(2,"0")}`,ze=`${et.getFullYear()}-${String(et.getMonth()+1).padStart(2,"0")}-${String(et.getDate()).padStart(2,"0")}`,me=A.filter(tt=>tt.date===se).length,Se=A.filter(tt=>tt.date>=qt&&tt.date<=ze).length,Xe=new Set(A.map(tt=>tt.clientEmail?.toLowerCase()).filter(Boolean)).size;return{todayBookings:me,weekBookings:Se,uniqueClients:Xe,totalBookings:A.length}},[A]),Kn=N.useMemo(()=>A.filter(H=>H.status==="pending").length,[A]),Tt=N.useMemo(()=>M.filter(H=>H.status==="waiting").length,[M]),[vt,Ae]=N.useState(0),[Pe,ut]=N.useState({}),Kt=N.useMemo(()=>{if(!r)return 0;r?.winbackSettings?.warningDays;const H=r?.winbackSettings?.inactiveDays||60;if(!(r?.winbackSettings?.enabled!==!1))return 0;const Ne=new Date,_e=A.filter(ze=>ze.status==="confirmed"||ze.status==="pending"||!ze.status),$e={};_e.forEach(ze=>{const me=ze.clientEmail?.toLowerCase();me&&(!$e[me]||ze.date>$e[me])&&($e[me]=ze.date)});let et=0;const qt=ze=>ze.replace(/\./g,"_dot_").replace(/@/g,"_at_");return Object.entries($e).forEach(([ze,me])=>{if(Math.floor((Ne.getTime()-new Date(me+"T12:00:00").getTime())/864e5)>H){const Xe=qt(ze);Pe[Xe]?.contacted||et++}}),et},[A,r,Pe]);if(N.useEffect(()=>{if(!u)return;const H=rn(st(Ee,"shops",u,"clientNotes"),se=>{const Ne={};se.docs.forEach(_e=>{Ne[_e.id]=_e.data()}),ut(Ne)});return()=>H()},[u]),N.useEffect(()=>{if(!u)return;const H=rn(st(Ee,"shops",u,"walkins"),se=>{const Ne=se.docs.filter(_e=>_e.data().status==="waiting").length;Ae(Ne)});return()=>H()},[u]),p)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:i.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[i.jsx("div",{className:"spinner"}),i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading dashboard"})]})});if(x)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:i.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:i.jsx(Wh,{className:"w-8 h-8 text-red-500"})}),i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Unauthorized"}),i.jsx("p",{className:"text-slate-600 mb-6",children:"You don't have access to this dashboard."}),i.jsx(rt,{to:`/shop/${e}/login`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:"Login"})]})});const _t=j==="all"?_:_.filter(H=>H.staffId===j),Nt=j==="all"?A:A.filter(H=>H.staffId===j),Tn=_t.reduce((H,se)=>(H[se.date]||(H[se.date]=[]),H[se.date].push(se),H),{}),Rt=Nt.reduce((H,se)=>(H[se.date]||(H[se.date]=[]),H[se.date].push(se),H),{}),Qn=he?Object.keys(Tn).filter(H=>H===he).sort():Object.keys(Tn).sort(),qn=he?Nt.filter(H=>H.date===he):Nt,bs=R==="all"?qn:R==="pending"?qn.filter(H=>H.status==="pending"):R==="confirmed"?qn.filter(H=>!H.status||H.status==="confirmed"):qn.filter(H=>H.status==="cancelled"||H.status==="rejected"),ts={all:qn.length,pending:qn.filter(H=>H.status==="pending").length,confirmed:qn.filter(H=>!H.status||H.status==="confirmed").length,cancelled:qn.filter(H=>H.status==="cancelled"||H.status==="rejected").length},qa=[{key:"schedule",label:"Schedule",icon:zt},{key:"clients",label:"Clients",icon:Q0},{key:"walkins",label:"Walk-ins",icon:GD},{key:"analytics",label:"Analytics",icon:P3},{key:"waitlist",label:"Waitlist",icon:Ig},{key:"staff",label:"Staff",icon:ln},{key:"services",label:"Services",icon:ps},{key:"settings",label:"Settings",icon:MD}];return i.jsxs("div",{className:"min-h-screen bg-slate-50",children:[i.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"h-16 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(r.name||"")[0]?.toUpperCase()||"S"}),i.jsxs("div",{className:"hidden sm:block",children:[i.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:r.name}),i.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),i.jsx("div",{className:"flex items-center bg-slate-100 p-1 rounded-xl",children:qa.map(H=>{const se=H.icon;return i.jsxs("button",{onClick:()=>fe(H.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${K===H.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[i.jsx(se,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:H.label}),H.key==="schedule"&&Kn>0&&i.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-amber-500 text-white text-[10px] font-bold rounded-full leading-none",children:Kn}),H.key==="clients"&&Kt>0&&i.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-orange-500 text-white text-[10px] font-bold rounded-full leading-none",children:Kt}),H.key==="walkins"&&vt>0&&i.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-emerald-500 text-white text-[10px] font-bold rounded-full leading-none",children:vt}),H.key==="waitlist"&&Tt>0&&i.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-blue-500 text-white text-[10px] font-bold rounded-full leading-none",children:Tt})]},H.key)})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(rt,{to:`/shop/${e}`,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[i.jsx(eD,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"View Page"})]}),i.jsxs("button",{onClick:Te,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",children:[i.jsx(fD,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[K==="schedule"&&i.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8 animate-fade-in",children:[{label:"Today's Bookings",value:ft.todayBookings,icon:b_,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:ft.weekBookings,icon:X0,color:"bg-violet-100 text-violet-600"},{label:"Total Bookings",value:ft.totalBookings,icon:K2,color:"bg-emerald-100 text-emerald-600"},{label:"Unique Clients",value:ft.uniqueClients,icon:ln,color:"bg-amber-100 text-amber-600"}].map(H=>{const se=H.icon;return i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("div",{className:`w-10 h-10 ${H.color} rounded-xl flex items-center justify-center`,children:i.jsx(se,{className:"w-5 h-5"})})}),i.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:H.value}),i.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:H.label})]},H.label)})}),K==="clients"&&i.jsx(pO,{shopId:u,bookings:A,shop:r,slug:e}),K==="walkins"&&i.jsx(hO,{shopId:u,services:U,staff:L,bookings:A}),K==="analytics"&&i.jsx(oO,{bookings:A}),K==="staff"&&i.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:i.jsx(iO,{shopId:u})}),K==="services"&&i.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:i.jsx(eO,{shopId:u})}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:i.jsx(ho,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Waitlist Match!"}),i.jsxs("p",{className:"text-sm text-slate-500",children:[I.matches.length," client",I.matches.length!==1?"s":""," on the waitlist match this freed slot"]})]})]}),i.jsx("div",{className:"bg-slate-50 rounded-xl p-3 mb-4 text-sm",children:i.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[i.jsx(zt,{className:"w-4 h-4 text-blue-500"}),i.jsxs("span",{className:"font-medium",children:[new Date(I.slot.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})," at ",(()=>{const[H,se]=I.slot.time.split(":"),Ne=parseInt(H);return`${Ne%12||12}:${se} ${Ne>=12?"PM":"AM"}`})()]})]})}),i.jsx("div",{className:"space-y-2 mb-5 max-h-48 overflow-y-auto",children:I.matches.map(H=>i.jsx("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-50 border border-blue-100 rounded-lg",children:i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-semibold text-slate-900",children:H.clientName}),i.jsx("span",{className:"text-xs text-slate-500 ml-2",children:H.serviceName})]})},H.id))}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{onClick:()=>le(I.matches,I.slot),className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:[i.jsx(ho,{className:"w-4 h-4"}),"Notify All"]}),i.jsx("button",{onClick:()=>q(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Dismiss"})]})]})}),D&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center",children:i.jsx(ci,{className:"w-5 h-5 text-red-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Cancel Recurring Booking"}),i.jsx("p",{className:"text-sm text-slate-500",children:"This booking is part of a recurring series"})]})]}),i.jsxs("div",{className:"space-y-2 mb-5",children:[i.jsxs("button",{onClick:()=>ue(D.bookingId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[i.jsx(Ca,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this one only"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments stay active"})]})]}),i.jsxs("button",{onClick:()=>Ue(D.bookingId,D.recurringGroupId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[i.jsx(ci,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future in series"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments"})]})]})]}),i.jsx("button",{onClick:()=>k(null),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Never mind"})]})}),K==="waitlist"&&i.jsx("div",{className:"animate-fade-in",children:i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-5",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Waitlist"}),Tt>0&&i.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:[Tt," waiting"]})]}),i.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[M.length," total"]})]}),M.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:i.jsx(Ig,{className:"w-6 h-6 text-slate-400"})}),i.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No waitlist entries yet"}),i.jsx("p",{className:"text-xs text-slate-400",children:"Clients can join the waitlist when no slots are available on your booking page."})]}):i.jsx("div",{children:(()=>{const H={};return M.forEach(se=>{const Ne=se.serviceName||"Other";H[Ne]||(H[Ne]=[]),H[Ne].push(se)}),Object.entries(H).sort(([se],[Ne])=>se.localeCompare(Ne)).map(([se,Ne])=>i.jsxs("div",{className:"mb-6 last:mb-0",children:[i.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100 flex items-center gap-2",children:[i.jsx(ps,{className:"w-3.5 h-3.5 text-blue-500"}),se,i.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",Ne.filter(_e=>_e.status==="waiting").length," waiting)"]})]}),i.jsx("div",{className:"space-y-2.5",children:Ne.sort((_e,$e)=>(_e.createdAt||"").localeCompare($e.createdAt||"")).map(_e=>{const $e={waiting:"bg-blue-50 text-blue-700 border-blue-200",notified:"bg-emerald-50 text-emerald-700 border-emerald-200",booked:"bg-emerald-50 text-emerald-700 border-emerald-200",expired:"bg-slate-100 text-slate-500 border-slate-200"},et={waiting:"Waiting",notified:"Notified",booked:"Booked",expired:"Removed"},qt=_e.createdAt?(()=>{const me=Date.now()-new Date(_e.createdAt).getTime(),Se=Math.floor(me/864e5),Xe=Math.floor(me/36e5);return Se>0?`${Se}d`:`${Xe}h`})():"",ze={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return i.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(ml,{className:"w-4 h-4 text-blue-600"})}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:_e.clientName}),i.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${$e[_e.status]||$e.waiting}`,children:et[_e.status]||"Waiting"})]}),i.jsxs("div",{className:"text-xs text-slate-500",children:["Joined ",qt," ago",_e.refCode&&i.jsx("span",{className:"font-mono text-slate-400 ml-2",children:_e.refCode})]})]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[_e.status==="waiting"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>xe(_e.id),className:"p-1.5 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-all",title:"Notify client",children:i.jsx(ho,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>be(_e.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove from waitlist",children:i.jsx(La,{className:"w-4 h-4"})})]}),_e.status==="notified"&&i.jsx("button",{onClick:()=>be(_e.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove",children:i.jsx(La,{className:"w-3.5 h-3.5"})})]})]}),i.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[_e.staffName&&_e.staffName!=="Any Available"&&i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(ln,{className:"w-3 h-3 text-violet-400"}),i.jsx("span",{className:"text-violet-600",children:_e.staffName})]}),_e.preferredDate&&i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(zt,{className:"w-3 h-3 text-slate-400"}),i.jsxs("span",{children:["Preferred: ",new Date(_e.preferredDate+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]})]}),_e.preferredDays&&_e.preferredDays.length>0&&i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(zt,{className:"w-3 h-3 text-slate-400"}),i.jsxs("span",{children:["Days: ",_e.preferredDays.map(me=>ze[me]||me).join(", ")]})]}),_e.preferredTimeRange&&!(_e.preferredTimeRange.start==="00:00"&&_e.preferredTimeRange.end==="23:59")&&i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(Dn,{className:"w-3 h-3 text-slate-400"}),i.jsxs("span",{children:["Time: ",Zi(_e.preferredTimeRange.start),"",Zi(_e.preferredTimeRange.end)]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Dg,{className:"w-3 h-3"}),_e.clientEmail]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Mg,{className:"w-3 h-3"}),_e.clientPhone]})]}),_e.status==="notified"&&_e.notifiedSlot&&i.jsxs("div",{className:"mt-1.5 px-2.5 py-1.5 bg-emerald-50 border border-emerald-200 rounded-lg inline-flex items-center gap-1.5",children:[i.jsx(ho,{className:"w-3 h-3 text-emerald-500"}),i.jsxs("span",{className:"text-emerald-700 font-medium",children:["Notified about ",new Date(_e.notifiedSlot.date+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})," at ",Zi(_e.notifiedSlot.time)]})]})]})]},_e.id)})})]},se))})()})]})}),K==="settings"&&i.jsxs("div",{className:"max-w-2xl animate-fade-in space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[i.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Settings"}),i.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure your booking preferences"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"pr-4",children:[i.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Require Booking Approval"}),i.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Review and approve bookings before they're confirmed"})]}),i.jsx("button",{type:"button",onClick:Q,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${r?.requireApproval?"bg-blue-500":"bg-slate-300"}`,children:i.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${r?.requireApproval?"translate-x-6":"translate-x-1"}`})})]}),r?.requireApproval&&i.jsxs("div",{className:"p-3.5 bg-amber-50 border border-amber-200 rounded-xl text-xs text-amber-800 leading-relaxed",children:[i.jsx("strong",{children:" Approval mode is on."}),' New bookings will appear as "Pending" until you approve or reject them. Time slots are held while pending to prevent double-booking.']}),i.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"pr-4",children:[i.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Buffer Time Between Bookings"}),i.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Add a gap between consecutive appointments"})]}),i.jsxs("select",{value:r?.bufferMinutes||0,onChange:H=>we(H.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[i.jsx("option",{value:"0",children:"No buffer"}),i.jsx("option",{value:"5",children:"5 minutes"}),i.jsx("option",{value:"10",children:"10 minutes"}),i.jsx("option",{value:"15",children:"15 minutes"}),i.jsx("option",{value:"30",children:"30 minutes"})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[i.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Retention"}),i.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure win-back alerts to re-engage inactive clients"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"pr-4",children:[i.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Enable Win-back Alerts"}),i.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Show alerts when clients haven't visited in a while"})]}),i.jsx("button",{type:"button",onClick:async()=>{const H=r?.winbackSettings||{},se=H.enabled===!1;try{await ot(Je(Ee,"shops",u),{winbackSettings:{...H,enabled:se}}),o(Ne=>({...Ne,winbackSettings:{...Ne.winbackSettings||{},enabled:se}}))}catch(Ne){console.error("Error updating winback settings:",Ne)}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${r?.winbackSettings?.enabled!==!1?"bg-blue-500":"bg-slate-300"}`,children:i.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${r?.winbackSettings?.enabled!==!1?"translate-x-6":"translate-x-1"}`})})]}),r?.winbackSettings?.enabled!==!1&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"pr-4",children:[i.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Getting Cold Threshold"}),i.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "Getting Cold" after this many days without a booking'})]}),i.jsxs("select",{value:r?.winbackSettings?.warningDays||30,onChange:async H=>{const se=parseInt(H.target.value),Ne=r?.winbackSettings||{};try{await ot(Je(Ee,"shops",u),{winbackSettings:{...Ne,warningDays:se}}),o(_e=>({..._e,winbackSettings:{..._e.winbackSettings||{},warningDays:se}}))}catch(_e){console.error("Error updating warning days:",_e)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[i.jsx("option",{value:"14",children:"14 days"}),i.jsx("option",{value:"21",children:"21 days"}),i.jsx("option",{value:"30",children:"30 days"}),i.jsx("option",{value:"45",children:"45 days"}),i.jsx("option",{value:"60",children:"60 days"})]})]}),i.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[i.jsxs("div",{className:"pr-4",children:[i.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"At Risk Threshold"}),i.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "At Risk" after this many days without a booking'})]}),i.jsxs("select",{value:r?.winbackSettings?.inactiveDays||60,onChange:async H=>{const se=parseInt(H.target.value),Ne=r?.winbackSettings||{};try{await ot(Je(Ee,"shops",u),{winbackSettings:{...Ne,inactiveDays:se}}),o(_e=>({..._e,winbackSettings:{..._e.winbackSettings||{},inactiveDays:se}}))}catch(_e){console.error("Error updating inactive days:",_e)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[i.jsx("option",{value:"30",children:"30 days"}),i.jsx("option",{value:"45",children:"45 days"}),i.jsx("option",{value:"60",children:"60 days"}),i.jsx("option",{value:"90",children:"90 days"}),i.jsx("option",{value:"120",children:"120 days"})]})]}),i.jsxs("div",{className:"p-3.5 bg-orange-50 border border-orange-200 rounded-xl text-xs text-orange-800 leading-relaxed",children:[i.jsx("strong",{children:" Tip:"}),' Clients flagged as "Lost" (over 90 days) will also appear in win-back alerts. Visit the ',i.jsx("strong",{children:"Clients"})," tab to view at-risk clients and send win-back messages."]})]})]})]})]}),K==="schedule"&&i.jsxs("div",{className:"animate-fade-in",children:[L.length>0&&i.jsx("div",{className:"flex flex-wrap gap-4 mb-6",children:i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5",children:"Filter by Staff"}),i.jsxs("select",{value:j,onChange:H=>T(H.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[i.jsx("option",{value:"all",children:"All Staff"}),L.map(H=>i.jsxs("option",{value:H.id,children:[H.name,H.role?`  ${H.role}`:""]},H.id))]})]})}),Ve.length>0&&i.jsxs("div",{className:"mb-6 bg-violet-50 border border-violet-200 rounded-xl p-5",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx(Z2,{className:"w-4 h-4 text-violet-600"}),i.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Recurring Weekly Hours"})]}),i.jsx("div",{className:"space-y-2.5",children:Ve.map(H=>{const se=U_.filter(Ne=>H.weeklyHours[Ne.key]?.enabled);return i.jsxs("div",{className:"flex items-start gap-2.5",children:[i.jsx("div",{className:"w-7 h-7 bg-violet-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:i.jsx(ln,{className:"w-3.5 h-3.5 text-violet-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-slate-900 text-sm",children:H.name}),i.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:se.map(Ne=>{const _e=H.weeklyHours[Ne.key];return i.jsxs("span",{className:"inline-block px-2 py-0.5 bg-white text-violet-700 border border-violet-200 rounded text-xs font-medium",children:[Ne.short," ",Zi(_e.start),"",Zi(_e.end),_e.break&&i.jsxs("span",{className:"text-amber-600 ml-1",children:["(break ",Zi(_e.break.start),"",Zi(_e.break.end),")"]})]},Ne.key)})})]})]},H.id)})}),i.jsx("p",{className:"text-xs text-violet-500 mt-3",children:"Slots auto-generate on the booking page. Manage hours in the Staff tab."})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[i.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Monthly Overview"}),i.jsx(XM,{slotsByDate:Tn,bookingsByDate:Rt,selectedDate:he,onSelectDate:oe,recurringDayFlags:He}),he&&i.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[i.jsxs("span",{className:"text-sm text-slate-600",children:["Showing: ",i.jsx("strong",{className:"text-slate-900",children:new Date(he+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),i.jsx("button",{onClick:()=>oe(null),className:"text-xs px-3 py-1 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-medium transition-all border border-slate-200",children:"Show All"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:Ve.length>0?"Add Custom Slots":"Create Time Slots"}),Ve.length>0&&i.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Use this for one-off availability outside regular hours."}),!Ve.length&&i.jsx("div",{className:"mb-4"}),i.jsxs("form",{onSubmit:ve,className:"space-y-4",children:[L.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Staff Member"}),i.jsxs("select",{value:Y.staffId,onChange:H=>ie({...Y,staffId:H.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[i.jsx("option",{value:"",children:"Select a staff member"}),L.map(H=>i.jsxs("option",{value:H.id,children:[H.name,H.role?`  ${H.role}`:""]},H.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Date"}),i.jsx("input",{type:"date",value:Y.date,onChange:H=>ie({...Y,date:H.target.value}),required:!0,min:new Date().toISOString().split("T")[0],className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Start"}),i.jsx("input",{type:"time",value:Y.startTime,onChange:H=>ie({...Y,startTime:H.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"End"}),i.jsx("input",{type:"time",value:Y.endTime,onChange:H=>ie({...Y,endTime:H.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Slot Duration"}),i.jsxs("select",{value:Y.slotDuration,onChange:H=>ie({...Y,slotDuration:H.target.value}),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[i.jsx("option",{value:"15",children:"15 minutes"}),i.jsx("option",{value:"30",children:"30 minutes"}),i.jsx("option",{value:"45",children:"45 minutes"}),i.jsx("option",{value:"60",children:"1 hour"}),i.jsx("option",{value:"90",children:"1.5 hours"}),i.jsx("option",{value:"120",children:"2 hours"})]})]}),i.jsxs("button",{type:"submit",className:"w-full flex items-center justify-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[i.jsx(xi,{className:"w-4 h-4"}),"Generate Slots"]})]}),i.jsxs("div",{className:"mt-4 p-3.5 bg-blue-50 border border-blue-100 rounded-xl text-xs text-slate-600 leading-relaxed",children:[i.jsx("strong",{className:"text-slate-700",children:" Tip:"})," ",Ve.length>0?"Weekly hours auto-generate slots. Use this for one-off slots outside regular hours.":L.length>0?"Select a staff member, pick a date, and set working hours to create slots.":"Set your hours and slot duration. We'll create all the time slots for that day."]})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h2",{className:"text-lg font-bold text-slate-900",children:he?"Bookings":"All Bookings"}),ts.pending>0&&i.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 border border-amber-200 text-xs font-bold rounded-full",children:[ts.pending," pending"]})]}),i.jsx("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:bs.length})]}),i.jsx("div",{className:"flex items-center gap-1 mb-4 p-1 bg-slate-100 rounded-lg overflow-x-auto",children:[{key:"all",label:"All"},{key:"pending",label:"Pending"},{key:"confirmed",label:"Confirmed"},{key:"cancelled",label:"Cancelled"}].map(H=>i.jsxs("button",{onClick:()=>V(H.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-semibold transition-all whitespace-nowrap ${R===H.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[H.label,i.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${R===H.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:ts[H.key]})]},H.key))}),bs.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:i.jsx(b_,{className:"w-6 h-6 text-slate-400"})}),i.jsx("p",{className:"text-sm text-slate-500 font-medium",children:R!=="all"?`No ${R} bookings`:he?"No bookings for this date":"No bookings yet"})]}):i.jsx("div",{className:"space-y-2.5 max-h-[500px] overflow-y-auto pr-1",children:bs.sort((H,se)=>`${H.date}${H.time}`.localeCompare(`${se.date}${se.time}`)).map(H=>{const se=H.status||"confirmed",Ne={pending:"bg-amber-50 text-amber-700 border-amber-200",confirmed:"bg-emerald-50 text-emerald-700 border-emerald-200",rejected:"bg-red-50 text-red-700 border-red-200",cancelled:"bg-slate-100 text-slate-500 border-slate-200"},_e={pending:"Pending",confirmed:"Confirmed",rejected:"Rejected",cancelled:"Cancelled"};return i.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(ml,{className:"w-4 h-4 text-blue-600"})}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:H.clientName}),i.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Ne[se]}`,children:_e[se]}),H.recurring&&i.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",title:"Recurring appointment",children:i.jsx(ci,{className:"w-2.5 h-2.5"})})]}),i.jsx("div",{className:"text-xs text-slate-500",children:Ie(H.date,H.time)})]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[se==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Be(H.id),className:"p-1.5 text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50 rounded-lg transition-all",title:"Approve booking",children:i.jsx(oi,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>We(H.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Reject booking",children:i.jsx(Ca,{className:"w-4 h-4"})})]}),se==="confirmed"&&i.jsx("button",{onClick:()=>Re(H.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Cancel booking",children:i.jsx(mu,{className:"w-3.5 h-3.5"})})]})]}),i.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[H.serviceName&&i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(ps,{className:"w-3 h-3 text-blue-400"}),i.jsx("span",{className:"font-medium text-slate-700",children:H.serviceName}),H.servicePrice!=null&&i.jsxs("span",{className:"text-blue-600 font-semibold",children:["$",Number(H.servicePrice).toFixed(2)]})]}),H.staffName&&i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(ln,{className:"w-3 h-3 text-violet-400"}),i.jsx("span",{className:"text-violet-600",children:H.staffName})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Dg,{className:"w-3 h-3"}),H.clientEmail]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Mg,{className:"w-3 h-3"}),H.clientPhone]})]}),i.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[H.refCode&&i.jsxs("span",{className:"font-mono text-[10px] text-slate-400",children:["REF: ",H.refCode]}),H.recurring&&i.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-indigo-50 border border-indigo-200 rounded text-[10px] font-semibold text-indigo-600",children:" Recurring"})]})]})]},H.id)})})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("h2",{className:"text-lg font-bold text-slate-900",children:he?"Custom Time Slots":"All Custom Time Slots"}),i.jsx("span",{className:"text-xs font-semibold text-slate-500 bg-slate-100 px-2.5 py-1 rounded-lg",children:he?(Tn[he]||[]).length:_t.length})]}),Ve.length>0&&i.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Recurring slots from weekly hours auto-generate  not shown here."}),!Ve.length&&i.jsx("div",{className:"mb-4"}),Qn.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:i.jsx(zt,{className:"w-6 h-6 text-slate-400"})}),i.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:he?"No custom slots for this date":"No custom slots yet"}),i.jsx("p",{className:"text-xs text-slate-400",children:Ve.length>0?"Recurring hours handle most scheduling.":"Use the form above to generate availability."})]}):i.jsx("div",{className:"space-y-6",children:Qn.map(H=>i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100",children:new Date(H).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-2.5",children:Tn[H].sort((se,Ne)=>se.time.localeCompare(Ne.time)).map(se=>i.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-3.5 text-center group hover:border-slate-300 transition-all",children:[i.jsx("div",{className:"text-sm font-bold text-slate-900 mb-0.5",children:se.time}),i.jsxs("div",{className:"text-xs text-slate-500 mb-1",children:[se.duration," min"]}),se.staffName&&i.jsxs("div",{className:"text-xs text-violet-600 mb-1.5 flex items-center justify-center gap-1",children:[i.jsx(ln,{className:"w-3 h-3"}),se.staffName]}),i.jsx("div",{className:"mb-2",children:se.available?i.jsx("span",{className:"inline-block px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-md text-xs font-medium",children:"Available"}):i.jsx("span",{className:"inline-block px-2 py-0.5 bg-red-50 text-red-700 border border-red-200 rounded-md text-xs font-medium",children:"Booked"})}),se.available&&i.jsxs("button",{onClick:()=>P(se.id),className:"opacity-0 group-hover:opacity-100 flex items-center justify-center gap-1 w-full px-2 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-xs font-medium transition-all border border-red-200",children:[i.jsx(mu,{className:"w-3 h-3"}),"Remove"]})]},se.id))})]},H))})]})]})]})]})}function vO({user:s}){const{slug:e}=ko(),n=Ro(),[r,o]=N.useState(""),[u,d]=N.useState(""),[p,g]=N.useState(""),[x,b]=N.useState(!1);N.useEffect(()=>{if(!s)return;(async()=>{const A=Ds(st(Ee,"shops"),fs("slug","==",e)),F=await Ms(A);F.empty||F.docs[0].data().ownerUid===s.uid&&n(`/shop/${e}/dashboard`,{replace:!0})})()},[s,e,n]);const _=async E=>{E.preventDefault(),g(""),b(!0);try{const F=(await H1(hl,r,u)).user,L=Ds(st(Ee,"shops"),fs("slug","==",e)),O=await Ms(L);if(O.empty){g("Shop not found"),b(!1);return}if(O.docs[0].data().ownerUid!==F.uid){g("You are not the owner of this shop"),await hl.signOut(),b(!1);return}n(`/shop/${e}/dashboard`,{replace:!0})}catch(A){switch(A.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":g("Invalid email or password");break;case"auth/invalid-email":g("Please enter a valid email address");break;case"auth/too-many-requests":g("Too many failed attempts. Please try again later.");break;default:g("Login failed. Please try again.")}d("")}finally{b(!1)}};return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:i.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[i.jsx("div",{className:"text-center mb-8",children:i.jsxs(rt,{to:"/",className:"inline-flex items-center gap-2.5",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:i.jsx(Ba,{className:"w-5 h-5 text-white"})}),i.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Book",i.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}),i.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),i.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),i.jsxs("form",{onSubmit:_,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),i.jsx("input",{type:"email",value:r,onChange:E=>{o(E.target.value),g("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),i.jsx("input",{type:"password",value:u,onChange:E=>{d(E.target.value),g("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${p?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),p&&i.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[i.jsx("span",{children:""})," ",p]})]}),i.jsx("button",{type:"submit",disabled:x,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:x?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):"Sign In"})]}),i.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:i.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",i.jsx(rt,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsxs(rt,{to:`/shop/${e}`,className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[i.jsx(Va,{className:"w-3.5 h-3.5"}),"Back to booking page"]})})]})})}function B_({name:s,className:e="w-12 h-12",bgClass:n="bg-blue-100 text-blue-700"}){const r=(s||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return i.jsx("div",{className:`${e} ${n} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:r||"?"})}function z_(){return i.jsxs(rt,{to:"/",className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:i.jsx(Ba,{className:"w-3.5 h-3.5 text-white"})}),i.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Book",i.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}function wO(){const{slug:s,refCode:e}=ko(),[n,r]=N.useState(null),[o,u]=N.useState(null),[d,p]=N.useState(!0),[g,x]=N.useState(!1),[b,_]=N.useState(null),[E,A]=N.useState(null),[F,L]=N.useState(!1),[O,U]=N.useState([]),[G,K]=N.useState([]),[fe,he]=N.useState([]),[oe,j]=N.useState([]),[T,R]=N.useState(!1),[V,M]=N.useState(!1),[z,I]=N.useState(null),[q,D]=N.useState(null),[k,Y]=N.useState(null),[ie,Te]=N.useState(!1),[ve,P]=N.useState("");N.useEffect(()=>{(async()=>{p(!0);try{const Pe=Ds(st(Ee,"shops"),fs("slug","==",s)),ut=await Ms(Pe);if(ut.empty)x(!0);else{const Kt=ut.docs[0];r(Kt.data()),u(Kt.id)}}catch(Pe){console.error("Error looking up shop:",Pe),x(!0)}finally{p(!1)}})()},[s]),N.useEffect(()=>{if(!o)return;(async()=>{try{const Pe=Ds(st(Ee,"shops",o,"bookings"),fs("refCode","==",e.toUpperCase())),ut=await Ms(Pe);if(ut.empty)L(!0);else{const Kt=ut.docs[0];_(Kt.data()),A(Kt.id)}}catch(Pe){console.error("Error looking up booking:",Pe),L(!0)}})()},[o,e]),N.useEffect(()=>{if(!o||!b)return;const Ae=rn(st(Ee,"shops",o,"bookings"),_t=>{U(_t.docs.map(Nt=>({id:Nt.id,...Nt.data()})))}),Pe=rn(st(Ee,"shops",o,"availability"),_t=>{const Nt=new Date,Tn=_t.docs.map(Rt=>({id:Rt.id,...Rt.data()})).filter(Rt=>new Date(`${Rt.date}T${Rt.time}`)>Nt);K(Tn)}),ut=rn(st(Ee,"shops",o,"staff"),_t=>{he(_t.docs.map(Nt=>({id:Nt.id,...Nt.data()})).filter(Nt=>Nt.active!==!1).sort((Nt,Tn)=>(Nt.name||"").localeCompare(Tn.name||"")))}),Kt=rn(st(Ee,"shops",o,"services"),_t=>{j(_t.docs.map(Nt=>({id:Nt.id,...Nt.data()})).filter(Nt=>Nt.active!==!1))});return()=>{Ae(),Pe(),ut(),Kt()}},[o,b]);const ee=n?.bufferMinutes||0,le=N.useMemo(()=>{if(!b)return null;if(b.serviceId){const Ae=oe.find(Pe=>Pe.id===b.serviceId);if(Ae)return Ae}return b.serviceName?{id:b.serviceId,name:b.serviceName,price:b.servicePrice,duration:b.serviceDuration||b.duration}:null},[b,oe]),xe=N.useMemo(()=>{if(!T||!b)return[];const Ae=new Date,Pe=le?.duration||b.duration||60;let ut=G.filter(Rt=>Rt.available);ut=ut.filter(Rt=>Rt.duration>=Pe),b.staffId&&(ut=ut.filter(Rt=>Rt.staffId===b.staffId||!Rt.staffId));const Kt=b.staffId?fe.filter(Rt=>Rt.id===b.staffId):fe,_t=mE(Kt,Pe,ee,4).filter(Rt=>new Date(`${Rt.date}T${Rt.time}`)>Ae),Nt=gE(_t,ut),Tn=O.filter(Rt=>Rt.id!==E);return pE(Nt,Tn,ee)},[T,b,E,G,fe,O,ee,le]),be=N.useMemo(()=>[...new Set(xe.map(Ae=>Ae.date))].sort(),[xe]),Re=N.useMemo(()=>q?xe.filter(Ae=>Ae.date===q):[],[q,xe]),ue=async(Ae="single")=>{Te(!0);try{if(await ot(Je(Ee,"shops",o,"bookings",E),{status:"cancelled"}),b.slotId&&!b.slotId.startsWith("wh-")&&!b.slotId.startsWith("recurring-"))try{await ot(Je(Ee,"shops",o,"availability",b.slotId),{available:!0})}catch(Pe){console.warn("Could not re-open slot:",Pe)}if(Ae==="future"&&b.recurringGroupId){const Pe=O.filter(ut=>ut.recurringGroupId===b.recurringGroupId&&ut.id!==E&&ut.date>=b.date&&(ut.status==="pending"||ut.status==="confirmed"));for(const ut of Pe)if(await ot(Je(Ee,"shops",o,"bookings",ut.id),{status:"cancelled"}),ut.slotId&&!ut.slotId.startsWith("wh-")&&!ut.slotId.startsWith("recurring-"))try{await ot(Je(Ee,"shops",o,"availability",ut.slotId),{available:!0})}catch(Kt){console.warn("Could not re-open slot:",Kt)}}_(Pe=>({...Pe,status:"cancelled"})),M(!1),I(null),P("cancelled")}catch(Pe){console.error("Cancel error:",Pe),P("error")}finally{Te(!1)}},Ue=async()=>{if(k){Te(!0);try{const Ae={date:k.date,time:k.time,slotId:k.id};if(k.staffId&&(Ae.staffId=k.staffId,Ae.staffName=k.staffName||""),n?.requireApproval&&(Ae.status="pending"),b.slotId&&!b.slotId.startsWith("wh-"))try{await ot(Je(Ee,"shops",o,"availability",b.slotId),{available:!0})}catch(Pe){console.warn("Could not re-open old slot:",Pe)}if(!k.generated&&k.id)try{await ot(Je(Ee,"shops",o,"availability",k.id),{available:!1})}catch(Pe){console.warn("Could not block new slot:",Pe)}await ot(Je(Ee,"shops",o,"bookings",E),Ae),_(Pe=>({...Pe,...Ae})),R(!1),D(null),Y(null),P("rescheduled")}catch(Ae){console.error("Reschedule error:",Ae),P("error")}finally{Te(!1)}}},Be=Ae=>new Date(Ae+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),We=Ae=>{const[Pe,ut]=Ae.split(":"),Kt=parseInt(Pe),_t=Kt>=12?"PM":"AM";return`${Kt%12||12}:${ut} ${_t}`},Q=Ae=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(Ae),we=Ae=>{if(!Ae)return"";if(Ae<60)return`${Ae} min`;const Pe=Math.floor(Ae/60),ut=Ae%60;return ut?`${Pe}h ${ut}m`:`${Pe} hour${Pe>1?"s":""}`};if(d)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:i.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[i.jsx("div",{className:"spinner"}),i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(g)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:i.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[i.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:i.jsx(zt,{className:"w-8 h-8 text-slate-400"})}),i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),i.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,i.jsx("span",{className:"font-mono text-blue-600",children:s}),'".']}),i.jsxs(rt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[i.jsx(Va,{className:"w-4 h-4"}),"Go Home"]})]})});if(F)return i.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[i.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(n?.name||"")[0]?.toUpperCase()||"S"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:n?.name}),i.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),i.jsx(z_,{})]})}),i.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:i.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[i.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:i.jsx(fl,{className:"w-8 h-8 text-amber-500"})}),i.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Not Found"}),i.jsx("p",{className:"text-slate-600 mb-2",children:"No booking found with reference code"}),i.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),i.jsxs(rt,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[i.jsx(zt,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:i.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[i.jsx("div",{className:"spinner"}),i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking"})]})});const Ie=b.status||"confirmed",He=Ie==="pending"||Ie==="confirmed",Ve=Ie==="cancelled",ft=Ie==="rejected",Kn={pending:{label:"Pending Approval",color:"bg-amber-100 text-amber-700 border-amber-200",icon:Dn},confirmed:{label:"Confirmed",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Is},cancelled:{label:"Cancelled",color:"bg-slate-100 text-slate-500 border-slate-200",icon:Ca},rejected:{label:"Rejected",color:"bg-red-100 text-red-700 border-red-200",icon:Ca}},Tt=Kn[Ie]||Kn.confirmed,vt=Tt.icon;return i.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[i.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(n?.name||"")[0]?.toUpperCase()||"S"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:n?.name}),i.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),i.jsx(z_,{})]})}),i.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[ve==="rescheduled"&&i.jsx("div",{className:"mb-6 animate-scale-in",children:i.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(X2,{className:"w-8 h-8 text-emerald-600"})}),i.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Rescheduled!"}),i.jsx("p",{className:"text-slate-600 mb-4",children:n?.requireApproval?"Your booking has been rescheduled and is pending approval.":"Your booking has been successfully rescheduled."}),i.jsx("button",{onClick:()=>P(""),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View updated details "})]})}),ve==="cancelled"&&i.jsx("div",{className:"mb-6 animate-scale-in",children:i.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg p-8 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Ca,{className:"w-8 h-8 text-slate-400"})}),i.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Cancelled"}),i.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking has been cancelled."}),i.jsxs(rt,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[i.jsx(zt,{className:"w-4 h-4"}),"Book a new appointment"]})]})}),ve==="error"&&i.jsx("div",{className:"mb-6 animate-scale-in",children:i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[i.jsx("span",{children:""}),i.jsx("span",{children:"Something went wrong. Please try again."})]})}),!T&&i.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Your Booking"}),i.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference: ",i.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),(Ve||ft)&&i.jsxs("div",{className:`mb-4 p-4 rounded-xl border flex items-center gap-3 ${Ve?"bg-slate-50 border-slate-200":"bg-red-50 border-red-200"}`,children:[i.jsx(vt,{className:`w-5 h-5 ${Ve?"text-slate-400":"text-red-500"}`}),i.jsx("span",{className:`font-medium text-sm ${Ve?"text-slate-600":"text-red-700"}`,children:Ve?"This booking has been cancelled.":"This booking has been rejected by the shop."})]}),b.recurringGroupId&&i.jsxs("div",{className:"mb-4 p-3.5 bg-blue-50 border border-blue-200 rounded-xl flex items-center gap-2.5",children:[i.jsx(ci,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Part of a recurring series"}),b.recurringInterval&&i.jsxs("p",{className:"text-xs text-blue-600 mt-0.5",children:["Repeats every ",b.recurringInterval==="weekly"?"week":b.recurringInterval==="biweekly"?"2 weeks":b.recurringInterval==="fourweekly"?"4 weeks":b.recurringInterval==="monthly"?"month":b.recurringInterval]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),i.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${Tt.color}`,children:[i.jsx(vt,{className:"w-3.5 h-3.5"}),Tt.label]})]}),b.serviceName&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(ps,{className:"w-4 h-4 text-blue-600"})}),i.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.servicePrice!=null&&i.jsx("span",{className:"font-bold text-blue-600",children:Q(b.servicePrice)})]}),b.staffName&&i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx(B_,{name:b.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),i.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:i.jsx(zt,{className:"w-4 h-4 text-slate-600"})}),i.jsxs("span",{className:"font-semibold text-slate-800",children:[Be(b.date)," at ",We(b.time)]})]}),i.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[i.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:i.jsx(Dn,{className:"w-4 h-4 text-slate-500"})}),i.jsx("span",{children:we(b.serviceDuration||b.duration)})]})]}),He&&!ve&&i.jsx("div",{className:"space-y-3",children:V?i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 animate-scale-in",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(fl,{className:"w-5 h-5 text-red-500"})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-slate-900",children:"Are you sure?"}),i.jsx("p",{className:"text-sm text-slate-600",children:"This action cannot be undone."})]})]}),b.recurringGroupId&&!z&&i.jsxs("div",{className:"space-y-2 mb-4",children:[i.jsxs("button",{onClick:()=>I("single"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[i.jsx(Ca,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this appointment only"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments in the series remain active"})]})]}),i.jsxs("button",{onClick:()=>I("future"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[i.jsx(ci,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future appointments"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments in the series"})]})]}),i.jsx("button",{onClick:()=>M(!1),className:"w-full px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Go Back"})]}),(!b.recurringGroupId||z)&&i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{onClick:()=>ue(z||"single"),disabled:ie,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold transition-all disabled:opacity-50",children:[ie?i.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}):i.jsx(Ca,{className:"w-4 h-4"}),ie?"Cancelling":z==="future"?"Cancel All Future":"Yes, Cancel"]}),i.jsx("button",{onClick:()=>{z?I(null):M(!1)},disabled:ie,className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Go Back"})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>{R(!0),P("")},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[i.jsx(Z2,{className:"w-4 h-4"}),"Reschedule Booking"]}),i.jsxs("button",{onClick:()=>{M(!0),I(null)},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-white hover:bg-red-50 text-red-600 rounded-xl font-semibold border border-red-200 hover:border-red-300 transition-all",children:[i.jsx(Ca,{className:"w-4 h-4"}),"Cancel Booking"]})]})}),(Ve||ft)&&i.jsx("div",{className:"text-center",children:i.jsxs(rt,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[i.jsx(zt,{className:"w-4 h-4"}),"Book Again"]})})]}),T&&i.jsxs("div",{className:"animate-fade-in",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[i.jsxs("button",{onClick:()=>{R(!1),D(null),Y(null)},className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[i.jsx(Va,{className:"w-3.5 h-3.5"}),"Back to Booking"]}),b.serviceName&&i.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[i.jsx(ps,{className:"w-3.5 h-3.5 text-blue-500"}),i.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName}),b.servicePrice!=null&&i.jsx("span",{className:"text-blue-600 font-bold",children:Q(b.servicePrice)})]}),b.staffName&&i.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[i.jsx(B_,{name:b.staffName,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),i.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a New Time"}),i.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Pick a new date and time for your appointment"})]}),be.length===0?i.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:i.jsx(zt,{className:"w-8 h-8 text-slate-400"})}),i.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),i.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"No time slots are currently available. Check back soon!"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"mb-8",children:i.jsx(nE,{availableDates:be,selectedDate:q,onSelectDate:Ae=>{D(Ae),Y(null)}})}),q&&i.jsxs("div",{className:"animate-slide-down",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",Be(q)]}),i.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[Re.length," slot",Re.length!==1?"s":""]})]}),Re.length===0?i.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:i.jsx("p",{className:"text-slate-500",children:"No slots available for this date"})}):i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:Re.sort((Ae,Pe)=>Ae.time.localeCompare(Pe.time)).map(Ae=>{const Pe=k?.id===Ae.id;return i.jsxs("button",{onClick:()=>Y(Ae),className:`group border rounded-xl p-4 transition-all duration-200 text-center ${Pe?"bg-blue-600 border-blue-600 text-white shadow-md shadow-blue-600/30":"bg-white border-slate-200 hover:border-blue-400 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5"}`,children:[i.jsx("div",{className:`text-lg font-bold mb-1 ${Pe?"text-white":"text-slate-900 group-hover:text-blue-700"} transition-colors`,children:We(Ae.time)}),Ae.staffName&&i.jsxs("div",{className:`text-xs mb-0.5 flex items-center justify-center gap-1 ${Pe?"text-blue-100":"text-violet-600"}`,children:[i.jsx(ln,{className:"w-3 h-3"}),Ae.staffName]}),i.jsx("div",{className:`text-xs ${Pe?"text-blue-200":"text-slate-400"}`,children:we(b.serviceDuration||b.duration)})]},Ae.id)})}),k&&i.jsxs("div",{className:"mt-6 animate-fade-in",children:[i.jsxs("div",{className:"bg-white rounded-xl border border-blue-200 shadow-sm p-5 mb-4",children:[i.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"New Appointment Time"}),i.jsxs("div",{className:"flex items-center gap-2.5 text-sm",children:[i.jsx(zt,{className:"w-4 h-4 text-blue-500"}),i.jsxs("span",{className:"font-semibold text-slate-800",children:[Be(k.date)," at ",We(k.time)]})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:Ue,disabled:ie,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed",children:ie?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Rescheduling"]}):i.jsxs(i.Fragment,{children:[i.jsx(Is,{className:"w-4 h-4"}),"Confirm Reschedule"]})}),i.jsx("button",{onClick:()=>Y(null),className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]})]}),!q&&i.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]})]}),i.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:i.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:i.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",i.jsx(rt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"BookFlow"})]})})})]})}function q_(){return i.jsxs(rt,{to:"/",className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:i.jsx(Ba,{className:"w-3.5 h-3.5 text-white"})}),i.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Book",i.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}function _O(s){if(!s)return"Any time";const e=n=>{const[r,o]=n.split(":").map(Number),u=r>=12?"PM":"AM",d=r%12||12;return o===0?`${d}${u}`:`${d}:${o.toString().padStart(2,"0")}${u}`};return s.start==="00:00"&&s.end==="23:59"?"Any time":`${e(s.start)}  ${e(s.end)}`}function NO(s){if(!s||s.length===0)return"Any day";const e={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return s.map(n=>e[n]||n).join(", ")}function EO(s){if(!s)return"";const e=new Date,n=new Date(s),r=e-n,o=Math.floor(r/6e4);if(o<60)return`${o}m ago`;const u=Math.floor(o/60);return u<24?`${u}h ago`:`${Math.floor(u/24)}d ago`}function SO(){const{slug:s,refCode:e}=ko(),[n,r]=N.useState(null),[o,u]=N.useState(null),[d,p]=N.useState(!0),[g,x]=N.useState(!1),[b,_]=N.useState(null),[E,A]=N.useState(!1),[F,L]=N.useState(null);if(N.useEffect(()=>{(async()=>{p(!0);try{const oe=Ds(st(Ee,"shops"),fs("slug","==",s)),j=await Ms(oe);if(j.empty)x(!0);else{const T=j.docs[0];r(T.data()),u(T.id)}}catch(oe){console.error("Error looking up shop:",oe),x(!0)}finally{p(!1)}})()},[s]),N.useEffect(()=>{if(!o)return;(async()=>{try{const oe=Ds(st(Ee,"shops",o,"waitlist"),fs("refCode","==",e.toUpperCase())),j=await Ms(oe);if(j.empty){A(!0);return}const T=j.docs[0],R={id:T.id,...T.data()};_(R);const V=Ds(st(Ee,"shops",o,"waitlist"),fs("serviceId","==",R.serviceId),fs("status","==","waiting")),I=(await Ms(V)).docs.map(q=>({id:q.id,...q.data()})).sort((q,D)=>(q.createdAt||"").localeCompare(D.createdAt||"")).findIndex(q=>q.id===R.id);I>=0&&L(I+1)}catch(oe){console.error("Error looking up waitlist entry:",oe),A(!0)}})()},[o,e]),d)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:i.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[i.jsx("div",{className:"spinner"}),i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(g)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:i.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[i.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:i.jsx(zt,{className:"w-8 h-8 text-slate-400"})}),i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),i.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,i.jsx("span",{className:"font-mono text-blue-600",children:s}),'".']}),i.jsxs(rt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[i.jsx(Va,{className:"w-4 h-4"}),"Go Home"]})]})});if(E)return i.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[i.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(n?.name||"")[0]?.toUpperCase()||"S"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:n?.name}),i.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),i.jsx(q_,{})]})}),i.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:i.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[i.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:i.jsx(fl,{className:"w-8 h-8 text-amber-500"})}),i.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Waitlist Entry Not Found"}),i.jsx("p",{className:"text-slate-600 mb-2",children:"No waitlist entry found with reference code"}),i.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),i.jsxs(rt,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[i.jsx(zt,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:i.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[i.jsx("div",{className:"spinner"}),i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading waitlist"})]})});const O={waiting:{label:"Waiting",color:"bg-blue-100 text-blue-700 border-blue-200",icon:Dn},notified:{label:"Slot Available!",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:ho},booked:{label:"Booked",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Is},expired:{label:"Expired",color:"bg-slate-100 text-slate-500 border-slate-200",icon:Dn}},U=O[b.status]||O.waiting,G=U.icon,K=he=>he?new Date(he+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):"",fe=he=>{if(!he)return"";const[oe,j]=he.split(":"),T=parseInt(oe),R=T>=12?"PM":"AM";return`${T%12||12}:${j} ${R}`};return i.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[i.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(n?.name||"")[0]?.toUpperCase()||"S"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:n?.name}),i.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),i.jsx(q_,{})]})}),i.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:i.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[b.status==="notified"&&i.jsx("div",{className:"mb-6 animate-scale-in",children:i.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(ho,{className:"w-8 h-8 text-emerald-600"})}),i.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"A Slot Is Available!"}),i.jsxs("p",{className:"text-slate-600 mb-4",children:["A slot has opened up for ",b.serviceName,". Book now before it's taken!"]}),b.notifiedSlot&&i.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-xl text-sm text-emerald-700 font-medium mb-4",children:[i.jsx(zt,{className:"w-4 h-4"}),K(b.notifiedSlot.date)," at"," ",fe(b.notifiedSlot.time),b.notifiedSlot.staffName&&i.jsxs("span",{className:"text-emerald-600",children:[" ","with ",b.notifiedSlot.staffName]})]}),i.jsx("div",{children:i.jsxs(rt,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-emerald-600/20 hover:shadow-lg",children:[i.jsx(zt,{className:"w-4 h-4"}),"Book Now "]})})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Waitlist Status"}),i.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference:"," ",i.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),i.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${U.color}`,children:[i.jsx(G,{className:"w-3.5 h-3.5"}),U.label]})]}),b.status==="waiting"&&F!=null&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Position"}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(Ig,{className:"w-4 h-4 text-blue-500"}),i.jsxs("span",{className:"font-bold text-slate-900 text-lg",children:["#",F]}),i.jsx("span",{className:"text-sm text-slate-500",children:"in line"})]})]}),b.serviceName&&i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(ps,{className:"w-4 h-4 text-blue-600"})}),i.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.staffName&&i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center",children:i.jsx(ln,{className:"w-4 h-4 text-violet-600"})}),i.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),b.preferredDate&&i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:i.jsx(zt,{className:"w-4 h-4 text-slate-600"})}),i.jsxs("span",{className:"text-sm text-slate-700",children:["Preferred: ",K(b.preferredDate)]})]}),b.preferredDays&&b.preferredDays.length>0&&i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:i.jsx(zt,{className:"w-4 h-4 text-slate-600"})}),i.jsxs("span",{className:"text-sm text-slate-700",children:["Days: ",NO(b.preferredDays)]})]}),b.preferredTimeRange&&i.jsxs("div",{className:"flex items-center gap-2.5",children:[i.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:i.jsx(Dn,{className:"w-4 h-4 text-slate-500"})}),i.jsxs("span",{className:"text-sm text-slate-700",children:["Time: ",_O(b.preferredTimeRange)]})]}),b.createdAt&&i.jsxs("div",{className:"pt-2 border-t border-slate-100 text-xs text-slate-400",children:["Joined ",EO(b.createdAt)]})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsxs(rt,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[i.jsx(zt,{className:"w-4 h-4"}),b.status==="notified"?"Book Now":"Check Available Slots"]})})]})}),i.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:i.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:i.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",i.jsx(rt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"BookFlow"})]})})})]})}function jO(){return i.jsxs(rt,{to:"/",className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:i.jsx(Ba,{className:"w-3.5 h-3.5 text-white"})}),i.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Book",i.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}function F_(s){if(s==null)return"";if(s<1)return"Next up!";if(s<60)return`~${s} min`;const e=Math.floor(s/60),n=s%60;return n>0?`~${e}h ${n}m`:`~${e}h`}function TO(){const{slug:s}=ko(),[e,n]=N.useState(null),[r,o]=N.useState(null),[u,d]=N.useState(!0),[p,g]=N.useState(!1),[x,b]=N.useState([]),[_,E]=N.useState([]),[A,F]=N.useState([]),[L,O]=N.useState(!1),[U,G]=N.useState(!1),[K,fe]=N.useState(!1),[he,oe]=N.useState(""),[j,T]=N.useState(0),[R,V]=N.useState({clientName:"",serviceId:""}),[M,z]=N.useState(Date.now());N.useEffect(()=>{const ve=setInterval(()=>z(Date.now()),3e4);return()=>clearInterval(ve)},[]),N.useEffect(()=>{(async()=>{d(!0);try{const P=Ds(st(Ee,"shops"),fs("slug","==",s)),ee=await Ms(P);if(ee.empty)g(!0);else{const le=ee.docs[0];n(le.data()),o(le.id)}}catch(P){console.error("Error looking up shop:",P),g(!0)}finally{d(!1)}})()},[s]),N.useEffect(()=>{if(!r)return;const ve=rn(st(Ee,"shops",r,"walkins"),le=>{const xe=le.docs.map(be=>({id:be.id,...be.data()}));b(xe)}),P=rn(st(Ee,"shops",r,"staff"),le=>{const xe=le.docs.map(be=>({id:be.id,...be.data()})).filter(be=>be.active!==!1);E(xe)}),ee=rn(st(Ee,"shops",r,"services"),le=>{const xe=le.docs.map(be=>({id:be.id,...be.data()})).filter(be=>be.active!==!1).sort((be,Re)=>(be.name||"").localeCompare(Re.name||""));F(xe)});return()=>{ve(),P(),ee()}},[r]);const I=N.useMemo(()=>x.filter(ve=>ve.status==="waiting").sort((ve,P)=>(ve.position||0)-(P.position||0)),[x]),q=N.useMemo(()=>x.filter(ve=>ve.status==="in-progress"),[x]),D=N.useMemo(()=>Math.max(_.length,1),[_]),k=N.useMemo(()=>bE({waitingQueue:I,inProgress:q,staffCount:D,defaultDuration:30}),[I,q,D]),Y=N.useMemo(()=>xE({waitingAhead:I,inProgress:q,staffCount:D,defaultDuration:30}),[I,q,D]),ie=N.useMemo(()=>{const ve=new Date;return ve.setHours(0,0,0,0),x.filter(P=>{const ee=P.joinedAt?.toDate?.()||(P.joinedAt?new Date(P.joinedAt):null);return ee&&ee>=ve}).length},[x]),Te=async ve=>{ve.preventDefault(),G(!0);const P=A.find(be=>be.id===R.serviceId),le=(I.length>0?Math.max(...I.map(be=>be.position||0)):0)+1,xe=R.clientName.trim()||`Walk-in #${ie+1}`;try{await yr(st(Ee,"shops",r,"walkins"),{clientName:xe,serviceId:R.serviceId||null,serviceName:P?.name||null,staffId:null,staffName:null,estimatedDuration:P?.duration||30,status:"waiting",position:le,joinedAt:kt.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),oe(xe),T(le),fe(!0),O(!1),V({clientName:"",serviceId:""})}catch(be){console.error("Error joining queue:",be)}finally{G(!1)}};return u?i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:i.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[i.jsx("div",{className:"spinner"}),i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):p?i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:i.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[i.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:i.jsx(zt,{className:"w-8 h-8 text-slate-400"})}),i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),i.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,i.jsx("span",{className:"font-mono text-blue-600",children:s}),'".']}),i.jsxs(rt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[i.jsx(Va,{className:"w-4 h-4"}),"Go Home"]})]})}):i.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[i.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e?.name||"")[0]?.toUpperCase()||"S"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e?.name}),i.jsx("p",{className:"text-xs text-slate-500",children:"Live Queue"})]})]}),i.jsx(jO,{})]})}),i.jsxs("div",{className:"max-w-2xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[K&&i.jsxs("div",{className:"mb-6 bg-emerald-50 border border-emerald-200 rounded-2xl p-6 text-center animate-scale-in",children:[i.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-3",children:i.jsx(ln,{className:"w-7 h-7 text-emerald-600"})}),i.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"You're in the queue!"}),i.jsxs("p",{className:"text-slate-600 text-sm mb-2",children:[i.jsx("strong",{children:he}),"  Position #",j]}),i.jsx("button",{onClick:()=>fe(!1),className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"Dismiss"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[i.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:i.jsx(ln,{className:"w-6 h-6 text-blue-600"})}),i.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:I.length}),i.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"People Waiting"})]}),i.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[i.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:i.jsx(tE,{className:"w-6 h-6 text-amber-600"})}),i.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:F_(Y)}),i.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"Est. Wait (New)"})]})]}),q.length>0&&i.jsxs("div",{className:"mb-6",children:[i.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[i.jsx(Ba,{className:"w-5 h-5 text-emerald-500"}),"Currently Being Served"]}),i.jsx("div",{className:"space-y-2",children:q.map(ve=>i.jsxs("div",{className:"bg-white rounded-xl border border-emerald-200 p-4 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:i.jsx(Ba,{className:"w-5 h-5 text-emerald-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-semibold text-slate-900",children:ve.clientName}),i.jsx("div",{className:"text-xs text-slate-500",children:ve.serviceName||"Service in progress"})]})]},ve.id))})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[i.jsx(Dn,{className:"w-5 h-5 text-blue-500"}),"Queue"]}),I.length===0?i.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-10 text-center",children:[i.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:i.jsx(ln,{className:"w-7 h-7 text-emerald-500"})}),i.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"No Wait!"}),i.jsx("p",{className:"text-sm text-slate-500",children:"The queue is empty  you can walk right in!"})]}):i.jsx("div",{className:"space-y-2",children:I.map((ve,P)=>{const ee=k.get(ve.id);return i.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4 flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center font-extrabold text-blue-700 text-lg flex-shrink-0",children:P+1}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold text-slate-900 text-lg truncate",children:ve.clientName}),ve.serviceName&&i.jsxs("div",{className:"text-sm text-slate-500 flex items-center gap-1",children:[i.jsx(ps,{className:"w-3 h-3"}),ve.serviceName]})]}),i.jsxs("div",{className:"text-right flex-shrink-0",children:[i.jsx("div",{className:"text-lg font-bold text-amber-600",children:F_(ee)}),i.jsx("div",{className:"text-xs text-slate-400",children:"est. wait"})]})]},ve.id)})})]}),!K&&i.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:L?i.jsxs("form",{onSubmit:Te,children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Join the Queue"}),i.jsxs("div",{className:"space-y-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Your Name"}),i.jsx("input",{type:"text",value:R.clientName,onChange:ve=>V(P=>({...P,clientName:ve.target.value})),placeholder:"Optional",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg"})]}),A.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Service"}),i.jsxs("select",{value:R.serviceId,onChange:ve=>V(P=>({...P,serviceId:ve.target.value})),className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg",children:[i.jsx("option",{value:"",children:"Select a service"}),A.map(ve=>i.jsxs("option",{value:ve.id,children:[ve.name," (",ve.duration,"min  $",Number(ve.price).toFixed(2),")"]},ve.id))]})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{type:"submit",disabled:U,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[i.jsx(xi,{className:"w-5 h-5"}),U?"Joining":"Join Queue"]}),i.jsx("button",{type:"button",onClick:()=>{O(!1),V({clientName:"",serviceId:""})},className:"px-6 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]}):i.jsxs("button",{onClick:()=>O(!0),className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[i.jsx(xi,{className:"w-5 h-5"}),"Join the Queue"]})})]}),i.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-between",children:[i.jsxs(rt,{to:`/shop/${s}`,className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[i.jsx(zt,{className:"w-4 h-4"}),"Book Online"]}),i.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",i.jsx(rt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"BookFlow"})]})]})})]})}function AO(){const[s,e]=N.useState(null),[n,r]=N.useState(!0);return N.useEffect(()=>{const o=bC(hl,u=>{e(u),r(!1)});return()=>o()},[]),n?i.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:i.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[i.jsx("div",{className:"spinner"}),i.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):i.jsx(TT,{children:i.jsxs(sT,{children:[i.jsx(ia,{path:"/",element:i.jsx(JD,{})}),i.jsx(ia,{path:"/register",element:i.jsx(eM,{})}),i.jsx(ia,{path:"/login",element:i.jsx(tM,{user:s})}),i.jsx(ia,{path:"/shop/:slug",element:i.jsx(QM,{})}),i.jsx(ia,{path:"/shop/:slug/booking/:refCode",element:i.jsx(wO,{})}),i.jsx(ia,{path:"/shop/:slug/waitlist/:refCode",element:i.jsx(SO,{})}),i.jsx(ia,{path:"/shop/:slug/queue",element:i.jsx(TO,{})}),i.jsx(ia,{path:"/shop/:slug/login",element:i.jsx(vO,{user:s})}),i.jsx(ia,{path:"/shop/:slug/dashboard",element:i.jsx(yO,{user:s})}),i.jsx(ia,{path:"*",element:i.jsx(tT,{to:"/",replace:!0})})]})})}rj.createRoot(document.getElementById("root")).render(i.jsx($t.StrictMode,{children:i.jsx(AO,{})}));
