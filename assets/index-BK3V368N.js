(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();function xx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var t0={exports:{}},Qc={};var Jv;function $E(){if(Jv)return Qc;Jv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var m in o)m!=="key"&&(c[m]=o[m])}else c=o;return o=c.ref,{$$typeof:n,type:i,key:d,ref:o!==void 0?o:null,props:c}}return Qc.Fragment=e,Qc.jsx=t,Qc.jsxs=t,Qc}var Zv;function qE(){return Zv||(Zv=1,t0.exports=$E()),t0.exports}var a=qE(),s0={exports:{}},ot={};var ew;function HE(){if(ew)return ot;ew=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),j=Symbol.iterator;function R(B){return B===null||typeof B!="object"?null:(B=j&&B[j]||B["@@iterator"],typeof B=="function"?B:null)}var U={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,L={};function z(B,J,le){this.props=B,this.context=J,this.refs=L,this.updater=le||U}z.prototype.isReactComponent={},z.prototype.setState=function(B,J){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,J,"setState")},z.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function Q(){}Q.prototype=z.prototype;function G(B,J,le){this.props=B,this.context=J,this.refs=L,this.updater=le||U}var ie=G.prototype=new Q;ie.constructor=G,V(ie,z.prototype),ie.isPureReactComponent=!0;var he=Array.isArray;function W(){}var T={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function S(B,J,le){var pe=le.ref;return{$$typeof:n,type:B,key:J,ref:pe!==void 0?pe:null,props:le}}function I(B,J){return S(B.type,J,B.props)}function k(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function M(B){var J={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(le){return J[le]})}var C=/\/+/g;function F(B,J){return typeof B=="object"&&B!==null&&B.key!=null?M(""+B.key):J.toString(36)}function P(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(W,W):(B.status="pending",B.then(function(J){B.status==="pending"&&(B.status="fulfilled",B.value=J)},function(J){B.status==="pending"&&(B.status="rejected",B.reason=J)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function O(B,J,le,pe,xe){var Me=typeof B;(Me==="undefined"||Me==="boolean")&&(B=null);var Ge=!1;if(B===null)Ge=!0;else switch(Me){case"bigint":case"string":case"number":Ge=!0;break;case"object":switch(B.$$typeof){case n:case e:Ge=!0;break;case b:return Ge=B._init,O(Ge(B._payload),J,le,pe,xe)}}if(Ge)return xe=xe(B),Ge=pe===""?"."+F(B,0):pe,he(xe)?(le="",Ge!=null&&(le=Ge.replace(C,"$&/")+"/"),O(xe,J,le,"",function(Gt){return Gt})):xe!=null&&(k(xe)&&(xe=I(xe,le+(xe.key==null||B&&B.key===xe.key?"":(""+xe.key).replace(C,"$&/")+"/")+Ge)),J.push(xe)),1;Ge=0;var xt=pe===""?".":pe+":";if(he(B))for(var it=0;it<B.length;it++)pe=B[it],Me=xt+F(pe,it),Ge+=O(pe,J,le,Me,xe);else if(it=R(B),typeof it=="function")for(B=it.call(B),it=0;!(pe=B.next()).done;)pe=pe.value,Me=xt+F(pe,it++),Ge+=O(pe,J,le,Me,xe);else if(Me==="object"){if(typeof B.then=="function")return O(P(B),J,le,pe,xe);throw J=String(B),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return Ge}function K(B,J,le){if(B==null)return B;var pe=[],xe=0;return O(B,pe,"","",function(Me){return J.call(le,Me,xe++)}),pe}function ce(B){if(B._status===-1){var J=B._result;J=J(),J.then(function(le){(B._status===0||B._status===-1)&&(B._status=1,B._result=le)},function(le){(B._status===0||B._status===-1)&&(B._status=2,B._result=le)}),B._status===-1&&(B._status=0,B._result=J)}if(B._status===1)return B._result.default;throw B._result}var Se=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},be={map:K,forEach:function(B,J,le){K(B,function(){J.apply(this,arguments)},le)},count:function(B){var J=0;return K(B,function(){J++}),J},toArray:function(B){return K(B,function(J){return J})||[]},only:function(B){if(!k(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return ot.Activity=w,ot.Children=be,ot.Component=z,ot.Fragment=t,ot.Profiler=o,ot.PureComponent=G,ot.StrictMode=i,ot.Suspense=x,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,ot.__COMPILER_RUNTIME={__proto__:null,c:function(B){return T.H.useMemoCache(B)}},ot.cache=function(B){return function(){return B.apply(null,arguments)}},ot.cacheSignal=function(){return null},ot.cloneElement=function(B,J,le){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var pe=V({},B.props),xe=B.key;if(J!=null)for(Me in J.key!==void 0&&(xe=""+J.key),J)!E.call(J,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&J.ref===void 0||(pe[Me]=J[Me]);var Me=arguments.length-2;if(Me===1)pe.children=le;else if(1<Me){for(var Ge=Array(Me),xt=0;xt<Me;xt++)Ge[xt]=arguments[xt+2];pe.children=Ge}return S(B.type,xe,pe)},ot.createContext=function(B){return B={$$typeof:d,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:c,_context:B},B},ot.createElement=function(B,J,le){var pe,xe={},Me=null;if(J!=null)for(pe in J.key!==void 0&&(Me=""+J.key),J)E.call(J,pe)&&pe!=="key"&&pe!=="__self"&&pe!=="__source"&&(xe[pe]=J[pe]);var Ge=arguments.length-2;if(Ge===1)xe.children=le;else if(1<Ge){for(var xt=Array(Ge),it=0;it<Ge;it++)xt[it]=arguments[it+2];xe.children=xt}if(B&&B.defaultProps)for(pe in Ge=B.defaultProps,Ge)xe[pe]===void 0&&(xe[pe]=Ge[pe]);return S(B,Me,xe)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(B){return{$$typeof:m,render:B}},ot.isValidElement=k,ot.lazy=function(B){return{$$typeof:b,_payload:{_status:-1,_result:B},_init:ce}},ot.memo=function(B,J){return{$$typeof:g,type:B,compare:J===void 0?null:J}},ot.startTransition=function(B){var J=T.T,le={};T.T=le;try{var pe=B(),xe=T.S;xe!==null&&xe(le,pe),typeof pe=="object"&&pe!==null&&typeof pe.then=="function"&&pe.then(W,Se)}catch(Me){Se(Me)}finally{J!==null&&le.types!==null&&(J.types=le.types),T.T=J}},ot.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},ot.use=function(B){return T.H.use(B)},ot.useActionState=function(B,J,le){return T.H.useActionState(B,J,le)},ot.useCallback=function(B,J){return T.H.useCallback(B,J)},ot.useContext=function(B){return T.H.useContext(B)},ot.useDebugValue=function(){},ot.useDeferredValue=function(B,J){return T.H.useDeferredValue(B,J)},ot.useEffect=function(B,J){return T.H.useEffect(B,J)},ot.useEffectEvent=function(B){return T.H.useEffectEvent(B)},ot.useId=function(){return T.H.useId()},ot.useImperativeHandle=function(B,J,le){return T.H.useImperativeHandle(B,J,le)},ot.useInsertionEffect=function(B,J){return T.H.useInsertionEffect(B,J)},ot.useLayoutEffect=function(B,J){return T.H.useLayoutEffect(B,J)},ot.useMemo=function(B,J){return T.H.useMemo(B,J)},ot.useOptimistic=function(B,J){return T.H.useOptimistic(B,J)},ot.useReducer=function(B,J,le){return T.H.useReducer(B,J,le)},ot.useRef=function(B){return T.H.useRef(B)},ot.useState=function(B){return T.H.useState(B)},ot.useSyncExternalStore=function(B,J,le){return T.H.useSyncExternalStore(B,J,le)},ot.useTransition=function(){return T.H.useTransition()},ot.version="19.2.4",ot}var tw;function gx(){return tw||(tw=1,s0.exports=HE()),s0.exports}var _=gx();const Qt=xx(_);var n0={exports:{}},Kc={},a0={exports:{}},r0={};var sw;function GE(){return sw||(sw=1,(function(n){function e(O,K){var ce=O.length;O.push(K);e:for(;0<ce;){var Se=ce-1>>>1,be=O[Se];if(0<o(be,K))O[Se]=K,O[ce]=be,ce=Se;else break e}}function t(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var K=O[0],ce=O.pop();if(ce!==K){O[0]=ce;e:for(var Se=0,be=O.length,B=be>>>1;Se<B;){var J=2*(Se+1)-1,le=O[J],pe=J+1,xe=O[pe];if(0>o(le,ce))pe<be&&0>o(xe,le)?(O[Se]=xe,O[pe]=ce,Se=pe):(O[Se]=le,O[J]=ce,Se=J);else if(pe<be&&0>o(xe,ce))O[Se]=xe,O[pe]=ce,Se=pe;else break e}}return K}function o(O,K){var ce=O.sortIndex-K.sortIndex;return ce!==0?ce:O.id-K.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,m=d.now();n.unstable_now=function(){return d.now()-m}}var x=[],g=[],b=1,w=null,j=3,R=!1,U=!1,V=!1,L=!1,z=typeof setTimeout=="function"?setTimeout:null,Q=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;function ie(O){for(var K=t(g);K!==null;){if(K.callback===null)i(g);else if(K.startTime<=O)i(g),K.sortIndex=K.expirationTime,e(x,K);else break;K=t(g)}}function he(O){if(V=!1,ie(O),!U)if(t(x)!==null)U=!0,W||(W=!0,M());else{var K=t(g);K!==null&&P(he,K.startTime-O)}}var W=!1,T=-1,E=5,S=-1;function I(){return L?!0:!(n.unstable_now()-S<E)}function k(){if(L=!1,W){var O=n.unstable_now();S=O;var K=!0;try{e:{U=!1,V&&(V=!1,Q(T),T=-1),R=!0;var ce=j;try{t:{for(ie(O),w=t(x);w!==null&&!(w.expirationTime>O&&I());){var Se=w.callback;if(typeof Se=="function"){w.callback=null,j=w.priorityLevel;var be=Se(w.expirationTime<=O);if(O=n.unstable_now(),typeof be=="function"){w.callback=be,ie(O),K=!0;break t}w===t(x)&&i(x),ie(O)}else i(x);w=t(x)}if(w!==null)K=!0;else{var B=t(g);B!==null&&P(he,B.startTime-O),K=!1}}break e}finally{w=null,j=ce,R=!1}K=void 0}}finally{K?M():W=!1}}}var M;if(typeof G=="function")M=function(){G(k)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,F=C.port2;C.port1.onmessage=k,M=function(){F.postMessage(null)}}else M=function(){z(k,0)};function P(O,K){T=z(function(){O(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return j},n.unstable_next=function(O){switch(j){case 1:case 2:case 3:var K=3;break;default:K=j}var ce=j;j=K;try{return O()}finally{j=ce}},n.unstable_requestPaint=function(){L=!0},n.unstable_runWithPriority=function(O,K){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var ce=j;j=O;try{return K()}finally{j=ce}},n.unstable_scheduleCallback=function(O,K,ce){var Se=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?Se+ce:Se):ce=Se,O){case 1:var be=-1;break;case 2:be=250;break;case 5:be=1073741823;break;case 4:be=1e4;break;default:be=5e3}return be=ce+be,O={id:b++,callback:K,priorityLevel:O,startTime:ce,expirationTime:be,sortIndex:-1},ce>Se?(O.sortIndex=ce,e(g,O),t(x)===null&&O===t(g)&&(V?(Q(T),T=-1):V=!0,P(he,ce-Se))):(O.sortIndex=be,e(x,O),U||R||(U=!0,W||(W=!0,M()))),O},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(O){var K=j;return function(){var ce=j;j=K;try{return O.apply(this,arguments)}finally{j=ce}}}})(r0)),r0}var nw;function YE(){return nw||(nw=1,a0.exports=GE()),a0.exports}var i0={exports:{}},Xs={};var aw;function WE(){if(aw)return Xs;aw=1;var n=gx();function e(x){var g="https://react.dev/errors/"+x;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+x+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(x,g,b){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:w==null?null:""+w,children:x,containerInfo:g,implementation:b}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(x,g){if(x==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return Xs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Xs.createPortal=function(x,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(x,g,null,b)},Xs.flushSync=function(x){var g=d.T,b=i.p;try{if(d.T=null,i.p=2,x)return x()}finally{d.T=g,i.p=b,i.d.f()}},Xs.preconnect=function(x,g){typeof x=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(x,g))},Xs.prefetchDNS=function(x){typeof x=="string"&&i.d.D(x)},Xs.preinit=function(x,g){if(typeof x=="string"&&g&&typeof g.as=="string"){var b=g.as,w=m(b,g.crossOrigin),j=typeof g.integrity=="string"?g.integrity:void 0,R=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?i.d.S(x,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:w,integrity:j,fetchPriority:R}):b==="script"&&i.d.X(x,{crossOrigin:w,integrity:j,fetchPriority:R,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},Xs.preinitModule=function(x,g){if(typeof x=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=m(g.as,g.crossOrigin);i.d.M(x,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(x)},Xs.preload=function(x,g){if(typeof x=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,w=m(b,g.crossOrigin);i.d.L(x,b,{crossOrigin:w,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},Xs.preloadModule=function(x,g){if(typeof x=="string")if(g){var b=m(g.as,g.crossOrigin);i.d.m(x,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(x)},Xs.requestFormReset=function(x){i.d.r(x)},Xs.unstable_batchedUpdates=function(x,g){return x(g)},Xs.useFormState=function(x,g,b){return d.H.useFormState(x,g,b)},Xs.useFormStatus=function(){return d.H.useHostTransitionStatus()},Xs.version="19.2.4",Xs}var rw;function QE(){if(rw)return i0.exports;rw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),i0.exports=WE(),i0.exports}var iw;function KE(){if(iw)return Kc;iw=1;var n=YE(),e=gx(),t=QE();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var r=s,l=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(l=r.return),s=r.return;while(s)}return r.tag===3?l:null}function d(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function m(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function x(s){if(c(s)!==s)throw Error(i(188))}function g(s){var r=s.alternate;if(!r){if(r=c(s),r===null)throw Error(i(188));return r!==s?null:s}for(var l=s,u=r;;){var f=l.return;if(f===null)break;var p=f.alternate;if(p===null){if(u=f.return,u!==null){l=u;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===l)return x(f),s;if(p===u)return x(f),r;p=p.sibling}throw Error(i(188))}if(l.return!==u.return)l=f,u=p;else{for(var v=!1,A=f.child;A;){if(A===l){v=!0,l=f,u=p;break}if(A===u){v=!0,u=f,l=p;break}A=A.sibling}if(!v){for(A=p.child;A;){if(A===l){v=!0,l=p,u=f;break}if(A===u){v=!0,u=p,l=f;break}A=A.sibling}if(!v)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:r}function b(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=b(s),r!==null)return r;s=s.sibling}return null}var w=Object.assign,j=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),U=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),Q=Symbol.for("react.consumer"),G=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function M(s){return s===null||typeof s!="object"?null:(s=k&&s[k]||s["@@iterator"],typeof s=="function"?s:null)}var C=Symbol.for("react.client.reference");function F(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===C?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case V:return"Fragment";case z:return"Profiler";case L:return"StrictMode";case he:return"Suspense";case W:return"SuspenseList";case S:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case U:return"Portal";case G:return s.displayName||"Context";case Q:return(s._context.displayName||"Context")+".Consumer";case ie:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case T:return r=s.displayName||null,r!==null?r:F(s.type)||"Memo";case E:r=s._payload,s=s._init;try{return F(s(r))}catch{}}return null}var P=Array.isArray,O=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},Se=[],be=-1;function B(s){return{current:s}}function J(s){0>be||(s.current=Se[be],Se[be]=null,be--)}function le(s,r){be++,Se[be]=s.current,s.current=r}var pe=B(null),xe=B(null),Me=B(null),Ge=B(null);function xt(s,r){switch(le(Me,r),le(xe,s),le(pe,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?wv(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=wv(r),s=Nv(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}J(pe),le(pe,s)}function it(){J(pe),J(xe),J(Me)}function Gt(s){s.memoizedState!==null&&le(Ge,s);var r=pe.current,l=Nv(r,s.type);r!==l&&(le(xe,s),le(pe,l))}function ae(s){xe.current===s&&(J(pe),J(xe)),Ge.current===s&&(J(Ge),Hc._currentValue=ce)}var _e,Ee;function qe(s){if(_e===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);_e=r&&r[1]||"",Ee=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+_e+s+Ee}var Je=!1;function Nt(s,r){if(!s||Je)return"";Je=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(ue){var re=ue}Reflect.construct(s,[],ye)}else{try{ye.call()}catch(ue){re=ue}s.call(ye.prototype)}}else{try{throw Error()}catch(ue){re=ue}(ye=s())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(ue){if(ue&&re&&typeof ue.stack=="string")return[ue.stack,re.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=u.DetermineComponentFrameRoot(),v=p[0],A=p[1];if(v&&A){var q=v.split(`
`),ne=A.split(`
`);for(f=u=0;u<q.length&&!q[u].includes("DetermineComponentFrameRoot");)u++;for(;f<ne.length&&!ne[f].includes("DetermineComponentFrameRoot");)f++;if(u===q.length||f===ne.length)for(u=q.length-1,f=ne.length-1;1<=u&&0<=f&&q[u]!==ne[f];)f--;for(;1<=u&&0<=f;u--,f--)if(q[u]!==ne[f]){if(u!==1||f!==1)do if(u--,f--,0>f||q[u]!==ne[f]){var me=`
`+q[u].replace(" at new "," at ");return s.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",s.displayName)),me}while(1<=u&&0<=f);break}}}finally{Je=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?qe(l):""}function Vs(s,r){switch(s.tag){case 26:case 27:case 5:return qe(s.type);case 16:return qe("Lazy");case 13:return s.child!==r&&r!==null?qe("Suspense Fallback"):qe("Suspense");case 19:return qe("SuspenseList");case 0:case 15:return Nt(s.type,!1);case 11:return Nt(s.type.render,!1);case 1:return Nt(s.type,!0);case 31:return qe("Activity");default:return""}}function At(s){try{var r="",l=null;do r+=Vs(s,l),l=s,s=s.return;while(s);return r}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var ft=Object.prototype.hasOwnProperty,Ie=n.unstable_scheduleCallback,Be=n.unstable_cancelCallback,fe=n.unstable_shouldYield,ze=n.unstable_requestPaint,Ve=n.unstable_now,De=n.unstable_getCurrentPriorityLevel,He=n.unstable_ImmediatePriority,Ye=n.unstable_UserBlockingPriority,Z=n.unstable_NormalPriority,Ce=n.unstable_LowPriority,We=n.unstable_IdlePriority,tt=n.log,kt=n.unstable_setDisableYieldValue,Lt=null,_t=null;function ss(s){if(typeof tt=="function"&&kt(s),_t&&typeof _t.setStrictMode=="function")try{_t.setStrictMode(Lt,s)}catch{}}var It=Math.clz32?Math.clz32:Ea,Qs=Math.log,Is=Math.LN2;function Ea(s){return s>>>=0,s===0?32:31-(Qs(s)/Is|0)|0}var $=256,H=262144,ee=4194304;function de(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Te(s,r,l){var u=s.pendingLanes;if(u===0)return 0;var f=0,p=s.suspendedLanes,v=s.pingedLanes;s=s.warmLanes;var A=u&134217727;return A!==0?(u=A&~p,u!==0?f=de(u):(v&=A,v!==0?f=de(v):l||(l=A&~s,l!==0&&(f=de(l))))):(A=u&~p,A!==0?f=de(A):v!==0?f=de(v):l||(l=u&~s,l!==0&&(f=de(l)))),f===0?0:r!==0&&r!==f&&(r&p)===0&&(p=f&-f,l=r&-r,p>=l||p===32&&(l&4194048)!==0)?r:f}function Oe(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function Ae(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function je(){var s=ee;return ee<<=1,(ee&62914560)===0&&(ee=4194304),s}function Ze(s){for(var r=[],l=0;31>l;l++)r.push(s);return r}function St(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ns(s,r,l,u,f,p){var v=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var A=s.entanglements,q=s.expirationTimes,ne=s.hiddenUpdates;for(l=v&~l;0<l;){var me=31-It(l),ye=1<<me;A[me]=0,q[me]=-1;var re=ne[me];if(re!==null)for(ne[me]=null,me=0;me<re.length;me++){var ue=re[me];ue!==null&&(ue.lane&=-536870913)}l&=~ye}u!==0&&as(s,u,0),p!==0&&f===0&&s.tag!==0&&(s.suspendedLanes|=p&~(v&~r))}function as(s,r,l){s.pendingLanes|=r,s.suspendedLanes&=~r;var u=31-It(r);s.entangledLanes|=r,s.entanglements[u]=s.entanglements[u]|1073741824|l&261930}function Sn(s,r){var l=s.entangledLanes|=r;for(s=s.entanglements;l;){var u=31-It(l),f=1<<u;f&r|s[u]&r&&(s[u]|=r),l&=~f}}function zn(s,r){var l=r&-r;return l=(l&42)!==0?1:ia(l),(l&(s.suspendedLanes|r))!==0?0:l}function ia(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function us(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function tr(){var s=K.p;return s!==0?s:(s=window.event,s===void 0?32:Hv(s.type))}function rs(s,r){var l=K.p;try{return K.p=s,r()}finally{K.p=l}}var Ks=Math.random().toString(36).slice(2),is="__reactFiber$"+Ks,ws="__reactProps$"+Ks,En="__reactContainer$"+Ks,Li="__reactEvents$"+Ks,lm="__reactListeners$"+Ks,Ju="__reactHandles$"+Ks,Zu="__reactResources$"+Ks,Ta="__reactMarker$"+Ks;function Rl(s){delete s[is],delete s[ws],delete s[Li],delete s[lm],delete s[Ju]}function Aa(s){var r=s[is];if(r)return r;for(var l=s.parentNode;l;){if(r=l[En]||l[is]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(s=kv(s);s!==null;){if(l=s[is])return l;s=kv(s)}return r}s=l,l=s.parentNode}return null}function Fn(s){if(s=s[is]||s[En]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function Tn(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function ka(s){var r=s[Zu];return r||(r=s[Zu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Ns(s){s[Ta]=!0}var Jo=new Set,Zo={};function Ca(s,r){Ra(s,r),Ra(s+"Capture",r)}function Ra(s,r){for(Zo[s]=r,s=0;s<r.length;s++)Jo.add(r[s])}var ec=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tc={},sc={};function ed(s){return ft.call(sc,s)?!0:ft.call(tc,s)?!1:ec.test(s)?sc[s]=!0:(tc[s]=!0,!1)}function Il(s,r,l){if(ed(r))if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+l)}}function An(s,r,l){if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+l)}}function _s(s,r,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(r,l,""+u)}}function Ls(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Or(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function nc(s,r,l){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var f=u.get,p=u.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return f.call(this)},set:function(v){l=""+v,p.call(this,v)}}),Object.defineProperty(s,r,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(v){l=""+v},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Ut(s){if(!s._valueTracker){var r=Or(s)?"checked":"value";s._valueTracker=nc(s,r,""+s[r])}}function Ui(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return s&&(u=Or(s)?s.checked?"true":"false":s.value),s=u,s!==l?(r.setValue(s),!0):!1}function Ia(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Bi=/[\n"\\]/g;function on(s){return s.replace(Bi,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Dl(s,r,l,u,f,p,v,A){s.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?s.type=v:s.removeAttribute("type"),r!=null?v==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+Ls(r)):s.value!==""+Ls(r)&&(s.value=""+Ls(r)):v!=="submit"&&v!=="reset"||s.removeAttribute("value"),r!=null?ac(s,v,Ls(r)):l!=null?ac(s,v,Ls(l)):u!=null&&s.removeAttribute("value"),f==null&&p!=null&&(s.defaultChecked=!!p),f!=null&&(s.checked=f&&typeof f!="function"&&typeof f!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.name=""+Ls(A):s.removeAttribute("name")}function td(s,r,l,u,f,p,v,A){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(s.type=p),r!=null||l!=null){if(!(p!=="submit"&&p!=="reset"||r!=null)){Ut(s);return}l=l!=null?""+Ls(l):"",r=r!=null?""+Ls(r):l,A||r===s.value||(s.value=r),s.defaultValue=r}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=A?s.checked:!!u,s.defaultChecked=!!u,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.name=v),Ut(s)}function ac(s,r,l){r==="number"&&Ia(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function Pr(s,r,l,u){if(s=s.options,r){r={};for(var f=0;f<l.length;f++)r["$"+l[f]]=!0;for(l=0;l<s.length;l++)f=r.hasOwnProperty("$"+s[l].value),s[l].selected!==f&&(s[l].selected=f),f&&u&&(s[l].defaultSelected=!0)}else{for(l=""+Ls(l),r=null,f=0;f<s.length;f++){if(s[f].value===l){s[f].selected=!0,u&&(s[f].defaultSelected=!0);return}r!==null||s[f].disabled||(r=s[f])}r!==null&&(r.selected=!0)}}function sd(s,r,l){if(r!=null&&(r=""+Ls(r),r!==s.value&&(s.value=r),l==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=l!=null?""+Ls(l):""}function Vr(s,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(i(92));if(P(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=Ls(r),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u),Ut(s)}function cn(s,r){if(r){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=r;return}}s.textContent=r}var nd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rc(s,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":u?s.setProperty(r,l):typeof l!="number"||l===0||nd.has(r)?r==="float"?s.cssFloat=l:s[r]=(""+l).trim():s[r]=l+"px"}function ic(s,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var f in r)u=r[f],r.hasOwnProperty(f)&&l[f]!==u&&rc(s,f,u)}else for(var p in r)r.hasOwnProperty(p)&&rc(s,p,r[p])}function Ml(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ad=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Lr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ol(s){return Lr.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function la(){}var lc=null;function $n(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ur=null,Da=null;function zi(s){var r=Fn(s);if(r&&(s=r.stateNode)){var l=s[ws]||null;e:switch(s=r.stateNode,r.type){case"input":if(Dl(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+on(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==s&&u.form===s.form){var f=u[ws]||null;if(!f)throw Error(i(90));Dl(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===s.form&&Ui(u)}break e;case"textarea":sd(s,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&Pr(s,!!l.multiple,r,!1)}}}var Pl=!1;function Br(s,r,l){if(Pl)return s(r,l);Pl=!0;try{var u=s(r);return u}finally{if(Pl=!1,(Ur!==null||Da!==null)&&(Xd(),Ur&&(r=Ur,s=Da,Da=Ur=null,zi(r),s)))for(r=0;r<s.length;r++)zi(s[r])}}function oa(s,r){var l=s.stateNode;if(l===null)return null;var u=l[ws]||null;if(u===null)return null;l=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fi=!1;if(qn)try{var Ft={};Object.defineProperty(Ft,"passive",{get:function(){Fi=!0}}),window.addEventListener("test",Ft,Ft),window.removeEventListener("test",Ft,Ft)}catch{Fi=!1}var Ma=null,oc=null,$i=null;function cc(){if($i)return $i;var s,r=oc,l=r.length,u,f="value"in Ma?Ma.value:Ma.textContent,p=f.length;for(s=0;s<l&&r[s]===f[s];s++);var v=l-s;for(u=1;u<=v&&r[l-u]===f[p-u];u++);return $i=f.slice(s,1<u?1-u:void 0)}function qi(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function sr(){return!0}function ca(){return!1}function zs(s){function r(l,u,f,p,v){this._reactName=l,this._targetInst=f,this.type=u,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var A in s)s.hasOwnProperty(A)&&(l=s[A],this[A]=l?l(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?sr:ca,this.isPropagationStopped=ca,this}return w(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=sr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=sr)},persist:function(){},isPersistent:sr}),r}var nr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Oa=zs(nr),zr=w({},nr,{view:0,detail:0}),uc=zs(zr),Fr,Vl,Pa,Ll=w({},zr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$r,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Pa&&(Pa&&s.type==="mousemove"?(Fr=s.screenX-Pa.screenX,Vl=s.screenY-Pa.screenY):Vl=Fr=0,Pa=s),Fr)},movementY:function(s){return"movementY"in s?s.movementY:Vl}}),dc=zs(Ll),Hi=w({},Ll,{dataTransfer:0}),rd=zs(Hi),id=w({},zr,{relatedTarget:0}),Gi=zs(id),hc=w({},nr,{animationName:0,elapsedTime:0,pseudoElement:0}),ld=zs(hc),Ul=w({},nr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),od=zs(Ul),cd=w({},nr,{data:0}),Va=zs(cd),ud={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fd(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=hd[s])?!!r[s]:!1}function $r(){return fd}var nn=w({},zr,{key:function(s){if(s.key){var r=ud[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=qi(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?dd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$r,charCode:function(s){return s.type==="keypress"?qi(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?qi(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),md=zs(nn),pd=w({},Ll,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ar=zs(pd),h=w({},zr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$r}),y=zs(h),N=w({},nr,{propertyName:0,elapsedTime:0,pseudoElement:0}),D=zs(N),te=w({},Ll,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),oe=zs(te),ke=w({},nr,{newState:0,oldState:0}),ut=zs(ke),gs=[9,13,27,32],Dt=qn&&"CompositionEvent"in window,ls=null;qn&&"documentMode"in document&&(ls=document.documentMode);var Hn=qn&&"TextEvent"in window&&!ls,La=qn&&(!Dt||ls&&8<ls&&11>=ls),ua=" ",da=!1;function Yi(s,r){switch(s){case"keyup":return gs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var zl=!1;function fS(s,r){switch(s){case"compositionend":return Bl(r);case"keypress":return r.which!==32?null:(da=!0,ua);case"textInput":return s=r.data,s===ua&&da?null:s;default:return null}}function mS(s,r){if(zl)return s==="compositionend"||!Dt&&Yi(s,r)?(s=cc(),$i=oc=Ma=null,zl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return La&&r.locale!=="ko"?null:r.data;default:return null}}var pS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ig(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!pS[s.type]:r==="textarea"}function Dg(s,r,l,u){Ur?Da?Da.push(u):Da=[u]:Ur=u,r=ah(r,"onChange"),0<r.length&&(l=new Oa("onChange","change",null,l,u),s.push({event:l,listeners:r}))}var fc=null,mc=null;function xS(s){pv(s,0)}function xd(s){var r=Tn(s);if(Ui(r))return s}function Mg(s,r){if(s==="change")return r}var Og=!1;if(qn){var om;if(qn){var cm="oninput"in document;if(!cm){var Pg=document.createElement("div");Pg.setAttribute("oninput","return;"),cm=typeof Pg.oninput=="function"}om=cm}else om=!1;Og=om&&(!document.documentMode||9<document.documentMode)}function Vg(){fc&&(fc.detachEvent("onpropertychange",Lg),mc=fc=null)}function Lg(s){if(s.propertyName==="value"&&xd(mc)){var r=[];Dg(r,mc,s,$n(s)),Br(xS,r)}}function gS(s,r,l){s==="focusin"?(Vg(),fc=r,mc=l,fc.attachEvent("onpropertychange",Lg)):s==="focusout"&&Vg()}function bS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return xd(mc)}function yS(s,r){if(s==="click")return xd(r)}function vS(s,r){if(s==="input"||s==="change")return xd(r)}function wS(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var kn=typeof Object.is=="function"?Object.is:wS;function pc(s,r){if(kn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var l=Object.keys(s),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var f=l[u];if(!ft.call(r,f)||!kn(s[f],r[f]))return!1}return!0}function Ug(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Bg(s,r){var l=Ug(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=r&&u>=r)return{node:l,offset:r-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Ug(l)}}function zg(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?zg(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Fg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Ia(s.document);r instanceof s.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)s=r.contentWindow;else break;r=Ia(s.document)}return r}function um(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var NS=qn&&"documentMode"in document&&11>=document.documentMode,Fl=null,dm=null,xc=null,hm=!1;function $g(s,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;hm||Fl==null||Fl!==Ia(u)||(u=Fl,"selectionStart"in u&&um(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),xc&&pc(xc,u)||(xc=u,u=ah(dm,"onSelect"),0<u.length&&(r=new Oa("onSelect","select",null,r,l),s.push({event:r,listeners:u}),r.target=Fl)))}function Wi(s,r){var l={};return l[s.toLowerCase()]=r.toLowerCase(),l["Webkit"+s]="webkit"+r,l["Moz"+s]="moz"+r,l}var $l={animationend:Wi("Animation","AnimationEnd"),animationiteration:Wi("Animation","AnimationIteration"),animationstart:Wi("Animation","AnimationStart"),transitionrun:Wi("Transition","TransitionRun"),transitionstart:Wi("Transition","TransitionStart"),transitioncancel:Wi("Transition","TransitionCancel"),transitionend:Wi("Transition","TransitionEnd")},fm={},qg={};qn&&(qg=document.createElement("div").style,"AnimationEvent"in window||(delete $l.animationend.animation,delete $l.animationiteration.animation,delete $l.animationstart.animation),"TransitionEvent"in window||delete $l.transitionend.transition);function Qi(s){if(fm[s])return fm[s];if(!$l[s])return s;var r=$l[s],l;for(l in r)if(r.hasOwnProperty(l)&&l in qg)return fm[s]=r[l];return s}var Hg=Qi("animationend"),Gg=Qi("animationiteration"),Yg=Qi("animationstart"),_S=Qi("transitionrun"),jS=Qi("transitionstart"),SS=Qi("transitioncancel"),Wg=Qi("transitionend"),Qg=new Map,mm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mm.push("scrollEnd");function ha(s,r){Qg.set(s,r),Ca(r,[s])}var gd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Gn=[],ql=0,pm=0;function bd(){for(var s=ql,r=pm=ql=0;r<s;){var l=Gn[r];Gn[r++]=null;var u=Gn[r];Gn[r++]=null;var f=Gn[r];Gn[r++]=null;var p=Gn[r];if(Gn[r++]=null,u!==null&&f!==null){var v=u.pending;v===null?f.next=f:(f.next=v.next,v.next=f),u.pending=f}p!==0&&Kg(l,f,p)}}function yd(s,r,l,u){Gn[ql++]=s,Gn[ql++]=r,Gn[ql++]=l,Gn[ql++]=u,pm|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function xm(s,r,l,u){return yd(s,r,l,u),vd(s)}function Ki(s,r){return yd(s,null,null,r),vd(s)}function Kg(s,r,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var f=!1,p=s.return;p!==null;)p.childLanes|=l,u=p.alternate,u!==null&&(u.childLanes|=l),p.tag===22&&(s=p.stateNode,s===null||s._visibility&1||(f=!0)),s=p,p=p.return;return s.tag===3?(p=s.stateNode,f&&r!==null&&(f=31-It(l),s=p.hiddenUpdates,u=s[f],u===null?s[f]=[r]:u.push(r),r.lane=l|536870912),p):null}function vd(s){if(50<Lc)throw Lc=0,Sp=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var Hl={};function ES(s,r,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cn(s,r,l,u){return new ES(s,r,l,u)}function gm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function rr(s,r){var l=s.alternate;return l===null?(l=Cn(s.tag,r,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=r,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,r=s.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Xg(s,r){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,r=l.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function wd(s,r,l,u,f,p){var v=0;if(u=s,typeof s=="function")gm(s)&&(v=1);else if(typeof s=="string")v=RE(s,l,pe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case S:return s=Cn(31,l,r,f),s.elementType=S,s.lanes=p,s;case V:return Xi(l.children,f,p,r);case L:v=8,f|=24;break;case z:return s=Cn(12,l,r,f|2),s.elementType=z,s.lanes=p,s;case he:return s=Cn(13,l,r,f),s.elementType=he,s.lanes=p,s;case W:return s=Cn(19,l,r,f),s.elementType=W,s.lanes=p,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case G:v=10;break e;case Q:v=9;break e;case ie:v=11;break e;case T:v=14;break e;case E:v=16,u=null;break e}v=29,l=Error(i(130,s===null?"null":typeof s,"")),u=null}return r=Cn(v,l,r,f),r.elementType=s,r.type=u,r.lanes=p,r}function Xi(s,r,l,u){return s=Cn(7,s,u,r),s.lanes=l,s}function bm(s,r,l){return s=Cn(6,s,null,r),s.lanes=l,s}function Jg(s){var r=Cn(18,null,null,0);return r.stateNode=s,r}function ym(s,r,l){return r=Cn(4,s.children!==null?s.children:[],s.key,r),r.lanes=l,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var Zg=new WeakMap;function Yn(s,r){if(typeof s=="object"&&s!==null){var l=Zg.get(s);return l!==void 0?l:(r={value:s,source:r,stack:At(r)},Zg.set(s,r),r)}return{value:s,source:r,stack:At(r)}}var Gl=[],Yl=0,Nd=null,gc=0,Wn=[],Qn=0,qr=null,Ua=1,Ba="";function ir(s,r){Gl[Yl++]=gc,Gl[Yl++]=Nd,Nd=s,gc=r}function eb(s,r,l){Wn[Qn++]=Ua,Wn[Qn++]=Ba,Wn[Qn++]=qr,qr=s;var u=Ua;s=Ba;var f=32-It(u)-1;u&=~(1<<f),l+=1;var p=32-It(r)+f;if(30<p){var v=f-f%5;p=(u&(1<<v)-1).toString(32),u>>=v,f-=v,Ua=1<<32-It(r)+f|l<<f|u,Ba=p+s}else Ua=1<<p|l<<f|u,Ba=s}function vm(s){s.return!==null&&(ir(s,1),eb(s,1,0))}function wm(s){for(;s===Nd;)Nd=Gl[--Yl],Gl[Yl]=null,gc=Gl[--Yl],Gl[Yl]=null;for(;s===qr;)qr=Wn[--Qn],Wn[Qn]=null,Ba=Wn[--Qn],Wn[Qn]=null,Ua=Wn[--Qn],Wn[Qn]=null}function tb(s,r){Wn[Qn++]=Ua,Wn[Qn++]=Ba,Wn[Qn++]=qr,Ua=r.id,Ba=r.overflow,qr=s}var Fs=null,Zt=null,jt=!1,Hr=null,Kn=!1,Nm=Error(i(519));function Gr(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bc(Yn(r,s)),Nm}function sb(s){var r=s.stateNode,l=s.type,u=s.memoizedProps;switch(r[is]=s,r[ws]=u,l){case"dialog":pt("cancel",r),pt("close",r);break;case"iframe":case"object":case"embed":pt("load",r);break;case"video":case"audio":for(l=0;l<Bc.length;l++)pt(Bc[l],r);break;case"source":pt("error",r);break;case"img":case"image":case"link":pt("error",r),pt("load",r);break;case"details":pt("toggle",r);break;case"input":pt("invalid",r),td(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":pt("invalid",r);break;case"textarea":pt("invalid",r),Vr(r,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||yv(r.textContent,l)?(u.popover!=null&&(pt("beforetoggle",r),pt("toggle",r)),u.onScroll!=null&&pt("scroll",r),u.onScrollEnd!=null&&pt("scrollend",r),u.onClick!=null&&(r.onclick=la),r=!0):r=!1,r||Gr(s,!0)}function nb(s){for(Fs=s.return;Fs;)switch(Fs.tag){case 5:case 31:case 13:Kn=!1;return;case 27:case 3:Kn=!0;return;default:Fs=Fs.return}}function Wl(s){if(s!==Fs)return!1;if(!jt)return nb(s),jt=!0,!1;var r=s.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||Bp(s.type,s.memoizedProps)),l=!l),l&&Zt&&Gr(s),nb(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Zt=Av(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Zt=Av(s)}else r===27?(r=Zt,ii(s.type)?(s=Hp,Hp=null,Zt=s):Zt=r):Zt=Fs?Jn(s.stateNode.nextSibling):null;return!0}function Ji(){Zt=Fs=null,jt=!1}function _m(){var s=Hr;return s!==null&&(fn===null?fn=s:fn.push.apply(fn,s),Hr=null),s}function bc(s){Hr===null?Hr=[s]:Hr.push(s)}var jm=B(null),Zi=null,lr=null;function Yr(s,r,l){le(jm,r._currentValue),r._currentValue=l}function or(s){s._currentValue=jm.current,J(jm)}function Sm(s,r,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),s===l)break;s=s.return}}function Em(s,r,l,u){var f=s.child;for(f!==null&&(f.return=s);f!==null;){var p=f.dependencies;if(p!==null){var v=f.child;p=p.firstContext;e:for(;p!==null;){var A=p;p=f;for(var q=0;q<r.length;q++)if(A.context===r[q]){p.lanes|=l,A=p.alternate,A!==null&&(A.lanes|=l),Sm(p.return,l,s),u||(v=null);break e}p=A.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(i(341));v.lanes|=l,p=v.alternate,p!==null&&(p.lanes|=l),Sm(v,l,s),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===s){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function Ql(s,r,l,u){s=null;for(var f=r,p=!1;f!==null;){if(!p){if((f.flags&524288)!==0)p=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(i(387));if(v=v.memoizedProps,v!==null){var A=f.type;kn(f.pendingProps.value,v.value)||(s!==null?s.push(A):s=[A])}}else if(f===Ge.current){if(v=f.alternate,v===null)throw Error(i(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(s!==null?s.push(Hc):s=[Hc])}f=f.return}s!==null&&Em(r,s,l,u),r.flags|=262144}function _d(s){for(s=s.firstContext;s!==null;){if(!kn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function el(s){Zi=s,lr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function $s(s){return ab(Zi,s)}function jd(s,r){return Zi===null&&el(s),ab(s,r)}function ab(s,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},lr===null){if(s===null)throw Error(i(308));lr=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else lr=lr.next=r;return l}var TS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){r.aborted=!0,s.forEach(function(l){return l()})}},AS=n.unstable_scheduleCallback,kS=n.unstable_NormalPriority,js={$$typeof:G,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tm(){return{controller:new TS,data:new Map,refCount:0}}function yc(s){s.refCount--,s.refCount===0&&AS(kS,function(){s.controller.abort()})}var vc=null,Am=0,Kl=0,Xl=null;function CS(s,r){if(vc===null){var l=vc=[];Am=0,Kl=Rp(),Xl={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Am++,r.then(rb,rb),r}function rb(){if(--Am===0&&vc!==null){Xl!==null&&(Xl.status="fulfilled");var s=vc;vc=null,Kl=0,Xl=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function RS(s,r){var l=[],u={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return s.then(function(){u.status="fulfilled",u.value=r;for(var f=0;f<l.length;f++)(0,l[f])(r)},function(f){for(u.status="rejected",u.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),u}var ib=O.S;O.S=function(s,r){$y=Ve(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&CS(s,r),ib!==null&&ib(s,r)};var tl=B(null);function km(){var s=tl.current;return s!==null?s:Yt.pooledCache}function Sd(s,r){r===null?le(tl,tl.current):le(tl,r.pool)}function lb(){var s=km();return s===null?null:{parent:js._currentValue,pool:s}}var Jl=Error(i(460)),Cm=Error(i(474)),Ed=Error(i(542)),Td={then:function(){}};function ob(s){return s=s.status,s==="fulfilled"||s==="rejected"}function cb(s,r,l){switch(l=s[l],l===void 0?s.push(r):l!==r&&(r.then(la,la),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,db(s),s;default:if(typeof r.status=="string")r.then(la,la);else{if(s=Yt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(u){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=u}},function(u){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,db(s),s}throw nl=r,Jl}}function sl(s){try{var r=s._init;return r(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(nl=l,Jl):l}}var nl=null;function ub(){if(nl===null)throw Error(i(459));var s=nl;return nl=null,s}function db(s){if(s===Jl||s===Ed)throw Error(i(483))}var Zl=null,wc=0;function Ad(s){var r=wc;return wc+=1,Zl===null&&(Zl=[]),cb(Zl,s,r)}function Nc(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function kd(s,r){throw r.$$typeof===j?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function hb(s){function r(X,Y){if(s){var se=X.deletions;se===null?(X.deletions=[Y],X.flags|=16):se.push(Y)}}function l(X,Y){if(!s)return null;for(;Y!==null;)r(X,Y),Y=Y.sibling;return null}function u(X){for(var Y=new Map;X!==null;)X.key!==null?Y.set(X.key,X):Y.set(X.index,X),X=X.sibling;return Y}function f(X,Y){return X=rr(X,Y),X.index=0,X.sibling=null,X}function p(X,Y,se){return X.index=se,s?(se=X.alternate,se!==null?(se=se.index,se<Y?(X.flags|=67108866,Y):se):(X.flags|=67108866,Y)):(X.flags|=1048576,Y)}function v(X){return s&&X.alternate===null&&(X.flags|=67108866),X}function A(X,Y,se,ge){return Y===null||Y.tag!==6?(Y=bm(se,X.mode,ge),Y.return=X,Y):(Y=f(Y,se),Y.return=X,Y)}function q(X,Y,se,ge){var Qe=se.type;return Qe===V?me(X,Y,se.props.children,ge,se.key):Y!==null&&(Y.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===E&&sl(Qe)===Y.type)?(Y=f(Y,se.props),Nc(Y,se),Y.return=X,Y):(Y=wd(se.type,se.key,se.props,null,X.mode,ge),Nc(Y,se),Y.return=X,Y)}function ne(X,Y,se,ge){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==se.containerInfo||Y.stateNode.implementation!==se.implementation?(Y=ym(se,X.mode,ge),Y.return=X,Y):(Y=f(Y,se.children||[]),Y.return=X,Y)}function me(X,Y,se,ge,Qe){return Y===null||Y.tag!==7?(Y=Xi(se,X.mode,ge,Qe),Y.return=X,Y):(Y=f(Y,se),Y.return=X,Y)}function ye(X,Y,se){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=bm(""+Y,X.mode,se),Y.return=X,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case R:return se=wd(Y.type,Y.key,Y.props,null,X.mode,se),Nc(se,Y),se.return=X,se;case U:return Y=ym(Y,X.mode,se),Y.return=X,Y;case E:return Y=sl(Y),ye(X,Y,se)}if(P(Y)||M(Y))return Y=Xi(Y,X.mode,se,null),Y.return=X,Y;if(typeof Y.then=="function")return ye(X,Ad(Y),se);if(Y.$$typeof===G)return ye(X,jd(X,Y),se);kd(X,Y)}return null}function re(X,Y,se,ge){var Qe=Y!==null?Y.key:null;if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return Qe!==null?null:A(X,Y,""+se,ge);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case R:return se.key===Qe?q(X,Y,se,ge):null;case U:return se.key===Qe?ne(X,Y,se,ge):null;case E:return se=sl(se),re(X,Y,se,ge)}if(P(se)||M(se))return Qe!==null?null:me(X,Y,se,ge,null);if(typeof se.then=="function")return re(X,Y,Ad(se),ge);if(se.$$typeof===G)return re(X,Y,jd(X,se),ge);kd(X,se)}return null}function ue(X,Y,se,ge,Qe){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return X=X.get(se)||null,A(Y,X,""+ge,Qe);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case R:return X=X.get(ge.key===null?se:ge.key)||null,q(Y,X,ge,Qe);case U:return X=X.get(ge.key===null?se:ge.key)||null,ne(Y,X,ge,Qe);case E:return ge=sl(ge),ue(X,Y,se,ge,Qe)}if(P(ge)||M(ge))return X=X.get(se)||null,me(Y,X,ge,Qe,null);if(typeof ge.then=="function")return ue(X,Y,se,Ad(ge),Qe);if(ge.$$typeof===G)return ue(X,Y,se,jd(Y,ge),Qe);kd(Y,ge)}return null}function Ue(X,Y,se,ge){for(var Qe=null,Ct=null,Fe=Y,ht=Y=0,bt=null;Fe!==null&&ht<se.length;ht++){Fe.index>ht?(bt=Fe,Fe=null):bt=Fe.sibling;var Rt=re(X,Fe,se[ht],ge);if(Rt===null){Fe===null&&(Fe=bt);break}s&&Fe&&Rt.alternate===null&&r(X,Fe),Y=p(Rt,Y,ht),Ct===null?Qe=Rt:Ct.sibling=Rt,Ct=Rt,Fe=bt}if(ht===se.length)return l(X,Fe),jt&&ir(X,ht),Qe;if(Fe===null){for(;ht<se.length;ht++)Fe=ye(X,se[ht],ge),Fe!==null&&(Y=p(Fe,Y,ht),Ct===null?Qe=Fe:Ct.sibling=Fe,Ct=Fe);return jt&&ir(X,ht),Qe}for(Fe=u(Fe);ht<se.length;ht++)bt=ue(Fe,X,ht,se[ht],ge),bt!==null&&(s&&bt.alternate!==null&&Fe.delete(bt.key===null?ht:bt.key),Y=p(bt,Y,ht),Ct===null?Qe=bt:Ct.sibling=bt,Ct=bt);return s&&Fe.forEach(function(di){return r(X,di)}),jt&&ir(X,ht),Qe}function et(X,Y,se,ge){if(se==null)throw Error(i(151));for(var Qe=null,Ct=null,Fe=Y,ht=Y=0,bt=null,Rt=se.next();Fe!==null&&!Rt.done;ht++,Rt=se.next()){Fe.index>ht?(bt=Fe,Fe=null):bt=Fe.sibling;var di=re(X,Fe,Rt.value,ge);if(di===null){Fe===null&&(Fe=bt);break}s&&Fe&&di.alternate===null&&r(X,Fe),Y=p(di,Y,ht),Ct===null?Qe=di:Ct.sibling=di,Ct=di,Fe=bt}if(Rt.done)return l(X,Fe),jt&&ir(X,ht),Qe;if(Fe===null){for(;!Rt.done;ht++,Rt=se.next())Rt=ye(X,Rt.value,ge),Rt!==null&&(Y=p(Rt,Y,ht),Ct===null?Qe=Rt:Ct.sibling=Rt,Ct=Rt);return jt&&ir(X,ht),Qe}for(Fe=u(Fe);!Rt.done;ht++,Rt=se.next())Rt=ue(Fe,X,ht,Rt.value,ge),Rt!==null&&(s&&Rt.alternate!==null&&Fe.delete(Rt.key===null?ht:Rt.key),Y=p(Rt,Y,ht),Ct===null?Qe=Rt:Ct.sibling=Rt,Ct=Rt);return s&&Fe.forEach(function(FE){return r(X,FE)}),jt&&ir(X,ht),Qe}function Ht(X,Y,se,ge){if(typeof se=="object"&&se!==null&&se.type===V&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case R:e:{for(var Qe=se.key;Y!==null;){if(Y.key===Qe){if(Qe=se.type,Qe===V){if(Y.tag===7){l(X,Y.sibling),ge=f(Y,se.props.children),ge.return=X,X=ge;break e}}else if(Y.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===E&&sl(Qe)===Y.type){l(X,Y.sibling),ge=f(Y,se.props),Nc(ge,se),ge.return=X,X=ge;break e}l(X,Y);break}else r(X,Y);Y=Y.sibling}se.type===V?(ge=Xi(se.props.children,X.mode,ge,se.key),ge.return=X,X=ge):(ge=wd(se.type,se.key,se.props,null,X.mode,ge),Nc(ge,se),ge.return=X,X=ge)}return v(X);case U:e:{for(Qe=se.key;Y!==null;){if(Y.key===Qe)if(Y.tag===4&&Y.stateNode.containerInfo===se.containerInfo&&Y.stateNode.implementation===se.implementation){l(X,Y.sibling),ge=f(Y,se.children||[]),ge.return=X,X=ge;break e}else{l(X,Y);break}else r(X,Y);Y=Y.sibling}ge=ym(se,X.mode,ge),ge.return=X,X=ge}return v(X);case E:return se=sl(se),Ht(X,Y,se,ge)}if(P(se))return Ue(X,Y,se,ge);if(M(se)){if(Qe=M(se),typeof Qe!="function")throw Error(i(150));return se=Qe.call(se),et(X,Y,se,ge)}if(typeof se.then=="function")return Ht(X,Y,Ad(se),ge);if(se.$$typeof===G)return Ht(X,Y,jd(X,se),ge);kd(X,se)}return typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint"?(se=""+se,Y!==null&&Y.tag===6?(l(X,Y.sibling),ge=f(Y,se),ge.return=X,X=ge):(l(X,Y),ge=bm(se,X.mode,ge),ge.return=X,X=ge),v(X)):l(X,Y)}return function(X,Y,se,ge){try{wc=0;var Qe=Ht(X,Y,se,ge);return Zl=null,Qe}catch(Fe){if(Fe===Jl||Fe===Ed)throw Fe;var Ct=Cn(29,Fe,null,X.mode);return Ct.lanes=ge,Ct.return=X,Ct}}}var al=hb(!0),fb=hb(!1),Wr=!1;function Rm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Im(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Qr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Kr(s,r,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(Mt&2)!==0){var f=u.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),u.pending=r,r=vd(s),Kg(s,null,l),r}return yd(s,u,r,l),vd(s)}function _c(s,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,Sn(s,l)}}function Dm(s,r){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var f=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var v={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};p===null?f=p=v:p=p.next=v,l=l.next}while(l!==null);p===null?f=p=r:p=p.next=r}else f=p=r;l={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=r:s.next=r,l.lastBaseUpdate=r}var Mm=!1;function jc(){if(Mm){var s=Xl;if(s!==null)throw s}}function Sc(s,r,l,u){Mm=!1;var f=s.updateQueue;Wr=!1;var p=f.firstBaseUpdate,v=f.lastBaseUpdate,A=f.shared.pending;if(A!==null){f.shared.pending=null;var q=A,ne=q.next;q.next=null,v===null?p=ne:v.next=ne,v=q;var me=s.alternate;me!==null&&(me=me.updateQueue,A=me.lastBaseUpdate,A!==v&&(A===null?me.firstBaseUpdate=ne:A.next=ne,me.lastBaseUpdate=q))}if(p!==null){var ye=f.baseState;v=0,me=ne=q=null,A=p;do{var re=A.lane&-536870913,ue=re!==A.lane;if(ue?(gt&re)===re:(u&re)===re){re!==0&&re===Kl&&(Mm=!0),me!==null&&(me=me.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var Ue=s,et=A;re=r;var Ht=l;switch(et.tag){case 1:if(Ue=et.payload,typeof Ue=="function"){ye=Ue.call(Ht,ye,re);break e}ye=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=et.payload,re=typeof Ue=="function"?Ue.call(Ht,ye,re):Ue,re==null)break e;ye=w({},ye,re);break e;case 2:Wr=!0}}re=A.callback,re!==null&&(s.flags|=64,ue&&(s.flags|=8192),ue=f.callbacks,ue===null?f.callbacks=[re]:ue.push(re))}else ue={lane:re,tag:A.tag,payload:A.payload,callback:A.callback,next:null},me===null?(ne=me=ue,q=ye):me=me.next=ue,v|=re;if(A=A.next,A===null){if(A=f.shared.pending,A===null)break;ue=A,A=ue.next,ue.next=null,f.lastBaseUpdate=ue,f.shared.pending=null}}while(!0);me===null&&(q=ye),f.baseState=q,f.firstBaseUpdate=ne,f.lastBaseUpdate=me,p===null&&(f.shared.lanes=0),ti|=v,s.lanes=v,s.memoizedState=ye}}function mb(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function pb(s,r){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)mb(l[s],r)}var eo=B(null),Cd=B(0);function xb(s,r){s=gr,le(Cd,s),le(eo,r),gr=s|r.baseLanes}function Om(){le(Cd,gr),le(eo,eo.current)}function Pm(){gr=Cd.current,J(eo),J(Cd)}var Rn=B(null),Xn=null;function Xr(s){var r=s.alternate;le(bs,bs.current&1),le(Rn,s),Xn===null&&(r===null||eo.current!==null||r.memoizedState!==null)&&(Xn=s)}function Vm(s){le(bs,bs.current),le(Rn,s),Xn===null&&(Xn=s)}function gb(s){s.tag===22?(le(bs,bs.current),le(Rn,s),Xn===null&&(Xn=s)):Jr()}function Jr(){le(bs,bs.current),le(Rn,Rn.current)}function In(s){J(Rn),Xn===s&&(Xn=null),J(bs)}var bs=B(0);function Rd(s){for(var r=s;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||$p(l)||qp(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var cr=0,dt=null,$t=null,Ss=null,Id=!1,to=!1,rl=!1,Dd=0,Ec=0,so=null,IS=0;function hs(){throw Error(i(321))}function Lm(s,r){if(r===null)return!1;for(var l=0;l<r.length&&l<s.length;l++)if(!kn(s[l],r[l]))return!1;return!0}function Um(s,r,l,u,f,p){return cr=p,dt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,O.H=s===null||s.memoizedState===null?ey:ep,rl=!1,p=l(u,f),rl=!1,to&&(p=yb(r,l,u,f)),bb(s),p}function bb(s){O.H=kc;var r=$t!==null&&$t.next!==null;if(cr=0,Ss=$t=dt=null,Id=!1,Ec=0,so=null,r)throw Error(i(300));s===null||Es||(s=s.dependencies,s!==null&&_d(s)&&(Es=!0))}function yb(s,r,l,u){dt=s;var f=0;do{if(to&&(so=null),Ec=0,to=!1,25<=f)throw Error(i(301));if(f+=1,Ss=$t=null,s.updateQueue!=null){var p=s.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}O.H=ty,p=r(l,u)}while(to);return p}function DS(){var s=O.H,r=s.useState()[0];return r=typeof r.then=="function"?Tc(r):r,s=s.useState()[0],($t!==null?$t.memoizedState:null)!==s&&(dt.flags|=1024),r}function Bm(){var s=Dd!==0;return Dd=0,s}function zm(s,r,l){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~l}function Fm(s){if(Id){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Id=!1}cr=0,Ss=$t=dt=null,to=!1,Ec=Dd=0,so=null}function an(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ss===null?dt.memoizedState=Ss=s:Ss=Ss.next=s,Ss}function ys(){if($t===null){var s=dt.alternate;s=s!==null?s.memoizedState:null}else s=$t.next;var r=Ss===null?dt.memoizedState:Ss.next;if(r!==null)Ss=r,$t=s;else{if(s===null)throw dt.alternate===null?Error(i(467)):Error(i(310));$t=s,s={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},Ss===null?dt.memoizedState=Ss=s:Ss=Ss.next=s}return Ss}function Md(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Tc(s){var r=Ec;return Ec+=1,so===null&&(so=[]),s=cb(so,s,r),r=dt,(Ss===null?r.memoizedState:Ss.next)===null&&(r=r.alternate,O.H=r===null||r.memoizedState===null?ey:ep),s}function Od(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Tc(s);if(s.$$typeof===G)return $s(s)}throw Error(i(438,String(s)))}function $m(s){var r=null,l=dt.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=dt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=Md(),dt.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(s),u=0;u<s;u++)l[u]=I;return r.index++,l}function ur(s,r){return typeof r=="function"?r(s):r}function Pd(s){var r=ys();return qm(r,$t,s)}function qm(s,r,l){var u=s.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var f=s.baseQueue,p=u.pending;if(p!==null){if(f!==null){var v=f.next;f.next=p.next,p.next=v}r.baseQueue=f=p,u.pending=null}if(p=s.baseState,f===null)s.memoizedState=p;else{r=f.next;var A=v=null,q=null,ne=r,me=!1;do{var ye=ne.lane&-536870913;if(ye!==ne.lane?(gt&ye)===ye:(cr&ye)===ye){var re=ne.revertLane;if(re===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),ye===Kl&&(me=!0);else if((cr&re)===re){ne=ne.next,re===Kl&&(me=!0);continue}else ye={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},q===null?(A=q=ye,v=p):q=q.next=ye,dt.lanes|=re,ti|=re;ye=ne.action,rl&&l(p,ye),p=ne.hasEagerState?ne.eagerState:l(p,ye)}else re={lane:ye,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},q===null?(A=q=re,v=p):q=q.next=re,dt.lanes|=ye,ti|=ye;ne=ne.next}while(ne!==null&&ne!==r);if(q===null?v=p:q.next=A,!kn(p,s.memoizedState)&&(Es=!0,me&&(l=Xl,l!==null)))throw l;s.memoizedState=p,s.baseState=v,s.baseQueue=q,u.lastRenderedState=p}return f===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function Hm(s){var r=ys(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var u=l.dispatch,f=l.pending,p=r.memoizedState;if(f!==null){l.pending=null;var v=f=f.next;do p=s(p,v.action),v=v.next;while(v!==f);kn(p,r.memoizedState)||(Es=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),l.lastRenderedState=p}return[p,u]}function vb(s,r,l){var u=dt,f=ys(),p=jt;if(p){if(l===void 0)throw Error(i(407));l=l()}else l=r();var v=!kn(($t||f).memoizedState,l);if(v&&(f.memoizedState=l,Es=!0),f=f.queue,Wm(_b.bind(null,u,f,s),[s]),f.getSnapshot!==r||v||Ss!==null&&Ss.memoizedState.tag&1){if(u.flags|=2048,no(9,{destroy:void 0},Nb.bind(null,u,f,l,r),null),Yt===null)throw Error(i(349));p||(cr&127)!==0||wb(u,r,l)}return l}function wb(s,r,l){s.flags|=16384,s={getSnapshot:r,value:l},r=dt.updateQueue,r===null?(r=Md(),dt.updateQueue=r,r.stores=[s]):(l=r.stores,l===null?r.stores=[s]:l.push(s))}function Nb(s,r,l,u){r.value=l,r.getSnapshot=u,jb(r)&&Sb(s)}function _b(s,r,l){return l(function(){jb(r)&&Sb(s)})}function jb(s){var r=s.getSnapshot;s=s.value;try{var l=r();return!kn(s,l)}catch{return!0}}function Sb(s){var r=Ki(s,2);r!==null&&mn(r,s,2)}function Gm(s){var r=an();if(typeof s=="function"){var l=s;if(s=l(),rl){ss(!0);try{l()}finally{ss(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ur,lastRenderedState:s},r}function Eb(s,r,l,u){return s.baseState=l,qm(s,$t,typeof u=="function"?u:ur)}function MS(s,r,l,u,f){if(Ud(s))throw Error(i(485));if(s=r.action,s!==null){var p={payload:f,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){p.listeners.push(v)}};O.T!==null?l(!0):p.isTransition=!1,u(p),l=r.pending,l===null?(p.next=r.pending=p,Tb(r,p)):(p.next=l.next,r.pending=l.next=p)}}function Tb(s,r){var l=r.action,u=r.payload,f=s.state;if(r.isTransition){var p=O.T,v={};O.T=v;try{var A=l(f,u),q=O.S;q!==null&&q(v,A),Ab(s,r,A)}catch(ne){Ym(s,r,ne)}finally{p!==null&&v.types!==null&&(p.types=v.types),O.T=p}}else try{p=l(f,u),Ab(s,r,p)}catch(ne){Ym(s,r,ne)}}function Ab(s,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){kb(s,r,u)},function(u){return Ym(s,r,u)}):kb(s,r,l)}function kb(s,r,l){r.status="fulfilled",r.value=l,Cb(r),s.state=l,r=s.pending,r!==null&&(l=r.next,l===r?s.pending=null:(l=l.next,r.next=l,Tb(s,l)))}function Ym(s,r,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,Cb(r),r=r.next;while(r!==u)}s.action=null}function Cb(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function Rb(s,r){return r}function Ib(s,r){if(jt){var l=Yt.formState;if(l!==null){e:{var u=dt;if(jt){if(Zt){t:{for(var f=Zt,p=Kn;f.nodeType!==8;){if(!p){f=null;break t}if(f=Jn(f.nextSibling),f===null){f=null;break t}}p=f.data,f=p==="F!"||p==="F"?f:null}if(f){Zt=Jn(f.nextSibling),u=f.data==="F!";break e}}Gr(u)}u=!1}u&&(r=l[0])}}return l=an(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rb,lastRenderedState:r},l.queue=u,l=Xb.bind(null,dt,u),u.dispatch=l,u=Gm(!1),p=Zm.bind(null,dt,!1,u.queue),u=an(),f={state:r,dispatch:null,action:s,pending:null},u.queue=f,l=MS.bind(null,dt,f,p,l),f.dispatch=l,u.memoizedState=s,[r,l,!1]}function Db(s){var r=ys();return Mb(r,$t,s)}function Mb(s,r,l){if(r=qm(s,r,Rb)[0],s=Pd(ur)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=Tc(r)}catch(v){throw v===Jl?Ed:v}else u=r;r=ys();var f=r.queue,p=f.dispatch;return l!==r.memoizedState&&(dt.flags|=2048,no(9,{destroy:void 0},OS.bind(null,f,l),null)),[u,p,s]}function OS(s,r){s.action=r}function Ob(s){var r=ys(),l=$t;if(l!==null)return Mb(r,l,s);ys(),r=r.memoizedState,l=ys();var u=l.queue.dispatch;return l.memoizedState=s,[r,u,!1]}function no(s,r,l,u){return s={tag:s,create:l,deps:u,inst:r,next:null},r=dt.updateQueue,r===null&&(r=Md(),dt.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,r.lastEffect=s),s}function Pb(){return ys().memoizedState}function Vd(s,r,l,u){var f=an();dt.flags|=s,f.memoizedState=no(1|r,{destroy:void 0},l,u===void 0?null:u)}function Ld(s,r,l,u){var f=ys();u=u===void 0?null:u;var p=f.memoizedState.inst;$t!==null&&u!==null&&Lm(u,$t.memoizedState.deps)?f.memoizedState=no(r,p,l,u):(dt.flags|=s,f.memoizedState=no(1|r,p,l,u))}function Vb(s,r){Vd(8390656,8,s,r)}function Wm(s,r){Ld(2048,8,s,r)}function PS(s){dt.flags|=4;var r=dt.updateQueue;if(r===null)r=Md(),dt.updateQueue=r,r.events=[s];else{var l=r.events;l===null?r.events=[s]:l.push(s)}}function Lb(s){var r=ys().memoizedState;return PS({ref:r,nextImpl:s}),function(){if((Mt&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Ub(s,r){return Ld(4,2,s,r)}function Bb(s,r){return Ld(4,4,s,r)}function zb(s,r){if(typeof r=="function"){s=s();var l=r(s);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Fb(s,r,l){l=l!=null?l.concat([s]):null,Ld(4,4,zb.bind(null,r,s),l)}function Qm(){}function $b(s,r){var l=ys();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&Lm(r,u[1])?u[0]:(l.memoizedState=[s,r],s)}function qb(s,r){var l=ys();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&Lm(r,u[1]))return u[0];if(u=s(),rl){ss(!0);try{s()}finally{ss(!1)}}return l.memoizedState=[u,r],u}function Km(s,r,l){return l===void 0||(cr&1073741824)!==0&&(gt&261930)===0?s.memoizedState=r:(s.memoizedState=l,s=Hy(),dt.lanes|=s,ti|=s,l)}function Hb(s,r,l,u){return kn(l,r)?l:eo.current!==null?(s=Km(s,l,u),kn(s,r)||(Es=!0),s):(cr&42)===0||(cr&1073741824)!==0&&(gt&261930)===0?(Es=!0,s.memoizedState=l):(s=Hy(),dt.lanes|=s,ti|=s,r)}function Gb(s,r,l,u,f){var p=K.p;K.p=p!==0&&8>p?p:8;var v=O.T,A={};O.T=A,Zm(s,!1,r,l);try{var q=f(),ne=O.S;if(ne!==null&&ne(A,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var me=RS(q,u);Ac(s,r,me,On(s))}else Ac(s,r,u,On(s))}catch(ye){Ac(s,r,{then:function(){},status:"rejected",reason:ye},On())}finally{K.p=p,v!==null&&A.types!==null&&(v.types=A.types),O.T=v}}function VS(){}function Xm(s,r,l,u){if(s.tag!==5)throw Error(i(476));var f=Yb(s).queue;Gb(s,f,r,ce,l===null?VS:function(){return Wb(s),l(u)})}function Yb(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ur,lastRenderedState:ce},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ur,lastRenderedState:l},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function Wb(s){var r=Yb(s);r.next===null&&(r=s.alternate.memoizedState),Ac(s,r.next.queue,{},On())}function Jm(){return $s(Hc)}function Qb(){return ys().memoizedState}function Kb(){return ys().memoizedState}function LS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var l=On();s=Qr(l);var u=Kr(r,s,l);u!==null&&(mn(u,r,l),_c(u,r,l)),r={cache:Tm()},s.payload=r;return}r=r.return}}function US(s,r,l){var u=On();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Ud(s)?Jb(r,l):(l=xm(s,r,l,u),l!==null&&(mn(l,s,u),Zb(l,r,u)))}function Xb(s,r,l){var u=On();Ac(s,r,l,u)}function Ac(s,r,l,u){var f={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Ud(s))Jb(r,f);else{var p=s.alternate;if(s.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var v=r.lastRenderedState,A=p(v,l);if(f.hasEagerState=!0,f.eagerState=A,kn(A,v))return yd(s,r,f,0),Yt===null&&bd(),!1}catch{}if(l=xm(s,r,f,u),l!==null)return mn(l,s,u),Zb(l,r,u),!0}return!1}function Zm(s,r,l,u){if(u={lane:2,revertLane:Rp(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Ud(s)){if(r)throw Error(i(479))}else r=xm(s,l,u,2),r!==null&&mn(r,s,2)}function Ud(s){var r=s.alternate;return s===dt||r!==null&&r===dt}function Jb(s,r){to=Id=!0;var l=s.pending;l===null?r.next=r:(r.next=l.next,l.next=r),s.pending=r}function Zb(s,r,l){if((l&4194048)!==0){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,Sn(s,l)}}var kc={readContext:$s,use:Od,useCallback:hs,useContext:hs,useEffect:hs,useImperativeHandle:hs,useLayoutEffect:hs,useInsertionEffect:hs,useMemo:hs,useReducer:hs,useRef:hs,useState:hs,useDebugValue:hs,useDeferredValue:hs,useTransition:hs,useSyncExternalStore:hs,useId:hs,useHostTransitionStatus:hs,useFormState:hs,useActionState:hs,useOptimistic:hs,useMemoCache:hs,useCacheRefresh:hs};kc.useEffectEvent=hs;var ey={readContext:$s,use:Od,useCallback:function(s,r){return an().memoizedState=[s,r===void 0?null:r],s},useContext:$s,useEffect:Vb,useImperativeHandle:function(s,r,l){l=l!=null?l.concat([s]):null,Vd(4194308,4,zb.bind(null,r,s),l)},useLayoutEffect:function(s,r){return Vd(4194308,4,s,r)},useInsertionEffect:function(s,r){Vd(4,2,s,r)},useMemo:function(s,r){var l=an();r=r===void 0?null:r;var u=s();if(rl){ss(!0);try{s()}finally{ss(!1)}}return l.memoizedState=[u,r],u},useReducer:function(s,r,l){var u=an();if(l!==void 0){var f=l(r);if(rl){ss(!0);try{l(r)}finally{ss(!1)}}}else f=r;return u.memoizedState=u.baseState=f,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:f},u.queue=s,s=s.dispatch=US.bind(null,dt,s),[u.memoizedState,s]},useRef:function(s){var r=an();return s={current:s},r.memoizedState=s},useState:function(s){s=Gm(s);var r=s.queue,l=Xb.bind(null,dt,r);return r.dispatch=l,[s.memoizedState,l]},useDebugValue:Qm,useDeferredValue:function(s,r){var l=an();return Km(l,s,r)},useTransition:function(){var s=Gm(!1);return s=Gb.bind(null,dt,s.queue,!0,!1),an().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,l){var u=dt,f=an();if(jt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),Yt===null)throw Error(i(349));(gt&127)!==0||wb(u,r,l)}f.memoizedState=l;var p={value:l,getSnapshot:r};return f.queue=p,Vb(_b.bind(null,u,p,s),[s]),u.flags|=2048,no(9,{destroy:void 0},Nb.bind(null,u,p,l,r),null),l},useId:function(){var s=an(),r=Yt.identifierPrefix;if(jt){var l=Ba,u=Ua;l=(u&~(1<<32-It(u)-1)).toString(32)+l,r="_"+r+"R_"+l,l=Dd++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=IS++,r="_"+r+"r_"+l.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:Jm,useFormState:Ib,useActionState:Ib,useOptimistic:function(s){var r=an();r.memoizedState=r.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=Zm.bind(null,dt,!0,l),l.dispatch=r,[s,r]},useMemoCache:$m,useCacheRefresh:function(){return an().memoizedState=LS.bind(null,dt)},useEffectEvent:function(s){var r=an(),l={impl:s};return r.memoizedState=l,function(){if((Mt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},ep={readContext:$s,use:Od,useCallback:$b,useContext:$s,useEffect:Wm,useImperativeHandle:Fb,useInsertionEffect:Ub,useLayoutEffect:Bb,useMemo:qb,useReducer:Pd,useRef:Pb,useState:function(){return Pd(ur)},useDebugValue:Qm,useDeferredValue:function(s,r){var l=ys();return Hb(l,$t.memoizedState,s,r)},useTransition:function(){var s=Pd(ur)[0],r=ys().memoizedState;return[typeof s=="boolean"?s:Tc(s),r]},useSyncExternalStore:vb,useId:Qb,useHostTransitionStatus:Jm,useFormState:Db,useActionState:Db,useOptimistic:function(s,r){var l=ys();return Eb(l,$t,s,r)},useMemoCache:$m,useCacheRefresh:Kb};ep.useEffectEvent=Lb;var ty={readContext:$s,use:Od,useCallback:$b,useContext:$s,useEffect:Wm,useImperativeHandle:Fb,useInsertionEffect:Ub,useLayoutEffect:Bb,useMemo:qb,useReducer:Hm,useRef:Pb,useState:function(){return Hm(ur)},useDebugValue:Qm,useDeferredValue:function(s,r){var l=ys();return $t===null?Km(l,s,r):Hb(l,$t.memoizedState,s,r)},useTransition:function(){var s=Hm(ur)[0],r=ys().memoizedState;return[typeof s=="boolean"?s:Tc(s),r]},useSyncExternalStore:vb,useId:Qb,useHostTransitionStatus:Jm,useFormState:Ob,useActionState:Ob,useOptimistic:function(s,r){var l=ys();return $t!==null?Eb(l,$t,s,r):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:$m,useCacheRefresh:Kb};ty.useEffectEvent=Lb;function tp(s,r,l,u){r=s.memoizedState,l=l(u,r),l=l==null?r:w({},r,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var sp={enqueueSetState:function(s,r,l){s=s._reactInternals;var u=On(),f=Qr(u);f.payload=r,l!=null&&(f.callback=l),r=Kr(s,f,u),r!==null&&(mn(r,s,u),_c(r,s,u))},enqueueReplaceState:function(s,r,l){s=s._reactInternals;var u=On(),f=Qr(u);f.tag=1,f.payload=r,l!=null&&(f.callback=l),r=Kr(s,f,u),r!==null&&(mn(r,s,u),_c(r,s,u))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var l=On(),u=Qr(l);u.tag=2,r!=null&&(u.callback=r),r=Kr(s,u,l),r!==null&&(mn(r,s,l),_c(r,s,l))}};function sy(s,r,l,u,f,p,v){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,p,v):r.prototype&&r.prototype.isPureReactComponent?!pc(l,u)||!pc(f,p):!0}function ny(s,r,l,u){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==s&&sp.enqueueReplaceState(r,r.state,null)}function il(s,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(s=s.defaultProps){l===r&&(l=w({},l));for(var f in s)l[f]===void 0&&(l[f]=s[f])}return l}function ay(s){gd(s)}function ry(s){console.error(s)}function iy(s){gd(s)}function Bd(s,r){try{var l=s.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function ly(s,r,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function np(s,r,l){return l=Qr(l),l.tag=3,l.payload={element:null},l.callback=function(){Bd(s,r)},l}function oy(s){return s=Qr(s),s.tag=3,s}function cy(s,r,l,u){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var p=u.value;s.payload=function(){return f(p)},s.callback=function(){ly(r,l,u)}}var v=l.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){ly(r,l,u),typeof f!="function"&&(si===null?si=new Set([this]):si.add(this));var A=u.stack;this.componentDidCatch(u.value,{componentStack:A!==null?A:""})})}function BS(s,r,l,u,f){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&Ql(r,l,f,!0),l=Rn.current,l!==null){switch(l.tag){case 31:case 13:return Xn===null?Jd():l.alternate===null&&fs===0&&(fs=3),l.flags&=-257,l.flags|=65536,l.lanes=f,u===Td?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),Ap(s,u,f)),!1;case 22:return l.flags|=65536,u===Td?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),Ap(s,u,f)),!1}throw Error(i(435,l.tag))}return Ap(s,u,f),Jd(),!1}if(jt)return r=Rn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,u!==Nm&&(s=Error(i(422),{cause:u}),bc(Yn(s,l)))):(u!==Nm&&(r=Error(i(423),{cause:u}),bc(Yn(r,l))),s=s.current.alternate,s.flags|=65536,f&=-f,s.lanes|=f,u=Yn(u,l),f=np(s.stateNode,u,f),Dm(s,f),fs!==4&&(fs=2)),!1;var p=Error(i(520),{cause:u});if(p=Yn(p,l),Vc===null?Vc=[p]:Vc.push(p),fs!==4&&(fs=2),r===null)return!0;u=Yn(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,s=f&-f,l.lanes|=s,s=np(l.stateNode,u,s),Dm(l,s),!1;case 1:if(r=l.type,p=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(si===null||!si.has(p))))return l.flags|=65536,f&=-f,l.lanes|=f,f=oy(f),cy(f,s,l,u),Dm(l,f),!1}l=l.return}while(l!==null);return!1}var ap=Error(i(461)),Es=!1;function qs(s,r,l,u){r.child=s===null?fb(r,null,l,u):al(r,s.child,l,u)}function uy(s,r,l,u,f){l=l.render;var p=r.ref;if("ref"in u){var v={};for(var A in u)A!=="ref"&&(v[A]=u[A])}else v=u;return el(r),u=Um(s,r,l,v,p,f),A=Bm(),s!==null&&!Es?(zm(s,r,f),dr(s,r,f)):(jt&&A&&vm(r),r.flags|=1,qs(s,r,u,f),r.child)}function dy(s,r,l,u,f){if(s===null){var p=l.type;return typeof p=="function"&&!gm(p)&&p.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=p,hy(s,r,p,u,f)):(s=wd(l.type,null,u,r,r.mode,f),s.ref=r.ref,s.return=r,r.child=s)}if(p=s.child,!hp(s,f)){var v=p.memoizedProps;if(l=l.compare,l=l!==null?l:pc,l(v,u)&&s.ref===r.ref)return dr(s,r,f)}return r.flags|=1,s=rr(p,u),s.ref=r.ref,s.return=r,r.child=s}function hy(s,r,l,u,f){if(s!==null){var p=s.memoizedProps;if(pc(p,u)&&s.ref===r.ref)if(Es=!1,r.pendingProps=u=p,hp(s,f))(s.flags&131072)!==0&&(Es=!0);else return r.lanes=s.lanes,dr(s,r,f)}return rp(s,r,l,u,f)}function fy(s,r,l,u){var f=u.children,p=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((r.flags&128)!==0){if(p=p!==null?p.baseLanes|l:l,s!==null){for(u=r.child=s.child,f=0;u!==null;)f=f|u.lanes|u.childLanes,u=u.sibling;u=f&~p}else u=0,r.child=null;return my(s,r,p,l,u)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&Sd(r,p!==null?p.cachePool:null),p!==null?xb(r,p):Om(),gb(r);else return u=r.lanes=536870912,my(s,r,p!==null?p.baseLanes|l:l,l,u)}else p!==null?(Sd(r,p.cachePool),xb(r,p),Jr(),r.memoizedState=null):(s!==null&&Sd(r,null),Om(),Jr());return qs(s,r,f,l),r.child}function Cc(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function my(s,r,l,u,f){var p=km();return p=p===null?null:{parent:js._currentValue,pool:p},r.memoizedState={baseLanes:l,cachePool:p},s!==null&&Sd(r,null),Om(),gb(r),s!==null&&Ql(s,r,u,!0),r.childLanes=f,null}function zd(s,r){return r=$d({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function py(s,r,l){return al(r,s.child,null,l),s=zd(r,r.pendingProps),s.flags|=2,In(r),r.memoizedState=null,s}function zS(s,r,l){var u=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(jt){if(u.mode==="hidden")return s=zd(r,u),r.lanes=536870912,Cc(null,s);if(Vm(r),(s=Zt)?(s=Tv(s,Kn),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:qr!==null?{id:Ua,overflow:Ba}:null,retryLane:536870912,hydrationErrors:null},l=Jg(s),l.return=r,r.child=l,Fs=r,Zt=null)):s=null,s===null)throw Gr(r);return r.lanes=536870912,null}return zd(r,u)}var p=s.memoizedState;if(p!==null){var v=p.dehydrated;if(Vm(r),f)if(r.flags&256)r.flags&=-257,r=py(s,r,l);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(Es||Ql(s,r,l,!1),f=(l&s.childLanes)!==0,Es||f){if(u=Yt,u!==null&&(v=zn(u,l),v!==0&&v!==p.retryLane))throw p.retryLane=v,Ki(s,v),mn(u,s,v),ap;Jd(),r=py(s,r,l)}else s=p.treeContext,Zt=Jn(v.nextSibling),Fs=r,jt=!0,Hr=null,Kn=!1,s!==null&&tb(r,s),r=zd(r,u),r.flags|=4096;return r}return s=rr(s.child,{mode:u.mode,children:u.children}),s.ref=r.ref,r.child=s,s.return=r,s}function Fd(s,r){var l=r.ref;if(l===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(r.flags|=4194816)}}function rp(s,r,l,u,f){return el(r),l=Um(s,r,l,u,void 0,f),u=Bm(),s!==null&&!Es?(zm(s,r,f),dr(s,r,f)):(jt&&u&&vm(r),r.flags|=1,qs(s,r,l,f),r.child)}function xy(s,r,l,u,f,p){return el(r),r.updateQueue=null,l=yb(r,u,l,f),bb(s),u=Bm(),s!==null&&!Es?(zm(s,r,p),dr(s,r,p)):(jt&&u&&vm(r),r.flags|=1,qs(s,r,l,p),r.child)}function gy(s,r,l,u,f){if(el(r),r.stateNode===null){var p=Hl,v=l.contextType;typeof v=="object"&&v!==null&&(p=$s(v)),p=new l(u,p),r.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=sp,r.stateNode=p,p._reactInternals=r,p=r.stateNode,p.props=u,p.state=r.memoizedState,p.refs={},Rm(r),v=l.contextType,p.context=typeof v=="object"&&v!==null?$s(v):Hl,p.state=r.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(tp(r,l,v,u),p.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(v=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),v!==p.state&&sp.enqueueReplaceState(p,p.state,null),Sc(r,u,p,f),jc(),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(s===null){p=r.stateNode;var A=r.memoizedProps,q=il(l,A);p.props=q;var ne=p.context,me=l.contextType;v=Hl,typeof me=="object"&&me!==null&&(v=$s(me));var ye=l.getDerivedStateFromProps;me=typeof ye=="function"||typeof p.getSnapshotBeforeUpdate=="function",A=r.pendingProps!==A,me||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(A||ne!==v)&&ny(r,p,u,v),Wr=!1;var re=r.memoizedState;p.state=re,Sc(r,u,p,f),jc(),ne=r.memoizedState,A||re!==ne||Wr?(typeof ye=="function"&&(tp(r,l,ye,u),ne=r.memoizedState),(q=Wr||sy(r,l,q,u,re,ne,v))?(me||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(r.flags|=4194308)):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=ne),p.props=u,p.state=ne,p.context=v,u=q):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{p=r.stateNode,Im(s,r),v=r.memoizedProps,me=il(l,v),p.props=me,ye=r.pendingProps,re=p.context,ne=l.contextType,q=Hl,typeof ne=="object"&&ne!==null&&(q=$s(ne)),A=l.getDerivedStateFromProps,(ne=typeof A=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(v!==ye||re!==q)&&ny(r,p,u,q),Wr=!1,re=r.memoizedState,p.state=re,Sc(r,u,p,f),jc();var ue=r.memoizedState;v!==ye||re!==ue||Wr||s!==null&&s.dependencies!==null&&_d(s.dependencies)?(typeof A=="function"&&(tp(r,l,A,u),ue=r.memoizedState),(me=Wr||sy(r,l,me,u,re,ue,q)||s!==null&&s.dependencies!==null&&_d(s.dependencies))?(ne||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,ue,q),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,ue,q)),typeof p.componentDidUpdate=="function"&&(r.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof p.componentDidUpdate!="function"||v===s.memoizedProps&&re===s.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&re===s.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=ue),p.props=u,p.state=ue,p.context=q,u=me):(typeof p.componentDidUpdate!="function"||v===s.memoizedProps&&re===s.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&re===s.memoizedState||(r.flags|=1024),u=!1)}return p=u,Fd(s,r),u=(r.flags&128)!==0,p||u?(p=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:p.render(),r.flags|=1,s!==null&&u?(r.child=al(r,s.child,null,f),r.child=al(r,null,l,f)):qs(s,r,l,f),r.memoizedState=p.state,s=r.child):s=dr(s,r,f),s}function by(s,r,l,u){return Ji(),r.flags|=256,qs(s,r,l,u),r.child}var ip={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function lp(s){return{baseLanes:s,cachePool:lb()}}function op(s,r,l){return s=s!==null?s.childLanes&~l:0,r&&(s|=Mn),s}function yy(s,r,l){var u=r.pendingProps,f=!1,p=(r.flags&128)!==0,v;if((v=p)||(v=s!==null&&s.memoizedState===null?!1:(bs.current&2)!==0),v&&(f=!0,r.flags&=-129),v=(r.flags&32)!==0,r.flags&=-33,s===null){if(jt){if(f?Xr(r):Jr(),(s=Zt)?(s=Tv(s,Kn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:qr!==null?{id:Ua,overflow:Ba}:null,retryLane:536870912,hydrationErrors:null},l=Jg(s),l.return=r,r.child=l,Fs=r,Zt=null)):s=null,s===null)throw Gr(r);return qp(s)?r.lanes=32:r.lanes=536870912,null}var A=u.children;return u=u.fallback,f?(Jr(),f=r.mode,A=$d({mode:"hidden",children:A},f),u=Xi(u,f,l,null),A.return=r,u.return=r,A.sibling=u,r.child=A,u=r.child,u.memoizedState=lp(l),u.childLanes=op(s,v,l),r.memoizedState=ip,Cc(null,u)):(Xr(r),cp(r,A))}var q=s.memoizedState;if(q!==null&&(A=q.dehydrated,A!==null)){if(p)r.flags&256?(Xr(r),r.flags&=-257,r=up(s,r,l)):r.memoizedState!==null?(Jr(),r.child=s.child,r.flags|=128,r=null):(Jr(),A=u.fallback,f=r.mode,u=$d({mode:"visible",children:u.children},f),A=Xi(A,f,l,null),A.flags|=2,u.return=r,A.return=r,u.sibling=A,r.child=u,al(r,s.child,null,l),u=r.child,u.memoizedState=lp(l),u.childLanes=op(s,v,l),r.memoizedState=ip,r=Cc(null,u));else if(Xr(r),qp(A)){if(v=A.nextSibling&&A.nextSibling.dataset,v)var ne=v.dgst;v=ne,u=Error(i(419)),u.stack="",u.digest=v,bc({value:u,source:null,stack:null}),r=up(s,r,l)}else if(Es||Ql(s,r,l,!1),v=(l&s.childLanes)!==0,Es||v){if(v=Yt,v!==null&&(u=zn(v,l),u!==0&&u!==q.retryLane))throw q.retryLane=u,Ki(s,u),mn(v,s,u),ap;$p(A)||Jd(),r=up(s,r,l)}else $p(A)?(r.flags|=192,r.child=s.child,r=null):(s=q.treeContext,Zt=Jn(A.nextSibling),Fs=r,jt=!0,Hr=null,Kn=!1,s!==null&&tb(r,s),r=cp(r,u.children),r.flags|=4096);return r}return f?(Jr(),A=u.fallback,f=r.mode,q=s.child,ne=q.sibling,u=rr(q,{mode:"hidden",children:u.children}),u.subtreeFlags=q.subtreeFlags&65011712,ne!==null?A=rr(ne,A):(A=Xi(A,f,l,null),A.flags|=2),A.return=r,u.return=r,u.sibling=A,r.child=u,Cc(null,u),u=r.child,A=s.child.memoizedState,A===null?A=lp(l):(f=A.cachePool,f!==null?(q=js._currentValue,f=f.parent!==q?{parent:q,pool:q}:f):f=lb(),A={baseLanes:A.baseLanes|l,cachePool:f}),u.memoizedState=A,u.childLanes=op(s,v,l),r.memoizedState=ip,Cc(s.child,u)):(Xr(r),l=s.child,s=l.sibling,l=rr(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,s!==null&&(v=r.deletions,v===null?(r.deletions=[s],r.flags|=16):v.push(s)),r.child=l,r.memoizedState=null,l)}function cp(s,r){return r=$d({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function $d(s,r){return s=Cn(22,s,null,r),s.lanes=0,s}function up(s,r,l){return al(r,s.child,null,l),s=cp(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function vy(s,r,l){s.lanes|=r;var u=s.alternate;u!==null&&(u.lanes|=r),Sm(s.return,r,l)}function dp(s,r,l,u,f,p){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:f,treeForkCount:p}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=l,v.tailMode=f,v.treeForkCount=p)}function wy(s,r,l){var u=r.pendingProps,f=u.revealOrder,p=u.tail;u=u.children;var v=bs.current,A=(v&2)!==0;if(A?(v=v&1|2,r.flags|=128):v&=1,le(bs,v),qs(s,r,u,l),u=jt?gc:0,!A&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&vy(s,l,r);else if(s.tag===19)vy(s,l,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(f){case"forwards":for(l=r.child,f=null;l!==null;)s=l.alternate,s!==null&&Rd(s)===null&&(f=l),l=l.sibling;l=f,l===null?(f=r.child,r.child=null):(f=l.sibling,l.sibling=null),dp(r,!1,f,l,p,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,f=r.child,r.child=null;f!==null;){if(s=f.alternate,s!==null&&Rd(s)===null){r.child=f;break}s=f.sibling,f.sibling=l,l=f,f=s}dp(r,!0,l,null,p,u);break;case"together":dp(r,!1,null,null,void 0,u);break;default:r.memoizedState=null}return r.child}function dr(s,r,l){if(s!==null&&(r.dependencies=s.dependencies),ti|=r.lanes,(l&r.childLanes)===0)if(s!==null){if(Ql(s,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,l=rr(s,s.pendingProps),r.child=l,l.return=r;s.sibling!==null;)s=s.sibling,l=l.sibling=rr(s,s.pendingProps),l.return=r;l.sibling=null}return r.child}function hp(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&_d(s)))}function FS(s,r,l){switch(r.tag){case 3:xt(r,r.stateNode.containerInfo),Yr(r,js,s.memoizedState.cache),Ji();break;case 27:case 5:Gt(r);break;case 4:xt(r,r.stateNode.containerInfo);break;case 10:Yr(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Vm(r),null;break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(Xr(r),r.flags|=128,null):(l&r.child.childLanes)!==0?yy(s,r,l):(Xr(r),s=dr(s,r,l),s!==null?s.sibling:null);Xr(r);break;case 19:var f=(s.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||(Ql(s,r,l,!1),u=(l&r.childLanes)!==0),f){if(u)return wy(s,r,l);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),le(bs,bs.current),u)break;return null;case 22:return r.lanes=0,fy(s,r,l,r.pendingProps);case 24:Yr(r,js,s.memoizedState.cache)}return dr(s,r,l)}function Ny(s,r,l){if(s!==null)if(s.memoizedProps!==r.pendingProps)Es=!0;else{if(!hp(s,l)&&(r.flags&128)===0)return Es=!1,FS(s,r,l);Es=(s.flags&131072)!==0}else Es=!1,jt&&(r.flags&1048576)!==0&&eb(r,gc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var u=r.pendingProps;if(s=sl(r.elementType),r.type=s,typeof s=="function")gm(s)?(u=il(s,u),r.tag=1,r=gy(null,r,s,u,l)):(r.tag=0,r=rp(null,r,s,u,l));else{if(s!=null){var f=s.$$typeof;if(f===ie){r.tag=11,r=uy(null,r,s,u,l);break e}else if(f===T){r.tag=14,r=dy(null,r,s,u,l);break e}}throw r=F(s)||s,Error(i(306,r,""))}}return r;case 0:return rp(s,r,r.type,r.pendingProps,l);case 1:return u=r.type,f=il(u,r.pendingProps),gy(s,r,u,f,l);case 3:e:{if(xt(r,r.stateNode.containerInfo),s===null)throw Error(i(387));u=r.pendingProps;var p=r.memoizedState;f=p.element,Im(s,r),Sc(r,u,null,l);var v=r.memoizedState;if(u=v.cache,Yr(r,js,u),u!==p.cache&&Em(r,[js],l,!0),jc(),u=v.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:v.cache},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){r=by(s,r,u,l);break e}else if(u!==f){f=Yn(Error(i(424)),r),bc(f),r=by(s,r,u,l);break e}else for(s=r.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,Zt=Jn(s.firstChild),Fs=r,jt=!0,Hr=null,Kn=!0,l=fb(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Ji(),u===f){r=dr(s,r,l);break e}qs(s,r,u,l)}r=r.child}return r;case 26:return Fd(s,r),s===null?(l=Dv(r.type,null,r.pendingProps,null))?r.memoizedState=l:jt||(l=r.type,s=r.pendingProps,u=rh(Me.current).createElement(l),u[is]=r,u[ws]=s,Hs(u,l,s),Ns(u),r.stateNode=u):r.memoizedState=Dv(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Gt(r),s===null&&jt&&(u=r.stateNode=Cv(r.type,r.pendingProps,Me.current),Fs=r,Kn=!0,f=Zt,ii(r.type)?(Hp=f,Zt=Jn(u.firstChild)):Zt=f),qs(s,r,r.pendingProps.children,l),Fd(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&jt&&((f=u=Zt)&&(u=bE(u,r.type,r.pendingProps,Kn),u!==null?(r.stateNode=u,Fs=r,Zt=Jn(u.firstChild),Kn=!1,f=!0):f=!1),f||Gr(r)),Gt(r),f=r.type,p=r.pendingProps,v=s!==null?s.memoizedProps:null,u=p.children,Bp(f,p)?u=null:v!==null&&Bp(f,v)&&(r.flags|=32),r.memoizedState!==null&&(f=Um(s,r,DS,null,null,l),Hc._currentValue=f),Fd(s,r),qs(s,r,u,l),r.child;case 6:return s===null&&jt&&((s=l=Zt)&&(l=yE(l,r.pendingProps,Kn),l!==null?(r.stateNode=l,Fs=r,Zt=null,s=!0):s=!1),s||Gr(r)),null;case 13:return yy(s,r,l);case 4:return xt(r,r.stateNode.containerInfo),u=r.pendingProps,s===null?r.child=al(r,null,u,l):qs(s,r,u,l),r.child;case 11:return uy(s,r,r.type,r.pendingProps,l);case 7:return qs(s,r,r.pendingProps,l),r.child;case 8:return qs(s,r,r.pendingProps.children,l),r.child;case 12:return qs(s,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,Yr(r,r.type,u.value),qs(s,r,u.children,l),r.child;case 9:return f=r.type._context,u=r.pendingProps.children,el(r),f=$s(f),u=u(f),r.flags|=1,qs(s,r,u,l),r.child;case 14:return dy(s,r,r.type,r.pendingProps,l);case 15:return hy(s,r,r.type,r.pendingProps,l);case 19:return wy(s,r,l);case 31:return zS(s,r,l);case 22:return fy(s,r,l,r.pendingProps);case 24:return el(r),u=$s(js),s===null?(f=km(),f===null&&(f=Yt,p=Tm(),f.pooledCache=p,p.refCount++,p!==null&&(f.pooledCacheLanes|=l),f=p),r.memoizedState={parent:u,cache:f},Rm(r),Yr(r,js,f)):((s.lanes&l)!==0&&(Im(s,r),Sc(r,null,null,l),jc()),f=s.memoizedState,p=r.memoizedState,f.parent!==u?(f={parent:u,cache:u},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),Yr(r,js,u)):(u=p.cache,Yr(r,js,u),u!==f.cache&&Em(r,[js],l,!0))),qs(s,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function hr(s){s.flags|=4}function fp(s,r,l,u,f){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(f&335544128)===f)if(s.stateNode.complete)s.flags|=8192;else if(Qy())s.flags|=8192;else throw nl=Td,Cm}else s.flags&=-16777217}function _y(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Lv(r))if(Qy())s.flags|=8192;else throw nl=Td,Cm}function qd(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?je():536870912,s.lanes|=r,lo|=r)}function Rc(s,r){if(!jt)switch(s.tailMode){case"hidden":r=s.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function es(s){var r=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(r)for(var f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=s,f=f.sibling;else for(f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=s,f=f.sibling;return s.subtreeFlags|=u,s.childLanes=l,r}function $S(s,r,l){var u=r.pendingProps;switch(wm(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return es(r),null;case 1:return es(r),null;case 3:return l=r.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),or(js),it(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Wl(r)?hr(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,_m())),es(r),null;case 26:var f=r.type,p=r.memoizedState;return s===null?(hr(r),p!==null?(es(r),_y(r,p)):(es(r),fp(r,f,null,u,l))):p?p!==s.memoizedState?(hr(r),es(r),_y(r,p)):(es(r),r.flags&=-16777217):(s=s.memoizedProps,s!==u&&hr(r),es(r),fp(r,f,s,u,l)),null;case 27:if(ae(r),l=Me.current,f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&hr(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return es(r),null}s=pe.current,Wl(r)?sb(r):(s=Cv(f,u,l),r.stateNode=s,hr(r))}return es(r),null;case 5:if(ae(r),f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&hr(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return es(r),null}if(p=pe.current,Wl(r))sb(r);else{var v=rh(Me.current);switch(p){case 1:p=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:p=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":p=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":p=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":p=v.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof u.is=="string"?v.createElement("select",{is:u.is}):v.createElement("select"),u.multiple?p.multiple=!0:u.size&&(p.size=u.size);break;default:p=typeof u.is=="string"?v.createElement(f,{is:u.is}):v.createElement(f)}}p[is]=r,p[ws]=u;e:for(v=r.child;v!==null;){if(v.tag===5||v.tag===6)p.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===r)break e;for(;v.sibling===null;){if(v.return===null||v.return===r)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}r.stateNode=p;e:switch(Hs(p,f,u),f){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&hr(r)}}return es(r),fp(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,l),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==u&&hr(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(s=Me.current,Wl(r)){if(s=r.stateNode,l=r.memoizedProps,u=null,f=Fs,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}s[is]=r,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||yv(s.nodeValue,l)),s||Gr(r,!0)}else s=rh(s).createTextNode(u),s[is]=r,r.stateNode=s}return es(r),null;case 31:if(l=r.memoizedState,s===null||s.memoizedState!==null){if(u=Wl(r),l!==null){if(s===null){if(!u)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[is]=r}else Ji(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;es(r),s=!1}else l=_m(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return r.flags&256?(In(r),r):(In(r),null);if((r.flags&128)!==0)throw Error(i(558))}return es(r),null;case 13:if(u=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(f=Wl(r),u!==null&&u.dehydrated!==null){if(s===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[is]=r}else Ji(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;es(r),f=!1}else f=_m(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(In(r),r):(In(r),null)}return In(r),(r.flags&128)!==0?(r.lanes=l,r):(l=u!==null,s=s!==null&&s.memoizedState!==null,l&&(u=r.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==f&&(u.flags|=2048)),l!==s&&l&&(r.child.flags|=8192),qd(r,r.updateQueue),es(r),null);case 4:return it(),s===null&&Op(r.stateNode.containerInfo),es(r),null;case 10:return or(r.type),es(r),null;case 19:if(J(bs),u=r.memoizedState,u===null)return es(r),null;if(f=(r.flags&128)!==0,p=u.rendering,p===null)if(f)Rc(u,!1);else{if(fs!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(p=Rd(s),p!==null){for(r.flags|=128,Rc(u,!1),s=p.updateQueue,r.updateQueue=s,qd(r,s),r.subtreeFlags=0,s=l,l=r.child;l!==null;)Xg(l,s),l=l.sibling;return le(bs,bs.current&1|2),jt&&ir(r,u.treeForkCount),r.child}s=s.sibling}u.tail!==null&&Ve()>Qd&&(r.flags|=128,f=!0,Rc(u,!1),r.lanes=4194304)}else{if(!f)if(s=Rd(p),s!==null){if(r.flags|=128,f=!0,s=s.updateQueue,r.updateQueue=s,qd(r,s),Rc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!p.alternate&&!jt)return es(r),null}else 2*Ve()-u.renderingStartTime>Qd&&l!==536870912&&(r.flags|=128,f=!0,Rc(u,!1),r.lanes=4194304);u.isBackwards?(p.sibling=r.child,r.child=p):(s=u.last,s!==null?s.sibling=p:r.child=p,u.last=p)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=Ve(),s.sibling=null,l=bs.current,le(bs,f?l&1|2:l&1),jt&&ir(r,u.treeForkCount),s):(es(r),null);case 22:case 23:return In(r),Pm(),u=r.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(es(r),r.subtreeFlags&6&&(r.flags|=8192)):es(r),l=r.updateQueue,l!==null&&qd(r,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),s!==null&&J(tl),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),or(js),es(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function qS(s,r){switch(wm(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return or(js),it(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return ae(r),null;case 31:if(r.memoizedState!==null){if(In(r),r.alternate===null)throw Error(i(340));Ji()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(In(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Ji()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return J(bs),null;case 4:return it(),null;case 10:return or(r.type),null;case 22:case 23:return In(r),Pm(),s!==null&&J(tl),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return or(js),null;case 25:return null;default:return null}}function jy(s,r){switch(wm(r),r.tag){case 3:or(js),it();break;case 26:case 27:case 5:ae(r);break;case 4:it();break;case 31:r.memoizedState!==null&&In(r);break;case 13:In(r);break;case 19:J(bs);break;case 10:or(r.type);break;case 22:case 23:In(r),Pm(),s!==null&&J(tl);break;case 24:or(js)}}function Ic(s,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&s)===s){u=void 0;var p=l.create,v=l.inst;u=p(),v.destroy=u}l=l.next}while(l!==f)}}catch(A){zt(r,r.return,A)}}function Zr(s,r,l){try{var u=r.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var p=f.next;u=p;do{if((u.tag&s)===s){var v=u.inst,A=v.destroy;if(A!==void 0){v.destroy=void 0,f=r;var q=l,ne=A;try{ne()}catch(me){zt(f,q,me)}}}u=u.next}while(u!==p)}}catch(me){zt(r,r.return,me)}}function Sy(s){var r=s.updateQueue;if(r!==null){var l=s.stateNode;try{pb(r,l)}catch(u){zt(s,s.return,u)}}}function Ey(s,r,l){l.props=il(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){zt(s,r,u)}}function Dc(s,r){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(f){zt(s,r,f)}}function za(s,r){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(f){zt(s,r,f)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){zt(s,r,f)}else l.current=null}function Ty(s){var r=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(f){zt(s,s.return,f)}}function mp(s,r,l){try{var u=s.stateNode;hE(u,s.type,l,r),u[ws]=r}catch(f){zt(s,s.return,f)}}function Ay(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ii(s.type)||s.tag===4}function pp(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Ay(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ii(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function xp(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(s),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=la));else if(u!==4&&(u===27&&ii(s.type)&&(l=s.stateNode,r=null),s=s.child,s!==null))for(xp(s,r,l),s=s.sibling;s!==null;)xp(s,r,l),s=s.sibling}function Hd(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?l.insertBefore(s,r):l.appendChild(s);else if(u!==4&&(u===27&&ii(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Hd(s,r,l),s=s.sibling;s!==null;)Hd(s,r,l),s=s.sibling}function ky(s){var r=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Hs(r,u,l),r[is]=s,r[ws]=l}catch(p){zt(s,s.return,p)}}var fr=!1,Ts=!1,gp=!1,Cy=typeof WeakSet=="function"?WeakSet:Set,Us=null;function HS(s,r){if(s=s.containerInfo,Lp=hh,s=Fg(s),um(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var f=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var v=0,A=-1,q=-1,ne=0,me=0,ye=s,re=null;t:for(;;){for(var ue;ye!==l||f!==0&&ye.nodeType!==3||(A=v+f),ye!==p||u!==0&&ye.nodeType!==3||(q=v+u),ye.nodeType===3&&(v+=ye.nodeValue.length),(ue=ye.firstChild)!==null;)re=ye,ye=ue;for(;;){if(ye===s)break t;if(re===l&&++ne===f&&(A=v),re===p&&++me===u&&(q=v),(ue=ye.nextSibling)!==null)break;ye=re,re=ye.parentNode}ye=ue}l=A===-1||q===-1?null:{start:A,end:q}}else l=null}l=l||{start:0,end:0}}else l=null;for(Up={focusedElem:s,selectionRange:l},hh=!1,Us=r;Us!==null;)if(r=Us,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,Us=s;else for(;Us!==null;){switch(r=Us,p=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)f=s[l],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&p!==null){s=void 0,l=r,f=p.memoizedProps,p=p.memoizedState,u=l.stateNode;try{var Ue=il(l.type,f);s=u.getSnapshotBeforeUpdate(Ue,p),u.__reactInternalSnapshotBeforeUpdate=s}catch(et){zt(l,l.return,et)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,l=s.nodeType,l===9)Fp(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Fp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,Us=s;break}Us=r.return}}function Ry(s,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:pr(s,l),u&4&&Ic(5,l);break;case 1:if(pr(s,l),u&4)if(s=l.stateNode,r===null)try{s.componentDidMount()}catch(v){zt(l,l.return,v)}else{var f=il(l.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(f,r,s.__reactInternalSnapshotBeforeUpdate)}catch(v){zt(l,l.return,v)}}u&64&&Sy(l),u&512&&Dc(l,l.return);break;case 3:if(pr(s,l),u&64&&(s=l.updateQueue,s!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{pb(s,r)}catch(v){zt(l,l.return,v)}}break;case 27:r===null&&u&4&&ky(l);case 26:case 5:pr(s,l),r===null&&u&4&&Ty(l),u&512&&Dc(l,l.return);break;case 12:pr(s,l);break;case 31:pr(s,l),u&4&&My(s,l);break;case 13:pr(s,l),u&4&&Oy(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=eE.bind(null,l),vE(s,l))));break;case 22:if(u=l.memoizedState!==null||fr,!u){r=r!==null&&r.memoizedState!==null||Ts,f=fr;var p=Ts;fr=u,(Ts=r)&&!p?xr(s,l,(l.subtreeFlags&8772)!==0):pr(s,l),fr=f,Ts=p}break;case 30:break;default:pr(s,l)}}function Iy(s){var r=s.alternate;r!==null&&(s.alternate=null,Iy(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Rl(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var os=null,un=!1;function mr(s,r,l){for(l=l.child;l!==null;)Dy(s,r,l),l=l.sibling}function Dy(s,r,l){if(_t&&typeof _t.onCommitFiberUnmount=="function")try{_t.onCommitFiberUnmount(Lt,l)}catch{}switch(l.tag){case 26:Ts||za(l,r),mr(s,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ts||za(l,r);var u=os,f=un;ii(l.type)&&(os=l.stateNode,un=!1),mr(s,r,l),Fc(l.stateNode),os=u,un=f;break;case 5:Ts||za(l,r);case 6:if(u=os,f=un,os=null,mr(s,r,l),os=u,un=f,os!==null)if(un)try{(os.nodeType===9?os.body:os.nodeName==="HTML"?os.ownerDocument.body:os).removeChild(l.stateNode)}catch(p){zt(l,r,p)}else try{os.removeChild(l.stateNode)}catch(p){zt(l,r,p)}break;case 18:os!==null&&(un?(s=os,Sv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),xo(s)):Sv(os,l.stateNode));break;case 4:u=os,f=un,os=l.stateNode.containerInfo,un=!0,mr(s,r,l),os=u,un=f;break;case 0:case 11:case 14:case 15:Zr(2,l,r),Ts||Zr(4,l,r),mr(s,r,l);break;case 1:Ts||(za(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&Ey(l,r,u)),mr(s,r,l);break;case 21:mr(s,r,l);break;case 22:Ts=(u=Ts)||l.memoizedState!==null,mr(s,r,l),Ts=u;break;default:mr(s,r,l)}}function My(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{xo(s)}catch(l){zt(r,r.return,l)}}}function Oy(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{xo(s)}catch(l){zt(r,r.return,l)}}function GS(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new Cy),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new Cy),r;default:throw Error(i(435,s.tag))}}function Gd(s,r){var l=GS(s);r.forEach(function(u){if(!l.has(u)){l.add(u);var f=tE.bind(null,s,u);u.then(f,f)}})}function dn(s,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var f=l[u],p=s,v=r,A=v;e:for(;A!==null;){switch(A.tag){case 27:if(ii(A.type)){os=A.stateNode,un=!1;break e}break;case 5:os=A.stateNode,un=!1;break e;case 3:case 4:os=A.stateNode.containerInfo,un=!0;break e}A=A.return}if(os===null)throw Error(i(160));Dy(p,v,f),os=null,un=!1,p=f.alternate,p!==null&&(p.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Py(r,s),r=r.sibling}var fa=null;function Py(s,r){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:dn(r,s),hn(s),u&4&&(Zr(3,s,s.return),Ic(3,s),Zr(5,s,s.return));break;case 1:dn(r,s),hn(s),u&512&&(Ts||l===null||za(l,l.return)),u&64&&fr&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var f=fa;if(dn(r,s),hn(s),u&512&&(Ts||l===null||za(l,l.return)),u&4){var p=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":p=f.getElementsByTagName("title")[0],(!p||p[Ta]||p[is]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=f.createElement(u),f.head.insertBefore(p,f.querySelector("head > title"))),Hs(p,u,l),p[is]=s,Ns(p),u=p;break e;case"link":var v=Pv("link","href",f).get(u+(l.href||""));if(v){for(var A=0;A<v.length;A++)if(p=v[A],p.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&p.getAttribute("rel")===(l.rel==null?null:l.rel)&&p.getAttribute("title")===(l.title==null?null:l.title)&&p.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){v.splice(A,1);break t}}p=f.createElement(u),Hs(p,u,l),f.head.appendChild(p);break;case"meta":if(v=Pv("meta","content",f).get(u+(l.content||""))){for(A=0;A<v.length;A++)if(p=v[A],p.getAttribute("content")===(l.content==null?null:""+l.content)&&p.getAttribute("name")===(l.name==null?null:l.name)&&p.getAttribute("property")===(l.property==null?null:l.property)&&p.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&p.getAttribute("charset")===(l.charSet==null?null:l.charSet)){v.splice(A,1);break t}}p=f.createElement(u),Hs(p,u,l),f.head.appendChild(p);break;default:throw Error(i(468,u))}p[is]=s,Ns(p),u=p}s.stateNode=u}else Vv(f,s.type,s.stateNode);else s.stateNode=Ov(f,u,s.memoizedProps);else p!==u?(p===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):p.count--,u===null?Vv(f,s.type,s.stateNode):Ov(f,u,s.memoizedProps)):u===null&&s.stateNode!==null&&mp(s,s.memoizedProps,l.memoizedProps)}break;case 27:dn(r,s),hn(s),u&512&&(Ts||l===null||za(l,l.return)),l!==null&&u&4&&mp(s,s.memoizedProps,l.memoizedProps);break;case 5:if(dn(r,s),hn(s),u&512&&(Ts||l===null||za(l,l.return)),s.flags&32){f=s.stateNode;try{cn(f,"")}catch(Ue){zt(s,s.return,Ue)}}u&4&&s.stateNode!=null&&(f=s.memoizedProps,mp(s,f,l!==null?l.memoizedProps:f)),u&1024&&(gp=!0);break;case 6:if(dn(r,s),hn(s),u&4){if(s.stateNode===null)throw Error(i(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(Ue){zt(s,s.return,Ue)}}break;case 3:if(oh=null,f=fa,fa=ih(r.containerInfo),dn(r,s),fa=f,hn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{xo(r.containerInfo)}catch(Ue){zt(s,s.return,Ue)}gp&&(gp=!1,Vy(s));break;case 4:u=fa,fa=ih(s.stateNode.containerInfo),dn(r,s),hn(s),fa=u;break;case 12:dn(r,s),hn(s);break;case 31:dn(r,s),hn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Gd(s,u)));break;case 13:dn(r,s),hn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Wd=Ve()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Gd(s,u)));break;case 22:f=s.memoizedState!==null;var q=l!==null&&l.memoizedState!==null,ne=fr,me=Ts;if(fr=ne||f,Ts=me||q,dn(r,s),Ts=me,fr=ne,hn(s),u&8192)e:for(r=s.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(l===null||q||fr||Ts||ll(s)),l=null,r=s;;){if(r.tag===5||r.tag===26){if(l===null){q=l=r;try{if(p=q.stateNode,f)v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{A=q.stateNode;var ye=q.memoizedProps.style,re=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;A.style.display=re==null||typeof re=="boolean"?"":(""+re).trim()}}catch(Ue){zt(q,q.return,Ue)}}}else if(r.tag===6){if(l===null){q=r;try{q.stateNode.nodeValue=f?"":q.memoizedProps}catch(Ue){zt(q,q.return,Ue)}}}else if(r.tag===18){if(l===null){q=r;try{var ue=q.stateNode;f?Ev(ue,!0):Ev(q.stateNode,!1)}catch(Ue){zt(q,q.return,Ue)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Gd(s,l))));break;case 19:dn(r,s),hn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Gd(s,u)));break;case 30:break;case 21:break;default:dn(r,s),hn(s)}}function hn(s){var r=s.flags;if(r&2){try{for(var l,u=s.return;u!==null;){if(Ay(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var f=l.stateNode,p=pp(s);Hd(s,p,f);break;case 5:var v=l.stateNode;l.flags&32&&(cn(v,""),l.flags&=-33);var A=pp(s);Hd(s,A,v);break;case 3:case 4:var q=l.stateNode.containerInfo,ne=pp(s);xp(s,ne,q);break;default:throw Error(i(161))}}catch(me){zt(s,s.return,me)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function Vy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;Vy(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function pr(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Ry(s,r.alternate,r),r=r.sibling}function ll(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:Zr(4,r,r.return),ll(r);break;case 1:za(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&Ey(r,r.return,l),ll(r);break;case 27:Fc(r.stateNode);case 26:case 5:za(r,r.return),ll(r);break;case 22:r.memoizedState===null&&ll(r);break;case 30:ll(r);break;default:ll(r)}s=s.sibling}}function xr(s,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,f=s,p=r,v=p.flags;switch(p.tag){case 0:case 11:case 15:xr(f,p,l),Ic(4,p);break;case 1:if(xr(f,p,l),u=p,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ne){zt(u,u.return,ne)}if(u=p,f=u.updateQueue,f!==null){var A=u.stateNode;try{var q=f.shared.hiddenCallbacks;if(q!==null)for(f.shared.hiddenCallbacks=null,f=0;f<q.length;f++)mb(q[f],A)}catch(ne){zt(u,u.return,ne)}}l&&v&64&&Sy(p),Dc(p,p.return);break;case 27:ky(p);case 26:case 5:xr(f,p,l),l&&u===null&&v&4&&Ty(p),Dc(p,p.return);break;case 12:xr(f,p,l);break;case 31:xr(f,p,l),l&&v&4&&My(f,p);break;case 13:xr(f,p,l),l&&v&4&&Oy(f,p);break;case 22:p.memoizedState===null&&xr(f,p,l),Dc(p,p.return);break;case 30:break;default:xr(f,p,l)}r=r.sibling}}function bp(s,r){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&yc(l))}function yp(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&yc(s))}function ma(s,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Ly(s,r,l,u),r=r.sibling}function Ly(s,r,l,u){var f=r.flags;switch(r.tag){case 0:case 11:case 15:ma(s,r,l,u),f&2048&&Ic(9,r);break;case 1:ma(s,r,l,u);break;case 3:ma(s,r,l,u),f&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&yc(s)));break;case 12:if(f&2048){ma(s,r,l,u),s=r.stateNode;try{var p=r.memoizedProps,v=p.id,A=p.onPostCommit;typeof A=="function"&&A(v,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(q){zt(r,r.return,q)}}else ma(s,r,l,u);break;case 31:ma(s,r,l,u);break;case 13:ma(s,r,l,u);break;case 23:break;case 22:p=r.stateNode,v=r.alternate,r.memoizedState!==null?p._visibility&2?ma(s,r,l,u):Mc(s,r):p._visibility&2?ma(s,r,l,u):(p._visibility|=2,ao(s,r,l,u,(r.subtreeFlags&10256)!==0||!1)),f&2048&&bp(v,r);break;case 24:ma(s,r,l,u),f&2048&&yp(r.alternate,r);break;default:ma(s,r,l,u)}}function ao(s,r,l,u,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var p=s,v=r,A=l,q=u,ne=v.flags;switch(v.tag){case 0:case 11:case 15:ao(p,v,A,q,f),Ic(8,v);break;case 23:break;case 22:var me=v.stateNode;v.memoizedState!==null?me._visibility&2?ao(p,v,A,q,f):Mc(p,v):(me._visibility|=2,ao(p,v,A,q,f)),f&&ne&2048&&bp(v.alternate,v);break;case 24:ao(p,v,A,q,f),f&&ne&2048&&yp(v.alternate,v);break;default:ao(p,v,A,q,f)}r=r.sibling}}function Mc(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=s,u=r,f=u.flags;switch(u.tag){case 22:Mc(l,u),f&2048&&bp(u.alternate,u);break;case 24:Mc(l,u),f&2048&&yp(u.alternate,u);break;default:Mc(l,u)}r=r.sibling}}var Oc=8192;function ro(s,r,l){if(s.subtreeFlags&Oc)for(s=s.child;s!==null;)Uy(s,r,l),s=s.sibling}function Uy(s,r,l){switch(s.tag){case 26:ro(s,r,l),s.flags&Oc&&s.memoizedState!==null&&IE(l,fa,s.memoizedState,s.memoizedProps);break;case 5:ro(s,r,l);break;case 3:case 4:var u=fa;fa=ih(s.stateNode.containerInfo),ro(s,r,l),fa=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Oc,Oc=16777216,ro(s,r,l),Oc=u):ro(s,r,l));break;default:ro(s,r,l)}}function By(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Pc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Us=u,Fy(u,s)}By(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)zy(s),s=s.sibling}function zy(s){switch(s.tag){case 0:case 11:case 15:Pc(s),s.flags&2048&&Zr(9,s,s.return);break;case 3:Pc(s);break;case 12:Pc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Yd(s)):Pc(s);break;default:Pc(s)}}function Yd(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Us=u,Fy(u,s)}By(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:Zr(8,r,r.return),Yd(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,Yd(r));break;default:Yd(r)}s=s.sibling}}function Fy(s,r){for(;Us!==null;){var l=Us;switch(l.tag){case 0:case 11:case 15:Zr(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:yc(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Us=u;else e:for(l=s;Us!==null;){u=Us;var f=u.sibling,p=u.return;if(Iy(u),u===l){Us=null;break e}if(f!==null){f.return=p,Us=f;break e}Us=p}}}var YS={getCacheForType:function(s){var r=$s(js),l=r.data.get(s);return l===void 0&&(l=s(),r.data.set(s,l)),l},cacheSignal:function(){return $s(js).controller.signal}},WS=typeof WeakMap=="function"?WeakMap:Map,Mt=0,Yt=null,mt=null,gt=0,Bt=0,Dn=null,ei=!1,io=!1,vp=!1,gr=0,fs=0,ti=0,ol=0,wp=0,Mn=0,lo=0,Vc=null,fn=null,Np=!1,Wd=0,$y=0,Qd=1/0,Kd=null,si=null,Ds=0,ni=null,oo=null,br=0,_p=0,jp=null,qy=null,Lc=0,Sp=null;function On(){return(Mt&2)!==0&&gt!==0?gt&-gt:O.T!==null?Rp():tr()}function Hy(){if(Mn===0)if((gt&536870912)===0||jt){var s=H;H<<=1,(H&3932160)===0&&(H=262144),Mn=s}else Mn=536870912;return s=Rn.current,s!==null&&(s.flags|=32),Mn}function mn(s,r,l){(s===Yt&&(Bt===2||Bt===9)||s.cancelPendingCommit!==null)&&(co(s,0),ai(s,gt,Mn,!1)),St(s,l),((Mt&2)===0||s!==Yt)&&(s===Yt&&((Mt&2)===0&&(ol|=l),fs===4&&ai(s,gt,Mn,!1)),Fa(s))}function Gy(s,r,l){if((Mt&6)!==0)throw Error(i(327));var u=!l&&(r&127)===0&&(r&s.expiredLanes)===0||Oe(s,r),f=u?XS(s,r):Tp(s,r,!0),p=u;do{if(f===0){io&&!u&&ai(s,r,0,!1);break}else{if(l=s.current.alternate,p&&!QS(l)){f=Tp(s,r,!1),p=!1;continue}if(f===2){if(p=r,s.errorRecoveryDisabledLanes&p)var v=0;else v=s.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){r=v;e:{var A=s;f=Vc;var q=A.current.memoizedState.isDehydrated;if(q&&(co(A,v).flags|=256),v=Tp(A,v,!1),v!==2){if(vp&&!q){A.errorRecoveryDisabledLanes|=p,ol|=p,f=4;break e}p=fn,fn=f,p!==null&&(fn===null?fn=p:fn.push.apply(fn,p))}f=v}if(p=!1,f!==2)continue}}if(f===1){co(s,0),ai(s,r,0,!0);break}e:{switch(u=s,p=f,p){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:ai(u,r,Mn,!ei);break e;case 2:fn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Wd+300-Ve(),10<f)){if(ai(u,r,Mn,!ei),Te(u,0,!0)!==0)break e;br=r,u.timeoutHandle=_v(Yy.bind(null,u,l,fn,Kd,Np,r,Mn,ol,lo,ei,p,"Throttled",-0,0),f);break e}Yy(u,l,fn,Kd,Np,r,Mn,ol,lo,ei,p,null,-0,0)}}break}while(!0);Fa(s)}function Yy(s,r,l,u,f,p,v,A,q,ne,me,ye,re,ue){if(s.timeoutHandle=-1,ye=r.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:la},Uy(r,p,ye);var Ue=(p&62914560)===p?Wd-Ve():(p&4194048)===p?$y-Ve():0;if(Ue=DE(ye,Ue),Ue!==null){br=p,s.cancelPendingCommit=Ue(tv.bind(null,s,r,p,l,u,f,v,A,q,me,ye,null,re,ue)),ai(s,p,v,!ne);return}}tv(s,r,p,l,u,f,v,A,q)}function QS(s){for(var r=s;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var f=l[u],p=f.getSnapshot;f=f.value;try{if(!kn(p(),f))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function ai(s,r,l,u){r&=~wp,r&=~ol,s.suspendedLanes|=r,s.pingedLanes&=~r,u&&(s.warmLanes|=r),u=s.expirationTimes;for(var f=r;0<f;){var p=31-It(f),v=1<<p;u[p]=-1,f&=~v}l!==0&&as(s,l,r)}function Xd(){return(Mt&6)===0?(Uc(0),!1):!0}function Ep(){if(mt!==null){if(Bt===0)var s=mt.return;else s=mt,lr=Zi=null,Fm(s),Zl=null,wc=0,s=mt;for(;s!==null;)jy(s.alternate,s),s=s.return;mt=null}}function co(s,r){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,pE(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),br=0,Ep(),Yt=s,mt=l=rr(s.current,null),gt=r,Bt=0,Dn=null,ei=!1,io=Oe(s,r),vp=!1,lo=Mn=wp=ol=ti=fs=0,fn=Vc=null,Np=!1,(r&8)!==0&&(r|=r&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=r;0<u;){var f=31-It(u),p=1<<f;r|=s[f],u&=~p}return gr=r,bd(),l}function Wy(s,r){dt=null,O.H=kc,r===Jl||r===Ed?(r=ub(),Bt=3):r===Cm?(r=ub(),Bt=4):Bt=r===ap?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Dn=r,mt===null&&(fs=1,Bd(s,Yn(r,s.current)))}function Qy(){var s=Rn.current;return s===null?!0:(gt&4194048)===gt?Xn===null:(gt&62914560)===gt||(gt&536870912)!==0?s===Xn:!1}function Ky(){var s=O.H;return O.H=kc,s===null?kc:s}function Xy(){var s=O.A;return O.A=YS,s}function Jd(){fs=4,ei||(gt&4194048)!==gt&&Rn.current!==null||(io=!0),(ti&134217727)===0&&(ol&134217727)===0||Yt===null||ai(Yt,gt,Mn,!1)}function Tp(s,r,l){var u=Mt;Mt|=2;var f=Ky(),p=Xy();(Yt!==s||gt!==r)&&(Kd=null,co(s,r)),r=!1;var v=fs;e:do try{if(Bt!==0&&mt!==null){var A=mt,q=Dn;switch(Bt){case 8:Ep(),v=6;break e;case 3:case 2:case 9:case 6:Rn.current===null&&(r=!0);var ne=Bt;if(Bt=0,Dn=null,uo(s,A,q,ne),l&&io){v=0;break e}break;default:ne=Bt,Bt=0,Dn=null,uo(s,A,q,ne)}}KS(),v=fs;break}catch(me){Wy(s,me)}while(!0);return r&&s.shellSuspendCounter++,lr=Zi=null,Mt=u,O.H=f,O.A=p,mt===null&&(Yt=null,gt=0,bd()),v}function KS(){for(;mt!==null;)Jy(mt)}function XS(s,r){var l=Mt;Mt|=2;var u=Ky(),f=Xy();Yt!==s||gt!==r?(Kd=null,Qd=Ve()+500,co(s,r)):io=Oe(s,r);e:do try{if(Bt!==0&&mt!==null){r=mt;var p=Dn;t:switch(Bt){case 1:Bt=0,Dn=null,uo(s,r,p,1);break;case 2:case 9:if(ob(p)){Bt=0,Dn=null,Zy(r);break}r=function(){Bt!==2&&Bt!==9||Yt!==s||(Bt=7),Fa(s)},p.then(r,r);break e;case 3:Bt=7;break e;case 4:Bt=5;break e;case 7:ob(p)?(Bt=0,Dn=null,Zy(r)):(Bt=0,Dn=null,uo(s,r,p,7));break;case 5:var v=null;switch(mt.tag){case 26:v=mt.memoizedState;case 5:case 27:var A=mt;if(v?Lv(v):A.stateNode.complete){Bt=0,Dn=null;var q=A.sibling;if(q!==null)mt=q;else{var ne=A.return;ne!==null?(mt=ne,Zd(ne)):mt=null}break t}}Bt=0,Dn=null,uo(s,r,p,5);break;case 6:Bt=0,Dn=null,uo(s,r,p,6);break;case 8:Ep(),fs=6;break e;default:throw Error(i(462))}}JS();break}catch(me){Wy(s,me)}while(!0);return lr=Zi=null,O.H=u,O.A=f,Mt=l,mt!==null?0:(Yt=null,gt=0,bd(),fs)}function JS(){for(;mt!==null&&!fe();)Jy(mt)}function Jy(s){var r=Ny(s.alternate,s,gr);s.memoizedProps=s.pendingProps,r===null?Zd(s):mt=r}function Zy(s){var r=s,l=r.alternate;switch(r.tag){case 15:case 0:r=xy(l,r,r.pendingProps,r.type,void 0,gt);break;case 11:r=xy(l,r,r.pendingProps,r.type.render,r.ref,gt);break;case 5:Fm(r);default:jy(l,r),r=mt=Xg(r,gr),r=Ny(l,r,gr)}s.memoizedProps=s.pendingProps,r===null?Zd(s):mt=r}function uo(s,r,l,u){lr=Zi=null,Fm(r),Zl=null,wc=0;var f=r.return;try{if(BS(s,f,r,l,gt)){fs=1,Bd(s,Yn(l,s.current)),mt=null;return}}catch(p){if(f!==null)throw mt=f,p;fs=1,Bd(s,Yn(l,s.current)),mt=null;return}r.flags&32768?(jt||u===1?s=!0:io||(gt&536870912)!==0?s=!1:(ei=s=!0,(u===2||u===9||u===3||u===6)&&(u=Rn.current,u!==null&&u.tag===13&&(u.flags|=16384))),ev(r,s)):Zd(r)}function Zd(s){var r=s;do{if((r.flags&32768)!==0){ev(r,ei);return}s=r.return;var l=$S(r.alternate,r,gr);if(l!==null){mt=l;return}if(r=r.sibling,r!==null){mt=r;return}mt=r=s}while(r!==null);fs===0&&(fs=5)}function ev(s,r){do{var l=qS(s.alternate,s);if(l!==null){l.flags&=32767,mt=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(s=s.sibling,s!==null)){mt=s;return}mt=s=l}while(s!==null);fs=6,mt=null}function tv(s,r,l,u,f,p,v,A,q){s.cancelPendingCommit=null;do eh();while(Ds!==0);if((Mt&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(p=r.lanes|r.childLanes,p|=pm,ns(s,l,p,v,A,q),s===Yt&&(mt=Yt=null,gt=0),oo=r,ni=s,br=l,_p=p,jp=f,qy=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,sE(Z,function(){return iv(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=O.T,O.T=null,f=K.p,K.p=2,v=Mt,Mt|=4;try{HS(s,r,l)}finally{Mt=v,K.p=f,O.T=u}}Ds=1,sv(),nv(),av()}}function sv(){if(Ds===1){Ds=0;var s=ni,r=oo,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=O.T,O.T=null;var u=K.p;K.p=2;var f=Mt;Mt|=4;try{Py(r,s);var p=Up,v=Fg(s.containerInfo),A=p.focusedElem,q=p.selectionRange;if(v!==A&&A&&A.ownerDocument&&zg(A.ownerDocument.documentElement,A)){if(q!==null&&um(A)){var ne=q.start,me=q.end;if(me===void 0&&(me=ne),"selectionStart"in A)A.selectionStart=ne,A.selectionEnd=Math.min(me,A.value.length);else{var ye=A.ownerDocument||document,re=ye&&ye.defaultView||window;if(re.getSelection){var ue=re.getSelection(),Ue=A.textContent.length,et=Math.min(q.start,Ue),Ht=q.end===void 0?et:Math.min(q.end,Ue);!ue.extend&&et>Ht&&(v=Ht,Ht=et,et=v);var X=Bg(A,et),Y=Bg(A,Ht);if(X&&Y&&(ue.rangeCount!==1||ue.anchorNode!==X.node||ue.anchorOffset!==X.offset||ue.focusNode!==Y.node||ue.focusOffset!==Y.offset)){var se=ye.createRange();se.setStart(X.node,X.offset),ue.removeAllRanges(),et>Ht?(ue.addRange(se),ue.extend(Y.node,Y.offset)):(se.setEnd(Y.node,Y.offset),ue.addRange(se))}}}}for(ye=[],ue=A;ue=ue.parentNode;)ue.nodeType===1&&ye.push({element:ue,left:ue.scrollLeft,top:ue.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<ye.length;A++){var ge=ye[A];ge.element.scrollLeft=ge.left,ge.element.scrollTop=ge.top}}hh=!!Lp,Up=Lp=null}finally{Mt=f,K.p=u,O.T=l}}s.current=r,Ds=2}}function nv(){if(Ds===2){Ds=0;var s=ni,r=oo,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=O.T,O.T=null;var u=K.p;K.p=2;var f=Mt;Mt|=4;try{Ry(s,r.alternate,r)}finally{Mt=f,K.p=u,O.T=l}}Ds=3}}function av(){if(Ds===4||Ds===3){Ds=0,ze();var s=ni,r=oo,l=br,u=qy;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ds=5:(Ds=0,oo=ni=null,rv(s,s.pendingLanes));var f=s.pendingLanes;if(f===0&&(si=null),us(l),r=r.stateNode,_t&&typeof _t.onCommitFiberRoot=="function")try{_t.onCommitFiberRoot(Lt,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=O.T,f=K.p,K.p=2,O.T=null;try{for(var p=s.onRecoverableError,v=0;v<u.length;v++){var A=u[v];p(A.value,{componentStack:A.stack})}}finally{O.T=r,K.p=f}}(br&3)!==0&&eh(),Fa(s),f=s.pendingLanes,(l&261930)!==0&&(f&42)!==0?s===Sp?Lc++:(Lc=0,Sp=s):Lc=0,Uc(0)}}function rv(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,yc(r)))}function eh(){return sv(),nv(),av(),iv()}function iv(){if(Ds!==5)return!1;var s=ni,r=_p;_p=0;var l=us(br),u=O.T,f=K.p;try{K.p=32>l?32:l,O.T=null,l=jp,jp=null;var p=ni,v=br;if(Ds=0,oo=ni=null,br=0,(Mt&6)!==0)throw Error(i(331));var A=Mt;if(Mt|=4,zy(p.current),Ly(p,p.current,v,l),Mt=A,Uc(0,!1),_t&&typeof _t.onPostCommitFiberRoot=="function")try{_t.onPostCommitFiberRoot(Lt,p)}catch{}return!0}finally{K.p=f,O.T=u,rv(s,r)}}function lv(s,r,l){r=Yn(l,r),r=np(s.stateNode,r,2),s=Kr(s,r,2),s!==null&&(St(s,2),Fa(s))}function zt(s,r,l){if(s.tag===3)lv(s,s,l);else for(;r!==null;){if(r.tag===3){lv(r,s,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(si===null||!si.has(u))){s=Yn(l,s),l=oy(2),u=Kr(r,l,2),u!==null&&(cy(l,u,r,s),St(u,2),Fa(u));break}}r=r.return}}function Ap(s,r,l){var u=s.pingCache;if(u===null){u=s.pingCache=new WS;var f=new Set;u.set(r,f)}else f=u.get(r),f===void 0&&(f=new Set,u.set(r,f));f.has(l)||(vp=!0,f.add(l),s=ZS.bind(null,s,r,l),r.then(s,s))}function ZS(s,r,l){var u=s.pingCache;u!==null&&u.delete(r),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Yt===s&&(gt&l)===l&&(fs===4||fs===3&&(gt&62914560)===gt&&300>Ve()-Wd?(Mt&2)===0&&co(s,0):wp|=l,lo===gt&&(lo=0)),Fa(s)}function ov(s,r){r===0&&(r=je()),s=Ki(s,r),s!==null&&(St(s,r),Fa(s))}function eE(s){var r=s.memoizedState,l=0;r!==null&&(l=r.retryLane),ov(s,l)}function tE(s,r){var l=0;switch(s.tag){case 31:case 13:var u=s.stateNode,f=s.memoizedState;f!==null&&(l=f.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),ov(s,l)}function sE(s,r){return Ie(s,r)}var th=null,ho=null,kp=!1,sh=!1,Cp=!1,ri=0;function Fa(s){s!==ho&&s.next===null&&(ho===null?th=ho=s:ho=ho.next=s),sh=!0,kp||(kp=!0,aE())}function Uc(s,r){if(!Cp&&sh){Cp=!0;do for(var l=!1,u=th;u!==null;){if(s!==0){var f=u.pendingLanes;if(f===0)var p=0;else{var v=u.suspendedLanes,A=u.pingedLanes;p=(1<<31-It(42|s)+1)-1,p&=f&~(v&~A),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(l=!0,hv(u,p))}else p=gt,p=Te(u,u===Yt?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(p&3)===0||Oe(u,p)||(l=!0,hv(u,p));u=u.next}while(l);Cp=!1}}function nE(){cv()}function cv(){sh=kp=!1;var s=0;ri!==0&&mE()&&(s=ri);for(var r=Ve(),l=null,u=th;u!==null;){var f=u.next,p=uv(u,r);p===0?(u.next=null,l===null?th=f:l.next=f,f===null&&(ho=l)):(l=u,(s!==0||(p&3)!==0)&&(sh=!0)),u=f}Ds!==0&&Ds!==5||Uc(s),ri!==0&&(ri=0)}function uv(s,r){for(var l=s.suspendedLanes,u=s.pingedLanes,f=s.expirationTimes,p=s.pendingLanes&-62914561;0<p;){var v=31-It(p),A=1<<v,q=f[v];q===-1?((A&l)===0||(A&u)!==0)&&(f[v]=Ae(A,r)):q<=r&&(s.expiredLanes|=A),p&=~A}if(r=Yt,l=gt,l=Te(s,s===r?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===r&&(Bt===2||Bt===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Be(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Oe(s,l)){if(r=l&-l,r===s.callbackPriority)return r;switch(u!==null&&Be(u),us(l)){case 2:case 8:l=Ye;break;case 32:l=Z;break;case 268435456:l=We;break;default:l=Z}return u=dv.bind(null,s),l=Ie(l,u),s.callbackPriority=r,s.callbackNode=l,r}return u!==null&&u!==null&&Be(u),s.callbackPriority=2,s.callbackNode=null,2}function dv(s,r){if(Ds!==0&&Ds!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(eh()&&s.callbackNode!==l)return null;var u=gt;return u=Te(s,s===Yt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(Gy(s,u,r),uv(s,Ve()),s.callbackNode!=null&&s.callbackNode===l?dv.bind(null,s):null)}function hv(s,r){if(eh())return null;Gy(s,r,!0)}function aE(){xE(function(){(Mt&6)!==0?Ie(He,nE):cv()})}function Rp(){if(ri===0){var s=Kl;s===0&&(s=$,$<<=1,($&261888)===0&&($=256)),ri=s}return ri}function fv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ol(""+s)}function mv(s,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,s.id&&l.setAttribute("form",s.id),r.parentNode.insertBefore(l,r),s=new FormData(s),l.parentNode.removeChild(l),s}function rE(s,r,l,u,f){if(r==="submit"&&l&&l.stateNode===f){var p=fv((f[ws]||null).action),v=u.submitter;v&&(r=(r=v[ws]||null)?fv(r.formAction):v.getAttribute("formAction"),r!==null&&(p=r,v=null));var A=new Oa("action","action",null,u,f);s.push({event:A,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ri!==0){var q=v?mv(f,v):new FormData(f);Xm(l,{pending:!0,data:q,method:f.method,action:p},null,q)}}else typeof p=="function"&&(A.preventDefault(),q=v?mv(f,v):new FormData(f),Xm(l,{pending:!0,data:q,method:f.method,action:p},p,q))},currentTarget:f}]})}}for(var Ip=0;Ip<mm.length;Ip++){var Dp=mm[Ip],iE=Dp.toLowerCase(),lE=Dp[0].toUpperCase()+Dp.slice(1);ha(iE,"on"+lE)}ha(Hg,"onAnimationEnd"),ha(Gg,"onAnimationIteration"),ha(Yg,"onAnimationStart"),ha("dblclick","onDoubleClick"),ha("focusin","onFocus"),ha("focusout","onBlur"),ha(_S,"onTransitionRun"),ha(jS,"onTransitionStart"),ha(SS,"onTransitionCancel"),ha(Wg,"onTransitionEnd"),Ra("onMouseEnter",["mouseout","mouseover"]),Ra("onMouseLeave",["mouseout","mouseover"]),Ra("onPointerEnter",["pointerout","pointerover"]),Ra("onPointerLeave",["pointerout","pointerover"]),Ca("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ca("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ca("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ca("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ca("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ca("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bc));function pv(s,r){r=(r&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],f=u.event;u=u.listeners;e:{var p=void 0;if(r)for(var v=u.length-1;0<=v;v--){var A=u[v],q=A.instance,ne=A.currentTarget;if(A=A.listener,q!==p&&f.isPropagationStopped())break e;p=A,f.currentTarget=ne;try{p(f)}catch(me){gd(me)}f.currentTarget=null,p=q}else for(v=0;v<u.length;v++){if(A=u[v],q=A.instance,ne=A.currentTarget,A=A.listener,q!==p&&f.isPropagationStopped())break e;p=A,f.currentTarget=ne;try{p(f)}catch(me){gd(me)}f.currentTarget=null,p=q}}}}function pt(s,r){var l=r[Li];l===void 0&&(l=r[Li]=new Set);var u=s+"__bubble";l.has(u)||(xv(r,s,2,!1),l.add(u))}function Mp(s,r,l){var u=0;r&&(u|=4),xv(l,s,u,r)}var nh="_reactListening"+Math.random().toString(36).slice(2);function Op(s){if(!s[nh]){s[nh]=!0,Jo.forEach(function(l){l!=="selectionchange"&&(oE.has(l)||Mp(l,!1,s),Mp(l,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[nh]||(r[nh]=!0,Mp("selectionchange",!1,r))}}function xv(s,r,l,u){switch(Hv(r)){case 2:var f=PE;break;case 8:f=VE;break;default:f=Kp}l=f.bind(null,r,l,s),f=void 0,!Fi||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),u?f!==void 0?s.addEventListener(r,l,{capture:!0,passive:f}):s.addEventListener(r,l,!0):f!==void 0?s.addEventListener(r,l,{passive:f}):s.addEventListener(r,l,!1)}function Pp(s,r,l,u,f){var p=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var A=u.stateNode.containerInfo;if(A===f)break;if(v===4)for(v=u.return;v!==null;){var q=v.tag;if((q===3||q===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;A!==null;){if(v=Aa(A),v===null)return;if(q=v.tag,q===5||q===6||q===26||q===27){u=p=v;continue e}A=A.parentNode}}u=u.return}Br(function(){var ne=p,me=$n(l),ye=[];e:{var re=Qg.get(s);if(re!==void 0){var ue=Oa,Ue=s;switch(s){case"keypress":if(qi(l)===0)break e;case"keydown":case"keyup":ue=md;break;case"focusin":Ue="focus",ue=Gi;break;case"focusout":Ue="blur",ue=Gi;break;case"beforeblur":case"afterblur":ue=Gi;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=dc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=rd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=y;break;case Hg:case Gg:case Yg:ue=ld;break;case Wg:ue=D;break;case"scroll":case"scrollend":ue=uc;break;case"wheel":ue=oe;break;case"copy":case"cut":case"paste":ue=od;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=ar;break;case"toggle":case"beforetoggle":ue=ut}var et=(r&4)!==0,Ht=!et&&(s==="scroll"||s==="scrollend"),X=et?re!==null?re+"Capture":null:re;et=[];for(var Y=ne,se;Y!==null;){var ge=Y;if(se=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||se===null||X===null||(ge=oa(Y,X),ge!=null&&et.push(zc(Y,ge,se))),Ht)break;Y=Y.return}0<et.length&&(re=new ue(re,Ue,null,l,me),ye.push({event:re,listeners:et}))}}if((r&7)===0){e:{if(re=s==="mouseover"||s==="pointerover",ue=s==="mouseout"||s==="pointerout",re&&l!==lc&&(Ue=l.relatedTarget||l.fromElement)&&(Aa(Ue)||Ue[En]))break e;if((ue||re)&&(re=me.window===me?me:(re=me.ownerDocument)?re.defaultView||re.parentWindow:window,ue?(Ue=l.relatedTarget||l.toElement,ue=ne,Ue=Ue?Aa(Ue):null,Ue!==null&&(Ht=c(Ue),et=Ue.tag,Ue!==Ht||et!==5&&et!==27&&et!==6)&&(Ue=null)):(ue=null,Ue=ne),ue!==Ue)){if(et=dc,ge="onMouseLeave",X="onMouseEnter",Y="mouse",(s==="pointerout"||s==="pointerover")&&(et=ar,ge="onPointerLeave",X="onPointerEnter",Y="pointer"),Ht=ue==null?re:Tn(ue),se=Ue==null?re:Tn(Ue),re=new et(ge,Y+"leave",ue,l,me),re.target=Ht,re.relatedTarget=se,ge=null,Aa(me)===ne&&(et=new et(X,Y+"enter",Ue,l,me),et.target=se,et.relatedTarget=Ht,ge=et),Ht=ge,ue&&Ue)t:{for(et=cE,X=ue,Y=Ue,se=0,ge=X;ge;ge=et(ge))se++;ge=0;for(var Qe=Y;Qe;Qe=et(Qe))ge++;for(;0<se-ge;)X=et(X),se--;for(;0<ge-se;)Y=et(Y),ge--;for(;se--;){if(X===Y||Y!==null&&X===Y.alternate){et=X;break t}X=et(X),Y=et(Y)}et=null}else et=null;ue!==null&&gv(ye,re,ue,et,!1),Ue!==null&&Ht!==null&&gv(ye,Ht,Ue,et,!0)}}e:{if(re=ne?Tn(ne):window,ue=re.nodeName&&re.nodeName.toLowerCase(),ue==="select"||ue==="input"&&re.type==="file")var Ct=Mg;else if(Ig(re))if(Og)Ct=vS;else{Ct=bS;var Fe=gS}else ue=re.nodeName,!ue||ue.toLowerCase()!=="input"||re.type!=="checkbox"&&re.type!=="radio"?ne&&Ml(ne.elementType)&&(Ct=Mg):Ct=yS;if(Ct&&(Ct=Ct(s,ne))){Dg(ye,Ct,l,me);break e}Fe&&Fe(s,re,ne),s==="focusout"&&ne&&re.type==="number"&&ne.memoizedProps.value!=null&&ac(re,"number",re.value)}switch(Fe=ne?Tn(ne):window,s){case"focusin":(Ig(Fe)||Fe.contentEditable==="true")&&(Fl=Fe,dm=ne,xc=null);break;case"focusout":xc=dm=Fl=null;break;case"mousedown":hm=!0;break;case"contextmenu":case"mouseup":case"dragend":hm=!1,$g(ye,l,me);break;case"selectionchange":if(NS)break;case"keydown":case"keyup":$g(ye,l,me)}var ht;if(Dt)e:{switch(s){case"compositionstart":var bt="onCompositionStart";break e;case"compositionend":bt="onCompositionEnd";break e;case"compositionupdate":bt="onCompositionUpdate";break e}bt=void 0}else zl?Yi(s,l)&&(bt="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(bt="onCompositionStart");bt&&(La&&l.locale!=="ko"&&(zl||bt!=="onCompositionStart"?bt==="onCompositionEnd"&&zl&&(ht=cc()):(Ma=me,oc="value"in Ma?Ma.value:Ma.textContent,zl=!0)),Fe=ah(ne,bt),0<Fe.length&&(bt=new Va(bt,s,null,l,me),ye.push({event:bt,listeners:Fe}),ht?bt.data=ht:(ht=Bl(l),ht!==null&&(bt.data=ht)))),(ht=Hn?fS(s,l):mS(s,l))&&(bt=ah(ne,"onBeforeInput"),0<bt.length&&(Fe=new Va("onBeforeInput","beforeinput",null,l,me),ye.push({event:Fe,listeners:bt}),Fe.data=ht)),rE(ye,s,ne,l,me)}pv(ye,r)})}function zc(s,r,l){return{instance:s,listener:r,currentTarget:l}}function ah(s,r){for(var l=r+"Capture",u=[];s!==null;){var f=s,p=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||p===null||(f=oa(s,l),f!=null&&u.unshift(zc(s,f,p)),f=oa(s,r),f!=null&&u.push(zc(s,f,p))),s.tag===3)return u;s=s.return}return[]}function cE(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function gv(s,r,l,u,f){for(var p=r._reactName,v=[];l!==null&&l!==u;){var A=l,q=A.alternate,ne=A.stateNode;if(A=A.tag,q!==null&&q===u)break;A!==5&&A!==26&&A!==27||ne===null||(q=ne,f?(ne=oa(l,p),ne!=null&&v.unshift(zc(l,ne,q))):f||(ne=oa(l,p),ne!=null&&v.push(zc(l,ne,q)))),l=l.return}v.length!==0&&s.push({event:r,listeners:v})}var uE=/\r\n?/g,dE=/\u0000|\uFFFD/g;function bv(s){return(typeof s=="string"?s:""+s).replace(uE,`
`).replace(dE,"")}function yv(s,r){return r=bv(r),bv(s)===r}function qt(s,r,l,u,f,p){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||cn(s,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&cn(s,""+u);break;case"className":An(s,"class",u);break;case"tabIndex":An(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":An(s,l,u);break;case"style":ic(s,u,p);break;case"data":if(r!=="object"){An(s,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Ol(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(l==="formAction"?(r!=="input"&&qt(s,r,"name",f.name,f,null),qt(s,r,"formEncType",f.formEncType,f,null),qt(s,r,"formMethod",f.formMethod,f,null),qt(s,r,"formTarget",f.formTarget,f,null)):(qt(s,r,"encType",f.encType,f,null),qt(s,r,"method",f.method,f,null),qt(s,r,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Ol(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=la);break;case"onScroll":u!=null&&pt("scroll",s);break;case"onScrollEnd":u!=null&&pt("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Ol(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":pt("beforetoggle",s),pt("toggle",s),Il(s,"popover",u);break;case"xlinkActuate":_s(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":_s(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":_s(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":_s(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":_s(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":_s(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":_s(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":_s(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":_s(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Il(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=ad.get(l)||l,Il(s,l,u))}}function Vp(s,r,l,u,f,p){switch(l){case"style":ic(s,u,p);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof u=="string"?cn(s,u):(typeof u=="number"||typeof u=="bigint")&&cn(s,""+u);break;case"onScroll":u!=null&&pt("scroll",s);break;case"onScrollEnd":u!=null&&pt("scrollend",s);break;case"onClick":u!=null&&(s.onclick=la);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Zo.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),r=l.slice(2,f?l.length-7:void 0),p=s[ws]||null,p=p!=null?p[l]:null,typeof p=="function"&&s.removeEventListener(r,p,f),typeof u=="function")){typeof p!="function"&&p!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(r,u,f);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Il(s,l,u)}}}function Hs(s,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pt("error",s),pt("load",s);var u=!1,f=!1,p;for(p in l)if(l.hasOwnProperty(p)){var v=l[p];if(v!=null)switch(p){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:qt(s,r,p,v,l,null)}}f&&qt(s,r,"srcSet",l.srcSet,l,null),u&&qt(s,r,"src",l.src,l,null);return;case"input":pt("invalid",s);var A=p=v=f=null,q=null,ne=null;for(u in l)if(l.hasOwnProperty(u)){var me=l[u];if(me!=null)switch(u){case"name":f=me;break;case"type":v=me;break;case"checked":q=me;break;case"defaultChecked":ne=me;break;case"value":p=me;break;case"defaultValue":A=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,r));break;default:qt(s,r,u,me,l,null)}}td(s,p,A,q,ne,v,f,!1);return;case"select":pt("invalid",s),u=v=p=null;for(f in l)if(l.hasOwnProperty(f)&&(A=l[f],A!=null))switch(f){case"value":p=A;break;case"defaultValue":v=A;break;case"multiple":u=A;default:qt(s,r,f,A,l,null)}r=p,l=v,s.multiple=!!u,r!=null?Pr(s,!!u,r,!1):l!=null&&Pr(s,!!u,l,!0);return;case"textarea":pt("invalid",s),p=f=u=null;for(v in l)if(l.hasOwnProperty(v)&&(A=l[v],A!=null))switch(v){case"value":u=A;break;case"defaultValue":f=A;break;case"children":p=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(i(91));break;default:qt(s,r,v,A,l,null)}Vr(s,u,f,p);return;case"option":for(q in l)l.hasOwnProperty(q)&&(u=l[q],u!=null)&&(q==="selected"?s.selected=u&&typeof u!="function"&&typeof u!="symbol":qt(s,r,q,u,l,null));return;case"dialog":pt("beforetoggle",s),pt("toggle",s),pt("cancel",s),pt("close",s);break;case"iframe":case"object":pt("load",s);break;case"video":case"audio":for(u=0;u<Bc.length;u++)pt(Bc[u],s);break;case"image":pt("error",s),pt("load",s);break;case"details":pt("toggle",s);break;case"embed":case"source":case"link":pt("error",s),pt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in l)if(l.hasOwnProperty(ne)&&(u=l[ne],u!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:qt(s,r,ne,u,l,null)}return;default:if(Ml(r)){for(me in l)l.hasOwnProperty(me)&&(u=l[me],u!==void 0&&Vp(s,r,me,u,l,void 0));return}}for(A in l)l.hasOwnProperty(A)&&(u=l[A],u!=null&&qt(s,r,A,u,l,null))}function hE(s,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,p=null,v=null,A=null,q=null,ne=null,me=null;for(ue in l){var ye=l[ue];if(l.hasOwnProperty(ue)&&ye!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":q=ye;default:u.hasOwnProperty(ue)||qt(s,r,ue,null,u,ye)}}for(var re in u){var ue=u[re];if(ye=l[re],u.hasOwnProperty(re)&&(ue!=null||ye!=null))switch(re){case"type":p=ue;break;case"name":f=ue;break;case"checked":ne=ue;break;case"defaultChecked":me=ue;break;case"value":v=ue;break;case"defaultValue":A=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(i(137,r));break;default:ue!==ye&&qt(s,r,re,ue,u,ye)}}Dl(s,v,A,q,ne,me,p,f);return;case"select":ue=v=A=re=null;for(p in l)if(q=l[p],l.hasOwnProperty(p)&&q!=null)switch(p){case"value":break;case"multiple":ue=q;default:u.hasOwnProperty(p)||qt(s,r,p,null,u,q)}for(f in u)if(p=u[f],q=l[f],u.hasOwnProperty(f)&&(p!=null||q!=null))switch(f){case"value":re=p;break;case"defaultValue":A=p;break;case"multiple":v=p;default:p!==q&&qt(s,r,f,p,u,q)}r=A,l=v,u=ue,re!=null?Pr(s,!!l,re,!1):!!u!=!!l&&(r!=null?Pr(s,!!l,r,!0):Pr(s,!!l,l?[]:"",!1));return;case"textarea":ue=re=null;for(A in l)if(f=l[A],l.hasOwnProperty(A)&&f!=null&&!u.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:qt(s,r,A,null,u,f)}for(v in u)if(f=u[v],p=l[v],u.hasOwnProperty(v)&&(f!=null||p!=null))switch(v){case"value":re=f;break;case"defaultValue":ue=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==p&&qt(s,r,v,f,u,p)}sd(s,re,ue);return;case"option":for(var Ue in l)re=l[Ue],l.hasOwnProperty(Ue)&&re!=null&&!u.hasOwnProperty(Ue)&&(Ue==="selected"?s.selected=!1:qt(s,r,Ue,null,u,re));for(q in u)re=u[q],ue=l[q],u.hasOwnProperty(q)&&re!==ue&&(re!=null||ue!=null)&&(q==="selected"?s.selected=re&&typeof re!="function"&&typeof re!="symbol":qt(s,r,q,re,u,ue));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var et in l)re=l[et],l.hasOwnProperty(et)&&re!=null&&!u.hasOwnProperty(et)&&qt(s,r,et,null,u,re);for(ne in u)if(re=u[ne],ue=l[ne],u.hasOwnProperty(ne)&&re!==ue&&(re!=null||ue!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(i(137,r));break;default:qt(s,r,ne,re,u,ue)}return;default:if(Ml(r)){for(var Ht in l)re=l[Ht],l.hasOwnProperty(Ht)&&re!==void 0&&!u.hasOwnProperty(Ht)&&Vp(s,r,Ht,void 0,u,re);for(me in u)re=u[me],ue=l[me],!u.hasOwnProperty(me)||re===ue||re===void 0&&ue===void 0||Vp(s,r,me,re,u,ue);return}}for(var X in l)re=l[X],l.hasOwnProperty(X)&&re!=null&&!u.hasOwnProperty(X)&&qt(s,r,X,null,u,re);for(ye in u)re=u[ye],ue=l[ye],!u.hasOwnProperty(ye)||re===ue||re==null&&ue==null||qt(s,r,ye,re,u,ue)}function vv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function fE(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var f=l[u],p=f.transferSize,v=f.initiatorType,A=f.duration;if(p&&A&&vv(v)){for(v=0,A=f.responseEnd,u+=1;u<l.length;u++){var q=l[u],ne=q.startTime;if(ne>A)break;var me=q.transferSize,ye=q.initiatorType;me&&vv(ye)&&(q=q.responseEnd,v+=me*(q<A?1:(A-ne)/(q-ne)))}if(--u,r+=8*(p+v)/(f.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Lp=null,Up=null;function rh(s){return s.nodeType===9?s:s.ownerDocument}function wv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Nv(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function Bp(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var zp=null;function mE(){var s=window.event;return s&&s.type==="popstate"?s===zp?!1:(zp=s,!0):(zp=null,!1)}var _v=typeof setTimeout=="function"?setTimeout:void 0,pE=typeof clearTimeout=="function"?clearTimeout:void 0,jv=typeof Promise=="function"?Promise:void 0,xE=typeof queueMicrotask=="function"?queueMicrotask:typeof jv<"u"?function(s){return jv.resolve(null).then(s).catch(gE)}:_v;function gE(s){setTimeout(function(){throw s})}function ii(s){return s==="head"}function Sv(s,r){var l=r,u=0;do{var f=l.nextSibling;if(s.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"||l==="/&"){if(u===0){s.removeChild(f),xo(r);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")Fc(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,Fc(l);for(var p=l.firstChild;p;){var v=p.nextSibling,A=p.nodeName;p[Ta]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&p.rel.toLowerCase()==="stylesheet"||l.removeChild(p),p=v}}else l==="body"&&Fc(s.ownerDocument.body);l=f}while(l);xo(r)}function Ev(s,r){var l=s;s=0;do{var u=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=u}while(l)}function Fp(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Fp(l),Rl(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function bE(s,r,l,u){for(;s.nodeType===1;){var f=l;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Ta])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(p=s.getAttribute("rel"),p==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(p!==f.rel||s.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||s.getAttribute("title")!==(f.title==null?null:f.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(p=s.getAttribute("src"),(p!==(f.src==null?null:f.src)||s.getAttribute("type")!==(f.type==null?null:f.type)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&p&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var p=f.name==null?null:""+f.name;if(f.type==="hidden"&&s.getAttribute("name")===p)return s}else return s;if(s=Jn(s.nextSibling),s===null)break}return null}function yE(s,r,l){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Jn(s.nextSibling),s===null))return null;return s}function Tv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=Jn(s.nextSibling),s===null))return null;return s}function $p(s){return s.data==="$?"||s.data==="$~"}function qp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function vE(s,r){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||l.readyState!=="loading")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function Jn(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var Hp=null;function Av(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(r===0)return Jn(s.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}s=s.nextSibling}return null}function kv(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return s;r--}else l!=="/$"&&l!=="/&"||r++}s=s.previousSibling}return null}function Cv(s,r,l){switch(r=rh(l),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Fc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Rl(s)}var Zn=new Map,Rv=new Set;function ih(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var yr=K.d;K.d={f:wE,r:NE,D:_E,C:jE,L:SE,m:EE,X:AE,S:TE,M:kE};function wE(){var s=yr.f(),r=Xd();return s||r}function NE(s){var r=Fn(s);r!==null&&r.tag===5&&r.type==="form"?Wb(r):yr.r(s)}var fo=typeof document>"u"?null:document;function Iv(s,r,l){var u=fo;if(u&&typeof r=="string"&&r){var f=on(r);f='link[rel="'+s+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),Rv.has(f)||(Rv.add(f),s={rel:s,crossOrigin:l,href:r},u.querySelector(f)===null&&(r=u.createElement("link"),Hs(r,"link",s),Ns(r),u.head.appendChild(r)))}}function _E(s){yr.D(s),Iv("dns-prefetch",s,null)}function jE(s,r){yr.C(s,r),Iv("preconnect",s,r)}function SE(s,r,l){yr.L(s,r,l);var u=fo;if(u&&s&&r){var f='link[rel="preload"][as="'+on(r)+'"]';r==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+on(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+on(l.imageSizes)+'"]')):f+='[href="'+on(s)+'"]';var p=f;switch(r){case"style":p=mo(s);break;case"script":p=po(s)}Zn.has(p)||(s=w({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:s,as:r},l),Zn.set(p,s),u.querySelector(f)!==null||r==="style"&&u.querySelector($c(p))||r==="script"&&u.querySelector(qc(p))||(r=u.createElement("link"),Hs(r,"link",s),Ns(r),u.head.appendChild(r)))}}function EE(s,r){yr.m(s,r);var l=fo;if(l&&s){var u=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+on(u)+'"][href="'+on(s)+'"]',p=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=po(s)}if(!Zn.has(p)&&(s=w({rel:"modulepreload",href:s},r),Zn.set(p,s),l.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(qc(p)))return}u=l.createElement("link"),Hs(u,"link",s),Ns(u),l.head.appendChild(u)}}}function TE(s,r,l){yr.S(s,r,l);var u=fo;if(u&&s){var f=ka(u).hoistableStyles,p=mo(s);r=r||"default";var v=f.get(p);if(!v){var A={loading:0,preload:null};if(v=u.querySelector($c(p)))A.loading=5;else{s=w({rel:"stylesheet",href:s,"data-precedence":r},l),(l=Zn.get(p))&&Gp(s,l);var q=v=u.createElement("link");Ns(q),Hs(q,"link",s),q._p=new Promise(function(ne,me){q.onload=ne,q.onerror=me}),q.addEventListener("load",function(){A.loading|=1}),q.addEventListener("error",function(){A.loading|=2}),A.loading|=4,lh(v,r,u)}v={type:"stylesheet",instance:v,count:1,state:A},f.set(p,v)}}}function AE(s,r){yr.X(s,r);var l=fo;if(l&&s){var u=ka(l).hoistableScripts,f=po(s),p=u.get(f);p||(p=l.querySelector(qc(f)),p||(s=w({src:s,async:!0},r),(r=Zn.get(f))&&Yp(s,r),p=l.createElement("script"),Ns(p),Hs(p,"link",s),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function kE(s,r){yr.M(s,r);var l=fo;if(l&&s){var u=ka(l).hoistableScripts,f=po(s),p=u.get(f);p||(p=l.querySelector(qc(f)),p||(s=w({src:s,async:!0,type:"module"},r),(r=Zn.get(f))&&Yp(s,r),p=l.createElement("script"),Ns(p),Hs(p,"link",s),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function Dv(s,r,l,u){var f=(f=Me.current)?ih(f):null;if(!f)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=mo(l.href),l=ka(f).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=mo(l.href);var p=ka(f).hoistableStyles,v=p.get(s);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(s,v),(p=f.querySelector($c(s)))&&!p._p&&(v.instance=p,v.state.loading=5),Zn.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Zn.set(s,l),p||CE(f,s,l,v.state))),r&&u===null)throw Error(i(528,""));return v}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=po(l),l=ka(f).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function mo(s){return'href="'+on(s)+'"'}function $c(s){return'link[rel="stylesheet"]['+s+"]"}function Mv(s){return w({},s,{"data-precedence":s.precedence,precedence:null})}function CE(s,r,l,u){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=s.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),Hs(r,"link",l),Ns(r),s.head.appendChild(r))}function po(s){return'[src="'+on(s)+'"]'}function qc(s){return"script[async]"+s}function Ov(s,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=s.querySelector('style[data-href~="'+on(l.href)+'"]');if(u)return r.instance=u,Ns(u),u;var f=w({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),Ns(u),Hs(u,"style",f),lh(u,l.precedence,s),r.instance=u;case"stylesheet":f=mo(l.href);var p=s.querySelector($c(f));if(p)return r.state.loading|=4,r.instance=p,Ns(p),p;u=Mv(l),(f=Zn.get(f))&&Gp(u,f),p=(s.ownerDocument||s).createElement("link"),Ns(p);var v=p;return v._p=new Promise(function(A,q){v.onload=A,v.onerror=q}),Hs(p,"link",u),r.state.loading|=4,lh(p,l.precedence,s),r.instance=p;case"script":return p=po(l.src),(f=s.querySelector(qc(p)))?(r.instance=f,Ns(f),f):(u=l,(f=Zn.get(p))&&(u=w({},l),Yp(u,f)),s=s.ownerDocument||s,f=s.createElement("script"),Ns(f),Hs(f,"link",u),s.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,lh(u,l.precedence,s));return r.instance}function lh(s,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,p=f,v=0;v<u.length;v++){var A=u[v];if(A.dataset.precedence===r)p=A;else if(p!==f)break}p?p.parentNode.insertBefore(s,p.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(s,r.firstChild))}function Gp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function Yp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var oh=null;function Pv(s,r,l){if(oh===null){var u=new Map,f=oh=new Map;f.set(l,u)}else f=oh,u=f.get(l),u||(u=new Map,f.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),f=0;f<l.length;f++){var p=l[f];if(!(p[Ta]||p[is]||s==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var v=p.getAttribute(r)||"";v=s+v;var A=u.get(v);A?A.push(p):u.set(v,[p])}}return u}function Vv(s,r,l){s=s.ownerDocument||s,s.head.insertBefore(l,r==="title"?s.querySelector("head > title"):null)}function RE(s,r,l){if(l===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(s=r.disabled,typeof r.precedence=="string"&&s==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Lv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function IE(s,r,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var f=mo(u.href),p=r.querySelector($c(f));if(p){r=p._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=ch.bind(s),r.then(s,s)),l.state.loading|=4,l.instance=p,Ns(p);return}p=r.ownerDocument||r,u=Mv(u),(f=Zn.get(f))&&Gp(u,f),p=p.createElement("link"),Ns(p);var v=p;v._p=new Promise(function(A,q){v.onload=A,v.onerror=q}),Hs(p,"link",u),l.instance=p}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=ch.bind(s),r.addEventListener("load",l),r.addEventListener("error",l))}}var Wp=0;function DE(s,r){return s.stylesheets&&s.count===0&&dh(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var u=setTimeout(function(){if(s.stylesheets&&dh(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4+r);0<s.imgBytes&&Wp===0&&(Wp=62500*fE());var f=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&dh(s,s.stylesheets),s.unsuspend)){var p=s.unsuspend;s.unsuspend=null,p()}},(s.imgBytes>Wp?50:800)+r);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(f)}}:null}function ch(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)dh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var uh=null;function dh(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,uh=new Map,r.forEach(ME,s),uh=null,ch.call(s))}function ME(s,r){if(!(r.state.loading&4)){var l=uh.get(s);if(l)var u=l.get(null);else{l=new Map,uh.set(s,l);for(var f=s.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<f.length;p++){var v=f[p];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(l.set(v.dataset.precedence,v),u=v)}u&&l.set(null,u)}f=r.instance,v=f.getAttribute("data-precedence"),p=l.get(v)||u,p===u&&l.set(null,f),l.set(v,f),this.count++,u=ch.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),p?p.parentNode.insertBefore(f,p.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(f,s.firstChild)),r.state.loading|=4}}var Hc={$$typeof:G,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function OE(s,r,l,u,f,p,v,A,q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ze(0),this.hiddenUpdates=Ze(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=p,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function Uv(s,r,l,u,f,p,v,A,q,ne,me,ye){return s=new OE(s,r,l,v,q,ne,me,ye,A),r=1,p===!0&&(r|=24),p=Cn(3,null,null,r),s.current=p,p.stateNode=s,r=Tm(),r.refCount++,s.pooledCache=r,r.refCount++,p.memoizedState={element:u,isDehydrated:l,cache:r},Rm(p),s}function Bv(s){return s?(s=Hl,s):Hl}function zv(s,r,l,u,f,p){f=Bv(f),u.context===null?u.context=f:u.pendingContext=f,u=Qr(r),u.payload={element:l},p=p===void 0?null:p,p!==null&&(u.callback=p),l=Kr(s,u,r),l!==null&&(mn(l,s,r),_c(l,s,r))}function Fv(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<r?l:r}}function Qp(s,r){Fv(s,r),(s=s.alternate)&&Fv(s,r)}function $v(s){if(s.tag===13||s.tag===31){var r=Ki(s,67108864);r!==null&&mn(r,s,67108864),Qp(s,67108864)}}function qv(s){if(s.tag===13||s.tag===31){var r=On();r=ia(r);var l=Ki(s,r);l!==null&&mn(l,s,r),Qp(s,r)}}var hh=!0;function PE(s,r,l,u){var f=O.T;O.T=null;var p=K.p;try{K.p=2,Kp(s,r,l,u)}finally{K.p=p,O.T=f}}function VE(s,r,l,u){var f=O.T;O.T=null;var p=K.p;try{K.p=8,Kp(s,r,l,u)}finally{K.p=p,O.T=f}}function Kp(s,r,l,u){if(hh){var f=Xp(u);if(f===null)Pp(s,r,u,fh,l),Gv(s,u);else if(UE(f,s,r,l,u))u.stopPropagation();else if(Gv(s,u),r&4&&-1<LE.indexOf(s)){for(;f!==null;){var p=Fn(f);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var v=de(p.pendingLanes);if(v!==0){var A=p;for(A.pendingLanes|=2,A.entangledLanes|=2;v;){var q=1<<31-It(v);A.entanglements[1]|=q,v&=~q}Fa(p),(Mt&6)===0&&(Qd=Ve()+500,Uc(0))}}break;case 31:case 13:A=Ki(p,2),A!==null&&mn(A,p,2),Xd(),Qp(p,2)}if(p=Xp(u),p===null&&Pp(s,r,u,fh,l),p===f)break;f=p}f!==null&&u.stopPropagation()}else Pp(s,r,u,null,l)}}function Xp(s){return s=$n(s),Jp(s)}var fh=null;function Jp(s){if(fh=null,s=Aa(s),s!==null){var r=c(s);if(r===null)s=null;else{var l=r.tag;if(l===13){if(s=d(r),s!==null)return s;s=null}else if(l===31){if(s=m(r),s!==null)return s;s=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return fh=s,null}function Hv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(De()){case He:return 2;case Ye:return 8;case Z:case Ce:return 32;case We:return 268435456;default:return 32}default:return 32}}var Zp=!1,li=null,oi=null,ci=null,Gc=new Map,Yc=new Map,ui=[],LE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Gv(s,r){switch(s){case"focusin":case"focusout":li=null;break;case"dragenter":case"dragleave":oi=null;break;case"mouseover":case"mouseout":ci=null;break;case"pointerover":case"pointerout":Gc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yc.delete(r.pointerId)}}function Wc(s,r,l,u,f,p){return s===null||s.nativeEvent!==p?(s={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:p,targetContainers:[f]},r!==null&&(r=Fn(r),r!==null&&$v(r)),s):(s.eventSystemFlags|=u,r=s.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),s)}function UE(s,r,l,u,f){switch(r){case"focusin":return li=Wc(li,s,r,l,u,f),!0;case"dragenter":return oi=Wc(oi,s,r,l,u,f),!0;case"mouseover":return ci=Wc(ci,s,r,l,u,f),!0;case"pointerover":var p=f.pointerId;return Gc.set(p,Wc(Gc.get(p)||null,s,r,l,u,f)),!0;case"gotpointercapture":return p=f.pointerId,Yc.set(p,Wc(Yc.get(p)||null,s,r,l,u,f)),!0}return!1}function Yv(s){var r=Aa(s.target);if(r!==null){var l=c(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){s.blockedOn=r,rs(s.priority,function(){qv(l)});return}}else if(r===31){if(r=m(l),r!==null){s.blockedOn=r,rs(s.priority,function(){qv(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function mh(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var l=Xp(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);lc=u,l.target.dispatchEvent(u),lc=null}else return r=Fn(l),r!==null&&$v(r),s.blockedOn=l,!1;r.shift()}return!0}function Wv(s,r,l){mh(s)&&l.delete(r)}function BE(){Zp=!1,li!==null&&mh(li)&&(li=null),oi!==null&&mh(oi)&&(oi=null),ci!==null&&mh(ci)&&(ci=null),Gc.forEach(Wv),Yc.forEach(Wv)}function ph(s,r){s.blockedOn===r&&(s.blockedOn=null,Zp||(Zp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,BE)))}var xh=null;function Qv(s){xh!==s&&(xh=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){xh===s&&(xh=null);for(var r=0;r<s.length;r+=3){var l=s[r],u=s[r+1],f=s[r+2];if(typeof u!="function"){if(Jp(u||l)===null)continue;break}var p=Fn(l);p!==null&&(s.splice(r,3),r-=3,Xm(p,{pending:!0,data:f,method:l.method,action:u},u,f))}}))}function xo(s){function r(q){return ph(q,s)}li!==null&&ph(li,s),oi!==null&&ph(oi,s),ci!==null&&ph(ci,s),Gc.forEach(r),Yc.forEach(r);for(var l=0;l<ui.length;l++){var u=ui[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<ui.length&&(l=ui[0],l.blockedOn===null);)Yv(l),l.blockedOn===null&&ui.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var f=l[u],p=l[u+1],v=f[ws]||null;if(typeof p=="function")v||Qv(l);else if(v){var A=null;if(p&&p.hasAttribute("formAction")){if(f=p,v=p[ws]||null)A=v.formAction;else if(Jp(f)!==null)continue}else A=v.action;typeof A=="function"?l[u+1]=A:(l.splice(u,3),u-=3),Qv(l)}}}function Kv(){function s(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,f=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function e0(s){this._internalRoot=s}gh.prototype.render=e0.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,u=On();zv(l,u,s,r,null,null)},gh.prototype.unmount=e0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;zv(s.current,2,null,s,null,null),Xd(),r[En]=null}};function gh(s){this._internalRoot=s}gh.prototype.unstable_scheduleHydration=function(s){if(s){var r=tr();s={blockedOn:null,target:s,priority:r};for(var l=0;l<ui.length&&r!==0&&r<ui[l].priority;l++);ui.splice(l,0,s),l===0&&Yv(s)}};var Xv=e.version;if(Xv!=="19.2.4")throw Error(i(527,Xv,"19.2.4"));K.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=g(r),s=s!==null?b(s):null,s=s===null?null:s.stateNode,s};var zE={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bh.isDisabled&&bh.supportsFiber)try{Lt=bh.inject(zE),_t=bh}catch{}}return Kc.createRoot=function(s,r){if(!o(s))throw Error(i(299));var l=!1,u="",f=ay,p=ry,v=iy;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(p=r.onCaughtError),r.onRecoverableError!==void 0&&(v=r.onRecoverableError)),r=Uv(s,1,!1,null,null,l,u,null,f,p,v,Kv),s[En]=r.current,Op(s),new e0(r)},Kc.hydrateRoot=function(s,r,l){if(!o(s))throw Error(i(299));var u=!1,f="",p=ay,v=ry,A=iy,q=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(p=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(A=l.onRecoverableError),l.formState!==void 0&&(q=l.formState)),r=Uv(s,1,!0,r,l??null,u,f,q,p,v,A,Kv),r.context=Bv(null),l=r.current,u=On(),u=ia(u),f=Qr(u),f.callback=null,Kr(l,f,u),l=u,r.current.lanes=l,St(r,l),Fa(r),s[En]=r.current,Op(s),new gh(r)},Kc.version="19.2.4",Kc}var lw;function XE(){if(lw)return n0.exports;lw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),n0.exports=KE(),n0.exports}var JE=XE();const ZE=xx(JE);var ow="popstate";function eT(n={}){function e(o,c){let{pathname:d="/",search:m="",hash:x=""}=Sl(o.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),I0("",{pathname:d,search:m,hash:x},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function t(o,c){let d=o.document.querySelector("base"),m="";if(d&&d.getAttribute("href")){let x=o.location.href,g=x.indexOf("#");m=g===-1?x:x.slice(0,g)}return m+"#"+(typeof c=="string"?c:wu(c))}function i(o,c){Un(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(c)})`)}return sT(e,t,i,n)}function cs(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Un(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tT(){return Math.random().toString(36).substring(2,10)}function cw(n,e){return{usr:n.state,key:n.key,idx:e}}function I0(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Sl(e):e,state:t,key:e&&e.key||i||tT()}}function wu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Sl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function sT(n,e,t,i={}){let{window:o=document.defaultView,v5Compat:c=!1}=i,d=o.history,m="POP",x=null,g=b();g==null&&(g=0,d.replaceState({...d.state,idx:g},""));function b(){return(d.state||{idx:null}).idx}function w(){m="POP";let L=b(),z=L==null?null:L-g;g=L,x&&x({action:m,location:V.location,delta:z})}function j(L,z){m="PUSH";let Q=I0(V.location,L,z);t&&t(Q,L),g=b()+1;let G=cw(Q,g),ie=V.createHref(Q);try{d.pushState(G,"",ie)}catch(he){if(he instanceof DOMException&&he.name==="DataCloneError")throw he;o.location.assign(ie)}c&&x&&x({action:m,location:V.location,delta:1})}function R(L,z){m="REPLACE";let Q=I0(V.location,L,z);t&&t(Q,L),g=b();let G=cw(Q,g),ie=V.createHref(Q);d.replaceState(G,"",ie),c&&x&&x({action:m,location:V.location,delta:0})}function U(L){return nT(L)}let V={get action(){return m},get location(){return n(o,d)},listen(L){if(x)throw new Error("A history only accepts one active listener");return o.addEventListener(ow,w),x=L,()=>{o.removeEventListener(ow,w),x=null}},createHref(L){return e(o,L)},createURL:U,encodeLocation(L){let z=U(L);return{pathname:z.pathname,search:z.search,hash:z.hash}},push:j,replace:R,go(L){return d.go(L)}};return V}function nT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),cs(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:wu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function IN(n,e,t="/"){return aT(n,e,t,!1)}function aT(n,e,t,i){let o=typeof e=="string"?Sl(e):e,c=Tr(o.pathname||"/",t);if(c==null)return null;let d=DN(n);rT(d);let m=null;for(let x=0;m==null&&x<d.length;++x){let g=xT(c);m=mT(d[x],g,i)}return m}function DN(n,e=[],t=[],i="",o=!1){let c=(d,m,x=o,g)=>{let b={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:m,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&x)return;cs(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let w=jr([i,b.relativePath]),j=t.concat(b);d.children&&d.children.length>0&&(cs(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),DN(d.children,e,j,w,x)),!(d.path==null&&!d.index)&&e.push({path:w,score:hT(w,d.index),routesMeta:j})};return n.forEach((d,m)=>{if(d.path===""||!d.path?.includes("?"))c(d,m);else for(let x of MN(d.path))c(d,m,!0,x)}),e}function MN(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,o=t.endsWith("?"),c=t.replace(/\?$/,"");if(i.length===0)return o?[c,""]:[c];let d=MN(i.join("/")),m=[];return m.push(...d.map(x=>x===""?c:[c,x].join("/"))),o&&m.push(...d),m.map(x=>n.startsWith("/")&&x===""?"/":x)}function rT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:fT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var iT=/^:[\w-]+$/,lT=3,oT=2,cT=1,uT=10,dT=-2,uw=n=>n==="*";function hT(n,e){let t=n.split("/"),i=t.length;return t.some(uw)&&(i+=dT),e&&(i+=oT),t.filter(o=>!uw(o)).reduce((o,c)=>o+(iT.test(c)?lT:c===""?cT:uT),i)}function fT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,o)=>i===e[o])?n[n.length-1]-e[e.length-1]:0}function mT(n,e,t=!1){let{routesMeta:i}=n,o={},c="/",d=[];for(let m=0;m<i.length;++m){let x=i[m],g=m===i.length-1,b=c==="/"?e:e.slice(c.length)||"/",w=Zh({path:x.relativePath,caseSensitive:x.caseSensitive,end:g},b),j=x.route;if(!w&&g&&t&&!i[i.length-1].route.index&&(w=Zh({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},b)),!w)return null;Object.assign(o,w.params),d.push({params:o,pathname:jr([c,w.pathname]),pathnameBase:vT(jr([c,w.pathnameBase])),route:j}),w.pathnameBase!=="/"&&(c=jr([c,w.pathnameBase]))}return d}function Zh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=pT(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),m=o.slice(1);return{params:i.reduce((g,{paramName:b,isOptional:w},j)=>{if(b==="*"){let U=m[j]||"";d=c.slice(0,c.length-U.length).replace(/(.)\/+$/,"$1")}const R=m[j];return w&&!R?g[b]=void 0:g[b]=(R||"").replace(/%2F/g,"/"),g},{}),pathname:c,pathnameBase:d,pattern:n}}function pT(n,e=!1,t=!0){Un(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,m,x)=>(i.push({paramName:m,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function xT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Un(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Tr(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var gT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function bT(n,e="/"){let{pathname:t,search:i="",hash:o=""}=typeof n=="string"?Sl(n):n,c;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?c=dw(t.substring(1),"/"):c=dw(t,e)):c=e,{pathname:c,search:wT(i),hash:NT(o)}}function dw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function l0(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function yT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function bx(n){let e=yT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function yx(n,e,t,i=!1){let o;typeof n=="string"?o=Sl(n):(o={...n},cs(!o.pathname||!o.pathname.includes("?"),l0("?","pathname","search",o)),cs(!o.pathname||!o.pathname.includes("#"),l0("#","pathname","hash",o)),cs(!o.search||!o.search.includes("#"),l0("#","search","hash",o)));let c=n===""||o.pathname==="",d=c?"/":o.pathname,m;if(d==null)m=t;else{let w=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),w-=1;o.pathname=j.join("/")}m=w>=0?e[w]:"/"}let x=bT(o,m),g=d&&d!=="/"&&d.endsWith("/"),b=(c||d===".")&&t.endsWith("/");return!x.pathname.endsWith("/")&&(g||b)&&(x.pathname+="/"),x}var jr=n=>n.join("/").replace(/\/\/+/g,"/"),vT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),wT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,NT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,_T=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function jT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function ST(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var ON=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function PN(n,e){let t=n;if(typeof t!="string"||!gT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,o=!1;if(ON)try{let c=new URL(window.location.href),d=t.startsWith("//")?new URL(c.protocol+t):new URL(t),m=Tr(d.pathname,e);d.origin===c.origin&&m!=null?t=m+d.search+d.hash:o=!0}catch{Un(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:o,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var VN=["POST","PUT","PATCH","DELETE"];new Set(VN);var ET=["GET",...VN];new Set(ET);var $o=_.createContext(null);$o.displayName="DataRouter";var Cf=_.createContext(null);Cf.displayName="DataRouterState";var TT=_.createContext(!1),LN=_.createContext({isTransitioning:!1});LN.displayName="ViewTransition";var AT=_.createContext(new Map);AT.displayName="Fetchers";var kT=_.createContext(null);kT.displayName="Await";var Bn=_.createContext(null);Bn.displayName="Navigation";var Ou=_.createContext(null);Ou.displayName="Location";var ja=_.createContext({outlet:null,matches:[],isDataRoute:!1});ja.displayName="Route";var vx=_.createContext(null);vx.displayName="RouteError";var UN="REACT_ROUTER_ERROR",CT="REDIRECT",RT="ROUTE_ERROR_RESPONSE";function IT(n){if(n.startsWith(`${UN}:${CT}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function DT(n){if(n.startsWith(`${UN}:${RT}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new _T(e.status,e.statusText,e.data)}catch{}}function MT(n,{relative:e}={}){cs(qo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=_.useContext(Bn),{hash:o,pathname:c,search:d}=Pu(n,{relative:e}),m=c;return t!=="/"&&(m=c==="/"?t:jr([t,c])),i.createHref({pathname:m,search:d,hash:o})}function qo(){return _.useContext(Ou)!=null}function Mr(){return cs(qo(),"useLocation() may be used only in the context of a <Router> component."),_.useContext(Ou).location}var BN="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function zN(n){_.useContext(Bn).static||_.useLayoutEffect(n)}function Di(){let{isDataRoute:n}=_.useContext(ja);return n?YT():OT()}function OT(){cs(qo(),"useNavigate() may be used only in the context of a <Router> component.");let n=_.useContext($o),{basename:e,navigator:t}=_.useContext(Bn),{matches:i}=_.useContext(ja),{pathname:o}=Mr(),c=JSON.stringify(bx(i)),d=_.useRef(!1);return zN(()=>{d.current=!0}),_.useCallback((x,g={})=>{if(Un(d.current,BN),!d.current)return;if(typeof x=="number"){t.go(x);return}let b=yx(x,JSON.parse(c),o,g.relative==="path");n==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:jr([e,b.pathname])),(g.replace?t.replace:t.push)(b,g.state,g)},[e,t,c,o,n])}_.createContext(null);function Ho(){let{matches:n}=_.useContext(ja),e=n[n.length-1];return e?e.params:{}}function Pu(n,{relative:e}={}){let{matches:t}=_.useContext(ja),{pathname:i}=Mr(),o=JSON.stringify(bx(t));return _.useMemo(()=>yx(n,JSON.parse(o),i,e==="path"),[n,o,i,e])}function PT(n,e){return FN(n,e)}function FN(n,e,t,i,o){cs(qo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=_.useContext(Bn),{matches:d}=_.useContext(ja),m=d[d.length-1],x=m?m.params:{},g=m?m.pathname:"/",b=m?m.pathnameBase:"/",w=m&&m.route;{let Q=w&&w.path||"";qN(g,!w||Q.endsWith("*")||Q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${Q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Q}"> to <Route path="${Q==="/"?"*":`${Q}/*`}">.`)}let j=Mr(),R;if(e){let Q=typeof e=="string"?Sl(e):e;cs(b==="/"||Q.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${Q.pathname}" was given in the \`location\` prop.`),R=Q}else R=j;let U=R.pathname||"/",V=U;if(b!=="/"){let Q=b.replace(/^\//,"").split("/");V="/"+U.replace(/^\//,"").split("/").slice(Q.length).join("/")}let L=IN(n,{pathname:V});Un(w||L!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),Un(L==null||L[L.length-1].route.element!==void 0||L[L.length-1].route.Component!==void 0||L[L.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let z=zT(L&&L.map(Q=>Object.assign({},Q,{params:Object.assign({},x,Q.params),pathname:jr([b,c.encodeLocation?c.encodeLocation(Q.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Q.pathname]),pathnameBase:Q.pathnameBase==="/"?b:jr([b,c.encodeLocation?c.encodeLocation(Q.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Q.pathnameBase])})),d,t,i,o);return e&&z?_.createElement(Ou.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...R},navigationType:"POP"}},z):z}function VT(){let n=GT(),e=jT(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},c={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=_.createElement(_.Fragment,null,_.createElement("p",null," Hey developer "),_.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",_.createElement("code",{style:c},"ErrorBoundary")," or"," ",_.createElement("code",{style:c},"errorElement")," prop on your route.")),_.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),t?_.createElement("pre",{style:o},t):null,d)}var LT=_.createElement(VT,null),$N=class extends _.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=DT(n.digest);t&&(n=t)}let e=n!==void 0?_.createElement(ja.Provider,{value:this.props.routeContext},_.createElement(vx.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?_.createElement(UT,{error:n},e):e}};$N.contextType=TT;var o0=new WeakMap;function UT({children:n,error:e}){let{basename:t}=_.useContext(Bn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=IT(e.digest);if(i){let o=o0.get(e);if(o)throw o;let c=PN(i.location,t);if(ON&&!o0.get(e))if(c.isExternal||i.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:i.replace}));throw o0.set(e,d),d}return _.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return n}function BT({routeContext:n,match:e,children:t}){let i=_.useContext($o);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),_.createElement(ja.Provider,{value:n},t)}function zT(n,e=[],t=null,i=null,o=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,d=t?.errors;if(d!=null){let b=c.findIndex(w=>w.route.id&&d?.[w.route.id]!==void 0);cs(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,b+1))}let m=!1,x=-1;if(t)for(let b=0;b<c.length;b++){let w=c[b];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(x=b),w.route.id){let{loaderData:j,errors:R}=t,U=w.route.loader&&!j.hasOwnProperty(w.route.id)&&(!R||R[w.route.id]===void 0);if(w.route.lazy||U){m=!0,x>=0?c=c.slice(0,x+1):c=[c[0]];break}}}let g=t&&i?(b,w)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:ST(t.matches),errorInfo:w})}:void 0;return c.reduceRight((b,w,j)=>{let R,U=!1,V=null,L=null;t&&(R=d&&w.route.id?d[w.route.id]:void 0,V=w.route.errorElement||LT,m&&(x<0&&j===0?(qN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),U=!0,L=null):x===j&&(U=!0,L=w.route.hydrateFallbackElement||null)));let z=e.concat(c.slice(0,j+1)),Q=()=>{let G;return R?G=V:U?G=L:w.route.Component?G=_.createElement(w.route.Component,null):w.route.element?G=w.route.element:G=b,_.createElement(BT,{match:w,routeContext:{outlet:b,matches:z,isDataRoute:t!=null},children:G})};return t&&(w.route.ErrorBoundary||w.route.errorElement||j===0)?_.createElement($N,{location:t.location,revalidation:t.revalidation,component:V,error:R,children:Q(),routeContext:{outlet:null,matches:z,isDataRoute:!0},onError:g}):Q()},null)}function wx(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function FT(n){let e=_.useContext($o);return cs(e,wx(n)),e}function $T(n){let e=_.useContext(Cf);return cs(e,wx(n)),e}function qT(n){let e=_.useContext(ja);return cs(e,wx(n)),e}function Nx(n){let e=qT(n),t=e.matches[e.matches.length-1];return cs(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function HT(){return Nx("useRouteId")}function GT(){let n=_.useContext(vx),e=$T("useRouteError"),t=Nx("useRouteError");return n!==void 0?n:e.errors?.[t]}function YT(){let{router:n}=FT("useNavigate"),e=Nx("useNavigate"),t=_.useRef(!1);return zN(()=>{t.current=!0}),_.useCallback(async(o,c={})=>{Un(t.current,BN),t.current&&(typeof o=="number"?await n.navigate(o):await n.navigate(o,{fromRouteId:e,...c}))},[n,e])}var hw={};function qN(n,e,t){!e&&!hw[n]&&(hw[n]=!0,Un(!1,t))}_.memo(WT);function WT({routes:n,future:e,state:t,onError:i}){return FN(n,void 0,t,i,e)}function QT({to:n,replace:e,state:t,relative:i}){cs(qo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=_.useContext(Bn);Un(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=_.useContext(ja),{pathname:d}=Mr(),m=Di(),x=yx(n,bx(c),d,i==="path"),g=JSON.stringify(x);return _.useEffect(()=>{m(JSON.parse(g),{replace:e,state:t,relative:i})},[m,g,i,e,t]),null}function ea(n){cs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function KT({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:o,static:c=!1,unstable_useTransitions:d}){cs(!qo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let m=n.replace(/^\/*/,"/"),x=_.useMemo(()=>({basename:m,navigator:o,static:c,unstable_useTransitions:d,future:{}}),[m,o,c,d]);typeof t=="string"&&(t=Sl(t));let{pathname:g="/",search:b="",hash:w="",state:j=null,key:R="default"}=t,U=_.useMemo(()=>{let V=Tr(g,m);return V==null?null:{location:{pathname:V,search:b,hash:w,state:j,key:R},navigationType:i}},[m,g,b,w,j,R,i]);return Un(U!=null,`<Router basename="${m}"> is not able to match the URL "${g}${b}${w}" because it does not start with the basename, so the <Router> won't render anything.`),U==null?null:_.createElement(Bn.Provider,{value:x},_.createElement(Ou.Provider,{children:e,value:U}))}function XT({children:n,location:e}){return PT(D0(n),e)}function D0(n,e=[]){let t=[];return _.Children.forEach(n,(i,o)=>{if(!_.isValidElement(i))return;let c=[...e,o];if(i.type===_.Fragment){t.push.apply(t,D0(i.props.children,c));return}cs(i.type===ea,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),cs(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||c.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=D0(i.props.children,c)),t.push(d)}),t}var Mh="get",Oh="application/x-www-form-urlencoded";function Rf(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function JT(n){return Rf(n)&&n.tagName.toLowerCase()==="button"}function ZT(n){return Rf(n)&&n.tagName.toLowerCase()==="form"}function e5(n){return Rf(n)&&n.tagName.toLowerCase()==="input"}function t5(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function s5(n,e){return n.button===0&&(!e||e==="_self")&&!t5(n)}function M0(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(o=>[t,o]):[[t,i]])},[]))}function n5(n,e){let t=M0(n);return e&&e.forEach((i,o)=>{t.has(o)||e.getAll(o).forEach(c=>{t.append(o,c)})}),t}var yh=null;function a5(){if(yh===null)try{new FormData(document.createElement("form"),0),yh=!1}catch{yh=!0}return yh}var r5=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function c0(n){return n!=null&&!r5.has(n)?(Un(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Oh}"`),null):n}function i5(n,e){let t,i,o,c,d;if(ZT(n)){let m=n.getAttribute("action");i=m?Tr(m,e):null,t=n.getAttribute("method")||Mh,o=c0(n.getAttribute("enctype"))||Oh,c=new FormData(n)}else if(JT(n)||e5(n)&&(n.type==="submit"||n.type==="image")){let m=n.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let x=n.getAttribute("formaction")||m.getAttribute("action");if(i=x?Tr(x,e):null,t=n.getAttribute("formmethod")||m.getAttribute("method")||Mh,o=c0(n.getAttribute("formenctype"))||c0(m.getAttribute("enctype"))||Oh,c=new FormData(m,n),!a5()){let{name:g,type:b,value:w}=n;if(b==="image"){let j=g?`${g}.`:"";c.append(`${j}x`,"0"),c.append(`${j}y`,"0")}else g&&c.append(g,w)}}else{if(Rf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Mh,i=null,o=Oh,d=n}return c&&o==="text/plain"&&(d=c,c=void 0),{action:i,method:t.toLowerCase(),encType:o,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function _x(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function l5(n,e,t,i){let o=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${i}`:o.pathname=`${o.pathname}.${i}`:o.pathname==="/"?o.pathname=`_root.${i}`:e&&Tr(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${i}`,o}async function o5(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function c5(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function u5(n,e,t){let i=await Promise.all(n.map(async o=>{let c=e.routes[o.route.id];if(c){let d=await o5(c,t);return d.links?d.links():[]}return[]}));return m5(i.flat(1).filter(c5).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function fw(n,e,t,i,o,c){let d=(x,g)=>t[g]?x.route.id!==t[g].route.id:!0,m=(x,g)=>t[g].pathname!==x.pathname||t[g].route.path?.endsWith("*")&&t[g].params["*"]!==x.params["*"];return c==="assets"?e.filter((x,g)=>d(x,g)||m(x,g)):c==="data"?e.filter((x,g)=>{let b=i.routes[x.route.id];if(!b||!b.hasLoader)return!1;if(d(x,g)||m(x,g))return!0;if(x.route.shouldRevalidate){let w=x.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:x.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function d5(n,e,{includeHydrateFallback:t}={}){return h5(n.map(i=>{let o=e.routes[i.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function h5(n){return[...new Set(n)]}function f5(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function m5(n,e){let t=new Set;return new Set(e),n.reduce((i,o)=>{let c=JSON.stringify(f5(o));return t.has(c)||(t.add(c),i.push({key:c,link:o})),i},[])}function HN(){let n=_.useContext($o);return _x(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function p5(){let n=_.useContext(Cf);return _x(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var jx=_.createContext(void 0);jx.displayName="FrameworkContext";function GN(){let n=_.useContext(jx);return _x(n,"You must render this element inside a <HydratedRouter> element"),n}function x5(n,e){let t=_.useContext(jx),[i,o]=_.useState(!1),[c,d]=_.useState(!1),{onFocus:m,onBlur:x,onMouseEnter:g,onMouseLeave:b,onTouchStart:w}=e,j=_.useRef(null);_.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let V=z=>{z.forEach(Q=>{d(Q.isIntersecting)})},L=new IntersectionObserver(V,{threshold:.5});return j.current&&L.observe(j.current),()=>{L.disconnect()}}},[n]),_.useEffect(()=>{if(i){let V=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(V)}}},[i]);let R=()=>{o(!0)},U=()=>{o(!1),d(!1)};return t?n!=="intent"?[c,j,{}]:[c,j,{onFocus:Xc(m,R),onBlur:Xc(x,U),onMouseEnter:Xc(g,R),onMouseLeave:Xc(b,U),onTouchStart:Xc(w,R)}]:[!1,j,{}]}function Xc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function g5({page:n,...e}){let{router:t}=HN(),i=_.useMemo(()=>IN(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?_.createElement(y5,{page:n,matches:i,...e}):null}function b5(n){let{manifest:e,routeModules:t}=GN(),[i,o]=_.useState([]);return _.useEffect(()=>{let c=!1;return u5(n,e,t).then(d=>{c||o(d)}),()=>{c=!0}},[n,e,t]),i}function y5({page:n,matches:e,...t}){let i=Mr(),{future:o,manifest:c,routeModules:d}=GN(),{basename:m}=HN(),{loaderData:x,matches:g}=p5(),b=_.useMemo(()=>fw(n,e,g,c,i,"data"),[n,e,g,c,i]),w=_.useMemo(()=>fw(n,e,g,c,i,"assets"),[n,e,g,c,i]),j=_.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let V=new Set,L=!1;if(e.forEach(Q=>{let G=c.routes[Q.route.id];!G||!G.hasLoader||(!b.some(ie=>ie.route.id===Q.route.id)&&Q.route.id in x&&d[Q.route.id]?.shouldRevalidate||G.hasClientLoader?L=!0:V.add(Q.route.id))}),V.size===0)return[];let z=l5(n,m,o.unstable_trailingSlashAwareDataRequests,"data");return L&&V.size>0&&z.searchParams.set("_routes",e.filter(Q=>V.has(Q.route.id)).map(Q=>Q.route.id).join(",")),[z.pathname+z.search]},[m,o.unstable_trailingSlashAwareDataRequests,x,i,c,b,e,n,d]),R=_.useMemo(()=>d5(w,c),[w,c]),U=b5(w);return _.createElement(_.Fragment,null,j.map(V=>_.createElement("link",{key:V,rel:"prefetch",as:"fetch",href:V,...t})),R.map(V=>_.createElement("link",{key:V,rel:"modulepreload",href:V,...t})),U.map(({key:V,link:L})=>_.createElement("link",{key:V,nonce:t.nonce,...L,crossOrigin:L.crossOrigin??t.crossOrigin})))}function v5(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var w5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{w5&&(window.__reactRouterVersion="7.13.0")}catch{}function N5({basename:n,children:e,unstable_useTransitions:t,window:i}){let o=_.useRef();o.current==null&&(o.current=eT({window:i,v5Compat:!0}));let c=o.current,[d,m]=_.useState({action:c.action,location:c.location}),x=_.useCallback(g=>{t===!1?m(g):_.startTransition(()=>m(g))},[t]);return _.useLayoutEffect(()=>c.listen(x),[c,x]),_.createElement(KT,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:c,unstable_useTransitions:t})}var YN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,at=_.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:o,reloadDocument:c,replace:d,state:m,target:x,to:g,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:j,...R},U){let{basename:V,unstable_useTransitions:L}=_.useContext(Bn),z=typeof g=="string"&&YN.test(g),Q=PN(g,V);g=Q.to;let G=MT(g,{relative:o}),[ie,he,W]=x5(i,R),T=E5(g,{replace:d,state:m,target:x,preventScrollReset:b,relative:o,viewTransition:w,unstable_defaultShouldRevalidate:j,unstable_useTransitions:L});function E(I){e&&e(I),I.defaultPrevented||T(I)}let S=_.createElement("a",{...R,...W,href:Q.absoluteURL||G,onClick:Q.isExternal||c?e:E,ref:v5(U,he),target:x,"data-discover":!z&&t==="render"?"true":void 0});return ie&&!z?_.createElement(_.Fragment,null,S,_.createElement(g5,{page:G})):S});at.displayName="Link";var _5=_.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:o=!1,style:c,to:d,viewTransition:m,children:x,...g},b){let w=Pu(d,{relative:g.relative}),j=Mr(),R=_.useContext(Cf),{navigator:U,basename:V}=_.useContext(Bn),L=R!=null&&R5(w)&&m===!0,z=U.encodeLocation?U.encodeLocation(w).pathname:w.pathname,Q=j.pathname,G=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;t||(Q=Q.toLowerCase(),G=G?G.toLowerCase():null,z=z.toLowerCase()),G&&V&&(G=Tr(G,V)||G);const ie=z!=="/"&&z.endsWith("/")?z.length-1:z.length;let he=Q===z||!o&&Q.startsWith(z)&&Q.charAt(ie)==="/",W=G!=null&&(G===z||!o&&G.startsWith(z)&&G.charAt(z.length)==="/"),T={isActive:he,isPending:W,isTransitioning:L},E=he?e:void 0,S;typeof i=="function"?S=i(T):S=[i,he?"active":null,W?"pending":null,L?"transitioning":null].filter(Boolean).join(" ");let I=typeof c=="function"?c(T):c;return _.createElement(at,{...g,"aria-current":E,className:S,ref:b,style:I,to:d,viewTransition:m},typeof x=="function"?x(T):x)});_5.displayName="NavLink";var j5=_.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:o,state:c,method:d=Mh,action:m,onSubmit:x,relative:g,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:j,...R},U)=>{let{unstable_useTransitions:V}=_.useContext(Bn),L=k5(),z=C5(m,{relative:g}),Q=d.toLowerCase()==="get"?"get":"post",G=typeof m=="string"&&YN.test(m),ie=he=>{if(x&&x(he),he.defaultPrevented)return;he.preventDefault();let W=he.nativeEvent.submitter,T=W?.getAttribute("formmethod")||d,E=()=>L(W||he.currentTarget,{fetcherKey:e,method:T,navigate:t,replace:o,state:c,relative:g,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:j});V&&t!==!1?_.startTransition(()=>E()):E()};return _.createElement("form",{ref:U,method:Q,action:z,onSubmit:i?x:ie,...R,"data-discover":!G&&n==="render"?"true":void 0})});j5.displayName="Form";function S5(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function WN(n){let e=_.useContext($o);return cs(e,S5(n)),e}function E5(n,{target:e,replace:t,state:i,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:m,unstable_useTransitions:x}={}){let g=Di(),b=Mr(),w=Pu(n,{relative:c});return _.useCallback(j=>{if(s5(j,e)){j.preventDefault();let R=t!==void 0?t:wu(b)===wu(w),U=()=>g(n,{replace:R,state:i,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:m});x?_.startTransition(()=>U()):U()}},[b,g,w,t,i,e,n,o,c,d,m,x])}function QN(n){Un(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=_.useRef(M0(n)),t=_.useRef(!1),i=Mr(),o=_.useMemo(()=>n5(i.search,t.current?null:e.current),[i.search]),c=Di(),d=_.useCallback((m,x)=>{const g=M0(typeof m=="function"?m(new URLSearchParams(o)):m);t.current=!0,c("?"+g,x)},[c,o]);return[o,d]}var T5=0,A5=()=>`__${String(++T5)}__`;function k5(){let{router:n}=WN("useSubmit"),{basename:e}=_.useContext(Bn),t=HT(),i=n.fetch,o=n.navigate;return _.useCallback(async(c,d={})=>{let{action:m,method:x,encType:g,formData:b,body:w}=i5(c,e);if(d.navigate===!1){let j=d.fetcherKey||A5();await i(j,t,d.action||m,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:w,formMethod:d.method||x,formEncType:d.encType||g,flushSync:d.flushSync})}else await o(d.action||m,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:w,formMethod:d.method||x,formEncType:d.encType||g,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,o,e,t])}function C5(n,{relative:e}={}){let{basename:t}=_.useContext(Bn),i=_.useContext(ja);cs(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),c={...Pu(n||".",{relative:e})},d=Mr();if(n==null){c.search=d.search;let m=new URLSearchParams(c.search),x=m.getAll("index");if(x.some(b=>b==="")){m.delete("index"),x.filter(w=>w).forEach(w=>m.append("index",w));let b=m.toString();c.search=b?`?${b}`:""}}return(!n||n===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(c.pathname=c.pathname==="/"?t:jr([t,c.pathname])),wu(c)}function R5(n,{relative:e}={}){let t=_.useContext(LN);cs(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=WN("useViewTransitionState"),o=Pu(n,{relative:e});if(!t.isTransitioning)return!1;let c=Tr(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=Tr(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Zh(o.pathname,d)!=null||Zh(o.pathname,c)!=null}const I5=()=>{};var mw={};const KN=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},D5=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[i++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],m=n[t++],x=((o&7)<<18|(c&63)<<12|(d&63)<<6|m&63)-65536;e[i++]=String.fromCharCode(55296+(x>>10)),e[i++]=String.fromCharCode(56320+(x&1023))}else{const c=n[t++],d=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},XN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,m=d?n[o+1]:0,x=o+2<n.length,g=x?n[o+2]:0,b=c>>2,w=(c&3)<<4|m>>4;let j=(m&15)<<2|g>>6,R=g&63;x||(R=64,d||(j=64)),i.push(t[b],t[w],t[j],t[R])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(KN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):D5(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],m=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const w=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||m==null||g==null||w==null)throw new M5;const j=c<<2|m>>4;if(i.push(j),g!==64){const R=m<<4&240|g>>2;if(i.push(R),w!==64){const U=g<<6&192|w;i.push(U)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class M5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const O5=function(n){const e=KN(n);return XN.encodeByteArray(e,!0)},ef=function(n){return O5(n).replace(/\./g,"")},JN=function(n){try{return XN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function P5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const V5=()=>P5().__FIREBASE_DEFAULTS__,L5=()=>{if(typeof process>"u"||typeof mw>"u")return;const n=mw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},U5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&JN(n[1]);return e&&JSON.parse(e)},If=()=>{try{return I5()||V5()||L5()||U5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ZN=n=>If()?.emulatorHosts?.[n],Sx=n=>{const e=ZN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},e_=()=>If()?.config,t_=n=>If()?.[`_${n}`];class B5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function er(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Df(n){return(await fetch(n,{credentials:"include"})).ok}function s_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}},...n};return[ef(JSON.stringify(t)),ef(JSON.stringify(d)),""].join(".")}const hu={};function z5(){const n={prod:[],emulator:[]};for(const e of Object.keys(hu))hu[e]?n.emulator.push(e):n.prod.push(e);return n}function F5(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let pw=!1;function Mf(n,e){if(typeof window>"u"||typeof document>"u"||!er(window.location.host)||hu[n]===e||hu[n]||pw)return;hu[n]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",c=z5().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function m(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function x(j,R){j.setAttribute("width","24"),j.setAttribute("id",R),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function g(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{pw=!0,d()},j}function b(j,R){j.setAttribute("id",R),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function w(){const j=F5(i),R=t("text"),U=document.getElementById(R)||document.createElement("span"),V=t("learnmore"),L=document.getElementById(V)||document.createElement("a"),z=t("preprendIcon"),Q=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const G=j.element;m(G),b(L,V);const ie=g();x(Q,z),G.append(Q,U,L,ie),document.body.appendChild(G)}c?(U.innerText="Preview backend disconnected.",Q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,U.innerText="Preview backend running in this workspace."),U.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}function sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sn())}function q5(){const n=If()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function H5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function G5(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Y5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function W5(){const n=sn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Q5(){return!q5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function K5(){try{return typeof indexedDB=="object"}catch{return!1}}function X5(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}const J5="FirebaseError";class Sa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=J5,Object.setPrototypeOf(this,Sa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Vu.prototype.create)}}class Vu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?Z5(c,i):"Error",m=`${this.serviceName}: ${d} (${o}).`;return new Sa(o,m,i)}}function Z5(n,e){return n.replace(eA,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const eA=/\{\$([^}]+)}/g;function tA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function bl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const c=n[o],d=e[o];if(xw(c)&&xw(d)){if(!bl(c,d))return!1}else if(c!==d)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function xw(n){return n!==null&&typeof n=="object"}function Lu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ru(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,c]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function iu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function sA(n,e){const t=new nA(n,e);return t.subscribe.bind(t)}class nA{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");aA(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=u0),o.error===void 0&&(o.error=u0),o.complete===void 0&&(o.complete=u0);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function aA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function u0(){}function Xt(n){return n&&n._delegate?n._delegate:n}class Ar{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const hl="[DEFAULT]";class rA{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new B5;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lA(e))try{this.getOrInitializeService({instanceIdentifier:hl})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});i.resolve(c)}catch{}}}}clearInstance(e=hl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=hl){return this.instances.has(e)}getOptions(e=hl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[c,d]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(c);i===m&&d.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const c=this.instances.get(i);return c&&e(c,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:iA(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=hl){return this.component?this.component.multipleInstances?e:hl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iA(n){return n===hl?void 0:n}function lA(n){return n.instantiationMode==="EAGER"}class oA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new rA(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var yt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yt||(yt={}));const cA={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},uA=yt.INFO,dA={[yt.DEBUG]:"log",[yt.VERBOSE]:"log",[yt.INFO]:"info",[yt.WARN]:"warn",[yt.ERROR]:"error"},hA=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=dA[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ex{constructor(e){this.name=e,this._logLevel=uA,this._logHandler=hA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yt.DEBUG,...e),this._logHandler(this,yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yt.VERBOSE,...e),this._logHandler(this,yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yt.INFO,...e),this._logHandler(this,yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yt.WARN,...e),this._logHandler(this,yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yt.ERROR,...e),this._logHandler(this,yt.ERROR,...e)}}const fA=(n,e)=>e.some(t=>n instanceof t);let gw,bw;function mA(){return gw||(gw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pA(){return bw||(bw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const n_=new WeakMap,O0=new WeakMap,a_=new WeakMap,d0=new WeakMap,Tx=new WeakMap;function xA(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(vi(n.result)),o()},d=()=>{i(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&n_.set(t,n)}).catch(()=>{}),Tx.set(e,n),e}function gA(n){if(O0.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});O0.set(n,e)}let P0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return O0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||a_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return vi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function bA(n){P0=n(P0)}function yA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(h0(this),e,...t);return a_.set(i,e.sort?e.sort():[e]),vi(i)}:pA().includes(n)?function(...e){return n.apply(h0(this),e),vi(n_.get(this))}:function(...e){return vi(n.apply(h0(this),e))}}function vA(n){return typeof n=="function"?yA(n):(n instanceof IDBTransaction&&gA(n),fA(n,mA())?new Proxy(n,P0):n)}function vi(n){if(n instanceof IDBRequest)return xA(n);if(d0.has(n))return d0.get(n);const e=vA(n);return e!==n&&(d0.set(n,e),Tx.set(e,n)),e}const h0=n=>Tx.get(n);function wA(n,e,{blocked:t,upgrade:i,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),m=vi(d);return i&&d.addEventListener("upgradeneeded",x=>{i(vi(d.result),x.oldVersion,x.newVersion,vi(d.transaction),x)}),t&&d.addEventListener("blocked",x=>t(x.oldVersion,x.newVersion,x)),m.then(x=>{c&&x.addEventListener("close",()=>c()),o&&x.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),m}const NA=["get","getKey","getAll","getAllKeys","count"],_A=["put","add","delete","clear"],f0=new Map;function yw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(f0.get(e))return f0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=_A.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||NA.includes(t)))return;const c=async function(d,...m){const x=this.transaction(d,o?"readwrite":"readonly");let g=x.store;return i&&(g=g.index(m.shift())),(await Promise.all([g[t](...m),o&&x.done]))[0]};return f0.set(e,c),c}bA(n=>({...n,get:(e,t,i)=>yw(e,t)||n.get(e,t,i),has:(e,t)=>!!yw(e,t)||n.has(e,t)}));class jA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(SA(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function SA(n){return n.getComponent()?.type==="VERSION"}const V0="@firebase/app",vw="0.14.7";const kr=new Ex("@firebase/app"),EA="@firebase/app-compat",TA="@firebase/analytics-compat",AA="@firebase/analytics",kA="@firebase/app-check-compat",CA="@firebase/app-check",RA="@firebase/auth",IA="@firebase/auth-compat",DA="@firebase/database",MA="@firebase/data-connect",OA="@firebase/database-compat",PA="@firebase/functions",VA="@firebase/functions-compat",LA="@firebase/installations",UA="@firebase/installations-compat",BA="@firebase/messaging",zA="@firebase/messaging-compat",FA="@firebase/performance",$A="@firebase/performance-compat",qA="@firebase/remote-config",HA="@firebase/remote-config-compat",GA="@firebase/storage",YA="@firebase/storage-compat",WA="@firebase/firestore",QA="@firebase/ai",KA="@firebase/firestore-compat",XA="firebase",JA="12.8.0";const L0="[DEFAULT]",ZA={[V0]:"fire-core",[EA]:"fire-core-compat",[AA]:"fire-analytics",[TA]:"fire-analytics-compat",[CA]:"fire-app-check",[kA]:"fire-app-check-compat",[RA]:"fire-auth",[IA]:"fire-auth-compat",[DA]:"fire-rtdb",[MA]:"fire-data-connect",[OA]:"fire-rtdb-compat",[PA]:"fire-fn",[VA]:"fire-fn-compat",[LA]:"fire-iid",[UA]:"fire-iid-compat",[BA]:"fire-fcm",[zA]:"fire-fcm-compat",[FA]:"fire-perf",[$A]:"fire-perf-compat",[qA]:"fire-rc",[HA]:"fire-rc-compat",[GA]:"fire-gcs",[YA]:"fire-gcs-compat",[WA]:"fire-fst",[KA]:"fire-fst-compat",[QA]:"fire-vertex","fire-js":"fire-js",[XA]:"fire-js-all"};const tf=new Map,ek=new Map,U0=new Map;function ww(n,e){try{n.container.addComponent(e)}catch(t){kr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ei(n){const e=n.name;if(U0.has(e))return kr.debug(`There were multiple attempts to register component ${e}.`),!1;U0.set(e,n);for(const t of tf.values())ww(t,n);for(const t of ek.values())ww(t,n);return!0}function Uu(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function xn(n){return n==null?!1:n.settings!==void 0}const tk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wi=new Vu("app","Firebase",tk);class sk{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ar("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wi.create("app-deleted",{appName:this._name})}}const El=JA;function r_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:L0,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw wi.create("bad-app-name",{appName:String(o)});if(t||(t=e_()),!t)throw wi.create("no-options");const c=tf.get(o);if(c){if(bl(t,c.options)&&bl(i,c.config))return c;throw wi.create("duplicate-app",{appName:o})}const d=new oA(o);for(const x of U0.values())d.addComponent(x);const m=new sk(t,i,d);return tf.set(o,m),m}function Of(n=L0){const e=tf.get(n);if(!e&&n===L0&&e_())return r_();if(!e)throw wi.create("no-app",{appName:n});return e}function aa(n,e,t){let i=ZA[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const d=[`Unable to register library "${i}" with version "${e}":`];o&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),kr.warn(d.join(" "));return}Ei(new Ar(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const nk="firebase-heartbeat-database",ak=1,Nu="firebase-heartbeat-store";let m0=null;function i_(){return m0||(m0=wA(nk,ak,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Nu)}catch(t){console.warn(t)}}}}).catch(n=>{throw wi.create("idb-open",{originalErrorMessage:n.message})})),m0}async function rk(n){try{const t=(await i_()).transaction(Nu),i=await t.objectStore(Nu).get(l_(n));return await t.done,i}catch(e){if(e instanceof Sa)kr.warn(e.message);else{const t=wi.create("idb-get",{originalErrorMessage:e?.message});kr.warn(t.message)}}}async function Nw(n,e){try{const i=(await i_()).transaction(Nu,"readwrite");await i.objectStore(Nu).put(e,l_(n)),await i.done}catch(t){if(t instanceof Sa)kr.warn(t.message);else{const i=wi.create("idb-set",{originalErrorMessage:t?.message});kr.warn(i.message)}}}function l_(n){return`${n.name}!${n.options.appId}`}const ik=1024,lk=30;class ok{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new uk(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=_w();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>lk){const o=dk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){kr.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=_w(),{heartbeatsToSend:t,unsentEntries:i}=ck(this._heartbeatsCache.heartbeats),o=ef(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return kr.warn(e),""}}}function _w(){return new Date().toISOString().substring(0,10)}function ck(n,e=ik){const t=[];let i=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),jw(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),jw(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class uk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return K5()?X5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await rk(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Nw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Nw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function jw(n){return ef(JSON.stringify({version:2,heartbeats:n})).length}function dk(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function hk(n){Ei(new Ar("platform-logger",e=>new jA(e),"PRIVATE")),Ei(new Ar("heartbeat",e=>new ok(e),"PRIVATE")),aa(V0,vw,n),aa(V0,vw,"esm2020"),aa("fire-js","")}hk("");function o_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const fk=o_,c_=new Vu("auth","Firebase",o_());const sf=new Ex("@firebase/auth");function mk(n,...e){sf.logLevel<=yt.WARN&&sf.warn(`Auth (${El}): ${n}`,...e)}function Ph(n,...e){sf.logLevel<=yt.ERROR&&sf.error(`Auth (${El}): ${n}`,...e)}function wa(n,...e){throw Ax(n,...e)}function Ya(n,...e){return Ax(n,...e)}function u_(n,e,t){const i={...fk(),[e]:t};return new Vu("auth","Firebase",i).create(e,{appName:n.name})}function Sr(n){return u_(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ax(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return c_.create(n,...e)}function nt(n,e,...t){if(!n)throw Ax(e,...t)}function wr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ph(e),new Error(e)}function Cr(n,e){n||wr(e)}function B0(){return typeof self<"u"&&self.location?.href||""}function pk(){return Sw()==="http:"||Sw()==="https:"}function Sw(){return typeof self<"u"&&self.location?.protocol||null}function xk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(pk()||G5()||"connection"in navigator)?navigator.onLine:!0}function gk(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Bu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Cr(t>e,"Short delay should be less than long delay!"),this.isMobile=$5()||Y5()}get(){return xk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function kx(n,e){Cr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class d_{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const bk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const yk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],vk=new Bu(3e4,6e4);function Mi(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Oi(n,e,t,i,o={}){return h_(n,o,async()=>{let c={},d={};i&&(e==="GET"?d=i:c={body:JSON.stringify(i)});const m=Lu({key:n.config.apiKey,...d}).slice(1),x=await n._getAdditionalHeaders();x["Content-Type"]="application/json",n.languageCode&&(x["X-Firebase-Locale"]=n.languageCode);const g={method:e,headers:x,...c};return H5()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&er(n.emulatorConfig.host)&&(g.credentials="include"),d_.fetch()(await f_(n,n.config.apiHost,t,m),g)})}async function h_(n,e,t){n._canInitEmulator=!1;const i={...bk,...e};try{const o=new Nk(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw vh(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const m=c.ok?d.errorMessage:d.error.message,[x,g]=m.split(" : ");if(x==="FEDERATED_USER_ID_ALREADY_LINKED")throw vh(n,"credential-already-in-use",d);if(x==="EMAIL_EXISTS")throw vh(n,"email-already-in-use",d);if(x==="USER_DISABLED")throw vh(n,"user-disabled",d);const b=i[x]||x.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw u_(n,b,g);wa(n,b)}}catch(o){if(o instanceof Sa)throw o;wa(n,"network-request-failed",{message:String(o)})}}async function zu(n,e,t,i,o={}){const c=await Oi(n,e,t,i,o);return"mfaPendingCredential"in c&&wa(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function f_(n,e,t,i){const o=`${e}${t}?${i}`,c=n,d=c.config.emulator?kx(n.config,o):`${n.config.apiScheme}://${o}`;return yk.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function wk(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Nk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ya(this.auth,"network-request-failed")),vk.get())})}}function vh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=Ya(n,e,i);return o.customData._tokenResponse=t,o}function Ew(n){return n!==void 0&&n.enterprise!==void 0}class _k{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return wk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function jk(n,e){return Oi(n,"GET","/v2/recaptchaConfig",Mi(n,e))}async function Sk(n,e){return Oi(n,"POST","/v1/accounts:delete",e)}async function nf(n,e){return Oi(n,"POST","/v1/accounts:lookup",e)}function fu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ek(n,e=!1){const t=Xt(n),i=await t.getIdToken(e),o=Cx(i);nt(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:i,authTime:fu(p0(o.auth_time)),issuedAtTime:fu(p0(o.iat)),expirationTime:fu(p0(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function p0(n){return Number(n)*1e3}function Cx(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Ph("JWT malformed, contained fewer than 3 sections"),null;try{const o=JN(t);return o?JSON.parse(o):(Ph("Failed to decode base64 JWT payload"),null)}catch(o){return Ph("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Tw(n){const e=Cx(n);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function _u(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Sa&&Tk(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Tk({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Ak{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class z0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fu(this.lastLoginAt),this.creationTime=fu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function af(n){const e=n.auth,t=await n.getIdToken(),i=await _u(n,nf(e,{idToken:t}));nt(i?.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const c=o.providerUserInfo?.length?m_(o.providerUserInfo):[],d=Ck(n.providerData,c),m=n.isAnonymous,x=!(n.email&&o.passwordHash)&&!d?.length,g=m?x:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new z0(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(n,b)}async function kk(n){const e=Xt(n);await af(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Ck(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function m_(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function Rk(n,e){const t=await h_(n,{},async()=>{const i=Lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await f_(n,o,"/v1/token",`key=${c}`),m=await n._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const x={method:"POST",headers:m,body:i};return n.emulatorConfig&&er(n.emulatorConfig.host)&&(x.credentials="include"),d_.fetch()(d,x)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Ik(n,e){return Oi(n,"POST","/v2/accounts:revokeToken",Mi(n,e))}class jo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Tw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const t=Tw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:c}=await Rk(e,t);this.updateTokensAndExpiration(i,o,Number(c))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:c}=t,d=new jo;return i&&(nt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),o&&(nt(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(nt(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jo,this.toJSON())}_performRefresh(){return wr("not implemented")}}function hi(n,e){nt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class pa{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new Ak(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new z0(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await _u(this,this.stsTokenManager.getToken(this.auth,e));return nt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Ek(this,e)}reload(){return kk(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new pa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await af(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xn(this.auth.app))return Promise.reject(Sr(this.auth));const e=await this.getIdToken();return await _u(this,Sk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,c=t.phoneNumber??void 0,d=t.photoURL??void 0,m=t.tenantId??void 0,x=t._redirectEventId??void 0,g=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:w,emailVerified:j,isAnonymous:R,providerData:U,stsTokenManager:V}=t;nt(w&&V,e,"internal-error");const L=jo.fromJSON(this.name,V);nt(typeof w=="string",e,"internal-error"),hi(i,e.name),hi(o,e.name),nt(typeof j=="boolean",e,"internal-error"),nt(typeof R=="boolean",e,"internal-error"),hi(c,e.name),hi(d,e.name),hi(m,e.name),hi(x,e.name),hi(g,e.name),hi(b,e.name);const z=new pa({uid:w,auth:e,email:o,emailVerified:j,displayName:i,isAnonymous:R,photoURL:d,phoneNumber:c,tenantId:m,stsTokenManager:L,createdAt:g,lastLoginAt:b});return U&&Array.isArray(U)&&(z.providerData=U.map(Q=>({...Q}))),x&&(z._redirectEventId=x),z}static async _fromIdTokenResponse(e,t,i=!1){const o=new jo;o.updateFromServerResponse(t);const c=new pa({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await af(c),c}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];nt(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?m_(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,m=new jo;m.updateFromIdToken(i);const x=new pa({uid:o.localId,auth:e,stsTokenManager:m,isAnonymous:d}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new z0(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(x,g),x}}const Aw=new Map;function Nr(n){Cr(n instanceof Function,"Expected a class definition");let e=Aw.get(n);return e?(Cr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Aw.set(n,e),e)}class p_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}p_.type="NONE";const kw=p_;function Vh(n,e,t){return`firebase:${n}:${e}:${t}`}class So{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:c}=this.auth;this.fullUserKey=Vh(this.userKey,o.apiKey,c),this.fullPersistenceKey=Vh("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await nf(this.auth,{idToken:e}).catch(()=>{});return t?pa._fromGetAccountInfoResponse(this.auth,t,e):null}return pa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new So(Nr(kw),e,i);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||Nr(kw);const d=Vh(i,e.config.apiKey,e.name);let m=null;for(const g of t)try{const b=await g._get(d);if(b){let w;if(typeof b=="string"){const j=await nf(e,{idToken:b}).catch(()=>{});if(!j)break;w=await pa._fromGetAccountInfoResponse(e,j,b)}else w=pa._fromJSON(e,b);g!==c&&(m=w),c=g;break}}catch{}const x=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!x.length?new So(c,e,i):(c=x[0],m&&await c._set(d,m.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(d)}catch{}})),new So(c,e,i))}}function Cw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(y_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(x_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(w_(e))return"Blackberry";if(N_(e))return"Webos";if(g_(e))return"Safari";if((e.includes("chrome/")||b_(e))&&!e.includes("edge/"))return"Chrome";if(v_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function x_(n=sn()){return/firefox\//i.test(n)}function g_(n=sn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function b_(n=sn()){return/crios\//i.test(n)}function y_(n=sn()){return/iemobile/i.test(n)}function v_(n=sn()){return/android/i.test(n)}function w_(n=sn()){return/blackberry/i.test(n)}function N_(n=sn()){return/webos/i.test(n)}function Rx(n=sn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Dk(n=sn()){return Rx(n)&&!!window.navigator?.standalone}function Mk(){return W5()&&document.documentMode===10}function __(n=sn()){return Rx(n)||v_(n)||N_(n)||w_(n)||/windows phone/i.test(n)||y_(n)}function j_(n,e=[]){let t;switch(n){case"Browser":t=Cw(sn());break;case"Worker":t=`${Cw(sn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${El}/${i}`}class Ok{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=c=>new Promise((d,m)=>{try{const x=e(c);d(x)}catch(x){m(x)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function Pk(n,e={}){return Oi(n,"GET","/v2/passwordPolicy",Mi(n,e))}const Vk=6;class Lk{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Vk,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}class Uk{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Rw(this),this.idTokenSubscription=new Rw(this),this.beforeStateQueue=new Ok(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=c_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Nr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await So.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await nf(this,{idToken:e}),i=await pa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(xn(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=this.redirectUser?._redirectEventId,d=i?._redirectEventId,m=await this.tryRedirectSignIn(e);(!c||c===d)&&m?.user&&(i=m.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await af(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xn(this.app))return Promise.reject(Sr(this));const t=e?Xt(e):null;return t&&nt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xn(this.app)?Promise.reject(Sr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xn(this.app)?Promise.reject(Sr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Nr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Pk(this),t=new Lk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Vu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await Ik(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Nr(e)||this._popupRedirectResolver;nt(t,this,"argument-error"),this.redirectPersistenceManager=await So.create(this,[Nr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(m,this,"internal-error"),m.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const x=e.addObserver(t,i,o);return()=>{d=!0,x()}}else{const x=e.addObserver(t);return()=>{d=!0,x()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=j_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(xn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&mk(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Tl(n){return Xt(n)}class Rw{constructor(e){this.auth=e,this.observer=null,this.addObserver=sA(t=>this.observer=t)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Pf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Bk(n){Pf=n}function S_(n){return Pf.loadJS(n)}function zk(){return Pf.recaptchaEnterpriseScript}function Fk(){return Pf.gapiScript}function $k(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class qk{constructor(){this.enterprise=new Hk}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Hk{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Gk="recaptcha-enterprise",E_="NO_RECAPTCHA";class Yk{constructor(e){this.type=Gk,this.auth=Tl(e)}async verify(e="verify",t=!1){async function i(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,m)=>{jk(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(x=>{if(x.recaptchaKey===void 0)m(new Error("recaptcha Enterprise site key undefined"));else{const g=new _k(x);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,d(g.siteKey)}}).catch(x=>{m(x)})})}function o(c,d,m){const x=window.grecaptcha;Ew(x)?x.enterprise.ready(()=>{x.enterprise.execute(c,{action:e}).then(g=>{d(g)}).catch(()=>{d(E_)})}):m(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new qk().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{i(this.auth).then(m=>{if(!t&&Ew(window.grecaptcha))o(m,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let x=zk();x.length!==0&&(x+=m),S_(x).then(()=>{o(m,c,d)}).catch(g=>{d(g)})}}).catch(m=>{d(m)})})}}async function Iw(n,e,t,i=!1,o=!1){const c=new Yk(n);let d;if(o)d=E_;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const m={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in m){const x=m.phoneEnrollmentInfo.phoneNumber,g=m.phoneEnrollmentInfo.recaptchaToken;Object.assign(m,{phoneEnrollmentInfo:{phoneNumber:x,recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in m){const x=m.phoneSignInInfo.recaptchaToken;Object.assign(m,{phoneSignInInfo:{recaptchaToken:x,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return m}return i?Object.assign(m,{captchaResp:d}):Object.assign(m,{captchaResponse:d}),Object.assign(m,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(m,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),m}async function F0(n,e,t,i,o){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Iw(n,e,t,t==="getOobCode");return i(n,c)}else return i(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Iw(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(c)})}function Wk(n,e){const t=Uu(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(bl(c,e??{}))return o;wa(o,"already-initialized")}return t.initialize({options:e})}function Qk(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Nr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function Kk(n,e,t){const i=Tl(n);nt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,c=T_(e),{host:d,port:m}=Xk(e),x=m===null?"":`:${m}`,g={url:`${c}//${d}${x}/`},b=Object.freeze({host:d,port:m,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){nt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),nt(bl(g,i.config.emulator)&&bl(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,er(d)?(Df(`${c}//${d}${x}`),Mf("Auth",!0)):Jk()}function T_(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Xk(n){const e=T_(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const c=o[1];return{host:c,port:Dw(i.substr(c.length+1))}}else{const[c,d]=i.split(":");return{host:c,port:Dw(d)}}}function Dw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Jk(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Ix{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return wr("not implemented")}_getIdTokenResponse(e){return wr("not implemented")}_linkToIdToken(e,t){return wr("not implemented")}_getReauthenticationResolver(e){return wr("not implemented")}}async function Zk(n,e){return Oi(n,"POST","/v1/accounts:signUp",e)}async function eC(n,e){return zu(n,"POST","/v1/accounts:signInWithPassword",Mi(n,e))}async function tC(n,e){return zu(n,"POST","/v1/accounts:signInWithEmailLink",Mi(n,e))}async function sC(n,e){return zu(n,"POST","/v1/accounts:signInWithEmailLink",Mi(n,e))}class ju extends Ix{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new ju(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new ju(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return F0(e,t,"signInWithPassword",eC);case"emailLink":return tC(e,{email:this._email,oobCode:this._password});default:wa(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return F0(e,i,"signUpPassword",Zk);case"emailLink":return sC(e,{idToken:t,email:this._email,oobCode:this._password});default:wa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Eo(n,e){return zu(n,"POST","/v1/accounts:signInWithIdp",Mi(n,e))}const nC="http://localhost";class yl extends Ix{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new yl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):wa("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...c}=t;if(!i||!o)return null;const d=new yl(i,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Eo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Eo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Eo(e,t)}buildRequest(){const e={requestUri:nC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Lu(t)}return e}}function aC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function rC(n){const e=ru(iu(n)).link,t=e?ru(iu(e)).deep_link_id:null,i=ru(iu(n)).deep_link_id;return(i?ru(iu(i)).link:null)||i||t||e||n}class Dx{constructor(e){const t=ru(iu(e)),i=t.apiKey??null,o=t.oobCode??null,c=aC(t.mode??null);nt(i&&o&&c,"argument-error"),this.apiKey=i,this.operation=c,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=rC(e);try{return new Dx(t)}catch{return null}}}class Go{constructor(){this.providerId=Go.PROVIDER_ID}static credential(e,t){return ju._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Dx.parseLink(t);return nt(i,"argument-error"),ju._fromEmailAndCode(e,i.code,i.tenantId)}}Go.PROVIDER_ID="password";Go.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Go.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class A_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Fu extends A_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class mi extends Fu{constructor(){super("facebook.com")}static credential(e){return yl._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";mi.PROVIDER_ID="facebook.com";class pi extends Fu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return yl._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return pi.credential(t,i)}catch{return null}}}pi.GOOGLE_SIGN_IN_METHOD="google.com";pi.PROVIDER_ID="google.com";class xi extends Fu{constructor(){super("github.com")}static credential(e){return yl._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xi.credential(e.oauthAccessToken)}catch{return null}}}xi.GITHUB_SIGN_IN_METHOD="github.com";xi.PROVIDER_ID="github.com";class gi extends Fu{constructor(){super("twitter.com")}static credential(e,t){return yl._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return gi.credential(t,i)}catch{return null}}}gi.TWITTER_SIGN_IN_METHOD="twitter.com";gi.PROVIDER_ID="twitter.com";async function iC(n,e){return zu(n,"POST","/v1/accounts:signUp",Mi(n,e))}class vl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const c=await pa._fromIdTokenResponse(e,i,o),d=Mw(i);return new vl({user:c,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=Mw(i);return new vl({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function Mw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class rf extends Sa{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,rf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new rf(e,t,i,o)}}function k_(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?rf._fromErrorAndOperation(n,c,e,i):c})}async function lC(n,e,t=!1){const i=await _u(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return vl._forOperation(n,"link",i)}async function oC(n,e,t=!1){const{auth:i}=n;if(xn(i.app))return Promise.reject(Sr(i));const o="reauthenticate";try{const c=await _u(n,k_(i,o,e,n),t);nt(c.idToken,i,"internal-error");const d=Cx(c.idToken);nt(d,i,"internal-error");const{sub:m}=d;return nt(n.uid===m,i,"user-mismatch"),vl._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&wa(i,"user-mismatch"),c}}async function C_(n,e,t=!1){if(xn(n.app))return Promise.reject(Sr(n));const i="signIn",o=await k_(n,i,e),c=await vl._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(c.user),c}async function cC(n,e){return C_(Tl(n),e)}async function R_(n){const e=Tl(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function uC(n,e,t){if(xn(n.app))return Promise.reject(Sr(n));const i=Tl(n),d=await F0(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",iC).catch(x=>{throw x.code==="auth/password-does-not-meet-requirements"&&R_(n),x}),m=await vl._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(m.user),m}function Mx(n,e,t){return xn(n.app)?Promise.reject(Sr(n)):cC(Xt(n),Go.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&R_(n),i})}function dC(n,e,t,i){return Xt(n).onIdTokenChanged(e,t,i)}function hC(n,e,t){return Xt(n).beforeAuthStateChanged(e,t)}function fC(n,e,t,i){return Xt(n).onAuthStateChanged(e,t,i)}function lf(n){return Xt(n).signOut()}const of="__sak";class I_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(of,"1"),this.storage.removeItem(of),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const mC=1e3,pC=10;class D_ extends I_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=__(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,m,x)=>{this.notifyListeners(d,x)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},c=this.storage.getItem(i);Mk()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,pC):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},mC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}D_.type="LOCAL";const xC=D_;class M_ extends I_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}M_.type="SESSION";const O_=M_;function gC(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Vf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Vf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const m=Array.from(d).map(async g=>g(t.origin,c)),x=await gC(m);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:x})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Vf.receivers=[];function Ox(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class bC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((m,x)=>{const g=Ox("",20);o.port1.start();const b=setTimeout(()=>{x(new Error("unsupported_event"))},i);d={messageChannel:o,onMessage(w){const j=w;if(j.data.eventId===g)switch(j.data.status){case"ack":clearTimeout(b),c=setTimeout(()=>{x(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),m(j.data.response);break;default:clearTimeout(b),clearTimeout(c),x(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Wa(){return window}function yC(n){Wa().location.href=n}function P_(){return typeof Wa().WorkerGlobalScope<"u"&&typeof Wa().importScripts=="function"}async function vC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wC(){return navigator?.serviceWorker?.controller||null}function NC(){return P_()?self:null}const V_="firebaseLocalStorageDb",_C=1,cf="firebaseLocalStorage",L_="fbase_key";class $u{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Lf(n,e){return n.transaction([cf],e?"readwrite":"readonly").objectStore(cf)}function jC(){const n=indexedDB.deleteDatabase(V_);return new $u(n).toPromise()}function $0(){const n=indexedDB.open(V_,_C);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(cf,{keyPath:L_})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(cf)?e(i):(i.close(),await jC(),e(await $0()))})})}async function Ow(n,e,t){const i=Lf(n,!0).put({[L_]:e,value:t});return new $u(i).toPromise()}async function SC(n,e){const t=Lf(n,!1).get(e),i=await new $u(t).toPromise();return i===void 0?null:i.value}function Pw(n,e){const t=Lf(n,!0).delete(e);return new $u(t).toPromise()}const EC=800,TC=3;class U_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>TC)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return P_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vf._getInstance(NC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await vC(),!this.activeServiceWorker)return;this.sender=new bC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $0();return await Ow(e,of,"1"),await Pw(e,of),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Ow(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>SC(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Pw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Lf(o,!1).getAll();return new $u(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),EC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}U_.type="LOCAL";const AC=U_;new Bu(3e4,6e4);function kC(n,e){return e?Nr(e):(nt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Px extends Ix{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Eo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Eo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Eo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function CC(n){return C_(n.auth,new Px(n),n.bypassAuthState)}function RC(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),oC(t,new Px(n),n.bypassAuthState)}async function IC(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),lC(t,new Px(n),n.bypassAuthState)}class B_{constructor(e,t,i,o,c=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:c,error:d,type:m}=e;if(d){this.reject(d);return}const x={auth:this.auth,requestUri:t,sessionId:i,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(x))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CC;case"linkViaPopup":case"linkViaRedirect":return IC;case"reauthViaPopup":case"reauthViaRedirect":return RC;default:wa(this.auth,"internal-error")}}resolve(e){Cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const DC=new Bu(2e3,1e4);class No extends B_{constructor(e,t,i,o,c){super(e,t,o,c),this.provider=i,this.authWindow=null,this.pollId=null,No.currentPopupAction&&No.currentPopupAction.cancel(),No.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){Cr(this.filter.length===1,"Popup operations only handle one event");const e=Ox();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ya(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ya(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,No.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ya(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,DC.get())};e()}}No.currentPopupAction=null;const MC="pendingRedirect",Lh=new Map;class OC extends B_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Lh.get(this.auth._key());if(!e){try{const i=await PC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Lh.set(this.auth._key(),e)}return this.bypassAuthState||Lh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PC(n,e){const t=UC(e),i=LC(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function VC(n,e){Lh.set(n._key(),e)}function LC(n){return Nr(n._redirectPersistence)}function UC(n){return Vh(MC,n.config.apiKey,n.name)}async function BC(n,e,t=!1){if(xn(n.app))return Promise.reject(Sr(n));const i=Tl(n),o=kC(i,e),d=await new OC(i,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const zC=600*1e3;class FC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$C(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!z_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ya(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zC&&this.cachedEventUids.clear(),this.cachedEventUids.has(Vw(e))}saveEventToCache(e){this.cachedEventUids.add(Vw(e)),this.lastProcessedEventTime=Date.now()}}function Vw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function z_({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function $C(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return z_(n);default:return!1}}async function qC(n,e={}){return Oi(n,"GET","/v1/projects",e)}const HC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,GC=/^https?/;async function YC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await qC(n);for(const t of e)try{if(WC(t))return}catch{}wa(n,"unauthorized-domain")}function WC(n){const e=B0(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!GC.test(t))return!1;if(HC.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}const QC=new Bu(3e4,6e4);function Lw(){const n=Wa().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function KC(n){return new Promise((e,t)=>{function i(){Lw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Lw(),t(Ya(n,"network-request-failed"))},timeout:QC.get()})}if(Wa().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Wa().gapi?.load)i();else{const o=$k("iframefcb");return Wa()[o]=()=>{gapi.load?i():t(Ya(n,"network-request-failed"))},S_(`${Fk()}?onload=${o}`).catch(c=>t(c))}}).catch(e=>{throw Uh=null,e})}let Uh=null;function XC(n){return Uh=Uh||KC(n),Uh}const JC=new Bu(5e3,15e3),ZC="__/auth/iframe",e4="emulator/auth/iframe",t4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},s4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function n4(n){const e=n.config;nt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?kx(e,e4):`https://${n.config.authDomain}/${ZC}`,i={apiKey:e.apiKey,appName:n.name,v:El},o=s4.get(n.config.apiHost);o&&(i.eid=o);const c=n._getFrameworks();return c.length&&(i.fw=c.join(",")),`${t}?${Lu(i).slice(1)}`}async function a4(n){const e=await XC(n),t=Wa().gapi;return nt(t,n,"internal-error"),e.open({where:document.body,url:n4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:t4,dontclear:!0},i=>new Promise(async(o,c)=>{await i.restyle({setHideOnLeave:!1});const d=Ya(n,"network-request-failed"),m=Wa().setTimeout(()=>{c(d)},JC.get());function x(){Wa().clearTimeout(m),o(i)}i.ping(x).then(x,()=>{c(d)})}))}const r4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},i4=500,l4=600,o4="_blank",c4="http://localhost";class Uw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function u4(n,e,t,i=i4,o=l4){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let m="";const x={...r4,width:i.toString(),height:o.toString(),top:c,left:d},g=sn().toLowerCase();t&&(m=b_(g)?o4:t),x_(g)&&(e=e||c4,x.scrollbars="yes");const b=Object.entries(x).reduce((j,[R,U])=>`${j}${R}=${U},`,"");if(Dk(g)&&m!=="_self")return d4(e||"",m),new Uw(null);const w=window.open(e||"",m,b);nt(w,n,"popup-blocked");try{w.focus()}catch{}return new Uw(w)}function d4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const h4="__/auth/handler",f4="emulator/auth/handler",m4=encodeURIComponent("fac");async function Bw(n,e,t,i,o,c){nt(n.config.authDomain,n,"auth-domain-config-required"),nt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:El,eventId:o};if(e instanceof A_){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",tA(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,w]of Object.entries({}))d[b]=w}if(e instanceof Fu){const b=e.getScopes().filter(w=>w!=="");b.length>0&&(d.scopes=b.join(","))}n.tenantId&&(d.tid=n.tenantId);const m=d;for(const b of Object.keys(m))m[b]===void 0&&delete m[b];const x=await n._getAppCheckToken(),g=x?`#${m4}=${encodeURIComponent(x)}`:"";return`${p4(n)}?${Lu(m).slice(1)}${g}`}function p4({config:n}){return n.emulator?kx(n,f4):`https://${n.authDomain}/${h4}`}const x0="webStorageSupport";class x4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=O_,this._completeRedirectFn=BC,this._overrideRedirectResult=VC}async _openPopup(e,t,i,o){Cr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const c=await Bw(e,t,i,B0(),o);return u4(e,c,Ox())}async _openRedirect(e,t,i,o){await this._originValidation(e);const c=await Bw(e,t,i,B0(),o);return yC(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Cr(c,"If manager is not set, promise should be"),c)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await a4(e),i=new FC(e);return t.register("authEvent",o=>(nt(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(x0,{type:x0},o=>{const c=o?.[0]?.[x0];c!==void 0&&t(!!c),wa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=YC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return __()||g_()||Rx()}}const g4=x4;var zw="@firebase/auth",Fw="1.12.0";class b4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function y4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function v4(n){Ei(new Ar("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:m}=i.options;nt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const x={apiKey:d,authDomain:m,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:j_(n)},g=new Uk(i,o,c,x);return Qk(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ei(new Ar("auth-internal",e=>{const t=Tl(e.getProvider("auth").getImmediate());return(i=>new b4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),aa(zw,Fw,y4(n)),aa(zw,Fw,"esm2020")}const w4=300,N4=t_("authIdTokenMaxAge")||w4;let $w=null;const _4=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>N4)return;const o=t?.token;$w!==o&&($w=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function j4(n=Of()){const e=Uu(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Wk(n,{popupRedirectResolver:g4,persistence:[AC,xC,O_]}),i=t_("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(i,location.origin);if(location.origin===c.origin){const d=_4(c.toString());hC(t,d,()=>d(t.currentUser)),dC(t,m=>d(m))}}const o=ZN("auth");return o&&Kk(t,`http://${o}`),t}function S4(){return document.getElementsByTagName("head")?.[0]??document}Bk({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const c=Ya("internal-error");c.customData=o,t(c)},i.type="text/javascript",i.charset="UTF-8",S4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});v4("Browser");var E4="firebase",T4="12.8.0";aa(E4,T4,"app");var qw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ni,F_;(function(){var n;function e(T,E){function S(){}S.prototype=E.prototype,T.F=E.prototype,T.prototype=new S,T.prototype.constructor=T,T.D=function(I,k,M){for(var C=Array(arguments.length-2),F=2;F<arguments.length;F++)C[F-2]=arguments[F];return E.prototype[k].apply(I,C)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(T,E,S){S||(S=0);const I=Array(16);if(typeof E=="string")for(var k=0;k<16;++k)I[k]=E.charCodeAt(S++)|E.charCodeAt(S++)<<8|E.charCodeAt(S++)<<16|E.charCodeAt(S++)<<24;else for(k=0;k<16;++k)I[k]=E[S++]|E[S++]<<8|E[S++]<<16|E[S++]<<24;E=T.g[0],S=T.g[1],k=T.g[2];let M=T.g[3],C;C=E+(M^S&(k^M))+I[0]+3614090360&4294967295,E=S+(C<<7&4294967295|C>>>25),C=M+(k^E&(S^k))+I[1]+3905402710&4294967295,M=E+(C<<12&4294967295|C>>>20),C=k+(S^M&(E^S))+I[2]+606105819&4294967295,k=M+(C<<17&4294967295|C>>>15),C=S+(E^k&(M^E))+I[3]+3250441966&4294967295,S=k+(C<<22&4294967295|C>>>10),C=E+(M^S&(k^M))+I[4]+4118548399&4294967295,E=S+(C<<7&4294967295|C>>>25),C=M+(k^E&(S^k))+I[5]+1200080426&4294967295,M=E+(C<<12&4294967295|C>>>20),C=k+(S^M&(E^S))+I[6]+2821735955&4294967295,k=M+(C<<17&4294967295|C>>>15),C=S+(E^k&(M^E))+I[7]+4249261313&4294967295,S=k+(C<<22&4294967295|C>>>10),C=E+(M^S&(k^M))+I[8]+1770035416&4294967295,E=S+(C<<7&4294967295|C>>>25),C=M+(k^E&(S^k))+I[9]+2336552879&4294967295,M=E+(C<<12&4294967295|C>>>20),C=k+(S^M&(E^S))+I[10]+4294925233&4294967295,k=M+(C<<17&4294967295|C>>>15),C=S+(E^k&(M^E))+I[11]+2304563134&4294967295,S=k+(C<<22&4294967295|C>>>10),C=E+(M^S&(k^M))+I[12]+1804603682&4294967295,E=S+(C<<7&4294967295|C>>>25),C=M+(k^E&(S^k))+I[13]+4254626195&4294967295,M=E+(C<<12&4294967295|C>>>20),C=k+(S^M&(E^S))+I[14]+2792965006&4294967295,k=M+(C<<17&4294967295|C>>>15),C=S+(E^k&(M^E))+I[15]+1236535329&4294967295,S=k+(C<<22&4294967295|C>>>10),C=E+(k^M&(S^k))+I[1]+4129170786&4294967295,E=S+(C<<5&4294967295|C>>>27),C=M+(S^k&(E^S))+I[6]+3225465664&4294967295,M=E+(C<<9&4294967295|C>>>23),C=k+(E^S&(M^E))+I[11]+643717713&4294967295,k=M+(C<<14&4294967295|C>>>18),C=S+(M^E&(k^M))+I[0]+3921069994&4294967295,S=k+(C<<20&4294967295|C>>>12),C=E+(k^M&(S^k))+I[5]+3593408605&4294967295,E=S+(C<<5&4294967295|C>>>27),C=M+(S^k&(E^S))+I[10]+38016083&4294967295,M=E+(C<<9&4294967295|C>>>23),C=k+(E^S&(M^E))+I[15]+3634488961&4294967295,k=M+(C<<14&4294967295|C>>>18),C=S+(M^E&(k^M))+I[4]+3889429448&4294967295,S=k+(C<<20&4294967295|C>>>12),C=E+(k^M&(S^k))+I[9]+568446438&4294967295,E=S+(C<<5&4294967295|C>>>27),C=M+(S^k&(E^S))+I[14]+3275163606&4294967295,M=E+(C<<9&4294967295|C>>>23),C=k+(E^S&(M^E))+I[3]+4107603335&4294967295,k=M+(C<<14&4294967295|C>>>18),C=S+(M^E&(k^M))+I[8]+1163531501&4294967295,S=k+(C<<20&4294967295|C>>>12),C=E+(k^M&(S^k))+I[13]+2850285829&4294967295,E=S+(C<<5&4294967295|C>>>27),C=M+(S^k&(E^S))+I[2]+4243563512&4294967295,M=E+(C<<9&4294967295|C>>>23),C=k+(E^S&(M^E))+I[7]+1735328473&4294967295,k=M+(C<<14&4294967295|C>>>18),C=S+(M^E&(k^M))+I[12]+2368359562&4294967295,S=k+(C<<20&4294967295|C>>>12),C=E+(S^k^M)+I[5]+4294588738&4294967295,E=S+(C<<4&4294967295|C>>>28),C=M+(E^S^k)+I[8]+2272392833&4294967295,M=E+(C<<11&4294967295|C>>>21),C=k+(M^E^S)+I[11]+1839030562&4294967295,k=M+(C<<16&4294967295|C>>>16),C=S+(k^M^E)+I[14]+4259657740&4294967295,S=k+(C<<23&4294967295|C>>>9),C=E+(S^k^M)+I[1]+2763975236&4294967295,E=S+(C<<4&4294967295|C>>>28),C=M+(E^S^k)+I[4]+1272893353&4294967295,M=E+(C<<11&4294967295|C>>>21),C=k+(M^E^S)+I[7]+4139469664&4294967295,k=M+(C<<16&4294967295|C>>>16),C=S+(k^M^E)+I[10]+3200236656&4294967295,S=k+(C<<23&4294967295|C>>>9),C=E+(S^k^M)+I[13]+681279174&4294967295,E=S+(C<<4&4294967295|C>>>28),C=M+(E^S^k)+I[0]+3936430074&4294967295,M=E+(C<<11&4294967295|C>>>21),C=k+(M^E^S)+I[3]+3572445317&4294967295,k=M+(C<<16&4294967295|C>>>16),C=S+(k^M^E)+I[6]+76029189&4294967295,S=k+(C<<23&4294967295|C>>>9),C=E+(S^k^M)+I[9]+3654602809&4294967295,E=S+(C<<4&4294967295|C>>>28),C=M+(E^S^k)+I[12]+3873151461&4294967295,M=E+(C<<11&4294967295|C>>>21),C=k+(M^E^S)+I[15]+530742520&4294967295,k=M+(C<<16&4294967295|C>>>16),C=S+(k^M^E)+I[2]+3299628645&4294967295,S=k+(C<<23&4294967295|C>>>9),C=E+(k^(S|~M))+I[0]+4096336452&4294967295,E=S+(C<<6&4294967295|C>>>26),C=M+(S^(E|~k))+I[7]+1126891415&4294967295,M=E+(C<<10&4294967295|C>>>22),C=k+(E^(M|~S))+I[14]+2878612391&4294967295,k=M+(C<<15&4294967295|C>>>17),C=S+(M^(k|~E))+I[5]+4237533241&4294967295,S=k+(C<<21&4294967295|C>>>11),C=E+(k^(S|~M))+I[12]+1700485571&4294967295,E=S+(C<<6&4294967295|C>>>26),C=M+(S^(E|~k))+I[3]+2399980690&4294967295,M=E+(C<<10&4294967295|C>>>22),C=k+(E^(M|~S))+I[10]+4293915773&4294967295,k=M+(C<<15&4294967295|C>>>17),C=S+(M^(k|~E))+I[1]+2240044497&4294967295,S=k+(C<<21&4294967295|C>>>11),C=E+(k^(S|~M))+I[8]+1873313359&4294967295,E=S+(C<<6&4294967295|C>>>26),C=M+(S^(E|~k))+I[15]+4264355552&4294967295,M=E+(C<<10&4294967295|C>>>22),C=k+(E^(M|~S))+I[6]+2734768916&4294967295,k=M+(C<<15&4294967295|C>>>17),C=S+(M^(k|~E))+I[13]+1309151649&4294967295,S=k+(C<<21&4294967295|C>>>11),C=E+(k^(S|~M))+I[4]+4149444226&4294967295,E=S+(C<<6&4294967295|C>>>26),C=M+(S^(E|~k))+I[11]+3174756917&4294967295,M=E+(C<<10&4294967295|C>>>22),C=k+(E^(M|~S))+I[2]+718787259&4294967295,k=M+(C<<15&4294967295|C>>>17),C=S+(M^(k|~E))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+E&4294967295,T.g[1]=T.g[1]+(k+(C<<21&4294967295|C>>>11))&4294967295,T.g[2]=T.g[2]+k&4294967295,T.g[3]=T.g[3]+M&4294967295}i.prototype.v=function(T,E){E===void 0&&(E=T.length);const S=E-this.blockSize,I=this.C;let k=this.h,M=0;for(;M<E;){if(k==0)for(;M<=S;)o(this,T,M),M+=this.blockSize;if(typeof T=="string"){for(;M<E;)if(I[k++]=T.charCodeAt(M++),k==this.blockSize){o(this,I),k=0;break}}else for(;M<E;)if(I[k++]=T[M++],k==this.blockSize){o(this,I),k=0;break}}this.h=k,this.o+=E},i.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var E=1;E<T.length-8;++E)T[E]=0;E=this.o*8;for(var S=T.length-8;S<T.length;++S)T[S]=E&255,E/=256;for(this.v(T),T=Array(16),E=0,S=0;S<4;++S)for(let I=0;I<32;I+=8)T[E++]=this.g[S]>>>I&255;return T};function c(T,E){var S=m;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=E(T)}function d(T,E){this.h=E;const S=[];let I=!0;for(let k=T.length-1;k>=0;k--){const M=T[k]|0;I&&M==E||(S[k]=M,I=!1)}this.g=S}var m={};function x(T){return-128<=T&&T<128?c(T,function(E){return new d([E|0],E<0?-1:0)}):new d([T|0],T<0?-1:0)}function g(T){if(isNaN(T)||!isFinite(T))return w;if(T<0)return L(g(-T));const E=[];let S=1;for(let I=0;T>=S;I++)E[I]=T/S|0,S*=4294967296;return new d(E,0)}function b(T,E){if(T.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(T.charAt(0)=="-")return L(b(T.substring(1),E));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=g(Math.pow(E,8));let I=w;for(let M=0;M<T.length;M+=8){var k=Math.min(8,T.length-M);const C=parseInt(T.substring(M,M+k),E);k<8?(k=g(Math.pow(E,k)),I=I.j(k).add(g(C))):(I=I.j(S),I=I.add(g(C)))}return I}var w=x(0),j=x(1),R=x(16777216);n=d.prototype,n.m=function(){if(V(this))return-L(this).m();let T=0,E=1;for(let S=0;S<this.g.length;S++){const I=this.i(S);T+=(I>=0?I:4294967296+I)*E,E*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(U(this))return"0";if(V(this))return"-"+L(this).toString(T);const E=g(Math.pow(T,6));var S=this;let I="";for(;;){const k=ie(S,E).g;S=z(S,k.j(E));let M=((S.g.length>0?S.g[0]:S.h)>>>0).toString(T);if(S=k,U(S))return M+I;for(;M.length<6;)M="0"+M;I=M+I}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function U(T){if(T.h!=0)return!1;for(let E=0;E<T.g.length;E++)if(T.g[E]!=0)return!1;return!0}function V(T){return T.h==-1}n.l=function(T){return T=z(this,T),V(T)?-1:U(T)?0:1};function L(T){const E=T.g.length,S=[];for(let I=0;I<E;I++)S[I]=~T.g[I];return new d(S,~T.h).add(j)}n.abs=function(){return V(this)?L(this):this},n.add=function(T){const E=Math.max(this.g.length,T.g.length),S=[];let I=0;for(let k=0;k<=E;k++){let M=I+(this.i(k)&65535)+(T.i(k)&65535),C=(M>>>16)+(this.i(k)>>>16)+(T.i(k)>>>16);I=C>>>16,M&=65535,C&=65535,S[k]=C<<16|M}return new d(S,S[S.length-1]&-2147483648?-1:0)};function z(T,E){return T.add(L(E))}n.j=function(T){if(U(this)||U(T))return w;if(V(this))return V(T)?L(this).j(L(T)):L(L(this).j(T));if(V(T))return L(this.j(L(T)));if(this.l(R)<0&&T.l(R)<0)return g(this.m()*T.m());const E=this.g.length+T.g.length,S=[];for(var I=0;I<2*E;I++)S[I]=0;for(I=0;I<this.g.length;I++)for(let k=0;k<T.g.length;k++){const M=this.i(I)>>>16,C=this.i(I)&65535,F=T.i(k)>>>16,P=T.i(k)&65535;S[2*I+2*k]+=C*P,Q(S,2*I+2*k),S[2*I+2*k+1]+=M*P,Q(S,2*I+2*k+1),S[2*I+2*k+1]+=C*F,Q(S,2*I+2*k+1),S[2*I+2*k+2]+=M*F,Q(S,2*I+2*k+2)}for(T=0;T<E;T++)S[T]=S[2*T+1]<<16|S[2*T];for(T=E;T<2*E;T++)S[T]=0;return new d(S,0)};function Q(T,E){for(;(T[E]&65535)!=T[E];)T[E+1]+=T[E]>>>16,T[E]&=65535,E++}function G(T,E){this.g=T,this.h=E}function ie(T,E){if(U(E))throw Error("division by zero");if(U(T))return new G(w,w);if(V(T))return E=ie(L(T),E),new G(L(E.g),L(E.h));if(V(E))return E=ie(T,L(E)),new G(L(E.g),E.h);if(T.g.length>30){if(V(T)||V(E))throw Error("slowDivide_ only works with positive integers.");for(var S=j,I=E;I.l(T)<=0;)S=he(S),I=he(I);var k=W(S,1),M=W(I,1);for(I=W(I,2),S=W(S,2);!U(I);){var C=M.add(I);C.l(T)<=0&&(k=k.add(S),M=C),I=W(I,1),S=W(S,1)}return E=z(T,k.j(E)),new G(k,E)}for(k=w;T.l(E)>=0;){for(S=Math.max(1,Math.floor(T.m()/E.m())),I=Math.ceil(Math.log(S)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),M=g(S),C=M.j(E);V(C)||C.l(T)>0;)S-=I,M=g(S),C=M.j(E);U(M)&&(M=j),k=k.add(M),T=z(T,C)}return new G(k,T)}n.B=function(T){return ie(this,T).h},n.and=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let I=0;I<E;I++)S[I]=this.i(I)&T.i(I);return new d(S,this.h&T.h)},n.or=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let I=0;I<E;I++)S[I]=this.i(I)|T.i(I);return new d(S,this.h|T.h)},n.xor=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let I=0;I<E;I++)S[I]=this.i(I)^T.i(I);return new d(S,this.h^T.h)};function he(T){const E=T.g.length+1,S=[];for(let I=0;I<E;I++)S[I]=T.i(I)<<1|T.i(I-1)>>>31;return new d(S,T.h)}function W(T,E){const S=E>>5;E%=32;const I=T.g.length-S,k=[];for(let M=0;M<I;M++)k[M]=E>0?T.i(M+S)>>>E|T.i(M+S+1)<<32-E:T.i(M+S);return new d(k,T.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,F_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=g,d.fromString=b,Ni=d}).apply(typeof qw<"u"?qw:typeof self<"u"?self:typeof window<"u"?window:{});var wh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $_,lu,q_,Bh,q0,H_,G_,Y_;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof wh=="object"&&wh];for(var y=0;y<h.length;++y){var N=h[y];if(N&&N.Math==Math)return N}throw Error("Cannot find global object")}var i=t(this);function o(h,y){if(y)e:{var N=i;h=h.split(".");for(var D=0;D<h.length-1;D++){var te=h[D];if(!(te in N))break e;N=N[te]}h=h[h.length-1],D=N[h],y=y(D),y!=D&&y!=null&&e(N,h,{configurable:!0,writable:!0,value:y})}}o("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(h){return h||function(y){var N=[],D;for(D in y)Object.prototype.hasOwnProperty.call(y,D)&&N.push([D,y[D]]);return N}});var c=c||{},d=this||self;function m(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function x(h,y,N){return h.call.apply(h.bind,arguments)}function g(h,y,N){return g=x,g.apply(null,arguments)}function b(h,y){var N=Array.prototype.slice.call(arguments,1);return function(){var D=N.slice();return D.push.apply(D,arguments),h.apply(this,D)}}function w(h,y){function N(){}N.prototype=y.prototype,h.Z=y.prototype,h.prototype=new N,h.prototype.constructor=h,h.Ob=function(D,te,oe){for(var ke=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)ke[ut-2]=arguments[ut];return y.prototype[te].apply(D,ke)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function R(h){const y=h.length;if(y>0){const N=Array(y);for(let D=0;D<y;D++)N[D]=h[D];return N}return[]}function U(h,y){for(let D=1;D<arguments.length;D++){const te=arguments[D];var N=typeof te;if(N=N!="object"?N:te?Array.isArray(te)?"array":N:"null",N=="array"||N=="object"&&typeof te.length=="number"){N=h.length||0;const oe=te.length||0;h.length=N+oe;for(let ke=0;ke<oe;ke++)h[N+ke]=te[ke]}else h.push(te)}}class V{constructor(y,N){this.i=y,this.j=N,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function L(h){d.setTimeout(()=>{throw h},0)}function z(){var h=T;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class Q{constructor(){this.h=this.g=null}add(y,N){const D=G.get();D.set(y,N),this.h?this.h.next=D:this.g=D,this.h=D}}var G=new V(()=>new ie,h=>h.reset());class ie{constructor(){this.next=this.g=this.h=null}set(y,N){this.h=y,this.g=N,this.next=null}reset(){this.next=this.g=this.h=null}}let he,W=!1,T=new Q,E=()=>{const h=Promise.resolve(void 0);he=()=>{h.then(S)}};function S(){for(var h;h=z();){try{h.h.call(h.g)}catch(N){L(N)}var y=G;y.j(h),y.h<100&&(y.h++,h.next=y.g,y.g=h)}W=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const N=()=>{};d.addEventListener("test",N,y),d.removeEventListener("test",N,y)}catch{}return h})();function C(h){return/^[\s\xa0]*$/.test(h)}function F(h,y){k.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,y)}w(F,k),F.prototype.init=function(h,y){const N=this.type=h.type,D=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget,y||(N=="mouseover"?y=h.fromElement:N=="mouseout"&&(y=h.toElement)),this.relatedTarget=y,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&F.Z.h.call(this)},F.prototype.h=function(){F.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var P="closure_listenable_"+(Math.random()*1e6|0),O=0;function K(h,y,N,D,te){this.listener=h,this.proxy=null,this.src=y,this.type=N,this.capture=!!D,this.ha=te,this.key=++O,this.da=this.fa=!1}function ce(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Se(h,y,N){for(const D in h)y.call(N,h[D],D,h)}function be(h,y){for(const N in h)y.call(void 0,h[N],N,h)}function B(h){const y={};for(const N in h)y[N]=h[N];return y}const J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function le(h,y){let N,D;for(let te=1;te<arguments.length;te++){D=arguments[te];for(N in D)h[N]=D[N];for(let oe=0;oe<J.length;oe++)N=J[oe],Object.prototype.hasOwnProperty.call(D,N)&&(h[N]=D[N])}}function pe(h){this.src=h,this.g={},this.h=0}pe.prototype.add=function(h,y,N,D,te){const oe=h.toString();h=this.g[oe],h||(h=this.g[oe]=[],this.h++);const ke=Me(h,y,D,te);return ke>-1?(y=h[ke],N||(y.fa=!1)):(y=new K(y,this.src,oe,!!D,te),y.fa=N,h.push(y)),y};function xe(h,y){const N=y.type;if(N in h.g){var D=h.g[N],te=Array.prototype.indexOf.call(D,y,void 0),oe;(oe=te>=0)&&Array.prototype.splice.call(D,te,1),oe&&(ce(y),h.g[N].length==0&&(delete h.g[N],h.h--))}}function Me(h,y,N,D){for(let te=0;te<h.length;++te){const oe=h[te];if(!oe.da&&oe.listener==y&&oe.capture==!!N&&oe.ha==D)return te}return-1}var Ge="closure_lm_"+(Math.random()*1e6|0),xt={};function it(h,y,N,D,te){if(Array.isArray(y)){for(let oe=0;oe<y.length;oe++)it(h,y[oe],N,D,te);return null}return N=At(N),h&&h[P]?h.J(y,N,m(D)?!!D.capture:!1,te):Gt(h,y,N,!1,D,te)}function Gt(h,y,N,D,te,oe){if(!y)throw Error("Invalid event type");const ke=m(te)?!!te.capture:!!te;let ut=Nt(h);if(ut||(h[Ge]=ut=new pe(h)),N=ut.add(y,N,D,ke,oe),N.proxy)return N;if(D=ae(),N.proxy=D,D.src=h,D.listener=N,h.addEventListener)M||(te=ke),te===void 0&&(te=!1),h.addEventListener(y.toString(),D,te);else if(h.attachEvent)h.attachEvent(qe(y.toString()),D);else if(h.addListener&&h.removeListener)h.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return N}function ae(){function h(N){return y.call(h.src,h.listener,N)}const y=Je;return h}function _e(h,y,N,D,te){if(Array.isArray(y))for(var oe=0;oe<y.length;oe++)_e(h,y[oe],N,D,te);else D=m(D)?!!D.capture:!!D,N=At(N),h&&h[P]?(h=h.i,oe=String(y).toString(),oe in h.g&&(y=h.g[oe],N=Me(y,N,D,te),N>-1&&(ce(y[N]),Array.prototype.splice.call(y,N,1),y.length==0&&(delete h.g[oe],h.h--)))):h&&(h=Nt(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Me(y,N,D,te)),(N=h>-1?y[h]:null)&&Ee(N))}function Ee(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[P])xe(y.i,h);else{var N=h.type,D=h.proxy;y.removeEventListener?y.removeEventListener(N,D,h.capture):y.detachEvent?y.detachEvent(qe(N),D):y.addListener&&y.removeListener&&y.removeListener(D),(N=Nt(y))?(xe(N,h),N.h==0&&(N.src=null,y[Ge]=null)):ce(h)}}}function qe(h){return h in xt?xt[h]:xt[h]="on"+h}function Je(h,y){if(h.da)h=!0;else{y=new F(y,this);const N=h.listener,D=h.ha||h.src;h.fa&&Ee(h),h=N.call(D,y)}return h}function Nt(h){return h=h[Ge],h instanceof pe?h:null}var Vs="__closure_events_fn_"+(Math.random()*1e9>>>0);function At(h){return typeof h=="function"?h:(h[Vs]||(h[Vs]=function(y){return h.handleEvent(y)}),h[Vs])}function ft(){I.call(this),this.i=new pe(this),this.M=this,this.G=null}w(ft,I),ft.prototype[P]=!0,ft.prototype.removeEventListener=function(h,y,N,D){_e(this,h,y,N,D)};function Ie(h,y){var N,D=h.G;if(D)for(N=[];D;D=D.G)N.push(D);if(h=h.M,D=y.type||y,typeof y=="string")y=new k(y,h);else if(y instanceof k)y.target=y.target||h;else{var te=y;y=new k(D,h),le(y,te)}te=!0;let oe,ke;if(N)for(ke=N.length-1;ke>=0;ke--)oe=y.g=N[ke],te=Be(oe,D,!0,y)&&te;if(oe=y.g=h,te=Be(oe,D,!0,y)&&te,te=Be(oe,D,!1,y)&&te,N)for(ke=0;ke<N.length;ke++)oe=y.g=N[ke],te=Be(oe,D,!1,y)&&te}ft.prototype.N=function(){if(ft.Z.N.call(this),this.i){var h=this.i;for(const y in h.g){const N=h.g[y];for(let D=0;D<N.length;D++)ce(N[D]);delete h.g[y],h.h--}}this.G=null},ft.prototype.J=function(h,y,N,D){return this.i.add(String(h),y,!1,N,D)},ft.prototype.K=function(h,y,N,D){return this.i.add(String(h),y,!0,N,D)};function Be(h,y,N,D){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();let te=!0;for(let oe=0;oe<y.length;++oe){const ke=y[oe];if(ke&&!ke.da&&ke.capture==N){const ut=ke.listener,gs=ke.ha||ke.src;ke.fa&&xe(h.i,ke),te=ut.call(gs,D)!==!1&&te}}return te&&!D.defaultPrevented}function fe(h,y){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:d.setTimeout(h,y||0)}function ze(h){h.g=fe(()=>{h.g=null,h.i&&(h.i=!1,ze(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Ve extends I{constructor(y,N){super(),this.m=y,this.l=N,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:ze(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function De(h){I.call(this),this.h=h,this.g={}}w(De,I);var He=[];function Ye(h){Se(h.g,function(y,N){this.g.hasOwnProperty(N)&&Ee(y)},h),h.g={}}De.prototype.N=function(){De.Z.N.call(this),Ye(this)},De.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Z=d.JSON.stringify,Ce=d.JSON.parse,We=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function tt(){}function kt(){}var Lt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function _t(){k.call(this,"d")}w(_t,k);function ss(){k.call(this,"c")}w(ss,k);var It={},Qs=null;function Is(){return Qs=Qs||new ft}It.Ia="serverreachability";function Ea(h){k.call(this,It.Ia,h)}w(Ea,k);function $(h){const y=Is();Ie(y,new Ea(y))}It.STAT_EVENT="statevent";function H(h,y){k.call(this,It.STAT_EVENT,h),this.stat=y}w(H,k);function ee(h){const y=Is();Ie(y,new H(y,h))}It.Ja="timingevent";function de(h,y){k.call(this,It.Ja,h),this.size=y}w(de,k);function Te(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},y)}function Oe(){this.g=!0}Oe.prototype.ua=function(){this.g=!1};function Ae(h,y,N,D,te,oe){h.info(function(){if(h.g)if(oe){var ke="",ut=oe.split("&");for(let Dt=0;Dt<ut.length;Dt++){var gs=ut[Dt].split("=");if(gs.length>1){const ls=gs[0];gs=gs[1];const Hn=ls.split("_");ke=Hn.length>=2&&Hn[1]=="type"?ke+(ls+"="+gs+"&"):ke+(ls+"=redacted&")}}}else ke=null;else ke=oe;return"XMLHTTP REQ ("+D+") [attempt "+te+"]: "+y+`
`+N+`
`+ke})}function je(h,y,N,D,te,oe,ke){h.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+te+"]: "+y+`
`+N+`
`+oe+" "+ke})}function Ze(h,y,N,D){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+ns(h,N)+(D?" "+D:"")})}function St(h,y){h.info(function(){return"TIMEOUT: "+y})}Oe.prototype.info=function(){};function ns(h,y){if(!h.g)return y;if(!y)return null;try{const oe=JSON.parse(y);if(oe){for(h=0;h<oe.length;h++)if(Array.isArray(oe[h])){var N=oe[h];if(!(N.length<2)){var D=N[1];if(Array.isArray(D)&&!(D.length<1)){var te=D[0];if(te!="noop"&&te!="stop"&&te!="close")for(let ke=1;ke<D.length;ke++)D[ke]=""}}}}return Z(oe)}catch{return y}}var as={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Sn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},zn;function ia(){}w(ia,tt),ia.prototype.g=function(){return new XMLHttpRequest},zn=new ia;function us(h){return encodeURIComponent(String(h))}function tr(h){var y=1;h=h.split(":");const N=[];for(;y>0&&h.length;)N.push(h.shift()),y--;return h.length&&N.push(h.join(":")),N}function rs(h,y,N,D){this.j=h,this.i=y,this.l=N,this.S=D||1,this.V=new De(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ks}function Ks(){this.i=null,this.g="",this.h=!1}var is={},ws={};function En(h,y,N){h.M=1,h.A=Ui(_s(y)),h.u=N,h.R=!0,Li(h,null)}function Li(h,y){h.F=Date.now(),Ta(h),h.B=_s(h.A);var N=h.B,D=h.S;Array.isArray(D)||(D=[String(D)]),Ml(N.i,"t",D),h.C=0,N=h.j.L,h.h=new Ks,h.g=hd(h.j,N?y:null,!h.u),h.P>0&&(h.O=new Ve(g(h.Y,h,h.g),h.P)),y=h.V,N=h.g,D=h.ba;var te="readystatechange";Array.isArray(te)||(te&&(He[0]=te.toString()),te=He);for(let oe=0;oe<te.length;oe++){const ke=it(N,te[oe],D||y.handleEvent,!1,y.h||y);if(!ke)break;y.g[ke.key]=ke}y=h.J?B(h.J):{},h.u?(h.v||(h.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,y)):(h.v="GET",h.g.ea(h.B,h.v,null,y)),$(),Ae(h.i,h.v,h.B,h.l,h.S,h.u)}rs.prototype.ba=function(h){h=h.target;const y=this.O;y&&ca(h)==3?y.j():this.Y(h)},rs.prototype.Y=function(h){try{if(h==this.g)e:{const ut=ca(this.g),gs=this.g.ya(),Dt=this.g.ca();if(!(ut<3)&&(ut!=3||this.g&&(this.h.h||this.g.la()||zs(this.g)))){this.K||ut!=4||gs==7||(gs==8||Dt<=0?$(3):$(2)),Aa(this);var y=this.g.ca();this.X=y;var N=lm(this);if(this.o=y==200,je(this.i,this.v,this.B,this.l,this.S,ut,y),this.o){if(this.U&&!this.L){t:{if(this.g){var D,te=this.g;if((D=te.g?te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(D)){var oe=D;break t}}oe=null}if(h=oe)Ze(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ka(this,h);else{this.o=!1,this.m=3,ee(12),Tn(this),Fn(this);break e}}if(this.R){h=!0;let ls;for(;!this.K&&this.C<N.length;)if(ls=Zu(this,N),ls==ws){ut==4&&(this.m=4,ee(14),h=!1),Ze(this.i,this.l,null,"[Incomplete Response]");break}else if(ls==is){this.m=4,ee(15),Ze(this.i,this.l,N,"[Invalid Chunk]"),h=!1;break}else Ze(this.i,this.l,ls,null),ka(this,ls);if(Ju(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ut!=4||N.length!=0||this.h.h||(this.m=1,ee(16),h=!1),this.o=this.o&&h,!h)Ze(this.i,this.l,N,"[Invalid Chunked Response]"),Tn(this),Fn(this);else if(N.length>0&&!this.W){this.W=!0;var ke=this.j;ke.g==this&&ke.aa&&!ke.P&&(ke.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),hc(ke),ke.P=!0,ee(11))}}else Ze(this.i,this.l,N,null),ka(this,N);ut==4&&Tn(this),this.o&&!this.K&&(ut==4?od(this.j,this):(this.o=!1,Ta(this)))}else nr(this.g),y==400&&N.indexOf("Unknown SID")>0?(this.m=3,ee(12)):(this.m=0,ee(13)),Tn(this),Fn(this)}}}catch{}};function lm(h){if(!Ju(h))return h.g.la();const y=zs(h.g);if(y==="")return"";let N="";const D=y.length,te=ca(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Tn(h),Fn(h),"";h.h.i=new d.TextDecoder}for(let oe=0;oe<D;oe++)h.h.h=!0,N+=h.h.i.decode(y[oe],{stream:!(te&&oe==D-1)});return y.length=0,h.h.g+=N,h.C=0,h.h.g}function Ju(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Zu(h,y){var N=h.C,D=y.indexOf(`
`,N);return D==-1?ws:(N=Number(y.substring(N,D)),isNaN(N)?is:(D+=1,D+N>y.length?ws:(y=y.slice(D,D+N),h.C=D+N,y)))}rs.prototype.cancel=function(){this.K=!0,Tn(this)};function Ta(h){h.T=Date.now()+h.H,Rl(h,h.H)}function Rl(h,y){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Te(g(h.aa,h),y)}function Aa(h){h.D&&(d.clearTimeout(h.D),h.D=null)}rs.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(St(this.i,this.B),this.M!=2&&($(),ee(17)),Tn(this),this.m=2,Fn(this)):Rl(this,this.T-h)};function Fn(h){h.j.I==0||h.K||od(h.j,h)}function Tn(h){Aa(h);var y=h.O;y&&typeof y.dispose=="function"&&y.dispose(),h.O=null,Ye(h.V),h.g&&(y=h.g,h.g=null,y.abort(),y.dispose())}function ka(h,y){try{var N=h.j;if(N.I!=0&&(N.g==h||Ra(N.h,h))){if(!h.L&&Ra(N.h,h)&&N.I==3){try{var D=N.Ba.g.parse(y)}catch{D=null}if(Array.isArray(D)&&D.length==3){var te=D;if(te[0]==0){e:if(!N.v){if(N.g)if(N.g.F+3e3<h.F)Ul(N),Fr(N);else break e;Gi(N),ee(18)}}else N.xa=te[1],0<N.xa-N.K&&te[2]<37500&&N.F&&N.A==0&&!N.C&&(N.C=Te(g(N.Va,N),6e3));Ca(N.h)<=1&&N.ta&&(N.ta=void 0)}else Va(N,11)}else if((h.L||N.g==h)&&Ul(N),!C(y))for(te=N.Ba.g.parse(y),y=0;y<te.length;y++){let Dt=te[y];const ls=Dt[0];if(!(ls<=N.K))if(N.K=ls,Dt=Dt[1],N.I==2)if(Dt[0]=="c"){N.M=Dt[1],N.ba=Dt[2];const Hn=Dt[3];Hn!=null&&(N.ka=Hn,N.j.info("VER="+N.ka));const La=Dt[4];La!=null&&(N.za=La,N.j.info("SVER="+N.za));const ua=Dt[5];ua!=null&&typeof ua=="number"&&ua>0&&(D=1.5*ua,N.O=D,N.j.info("backChannelRequestTimeoutMs_="+D)),D=N;const da=h.g;if(da){const Yi=da.g?da.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yi){var oe=D.h;oe.g||Yi.indexOf("spdy")==-1&&Yi.indexOf("quic")==-1&&Yi.indexOf("h2")==-1||(oe.j=oe.l,oe.g=new Set,oe.h&&(ec(oe,oe.h),oe.h=null))}if(D.G){const Bl=da.g?da.g.getResponseHeader("X-HTTP-Session-Id"):null;Bl&&(D.wa=Bl,Ut(D.J,D.G,Bl))}}N.I=3,N.l&&N.l.ra(),N.aa&&(N.T=Date.now()-h.F,N.j.info("Handshake RTT: "+N.T+"ms")),D=N;var ke=h;if(D.na=dd(D,D.L?D.ba:null,D.W),ke.L){tc(D.h,ke);var ut=ke,gs=D.O;gs&&(ut.H=gs),ut.D&&(Aa(ut),Ta(ut)),D.g=ke}else id(D);N.i.length>0&&Pa(N)}else Dt[0]!="stop"&&Dt[0]!="close"||Va(N,7);else N.I==3&&(Dt[0]=="stop"||Dt[0]=="close"?Dt[0]=="stop"?Va(N,7):uc(N):Dt[0]!="noop"&&N.l&&N.l.qa(Dt),N.A=0)}}$(4)}catch{}}var Ns=class{constructor(h,y){this.g=h,this.map=y}};function Jo(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Zo(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ca(h){return h.h?1:h.g?h.g.size:0}function Ra(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function ec(h,y){h.g?h.g.add(y):h.h=y}function tc(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Jo.prototype.cancel=function(){if(this.i=sc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function sc(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const N of h.g.values())y=y.concat(N.G);return y}return R(h.i)}var ed=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Il(h,y){if(h){h=h.split("&");for(let N=0;N<h.length;N++){const D=h[N].indexOf("=");let te,oe=null;D>=0?(te=h[N].substring(0,D),oe=h[N].substring(D+1)):te=h[N],y(te,oe?decodeURIComponent(oe.replace(/\+/g," ")):"")}}}function An(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;h instanceof An?(this.l=h.l,Ls(this,h.j),this.o=h.o,this.g=h.g,Or(this,h.u),this.h=h.h,nc(this,ad(h.i)),this.m=h.m):h&&(y=String(h).match(ed))?(this.l=!1,Ls(this,y[1]||"",!0),this.o=Ia(y[2]||""),this.g=Ia(y[3]||"",!0),Or(this,y[4]),this.h=Ia(y[5]||"",!0),nc(this,y[6]||"",!0),this.m=Ia(y[7]||"")):(this.l=!1,this.i=new Vr(null,this.l))}An.prototype.toString=function(){const h=[];var y=this.j;y&&h.push(Bi(y,Dl,!0),":");var N=this.g;return(N||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Bi(y,Dl,!0),"@"),h.push(us(N).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N=this.u,N!=null&&h.push(":",String(N))),(N=this.h)&&(this.g&&N.charAt(0)!="/"&&h.push("/"),h.push(Bi(N,N.charAt(0)=="/"?ac:td,!0))),(N=this.i.toString())&&h.push("?",N),(N=this.m)&&h.push("#",Bi(N,sd)),h.join("")},An.prototype.resolve=function(h){const y=_s(this);let N=!!h.j;N?Ls(y,h.j):N=!!h.o,N?y.o=h.o:N=!!h.g,N?y.g=h.g:N=h.u!=null;var D=h.h;if(N)Or(y,h.u);else if(N=!!h.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var te=y.h.lastIndexOf("/");te!=-1&&(D=y.h.slice(0,te+1)+D)}if(te=D,te==".."||te==".")D="";else if(te.indexOf("./")!=-1||te.indexOf("/.")!=-1){D=te.lastIndexOf("/",0)==0,te=te.split("/");const oe=[];for(let ke=0;ke<te.length;){const ut=te[ke++];ut=="."?D&&ke==te.length&&oe.push(""):ut==".."?((oe.length>1||oe.length==1&&oe[0]!="")&&oe.pop(),D&&ke==te.length&&oe.push("")):(oe.push(ut),D=!0)}D=oe.join("/")}else D=te}return N?y.h=D:N=h.i.toString()!=="",N?nc(y,ad(h.i)):N=!!h.m,N&&(y.m=h.m),y};function _s(h){return new An(h)}function Ls(h,y,N){h.j=N?Ia(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Or(h,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);h.u=y}else h.u=null}function nc(h,y,N){y instanceof Vr?(h.i=y,Ol(h.i,h.l)):(N||(y=Bi(y,Pr)),h.i=new Vr(y,h.l))}function Ut(h,y,N){h.i.set(y,N)}function Ui(h){return Ut(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Ia(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Bi(h,y,N){return typeof h=="string"?(h=encodeURI(h).replace(y,on),N&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function on(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Dl=/[#\/\?@]/g,td=/[#\?:]/g,ac=/[#\?]/g,Pr=/[#\?@]/g,sd=/#/g;function Vr(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function cn(h){h.g||(h.g=new Map,h.h=0,h.i&&Il(h.i,function(y,N){h.add(decodeURIComponent(y.replace(/\+/g," ")),N)}))}n=Vr.prototype,n.add=function(h,y){cn(this),this.i=null,h=Lr(this,h);let N=this.g.get(h);return N||this.g.set(h,N=[]),N.push(y),this.h+=1,this};function nd(h,y){cn(h),y=Lr(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function rc(h,y){return cn(h),y=Lr(h,y),h.g.has(y)}n.forEach=function(h,y){cn(this),this.g.forEach(function(N,D){N.forEach(function(te){h.call(y,te,D,this)},this)},this)};function ic(h,y){cn(h);let N=[];if(typeof y=="string")rc(h,y)&&(N=N.concat(h.g.get(Lr(h,y))));else for(h=Array.from(h.g.values()),y=0;y<h.length;y++)N=N.concat(h[y]);return N}n.set=function(h,y){return cn(this),this.i=null,h=Lr(this,h),rc(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=ic(this,h),h.length>0?String(h[0]):y):y};function Ml(h,y,N){nd(h,y),N.length>0&&(h.i=null,h.g.set(Lr(h,y),R(N)),h.h+=N.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(let D=0;D<y.length;D++){var N=y[D];const te=us(N);N=ic(this,N);for(let oe=0;oe<N.length;oe++){let ke=te;N[oe]!==""&&(ke+="="+us(N[oe])),h.push(ke)}}return this.i=h.join("&")};function ad(h){const y=new Vr;return y.i=h.i,h.g&&(y.g=new Map(h.g),y.h=h.h),y}function Lr(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Ol(h,y){y&&!h.j&&(cn(h),h.i=null,h.g.forEach(function(N,D){const te=D.toLowerCase();D!=te&&(nd(this,D),Ml(this,te,N))},h)),h.j=y}function la(h,y){const N=new Oe;if(d.Image){const D=new Image;D.onload=b($n,N,"TestLoadImage: loaded",!0,y,D),D.onerror=b($n,N,"TestLoadImage: error",!1,y,D),D.onabort=b($n,N,"TestLoadImage: abort",!1,y,D),D.ontimeout=b($n,N,"TestLoadImage: timeout",!1,y,D),d.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=h}else y(!1)}function lc(h,y){const N=new Oe,D=new AbortController,te=setTimeout(()=>{D.abort(),$n(N,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:D.signal}).then(oe=>{clearTimeout(te),oe.ok?$n(N,"TestPingServer: ok",!0,y):$n(N,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(te),$n(N,"TestPingServer: error",!1,y)})}function $n(h,y,N,D,te){try{te&&(te.onload=null,te.onerror=null,te.onabort=null,te.ontimeout=null),D(N)}catch{}}function Ur(){this.g=new We}function Da(h){this.i=h.Sb||null,this.h=h.ab||!1}w(Da,tt),Da.prototype.g=function(){return new zi(this.i,this.h)};function zi(h,y){ft.call(this),this.H=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(zi,ft),n=zi.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=y,this.readyState=1,oa(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(y.body=h),(this.H||d).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Br(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,oa(this)),this.g&&(this.readyState=3,oa(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Pl(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Pl(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Br(this):oa(this),this.readyState==3&&Pl(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,Br(this))},n.Na=function(h){this.g&&(this.response=h,Br(this))},n.ga=function(){this.g&&Br(this)};function Br(h){h.readyState=4,h.l=null,h.j=null,h.B=null,oa(h)}n.setRequestHeader=function(h,y){this.A.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var N=y.next();!N.done;)N=N.value,h.push(N[0]+": "+N[1]),N=y.next();return h.join(`\r
`)};function oa(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(zi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function qn(h){let y="";return Se(h,function(N,D){y+=D,y+=":",y+=N,y+=`\r
`}),y}function Fi(h,y,N){e:{for(D in N){var D=!1;break e}D=!0}D||(N=qn(N),typeof h=="string"?N!=null&&us(N):Ut(h,y,N))}function Ft(h){ft.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(Ft,ft);var Ma=/^https?$/i,oc=["POST","PUT"];n=Ft.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,y,N,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():zn.g(),this.g.onreadystatechange=j(g(this.Ca,this));try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(oe){$i(this,oe);return}if(h=N||"",N=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var te in D)N.set(te,D[te]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const oe of D.keys())N.set(oe,D.get(oe));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(N.keys()).find(oe=>oe.toLowerCase()=="content-type"),te=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(oc,y,void 0)>=0)||D||te||N.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[oe,ke]of N)this.g.setRequestHeader(oe,ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(oe){$i(this,oe)}};function $i(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.o=5,cc(h),sr(h)}function cc(h){h.A||(h.A=!0,Ie(h,"complete"),Ie(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ie(this,"complete"),Ie(this,"abort"),sr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),sr(this,!0)),Ft.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?qi(this):this.Xa())},n.Xa=function(){qi(this)};function qi(h){if(h.h&&typeof c<"u"){if(h.v&&ca(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ie(h,"readystatechange"),ca(h)==4){h.h=!1;try{const oe=h.ca();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var N;if(!(N=y)){var D;if(D=oe===0){let ke=String(h.D).match(ed)[1]||null;!ke&&d.self&&d.self.location&&(ke=d.self.location.protocol.slice(0,-1)),D=!Ma.test(ke?ke.toLowerCase():"")}N=D}if(N)Ie(h,"complete"),Ie(h,"success");else{h.o=6;try{var te=ca(h)>2?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.ca()+"]",cc(h)}}finally{sr(h)}}}}function sr(h,y){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const N=h.g;h.g=null,y||Ie(h,"ready");try{N.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ca(h){return h.g?h.g.readyState:0}n.ca=function(){try{return ca(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),Ce(y)}};function zs(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function nr(h){const y={};h=(h.g&&ca(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<h.length;D++){if(C(h[D]))continue;var N=tr(h[D]);const te=N[0];if(N=N[1],typeof N!="string")continue;N=N.trim();const oe=y[te]||[];y[te]=oe,oe.push(N)}be(y,function(D){return D.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Oa(h,y,N){return N&&N.internalChannelParams&&N.internalChannelParams[h]||y}function zr(h){this.za=0,this.i=[],this.j=new Oe,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Oa("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Oa("baseRetryDelayMs",5e3,h),this.Za=Oa("retryDelaySeedMs",1e4,h),this.Ta=Oa("forwardChannelMaxRetries",2,h),this.va=Oa("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Jo(h&&h.concurrentRequestLimit),this.Ba=new Ur,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=zr.prototype,n.ka=8,n.I=1,n.connect=function(h,y,N,D){ee(0),this.W=h,this.H=y||{},N&&D!==void 0&&(this.H.OSID=N,this.H.OAID=D),this.F=this.X,this.J=dd(this,null,this.W),Pa(this)};function uc(h){if(Vl(h),h.I==3){var y=h.V++,N=_s(h.J);if(Ut(N,"SID",h.M),Ut(N,"RID",y),Ut(N,"TYPE","terminate"),Hi(h,N),y=new rs(h,h.j,y),y.M=2,y.A=Ui(_s(N)),N=!1,d.navigator&&d.navigator.sendBeacon)try{N=d.navigator.sendBeacon(y.A.toString(),"")}catch{}!N&&d.Image&&(new Image().src=y.A,N=!0),N||(y.g=hd(y.j,null),y.g.ea(y.A)),y.F=Date.now(),Ta(y)}ud(h)}function Fr(h){h.g&&(hc(h),h.g.cancel(),h.g=null)}function Vl(h){Fr(h),h.v&&(d.clearTimeout(h.v),h.v=null),Ul(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Pa(h){if(!Zo(h.h)&&!h.m){h.m=!0;var y=h.Ea;he||E(),W||(he(),W=!0),T.add(y,h),h.D=0}}function Ll(h,y){return Ca(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=y.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Te(g(h.Ea,h,y),cd(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const te=new rs(this,this.j,h);let oe=this.o;if(this.U&&(oe?(oe=B(oe),le(oe,this.U)):oe=this.U),this.u!==null||this.R||(te.J=oe,oe=null),this.S)e:{for(var y=0,N=0;N<this.i.length;N++){t:{var D=this.i[N];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(y+=D,y>4096){y=N;break e}if(y===4096||N===this.i.length-1){y=N+1;break e}}y=1e3}else y=1e3;y=rd(this,te,y),N=_s(this.J),Ut(N,"RID",h),Ut(N,"CVER",22),this.G&&Ut(N,"X-HTTP-Session-Id",this.G),Hi(this,N),oe&&(this.R?y="headers="+us(qn(oe))+"&"+y:this.u&&Fi(N,this.u,oe)),ec(this.h,te),this.Ra&&Ut(N,"TYPE","init"),this.S?(Ut(N,"$req",y),Ut(N,"SID","null"),te.U=!0,En(te,N,null)):En(te,N,y),this.I=2}}else this.I==3&&(h?dc(this,h):this.i.length==0||Zo(this.h)||dc(this))};function dc(h,y){var N;y?N=y.l:N=h.V++;const D=_s(h.J);Ut(D,"SID",h.M),Ut(D,"RID",N),Ut(D,"AID",h.K),Hi(h,D),h.u&&h.o&&Fi(D,h.u,h.o),N=new rs(h,h.j,N,h.D+1),h.u===null&&(N.J=h.o),y&&(h.i=y.G.concat(h.i)),y=rd(h,N,1e3),N.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),ec(h.h,N),En(N,D,y)}function Hi(h,y){h.H&&Se(h.H,function(N,D){Ut(y,D,N)}),h.l&&Se({},function(N,D){Ut(y,D,N)})}function rd(h,y,N){N=Math.min(h.i.length,N);const D=h.l?g(h.l.Ka,h.l,h):null;e:{var te=h.i;let ut=-1;for(;;){const gs=["count="+N];ut==-1?N>0?(ut=te[0].g,gs.push("ofs="+ut)):ut=0:gs.push("ofs="+ut);let Dt=!0;for(let ls=0;ls<N;ls++){var oe=te[ls].g;const Hn=te[ls].map;if(oe-=ut,oe<0)ut=Math.max(0,te[ls].g-100),Dt=!1;else try{oe="req"+oe+"_"||"";try{var ke=Hn instanceof Map?Hn:Object.entries(Hn);for(const[La,ua]of ke){let da=ua;m(ua)&&(da=Z(ua)),gs.push(oe+La+"="+encodeURIComponent(da))}}catch(La){throw gs.push(oe+"type="+encodeURIComponent("_badmap")),La}}catch{D&&D(Hn)}}if(Dt){ke=gs.join("&");break e}}ke=void 0}return h=h.i.splice(0,N),y.G=h,ke}function id(h){if(!h.g&&!h.v){h.Y=1;var y=h.Da;he||E(),W||(he(),W=!0),T.add(y,h),h.A=0}}function Gi(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Te(g(h.Da,h),cd(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,ld(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Te(g(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ee(10),Fr(this),ld(this))};function hc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function ld(h){h.g=new rs(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var y=_s(h.na);Ut(y,"RID","rpc"),Ut(y,"SID",h.M),Ut(y,"AID",h.K),Ut(y,"CI",h.F?"0":"1"),!h.F&&h.ia&&Ut(y,"TO",h.ia),Ut(y,"TYPE","xmlhttp"),Hi(h,y),h.u&&h.o&&Fi(y,h.u,h.o),h.O&&(h.g.H=h.O);var N=h.g;h=h.ba,N.M=1,N.A=Ui(_s(y)),N.u=null,N.R=!0,Li(N,h)}n.Va=function(){this.C!=null&&(this.C=null,Fr(this),Gi(this),ee(19))};function Ul(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function od(h,y){var N=null;if(h.g==y){Ul(h),hc(h),h.g=null;var D=2}else if(Ra(h.h,y))N=y.G,tc(h.h,y),D=1;else return;if(h.I!=0){if(y.o)if(D==1){N=y.u?y.u.length:0,y=Date.now()-y.F;var te=h.D;D=Is(),Ie(D,new de(D,N)),Pa(h)}else id(h);else if(te=y.m,te==3||te==0&&y.X>0||!(D==1&&Ll(h,y)||D==2&&Gi(h)))switch(N&&N.length>0&&(y=h.h,y.i=y.i.concat(N)),te){case 1:Va(h,5);break;case 4:Va(h,10);break;case 3:Va(h,6);break;default:Va(h,2)}}}function cd(h,y){let N=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(N*=2),N*y}function Va(h,y){if(h.j.info("Error code "+y),y==2){var N=g(h.bb,h),D=h.Ua;const te=!D;D=new An(D||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Ls(D,"https"),Ui(D),te?la(D.toString(),N):lc(D.toString(),N)}else ee(2);h.I=0,h.l&&h.l.pa(y),ud(h),Vl(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),ee(2)):(this.j.info("Failed to ping google.com"),ee(1))};function ud(h){if(h.I=0,h.ja=[],h.l){const y=sc(h.h);(y.length!=0||h.i.length!=0)&&(U(h.ja,y),U(h.ja,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.oa()}}function dd(h,y,N){var D=N instanceof An?_s(N):new An(N);if(D.g!="")y&&(D.g=y+"."+D.g),Or(D,D.u);else{var te=d.location;D=te.protocol,y=y?y+"."+te.hostname:te.hostname,te=+te.port;const oe=new An(null);D&&Ls(oe,D),y&&(oe.g=y),te&&Or(oe,te),N&&(oe.h=N),D=oe}return N=h.G,y=h.wa,N&&y&&Ut(D,N,y),Ut(D,"VER",h.ka),Hi(h,D),D}function hd(h,y,N){if(y&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Aa&&!h.ma?new Ft(new Da({ab:N})):new Ft(h.ma),y.Fa(h.L),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function fd(){}n=fd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function $r(){}$r.prototype.g=function(h,y){return new nn(h,y)};function nn(h,y){ft.call(this),this.g=new zr(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(h?h["X-WebChannel-Client-Profile"]=y.sa:h={"X-WebChannel-Client-Profile":y.sa}),this.g.U=h,(h=y&&y.Qb)&&!C(h)&&(this.g.u=h),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!C(y)&&(this.g.G=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new ar(this)}w(nn,ft),nn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},nn.prototype.close=function(){uc(this.g)},nn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var N={};N.__data__=h,h=N}else this.v&&(N={},N.__data__=Z(h),h=N);y.i.push(new Ns(y.Ya++,h)),y.I==3&&Pa(y)},nn.prototype.N=function(){this.g.l=null,delete this.j,uc(this.g),delete this.g,nn.Z.N.call(this)};function md(h){_t.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const N in y){h=N;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}w(md,_t);function pd(){ss.call(this),this.status=1}w(pd,ss);function ar(h){this.g=h}w(ar,fd),ar.prototype.ra=function(){Ie(this.g,"a")},ar.prototype.qa=function(h){Ie(this.g,new md(h))},ar.prototype.pa=function(h){Ie(this.g,new pd)},ar.prototype.oa=function(){Ie(this.g,"b")},$r.prototype.createWebChannel=$r.prototype.g,nn.prototype.send=nn.prototype.o,nn.prototype.open=nn.prototype.m,nn.prototype.close=nn.prototype.close,Y_=function(){return new $r},G_=function(){return Is()},H_=It,q0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},as.NO_ERROR=0,as.TIMEOUT=8,as.HTTP_ERROR=6,Bh=as,Sn.COMPLETE="complete",q_=Sn,kt.EventType=Lt,Lt.OPEN="a",Lt.CLOSE="b",Lt.ERROR="c",Lt.MESSAGE="d",ft.prototype.listen=ft.prototype.J,lu=kt,Ft.prototype.listenOnce=Ft.prototype.K,Ft.prototype.getLastError=Ft.prototype.Ha,Ft.prototype.getLastErrorCode=Ft.prototype.ya,Ft.prototype.getStatus=Ft.prototype.ca,Ft.prototype.getResponseJson=Ft.prototype.La,Ft.prototype.getResponseText=Ft.prototype.la,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Fa,$_=Ft}).apply(typeof wh<"u"?wh:typeof self<"u"?self:typeof window<"u"?window:{});let Zs=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Zs.UNAUTHENTICATED=new Zs(null),Zs.GOOGLE_CREDENTIALS=new Zs("google-credentials-uid"),Zs.FIRST_PARTY=new Zs("first-party-uid"),Zs.MOCK_USER=new Zs("mock-user");let Yo="12.8.0";function A4(n){Yo=n}const wl=new Ex("@firebase/firestore");function bo(){return wl.logLevel}function Le(n,...e){if(wl.logLevel<=yt.DEBUG){const t=e.map(Vx);wl.debug(`Firestore (${Yo}): ${n}`,...t)}}function Rr(n,...e){if(wl.logLevel<=yt.ERROR){const t=e.map(Vx);wl.error(`Firestore (${Yo}): ${n}`,...t)}}function Io(n,...e){if(wl.logLevel<=yt.WARN){const t=e.map(Vx);wl.warn(`Firestore (${Yo}): ${n}`,...t)}}function Vx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function rt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,W_(n,i,t)}function W_(n,e,t){let i=`FIRESTORE (${Yo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Rr(i),new Error(i)}function Vt(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||W_(e,o,i)}function ct(n,e){return n}const we={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Pe extends Sa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Er{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Q_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class k4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Zs.UNAUTHENTICATED)))}shutdown(){}}class C4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class R4{constructor(e){this.t=e,this.currentUser=Zs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Vt(this.o===void 0,42304);let i=this.i;const o=x=>this.i!==i?(i=this.i,t(x)):Promise.resolve();let c=new Er;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Er,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const x=c;e.enqueueRetryable((async()=>{await x.promise,await o(this.currentUser)}))},m=x=>{Le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=x,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((x=>m(x))),setTimeout((()=>{if(!this.auth){const x=this.t.getImmediate({optional:!0});x?m(x):(Le("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Er)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Vt(typeof i.accessToken=="string",31837,{l:i}),new Q_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Vt(e===null||typeof e=="string",2055,{h:e}),new Zs(e)}}class I4{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Zs.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class D4{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new I4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Zs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Hw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class M4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Vt(this.o===void 0,3512);const i=c=>{c.error!=null&&Le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,Le("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>i(c)))};const o=c=>{Le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>o(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):Le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Hw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Vt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Hw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function O4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Lx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=O4(40);for(let c=0;c<o.length;++c)i.length<20&&o[c]<t&&(i+=e.charAt(o[c]%62))}return i}}function vt(n,e){return n<e?-1:n>e?1:0}function H0(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),c=e.charAt(i);if(o!==c)return g0(o)===g0(c)?vt(o,c):g0(o)?1:-1}return vt(n.length,e.length)}const P4=55296,V4=57343;function g0(n){const e=n.charCodeAt(0);return e>=P4&&e<=V4}function Do(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}const Gw="__name__";class $a{constructor(e,t,i){t===void 0?t=0:t>e.length&&rt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&rt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return $a.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof $a?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const c=$a.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return vt(e.length,t.length)}static compareSegments(e,t){const i=$a.isNumericId(e),o=$a.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?$a.extractNumericId(e).compare($a.extractNumericId(t)):H0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ni.fromString(e.substring(4,e.length-2))}}class Jt extends $a{construct(e,t,i){return new Jt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Pe(we.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new Jt(t)}static emptyPath(){return new Jt([])}}const L4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ys extends $a{construct(e,t,i){return new Ys(e,t,i)}static isValidIdentifier(e){return L4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ys.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Gw}static keyField(){return new Ys([Gw])}static fromServerFormat(e){const t=[];let i="",o=0;const c=()=>{if(i.length===0)throw new Pe(we.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;o<e.length;){const m=e[o];if(m==="\\"){if(o+1===e.length)throw new Pe(we.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const x=e[o+1];if(x!=="\\"&&x!=="."&&x!=="`")throw new Pe(we.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=x,o+=2}else m==="`"?(d=!d,o++):m!=="."||d?(i+=m,o++):(c(),o++)}if(c(),d)throw new Pe(we.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ys(t)}static emptyPath(){return new Ys([])}}class Xe{constructor(e){this.path=e}static fromPath(e){return new Xe(Jt.fromString(e))}static fromName(e){return new Xe(Jt.fromString(e).popFirst(5))}static empty(){return new Xe(Jt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Jt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Jt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xe(new Jt(e.slice()))}}function K_(n,e,t){if(!t)throw new Pe(we.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function U4(n,e,t,i){if(e===!0&&i===!0)throw new Pe(we.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Yw(n){if(!Xe.isDocumentKey(n))throw new Pe(we.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ww(n){if(Xe.isDocumentKey(n))throw new Pe(we.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function X_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Uf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":rt(12329,{type:typeof n})}function wn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Pe(we.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Uf(n);throw new Pe(we.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Cs(n,e){const t={typeString:n};return e&&(t.value=e),t}function qu(n,e){if(!X_(n))throw new Pe(we.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,c="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(o&&typeof d!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(c!==void 0&&d!==c.value){t=`Expected '${i}' field to equal '${c.value}'`;break}}if(t)throw new Pe(we.INVALID_ARGUMENT,t);return!0}const Qw=-62135596800,Kw=1e6;class Ot{static now(){return Ot.fromMillis(Date.now())}static fromDate(e){return Ot.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*Kw);return new Ot(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Pe(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Pe(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Qw)throw new Pe(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Pe(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Kw}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ot._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qu(e,Ot._jsonSchema))return new Ot(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Qw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ot._jsonSchemaVersion="firestore/timestamp/1.0",Ot._jsonSchema={type:Cs("string",Ot._jsonSchemaVersion),seconds:Cs("number"),nanoseconds:Cs("number")};class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new Ot(0,0))}static max(){return new lt(new Ot(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Su=-1;function B4(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=lt.fromTimestamp(i===1e9?new Ot(t+1,0):new Ot(t,i));return new Ti(o,Xe.empty(),e)}function z4(n){return new Ti(n.readTime,n.key,Su)}class Ti{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ti(lt.min(),Xe.empty(),Su)}static max(){return new Ti(lt.max(),Xe.empty(),Su)}}function F4(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Xe.comparator(n.documentKey,e.documentKey),t!==0?t:vt(n.largestBatchId,e.largestBatchId))}const $4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class q4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Wo(n){if(n.code!==we.FAILED_PRECONDITION||n.message!==$4)throw n;Le("LocalStore","Unexpectedly lost primary lease")}class Ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&rt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ne(((i,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(i,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ne?t:Ne.resolve(t)}catch(t){return Ne.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.reject(t)}static resolve(e){return new Ne(((t,i)=>{t(e)}))}static reject(e){return new Ne(((t,i)=>{i(e)}))}static waitFor(e){return new Ne(((t,i)=>{let o=0,c=0,d=!1;e.forEach((m=>{++o,m.next((()=>{++c,d&&c===o&&t()}),(x=>i(x)))})),d=!0,c===o&&t()}))}static or(e){let t=Ne.resolve(!1);for(const i of e)t=t.next((o=>o?Ne.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,c)=>{i.push(t.call(this,o,c))})),this.waitFor(i)}static mapArray(e,t){return new Ne(((i,o)=>{const c=e.length,d=new Array(c);let m=0;for(let x=0;x<c;x++){const g=x;t(e[g]).next((b=>{d[g]=b,++m,m===c&&i(d)}),(b=>o(b)))}}))}static doWhile(e,t){return new Ne(((i,o)=>{const c=()=>{e()===!0?t().next((()=>{c()}),o):i()};c()}))}}function H4(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Qo(n){return n.name==="IndexedDbTransactionError"}class Bf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Bf.ce=-1;const Ux=-1;function zf(n){return n==null}function uf(n){return n===0&&1/n==-1/0}function G4(n){return typeof n=="number"&&Number.isInteger(n)&&!uf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const J_="";function Y4(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Xw(e)),e=W4(n.get(t),e);return Xw(e)}function W4(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case J_:t+="";break;default:t+=c}}return t}function Xw(n){return n+J_+""}function Jw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Pi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Z_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ds{constructor(e,t){this.comparator=e,this.root=t||Gs.EMPTY}insert(e,t){return new ds(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Gs.BLACK,null,null))}remove(e){return new ds(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Nh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Nh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Nh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Nh(this.root,e,this.comparator,!0)}}class Nh{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?i(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gs{constructor(e,t,i,o,c){this.key=e,this.value=t,this.color=i??Gs.RED,this.left=o??Gs.EMPTY,this.right=c??Gs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,c){return new Gs(e??this.key,t??this.value,i??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const c=i(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,i),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Gs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Gs.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw rt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw rt(27949);return e+(this.isRed()?0:1)}}Gs.EMPTY=null,Gs.RED=!0,Gs.BLACK=!1;Gs.EMPTY=new class{constructor(){this.size=0}get key(){throw rt(57766)}get value(){throw rt(16141)}get color(){throw rt(16727)}get left(){throw rt(29726)}get right(){throw rt(36894)}copy(e,t,i,o,c){return this}insert(e,t,i){return new Gs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ps{constructor(e){this.comparator=e,this.data=new ds(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Zw(this.data.getIterator())}getIteratorFrom(e){return new Zw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ps)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ps(this.comparator);return t.data=e,t}}class Zw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Pn{constructor(e){this.fields=e,e.sort(Ys.comparator)}static empty(){return new Pn([])}unionWith(e){let t=new Ps(Ys.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Pn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Do(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class ej extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ws{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new ej("Invalid base64 string: "+c):c}})(e);return new Ws(t)}static fromUint8Array(e){const t=(function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c})(e);return new Ws(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ws.EMPTY_BYTE_STRING=new Ws("");const Q4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ai(n){if(Vt(!!n,39018),typeof n=="string"){let e=0;const t=Q4.exec(n);if(Vt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:vs(n.seconds),nanos:vs(n.nanos)}}function vs(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ki(n){return typeof n=="string"?Ws.fromBase64String(n):Ws.fromUint8Array(n)}const tj="server_timestamp",sj="__type__",nj="__previous_value__",aj="__local_write_time__";function Bx(n){return(n?.mapValue?.fields||{})[sj]?.stringValue===tj}function Ff(n){const e=n.mapValue.fields[nj];return Bx(e)?Ff(e):e}function Eu(n){const e=Ai(n.mapValue.fields[aj].timestampValue);return new Ot(e.seconds,e.nanos)}class K4{constructor(e,t,i,o,c,d,m,x,g,b,w){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=m,this.longPollingOptions=x,this.useFetchStreams=g,this.isUsingEmulator=b,this.apiKey=w}}const df="(default)";class Tu{constructor(e,t){this.projectId=e,this.database=t||df}static empty(){return new Tu("","")}get isDefaultDatabase(){return this.database===df}isEqual(e){return e instanceof Tu&&e.projectId===this.projectId&&e.database===this.database}}function X4(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Pe(we.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tu(n.options.projectId,e)}const rj="__type__",J4="__max__",_h={mapValue:{}},ij="__vector__",hf="value";function Ci(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Bx(n)?4:eR(n)?9007199254740991:Z4(n)?10:11:rt(28295,{value:n})}function Ja(n,e){if(n===e)return!0;const t=Ci(n);if(t!==Ci(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Eu(n).isEqual(Eu(e));case 3:return(function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=Ai(o.timestampValue),m=Ai(c.timestampValue);return d.seconds===m.seconds&&d.nanos===m.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,c){return ki(o.bytesValue).isEqual(ki(c.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,c){return vs(o.geoPointValue.latitude)===vs(c.geoPointValue.latitude)&&vs(o.geoPointValue.longitude)===vs(c.geoPointValue.longitude)})(n,e);case 2:return(function(o,c){if("integerValue"in o&&"integerValue"in c)return vs(o.integerValue)===vs(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=vs(o.doubleValue),m=vs(c.doubleValue);return d===m?uf(d)===uf(m):isNaN(d)&&isNaN(m)}return!1})(n,e);case 9:return Do(n.arrayValue.values||[],e.arrayValue.values||[],Ja);case 10:case 11:return(function(o,c){const d=o.mapValue.fields||{},m=c.mapValue.fields||{};if(Jw(d)!==Jw(m))return!1;for(const x in d)if(d.hasOwnProperty(x)&&(m[x]===void 0||!Ja(d[x],m[x])))return!1;return!0})(n,e);default:return rt(52216,{left:n})}}function Au(n,e){return(n.values||[]).find((t=>Ja(t,e)))!==void 0}function Mo(n,e){if(n===e)return 0;const t=Ci(n),i=Ci(e);if(t!==i)return vt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return vt(n.booleanValue,e.booleanValue);case 2:return(function(c,d){const m=vs(c.integerValue||c.doubleValue),x=vs(d.integerValue||d.doubleValue);return m<x?-1:m>x?1:m===x?0:isNaN(m)?isNaN(x)?0:-1:1})(n,e);case 3:return e1(n.timestampValue,e.timestampValue);case 4:return e1(Eu(n),Eu(e));case 5:return H0(n.stringValue,e.stringValue);case 6:return(function(c,d){const m=ki(c),x=ki(d);return m.compareTo(x)})(n.bytesValue,e.bytesValue);case 7:return(function(c,d){const m=c.split("/"),x=d.split("/");for(let g=0;g<m.length&&g<x.length;g++){const b=vt(m[g],x[g]);if(b!==0)return b}return vt(m.length,x.length)})(n.referenceValue,e.referenceValue);case 8:return(function(c,d){const m=vt(vs(c.latitude),vs(d.latitude));return m!==0?m:vt(vs(c.longitude),vs(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return t1(n.arrayValue,e.arrayValue);case 10:return(function(c,d){const m=c.fields||{},x=d.fields||{},g=m[hf]?.arrayValue,b=x[hf]?.arrayValue,w=vt(g?.values?.length||0,b?.values?.length||0);return w!==0?w:t1(g,b)})(n.mapValue,e.mapValue);case 11:return(function(c,d){if(c===_h.mapValue&&d===_h.mapValue)return 0;if(c===_h.mapValue)return 1;if(d===_h.mapValue)return-1;const m=c.fields||{},x=Object.keys(m),g=d.fields||{},b=Object.keys(g);x.sort(),b.sort();for(let w=0;w<x.length&&w<b.length;++w){const j=H0(x[w],b[w]);if(j!==0)return j;const R=Mo(m[x[w]],g[b[w]]);if(R!==0)return R}return vt(x.length,b.length)})(n.mapValue,e.mapValue);default:throw rt(23264,{he:t})}}function e1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return vt(n,e);const t=Ai(n),i=Ai(e),o=vt(t.seconds,i.seconds);return o!==0?o:vt(t.nanos,i.nanos)}function t1(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const c=Mo(t[o],i[o]);if(c)return c}return vt(t.length,i.length)}function Oo(n){return G0(n)}function G0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Ai(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ki(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Xe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const c of t.values||[])o?o=!1:i+=",",i+=G0(c);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of i)c?c=!1:o+=",",o+=`${d}:${G0(t.fields[d])}`;return o+"}"})(n.mapValue):rt(61005,{value:n})}function zh(n){switch(Ci(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ff(n);return e?16+zh(e):16;case 5:return 2*n.stringValue.length;case 6:return ki(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,c)=>o+zh(c)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return Pi(i.fields,((c,d)=>{o+=c.length+zh(d)})),o})(n.mapValue);default:throw rt(13486,{value:n})}}function s1(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Y0(n){return!!n&&"integerValue"in n}function zx(n){return!!n&&"arrayValue"in n}function n1(n){return!!n&&"nullValue"in n}function a1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Fh(n){return!!n&&"mapValue"in n}function Z4(n){return(n?.mapValue?.fields||{})[rj]?.stringValue===ij}function mu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Pi(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=mu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=mu(n.arrayValue.values[t]);return e}return{...n}}function eR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===J4}class gn{constructor(e){this.value=e}static empty(){return new gn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Fh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mu(t)}setAll(e){let t=Ys.emptyPath(),i={},o=[];e.forEach(((d,m)=>{if(!t.isImmediateParentOf(m)){const x=this.getFieldsMap(t);this.applyChanges(x,i,o),i={},o=[],t=m.popLast()}d?i[m.lastSegment()]=mu(d):o.push(m.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,i,o)}delete(e){const t=this.field(e.popLast());Fh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ja(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];Fh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Pi(t,((o,c)=>e[o]=c));for(const o of i)delete e[o]}clone(){return new gn(mu(this.value))}}function lj(n){const e=[];return Pi(n.fields,((t,i)=>{const o=new Ys([t]);if(Fh(i)){const c=lj(i.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)})),new Pn(e)}class en{constructor(e,t,i,o,c,d,m){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=c,this.data=d,this.documentState=m}static newInvalidDocument(e){return new en(e,0,lt.min(),lt.min(),lt.min(),gn.empty(),0)}static newFoundDocument(e,t,i,o){return new en(e,1,t,lt.min(),i,o,0)}static newNoDocument(e,t){return new en(e,2,t,lt.min(),lt.min(),gn.empty(),0)}static newUnknownDocument(e,t){return new en(e,3,t,lt.min(),lt.min(),gn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof en&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new en(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ff{constructor(e,t){this.position=e,this.inclusive=t}}function r1(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?i=Xe.comparator(Xe.fromName(d.referenceValue),t.key):i=Mo(d,t.data.field(c.field)),c.dir==="desc"&&(i*=-1),i!==0)break}return i}function i1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ja(n.position[t],e.position[t]))return!1;return!0}class mf{constructor(e,t="asc"){this.field=e,this.dir=t}}function tR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class oj{}class ks extends oj{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new nR(e,t,i):t==="array-contains"?new iR(e,i):t==="in"?new lR(e,i):t==="not-in"?new oR(e,i):t==="array-contains-any"?new cR(e,i):new ks(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new aR(e,i):new rR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Mo(t,this.value)):t!==null&&Ci(this.value)===Ci(t)&&this.matchesComparison(Mo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return rt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Na extends oj{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Na(e,t)}matches(e){return cj(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function cj(n){return n.op==="and"}function uj(n){return sR(n)&&cj(n)}function sR(n){for(const e of n.filters)if(e instanceof Na)return!1;return!0}function W0(n){if(n instanceof ks)return n.field.canonicalString()+n.op.toString()+Oo(n.value);if(uj(n))return n.filters.map((e=>W0(e))).join(",");{const e=n.filters.map((t=>W0(t))).join(",");return`${n.op}(${e})`}}function dj(n,e){return n instanceof ks?(function(i,o){return o instanceof ks&&i.op===o.op&&i.field.isEqual(o.field)&&Ja(i.value,o.value)})(n,e):n instanceof Na?(function(i,o){return o instanceof Na&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((c,d,m)=>c&&dj(d,o.filters[m])),!0):!1})(n,e):void rt(19439)}function hj(n){return n instanceof ks?(function(t){return`${t.field.canonicalString()} ${t.op} ${Oo(t.value)}`})(n):n instanceof Na?(function(t){return t.op.toString()+" {"+t.getFilters().map(hj).join(" ,")+"}"})(n):"Filter"}class nR extends ks{constructor(e,t,i){super(e,t,i),this.key=Xe.fromName(i.referenceValue)}matches(e){const t=Xe.comparator(e.key,this.key);return this.matchesComparison(t)}}class aR extends ks{constructor(e,t){super(e,"in",t),this.keys=fj("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class rR extends ks{constructor(e,t){super(e,"not-in",t),this.keys=fj("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function fj(n,e){return(e.arrayValue?.values||[]).map((t=>Xe.fromName(t.referenceValue)))}class iR extends ks{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return zx(t)&&Au(t.arrayValue,this.value)}}class lR extends ks{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Au(this.value.arrayValue,t)}}class oR extends ks{constructor(e,t){super(e,"not-in",t)}matches(e){if(Au(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Au(this.value.arrayValue,t)}}class cR extends ks{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!zx(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Au(this.value.arrayValue,i)))}}class uR{constructor(e,t=null,i=[],o=[],c=null,d=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=c,this.startAt=d,this.endAt=m,this.Te=null}}function l1(n,e=null,t=[],i=[],o=null,c=null,d=null){return new uR(n,e,t,i,o,c,d)}function Fx(n){const e=ct(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>W0(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(c){return c.field.canonicalString()+c.dir})(i))).join(","),zf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Oo(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Oo(i))).join(",")),e.Te=t}return e.Te}function $x(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!tR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!dj(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!i1(n.startAt,e.startAt)&&i1(n.endAt,e.endAt)}function Q0(n){return Xe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Hu{constructor(e,t=null,i=[],o=[],c=null,d="F",m=null,x=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=c,this.limitType=d,this.startAt=m,this.endAt=x,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function dR(n,e,t,i,o,c,d,m){return new Hu(n,e,t,i,o,c,d,m)}function $f(n){return new Hu(n)}function o1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function hR(n){return Xe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function mj(n){return n.collectionGroup!==null}function pu(n){const e=ct(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),t.add(c.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let m=new Ps(Ys.comparator);return d.filters.forEach((x=>{x.getFlattenedFilters().forEach((g=>{g.isInequality()&&(m=m.add(g.field))}))})),m})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new mf(c,i))})),t.has(Ys.keyField().canonicalString())||e.Ie.push(new mf(Ys.keyField(),i))}return e.Ie}function Qa(n){const e=ct(n);return e.Ee||(e.Ee=fR(e,pu(n))),e.Ee}function fR(n,e){if(n.limitType==="F")return l1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const c=o.dir==="desc"?"asc":"desc";return new mf(o.field,c)}));const t=n.endAt?new ff(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new ff(n.startAt.position,n.startAt.inclusive):null;return l1(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function K0(n,e){const t=n.filters.concat([e]);return new Hu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function X0(n,e,t){return new Hu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function qf(n,e){return $x(Qa(n),Qa(e))&&n.limitType===e.limitType}function pj(n){return`${Fx(Qa(n))}|lt:${n.limitType}`}function yo(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>hj(o))).join(", ")}]`),zf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>Oo(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>Oo(o))).join(",")),`Target(${i})`})(Qa(n))}; limitType=${n.limitType})`}function Hf(n,e){return e.isFoundDocument()&&(function(i,o){const c=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(c):Xe.isDocumentKey(i.path)?i.path.isEqual(c):i.path.isImmediateParentOf(c)})(n,e)&&(function(i,o){for(const c of pu(i))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const c of i.filters)if(!c.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(d,m,x){const g=r1(d,m,x);return d.inclusive?g<=0:g<0})(i.startAt,pu(i),o)||i.endAt&&!(function(d,m,x){const g=r1(d,m,x);return d.inclusive?g>=0:g>0})(i.endAt,pu(i),o))})(n,e)}function mR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function xj(n){return(e,t)=>{let i=!1;for(const o of pu(n)){const c=pR(o,e,t);if(c!==0)return c;i=i||o.field.isKeyField()}return 0}}function pR(n,e,t){const i=n.field.isKeyField()?Xe.comparator(e.key,t.key):(function(c,d,m){const x=d.data.field(c),g=m.data.field(c);return x!==null&&g!==null?Mo(x,g):rt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return rt(19790,{direction:n.dir})}}class Al{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,c]of i)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Pi(this.inner,((t,i)=>{for(const[o,c]of i)e(o,c)}))}isEmpty(){return Z_(this.inner)}size(){return this.innerSize}}const xR=new ds(Xe.comparator);function Ir(){return xR}const gj=new ds(Xe.comparator);function ou(...n){let e=gj;for(const t of n)e=e.insert(t.key,t);return e}function bj(n){let e=gj;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function fl(){return xu()}function yj(){return xu()}function xu(){return new Al((n=>n.toString()),((n,e)=>n.isEqual(e)))}const gR=new ds(Xe.comparator),bR=new Ps(Xe.comparator);function wt(...n){let e=bR;for(const t of n)e=e.add(t);return e}const yR=new Ps(vt);function vR(){return yR}function qx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uf(e)?"-0":e}}function vj(n){return{integerValue:""+n}}function wR(n,e){return G4(e)?vj(e):qx(n,e)}class Gf{constructor(){this._=void 0}}function NR(n,e,t){return n instanceof ku?(function(o,c){const d={fields:{[sj]:{stringValue:tj},[aj]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Bx(c)&&(c=Ff(c)),c&&(d.fields[nj]=c),{mapValue:d}})(t,e):n instanceof Cu?Nj(n,e):n instanceof Ru?_j(n,e):(function(o,c){const d=wj(o,c),m=c1(d)+c1(o.Ae);return Y0(d)&&Y0(o.Ae)?vj(m):qx(o.serializer,m)})(n,e)}function _R(n,e,t){return n instanceof Cu?Nj(n,e):n instanceof Ru?_j(n,e):t}function wj(n,e){return n instanceof pf?(function(i){return Y0(i)||(function(c){return!!c&&"doubleValue"in c})(i)})(e)?e:{integerValue:0}:null}class ku extends Gf{}class Cu extends Gf{constructor(e){super(),this.elements=e}}function Nj(n,e){const t=jj(e);for(const i of n.elements)t.some((o=>Ja(o,i)))||t.push(i);return{arrayValue:{values:t}}}class Ru extends Gf{constructor(e){super(),this.elements=e}}function _j(n,e){let t=jj(e);for(const i of n.elements)t=t.filter((o=>!Ja(o,i)));return{arrayValue:{values:t}}}class pf extends Gf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function c1(n){return vs(n.integerValue||n.doubleValue)}function jj(n){return zx(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class jR{constructor(e,t){this.field=e,this.transform=t}}function SR(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof Cu&&o instanceof Cu||i instanceof Ru&&o instanceof Ru?Do(i.elements,o.elements,Ja):i instanceof pf&&o instanceof pf?Ja(i.Ae,o.Ae):i instanceof ku&&o instanceof ku})(n.transform,e.transform)}class ER{constructor(e,t){this.version=e,this.transformResults=t}}class ra{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ra}static exists(e){return new ra(void 0,e)}static updateTime(e){return new ra(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function $h(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Yf{}function Sj(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Hx(n.key,ra.none()):new Gu(n.key,n.data,ra.none());{const t=n.data,i=gn.empty();let o=new Ps(Ys.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?i.delete(c):i.set(c,d),o=o.add(c)}return new Vi(n.key,i,new Pn(o.toArray()),ra.none())}}function TR(n,e,t){n instanceof Gu?(function(o,c,d){const m=o.value.clone(),x=d1(o.fieldTransforms,c,d.transformResults);m.setAll(x),c.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):n instanceof Vi?(function(o,c,d){if(!$h(o.precondition,c))return void c.convertToUnknownDocument(d.version);const m=d1(o.fieldTransforms,c,d.transformResults),x=c.data;x.setAll(Ej(o)),x.setAll(m),c.convertToFoundDocument(d.version,x).setHasCommittedMutations()})(n,e,t):(function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function gu(n,e,t,i){return n instanceof Gu?(function(c,d,m,x){if(!$h(c.precondition,d))return m;const g=c.value.clone(),b=h1(c.fieldTransforms,x,d);return g.setAll(b),d.convertToFoundDocument(d.version,g).setHasLocalMutations(),null})(n,e,t,i):n instanceof Vi?(function(c,d,m,x){if(!$h(c.precondition,d))return m;const g=h1(c.fieldTransforms,x,d),b=d.data;return b.setAll(Ej(c)),b.setAll(g),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),m===null?null:m.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((w=>w.field)))})(n,e,t,i):(function(c,d,m){return $h(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):m})(n,e,t)}function AR(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),c=wj(i.transform,o||null);c!=null&&(t===null&&(t=gn.empty()),t.set(i.field,c))}return t||null}function u1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Do(i,o,((c,d)=>SR(c,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Gu extends Yf{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Vi extends Yf{constructor(e,t,i,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function Ej(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function d1(n,e,t){const i=new Map;Vt(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,m=e.data.field(c.field);i.set(c.field,_R(d,m,t[o]))}return i}function h1(n,e,t){const i=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);i.set(o.field,NR(c,d,e))}return i}class Hx extends Yf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kR extends Yf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class CR{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&TR(c,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=gu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=gu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=yj();return this.mutations.forEach((o=>{const c=e.get(o.key),d=c.overlayedDocument;let m=this.applyToLocalView(d,c.mutatedFields);m=t.has(o.key)?null:m;const x=Sj(d,m);x!==null&&i.set(o.key,x),d.isValidDocument()||d.convertToNoDocument(lt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),wt())}isEqual(e){return this.batchId===e.batchId&&Do(this.mutations,e.mutations,((t,i)=>u1(t,i)))&&Do(this.baseMutations,e.baseMutations,((t,i)=>u1(t,i)))}}class Gx{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){Vt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return gR})();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,i[d].version);return new Gx(e,t,i,o)}}class RR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class IR{constructor(e,t){this.count=e,this.unchangedNames=t}}var As,Et;function DR(n){switch(n){case we.OK:return rt(64938);case we.CANCELLED:case we.UNKNOWN:case we.DEADLINE_EXCEEDED:case we.RESOURCE_EXHAUSTED:case we.INTERNAL:case we.UNAVAILABLE:case we.UNAUTHENTICATED:return!1;case we.INVALID_ARGUMENT:case we.NOT_FOUND:case we.ALREADY_EXISTS:case we.PERMISSION_DENIED:case we.FAILED_PRECONDITION:case we.ABORTED:case we.OUT_OF_RANGE:case we.UNIMPLEMENTED:case we.DATA_LOSS:return!0;default:return rt(15467,{code:n})}}function Tj(n){if(n===void 0)return Rr("GRPC error has no .code"),we.UNKNOWN;switch(n){case As.OK:return we.OK;case As.CANCELLED:return we.CANCELLED;case As.UNKNOWN:return we.UNKNOWN;case As.DEADLINE_EXCEEDED:return we.DEADLINE_EXCEEDED;case As.RESOURCE_EXHAUSTED:return we.RESOURCE_EXHAUSTED;case As.INTERNAL:return we.INTERNAL;case As.UNAVAILABLE:return we.UNAVAILABLE;case As.UNAUTHENTICATED:return we.UNAUTHENTICATED;case As.INVALID_ARGUMENT:return we.INVALID_ARGUMENT;case As.NOT_FOUND:return we.NOT_FOUND;case As.ALREADY_EXISTS:return we.ALREADY_EXISTS;case As.PERMISSION_DENIED:return we.PERMISSION_DENIED;case As.FAILED_PRECONDITION:return we.FAILED_PRECONDITION;case As.ABORTED:return we.ABORTED;case As.OUT_OF_RANGE:return we.OUT_OF_RANGE;case As.UNIMPLEMENTED:return we.UNIMPLEMENTED;case As.DATA_LOSS:return we.DATA_LOSS;default:return rt(39323,{code:n})}}(Et=As||(As={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";function MR(){return new TextEncoder}const OR=new Ni([4294967295,4294967295],0);function f1(n){const e=MR().encode(n),t=new F_;return t.update(e),new Uint8Array(t.digest())}function m1(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new Ni([t,i],0),new Ni([o,c],0)]}class Yx{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new cu(`Invalid padding: ${t}`);if(i<0)throw new cu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new cu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new cu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ni.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(Ni.fromNumber(i)));return o.compare(OR)===1&&(o=new Ni([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=f1(e),[i,o]=m1(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(i,o,c);if(!this.we(d))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Yx(c,o,t);return i.forEach((m=>d.insert(m))),d}insert(e){if(this.ge===0)return;const t=f1(e),[i,o]=m1(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(i,o,c);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Wf{constructor(e,t,i,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Yu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Wf(lt.min(),o,new ds(vt),Ir(),wt())}}class Yu{constructor(e,t,i,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Yu(i,t,wt(),wt(),wt())}}class qh{constructor(e,t,i,o){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=o}}class Aj{constructor(e,t){this.targetId=e,this.Ce=t}}class kj{constructor(e,t,i=Ws.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class p1{constructor(){this.ve=0,this.Fe=x1(),this.Me=Ws.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=wt(),t=wt(),i=wt();return this.Fe.forEach(((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:rt(38017,{changeType:c})}})),new Yu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=x1()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Vt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class PR{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ir(),this.He=jh(),this.Je=jh(),this.Ze=new ds(vt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:rt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const c=o.target;if(Q0(c))if(i===0){const d=new Xe(c.path);this.et(t,d,en.newNoDocument(d,lt.min()))}else Vt(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const m=this.ut(e),x=m?this.ct(m,e,d):1;if(x!==0){this.it(t);const g=x===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:c=0}=t;let d,m;try{d=ki(i).toUint8Array()}catch(x){if(x instanceof ej)return Io("Decoding the base64 bloom filter in existence filter failed ("+x.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw x}try{m=new Yx(d,o,c)}catch(x){return Io(x instanceof cu?"BloomFilter error: ":"Applying bloom filter failed: ",x),null}return m.ge===0?null:m}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((c=>{const d=this.Ge.ht(),m=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(m)||(this.et(t,c,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((c,d)=>{const m=this.ot(d);if(m){if(c.current&&Q0(m.target)){const x=new Xe(m.target.path);this.It(x).has(d)||this.Et(d,x)||this.et(d,x,en.newNoDocument(x,e))}c.Be&&(t.set(d,c.ke()),c.Ke())}}));let i=wt();this.Je.forEach(((c,d)=>{let m=!0;d.forEachWhile((x=>{const g=this.ot(x);return!g||g.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(i=i.add(c))})),this.je.forEach(((c,d)=>d.setReadTime(e)));const o=new Wf(e,t,this.Ze,this.je,i);return this.je=Ir(),this.He=jh(),this.Je=jh(),this.Ze=new ds(vt),o}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.qe(t,1):o.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new p1,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ps(vt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ps(vt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Le("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new p1),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function jh(){return new ds(Xe.comparator)}function x1(){return new ds(Xe.comparator)}const VR={asc:"ASCENDING",desc:"DESCENDING"},LR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},UR={and:"AND",or:"OR"};class BR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function J0(n,e){return n.useProto3Json||zf(e)?e:{value:e}}function xf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Cj(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function zR(n,e){return xf(n,e.toTimestamp())}function Ka(n){return Vt(!!n,49232),lt.fromTimestamp((function(t){const i=Ai(t);return new Ot(i.seconds,i.nanos)})(n))}function Wx(n,e){return Z0(n,e).canonicalString()}function Z0(n,e){const t=(function(o){return new Jt(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Rj(n){const e=Jt.fromString(n);return Vt(Pj(e),10190,{key:e.toString()}),e}function ex(n,e){return Wx(n.databaseId,e.path)}function b0(n,e){const t=Rj(e);if(t.get(1)!==n.databaseId.projectId)throw new Pe(we.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Pe(we.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Xe(Dj(t))}function Ij(n,e){return Wx(n.databaseId,e)}function FR(n){const e=Rj(n);return e.length===4?Jt.emptyPath():Dj(e)}function tx(n){return new Jt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Dj(n){return Vt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function g1(n,e,t){return{name:ex(n,e),fields:t.value.mapValue.fields}}function $R(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:rt(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=(function(g,b){return g.useProto3Json?(Vt(b===void 0||typeof b=="string",58123),Ws.fromBase64String(b||"")):(Vt(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Ws.fromUint8Array(b||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,m=d&&(function(g){const b=g.code===void 0?we.UNKNOWN:Tj(g.code);return new Pe(b,g.message||"")})(d);t=new kj(i,o,c,m||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=b0(n,i.document.name),c=Ka(i.document.updateTime),d=i.document.createTime?Ka(i.document.createTime):lt.min(),m=new gn({mapValue:{fields:i.document.fields}}),x=en.newFoundDocument(o,c,d,m),g=i.targetIds||[],b=i.removedTargetIds||[];t=new qh(g,b,x.key,x)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=b0(n,i.document),c=i.readTime?Ka(i.readTime):lt.min(),d=en.newNoDocument(o,c),m=i.removedTargetIds||[];t=new qh([],m,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=b0(n,i.document),c=i.removedTargetIds||[];t=new qh([],c,o,null)}else{if(!("filter"in e))return rt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:c}=i,d=new IR(o,c),m=i.targetId;t=new Aj(m,d)}}return t}function qR(n,e){let t;if(e instanceof Gu)t={update:g1(n,e.key,e.value)};else if(e instanceof Hx)t={delete:ex(n,e.key)};else if(e instanceof Vi)t={update:g1(n,e.key,e.data),updateMask:ZR(e.fieldMask)};else{if(!(e instanceof kR))return rt(16599,{dt:e.type});t={verify:ex(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(c,d){const m=d.transform;if(m instanceof ku)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Cu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Ru)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof pf)return{fieldPath:d.field.canonicalString(),increment:m.Ae};throw rt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(o,c){return c.updateTime!==void 0?{updateTime:zR(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:rt(27497)})(n,e.precondition)),t}function HR(n,e){return n&&n.length>0?(Vt(e!==void 0,14353),n.map((t=>(function(o,c){let d=o.updateTime?Ka(o.updateTime):Ka(c);return d.isEqual(lt.min())&&(d=Ka(c)),new ER(d,o.transformResults||[])})(t,e)))):[]}function GR(n,e){return{documents:[Ij(n,e.path)]}}function YR(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Ij(n,o);const c=(function(g){if(g.length!==0)return Oj(Na.create(g,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const d=(function(g){if(g.length!==0)return g.map((b=>(function(j){return{field:vo(j.field),direction:KR(j.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const m=J0(n,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:o}}function WR(n){let e=FR(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){Vt(i===1,65062);const b=t.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let c=[];t.where&&(c=(function(w){const j=Mj(w);return j instanceof Na&&uj(j)?j.getFilters():[j]})(t.where));let d=[];t.orderBy&&(d=(function(w){return w.map((j=>(function(U){return new mf(wo(U.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(U.direction))})(j)))})(t.orderBy));let m=null;t.limit&&(m=(function(w){let j;return j=typeof w=="object"?w.value:w,zf(j)?null:j})(t.limit));let x=null;t.startAt&&(x=(function(w){const j=!!w.before,R=w.values||[];return new ff(R,j)})(t.startAt));let g=null;return t.endAt&&(g=(function(w){const j=!w.before,R=w.values||[];return new ff(R,j)})(t.endAt)),dR(e,o,d,c,m,"F",x,g)}function QR(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Mj(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=wo(t.unaryFilter.field);return ks.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=wo(t.unaryFilter.field);return ks.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=wo(t.unaryFilter.field);return ks.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=wo(t.unaryFilter.field);return ks.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return rt(61313);default:return rt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ks.create(wo(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return rt(58110);default:return rt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Na.create(t.compositeFilter.filters.map((i=>Mj(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return rt(1026)}})(t.compositeFilter.op))})(n):rt(30097,{filter:n})}function KR(n){return VR[n]}function XR(n){return LR[n]}function JR(n){return UR[n]}function vo(n){return{fieldPath:n.canonicalString()}}function wo(n){return Ys.fromServerFormat(n.fieldPath)}function Oj(n){return n instanceof ks?(function(t){if(t.op==="=="){if(a1(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NAN"}};if(n1(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(a1(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NOT_NAN"}};if(n1(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vo(t.field),op:XR(t.op),value:t.value}}})(n):n instanceof Na?(function(t){const i=t.getFilters().map((o=>Oj(o)));return i.length===1?i[0]:{compositeFilter:{op:JR(t.op),filters:i}}})(n):rt(54877,{filter:n})}function ZR(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Pj(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function Vj(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class yi{constructor(e,t,i,o,c=lt.min(),d=lt.min(),m=Ws.EMPTY_BYTE_STRING,x=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=m,this.expectedCount=x}withSequenceNumber(e){return new yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class e6{constructor(e){this.yt=e}}function t6(n){const e=WR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?X0(e,e.limit,"L"):e}class s6{constructor(){this.Sn=new n6}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ne.resolve()}getCollectionParents(e,t){return Ne.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ne.resolve()}deleteFieldIndex(e,t){return Ne.resolve()}deleteAllFieldIndexes(e){return Ne.resolve()}createTargetIndexes(e,t){return Ne.resolve()}getDocumentsMatchingTarget(e,t){return Ne.resolve(null)}getIndexType(e,t){return Ne.resolve(0)}getFieldIndexes(e,t){return Ne.resolve([])}getNextCollectionGroupToUpdate(e){return Ne.resolve(null)}getMinOffset(e,t){return Ne.resolve(Ti.min())}getMinOffsetFromCollectionGroup(e,t){return Ne.resolve(Ti.min())}updateCollectionGroup(e,t,i){return Ne.resolve()}updateIndexEntries(e,t){return Ne.resolve()}}class n6{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new Ps(Jt.comparator),c=!o.has(i);return this.index[t]=o.add(i),c}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new Ps(Jt.comparator)).toArray()}}const b1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Lj=41943040;class pn{static withCacheSize(e){return new pn(e,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}pn.DEFAULT_COLLECTION_PERCENTILE=10,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pn.DEFAULT=new pn(Lj,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pn.DISABLED=new pn(-1,0,0);class Po{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Po(0)}static ar(){return new Po(-1)}}const y1="LruGarbageCollector",a6=1048576;function v1([n,e],[t,i]){const o=vt(n,t);return o===0?vt(e,i):o}class r6{constructor(e){this.Pr=e,this.buffer=new Ps(v1),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();v1(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class i6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Le(y1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Qo(t)?Le(y1,"Ignoring IndexedDB error during garbage collection: ",t):await Wo(t)}await this.Ar(3e5)}))}}class l6{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ne.resolve(Bf.ce);const i=new r6(t);return this.Vr.forEachTarget(e,(o=>i.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>i.Er(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Le("LruGarbageCollector","Garbage collection skipped; disabled"),Ne.resolve(b1)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Le("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),b1):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,o,c,d,m,x,g;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(Le("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),o=this.params.maximumSequenceNumbersToCollect):o=w,d=Date.now(),this.nthSequenceNumber(e,o)))).next((w=>(i=w,m=Date.now(),this.removeTargets(e,i,t)))).next((w=>(c=w,x=Date.now(),this.removeOrphanedDocuments(e,i)))).next((w=>(g=Date.now(),bo()<=yt.DEBUG&&Le("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${o} in `+(m-d)+`ms
	Removed ${c} targets in `+(x-m)+`ms
	Removed ${w} documents in `+(g-x)+`ms
Total Duration: ${g-b}ms`),Ne.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:w}))))}}function o6(n,e){return new l6(n,e)}class c6{constructor(){this.changes=new Al((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,en.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ne.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class u6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class d6{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&gu(i.mutation,o,Pn.empty(),Ot.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,wt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=wt()){const o=fl();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((c=>{let d=ou();return c.forEach(((m,x)=>{d=d.insert(m,x.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=fl();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,wt())))}populateOverlays(e,t,i){const o=[];return i.forEach((c=>{t.has(c)||o.push(c)})),this.documentOverlayCache.getOverlays(e,o).next((c=>{c.forEach(((d,m)=>{t.set(d,m)}))}))}computeViews(e,t,i,o){let c=Ir();const d=xu(),m=(function(){return xu()})();return t.forEach(((x,g)=>{const b=i.get(g.key);o.has(g.key)&&(b===void 0||b.mutation instanceof Vi)?c=c.insert(g.key,g):b!==void 0?(d.set(g.key,b.mutation.getFieldMask()),gu(b.mutation,g,b.mutation.getFieldMask(),Ot.now())):d.set(g.key,Pn.empty())})),this.recalculateAndSaveOverlays(e,c).next((x=>(x.forEach(((g,b)=>d.set(g,b))),t.forEach(((g,b)=>m.set(g,new u6(b,d.get(g)??null)))),m)))}recalculateAndSaveOverlays(e,t){const i=xu();let o=new ds(((d,m)=>d-m)),c=wt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const m of d)m.keys().forEach((x=>{const g=t.get(x);if(g===null)return;let b=i.get(x)||Pn.empty();b=m.applyToLocalView(g,b),i.set(x,b);const w=(o.get(m.batchId)||wt()).add(x);o=o.insert(m.batchId,w)}))})).next((()=>{const d=[],m=o.getReverseIterator();for(;m.hasNext();){const x=m.getNext(),g=x.key,b=x.value,w=yj();b.forEach((j=>{if(!c.has(j)){const R=Sj(t.get(j),i.get(j));R!==null&&w.set(j,R),c=c.add(j)}})),d.push(this.documentOverlayCache.saveOverlays(e,g,w))}return Ne.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return hR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mj(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-c.size):Ne.resolve(fl());let m=Su,x=c;return d.next((g=>Ne.forEach(g,((b,w)=>(m<w.largestBatchId&&(m=w.largestBatchId),c.get(b)?Ne.resolve():this.remoteDocumentCache.getEntry(e,b).next((j=>{x=x.insert(b,j)}))))).next((()=>this.populateOverlays(e,g,c))).next((()=>this.computeViews(e,x,g,wt()))).next((b=>({batchId:m,changes:bj(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xe(t)).next((i=>{let o=ou();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const c=t.collectionGroup;let d=ou();return this.indexManager.getCollectionParents(e,c).next((m=>Ne.forEach(m,(x=>{const g=(function(w,j){return new Hu(j,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,x.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,i,o).next((b=>{b.forEach(((w,j)=>{d=d.insert(w,j)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,c,o)))).next((d=>{c.forEach(((x,g)=>{const b=g.getKey();d.get(b)===null&&(d=d.insert(b,en.newInvalidDocument(b)))}));let m=ou();return d.forEach(((x,g)=>{const b=c.get(x);b!==void 0&&gu(b.mutation,g,Pn.empty(),Ot.now()),Hf(t,g)&&(m=m.insert(x,g))})),m}))}}class h6{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ne.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Ka(o.createTime)}})(t)),Ne.resolve()}getNamedQuery(e,t){return Ne.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(o){return{name:o.name,query:t6(o.bundledQuery),readTime:Ka(o.readTime)}})(t)),Ne.resolve()}}class f6{constructor(){this.overlays=new ds(Xe.comparator),this.Lr=new Map}getOverlay(e,t){return Ne.resolve(this.overlays.get(t))}getOverlays(e,t){const i=fl();return Ne.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&i.set(o,c)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,c)=>{this.bt(e,t,c)})),Ne.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.Lr.get(i);return o!==void 0&&(o.forEach((c=>this.overlays=this.overlays.remove(c))),this.Lr.delete(i)),Ne.resolve()}getOverlaysForCollection(e,t,i){const o=fl(),c=t.length+1,d=new Xe(t.child("")),m=this.overlays.getIteratorFrom(d);for(;m.hasNext();){const x=m.getNext().value,g=x.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&x.largestBatchId>i&&o.set(x.getKey(),x)}return Ne.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let c=new ds(((g,b)=>g-b));const d=this.overlays.getIterator();for(;d.hasNext();){const g=d.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>i){let b=c.get(g.largestBatchId);b===null&&(b=fl(),c=c.insert(g.largestBatchId,b)),b.set(g.getKey(),g)}}const m=fl(),x=c.getIterator();for(;x.hasNext()&&(x.getNext().value.forEach(((g,b)=>m.set(g,b))),!(m.size()>=o)););return Ne.resolve(m)}bt(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const d=this.Lr.get(o.largestBatchId).delete(i.key);this.Lr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new RR(t,i));let c=this.Lr.get(t);c===void 0&&(c=wt(),this.Lr.set(t,c)),this.Lr.set(t,c.add(i.key))}}class m6{constructor(){this.sessionToken=Ws.EMPTY_BYTE_STRING}getSessionToken(e){return Ne.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ne.resolve()}}class Qx{constructor(){this.kr=new Ps(Bs.Kr),this.qr=new Ps(Bs.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Bs(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Bs(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Xe(new Jt([])),i=new Bs(t,e),o=new Bs(t,e+1),c=[];return this.qr.forEachInRange([i,o],(d=>{this.Wr(d),c.push(d.key)})),c}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Xe(new Jt([])),i=new Bs(t,e),o=new Bs(t,e+1);let c=wt();return this.qr.forEachInRange([i,o],(d=>{c=c.add(d.key)})),c}containsKey(e){const t=new Bs(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Bs{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Xe.comparator(e.key,t.key)||vt(e.Hr,t.Hr)}static Ur(e,t){return vt(e.Hr,t.Hr)||Xe.comparator(e.key,t.key)}}class p6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ps(Bs.Kr)}checkEmpty(e){return Ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const c=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new CR(c,t,i,o);this.mutationQueue.push(d);for(const m of o)this.Jr=this.Jr.add(new Bs(m.key,c)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return Ne.resolve(d)}lookupMutationBatch(e,t){return Ne.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.Xr(i),c=o<0?0:o;return Ne.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return Ne.resolve(this.mutationQueue.length===0?Ux:this.Yn-1)}getAllMutationBatches(e){return Ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Bs(t,0),o=new Bs(t,Number.POSITIVE_INFINITY),c=[];return this.Jr.forEachInRange([i,o],(d=>{const m=this.Zr(d.Hr);c.push(m)})),Ne.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ps(vt);return t.forEach((o=>{const c=new Bs(o,0),d=new Bs(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([c,d],(m=>{i=i.add(m.Hr)}))})),Ne.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let c=i;Xe.isDocumentKey(c)||(c=c.child(""));const d=new Bs(new Xe(c),0);let m=new Ps(vt);return this.Jr.forEachWhile((x=>{const g=x.key.path;return!!i.isPrefixOf(g)&&(g.length===o&&(m=m.add(x.Hr)),!0)}),d),Ne.resolve(this.Yr(m))}Yr(e){const t=[];return e.forEach((i=>{const o=this.Zr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){Vt(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ne.forEach(t.mutations,(o=>{const c=new Bs(o.key,t.batchId);return i=i.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Bs(t,0),o=this.Jr.firstAfterOrEqual(i);return Ne.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ne.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class x6{constructor(e){this.ti=e,this.docs=(function(){return new ds(Xe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),c=o?o.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ne.resolve(i?i.document.mutableCopy():en.newInvalidDocument(t))}getEntries(e,t){let i=Ir();return t.forEach((o=>{const c=this.docs.get(o);i=i.insert(o,c?c.document.mutableCopy():en.newInvalidDocument(o))})),Ne.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let c=Ir();const d=t.path,m=new Xe(d.child("__id-9223372036854775808__")),x=this.docs.getIteratorFrom(m);for(;x.hasNext();){const{key:g,value:{document:b}}=x.getNext();if(!d.isPrefixOf(g.path))break;g.path.length>d.length+1||F4(z4(b),i)<=0||(o.has(b.key)||Hf(t,b))&&(c=c.insert(b.key,b.mutableCopy()))}return Ne.resolve(c)}getAllFromCollectionGroup(e,t,i,o){rt(9500)}ni(e,t){return Ne.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new g6(this)}getSize(e){return Ne.resolve(this.size)}}class g6 extends c6{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(i)})),Ne.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class b6{constructor(e){this.persistence=e,this.ri=new Al((t=>Fx(t)),$x),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.ii=0,this.si=new Qx,this.targetCount=0,this.oi=Po._r()}forEachTarget(e,t){return this.ri.forEach(((i,o)=>t(o))),Ne.resolve()}getLastRemoteSnapshotVersion(e){return Ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ne.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ne.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ne.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Po(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ne.resolve()}updateTargetData(e,t){return this.lr(t),Ne.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ne.resolve()}removeTargets(e,t,i){let o=0;const c=[];return this.ri.forEach(((d,m)=>{m.sequenceNumber<=t&&i.get(m.targetId)===null&&(this.ri.delete(d),c.push(this.removeMatchingKeysForTargetId(e,m.targetId)),o++)})),Ne.waitFor(c).next((()=>o))}getTargetCount(e){return Ne.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ne.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ne.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach((d=>{c.push(o.markPotentiallyOrphaned(e,d))})),Ne.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ne.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ne.resolve(i)}containsKey(e,t){return Ne.resolve(this.si.containsKey(t))}}class Uj{constructor(e,t){this._i={},this.overlays={},this.ai=new Bf(0),this.ui=!1,this.ui=!0,this.ci=new m6,this.referenceDelegate=e(this),this.li=new b6(this),this.indexManager=new s6,this.remoteDocumentCache=(function(o){return new x6(o)})((i=>this.referenceDelegate.hi(i))),this.serializer=new e6(t),this.Pi=new h6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new f6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new p6(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Le("MemoryPersistence","Starting transaction:",e);const o=new y6(this.ai.next());return this.referenceDelegate.Ti(),i(o).next((c=>this.referenceDelegate.Ii(o).next((()=>c)))).toPromise().then((c=>(o.raiseOnCommittedEvent(),c)))}Ei(e,t){return Ne.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class y6 extends q4{constructor(e){super(),this.currentSequenceNumber=e}}class Kx{constructor(e){this.persistence=e,this.Ri=new Qx,this.Ai=null}static Vi(e){return new Kx(e)}get di(){if(this.Ai)return this.Ai;throw rt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ne.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ne.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ne.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((o=>this.di.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((c=>this.di.add(c.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ne.forEach(this.di,(i=>{const o=Xe.fromPath(i);return this.mi(e,o).next((c=>{c||t.removeEntry(o,lt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ne.or([()=>Ne.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class gf{constructor(e,t){this.persistence=e,this.fi=new Al((i=>Y4(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=o6(this,t)}static Vi(e,t){return new gf(e,t)}Ti(){}Ii(e){return Ne.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ne.forEach(this.fi,((i,o)=>this.wr(e,i,o).next((c=>c?Ne.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ni(e,(d=>this.wr(e,d,t).next((m=>{m||(i++,c.removeEntry(d,lt.min()))})))).next((()=>c.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=zh(e.data.value)),t}wr(e,t,i){return Ne.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.fi.get(t);return Ne.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Xx{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=o}static Es(e,t){let i=wt(),o=wt();for(const c of t.docChanges)switch(c.type){case 0:i=i.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new Xx(e,t.fromCache,i,o)}}class v6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class w6{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return Q5()?8:H4(sn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const c={result:null};return this.gs(e,t).next((d=>{c.result=d})).next((()=>{if(!c.result)return this.ps(e,t,o,i).next((d=>{c.result=d}))})).next((()=>{if(c.result)return;const d=new v6;return this.ys(e,t,d).next((m=>{if(c.result=m,this.As)return this.ws(e,t,d,m.size)}))})).next((()=>c.result))}ws(e,t,i,o){return i.documentReadCount<this.Vs?(bo()<=yt.DEBUG&&Le("QueryEngine","SDK will not create cache indexes for query:",yo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ne.resolve()):(bo()<=yt.DEBUG&&Le("QueryEngine","Query:",yo(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.ds*o?(bo()<=yt.DEBUG&&Le("QueryEngine","The SDK decides to create cache indexes for query:",yo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qa(t))):Ne.resolve())}gs(e,t){if(o1(t))return Ne.resolve(null);let i=Qa(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=X0(t,null,"F"),i=Qa(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((c=>{const d=wt(...c);return this.fs.getDocuments(e,d).next((m=>this.indexManager.getMinOffset(e,i).next((x=>{const g=this.bs(t,m);return this.Ss(t,g,d,x.readTime)?this.gs(e,X0(t,null,"F")):this.Ds(e,g,t,x)}))))})))))}ps(e,t,i,o){return o1(t)||o.isEqual(lt.min())?Ne.resolve(null):this.fs.getDocuments(e,i).next((c=>{const d=this.bs(t,c);return this.Ss(t,d,i,o)?Ne.resolve(null):(bo()<=yt.DEBUG&&Le("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),yo(t)),this.Ds(e,d,t,B4(o,Su)).next((m=>m)))}))}bs(e,t){let i=new Ps(xj(e));return t.forEach(((o,c)=>{Hf(e,c)&&(i=i.add(c))})),i}Ss(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}ys(e,t,i){return bo()<=yt.DEBUG&&Le("QueryEngine","Using full collection scan to execute query:",yo(t)),this.fs.getDocumentsMatchingQuery(e,t,Ti.min(),i)}Ds(e,t,i,o){return this.fs.getDocumentsMatchingQuery(e,i,o).next((c=>(t.forEach((d=>{c=c.insert(d.key,d)})),c)))}}const Jx="LocalStore",N6=3e8;class _6{constructor(e,t,i,o){this.persistence=e,this.Cs=t,this.serializer=o,this.vs=new ds(vt),this.Fs=new Al((c=>Fx(c)),$x),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new d6(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function j6(n,e,t,i){return new _6(n,e,t,i)}async function Bj(n,e){const t=ct(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((c=>(o=c,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((c=>{const d=[],m=[];let x=wt();for(const g of o){d.push(g.batchId);for(const b of g.mutations)x=x.add(b.key)}for(const g of c){m.push(g.batchId);for(const b of g.mutations)x=x.add(b.key)}return t.localDocuments.getDocuments(i,x).next((g=>({Ns:g,removedBatchIds:d,addedBatchIds:m})))}))}))}function S6(n,e){const t=ct(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),c=t.xs.newChangeBuffer({trackRemovals:!0});return(function(m,x,g,b){const w=g.batch,j=w.keys();let R=Ne.resolve();return j.forEach((U=>{R=R.next((()=>b.getEntry(x,U))).next((V=>{const L=g.docVersions.get(U);Vt(L!==null,48541),V.version.compareTo(L)<0&&(w.applyToRemoteDocument(V,g),V.isValidDocument()&&(V.setReadTime(g.commitVersion),b.addEntry(V)))}))})),R.next((()=>m.mutationQueue.removeMutationBatch(x,w)))})(t,i,e,c).next((()=>c.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(m){let x=wt();for(let g=0;g<m.mutationResults.length;++g)m.mutationResults[g].transformResults.length>0&&(x=x.add(m.batch.mutations[g].key));return x})(e)))).next((()=>t.localDocuments.getDocuments(i,o)))}))}function zj(n){const e=ct(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function E6(n,e){const t=ct(n),i=e.snapshotVersion;let o=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});o=t.vs;const m=[];e.targetChanges.forEach(((b,w)=>{const j=o.get(w);if(!j)return;m.push(t.li.removeMatchingKeys(c,b.removedDocuments,w).next((()=>t.li.addMatchingKeys(c,b.addedDocuments,w))));let R=j.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(w)!==null?R=R.withResumeToken(Ws.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):b.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(b.resumeToken,i)),o=o.insert(w,R),(function(V,L,z){return V.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=N6?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0})(j,R,b)&&m.push(t.li.updateTargetData(c,R))}));let x=Ir(),g=wt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(c,b))})),m.push(T6(c,d,e.documentUpdates).next((b=>{x=b.Bs,g=b.Ls}))),!i.isEqual(lt.min())){const b=t.li.getLastRemoteSnapshotVersion(c).next((w=>t.li.setTargetsMetadata(c,c.currentSequenceNumber,i)));m.push(b)}return Ne.waitFor(m).next((()=>d.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,x,g))).next((()=>x))})).then((c=>(t.vs=o,c)))}function T6(n,e,t){let i=wt(),o=wt();return t.forEach((c=>i=i.add(c))),e.getEntries(n,i).next((c=>{let d=Ir();return t.forEach(((m,x)=>{const g=c.get(m);x.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(m)),x.isNoDocument()&&x.version.isEqual(lt.min())?(e.removeEntry(m,x.readTime),d=d.insert(m,x)):!g.isValidDocument()||x.version.compareTo(g.version)>0||x.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(x),d=d.insert(m,x)):Le(Jx,"Ignoring outdated watch update for ",m,". Current version:",g.version," Watch version:",x.version)})),{Bs:d,Ls:o}}))}function A6(n,e){const t=ct(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Ux),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function k6(n,e){const t=ct(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.li.getTargetData(i,e).next((c=>c?(o=c,Ne.resolve(o)):t.li.allocateTargetId(i).next((d=>(o=new yi(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.vs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function sx(n,e,t){const i=ct(n),o=i.vs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",c,(d=>i.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!Qo(d))throw d;Le(Jx,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(o.target)}function w1(n,e,t){const i=ct(n);let o=lt.min(),c=wt();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(x,g,b){const w=ct(x),j=w.Fs.get(b);return j!==void 0?Ne.resolve(w.vs.get(j)):w.li.getTargetData(g,b)})(i,d,Qa(e)).next((m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,m.targetId).next((x=>{c=x}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?o:lt.min(),t?c:wt()))).next((m=>(C6(i,mR(e),m),{documents:m,ks:c})))))}function C6(n,e,t){let i=n.Ms.get(e)||lt.min();t.forEach(((o,c)=>{c.readTime.compareTo(i)>0&&(i=c.readTime)})),n.Ms.set(e,i)}class N1{constructor(){this.activeTargetIds=vR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class R6{constructor(){this.vo=new N1,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new N1,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class I6{Mo(e){}shutdown(){}}const _1="ConnectivityMonitor";class j1{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Le(_1,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Le(_1,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Sh=null;function nx(){return Sh===null?Sh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Sh++,"0x"+Sh.toString(16)}const y0="RestConnection",D6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class M6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${o}`,this.$o=this.databaseId.database===df?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Wo(e,t,i,o,c){const d=nx(),m=this.Qo(e,t.toUriEncodedString());Le(y0,`Sending RPC '${e}' ${d}:`,m,i);const x={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(x,o,c);const{host:g}=new URL(m),b=er(g);return this.zo(e,m,x,i,b).then((w=>(Le(y0,`Received RPC '${e}' ${d}: `,w),w)),(w=>{throw Io(y0,`RPC '${e}' ${d} failed with error: `,w,"url: ",m,"request:",i),w}))}jo(e,t,i,o,c,d){return this.Wo(e,t,i,o,c)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Yo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,c)=>e[c]=o)),i&&i.headers.forEach(((o,c)=>e[c]=o))}Qo(e,t){const i=D6[e];let o=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class O6{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Js="WebChannelConnection",Jc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(o){setTimeout((()=>{throw o}),0)}}))};class To extends M6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!To.c_){const e=G_();Jc(e,H_.STAT_EVENT,(t=>{t.stat===q0.PROXY?Le(Js,"STAT_EVENT: detected buffering proxy"):t.stat===q0.NOPROXY&&Le(Js,"STAT_EVENT: detected no buffering proxy")})),To.c_=!0}}zo(e,t,i,o,c){const d=nx();return new Promise(((m,x)=>{const g=new $_;g.setWithCredentials(!0),g.listenOnce(q_.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case Bh.NO_ERROR:const w=g.getResponseJson();Le(Js,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(w)),m(w);break;case Bh.TIMEOUT:Le(Js,`RPC '${e}' ${d} timed out`),x(new Pe(we.DEADLINE_EXCEEDED,"Request time out"));break;case Bh.HTTP_ERROR:const j=g.getStatus();if(Le(Js,`RPC '${e}' ${d} failed with status:`,j,"response text:",g.getResponseText()),j>0){let R=g.getResponseJson();Array.isArray(R)&&(R=R[0]);const U=R?.error;if(U&&U.status&&U.message){const V=(function(z){const Q=z.toLowerCase().replace(/_/g,"-");return Object.values(we).indexOf(Q)>=0?Q:we.UNKNOWN})(U.status);x(new Pe(V,U.message))}else x(new Pe(we.UNKNOWN,"Server responded with status "+g.getStatus()))}else x(new Pe(we.UNAVAILABLE,"Connection failed."));break;default:rt(9055,{l_:e,streamId:d,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Le(Js,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(o);Le(Js,`RPC '${e}' ${d} sending request:`,o),g.send(t,"POST",b,i,15)}))}T_(e,t,i){const o=nx(),c=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},x=this.longPollingOptions.timeoutSeconds;x!==void 0&&(m.longPollingTimeout=Math.round(1e3*x)),this.useFetchStreams&&(m.useFetchStreams=!0),this.Go(m.initMessageHeaders,t,i),m.encodeInitMessageHeaders=!0;const g=c.join("");Le(Js,`Creating RPC '${e}' stream ${o}: ${g}`,m);const b=d.createWebChannel(g,m);this.I_(b);let w=!1,j=!1;const R=new O6({Ho:U=>{j?Le(Js,`Not sending because RPC '${e}' stream ${o} is closed:`,U):(w||(Le(Js,`Opening RPC '${e}' stream ${o} transport.`),b.open(),w=!0),Le(Js,`RPC '${e}' stream ${o} sending:`,U),b.send(U))},Jo:()=>b.close()});return Jc(b,lu.EventType.OPEN,(()=>{j||(Le(Js,`RPC '${e}' stream ${o} transport opened.`),R.i_())})),Jc(b,lu.EventType.CLOSE,(()=>{j||(j=!0,Le(Js,`RPC '${e}' stream ${o} transport closed`),R.o_(),this.E_(b))})),Jc(b,lu.EventType.ERROR,(U=>{j||(j=!0,Io(Js,`RPC '${e}' stream ${o} transport errored. Name:`,U.name,"Message:",U.message),R.o_(new Pe(we.UNAVAILABLE,"The operation could not be completed")))})),Jc(b,lu.EventType.MESSAGE,(U=>{if(!j){const V=U.data[0];Vt(!!V,16349);const L=V,z=L?.error||L[0]?.error;if(z){Le(Js,`RPC '${e}' stream ${o} received error:`,z);const Q=z.status;let G=(function(W){const T=As[W];if(T!==void 0)return Tj(T)})(Q),ie=z.message;G===void 0&&(G=we.INTERNAL,ie="Unknown error status: "+Q+" with message "+z.message),j=!0,R.o_(new Pe(G,ie)),b.close()}else Le(Js,`RPC '${e}' stream ${o} received:`,V),R.__(V)}})),To.u_(),setTimeout((()=>{R.s_()}),0),R}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Y_()}}function P6(n){return new To(n)}function v0(){return typeof document<"u"?document:null}function Qf(n){return new BR(n,!0)}To.c_=!1;class Fj{constructor(e,t,i=1e3,o=1.5,c=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=o,this.V_=c,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&Le("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const S1="PersistentStream";class $j{constructor(e,t,i,o,c,d,m,x){this.Ci=e,this.b_=i,this.S_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=m,this.listener=x,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Fj(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===we.RESOURCE_EXHAUSTED?(Rr(t.toString()),Rr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===we.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new Pe(we.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Le(S1,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Le(S1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class V6 extends $j{constructor(e,t,i,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=$R(this.serializer,e),i=(function(c){if(!("targetChange"in c))return lt.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?lt.min():d.readTime?Ka(d.readTime):lt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=tx(this.serializer),t.addTarget=(function(c,d){let m;const x=d.target;if(m=Q0(x)?{documents:GR(c,x)}:{query:YR(c,x).ft},m.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){m.resumeToken=Cj(c,d.resumeToken);const g=J0(c,d.expectedCount);g!==null&&(m.expectedCount=g)}else if(d.snapshotVersion.compareTo(lt.min())>0){m.readTime=xf(c,d.snapshotVersion.toTimestamp());const g=J0(c,d.expectedCount);g!==null&&(m.expectedCount=g)}return m})(this.serializer,e);const i=QR(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=tx(this.serializer),t.removeTarget=e,this.K_(t)}}class L6 extends $j{constructor(e,t,i,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Vt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Vt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Vt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=HR(e.writeResults,e.commitTime),i=Ka(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=tx(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>qR(this.serializer,i)))};this.K_(t)}}class U6{}class B6 extends U6{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Pe(we.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Wo(e,Z0(t,i),o,c,d))).catch((c=>{throw c.name==="FirebaseError"?(c.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Pe(we.UNKNOWN,c.toString())}))}jo(e,t,i,o,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,m])=>this.connection.jo(e,Z0(t,i),o,d,m,c))).catch((d=>{throw d.name==="FirebaseError"?(d.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Pe(we.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function z6(n,e,t,i){return new B6(n,e,t,i)}class F6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Rr(t),this.aa=!1):Le("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Nl="RemoteStore";class $6{constructor(e,t,i,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=c,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{kl(this)&&(Le(Nl,"Restarting streams for network reachability change."),await(async function(x){const g=ct(x);g.Ea.add(4),await Wu(g),g.Va.set("Unknown"),g.Ea.delete(4),await Kf(g)})(this))}))})),this.Va=new F6(i,o)}}async function Kf(n){if(kl(n))for(const e of n.Ra)await e(!0)}async function Wu(n){for(const e of n.Ra)await e(!1)}function qj(n,e){const t=ct(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),sg(t)?tg(t):Ko(t).O_()&&eg(t,e))}function Zx(n,e){const t=ct(n),i=Ko(t);t.Ia.delete(e),i.O_()&&Hj(t,e),t.Ia.size===0&&(i.O_()?i.L_():kl(t)&&t.Va.set("Unknown"))}function eg(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ko(n).Z_(e)}function Hj(n,e){n.da.$e(e),Ko(n).X_(e)}function tg(n){n.da=new PR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ko(n).start(),n.Va.ua()}function sg(n){return kl(n)&&!Ko(n).x_()&&n.Ia.size>0}function kl(n){return ct(n).Ea.size===0}function Gj(n){n.da=void 0}async function q6(n){n.Va.set("Online")}async function H6(n){n.Ia.forEach(((e,t)=>{eg(n,e)}))}async function G6(n,e){Gj(n),sg(n)?(n.Va.ha(e),tg(n)):n.Va.set("Unknown")}async function Y6(n,e,t){if(n.Va.set("Online"),e instanceof kj&&e.state===2&&e.cause)try{await(async function(o,c){const d=c.cause;for(const m of c.targetIds)o.Ia.has(m)&&(await o.remoteSyncer.rejectListen(m,d),o.Ia.delete(m),o.da.removeTarget(m))})(n,e)}catch(i){Le(Nl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await bf(n,i)}else if(e instanceof qh?n.da.Xe(e):e instanceof Aj?n.da.st(e):n.da.tt(e),!t.isEqual(lt.min()))try{const i=await zj(n.localStore);t.compareTo(i)>=0&&await(function(c,d){const m=c.da.Tt(d);return m.targetChanges.forEach(((x,g)=>{if(x.resumeToken.approximateByteSize()>0){const b=c.Ia.get(g);b&&c.Ia.set(g,b.withResumeToken(x.resumeToken,d))}})),m.targetMismatches.forEach(((x,g)=>{const b=c.Ia.get(x);if(!b)return;c.Ia.set(x,b.withResumeToken(Ws.EMPTY_BYTE_STRING,b.snapshotVersion)),Hj(c,x);const w=new yi(b.target,x,g,b.sequenceNumber);eg(c,w)})),c.remoteSyncer.applyRemoteEvent(m)})(n,t)}catch(i){Le(Nl,"Failed to raise snapshot:",i),await bf(n,i)}}async function bf(n,e,t){if(!Qo(e))throw e;n.Ea.add(1),await Wu(n),n.Va.set("Offline"),t||(t=()=>zj(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Le(Nl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Kf(n)}))}function Yj(n,e){return e().catch((t=>bf(n,t,e)))}async function Xf(n){const e=ct(n),t=Ri(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ux;for(;W6(e);)try{const o=await A6(e.localStore,i);if(o===null){e.Ta.length===0&&t.L_();break}i=o.batchId,Q6(e,o)}catch(o){await bf(e,o)}Wj(e)&&Qj(e)}function W6(n){return kl(n)&&n.Ta.length<10}function Q6(n,e){n.Ta.push(e);const t=Ri(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function Wj(n){return kl(n)&&!Ri(n).x_()&&n.Ta.length>0}function Qj(n){Ri(n).start()}async function K6(n){Ri(n).ra()}async function X6(n){const e=Ri(n);for(const t of n.Ta)e.ea(t.mutations)}async function J6(n,e,t){const i=n.Ta.shift(),o=Gx.from(i,e,t);await Yj(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await Xf(n)}async function Z6(n,e){e&&Ri(n).Y_&&await(async function(i,o){if((function(d){return DR(d)&&d!==we.ABORTED})(o.code)){const c=i.Ta.shift();Ri(i).B_(),await Yj(i,(()=>i.remoteSyncer.rejectFailedWrite(c.batchId,o))),await Xf(i)}})(n,e),Wj(n)&&Qj(n)}async function E1(n,e){const t=ct(n);t.asyncQueue.verifyOperationInProgress(),Le(Nl,"RemoteStore received new credentials");const i=kl(t);t.Ea.add(3),await Wu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Kf(t)}async function e3(n,e){const t=ct(n);e?(t.Ea.delete(2),await Kf(t)):e||(t.Ea.add(2),await Wu(t),t.Va.set("Unknown"))}function Ko(n){return n.ma||(n.ma=(function(t,i,o){const c=ct(t);return c.sa(),new V6(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:q6.bind(null,n),Yo:H6.bind(null,n),t_:G6.bind(null,n),J_:Y6.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),sg(n)?tg(n):n.Va.set("Unknown")):(await n.ma.stop(),Gj(n))}))),n.ma}function Ri(n){return n.fa||(n.fa=(function(t,i,o){const c=ct(t);return c.sa(),new L6(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:K6.bind(null,n),t_:Z6.bind(null,n),ta:X6.bind(null,n),na:J6.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Xf(n)):(await n.fa.stop(),n.Ta.length>0&&(Le(Nl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class ng{constructor(e,t,i,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=c,this.deferred=new Er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,c){const d=Date.now()+i,m=new ng(e,t,d,o,c);return m.start(i),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Pe(we.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ag(n,e){if(Rr("AsyncQueue",`${e}: ${n}`),Qo(n))return new Pe(we.UNAVAILABLE,`${e}: ${n}`);throw n}class Ao{static emptySet(e){return new Ao(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Xe.comparator(t.key,i.key):(t,i)=>Xe.comparator(t.key,i.key),this.keyedMap=ou(),this.sortedSet=new ds(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ao)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Ao;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class T1{constructor(){this.ga=new ds(Xe.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):rt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Vo{constructor(e,t,i,o,c,d,m,x,g){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=m,this.excludesMetadataChanges=x,this.hasCachedResults=g}static fromInitialDocuments(e,t,i,o,c){const d=[];return t.forEach((m=>{d.push({type:0,doc:m})})),new Vo(e,t,Ao.emptySet(t),d,i,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}class t3{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class s3{constructor(){this.queries=A1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=ct(t),c=o.queries;o.queries=A1(),c.forEach(((d,m)=>{for(const x of m.ba)x.onError(i)}))})(this,new Pe(we.ABORTED,"Firestore shutting down"))}}function A1(){return new Al((n=>pj(n)),qf)}async function rg(n,e){const t=ct(n);let i=3;const o=e.query;let c=t.queries.get(o);c?!c.Sa()&&e.Da()&&(i=2):(c=new t3,i=e.Da()?0:1);try{switch(i){case 0:c.wa=await t.onListen(o,!0);break;case 1:c.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const m=ag(d,`Initialization of query '${yo(e.query)}' failed`);return void e.onError(m)}t.queries.set(o,c),c.ba.push(e),e.va(t.onlineState),c.wa&&e.Fa(c.wa)&&lg(t)}async function ig(n,e){const t=ct(n),i=e.query;let o=3;const c=t.queries.get(i);if(c){const d=c.ba.indexOf(e);d>=0&&(c.ba.splice(d,1),c.ba.length===0?o=e.Da()?0:1:!c.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function n3(n,e){const t=ct(n);let i=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const m of d.ba)m.Fa(o)&&(i=!0);d.wa=o}}i&&lg(t)}function a3(n,e,t){const i=ct(n),o=i.queries.get(e);if(o)for(const c of o.ba)c.onError(t);i.queries.delete(e)}function lg(n){n.Ca.forEach((e=>{e.next()}))}var ax,k1;(k1=ax||(ax={})).Ma="default",k1.Cache="cache";class og{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new Vo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Vo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ax.Cache}}class Kj{constructor(e){this.key=e}}class Xj{constructor(e){this.key=e}}class r3{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=wt(),this.mutatedKeys=wt(),this.eu=xj(e),this.tu=new Ao(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new T1,o=t?t.tu:this.tu;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,m=!1;const x=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,w)=>{const j=o.get(b),R=Hf(this.query,w)?w:null,U=!!j&&this.mutatedKeys.has(j.key),V=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let L=!1;j&&R?j.data.isEqual(R.data)?U!==V&&(i.track({type:3,doc:R}),L=!0):this.su(j,R)||(i.track({type:2,doc:R}),L=!0,(x&&this.eu(R,x)>0||g&&this.eu(R,g)<0)&&(m=!0)):!j&&R?(i.track({type:0,doc:R}),L=!0):j&&!R&&(i.track({type:1,doc:j}),L=!0,(x||g)&&(m=!0)),L&&(R?(d=d.add(R),c=V?c.add(b):c.delete(b)):(d=d.delete(b),c=c.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),c=c.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:m,mutatedKeys:c}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,w)=>(function(R,U){const V=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt(20277,{Vt:L})}};return V(R)-V(U)})(b.type,w.type)||this.eu(b.doc,w.doc))),this.ou(i),o=o??!1;const m=t&&!o?this._u():[],x=this.Ya.size===0&&this.current&&!o?1:0,g=x!==this.Xa;return this.Xa=x,d.length!==0||g?{snapshot:new Vo(this.query,e.tu,c,d,e.mutatedKeys,x===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new T1,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=wt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Xj(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Kj(i))})),t}cu(e){this.Za=e.ks,this.Ya=wt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Vo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const cg="SyncEngine";class i3{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class l3{constructor(e){this.key=e,this.hu=!1}}class o3{constructor(e,t,i,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Al((m=>pj(m)),qf),this.Iu=new Map,this.Eu=new Set,this.Ru=new ds(Xe.comparator),this.Au=new Map,this.Vu=new Qx,this.du={},this.mu=new Map,this.fu=Po.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function c3(n,e,t=!0){const i=n2(n);let o;const c=i.Tu.get(e);return c?(i.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.lu()):o=await Jj(i,e,t,!0),o}async function u3(n,e){const t=n2(n);await Jj(t,e,!0,!1)}async function Jj(n,e,t,i){const o=await k6(n.localStore,Qa(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let m;return i&&(m=await d3(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&qj(n.remoteStore,o),m}async function d3(n,e,t,i,o){n.pu=(w,j,R)=>(async function(V,L,z,Q){let G=L.view.ru(z);G.Ss&&(G=await w1(V.localStore,L.query,!1).then((({documents:T})=>L.view.ru(T,G))));const ie=Q&&Q.targetChanges.get(L.targetId),he=Q&&Q.targetMismatches.get(L.targetId)!=null,W=L.view.applyChanges(G,V.isPrimaryClient,ie,he);return R1(V,L.targetId,W.au),W.snapshot})(n,w,j,R);const c=await w1(n.localStore,e,!0),d=new r3(e,c.ks),m=d.ru(c.documents),x=Yu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),g=d.applyChanges(m,n.isPrimaryClient,x);R1(n,t,g.au);const b=new i3(e,t,d);return n.Tu.set(e,b),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),g.snapshot}async function h3(n,e,t){const i=ct(n),o=i.Tu.get(e),c=i.Iu.get(o.targetId);if(c.length>1)return i.Iu.set(o.targetId,c.filter((d=>!qf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await sx(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&Zx(i.remoteStore,o.targetId),rx(i,o.targetId)})).catch(Wo)):(rx(i,o.targetId),await sx(i.localStore,o.targetId,!0))}async function f3(n,e){const t=ct(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Zx(t.remoteStore,i.targetId))}async function m3(n,e,t){const i=w3(n);try{const o=await(function(d,m){const x=ct(d),g=Ot.now(),b=m.reduce(((R,U)=>R.add(U.key)),wt());let w,j;return x.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let U=Ir(),V=wt();return x.xs.getEntries(R,b).next((L=>{U=L,U.forEach(((z,Q)=>{Q.isValidDocument()||(V=V.add(z))}))})).next((()=>x.localDocuments.getOverlayedDocuments(R,U))).next((L=>{w=L;const z=[];for(const Q of m){const G=AR(Q,w.get(Q.key).overlayedDocument);G!=null&&z.push(new Vi(Q.key,G,lj(G.value.mapValue),ra.exists(!0)))}return x.mutationQueue.addMutationBatch(R,g,z,m)})).next((L=>{j=L;const z=L.applyToLocalDocumentSet(w,V);return x.documentOverlayCache.saveOverlays(R,L.batchId,z)}))})).then((()=>({batchId:j.batchId,changes:bj(w)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(d,m,x){let g=d.du[d.currentUser.toKey()];g||(g=new ds(vt)),g=g.insert(m,x),d.du[d.currentUser.toKey()]=g})(i,o.batchId,t),await Qu(i,o.changes),await Xf(i.remoteStore)}catch(o){const c=ag(o,"Failed to persist write");t.reject(c)}}async function Zj(n,e){const t=ct(n);try{const i=await E6(t.localStore,e);e.targetChanges.forEach(((o,c)=>{const d=t.Au.get(c);d&&(Vt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?Vt(d.hu,14607):o.removedDocuments.size>0&&(Vt(d.hu,42227),d.hu=!1))})),await Qu(t,i,e)}catch(i){await Wo(i)}}function C1(n,e,t){const i=ct(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((c,d)=>{const m=d.view.va(e);m.snapshot&&o.push(m.snapshot)})),(function(d,m){const x=ct(d);x.onlineState=m;let g=!1;x.queries.forEach(((b,w)=>{for(const j of w.ba)j.va(m)&&(g=!0)})),g&&lg(x)})(i.eventManager,e),o.length&&i.Pu.J_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function p3(n,e,t){const i=ct(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),c=o&&o.key;if(c){let d=new ds(Xe.comparator);d=d.insert(c,en.newNoDocument(c,lt.min()));const m=wt().add(c),x=new Wf(lt.min(),new Map,new ds(vt),d,m);await Zj(i,x),i.Ru=i.Ru.remove(c),i.Au.delete(e),ug(i)}else await sx(i.localStore,e,!1).then((()=>rx(i,e,t))).catch(Wo)}async function x3(n,e){const t=ct(n),i=e.batch.batchId;try{const o=await S6(t.localStore,e);t2(t,i,null),e2(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Qu(t,o)}catch(o){await Wo(o)}}async function g3(n,e,t){const i=ct(n);try{const o=await(function(d,m){const x=ct(d);return x.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let b;return x.mutationQueue.lookupMutationBatch(g,m).next((w=>(Vt(w!==null,37113),b=w.keys(),x.mutationQueue.removeMutationBatch(g,w)))).next((()=>x.mutationQueue.performConsistencyCheck(g))).next((()=>x.documentOverlayCache.removeOverlaysForBatchId(g,b,m))).next((()=>x.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,b))).next((()=>x.localDocuments.getDocuments(g,b)))}))})(i.localStore,e);t2(i,e,t),e2(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Qu(i,o)}catch(o){await Wo(o)}}function e2(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function t2(n,e,t){const i=ct(n);let o=i.du[i.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),i.du[i.currentUser.toKey()]=o}}function rx(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||s2(n,i)}))}function s2(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(Zx(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),ug(n))}function R1(n,e,t){for(const i of t)i instanceof Kj?(n.Vu.addReference(i.key,e),b3(n,i)):i instanceof Xj?(Le(cg,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||s2(n,i.key)):rt(19791,{wu:i})}function b3(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(Le(cg,"New document in limbo: "+t),n.Eu.add(i),ug(n))}function ug(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Xe(Jt.fromString(e)),i=n.fu.next();n.Au.set(i,new l3(t)),n.Ru=n.Ru.insert(t,i),qj(n.remoteStore,new yi(Qa($f(t.path)),i,"TargetPurposeLimboResolution",Bf.ce))}}async function Qu(n,e,t){const i=ct(n),o=[],c=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((m,x)=>{d.push(i.pu(x,e,t).then((g=>{if((g||t)&&i.isPrimaryClient){const b=g?!g.fromCache:t?.targetChanges.get(x.targetId)?.current;i.sharedClientState.updateQueryState(x.targetId,b?"current":"not-current")}if(g){o.push(g);const b=Xx.Es(x.targetId,g);c.push(b)}})))})),await Promise.all(d),i.Pu.J_(o),await(async function(x,g){const b=ct(x);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>Ne.forEach(g,(j=>Ne.forEach(j.Ts,(R=>b.persistence.referenceDelegate.addReference(w,j.targetId,R))).next((()=>Ne.forEach(j.Is,(R=>b.persistence.referenceDelegate.removeReference(w,j.targetId,R)))))))))}catch(w){if(!Qo(w))throw w;Le(Jx,"Failed to update sequence numbers: "+w)}for(const w of g){const j=w.targetId;if(!w.fromCache){const R=b.vs.get(j),U=R.snapshotVersion,V=R.withLastLimboFreeSnapshotVersion(U);b.vs=b.vs.insert(j,V)}}})(i.localStore,c))}async function y3(n,e){const t=ct(n);if(!t.currentUser.isEqual(e)){Le(cg,"User change. New user:",e.toKey());const i=await Bj(t.localStore,e);t.currentUser=e,(function(c,d){c.mu.forEach((m=>{m.forEach((x=>{x.reject(new Pe(we.CANCELLED,d))}))})),c.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Qu(t,i.Ns)}}function v3(n,e){const t=ct(n),i=t.Au.get(e);if(i&&i.hu)return wt().add(i.key);{let o=wt();const c=t.Iu.get(e);if(!c)return o;for(const d of c){const m=t.Tu.get(d);o=o.unionWith(m.view.nu)}return o}}function n2(n){const e=ct(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Zj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=v3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=p3.bind(null,e),e.Pu.J_=n3.bind(null,e.eventManager),e.Pu.yu=a3.bind(null,e.eventManager),e}function w3(n){const e=ct(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=x3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=g3.bind(null,e),e}class yf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return j6(this.persistence,new w6,e.initialUser,this.serializer)}Cu(e){return new Uj(Kx.Vi,this.serializer)}Du(e){return new R6}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yf.provider={build:()=>new yf};class N3 extends yf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Vt(this.persistence.referenceDelegate instanceof gf,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new i6(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new Uj((i=>gf.Vi(i,t)),this.serializer)}}class ix{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>C1(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=y3.bind(null,this.syncEngine),await e3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new s3})()}createDatastore(e){const t=Qf(e.databaseInfo.databaseId),i=P6(e.databaseInfo);return z6(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,c,d,m){return new $6(i,o,c,d,m)})(this.localStore,this.datastore,e.asyncQueue,(t=>C1(this.syncEngine,t,0)),(function(){return j1.v()?new j1:new I6})())}createSyncEngine(e,t){return(function(o,c,d,m,x,g,b){const w=new o3(o,c,d,m,x,g);return b&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=ct(t);Le(Nl,"RemoteStore shutting down."),i.Ea.add(5),await Wu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ix.provider={build:()=>new ix};class dg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Rr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Ii="FirestoreClient";class _3{constructor(e,t,i,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=o,this.user=Zs.UNAUTHENTICATED,this.clientId=Lx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(i,(async d=>{Le(Ii,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Le(Ii,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=ag(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function w0(n,e){n.asyncQueue.verifyOperationInProgress(),Le(Ii,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await Bj(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function I1(n,e){n.asyncQueue.verifyOperationInProgress();const t=await j3(n);Le(Ii,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>E1(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>E1(e.remoteStore,o))),n._onlineComponents=e}async function j3(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Le(Ii,"Using user provided OfflineComponentProvider");try{await w0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===we.FAILED_PRECONDITION||o.code===we.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Io("Error using user provided cache. Falling back to memory cache: "+t),await w0(n,new yf)}}else Le(Ii,"Using default OfflineComponentProvider"),await w0(n,new N3(void 0));return n._offlineComponents}async function a2(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Le(Ii,"Using user provided OnlineComponentProvider"),await I1(n,n._uninitializedComponentsProvider._online)):(Le(Ii,"Using default OnlineComponentProvider"),await I1(n,new ix))),n._onlineComponents}function S3(n){return a2(n).then((e=>e.syncEngine))}async function vf(n){const e=await a2(n),t=e.eventManager;return t.onListen=c3.bind(null,e.syncEngine),t.onUnlisten=h3.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=u3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=f3.bind(null,e.syncEngine),t}function E3(n,e,t,i){const o=new dg(i),c=new og(e,o,t);return n.asyncQueue.enqueueAndForget((async()=>rg(await vf(n),c))),()=>{o.Nu(),n.asyncQueue.enqueueAndForget((async()=>ig(await vf(n),c)))}}function T3(n,e,t={}){const i=new Er;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,m,x,g){const b=new dg({next:j=>{b.Nu(),d.enqueueAndForget((()=>ig(c,w)));const R=j.docs.has(m);!R&&j.fromCache?g.reject(new Pe(we.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&j.fromCache&&x&&x.source==="server"?g.reject(new Pe(we.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(j)},error:j=>g.reject(j)}),w=new og($f(m.path),b,{includeMetadataChanges:!0,Ka:!0});return rg(c,w)})(await vf(n),n.asyncQueue,e,t,i))),i.promise}function A3(n,e,t={}){const i=new Er;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,m,x,g){const b=new dg({next:j=>{b.Nu(),d.enqueueAndForget((()=>ig(c,w))),j.fromCache&&x.source==="server"?g.reject(new Pe(we.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(j)},error:j=>g.reject(j)}),w=new og(m,b,{includeMetadataChanges:!0,Ka:!0});return rg(c,w)})(await vf(n),n.asyncQueue,e,t,i))),i.promise}function k3(n,e){const t=new Er;return n.asyncQueue.enqueueAndForget((async()=>m3(await S3(n),e,t))),t.promise}function r2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const C3="ComponentProvider",D1=new Map;function R3(n,e,t,i,o){return new K4(n,e,t,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,r2(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,i)}const i2="firestore.googleapis.com",M1=!0;class O1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Pe(we.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=i2,this.ssl=M1}else this.host=e.host,this.ssl=e.ssl??M1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Lj;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<a6)throw new Pe(we.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}U4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=r2(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Pe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Pe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Pe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Jf{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new O1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Pe(we.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Pe(we.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new O1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new k4;switch(i.type){case"firstParty":return new D4(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Pe(we.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=D1.get(t);i&&(Le(C3,"Removing Datastore"),D1.delete(t),i.terminate())})(this),Promise.resolve()}}function I3(n,e,t,i={}){n=wn(n,Jf);const o=er(e),c=n._getSettings(),d={...c,emulatorOptions:n._getEmulatorOptions()},m=`${e}:${t}`;o&&(Df(`https://${m}`),Mf("Firestore",!0)),c.host!==i2&&c.host!==m&&Io("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const x={...c,host:m,ssl:o,emulatorOptions:i};if(!bl(x,d)&&(n._setSettings(x),i.mockUserToken)){let g,b;if(typeof i.mockUserToken=="string")g=i.mockUserToken,b=Zs.MOCK_USER;else{g=s_(i.mockUserToken,n._app?.options.projectId);const w=i.mockUserToken.sub||i.mockUserToken.user_id;if(!w)throw new Pe(we.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Zs(w)}n._authCredentials=new C4(new Q_(g,b))}}class Cl{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Cl(this.firestore,e,this._query)}}class ms{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _i(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ms(this.firestore,e,this._key)}toJSON(){return{type:ms._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(qu(t,ms._jsonSchema))return new ms(e,i||null,new Xe(Jt.fromString(t.referencePath)))}}ms._jsonSchemaVersion="firestore/documentReference/1.0",ms._jsonSchema={type:Cs("string",ms._jsonSchemaVersion),referencePath:Cs("string")};class _i extends Cl{constructor(e,t,i){super(e,t,$f(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ms(this.firestore,null,new Xe(e))}withConverter(e){return new _i(this.firestore,e,this._path)}}function Ke(n,e,...t){if(n=Xt(n),K_("collection","path",e),n instanceof Jf){const i=Jt.fromString(e,...t);return Ww(i),new _i(n,null,i)}{if(!(n instanceof ms||n instanceof _i))throw new Pe(we.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Jt.fromString(e,...t));return Ww(i),new _i(n.firestore,null,i)}}function $e(n,e,...t){if(n=Xt(n),arguments.length===1&&(e=Lx.newId()),K_("doc","path",e),n instanceof Jf){const i=Jt.fromString(e,...t);return Yw(i),new ms(n,null,new Xe(i))}{if(!(n instanceof ms||n instanceof _i))throw new Pe(we.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Jt.fromString(e,...t));return Yw(i),new ms(n.firestore,n instanceof _i?n.converter:null,new Xe(i))}}const P1="AsyncQueue";class V1{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Fj(this,"async_queue_retry"),this._c=()=>{const i=v0();i&&Le(P1,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=v0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=v0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Er;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Qo(e))throw e;Le(P1,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Rr("INTERNAL UNHANDLED ERROR: ",L1(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=ng.createAndSchedule(this,e,t,i,(c=>this.hc(c)));return this.tc.push(o),o}uc(){this.nc&&rt(47125,{Pc:L1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function L1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Dr extends Jf{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new V1,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new V1(e),this._firestoreClient=void 0,await e}}}function D3(n,e){const t=typeof n=="object"?n:Of(),i=typeof n=="string"?n:df,o=Uu(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const c=Sx("firestore");c&&I3(o,...c)}return o}function Zf(n){if(n._terminated)throw new Pe(we.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||M3(n),n._firestoreClient}function M3(n){const e=n._freezeSettings(),t=R3(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new _3(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(o){const c=o?._online.build();return{_offline:o?._offline.build(c),_online:c}})(n._componentsProvider))}class ta{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ta(Ws.fromBase64String(e))}catch(t){throw new Pe(we.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ta(Ws.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ta._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qu(e,ta._jsonSchema))return ta.fromBase64String(e.bytes)}}ta._jsonSchemaVersion="firestore/bytes/1.0",ta._jsonSchema={type:Cs("string",ta._jsonSchemaVersion),bytes:Cs("string")};class hg{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Pe(we.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ys(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class em{constructor(e){this._methodName=e}}class Xa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Pe(we.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Pe(we.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Xa._jsonSchemaVersion}}static fromJSON(e){if(qu(e,Xa._jsonSchema))return new Xa(e.latitude,e.longitude)}}Xa._jsonSchemaVersion="firestore/geoPoint/1.0",Xa._jsonSchema={type:Cs("string",Xa._jsonSchemaVersion),latitude:Cs("number"),longitude:Cs("number")};class ba{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let c=0;c<i.length;++c)if(i[c]!==o[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ba._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qu(e,ba._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ba(e.vectorValues);throw new Pe(we.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ba._jsonSchemaVersion="firestore/vectorValue/1.0",ba._jsonSchema={type:Cs("string",ba._jsonSchemaVersion),vectorValues:Cs("object")};const O3=/^__.*__$/;class P3{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Gu(e,this.data,t,this.fieldTransforms)}}class l2{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function o2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt(40011,{dataSource:n})}}class fg{constructor(e,t,i,o,c,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,c===void 0&&this.validatePath(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new fg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return wf(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(o2(this.dataSource)&&O3.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class V3{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Qf(e)}createContext(e,t,i,o=!1){return new fg({dataSource:e,methodName:t,targetDoc:i,path:Ys.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function tm(n){const e=n._freezeSettings(),t=Qf(n._databaseId);return new V3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function c2(n,e,t,i,o,c={}){const d=n.createContext(c.merge||c.mergeFields?2:0,e,t,o);pg("Data must be an object, but it was:",d,i);const m=u2(i,d);let x,g;if(c.merge)x=new Pn(d.fieldMask),g=d.fieldTransforms;else if(c.mergeFields){const b=[];for(const w of c.mergeFields){const j=Lo(e,w,t);if(!d.contains(j))throw new Pe(we.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);f2(b,j)||b.push(j)}x=new Pn(b),g=d.fieldTransforms.filter((w=>x.covers(w.field)))}else x=null,g=d.fieldTransforms;return new P3(new gn(m),x,g)}class sm extends em{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sm}}class mg extends em{_toFieldTransform(e){return new jR(e.path,new ku)}isEqual(e){return e instanceof mg}}function L3(n,e,t,i){const o=n.createContext(1,e,t);pg("Data must be an object, but it was:",o,i);const c=[],d=gn.empty();Pi(i,((x,g)=>{const b=h2(e,x,t);g=Xt(g);const w=o.childContextForFieldPath(b);if(g instanceof sm)c.push(b);else{const j=Ku(g,w);j!=null&&(c.push(b),d.set(b,j))}}));const m=new Pn(c);return new l2(d,m,o.fieldTransforms)}function U3(n,e,t,i,o,c){const d=n.createContext(1,e,t),m=[Lo(e,i,t)],x=[o];if(c.length%2!=0)throw new Pe(we.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<c.length;j+=2)m.push(Lo(e,c[j])),x.push(c[j+1]);const g=[],b=gn.empty();for(let j=m.length-1;j>=0;--j)if(!f2(g,m[j])){const R=m[j];let U=x[j];U=Xt(U);const V=d.childContextForFieldPath(R);if(U instanceof sm)g.push(R);else{const L=Ku(U,V);L!=null&&(g.push(R),b.set(R,L))}}const w=new Pn(g);return new l2(b,w,d.fieldTransforms)}function B3(n,e,t,i=!1){return Ku(t,n.createContext(i?4:3,e))}function Ku(n,e){if(d2(n=Xt(n)))return pg("Unsupported field value:",e,n),u2(n,e);if(n instanceof em)return(function(i,o){if(!o2(o.dataSource))throw o.createError(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${i._methodName}() is not currently supported inside arrays`);const c=i._toFieldTransform(o);c&&o.fieldTransforms.push(c)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,o){const c=[];let d=0;for(const m of i){let x=Ku(m,o.childContextForArray(d));x==null&&(x={nullValue:"NULL_VALUE"}),c.push(x),d++}return{arrayValue:{values:c}}})(n,e)}return(function(i,o){if((i=Xt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return wR(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const c=Ot.fromDate(i);return{timestampValue:xf(o.serializer,c)}}if(i instanceof Ot){const c=new Ot(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:xf(o.serializer,c)}}if(i instanceof Xa)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ta)return{bytesValue:Cj(o.serializer,i._byteString)};if(i instanceof ms){const c=o.databaseId,d=i.firestore._databaseId;if(!d.isEqual(c))throw o.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Wx(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof ba)return(function(d,m){const x=d instanceof ba?d.toArray():d;return{mapValue:{fields:{[rj]:{stringValue:ij},[hf]:{arrayValue:{values:x.map((b=>{if(typeof b!="number")throw m.createError("VectorValues must only contain numeric values.");return qx(m.serializer,b)}))}}}}}})(i,o);if(Vj(i))return i._toProto(o.serializer);throw o.createError(`Unsupported field value: ${Uf(i)}`)})(n,e)}function u2(n,e){const t={};return Z_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pi(n,((i,o)=>{const c=Ku(o,e.childContextForField(i));c!=null&&(t[i]=c)})),{mapValue:{fields:t}}}function d2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ot||n instanceof Xa||n instanceof ta||n instanceof ms||n instanceof em||n instanceof ba||Vj(n))}function pg(n,e,t){if(!d2(t)||!X_(t)){const i=Uf(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Lo(n,e,t){if((e=Xt(e))instanceof hg)return e._internalPath;if(typeof e=="string")return h2(n,e);throw wf("Field path arguments must be of type string or ",n,!1,void 0,t)}const z3=new RegExp("[~\\*/\\[\\]]");function h2(n,e,t){if(e.search(z3)>=0)throw wf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new hg(...e.split("."))._internalPath}catch{throw wf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function wf(n,e,t,i,o){const c=i&&!i.isEmpty(),d=o!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let x="";return(c||d)&&(x+=" (found",c&&(x+=` in field ${i}`),d&&(x+=` in document ${o}`),x+=")"),new Pe(we.INVALID_ARGUMENT,m+n+x)}function f2(n,e){return n.some((t=>t.isEqual(e)))}class F3{convertValue(e,t="none"){switch(Ci(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ki(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw rt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Pi(e,((o,c)=>{i[o]=this.convertValue(c,t)})),i}convertVectorValue(e){const t=e.fields?.[hf].arrayValue?.values?.map((i=>vs(i.doubleValue)));return new ba(t)}convertGeoPoint(e){return new Xa(vs(e.latitude),vs(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Ff(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Eu(e));default:return null}}convertTimestamp(e){const t=Ai(e);return new Ot(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Jt.fromString(e);Vt(Pj(i),9688,{name:e});const o=new Tu(i.get(1),i.get(3)),c=new Xe(i.popFirst(5));return o.isEqual(t)||Rr(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}class xg extends F3{constructor(e){super(),this.firestore=e}convertBytes(e){return new ta(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ms(this.firestore,null,t)}}function ji(){return new mg("serverTimestamp")}const U1="@firebase/firestore",B1="4.10.0";function z1(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of i)if(c in o&&typeof o[c]=="function")return!0;return!1})(n,["next","error","complete"])}class m2{constructor(e,t,i,o,c){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new ms(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new $3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Lo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class $3 extends m2{data(){return super.data()}}function p2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Pe(we.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gg{}class q3 extends gg{}function Ln(n,e,...t){let i=[];e instanceof gg&&i.push(e),i=i.concat(t),(function(c){const d=c.filter((x=>x instanceof bg)).length,m=c.filter((x=>x instanceof nm)).length;if(d>1||d>0&&m>0)throw new Pe(we.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const o of i)n=o._apply(n);return n}class nm extends q3{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new nm(e,t,i)}_apply(e){const t=this._parse(e);return x2(e._query,t),new Cl(e.firestore,e.converter,K0(e._query,t))}_parse(e){const t=tm(e.firestore);return(function(c,d,m,x,g,b,w){let j;if(g.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Pe(we.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){$1(w,b);const U=[];for(const V of w)U.push(F1(x,c,V));j={arrayValue:{values:U}}}else j=F1(x,c,w)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||$1(w,b),j=B3(m,d,w,b==="in"||b==="not-in");return ks.create(g,b,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bn(n,e,t){const i=e,o=Lo("where",n);return nm._create(o,i,t)}class bg extends gg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new bg(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Na.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,c){let d=o;const m=c.getFlattenedFilters();for(const x of m)x2(d,x),d=K0(d,x)})(e._query,t),new Cl(e.firestore,e.converter,K0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function F1(n,e,t){if(typeof(t=Xt(t))=="string"){if(t==="")throw new Pe(we.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mj(e)&&t.indexOf("/")!==-1)throw new Pe(we.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Jt.fromString(t));if(!Xe.isDocumentKey(i))throw new Pe(we.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return s1(n,new Xe(i))}if(t instanceof ms)return s1(n,t._key);throw new Pe(we.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Uf(t)}.`)}function $1(n,e){if(!Array.isArray(n)||n.length===0)throw new Pe(we.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function x2(n,e){const t=(function(o,c){for(const d of o)for(const m of d.getFlattenedFilters())if(c.indexOf(m.op)>=0)return m.op;return null})(n.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Pe(we.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Pe(we.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function g2(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class uu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ml extends m2{constructor(e,t,i,o,c,d){super(e,t,i,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Hh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Lo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Pe(we.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ml._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ml._jsonSchemaVersion="firestore/documentSnapshot/1.0",ml._jsonSchema={type:Cs("string",ml._jsonSchemaVersion),bundleSource:Cs("string","DocumentSnapshot"),bundleName:Cs("string"),bundle:Cs("string")};class Hh extends ml{data(e={}){return super.data(e)}}class pl{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new uu(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Hh(this._firestore,this._userDataWriter,i.key,i,new uu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Pe(we.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((m=>{const x=new Hh(o._firestore,o._userDataWriter,m.doc.key,m.doc,new uu(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:x,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((m=>c||m.type!==3)).map((m=>{const x=new Hh(o._firestore,o._userDataWriter,m.doc.key,m.doc,new uu(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,b=-1;return m.type!==0&&(g=d.indexOf(m.doc.key),d=d.delete(m.doc.key)),m.type!==1&&(d=d.add(m.doc),b=d.indexOf(m.doc.key)),{type:H3(m.type),doc:x,oldIndex:g,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Pe(we.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=pl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Lx.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),i.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function H3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt(61501,{type:n})}}pl._jsonSchemaVersion="firestore/querySnapshot/1.0",pl._jsonSchema={type:Cs("string",pl._jsonSchemaVersion),bundleSource:Cs("string","QuerySnapshot"),bundleName:Cs("string"),bundle:Cs("string")};function N0(n){n=wn(n,ms);const e=wn(n.firestore,Dr),t=Zf(e);return T3(t,n._key).then((i=>b2(e,n,i)))}function Ms(n){n=wn(n,Cl);const e=wn(n.firestore,Dr),t=Zf(e),i=new xg(e);return p2(n._query),A3(t,n._query).then((o=>new pl(e,i,n,o)))}function _0(n,e,t){n=wn(n,ms);const i=wn(n.firestore,Dr),o=g2(n.converter,e),c=tm(i);return am(i,[c2(c,"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,ra.none())])}function st(n,e,t,...i){n=wn(n,ms);const o=wn(n.firestore,Dr),c=tm(o);let d;return d=typeof(e=Xt(e))=="string"||e instanceof hg?U3(c,"updateDoc",n._key,e,t,i):L3(c,"updateDoc",n._key,e),am(o,[d.toMutation(n._key,ra.exists(!0))])}function ko(n){return am(wn(n.firestore,Dr),[new Hx(n._key,ra.none())])}function _a(n,e){const t=wn(n.firestore,Dr),i=$e(n),o=g2(n.converter,e),c=tm(n.firestore);return am(t,[c2(c,"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,ra.exists(!1))]).then((()=>i))}function Kt(n,...e){n=Xt(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||z1(e[i])||(t=e[i++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(z1(e[i])){const g=e[i];e[i]=g.next?.bind(g),e[i+1]=g.error?.bind(g),e[i+2]=g.complete?.bind(g)}let c,d,m;if(n instanceof ms)d=wn(n.firestore,Dr),m=$f(n._key.path),c={next:g=>{e[i]&&e[i](b2(d,n,g))},error:e[i+1],complete:e[i+2]};else{const g=wn(n,Cl);d=wn(g.firestore,Dr),m=g._query;const b=new xg(d);c={next:w=>{e[i]&&e[i](new pl(d,b,g,w))},error:e[i+1],complete:e[i+2]},p2(n._query)}const x=Zf(d);return E3(x,m,o,c)}function am(n,e){const t=Zf(n);return k3(t,e)}function b2(n,e,t){const i=t.docs.get(e._key),o=new xg(n);return new ml(n,o,e._key,i,new uu(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){A4(El),Ei(new Ar("firestore",((i,{instanceIdentifier:o,options:c})=>{const d=i.getProvider("app").getImmediate(),m=new Dr(new R4(i.getProvider("auth-internal")),new M4(d,i.getProvider("app-check-internal")),X4(d,o),d);return c={useFetchStreams:t,...c},m._setSettings(c),m}),"PUBLIC").setMultipleInstances(!0)),aa(U1,B1,e),aa(U1,B1,"esm2020")})();const y2="firebasestorage.googleapis.com",v2="storageBucket",G3=120*1e3,Y3=600*1e3;class xs extends Sa{constructor(e,t,i=0){super(j0(e),`Firebase Storage: ${t} (${j0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,xs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return j0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ps;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ps||(ps={}));function j0(n){return"storage/"+n}function yg(){const n="An unknown error occurred, please check the error payload for server response.";return new xs(ps.UNKNOWN,n)}function W3(n){return new xs(ps.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Q3(n){return new xs(ps.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function K3(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new xs(ps.UNAUTHENTICATED,n)}function X3(){return new xs(ps.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function J3(n){return new xs(ps.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Z3(){return new xs(ps.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function eI(){return new xs(ps.CANCELED,"User canceled the upload/download.")}function tI(n){return new xs(ps.INVALID_URL,"Invalid URL '"+n+"'.")}function sI(n){return new xs(ps.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function nI(){return new xs(ps.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+v2+"' property when initializing the app?")}function aI(){return new xs(ps.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function rI(){return new xs(ps.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function iI(n){return new xs(ps.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function lx(n){return new xs(ps.INVALID_ARGUMENT,n)}function w2(){return new xs(ps.APP_DELETED,"The Firebase app was deleted.")}function lI(n){return new xs(ps.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function bu(n,e){return new xs(ps.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Zc(n){throw new xs(ps.INTERNAL_ERROR,"Internal error: "+n)}class Vn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Vn.makeFromUrl(e,t)}catch{return new Vn(e,"")}if(i.path==="")return i;throw sI(e)}static makeFromUrl(e,t){let i=null;const o="([A-Za-z0-9.\\-_]+)";function c(ie){ie.path.charAt(ie.path.length-1)==="/"&&(ie.path_=ie.path_.slice(0,-1))}const d="(/(.*))?$",m=new RegExp("^gs://"+o+d,"i"),x={bucket:1,path:3};function g(ie){ie.path_=decodeURIComponent(ie.path)}const b="v[A-Za-z0-9_]+",w=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",R=new RegExp(`^https?://${w}/${b}/b/${o}/o${j}`,"i"),U={bucket:1,path:3},V=t===y2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,L="([^?#]*)",z=new RegExp(`^https?://${V}/${o}/${L}`,"i"),G=[{regex:m,indices:x,postModify:c},{regex:R,indices:U,postModify:g},{regex:z,indices:{bucket:1,path:2},postModify:g}];for(let ie=0;ie<G.length;ie++){const he=G[ie],W=he.regex.exec(e);if(W){const T=W[he.indices.bucket];let E=W[he.indices.path];E||(E=""),i=new Vn(T,E),he.postModify(i);break}}if(i==null)throw tI(e);return i}}class oI{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function cI(n,e,t){let i=1,o=null,c=null,d=!1,m=0;function x(){return m===2}let g=!1;function b(...L){g||(g=!0,e.apply(null,L))}function w(L){o=setTimeout(()=>{o=null,n(R,x())},L)}function j(){c&&clearTimeout(c)}function R(L,...z){if(g){j();return}if(L){j(),b.call(null,L,...z);return}if(x()||d){j(),b.call(null,L,...z);return}i<64&&(i*=2);let G;m===1?(m=2,G=0):G=(i+Math.random())*1e3,w(G)}let U=!1;function V(L){U||(U=!0,j(),!g&&(o!==null?(L||(m=2),clearTimeout(o),w(0)):L||(m=1)))}return w(0),c=setTimeout(()=>{d=!0,V(!0)},t),V}function uI(n){n(!1)}function dI(n){return n!==void 0}function hI(n){return typeof n=="object"&&!Array.isArray(n)}function vg(n){return typeof n=="string"||n instanceof String}function q1(n){return wg()&&n instanceof Blob}function wg(){return typeof Blob<"u"}function H1(n,e,t,i){if(i<e)throw lx(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw lx(`Invalid value for '${n}'. Expected ${t} or less.`)}function rm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function N2(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const o=e(i)+"="+e(n[i]);t=t+o+"&"}return t=t.slice(0,-1),t}var xl;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(xl||(xl={}));function fI(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}class mI{constructor(e,t,i,o,c,d,m,x,g,b,w,j=!0,R=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=m,this.errorCallback_=x,this.timeout_=g,this.progressCallback_=b,this.connectionFactory_=w,this.retry=j,this.isUsingEmulator=R,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((U,V)=>{this.resolve_=U,this.reject_=V,this.start_()})}start_(){const e=(i,o)=>{if(o){i(!1,new Eh(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=m=>{const x=m.loaded,g=m.lengthComputable?m.total:-1;this.progressCallback_!==null&&this.progressCallback_(x,g)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const m=c.getErrorCode()===xl.NO_ERROR,x=c.getStatus();if(!m||fI(x,this.additionalRetryCodes_)&&this.retry){const b=c.getErrorCode()===xl.ABORT;i(!1,new Eh(!1,null,b));return}const g=this.successCodes_.indexOf(x)!==-1;i(!0,new Eh(g,c))})},t=(i,o)=>{const c=this.resolve_,d=this.reject_,m=o.connection;if(o.wasSuccessCode)try{const x=this.callback_(m,m.getResponse());dI(x)?c(x):c()}catch(x){d(x)}else if(m!==null){const x=yg();x.serverResponse=m.getErrorText(),this.errorCallback_?d(this.errorCallback_(m,x)):d(x)}else if(o.canceled){const x=this.appDelete_?w2():eI();d(x)}else{const x=Z3();d(x)}};this.canceled_?t(!1,new Eh(!1,null,!0)):this.backoffId_=cI(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&uI(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Eh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function pI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function xI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function gI(n,e){e&&(n["X-Firebase-GMPID"]=e)}function bI(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function yI(n,e,t,i,o,c,d=!0,m=!1){const x=N2(n.urlParams),g=n.url+x,b=Object.assign({},n.headers);return gI(b,e),pI(b,t),xI(b,c),bI(b,i),new mI(g,n.method,b,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,m)}function vI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function wI(...n){const e=vI();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(wg())return new Blob(n);throw new xs(ps.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function NI(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function _I(n){if(typeof atob>"u")throw iI("base-64");return atob(n)}const Ha={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class S0{constructor(e,t){this.data=e,this.contentType=t||null}}function jI(n,e){switch(n){case Ha.RAW:return new S0(_2(e));case Ha.BASE64:case Ha.BASE64URL:return new S0(j2(n,e));case Ha.DATA_URL:return new S0(EI(e),TI(e))}throw yg()}function _2(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const c=i,d=n.charCodeAt(++t);i=65536|(c&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function SI(n){let e;try{e=decodeURIComponent(n)}catch{throw bu(Ha.DATA_URL,"Malformed data URL.")}return _2(e)}function j2(n,e){switch(n){case Ha.BASE64:{const o=e.indexOf("-")!==-1,c=e.indexOf("_")!==-1;if(o||c)throw bu(n,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Ha.BASE64URL:{const o=e.indexOf("+")!==-1,c=e.indexOf("/")!==-1;if(o||c)throw bu(n,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=_I(e)}catch(o){throw o.message.includes("polyfill")?o:bu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}class S2{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw bu(Ha.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=AI(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function EI(n){const e=new S2(n);return e.base64?j2(Ha.BASE64,e.rest):SI(e.rest)}function TI(n){return new S2(n).contentType}function AI(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class bi{constructor(e,t){let i=0,o="";q1(e)?(this.data_=e,i=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(q1(this.data_)){const i=this.data_,o=NI(i,e,t);return o===null?null:new bi(o)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new bi(i,!0)}}static getBlob(...e){if(wg()){const t=e.map(i=>i instanceof bi?i.data_:i);return new bi(wI.apply(null,t))}else{const t=e.map(d=>vg(d)?jI(Ha.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const o=new Uint8Array(i);let c=0;return t.forEach(d=>{for(let m=0;m<d.length;m++)o[c++]=d[m]}),new bi(o,!0)}}uploadData(){return this.data_}}function E2(n){let e;try{e=JSON.parse(n)}catch{return null}return hI(e)?e:null}function kI(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function CI(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function T2(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function RI(n,e){return e}class rn{constructor(e,t,i,o){this.server=e,this.local=t||e,this.writable=!!i,this.xform=o||RI}}let Th=null;function II(n){return!vg(n)||n.length<2?n:T2(n)}function A2(){if(Th)return Th;const n=[];n.push(new rn("bucket")),n.push(new rn("generation")),n.push(new rn("metageneration")),n.push(new rn("name","fullPath",!0));function e(c,d){return II(d)}const t=new rn("name");t.xform=e,n.push(t);function i(c,d){return d!==void 0?Number(d):d}const o=new rn("size");return o.xform=i,n.push(o),n.push(new rn("timeCreated")),n.push(new rn("updated")),n.push(new rn("md5Hash",null,!0)),n.push(new rn("cacheControl",null,!0)),n.push(new rn("contentDisposition",null,!0)),n.push(new rn("contentEncoding",null,!0)),n.push(new rn("contentLanguage",null,!0)),n.push(new rn("contentType",null,!0)),n.push(new rn("metadata","customMetadata",!0)),Th=n,Th}function DI(n,e){function t(){const i=n.bucket,o=n.fullPath,c=new Vn(i,o);return e._makeStorageReference(c)}Object.defineProperty(n,"ref",{get:t})}function MI(n,e,t){const i={};i.type="file";const o=t.length;for(let c=0;c<o;c++){const d=t[c];i[d.local]=d.xform(i,e[d.server])}return DI(i,n),i}function k2(n,e,t){const i=E2(e);return i===null?null:MI(n,i,t)}function OI(n,e,t,i){const o=E2(e);if(o===null||!vg(o.downloadTokens))return null;const c=o.downloadTokens;if(c.length===0)return null;const d=encodeURIComponent;return c.split(",").map(g=>{const b=n.bucket,w=n.fullPath,j="/b/"+d(b)+"/o/"+d(w),R=rm(j,t,i),U=N2({alt:"media",token:g});return R+U})[0]}function PI(n,e){const t={},i=e.length;for(let o=0;o<i;o++){const c=e[o];c.writable&&(t[c.server]=n[c.local])}return JSON.stringify(t)}class Ng{constructor(e,t,i,o){this.url=e,this.method=t,this.handler=i,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function C2(n){if(!n)throw yg()}function VI(n,e){function t(i,o){const c=k2(n,o,e);return C2(c!==null),c}return t}function LI(n,e){function t(i,o){const c=k2(n,o,e);return C2(c!==null),OI(c,o,n.host,n._protocol)}return t}function R2(n){function e(t,i){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=X3():o=K3():t.getStatus()===402?o=Q3(n.bucket):t.getStatus()===403?o=J3(n.path):o=i,o.status=t.getStatus(),o.serverResponse=i.serverResponse,o}return e}function I2(n){const e=R2(n);function t(i,o){let c=e(i,o);return i.getStatus()===404&&(c=W3(n.path)),c.serverResponse=o.serverResponse,c}return t}function UI(n,e,t){const i=e.fullServerUrl(),o=rm(i,n.host,n._protocol),c="GET",d=n.maxOperationRetryTime,m=new Ng(o,c,LI(n,t),d);return m.errorHandler=I2(e),m}function BI(n,e){const t=e.fullServerUrl(),i=rm(t,n.host,n._protocol),o="DELETE",c=n.maxOperationRetryTime;function d(x,g){}const m=new Ng(i,o,d,c);return m.successCodes=[200,204],m.errorHandler=I2(e),m}function zI(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function FI(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=zI(null,e)),i}function $I(n,e,t,i,o){const c=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function m(){let G="";for(let ie=0;ie<2;ie++)G=G+Math.random().toString().slice(2);return G}const x=m();d["Content-Type"]="multipart/related; boundary="+x;const g=FI(e,i,o),b=PI(g,t),w="--"+x+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+x+`\r
Content-Type: `+g.contentType+`\r
\r
`,j=`\r
--`+x+"--",R=bi.getBlob(w,i,j);if(R===null)throw aI();const U={name:g.fullPath},V=rm(c,n.host,n._protocol),L="POST",z=n.maxUploadRetryTime,Q=new Ng(V,L,VI(n,t),z);return Q.urlParams=U,Q.headers=d,Q.body=R.uploadData(),Q.errorHandler=R2(e),Q}class qI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=xl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=xl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=xl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,o,c){if(this.sent_)throw Zc("cannot .send() more than once");if(er(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),c!==void 0)for(const d in c)c.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,c[d].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Zc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Zc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Zc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Zc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class HI extends qI{initXhr(){this.xhr_.responseType="text"}}function _g(){return new HI}class _l{constructor(e,t){this._service=e,t instanceof Vn?this._location=t:this._location=Vn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new _l(e,t)}get root(){const e=new Vn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return T2(this._location.path)}get storage(){return this._service}get parent(){const e=kI(this._location.path);if(e===null)return null;const t=new Vn(this._location.bucket,e);return new _l(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw lI(e)}}function GI(n,e,t){n._throwIfRoot("uploadBytes");const i=$I(n.storage,n._location,A2(),new bi(e,!0),t);return n.storage.makeRequestWithTokens(i,_g).then(o=>({metadata:o,ref:n}))}function YI(n){n._throwIfRoot("getDownloadURL");const e=UI(n.storage,n._location,A2());return n.storage.makeRequestWithTokens(e,_g).then(t=>{if(t===null)throw rI();return t})}function WI(n){n._throwIfRoot("deleteObject");const e=BI(n.storage,n._location);return n.storage.makeRequestWithTokens(e,_g)}function QI(n,e){const t=CI(n._location.path,e),i=new Vn(n._location.bucket,t);return new _l(n.storage,i)}function KI(n){return/^[A-Za-z]+:\/\//.test(n)}function XI(n,e){return new _l(n,e)}function D2(n,e){if(n instanceof jg){const t=n;if(t._bucket==null)throw nI();const i=new _l(t,t._bucket);return e!=null?D2(i,e):i}else return e!==void 0?QI(n,e):n}function JI(n,e){if(e&&KI(e)){if(n instanceof jg)return XI(n,e);throw lx("To use ref(service, url), the first argument must be a Storage instance.")}else return D2(n,e)}function G1(n,e){const t=e?.[v2];return t==null?null:Vn.makeFromBucketSpec(t,n)}function ZI(n,e,t,i={}){n.host=`${e}:${t}`;const o=er(e);o&&(Df(`https://${n.host}/b`),Mf("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=i;c&&(n._overrideAuthToken=typeof c=="string"?c:s_(c,n.app.options.projectId))}class jg{constructor(e,t,i,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=y2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=G3,this._maxUploadRetryTime=Y3,this._requests=new Set,o!=null?this._bucket=Vn.makeFromBucketSpec(o,this._host):this._bucket=G1(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Vn.makeFromBucketSpec(this._url,e):this._bucket=G1(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){H1("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){H1("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(xn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new _l(this,e)}_makeRequest(e,t,i,o,c=!0){if(this._deleted)return new oI(w2());{const d=yI(e,this._appId,i,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,o).getPromise()}}const Y1="@firebase/storage",W1="0.14.0";const M2="storage";function eD(n,e,t){return n=Xt(n),GI(n,e,t)}function tD(n){return n=Xt(n),YI(n)}function sD(n){return n=Xt(n),WI(n)}function Q1(n,e){return n=Xt(n),JI(n,e)}function nD(n=Of(),e){n=Xt(n);const i=Uu(n,M2).getImmediate({identifier:e}),o=Sx("storage");return o&&aD(i,...o),i}function aD(n,e,t,i={}){ZI(n,e,t,i)}function rD(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new jg(t,i,o,e,El)}function iD(){Ei(new Ar(M2,rD,"PUBLIC").setMultipleInstances(!0)),aa(Y1,W1,""),aa(Y1,W1,"esm2020")}iD();const lD={apiKey:"AIzaSyC1qZ9fK-6LFBxVWZsAD4dZq-KVg36A7f8",authDomain:"scheduler-65e51.firebaseapp.com",projectId:"scheduler-65e51",storageBucket:"scheduler-65e51.firebasestorage.app",messagingSenderId:"93993791456",appId:"1:93993791456:web:3a777a2da0dad4b8b74585"},Sg=r_(lD),ve=D3(Sg),ya=j4(Sg),K1=nD(Sg);const O2=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();const oD=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const cD=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase());const X1=n=>{const e=cD(n);return e.charAt(0).toUpperCase()+e.slice(1)};var uD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const dD=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const hD=_.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:o="",children:c,iconNode:d,...m},x)=>_.createElement("svg",{ref:x,...uD,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:O2("lucide",o),...!c&&!dD(m)&&{"aria-hidden":"true"},...m},[...d.map(([g,b])=>_.createElement(g,b)),...Array.isArray(c)?c:[c]]));const Re=(n,e)=>{const t=_.forwardRef(({className:i,...o},c)=>_.createElement(hD,{ref:c,iconNode:e,className:O2(`lucide-${oD(X1(n))}`,`lucide-${n}`,i),...o}));return t.displayName=X1(n),t};const fD=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],yu=Re("archive",fD);const mD=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],pD=Re("arrow-down-right",mD);const xD=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],xa=Re("arrow-left",xD);const gD=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Co=Re("arrow-right",gD);const bD=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],yD=Re("arrow-up-down",bD);const vD=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],P2=Re("arrow-up-right",vD);const wD=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],J1=Re("ban",wD);const ND=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],_o=Re("bell",ND);const _D=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],jD=Re("bot",_D);const SD=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],ED=Re("building-2",SD);const TD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],va=Re("calendar-check",TD);const AD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Z1=Re("calendar-days",AD);const kD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Tt=Re("calendar",kD);const CD=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],RD=Re("camera",CD);const ID=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Eg=Re("chart-column",ID);const DD=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],V2=Re("chart-pie",DD);const MD=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],tn=Re("check",MD);const OD=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Iu=Re("chevron-down",OD);const PD=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Tg=Re("chevron-left",PD);const VD=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Xu=Re("chevron-right",VD);const LD=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ox=Re("chevron-up",LD);const UD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Du=Re("circle-alert",UD);const BD=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Os=Re("circle-check-big",BD);const zD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],qa=Re("circle-x",zD);const FD=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ts=Re("clock",FD);const $D=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],qD=Re("code",$D);const HD=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],Nf=Re("coffee",HD);const GD=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],L2=Re("copy",GD);const YD=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],yn=Re("credit-card",YD);const WD=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Uo=Re("crown",WD);const QD=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ro=Re("dollar-sign",QD);const KD=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],gl=Re("external-link",KD);const XD=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],vu=Re("eye",XD);const JD=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],ZD=Re("ghost",JD);const eM=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],tM=Re("gift",eM);const sM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],nM=Re("globe",sM);const aM=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],rM=Re("headphones",aM);const iM=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Ag=Re("heart",iM);const lM=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],kg=Re("image",lM);const oM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],eN=Re("info",oM);const cM=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],cx=Re("list-ordered",cM);const uM=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]],_f=Re("list-plus",uM);const dM=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],sa=Re("loader-circle",dM);const hM=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],jf=Re("lock",hM);const fM=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Sf=Re("log-out",fM);const mM=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Ef=Re("mail",mM);const pM=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],xM=Re("map-pin",pM);const gM=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],U2=Re("menu",gM);const bM=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Tf=Re("message-circle",bM);const yM=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],ux=Re("message-square",yM);const vM=[["path",{d:"M5 12h14",key:"1ays0h"}]],wM=Re("minus",vM);const NM=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],_M=Re("palette",NM);const jM=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],B2=Re("party-popper",jM);const SM=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Cg=Re("pen-line",SM);const EM=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],dx=Re("phone",EM);const TM=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],E0=Re("play",TM);const AM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Za=Re("plus",AM);const kM=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Mu=Re("refresh-cw",kM);const CM=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],Si=Re("repeat",CM);const RM=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],z2=Re("save",RM);const IM=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Gh=Re("search",IM);const DM=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Yh=Re("send",DM);const MM=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Wh=Re("settings",MM);const OM=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Qh=Re("shield",OM);const PM=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],F2=Re("sparkles",PM);const VM=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],tN=Re("star",VM);const LM=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],sN=Re("sticky-note",LM);const UM=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],vr=Re("store",UM);const BM=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Nn=Re("tag",BM);const zM=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],$2=Re("thermometer",zM);const FM=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],q2=Re("timer",FM);const $M=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ga=Re("trash-2",$M);const qM=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Bo=Re("trending-up",qM);const HM=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],na=Re("triangle-alert",HM);const GM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],H2=Re("user-plus",GM);const YM=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],jl=Re("user",YM);const WM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Pt=Re("users",WM);const QM=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],nN=Re("wallet",QM);const KM=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Rs=Re("x",KM);const XM=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Xo=Re("zap",XM);function aN({className:n=""}){return a.jsxs(at,{to:"/",className:`flex items-center gap-2.5 ${n}`,children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(va,{className:"w-[18px] h-[18px] text-white"})}),a.jsxs("span",{className:"text-xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function JM(){return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-100",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsx(aN,{}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(at,{to:"/login",className:"px-4 py-2.5 text-sm font-semibold text-slate-600 hover:text-slate-900 transition-colors",children:"Sign In"}),a.jsxs(at,{to:"/register",className:"hidden sm:inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:["Get Started Free",a.jsx(Co,{className:"w-4 h-4"})]}),a.jsx(at,{to:"/register",className:"sm:hidden px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all",children:"Start Free"})]})]})}),a.jsxs("section",{className:"relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 -z-10",children:[a.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-blue-50 rounded-full blur-3xl opacity-60 -translate-y-1/2 translate-x-1/3"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-violet-50 rounded-full blur-3xl opacity-50 translate-y-1/3 -translate-x-1/4"})]}),a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 pt-16 sm:pt-24 pb-16 sm:pb-20",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-16 items-center",children:[a.jsxs("div",{className:"animate-fade-in-up",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 px-3.5 py-1.5 bg-blue-50 border border-blue-100 rounded-full text-sm font-medium text-blue-700 mb-6",children:[a.jsx(F2,{className:"w-3.5 h-3.5"}),"Free for beauty professionals"]}),a.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-[3.5rem] font-extrabold text-slate-900 leading-[1.1] mb-6 tracking-tight",children:["Online booking",a.jsx("br",{}),a.jsx("span",{className:"text-blue-600",children:"made effortless"})]}),a.jsx("p",{className:"text-lg sm:text-xl text-slate-600 leading-relaxed mb-8 max-w-lg",children:"Let clients book 24/7. Manage your team, services, and schedule from one beautiful dashboard. No more phone tag."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-10",children:[a.jsxs(at,{to:"/register",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-base shadow-lg shadow-blue-600/25 hover:shadow-xl hover:shadow-blue-600/30 transition-all hover:-translate-y-0.5",children:["Start for Free",a.jsx(Co,{className:"w-4 h-4"})]}),a.jsx("a",{href:"#how-it-works",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-base border border-slate-200 transition-all",children:"See How It Works"})]}),a.jsxs("div",{className:"flex items-center gap-5 text-sm text-slate-500",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Os,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"Free to use"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Os,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"No credit card"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Os,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"Setup in 2 min"})]})]})]}),a.jsxs("div",{className:"relative animate-fade-in-up",style:{animationDelay:"150ms"},children:[a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl shadow-slate-200/60 border border-slate-200/80 overflow-hidden",children:[a.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-slate-50 border-b border-slate-100",children:[a.jsxs("div",{className:"flex gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"})]}),a.jsx("div",{className:"flex-1 mx-4",children:a.jsx("div",{className:"bg-white border border-slate-200 rounded-lg px-3 py-1.5 text-xs text-slate-400 font-mono",children:"bookflow.app/shop/janes-salon"})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-sm font-bold",children:"J"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-slate-900",children:"Jane's Salon"}),a.jsx("div",{className:"text-xs text-slate-500",children:"Book your next appointment"})]})]}),a.jsx("div",{className:"space-y-2.5",children:[{name:"Haircut & Style",price:"$45",time:"45 min",color:"bg-blue-500"},{name:"Color Treatment",price:"$120",time:"2 hours",color:"bg-violet-500"},{name:"Blowout",price:"$35",time:"30 min",color:"bg-emerald-500"}].map(n=>a.jsxs("div",{className:"flex items-center justify-between p-3.5 bg-slate-50 rounded-xl border border-slate-100 group hover:border-blue-200 hover:bg-blue-50/50 transition-all cursor-default",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-2 h-8 ${n.color} rounded-full`}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-800",children:n.name}),a.jsx("div",{className:"text-xs text-slate-500",children:n.time})]})]}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:n.price})]},n.name))})]})]}),a.jsxs("div",{className:"absolute -bottom-4 -left-4 bg-white rounded-xl shadow-lg shadow-slate-200/60 border border-slate-100 px-4 py-3 flex items-center gap-3 animate-float",children:[a.jsx("div",{className:"w-9 h-9 bg-emerald-100 rounded-full flex items-center justify-center",children:a.jsx(Os,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-slate-500",children:"Booking confirmed"}),a.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Tomorrow at 2:00 PM"})]})]})]})]})})]}),a.jsx("section",{className:"border-y border-slate-100 bg-slate-50/50",children:a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-8 sm:py-10",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-8 sm:gap-16 text-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"500+"}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Businesses trust SpotBookie"})]}),a.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"10,000+"}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Appointments booked"})]}),a.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl sm:text-3xl font-extrabold text-slate-900",children:["4.9 ",a.jsx(tN,{className:"w-5 h-5 text-amber-400 fill-amber-400"})]}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Average rating"})]})]})})}),a.jsx("section",{className:"py-20 sm:py-28",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Everything you need to run your bookings"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Built specifically for beauty professionals, salons, and service businesses. Simple, powerful, and free."})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 stagger-children",children:[{icon:a.jsx(Tt,{className:"w-6 h-6"}),title:"Smart Scheduling",desc:"Set weekly hours with breaks. Slots auto-generate so your calendar is always up to date.",color:"bg-blue-100 text-blue-600"},{icon:a.jsx(Pt,{className:"w-6 h-6"}),title:"Multi-Staff Support",desc:"Add your whole team. Each member gets their own schedule, hours, and bookings.",color:"bg-violet-100 text-violet-600"},{icon:a.jsx(Xo,{className:"w-6 h-6"}),title:"Instant Booking",desc:"Clients pick a service, choose a stylist, and book  all in under a minute.",color:"bg-amber-100 text-amber-600"},{icon:a.jsx(nM,{className:"w-6 h-6"}),title:"Your Own Booking Page",desc:"Get a unique link to share anywhere. No app downloads needed for your clients.",color:"bg-emerald-100 text-emerald-600"}].map(n=>a.jsxs("div",{className:"group bg-white rounded-2xl p-7 border border-slate-200/80 hover:border-slate-300 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[a.jsx("div",{className:`w-12 h-12 ${n.color} rounded-xl flex items-center justify-center mb-5 group-hover:scale-110 transition-transform duration-300`,children:n.icon}),a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:n.title}),a.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:n.desc})]},n.title))})]})}),a.jsx("section",{id:"how-it-works",className:"py-20 sm:py-28 bg-slate-50 border-y border-slate-100",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Up and running in minutes"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Three simple steps to start accepting online bookings today."})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-8 lg:gap-12 relative",children:[a.jsx("div",{className:"hidden md:block absolute top-14 left-[calc(16.67%+1rem)] right-[calc(16.67%+1rem)] h-px bg-gradient-to-r from-blue-200 via-violet-200 to-emerald-200"}),[{step:"1",title:"Create your account",desc:"Sign up free in 30 seconds. Name your shop and you're in.",color:"from-blue-500 to-blue-600",shadow:"shadow-blue-500/30"},{step:"2",title:"Set up your shop",desc:"Add your services, team, and weekly hours. SpotBookie handles the rest.",color:"from-violet-500 to-violet-600",shadow:"shadow-violet-500/30"},{step:"3",title:"Share your link",desc:"Send your booking page to clients. They book, you get notified.",color:"from-emerald-500 to-emerald-600",shadow:"shadow-emerald-500/30"}].map(n=>a.jsxs("div",{className:"relative text-center",children:[a.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${n.color} rounded-2xl flex items-center justify-center mx-auto mb-6 text-white text-xl font-extrabold shadow-lg ${n.shadow} relative z-10`,children:n.step}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:n.title}),a.jsx("p",{className:"text-slate-600 leading-relaxed max-w-xs mx-auto",children:n.desc})]},n.step))]})]})}),a.jsx("section",{className:"py-20 sm:py-28",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Loved by professionals"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"See why salons and stylists are switching to SpotBookie."})]}),a.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{quote:"SpotBookie replaced our paper appointment book. Clients love being able to book online anytime.",name:"Maria Santos",role:"Salon Owner",initials:"MS",color:"bg-blue-100 text-blue-700"},{quote:"Setting up was incredibly easy. I had my booking page live and shared with clients in under 10 minutes.",name:"David Chen",role:"Barber",initials:"DC",color:"bg-violet-100 text-violet-700"},{quote:"The multi-staff feature is perfect. Each stylist manages their own schedule and clients can pick who they want.",name:"Lisa Park",role:"Studio Manager",initials:"LP",color:"bg-emerald-100 text-emerald-700"}].map(n=>a.jsxs("div",{className:"bg-white rounded-2xl p-7 border border-slate-200/80 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[a.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(5)].map((e,t)=>a.jsx(tN,{className:"w-4 h-4 text-amber-400 fill-amber-400"},t))}),a.jsxs("p",{className:"text-slate-700 leading-relaxed mb-6",children:['"',n.quote,'"']}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 ${n.color} rounded-full flex items-center justify-center text-sm font-bold`,children:n.initials}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:n.name}),a.jsx("div",{className:"text-xs text-slate-500",children:n.role})]})]})]},n.name))})]})}),a.jsxs("section",{className:"py-20 sm:py-28 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 -z-0",children:[a.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-violet-500/10 rounded-full blur-3xl"})]}),a.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto px-5 sm:px-8 text-center",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-extrabold text-white mb-6 leading-tight",children:"Ready to streamline your bookings?"}),a.jsx("p",{className:"text-lg text-slate-400 mb-10 max-w-xl mx-auto",children:"Join hundreds of professionals who have ditched the old appointment book. Set up in minutes, free forever."}),a.jsxs(at,{to:"/register",className:"inline-flex items-center gap-2 px-8 py-4 bg-white hover:bg-slate-50 text-slate-900 rounded-xl font-bold text-lg transition-all hover:shadow-xl hover:shadow-white/10 hover:-translate-y-0.5",children:["Create Your Free Account",a.jsx(Co,{className:"w-5 h-5"})]})]})]}),a.jsx("footer",{className:"bg-white border-t border-slate-100",children:a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-10",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[a.jsx(aN,{}),a.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500",children:[a.jsx(at,{to:"/register",className:"hover:text-slate-900 transition-colors",children:"Sign Up"}),a.jsx("span",{className:"text-slate-200",children:""}),a.jsx(at,{to:"/login",className:"hover:text-slate-900 transition-colors",children:"Sign In"}),a.jsx("span",{className:"text-slate-200",children:""}),a.jsx("a",{href:"#how-it-works",className:"hover:text-slate-900 transition-colors",children:"How It Works"})]}),a.jsxs("p",{className:"text-xs text-slate-400",children:[" ",new Date().getFullYear()," SpotBookie. All rights reserved."]})]})})})]})}function ZM(n){return n.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function eO(){const n=Di(),[e,t]=_.useState(""),[i,o]=_.useState(""),[c,d]=_.useState(""),[m,x]=_.useState(""),[g,b]=_.useState(!1),w=ZM(e),j=async R=>{if(R.preventDefault(),x(""),!w){x("Please enter a valid shop name");return}if(c.length<6){x("Password must be at least 6 characters");return}b(!0);try{const U=Ln(Ke(ve,"shops"),bn("slug","==",w));if(!(await Ms(U)).empty){x("A shop with that name already exists. Please choose a different name."),b(!1);return}const z=(await uC(ya,i,c)).user;await _a(Ke(ve,"shops"),{name:e.trim(),slug:w,ownerUid:z.uid,ownerEmail:i,createdAt:ji()}),n(`/shop/${w}/dashboard`)}catch(U){switch(U.code){case"auth/email-already-in-use":x("An account with this email already exists");break;case"auth/invalid-email":x("Please enter a valid email address");break;case"auth/weak-password":x("Password must be at least 6 characters");break;default:x("Registration failed. Please try again.")}}finally{b(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(va,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Create your shop"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Set up your booking page in seconds  it's free"})]}),a.jsxs("form",{onSubmit:j,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Shop Name"}),a.jsx("input",{type:"text",value:e,onChange:R=>{t(R.target.value),x("")},placeholder:"Jane's Salon",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),w&&a.jsxs("p",{className:"mt-1.5 text-xs text-slate-400",children:["Your page: ",a.jsxs("span",{className:"font-mono text-blue-600 font-medium",children:["bookflow.app/shop/",w]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:i,onChange:R=>{o(R.target.value),x("")},placeholder:"you@example.com",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:c,onChange:R=>{d(R.target.value),x("")},placeholder:"At least 6 characters",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${m?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),m&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",m]})]}),a.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Creating your shop"]}):a.jsxs(a.Fragment,{children:["Create Shop",a.jsx(Co,{className:"w-4 h-4"})]})})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Already have an account?"," ",a.jsx(at,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Sign in"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(at,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(xa,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function tO({user:n}){const e=Di(),[t,i]=_.useState(""),[o,c]=_.useState(""),[d,m]=_.useState(""),[x,g]=_.useState(!1);_.useState(()=>{if(!n)return;(async()=>{const j=Ln(Ke(ve,"shops"),bn("ownerUid","==",n.uid)),R=await Ms(j);if(!R.empty){const U=R.docs[0].data();e(`/shop/${U.slug}/dashboard`,{replace:!0})}})()},[n,e]);const b=async w=>{w.preventDefault(),m(""),g(!0);try{const R=(await Mx(ya,t,o)).user,U=Ln(Ke(ve,"shops"),bn("ownerUid","==",R.uid)),V=await Ms(U);if(V.empty){m("No shop found for this account. Need to create one?"),await ya.signOut(),g(!1);return}const L=V.docs[0].data();e(`/shop/${L.slug}/dashboard`,{replace:!0})}catch(j){switch(j.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":m("Invalid email or password");break;case"auth/invalid-email":m("Please enter a valid email address");break;case"auth/too-many-requests":m("Too many failed attempts. Please try again later.");break;default:m("Login failed. Please try again.")}c("")}finally{g(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(va,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:t,onChange:w=>{i(w.target.value),m("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:o,onChange:w=>{c(w.target.value),m("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${d?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),d&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",d]})]}),a.jsx("button",{type:"submit",disabled:x,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:x?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):a.jsxs(a.Fragment,{children:["Sign In",a.jsx(Co,{className:"w-4 h-4"})]})})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",a.jsx(at,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(at,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(xa,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function G2({availableDates:n,selectedDate:e,onSelectDate:t}){const[i,o]=_.useState(new Date),c=z=>{const Q=z.getFullYear(),G=z.getMonth(),ie=new Date(Q,G,1),W=new Date(Q,G+1,0).getDate(),T=ie.getDay();return{daysInMonth:W,startingDayOfWeek:T,year:Q,month:G}},{daysInMonth:d,startingDayOfWeek:m,year:x,month:g}=c(i),b=()=>{o(new Date(i.getFullYear(),i.getMonth()-1))},w=()=>{o(new Date(i.getFullYear(),i.getMonth()+1))},j=z=>{const Q=`${x}-${String(g+1).padStart(2,"0")}-${String(z).padStart(2,"0")}`;return n.includes(Q)},R=z=>`${x}-${String(g+1).padStart(2,"0")}-${String(z).padStart(2,"0")}`===e,U=z=>{if(j(z)){const Q=`${x}-${String(g+1).padStart(2,"0")}-${String(z).padStart(2,"0")}`;t(Q)}},V=["January","February","March","April","May","June","July","August","September","October","November","December"],L=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return a.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-5 sm:p-6 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-5",children:[a.jsx("button",{onClick:b,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Tg,{className:"w-5 h-5 text-slate-600"})}),a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[V[g]," ",x]}),a.jsx("button",{onClick:w,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Xu,{className:"w-5 h-5 text-slate-600"})})]}),a.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:L.map(z=>a.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:z},z))}),a.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:m}).map((z,Q)=>a.jsx("div",{},`empty-${Q}`)),Array.from({length:d}).map((z,Q)=>{const G=Q+1,ie=j(G),he=R(G),W=new Date,T=W.getDate()===G&&W.getMonth()===g&&W.getFullYear()===x;return a.jsxs("button",{onClick:()=>U(G),disabled:!ie,className:`
                relative p-2.5 sm:p-3 text-center rounded-lg text-sm font-semibold transition-all duration-200
                ${he?"bg-blue-600 text-white shadow-md shadow-blue-600/30":ie?"bg-emerald-50 text-emerald-700 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-300 cursor-pointer":T?"text-slate-900 font-bold":"text-slate-300 cursor-not-allowed"}
              `,children:[G,T&&!he&&a.jsx("span",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]},G)})]}),a.jsxs("div",{className:"mt-4 flex gap-5 text-xs text-slate-500",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 bg-emerald-50 border border-emerald-200 rounded"}),a.jsx("span",{children:"Available"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded"}),a.jsx("span",{children:"Selected"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-1 h-1 bg-blue-500 rounded-full"}),a.jsx("span",{children:"Today"})]})]})]})}const sO=[{key:"monday",label:"Mon"},{key:"tuesday",label:"Tue"},{key:"wednesday",label:"Wed"},{key:"thursday",label:"Thu"},{key:"friday",label:"Fri"},{key:"saturday",label:"Sat"},{key:"sunday",label:"Sun"}],rN=[{key:"morning",label:"Morning (9AM12PM)",start:"09:00",end:"12:00"},{key:"afternoon",label:"Afternoon (12PM5PM)",start:"12:00",end:"17:00"},{key:"evening",label:"Evening (5PM9PM)",start:"17:00",end:"21:00"},{key:"any",label:"Any time",start:"00:00",end:"23:59"}];function nO(){const n="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="WL";for(let t=0;t<4;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}function iN({shopId:n,slug:e,selectedService:t,selectedStaff:i,staffMembers:o,preferredDate:c,onSuccess:d,onCancel:m}){const[x,g]=_.useState({name:"",email:"",phone:""}),[b,w]=_.useState([]),[j,R]=_.useState("any"),[U,V]=_.useState(!1),[L,z]=_.useState(!1),[Q,G]=_.useState(""),ie=W=>{w(T=>T.includes(W)?T.filter(E=>E!==W):[...T,W])},he=async W=>{W.preventDefault(),V(!0);try{const T=nO(),E=rN.find(M=>M.key===j),S=i&&i!=="any"?i.id:"any",I=i&&i!=="any"?i.name:"Any Available",k={clientName:x.name,clientEmail:x.email,clientPhone:x.phone,serviceId:t?.id||null,serviceName:t?.name||"Any Service",staffId:S,staffName:I,preferredDate:c||null,preferredDays:b.length>0?b:null,preferredTimeRange:E?{start:E.start,end:E.end}:null,status:"waiting",refCode:T,createdAt:new Date().toISOString(),notifiedAt:null,notifiedSlot:null};await _a(Ke(ve,"shops",n,"waitlist"),k),G(T),z(!0),d&&d(T)}catch(T){console.error("Waitlist error:",T)}finally{V(!1)}};return L?a.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg shadow-blue-100/50 p-8 text-center animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Os,{className:"w-8 h-8 text-blue-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"You're on the Waitlist!"}),a.jsxs("p",{className:"text-slate-600 mb-4",children:["We'll notify you when a slot opens up",t?` for ${t.name}`:"","."]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your waitlist reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:Q})]}),a.jsxs("a",{href:`#/shop/${e}/waitlist/${Q}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(ts,{className:"w-4 h-4"}),"Check Waitlist Status"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to check your position and get notified"})]}):a.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg p-6 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(_f,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Join the Waitlist"}),a.jsx("p",{className:"text-sm text-slate-500",children:"We'll notify you when a slot opens up"})]})]}),a.jsxs("form",{onSubmit:he,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),a.jsx("input",{type:"text",value:x.name,onChange:W=>g({...x,name:W.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:x.email,onChange:W=>g({...x,email:W.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),a.jsx("input",{type:"tel",value:x.phone,onChange:W=>g({...x,phone:W.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["Preferred Days ",a.jsx("span",{className:"text-slate-400 font-normal",children:"(optional)"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:sO.map(W=>a.jsx("button",{type:"button",onClick:()=>ie(W.key),className:`px-3.5 py-2 rounded-lg text-sm font-semibold transition-all border ${b.includes(W.key)?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:W.label},W.key))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preferred Time"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:rN.map(W=>a.jsx("button",{type:"button",onClick:()=>R(W.key),className:`px-3.5 py-2.5 rounded-lg text-sm font-medium transition-all border text-left ${j===W.key?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:W.label},W.key))})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:U,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:U?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Joining"]}):a.jsxs(a.Fragment,{children:[a.jsx(_f,{className:"w-4 h-4"}),"Join Waitlist"]})}),m&&a.jsx("button",{type:"button",onClick:m,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]})}function aO(){return a.jsxs("div",{className:"flex items-end gap-2 mb-3",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:a.jsx(Tf,{className:"w-3.5 h-3.5 text-white"})}),a.jsx("div",{className:"bg-slate-100 rounded-2xl rounded-bl-md px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})}function rO({message:n,onSelectService:e,onQuickReply:t}){const i=n.sender==="bot";return a.jsxs("div",{className:`flex items-end gap-2 mb-3 ${i?"":"flex-row-reverse"}`,children:[i&&a.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:a.jsx(Tf,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("div",{className:"max-w-[85%] space-y-2",children:[a.jsx("div",{className:`px-4 py-2.5 text-sm leading-relaxed whitespace-pre-line ${i?"bg-slate-100 text-slate-800 rounded-2xl rounded-bl-md":"bg-blue-600 text-white rounded-2xl rounded-br-md"}`,children:n.text}),n.serviceCards&&n.serviceCards.length>0&&a.jsx("div",{className:"space-y-1.5",children:n.serviceCards.map(o=>a.jsxs("button",{onClick:()=>e(o),className:"w-full flex items-center justify-between gap-2 px-3.5 py-2.5 bg-white border border-slate-200 hover:border-blue-400 rounded-xl text-left transition-all hover:shadow-sm group",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold text-slate-800 group-hover:text-blue-700 truncate",children:o.name}),a.jsxs("p",{className:"text-xs text-slate-500",children:[Kh(o.duration),"  ",hx(o.price)]})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 whitespace-nowrap flex items-center gap-0.5",children:["Book ",a.jsx(Xu,{className:"w-3 h-3"})]})]},o.id))}),n.quickReplies&&n.quickReplies.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5 pt-1",children:n.quickReplies.map((o,c)=>a.jsx("button",{onClick:()=>t(o),className:"px-3 py-1.5 text-xs font-medium text-blue-600 bg-white border border-blue-200 hover:bg-blue-50 hover:border-blue-400 rounded-full transition-all",children:o},c))})]})]})}function hx(n){return n==null?"":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(n)}function Kh(n){if(!n)return"";if(n<60)return`${n} min`;const e=Math.floor(n/60),t=n%60;return t?`${e}h ${t}m`:`${e} hour${e>1?"s":""}`}function iO(n,{services:e,staffMembers:t,shop:i}){const o=n.toLowerCase().trim(),c=i?.name||"our shop";if(/^(hi|hello|hey|howdy|sup|yo|hiya|good\s*(morning|afternoon|evening))/.test(o))return{text:`Hi!  I'm here to help you book an appointment at ${c}. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]};if(/how (do i|to|can i) book|help.*(book|appoint)|booking help/i.test(o))return{text:`Booking is easy! Here's how:

1 Choose a service
2 Pick your stylist
3 Select a date & time
4 Fill in your details

That's it! Would you like to start?`,quickReplies:["View Services","View Staff"]};if(/what (services|do you offer)|menu|prices|how much|service list|your services/i.test(o)||o==="view services")return!e||e.length===0?{text:"We don't have any services listed right now. Please check back later!"}:{text:`Here are our services:

${e.map(m=>` ${m.name}  ${Kh(m.duration)}  ${hx(m.price)}`).join(`
`)}

Would you like to book one of these? Just tap below! `,serviceCards:e};if(e&&e.length>0){const d=e.find(m=>{const x=m.name.toLowerCase();return o.includes(x)||x.includes(o)});if(d&&o.length>2)return{text:`Great choice! Here are the details for **${d.name}**:

 Duration: ${Kh(d.duration)}
 Price: ${hx(d.price)}${d.description?`
 ${d.description}`:""}

Would you like to book this service? Tap "Book" below!`,serviceCards:[d],quickReplies:["View All Services","View Staff"]}}if(/how long|how much time|duration/i.test(o))return!e||e.length===0?{text:"No services are listed right now. Check back soon!"}:{text:`Here's how long each service takes:

${e.map(m=>` ${m.name}: ${Kh(m.duration)}`).join(`
`)}`,quickReplies:["View Services","How to Book"]};if(/who works|stylists?|staff|team|barber|who('s| is) (here|available)|your (team|people)/i.test(o)||o==="view staff")return!t||t.length===0?{text:"We don't have any team members listed right now."}:{text:`Meet our team! 

${t.map(m=>{let x=` ${m.name}`;return m.role&&(x+=`  ${m.role}`),m.bio&&(x+=`
  "${m.bio.slice(0,80)}${m.bio.length>80?"":""}"`),x}).join(`
`)}

You can pick your preferred stylist during booking.`,quickReplies:["View Services","How to Book"]};if(/available|open slot|when can i|next available|free slot|any opening/i.test(o)){const d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],m=new Set;return t&&t.length>0&&t.forEach(g=>{g.weeklyHours&&Object.entries(g.weeklyHours).forEach(([b,w])=>{w&&w.enabled&&m.add(b)})}),{text:`You can check available times by selecting a service and date in the booking flow above. We're generally available on ${m.size>0?[...m].sort((g,b)=>d.indexOf(g)-d.indexOf(b)).join(", "):"most days"}. `,quickReplies:["View Services","How to Book"]}}if(/hours|when are you open|business hours|open hours|what time|operating/i.test(o)){const d=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],m={};if(t&&t.length>0&&t.forEach(x=>{x.weeklyHours&&Object.entries(x.weeklyHours).forEach(([g,b])=>{b&&b.enabled&&b.start&&b.end&&(m[g]?(b.start<m[g].start&&(m[g].start=b.start),b.end>m[g].end&&(m[g].end=b.end)):m[g]={start:b.start,end:b.end})})}),Object.keys(m).length>0){const x=b=>{const[w,j]=b.split(":"),R=parseInt(w),U=R>=12?"PM":"AM";return`${R%12||12}:${j} ${U}`};return{text:`Here are our general hours:

${d.filter(b=>m[b]).map(b=>` ${b}: ${x(m[b].start)}  ${x(m[b].end)}`).join(`
`)}

Hours may vary by stylist. Select a service to see exact availability.`,quickReplies:["View Services","View Staff"]}}return{text:"Our hours vary by stylist. You can see exact availability by selecting a service above.",quickReplies:["View Services","How to Book"]}}return/phone|address|contact|where|location|email|reach/i.test(o)?{text:"For contact information, please reach out to the shop directly. You can also find us through the booking confirmation email after you book! ",quickReplies:["View Services","How to Book"]}:/cancel|reschedule|change my (booking|appointment)|modify/i.test(o)?{text:"You can manage your booking using the reference code you received. Go to your confirmation email and click 'Manage Booking' to reschedule or cancel. ",quickReplies:["How to Book","View Services"]}:/waitlist|no availability|fully booked|no slots|all booked|sold out/i.test(o)?{text:"If there are no available slots, you can join our waitlist and we'll notify you when something opens up! Look for the 'Join Waitlist' button when viewing available times. ",quickReplies:["View Services","How to Book"]}:/^(thanks?|thank you|thx|ty|cheers|appreciate)/i.test(o)?{text:"You're welcome!  Let me know if you need anything else.",quickReplies:["View Services","View Staff","How to Book"]}:{text:"I'm not sure about that. You can browse our services above, or try asking about our services, staff, or availability! ",quickReplies:["View Services","View Staff","How to Book"]}}function lO({services:n,staffMembers:e,shop:t,onSelectService:i}){const[o,c]=_.useState(!1),[d,m]=_.useState([]),[x,g]=_.useState(""),[b,w]=_.useState(!1),[j,R]=_.useState(!1),[U,V]=_.useState(!1),[L,z]=_.useState(!1),Q=_.useRef(null),G=_.useRef(null),ie=t?.name||"our shop";_.useEffect(()=>{Q.current?.scrollIntoView({behavior:"smooth"})},[d,b]),_.useEffect(()=>{o&&setTimeout(()=>G.current?.focus(),100)},[o]);const he=_.useCallback(()=>{V(!1),z(!0),c(!0),d.length===0&&m([{id:"welcome",sender:"bot",text:`Hi!  Welcome to ${ie}. I can help you find the right service and book an appointment. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]}])},[d.length,ie]),W=_.useCallback(k=>{w(!0);const M=400+Math.random()*600;setTimeout(()=>{const C=iO(k,{services:n,staffMembers:e,shop:t});m(F=>[...F,{id:`bot-${Date.now()}`,sender:"bot",text:C.text,serviceCards:C.serviceCards||null,quickReplies:C.quickReplies||null}]),w(!1)},M)},[n,e,t]),T=_.useCallback(()=>{const k=x.trim();k&&(m(M=>[...M,{id:`user-${Date.now()}`,sender:"user",text:k}]),g(""),W(k))},[x,W]),E=_.useCallback(k=>{m(M=>[...M,{id:`user-${Date.now()}`,sender:"user",text:k}]),W(k)},[W]),S=_.useCallback(k=>{i&&(i(k),m(M=>[...M,{id:`bot-${Date.now()}`,sender:"bot",text:`Great! I've selected "${k.name}" for you. You can now pick your stylist and time above. `}]),setTimeout(()=>c(!1),1500))},[i]),I=k=>{k.key==="Enter"&&!k.shiftKey&&(k.preventDefault(),T())};return a.jsxs(a.Fragment,{children:[U&&!o&&a.jsxs("div",{className:"fixed bottom-24 right-5 z-50 animate-fade-in",children:[a.jsx("button",{onClick:he,className:"bg-white border border-slate-200 shadow-lg rounded-2xl rounded-br-md px-4 py-3 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all max-w-[220px]",children:"Need help booking? "}),a.jsx("button",{onClick:()=>{V(!1),z(!0)},className:"absolute -top-2 -right-2 w-5 h-5 bg-slate-200 hover:bg-slate-300 rounded-full flex items-center justify-center text-slate-500 transition-colors",children:a.jsx(Rs,{className:"w-3 h-3"})})]}),o&&a.jsxs("div",{className:`fixed bottom-20 right-5 z-50 bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden animate-scale-in
                     w-[calc(100vw-2.5rem)] max-w-[380px] h-[min(500px,calc(100vh-7rem))]
                     sm:w-[380px] sm:right-5 sm:bottom-20`,style:{transformOrigin:"bottom right"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Tf,{className:"w-4 h-4"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-bold leading-tight",children:"SpotBookie Assistant"}),a.jsx("p",{className:"text-[11px] text-blue-100",children:"Ask me anything about booking"})]})]}),a.jsx("button",{onClick:()=>c(!1),className:"w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors","aria-label":"Close chat",children:a.jsx(Rs,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-0 bg-slate-50/50",children:[d.map(k=>a.jsx(rO,{message:k,onSelectService:S,onQuickReply:E},k.id)),b&&a.jsx(aO,{}),a.jsx("div",{ref:Q})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 border-t border-slate-200 bg-white flex-shrink-0",children:[a.jsx("input",{ref:G,type:"text",value:x,onChange:k=>g(k.target.value),onKeyDown:I,placeholder:"Type a message",className:"flex-1 px-3.5 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder:text-slate-400"}),a.jsx("button",{onClick:T,disabled:!x.trim(),className:"w-10 h-10 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-200 disabled:cursor-not-allowed text-white disabled:text-slate-400 rounded-xl flex items-center justify-center transition-all flex-shrink-0","aria-label":"Send message",children:a.jsx(Yh,{className:"w-4 h-4"})})]})]}),a.jsx("button",{onClick:()=>{o?c(!1):he()},className:`fixed bottom-5 right-5 z-50 w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 hover:scale-105 hover:shadow-xl ${o?"bg-slate-700 hover:bg-slate-800":"bg-blue-600 hover:bg-blue-700 chat-bubble-pulse"}`,"aria-label":o?"Close chat assistant":"Open chat assistant",children:o?a.jsx(Rs,{className:"w-6 h-6 text-white"}):a.jsx(Tf,{className:"w-6 h-6 text-white"})})]})}var T0={exports:{}},A0,lN;function oO(){if(lN)return A0;lN=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return A0=n,A0}var k0,oN;function cO(){if(oN)return k0;oN=1;var n=oO();function e(){}function t(){}return t.resetWarningCache=e,k0=function(){function i(d,m,x,g,b,w){if(w!==n){var j=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw j.name="Invariant Violation",j}}i.isRequired=i;function o(){return i}var c={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:o,element:i,elementType:i,instanceOf:o,node:i,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:t,resetWarningCache:e};return c.PropTypes=c,c},k0}var cN;function uO(){return cN||(cN=1,T0.exports=cO()()),T0.exports}var dO=uO();const Wt=xx(dO);function uN(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,i)}return t}function dN(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?uN(Object(t),!0).forEach(function(i){Y2(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):uN(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Xh(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Xh=function(e){return typeof e}:Xh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xh(n)}function Y2(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hO(n,e){if(n==null)return{};var t={},i=Object.keys(n),o,c;for(c=0;c<i.length;c++)o=i[c],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function fO(n,e){if(n==null)return{};var t=hO(n,e),i,o;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(o=0;o<c.length;o++)i=c[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function W2(n,e){return mO(n)||pO(n,e)||xO(n,e)||gO()}function mO(n){if(Array.isArray(n))return n}function pO(n,e){var t=n&&(typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"]);if(t!=null){var i=[],o=!0,c=!1,d,m;try{for(t=t.call(n);!(o=(d=t.next()).done)&&(i.push(d.value),!(e&&i.length===e));o=!0);}catch(x){c=!0,m=x}finally{try{!o&&t.return!=null&&t.return()}finally{if(c)throw m}}return i}}function xO(n,e){if(n){if(typeof n=="string")return hN(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return hN(n,e)}}function hN(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function gO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ln=function(e,t,i){var o=!!i,c=Qt.useRef(i);Qt.useEffect(function(){c.current=i},[i]),Qt.useEffect(function(){if(!o||!e)return function(){};var d=function(){c.current&&c.current.apply(c,arguments)};return e.on(t,d),function(){e.off(t,d)}},[o,t,e,c])},fx=function(e){var t=Qt.useRef(e);return Qt.useEffect(function(){t.current=e},[e]),t.current},zo=function(e){return e!==null&&Xh(e)==="object"},bO=function(e){return zo(e)&&typeof e.then=="function"},yO=function(e){return zo(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},fN="[object Object]",vO=function n(e,t){if(!zo(e)||!zo(t))return e===t;var i=Array.isArray(e),o=Array.isArray(t);if(i!==o)return!1;var c=Object.prototype.toString.call(e)===fN,d=Object.prototype.toString.call(t)===fN;if(c!==d)return!1;if(!c&&!i)return e===t;var m=Object.keys(e),x=Object.keys(t);if(m.length!==x.length)return!1;for(var g={},b=0;b<m.length;b+=1)g[m[b]]=!0;for(var w=0;w<x.length;w+=1)g[x[w]]=!0;var j=Object.keys(g);if(j.length!==m.length)return!1;var R=e,U=t,V=function(z){return n(R[z],U[z])};return j.every(V)},Q2=function(e,t,i){return zo(e)?Object.keys(e).reduce(function(o,c){var d=!zo(t)||!vO(e[c],t[c]);return i.includes(c)?(d&&console.warn("Unsupported prop change: options.".concat(c," is not a mutable property.")),o):d?dN(dN({},o||{}),{},Y2({},c,e[c])):o},null):null},K2="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",mN=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:K2;if(e===null||yO(e))return e;throw new Error(t)},wO=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:K2;if(bO(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(o){return mN(o,t)})};var i=mN(e,t);return i===null?{tag:"empty"}:{tag:"sync",stripe:i}},NO=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.6.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.6.0",url:"https://stripe.com/docs/stripe-js/react"}))},im=Qt.createContext(null);im.displayName="ElementsContext";var X2=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},J2=function(e){var t=e.stripe,i=e.options,o=e.children,c=Qt.useMemo(function(){return wO(t)},[t]),d=Qt.useState(function(){return{stripe:c.tag==="sync"?c.stripe:null,elements:c.tag==="sync"?c.stripe.elements(i):null}}),m=W2(d,2),x=m[0],g=m[1];Qt.useEffect(function(){var j=!0,R=function(V){g(function(L){return L.stripe?L:{stripe:V,elements:V.elements(i)}})};return c.tag==="async"&&!x.stripe?c.stripePromise.then(function(U){U&&j&&R(U)}):c.tag==="sync"&&!x.stripe&&R(c.stripe),function(){j=!1}},[c,x,i]);var b=fx(t);Qt.useEffect(function(){b!==null&&b!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[b,t]);var w=fx(i);return Qt.useEffect(function(){if(x.elements){var j=Q2(i,w,["clientSecret","fonts"]);j&&x.elements.update(j)}},[i,w,x.elements]),Qt.useEffect(function(){NO(x.stripe)},[x.stripe]),Qt.createElement(im.Provider,{value:x},o)};J2.propTypes={stripe:Wt.any,options:Wt.object};var _O=function(e){var t=Qt.useContext(im);return X2(t,e)},jO=function(){var e=_O("calls useElements()"),t=e.elements;return t};Wt.func.isRequired;var Z2=Qt.createContext(null);Z2.displayName="CheckoutContext";Wt.any,Wt.shape({clientSecret:Wt.oneOfType([Wt.string,Wt.instanceOf(Promise)]).isRequired,elementsOptions:Wt.object}).isRequired;var mx=function(e){var t=Qt.useContext(Z2),i=Qt.useContext(im);if(t){if(i)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t}else return X2(i,e)},SO=["mode"],EO=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},_n=function(e,t){var i="".concat(EO(e),"Element"),o=function(x){var g=x.id,b=x.className,w=x.options,j=w===void 0?{}:w,R=x.onBlur,U=x.onFocus,V=x.onReady,L=x.onChange,z=x.onEscape,Q=x.onClick,G=x.onLoadError,ie=x.onLoaderStart,he=x.onNetworksChange,W=x.onConfirm,T=x.onCancel,E=x.onShippingAddressChange,S=x.onShippingRateChange,I=x.onSavedPaymentMethodRemove,k=x.onSavedPaymentMethodUpdate,M=mx("mounts <".concat(i,">")),C="elements"in M?M.elements:null,F="checkoutState"in M?M.checkoutState:null,P=F?.type==="success"||F?.type==="loading"?F.sdk:null,O=Qt.useState(null),K=W2(O,2),ce=K[0],Se=K[1],be=Qt.useRef(null),B=Qt.useRef(null);ln(ce,"blur",R),ln(ce,"focus",U),ln(ce,"escape",z),ln(ce,"click",Q),ln(ce,"loaderror",G),ln(ce,"loaderstart",ie),ln(ce,"networkschange",he),ln(ce,"confirm",W),ln(ce,"cancel",T),ln(ce,"shippingaddresschange",E),ln(ce,"shippingratechange",S),ln(ce,"savedpaymentmethodremove",I),ln(ce,"savedpaymentmethodupdate",k),ln(ce,"change",L);var J;V&&(e==="expressCheckout"?J=V:J=function(){V(ce)}),ln(ce,"ready",J),Qt.useLayoutEffect(function(){if(be.current===null&&B.current!==null&&(C||P)){var pe=null;if(P)switch(e){case"paymentForm":pe=P.createPaymentFormElement(j);break;case"payment":pe=P.createPaymentElement(j);break;case"address":if("mode"in j){var xe=j.mode,Me=fO(j,SO);if(xe==="shipping")pe=P.createShippingAddressElement(Me);else if(xe==="billing")pe=P.createBillingAddressElement(Me);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":pe=P.createExpressCheckoutElement(j);break;case"currencySelector":pe=P.createCurrencySelectorElement();break;case"taxId":pe=P.createTaxIdElement(j);break;default:throw new Error("Invalid Element type ".concat(i,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else C&&(pe=C.create(e,j));be.current=pe,Se(pe),pe&&pe.mount(B.current)}},[C,P,j]);var le=fx(j);return Qt.useEffect(function(){if(be.current){var pe=Q2(j,le,["paymentRequest"]);pe&&"update"in be.current&&be.current.update(pe)}},[j,le]),Qt.useLayoutEffect(function(){return function(){if(be.current&&typeof be.current.destroy=="function")try{be.current.destroy(),be.current=null}catch{}}},[]),Qt.createElement("div",{id:g,className:b,ref:B})},c=function(x){mx("mounts <".concat(i,">"));var g=x.id,b=x.className;return Qt.createElement("div",{id:g,className:b})},d=t?c:o;return d.propTypes={id:Wt.string,className:Wt.string,onChange:Wt.func,onBlur:Wt.func,onFocus:Wt.func,onReady:Wt.func,onEscape:Wt.func,onClick:Wt.func,onLoadError:Wt.func,onLoaderStart:Wt.func,onNetworksChange:Wt.func,onConfirm:Wt.func,onCancel:Wt.func,onShippingAddressChange:Wt.func,onShippingRateChange:Wt.func,onSavedPaymentMethodRemove:Wt.func,onSavedPaymentMethodUpdate:Wt.func,options:Wt.object},d.displayName=i,d.__elementType=e,d},jn=typeof window>"u",TO=Qt.createContext(null);TO.displayName="EmbeddedCheckoutProviderContext";var AO=function(){var e=mx("calls useStripe()"),t=e.stripe;return t};_n("auBankAccount",jn);var pN=_n("card",jn);_n("cardNumber",jn);_n("cardExpiry",jn);_n("cardCvc",jn);_n("iban",jn);_n("payment",jn);_n("expressCheckout",jn);_n("paymentRequestButton",jn);_n("linkAuthentication",jn);_n("address",jn);_n("shippingAddress",jn);_n("paymentMethodMessaging",jn);_n("taxId",jn);function Jh(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Jh=function(e){return typeof e}:Jh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jh(n)}var eS="clover",kO=function(e){return e===3?"v3":e},tS="https://js.stripe.com",CO="".concat(tS,"/").concat(eS,"/stripe.js"),RO=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,IO=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var DO=function(e){return RO.test(e)||IO.test(e)},MO=function(){for(var e=document.querySelectorAll('script[src^="'.concat(tS,'"]')),t=0;t<e.length;t++){var i=e[t];if(DO(i.src))return i}return null},xN=function(e){var t="",i=document.createElement("script");i.src="".concat(CO).concat(t);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(i),i},OO=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.7.0",startTime:t})},eu=null,Ah=null,kh=null,PO=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},VO=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},LO=function(e){return eu!==null?eu:(eu=new Promise(function(t,i){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var o=MO();if(!(o&&e)){if(!o)o=xN(e);else if(o&&kh!==null&&Ah!==null){var c;o.removeEventListener("load",kh),o.removeEventListener("error",Ah),(c=o.parentNode)===null||c===void 0||c.removeChild(o),o=xN(e)}}kh=VO(t,i),Ah=PO(i),o.addEventListener("load",kh),o.addEventListener("error",Ah)}catch(d){i(d);return}}),eu.catch(function(t){return eu=null,Promise.reject(t)}))},UO=function(e,t,i){if(e===null)return null;var o=t[0];if(typeof o!="string")throw new Error("Expected publishable key to be of type string, got type ".concat(Jh(o)," instead."));var c=o.match(/^pk_test/),d=kO(e.version),m=eS;c&&d!==m&&console.warn("Stripe.js@".concat(d," was loaded on the page, but @stripe/stripe-js@").concat("8.7.0"," expected Stripe.js@").concat(m,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var x=e.apply(void 0,t);return OO(x,i),x},tu,sS=!1,nS=function(){return tu||(tu=LO(null).catch(function(e){return tu=null,Promise.reject(e)}),tu)};Promise.resolve().then(function(){return nS()}).catch(function(n){sS||console.warn(n)});var BO=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];sS=!0;var o=Date.now();return nS().then(function(c){return UO(c,t,o)})};const zO=BO("pk_test_51NXZytLhwB1Jyzw82kEuknbGp3F4vTdnqmBrVmzsHqKYeldrpbiWInM6U2v2ojnsLW4u251zbpRk2UiXnwBgiQZo00bK99q5kj"),FO="https://us-central1-scheduler-65e51.cloudfunctions.net",$O={style:{base:{fontSize:"16px",color:"#1e293b",fontFamily:"system-ui, -apple-system, sans-serif","::placeholder":{color:"#94a3b8"}},invalid:{color:"#ef4444",iconColor:"#ef4444"}}};function qO({amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:m=!0}){const x=AO(),g=jO(),[b,w]=_.useState(!1),[j,R]=_.useState(null),[U,V]=_.useState(!1),L=async Q=>{if(Q.preventDefault(),!x||!g)return;w(!0),R(null);const G=g.getElement(pN),{error:ie,paymentMethod:he}=await x.createPaymentMethod({type:"card",card:G,billing_details:{name:i.name,email:i.email,phone:i.phone}});if(ie){R(ie.message),w(!1);return}if(m&&c)try{const W=await fetch(`${FO}/createDepositPaymentIntent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:c,amount:n,serviceName:o,clientName:i.name,clientEmail:i.email,bookingRefCode:d,paymentMethodId:he.id})}),T=await W.json();if(!W.ok){T.needsConnect?R("This shop has not connected Stripe yet. Please contact the shop owner."):T.needsOnboarding?R("This shop is still setting up payments. Please try again later."):R(T.error||"Payment failed. Please try again."),w(!1);return}console.log("Payment processed:",T.paymentIntentId),w(!1),e({paymentMethodId:he.id,paymentIntentId:T.paymentIntentId,last4:he.card.last4,brand:he.card.brand,amount:T.amount})}catch(W){console.error("Payment error:",W),R("Payment failed. Please try again."),w(!1)}else console.log("Payment method created (no Connect):",he.id),await new Promise(W=>setTimeout(W,500)),w(!1),e({paymentMethodId:he.id,last4:he.card.last4,brand:he.card.brand})},z=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q/100);return a.jsxs("form",{onSubmit:L,className:"space-y-5",children:[a.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 rounded-xl p-5 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-emerald-100 text-sm font-medium",children:["Deposit for ",o]}),a.jsx("p",{className:"text-3xl font-bold mt-1",children:z(n)})]}),a.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:a.jsx(yn,{className:"w-6 h-6"})})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Card Details"}),a.jsx("div",{className:"p-4 border-2 border-slate-200 rounded-xl focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-500/20 transition-all bg-white",children:a.jsx(pN,{options:$O,onChange:Q=>{V(Q.complete),Q.error?R(Q.error.message):R(null)}})})]}),j&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:[a.jsx(Du,{className:"w-4 h-4 flex-shrink-0"}),j]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[a.jsx(jf,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:"Your payment is secured with 256-bit encryption"})]}),a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-700",children:[a.jsx(Du,{className:"w-4 h-4 flex-shrink-0"}),a.jsxs("span",{children:[a.jsx("strong",{children:"Test Mode:"})," Use card number ",a.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"4242 4242 4242 4242"})," with any future date and CVC."]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:b||!x||!U,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold shadow-md shadow-emerald-600/20 hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:b?a.jsxs(a.Fragment,{children:[a.jsx(sa,{className:"w-4 h-4 animate-spin"}),"Processing"]}):a.jsxs(a.Fragment,{children:[a.jsx(jf,{className:"w-4 h-4"}),"Pay ",z(n)]})}),a.jsx("button",{type:"button",onClick:t,disabled:b,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 disabled:opacity-50",children:"Back"})]})]})}function HO({amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:m=!0}){return a.jsx(J2,{stripe:zO,children:a.jsx(qO,{amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:m})})}const GO=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function Ga(n){const[e,t]=n.split(":").map(Number);return e*60+t}function gN(n){const e=Math.floor(n/60),t=n%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}function YO(n){const e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${i}`}function WO(n,e,t){if(!t||t.length===0)return!1;for(const i of t){if(!i||!i.start||!i.end)continue;const o=Ga(i.start),c=Ga(i.end);if(n<c&&e>o)return!0}return!1}function QO(n,e){if(!e||e.length===0)return n;const t=[...e].filter(o=>o&&o.start&&o.end).sort((o,c)=>Ga(o.start)-Ga(c.start));let i=n;for(const o of t){const c=Ga(o.start),d=Ga(o.end);if(i<c)break;i<d&&(i=d)}return i}function KO(n,e,t,i,o,c){if(!n)return[];const m=new Date(e+"T12:00:00").getDay(),x=GO[m],g=n[x];if(!g||!g.enabled)return[];const b=Ga(g.start),w=Ga(g.end),j=g.breaks||(g.break?[g.break]:[]),R=t+i,U=[];let V=b;for(;V+t<=w;){const L=V+t;if(WO(V,L,j)){V=QO(V,j);continue}U.push({id:`wh-${o}-${e}-${gN(V)}`,date:e,time:gN(V),duration:t,available:!0,staffId:o,staffName:c,generated:!0}),V+=R}return U}function aS(n,e,t=0,i=4){const o=[],c=new Date;c.setHours(0,0,0,0);const d=new Date(c);d.setDate(d.getDate()+i*7);for(const m of n){if(!m.weeklyHours)continue;const x=new Date(c);for(;x<d;){const g=YO(x),b=KO(m.weeklyHours,g,e,t,m.id,m.name);o.push(...b),x.setDate(x.getDate()+1)}}return o}function rS(n,e,t=0){const i=e.filter(o=>!o.status||o.status==="pending"||o.status==="confirmed");return n.filter(o=>{const c=Ga(o.time),d=c+o.duration;return!i.some(x=>{if(o.staffId&&x.staffId&&x.staffId!==o.staffId||x.date!==o.date)return!1;const g=Ga(x.time),b=x.serviceDuration||x.duration||o.duration,w=g+b;return!(d+t<=g||w+t<=c)})})}function iS(n,e){const t=new Set(e.map(o=>`${o.staffId||""}-${o.date}-${o.time}`)),i=n.filter(o=>{const c=`${o.staffId||""}-${o.date}-${o.time}`;return!t.has(c)});return[...e,...i]}function du({name:n,className:e="w-12 h-12",bgClass:t="bg-blue-100 text-blue-700"}){const i=(n||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return a.jsx("div",{className:`${e} ${t} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function XO(){return a.jsxs(at,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(va,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function JO({member:n,onClose:e}){const[t,i]=_.useState(null),o=n.portfolio||[];return _.useEffect(()=>{const c=d=>{d.key==="Escape"&&(t!==null?i(null):e())};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,e]),a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in",children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center text-slate-600 transition-all z-10",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(du,{name:n.name,className:"w-14 h-14",bgClass:"bg-violet-100 text-violet-700"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name}),n.role&&a.jsx("p",{className:"text-sm text-violet-600 font-medium",children:n.role})]})]}),n.bio&&a.jsx("p",{className:"mt-3 text-sm text-slate-600 leading-relaxed",children:n.bio})]}),a.jsx("div",{className:"p-6",children:o.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(kg,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:o.map((c,d)=>a.jsxs("button",{onClick:()=>i(d),className:"group relative aspect-square rounded-xl overflow-hidden bg-slate-100 shadow-sm hover:shadow-md transition-all hover:-translate-y-0.5",children:[a.jsx("img",{src:c.url,alt:c.caption||"Portfolio",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),c.caption&&a.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/70 to-transparent p-2.5 pt-6",children:a.jsx("p",{className:"text-xs text-white font-medium truncate",children:c.caption})})]},d))})})]}),t!==null&&o[t]&&a.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/90",children:[a.jsx("button",{onClick:()=>i(null),className:"absolute top-4 right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(Rs,{className:"w-5 h-5"})}),t>0&&a.jsx("button",{onClick:()=>i(t-1),className:"absolute left-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(Tg,{className:"w-5 h-5"})}),t<o.length-1&&a.jsx("button",{onClick:()=>i(t+1),className:"absolute right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(Xu,{className:"w-5 h-5"})}),a.jsxs("div",{className:"max-w-4xl max-h-[85vh] flex flex-col items-center",children:[a.jsx("img",{src:o[t].url,alt:o[t].caption||"Portfolio",className:"max-w-full max-h-[75vh] object-contain rounded-lg"}),o[t].caption&&a.jsx("p",{className:"mt-3 text-sm text-white/90 font-medium text-center px-4",children:o[t].caption}),a.jsxs("p",{className:"mt-1 text-xs text-white/50",children:[t+1," / ",o.length]})]})]})]})}function ZO(){const{slug:n}=Ho(),[e,t]=_.useState(null),[i,o]=_.useState(null),[c,d]=_.useState(!0),[m,x]=_.useState(!1),[g,b]=_.useState([]),[w,j]=_.useState([]),[R,U]=_.useState(null),[V,L]=_.useState(null),[z,Q]=_.useState([]),[G,ie]=_.useState([]),[he,W]=_.useState(!1),[T,E]=_.useState(null),[S,I]=_.useState(null),[k,M]=_.useState(""),[C,F]=_.useState(!1),[P,O]=_.useState({name:"",email:"",phone:""}),[K,ce]=_.useState(""),[Se,be]=_.useState(!1),[B,J]=_.useState(null),[le,pe]=_.useState(!1),[xe,Me]=_.useState("biweekly"),[Ge,xt]=_.useState(null),[it,Gt]=_.useState(!1),[ae,_e]=_.useState(null);_.useEffect(()=>{(async()=>{d(!0),x(!1);try{const ee=Ln(Ke(ve,"shops"),bn("slug","==",n)),de=await Ms(ee);if(de.empty)x(!0);else{const Te=de.docs[0];t(Te.data()),o(Te.id)}}catch(ee){console.error("Error looking up shop:",ee),x(!0)}finally{d(!1)}})()},[n]),_.useEffect(()=>{if(!i)return;const H=Kt(Ke(ve,"shops",i,"services"),Oe=>{const Ae=Oe.docs.map(je=>({id:je.id,...je.data()})).filter(je=>je.active!==!1).sort((je,Ze)=>(je.name||"").localeCompare(Ze.name||""));b(Ae)}),ee=Kt(Ke(ve,"shops",i,"availability"),Oe=>{const Ae=new Date,je=Oe.docs.map(Ze=>({id:Ze.id,...Ze.data()})).filter(Ze=>new Date(`${Ze.date}T${Ze.time}`)>Ae);Q(je)}),de=Kt(Ke(ve,"shops",i,"bookings"),Oe=>{const Ae=Oe.docs.map(je=>({id:je.id,...je.data()}));ie(Ae)}),Te=Kt(Ke(ve,"shops",i,"staff"),Oe=>{const Ae=Oe.docs.map(je=>({id:je.id,...je.data()})).filter(je=>je.active!==!1).sort((je,Ze)=>(je.name||"").localeCompare(Ze.name||""));j(Ae)});return()=>{H(),ee(),de(),Te()}},[i]),_.useEffect(()=>{w.length===1?L(w[0]):w.length===0&&L(null)},[w]);const Ee=g.length>0;w.length>0;const qe=w.length>1,Je=e?.bufferMinutes||0,Nt=_.useMemo(()=>{const H=new Date;let ee=z.filter(Ae=>Ae.available);if(R&&(ee=ee.filter(Ae=>Ae.duration>=R.duration)),V&&V!=="any"&&(ee=ee.filter(Ae=>Ae.staffId===V.id||!Ae.staffId)),!R)return ee;const de=V&&V!=="any"?w.filter(Ae=>Ae.id===V.id):w,Te=aS(de,R.duration,Je,4).filter(Ae=>new Date(`${Ae.date}T${Ae.time}`)>H),Oe=iS(Te,ee);return rS(Oe,G,Je)},[z,R,V,w,G,Je]),Vs=(H,ee,de=3)=>{const Te=[],Oe=new Date(H+"T12:00:00"),Ae=new Date(Oe);Ae.setMonth(Ae.getMonth()+de);let je=new Date(Oe);for(ee==="weekly"?je.setDate(je.getDate()+7):ee==="biweekly"?je.setDate(je.getDate()+14):ee==="fourweekly"?je.setDate(je.getDate()+28):ee==="monthly"&&je.setMonth(je.getMonth()+1);je<=Ae;){const Ze=je.getFullYear(),St=String(je.getMonth()+1).padStart(2,"0"),ns=String(je.getDate()).padStart(2,"0");Te.push(`${Ze}-${St}-${ns}`),ee==="weekly"?je.setDate(je.getDate()+7):ee==="biweekly"?je.setDate(je.getDate()+14):ee==="fourweekly"?je.setDate(je.getDate()+28):ee==="monthly"&&je.setMonth(je.getMonth()+1)}return Te},At=_.useMemo(()=>{if(!le||!T)return null;const H=Vs(T.date,xe),ee=R?R.duration:T.duration||60,de=V&&V!=="any"?V.id:T.staffId,Te=T.time,Oe=G.filter(us=>!us.status||us.status==="pending"||us.status==="confirmed"),Ae=us=>{const[tr,rs]=us.split(":").map(Number);return tr*60+rs},je=Ae(Te),Ze=je+ee;let St=[],ns=[];const as=new Set;H.forEach(us=>{Oe.some(rs=>{if(de&&rs.staffId&&rs.staffId!==de||rs.date!==us)return!1;const Ks=Ae(rs.time),is=rs.serviceDuration||rs.duration||ee,ws=Ks+is,En=Je||0;return!(Ze+En<=Ks||ws+En<=je)})||as.has(us)?ns.push(us):(St.push(us),as.add(us))});const Sn=H.length>0?H[H.length-1]:T.date,zn=new Date(Sn+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),ia={weekly:"week",biweekly:"2 weeks",fourweekly:"4 weeks",monthly:"month"};return{available:St,conflicts:ns,total:St.length+1,skipped:ns.length,endDate:zn,intervalLabel:ia[xe]||xe}},[le,xe,T,R,V,G,Je]),ft=H=>{U(H),w.length>1&&L(null),I(null),E(null),W(!1),M("")},Ie=H=>{L(H),I(null),E(null),W(!1),M("")},Be=()=>{U(null),w.length>1&&L(null),I(null),E(null),W(!1)},fe=()=>{I(null),E(null),W(!1),qe?L(null):Ee&&U(null)},ze=H=>{E(H),W(!0),M("")},Ve=()=>{const H="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let ee="BK";for(let de=0;de<4;de++)ee+=H.charAt(Math.floor(Math.random()*H.length));return ee},De=H=>{H.preventDefault(),_t?Gt(!0):Ye()},He=H=>{_e(H),Ye(H)},Ye=async(H=null)=>{F(!0),xt(null);try{const ee=Ve(),de=e?.requireApproval?"pending":"confirmed",Te=le?`rg-${Date.now()}-${Math.random().toString(36).slice(2,8)}`:null,Oe=le&&At?At.endDate:null,Ae={slotId:T.id,date:T.date,time:T.time,duration:R?R.duration:T.duration,clientName:P.name,clientEmail:P.email,clientPhone:P.phone,bookedAt:new Date().toISOString(),status:de,refCode:ee};if(R&&(Ae.serviceId=R.id,Ae.serviceName=R.name,Ae.servicePrice=R.price,Ae.serviceDuration=R.duration,Ae.depositPercent=R.depositPercent||0),H||ae){const St=H||ae;Ae.depositPaid=!0,Ae.depositAmount=ss/100,Ae.paymentMethodId=St.paymentMethodId,Ae.cardLast4=St.last4,Ae.cardBrand=St.brand}V&&V!=="any"?(Ae.staffId=V.id,Ae.staffName=V.name):T.staffId&&(Ae.staffId=T.staffId,Ae.staffName=T.staffName||""),le&&Te&&(Ae.recurring=!0,Ae.recurringInterval=xe,Ae.recurringGroupId=Te,Ae.recurringUntil=Oe),await _a(Ke(ve,"shops",i,"bookings"),Ae),T.generated||await st($e(ve,"shops",i,"availability",T.id),{available:!1});let je=1,Ze=0;if(le&&At){const St=At.available;Ze=At.skipped;for(const ns of St){const as=Ve(),Sn={...Ae,date:ns,slotId:`recurring-${Te}-${ns}`,refCode:as,bookedAt:new Date().toISOString()};await _a(Ke(ve,"shops",i,"bookings"),Sn),je++}xt({created:je,skipped:Ze})}O({name:"",email:"",phone:""}),W(!1),Gt(!1),_e(null),E(null),U(null),I(null),L(w.length===1?w[0]:null),pe(!1),ce(ee),e?.requireApproval?M(" Your booking request has been submitted! The shop will review and confirm it shortly."):M(" Booking confirmed! You will receive a confirmation email shortly.")}catch(ee){console.error("Booking error:",ee),M(" Something went wrong. Please try again.")}finally{F(!1)}},Z=H=>new Date(H+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),Ce=H=>{const[ee,de]=H.split(":"),Te=parseInt(ee),Oe=Te>=12?"PM":"AM";return`${Te%12||12}:${de} ${Oe}`},We=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(H),tt=H=>{if(H<60)return`${H} min`;const ee=Math.floor(H/60),de=H%60;return de?`${ee}h ${de}m`:`${ee} hour${ee>1?"s":""}`};if(c)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking page"})]})});if(m)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Tt,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(xa,{className:"w-4 h-4"}),"Go Home"]})]})});if(e?.archived)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-amber-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(yu,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Unavailable"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[a.jsx("span",{className:"font-semibold",children:e.name})," is currently not accepting new bookings. Please check back later or contact the shop directly."]}),a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(xa,{className:"w-4 h-4"}),"Go Home"]})]})});const kt=[...new Set(Nt.map(H=>H.date))].sort(),Lt=S?Nt.filter(H=>H.date===S):Nt,_t=R&&R.depositPercent>0,ss=_t?Math.round(R.price*(R.depositPercent/100)*100):0,Qs=it?"payment":he?"form":Ee&&!R?"services":qe&&!V?"staff":"calendar",Is=[];Ee&&Is.push({key:"services",label:"Service"}),qe&&Is.push({key:"staff",label:"Stylist"}),Is.push({key:"calendar",label:"Date & Time"}),Is.push({key:"form",label:"Details"}),_t&&Is.push({key:"payment",label:"Payment"});const Ea=Is.findIndex(H=>H.key===Qs),$=["border-l-blue-500","border-l-violet-500","border-l-emerald-500","border-l-amber-500","border-l-rose-500","border-l-cyan-500","border-l-indigo-500","border-l-pink-500","border-l-teal-500"];return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Book your appointment"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(at,{to:`/shop/${n}/login`,className:"flex items-center gap-1.5 px-3.5 py-2 text-xs font-medium text-slate-500 hover:text-slate-700 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[a.jsx(jf,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Owner"})]}),a.jsx(XO,{})]})]})}),a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[Is.length>1&&a.jsx("div",{className:"flex items-center justify-center gap-0 mb-8 animate-fade-in",children:Is.map((H,ee)=>{const de=H.key===Qs,Te=ee<Ea;return a.jsxs(_.Fragment,{children:[ee>0&&a.jsx("div",{className:`w-8 sm:w-14 h-0.5 transition-colors duration-300 ${ee<=Ea?"bg-blue-500":"bg-slate-200"}`}),a.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[a.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 ${de?"bg-blue-600 text-white shadow-md shadow-blue-600/30 scale-110":Te?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:Te?a.jsx(Os,{className:"w-5 h-5"}):ee+1}),a.jsx("span",{className:`text-xs font-medium hidden sm:block transition-colors ${de?"text-blue-700":Te?"text-blue-600":"text-slate-400"}`,children:H.label})]})]},H.key)})}),k&&a.jsx("div",{className:"mb-8 animate-scale-in",children:k.startsWith("")?a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(B2,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Confirmed!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"You're all set. We'll send a confirmation to your email."}),Ge&&a.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[a.jsx(Si,{className:"w-4 h-4"}),"Recurring Series Created"]}),a.jsxs("p",{className:"text-sm text-slate-700",children:[Ge.created," appointment",Ge.created!==1?"s":""," booked"]}),Ge.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",Ge.skipped," date",Ge.skipped!==1?"s":""," skipped due to conflicts"]})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:K})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsxs(at,{to:`/shop/${n}/booking/${K}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(va,{className:"w-4 h-4"}),"Manage Your Booking"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-lg text-sm text-emerald-700 font-medium",children:[a.jsx(va,{className:"w-4 h-4"}),"Add to your calendar to remember"]})]}):k.startsWith("")?a.jsxs("div",{className:"bg-white rounded-2xl border border-amber-200 shadow-lg shadow-amber-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(ts,{className:"w-8 h-8 text-amber-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Request Submitted!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking request has been submitted! The shop will review and confirm it shortly."}),Ge&&a.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[a.jsx(Si,{className:"w-4 h-4"}),"Recurring Series Created"]}),a.jsxs("p",{className:"text-sm text-slate-700",children:[Ge.created," appointment",Ge.created!==1?"s":""," submitted"]}),Ge.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",Ge.skipped," date",Ge.skipped!==1?"s":""," skipped due to conflicts"]})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:K})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsxs(at,{to:`/shop/${n}/booking/${K}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(va,{className:"w-4 h-4"}),"Manage Your Booking"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-700 font-medium",children:[a.jsx(ts,{className:"w-4 h-4"}),"You'll be notified once it's confirmed"]})]}):a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Something went wrong. Please try again."})]})}),Qs==="services"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a Service"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select the service you'd like to book"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 stagger-children",children:g.map((H,ee)=>a.jsxs("button",{onClick:()=>ft(H),className:`group text-left bg-white border-l-4 ${$[ee%$.length]} border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5`,children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors pr-2",children:H.name}),a.jsx("span",{className:"text-xl font-extrabold text-blue-600 whitespace-nowrap",children:We(H.price)})]}),H.description&&a.jsx("p",{className:"text-sm text-slate-500 mb-3 line-clamp-2 leading-relaxed",children:H.description}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-400",children:[a.jsx(ts,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:tt(H.duration)})]}),a.jsx("span",{className:"text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]})]},H.id))})]}),Qs==="staff"&&a.jsxs("div",{className:"animate-fade-in",children:[Ee&&R&&a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:Be,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(xa,{className:"w-3.5 h-3.5"}),"Back"]}),a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Nn,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:R.name}),a.jsx("span",{className:"text-blue-600 font-bold",children:We(R.price)})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose Your Stylist"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select your preferred professional"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 stagger-children",children:[a.jsxs("button",{onClick:()=>Ie("any"),className:"group text-left bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-3.5 mb-3",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Pt,{className:"w-5 h-5 text-slate-500"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:"Any Available"}),a.jsx("p",{className:"text-xs text-slate-500",children:"First available professional"})]})]}),a.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),w.map(H=>{const ee=H.portfolio||[];return a.jsxs("div",{className:"group bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[a.jsxs("button",{onClick:()=>Ie(H),className:"w-full text-left",children:[a.jsxs("div",{className:"flex items-center gap-3.5 mb-2",children:[a.jsx(du,{name:H.name}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:H.name}),H.role&&a.jsx("p",{className:"text-xs text-slate-500",children:H.role})]})]}),H.bio&&a.jsx("p",{className:"text-xs text-slate-500 leading-relaxed mb-2 line-clamp-2",children:H.bio}),ee.length>0&&a.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[ee.slice(0,3).map((de,Te)=>a.jsx("img",{src:de.url,alt:de.caption||"Work",className:"w-10 h-10 rounded-md object-cover border border-slate-200"},Te)),ee.length>3&&a.jsxs("span",{className:"w-10 h-10 rounded-md bg-slate-100 border border-slate-200 flex items-center justify-center text-xs text-slate-500 font-semibold",children:["+",ee.length-3]})]}),a.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),ee.length>0&&a.jsxs("button",{onClick:de=>{de.stopPropagation(),J(H)},className:"mt-2 w-full flex items-center justify-center gap-1.5 py-1.5 text-xs font-semibold text-violet-600 hover:text-violet-700 hover:bg-violet-50 rounded-lg transition-all",children:[a.jsx(kg,{className:"w-3.5 h-3.5"}),"View Portfolio (",ee.length,")"]})]},H.id)})]})]}),Qs==="calendar"&&a.jsxs("div",{className:"animate-fade-in",children:[(Ee||qe)&&a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:fe,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(xa,{className:"w-3.5 h-3.5"}),"Back"]}),R&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Nn,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:R.name}),a.jsx("span",{className:"text-blue-600 font-bold",children:We(R.price)}),a.jsxs("span",{className:"text-slate-400",children:[" ",tt(R.duration)]})]}),V&&V!=="any"&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[a.jsx(du,{name:V.name,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:V.name})]}),V==="any"&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm",children:[a.jsx(Pt,{className:"w-3.5 h-3.5 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-700",children:"Any Available"})]})]}),kt.length===0?a.jsx("div",{children:Se?a.jsx("div",{className:"max-w-lg mx-auto",children:a.jsx(iN,{shopId:i,slug:n,selectedService:R,selectedStaff:V,staffMembers:w,preferredDate:null,onCancel:()=>be(!1)})}):a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(Tt,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),a.jsx("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:R?`No time slots available for ${R.name} (${tt(R.duration)}). Join the waitlist to be notified when a slot opens up!`:"Check back soon for new availability, or join the waitlist!"}),a.jsxs("button",{onClick:()=>be(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:[a.jsx(_f,{className:"w-4 h-4"}),"Join Waitlist"]})]})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Select a Date"}),a.jsx("p",{className:"text-slate-500 text-sm",children:"Pick a day that works for you"})]}),a.jsx("div",{className:"mb-8",children:a.jsx(G2,{availableDates:kt,selectedDate:S,onSelectDate:I})}),S&&a.jsxs("div",{className:"animate-slide-down",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",Z(S)]}),a.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[Lt.length," slot",Lt.length!==1?"s":""]})]}),Lt.length===0?a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:[a.jsx("p",{className:"text-slate-500 mb-4",children:"No times available for this date"}),Se?a.jsx("div",{className:"mt-4 text-left",children:a.jsx(iN,{shopId:i,slug:n,selectedService:R,selectedStaff:V,staffMembers:w,preferredDate:S,onCancel:()=>be(!1)})}):a.jsxs("button",{onClick:()=>be(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(_f,{className:"w-4 h-4"}),"Join the Waitlist"]})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:Lt.sort((H,ee)=>H.time.localeCompare(ee.time)).map(H=>a.jsxs("button",{onClick:()=>ze(H),className:"group bg-white border border-slate-200 hover:border-blue-400 rounded-xl p-4 transition-all duration-200 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-slate-900 group-hover:text-blue-700 transition-colors mb-1",children:Ce(H.time)}),H.staffName&&V==="any"&&a.jsxs("div",{className:"text-xs text-violet-600 mb-0.5 flex items-center justify-center gap-1",children:[a.jsx(Pt,{className:"w-3 h-3"}),H.staffName]}),a.jsx("div",{className:"text-xs text-slate-400",children:R?tt(R.duration):`${H.duration} min`})]},H.id))})]}),!S&&a.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]}),Qs==="form"&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Complete Your Booking"}),a.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Review your details and confirm"}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[R&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Nn,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:R.name})]}),a.jsx("span",{className:"font-bold text-blue-600",children:We(R.price)})]}),V&&V!=="any"&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(du,{name:V.name,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-800",children:V.name}),V.role&&a.jsxs("span",{className:"text-slate-400 text-sm ml-1.5",children:[" ",V.role]})]})]}),V==="any"&&T?.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(du,{name:T.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:T.staffName})]}),a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Tt,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[Z(T.date)," at ",Ce(T.time)]})]}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(ts,{className:"w-4 h-4 text-slate-500"})}),a.jsx("span",{children:R?tt(R.duration):`${T.duration} min`})]})]}),a.jsxs("form",{onSubmit:De,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),a.jsx("input",{type:"text",value:P.name,onChange:H=>O({...P,name:H.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:P.email,onChange:H=>O({...P,email:H.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),a.jsx("input",{type:"tel",value:P.phone,onChange:H=>O({...P,phone:H.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Si,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Make this recurring"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Book the same slot on a regular schedule"})]})]}),a.jsx("button",{type:"button",onClick:()=>pe(!le),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${le?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${le?"translate-x-6":"translate-x-1"}`})})]}),le&&a.jsxs("div",{className:"space-y-3 pt-1 animate-fade-in",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Repeat every"}),a.jsxs("select",{value:xe,onChange:H=>Me(H.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[a.jsx("option",{value:"weekly",children:"Week"}),a.jsx("option",{value:"biweekly",children:"2 Weeks"}),a.jsx("option",{value:"fourweekly",children:"4 Weeks"}),a.jsx("option",{value:"monthly",children:"Month"})]})]}),At&&a.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:[" Every ",At.intervalLabel," through ",At.endDate]}),a.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[At.total," total appointment",At.total!==1?"s":""]}),At.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1 font-medium",children:[" ",At.skipped," date",At.skipped!==1?"s":""," will be skipped due to existing bookings"]})]})]})]}),_t&&a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(yn,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm font-semibold text-emerald-800",children:["$",(ss/100).toFixed(2)," deposit required"]}),a.jsxs("p",{className:"text-xs text-emerald-600",children:[R.depositPercent,"% of service price  Remaining $",(R.price-ss/100).toFixed(2)," due at appointment"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:C,className:`flex-1 flex items-center justify-center gap-2 px-6 py-3.5 ${_t?"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-600/20 hover:shadow-emerald-600/25":"bg-blue-600 hover:bg-blue-700 shadow-blue-600/20 hover:shadow-blue-600/25"} text-white rounded-xl font-semibold shadow-md hover:shadow-lg transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0`,children:C?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):_t?a.jsxs(a.Fragment,{children:[a.jsx(yn,{className:"w-4 h-4"}),"Continue to Payment"]}):a.jsxs(a.Fragment,{children:[a.jsx(Os,{className:"w-4 h-4"}),"Confirm Booking"]})}),a.jsx("button",{type:"button",onClick:()=>{W(!1),E(null)},className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]}),Qs==="payment"&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Secure Payment"}),a.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Complete your deposit to confirm your booking"}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Tt,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-800",children:R?.name}),a.jsxs("p",{className:"text-sm text-slate-500",children:[T&&Z(T.date)," at ",T&&Ce(T.time)]})]})]}),a.jsxs("div",{className:"text-sm text-slate-600 pl-13",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Client:"})," ",P.name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",P.email]})]})]}),!e?.payoutsEnabled&&(!e?.subscriptionTier||e?.subscriptionTier==="free")&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(yn,{className:"w-4 h-4 text-red-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800 text-sm",children:"Booking Unavailable"}),a.jsx("p",{className:"text-xs text-red-700 mt-1",children:"This shop is still setting up their payment system and cannot accept bookings yet. Please check back later or contact the shop directly."})]})]})}),!e?.payoutsEnabled&&e?.subscriptionTier&&e?.subscriptionTier!=="free"&&a.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(yn,{className:"w-4 h-4 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-amber-800 text-sm",children:"Payment Setup in Progress"}),a.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"This shop is still setting up their payment system. You can still book, but payment will be collected at the time of your appointment."}),a.jsx("button",{onClick:()=>Ye(),disabled:C,className:"mt-3 flex items-center gap-2 px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg font-semibold text-sm transition-all disabled:opacity-50",children:C?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):a.jsxs(a.Fragment,{children:[a.jsx(Os,{className:"w-4 h-4"}),"Book Without Deposit"]})})]})]})}),e?.payoutsEnabled&&a.jsx(HO,{amount:ss,serviceName:R?.name||"Service",clientInfo:P,onSuccess:He,onCancel:()=>Gt(!1),shopId:i,bookingRefCode:null,shopHasConnect:e?.payoutsEnabled}),!e?.payoutsEnabled&&a.jsx("button",{onClick:()=>Gt(!1),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 mt-4",children:" Back"})]})]}),B&&a.jsx(JO,{member:B,onClose:()=>J(null)}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(at,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})}),a.jsx(lO,{services:g,staffMembers:w,shop:e,onSelectService:ft})]})}function e9({slotsByDate:n,bookingsByDate:e,selectedDate:t,onSelectDate:i,recurringDayFlags:o={},breaksByDate:c={}}){const[d,m]=_.useState(new Date),x=he=>{const W=he.getFullYear(),T=he.getMonth(),E=new Date(W,T,1),I=new Date(W,T+1,0).getDate(),k=E.getDay();return{daysInMonth:I,startingDayOfWeek:k,year:W,month:T}},{daysInMonth:g,startingDayOfWeek:b,year:w,month:j}=x(d),R=()=>{m(new Date(d.getFullYear(),d.getMonth()-1))},U=()=>{m(new Date(d.getFullYear(),d.getMonth()+1))},V=he=>`${w}-${String(j+1).padStart(2,"0")}-${String(he).padStart(2,"0")}`,L=he=>{const W=V(he),T=n[W]||[],E=e[W]||[],S=c[W]||[],I=T.filter(C=>C.available).length,k=E.length,M=S.length;return{availableCount:I,bookedCount:k,breakCount:M,hasData:T.length>0||E.length>0||M>0}},z=he=>{const W=V(he);i(W===t?null:W)},Q=["January","February","March","April","May","June","July","August","September","October","November","December"],G=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ie=new Date;return ie.setHours(0,0,0,0),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-5",children:[a.jsx("button",{onClick:R,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Tg,{className:"w-5 h-5 text-slate-600"})}),a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[Q[j]," ",w]}),a.jsx("button",{onClick:U,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Xu,{className:"w-5 h-5 text-slate-600"})})]}),a.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:G.map(he=>a.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:he},he))}),a.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:b}).map((he,W)=>a.jsx("div",{},`empty-${W}`)),Array.from({length:g}).map((he,W)=>{const T=W+1,E=V(T),{availableCount:S,bookedCount:I,breakCount:k,hasData:M}=L(T),C=E===t,F=new Date,P=F.getDate()===T&&F.getMonth()===j&&F.getFullYear()===w,O=new Date(w,j,T),K=O.getDay(),ce=o[K]&&O>=ie;return a.jsxs("button",{onClick:()=>z(T),className:`
                relative p-2 text-center rounded-lg text-sm font-semibold transition-all duration-200 min-h-[56px] flex flex-col items-center justify-start cursor-pointer
                ${C?"bg-blue-600 text-white shadow-md shadow-blue-600/30":M||ce?"bg-slate-50 hover:bg-slate-100 text-slate-900 border border-slate-200 hover:border-slate-300":P?"text-slate-900 font-bold hover:bg-slate-50":"text-slate-400 hover:bg-slate-50"}
              `,children:[a.jsxs("span",{className:`text-sm ${P&&!C?"relative":""}`,children:[T,P&&!C&&a.jsx("span",{className:"absolute -bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]}),(M||ce)&&a.jsxs("div",{className:"flex gap-0.5 mt-1 flex-wrap justify-center",children:[ce&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${C?"bg-white/20 text-white":"bg-violet-100 text-violet-700"}`,children:"R"}),k>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${C?"bg-white/20 text-white":"bg-amber-100 text-amber-700"}`,children:""}),S>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${C?"bg-white/20 text-white":"bg-emerald-100 text-emerald-700"}`,children:S}),I>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${C?"bg-white/20 text-white":"bg-blue-100 text-blue-700"}`,children:I})]})]},T)})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-xs text-slate-500",children:[Object.keys(o).length>0&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-violet-100 border border-violet-200 rounded flex items-center justify-center text-[7px] font-bold text-violet-700",children:"R"}),a.jsx("span",{children:"Recurring"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-amber-100 border border-amber-200 rounded flex items-center justify-center text-[8px]",children:""}),a.jsx("span",{children:"Break"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-emerald-100 border border-emerald-200 rounded"}),a.jsx("span",{children:"Available"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-blue-100 border border-blue-200 rounded"}),a.jsx("span",{children:"Booked"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-blue-600 rounded"}),a.jsx("span",{children:"Selected"})]})]})]})}const t9=[{value:15,label:"15 min"},{value:30,label:"30 min"},{value:45,label:"45 min"},{value:60,label:"1 hour"},{value:90,label:"1.5 hours"},{value:120,label:"2 hours"}],s9=[{value:0,label:"No deposit required"},{value:10,label:"10%"},{value:20,label:"20%"},{value:25,label:"25%"},{value:50,label:"50%"},{value:100,label:"Full payment upfront"}];function n9({shopId:n}){const[e,t]=_.useState([]),[i,o]=_.useState(!1),[c,d]=_.useState(null),[m,x]=_.useState({name:"",description:"",duration:30,price:"",depositPercent:0}),[g,b]=_.useState(!1);_.useEffect(()=>{if(!n)return;const z=Kt(Ke(ve,"shops",n,"services"),Q=>{const G=Q.docs.map(ie=>({id:ie.id,...ie.data()})).filter(ie=>ie.active!==!1).sort((ie,he)=>(ie.name||"").localeCompare(he.name||""));t(G)});return()=>z()},[n]);const w=()=>{x({name:"",description:"",duration:30,price:"",depositPercent:0}),o(!1),d(null)},j=async z=>{z.preventDefault(),b(!0);const Q={name:m.name.trim(),description:m.description.trim(),duration:parseInt(m.duration),price:parseFloat(m.price),depositPercent:parseInt(m.depositPercent)||0,active:!0};try{c?await st($e(ve,"shops",n,"services",c),Q):await _a(Ke(ve,"shops",n,"services"),{...Q,createdAt:ji()}),w()}catch(G){console.error("Error saving service:",G)}finally{b(!1)}},R=z=>{x({name:z.name,description:z.description||"",duration:z.duration,price:z.price.toString(),depositPercent:z.depositPercent||0}),d(z.id),o(!0)},U=async z=>{try{await st($e(ve,"shops",n,"services",z),{active:!1})}catch(Q){console.error("Error deleting service:",Q)}},V=z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(z),L=z=>{if(z<60)return`${z} min`;const Q=Math.floor(z/60),G=z%60;return G?`${Q}h ${G}m`:`${Q}h`};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Services"}),a.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Define the services you offer  clients will pick one before booking"})]}),!i&&a.jsxs("button",{onClick:()=>{w(),o(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(Za,{className:"w-4 h-4"}),"Add Service"]})]}),i&&a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:c?"Edit Service":"New Service"}),a.jsxs("form",{onSubmit:j,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Service Name *"}),a.jsx("input",{type:"text",value:m.name,onChange:z=>x({...m,name:z.target.value}),required:!0,placeholder:"e.g. Haircut",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description (optional)"}),a.jsx("input",{type:"text",value:m.description,onChange:z=>x({...m,description:z.target.value}),placeholder:"e.g. Classic cut and style",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Duration *"}),a.jsx("select",{value:m.duration,onChange:z=>x({...m,duration:z.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:t9.map(z=>a.jsx("option",{value:z.value,children:z.label},z.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Price (USD) *"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-semibold",children:"$"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:m.price,onChange:z=>x({...m,price:z.target.value}),required:!0,placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx(yn,{className:"w-4 h-4 text-emerald-500"}),"Deposit Required"]})}),a.jsx("select",{value:m.depositPercent,onChange:z=>x({...m,depositPercent:z.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:s9.map(z=>a.jsx("option",{value:z.value,children:z.label},z.value))})]})]}),m.depositPercent>0&&m.price&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-emerald-50 border border-emerald-200 rounded-lg text-sm",children:[a.jsx(yn,{className:"w-4 h-4 text-emerald-600"}),a.jsxs("span",{className:"text-emerald-800",children:["Clients will pay ",a.jsxs("strong",{children:["$",((parseFloat(m.price)||0)*(parseInt(m.depositPercent)/100)).toFixed(2)]})," deposit at booking",parseInt(m.depositPercent)<100&&a.jsxs("span",{children:[" ($",((parseFloat(m.price)||0)*(1-parseInt(m.depositPercent)/100)).toFixed(2)," remaining due at appointment)"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:g,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(tn,{className:"w-4 h-4"}),g?"Saving":c?"Update Service":"Add Service"]}),a.jsxs("button",{type:"button",onClick:w,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Rs,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"text-5xl mb-3",children:""}),a.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No services yet"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Add your first service so clients can choose what to book"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(z=>a.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:z.name}),z.description&&a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:z.description})]}),a.jsx("span",{className:"text-xl font-bold text-blue-600 whitespace-nowrap ml-3",children:V(z.price)})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500 mb-4 flex-wrap",children:[a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx(ts,{className:"w-4 h-4"}),L(z.duration)]}),z.depositPercent>0&&a.jsxs("span",{className:"flex items-center gap-1.5 text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full text-xs font-medium",children:[a.jsx(yn,{className:"w-3 h-3"}),z.depositPercent,"% deposit"]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>R(z),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:[a.jsx(Cg,{className:"w-3.5 h-3.5"}),"Edit"]}),a.jsx("button",{onClick:()=>U(z.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:a.jsx(ga,{className:"w-3.5 h-3.5"})})]})]},z.id))})]})}const su=[{key:"monday",label:"Monday",short:"Mon"},{key:"tuesday",label:"Tuesday",short:"Tue"},{key:"wednesday",label:"Wednesday",short:"Wed"},{key:"thursday",label:"Thursday",short:"Thu"},{key:"friday",label:"Friday",short:"Fri"},{key:"saturday",label:"Saturday",short:"Sat"},{key:"sunday",label:"Sunday",short:"Sun"}],bN={enabled:!1,start:"09:00",end:"17:00",breaks:[]};function a9({shopId:n,staffId:e,staffName:t,weeklyHours:i,onClose:o}){const[c,d]=_.useState(()=>{const E={};for(const S of su){const I=i?.[S.key];if(I){const k=I.breaks||(I.break?[I.break]:[]);E[S.key]={enabled:!!I.enabled,start:I.start||"09:00",end:I.end||"17:00",breaks:k}}else E[S.key]={...bN,breaks:[]}}return E}),[m,x]=_.useState(!1),[g,b]=_.useState(null),[w,j]=_.useState([]),[R,U]=_.useState(!1),[V,L]=_.useState(null);_.useEffect(()=>{if(!n)return;const E=Kt(Ke(ve,"shops",n,"schedulePresets"),S=>{const I=S.docs.map(k=>({id:k.id,...k.data()})).sort((k,M)=>k.isDefault&&!M.isDefault?-1:!k.isDefault&&M.isDefault?1:(k.name||"").localeCompare(M.name||""));j(I)});return()=>E()},[n]);const z=(E,S,I)=>{d(k=>({...k,[E]:{...k[E],[S]:I}})),L(null)},Q=E=>{d(S=>({...S,[E]:{...S[E],breaks:[...S[E].breaks||[],{start:"12:00",end:"13:00"}]}})),L(null)},G=(E,S,I,k)=>{d(M=>{const C=[...M[E].breaks||[]];return C[S]={...C[S],[I]:k},{...M,[E]:{...M[E],breaks:C}}}),L(null)},ie=(E,S)=>{d(I=>({...I,[E]:{...I[E],breaks:I[E].breaks.filter((k,M)=>M!==S)}})),L(null)},he=E=>{const S=c[E];d(I=>{const k={...I};for(const M of su)M.key!==E&&(k[M.key]={enabled:S.enabled,start:S.start,end:S.end,breaks:S.breaks.map(C=>({...C}))});return k}),b(E),L(null),setTimeout(()=>b(null),1500)},W=E=>{if(!E.days)return;const S={};for(const I of su){const k=E.days[I.key];if(k){const M=k.breaks||(k.break?[k.break]:[]);S[I.key]={enabled:!!k.enabled,start:k.start||"09:00",end:k.end||"17:00",breaks:M.map(C=>({...C}))}}else S[I.key]={...bN,breaks:[]}}d(S),U(!1),L(E.name),setTimeout(()=>L(null),2e3)},T=async()=>{x(!0);try{const E={};for(const S of su){const I=c[S.key];E[S.key]={enabled:I.enabled,start:I.start,end:I.end,breaks:I.breaks||[],break:I.breaks&&I.breaks.length>0?I.breaks[0]:null}}await st($e(ve,"shops",n,"staff",e),{weeklyHours:E}),o()}catch(E){console.error("Error saving weekly hours:",E)}finally{x(!1)}};return a.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Weekly Hours"}),a.jsx("p",{className:"text-sm text-slate-500",children:t})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[w.length>0&&a.jsxs("div",{className:"relative",children:[a.jsxs("button",{type:"button",onClick:()=>U(!R),className:"flex items-center gap-2 px-4 py-2 bg-violet-50 hover:bg-violet-100 text-violet-700 border border-violet-200 rounded-xl text-sm font-semibold transition-all",children:[a.jsx(Tt,{className:"w-4 h-4"}),"Apply Preset",a.jsx(Iu,{className:`w-4 h-4 transition-transform ${R?"rotate-180":""}`})]}),R&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>U(!1)}),a.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white border border-slate-200 rounded-xl shadow-xl z-20 py-2 max-h-80 overflow-y-auto",children:w.map(E=>a.jsxs("button",{onClick:()=>W(E),className:"w-full px-4 py-3 text-left hover:bg-blue-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:E.name}),E.isDefault&&a.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded",children:"DEFAULT"})]}),E.description&&a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:E.description})]},E.id))})]})]}),a.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Rs,{className:"w-5 h-5 text-slate-400"})})]})]}),V&&a.jsxs("div",{className:"mb-4 px-4 py-3 bg-green-50 border border-green-200 rounded-xl flex items-center gap-2 text-sm text-green-700 font-medium animate-fade-in",children:[a.jsx(tn,{className:"w-4 h-4"}),'Applied "',V,'" preset  click Save to keep changes']}),a.jsx("div",{className:"space-y-3",children:su.map(({key:E,label:S})=>{const I=c[E],k=I.breaks||[];return a.jsxs("div",{className:`rounded-xl p-4 transition-all ${I.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{type:"button",onClick:()=>z(E,"enabled",!I.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${I.enabled?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${I.enabled?"translate-x-6":"translate-x-1"}`})}),a.jsx("span",{className:`font-semibold text-sm ${I.enabled?"text-slate-900":"text-slate-400"}`,children:S}),!I.enabled&&a.jsx("span",{className:"text-sm text-slate-400 italic ml-2",children:"Day off"})]}),I.enabled&&a.jsxs("div",{className:"mt-3 ml-14 space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx(ts,{className:"w-4 h-4 text-blue-500"}),a.jsx("input",{type:"time",value:I.start,onChange:M=>z(E,"start",M.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),a.jsx("input",{type:"time",value:I.end,onChange:M=>z(E,"end",M.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{type:"button",onClick:()=>Q(E),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${k.length>0?"bg-amber-100 text-amber-700 border border-amber-200":"bg-slate-100 text-slate-500 border border-slate-200 hover:bg-amber-50 hover:text-amber-600 hover:border-amber-200"}`,children:[a.jsx(Nf,{className:"w-3.5 h-3.5"}),k.length>0?`${k.length} Break${k.length>1?"s":""}`:"+ Break"]}),a.jsx("button",{type:"button",onClick:()=>he(E),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:g===E?" Copied!":"Copy to all"})]})]}),I.enabled&&k.length>0&&a.jsx("div",{className:"mt-2 ml-14 space-y-2",children:k.map((M,C)=>a.jsxs("div",{className:"flex items-start gap-2 animate-fade-in",children:[a.jsx(Nf,{className:"w-3.5 h-3.5 text-amber-500 mt-2"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("span",{className:"text-xs text-slate-500 block mb-1",children:["Break ",C+1]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("input",{type:"time",value:M.start,onChange:F=>G(E,C,"start",F.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("span",{className:"text-slate-400 text-xs",children:"to"}),a.jsx("input",{type:"time",value:M.end,onChange:F=>G(E,C,"end",F.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("button",{type:"button",onClick:()=>ie(E,C),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",title:"Remove break",children:a.jsx(Rs,{className:"w-3.5 h-3.5"})})]})]})]},C))})]},E)})}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t border-slate-200",children:[a.jsxs("button",{onClick:T,disabled:m,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(z2,{className:"w-4 h-4"}),m?"Saving":"Save Hours"]}),a.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Rs,{className:"w-4 h-4"}),"Cancel"]})]})]})}const go=[{key:"monday",short:"Mon",label:"Monday"},{key:"tuesday",short:"Tue",label:"Tuesday"},{key:"wednesday",short:"Wed",label:"Wednesday"},{key:"thursday",short:"Thu",label:"Thursday"},{key:"friday",short:"Fri",label:"Friday"},{key:"saturday",short:"Sat",label:"Saturday"},{key:"sunday",short:"Sun",label:"Sunday"}],r9=[{name:"Full-time 9-5",description:"Monday to Friday, 9am to 5pm with lunch break",days:{monday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},tuesday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},wednesday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},thursday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},friday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},saturday:{enabled:!1,start:"09:00",end:"17:00",breaks:[]},sunday:{enabled:!1,start:"09:00",end:"17:00",breaks:[]}},isDefault:!0},{name:"Part-time Mornings",description:"Monday to Friday, 9am to 1pm",days:{monday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},tuesday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},wednesday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},thursday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},friday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},saturday:{enabled:!1,start:"09:00",end:"13:00",breaks:[]},sunday:{enabled:!1,start:"09:00",end:"13:00",breaks:[]}},isDefault:!0},{name:"Weekends Only",description:"Saturday and Sunday, 10am to 6pm",days:{monday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},tuesday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},wednesday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},thursday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},friday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},saturday:{enabled:!0,start:"10:00",end:"18:00",breaks:[{start:"13:00",end:"14:00"}]},sunday:{enabled:!0,start:"10:00",end:"18:00",breaks:[{start:"13:00",end:"14:00"}]}},isDefault:!0}],Ch={enabled:!1,start:"09:00",end:"17:00",breaks:[]};function yN(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return t===0?`${o}${i}`:`${o}:${t.toString().padStart(2,"0")}${i}`}function i9({shopId:n}){const[e,t]=_.useState([]),[i,o]=_.useState(!0),[c,d]=_.useState(!1),[m,x]=_.useState(null),[g,b]=_.useState(!1),[w,j]=_.useState({name:"",description:"",days:{}});_.useEffect(()=>{R()},[]),_.useEffect(()=>{if(!n)return;const S=Kt(Ke(ve,"shops",n,"schedulePresets"),I=>{const k=I.docs.map(M=>({id:M.id,...M.data()})).sort((M,C)=>M.isDefault&&!C.isDefault?-1:!M.isDefault&&C.isDefault?1:(M.name||"").localeCompare(C.name||""));t(k),o(!1)});return()=>S()},[n]);const R=()=>{const S={};go.forEach(I=>{S[I.key]={...Ch,breaks:[]}}),j({name:"",description:"",days:S}),x(null),d(!1)},U=async()=>{try{for(const S of r9)await _a(Ke(ve,"shops",n,"schedulePresets"),{...S,createdAt:ji()})}catch(S){console.error("Error initializing default presets:",S)}},V=async S=>{if(S.preventDefault(),!!w.name.trim()){b(!0);try{const I={name:w.name.trim(),description:w.description.trim(),days:w.days,isDefault:!1,updatedAt:ji()};m?await st($e(ve,"shops",n,"schedulePresets",m.id),I):await _a(Ke(ve,"shops",n,"schedulePresets"),{...I,createdAt:ji()}),R()}catch(I){console.error("Error saving preset:",I)}finally{b(!1)}}},L=S=>{const I={};go.forEach(k=>{const M=S.days?.[k.key];M?I[k.key]={enabled:!!M.enabled,start:M.start||"09:00",end:M.end||"17:00",breaks:M.breaks||(M.break?[M.break]:[])}:I[k.key]={...Ch,breaks:[]}}),j({name:S.name,description:S.description||"",days:I}),x(S),d(!0)},z=async S=>{if(confirm("Delete this schedule preset?"))try{await ko($e(ve,"shops",n,"schedulePresets",S))}catch(I){console.error("Error deleting preset:",I)}},Q=S=>{const I={};go.forEach(k=>{const M=S.days?.[k.key];M?I[k.key]={enabled:!!M.enabled,start:M.start||"09:00",end:M.end||"17:00",breaks:[...M.breaks||(M.break?[M.break]:[])]}:I[k.key]={...Ch,breaks:[]}}),j({name:`${S.name} (Copy)`,description:S.description||"",days:I}),x(null),d(!0)},G=(S,I,k)=>{j(M=>({...M,days:{...M.days,[S]:{...M.days[S],[I]:k}}}))},ie=S=>{j(I=>({...I,days:{...I.days,[S]:{...I.days[S],breaks:[...I.days[S].breaks||[],{start:"12:00",end:"13:00"}]}}}))},he=(S,I,k,M)=>{j(C=>{const F=[...C.days[S].breaks||[]];return F[I]={...F[I],[k]:M},{...C,days:{...C.days,[S]:{...C.days[S],breaks:F}}}})},W=(S,I)=>{j(k=>({...k,days:{...k.days,[S]:{...k.days[S],breaks:k.days[S].breaks.filter((M,C)=>C!==I)}}}))},T=S=>{const I=w.days[S];j(k=>{const M={...k.days};return go.forEach(C=>{C.key!==S&&(M[C.key]={enabled:I.enabled,start:I.start,end:I.end,breaks:I.breaks.map(F=>({...F}))})}),{...k,days:M}})},E=S=>{if(!S.days)return"No schedule configured";const I=go.filter(M=>S.days[M.key]?.enabled);return I.length===0?"No working days":I.map(M=>{const C=S.days[M.key],F=C.breaks||(C.break?[C.break]:[]),P=F.length>0?` (${F.length} break${F.length>1?"s":""})`:"";return`${M.short} ${yN(C.start)}${yN(C.end)}${P}`}).join("  ")};return i?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"spinner"})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Schedule Presets"}),a.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create reusable schedule templates with breaks to quickly apply to staff"})]}),!c&&a.jsxs("button",{onClick:()=>{R(),d(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(Za,{className:"w-4 h-4"}),"New Preset"]})]}),e.length===0&&!c&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 text-center mb-6",children:[a.jsx(Tt,{className:"w-10 h-10 text-blue-500 mx-auto mb-3"}),a.jsx("h3",{className:"font-bold text-slate-900 mb-2",children:"Get started with presets"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:'Add common schedule templates like "Full-time 9-5" or "Weekends Only"'}),a.jsxs("button",{onClick:U,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Za,{className:"w-4 h-4"}),"Add Default Presets"]})]}),c&&a.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 mb-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:m?"Edit Preset":"New Schedule Preset"}),a.jsx("button",{onClick:R,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Rs,{className:"w-5 h-5 text-slate-400"})})]}),a.jsxs("form",{onSubmit:V,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preset Name *"}),a.jsx("input",{type:"text",value:w.name,onChange:S=>j({...w,name:S.target.value}),placeholder:"e.g., Full-time 9-5",required:!0,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description"}),a.jsx("input",{type:"text",value:w.description,onChange:S=>j({...w,description:S.target.value}),placeholder:"e.g., Standard work week with lunch break",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Weekly Schedule"}),go.map(({key:S,label:I})=>{const k=w.days[S]||Ch;return a.jsxs("div",{className:`rounded-xl p-4 transition-all ${k.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-[140px]",children:[a.jsx("button",{type:"button",onClick:()=>G(S,"enabled",!k.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${k.enabled?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${k.enabled?"translate-x-6":"translate-x-1"}`})}),a.jsx("span",{className:`font-semibold text-sm ${k.enabled?"text-slate-900":"text-slate-400"}`,children:I})]}),k.enabled?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ts,{className:"w-4 h-4 text-blue-500"}),a.jsx("input",{type:"time",value:k.start,onChange:M=>G(S,"start",M.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),a.jsx("input",{type:"time",value:k.end,onChange:M=>G(S,"end",M.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("button",{type:"button",onClick:()=>ie(S),className:"flex items-center gap-1.5 px-3 py-1.5 bg-amber-100 hover:bg-amber-200 text-amber-700 border border-amber-200 rounded-lg text-xs font-semibold transition-all",children:[a.jsx(Nf,{className:"w-3.5 h-3.5"}),"+ Break"]}),a.jsx("button",{type:"button",onClick:()=>T(S),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:"Copy to all"})]}):a.jsx("span",{className:"text-sm text-slate-400 italic",children:"Day off"})]}),k.enabled&&k.breaks&&k.breaks.length>0&&a.jsx("div",{className:"mt-3 ml-[140px] space-y-2",children:k.breaks.map((M,C)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Nf,{className:"w-3.5 h-3.5 text-amber-500"}),a.jsx("span",{className:"text-xs text-slate-500",children:"Break:"}),a.jsx("input",{type:"time",value:M.start,onChange:F=>he(S,C,"start",F.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("span",{className:"text-slate-400 text-xs",children:""}),a.jsx("input",{type:"time",value:M.end,onChange:F=>he(S,C,"end",F.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("button",{type:"button",onClick:()=>W(S,C),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",children:a.jsx(Rs,{className:"w-3.5 h-3.5"})})]},C))})]},S)})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:g,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(z2,{className:"w-4 h-4"}),g?"Saving":m?"Update Preset":"Save Preset"]}),a.jsxs("button",{type:"button",onClick:R,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Rs,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length>0&&a.jsx("div",{className:"space-y-3",children:e.map(S=>a.jsx("div",{className:"bg-white border border-slate-200 rounded-xl p-5 hover:shadow-md transition-all",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900",children:S.name}),S.isDefault&&a.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-[10px] font-bold rounded-md",children:"DEFAULT"})]}),S.description&&a.jsx("p",{className:"text-sm text-slate-500 mb-2",children:S.description}),a.jsx("p",{className:"text-xs text-slate-400 leading-relaxed",children:E(S)})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx("button",{onClick:()=>Q(S),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"Duplicate preset",children:a.jsx(L2,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>L(S),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"Edit preset",children:a.jsx(Cg,{className:"w-4 h-4"})}),!S.isDefault&&a.jsx("button",{onClick:()=>z(S.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Delete preset",children:a.jsx(ga,{className:"w-4 h-4"})})]})]})},S.id))})]})}const _r={free:{name:"Free",price:0,staffLimit:1,platformFeePercent:5,features:["basicBooking","emailNotifications"]},pro:{name:"Pro",price:29,priceId:null,staffLimit:5,platformFeePercent:0,features:["basicBooking","emailNotifications","aiAssistant","recurringBookings","waitlist","crm","analytics","smsNotifications","customBranding"]},unlimited:{name:"Unlimited",price:79,priceId:null,staffLimit:1/0,platformFeePercent:0,features:["basicBooking","emailNotifications","aiAssistant","recurringBookings","waitlist","crm","analytics","smsNotifications","customBranding","walkIns","multiLocation","noBranding","apiAccess","prioritySupport"]}},l9={basicBooking:{name:"Online Booking",description:"Accept bookings through your booking page"},emailNotifications:{name:"Email Notifications",description:"Automatic booking confirmations and reminders"},aiAssistant:{name:"AI Booking Assistant",description:"Smart suggestions and automated responses"},recurringBookings:{name:"Recurring Bookings",description:"Schedule repeating appointments"},waitlist:{name:"Waitlist",description:"Let clients join a waitlist when fully booked"},crm:{name:"Client CRM",description:"Client notes, history, and win-back tracking"},analytics:{name:"Analytics",description:"Detailed booking and revenue analytics"},smsNotifications:{name:"SMS Notifications",description:"Send text message reminders to clients"},customBranding:{name:"Custom Branding",description:"Customize colors and branding on your booking page"},walkIns:{name:"Walk-in Queue",description:"Manage walk-in clients with live queue"},multiLocation:{name:"Multi-Location",description:"Manage multiple business locations"},noBranding:{name:"Remove SpotBookie Branding",description:"White-label your booking experience"},apiAccess:{name:"API Access",description:"Integrate with external tools and systems"},prioritySupport:{name:"Priority Support",description:"24/7 priority customer support"}};function lS(n){const e=n?.subscriptionTier||"free";return _r[e]?.staffLimit||1}function o9(n,e){const t=lS(n);return e<t}function c9(n,e){const t=_r[n]||_r.free,i=_r[e];return i?i.features.filter(o=>!t.features.includes(o)):[]}function u9(n){const e=["free","pro","unlimited"],t=e.indexOf(n||"free");return e.slice(t+1).map(i=>({key:i,..._r[i],newFeatures:c9(n,i)}))}const d9="https://us-central1-scheduler-65e51.cloudfunctions.net",h9={pro:"price_1Sxx7ILhwB1Jyzw8UvRxE5FT",unlimited:"price_1Sxx7JLhwB1Jyzw8uw9BRYhO"};function f9({isOpen:n,onClose:e,shopId:t,slug:i,currentTier:o="free",feature:c,title:d,description:m}){const[x,g]=_.useState(null),[b,w]=_.useState(null);if(!n)return null;const j=u9(o),R=async U=>{g(U),w(null);try{const V=await fetch(`${d9}/createCheckoutSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:t,priceId:h9[U],successUrl:`${window.location.origin}/#/shop/${i}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/#/shop/${i}/dashboard?subscription=canceled`})}),L=await V.json();if(!V.ok)throw new Error(L.error||"Failed to create checkout session");window.location.href=L.url}catch(V){console.error("Upgrade error:",V),w(V.message),g(null)}};return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-violet-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20",children:a.jsx(Uo,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:d||"Upgrade Required"}),a.jsx("p",{className:"text-sm text-slate-500",children:m||"Unlock more features with a premium plan"})]})]}),a.jsx("button",{onClick:e,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",children:a.jsx(Rs,{className:"w-5 h-5"})})]}),b&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:b}),a.jsx("div",{className:"space-y-3",children:j.map(U=>a.jsxs("div",{className:`border-2 rounded-xl p-4 transition-all ${U.key==="pro"?"border-blue-300 bg-blue-50/50":"border-violet-300 bg-violet-50/50"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-slate-900",children:U.name}),a.jsxs("p",{className:"text-lg font-extrabold text-slate-900",children:["$",U.price,a.jsx("span",{className:"text-sm font-normal text-slate-500",children:"/month"})]})]}),a.jsx("button",{onClick:()=>R(U.key),disabled:x,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-semibold text-sm transition-all disabled:opacity-50 ${U.key==="pro"?"bg-blue-500 hover:bg-blue-600 text-white shadow-md shadow-blue-500/20":"bg-violet-500 hover:bg-violet-600 text-white shadow-md shadow-violet-500/20"}`,children:x===U.key?a.jsx(sa,{className:"w-4 h-4 animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(Xo,{className:"w-4 h-4"}),"Upgrade"]})})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[U.key==="pro"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-blue-200 rounded-lg text-xs font-medium text-blue-700",children:[a.jsx(Pt,{className:"w-3 h-3"}),"5 staff"]}),U.key==="unlimited"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-violet-200 rounded-lg text-xs font-medium text-violet-700",children:[a.jsx(Pt,{className:"w-3 h-3"}),"Unlimited staff"]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-emerald-50 border border-emerald-200 rounded-lg text-xs font-medium text-emerald-700",children:[a.jsx(tn,{className:"w-3 h-3"}),"No platform fees"]})]})]},U.key))}),a.jsx("p",{className:"text-xs text-slate-400 text-center mt-4",children:"Cancel anytime  14-day money-back guarantee"})]})})}function m9({currentCount:n,limit:e,onUpgradeClick:t}){const i=n>=e,o=n>=e-1&&n<e;return!i&&!o?null:a.jsxs("div",{className:`rounded-xl p-4 flex items-center justify-between gap-4 mb-4 ${i?"bg-amber-50 border border-amber-200":"bg-blue-50 border border-blue-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${i?"bg-amber-100":"bg-blue-100"}`,children:a.jsx(Pt,{className:`w-5 h-5 ${i?"text-amber-600":"text-blue-600"}`})}),a.jsxs("div",{children:[a.jsx("p",{className:`font-semibold text-sm ${i?"text-amber-900":"text-blue-900"}`,children:i?"Staff limit reached":"Almost at staff limit"}),a.jsxs("p",{className:"text-xs text-slate-600",children:["You have ",n," of ",e," staff member",e!==1?"s":"",".",i?" Upgrade to add more.":" Upgrade before you need more."]})]})]}),a.jsxs("button",{onClick:t,className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-semibold text-sm transition-all shadow-md flex-shrink-0 ${i?"bg-amber-500 hover:bg-amber-600 text-white shadow-amber-500/20":"bg-blue-500 hover:bg-blue-600 text-white shadow-blue-500/20"}`,children:[a.jsx(Xo,{className:"w-4 h-4"}),"Upgrade"]})]})}const p9=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}],x9=5*1024*1024,g9=["image/jpeg","image/png","image/webp"];function vN(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return t===0?`${o}${i}`:`${o}:${t.toString().padStart(2,"0")}${i}`}function b9({shopId:n,shop:e,slug:t}){const[i,o]=_.useState([]),[c,d]=_.useState(!1),[m,x]=_.useState(null),[g,b]=_.useState(null),[w,j]=_.useState(null),[R,U]=_.useState({name:"",role:""}),[V,L]=_.useState(!1),[z,Q]=_.useState(!1),[G,ie]=_.useState("staff"),[he,W]=_.useState([]),[T,E]=_.useState(null),[S,I]=_.useState(null),k=lS(e),M=o9(e,i.length),[C,F]=_.useState(null),[P,O]=_.useState(""),[K,ce]=_.useState(!1),[Se,be]=_.useState(!1),[B,J]=_.useState(""),[le,pe]=_.useState(null),[xe,Me]=_.useState(null),[Ge,xt]=_.useState(null),it=_.useRef(null);_.useEffect(()=>{if(!n)return;const fe=Kt(Ke(ve,"shops",n,"staff"),Ve=>{const De=Ve.docs.map(He=>({id:He.id,...He.data()})).filter(He=>He.active!==!1).sort((He,Ye)=>(He.name||"").localeCompare(Ye.name||""));o(De)}),ze=Kt(Ke(ve,"shops",n,"schedulePresets"),Ve=>{const De=Ve.docs.map(He=>({id:He.id,...He.data()})).sort((He,Ye)=>He.isDefault&&!Ye.isDefault?-1:!He.isDefault&&Ye.isDefault?1:(He.name||"").localeCompare(Ye.name||""));W(De)});return()=>{fe(),ze()}},[n]);const Gt=async(fe,ze)=>{if(ze.days)try{const Ve={},De=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];for(const He of De){const Ye=ze.days[He];if(Ye){const Z=Ye.breaks||(Ye.break?[Ye.break]:[]);Ve[He]={enabled:!!Ye.enabled,start:Ye.start||"09:00",end:Ye.end||"17:00",breaks:Z,break:Z.length>0?Z[0]:null}}else Ve[He]={enabled:!1,start:"09:00",end:"17:00",breaks:[],break:null}}await st($e(ve,"shops",n,"staff",fe),{weeklyHours:Ve}),E(null),I({staffId:fe,presetName:ze.name}),setTimeout(()=>I(null),2500)}catch(Ve){console.error("Error applying preset:",Ve)}},ae=()=>{U({name:"",role:""}),d(!1),x(null)},_e=async fe=>{fe.preventDefault(),L(!0);const ze={name:R.name.trim(),role:R.role.trim(),active:!0};try{m?await st($e(ve,"shops",n,"staff",m),ze):await _a(Ke(ve,"shops",n,"staff"),{...ze,email:"",bio:"",portfolio:[],createdAt:ji()}),ae()}catch(Ve){console.error("Error saving staff member:",Ve)}finally{L(!1)}},Ee=fe=>{U({name:fe.name,role:fe.role||""}),x(fe.id),d(!0)},qe=async fe=>{try{await st($e(ve,"shops",n,"staff",fe),{active:!1})}catch(ze){console.error("Error deleting staff member:",ze)}},Je=fe=>{F(fe.id),O(fe.bio||"")},Nt=async fe=>{ce(!0);try{await st($e(ve,"shops",n,"staff",fe),{bio:P.trim()}),F(null),O("")}catch(ze){console.error("Error saving bio:",ze)}finally{ce(!1)}},Vs=fe=>{pe(fe),J(""),Me(null),setTimeout(()=>{it.current&&(it.current.value="",it.current.click())},50)},At=fe=>{const ze=fe.target.files?.[0];if(ze){if(!g9.includes(ze.type)){alert("Please select a JPG, PNG, or WebP image.");return}if(ze.size>x9){alert("File size must be under 5MB.");return}Me(ze)}},ft=async fe=>{if(xe){be(!0);try{const ze=Date.now(),Ve=xe.name.split(".").pop(),De=`${ze}.${Ve}`,He=`shops/${n}/staff/${fe}/portfolio/${De}`,Ye=Q1(K1,He);await eD(Ye,xe);const Z=await tD(Ye),We=i.find(tt=>tt.id===fe)?.portfolio||[];await st($e(ve,"shops",n,"staff",fe),{portfolio:[...We,{url:Z,storagePath:He,caption:B.trim(),uploadedAt:new Date().toISOString()}]}),pe(null),J(""),Me(null)}catch(ze){console.error("Error uploading photo:",ze),alert("Upload failed. Please try again.")}finally{be(!1)}}},Ie=async(fe,ze)=>{const Ve=i.find(He=>He.id===fe);if(!Ve)return;const De=Ve.portfolio[ze];if(De){xt(`${fe}-${ze}`);try{if(De.storagePath)try{const Ye=Q1(K1,De.storagePath);await sD(Ye)}catch(Ye){console.warn("Storage delete warning:",Ye)}const He=Ve.portfolio.filter((Ye,Z)=>Z!==ze);await st($e(ve,"shops",n,"staff",fe),{portfolio:He})}catch(He){console.error("Error deleting photo:",He),alert("Failed to delete photo.")}finally{xt(null)}}},Be=fe=>{if(!fe)return null;const ze=p9.filter(Ve=>fe[Ve.key]?.enabled);return ze.length===0?null:ze.map(Ve=>{const De=fe[Ve.key],He=De.breaks||(De.break?[De.break]:[]),Ye=He.length>0?` ${He.length>1?He.length:""}`:"";return`${Ve.short} ${vN(De.start)}${vN(De.end)}${Ye}`})};return a.jsxs("div",{children:[a.jsx("input",{ref:it,type:"file",accept:".jpg,.jpeg,.png,.webp",className:"hidden",onChange:At}),a.jsxs("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl mb-6 w-fit",children:[a.jsxs("button",{onClick:()=>ie("staff"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${G==="staff"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(Pt,{className:"w-4 h-4"}),"Staff Members"]}),a.jsxs("button",{onClick:()=>ie("presets"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${G==="presets"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(Tt,{className:"w-4 h-4"}),"Schedule Presets"]})]}),G==="presets"&&a.jsx(i9,{shopId:n}),G==="staff"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Staff"}),a.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Manage your team  assign availability and bookings per staff member"})]}),!c&&(M?a.jsxs("button",{onClick:()=>{ae(),d(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(Za,{className:"w-4 h-4"}),"Add Staff"]}):a.jsxs("button",{onClick:()=>Q(!0),className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white rounded-xl font-semibold shadow-lg shadow-amber-500/30 hover:shadow-xl hover:shadow-amber-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(Uo,{className:"w-4 h-4"}),"Upgrade to Add More"]}))]}),a.jsx(m9,{currentCount:i.length,limit:k,onUpgradeClick:()=>Q(!0)}),a.jsx(f9,{isOpen:z,onClose:()=>Q(!1),shopId:n,slug:t,currentTier:e?.subscriptionTier||"free",title:"Add More Staff Members",description:`Your ${e?.subscriptionTier||"Free"} plan allows ${k} staff member${k!==1?"s":""}. Upgrade to add more.`}),c&&a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:m?"Edit Staff Member":"New Staff Member"}),a.jsxs("form",{onSubmit:_e,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Name *"}),a.jsx("input",{type:"text",value:R.name,onChange:fe=>U({...R,name:fe.target.value}),required:!0,placeholder:"e.g. Jane Smith",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Role (optional)"}),a.jsx("input",{type:"text",value:R.role,onChange:fe=>U({...R,role:fe.target.value}),placeholder:"e.g. Senior Stylist",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:V,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(tn,{className:"w-4 h-4"}),V?"Saving":m?"Update Staff":"Add Staff"]}),a.jsxs("button",{type:"button",onClick:ae,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Rs,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),i.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"text-5xl mb-3",children:""}),a.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No staff members yet"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Add your team members to assign them availability and bookings"})]}):a.jsx("div",{className:"space-y-4",children:i.map(fe=>{const ze=Be(fe.weeklyHours),Ve=fe.portfolio||[];return a.jsxs("div",{children:[a.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:fe.name}),fe.role&&a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:fe.role})]}),a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Pt,{className:"w-5 h-5 text-blue-600"})})]}),a.jsx("div",{className:"mb-3",children:C===fe.id?a.jsxs("div",{className:"space-y-2",children:[a.jsx("textarea",{value:P,onChange:De=>O(De.target.value),placeholder:"Write a short bio  specialties, experience, personality",rows:3,maxLength:500,className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none transition-all"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>Nt(fe.id),disabled:K,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[K?a.jsx(sa,{className:"w-3 h-3 animate-spin"}):a.jsx(tn,{className:"w-3 h-3"}),"Save Bio"]}),a.jsx("button",{onClick:()=>{F(null),O("")},className:"px-3 py-1.5 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"}),a.jsxs("span",{className:"text-xs text-slate-400 ml-auto",children:[P.length,"/500"]})]})]}):a.jsx("div",{onClick:()=>Je(fe),className:"cursor-pointer group",children:fe.bio?a.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed group-hover:text-slate-800 transition-colors",children:[fe.bio,a.jsx("span",{className:"ml-1.5 text-xs text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",children:"edit"})]}):a.jsx("p",{className:"text-sm text-slate-400 italic group-hover:text-blue-500 transition-colors",children:"+ Add a bio"})})}),ze?a.jsx("div",{className:"mb-3 flex flex-wrap gap-1.5",children:ze.map((De,He)=>a.jsx("span",{className:"inline-block px-2 py-0.5 bg-green-50 text-green-700 border border-green-200 rounded text-xs font-medium",children:De},He))}):a.jsx("p",{className:"text-xs text-slate-400 mb-3 italic",children:"No weekly hours set"}),Ve.length>0&&w!==fe.id&&a.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[a.jsx("div",{className:"flex -space-x-1",children:Ve.slice(0,4).map((De,He)=>a.jsx("img",{src:De.url,alt:De.caption||"Portfolio",className:"w-10 h-10 rounded-lg object-cover border-2 border-white shadow-sm"},He))}),a.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[Ve.length," photo",Ve.length!==1?"s":""]})]}),S?.staffId===fe.id&&a.jsxs("div",{className:"mb-3 px-3 py-2 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-xs text-green-700 font-medium animate-fade-in",children:[a.jsx(tn,{className:"w-3.5 h-3.5"}),'Applied "',S.presetName,'" schedule']}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs("button",{onClick:()=>b(g===fe.id?null:fe.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${g===fe.id?"bg-blue-100 text-blue-700 border-blue-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:[a.jsx(ts,{className:"w-3.5 h-3.5"}),"Set Hours"]}),he.length>0&&a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>E(T===fe.id?null:fe.id),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${T===fe.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-violet-50 hover:bg-violet-100 text-violet-700 border-violet-200"}`,children:[a.jsx(Tt,{className:"w-3.5 h-3.5"}),"Apply Preset",a.jsx(Iu,{className:`w-3 h-3 transition-transform ${T===fe.id?"rotate-180":""}`})]}),T===fe.id&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>E(null)}),a.jsx("div",{className:"absolute top-full right-0 mt-1 w-56 bg-white border border-slate-200 rounded-xl shadow-xl z-20 py-2 max-h-64 overflow-y-auto",children:he.map(De=>a.jsxs("button",{onClick:()=>Gt(fe.id,De),className:"w-full px-4 py-2.5 text-left hover:bg-blue-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-900 text-sm",children:De.name}),De.isDefault&&a.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded",children:"DEFAULT"})]}),De.description&&a.jsx("p",{className:"text-xs text-slate-500 mt-0.5 line-clamp-1",children:De.description})]},De.id))})]})]}),a.jsx("button",{onClick:()=>j(w===fe.id?null:fe.id),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${w===fe.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:a.jsx(RD,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>Ee(fe),className:"flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:a.jsx(Cg,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>qe(fe.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:a.jsx(ga,{className:"w-3.5 h-3.5"})})]})]}),g===fe.id&&a.jsx("div",{className:"mt-2",children:a.jsx(a9,{shopId:n,staffId:fe.id,staffName:fe.name,weeklyHours:fe.weeklyHours,onClose:()=>b(null)})}),w===fe.id&&a.jsxs("div",{className:"mt-2 bg-white border-2 border-violet-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[a.jsx(kg,{className:"w-4 h-4 text-violet-600"}),"Portfolio  ",fe.name]}),a.jsxs("button",{onClick:()=>Vs(fe.id),disabled:Se,className:"flex items-center gap-1.5 px-3 py-1.5 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[a.jsx(Za,{className:"w-3 h-3"}),"Add Photo"]})]}),le===fe.id&&xe&&a.jsxs("div",{className:"mb-4 p-3 bg-violet-50 border border-violet-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-16 h-16 rounded-lg bg-slate-200 overflow-hidden flex-shrink-0",children:a.jsx("img",{src:URL.createObjectURL(xe),alt:"Preview",className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-xs text-slate-600 font-medium mb-1 truncate",children:xe.name}),a.jsxs("p",{className:"text-xs text-slate-400",children:[(xe.size/1024/1024).toFixed(1)," MB"]})]})]}),a.jsx("input",{type:"text",value:B,onChange:De=>J(De.target.value),placeholder:"Add a caption (optional)",maxLength:200,className:"w-full px-3 py-2 text-sm border border-violet-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-400 focus:border-transparent mb-2"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>ft(fe.id),disabled:Se,className:"flex items-center gap-1.5 px-4 py-2 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:Se?a.jsxs(a.Fragment,{children:[a.jsx(sa,{className:"w-3 h-3 animate-spin"}),"Uploading"]}):a.jsxs(a.Fragment,{children:[a.jsx(tn,{className:"w-3 h-3"}),"Upload"]})}),a.jsx("button",{onClick:()=>{pe(null),Me(null),J("")},className:"px-3 py-2 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}),Ve.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-3xl mb-2",children:""}),a.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet. Add some to showcase work!"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:Ve.map((De,He)=>a.jsxs("div",{className:"group relative bg-slate-50 rounded-lg overflow-hidden border border-slate-200 shadow-sm",children:[a.jsx("div",{className:"aspect-square",children:a.jsx("img",{src:De.url,alt:De.caption||"Portfolio photo",className:"w-full h-full object-cover"})}),De.caption&&a.jsx("div",{className:"px-2 py-1.5",children:a.jsx("p",{className:"text-xs text-slate-600 truncate",children:De.caption})}),a.jsx("button",{onClick:()=>Ie(fe.id,He),disabled:Ge===`${fe.id}-${He}`,className:"absolute top-1.5 right-1.5 w-7 h-7 bg-red-500/90 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-md disabled:opacity-50",title:"Delete photo",children:Ge===`${fe.id}-${He}`?a.jsx(sa,{className:"w-3.5 h-3.5 animate-spin"}):a.jsx(ga,{className:"w-3.5 h-3.5"})})]},He))})]})]},fe.id)})})]})]})}function cl(n){return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}function y9(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function ul(n){return`$${Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function wN(n){return new Date(n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}function NN(n){return new Date(n+"T12:00:00").toLocaleDateString("en-US",{weekday:"short"})}function C0(n,e){return e===0&&n===0?0:e===0?100:(n-e)/e*100}function v9({bookings:n}){const[e,t]=_.useState(null),[i,o]=_.useState(null),c=_.useMemo(()=>n.filter(F=>F.status==="confirmed"||F.status==="pending"||!F.status),[n]),d=_.useMemo(()=>{const F=new Date;return F.setHours(0,0,0,0),F},[]),m=_.useMemo(()=>cl(d),[d]),x=_.useMemo(()=>y9(d),[d]),g=_.useMemo(()=>{const F=new Date(x);return F.setDate(F.getDate()+6),F},[x]),b=_.useMemo(()=>{const F=new Date(x);return F.setDate(F.getDate()-7),F},[x]),w=_.useMemo(()=>{const F=new Date(b);return F.setDate(F.getDate()+6),F},[b]),j=_.useMemo(()=>new Date(d.getFullYear(),d.getMonth(),1),[d]),R=_.useMemo(()=>new Date(d.getFullYear(),d.getMonth()-1,1),[d]),U=_.useMemo(()=>{const F=new Date(j);return F.setDate(F.getDate()-1),F},[j]),V=_.useMemo(()=>{const F=new Date(d);return F.setDate(F.getDate()-1),cl(F)},[d]),L=_.useMemo(()=>{const F=le=>le.reduce((pe,xe)=>pe+(Number(xe.servicePrice)||0),0),P=(le,pe,xe)=>le.date>=cl(pe)&&le.date<=cl(xe),O=F(c.filter(le=>le.date===m)),K=F(c.filter(le=>le.date===V)),ce=F(c.filter(le=>P(le,x,g))),Se=F(c.filter(le=>P(le,b,w))),be=F(c.filter(le=>P(le,j,d))),B=F(c.filter(le=>P(le,R,U))),J=F(c);return{today:O,todayChange:C0(O,K),week:ce,weekChange:C0(ce,Se),month:be,monthChange:C0(be,B),allTime:J}},[c,m,V,x,g,b,w,j,U,d]),z=_.useMemo(()=>{const F=[];for(let P=13;P>=0;P--){const O=new Date(d);O.setDate(O.getDate()-P),F.push(cl(O))}return F},[d]),Q=_.useMemo(()=>{const F={};return z.forEach(P=>{F[P]=0}),c.forEach(P=>{F[P.date]!==void 0&&(F[P.date]+=Number(P.servicePrice)||0)}),z.map(P=>({date:P,value:F[P]}))},[c,z]),G=_.useMemo(()=>Math.max(...Q.map(F=>F.value),1),[Q]),ie=_.useMemo(()=>{const F={},P={};return z.forEach(O=>{F[O]=0,P[O]=0}),n.forEach(O=>{F[O.date]!==void 0&&(O.status==="cancelled"||O.status==="rejected"?P[O.date]++:F[O.date]++)}),z.map(O=>({date:O,confirmed:F[O],cancelled:P[O],total:F[O]+P[O]}))},[n,z]),he=_.useMemo(()=>Math.max(...ie.map(F=>F.total),1),[ie]),W=_.useMemo(()=>{const F=n.length;if(F===0)return 100;const P=n.filter(O=>O.status==="cancelled"||O.status==="rejected").length;return Math.round((F-P)/F*100)},[n]),T=_.useMemo(()=>{const F=Array.from({length:7},()=>Array(24).fill(0));c.forEach(O=>{if(!O.date||!O.time)return;const ce=new Date(O.date+"T12:00:00").getDay(),Se=parseInt(O.time.split(":")[0],10);!isNaN(ce)&&!isNaN(Se)&&F[ce][Se]++});let P=0;return F.forEach(O=>O.forEach(K=>{K>P&&(P=K)})),{grid:F,max:P}},[c]),E=_.useMemo(()=>{const F={};return c.forEach(P=>{const O=P.serviceName||"Unknown";F[O]||(F[O]={name:O,count:0,revenue:0}),F[O].count++,F[O].revenue+=Number(P.servicePrice)||0}),Object.values(F).map(P=>({...P,avgRevenue:P.count>0?P.revenue/P.count:0})).sort((P,O)=>O.revenue-P.revenue)},[c]),S=_.useMemo(()=>{const F={};return c.forEach(P=>{const O=P.staffName||"Unassigned";F[O]||(F[O]={name:O,count:0,revenue:0,clients:new Set}),F[O].count++,F[O].revenue+=Number(P.servicePrice)||0,P.clientEmail&&F[O].clients.add(P.clientEmail.toLowerCase())}),Object.values(F).map(P=>({...P,clientCount:P.clients.size})).sort((P,O)=>O.revenue-P.revenue)},[c]),I=_.useMemo(()=>{const F=c.map(xe=>xe.clientEmail?.toLowerCase()).filter(Boolean),P=new Set(F).size,O=c.filter(xe=>xe.date>=cl(j)&&xe.date<=m),K=new Set(O.map(xe=>xe.clientEmail?.toLowerCase()).filter(Boolean)),ce=c.filter(xe=>xe.date<cl(j)),Se=new Set(ce.map(xe=>xe.clientEmail?.toLowerCase()).filter(Boolean));let be=0,B=0;K.forEach(xe=>{Se.has(xe)?B++:be++});const J={};c.forEach(xe=>{const Me=xe.clientEmail?.toLowerCase();Me&&(J[Me]||(J[Me]={email:Me,name:xe.clientName||Me,count:0}),J[Me].count++,xe.clientName&&(J[Me].name=xe.clientName))});const le=Object.values(J).sort((xe,Me)=>Me.count-xe.count).slice(0,10),pe=P>0?c.length/P:0;return{uniqueClients:P,newThisMonth:be,returningThisMonth:B,topClients:le,avgBookingsPerClient:pe}},[c,j,m]),k=({value:F,suffix:P="vs prev"})=>{if(F===0)return a.jsxs("span",{className:"flex items-center gap-0.5 text-xs font-medium text-slate-400",children:[a.jsx(wM,{className:"w-3 h-3"})," 0% ",P]});const O=F>0;return a.jsxs("span",{className:`flex items-center gap-0.5 text-xs font-semibold ${O?"text-emerald-600":"text-red-500"}`,children:[O?a.jsx(P2,{className:"w-3 h-3"}):a.jsx(pD,{className:"w-3 h-3"}),O?"+":"",Math.round(F),"% ",P]})},M=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],C=Array.from({length:15},(F,P)=>P+7);return a.jsxs("div",{className:"animate-fade-in space-y-6",children:[a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Today's Revenue",value:L.today,change:L.todayChange,suffix:"vs yesterday",icon:Ro,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:L.week,change:L.weekChange,suffix:"vs last week",icon:Bo,color:"bg-violet-100 text-violet-600"},{label:"This Month",value:L.month,change:L.monthChange,suffix:"vs last month",icon:Tt,color:"bg-emerald-100 text-emerald-600"},{label:"All-time Revenue",value:L.allTime,change:null,icon:Eg,color:"bg-amber-100 text-amber-600"}].map(F=>{const P=F.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${F.color} rounded-xl flex items-center justify-center`,children:a.jsx(P,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:ul(F.value)}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5 mb-1",children:F.label}),F.change!==null&&a.jsx(k,{value:F.change,suffix:F.suffix})]},F.label)})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Revenue"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Last 14 days  confirmed & pending bookings"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("div",{className:"flex items-end gap-0",children:[a.jsxs("div",{className:"flex flex-col justify-between h-48 pr-2 text-right flex-shrink-0 w-16",children:[a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:ul(G)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:ul(G/2)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"$0"})]}),a.jsx("div",{className:"flex-1 flex items-end gap-1 h-48 border-b border-l border-slate-200 pl-1 pb-0 relative",children:Q.map((F,P)=>{const O=G>0?F.value/G*100:0,K=e===P;return a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative group",onMouseEnter:()=>t(P),onMouseLeave:()=>t(null),onTouchStart:()=>t(P),children:[K&&a.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[ul(F.value),a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),a.jsx("div",{className:"w-full rounded-t-md transition-all duration-200 cursor-pointer",style:{height:`${Math.max(O,F.value>0?2:0)}%`,background:K?"linear-gradient(to top, #2563eb, #60a5fa)":"linear-gradient(to top, #3b82f6, #93c5fd)",minHeight:F.value>0?"4px":"0px"}})]},F.date)})})]}),a.jsx("div",{className:"flex ml-16 pl-1",children:Q.map(F=>a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:NN(F.date)}),a.jsx("div",{className:"text-[9px] text-slate-400",children:wN(F.date)})]},F.date))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-5",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Booking Trends"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Last 14 days breakdown"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-blue-500"})," Confirmed"]}),a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-red-400"})," Cancelled"]}),a.jsxs("span",{className:"px-2.5 py-1 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-lg font-semibold",children:[W,"% completion"]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("div",{className:"flex items-end gap-0",children:[a.jsxs("div",{className:"flex flex-col justify-between h-40 pr-2 text-right flex-shrink-0 w-16",children:[a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:he}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:Math.round(he/2)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"0"})]}),a.jsx("div",{className:"flex-1 flex items-end gap-1 h-40 border-b border-l border-slate-200 pl-1 relative",children:ie.map((F,P)=>{const O=he>0?F.confirmed/he*100:0,K=he>0?F.cancelled/he*100:0,ce=i===P;return a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative",onMouseEnter:()=>o(P),onMouseLeave:()=>o(null),onTouchStart:()=>o(P),children:[ce&&a.jsxs("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[F.confirmed," confirmed, ",F.cancelled," cancelled",a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),a.jsxs("div",{className:"w-full flex flex-col items-stretch",children:[F.cancelled>0&&a.jsx("div",{className:"w-full rounded-t-md bg-red-400 transition-all duration-200",style:{height:`${Math.max(K,2)}%`}}),F.confirmed>0&&a.jsx("div",{className:`w-full bg-blue-500 transition-all duration-200 ${F.cancelled===0?"rounded-t-md":""}`,style:{height:`${Math.max(O,2)}%`}})]})]},F.date)})})]}),a.jsx("div",{className:"flex ml-16 pl-1",children:ie.map(F=>a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:NN(F.date)}),a.jsx("div",{className:"text-[9px] text-slate-400",children:wN(F.date)})]},F.date))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Busiest Times"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Booking density by day of week and hour"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"w-12"}),C.map(F=>a.jsxs("th",{className:"text-[10px] text-slate-400 font-medium pb-2 text-center px-0.5",children:[F%12||12,F>=12?"p":"a"]},F))]})}),a.jsx("tbody",{children:[1,2,3,4,5,6,0].map(F=>a.jsxs("tr",{children:[a.jsx("td",{className:"text-[11px] text-slate-500 font-semibold pr-2 py-0.5 text-right",children:M[F]}),C.map(P=>{const O=T.grid[F][P],K=T.max||1,ce=O/K;let Se="bg-slate-50";return O>0&&(ce<=.2?Se="bg-blue-100":ce<=.4?Se="bg-blue-200":ce<=.6?Se="bg-blue-300":ce<=.8?Se="bg-blue-500 text-white":Se="bg-blue-700 text-white"),a.jsx("td",{className:"px-0.5 py-0.5",children:a.jsx("div",{className:`w-full aspect-square rounded-sm ${Se} flex items-center justify-center text-[9px] font-bold transition-all hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 cursor-default`,title:`${M[F]} ${P}:00  ${O} booking${O!==1?"s":""}`,children:O>0?O:""})},P)})]},F))})]}),a.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-3",children:[a.jsx("span",{className:"text-[10px] text-slate-400",children:"Less"}),["bg-slate-50","bg-blue-100","bg-blue-200","bg-blue-300","bg-blue-500","bg-blue-700"].map((F,P)=>a.jsx("div",{className:`w-4 h-4 rounded-sm ${F} border border-slate-200`},P)),a.jsx("span",{className:"text-[10px] text-slate-400",children:"More"})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Top Services"}),a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Ranked by revenue from confirmed & pending bookings"}),E.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Nn,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No service data yet"})]}):a.jsx("div",{className:"space-y-2",children:E.map((F,P)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm flex-shrink-0",children:P+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:F.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:[F.count," booking",F.count!==1?"s":"","  avg ",ul(F.avgRevenue)]})]}),a.jsx("div",{className:"text-sm font-bold text-blue-600 flex-shrink-0",children:ul(F.revenue)})]},F.name))})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Staff Performance"}),a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Bookings, revenue & clients per staff member"}),S.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Pt,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No staff data yet"})]}):a.jsx("div",{className:"space-y-2",children:S.map((F,P)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center text-violet-600 font-bold text-sm flex-shrink-0",children:P+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:F.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:[F.count," booking",F.count!==1?"s":"","  ",F.clientCount," client",F.clientCount!==1?"s":""]})]}),a.jsx("div",{className:"text-sm font-bold text-violet-600 flex-shrink-0",children:ul(F.revenue)})]},F.name))})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Insights"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Understanding your client base"}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[a.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:I.uniqueClients}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Unique Clients"})]}),a.jsxs("div",{className:"bg-emerald-50 rounded-xl border border-emerald-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-emerald-700",children:I.newThisMonth}),a.jsx("div",{className:"text-xs font-medium text-emerald-600 mt-0.5",children:"New This Month"})]}),a.jsxs("div",{className:"bg-blue-50 rounded-xl border border-blue-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-blue-700",children:I.returningThisMonth}),a.jsx("div",{className:"text-xs font-medium text-blue-600 mt-0.5",children:"Returning This Month"})]}),a.jsxs("div",{className:"bg-violet-50 rounded-xl border border-violet-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-violet-700",children:I.avgBookingsPerClient.toFixed(1)}),a.jsx("div",{className:"text-xs font-medium text-violet-600 mt-0.5",children:"Avg Bookings / Client"})]})]}),a.jsx("h4",{className:"text-sm font-bold text-slate-700 mb-3",children:"Top Clients by Frequency"}),I.topClients.length===0?a.jsxs("div",{className:"text-center py-6",children:[a.jsx(jl,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No client data yet"})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:I.topClients.map((F,P)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center text-amber-700 font-bold text-xs flex-shrink-0",children:P+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:F.name}),a.jsx("div",{className:"text-xs text-slate-400 truncate",children:F.email})]}),a.jsxs("div",{className:"flex-shrink-0 px-2.5 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-bold",children:[F.count," visit",F.count!==1?"s":""]})]},F.email))})]})]})}function oS({waitingAhead:n=[],inProgress:e=[],staffCount:t=1,upcomingBookings:i=[],defaultDuration:o=30}){const c=Math.max(t,1),d=Date.now(),m=e.map(b=>{const w=b.startedAt?.toDate?.()||(b.startedAt?new Date(b.startedAt):null);if(!w)return 0;const j=(d-w.getTime())/6e4,R=b.estimatedDuration||o;return Math.max(0,R-j)});m.sort((b,w)=>b-w);const x=[];for(let b=0;b<c;b++)x.push(m[b]||0);x.sort((b,w)=>b-w);const g=n.map(b=>b.estimatedDuration||o);for(const b of g)x[0]+=b,x.sort((w,j)=>w-j);return Math.round(x[0])}function cS({waitingQueue:n=[],inProgress:e=[],staffCount:t=1,upcomingBookings:i=[],defaultDuration:o=30}){const c=new Map;for(let d=0;d<n.length;d++){const m=n.slice(0,d),x=oS({waitingAhead:m,inProgress:e,staffCount:t,upcomingBookings:i,defaultDuration:o});c.set(n[d].id,x)}return c}function w9(n=[],e=3){const t=new Date,i=new Date(t.getTime()+e*60*60*1e3),o=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return n.filter(c=>{if(c.status==="cancelled"||c.status==="rejected"||c.date!==o)return!1;const d=new Date(`${c.date}T${c.time}`);return d>=t&&d<=i}).sort((c,d)=>`${c.time}`.localeCompare(`${d.time}`))}function N9(n){if(!n)return"0m";const e=n?.toDate?.()||new Date(n),t=Math.floor((Date.now()-e.getTime())/6e4);if(t<1)return"<1m";if(t<60)return`${t}m`;const i=Math.floor(t/60),o=t%60;return o>0?`${i}h ${o}m`:`${i}h`}function _9(n){if(n==null)return"";if(n<1)return"Next up";if(n<60)return`~${n}m`;const e=Math.floor(n/60),t=n%60;return t>0?`~${e}h ${t}m`:`~${e}h`}function j9({shopId:n,services:e,staff:t,bookings:i}){const[o,c]=_.useState([]),[d,m]=_.useState(!1),[x,g]=_.useState(!1),[b,w]=_.useState(!1),[j,R]=_.useState({clientName:"",serviceId:"",staffId:"",estimatedDuration:30});_.useEffect(()=>{if(!n)return;const P=Kt(Ke(ve,"shops",n,"walkins"),O=>{const K=O.docs.map(ce=>({id:ce.id,...ce.data()}));c(K)});return()=>P()},[n]);const U=_.useMemo(()=>o.filter(P=>P.status==="waiting").sort((P,O)=>(P.position||0)-(O.position||0)),[o]),V=_.useMemo(()=>o.filter(P=>P.status==="in-progress").sort((P,O)=>{const K=P.startedAt?.toDate?.()?.getTime()||0,ce=O.startedAt?.toDate?.()?.getTime()||0;return K-ce}),[o]),L=_.useMemo(()=>{const P=new Date;return P.setHours(0,0,0,0),P},[]),z=_.useMemo(()=>o.filter(P=>{if(P.status!=="completed"&&P.status!=="no-show")return!1;const O=P.completedAt?.toDate?.()||(P.completedAt?new Date(P.completedAt):null);return O?O>=L:!1}).sort((P,O)=>{const K=P.completedAt?.toDate?.()?.getTime()||0;return(O.completedAt?.toDate?.()?.getTime()||0)-K}),[o,L]),Q=_.useMemo(()=>Math.max(t.filter(P=>P.active!==!1).length,1),[t]),G=_.useMemo(()=>w9(i,3),[i]),ie=_.useMemo(()=>cS({waitingQueue:U,inProgress:V,staffCount:Q,upcomingBookings:G,defaultDuration:30}),[U,V,Q,G]),he=_.useMemo(()=>{const P=z.filter(K=>K.status==="completed"&&K.joinedAt&&K.startedAt).map(K=>{const ce=K.joinedAt?.toDate?.()||new Date(K.joinedAt),Se=K.startedAt?.toDate?.()||new Date(K.startedAt);return Math.floor((Se.getTime()-ce.getTime())/6e4)}).filter(K=>K>=0),O=P.length>0?Math.round(P.reduce((K,ce)=>K+ce,0)/P.length):0;return{waiting:U.length,avgWait:O,completedToday:z.filter(K=>K.status==="completed").length}},[U,z]),W=P=>{const O=e.find(K=>K.id===P);R(K=>({...K,serviceId:P,estimatedDuration:O?.duration||30}))},T=()=>U.length===0?1:Math.max(...U.map(P=>P.position||0))+1,E=_.useMemo(()=>o.filter(P=>{const O=P.joinedAt?.toDate?.()||(P.joinedAt?new Date(P.joinedAt):null);return O&&O>=L}).length,[o,L]),S=async P=>{P.preventDefault(),w(!0);const O=e.find(be=>be.id===j.serviceId),K=t.find(be=>be.id===j.staffId),ce=T(),Se=j.clientName.trim()||`Walk-in #${E+1}`;try{await _a(Ke(ve,"shops",n,"walkins"),{clientName:Se,serviceId:j.serviceId||null,serviceName:O?.name||null,staffId:j.staffId||null,staffName:K?.name||null,estimatedDuration:parseInt(j.estimatedDuration)||30,status:"waiting",position:ce,joinedAt:Ot.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),R({clientName:"",serviceId:"",staffId:"",estimatedDuration:30}),m(!1)}catch(be){console.error("Error adding walk-in:",be)}finally{w(!1)}},I=async P=>{try{await st($e(ve,"shops",n,"walkins",P),{status:"in-progress",startedAt:Ot.now()});const O=U.filter(K=>K.id!==P).sort((K,ce)=>(K.position||0)-(ce.position||0));for(let K=0;K<O.length;K++)await st($e(ve,"shops",n,"walkins",O[K].id),{position:K+1})}catch(O){console.error("Error starting service:",O)}},k=async P=>{try{await st($e(ve,"shops",n,"walkins",P),{status:"completed",completedAt:Ot.now()})}catch(O){console.error("Error completing service:",O)}},M=async P=>{try{await st($e(ve,"shops",n,"walkins",P),{status:"no-show",completedAt:Ot.now()});const O=U.filter(K=>K.id!==P).sort((K,ce)=>(K.position||0)-(ce.position||0));for(let K=0;K<O.length;K++)await st($e(ve,"shops",n,"walkins",O[K].id),{position:K+1})}catch(O){console.error("Error marking no-show:",O)}},C=async P=>{const O=U.findIndex(Se=>Se.id===P);if(O<=0)return;const K=U[O-1],ce=U[O];try{await st($e(ve,"shops",n,"walkins",ce.id),{position:K.position}),await st($e(ve,"shops",n,"walkins",K.id),{position:ce.position})}catch(Se){console.error("Error reordering:",Se)}},F=async P=>{const O=U.findIndex(Se=>Se.id===P);if(O<0||O>=U.length-1)return;const K=U[O+1],ce=U[O];try{await st($e(ve,"shops",n,"walkins",ce.id),{position:K.position}),await st($e(ve,"shops",n,"walkins",K.id),{position:ce.position})}catch(Se){console.error("Error reordering:",Se)}};return a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[{label:"Currently Waiting",value:he.waiting,icon:Pt,color:"bg-blue-100 text-blue-600"},{label:"Avg Wait",value:he.avgWait>0?`${he.avgWait}m`:"",icon:q2,color:"bg-amber-100 text-amber-600"},{label:"Completed Today",value:he.completedToday,icon:Bo,color:"bg-emerald-100 text-emerald-600"}].map(P=>{const O=P.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${P.color} rounded-xl flex items-center justify-center`,children:a.jsx(O,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:P.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:P.label})]},P.label)})}),G.length>0&&a.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(na,{className:"w-4 h-4 text-amber-600"}),a.jsx("span",{className:"text-sm font-bold text-amber-800",children:"Upcoming Online Bookings"})]}),a.jsx("div",{className:"space-y-1",children:G.slice(0,5).map(P=>{const[O,K]=(P.time||"").split(":"),ce=parseInt(O),Se=`${ce%12||12}:${K} ${ce>=12?"PM":"AM"}`;return a.jsxs("div",{className:"text-xs text-amber-700 flex items-center gap-2",children:[a.jsx(ts,{className:"w-3 h-3"}),a.jsx("span",{className:"font-medium",children:Se}),a.jsx("span",{children:""}),a.jsx("span",{children:P.clientName}),P.serviceName&&a.jsxs("span",{className:"text-amber-500",children:["(",P.serviceName,")"]}),P.staffName&&a.jsxs("span",{className:"text-violet-600",children:["with ",P.staffName]})]},P.id)})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Walk-in Queue"}),!d&&a.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[a.jsx(Za,{className:"w-4 h-4"}),"Add Walk-in"]})]}),d&&a.jsxs("form",{onSubmit:S,className:"mb-5 p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3",children:"New Walk-in"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Client Name"}),a.jsx("input",{type:"text",value:j.clientName,onChange:P=>R(O=>({...O,clientName:P.target.value})),placeholder:`Walk-in #${E+1}`,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Service"}),a.jsxs("select",{value:j.serviceId,onChange:P=>W(P.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"No service selected"}),e.map(P=>a.jsxs("option",{value:P.id,children:[P.name," (",P.duration,"min)"]},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Staff Preference"}),a.jsxs("select",{value:j.staffId,onChange:P=>R(O=>({...O,staffId:P.target.value})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"Next available"}),t.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Est. Duration (min)"}),a.jsx("select",{value:j.estimatedDuration,onChange:P=>R(O=>({...O,estimatedDuration:parseInt(P.target.value)})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[15,30,45,60,90,120].map(P=>a.jsx("option",{value:P,children:P<60?`${P} min`:`${P/60}h${P%60?` ${P%60}m`:""}`},P))})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{type:"submit",disabled:b,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[a.jsx(Za,{className:"w-4 h-4"}),b?"Adding":"Add to Queue"]}),a.jsx("button",{type:"button",onClick:()=>{m(!1),R({clientName:"",serviceId:"",staffId:"",estimatedDuration:30})},className:"px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Cancel"})]})]}),U.length===0&&V.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Pt,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No walk-ins in queue"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Add a walk-in client to start the queue."})]}):a.jsxs(a.Fragment,{children:[U.length>0&&a.jsxs("div",{className:"mb-5",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx(ts,{className:"w-4 h-4 text-blue-500"}),"Waiting",a.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:U.length})]}),a.jsx("div",{className:"space-y-2",children:U.map((P,O)=>{const K=ie.get(P.id);return a.jsxs("div",{className:"group flex items-center gap-3 border border-slate-200 rounded-xl p-3.5 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[a.jsx("button",{onClick:()=>C(P.id),disabled:O===0,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:a.jsx(ox,{className:"w-4 h-4"})}),a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center font-bold text-blue-700 text-sm",children:O+1}),a.jsx("button",{onClick:()=>F(P.id),disabled:O===U.length-1,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:a.jsx(Iu,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:P.clientName}),a.jsx("span",{className:"px-2 py-0.5 bg-blue-50 text-blue-600 border border-blue-200 text-[10px] font-bold rounded-md",children:"WAITING"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[P.serviceName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nn,{className:"w-3 h-3 text-blue-400"}),P.serviceName]}),P.staffName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(jl,{className:"w-3 h-3 text-violet-400"}),P.staffName]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(ts,{className:"w-3 h-3"}),P.estimatedDuration||30,"min"]})]})]}),a.jsxs("div",{className:"text-right mr-2",children:[a.jsx("div",{className:"text-sm font-bold text-amber-600",children:_9(K)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"est. wait"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs("button",{onClick:()=>I(P.id),className:"flex items-center gap-1 px-3 py-2 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 border border-emerald-200 rounded-lg text-xs font-semibold transition-all",title:"Start Service",children:[a.jsx(E0,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Start"})]}),a.jsxs("button",{onClick:()=>M(P.id),className:"flex items-center gap-1 px-3 py-2 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all",title:"No-show",children:[a.jsx(qa,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"No-show"})]})]})]},P.id)})})]}),V.length>0&&a.jsxs("div",{className:"mb-5",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx(E0,{className:"w-4 h-4 text-emerald-500"}),"In Progress",a.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 border border-emerald-200 text-xs font-bold rounded-full",children:V.length})]}),a.jsx("div",{className:"space-y-2",children:V.map(P=>a.jsxs("div",{className:"flex items-center gap-3 border border-emerald-200 bg-emerald-50/50 rounded-xl p-3.5 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center",children:a.jsx(E0,{className:"w-4 h-4 text-emerald-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:P.clientName}),a.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 text-[10px] font-bold rounded-md",children:"IN PROGRESS"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[P.serviceName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nn,{className:"w-3 h-3 text-blue-400"}),P.serviceName]}),P.staffName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(jl,{className:"w-3 h-3 text-violet-400"}),P.staffName]})]})]}),a.jsxs("div",{className:"text-right mr-2",children:[a.jsx("div",{className:"text-sm font-bold text-emerald-600",children:N9(P.startedAt)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"elapsed"})]}),a.jsxs("button",{onClick:()=>k(P.id),className:"flex items-center gap-1 px-3 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 rounded-lg text-xs font-semibold transition-all",title:"Complete",children:[a.jsx(Os,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Complete"})]})]},P.id))})]})]})]}),z.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("button",{onClick:()=>g(!x),className:"w-full flex items-center justify-between",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[a.jsx(Os,{className:"w-4 h-4 text-slate-400"}),"Completed Today",a.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-500 border border-slate-200 text-xs font-bold rounded-full",children:z.length})]}),a.jsx(Xu,{className:`w-4 h-4 text-slate-400 transition-transform ${x?"rotate-90":""}`})]}),x&&a.jsx("div",{className:"mt-3 space-y-2",children:z.map(P=>a.jsxs("div",{className:"flex items-center gap-3 border border-slate-100 rounded-lg p-3 bg-slate-50/50",children:[a.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center bg-slate-100",children:P.status==="no-show"?a.jsx(qa,{className:"w-3.5 h-3.5 text-red-400"}):a.jsx(Os,{className:"w-3.5 h-3.5 text-emerald-400"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-700 text-sm truncate",children:P.clientName}),a.jsx("span",{className:`text-[10px] font-bold rounded-md px-1.5 py-0.5 border ${P.status==="no-show"?"bg-red-50 text-red-600 border-red-200":"bg-emerald-50 text-emerald-600 border-emerald-200"}`,children:P.status==="no-show"?"NO-SHOW":"COMPLETED"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[P.serviceName&&a.jsx("span",{children:P.serviceName}),P.staffName&&a.jsxs("span",{children:[" ",P.staffName]})]})]})]},P.id))})]})]})}function S9(n,e){const t=new Date(n+"T12:00:00"),i=e.getTime()-t.getTime();return Math.floor(i/864e5)}function Rh(n){return`$${Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function nu(n){return n?new Date(n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function E9(n,e,t){return n>90?"lost":n>t?"at-risk":n>e?"getting-cold":"active"}const Ih={active:{label:"Active",bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200",icon:Ag,iconColor:"text-emerald-500"},"getting-cold":{label:"Getting Cold",bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",icon:$2,iconColor:"text-amber-500"},"at-risk":{label:"At Risk",bg:"bg-orange-50",text:"text-orange-700",border:"border-orange-200",icon:na,iconColor:"text-orange-500"},lost:{label:"Lost",bg:"bg-red-50",text:"text-red-700",border:"border-red-200",icon:ZD,iconColor:"text-red-500"}};function T9({shopId:n,bookings:e,shop:t,slug:i}){const[o,c]=_.useState({}),[d,m]=_.useState(null),[x,g]=_.useState(null),[b,w]=_.useState(""),[j,R]=_.useState(""),[U,V]=_.useState("all"),[L,z]=_.useState("lastVisit"),[Q,G]=_.useState("asc"),[ie,he]=_.useState(null),[W,T]=_.useState(!1),[E,S]=_.useState(null),[I,k]=_.useState(!1),[M,C]=_.useState(null),F=t?.winbackSettings?.warningDays||30,P=t?.winbackSettings?.inactiveDays||60,O=t?.winbackSettings?.enabled!==!1,K=ae=>ae.toLowerCase().replace(/\./g,"_dot_").replace(/@/g,"_at_");_.useEffect(()=>{if(!n)return;const ae=Kt(Ke(ve,"shops",n,"clientNotes"),_e=>{const Ee={};_e.docs.forEach(qe=>{Ee[qe.id]=qe.data()}),c(Ee)});return()=>ae()},[n]);const ce=_.useMemo(()=>new Date,[]),Se=_.useMemo(()=>e.filter(ae=>ae.status==="confirmed"||ae.status==="pending"||!ae.status),[e]),be=_.useMemo(()=>{const ae={};return Se.forEach(_e=>{const Ee=_e.clientEmail?.toLowerCase();if(!Ee)return;ae[Ee]||(ae[Ee]={email:Ee,name:_e.clientName||Ee,phone:_e.clientPhone||"",totalVisits:0,totalSpent:0,lastVisitDate:null,firstVisitDate:null,bookings:[],serviceFrequency:{},staffFrequency:{}});const qe=ae[Ee];_e.clientName&&(qe.name=_e.clientName),_e.clientPhone&&(qe.phone=_e.clientPhone),qe.totalVisits++,qe.totalSpent+=Number(_e.servicePrice)||0,qe.bookings.push(_e),(!qe.lastVisitDate||_e.date>qe.lastVisitDate)&&(qe.lastVisitDate=_e.date),(!qe.firstVisitDate||_e.date<qe.firstVisitDate)&&(qe.firstVisitDate=_e.date),_e.serviceName&&(qe.serviceFrequency[_e.serviceName]=(qe.serviceFrequency[_e.serviceName]||0)+1),_e.staffName&&(qe.staffFrequency[_e.staffName]=(qe.staffFrequency[_e.staffName]||0)+1)}),Object.values(ae).map(_e=>{const Ee=_e.lastVisitDate?S9(_e.lastVisitDate,ce):999,qe=E9(Ee,F,P),Je=Object.entries(_e.serviceFrequency).sort((Ie,Be)=>Be[1]-Ie[1])[0]?.[0]||null,Nt=Object.entries(_e.staffFrequency).sort((Ie,Be)=>Be[1]-Ie[1])[0]?.[0]||null,Vs=_e.totalVisits>0?_e.totalSpent/_e.totalVisits:0,At=K(_e.email),ft=o[At];return{..._e,daysSinceLastVisit:Ee,status:qe,favoriteService:Je,favoriteStaff:Nt,avgSpending:Vs,encodedEmail:At,notes:ft?.notes||"",contacted:ft?.contacted||!1,contactedAt:ft?.contactedAt||null,tags:ft?.tags||[]}})},[Se,ce,F,P,o]),B=_.useMemo(()=>{const ae={all:be.length,active:0,"getting-cold":0,"at-risk":0,lost:0};return be.forEach(_e=>{ae[_e.status]++}),ae},[be]),J=_.useMemo(()=>be.filter(ae=>(ae.status==="at-risk"||ae.status==="lost")&&!ae.contacted),[be]),le=_.useMemo(()=>{let ae=be;if(j.trim()){const _e=j.toLowerCase();ae=ae.filter(Ee=>Ee.name.toLowerCase().includes(_e)||Ee.email.includes(_e)||Ee.phone.includes(_e))}return U!=="all"&&(ae=ae.filter(_e=>_e.status===U)),ae=[...ae].sort((_e,Ee)=>{if(L==="lastVisit"){const qe=(_e.lastVisitDate||"").localeCompare(Ee.lastVisitDate||"");return Q==="asc"?qe:-qe}return L==="totalVisits"?Q==="desc"?Ee.totalVisits-_e.totalVisits:_e.totalVisits-Ee.totalVisits:L==="totalSpent"?Q==="desc"?Ee.totalSpent-_e.totalSpent:_e.totalSpent-Ee.totalSpent:0}),ae},[be,j,U,L,Q]),pe=ae=>{L===ae?G(_e=>_e==="asc"?"desc":"asc"):(z(ae),G(ae==="lastVisit"?"asc":"desc"))},xe=_.useCallback(ae=>{const _e=t?.name||"our shop",Ee=`${window.location.origin}${window.location.pathname}#/shop/${i}`;return`Hi ${ae.name.split(" ")[0]}, we miss you at ${_e}! It's been ${ae.daysSinceLastVisit} days since your last visit.${ae.favoriteService?` Book your next ${ae.favoriteService} today:`:" Book your next appointment:"} ${Ee}`},[t,i]),Me=ae=>{const _e=xe(ae);S({email:ae.email,encodedEmail:ae.encodedEmail,name:ae.name,message:_e})},Ge=async(ae,_e)=>{try{await navigator.clipboard.writeText(ae),he(_e),setTimeout(()=>he(null),2e3)}catch(Ee){console.error("Failed to copy:",Ee)}},xt=async ae=>{C(ae);try{const _e=$e(ve,"shops",n,"clientNotes",ae),Ee=await N0(_e),qe=Ee.exists()?Ee.data():{};await _0(_e,{...qe,contacted:!0,contactedAt:new Date().toISOString()}),S(null)}catch(_e){console.error("Error marking as contacted:",_e)}finally{C(null)}},it=async ae=>{try{const _e=$e(ve,"shops",n,"clientNotes",ae),Ee=await N0(_e),qe=Ee.exists()?Ee.data():{};await _0(_e,{...qe,contacted:!1,contactedAt:null})}catch(_e){console.error("Error resetting contacted status:",_e)}},Gt=async ae=>{k(!0);try{const _e=$e(ve,"shops",n,"clientNotes",ae),Ee=await N0(_e),qe=Ee.exists()?Ee.data():{};await _0(_e,{...qe,notes:b}),g(null)}catch(_e){console.error("Error saving notes:",_e)}finally{k(!1)}};return a.jsxs("div",{className:"animate-fade-in space-y-6",children:[O&&J.length>0&&a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>T(!W),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:a.jsx(na,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[J.length," client",J.length!==1?"s":""," need",J.length===1?"s":""," attention"]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Haven't visited in over ",P," days  send a win-back message to re-engage"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-2.5 py-1 bg-orange-100 text-orange-700 border border-orange-200 text-xs font-bold rounded-lg",children:J.length}),W?a.jsx(ox,{className:"w-5 h-5 text-slate-400"}):a.jsx(Iu,{className:"w-5 h-5 text-slate-400"})]})]}),W&&a.jsx("div",{className:"mt-4 space-y-2.5",children:J.sort((ae,_e)=>_e.daysSinceLastVisit-ae.daysSinceLastVisit).map(ae=>a.jsxs("div",{className:"bg-white rounded-xl border border-orange-100 p-4 flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx("div",{className:"w-9 h-9 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(jl,{className:"w-4 h-4 text-orange-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:ae.name}),a.jsxs("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Ih[ae.status].bg} ${Ih[ae.status].text} ${Ih[ae.status].border}`,children:[ae.daysSinceLastVisit," days ago"]})]}),a.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 flex-wrap mt-0.5",children:[a.jsxs("span",{children:["Last: ",nu(ae.lastVisitDate)]}),ae.favoriteService&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-slate-300",children:""}),a.jsxs("span",{className:"text-blue-600",children:["Loves ",ae.favoriteService]})]}),a.jsx("span",{className:"text-slate-300",children:""}),a.jsxs("span",{children:[ae.totalVisits," visit",ae.totalVisits!==1?"s":""]})]})]})]}),a.jsxs("button",{onClick:_e=>{_e.stopPropagation(),Me(ae)},className:"flex items-center gap-1.5 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-xl text-xs font-semibold transition-all shadow-sm flex-shrink-0",children:[a.jsx(Yh,{className:"w-3.5 h-3.5"}),"Send Win-back"]})]},ae.email))})]}),E&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:a.jsx(ux,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Win-back Message"}),a.jsxs("p",{className:"text-sm text-slate-500",children:["Send to ",E.name]})]})]}),a.jsx("div",{className:"bg-slate-50 rounded-xl p-4 mb-4 border border-slate-200",children:a.jsx("textarea",{value:E.message,onChange:ae=>S({...E,message:ae.target.value}),rows:4,className:"w-full bg-transparent text-sm text-slate-700 resize-none focus:outline-none leading-relaxed"})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{Ge(E.message,E.email)},className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:ie===E.email?a.jsxs(a.Fragment,{children:[a.jsx(tn,{className:"w-4 h-4"}),"Copied!"]}):a.jsxs(a.Fragment,{children:[a.jsx(L2,{className:"w-4 h-4"}),"Copy to Clipboard"]})}),a.jsxs("button",{onClick:()=>xt(E.encodedEmail),disabled:M===E.encodedEmail,className:"flex items-center justify-center gap-2 px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-emerald-600/20 disabled:opacity-50",children:[a.jsx(tn,{className:"w-4 h-4"}),"Mark Contacted"]}),a.jsx("button",{onClick:()=>S(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Close"})]})]})}),a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Clients",value:B.all,icon:Pt,color:"bg-blue-100 text-blue-600"},{label:"Active",value:B.active,icon:Ag,color:"bg-emerald-100 text-emerald-600"},{label:"Getting Cold",value:B["getting-cold"],icon:$2,color:"bg-amber-100 text-amber-600"},{label:"At Risk / Lost",value:B["at-risk"]+B.lost,icon:na,color:"bg-red-100 text-red-600"}].map(ae=>{const _e=ae.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${ae.color} rounded-xl flex items-center justify-center`,children:a.jsx(_e,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:ae.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:ae.label})]},ae.label)})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Clients"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Derived from booking history"})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[le.length," client",le.length!==1?"s":""]})]}),a.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[a.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[a.jsx(Gh,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2"}),a.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:j,onChange:ae=>R(ae.target.value),className:"w-full pl-10 pr-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),j&&a.jsx("button",{onClick:()=>R(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:a.jsx(Rs,{className:"w-4 h-4 text-slate-400 hover:text-slate-600"})})]}),a.jsx("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl overflow-x-auto",children:[{key:"all",label:"All"},{key:"active",label:"Active"},{key:"getting-cold",label:"Cold"},{key:"at-risk",label:"At Risk"},{key:"lost",label:"Lost"}].map(ae=>a.jsxs("button",{onClick:()=>V(ae.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap ${U===ae.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[ae.label,a.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${U===ae.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:B[ae.key]??0})]},ae.key))}),a.jsx("div",{className:"flex items-center gap-1",children:[{key:"lastVisit",label:"Last Visit"},{key:"totalVisits",label:"Visits"},{key:"totalSpent",label:"Spent"}].map(ae=>a.jsxs("button",{onClick:()=>pe(ae.key),className:`flex items-center gap-1 px-3 py-2 rounded-lg text-xs font-semibold transition-all border ${L===ae.key?"bg-blue-50 text-blue-700 border-blue-200":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[ae.label,L===ae.key&&a.jsx(yD,{className:"w-3 h-3"})]},ae.key))})]}),le.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Pt,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No clients found"}),a.jsx("p",{className:"text-xs text-slate-400",children:j?"Try a different search term":"Client data will appear as bookings come in"})]}):a.jsx("div",{className:"space-y-2",children:le.map(ae=>{const _e=d===ae.email,Ee=Ih[ae.status],qe=Ee.icon;return a.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden hover:border-slate-300 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 cursor-pointer hover:bg-slate-50/50 transition-all",onClick:()=>m(_e?null:ae.email),children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(jl,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:ae.name}),a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-bold rounded-md border ${Ee.bg} ${Ee.text} ${Ee.border}`,children:[a.jsx(qe,{className:"w-3 h-3"}),Ee.label]}),ae.contacted&&a.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",children:[a.jsx(Yh,{className:"w-2.5 h-2.5"}),"Contacted"]}),ae.notes&&a.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-violet-50 text-violet-600 border-violet-200",children:a.jsx(sN,{className:"w-2.5 h-2.5"})})]}),a.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-3 mt-0.5 flex-wrap",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Ef,{className:"w-3 h-3"}),ae.email]}),ae.phone&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(dx,{className:"w-3 h-3"}),ae.phone]})]})]}),a.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-shrink-0",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900",children:ae.totalVisits}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-blue-600",children:Rh(ae.totalSpent)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-700",children:nu(ae.lastVisitDate)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(ae.status==="at-risk"||ae.status==="lost")&&!ae.contacted&&a.jsx("button",{onClick:Je=>{Je.stopPropagation(),Me(ae)},className:"p-2 text-orange-500 hover:text-orange-700 hover:bg-orange-50 rounded-lg transition-all",title:"Send win-back message",children:a.jsx(Yh,{className:"w-4 h-4"})}),_e?a.jsx(ox,{className:"w-4 h-4 text-slate-400"}):a.jsx(Iu,{className:"w-4 h-4 text-slate-400"})]})]}),_e&&a.jsxs("div",{className:"border-t border-slate-200 bg-slate-50/50 p-5 space-y-5",children:[a.jsxs("div",{className:"sm:hidden grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-slate-900",children:ae.totalVisits}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-blue-600",children:Rh(ae.totalSpent)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-700",children:nu(ae.lastVisitDate)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Avg per Visit"}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:Rh(ae.avgSpending)})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"First Visit"}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:nu(ae.firstVisitDate)})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Days Since Last Visit"}),a.jsxs("div",{className:"text-sm font-bold text-slate-900",children:[ae.daysSinceLastVisit,"d"]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Favorite Service"}),a.jsx("div",{className:"text-sm font-bold text-blue-600 truncate",children:ae.favoriteService||""})]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Nn,{className:"w-3.5 h-3.5 text-blue-500"}),"Services Used"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(ae.serviceFrequency).sort((Je,Nt)=>Nt[1]-Je[1]).map(([Je,Nt])=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg text-xs font-medium",children:[Je,a.jsxs("span",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[Nt,""]})]},Je))})]}),Object.keys(ae.staffFrequency).length>0&&a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Pt,{className:"w-3.5 h-3.5 text-violet-500"}),"Staff Members Seen"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(ae.staffFrequency).sort((Je,Nt)=>Nt[1]-Je[1]).map(([Je,Nt])=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-violet-50 text-violet-700 border border-violet-200 rounded-lg text-xs font-medium",children:[Je,a.jsxs("span",{className:"bg-violet-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[Nt,""]})]},Je))})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Tt,{className:"w-3.5 h-3.5 text-emerald-500"}),"Booking History",a.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",ae.bookings.length,")"]})]}),a.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:ae.bookings.sort((Je,Nt)=>(Nt.date+Nt.time).localeCompare(Je.date+Je.time)).map((Je,Nt)=>a.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded-lg hover:bg-slate-50 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-700",children:nu(Je.date)}),a.jsx("span",{className:"text-slate-400",children:Je.time}),Je.serviceName&&a.jsx("span",{className:"text-blue-600",children:Je.serviceName})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[Je.staffName&&a.jsx("span",{className:"text-violet-600",children:Je.staffName}),Je.servicePrice!=null&&a.jsx("span",{className:"font-semibold text-slate-900",children:Rh(Je.servicePrice)})]})]},Nt))})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 flex items-center gap-1.5",children:[a.jsx(sN,{className:"w-3.5 h-3.5 text-amber-500"}),"Notes"]}),x!==ae.encodedEmail&&a.jsx("button",{onClick:()=>{g(ae.encodedEmail),w(ae.notes||"")},className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:ae.notes?"Edit":"Add Notes"})]}),x===ae.encodedEmail?a.jsxs("div",{className:"space-y-2",children:[a.jsx("textarea",{value:b,onChange:Je=>w(Je.target.value),placeholder:"Add notes about this client (e.g., preferences, allergies, favorite styles...)",rows:3,className:"w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>Gt(ae.encodedEmail),disabled:I,className:"px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:I?"Saving...":"Save"}),a.jsx("button",{onClick:()=>g(null),className:"px-4 py-1.5 bg-white hover:bg-slate-50 text-slate-600 border border-slate-200 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}):a.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:ae.notes||'No notes yet. Click "Add Notes" to save preferences, allergies, or anything useful.'})]}),ae.contacted&&a.jsxs("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[a.jsx(tn,{className:"w-4 h-4"}),a.jsxs("span",{className:"font-medium",children:["Contacted",ae.contactedAt?` on ${new Date(ae.contactedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`:""]})]}),a.jsx("button",{onClick:()=>it(ae.encodedEmail),className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:"Reset"})]})]})]},ae.email)})})]})]})}const _N="https://us-central1-scheduler-65e51.cloudfunctions.net",A9={pro:"price_1Sxx7ILhwB1Jyzw8UvRxE5FT",unlimited:"price_1Sxx7JLhwB1Jyzw8uw9BRYhO"},k9={basicBooking:Tt,emailNotifications:ux,aiAssistant:jD,recurringBookings:ts,waitlist:Pt,crm:Pt,analytics:Eg,smsNotifications:ux,customBranding:_M,walkIns:H2,multiLocation:xM,noBranding:F2,apiAccess:qD,prioritySupport:rM};function C9({shopId:n,shop:e,slug:t}){const[i,o]=_.useState(e),[c,d]=_.useState(!1),[m,x]=_.useState(null),[g,b]=_.useState(!1);_.useEffect(()=>{if(!n)return;const G=Kt($e(ve,"shops",n),ie=>{ie.exists()&&o(ie.data())});return()=>G()},[n]);const w=i?.subscriptionTier||"free",j=_r[w],R=i?.subscriptionStatus,U=i?.subscriptionEndsAt,V=G=>G?(G.toDate?G.toDate():new Date(G)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):null,L=async G=>{d(G),x(null);try{const ie=await fetch(`${_N}/createCheckoutSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,priceId:A9[G],successUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?subscription=canceled`})}),he=await ie.json();if(!ie.ok)throw new Error(he.error||"Failed to create checkout session");window.location.href=he.url}catch(ie){console.error("Upgrade error:",ie),x(ie.message),d(null)}},z=async()=>{b(!0),x(null);try{const G=await fetch(`${_N}/createBillingPortalSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,returnUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard`})}),ie=await G.json();if(!G.ok)throw new Error(ie.error||"Failed to open billing portal");window.location.href=ie.url}catch(G){console.error("Billing portal error:",G),x(G.message),b(!1)}},Q=[{key:"free",name:"Free",price:"$0",period:"forever",description:"Perfect for getting started",color:"slate",features:[{key:"staff",text:"1 staff member"},{key:"basicBooking",text:"Online booking"},{key:"emailNotifications",text:"Email notifications"},{key:"fee",text:"5% platform fee on deposits",negative:!0}]},{key:"pro",name:"Pro",price:"$29",period:"/month",description:"For growing businesses",color:"blue",popular:!0,features:[{key:"staff",text:"Up to 5 staff members"},{key:"basicBooking",text:"Online booking"},{key:"emailNotifications",text:"Email notifications"},{key:"aiAssistant",text:"AI booking assistant"},{key:"recurringBookings",text:"Recurring bookings"},{key:"waitlist",text:"Waitlist management"},{key:"crm",text:"Client CRM & notes"},{key:"analytics",text:"Analytics dashboard"},{key:"smsNotifications",text:"SMS notifications"},{key:"fee",text:"No platform fees",highlight:!0}]},{key:"unlimited",name:"Unlimited",price:"$79",period:"/month",description:"For established businesses",color:"violet",features:[{key:"staff",text:"Unlimited staff members"},{key:"everything",text:"Everything in Pro, plus:"},{key:"walkIns",text:"Walk-in queue management"},{key:"multiLocation",text:"Multi-location support"},{key:"noBranding",text:"Remove SpotBookie branding"},{key:"apiAccess",text:"API access"},{key:"prioritySupport",text:"Priority support"}]}];return a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:`rounded-2xl p-6 mb-8 ${w==="unlimited"?"bg-gradient-to-r from-violet-500 to-purple-600":w==="pro"?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gradient-to-r from-slate-600 to-slate-700"}`,children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:a.jsx(Uo,{className:"w-7 h-7 text-white"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("h2",{className:"text-xl font-bold text-white",children:[j.name," Plan"]}),R==="past_due"&&a.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full",children:"Payment Failed"}),U&&a.jsx("span",{className:"px-2 py-0.5 bg-amber-500 text-white text-xs font-bold rounded-full",children:"Canceling"})]}),a.jsx("p",{className:"text-white/80 text-sm mt-0.5",children:w==="free"?"Upgrade to unlock more features":U?`Access until ${V(U)}`:"Your subscription is active"})]})]}),w!=="free"&&a.jsxs("button",{onClick:z,disabled:g,className:"flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 text-white rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[g?a.jsx(sa,{className:"w-4 h-4 animate-spin"}):a.jsx(gl,{className:"w-4 h-4"}),"Manage Billing"]})]})}),m&&a.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[a.jsx(Du,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800",children:"Something went wrong"}),a.jsx("p",{className:"text-sm text-red-600",children:m})]})]}),R==="past_due"&&a.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl flex items-start gap-3",children:[a.jsx(Du,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-amber-800",children:"Payment Failed"}),a.jsx("p",{className:"text-sm text-amber-600",children:"Your last payment failed. Please update your payment method to keep your subscription active."}),a.jsx("button",{onClick:z,className:"mt-2 text-sm font-semibold text-amber-700 hover:text-amber-800 underline",children:"Update Payment Method "})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Q.map(G=>{const ie=G.key===w,he=["free","pro","unlimited"].indexOf(G.key)<["free","pro","unlimited"].indexOf(w),W=!ie&&!he;return a.jsxs("div",{className:`relative bg-white rounded-2xl border-2 p-6 transition-all ${G.popular?"border-blue-500 shadow-lg shadow-blue-500/10":ie?"border-emerald-500":"border-slate-200 hover:border-slate-300"}`,children:[G.popular&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsx("span",{className:"px-3 py-1 bg-blue-500 text-white text-xs font-bold rounded-full",children:"Most Popular"})}),ie&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsx("span",{className:"px-3 py-1 bg-emerald-500 text-white text-xs font-bold rounded-full",children:"Current Plan"})}),a.jsxs("div",{className:"text-center mb-6 pt-2",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:G.name}),a.jsxs("div",{className:"mt-2 flex items-baseline justify-center gap-1",children:[a.jsx("span",{className:"text-4xl font-extrabold text-slate-900",children:G.price}),a.jsx("span",{className:"text-slate-500 text-sm",children:G.period})]}),a.jsx("p",{className:"text-sm text-slate-500 mt-2",children:G.description})]}),a.jsx("ul",{className:"space-y-3 mb-6",children:G.features.map((T,E)=>(k9[T.key],a.jsxs("li",{className:"flex items-start gap-2.5",children:[a.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5 ${T.negative?"bg-red-100 text-red-500":T.highlight?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-600"}`,children:T.negative?a.jsx("span",{className:"text-xs font-bold",children:"%"}):a.jsx(tn,{className:"w-3 h-3"})}),a.jsx("span",{className:`text-sm ${T.negative?"text-red-600":T.highlight?"text-emerald-700 font-medium":"text-slate-700"}`,children:T.text})]},E)))}),W?a.jsx("button",{onClick:()=>L(G.key),disabled:c,className:`w-full flex items-center justify-center gap-2 py-3 rounded-xl font-semibold text-sm transition-all ${G.key==="unlimited"?"bg-gradient-to-r from-violet-500 to-purple-600 hover:from-violet-600 hover:to-purple-700 text-white shadow-lg shadow-violet-500/20":G.key==="pro"?"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg shadow-blue-500/20":"bg-slate-100 hover:bg-slate-200 text-slate-700"} disabled:opacity-50`,children:c===G.key?a.jsxs(a.Fragment,{children:[a.jsx(sa,{className:"w-4 h-4 animate-spin"}),"Redirecting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Xo,{className:"w-4 h-4"}),"Upgrade to ",G.name]})}):ie?a.jsx("div",{className:"w-full py-3 text-center text-sm font-semibold text-emerald-600 bg-emerald-50 rounded-xl border border-emerald-200",children:" Your Current Plan"}):a.jsx("div",{className:"w-full py-3 text-center text-sm font-medium text-slate-400 bg-slate-50 rounded-xl",children:"Included in your plan"})]},G.key)})}),a.jsxs("div",{className:"mt-12",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Feature Comparison"}),a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Feature"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-slate-700",children:"Free"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-blue-600",children:"Pro"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-violet-600",children:"Unlimited"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b border-slate-100",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:"Staff Members"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"1"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"5"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"Unlimited"})]}),a.jsxs("tr",{className:"border-b border-slate-100",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:"Platform Fee"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-red-500",children:"5%"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-emerald-600",children:"0%"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-emerald-600",children:"0%"})]}),Object.entries(l9).map(([G,ie])=>a.jsxs("tr",{className:"border-b border-slate-100 last:border-b-0",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:ie.name}),a.jsx("td",{className:"py-3 px-4 text-center",children:_r.free.features.includes(G)?a.jsx(tn,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})}),a.jsx("td",{className:"py-3 px-4 text-center",children:_r.pro.features.includes(G)?a.jsx(tn,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})}),a.jsx("td",{className:"py-3 px-4 text-center",children:_r.unlimited.features.includes(G)?a.jsx(tn,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})})]},G))]})]})})]}),a.jsxs("div",{className:"mt-12",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Frequently Asked Questions"}),a.jsx("div",{className:"space-y-4",children:[{q:"Can I cancel anytime?",a:"Yes! You can cancel your subscription at any time. You'll continue to have access until the end of your billing period."},{q:"What happens if I downgrade?",a:"When you downgrade, you'll keep your current plan until the end of the billing period. After that, feature limits (like staff count) will apply."},{q:"What is the platform fee?",a:"On the Free plan, we charge a 5% fee on any deposits collected through SpotBookie. Pro and Unlimited plans have no platform fees."},{q:"Do you offer refunds?",a:"We offer a 14-day money-back guarantee for first-time subscribers. Contact us if you're not satisfied."}].map((G,ie)=>a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:G.q}),a.jsx("p",{className:"text-sm text-slate-600",children:G.a})]},ie))})]})]})}const Dh="https://us-central1-scheduler-65e51.cloudfunctions.net";function R9({shopId:n,shop:e,slug:t}){const[i,o]=_.useState(e),[c,d]=_.useState(null),[m,x]=_.useState(null),[g,b]=_.useState(null);_.useEffect(()=>{if(!n)return;const W=Kt($e(ve,"shops",n),T=>{T.exists()&&o(T.data())});return()=>W()},[n]);const w=!!i?.stripeAccountId,j=i?.stripeOnboardingComplete,R=i?.payoutsEnabled;i?.stripeAccountStatus;const U=i?.subscriptionTier||"free",V=U==="free"?"5%":"0%",L=async()=>{d("create"),x(null);try{const W=await fetch(`${Dh}/createConnectAccount`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,email:i.ownerEmail,businessName:i.name})}),T=await W.json();if(!W.ok)throw new Error(T.error||"Failed to create account");(!T.alreadyExists||!i.stripeOnboardingComplete)&&await z()}catch(W){console.error("Create account error:",W),x(W.message)}finally{d(null)}},z=async()=>{d("onboard"),x(null);try{const W=await fetch(`${Dh}/createAccountLink`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,returnUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?connect=return`,refreshUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?connect=refresh`})}),T=await W.json();if(!W.ok)throw new Error(T.error||"Failed to create onboarding link");window.location.href=T.url}catch(W){console.error("Onboarding error:",W),x(W.message),d(null)}},Q=async()=>{d("dashboard"),x(null);try{const W=await fetch(`${Dh}/getConnectDashboardLink`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n})}),T=await W.json();if(!W.ok)throw new Error(T.error||"Failed to get dashboard link");window.open(T.url,"_blank")}catch(W){console.error("Dashboard link error:",W),x(W.message)}finally{d(null)}},G=async()=>{d("balance"),x(null);try{const W=await fetch(`${Dh}/getConnectBalance`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n})}),T=await W.json();if(!W.ok)throw new Error(T.error||"Failed to fetch balance");b(T)}catch(W){console.error("Balance fetch error:",W),x(W.message)}finally{d(null)}};_.useEffect(()=>{R&&!g&&G()},[R]);const ie=(W,T="usd")=>new Intl.NumberFormat("en-US",{style:"currency",currency:T.toUpperCase()}).format(W/100),he=W=>new Date(W*1e3).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Payments"}),a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:"Connect Stripe to accept deposits and get paid"})]}),w&&R&&a.jsxs("button",{onClick:G,disabled:c==="balance",className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-all",children:[c==="balance"?a.jsx(sa,{className:"w-3.5 h-3.5 animate-spin"}):a.jsx(Mu,{className:"w-3.5 h-3.5"}),"Refresh"]})]}),m&&a.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[a.jsx(Du,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800 text-sm",children:"Something went wrong"}),a.jsx("p",{className:"text-sm text-red-600",children:m})]})]}),!w&&a.jsx("div",{className:"bg-gradient-to-br from-violet-50 to-blue-50 rounded-2xl border border-violet-200 p-8",children:a.jsxs("div",{className:"flex flex-col items-center text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-lg flex items-center justify-center mb-5",children:a.jsx(yn,{className:"w-8 h-8 text-violet-600"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"Accept Payments"}),a.jsx("p",{className:"text-slate-600 max-w-md mb-6",children:"Connect your Stripe account to accept deposit payments from clients when they book. Funds are transferred directly to your bank account."}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 w-full max-w-xl mb-8",children:[{icon:Qh,label:"Secure payments",desc:"256-bit encryption"},{icon:Xo,label:"Fast payouts",desc:"2-day transfers"},{icon:Ro,label:"Low fees",desc:"2.9% + 30"}].map(({icon:W,label:T,desc:E})=>a.jsxs("div",{className:"bg-white/70 rounded-xl p-4 text-center",children:[a.jsx(W,{className:"w-5 h-5 text-violet-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm font-semibold text-slate-900",children:T}),a.jsx("p",{className:"text-xs text-slate-500",children:E})]},T))}),a.jsx("button",{onClick:L,disabled:c==="create",className:"flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-violet-600 to-blue-600 hover:from-violet-700 hover:to-blue-700 text-white rounded-xl font-bold text-base shadow-lg shadow-violet-600/25 transition-all disabled:opacity-50",children:c==="create"?a.jsxs(a.Fragment,{children:[a.jsx(sa,{className:"w-5 h-5 animate-spin"}),"Setting up..."]}):a.jsxs(a.Fragment,{children:[a.jsx(yn,{className:"w-5 h-5"}),"Connect with Stripe",a.jsx(Co,{className:"w-5 h-5"})]})}),U==="free"&&a.jsxs("p",{className:"mt-4 text-xs text-slate-500 flex items-center gap-1",children:[a.jsx(eN,{className:"w-3.5 h-3.5"}),"Free tier: ",V," platform fee on deposits.",a.jsx("a",{href:"#",className:"text-violet-600 hover:underline",children:"Upgrade to remove"})]})]})}),w&&!j&&a.jsx("div",{className:"bg-amber-50 rounded-2xl border border-amber-200 p-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(ts,{className:"w-6 h-6 text-amber-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Complete Your Setup"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Your Stripe account is created, but you need to complete the onboarding process to start accepting payments."}),a.jsx("button",{onClick:z,disabled:c==="onboard",className:"flex items-center gap-2 px-5 py-2.5 bg-amber-600 hover:bg-amber-700 text-white rounded-xl font-semibold text-sm shadow-md transition-all disabled:opacity-50",children:c==="onboard"?a.jsxs(a.Fragment,{children:[a.jsx(sa,{className:"w-4 h-4 animate-spin"}),"Redirecting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(gl,{className:"w-4 h-4"}),"Complete Setup"]})})]})]})}),w&&j&&!R&&a.jsx("div",{className:"bg-blue-50 rounded-2xl border border-blue-200 p-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(ED,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Verification in Progress"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Stripe is reviewing your account. This usually takes a few minutes. Once approved, you'll be able to accept payments."}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("button",{onClick:z,disabled:c==="onboard",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[c==="onboard"?a.jsx(sa,{className:"w-4 h-4 animate-spin"}):a.jsx(gl,{className:"w-4 h-4"}),"Check Status"]})})]})]})}),w&&R&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:a.jsx(Os,{className:"w-7 h-7"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Stripe Connected"}),a.jsx("span",{className:"px-2 py-0.5 bg-white/20 text-xs font-bold rounded-full",children:"Active"})]}),a.jsx("p",{className:"text-white/80 text-sm mt-0.5",children:"You're ready to accept deposit payments"})]})]}),a.jsxs("button",{onClick:Q,disabled:c==="dashboard",className:"flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[c==="dashboard"?a.jsx(sa,{className:"w-4 h-4 animate-spin"}):a.jsx(gl,{className:"w-4 h-4"}),"Stripe Dashboard"]})]})}),g&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Available"}),a.jsx(nN,{className:"w-4 h-4 text-emerald-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:g.balance.available[0]?ie(g.balance.available[0].amount,g.balance.available[0].currency):"$0.00"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Ready to pay out"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Pending"}),a.jsx(ts,{className:"w-4 h-4 text-blue-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:g.balance.pending[0]?ie(g.balance.pending[0].amount,g.balance.pending[0].currency):"$0.00"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Processing"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Platform Fee"}),a.jsx(Ro,{className:"w-4 h-4 text-violet-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:V}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:U==="free"?"Upgrade to remove":"No platform fees"})]})]}),g?.recentCharges?.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-bold text-slate-900",children:"Recent Payments"}),a.jsx("button",{onClick:Q,className:"text-xs font-medium text-blue-600 hover:text-blue-700",children:"View All "})]}),a.jsx("div",{className:"space-y-3",children:g.recentCharges.slice(0,5).map(W=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${W.status==="succeeded"?"bg-emerald-100":"bg-slate-100"}`,children:W.status==="succeeded"?a.jsx(Os,{className:"w-4 h-4 text-emerald-600"}):a.jsx(ts,{className:"w-4 h-4 text-slate-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:W.metadata?.clientName||"Payment"}),a.jsxs("p",{className:"text-xs text-slate-400",children:[he(W.created),W.metadata?.serviceName&&`  ${W.metadata.serviceName}`]})]})]}),a.jsx("span",{className:"text-sm font-bold text-slate-900",children:ie(W.amount,W.currency)})]},W.id))})]}),g?.recentPayouts?.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-bold text-slate-900",children:"Recent Payouts"}),a.jsx(Bo,{className:"w-4 h-4 text-slate-400"})]}),a.jsx("div",{className:"space-y-3",children:g.recentPayouts.slice(0,3).map(W=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${W.status==="paid"?"bg-emerald-100":"bg-amber-100"}`,children:a.jsx(nN,{className:`w-4 h-4 ${W.status==="paid"?"text-emerald-600":"text-amber-600"}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900 capitalize",children:W.status}),a.jsx("p",{className:"text-xs text-slate-400",children:W.arrivalDate?`Arrives ${he(W.arrivalDate)}`:he(W.created)})]})]}),a.jsx("span",{className:"text-sm font-bold text-emerald-600",children:ie(W.amount,W.currency)})]},W.id))})]})]}),a.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-5",children:[a.jsxs("h3",{className:"font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(eN,{className:"w-4 h-4 text-blue-500"}),"How it works"]}),a.jsxs("ul",{className:"space-y-2 text-sm text-slate-600",children:[a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"1"}),a.jsx("span",{children:"Client books an appointment and pays the deposit"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"2"}),a.jsxs("span",{children:["Payment goes directly to your Stripe account (minus Stripe's 2.9% + 30 fee",U==="free"&&` and ${V} platform fee`,")"]})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"3"}),a.jsx("span",{children:"Stripe automatically transfers funds to your bank (usually within 2 days)"})]})]})]})]})}const I9=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function R0(n){const[e,t]=n.split(":").map(Number);return e*60+t}function D9(n,e){if(n.status!=="waiting"||n.serviceId&&e.serviceId&&n.serviceId!==e.serviceId||n.staffId&&n.staffId!=="any"&&e.staffId&&n.staffId!==e.staffId)return!1;if(e.date){if(n.preferredDate&&n.preferredDate!==e.date)return!1;if(n.preferredDays&&n.preferredDays.length>0){const t=new Date(e.date+"T12:00:00"),i=I9[t.getDay()];if(!n.preferredDays.includes(i))return!1}}if(e.time&&n.preferredTimeRange){const t=R0(e.time),i=R0(n.preferredTimeRange.start),o=R0(n.preferredTimeRange.end);if(!(n.preferredTimeRange.start==="00:00"&&n.preferredTimeRange.end==="23:59")&&(t<i||t>o))return!1}return!0}function M9(n,e){return n.filter(t=>D9(t,e)).sort((t,i)=>(t.createdAt||"").localeCompare(i.createdAt||""))}const jN=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}];function fi(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"PM":"AM";return`${e%12||12}:${t.toString().padStart(2,"0")} ${i}`}function O9({user:n}){const{slug:e}=Ho(),t=Di(),[i,o]=QN(),[c,d]=_.useState(null),[m,x]=_.useState(null),[g,b]=_.useState(!0),[w,j]=_.useState(!1),[R,U]=_.useState([]),[V,L]=_.useState([]),[z,Q]=_.useState([]),[G,ie]=_.useState([]),he=["schedule","clients","walkins","analytics","waitlist","staff","services","subscription","settings"],W=i.get("tab"),T=he.includes(W)?W:"schedule",E=$=>{o({tab:$})},[S,I]=_.useState(null),[k,M]=_.useState("all"),[C,F]=_.useState("all"),[P,O]=_.useState([]),[K,ce]=_.useState(null),[Se,be]=_.useState(null),[B,J]=_.useState(!1),[le,pe]=_.useState({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""});_.useEffect(()=>{if(!n){t(`/shop/${e}/login`,{replace:!0});return}(async()=>{b(!0);try{const H=Ln(Ke(ve,"shops"),bn("slug","==",e)),ee=await Ms(H);if(ee.empty){j(!0),b(!1);return}const de=ee.docs[0],Te=de.data();if(Te.ownerUid!==n.uid){j(!0),b(!1);return}d(Te),x(de.id)}catch(H){console.error("Error checking ownership:",H),j(!0)}finally{b(!1)}})()},[n,e,t]),_.useEffect(()=>{if(!m)return;const $=Kt(Ke(ve,"shops",m,"availability"),Oe=>{const Ae=Oe.docs.map(je=>({id:je.id,...je.data()}));U(Ae)}),H=Kt(Ke(ve,"shops",m,"bookings"),Oe=>{const Ae=Oe.docs.map(je=>({id:je.id,...je.data()}));L(Ae)}),ee=Kt(Ke(ve,"shops",m,"staff"),Oe=>{const Ae=Oe.docs.map(je=>({id:je.id,...je.data()})).filter(je=>je.active!==!1).sort((je,Ze)=>(je.name||"").localeCompare(Ze.name||""));Q(Ae)}),de=Kt(Ke(ve,"shops",m,"waitlist"),Oe=>{const Ae=Oe.docs.map(je=>({id:je.id,...je.data()})).sort((je,Ze)=>(je.createdAt||"").localeCompare(Ze.createdAt||""));O(Ae)}),Te=Kt(Ke(ve,"shops",m,"services"),Oe=>{const Ae=Oe.docs.map(je=>({id:je.id,...je.data()})).filter(je=>je.active!==!1).sort((je,Ze)=>(je.name||"").localeCompare(Ze.name||""));ie(Ae)});return()=>{$(),H(),ee(),de(),Te()}},[m]);const xe=async()=>{await lf(ya),t(`/shop/${e}`,{replace:!0})},Me=async $=>{$.preventDefault();const{date:H,startTime:ee,endTime:de,slotDuration:Te,staffId:Oe}=le,Ae=parseInt(Te),[je,Ze]=ee.split(":").map(Number),[St,ns]=de.split(":").map(Number),as=je*60+Ze,Sn=St*60+ns;let zn=as;for(;zn+Ae<=Sn;){const ia=Math.floor(zn/60),us=zn%60,tr=`${ia.toString().padStart(2,"0")}:${us.toString().padStart(2,"0")}`,rs={date:H,time:tr,duration:Ae,available:!0};if(Oe){const Ks=z.find(is=>is.id===Oe);rs.staffId=Oe,rs.staffName=Ks?.name||""}await _a(Ke(ve,"shops",m,"availability"),rs),zn+=Ae}pe({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""})},Ge=async $=>{await ko($e(ve,"shops",m,"availability",$))},xt=$=>{const H={date:$.date,time:$.time,staffId:$.staffId||null,serviceId:$.serviceId||null},ee=M9(P,H);ee.length>0&&ce({matches:ee,slot:H})},it=async($,H)=>{for(const ee of $)await st($e(ve,"shops",m,"waitlist",ee.id),{status:"notified",notifiedAt:new Date().toISOString(),notifiedSlot:{date:H.date,time:H.time,staffId:H.staffId||null,staffName:H.staffName||null}});ce(null)},Gt=async $=>{await st($e(ve,"shops",m,"waitlist",$),{status:"notified",notifiedAt:new Date().toISOString()})},ae=async $=>{await st($e(ve,"shops",m,"waitlist",$),{status:"expired"})},_e=async $=>{const H=V.find(ee=>ee.id===$);if(H&&H.recurringGroupId){be({bookingId:$,recurringGroupId:H.recurringGroupId});return}if(await st($e(ve,"shops",m,"bookings",$),{status:"cancelled"}),H&&H.slotId&&!H.slotId.startsWith("wh-")&&!H.slotId.startsWith("recurring-"))try{await st($e(ve,"shops",m,"availability",H.slotId),{available:!0})}catch(ee){console.warn("Could not re-open slot:",ee)}H&&xt(H)},Ee=async $=>{const H=V.find(ee=>ee.id===$);if(await st($e(ve,"shops",m,"bookings",$),{status:"cancelled"}),H&&H.slotId&&!H.slotId.startsWith("wh-")&&!H.slotId.startsWith("recurring-"))try{await st($e(ve,"shops",m,"availability",H.slotId),{available:!0})}catch(ee){console.warn("Could not re-open slot:",ee)}H&&xt(H),be(null)},qe=async($,H)=>{const ee=V.find(Te=>Te.id===$);if(!ee)return;const de=V.filter(Te=>Te.recurringGroupId===H&&Te.date>=ee.date&&(Te.status==="pending"||Te.status==="confirmed"));for(const Te of de)if(await st($e(ve,"shops",m,"bookings",Te.id),{status:"cancelled"}),Te.slotId&&!Te.slotId.startsWith("wh-")&&!Te.slotId.startsWith("recurring-"))try{await st($e(ve,"shops",m,"availability",Te.slotId),{available:!0})}catch(Oe){console.warn("Could not re-open slot:",Oe)}ee&&xt(ee),be(null)},Je=async $=>{await st($e(ve,"shops",m,"bookings",$),{status:"confirmed"})},Nt=async $=>{const H=V.find(ee=>ee.id===$);if(await st($e(ve,"shops",m,"bookings",$),{status:"rejected"}),H&&H.slotId&&!H.slotId.startsWith("wh-"))try{await st($e(ve,"shops",m,"availability",H.slotId),{available:!0})}catch(ee){console.warn("Could not re-open slot:",ee)}H&&xt(H)},Vs=async()=>{const $=!c?.requireApproval;try{await st($e(ve,"shops",m),{requireApproval:$}),d(H=>({...H,requireApproval:$}))}catch(H){console.error("Error updating requireApproval:",H)}},At=async $=>{const H=parseInt($);try{await st($e(ve,"shops",m),{bufferMinutes:H}),d(ee=>({...ee,bufferMinutes:H}))}catch(ee){console.error("Error updating buffer minutes:",ee)}},ft=($,H)=>new Date(`${$}T${H}`).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),Ie=_.useMemo(()=>{const $={},H=k==="all"?z:z.filter(de=>de.id===k),ee=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(const de of H)de.weeklyHours&&ee.forEach((Te,Oe)=>{de.weeklyHours[Te]?.enabled&&($[Oe]=!0)});return $},[z,k]),Be=_.useMemo(()=>{const $={},H=k==="all"?z:z.filter(Te=>Te.id===k),ee=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],de=new Date;de.setHours(0,0,0,0);for(let Te=0;Te<60;Te++){const Oe=new Date(de);Oe.setDate(Oe.getDate()+Te);const Ae=Oe.getDay(),je=ee[Ae],Ze=`${Oe.getFullYear()}-${String(Oe.getMonth()+1).padStart(2,"0")}-${String(Oe.getDate()).padStart(2,"0")}`;for(const St of H){if(!St.weeklyHours||!St.weeklyHours[je]?.enabled)continue;const ns=St.weeklyHours[je],as=ns.breaks||(ns.break?[ns.break]:[]);as.length>0&&($[Ze]||($[Ze]=[]),$[Ze].push(...as.map(Sn=>({...Sn,staffId:St.id,staffName:St.name}))))}}return $},[z,k]),fe=_.useMemo(()=>(k==="all"?z:z.filter(H=>H.id===k)).filter(H=>H.weeklyHours?jN.some(ee=>H.weeklyHours[ee.key]?.enabled):!1),[z,k]),ze=_.useMemo(()=>{const $=new Date,H=`${$.getFullYear()}-${String($.getMonth()+1).padStart(2,"0")}-${String($.getDate()).padStart(2,"0")}`,ee=$.getDay(),de=ee===0?-6:1-ee,Te=new Date($);Te.setDate($.getDate()+de),Te.setHours(0,0,0,0);const Oe=new Date(Te);Oe.setDate(Te.getDate()+6),Oe.setHours(23,59,59,999);const Ae=`${Te.getFullYear()}-${String(Te.getMonth()+1).padStart(2,"0")}-${String(Te.getDate()).padStart(2,"0")}`,je=`${Oe.getFullYear()}-${String(Oe.getMonth()+1).padStart(2,"0")}-${String(Oe.getDate()).padStart(2,"0")}`,Ze=V.filter(as=>as.date===H).length,St=V.filter(as=>as.date>=Ae&&as.date<=je).length,ns=new Set(V.map(as=>as.clientEmail?.toLowerCase()).filter(Boolean)).size;return{todayBookings:Ze,weekBookings:St,uniqueClients:ns,totalBookings:V.length}},[V]),Ve=_.useMemo(()=>V.filter($=>$.status==="pending").length,[V]),De=_.useMemo(()=>P.filter($=>$.status==="waiting").length,[P]),[He,Ye]=_.useState(0),[Z,Ce]=_.useState({}),We=_.useMemo(()=>{if(!c)return 0;c?.winbackSettings?.warningDays;const $=c?.winbackSettings?.inactiveDays||60;if(!(c?.winbackSettings?.enabled!==!1))return 0;const ee=new Date,de=V.filter(je=>je.status==="confirmed"||je.status==="pending"||!je.status),Te={};de.forEach(je=>{const Ze=je.clientEmail?.toLowerCase();Ze&&(!Te[Ze]||je.date>Te[Ze])&&(Te[Ze]=je.date)});let Oe=0;const Ae=je=>je.replace(/\./g,"_dot_").replace(/@/g,"_at_");return Object.entries(Te).forEach(([je,Ze])=>{if(Math.floor((ee.getTime()-new Date(Ze+"T12:00:00").getTime())/864e5)>$){const ns=Ae(je);Z[ns]?.contacted||Oe++}}),Oe},[V,c,Z]);if(_.useEffect(()=>{if(!m)return;const $=Kt(Ke(ve,"shops",m,"clientNotes"),H=>{const ee={};H.docs.forEach(de=>{ee[de.id]=de.data()}),Ce(ee)});return()=>$()},[m]),_.useEffect(()=>{if(!m)return;const $=Kt(Ke(ve,"shops",m,"walkins"),H=>{const ee=H.docs.filter(de=>de.data().status==="waiting").length;Ye(ee)});return()=>$()},[m]),g)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading dashboard"})]})});if(w)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(jf,{className:"w-8 h-8 text-red-500"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Unauthorized"}),a.jsx("p",{className:"text-slate-600 mb-6",children:"You don't have access to this dashboard."}),a.jsx(at,{to:`/shop/${e}/login`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:"Login"})]})});const tt=k==="all"?R:R.filter($=>$.staffId===k),kt=k==="all"?V:V.filter($=>$.staffId===k),Lt=tt.reduce(($,H)=>($[H.date]||($[H.date]=[]),$[H.date].push(H),$),{}),_t=kt.reduce(($,H)=>($[H.date]||($[H.date]=[]),$[H.date].push(H),$),{}),ss=S?Object.keys(Lt).filter($=>$===S).sort():Object.keys(Lt).sort(),It=S?kt.filter($=>$.date===S):kt,Qs=C==="all"?It:C==="pending"?It.filter($=>$.status==="pending"):C==="confirmed"?It.filter($=>!$.status||$.status==="confirmed"):It.filter($=>$.status==="cancelled"||$.status==="rejected"),Is={all:It.length,pending:It.filter($=>$.status==="pending").length,confirmed:It.filter($=>!$.status||$.status==="confirmed").length,cancelled:It.filter($=>$.status==="cancelled"||$.status==="rejected").length},Ea=[{key:"schedule",label:"Schedule",icon:Tt},{key:"clients",label:"Clients",icon:Ag},{key:"walkins",label:"Walk-ins",icon:H2},{key:"analytics",label:"Analytics",icon:V2},{key:"waitlist",label:"Waitlist",icon:cx},{key:"staff",label:"Staff",icon:Pt},{key:"services",label:"Services",icon:Nn},{key:"subscription",label:"Plan",icon:Uo},{key:"settings",label:"Settings",icon:Wh}];return a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>J(!0),className:"lg:hidden p-2 -ml-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:a.jsx(U2,{className:"w-6 h-6"})}),a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(c.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{className:"hidden sm:block",children:[a.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:c.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),a.jsx("div",{className:"hidden lg:flex items-center bg-slate-100 p-1 rounded-xl",children:Ea.map($=>{const H=$.icon,de=$.key==="schedule"&&Ve>0?{count:Ve,color:"bg-amber-500"}:$.key==="clients"&&We>0?{count:We,color:"bg-orange-500"}:$.key==="walkins"&&He>0?{count:He,color:"bg-emerald-500"}:$.key==="waitlist"&&De>0?{count:De,color:"bg-blue-500"}:null;return a.jsxs("button",{onClick:()=>E($.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${T===$.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(H,{className:"w-4 h-4"}),a.jsx("span",{children:$.label}),de&&a.jsx("span",{className:`ml-1 px-1.5 py-0.5 ${de.color} text-white text-[10px] font-bold rounded-full leading-none`,children:de.count})]},$.key)})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(at,{to:`/shop/${e}`,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[a.jsx(vu,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"View Page"})]}),a.jsxs("button",{onClick:xe,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",children:[a.jsx(Sf,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),B&&a.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>J(!1)}),a.jsxs("div",{className:"fixed inset-y-0 left-0 w-72 bg-white shadow-2xl animate-slide-in-left",children:[a.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-slate-200",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm",children:(c.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-bold text-slate-900",children:c.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),a.jsx("button",{onClick:()=>J(!1),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",children:a.jsx(Rs,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"p-3 space-y-1",children:Ea.map($=>{const H=$.icon,de=$.key==="schedule"&&Ve>0?{count:Ve,color:"bg-amber-500"}:$.key==="clients"&&We>0?{count:We,color:"bg-orange-500"}:$.key==="walkins"&&He>0?{count:He,color:"bg-emerald-500"}:$.key==="waitlist"&&De>0?{count:De,color:"bg-blue-500"}:null;return a.jsxs("button",{onClick:()=>{E($.key),J(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left font-medium transition-all ${T===$.key?"bg-blue-50 text-blue-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,children:[a.jsx(H,{className:`w-5 h-5 ${T===$.key?"text-blue-600":"text-slate-400"}`}),a.jsx("span",{className:"flex-1",children:$.label}),de&&a.jsx("span",{className:`px-2 py-0.5 ${de.color} text-white text-xs font-bold rounded-full`,children:de.count})]},$.key)})}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 border-t border-slate-200 bg-slate-50",children:[a.jsxs(at,{to:`/shop/${e}`,onClick:()=>J(!1),className:"flex items-center gap-3 px-4 py-3 text-slate-600 hover:bg-white rounded-xl font-medium transition-all",children:[a.jsx(vu,{className:"w-5 h-5 text-slate-400"}),"View Public Page"]}),a.jsxs("button",{onClick:()=>{J(!1),xe()},className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl font-medium transition-all",children:[a.jsx(Sf,{className:"w-5 h-5"}),"Logout"]})]})]})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[T==="schedule"&&a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8 animate-fade-in",children:[{label:"Today's Bookings",value:ze.todayBookings,icon:Z1,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:ze.weekBookings,icon:Bo,color:"bg-violet-100 text-violet-600"},{label:"Total Bookings",value:ze.totalBookings,icon:Eg,color:"bg-emerald-100 text-emerald-600"},{label:"Unique Clients",value:ze.uniqueClients,icon:Pt,color:"bg-amber-100 text-amber-600"}].map($=>{const H=$.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${$.color} rounded-xl flex items-center justify-center`,children:a.jsx(H,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:$.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:$.label})]},$.label)})}),T==="clients"&&a.jsx(T9,{shopId:m,bookings:V,shop:c,slug:e}),T==="walkins"&&a.jsx(j9,{shopId:m,services:G,staff:z,bookings:V}),T==="analytics"&&a.jsx(v9,{bookings:V}),T==="staff"&&a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:a.jsx(b9,{shopId:m,shop:c,slug:e})}),T==="services"&&a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:a.jsx(n9,{shopId:m})}),T==="subscription"&&a.jsx(C9,{shopId:m,shop:c,slug:e}),K&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(_o,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Waitlist Match!"}),a.jsxs("p",{className:"text-sm text-slate-500",children:[K.matches.length," client",K.matches.length!==1?"s":""," on the waitlist match this freed slot"]})]})]}),a.jsx("div",{className:"bg-slate-50 rounded-xl p-3 mb-4 text-sm",children:a.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[a.jsx(Tt,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-medium",children:[new Date(K.slot.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})," at ",(()=>{const[$,H]=K.slot.time.split(":"),ee=parseInt($);return`${ee%12||12}:${H} ${ee>=12?"PM":"AM"}`})()]})]})}),a.jsx("div",{className:"space-y-2 mb-5 max-h-48 overflow-y-auto",children:K.matches.map($=>a.jsx("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-50 border border-blue-100 rounded-lg",children:a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:$.clientName}),a.jsx("span",{className:"text-xs text-slate-500 ml-2",children:$.serviceName})]})},$.id))}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>it(K.matches,K.slot),className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:[a.jsx(_o,{className:"w-4 h-4"}),"Notify All"]}),a.jsx("button",{onClick:()=>ce(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Dismiss"})]})]})}),Se&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center",children:a.jsx(Si,{className:"w-5 h-5 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Cancel Recurring Booking"}),a.jsx("p",{className:"text-sm text-slate-500",children:"This booking is part of a recurring series"})]})]}),a.jsxs("div",{className:"space-y-2 mb-5",children:[a.jsxs("button",{onClick:()=>Ee(Se.bookingId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(qa,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this one only"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments stay active"})]})]}),a.jsxs("button",{onClick:()=>qe(Se.bookingId,Se.recurringGroupId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(Si,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future in series"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments"})]})]})]}),a.jsx("button",{onClick:()=>be(null),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Never mind"})]})}),T==="waitlist"&&a.jsx("div",{className:"animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-5",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Waitlist"}),De>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:[De," waiting"]})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[P.length," total"]})]}),P.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(cx,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No waitlist entries yet"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Clients can join the waitlist when no slots are available on your booking page."})]}):a.jsx("div",{children:(()=>{const $={};return P.forEach(H=>{const ee=H.serviceName||"Other";$[ee]||($[ee]=[]),$[ee].push(H)}),Object.entries($).sort(([H],[ee])=>H.localeCompare(ee)).map(([H,ee])=>a.jsxs("div",{className:"mb-6 last:mb-0",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100 flex items-center gap-2",children:[a.jsx(Nn,{className:"w-3.5 h-3.5 text-blue-500"}),H,a.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",ee.filter(de=>de.status==="waiting").length," waiting)"]})]}),a.jsx("div",{className:"space-y-2.5",children:ee.sort((de,Te)=>(de.createdAt||"").localeCompare(Te.createdAt||"")).map(de=>{const Te={waiting:"bg-blue-50 text-blue-700 border-blue-200",notified:"bg-emerald-50 text-emerald-700 border-emerald-200",booked:"bg-emerald-50 text-emerald-700 border-emerald-200",expired:"bg-slate-100 text-slate-500 border-slate-200"},Oe={waiting:"Waiting",notified:"Notified",booked:"Booked",expired:"Removed"},Ae=de.createdAt?(()=>{const Ze=Date.now()-new Date(de.createdAt).getTime(),St=Math.floor(Ze/864e5),ns=Math.floor(Ze/36e5);return St>0?`${St}d`:`${ns}h`})():"",je={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return a.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(jl,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:de.clientName}),a.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Te[de.status]||Te.waiting}`,children:Oe[de.status]||"Waiting"})]}),a.jsxs("div",{className:"text-xs text-slate-500",children:["Joined ",Ae," ago",de.refCode&&a.jsx("span",{className:"font-mono text-slate-400 ml-2",children:de.refCode})]})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[de.status==="waiting"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>Gt(de.id),className:"p-1.5 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-all",title:"Notify client",children:a.jsx(_o,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>ae(de.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove from waitlist",children:a.jsx(Rs,{className:"w-4 h-4"})})]}),de.status==="notified"&&a.jsx("button",{onClick:()=>ae(de.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove",children:a.jsx(Rs,{className:"w-3.5 h-3.5"})})]})]}),a.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[de.staffName&&de.staffName!=="Any Available"&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Pt,{className:"w-3 h-3 text-violet-400"}),a.jsx("span",{className:"text-violet-600",children:de.staffName})]}),de.preferredDate&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Tt,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Preferred: ",new Date(de.preferredDate+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]})]}),de.preferredDays&&de.preferredDays.length>0&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Tt,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Days: ",de.preferredDays.map(Ze=>je[Ze]||Ze).join(", ")]})]}),de.preferredTimeRange&&!(de.preferredTimeRange.start==="00:00"&&de.preferredTimeRange.end==="23:59")&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(ts,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Time: ",fi(de.preferredTimeRange.start),"",fi(de.preferredTimeRange.end)]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Ef,{className:"w-3 h-3"}),de.clientEmail]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(dx,{className:"w-3 h-3"}),de.clientPhone]})]}),de.status==="notified"&&de.notifiedSlot&&a.jsxs("div",{className:"mt-1.5 px-2.5 py-1.5 bg-emerald-50 border border-emerald-200 rounded-lg inline-flex items-center gap-1.5",children:[a.jsx(_o,{className:"w-3 h-3 text-emerald-500"}),a.jsxs("span",{className:"text-emerald-700 font-medium",children:["Notified about ",new Date(de.notifiedSlot.date+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})," at ",fi(de.notifiedSlot.time)]})]})]})]},de.id)})})]},H))})()})]})}),T==="settings"&&a.jsxs("div",{className:"max-w-2xl animate-fade-in space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Settings"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure your booking preferences"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Require Booking Approval"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Review and approve bookings before they're confirmed"})]}),a.jsx("button",{type:"button",onClick:Vs,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${c?.requireApproval?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${c?.requireApproval?"translate-x-6":"translate-x-1"}`})})]}),c?.requireApproval&&a.jsxs("div",{className:"p-3.5 bg-amber-50 border border-amber-200 rounded-xl text-xs text-amber-800 leading-relaxed",children:[a.jsx("strong",{children:" Approval mode is on."}),' New bookings will appear as "Pending" until you approve or reject them. Time slots are held while pending to prevent double-booking.']}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Buffer Time Between Bookings"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Add a gap between consecutive appointments"})]}),a.jsxs("select",{value:c?.bufferMinutes||0,onChange:$=>At($.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"0",children:"No buffer"}),a.jsx("option",{value:"5",children:"5 minutes"}),a.jsx("option",{value:"10",children:"10 minutes"}),a.jsx("option",{value:"15",children:"15 minutes"}),a.jsx("option",{value:"30",children:"30 minutes"})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Retention"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure win-back alerts to re-engage inactive clients"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Enable Win-back Alerts"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Show alerts when clients haven't visited in a while"})]}),a.jsx("button",{type:"button",onClick:async()=>{const $=c?.winbackSettings||{},H=$.enabled===!1;try{await st($e(ve,"shops",m),{winbackSettings:{...$,enabled:H}}),d(ee=>({...ee,winbackSettings:{...ee.winbackSettings||{},enabled:H}}))}catch(ee){console.error("Error updating winback settings:",ee)}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${c?.winbackSettings?.enabled!==!1?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${c?.winbackSettings?.enabled!==!1?"translate-x-6":"translate-x-1"}`})})]}),c?.winbackSettings?.enabled!==!1&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Getting Cold Threshold"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "Getting Cold" after this many days without a booking'})]}),a.jsxs("select",{value:c?.winbackSettings?.warningDays||30,onChange:async $=>{const H=parseInt($.target.value),ee=c?.winbackSettings||{};try{await st($e(ve,"shops",m),{winbackSettings:{...ee,warningDays:H}}),d(de=>({...de,winbackSettings:{...de.winbackSettings||{},warningDays:H}}))}catch(de){console.error("Error updating warning days:",de)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"14",children:"14 days"}),a.jsx("option",{value:"21",children:"21 days"}),a.jsx("option",{value:"30",children:"30 days"}),a.jsx("option",{value:"45",children:"45 days"}),a.jsx("option",{value:"60",children:"60 days"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"At Risk Threshold"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "At Risk" after this many days without a booking'})]}),a.jsxs("select",{value:c?.winbackSettings?.inactiveDays||60,onChange:async $=>{const H=parseInt($.target.value),ee=c?.winbackSettings||{};try{await st($e(ve,"shops",m),{winbackSettings:{...ee,inactiveDays:H}}),d(de=>({...de,winbackSettings:{...de.winbackSettings||{},inactiveDays:H}}))}catch(de){console.error("Error updating inactive days:",de)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"30",children:"30 days"}),a.jsx("option",{value:"45",children:"45 days"}),a.jsx("option",{value:"60",children:"60 days"}),a.jsx("option",{value:"90",children:"90 days"}),a.jsx("option",{value:"120",children:"120 days"})]})]}),a.jsxs("div",{className:"p-3.5 bg-orange-50 border border-orange-200 rounded-xl text-xs text-orange-800 leading-relaxed",children:[a.jsx("strong",{children:" Tip:"}),' Clients flagged as "Lost" (over 90 days) will also appear in win-back alerts. Visit the ',a.jsx("strong",{children:"Clients"})," tab to view at-risk clients and send win-back messages."]})]})]})]}),a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:a.jsx(R9,{shopId:m,shop:c,slug:e})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Visibility"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Temporarily hide your shop from public view"}),c?.archived?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(yu,{className:"w-5 h-5 text-amber-600"}),a.jsx("span",{className:"font-semibold text-amber-800",children:"Shop is Archived"})]}),a.jsx("p",{className:"text-sm text-amber-700",children:"Your shop is currently hidden from the public booking page. You can still access your dashboard to view history."})]}),a.jsxs("button",{onClick:async()=>{try{await st($e(ve,"shops",m),{archived:!1,archivedAt:null}),d($=>({...$,archived:!1,archivedAt:null}))}catch($){console.error("Error unarchiving shop:",$)}},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-emerald-600/20 transition-all",children:[a.jsx(yu,{className:"w-4 h-4"}),"Unarchive Shop"]})]}):a.jsxs("button",{onClick:async()=>{if(window.confirm("Are you sure you want to archive your shop? It will be hidden from the public booking page."))try{await st($e(ve,"shops",m),{archived:!0,archivedAt:ji()}),d($=>({...$,archived:!0,archivedAt:new Date().toISOString()}))}catch($){console.error("Error archiving shop:",$)}},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-amber-500 hover:bg-amber-600 text-white rounded-xl font-semibold text-sm shadow-md shadow-amber-500/20 transition-all",children:[a.jsx(yu,{className:"w-4 h-4"}),"Archive Shop"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-3",children:"Archiving hides your shop but preserves all data. You can unarchive at any time."})]}),a.jsxs("div",{className:"bg-white rounded-xl border-2 border-red-200 p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(na,{className:"w-5 h-5 text-red-500"}),a.jsx("h2",{className:"text-lg font-bold text-red-600",children:"Danger Zone"})]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Irreversible actions that will permanently affect your shop"}),a.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl mb-4",children:[a.jsx("h3",{className:"font-semibold text-red-800 mb-2",children:"Delete Shop Permanently"}),a.jsxs("p",{className:"text-sm text-red-700 mb-3",children:["This will permanently delete your shop, all staff, bookings, time slots, and settings.",a.jsx("strong",{children:" This cannot be undone."})]}),a.jsxs("button",{onClick:()=>{const $=new Date().toISOString().split("T")[0],H=V.filter(de=>de.date>=$&&(de.status==="pending"||de.status==="confirmed"||!de.status));if(H.length>0){alert(`Cannot delete shop: You have ${H.length} upcoming booking${H.length!==1?"s":""}. Please cancel or complete all upcoming bookings before deleting your shop.`);return}const ee=window.prompt(`To delete your shop, type "${c.name}" below:

 WARNING: This will permanently delete:
 Your shop and all settings
 All staff members
 All bookings (past and future)
 All time slots
 All waitlist entries
 All schedule presets`);ee===c.name?(async()=>{try{const Te=["staff","bookings","availability","waitlist","schedulePresets","services","walkins","clientNotes"];for(const Oe of Te){const Ae=await Ms(Ke(ve,"shops",m,Oe));for(const je of Ae.docs)await ko($e(ve,"shops",m,Oe,je.id))}await ko($e(ve,"shops",m)),await lf(ya),t("/",{replace:!0})}catch(Te){console.error("Error deleting shop:",Te),alert("An error occurred while deleting the shop. Please try again.")}})():ee!==null&&alert("Shop name did not match. Deletion cancelled.")},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-red-600/20 transition-all",children:[a.jsx(ga,{className:"w-4 h-4"}),"Delete Shop Forever"]})]})]})]}),T==="schedule"&&a.jsxs("div",{className:"animate-fade-in",children:[z.length>0&&a.jsx("div",{className:"flex flex-wrap gap-4 mb-6",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5",children:"Filter by Staff"}),a.jsxs("select",{value:k,onChange:$=>M($.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[a.jsx("option",{value:"all",children:"All Staff"}),z.map($=>a.jsxs("option",{value:$.id,children:[$.name,$.role?`  ${$.role}`:""]},$.id))]})]})}),fe.length>0&&a.jsxs("div",{className:"mb-6 bg-violet-50 border border-violet-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Mu,{className:"w-4 h-4 text-violet-600"}),a.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Recurring Weekly Hours"})]}),a.jsx("div",{className:"space-y-2.5",children:fe.map($=>{const H=jN.filter(ee=>$.weeklyHours[ee.key]?.enabled);return a.jsxs("div",{className:"flex items-start gap-2.5",children:[a.jsx("div",{className:"w-7 h-7 bg-violet-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(Pt,{className:"w-3.5 h-3.5 text-violet-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-900 text-sm",children:$.name}),a.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:H.map(ee=>{const de=$.weeklyHours[ee.key];return a.jsxs("span",{className:"inline-block px-2 py-0.5 bg-white text-violet-700 border border-violet-200 rounded text-xs font-medium",children:[ee.short," ",fi(de.start),"",fi(de.end),de.break&&a.jsxs("span",{className:"text-amber-600 ml-1",children:["(break ",fi(de.break.start),"",fi(de.break.end),")"]})]},ee.key)})})]})]},$.id)})}),a.jsx("p",{className:"text-xs text-violet-500 mt-3",children:"Slots auto-generate on the booking page. Manage hours in the Staff tab."})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Monthly Overview"}),a.jsx(e9,{slotsByDate:Lt,bookingsByDate:_t,selectedDate:S,onSelectDate:I,recurringDayFlags:Ie,breaksByDate:Be}),S&&a.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[a.jsxs("span",{className:"text-sm text-slate-600",children:["Showing: ",a.jsx("strong",{className:"text-slate-900",children:new Date(S+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),a.jsx("button",{onClick:()=>I(null),className:"text-xs px-3 py-1 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-medium transition-all border border-slate-200",children:"Show All"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:fe.length>0?"Add Custom Slots":"Create Time Slots"}),fe.length>0&&a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Use this for one-off availability outside regular hours."}),!fe.length&&a.jsx("div",{className:"mb-4"}),a.jsxs("form",{onSubmit:Me,className:"space-y-4",children:[z.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Staff Member"}),a.jsxs("select",{value:le.staffId,onChange:$=>pe({...le,staffId:$.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"Select a staff member"}),z.map($=>a.jsxs("option",{value:$.id,children:[$.name,$.role?`  ${$.role}`:""]},$.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Date"}),a.jsx("input",{type:"date",value:le.date,onChange:$=>pe({...le,date:$.target.value}),required:!0,min:new Date().toISOString().split("T")[0],className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Start"}),a.jsx("input",{type:"time",value:le.startTime,onChange:$=>pe({...le,startTime:$.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"End"}),a.jsx("input",{type:"time",value:le.endTime,onChange:$=>pe({...le,endTime:$.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Slot Duration"}),(()=>{const[$,H]=le.startTime.split(":").map(Number),[ee,de]=le.endTime.split(":").map(Number),Te=ee*60+de-($*60+H),Oe=[{value:"15",label:"15 minutes"},{value:"30",label:"30 minutes"},{value:"45",label:"45 minutes"},{value:"60",label:"1 hour"},{value:"90",label:"1.5 hours"},{value:"120",label:"2 hours"}].filter(Ae=>parseInt(Ae.value)<=Te);return a.jsx("select",{value:le.slotDuration,onChange:Ae=>pe({...le,slotDuration:Ae.target.value}),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:Oe.length>0?Oe.map(Ae=>a.jsx("option",{value:Ae.value,children:Ae.label},Ae.value)):a.jsx("option",{value:"15",children:"15 minutes"})})})()]}),a.jsxs("button",{type:"submit",className:"w-full flex items-center justify-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(Za,{className:"w-4 h-4"}),"Generate Slots"]})]}),a.jsxs("div",{className:"mt-4 p-3.5 bg-blue-50 border border-blue-100 rounded-xl text-xs text-slate-600 leading-relaxed",children:[a.jsx("strong",{className:"text-slate-700",children:" Tip:"})," ",fe.length>0?"Weekly hours auto-generate slots. Use this for one-off slots outside regular hours.":z.length>0?"Select a staff member, pick a date, and set working hours to create slots.":"Set your hours and slot duration. We'll create all the time slots for that day."]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:S?"Bookings":"All Bookings"}),Is.pending>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 border border-amber-200 text-xs font-bold rounded-full",children:[Is.pending," pending"]})]}),a.jsx("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:Qs.length})]}),a.jsx("div",{className:"flex items-center gap-1 mb-4 p-1 bg-slate-100 rounded-lg overflow-x-auto",children:[{key:"all",label:"All"},{key:"pending",label:"Pending"},{key:"confirmed",label:"Confirmed"},{key:"cancelled",label:"Cancelled"}].map($=>a.jsxs("button",{onClick:()=>F($.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-semibold transition-all whitespace-nowrap ${C===$.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[$.label,a.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${C===$.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:Is[$.key]})]},$.key))}),Qs.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Z1,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium",children:C!=="all"?`No ${C} bookings`:S?"No bookings for this date":"No bookings yet"})]}):a.jsx("div",{className:"space-y-2.5 max-h-[500px] overflow-y-auto pr-1",children:Qs.sort(($,H)=>`${$.date}${$.time}`.localeCompare(`${H.date}${H.time}`)).map($=>{const H=$.status||"confirmed",ee={pending:"bg-amber-50 text-amber-700 border-amber-200",confirmed:"bg-emerald-50 text-emerald-700 border-emerald-200",rejected:"bg-red-50 text-red-700 border-red-200",cancelled:"bg-slate-100 text-slate-500 border-slate-200"},de={pending:"Pending",confirmed:"Confirmed",rejected:"Rejected",cancelled:"Cancelled"};return a.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(jl,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:$.clientName}),a.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${ee[H]}`,children:de[H]}),$.recurring&&a.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",title:"Recurring appointment",children:a.jsx(Si,{className:"w-2.5 h-2.5"})})]}),a.jsx("div",{className:"text-xs text-slate-500",children:ft($.date,$.time)})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[H==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>Je($.id),className:"p-1.5 text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50 rounded-lg transition-all",title:"Approve booking",children:a.jsx(tn,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Nt($.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Reject booking",children:a.jsx(qa,{className:"w-4 h-4"})})]}),H==="confirmed"&&a.jsx("button",{onClick:()=>_e($.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Cancel booking",children:a.jsx(ga,{className:"w-3.5 h-3.5"})})]})]}),a.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[$.serviceName&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Nn,{className:"w-3 h-3 text-blue-400"}),a.jsx("span",{className:"font-medium text-slate-700",children:$.serviceName}),$.servicePrice!=null&&a.jsxs("span",{className:"text-blue-600 font-semibold",children:["$",Number($.servicePrice).toFixed(2)]})]}),$.staffName&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Pt,{className:"w-3 h-3 text-violet-400"}),a.jsx("span",{className:"text-violet-600",children:$.staffName})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Ef,{className:"w-3 h-3"}),$.clientEmail]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(dx,{className:"w-3 h-3"}),$.clientPhone]})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[$.refCode&&a.jsxs("span",{className:"font-mono text-[10px] text-slate-400",children:["REF: ",$.refCode]}),$.recurring&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-indigo-50 border border-indigo-200 rounded text-[10px] font-semibold text-indigo-600",children:" Recurring"})]})]})]},$.id)})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:S?"Custom Time Slots":"All Custom Time Slots"}),a.jsx("span",{className:"text-xs font-semibold text-slate-500 bg-slate-100 px-2.5 py-1 rounded-lg",children:S?(Lt[S]||[]).length:tt.length})]}),fe.length>0&&a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Recurring slots from weekly hours auto-generate  not shown here."}),!fe.length&&a.jsx("div",{className:"mb-4"}),ss.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Tt,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:S?"No custom slots for this date":"No custom slots yet"}),a.jsx("p",{className:"text-xs text-slate-400",children:fe.length>0?"Recurring hours handle most scheduling.":"Use the form above to generate availability."})]}):a.jsx("div",{className:"space-y-6",children:ss.map($=>a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100",children:new Date($).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-2.5",children:Lt[$].sort((H,ee)=>H.time.localeCompare(ee.time)).map(H=>a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-3.5 text-center group hover:border-slate-300 transition-all",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900 mb-0.5",children:fi(H.time)}),a.jsxs("div",{className:"text-xs text-slate-500 mb-1",children:[H.duration," min"]}),H.staffName&&a.jsxs("div",{className:"text-xs text-violet-600 mb-1.5 flex items-center justify-center gap-1",children:[a.jsx(Pt,{className:"w-3 h-3"}),H.staffName]}),a.jsx("div",{className:"mb-2",children:H.available?a.jsx("span",{className:"inline-block px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-md text-xs font-medium",children:"Available"}):a.jsx("span",{className:"inline-block px-2 py-0.5 bg-red-50 text-red-700 border border-red-200 rounded-md text-xs font-medium",children:"Booked"})}),H.available&&a.jsxs("button",{onClick:()=>Ge(H.id),className:"opacity-0 group-hover:opacity-100 flex items-center justify-center gap-1 w-full px-2 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-xs font-medium transition-all border border-red-200",children:[a.jsx(ga,{className:"w-3 h-3"}),"Remove"]})]},H.id))})]},$))})]})]})]})]})}function P9({user:n}){const{slug:e}=Ho(),t=Di(),[i,o]=_.useState(""),[c,d]=_.useState(""),[m,x]=_.useState(""),[g,b]=_.useState(!1);_.useEffect(()=>{if(!n)return;(async()=>{const R=Ln(Ke(ve,"shops"),bn("slug","==",e)),U=await Ms(R);U.empty||U.docs[0].data().ownerUid===n.uid&&t(`/shop/${e}/dashboard`,{replace:!0})})()},[n,e,t]);const w=async j=>{j.preventDefault(),x(""),b(!0);try{const U=(await Mx(ya,i,c)).user,V=Ln(Ke(ve,"shops"),bn("slug","==",e)),L=await Ms(V);if(L.empty){x("Shop not found"),b(!1);return}if(L.docs[0].data().ownerUid!==U.uid){x("You are not the owner of this shop"),await ya.signOut(),b(!1);return}t(`/shop/${e}/dashboard`,{replace:!0})}catch(R){switch(R.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":x("Invalid email or password");break;case"auth/invalid-email":x("Please enter a valid email address");break;case"auth/too-many-requests":x("Too many failed attempts. Please try again later.");break;default:x("Login failed. Please try again.")}d("")}finally{b(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(va,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),a.jsxs("form",{onSubmit:w,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:i,onChange:j=>{o(j.target.value),x("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:c,onChange:j=>{d(j.target.value),x("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${m?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),m&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",m]})]}),a.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):"Sign In"})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",a.jsx(at,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(at,{to:`/shop/${e}`,className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(xa,{className:"w-3.5 h-3.5"}),"Back to booking page"]})})]})})}function SN({name:n,className:e="w-12 h-12",bgClass:t="bg-blue-100 text-blue-700"}){const i=(n||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return a.jsx("div",{className:`${e} ${t} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function EN(){return a.jsxs(at,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(va,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function V9(){const{slug:n,refCode:e}=Ho(),[t,i]=_.useState(null),[o,c]=_.useState(null),[d,m]=_.useState(!0),[x,g]=_.useState(!1),[b,w]=_.useState(null),[j,R]=_.useState(null),[U,V]=_.useState(!1),[L,z]=_.useState([]),[Q,G]=_.useState([]),[ie,he]=_.useState([]),[W,T]=_.useState([]),[E,S]=_.useState(!1),[I,k]=_.useState(!1),[M,C]=_.useState(null),[F,P]=_.useState(null),[O,K]=_.useState(null),[ce,Se]=_.useState(!1),[be,B]=_.useState("");_.useEffect(()=>{(async()=>{m(!0);try{const Be=Ln(Ke(ve,"shops"),bn("slug","==",n)),fe=await Ms(Be);if(fe.empty)g(!0);else{const ze=fe.docs[0];i(ze.data()),c(ze.id)}}catch(Be){console.error("Error looking up shop:",Be),g(!0)}finally{m(!1)}})()},[n]),_.useEffect(()=>{if(!o)return;(async()=>{try{const Be=Ln(Ke(ve,"shops",o,"bookings"),bn("refCode","==",e.toUpperCase())),fe=await Ms(Be);if(fe.empty)V(!0);else{const ze=fe.docs[0];w(ze.data()),R(ze.id)}}catch(Be){console.error("Error looking up booking:",Be),V(!0)}})()},[o,e]),_.useEffect(()=>{if(!o||!b)return;const Ie=Kt(Ke(ve,"shops",o,"bookings"),Ve=>{z(Ve.docs.map(De=>({id:De.id,...De.data()})))}),Be=Kt(Ke(ve,"shops",o,"availability"),Ve=>{const De=new Date,He=Ve.docs.map(Ye=>({id:Ye.id,...Ye.data()})).filter(Ye=>new Date(`${Ye.date}T${Ye.time}`)>De);G(He)}),fe=Kt(Ke(ve,"shops",o,"staff"),Ve=>{he(Ve.docs.map(De=>({id:De.id,...De.data()})).filter(De=>De.active!==!1).sort((De,He)=>(De.name||"").localeCompare(He.name||"")))}),ze=Kt(Ke(ve,"shops",o,"services"),Ve=>{T(Ve.docs.map(De=>({id:De.id,...De.data()})).filter(De=>De.active!==!1))});return()=>{Ie(),Be(),fe(),ze()}},[o,b]);const J=t?.bufferMinutes||0,le=_.useMemo(()=>{if(!b)return null;if(b.serviceId){const Ie=W.find(Be=>Be.id===b.serviceId);if(Ie)return Ie}return b.serviceName?{id:b.serviceId,name:b.serviceName,price:b.servicePrice,duration:b.serviceDuration||b.duration}:null},[b,W]),pe=_.useMemo(()=>{if(!E||!b)return[];const Ie=new Date,Be=le?.duration||b.duration||60;let fe=Q.filter(Ye=>Ye.available);fe=fe.filter(Ye=>Ye.duration>=Be),b.staffId&&(fe=fe.filter(Ye=>Ye.staffId===b.staffId||!Ye.staffId));const ze=b.staffId?ie.filter(Ye=>Ye.id===b.staffId):ie,Ve=aS(ze,Be,J,4).filter(Ye=>new Date(`${Ye.date}T${Ye.time}`)>Ie),De=iS(Ve,fe),He=L.filter(Ye=>Ye.id!==j);return rS(De,He,J)},[E,b,j,Q,ie,L,J,le]),xe=_.useMemo(()=>[...new Set(pe.map(Ie=>Ie.date))].sort(),[pe]),Me=_.useMemo(()=>F?pe.filter(Ie=>Ie.date===F):[],[F,pe]),Ge=async(Ie="single")=>{Se(!0);try{if(await st($e(ve,"shops",o,"bookings",j),{status:"cancelled"}),b.slotId&&!b.slotId.startsWith("wh-")&&!b.slotId.startsWith("recurring-"))try{await st($e(ve,"shops",o,"availability",b.slotId),{available:!0})}catch(Be){console.warn("Could not re-open slot:",Be)}if(Ie==="future"&&b.recurringGroupId){const Be=L.filter(fe=>fe.recurringGroupId===b.recurringGroupId&&fe.id!==j&&fe.date>=b.date&&(fe.status==="pending"||fe.status==="confirmed"));for(const fe of Be)if(await st($e(ve,"shops",o,"bookings",fe.id),{status:"cancelled"}),fe.slotId&&!fe.slotId.startsWith("wh-")&&!fe.slotId.startsWith("recurring-"))try{await st($e(ve,"shops",o,"availability",fe.slotId),{available:!0})}catch(ze){console.warn("Could not re-open slot:",ze)}}w(Be=>({...Be,status:"cancelled"})),k(!1),C(null),B("cancelled")}catch(Be){console.error("Cancel error:",Be),B("error")}finally{Se(!1)}},xt=async()=>{if(O){Se(!0);try{const Ie={date:O.date,time:O.time,slotId:O.id};if(O.staffId&&(Ie.staffId=O.staffId,Ie.staffName=O.staffName||""),t?.requireApproval&&(Ie.status="pending"),b.slotId&&!b.slotId.startsWith("wh-"))try{await st($e(ve,"shops",o,"availability",b.slotId),{available:!0})}catch(Be){console.warn("Could not re-open old slot:",Be)}if(!O.generated&&O.id)try{await st($e(ve,"shops",o,"availability",O.id),{available:!1})}catch(Be){console.warn("Could not block new slot:",Be)}await st($e(ve,"shops",o,"bookings",j),Ie),w(Be=>({...Be,...Ie})),S(!1),P(null),K(null),B("rescheduled")}catch(Ie){console.error("Reschedule error:",Ie),B("error")}finally{Se(!1)}}},it=Ie=>new Date(Ie+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),Gt=Ie=>{const[Be,fe]=Ie.split(":"),ze=parseInt(Be),Ve=ze>=12?"PM":"AM";return`${ze%12||12}:${fe} ${Ve}`},ae=Ie=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(Ie),_e=Ie=>{if(!Ie)return"";if(Ie<60)return`${Ie} min`;const Be=Math.floor(Ie/60),fe=Ie%60;return fe?`${Be}h ${fe}m`:`${Be} hour${Be>1?"s":""}`};if(d)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(x)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Tt,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(xa,{className:"w-4 h-4"}),"Go Home"]})]})});if(U)return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),a.jsx(EN,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(na,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Not Found"}),a.jsx("p",{className:"text-slate-600 mb-2",children:"No booking found with reference code"}),a.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Tt,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking"})]})});const Ee=b.status||"confirmed",qe=Ee==="pending"||Ee==="confirmed",Je=Ee==="cancelled",Nt=Ee==="rejected",Vs={pending:{label:"Pending Approval",color:"bg-amber-100 text-amber-700 border-amber-200",icon:ts},confirmed:{label:"Confirmed",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Os},cancelled:{label:"Cancelled",color:"bg-slate-100 text-slate-500 border-slate-200",icon:qa},rejected:{label:"Rejected",color:"bg-red-100 text-red-700 border-red-200",icon:qa}},At=Vs[Ee]||Vs.confirmed,ft=At.icon;return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),a.jsx(EN,{})]})}),a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[be==="rescheduled"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(B2,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Rescheduled!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:t?.requireApproval?"Your booking has been rescheduled and is pending approval.":"Your booking has been successfully rescheduled."}),a.jsx("button",{onClick:()=>B(""),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View updated details "})]})}),be==="cancelled"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(qa,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Cancelled"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking has been cancelled."}),a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[a.jsx(Tt,{className:"w-4 h-4"}),"Book a new appointment"]})]})}),be==="error"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Something went wrong. Please try again."})]})}),!E&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Your Booking"}),a.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference: ",a.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),(Je||Nt)&&a.jsxs("div",{className:`mb-4 p-4 rounded-xl border flex items-center gap-3 ${Je?"bg-slate-50 border-slate-200":"bg-red-50 border-red-200"}`,children:[a.jsx(ft,{className:`w-5 h-5 ${Je?"text-slate-400":"text-red-500"}`}),a.jsx("span",{className:`font-medium text-sm ${Je?"text-slate-600":"text-red-700"}`,children:Je?"This booking has been cancelled.":"This booking has been rejected by the shop."})]}),b.recurringGroupId&&a.jsxs("div",{className:"mb-4 p-3.5 bg-blue-50 border border-blue-200 rounded-xl flex items-center gap-2.5",children:[a.jsx(Si,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Part of a recurring series"}),b.recurringInterval&&a.jsxs("p",{className:"text-xs text-blue-600 mt-0.5",children:["Repeats every ",b.recurringInterval==="weekly"?"week":b.recurringInterval==="biweekly"?"2 weeks":b.recurringInterval==="fourweekly"?"4 weeks":b.recurringInterval==="monthly"?"month":b.recurringInterval]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${At.color}`,children:[a.jsx(ft,{className:"w-3.5 h-3.5"}),At.label]})]}),b.serviceName&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Nn,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.servicePrice!=null&&a.jsx("span",{className:"font-bold text-blue-600",children:ae(b.servicePrice)})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(SN,{name:b.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Tt,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[it(b.date)," at ",Gt(b.time)]})]}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(ts,{className:"w-4 h-4 text-slate-500"})}),a.jsx("span",{children:_e(b.serviceDuration||b.duration)})]})]}),qe&&!be&&a.jsx("div",{className:"space-y-3",children:I?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(na,{className:"w-5 h-5 text-red-500"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-slate-900",children:"Are you sure?"}),a.jsx("p",{className:"text-sm text-slate-600",children:"This action cannot be undone."})]})]}),b.recurringGroupId&&!M&&a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsxs("button",{onClick:()=>C("single"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(qa,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this appointment only"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments in the series remain active"})]})]}),a.jsxs("button",{onClick:()=>C("future"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(Si,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future appointments"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments in the series"})]})]}),a.jsx("button",{onClick:()=>k(!1),className:"w-full px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Go Back"})]}),(!b.recurringGroupId||M)&&a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>Ge(M||"single"),disabled:ce,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold transition-all disabled:opacity-50",children:[ce?a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}):a.jsx(qa,{className:"w-4 h-4"}),ce?"Cancelling":M==="future"?"Cancel All Future":"Yes, Cancel"]}),a.jsx("button",{onClick:()=>{M?C(null):k(!1)},disabled:ce,className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Go Back"})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{S(!0),B("")},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(Mu,{className:"w-4 h-4"}),"Reschedule Booking"]}),a.jsxs("button",{onClick:()=>{k(!0),C(null)},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-white hover:bg-red-50 text-red-600 rounded-xl font-semibold border border-red-200 hover:border-red-300 transition-all",children:[a.jsx(qa,{className:"w-4 h-4"}),"Cancel Booking"]})]})}),(Je||Nt)&&a.jsx("div",{className:"text-center",children:a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(Tt,{className:"w-4 h-4"}),"Book Again"]})})]}),E&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:()=>{S(!1),P(null),K(null)},className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(xa,{className:"w-3.5 h-3.5"}),"Back to Booking"]}),b.serviceName&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Nn,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName}),b.servicePrice!=null&&a.jsx("span",{className:"text-blue-600 font-bold",children:ae(b.servicePrice)})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[a.jsx(SN,{name:b.staffName,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a New Time"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Pick a new date and time for your appointment"})]}),xe.length===0?a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(Tt,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),a.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"No time slots are currently available. Check back soon!"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-8",children:a.jsx(G2,{availableDates:xe,selectedDate:F,onSelectDate:Ie=>{P(Ie),K(null)}})}),F&&a.jsxs("div",{className:"animate-slide-down",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",it(F)]}),a.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[Me.length," slot",Me.length!==1?"s":""]})]}),Me.length===0?a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:a.jsx("p",{className:"text-slate-500",children:"No slots available for this date"})}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:Me.sort((Ie,Be)=>Ie.time.localeCompare(Be.time)).map(Ie=>{const Be=O?.id===Ie.id;return a.jsxs("button",{onClick:()=>K(Ie),className:`group border rounded-xl p-4 transition-all duration-200 text-center ${Be?"bg-blue-600 border-blue-600 text-white shadow-md shadow-blue-600/30":"bg-white border-slate-200 hover:border-blue-400 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5"}`,children:[a.jsx("div",{className:`text-lg font-bold mb-1 ${Be?"text-white":"text-slate-900 group-hover:text-blue-700"} transition-colors`,children:Gt(Ie.time)}),Ie.staffName&&a.jsxs("div",{className:`text-xs mb-0.5 flex items-center justify-center gap-1 ${Be?"text-blue-100":"text-violet-600"}`,children:[a.jsx(Pt,{className:"w-3 h-3"}),Ie.staffName]}),a.jsx("div",{className:`text-xs ${Be?"text-blue-200":"text-slate-400"}`,children:_e(b.serviceDuration||b.duration)})]},Ie.id)})}),O&&a.jsxs("div",{className:"mt-6 animate-fade-in",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-blue-200 shadow-sm p-5 mb-4",children:[a.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"New Appointment Time"}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm",children:[a.jsx(Tt,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[it(O.date)," at ",Gt(O.time)]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:xt,disabled:ce,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed",children:ce?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Rescheduling"]}):a.jsxs(a.Fragment,{children:[a.jsx(Os,{className:"w-4 h-4"}),"Confirm Reschedule"]})}),a.jsx("button",{onClick:()=>K(null),className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]})]}),!F&&a.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]})]}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(at,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})})]})}function TN(){return a.jsxs(at,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(va,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function L9(n){if(!n)return"Any time";const e=t=>{const[i,o]=t.split(":").map(Number),c=i>=12?"PM":"AM",d=i%12||12;return o===0?`${d}${c}`:`${d}:${o.toString().padStart(2,"0")}${c}`};return n.start==="00:00"&&n.end==="23:59"?"Any time":`${e(n.start)}  ${e(n.end)}`}function U9(n){if(!n||n.length===0)return"Any day";const e={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return n.map(t=>e[t]||t).join(", ")}function B9(n){if(!n)return"";const e=new Date,t=new Date(n),i=e-t,o=Math.floor(i/6e4);if(o<60)return`${o}m ago`;const c=Math.floor(o/60);return c<24?`${c}h ago`:`${Math.floor(c/24)}d ago`}function z9(){const{slug:n,refCode:e}=Ho(),[t,i]=_.useState(null),[o,c]=_.useState(null),[d,m]=_.useState(!0),[x,g]=_.useState(!1),[b,w]=_.useState(null),[j,R]=_.useState(!1),[U,V]=_.useState(null);if(_.useEffect(()=>{(async()=>{m(!0);try{const W=Ln(Ke(ve,"shops"),bn("slug","==",n)),T=await Ms(W);if(T.empty)g(!0);else{const E=T.docs[0];i(E.data()),c(E.id)}}catch(W){console.error("Error looking up shop:",W),g(!0)}finally{m(!1)}})()},[n]),_.useEffect(()=>{if(!o)return;(async()=>{try{const W=Ln(Ke(ve,"shops",o,"waitlist"),bn("refCode","==",e.toUpperCase())),T=await Ms(W);if(T.empty){R(!0);return}const E=T.docs[0],S={id:E.id,...E.data()};w(S);const I=Ln(Ke(ve,"shops",o,"waitlist"),bn("serviceId","==",S.serviceId),bn("status","==","waiting")),C=(await Ms(I)).docs.map(F=>({id:F.id,...F.data()})).sort((F,P)=>(F.createdAt||"").localeCompare(P.createdAt||"")).findIndex(F=>F.id===S.id);C>=0&&V(C+1)}catch(W){console.error("Error looking up waitlist entry:",W),R(!0)}})()},[o,e]),d)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(x)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Tt,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(xa,{className:"w-4 h-4"}),"Go Home"]})]})});if(j)return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),a.jsx(TN,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(na,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Waitlist Entry Not Found"}),a.jsx("p",{className:"text-slate-600 mb-2",children:"No waitlist entry found with reference code"}),a.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Tt,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading waitlist"})]})});const L={waiting:{label:"Waiting",color:"bg-blue-100 text-blue-700 border-blue-200",icon:ts},notified:{label:"Slot Available!",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:_o},booked:{label:"Booked",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Os},expired:{label:"Expired",color:"bg-slate-100 text-slate-500 border-slate-200",icon:ts}},z=L[b.status]||L.waiting,Q=z.icon,G=he=>he?new Date(he+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):"",ie=he=>{if(!he)return"";const[W,T]=he.split(":"),E=parseInt(W),S=E>=12?"PM":"AM";return`${E%12||12}:${T} ${S}`};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),a.jsx(TN,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[b.status==="notified"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(_o,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"A Slot Is Available!"}),a.jsxs("p",{className:"text-slate-600 mb-4",children:["A slot has opened up for ",b.serviceName,". Book now before it's taken!"]}),b.notifiedSlot&&a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-xl text-sm text-emerald-700 font-medium mb-4",children:[a.jsx(Tt,{className:"w-4 h-4"}),G(b.notifiedSlot.date)," at"," ",ie(b.notifiedSlot.time),b.notifiedSlot.staffName&&a.jsxs("span",{className:"text-emerald-600",children:[" ","with ",b.notifiedSlot.staffName]})]}),a.jsx("div",{children:a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-emerald-600/20 hover:shadow-lg",children:[a.jsx(Tt,{className:"w-4 h-4"}),"Book Now "]})})]})}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Waitlist Status"}),a.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference:"," ",a.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${z.color}`,children:[a.jsx(Q,{className:"w-3.5 h-3.5"}),z.label]})]}),b.status==="waiting"&&U!=null&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Position"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(cx,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-bold text-slate-900 text-lg",children:["#",U]}),a.jsx("span",{className:"text-sm text-slate-500",children:"in line"})]})]}),b.serviceName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Nn,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center",children:a.jsx(Pt,{className:"w-4 h-4 text-violet-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),b.preferredDate&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Tt,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Preferred: ",G(b.preferredDate)]})]}),b.preferredDays&&b.preferredDays.length>0&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Tt,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Days: ",U9(b.preferredDays)]})]}),b.preferredTimeRange&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(ts,{className:"w-4 h-4 text-slate-500"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Time: ",L9(b.preferredTimeRange)]})]}),b.createdAt&&a.jsxs("div",{className:"pt-2 border-t border-slate-100 text-xs text-slate-400",children:["Joined ",B9(b.createdAt)]})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(at,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(Tt,{className:"w-4 h-4"}),b.status==="notified"?"Book Now":"Check Available Slots"]})})]})}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(at,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})})]})}function F9(){return a.jsxs(at,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(va,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function AN(n){if(n==null)return"";if(n<1)return"Next up!";if(n<60)return`~${n} min`;const e=Math.floor(n/60),t=n%60;return t>0?`~${e}h ${t}m`:`~${e}h`}function $9(){const{slug:n}=Ho(),[e,t]=_.useState(null),[i,o]=_.useState(null),[c,d]=_.useState(!0),[m,x]=_.useState(!1),[g,b]=_.useState([]),[w,j]=_.useState([]),[R,U]=_.useState([]),[V,L]=_.useState(!1),[z,Q]=_.useState(!1),[G,ie]=_.useState(!1),[he,W]=_.useState(""),[T,E]=_.useState(0),[S,I]=_.useState({clientName:"",serviceId:""}),[k,M]=_.useState(Date.now());_.useEffect(()=>{const be=setInterval(()=>M(Date.now()),3e4);return()=>clearInterval(be)},[]),_.useEffect(()=>{(async()=>{d(!0);try{const B=Ln(Ke(ve,"shops"),bn("slug","==",n)),J=await Ms(B);if(J.empty)x(!0);else{const le=J.docs[0];t(le.data()),o(le.id)}}catch(B){console.error("Error looking up shop:",B),x(!0)}finally{d(!1)}})()},[n]),_.useEffect(()=>{if(!i)return;const be=Kt(Ke(ve,"shops",i,"walkins"),le=>{const pe=le.docs.map(xe=>({id:xe.id,...xe.data()}));b(pe)}),B=Kt(Ke(ve,"shops",i,"staff"),le=>{const pe=le.docs.map(xe=>({id:xe.id,...xe.data()})).filter(xe=>xe.active!==!1);j(pe)}),J=Kt(Ke(ve,"shops",i,"services"),le=>{const pe=le.docs.map(xe=>({id:xe.id,...xe.data()})).filter(xe=>xe.active!==!1).sort((xe,Me)=>(xe.name||"").localeCompare(Me.name||""));U(pe)});return()=>{be(),B(),J()}},[i]);const C=_.useMemo(()=>g.filter(be=>be.status==="waiting").sort((be,B)=>(be.position||0)-(B.position||0)),[g]),F=_.useMemo(()=>g.filter(be=>be.status==="in-progress"),[g]),P=_.useMemo(()=>Math.max(w.length,1),[w]),O=_.useMemo(()=>cS({waitingQueue:C,inProgress:F,staffCount:P,defaultDuration:30}),[C,F,P]),K=_.useMemo(()=>oS({waitingAhead:C,inProgress:F,staffCount:P,defaultDuration:30}),[C,F,P]),ce=_.useMemo(()=>{const be=new Date;return be.setHours(0,0,0,0),g.filter(B=>{const J=B.joinedAt?.toDate?.()||(B.joinedAt?new Date(B.joinedAt):null);return J&&J>=be}).length},[g]),Se=async be=>{be.preventDefault(),Q(!0);const B=R.find(xe=>xe.id===S.serviceId),le=(C.length>0?Math.max(...C.map(xe=>xe.position||0)):0)+1,pe=S.clientName.trim()||`Walk-in #${ce+1}`;try{await _a(Ke(ve,"shops",i,"walkins"),{clientName:pe,serviceId:S.serviceId||null,serviceName:B?.name||null,staffId:null,staffName:null,estimatedDuration:B?.duration||30,status:"waiting",position:le,joinedAt:Ot.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),W(pe),E(le),ie(!0),L(!1),I({clientName:"",serviceId:""})}catch(xe){console.error("Error joining queue:",xe)}finally{Q(!1)}};return c?a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):m?a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Tt,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(at,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(xa,{className:"w-4 h-4"}),"Go Home"]})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Live Queue"})]})]}),a.jsx(F9,{})]})}),a.jsxs("div",{className:"max-w-2xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[G&&a.jsxs("div",{className:"mb-6 bg-emerald-50 border border-emerald-200 rounded-2xl p-6 text-center animate-scale-in",children:[a.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(Pt,{className:"w-7 h-7 text-emerald-600"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"You're in the queue!"}),a.jsxs("p",{className:"text-slate-600 text-sm mb-2",children:[a.jsx("strong",{children:he}),"  Position #",T]}),a.jsx("button",{onClick:()=>ie(!1),className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"Dismiss"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Pt,{className:"w-6 h-6 text-blue-600"})}),a.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:C.length}),a.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"People Waiting"})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(q2,{className:"w-6 h-6 text-amber-600"})}),a.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:AN(K)}),a.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"Est. Wait (New)"})]})]}),F.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(Scissors,{className:"w-5 h-5 text-emerald-500"}),"Currently Being Served"]}),a.jsx("div",{className:"space-y-2",children:F.map(be=>a.jsxs("div",{className:"bg-white rounded-xl border border-emerald-200 p-4 flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:a.jsx(Scissors,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-slate-900",children:be.clientName}),a.jsx("div",{className:"text-xs text-slate-500",children:be.serviceName||"Service in progress"})]})]},be.id))})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(ts,{className:"w-5 h-5 text-blue-500"}),"Queue"]}),C.length===0?a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-10 text-center",children:[a.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Pt,{className:"w-7 h-7 text-emerald-500"})}),a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"No Wait!"}),a.jsx("p",{className:"text-sm text-slate-500",children:"The queue is empty  you can walk right in!"})]}):a.jsx("div",{className:"space-y-2",children:C.map((be,B)=>{const J=O.get(be.id);return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4 flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center font-extrabold text-blue-700 text-lg flex-shrink-0",children:B+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-semibold text-slate-900 text-lg truncate",children:be.clientName}),be.serviceName&&a.jsxs("div",{className:"text-sm text-slate-500 flex items-center gap-1",children:[a.jsx(Nn,{className:"w-3 h-3"}),be.serviceName]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsx("div",{className:"text-lg font-bold text-amber-600",children:AN(J)}),a.jsx("div",{className:"text-xs text-slate-400",children:"est. wait"})]})]},be.id)})})]}),!G&&a.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:V?a.jsxs("form",{onSubmit:Se,children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Join the Queue"}),a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Your Name"}),a.jsx("input",{type:"text",value:S.clientName,onChange:be=>I(B=>({...B,clientName:be.target.value})),placeholder:"Optional",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg"})]}),R.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Service"}),a.jsxs("select",{value:S.serviceId,onChange:be=>I(B=>({...B,serviceId:be.target.value})),className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg",children:[a.jsx("option",{value:"",children:"Select a service"}),R.map(be=>a.jsxs("option",{value:be.id,children:[be.name," (",be.duration,"min  $",Number(be.price).toFixed(2),")"]},be.id))]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{type:"submit",disabled:z,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[a.jsx(Za,{className:"w-5 h-5"}),z?"Joining":"Join Queue"]}),a.jsx("button",{type:"button",onClick:()=>{L(!1),I({clientName:"",serviceId:""})},className:"px-6 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]}):a.jsxs("button",{onClick:()=>L(!0),className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[a.jsx(Za,{className:"w-5 h-5"}),"Join the Queue"]})})]}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-between",children:[a.jsxs(at,{to:`/shop/${n}`,className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[a.jsx(Tt,{className:"w-4 h-4"}),"Book Online"]}),a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(at,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})]})})]})}const q9="type.googleapis.com/google.protobuf.Int64Value",H9="type.googleapis.com/google.protobuf.UInt64Value";function uS(n,e){const t={};for(const i in n)n.hasOwnProperty(i)&&(t[i]=e(n[i]));return t}function Af(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>Af(e));if(typeof n=="function"||typeof n=="object")return uS(n,e=>Af(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Fo(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case q9:case H9:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Fo(e)):typeof n=="function"||typeof n=="object"?uS(n,e=>Fo(e)):n}const Rg="functions";const kN={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class vn extends Sa{constructor(e,t,i){super(`${Rg}/${e}`,t||""),this.details=i,Object.setPrototypeOf(this,vn.prototype)}}function G9(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function kf(n,e){let t=G9(n),i=t,o;try{const c=e&&e.error;if(c){const d=c.status;if(typeof d=="string"){if(!kN[d])return new vn("internal","internal");t=kN[d],i=d}const m=c.message;typeof m=="string"&&(i=m),o=c.details,o!==void 0&&(o=Fo(o))}}catch{}return t==="ok"?null:new vn(t,i,o)}class Y9{constructor(e,t,i,o){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,xn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=i.getImmediate({optional:!0}),this.auth||t.get().then(c=>this.auth=c,()=>{}),this.messaging||i.get().then(c=>this.messaging=c,()=>{}),this.appCheck||o?.get().then(c=>this.appCheck=c,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),i=await this.getMessagingToken(),o=await this.getAppCheckToken(e);return{authToken:t,messagingToken:i,appCheckToken:o}}}const px="us-central1",W9=/^data: (.*?)(?:\n|$)/;function Q9(n){let e=null;return{promise:new Promise((t,i)=>{e=setTimeout(()=>{i(new vn("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class K9{constructor(e,t,i,o,c=px,d=(...m)=>fetch(...m)){this.app=e,this.fetchImpl=d,this.emulatorOrigin=null,this.contextProvider=new Y9(e,t,i,o),this.cancelAllRequests=new Promise(m=>{this.deleteService=()=>Promise.resolve(m())});try{const m=new URL(c);this.customDomain=m.origin+(m.pathname==="/"?"":m.pathname),this.region=px}catch{this.customDomain=null,this.region=c}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function X9(n,e,t){const i=er(e);n.emulatorOrigin=`http${i?"s":""}://${e}:${t}`,i&&(Df(n.emulatorOrigin+"/backends"),Mf("Functions",!0))}function J9(n,e,t){const i=o=>eP(n,e,o,{});return i.stream=(o,c)=>sP(n,e,o,c),i}function dS(n){return n.emulatorOrigin&&er(n.emulatorOrigin)?"include":void 0}async function Z9(n,e,t,i,o){t["Content-Type"]="application/json";let c;try{c=await i(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:dS(o)})}catch{return{status:0,json:null}}let d=null;try{d=await c.json()}catch{}return{status:c.status,json:d}}async function hS(n,e){const t={},i=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return i.authToken&&(t.Authorization="Bearer "+i.authToken),i.messagingToken&&(t["Firebase-Instance-ID-Token"]=i.messagingToken),i.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=i.appCheckToken),t}function eP(n,e,t,i){const o=n._url(e);return tP(n,o,t,i)}async function tP(n,e,t,i){t=Af(t);const o={data:t},c=await hS(n,i),d=i.timeout||7e4,m=Q9(d),x=await Promise.race([Z9(e,o,c,n.fetchImpl,n),m.promise,n.cancelAllRequests]);if(m.cancel(),!x)throw new vn("cancelled","Firebase Functions instance was deleted.");const g=kf(x.status,x.json);if(g)throw g;if(!x.json)throw new vn("internal","Response is not valid JSON object.");let b=x.json.data;if(typeof b>"u"&&(b=x.json.result),typeof b>"u")throw new vn("internal","Response is missing data field.");return{data:Fo(b)}}function sP(n,e,t,i){const o=n._url(e);return nP(n,o,t,i||{})}async function nP(n,e,t,i){t=Af(t);const o={data:t},c=await hS(n,i);c["Content-Type"]="application/json",c.Accept="text/event-stream";let d;try{d=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(o),headers:c,signal:i?.signal,credentials:dS(n)})}catch(j){if(j instanceof Error&&j.name==="AbortError"){const U=new vn("cancelled","Request was cancelled.");return{data:Promise.reject(U),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(U)}}}}}}const R=kf(0,null);return{data:Promise.reject(R),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(R)}}}}}}let m,x;const g=new Promise((j,R)=>{m=j,x=R});i?.signal?.addEventListener("abort",()=>{const j=new vn("cancelled","Request was cancelled.");x(j)});const b=d.body.getReader(),w=aP(b,m,x,i?.signal);return{stream:{[Symbol.asyncIterator](){const j=w.getReader();return{async next(){const{value:R,done:U}=await j.read();return{value:R,done:U}},async return(){return await j.cancel(),{done:!0,value:void 0}}}}},data:g}}function aP(n,e,t,i){const o=(d,m)=>{const x=d.match(W9);if(!x)return;const g=x[1];try{const b=JSON.parse(g);if("result"in b){e(Fo(b.result));return}if("message"in b){m.enqueue(Fo(b.message));return}if("error"in b){const w=kf(0,b);m.error(w),t(w);return}}catch(b){if(b instanceof vn){m.error(b),t(b);return}}},c=new TextDecoder;return new ReadableStream({start(d){let m="";return x();async function x(){if(i?.aborted){const g=new vn("cancelled","Request was cancelled");return d.error(g),t(g),Promise.resolve()}try{const{value:g,done:b}=await n.read();if(b){m.trim()&&o(m.trim(),d),d.close();return}if(i?.aborted){const j=new vn("cancelled","Request was cancelled");d.error(j),t(j),await n.cancel();return}m+=c.decode(g,{stream:!0});const w=m.split(`
`);m=w.pop()||"";for(const j of w)j.trim()&&o(j.trim(),d);return x()}catch(g){const b=g instanceof vn?g:kf(0,null);d.error(b),t(b)}}},cancel(){return n.cancel()}})}const CN="@firebase/functions",RN="0.13.1";const rP="auth-internal",iP="app-check-internal",lP="messaging-internal";function oP(n){const e=(t,{instanceIdentifier:i})=>{const o=t.getProvider("app").getImmediate(),c=t.getProvider(rP),d=t.getProvider(lP),m=t.getProvider(iP);return new K9(o,c,d,m,i)};Ei(new Ar(Rg,e,"PUBLIC").setMultipleInstances(!0)),aa(CN,RN,n),aa(CN,RN,"esm2020")}function cP(n=Of(),e=px){const i=Uu(Xt(n),Rg).getImmediate({identifier:e}),o=Sx("functions");return o&&uP(i,...o),i}function uP(n,e,t){X9(Xt(n),e,t)}function dP(n,e,t){return J9(Xt(n),e)}oP();const hP=cP(),fP=["aaron.sharp2011@gmail.com"],au={free:0,pro:29,unlimited:79},dl={free:{label:"Free",color:"bg-slate-100 text-slate-700 border-slate-200"},pro:{label:"Pro",color:"bg-blue-100 text-blue-700 border-blue-200"},unlimited:{label:"Unlimited",color:"bg-violet-100 text-violet-700 border-violet-200"}};function mP({user:n}){const e=Di(),[t,i]=QN(),[o,c]=_.useState(!0),[d,m]=_.useState([]),[x,g]=_.useState([]),b=["overview","shops","users","revenue","support"],w=t.get("tab"),j=b.includes(w)?w:"overview",R=Z=>{i({tab:Z})},[U,V]=_.useState(""),[L,z]=_.useState(null),[Q,G]=_.useState(null),[ie,he]=_.useState(null),[W,T]=_.useState(""),[E,S]=_.useState({}),[I,k]=_.useState(!1),[M,C]=_.useState(null),[F,P]=_.useState(!0),[O,K]=_.useState(!1),[ce,Se]=_.useState(""),[be,B]=_.useState(""),[J,le]=_.useState(""),[pe,xe]=_.useState(""),[Me,Ge]=_.useState(!1),[xt,it]=_.useState(!1),Gt=n&&fP.includes(n.email?.toLowerCase());_.useEffect(()=>{!n||!Gt||ae()},[n,Gt]);const ae=async()=>{c(!0);try{const Ce=(await Ms(Ke(ve,"shops"))).docs.map(kt=>({id:kt.id,...kt.data()}));m(Ce);const tt=(await Ms(Ke(ve,"users"))).docs.map(kt=>({id:kt.id,...kt.data()}));g(tt)}catch(Z){console.error("Error fetching admin data:",Z)}finally{c(!1)}},_e=async()=>{await lf(ya),e("/",{replace:!0})},Ee=_.useMemo(()=>{const Z={free:0,pro:0,unlimited:0};let Ce=0,We=0;d.forEach(_t=>{const ss=_t.subscriptionTier||"free";Z[ss]=(Z[ss]||0)+1,_t.stripeConnectAccountId&&(_t.stripeConnectComplete?Ce++:We++)});const tt=Z.pro*au.pro+Z.unlimited*au.unlimited,kt=new Date;kt.setDate(kt.getDate()-30);const Lt=d.filter(_t=>_t.createdAt?(_t.createdAt.toDate?_t.createdAt.toDate():new Date(_t.createdAt))>kt:!1);return{totalShops:d.length,tierCounts:Z,mrr:tt,stripeConnectedCount:Ce,stripePendingCount:We,recentShops:Lt.length}},[d]),qe=_.useMemo(()=>{if(!U.trim())return d;const Z=U.toLowerCase();return d.filter(Ce=>Ce.name?.toLowerCase().includes(Z)||Ce.slug?.toLowerCase().includes(Z)||Ce.ownerEmail?.toLowerCase().includes(Z))},[d,U]),Je=_.useMemo(()=>[...qe].sort((Z,Ce)=>{const We=Z.createdAt?.toDate?Z.createdAt.toDate():new Date(Z.createdAt||0);return(Ce.createdAt?.toDate?Ce.createdAt.toDate():new Date(Ce.createdAt||0))-We}),[qe]),Nt=async(Z,Ce)=>{G(Z);try{await st($e(ve,"shops",Z),{subscriptionTier:Ce}),m(We=>We.map(tt=>tt.id===Z?{...tt,subscriptionTier:Ce}:tt))}catch(We){console.error("Error changing tier:",We)}finally{G(null)}},Vs=async(Z,Ce)=>{G(Z);try{await st($e(ve,"shops",Z),{disabled:!Ce}),m(We=>We.map(tt=>tt.id===Z?{...tt,disabled:!Ce}:tt))}catch(We){console.error("Error toggling shop status:",We)}finally{G(null)}},At=async(Z,Ce)=>{G(Z);try{await st($e(ve,"shops",Z),{archived:!Ce,archivedAt:Ce?null:ji()}),m(We=>We.map(tt=>tt.id===Z?{...tt,archived:!Ce,archivedAt:Ce?null:new Date().toISOString()}:tt)),L?.id===Z&&z(We=>({...We,archived:!Ce}))}catch(We){console.error("Error toggling shop archive status:",We)}finally{G(null)}},ft=async Z=>{try{const Ce=await Ms(Ke(ve,"shops",Z,"bookings")),We=new Date().toISOString().split("T")[0],tt=Ce.docs.filter(kt=>{const Lt=kt.data();return Lt.date>=We&&(Lt.status==="pending"||Lt.status==="confirmed"||!Lt.status)});return S(kt=>({...kt,[Z]:tt.length})),tt.length}catch(Ce){return console.error("Error checking bookings:",Ce),0}},Ie=async Z=>{G(Z);try{const Ce=["staff","bookings","availability","waitlist","schedulePresets","services","walkins","clientNotes"];for(const We of Ce){const tt=await Ms(Ke(ve,"shops",Z,We));for(const kt of tt.docs)await ko($e(ve,"shops",Z,We,kt.id))}await ko($e(ve,"shops",Z)),m(We=>We.filter(tt=>tt.id!==Z)),z(null),he(null),T(""),k(!1)}catch(Ce){console.error("Error deleting shop:",Ce),alert("An error occurred while deleting the shop. Please try again.")}finally{G(null)}},Be=async Z=>{K(!0);try{const We=await dP(hP,"adminDeleteUser")({userId:Z,deleteShops:F});if(We.data.success){if(g(tt=>tt.filter(kt=>kt.id!==Z)),F&&We.data.shopsDeleted>0){const tt=await Ms(Ke(ve,"shops"));m(tt.docs.map(kt=>({id:kt.id,...kt.data()})))}C(null),P(!0),alert(`User deleted successfully. ${We.data.shopsDeleted} shop(s) deleted.`)}}catch(Ce){console.error("Error deleting user:",Ce),alert(Ce.message||"Failed to delete user")}finally{K(!1)}},fe=Z=>d.filter(Ce=>Ce.ownerId===Z),ze=_.useMemo(()=>{if(!ce)return x;const Z=ce.toLowerCase();return x.filter(Ce=>Ce.email?.toLowerCase().includes(Z)||Ce.displayName?.toLowerCase().includes(Z)||Ce.id.toLowerCase().includes(Z))},[x,ce]),Ve=Z=>Z?(Z.toDate?Z.toDate():new Date(Z)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",De=Z=>Z.stripeConnectAccountId?Z.stripeConnectComplete?{label:"Connected",color:"bg-emerald-100 text-emerald-700",icon:Os}:{label:"Pending",color:"bg-amber-100 text-amber-700",icon:ts}:{label:"None",color:"bg-slate-100 text-slate-500",icon:null},He=async Z=>{Z.preventDefault(),xe(""),Ge(!0);try{await Mx(ya,be,J)}catch(Ce){console.error("Login error:",Ce),Ce.code==="auth/user-not-found"||Ce.code==="auth/wrong-password"||Ce.code==="auth/invalid-credential"?xe("Invalid email or password"):Ce.code==="auth/invalid-email"?xe("Invalid email address"):xe(Ce.message)}finally{Ge(!1)}};if(!n)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-violet-600 to-purple-600 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-violet-600/30 mx-auto mb-4",children:a.jsx(Qh,{className:"w-8 h-8"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Admin Access"}),a.jsx("p",{className:"text-slate-500 text-sm",children:"Sign in with your admin credentials"})]}),a.jsxs("form",{onSubmit:He,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:be,onChange:Z=>B(Z.target.value),placeholder:"admin@example.com",required:!0,className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:J,onChange:Z=>le(Z.target.value),placeholder:"",required:!0,className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),pe&&a.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-600",children:pe}),a.jsx("button",{type:"submit",disabled:Me,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-violet-600 hover:bg-violet-700 disabled:bg-violet-400 text-white rounded-xl font-semibold transition-all shadow-lg shadow-violet-600/20",children:Me?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Sign In"})]})]})});if(!Gt)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-6",children:a.jsx(J1,{className:"w-8 h-8 text-red-600"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Access Denied"}),a.jsx("p",{className:"text-slate-500 mb-2",children:"You don't have permission to access the admin panel."}),a.jsxs("p",{className:"text-sm text-slate-400 mb-6",children:["Signed in as: ",n.email]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>lf(ya),className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all",children:"Sign Out"}),a.jsx("button",{onClick:()=>e("/"),className:"flex-1 px-5 py-3 bg-violet-600 hover:bg-violet-700 text-white rounded-xl font-semibold text-sm transition-all",children:"Go Home"})]})]})});if(o)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading admin panel"})]})});if(!Gt)return null;const Ye=[{key:"overview",label:"Overview",icon:V2},{key:"shops",label:"Shops",icon:vr},{key:"users",label:"Users",icon:Pt},{key:"revenue",label:"Revenue",icon:Ro},{key:"support",label:"Support",icon:Wh}];return a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"h-14 sm:h-16 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[a.jsx("button",{onClick:()=>it(!0),className:"lg:hidden p-2 -ml-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:a.jsx(U2,{className:"w-6 h-6"})}),a.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-violet-600 to-purple-600 rounded-lg sm:rounded-xl flex items-center justify-center text-white shadow-md shadow-violet-600/20 flex-shrink-0",children:a.jsx(Qh,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h1",{className:"text-sm sm:text-base font-bold text-slate-900 leading-tight truncate",children:"Admin"}),a.jsx("p",{className:"text-xs text-slate-500 hidden sm:block",children:"Platform Management"})]})]}),a.jsx("div",{className:"hidden lg:flex items-center bg-slate-100 p-1 rounded-xl",children:Ye.map(Z=>{const Ce=Z.icon;return a.jsxs("button",{onClick:()=>R(Z.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${j===Z.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(Ce,{className:"w-4 h-4"}),a.jsx("span",{children:Z.label})]},Z.key)})}),a.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 flex-shrink-0",children:[a.jsxs("button",{onClick:ae,className:"flex items-center justify-center gap-1.5 p-2 sm:px-3.5 sm:py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all",title:"Refresh",children:[a.jsx(Mu,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),a.jsxs("button",{onClick:_e,className:"flex items-center justify-center gap-1.5 p-2 sm:px-3.5 sm:py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",title:"Logout",children:[a.jsx(Sf,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),xt&&a.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>it(!1)}),a.jsxs("div",{className:"fixed inset-y-0 left-0 w-72 bg-white shadow-2xl animate-slide-in-left",children:[a.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-slate-200",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-violet-600 to-purple-600 rounded-xl flex items-center justify-center text-white shadow-md",children:a.jsx(Qh,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-bold text-slate-900",children:"Admin Panel"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Platform Management"})]})]}),a.jsx("button",{onClick:()=>it(!1),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",children:a.jsx(Rs,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"p-3 space-y-1",children:Ye.map(Z=>{const Ce=Z.icon;return a.jsxs("button",{onClick:()=>{R(Z.key),it(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left font-medium transition-all ${j===Z.key?"bg-violet-50 text-violet-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,children:[a.jsx(Ce,{className:`w-5 h-5 ${j===Z.key?"text-violet-600":"text-slate-400"}`}),a.jsx("span",{children:Z.label})]},Z.key)})}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 border-t border-slate-200 bg-slate-50",children:[a.jsxs("button",{onClick:()=>{it(!1),ae()},className:"w-full flex items-center gap-3 px-4 py-3 text-slate-600 hover:bg-white rounded-xl font-medium transition-all",children:[a.jsx(Mu,{className:"w-5 h-5 text-slate-400"}),"Refresh Data"]}),a.jsxs("button",{onClick:()=>{it(!1),_e()},className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl font-medium transition-all",children:[a.jsx(Sf,{className:"w-5 h-5"}),"Logout"]})]})]})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[j==="overview"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(vr,{className:"w-5 h-5 text-blue-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Ee.totalShops}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Shops"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:a.jsx(Ro,{className:"w-5 h-5 text-emerald-600"})})}),a.jsxs("div",{className:"text-2xl font-extrabold text-slate-900",children:["$",Ee.mrr]}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Monthly Recurring Revenue"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-violet-100 rounded-xl flex items-center justify-center",children:a.jsx(yn,{className:"w-5 h-5 text-violet-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Ee.stripeConnectedCount}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Stripe Connected"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center",children:a.jsx(Bo,{className:"w-5 h-5 text-amber-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:Ee.recentShops}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"New (Last 30 Days)"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Uo,{className:"w-5 h-5 text-amber-500"}),"Subscription Tiers"]}),a.jsx("div",{className:"space-y-4",children:Object.entries(Ee.tierCounts).map(([Z,Ce])=>{const We=dl[Z]||dl.free,tt=Ee.totalShops>0?Math.round(Ce/Ee.totalShops*100):0;return a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-24",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-bold border ${We.color}`,children:We.label})}),a.jsx("div",{className:"flex-1",children:a.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full transition-all ${Z==="free"?"bg-slate-400":Z==="pro"?"bg-blue-500":"bg-violet-500"}`,style:{width:`${tt}%`}})})}),a.jsxs("div",{className:"w-20 text-right",children:[a.jsx("span",{className:"text-sm font-bold text-slate-900",children:Ce}),a.jsxs("span",{className:"text-xs text-slate-500 ml-1",children:["(",tt,"%)"]})]})]},Z)})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(yn,{className:"w-5 h-5 text-violet-500"}),"Payment Status"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Os,{className:"w-5 h-5 text-emerald-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Stripe Connected"})]}),a.jsx("span",{className:"text-lg font-bold text-emerald-700",children:Ee.stripeConnectedCount})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ts,{className:"w-5 h-5 text-amber-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Pending Setup"})]}),a.jsx("span",{className:"text-lg font-bold text-amber-700",children:Ee.stripePendingCount})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(vr,{className:"w-5 h-5 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"No Payments"})]}),a.jsx("span",{className:"text-lg font-bold text-slate-700",children:Ee.totalShops-Ee.stripeConnectedCount-Ee.stripePendingCount})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Bo,{className:"w-5 h-5 text-blue-500"}),"Recent Signups"]}),a.jsx("div",{className:"space-y-3",children:Je.slice(0,5).map(Z=>{const Ce=dl[Z.subscriptionTier]||dl.free;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-xl border border-slate-200 hover:border-slate-300 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(vr,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:Z.name||"Unnamed Shop"}),a.jsx("div",{className:"text-xs text-slate-500",children:Z.ownerEmail})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-bold border ${Ce.color}`,children:Ce.label}),a.jsx("span",{className:"text-xs text-slate-500",children:Ve(Z.createdAt)})]})]},Z.id)})})]})]}),j==="shops"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-4 mb-6",children:a.jsxs("div",{className:"relative",children:[a.jsx(Gh,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by name, slug, or email...",value:U,onChange:Z=>V(Z.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Shops"}),a.jsxs("span",{className:"text-sm font-medium text-slate-500",children:[qe.length," shop",qe.length!==1?"s":""]})]}),a.jsxs("div",{className:"divide-y divide-slate-100",children:[Je.map(Z=>{const Ce=dl[Z.subscriptionTier]||dl.free,We=De(Z),tt=We.icon;return a.jsx("div",{className:`p-4 hover:bg-slate-50 transition-all ${Z.disabled?"opacity-60":""}`,children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:(Z.name||"S")[0].toUpperCase()}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:Z.name||"Unnamed Shop"}),a.jsx("span",{className:`px-2 py-0.5 rounded-lg text-[10px] font-bold border ${Ce.color}`,children:Ce.label}),Z.archived&&a.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold bg-amber-100 text-amber-700 border border-amber-200",children:"Archived"}),Z.disabled&&a.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold bg-red-100 text-red-700 border border-red-200",children:"Disabled"})]}),a.jsxs("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:["/",Z.slug,"  ",Z.ownerEmail]}),a.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs",children:[a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-md ${We.color}`,children:[tt&&a.jsx(tt,{className:"w-3 h-3"}),"Stripe: ",We.label]}),a.jsxs("span",{className:"text-slate-400",children:["Created: ",Ve(Z.createdAt)]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(at,{to:`/shop/${Z.slug}`,target:"_blank",className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"View public page",children:a.jsx(vu,{className:"w-4 h-4"})}),a.jsx(at,{to:`/shop/${Z.slug}/dashboard`,target:"_blank",className:"p-2 text-slate-400 hover:text-violet-600 hover:bg-violet-50 rounded-lg transition-all",title:"View dashboard (impersonate)",children:a.jsx(gl,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>z(Z),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",title:"Manage shop",children:a.jsx(Wh,{className:"w-4 h-4"})})]})]})},Z.id)}),Je.length===0&&a.jsxs("div",{className:"p-12 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(vr,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"No shops found"}),U&&a.jsx("button",{onClick:()=>V(""),className:"mt-2 text-sm text-violet-600 hover:underline",children:"Clear search"})]})]})]})]}),j==="revenue"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Ro,{className:"w-5 h-5 text-emerald-500"}),"MRR Breakdown"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-900",children:"Pro Plans"}),a.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[Ee.tierCounts.pro," shops  $29/mo"]})]}),a.jsxs("span",{className:"text-lg font-bold text-blue-700",children:["$",Ee.tierCounts.pro*au.pro]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-violet-50 border border-violet-200 rounded-xl",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-900",children:"Unlimited Plans"}),a.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[Ee.tierCounts.unlimited," shops  $79/mo"]})]}),a.jsxs("span",{className:"text-lg font-bold text-violet-700",children:["$",Ee.tierCounts.unlimited*au.unlimited]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsx("div",{children:a.jsx("span",{className:"font-bold text-slate-900",children:"Total MRR"})}),a.jsxs("span",{className:"text-2xl font-extrabold text-emerald-700",children:["$",Ee.mrr]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(yn,{className:"w-5 h-5 text-violet-500"}),"Platform Fees"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(tM,{className:"w-4 h-4 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Free Tier"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"5% platform fee on deposit payments via Stripe Connect"})]}),a.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Xo,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Pro & Unlimited"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"No platform fees  shops keep 100% of payments"})]})]}),a.jsx("div",{className:"mt-6 pt-4 border-t border-slate-200",children:a.jsxs("a",{href:"https://dashboard.stripe.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-violet-600 hover:bg-violet-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-violet-600/20 transition-all",children:[a.jsx(gl,{className:"w-4 h-4"}),"Open Stripe Dashboard"]})})]})]}),a.jsxs("div",{className:"mt-6 bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(vr,{className:"w-5 h-5 text-blue-500"}),"Stripe Connect Accounts"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-emerald-700",children:Ee.stripeConnectedCount}),a.jsx("div",{className:"text-sm font-medium text-emerald-600 mt-1",children:"Fully Connected"})]}),a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-amber-700",children:Ee.stripePendingCount}),a.jsx("div",{className:"text-sm font-medium text-amber-600 mt-1",children:"Pending Setup"})]}),a.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-slate-700",children:Ee.totalShops-Ee.stripeConnectedCount-Ee.stripePendingCount}),a.jsx("div",{className:"text-sm font-medium text-slate-600 mt-1",children:"Not Started"})]})]})]})]}),j==="users"&&a.jsx("div",{className:"animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("div",{className:"flex items-center justify-between mb-6",children:a.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[a.jsx(Pt,{className:"w-5 h-5 text-violet-500"}),"All Users (",x.length,")"]})}),a.jsxs("div",{className:"relative mb-6",children:[a.jsx(Gh,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by email, name, or ID...",value:ce,onChange:Z=>Se(Z.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),a.jsx("div",{className:"space-y-3",children:ze.length===0?a.jsx("p",{className:"text-center text-slate-500 py-8",children:"No users found"}):ze.map(Z=>{const Ce=fe(Z.id);return a.jsx("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl hover:border-slate-300 transition-all",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-violet-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:(Z.email?.[0]||"?").toUpperCase()}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-semibold text-slate-900 truncate",children:Z.email||"No email"}),a.jsx("div",{className:"text-xs text-slate-500 font-mono truncate",children:Z.id}),Ce.length>0&&a.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[a.jsx(vr,{className:"w-3 h-3 text-blue-500"}),a.jsxs("span",{className:"text-xs text-blue-600",children:[Ce.length," shop",Ce.length>1?"s":""]})]})]})]}),a.jsxs("button",{onClick:()=>C(Z),className:"px-3 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all flex items-center gap-1.5",children:[a.jsx(ga,{className:"w-3.5 h-3.5"}),"Delete"]})]})},Z.id)})})]})}),j==="support"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Wh,{className:"w-5 h-5 text-violet-500"}),"Support Tools"]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Manage shops, impersonate dashboards, and take quick actions."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(vu,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"View Dashboard"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Click the external link icon on any shop to view their dashboard. You must be logged in as an admin."})]}),a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Uo,{className:"w-4 h-4 text-amber-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Change Tier"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Click the settings icon on any shop to change their subscription tier or disable the account."})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Quick Shop Lookup"}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(Gh,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by name, slug, or email...",value:U,onChange:Z=>V(Z.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),U&&a.jsx("div",{className:"space-y-2",children:qe.slice(0,10).map(Z=>a.jsxs("button",{onClick:()=>z(Z),className:"w-full flex items-center justify-between p-3 bg-slate-50 hover:bg-slate-100 rounded-xl border border-slate-200 transition-all text-left",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(vr,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:Z.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:["/",Z.slug]})]})]}),a.jsx(P2,{className:"w-4 h-4 text-slate-400"})]},Z.id))})]})]})]}),L&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl flex items-center justify-center text-white font-bold",children:(L.name||"S")[0].toUpperCase()}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:L.name}),a.jsxs("p",{className:"text-sm text-slate-500",children:["/",L.slug]})]})]}),a.jsx("button",{onClick:()=>z(null),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",children:a.jsx(Rs,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Ef,{className:"w-4 h-4 text-slate-400"}),a.jsx("span",{className:"text-slate-600",children:L.ownerEmail})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Tt,{className:"w-4 h-4 text-slate-400"}),a.jsxs("span",{className:"text-slate-600",children:["Created: ",Ve(L.createdAt)]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(yn,{className:"w-4 h-4 text-slate-400"}),a.jsxs("span",{className:"text-slate-600",children:["Stripe: ",De(L).label,L.stripeConnectAccountId&&a.jsxs("span",{className:"ml-1 text-xs text-slate-400 font-mono",children:["(",L.stripeConnectAccountId,")"]})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2",children:"Subscription Tier"}),a.jsx("div",{className:"flex gap-2",children:["free","pro","unlimited"].map(Z=>{const Ce=dl[Z],We=(L.subscriptionTier||"free")===Z;return a.jsxs("button",{onClick:()=>Nt(L.id,Z),disabled:Q===L.id,className:`flex-1 px-4 py-3 rounded-xl font-semibold text-sm transition-all border-2 ${We?Z==="free"?"border-slate-400 bg-slate-100 text-slate-900":Z==="pro"?"border-blue-500 bg-blue-50 text-blue-700":"border-violet-500 bg-violet-50 text-violet-700":"border-slate-200 bg-white text-slate-500 hover:border-slate-300"}`,children:[Ce.label,Z!=="free"&&a.jsxs("span",{className:"block text-xs font-normal mt-0.5",children:["$",au[Z],"/mo"]})]},Z)})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Quick Actions"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs(at,{to:`/shop/${L.slug}`,target:"_blank",className:"flex items-center justify-center gap-2 px-4 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-medium text-sm transition-all",children:[a.jsx(vu,{className:"w-4 h-4"}),"View Page"]}),a.jsxs(at,{to:`/shop/${L.slug}/dashboard`,target:"_blank",className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-xl font-medium text-sm transition-all",children:[a.jsx(gl,{className:"w-4 h-4"}),"Dashboard"]})]}),a.jsx("button",{onClick:()=>Vs(L.id,L.disabled),disabled:Q===L.id,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all ${L.disabled?"bg-emerald-100 hover:bg-emerald-200 text-emerald-700":"bg-red-100 hover:bg-red-200 text-red-700"}`,children:L.disabled?a.jsxs(a.Fragment,{children:[a.jsx(Os,{className:"w-4 h-4"}),"Enable Shop"]}):a.jsxs(a.Fragment,{children:[a.jsx(J1,{className:"w-4 h-4"}),"Disable Shop"]})}),a.jsxs("button",{onClick:()=>At(L.id,L.archived),disabled:Q===L.id,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all ${L.archived?"bg-emerald-100 hover:bg-emerald-200 text-emerald-700":"bg-amber-100 hover:bg-amber-200 text-amber-700"}`,children:[a.jsx(yu,{className:"w-4 h-4"}),L.archived?"Unarchive Shop":"Archive Shop"]}),a.jsxs("div",{className:"pt-4 mt-4 border-t border-red-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(na,{className:"w-4 h-4 text-red-500"}),a.jsx("span",{className:"text-xs font-bold text-red-600 uppercase tracking-wider",children:"Danger Zone"})]}),a.jsxs("button",{onClick:async()=>{await ft(L.id),he(L),T(""),k(!1)},disabled:Q===L.id,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-medium text-sm transition-all shadow-md shadow-red-600/20",children:[a.jsx(ga,{className:"w-4 h-4"}),"Delete Shop Forever"]})]})]})]})}),ie&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(na,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Delete Shop Permanently"}),a.jsxs("p",{className:"text-sm text-slate-500",children:["/",ie.slug]})]})]}),E[ie.id]>0&&a.jsxs("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(na,{className:"w-5 h-5 text-amber-600"}),a.jsxs("span",{className:"font-semibold text-amber-800",children:[E[ie.id]," Upcoming Booking",E[ie.id]!==1?"s":""]})]}),a.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"This shop has active bookings. Deleting it will cancel all bookings and notify no one."}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:I,onChange:Z=>k(Z.target.checked),className:"w-4 h-4 rounded border-amber-400 text-red-600 focus:ring-red-500"}),a.jsx("span",{className:"text-sm font-medium text-amber-800",children:"I understand and want to force delete anyway"})]})]}),a.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-xl",children:[a.jsx("p",{className:"text-sm text-red-700 mb-2",children:a.jsx("strong",{children:"This will permanently delete:"})}),a.jsxs("ul",{className:"text-sm text-red-600 space-y-1 ml-4 list-disc",children:[a.jsx("li",{children:"Shop and all settings"}),a.jsx("li",{children:"All staff members"}),a.jsx("li",{children:"All bookings (past and future)"}),a.jsx("li",{children:"All time slots and schedule presets"}),a.jsx("li",{children:"All waitlist entries"}),a.jsx("li",{children:"All client notes"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:['Type "',a.jsx("span",{className:"text-red-600",children:ie.name}),'" to confirm:']}),a.jsx("input",{type:"text",value:W,onChange:Z=>T(Z.target.value),placeholder:"Enter shop name",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{he(null),T(""),k(!1)},className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all",children:"Cancel"}),a.jsx("button",{onClick:()=>Ie(ie.id),disabled:W!==ie.name||Q===ie.id||E[ie.id]>0&&!I,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 disabled:bg-slate-300 disabled:cursor-not-allowed text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-red-600/20",children:Q===ie.id?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(ga,{className:"w-4 h-4"}),"Delete Forever"]})})]})]})}),M&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(na,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Delete User Account"}),a.jsx("p",{className:"text-sm text-slate-500",children:M.email})]})]}),fe(M.id).length>0&&a.jsxs("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(vr,{className:"w-5 h-5 text-amber-600"}),a.jsxs("span",{className:"font-semibold text-amber-800",children:[fe(M.id).length," Shop",fe(M.id).length!==1?"s":""," Owned"]})]}),a.jsx("ul",{className:"text-sm text-amber-700 mb-3 space-y-1",children:fe(M.id).map(Z=>a.jsxs("li",{children:[" ",Z.name," (/",Z.slug,")"]},Z.id))}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:F,onChange:Z=>P(Z.target.checked),className:"w-4 h-4 rounded border-amber-400 text-red-600 focus:ring-red-500"}),a.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Also delete all shops owned by this user"})]})]}),a.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-xl",children:[a.jsx("p",{className:"text-sm text-red-700 mb-2",children:a.jsx("strong",{children:"This will permanently delete:"})}),a.jsxs("ul",{className:"text-sm text-red-600 space-y-1 ml-4 list-disc",children:[a.jsx("li",{children:"User's Firebase Auth account"}),a.jsx("li",{children:"User document in database"}),F&&a.jsx("li",{children:"All shops and their data (bookings, staff, etc.)"})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{C(null),P(!0)},disabled:O,className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:"Cancel"}),a.jsx("button",{onClick:()=>Be(M.id),disabled:O,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-red-600/20",children:O?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(ga,{className:"w-4 h-4"}),"Delete User"]})})]})]})})]})}function pP(){const[n,e]=_.useState(null),[t,i]=_.useState(!0);return _.useEffect(()=>{const o=fC(ya,c=>{e(c),i(!1)});return()=>o()},[]),t?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):a.jsx(N5,{children:a.jsxs(XT,{children:[a.jsx(ea,{path:"/",element:a.jsx(JM,{})}),a.jsx(ea,{path:"/register",element:a.jsx(eO,{})}),a.jsx(ea,{path:"/login",element:a.jsx(tO,{user:n})}),a.jsx(ea,{path:"/shop/:slug",element:a.jsx(ZO,{})}),a.jsx(ea,{path:"/shop/:slug/booking/:refCode",element:a.jsx(V9,{})}),a.jsx(ea,{path:"/shop/:slug/waitlist/:refCode",element:a.jsx(z9,{})}),a.jsx(ea,{path:"/shop/:slug/queue",element:a.jsx($9,{})}),a.jsx(ea,{path:"/shop/:slug/login",element:a.jsx(P9,{user:n})}),a.jsx(ea,{path:"/shop/:slug/dashboard",element:a.jsx(O9,{user:n})}),a.jsx(ea,{path:"/admin",element:a.jsx(mP,{user:n})}),a.jsx(ea,{path:"*",element:a.jsx(QT,{to:"/",replace:!0})})]})})}ZE.createRoot(document.getElementById("root")).render(a.jsx(Qt.StrictMode,{children:a.jsx(pP,{})}));
