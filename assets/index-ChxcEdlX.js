(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(o){if(o.ep)return;o.ep=!0;const u=t(o);fetch(o.href,u)}})();function ag(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var $p={exports:{}},Yc={};var Lv;function TE(){if(Lv)return Yc;Lv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,u){var d=null;if(u!==void 0&&(d=""+u),o.key!==void 0&&(d=""+o.key),"key"in o){u={};for(var p in o)p!=="key"&&(u[p]=o[p])}else u=o;return o=u.ref,{$$typeof:n,type:i,key:d,ref:o!==void 0?o:null,props:u}}return Yc.Fragment=e,Yc.jsx=t,Yc.jsxs=t,Yc}var Uv;function AE(){return Uv||(Uv=1,$p.exports=TE()),$p.exports}var r=AE(),qp={exports:{}},lt={};var Bv;function kE(){if(Bv)return lt;Bv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),S=Symbol.iterator;function R(U){return U===null||typeof U!="object"?null:(U=S&&U[S]||U["@@iterator"],typeof U=="function"?U:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,F={};function H(U,ee,ue){this.props=U,this.context=ee,this.refs=F,this.updater=ue||B}H.prototype.isReactComponent={},H.prototype.setState=function(U,ee){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,ee,"setState")},H.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function W(){}W.prototype=H.prototype;function z(U,ee,ue){this.props=U,this.context=ee,this.refs=F,this.updater=ue||B}var ie=z.prototype=new W;ie.constructor=z,V(ie,H.prototype),ie.isPureReactComponent=!0;var ae=Array.isArray;function Y(){}var A={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function E(U,ee,ue){var fe=ue.ref;return{$$typeof:n,type:U,key:ee,ref:fe!==void 0?fe:null,props:ue}}function I(U,ee){return E(U.type,ee,U.props)}function _(U){return typeof U=="object"&&U!==null&&U.$$typeof===n}function D(U){var ee={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ue){return ee[ue]})}var k=/\/+/g;function L(U,ee){return typeof U=="object"&&U!==null&&U.key!=null?D(""+U.key):ee.toString(36)}function P(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(Y,Y):(U.status="pending",U.then(function(ee){U.status==="pending"&&(U.status="fulfilled",U.value=ee)},function(ee){U.status==="pending"&&(U.status="rejected",U.reason=ee)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function O(U,ee,ue,fe,ge){var Re=typeof U;(Re==="undefined"||Re==="boolean")&&(U=null);var He=!1;if(U===null)He=!0;else switch(Re){case"bigint":case"string":case"number":He=!0;break;case"object":switch(U.$$typeof){case n:case e:He=!0;break;case b:return He=U._init,O(He(U._payload),ee,ue,fe,ge)}}if(He)return ge=ge(U),He=fe===""?"."+L(U,0):fe,ae(ge)?(ue="",He!=null&&(ue=He.replace(k,"$&/")+"/"),O(ge,ee,ue,"",function(rs){return rs})):ge!=null&&(_(ge)&&(ge=I(ge,ue+(ge.key==null||U&&U.key===ge.key?"":(""+ge.key).replace(k,"$&/")+"/")+He)),ee.push(ge)),1;He=0;var At=fe===""?".":fe+":";if(ae(U))for(var ht=0;ht<U.length;ht++)fe=U[ht],Re=At+L(fe,ht),He+=O(fe,ee,ue,Re,ge);else if(ht=R(U),typeof ht=="function")for(U=ht.call(U),ht=0;!(fe=U.next()).done;)fe=fe.value,Re=At+L(fe,ht++),He+=O(fe,ee,ue,Re,ge);else if(Re==="object"){if(typeof U.then=="function")return O(P(U),ee,ue,fe,ge);throw ee=String(U),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return He}function Q(U,ee,ue){if(U==null)return U;var fe=[],ge=0;return O(U,fe,"","",function(Re){return ee.call(ue,Re,ge++)}),fe}function le(U){if(U._status===-1){var ee=U._result;ee=ee(),ee.then(function(ue){(U._status===0||U._status===-1)&&(U._status=1,U._result=ue)},function(ue){(U._status===0||U._status===-1)&&(U._status=2,U._result=ue)}),U._status===-1&&(U._status=0,U._result=ee)}if(U._status===1)return U._result.default;throw U._result}var Ee=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},xe={map:Q,forEach:function(U,ee,ue){Q(U,function(){ee.apply(this,arguments)},ue)},count:function(U){var ee=0;return Q(U,function(){ee++}),ee},toArray:function(U){return Q(U,function(ee){return ee})||[]},only:function(U){if(!_(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return lt.Activity=w,lt.Children=xe,lt.Component=H,lt.Fragment=t,lt.Profiler=o,lt.PureComponent=z,lt.StrictMode=i,lt.Suspense=g,lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,lt.__COMPILER_RUNTIME={__proto__:null,c:function(U){return A.H.useMemoCache(U)}},lt.cache=function(U){return function(){return U.apply(null,arguments)}},lt.cacheSignal=function(){return null},lt.cloneElement=function(U,ee,ue){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var fe=V({},U.props),ge=U.key;if(ee!=null)for(Re in ee.key!==void 0&&(ge=""+ee.key),ee)!T.call(ee,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&ee.ref===void 0||(fe[Re]=ee[Re]);var Re=arguments.length-2;if(Re===1)fe.children=ue;else if(1<Re){for(var He=Array(Re),At=0;At<Re;At++)He[At]=arguments[At+2];fe.children=He}return E(U.type,ge,fe)},lt.createContext=function(U){return U={$$typeof:d,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:u,_context:U},U},lt.createElement=function(U,ee,ue){var fe,ge={},Re=null;if(ee!=null)for(fe in ee.key!==void 0&&(Re=""+ee.key),ee)T.call(ee,fe)&&fe!=="key"&&fe!=="__self"&&fe!=="__source"&&(ge[fe]=ee[fe]);var He=arguments.length-2;if(He===1)ge.children=ue;else if(1<He){for(var At=Array(He),ht=0;ht<He;ht++)At[ht]=arguments[ht+2];ge.children=At}if(U&&U.defaultProps)for(fe in He=U.defaultProps,He)ge[fe]===void 0&&(ge[fe]=He[fe]);return E(U,Re,ge)},lt.createRef=function(){return{current:null}},lt.forwardRef=function(U){return{$$typeof:p,render:U}},lt.isValidElement=_,lt.lazy=function(U){return{$$typeof:b,_payload:{_status:-1,_result:U},_init:le}},lt.memo=function(U,ee){return{$$typeof:x,type:U,compare:ee===void 0?null:ee}},lt.startTransition=function(U){var ee=A.T,ue={};A.T=ue;try{var fe=U(),ge=A.S;ge!==null&&ge(ue,fe),typeof fe=="object"&&fe!==null&&typeof fe.then=="function"&&fe.then(Y,Ee)}catch(Re){Ee(Re)}finally{ee!==null&&ue.types!==null&&(ee.types=ue.types),A.T=ee}},lt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},lt.use=function(U){return A.H.use(U)},lt.useActionState=function(U,ee,ue){return A.H.useActionState(U,ee,ue)},lt.useCallback=function(U,ee){return A.H.useCallback(U,ee)},lt.useContext=function(U){return A.H.useContext(U)},lt.useDebugValue=function(){},lt.useDeferredValue=function(U,ee){return A.H.useDeferredValue(U,ee)},lt.useEffect=function(U,ee){return A.H.useEffect(U,ee)},lt.useEffectEvent=function(U){return A.H.useEffectEvent(U)},lt.useId=function(){return A.H.useId()},lt.useImperativeHandle=function(U,ee,ue){return A.H.useImperativeHandle(U,ee,ue)},lt.useInsertionEffect=function(U,ee){return A.H.useInsertionEffect(U,ee)},lt.useLayoutEffect=function(U,ee){return A.H.useLayoutEffect(U,ee)},lt.useMemo=function(U,ee){return A.H.useMemo(U,ee)},lt.useOptimistic=function(U,ee){return A.H.useOptimistic(U,ee)},lt.useReducer=function(U,ee,ue){return A.H.useReducer(U,ee,ue)},lt.useRef=function(U){return A.H.useRef(U)},lt.useState=function(U){return A.H.useState(U)},lt.useSyncExternalStore=function(U,ee,ue){return A.H.useSyncExternalStore(U,ee,ue)},lt.useTransition=function(){return A.H.useTransition()},lt.version="19.2.4",lt}var zv;function rg(){return zv||(zv=1,qp.exports=kE()),qp.exports}var j=rg();const Ht=ag(j);var Hp={exports:{}},Wc={},Gp={exports:{}},Yp={};var Fv;function CE(){return Fv||(Fv=1,(function(n){function e(O,Q){var le=O.length;O.push(Q);e:for(;0<le;){var Ee=le-1>>>1,xe=O[Ee];if(0<o(xe,Q))O[Ee]=Q,O[le]=xe,le=Ee;else break e}}function t(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var Q=O[0],le=O.pop();if(le!==Q){O[0]=le;e:for(var Ee=0,xe=O.length,U=xe>>>1;Ee<U;){var ee=2*(Ee+1)-1,ue=O[ee],fe=ee+1,ge=O[fe];if(0>o(ue,le))fe<xe&&0>o(ge,ue)?(O[Ee]=ge,O[fe]=le,Ee=fe):(O[Ee]=ue,O[ee]=le,Ee=ee);else if(fe<xe&&0>o(ge,le))O[Ee]=ge,O[fe]=le,Ee=fe;else break e}}return Q}function o(O,Q){var le=O.sortIndex-Q.sortIndex;return le!==0?le:O.id-Q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],x=[],b=1,w=null,S=3,R=!1,B=!1,V=!1,F=!1,H=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;function ie(O){for(var Q=t(x);Q!==null;){if(Q.callback===null)i(x);else if(Q.startTime<=O)i(x),Q.sortIndex=Q.expirationTime,e(g,Q);else break;Q=t(x)}}function ae(O){if(V=!1,ie(O),!B)if(t(g)!==null)B=!0,Y||(Y=!0,D());else{var Q=t(x);Q!==null&&P(ae,Q.startTime-O)}}var Y=!1,A=-1,T=5,E=-1;function I(){return F?!0:!(n.unstable_now()-E<T)}function _(){if(F=!1,Y){var O=n.unstable_now();E=O;var Q=!0;try{e:{B=!1,V&&(V=!1,W(A),A=-1),R=!0;var le=S;try{t:{for(ie(O),w=t(g);w!==null&&!(w.expirationTime>O&&I());){var Ee=w.callback;if(typeof Ee=="function"){w.callback=null,S=w.priorityLevel;var xe=Ee(w.expirationTime<=O);if(O=n.unstable_now(),typeof xe=="function"){w.callback=xe,ie(O),Q=!0;break t}w===t(g)&&i(g),ie(O)}else i(g);w=t(g)}if(w!==null)Q=!0;else{var U=t(x);U!==null&&P(ae,U.startTime-O),Q=!1}}break e}finally{w=null,S=le,R=!1}Q=void 0}}finally{Q?D():Y=!1}}}var D;if(typeof z=="function")D=function(){z(_)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,L=k.port2;k.port1.onmessage=_,D=function(){L.postMessage(null)}}else D=function(){H(_,0)};function P(O,Q){A=H(function(){O(n.unstable_now())},Q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_next=function(O){switch(S){case 1:case 2:case 3:var Q=3;break;default:Q=S}var le=S;S=Q;try{return O()}finally{S=le}},n.unstable_requestPaint=function(){F=!0},n.unstable_runWithPriority=function(O,Q){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var le=S;S=O;try{return Q()}finally{S=le}},n.unstable_scheduleCallback=function(O,Q,le){var Ee=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?Ee+le:Ee):le=Ee,O){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=le+xe,O={id:b++,callback:Q,priorityLevel:O,startTime:le,expirationTime:xe,sortIndex:-1},le>Ee?(O.sortIndex=le,e(x,O),t(g)===null&&O===t(x)&&(V?(W(A),A=-1):V=!0,P(ae,le-Ee))):(O.sortIndex=xe,e(g,O),B||R||(B=!0,Y||(Y=!0,D()))),O},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(O){var Q=S;return function(){var le=S;S=Q;try{return O.apply(this,arguments)}finally{S=le}}}})(Yp)),Yp}var $v;function RE(){return $v||($v=1,Gp.exports=CE()),Gp.exports}var Wp={exports:{}},Gs={};var qv;function IE(){if(qv)return Gs;qv=1;var n=rg();function e(g){var x="https://react.dev/errors/"+g;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)x+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+g+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function u(g,x,b){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:w==null?null:""+w,children:g,containerInfo:x,implementation:b}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,x){if(g==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return Gs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Gs.createPortal=function(g,x){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(e(299));return u(g,x,null,b)},Gs.flushSync=function(g){var x=d.T,b=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=x,i.p=b,i.d.f()}},Gs.preconnect=function(g,x){typeof g=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,i.d.C(g,x))},Gs.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Gs.preinit=function(g,x){if(typeof g=="string"&&x&&typeof x.as=="string"){var b=x.as,w=p(b,x.crossOrigin),S=typeof x.integrity=="string"?x.integrity:void 0,R=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;b==="style"?i.d.S(g,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:w,integrity:S,fetchPriority:R}):b==="script"&&i.d.X(g,{crossOrigin:w,integrity:S,fetchPriority:R,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},Gs.preinitModule=function(g,x){if(typeof g=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var b=p(x.as,x.crossOrigin);i.d.M(g,{crossOrigin:b,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&i.d.M(g)},Gs.preload=function(g,x){if(typeof g=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var b=x.as,w=p(b,x.crossOrigin);i.d.L(g,b,{crossOrigin:w,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},Gs.preloadModule=function(g,x){if(typeof g=="string")if(x){var b=p(x.as,x.crossOrigin);i.d.m(g,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:b,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else i.d.m(g)},Gs.requestFormReset=function(g){i.d.r(g)},Gs.unstable_batchedUpdates=function(g,x){return g(x)},Gs.useFormState=function(g,x,b){return d.H.useFormState(g,x,b)},Gs.useFormStatus=function(){return d.H.useHostTransitionStatus()},Gs.version="19.2.4",Gs}var Hv;function DE(){if(Hv)return Wp.exports;Hv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Wp.exports=IE(),Wp.exports}var Gv;function ME(){if(Gv)return Wc;Gv=1;var n=RE(),e=rg(),t=DE();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,l=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(l=a.return),s=a.return;while(s)}return a.tag===3?l:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function x(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var l=s,c=a;;){var f=l.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){l=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===l)return g(f),s;if(m===c)return g(f),a;m=m.sibling}throw Error(i(188))}if(l.return!==c.return)l=f,c=m;else{for(var v=!1,C=f.child;C;){if(C===l){v=!0,l=f,c=m;break}if(C===c){v=!0,c=f,l=m;break}C=C.sibling}if(!v){for(C=m.child;C;){if(C===l){v=!0,l=m,c=f;break}if(C===c){v=!0,c=m,l=f;break}C=C.sibling}if(!v)throw Error(i(189))}}if(l.alternate!==c)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:a}function b(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=b(s),a!==null)return a;s=s.sibling}return null}var w=Object.assign,S=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),B=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),W=Symbol.for("react.consumer"),z=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),_=Symbol.iterator;function D(s){return s===null||typeof s!="object"?null:(s=_&&s[_]||s["@@iterator"],typeof s=="function"?s:null)}var k=Symbol.for("react.client.reference");function L(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===k?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case V:return"Fragment";case H:return"Profiler";case F:return"StrictMode";case ae:return"Suspense";case Y:return"SuspenseList";case E:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case B:return"Portal";case z:return s.displayName||"Context";case W:return(s._context.displayName||"Context")+".Consumer";case ie:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return a=s.displayName||null,a!==null?a:L(s.type)||"Memo";case T:a=s._payload,s=s._init;try{return L(s(a))}catch{}}return null}var P=Array.isArray,O=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},Ee=[],xe=-1;function U(s){return{current:s}}function ee(s){0>xe||(s.current=Ee[xe],Ee[xe]=null,xe--)}function ue(s,a){xe++,Ee[xe]=s.current,s.current=a}var fe=U(null),ge=U(null),Re=U(null),He=U(null);function At(s,a){switch(ue(Re,a),ue(ge,s),ue(fe,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?lv(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=lv(a),s=ov(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ee(fe),ue(fe,s)}function ht(){ee(fe),ee(ge),ee(Re)}function rs(s){s.memoizedState!==null&&ue(He,s);var a=fe.current,l=ov(a,s.type);a!==l&&(ue(ge,s),ue(fe,l))}function ne(s){ge.current===s&&(ee(fe),ee(ge)),He.current===s&&(ee(He),$c._currentValue=le)}var Se,Ve;function Ke(s){if(Se===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);Se=a&&a[1]||"",Ve=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Se+s+Ve}var et=!1;function St(s,a){if(!s||et)return"";et=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(oe){var se=oe}Reflect.construct(s,[],be)}else{try{be.call()}catch(oe){se=oe}s.call(be.prototype)}}else{try{throw Error()}catch(oe){se=oe}(be=s())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(oe){if(oe&&se&&typeof oe.stack=="string")return[oe.stack,se.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),v=m[0],C=m[1];if(v&&C){var q=v.split(`
`),te=C.split(`
`);for(f=c=0;c<q.length&&!q[c].includes("DetermineComponentFrameRoot");)c++;for(;f<te.length&&!te[f].includes("DetermineComponentFrameRoot");)f++;if(c===q.length||f===te.length)for(c=q.length-1,f=te.length-1;1<=c&&0<=f&&q[c]!==te[f];)f--;for(;1<=c&&0<=f;c--,f--)if(q[c]!==te[f]){if(c!==1||f!==1)do if(c--,f--,0>f||q[c]!==te[f]){var he=`
`+q[c].replace(" at new "," at ");return s.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",s.displayName)),he}while(1<=c&&0<=f);break}}}finally{et=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?Ke(l):""}function qs(s,a){switch(s.tag){case 26:case 27:case 5:return Ke(s.type);case 16:return Ke("Lazy");case 13:return s.child!==a&&a!==null?Ke("Suspense Fallback"):Ke("Suspense");case 19:return Ke("SuspenseList");case 0:case 15:return St(s.type,!1);case 11:return St(s.type.render,!1);case 1:return St(s.type,!0);case 31:return Ke("Activity");default:return""}}function ft(s){try{var a="",l=null;do a+=qs(s,l),l=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var mt=Object.prototype.hasOwnProperty,ke=n.unstable_scheduleCallback,Oe=n.unstable_cancelCallback,me=n.unstable_shouldYield,Ye=n.unstable_requestPaint,Ue=n.unstable_now,De=n.unstable_getCurrentPriorityLevel,qe=n.unstable_ImmediatePriority,Ge=n.unstable_UserBlockingPriority,Jt=n.unstable_NormalPriority,an=n.unstable_LowPriority,jn=n.unstable_IdlePriority,Js=n.log,Hs=n.unstable_setDisableYieldValue,gs=null,Vt=null;function xs(s){if(typeof Js=="function"&&Hs(s),Vt&&typeof Vt.setStrictMode=="function")try{Vt.setStrictMode(gs,s)}catch{}}var $=Math.clz32?Math.clz32:je,ce=Math.log,_e=Math.LN2;function je(s){return s>>>=0,s===0?32:31-(ce(s)/_e|0)|0}var Fe=256,de=262144,we=4194304;function Te(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Be(s,a,l){var c=s.pendingLanes;if(c===0)return 0;var f=0,m=s.suspendedLanes,v=s.pingedLanes;s=s.warmLanes;var C=c&134217727;return C!==0?(c=C&~m,c!==0?f=Te(c):(v&=C,v!==0?f=Te(v):l||(l=C&~s,l!==0&&(f=Te(l))))):(C=c&~m,C!==0?f=Te(C):v!==0?f=Te(v):l||(l=c&~s,l!==0&&(f=Te(l)))),f===0?0:a!==0&&a!==f&&(a&m)===0&&(m=f&-f,l=a&-a,m>=l||m===32&&(l&4194048)!==0)?a:f}function it(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function Le(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ze(){var s=we;return we<<=1,(we&62914560)===0&&(we=4194304),s}function kt(s){for(var a=[],l=0;31>l;l++)a.push(s);return a}function Wt(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function rn(s,a,l,c,f,m){var v=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var C=s.entanglements,q=s.expirationTimes,te=s.hiddenUpdates;for(l=v&~l;0<l;){var he=31-$(l),be=1<<he;C[he]=0,q[he]=-1;var se=te[he];if(se!==null)for(te[he]=null,he=0;he<se.length;he++){var oe=se[he];oe!==null&&(oe.lane&=-536870913)}l&=~be}c!==0&&ln(s,c,0),m!==0&&f===0&&s.tag!==0&&(s.suspendedLanes|=m&~(v&~a))}function ln(s,a,l){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-$(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|l&261930}function na(s,a){var l=s.entangledLanes|=a;for(s=s.entanglements;l;){var c=31-$(l),f=1<<c;f&a|s[c]&a&&(s[c]|=a),l&=~f}}function aa(s,a){var l=a&-a;return l=(l&42)!==0?1:ra(l),(l&(s.suspendedLanes|a))!==0?0:l}function ra(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ns(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ri(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:Rv(s.type))}function bs(s,a){var l=Q.p;try{return Q.p=s,a()}finally{Q.p=l}}var on=Math.random().toString(36).slice(2),is="__reactFiber$"+on,ys="__reactProps$"+on,Sn="__reactContainer$"+on,Ii="__reactEvents$"+on,Qf="__reactListeners$"+on,Gu="__reactHandles$"+on,Yu="__reactResources$"+on,wa="__reactMarker$"+on;function kl(s){delete s[is],delete s[ys],delete s[Ii],delete s[Qf],delete s[Gu]}function Na(s){var a=s[is];if(a)return a;for(var l=s.parentNode;l;){if(a=l[Sn]||l[is]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(s=pv(s);s!==null;){if(l=s[is])return l;s=pv(s)}return a}s=l,l=s.parentNode}return null}function Bn(s){if(s=s[is]||s[Sn]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function En(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function _a(s){var a=s[Yu];return a||(a=s[Yu]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function vs(s){s[wa]=!0}var Ko=new Set,Xo={};function ja(s,a){Sa(s,a),Sa(s+"Capture",a)}function Sa(s,a){for(Xo[s]=a,s=0;s<a.length;s++)Ko.add(a[s])}var Jo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zo={},ec={};function Wu(s){return mt.call(ec,s)?!0:mt.call(Zo,s)?!1:Jo.test(s)?ec[s]=!0:(Zo[s]=!0,!1)}function Cl(s,a,l){if(Wu(a))if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+l)}}function Tn(s,a,l){if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+l)}}function ws(s,a,l,c){if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(a,l,""+c)}}function Is(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Tr(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function tc(s,a,l){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return f.call(this)},set:function(v){l=""+v,m.call(this,v)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return l},setValue:function(v){l=""+v},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function Mt(s){if(!s._valueTracker){var a=Tr(s)?"checked":"value";s._valueTracker=tc(s,a,""+s[a])}}function Di(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var l=a.getValue(),c="";return s&&(c=Tr(s)?s.checked?"true":"false":s.value),s=c,s!==l?(a.setValue(s),!0):!1}function Ea(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Mi=/[\n"\\]/g;function cn(s){return s.replace(Mi,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Rl(s,a,l,c,f,m,v,C){s.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?s.type=v:s.removeAttribute("type"),a!=null?v==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Is(a)):s.value!==""+Is(a)&&(s.value=""+Is(a)):v!=="submit"&&v!=="reset"||s.removeAttribute("value"),a!=null?sc(s,v,Is(a)):l!=null?sc(s,v,Is(l)):c!=null&&s.removeAttribute("value"),f==null&&m!=null&&(s.defaultChecked=!!m),f!=null&&(s.checked=f&&typeof f!="function"&&typeof f!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?s.name=""+Is(C):s.removeAttribute("name")}function Qu(s,a,l,c,f,m,v,C){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(s.type=m),a!=null||l!=null){if(!(m!=="submit"&&m!=="reset"||a!=null)){Mt(s);return}l=l!=null?""+Is(l):"",a=a!=null?""+Is(a):l,C||a===s.value||(s.value=a),s.defaultValue=a}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=C?s.checked:!!c,s.defaultChecked=!!c,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.name=v),Mt(s)}function sc(s,a,l){a==="number"&&Ea(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function Ar(s,a,l,c){if(s=s.options,a){a={};for(var f=0;f<l.length;f++)a["$"+l[f]]=!0;for(l=0;l<s.length;l++)f=a.hasOwnProperty("$"+s[l].value),s[l].selected!==f&&(s[l].selected=f),f&&c&&(s[l].defaultSelected=!0)}else{for(l=""+Is(l),a=null,f=0;f<s.length;f++){if(s[f].value===l){s[f].selected=!0,c&&(s[f].defaultSelected=!0);return}a!==null||s[f].disabled||(a=s[f])}a!==null&&(a.selected=!0)}}function Ku(s,a,l){if(a!=null&&(a=""+Is(a),a!==s.value&&(s.value=a),l==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=l!=null?""+Is(l):""}function kr(s,a,l,c){if(a==null){if(c!=null){if(l!=null)throw Error(i(92));if(P(c)){if(1<c.length)throw Error(i(93));c=c[0]}l=c}l==null&&(l=""),a=l}l=Is(a),s.defaultValue=l,c=s.textContent,c===l&&c!==""&&c!==null&&(s.value=c),Mt(s)}function un(s,a){if(a){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=a;return}}s.textContent=a}var Xu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function nc(s,a,l){var c=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,l):typeof l!="number"||l===0||Xu.has(a)?a==="float"?s.cssFloat=l:s[a]=(""+l).trim():s[a]=l+"px"}function ac(s,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var f in a)c=a[f],a.hasOwnProperty(f)&&l[f]!==c&&nc(s,f,c)}else for(var m in a)a.hasOwnProperty(m)&&nc(s,m,a[m])}function Il(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ju=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Cr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Dl(s){return Cr.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ia(){}var rc=null;function zn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Rr=null,Ta=null;function Oi(s){var a=Bn(s);if(a&&(s=a.stateNode)){var l=s[ys]||null;e:switch(s=a.stateNode,a.type){case"input":if(Rl(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+cn(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var c=l[a];if(c!==s&&c.form===s.form){var f=c[ys]||null;if(!f)throw Error(i(90));Rl(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(a=0;a<l.length;a++)c=l[a],c.form===s.form&&Di(c)}break e;case"textarea":Ku(s,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&Ar(s,!!l.multiple,a,!1)}}}var Ml=!1;function Ir(s,a,l){if(Ml)return s(a,l);Ml=!0;try{var c=s(a);return c}finally{if(Ml=!1,(Rr!==null||Ta!==null)&&(Hd(),Rr&&(a=Rr,s=Ta,Ta=Rr=null,Oi(a),s)))for(a=0;a<s.length;a++)Oi(s[a])}}function la(s,a){var l=s.stateNode;if(l===null)return null;var c=l[ys]||null;if(c===null)return null;l=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var Fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pi=!1;if(Fn)try{var Lt={};Object.defineProperty(Lt,"passive",{get:function(){Pi=!0}}),window.addEventListener("test",Lt,Lt),window.removeEventListener("test",Lt,Lt)}catch{Pi=!1}var Aa=null,ic=null,Vi=null;function lc(){if(Vi)return Vi;var s,a=ic,l=a.length,c,f="value"in Aa?Aa.value:Aa.textContent,m=f.length;for(s=0;s<l&&a[s]===f[s];s++);var v=l-s;for(c=1;c<=v&&a[l-c]===f[m-c];c++);return Vi=f.slice(s,1<c?1-c:void 0)}function Li(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Xa(){return!0}function oa(){return!1}function Os(s){function a(l,c,f,m,v){this._reactName=l,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var C in s)s.hasOwnProperty(C)&&(l=s[C],this[C]=l?l(m):m[C]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Xa:oa,this.isPropagationStopped=oa,this}return w(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Xa)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Xa)},persist:function(){},isPersistent:Xa}),a}var Ja={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ka=Os(Ja),Dr=w({},Ja,{view:0,detail:0}),oc=Os(Dr),Mr,Ol,Ca,Pl=w({},Dr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Or,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ca&&(Ca&&s.type==="mousemove"?(Mr=s.screenX-Ca.screenX,Ol=s.screenY-Ca.screenY):Ol=Mr=0,Ca=s),Mr)},movementY:function(s){return"movementY"in s?s.movementY:Ol}}),cc=Os(Pl),Ui=w({},Pl,{dataTransfer:0}),Zu=Os(Ui),ed=w({},Dr,{relatedTarget:0}),Bi=Os(ed),uc=w({},Ja,{animationName:0,elapsedTime:0,pseudoElement:0}),td=Os(uc),Vl=w({},Ja,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),sd=Os(Vl),nd=w({},Ja,{data:0}),Ra=Os(nd),ad={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},id={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ld(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=id[s])?!!a[s]:!1}function Or(){return ld}var Zs=w({},Dr,{key:function(s){if(s.key){var a=ad[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Li(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?rd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Or,charCode:function(s){return s.type==="keypress"?Li(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Li(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),od=Os(Zs),cd=w({},Pl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Za=Os(cd),h=w({},Dr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Or}),y=Os(h),N=w({},Ja,{propertyName:0,elapsedTime:0,pseudoElement:0}),M=Os(N),J=w({},Pl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),re=Os(J),Ae=w({},Ja,{newState:0,oldState:0}),ct=Os(Ae),hs=[9,13,27,32],Ct=Fn&&"CompositionEvent"in window,Zt=null;Fn&&"documentMode"in document&&(Zt=document.documentMode);var $n=Fn&&"TextEvent"in window&&!Zt,Ia=Fn&&(!Ct||Zt&&8<Zt&&11>=Zt),ca=" ",ua=!1;function zi(s,a){switch(s){case"keyup":return hs.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ll(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ul=!1;function Xj(s,a){switch(s){case"compositionend":return Ll(a);case"keypress":return a.which!==32?null:(ua=!0,ca);case"textInput":return s=a.data,s===ca&&ua?null:s;default:return null}}function Jj(s,a){if(Ul)return s==="compositionend"||!Ct&&zi(s,a)?(s=lc(),Vi=ic=Aa=null,Ul=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ia&&a.locale!=="ko"?null:a.data;default:return null}}var Zj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bx(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Zj[s.type]:a==="textarea"}function yx(s,a,l,c){Rr?Ta?Ta.push(c):Ta=[c]:Rr=c,a=Jd(a,"onChange"),0<a.length&&(l=new ka("onChange","change",null,l,c),s.push({event:l,listeners:a}))}var dc=null,hc=null;function eS(s){tv(s,0)}function ud(s){var a=En(s);if(Di(a))return s}function vx(s,a){if(s==="change")return a}var wx=!1;if(Fn){var Kf;if(Fn){var Xf="oninput"in document;if(!Xf){var Nx=document.createElement("div");Nx.setAttribute("oninput","return;"),Xf=typeof Nx.oninput=="function"}Kf=Xf}else Kf=!1;wx=Kf&&(!document.documentMode||9<document.documentMode)}function _x(){dc&&(dc.detachEvent("onpropertychange",jx),hc=dc=null)}function jx(s){if(s.propertyName==="value"&&ud(hc)){var a=[];yx(a,hc,s,zn(s)),Ir(eS,a)}}function tS(s,a,l){s==="focusin"?(_x(),dc=a,hc=l,dc.attachEvent("onpropertychange",jx)):s==="focusout"&&_x()}function sS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return ud(hc)}function nS(s,a){if(s==="click")return ud(a)}function aS(s,a){if(s==="input"||s==="change")return ud(a)}function rS(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var An=typeof Object.is=="function"?Object.is:rS;function fc(s,a){if(An(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var l=Object.keys(s),c=Object.keys(a);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var f=l[c];if(!mt.call(a,f)||!An(s[f],a[f]))return!1}return!0}function Sx(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ex(s,a){var l=Sx(s);s=0;for(var c;l;){if(l.nodeType===3){if(c=s+l.textContent.length,s<=a&&c>=a)return{node:l,offset:a-s};s=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Sx(l)}}function Tx(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?Tx(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function Ax(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Ea(s.document);a instanceof s.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)s=a.contentWindow;else break;a=Ea(s.document)}return a}function Jf(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var iS=Fn&&"documentMode"in document&&11>=document.documentMode,Bl=null,Zf=null,mc=null,em=!1;function kx(s,a,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;em||Bl==null||Bl!==Ea(c)||(c=Bl,"selectionStart"in c&&Jf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),mc&&fc(mc,c)||(mc=c,c=Jd(Zf,"onSelect"),0<c.length&&(a=new ka("onSelect","select",null,a,l),s.push({event:a,listeners:c}),a.target=Bl)))}function Fi(s,a){var l={};return l[s.toLowerCase()]=a.toLowerCase(),l["Webkit"+s]="webkit"+a,l["Moz"+s]="moz"+a,l}var zl={animationend:Fi("Animation","AnimationEnd"),animationiteration:Fi("Animation","AnimationIteration"),animationstart:Fi("Animation","AnimationStart"),transitionrun:Fi("Transition","TransitionRun"),transitionstart:Fi("Transition","TransitionStart"),transitioncancel:Fi("Transition","TransitionCancel"),transitionend:Fi("Transition","TransitionEnd")},tm={},Cx={};Fn&&(Cx=document.createElement("div").style,"AnimationEvent"in window||(delete zl.animationend.animation,delete zl.animationiteration.animation,delete zl.animationstart.animation),"TransitionEvent"in window||delete zl.transitionend.transition);function $i(s){if(tm[s])return tm[s];if(!zl[s])return s;var a=zl[s],l;for(l in a)if(a.hasOwnProperty(l)&&l in Cx)return tm[s]=a[l];return s}var Rx=$i("animationend"),Ix=$i("animationiteration"),Dx=$i("animationstart"),lS=$i("transitionrun"),oS=$i("transitionstart"),cS=$i("transitioncancel"),Mx=$i("transitionend"),Ox=new Map,sm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sm.push("scrollEnd");function da(s,a){Ox.set(s,a),ja(a,[s])}var dd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},qn=[],Fl=0,nm=0;function hd(){for(var s=Fl,a=nm=Fl=0;a<s;){var l=qn[a];qn[a++]=null;var c=qn[a];qn[a++]=null;var f=qn[a];qn[a++]=null;var m=qn[a];if(qn[a++]=null,c!==null&&f!==null){var v=c.pending;v===null?f.next=f:(f.next=v.next,v.next=f),c.pending=f}m!==0&&Px(l,f,m)}}function fd(s,a,l,c){qn[Fl++]=s,qn[Fl++]=a,qn[Fl++]=l,qn[Fl++]=c,nm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function am(s,a,l,c){return fd(s,a,l,c),md(s)}function qi(s,a){return fd(s,null,null,a),md(s)}function Px(s,a,l){s.lanes|=l;var c=s.alternate;c!==null&&(c.lanes|=l);for(var f=!1,m=s.return;m!==null;)m.childLanes|=l,c=m.alternate,c!==null&&(c.childLanes|=l),m.tag===22&&(s=m.stateNode,s===null||s._visibility&1||(f=!0)),s=m,m=m.return;return s.tag===3?(m=s.stateNode,f&&a!==null&&(f=31-$(l),s=m.hiddenUpdates,c=s[f],c===null?s[f]=[a]:c.push(a),a.lane=l|536870912),m):null}function md(s){if(50<Pc)throw Pc=0,fp=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var $l={};function uS(s,a,l,c){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(s,a,l,c){return new uS(s,a,l,c)}function rm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function er(s,a){var l=s.alternate;return l===null?(l=kn(s.tag,a,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=a,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,a=s.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Vx(s,a){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,a=l.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function pd(s,a,l,c,f,m){var v=0;if(c=s,typeof s=="function")rm(s)&&(v=1);else if(typeof s=="string")v=pE(s,l,fe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case E:return s=kn(31,l,a,f),s.elementType=E,s.lanes=m,s;case V:return Hi(l.children,f,m,a);case F:v=8,f|=24;break;case H:return s=kn(12,l,a,f|2),s.elementType=H,s.lanes=m,s;case ae:return s=kn(13,l,a,f),s.elementType=ae,s.lanes=m,s;case Y:return s=kn(19,l,a,f),s.elementType=Y,s.lanes=m,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case z:v=10;break e;case W:v=9;break e;case ie:v=11;break e;case A:v=14;break e;case T:v=16,c=null;break e}v=29,l=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=kn(v,l,a,f),a.elementType=s,a.type=c,a.lanes=m,a}function Hi(s,a,l,c){return s=kn(7,s,c,a),s.lanes=l,s}function im(s,a,l){return s=kn(6,s,null,a),s.lanes=l,s}function Lx(s){var a=kn(18,null,null,0);return a.stateNode=s,a}function lm(s,a,l){return a=kn(4,s.children!==null?s.children:[],s.key,a),a.lanes=l,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var Ux=new WeakMap;function Hn(s,a){if(typeof s=="object"&&s!==null){var l=Ux.get(s);return l!==void 0?l:(a={value:s,source:a,stack:ft(a)},Ux.set(s,a),a)}return{value:s,source:a,stack:ft(a)}}var ql=[],Hl=0,gd=null,pc=0,Gn=[],Yn=0,Pr=null,Da=1,Ma="";function tr(s,a){ql[Hl++]=pc,ql[Hl++]=gd,gd=s,pc=a}function Bx(s,a,l){Gn[Yn++]=Da,Gn[Yn++]=Ma,Gn[Yn++]=Pr,Pr=s;var c=Da;s=Ma;var f=32-$(c)-1;c&=~(1<<f),l+=1;var m=32-$(a)+f;if(30<m){var v=f-f%5;m=(c&(1<<v)-1).toString(32),c>>=v,f-=v,Da=1<<32-$(a)+f|l<<f|c,Ma=m+s}else Da=1<<m|l<<f|c,Ma=s}function om(s){s.return!==null&&(tr(s,1),Bx(s,1,0))}function cm(s){for(;s===gd;)gd=ql[--Hl],ql[Hl]=null,pc=ql[--Hl],ql[Hl]=null;for(;s===Pr;)Pr=Gn[--Yn],Gn[Yn]=null,Ma=Gn[--Yn],Gn[Yn]=null,Da=Gn[--Yn],Gn[Yn]=null}function zx(s,a){Gn[Yn++]=Da,Gn[Yn++]=Ma,Gn[Yn++]=Pr,Da=a.id,Ma=a.overflow,Pr=s}var Ps=null,Qt=null,Nt=!1,Vr=null,Wn=!1,um=Error(i(519));function Lr(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gc(Hn(a,s)),um}function Fx(s){var a=s.stateNode,l=s.type,c=s.memoizedProps;switch(a[is]=s,a[ys]=c,l){case"dialog":gt("cancel",a),gt("close",a);break;case"iframe":case"object":case"embed":gt("load",a);break;case"video":case"audio":for(l=0;l<Lc.length;l++)gt(Lc[l],a);break;case"source":gt("error",a);break;case"img":case"image":case"link":gt("error",a),gt("load",a);break;case"details":gt("toggle",a);break;case"input":gt("invalid",a),Qu(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":gt("invalid",a);break;case"textarea":gt("invalid",a),kr(a,c.value,c.defaultValue,c.children)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||c.suppressHydrationWarning===!0||rv(a.textContent,l)?(c.popover!=null&&(gt("beforetoggle",a),gt("toggle",a)),c.onScroll!=null&&gt("scroll",a),c.onScrollEnd!=null&&gt("scrollend",a),c.onClick!=null&&(a.onclick=ia),a=!0):a=!1,a||Lr(s,!0)}function $x(s){for(Ps=s.return;Ps;)switch(Ps.tag){case 5:case 31:case 13:Wn=!1;return;case 27:case 3:Wn=!0;return;default:Ps=Ps.return}}function Gl(s){if(s!==Ps)return!1;if(!Nt)return $x(s),Nt=!0,!1;var a=s.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||Ap(s.type,s.memoizedProps)),l=!l),l&&Qt&&Lr(s),$x(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Qt=mv(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Qt=mv(s)}else a===27?(a=Qt,Jr(s.type)?(s=Dp,Dp=null,Qt=s):Qt=a):Qt=Ps?Kn(s.stateNode.nextSibling):null;return!0}function Gi(){Qt=Ps=null,Nt=!1}function dm(){var s=Vr;return s!==null&&(mn===null?mn=s:mn.push.apply(mn,s),Vr=null),s}function gc(s){Vr===null?Vr=[s]:Vr.push(s)}var hm=U(null),Yi=null,sr=null;function Ur(s,a,l){ue(hm,a._currentValue),a._currentValue=l}function nr(s){s._currentValue=hm.current,ee(hm)}function fm(s,a,l){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===l)break;s=s.return}}function mm(s,a,l,c){var f=s.child;for(f!==null&&(f.return=s);f!==null;){var m=f.dependencies;if(m!==null){var v=f.child;m=m.firstContext;e:for(;m!==null;){var C=m;m=f;for(var q=0;q<a.length;q++)if(C.context===a[q]){m.lanes|=l,C=m.alternate,C!==null&&(C.lanes|=l),fm(m.return,l,s),c||(v=null);break e}m=C.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(i(341));v.lanes|=l,m=v.alternate,m!==null&&(m.lanes|=l),fm(v,l,s),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===s){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function Yl(s,a,l,c){s=null;for(var f=a,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(i(387));if(v=v.memoizedProps,v!==null){var C=f.type;An(f.pendingProps.value,v.value)||(s!==null?s.push(C):s=[C])}}else if(f===He.current){if(v=f.alternate,v===null)throw Error(i(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(s!==null?s.push($c):s=[$c])}f=f.return}s!==null&&mm(a,s,l,c),a.flags|=262144}function xd(s){for(s=s.firstContext;s!==null;){if(!An(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Wi(s){Yi=s,sr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Vs(s){return qx(Yi,s)}function bd(s,a){return Yi===null&&Wi(s),qx(s,a)}function qx(s,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},sr===null){if(s===null)throw Error(i(308));sr=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else sr=sr.next=a;return l}var dS=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(l,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(l){return l()})}},hS=n.unstable_scheduleCallback,fS=n.unstable_NormalPriority,Ns={$$typeof:z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function pm(){return{controller:new dS,data:new Map,refCount:0}}function xc(s){s.refCount--,s.refCount===0&&hS(fS,function(){s.controller.abort()})}var bc=null,gm=0,Wl=0,Ql=null;function mS(s,a){if(bc===null){var l=bc=[];gm=0,Wl=yp(),Ql={status:"pending",value:void 0,then:function(c){l.push(c)}}}return gm++,a.then(Hx,Hx),a}function Hx(){if(--gm===0&&bc!==null){Ql!==null&&(Ql.status="fulfilled");var s=bc;bc=null,Wl=0,Ql=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function pS(s,a){var l=[],c={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var f=0;f<l.length;f++)(0,l[f])(a)},function(f){for(c.status="rejected",c.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),c}var Gx=O.S;O.S=function(s,a){ky=Ue(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&mS(s,a),Gx!==null&&Gx(s,a)};var Qi=U(null);function xm(){var s=Qi.current;return s!==null?s:$t.pooledCache}function yd(s,a){a===null?ue(Qi,Qi.current):ue(Qi,a.pool)}function Yx(){var s=xm();return s===null?null:{parent:Ns._currentValue,pool:s}}var Kl=Error(i(460)),bm=Error(i(474)),vd=Error(i(542)),wd={then:function(){}};function Wx(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Qx(s,a,l){switch(l=s[l],l===void 0?s.push(a):l!==a&&(a.then(ia,ia),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Xx(s),s;default:if(typeof a.status=="string")a.then(ia,ia);else{if(s=$t,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var f=a;f.status="fulfilled",f.value=c}},function(c){if(a.status==="pending"){var f=a;f.status="rejected",f.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Xx(s),s}throw Xi=a,Kl}}function Ki(s){try{var a=s._init;return a(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Xi=l,Kl):l}}var Xi=null;function Kx(){if(Xi===null)throw Error(i(459));var s=Xi;return Xi=null,s}function Xx(s){if(s===Kl||s===vd)throw Error(i(483))}var Xl=null,yc=0;function Nd(s){var a=yc;return yc+=1,Xl===null&&(Xl=[]),Qx(Xl,s,a)}function vc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function _d(s,a){throw a.$$typeof===S?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Jx(s){function a(K,G){if(s){var Z=K.deletions;Z===null?(K.deletions=[G],K.flags|=16):Z.push(G)}}function l(K,G){if(!s)return null;for(;G!==null;)a(K,G),G=G.sibling;return null}function c(K){for(var G=new Map;K!==null;)K.key!==null?G.set(K.key,K):G.set(K.index,K),K=K.sibling;return G}function f(K,G){return K=er(K,G),K.index=0,K.sibling=null,K}function m(K,G,Z){return K.index=Z,s?(Z=K.alternate,Z!==null?(Z=Z.index,Z<G?(K.flags|=67108866,G):Z):(K.flags|=67108866,G)):(K.flags|=1048576,G)}function v(K){return s&&K.alternate===null&&(K.flags|=67108866),K}function C(K,G,Z,pe){return G===null||G.tag!==6?(G=im(Z,K.mode,pe),G.return=K,G):(G=f(G,Z),G.return=K,G)}function q(K,G,Z,pe){var We=Z.type;return We===V?he(K,G,Z.props.children,pe,Z.key):G!==null&&(G.elementType===We||typeof We=="object"&&We!==null&&We.$$typeof===T&&Ki(We)===G.type)?(G=f(G,Z.props),vc(G,Z),G.return=K,G):(G=pd(Z.type,Z.key,Z.props,null,K.mode,pe),vc(G,Z),G.return=K,G)}function te(K,G,Z,pe){return G===null||G.tag!==4||G.stateNode.containerInfo!==Z.containerInfo||G.stateNode.implementation!==Z.implementation?(G=lm(Z,K.mode,pe),G.return=K,G):(G=f(G,Z.children||[]),G.return=K,G)}function he(K,G,Z,pe,We){return G===null||G.tag!==7?(G=Hi(Z,K.mode,pe,We),G.return=K,G):(G=f(G,Z),G.return=K,G)}function be(K,G,Z){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=im(""+G,K.mode,Z),G.return=K,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case R:return Z=pd(G.type,G.key,G.props,null,K.mode,Z),vc(Z,G),Z.return=K,Z;case B:return G=lm(G,K.mode,Z),G.return=K,G;case T:return G=Ki(G),be(K,G,Z)}if(P(G)||D(G))return G=Hi(G,K.mode,Z,null),G.return=K,G;if(typeof G.then=="function")return be(K,Nd(G),Z);if(G.$$typeof===z)return be(K,bd(K,G),Z);_d(K,G)}return null}function se(K,G,Z,pe){var We=G!==null?G.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return We!==null?null:C(K,G,""+Z,pe);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case R:return Z.key===We?q(K,G,Z,pe):null;case B:return Z.key===We?te(K,G,Z,pe):null;case T:return Z=Ki(Z),se(K,G,Z,pe)}if(P(Z)||D(Z))return We!==null?null:he(K,G,Z,pe,null);if(typeof Z.then=="function")return se(K,G,Nd(Z),pe);if(Z.$$typeof===z)return se(K,G,bd(K,Z),pe);_d(K,Z)}return null}function oe(K,G,Z,pe,We){if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return K=K.get(Z)||null,C(G,K,""+pe,We);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case R:return K=K.get(pe.key===null?Z:pe.key)||null,q(G,K,pe,We);case B:return K=K.get(pe.key===null?Z:pe.key)||null,te(G,K,pe,We);case T:return pe=Ki(pe),oe(K,G,Z,pe,We)}if(P(pe)||D(pe))return K=K.get(Z)||null,he(G,K,pe,We,null);if(typeof pe.then=="function")return oe(K,G,Z,Nd(pe),We);if(pe.$$typeof===z)return oe(K,G,Z,bd(G,pe),We);_d(G,pe)}return null}function Pe(K,G,Z,pe){for(var We=null,Et=null,$e=G,dt=G=0,bt=null;$e!==null&&dt<Z.length;dt++){$e.index>dt?(bt=$e,$e=null):bt=$e.sibling;var Tt=se(K,$e,Z[dt],pe);if(Tt===null){$e===null&&($e=bt);break}s&&$e&&Tt.alternate===null&&a(K,$e),G=m(Tt,G,dt),Et===null?We=Tt:Et.sibling=Tt,Et=Tt,$e=bt}if(dt===Z.length)return l(K,$e),Nt&&tr(K,dt),We;if($e===null){for(;dt<Z.length;dt++)$e=be(K,Z[dt],pe),$e!==null&&(G=m($e,G,dt),Et===null?We=$e:Et.sibling=$e,Et=$e);return Nt&&tr(K,dt),We}for($e=c($e);dt<Z.length;dt++)bt=oe($e,K,dt,Z[dt],pe),bt!==null&&(s&&bt.alternate!==null&&$e.delete(bt.key===null?dt:bt.key),G=m(bt,G,dt),Et===null?We=bt:Et.sibling=bt,Et=bt);return s&&$e.forEach(function(ni){return a(K,ni)}),Nt&&tr(K,dt),We}function Je(K,G,Z,pe){if(Z==null)throw Error(i(151));for(var We=null,Et=null,$e=G,dt=G=0,bt=null,Tt=Z.next();$e!==null&&!Tt.done;dt++,Tt=Z.next()){$e.index>dt?(bt=$e,$e=null):bt=$e.sibling;var ni=se(K,$e,Tt.value,pe);if(ni===null){$e===null&&($e=bt);break}s&&$e&&ni.alternate===null&&a(K,$e),G=m(ni,G,dt),Et===null?We=ni:Et.sibling=ni,Et=ni,$e=bt}if(Tt.done)return l(K,$e),Nt&&tr(K,dt),We;if($e===null){for(;!Tt.done;dt++,Tt=Z.next())Tt=be(K,Tt.value,pe),Tt!==null&&(G=m(Tt,G,dt),Et===null?We=Tt:Et.sibling=Tt,Et=Tt);return Nt&&tr(K,dt),We}for($e=c($e);!Tt.done;dt++,Tt=Z.next())Tt=oe($e,K,dt,Tt.value,pe),Tt!==null&&(s&&Tt.alternate!==null&&$e.delete(Tt.key===null?dt:Tt.key),G=m(Tt,G,dt),Et===null?We=Tt:Et.sibling=Tt,Et=Tt);return s&&$e.forEach(function(EE){return a(K,EE)}),Nt&&tr(K,dt),We}function zt(K,G,Z,pe){if(typeof Z=="object"&&Z!==null&&Z.type===V&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case R:e:{for(var We=Z.key;G!==null;){if(G.key===We){if(We=Z.type,We===V){if(G.tag===7){l(K,G.sibling),pe=f(G,Z.props.children),pe.return=K,K=pe;break e}}else if(G.elementType===We||typeof We=="object"&&We!==null&&We.$$typeof===T&&Ki(We)===G.type){l(K,G.sibling),pe=f(G,Z.props),vc(pe,Z),pe.return=K,K=pe;break e}l(K,G);break}else a(K,G);G=G.sibling}Z.type===V?(pe=Hi(Z.props.children,K.mode,pe,Z.key),pe.return=K,K=pe):(pe=pd(Z.type,Z.key,Z.props,null,K.mode,pe),vc(pe,Z),pe.return=K,K=pe)}return v(K);case B:e:{for(We=Z.key;G!==null;){if(G.key===We)if(G.tag===4&&G.stateNode.containerInfo===Z.containerInfo&&G.stateNode.implementation===Z.implementation){l(K,G.sibling),pe=f(G,Z.children||[]),pe.return=K,K=pe;break e}else{l(K,G);break}else a(K,G);G=G.sibling}pe=lm(Z,K.mode,pe),pe.return=K,K=pe}return v(K);case T:return Z=Ki(Z),zt(K,G,Z,pe)}if(P(Z))return Pe(K,G,Z,pe);if(D(Z)){if(We=D(Z),typeof We!="function")throw Error(i(150));return Z=We.call(Z),Je(K,G,Z,pe)}if(typeof Z.then=="function")return zt(K,G,Nd(Z),pe);if(Z.$$typeof===z)return zt(K,G,bd(K,Z),pe);_d(K,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,G!==null&&G.tag===6?(l(K,G.sibling),pe=f(G,Z),pe.return=K,K=pe):(l(K,G),pe=im(Z,K.mode,pe),pe.return=K,K=pe),v(K)):l(K,G)}return function(K,G,Z,pe){try{yc=0;var We=zt(K,G,Z,pe);return Xl=null,We}catch($e){if($e===Kl||$e===vd)throw $e;var Et=kn(29,$e,null,K.mode);return Et.lanes=pe,Et.return=K,Et}}}var Ji=Jx(!0),Zx=Jx(!1),Br=!1;function ym(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function zr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Fr(s,a,l){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Rt&2)!==0){var f=c.pending;return f===null?a.next=a:(a.next=f.next,f.next=a),c.pending=a,a=md(s),Px(s,null,l),a}return fd(s,c,a,l),md(s)}function wc(s,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,l|=c,a.lanes=l,na(s,l)}}function wm(s,a){var l=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var f=null,m=null;if(l=l.firstBaseUpdate,l!==null){do{var v={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};m===null?f=m=v:m=m.next=v,l=l.next}while(l!==null);m===null?f=m=a:m=m.next=a}else f=m=a;l={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=a:s.next=a,l.lastBaseUpdate=a}var Nm=!1;function Nc(){if(Nm){var s=Ql;if(s!==null)throw s}}function _c(s,a,l,c){Nm=!1;var f=s.updateQueue;Br=!1;var m=f.firstBaseUpdate,v=f.lastBaseUpdate,C=f.shared.pending;if(C!==null){f.shared.pending=null;var q=C,te=q.next;q.next=null,v===null?m=te:v.next=te,v=q;var he=s.alternate;he!==null&&(he=he.updateQueue,C=he.lastBaseUpdate,C!==v&&(C===null?he.firstBaseUpdate=te:C.next=te,he.lastBaseUpdate=q))}if(m!==null){var be=f.baseState;v=0,he=te=q=null,C=m;do{var se=C.lane&-536870913,oe=se!==C.lane;if(oe?(xt&se)===se:(c&se)===se){se!==0&&se===Wl&&(Nm=!0),he!==null&&(he=he.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});e:{var Pe=s,Je=C;se=a;var zt=l;switch(Je.tag){case 1:if(Pe=Je.payload,typeof Pe=="function"){be=Pe.call(zt,be,se);break e}be=Pe;break e;case 3:Pe.flags=Pe.flags&-65537|128;case 0:if(Pe=Je.payload,se=typeof Pe=="function"?Pe.call(zt,be,se):Pe,se==null)break e;be=w({},be,se);break e;case 2:Br=!0}}se=C.callback,se!==null&&(s.flags|=64,oe&&(s.flags|=8192),oe=f.callbacks,oe===null?f.callbacks=[se]:oe.push(se))}else oe={lane:se,tag:C.tag,payload:C.payload,callback:C.callback,next:null},he===null?(te=he=oe,q=be):he=he.next=oe,v|=se;if(C=C.next,C===null){if(C=f.shared.pending,C===null)break;oe=C,C=oe.next,oe.next=null,f.lastBaseUpdate=oe,f.shared.pending=null}}while(!0);he===null&&(q=be),f.baseState=q,f.firstBaseUpdate=te,f.lastBaseUpdate=he,m===null&&(f.shared.lanes=0),Yr|=v,s.lanes=v,s.memoizedState=be}}function eb(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function tb(s,a){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)eb(l[s],a)}var Jl=U(null),jd=U(0);function sb(s,a){s=hr,ue(jd,s),ue(Jl,a),hr=s|a.baseLanes}function _m(){ue(jd,hr),ue(Jl,Jl.current)}function jm(){hr=jd.current,ee(Jl),ee(jd)}var Cn=U(null),Qn=null;function $r(s){var a=s.alternate;ue(fs,fs.current&1),ue(Cn,s),Qn===null&&(a===null||Jl.current!==null||a.memoizedState!==null)&&(Qn=s)}function Sm(s){ue(fs,fs.current),ue(Cn,s),Qn===null&&(Qn=s)}function nb(s){s.tag===22?(ue(fs,fs.current),ue(Cn,s),Qn===null&&(Qn=s)):qr()}function qr(){ue(fs,fs.current),ue(Cn,Cn.current)}function Rn(s){ee(Cn),Qn===s&&(Qn=null),ee(fs)}var fs=U(0);function Sd(s){for(var a=s;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Rp(l)||Ip(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ar=0,ut=null,Ut=null,_s=null,Ed=!1,Zl=!1,Zi=!1,Td=0,jc=0,eo=null,gS=0;function ls(){throw Error(i(321))}function Em(s,a){if(a===null)return!1;for(var l=0;l<a.length&&l<s.length;l++)if(!An(s[l],a[l]))return!1;return!0}function Tm(s,a,l,c,f,m){return ar=m,ut=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,O.H=s===null||s.memoizedState===null?Bb:Fm,Zi=!1,m=l(c,f),Zi=!1,Zl&&(m=rb(a,l,c,f)),ab(s),m}function ab(s){O.H=Tc;var a=Ut!==null&&Ut.next!==null;if(ar=0,_s=Ut=ut=null,Ed=!1,jc=0,eo=null,a)throw Error(i(300));s===null||js||(s=s.dependencies,s!==null&&xd(s)&&(js=!0))}function rb(s,a,l,c){ut=s;var f=0;do{if(Zl&&(eo=null),jc=0,Zl=!1,25<=f)throw Error(i(301));if(f+=1,_s=Ut=null,s.updateQueue!=null){var m=s.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}O.H=zb,m=a(l,c)}while(Zl);return m}function xS(){var s=O.H,a=s.useState()[0];return a=typeof a.then=="function"?Sc(a):a,s=s.useState()[0],(Ut!==null?Ut.memoizedState:null)!==s&&(ut.flags|=1024),a}function Am(){var s=Td!==0;return Td=0,s}function km(s,a,l){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~l}function Cm(s){if(Ed){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Ed=!1}ar=0,_s=Ut=ut=null,Zl=!1,jc=Td=0,eo=null}function en(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _s===null?ut.memoizedState=_s=s:_s=_s.next=s,_s}function ms(){if(Ut===null){var s=ut.alternate;s=s!==null?s.memoizedState:null}else s=Ut.next;var a=_s===null?ut.memoizedState:_s.next;if(a!==null)_s=a,Ut=s;else{if(s===null)throw ut.alternate===null?Error(i(467)):Error(i(310));Ut=s,s={memoizedState:Ut.memoizedState,baseState:Ut.baseState,baseQueue:Ut.baseQueue,queue:Ut.queue,next:null},_s===null?ut.memoizedState=_s=s:_s=_s.next=s}return _s}function Ad(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sc(s){var a=jc;return jc+=1,eo===null&&(eo=[]),s=Qx(eo,s,a),a=ut,(_s===null?a.memoizedState:_s.next)===null&&(a=a.alternate,O.H=a===null||a.memoizedState===null?Bb:Fm),s}function kd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Sc(s);if(s.$$typeof===z)return Vs(s)}throw Error(i(438,String(s)))}function Rm(s){var a=null,l=ut.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var c=ut.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(f){return f.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=Ad(),ut.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(s),c=0;c<s;c++)l[c]=I;return a.index++,l}function rr(s,a){return typeof a=="function"?a(s):a}function Cd(s){var a=ms();return Im(a,Ut,s)}function Im(s,a,l){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=l;var f=s.baseQueue,m=c.pending;if(m!==null){if(f!==null){var v=f.next;f.next=m.next,m.next=v}a.baseQueue=f=m,c.pending=null}if(m=s.baseState,f===null)s.memoizedState=m;else{a=f.next;var C=v=null,q=null,te=a,he=!1;do{var be=te.lane&-536870913;if(be!==te.lane?(xt&be)===be:(ar&be)===be){var se=te.revertLane;if(se===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),be===Wl&&(he=!0);else if((ar&se)===se){te=te.next,se===Wl&&(he=!0);continue}else be={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},q===null?(C=q=be,v=m):q=q.next=be,ut.lanes|=se,Yr|=se;be=te.action,Zi&&l(m,be),m=te.hasEagerState?te.eagerState:l(m,be)}else se={lane:be,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},q===null?(C=q=se,v=m):q=q.next=se,ut.lanes|=be,Yr|=be;te=te.next}while(te!==null&&te!==a);if(q===null?v=m:q.next=C,!An(m,s.memoizedState)&&(js=!0,he&&(l=Ql,l!==null)))throw l;s.memoizedState=m,s.baseState=v,s.baseQueue=q,c.lastRenderedState=m}return f===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function Dm(s){var a=ms(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var c=l.dispatch,f=l.pending,m=a.memoizedState;if(f!==null){l.pending=null;var v=f=f.next;do m=s(m,v.action),v=v.next;while(v!==f);An(m,a.memoizedState)||(js=!0),a.memoizedState=m,a.baseQueue===null&&(a.baseState=m),l.lastRenderedState=m}return[m,c]}function ib(s,a,l){var c=ut,f=ms(),m=Nt;if(m){if(l===void 0)throw Error(i(407));l=l()}else l=a();var v=!An((Ut||f).memoizedState,l);if(v&&(f.memoizedState=l,js=!0),f=f.queue,Pm(cb.bind(null,c,f,s),[s]),f.getSnapshot!==a||v||_s!==null&&_s.memoizedState.tag&1){if(c.flags|=2048,to(9,{destroy:void 0},ob.bind(null,c,f,l,a),null),$t===null)throw Error(i(349));m||(ar&127)!==0||lb(c,a,l)}return l}function lb(s,a,l){s.flags|=16384,s={getSnapshot:a,value:l},a=ut.updateQueue,a===null?(a=Ad(),ut.updateQueue=a,a.stores=[s]):(l=a.stores,l===null?a.stores=[s]:l.push(s))}function ob(s,a,l,c){a.value=l,a.getSnapshot=c,ub(a)&&db(s)}function cb(s,a,l){return l(function(){ub(a)&&db(s)})}function ub(s){var a=s.getSnapshot;s=s.value;try{var l=a();return!An(s,l)}catch{return!0}}function db(s){var a=qi(s,2);a!==null&&pn(a,s,2)}function Mm(s){var a=en();if(typeof s=="function"){var l=s;if(s=l(),Zi){xs(!0);try{l()}finally{xs(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:s},a}function hb(s,a,l,c){return s.baseState=l,Im(s,Ut,typeof c=="function"?c:rr)}function bS(s,a,l,c,f){if(Dd(s))throw Error(i(485));if(s=a.action,s!==null){var m={payload:f,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){m.listeners.push(v)}};O.T!==null?l(!0):m.isTransition=!1,c(m),l=a.pending,l===null?(m.next=a.pending=m,fb(a,m)):(m.next=l.next,a.pending=l.next=m)}}function fb(s,a){var l=a.action,c=a.payload,f=s.state;if(a.isTransition){var m=O.T,v={};O.T=v;try{var C=l(f,c),q=O.S;q!==null&&q(v,C),mb(s,a,C)}catch(te){Om(s,a,te)}finally{m!==null&&v.types!==null&&(m.types=v.types),O.T=m}}else try{m=l(f,c),mb(s,a,m)}catch(te){Om(s,a,te)}}function mb(s,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){pb(s,a,c)},function(c){return Om(s,a,c)}):pb(s,a,l)}function pb(s,a,l){a.status="fulfilled",a.value=l,gb(a),s.state=l,a=s.pending,a!==null&&(l=a.next,l===a?s.pending=null:(l=l.next,a.next=l,fb(s,l)))}function Om(s,a,l){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=l,gb(a),a=a.next;while(a!==c)}s.action=null}function gb(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function xb(s,a){return a}function bb(s,a){if(Nt){var l=$t.formState;if(l!==null){e:{var c=ut;if(Nt){if(Qt){t:{for(var f=Qt,m=Wn;f.nodeType!==8;){if(!m){f=null;break t}if(f=Kn(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Qt=Kn(f.nextSibling),c=f.data==="F!";break e}}Lr(c)}c=!1}c&&(a=l[0])}}return l=en(),l.memoizedState=l.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xb,lastRenderedState:a},l.queue=c,l=Vb.bind(null,ut,c),c.dispatch=l,c=Mm(!1),m=zm.bind(null,ut,!1,c.queue),c=en(),f={state:a,dispatch:null,action:s,pending:null},c.queue=f,l=bS.bind(null,ut,f,m,l),f.dispatch=l,c.memoizedState=s,[a,l,!1]}function yb(s){var a=ms();return vb(a,Ut,s)}function vb(s,a,l){if(a=Im(s,a,xb)[0],s=Cd(rr)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Sc(a)}catch(v){throw v===Kl?vd:v}else c=a;a=ms();var f=a.queue,m=f.dispatch;return l!==a.memoizedState&&(ut.flags|=2048,to(9,{destroy:void 0},yS.bind(null,f,l),null)),[c,m,s]}function yS(s,a){s.action=a}function wb(s){var a=ms(),l=Ut;if(l!==null)return vb(a,l,s);ms(),a=a.memoizedState,l=ms();var c=l.queue.dispatch;return l.memoizedState=s,[a,c,!1]}function to(s,a,l,c){return s={tag:s,create:l,deps:c,inst:a,next:null},a=ut.updateQueue,a===null&&(a=Ad(),ut.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=s.next=s:(c=l.next,l.next=s,s.next=c,a.lastEffect=s),s}function Nb(){return ms().memoizedState}function Rd(s,a,l,c){var f=en();ut.flags|=s,f.memoizedState=to(1|a,{destroy:void 0},l,c===void 0?null:c)}function Id(s,a,l,c){var f=ms();c=c===void 0?null:c;var m=f.memoizedState.inst;Ut!==null&&c!==null&&Em(c,Ut.memoizedState.deps)?f.memoizedState=to(a,m,l,c):(ut.flags|=s,f.memoizedState=to(1|a,m,l,c))}function _b(s,a){Rd(8390656,8,s,a)}function Pm(s,a){Id(2048,8,s,a)}function vS(s){ut.flags|=4;var a=ut.updateQueue;if(a===null)a=Ad(),ut.updateQueue=a,a.events=[s];else{var l=a.events;l===null?a.events=[s]:l.push(s)}}function jb(s){var a=ms().memoizedState;return vS({ref:a,nextImpl:s}),function(){if((Rt&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function Sb(s,a){return Id(4,2,s,a)}function Eb(s,a){return Id(4,4,s,a)}function Tb(s,a){if(typeof a=="function"){s=s();var l=a(s);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function Ab(s,a,l){l=l!=null?l.concat([s]):null,Id(4,4,Tb.bind(null,a,s),l)}function Vm(){}function kb(s,a){var l=ms();a=a===void 0?null:a;var c=l.memoizedState;return a!==null&&Em(a,c[1])?c[0]:(l.memoizedState=[s,a],s)}function Cb(s,a){var l=ms();a=a===void 0?null:a;var c=l.memoizedState;if(a!==null&&Em(a,c[1]))return c[0];if(c=s(),Zi){xs(!0);try{s()}finally{xs(!1)}}return l.memoizedState=[c,a],c}function Lm(s,a,l){return l===void 0||(ar&1073741824)!==0&&(xt&261930)===0?s.memoizedState=a:(s.memoizedState=l,s=Ry(),ut.lanes|=s,Yr|=s,l)}function Rb(s,a,l,c){return An(l,a)?l:Jl.current!==null?(s=Lm(s,l,c),An(s,a)||(js=!0),s):(ar&42)===0||(ar&1073741824)!==0&&(xt&261930)===0?(js=!0,s.memoizedState=l):(s=Ry(),ut.lanes|=s,Yr|=s,a)}function Ib(s,a,l,c,f){var m=Q.p;Q.p=m!==0&&8>m?m:8;var v=O.T,C={};O.T=C,zm(s,!1,a,l);try{var q=f(),te=O.S;if(te!==null&&te(C,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var he=pS(q,c);Ec(s,a,he,Mn(s))}else Ec(s,a,c,Mn(s))}catch(be){Ec(s,a,{then:function(){},status:"rejected",reason:be},Mn())}finally{Q.p=m,v!==null&&C.types!==null&&(v.types=C.types),O.T=v}}function wS(){}function Um(s,a,l,c){if(s.tag!==5)throw Error(i(476));var f=Db(s).queue;Ib(s,f,a,le,l===null?wS:function(){return Mb(s),l(c)})}function Db(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:le},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:l},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function Mb(s){var a=Db(s);a.next===null&&(a=s.alternate.memoizedState),Ec(s,a.next.queue,{},Mn())}function Bm(){return Vs($c)}function Ob(){return ms().memoizedState}function Pb(){return ms().memoizedState}function NS(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var l=Mn();s=zr(l);var c=Fr(a,s,l);c!==null&&(pn(c,a,l),wc(c,a,l)),a={cache:pm()},s.payload=a;return}a=a.return}}function _S(s,a,l){var c=Mn();l={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Dd(s)?Lb(a,l):(l=am(s,a,l,c),l!==null&&(pn(l,s,c),Ub(l,a,c)))}function Vb(s,a,l){var c=Mn();Ec(s,a,l,c)}function Ec(s,a,l,c){var f={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Dd(s))Lb(a,f);else{var m=s.alternate;if(s.lanes===0&&(m===null||m.lanes===0)&&(m=a.lastRenderedReducer,m!==null))try{var v=a.lastRenderedState,C=m(v,l);if(f.hasEagerState=!0,f.eagerState=C,An(C,v))return fd(s,a,f,0),$t===null&&hd(),!1}catch{}if(l=am(s,a,f,c),l!==null)return pn(l,s,c),Ub(l,a,c),!0}return!1}function zm(s,a,l,c){if(c={lane:2,revertLane:yp(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Dd(s)){if(a)throw Error(i(479))}else a=am(s,l,c,2),a!==null&&pn(a,s,2)}function Dd(s){var a=s.alternate;return s===ut||a!==null&&a===ut}function Lb(s,a){Zl=Ed=!0;var l=s.pending;l===null?a.next=a:(a.next=l.next,l.next=a),s.pending=a}function Ub(s,a,l){if((l&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,l|=c,a.lanes=l,na(s,l)}}var Tc={readContext:Vs,use:kd,useCallback:ls,useContext:ls,useEffect:ls,useImperativeHandle:ls,useLayoutEffect:ls,useInsertionEffect:ls,useMemo:ls,useReducer:ls,useRef:ls,useState:ls,useDebugValue:ls,useDeferredValue:ls,useTransition:ls,useSyncExternalStore:ls,useId:ls,useHostTransitionStatus:ls,useFormState:ls,useActionState:ls,useOptimistic:ls,useMemoCache:ls,useCacheRefresh:ls};Tc.useEffectEvent=ls;var Bb={readContext:Vs,use:kd,useCallback:function(s,a){return en().memoizedState=[s,a===void 0?null:a],s},useContext:Vs,useEffect:_b,useImperativeHandle:function(s,a,l){l=l!=null?l.concat([s]):null,Rd(4194308,4,Tb.bind(null,a,s),l)},useLayoutEffect:function(s,a){return Rd(4194308,4,s,a)},useInsertionEffect:function(s,a){Rd(4,2,s,a)},useMemo:function(s,a){var l=en();a=a===void 0?null:a;var c=s();if(Zi){xs(!0);try{s()}finally{xs(!1)}}return l.memoizedState=[c,a],c},useReducer:function(s,a,l){var c=en();if(l!==void 0){var f=l(a);if(Zi){xs(!0);try{l(a)}finally{xs(!1)}}}else f=a;return c.memoizedState=c.baseState=f,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:f},c.queue=s,s=s.dispatch=_S.bind(null,ut,s),[c.memoizedState,s]},useRef:function(s){var a=en();return s={current:s},a.memoizedState=s},useState:function(s){s=Mm(s);var a=s.queue,l=Vb.bind(null,ut,a);return a.dispatch=l,[s.memoizedState,l]},useDebugValue:Vm,useDeferredValue:function(s,a){var l=en();return Lm(l,s,a)},useTransition:function(){var s=Mm(!1);return s=Ib.bind(null,ut,s.queue,!0,!1),en().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,l){var c=ut,f=en();if(Nt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),$t===null)throw Error(i(349));(xt&127)!==0||lb(c,a,l)}f.memoizedState=l;var m={value:l,getSnapshot:a};return f.queue=m,_b(cb.bind(null,c,m,s),[s]),c.flags|=2048,to(9,{destroy:void 0},ob.bind(null,c,m,l,a),null),l},useId:function(){var s=en(),a=$t.identifierPrefix;if(Nt){var l=Ma,c=Da;l=(c&~(1<<32-$(c)-1)).toString(32)+l,a="_"+a+"R_"+l,l=Td++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=gS++,a="_"+a+"r_"+l.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:Bm,useFormState:bb,useActionState:bb,useOptimistic:function(s){var a=en();a.memoizedState=a.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=zm.bind(null,ut,!0,l),l.dispatch=a,[s,a]},useMemoCache:Rm,useCacheRefresh:function(){return en().memoizedState=NS.bind(null,ut)},useEffectEvent:function(s){var a=en(),l={impl:s};return a.memoizedState=l,function(){if((Rt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},Fm={readContext:Vs,use:kd,useCallback:kb,useContext:Vs,useEffect:Pm,useImperativeHandle:Ab,useInsertionEffect:Sb,useLayoutEffect:Eb,useMemo:Cb,useReducer:Cd,useRef:Nb,useState:function(){return Cd(rr)},useDebugValue:Vm,useDeferredValue:function(s,a){var l=ms();return Rb(l,Ut.memoizedState,s,a)},useTransition:function(){var s=Cd(rr)[0],a=ms().memoizedState;return[typeof s=="boolean"?s:Sc(s),a]},useSyncExternalStore:ib,useId:Ob,useHostTransitionStatus:Bm,useFormState:yb,useActionState:yb,useOptimistic:function(s,a){var l=ms();return hb(l,Ut,s,a)},useMemoCache:Rm,useCacheRefresh:Pb};Fm.useEffectEvent=jb;var zb={readContext:Vs,use:kd,useCallback:kb,useContext:Vs,useEffect:Pm,useImperativeHandle:Ab,useInsertionEffect:Sb,useLayoutEffect:Eb,useMemo:Cb,useReducer:Dm,useRef:Nb,useState:function(){return Dm(rr)},useDebugValue:Vm,useDeferredValue:function(s,a){var l=ms();return Ut===null?Lm(l,s,a):Rb(l,Ut.memoizedState,s,a)},useTransition:function(){var s=Dm(rr)[0],a=ms().memoizedState;return[typeof s=="boolean"?s:Sc(s),a]},useSyncExternalStore:ib,useId:Ob,useHostTransitionStatus:Bm,useFormState:wb,useActionState:wb,useOptimistic:function(s,a){var l=ms();return Ut!==null?hb(l,Ut,s,a):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:Rm,useCacheRefresh:Pb};zb.useEffectEvent=jb;function $m(s,a,l,c){a=s.memoizedState,l=l(c,a),l=l==null?a:w({},a,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var qm={enqueueSetState:function(s,a,l){s=s._reactInternals;var c=Mn(),f=zr(c);f.payload=a,l!=null&&(f.callback=l),a=Fr(s,f,c),a!==null&&(pn(a,s,c),wc(a,s,c))},enqueueReplaceState:function(s,a,l){s=s._reactInternals;var c=Mn(),f=zr(c);f.tag=1,f.payload=a,l!=null&&(f.callback=l),a=Fr(s,f,c),a!==null&&(pn(a,s,c),wc(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var l=Mn(),c=zr(l);c.tag=2,a!=null&&(c.callback=a),a=Fr(s,c,l),a!==null&&(pn(a,s,l),wc(a,s,l))}};function Fb(s,a,l,c,f,m,v){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,m,v):a.prototype&&a.prototype.isPureReactComponent?!fc(l,c)||!fc(f,m):!0}function $b(s,a,l,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,c),a.state!==s&&qm.enqueueReplaceState(a,a.state,null)}function el(s,a){var l=a;if("ref"in a){l={};for(var c in a)c!=="ref"&&(l[c]=a[c])}if(s=s.defaultProps){l===a&&(l=w({},l));for(var f in s)l[f]===void 0&&(l[f]=s[f])}return l}function qb(s){dd(s)}function Hb(s){console.error(s)}function Gb(s){dd(s)}function Md(s,a){try{var l=s.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Yb(s,a,l){try{var c=s.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Hm(s,a,l){return l=zr(l),l.tag=3,l.payload={element:null},l.callback=function(){Md(s,a)},l}function Wb(s){return s=zr(s),s.tag=3,s}function Qb(s,a,l,c){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;s.payload=function(){return f(m)},s.callback=function(){Yb(a,l,c)}}var v=l.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){Yb(a,l,c),typeof f!="function"&&(Wr===null?Wr=new Set([this]):Wr.add(this));var C=c.stack;this.componentDidCatch(c.value,{componentStack:C!==null?C:""})})}function jS(s,a,l,c,f){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=l.alternate,a!==null&&Yl(a,l,f,!0),l=Cn.current,l!==null){switch(l.tag){case 31:case 13:return Qn===null?Gd():l.alternate===null&&os===0&&(os=3),l.flags&=-257,l.flags|=65536,l.lanes=f,c===wd?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([c]):a.add(c),gp(s,c,f)),!1;case 22:return l.flags|=65536,c===wd?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([c]):l.add(c)),gp(s,c,f)),!1}throw Error(i(435,l.tag))}return gp(s,c,f),Gd(),!1}if(Nt)return a=Cn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=f,c!==um&&(s=Error(i(422),{cause:c}),gc(Hn(s,l)))):(c!==um&&(a=Error(i(423),{cause:c}),gc(Hn(a,l))),s=s.current.alternate,s.flags|=65536,f&=-f,s.lanes|=f,c=Hn(c,l),f=Hm(s.stateNode,c,f),wm(s,f),os!==4&&(os=2)),!1;var m=Error(i(520),{cause:c});if(m=Hn(m,l),Oc===null?Oc=[m]:Oc.push(m),os!==4&&(os=2),a===null)return!0;c=Hn(c,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,s=f&-f,l.lanes|=s,s=Hm(l.stateNode,c,s),wm(l,s),!1;case 1:if(a=l.type,m=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Wr===null||!Wr.has(m))))return l.flags|=65536,f&=-f,l.lanes|=f,f=Wb(f),Qb(f,s,l,c),wm(l,f),!1}l=l.return}while(l!==null);return!1}var Gm=Error(i(461)),js=!1;function Ls(s,a,l,c){a.child=s===null?Zx(a,null,l,c):Ji(a,s.child,l,c)}function Kb(s,a,l,c,f){l=l.render;var m=a.ref;if("ref"in c){var v={};for(var C in c)C!=="ref"&&(v[C]=c[C])}else v=c;return Wi(a),c=Tm(s,a,l,v,m,f),C=Am(),s!==null&&!js?(km(s,a,f),ir(s,a,f)):(Nt&&C&&om(a),a.flags|=1,Ls(s,a,c,f),a.child)}function Xb(s,a,l,c,f){if(s===null){var m=l.type;return typeof m=="function"&&!rm(m)&&m.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=m,Jb(s,a,m,c,f)):(s=pd(l.type,null,c,a,a.mode,f),s.ref=a.ref,s.return=a,a.child=s)}if(m=s.child,!ep(s,f)){var v=m.memoizedProps;if(l=l.compare,l=l!==null?l:fc,l(v,c)&&s.ref===a.ref)return ir(s,a,f)}return a.flags|=1,s=er(m,c),s.ref=a.ref,s.return=a,a.child=s}function Jb(s,a,l,c,f){if(s!==null){var m=s.memoizedProps;if(fc(m,c)&&s.ref===a.ref)if(js=!1,a.pendingProps=c=m,ep(s,f))(s.flags&131072)!==0&&(js=!0);else return a.lanes=s.lanes,ir(s,a,f)}return Ym(s,a,l,c,f)}function Zb(s,a,l,c){var f=c.children,m=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(m=m!==null?m.baseLanes|l:l,s!==null){for(c=a.child=s.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,a.child=null;return ey(s,a,m,l,c)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&yd(a,m!==null?m.cachePool:null),m!==null?sb(a,m):_m(),nb(a);else return c=a.lanes=536870912,ey(s,a,m!==null?m.baseLanes|l:l,l,c)}else m!==null?(yd(a,m.cachePool),sb(a,m),qr(),a.memoizedState=null):(s!==null&&yd(a,null),_m(),qr());return Ls(s,a,f,l),a.child}function Ac(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function ey(s,a,l,c,f){var m=xm();return m=m===null?null:{parent:Ns._currentValue,pool:m},a.memoizedState={baseLanes:l,cachePool:m},s!==null&&yd(a,null),_m(),nb(a),s!==null&&Yl(s,a,c,!0),a.childLanes=f,null}function Od(s,a){return a=Vd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function ty(s,a,l){return Ji(a,s.child,null,l),s=Od(a,a.pendingProps),s.flags|=2,Rn(a),a.memoizedState=null,s}function SS(s,a,l){var c=a.pendingProps,f=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(Nt){if(c.mode==="hidden")return s=Od(a,c),a.lanes=536870912,Ac(null,s);if(Sm(a),(s=Qt)?(s=fv(s,Wn),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Pr!==null?{id:Da,overflow:Ma}:null,retryLane:536870912,hydrationErrors:null},l=Lx(s),l.return=a,a.child=l,Ps=a,Qt=null)):s=null,s===null)throw Lr(a);return a.lanes=536870912,null}return Od(a,c)}var m=s.memoizedState;if(m!==null){var v=m.dehydrated;if(Sm(a),f)if(a.flags&256)a.flags&=-257,a=ty(s,a,l);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(js||Yl(s,a,l,!1),f=(l&s.childLanes)!==0,js||f){if(c=$t,c!==null&&(v=aa(c,l),v!==0&&v!==m.retryLane))throw m.retryLane=v,qi(s,v),pn(c,s,v),Gm;Gd(),a=ty(s,a,l)}else s=m.treeContext,Qt=Kn(v.nextSibling),Ps=a,Nt=!0,Vr=null,Wn=!1,s!==null&&zx(a,s),a=Od(a,c),a.flags|=4096;return a}return s=er(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Pd(s,a){var l=a.ref;if(l===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(a.flags|=4194816)}}function Ym(s,a,l,c,f){return Wi(a),l=Tm(s,a,l,c,void 0,f),c=Am(),s!==null&&!js?(km(s,a,f),ir(s,a,f)):(Nt&&c&&om(a),a.flags|=1,Ls(s,a,l,f),a.child)}function sy(s,a,l,c,f,m){return Wi(a),a.updateQueue=null,l=rb(a,c,l,f),ab(s),c=Am(),s!==null&&!js?(km(s,a,m),ir(s,a,m)):(Nt&&c&&om(a),a.flags|=1,Ls(s,a,l,m),a.child)}function ny(s,a,l,c,f){if(Wi(a),a.stateNode===null){var m=$l,v=l.contextType;typeof v=="object"&&v!==null&&(m=Vs(v)),m=new l(c,m),a.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=qm,a.stateNode=m,m._reactInternals=a,m=a.stateNode,m.props=c,m.state=a.memoizedState,m.refs={},ym(a),v=l.contextType,m.context=typeof v=="object"&&v!==null?Vs(v):$l,m.state=a.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&($m(a,l,v,c),m.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(v=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),v!==m.state&&qm.enqueueReplaceState(m,m.state,null),_c(a,c,m,f),Nc(),m.state=a.memoizedState),typeof m.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){m=a.stateNode;var C=a.memoizedProps,q=el(l,C);m.props=q;var te=m.context,he=l.contextType;v=$l,typeof he=="object"&&he!==null&&(v=Vs(he));var be=l.getDerivedStateFromProps;he=typeof be=="function"||typeof m.getSnapshotBeforeUpdate=="function",C=a.pendingProps!==C,he||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(C||te!==v)&&$b(a,m,c,v),Br=!1;var se=a.memoizedState;m.state=se,_c(a,c,m,f),Nc(),te=a.memoizedState,C||se!==te||Br?(typeof be=="function"&&($m(a,l,be,c),te=a.memoizedState),(q=Br||Fb(a,l,q,c,se,te,v))?(he||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(a.flags|=4194308)):(typeof m.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=te),m.props=c,m.state=te,m.context=v,c=q):(typeof m.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{m=a.stateNode,vm(s,a),v=a.memoizedProps,he=el(l,v),m.props=he,be=a.pendingProps,se=m.context,te=l.contextType,q=$l,typeof te=="object"&&te!==null&&(q=Vs(te)),C=l.getDerivedStateFromProps,(te=typeof C=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==be||se!==q)&&$b(a,m,c,q),Br=!1,se=a.memoizedState,m.state=se,_c(a,c,m,f),Nc();var oe=a.memoizedState;v!==be||se!==oe||Br||s!==null&&s.dependencies!==null&&xd(s.dependencies)?(typeof C=="function"&&($m(a,l,C,c),oe=a.memoizedState),(he=Br||Fb(a,l,he,c,se,oe,q)||s!==null&&s.dependencies!==null&&xd(s.dependencies))?(te||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,oe,q),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,oe,q)),typeof m.componentDidUpdate=="function"&&(a.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===s.memoizedProps&&se===s.memoizedState||(a.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&se===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=oe),m.props=c,m.state=oe,m.context=q,c=he):(typeof m.componentDidUpdate!="function"||v===s.memoizedProps&&se===s.memoizedState||(a.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&se===s.memoizedState||(a.flags|=1024),c=!1)}return m=c,Pd(s,a),c=(a.flags&128)!==0,m||c?(m=a.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:m.render(),a.flags|=1,s!==null&&c?(a.child=Ji(a,s.child,null,f),a.child=Ji(a,null,l,f)):Ls(s,a,l,f),a.memoizedState=m.state,s=a.child):s=ir(s,a,f),s}function ay(s,a,l,c){return Gi(),a.flags|=256,Ls(s,a,l,c),a.child}var Wm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qm(s){return{baseLanes:s,cachePool:Yx()}}function Km(s,a,l){return s=s!==null?s.childLanes&~l:0,a&&(s|=Dn),s}function ry(s,a,l){var c=a.pendingProps,f=!1,m=(a.flags&128)!==0,v;if((v=m)||(v=s!==null&&s.memoizedState===null?!1:(fs.current&2)!==0),v&&(f=!0,a.flags&=-129),v=(a.flags&32)!==0,a.flags&=-33,s===null){if(Nt){if(f?$r(a):qr(),(s=Qt)?(s=fv(s,Wn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Pr!==null?{id:Da,overflow:Ma}:null,retryLane:536870912,hydrationErrors:null},l=Lx(s),l.return=a,a.child=l,Ps=a,Qt=null)):s=null,s===null)throw Lr(a);return Ip(s)?a.lanes=32:a.lanes=536870912,null}var C=c.children;return c=c.fallback,f?(qr(),f=a.mode,C=Vd({mode:"hidden",children:C},f),c=Hi(c,f,l,null),C.return=a,c.return=a,C.sibling=c,a.child=C,c=a.child,c.memoizedState=Qm(l),c.childLanes=Km(s,v,l),a.memoizedState=Wm,Ac(null,c)):($r(a),Xm(a,C))}var q=s.memoizedState;if(q!==null&&(C=q.dehydrated,C!==null)){if(m)a.flags&256?($r(a),a.flags&=-257,a=Jm(s,a,l)):a.memoizedState!==null?(qr(),a.child=s.child,a.flags|=128,a=null):(qr(),C=c.fallback,f=a.mode,c=Vd({mode:"visible",children:c.children},f),C=Hi(C,f,l,null),C.flags|=2,c.return=a,C.return=a,c.sibling=C,a.child=c,Ji(a,s.child,null,l),c=a.child,c.memoizedState=Qm(l),c.childLanes=Km(s,v,l),a.memoizedState=Wm,a=Ac(null,c));else if($r(a),Ip(C)){if(v=C.nextSibling&&C.nextSibling.dataset,v)var te=v.dgst;v=te,c=Error(i(419)),c.stack="",c.digest=v,gc({value:c,source:null,stack:null}),a=Jm(s,a,l)}else if(js||Yl(s,a,l,!1),v=(l&s.childLanes)!==0,js||v){if(v=$t,v!==null&&(c=aa(v,l),c!==0&&c!==q.retryLane))throw q.retryLane=c,qi(s,c),pn(v,s,c),Gm;Rp(C)||Gd(),a=Jm(s,a,l)}else Rp(C)?(a.flags|=192,a.child=s.child,a=null):(s=q.treeContext,Qt=Kn(C.nextSibling),Ps=a,Nt=!0,Vr=null,Wn=!1,s!==null&&zx(a,s),a=Xm(a,c.children),a.flags|=4096);return a}return f?(qr(),C=c.fallback,f=a.mode,q=s.child,te=q.sibling,c=er(q,{mode:"hidden",children:c.children}),c.subtreeFlags=q.subtreeFlags&65011712,te!==null?C=er(te,C):(C=Hi(C,f,l,null),C.flags|=2),C.return=a,c.return=a,c.sibling=C,a.child=c,Ac(null,c),c=a.child,C=s.child.memoizedState,C===null?C=Qm(l):(f=C.cachePool,f!==null?(q=Ns._currentValue,f=f.parent!==q?{parent:q,pool:q}:f):f=Yx(),C={baseLanes:C.baseLanes|l,cachePool:f}),c.memoizedState=C,c.childLanes=Km(s,v,l),a.memoizedState=Wm,Ac(s.child,c)):($r(a),l=s.child,s=l.sibling,l=er(l,{mode:"visible",children:c.children}),l.return=a,l.sibling=null,s!==null&&(v=a.deletions,v===null?(a.deletions=[s],a.flags|=16):v.push(s)),a.child=l,a.memoizedState=null,l)}function Xm(s,a){return a=Vd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Vd(s,a){return s=kn(22,s,null,a),s.lanes=0,s}function Jm(s,a,l){return Ji(a,s.child,null,l),s=Xm(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function iy(s,a,l){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),fm(s.return,a,l)}function Zm(s,a,l,c,f,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:f,treeForkCount:m}:(v.isBackwards=a,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=l,v.tailMode=f,v.treeForkCount=m)}function ly(s,a,l){var c=a.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var v=fs.current,C=(v&2)!==0;if(C?(v=v&1|2,a.flags|=128):v&=1,ue(fs,v),Ls(s,a,c,l),c=Nt?pc:0,!C&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&iy(s,l,a);else if(s.tag===19)iy(s,l,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(f){case"forwards":for(l=a.child,f=null;l!==null;)s=l.alternate,s!==null&&Sd(s)===null&&(f=l),l=l.sibling;l=f,l===null?(f=a.child,a.child=null):(f=l.sibling,l.sibling=null),Zm(a,!1,f,l,m,c);break;case"backwards":case"unstable_legacy-backwards":for(l=null,f=a.child,a.child=null;f!==null;){if(s=f.alternate,s!==null&&Sd(s)===null){a.child=f;break}s=f.sibling,f.sibling=l,l=f,f=s}Zm(a,!0,l,null,m,c);break;case"together":Zm(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function ir(s,a,l){if(s!==null&&(a.dependencies=s.dependencies),Yr|=a.lanes,(l&a.childLanes)===0)if(s!==null){if(Yl(s,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,l=er(s,s.pendingProps),a.child=l,l.return=a;s.sibling!==null;)s=s.sibling,l=l.sibling=er(s,s.pendingProps),l.return=a;l.sibling=null}return a.child}function ep(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&xd(s)))}function ES(s,a,l){switch(a.tag){case 3:At(a,a.stateNode.containerInfo),Ur(a,Ns,s.memoizedState.cache),Gi();break;case 27:case 5:rs(a);break;case 4:At(a,a.stateNode.containerInfo);break;case 10:Ur(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Sm(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?($r(a),a.flags|=128,null):(l&a.child.childLanes)!==0?ry(s,a,l):($r(a),s=ir(s,a,l),s!==null?s.sibling:null);$r(a);break;case 19:var f=(s.flags&128)!==0;if(c=(l&a.childLanes)!==0,c||(Yl(s,a,l,!1),c=(l&a.childLanes)!==0),f){if(c)return ly(s,a,l);a.flags|=128}if(f=a.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ue(fs,fs.current),c)break;return null;case 22:return a.lanes=0,Zb(s,a,l,a.pendingProps);case 24:Ur(a,Ns,s.memoizedState.cache)}return ir(s,a,l)}function oy(s,a,l){if(s!==null)if(s.memoizedProps!==a.pendingProps)js=!0;else{if(!ep(s,l)&&(a.flags&128)===0)return js=!1,ES(s,a,l);js=(s.flags&131072)!==0}else js=!1,Nt&&(a.flags&1048576)!==0&&Bx(a,pc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=Ki(a.elementType),a.type=s,typeof s=="function")rm(s)?(c=el(s,c),a.tag=1,a=ny(null,a,s,c,l)):(a.tag=0,a=Ym(null,a,s,c,l));else{if(s!=null){var f=s.$$typeof;if(f===ie){a.tag=11,a=Kb(null,a,s,c,l);break e}else if(f===A){a.tag=14,a=Xb(null,a,s,c,l);break e}}throw a=L(s)||s,Error(i(306,a,""))}}return a;case 0:return Ym(s,a,a.type,a.pendingProps,l);case 1:return c=a.type,f=el(c,a.pendingProps),ny(s,a,c,f,l);case 3:e:{if(At(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var m=a.memoizedState;f=m.element,vm(s,a),_c(a,c,null,l);var v=a.memoizedState;if(c=v.cache,Ur(a,Ns,c),c!==m.cache&&mm(a,[Ns],l,!0),Nc(),c=v.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:v.cache},a.updateQueue.baseState=m,a.memoizedState=m,a.flags&256){a=ay(s,a,c,l);break e}else if(c!==f){f=Hn(Error(i(424)),a),gc(f),a=ay(s,a,c,l);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,Qt=Kn(s.firstChild),Ps=a,Nt=!0,Vr=null,Wn=!0,l=Zx(a,null,c,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Gi(),c===f){a=ir(s,a,l);break e}Ls(s,a,c,l)}a=a.child}return a;case 26:return Pd(s,a),s===null?(l=yv(a.type,null,a.pendingProps,null))?a.memoizedState=l:Nt||(l=a.type,s=a.pendingProps,c=Zd(Re.current).createElement(l),c[is]=a,c[ys]=s,Us(c,l,s),vs(c),a.stateNode=c):a.memoizedState=yv(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return rs(a),s===null&&Nt&&(c=a.stateNode=gv(a.type,a.pendingProps,Re.current),Ps=a,Wn=!0,f=Qt,Jr(a.type)?(Dp=f,Qt=Kn(c.firstChild)):Qt=f),Ls(s,a,a.pendingProps.children,l),Pd(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Nt&&((f=c=Qt)&&(c=sE(c,a.type,a.pendingProps,Wn),c!==null?(a.stateNode=c,Ps=a,Qt=Kn(c.firstChild),Wn=!1,f=!0):f=!1),f||Lr(a)),rs(a),f=a.type,m=a.pendingProps,v=s!==null?s.memoizedProps:null,c=m.children,Ap(f,m)?c=null:v!==null&&Ap(f,v)&&(a.flags|=32),a.memoizedState!==null&&(f=Tm(s,a,xS,null,null,l),$c._currentValue=f),Pd(s,a),Ls(s,a,c,l),a.child;case 6:return s===null&&Nt&&((s=l=Qt)&&(l=nE(l,a.pendingProps,Wn),l!==null?(a.stateNode=l,Ps=a,Qt=null,s=!0):s=!1),s||Lr(a)),null;case 13:return ry(s,a,l);case 4:return At(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Ji(a,null,c,l):Ls(s,a,c,l),a.child;case 11:return Kb(s,a,a.type,a.pendingProps,l);case 7:return Ls(s,a,a.pendingProps,l),a.child;case 8:return Ls(s,a,a.pendingProps.children,l),a.child;case 12:return Ls(s,a,a.pendingProps.children,l),a.child;case 10:return c=a.pendingProps,Ur(a,a.type,c.value),Ls(s,a,c.children,l),a.child;case 9:return f=a.type._context,c=a.pendingProps.children,Wi(a),f=Vs(f),c=c(f),a.flags|=1,Ls(s,a,c,l),a.child;case 14:return Xb(s,a,a.type,a.pendingProps,l);case 15:return Jb(s,a,a.type,a.pendingProps,l);case 19:return ly(s,a,l);case 31:return SS(s,a,l);case 22:return Zb(s,a,l,a.pendingProps);case 24:return Wi(a),c=Vs(Ns),s===null?(f=xm(),f===null&&(f=$t,m=pm(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=l),f=m),a.memoizedState={parent:c,cache:f},ym(a),Ur(a,Ns,f)):((s.lanes&l)!==0&&(vm(s,a),_c(a,null,null,l),Nc()),f=s.memoizedState,m=a.memoizedState,f.parent!==c?(f={parent:c,cache:c},a.memoizedState=f,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=f),Ur(a,Ns,c)):(c=m.cache,Ur(a,Ns,c),c!==f.cache&&mm(a,[Ns],l,!0))),Ls(s,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function lr(s){s.flags|=4}function tp(s,a,l,c,f){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(f&335544128)===f)if(s.stateNode.complete)s.flags|=8192;else if(Oy())s.flags|=8192;else throw Xi=wd,bm}else s.flags&=-16777217}function cy(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!jv(a))if(Oy())s.flags|=8192;else throw Xi=wd,bm}function Ld(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?ze():536870912,s.lanes|=a,ro|=a)}function kc(s,a){if(!Nt)switch(s.tailMode){case"hidden":a=s.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function Kt(s){var a=s.alternate!==null&&s.alternate.child===s.child,l=0,c=0;if(a)for(var f=s.child;f!==null;)l|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=s,f=f.sibling;else for(f=s.child;f!==null;)l|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=s,f=f.sibling;return s.subtreeFlags|=c,s.childLanes=l,a}function TS(s,a,l){var c=a.pendingProps;switch(cm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(a),null;case 1:return Kt(a),null;case 3:return l=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),nr(Ns),ht(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Gl(a)?lr(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,dm())),Kt(a),null;case 26:var f=a.type,m=a.memoizedState;return s===null?(lr(a),m!==null?(Kt(a),cy(a,m)):(Kt(a),tp(a,f,null,c,l))):m?m!==s.memoizedState?(lr(a),Kt(a),cy(a,m)):(Kt(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&lr(a),Kt(a),tp(a,f,s,c,l)),null;case 27:if(ne(a),l=Re.current,f=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&lr(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return Kt(a),null}s=fe.current,Gl(a)?Fx(a):(s=gv(f,c,l),a.stateNode=s,lr(a))}return Kt(a),null;case 5:if(ne(a),f=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&lr(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return Kt(a),null}if(m=fe.current,Gl(a))Fx(a);else{var v=Zd(Re.current);switch(m){case 1:m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=v.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?v.createElement("select",{is:c.is}):v.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?v.createElement(f,{is:c.is}):v.createElement(f)}}m[is]=a,m[ys]=c;e:for(v=a.child;v!==null;){if(v.tag===5||v.tag===6)m.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===a)break e;for(;v.sibling===null;){if(v.return===null||v.return===a)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}a.stateNode=m;e:switch(Us(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&lr(a)}}return Kt(a),tp(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,l),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&lr(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Re.current,Gl(a)){if(s=a.stateNode,l=a.memoizedProps,c=null,f=Ps,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}s[is]=a,s=!!(s.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||rv(s.nodeValue,l)),s||Lr(a,!0)}else s=Zd(s).createTextNode(c),s[is]=a,a.stateNode=s}return Kt(a),null;case 31:if(l=a.memoizedState,s===null||s.memoizedState!==null){if(c=Gl(a),l!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[is]=a}else Gi(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Kt(a),s=!1}else l=dm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return a.flags&256?(Rn(a),a):(Rn(a),null);if((a.flags&128)!==0)throw Error(i(558))}return Kt(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(f=Gl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!f)throw Error(i(318));if(f=a.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[is]=a}else Gi(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Kt(a),f=!1}else f=dm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),f=!0;if(!f)return a.flags&256?(Rn(a),a):(Rn(a),null)}return Rn(a),(a.flags&128)!==0?(a.lanes=l,a):(l=c!==null,s=s!==null&&s.memoizedState!==null,l&&(c=a.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),l!==s&&l&&(a.child.flags|=8192),Ld(a,a.updateQueue),Kt(a),null);case 4:return ht(),s===null&&_p(a.stateNode.containerInfo),Kt(a),null;case 10:return nr(a.type),Kt(a),null;case 19:if(ee(fs),c=a.memoizedState,c===null)return Kt(a),null;if(f=(a.flags&128)!==0,m=c.rendering,m===null)if(f)kc(c,!1);else{if(os!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(m=Sd(s),m!==null){for(a.flags|=128,kc(c,!1),s=m.updateQueue,a.updateQueue=s,Ld(a,s),a.subtreeFlags=0,s=l,l=a.child;l!==null;)Vx(l,s),l=l.sibling;return ue(fs,fs.current&1|2),Nt&&tr(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&Ue()>$d&&(a.flags|=128,f=!0,kc(c,!1),a.lanes=4194304)}else{if(!f)if(s=Sd(m),s!==null){if(a.flags|=128,f=!0,s=s.updateQueue,a.updateQueue=s,Ld(a,s),kc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!Nt)return Kt(a),null}else 2*Ue()-c.renderingStartTime>$d&&l!==536870912&&(a.flags|=128,f=!0,kc(c,!1),a.lanes=4194304);c.isBackwards?(m.sibling=a.child,a.child=m):(s=c.last,s!==null?s.sibling=m:a.child=m,c.last=m)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Ue(),s.sibling=null,l=fs.current,ue(fs,f?l&1|2:l&1),Nt&&tr(a,c.treeForkCount),s):(Kt(a),null);case 22:case 23:return Rn(a),jm(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(l&536870912)!==0&&(a.flags&128)===0&&(Kt(a),a.subtreeFlags&6&&(a.flags|=8192)):Kt(a),l=a.updateQueue,l!==null&&Ld(a,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==l&&(a.flags|=2048),s!==null&&ee(Qi),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),nr(Ns),Kt(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function AS(s,a){switch(cm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return nr(Ns),ht(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return ne(a),null;case 31:if(a.memoizedState!==null){if(Rn(a),a.alternate===null)throw Error(i(340));Gi()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Rn(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Gi()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return ee(fs),null;case 4:return ht(),null;case 10:return nr(a.type),null;case 22:case 23:return Rn(a),jm(),s!==null&&ee(Qi),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return nr(Ns),null;case 25:return null;default:return null}}function uy(s,a){switch(cm(a),a.tag){case 3:nr(Ns),ht();break;case 26:case 27:case 5:ne(a);break;case 4:ht();break;case 31:a.memoizedState!==null&&Rn(a);break;case 13:Rn(a);break;case 19:ee(fs);break;case 10:nr(a.type);break;case 22:case 23:Rn(a),jm(),s!==null&&ee(Qi);break;case 24:nr(Ns)}}function Cc(s,a){try{var l=a.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var f=c.next;l=f;do{if((l.tag&s)===s){c=void 0;var m=l.create,v=l.inst;c=m(),v.destroy=c}l=l.next}while(l!==f)}}catch(C){Pt(a,a.return,C)}}function Hr(s,a,l){try{var c=a.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&s)===s){var v=c.inst,C=v.destroy;if(C!==void 0){v.destroy=void 0,f=a;var q=l,te=C;try{te()}catch(he){Pt(f,q,he)}}}c=c.next}while(c!==m)}}catch(he){Pt(a,a.return,he)}}function dy(s){var a=s.updateQueue;if(a!==null){var l=s.stateNode;try{tb(a,l)}catch(c){Pt(s,s.return,c)}}}function hy(s,a,l){l.props=el(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(c){Pt(s,a,c)}}function Rc(s,a){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof l=="function"?s.refCleanup=l(c):l.current=c}}catch(f){Pt(s,a,f)}}function Oa(s,a){var l=s.ref,c=s.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(f){Pt(s,a,f)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){Pt(s,a,f)}else l.current=null}function fy(s){var a=s.type,l=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(f){Pt(s,s.return,f)}}function sp(s,a,l){try{var c=s.stateNode;KS(c,s.type,l,a),c[ys]=a}catch(f){Pt(s,s.return,f)}}function my(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Jr(s.type)||s.tag===4}function np(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||my(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Jr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function ap(s,a,l){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(s),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=ia));else if(c!==4&&(c===27&&Jr(s.type)&&(l=s.stateNode,a=null),s=s.child,s!==null))for(ap(s,a,l),s=s.sibling;s!==null;)ap(s,a,l),s=s.sibling}function Ud(s,a,l){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?l.insertBefore(s,a):l.appendChild(s);else if(c!==4&&(c===27&&Jr(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Ud(s,a,l),s=s.sibling;s!==null;)Ud(s,a,l),s=s.sibling}function py(s){var a=s.stateNode,l=s.memoizedProps;try{for(var c=s.type,f=a.attributes;f.length;)a.removeAttributeNode(f[0]);Us(a,c,l),a[is]=s,a[ys]=l}catch(m){Pt(s,s.return,m)}}var or=!1,Ss=!1,rp=!1,gy=typeof WeakSet=="function"?WeakSet:Set,Ds=null;function kS(s,a){if(s=s.containerInfo,Ep=ih,s=Ax(s),Jf(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{l.nodeType,m.nodeType}catch{l=null;break e}var v=0,C=-1,q=-1,te=0,he=0,be=s,se=null;t:for(;;){for(var oe;be!==l||f!==0&&be.nodeType!==3||(C=v+f),be!==m||c!==0&&be.nodeType!==3||(q=v+c),be.nodeType===3&&(v+=be.nodeValue.length),(oe=be.firstChild)!==null;)se=be,be=oe;for(;;){if(be===s)break t;if(se===l&&++te===f&&(C=v),se===m&&++he===c&&(q=v),(oe=be.nextSibling)!==null)break;be=se,se=be.parentNode}be=oe}l=C===-1||q===-1?null:{start:C,end:q}}else l=null}l=l||{start:0,end:0}}else l=null;for(Tp={focusedElem:s,selectionRange:l},ih=!1,Ds=a;Ds!==null;)if(a=Ds,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Ds=s;else for(;Ds!==null;){switch(a=Ds,m=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)f=s[l],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&m!==null){s=void 0,l=a,f=m.memoizedProps,m=m.memoizedState,c=l.stateNode;try{var Pe=el(l.type,f);s=c.getSnapshotBeforeUpdate(Pe,m),c.__reactInternalSnapshotBeforeUpdate=s}catch(Je){Pt(l,l.return,Je)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,l=s.nodeType,l===9)Cp(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Cp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,Ds=s;break}Ds=a.return}}function xy(s,a,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:ur(s,l),c&4&&Cc(5,l);break;case 1:if(ur(s,l),c&4)if(s=l.stateNode,a===null)try{s.componentDidMount()}catch(v){Pt(l,l.return,v)}else{var f=el(l.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(f,a,s.__reactInternalSnapshotBeforeUpdate)}catch(v){Pt(l,l.return,v)}}c&64&&dy(l),c&512&&Rc(l,l.return);break;case 3:if(ur(s,l),c&64&&(s=l.updateQueue,s!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{tb(s,a)}catch(v){Pt(l,l.return,v)}}break;case 27:a===null&&c&4&&py(l);case 26:case 5:ur(s,l),a===null&&c&4&&fy(l),c&512&&Rc(l,l.return);break;case 12:ur(s,l);break;case 31:ur(s,l),c&4&&vy(s,l);break;case 13:ur(s,l),c&4&&wy(s,l),c&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=LS.bind(null,l),aE(s,l))));break;case 22:if(c=l.memoizedState!==null||or,!c){a=a!==null&&a.memoizedState!==null||Ss,f=or;var m=Ss;or=c,(Ss=a)&&!m?dr(s,l,(l.subtreeFlags&8772)!==0):ur(s,l),or=f,Ss=m}break;case 30:break;default:ur(s,l)}}function by(s){var a=s.alternate;a!==null&&(s.alternate=null,by(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&kl(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var es=null,dn=!1;function cr(s,a,l){for(l=l.child;l!==null;)yy(s,a,l),l=l.sibling}function yy(s,a,l){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(gs,l)}catch{}switch(l.tag){case 26:Ss||Oa(l,a),cr(s,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ss||Oa(l,a);var c=es,f=dn;Jr(l.type)&&(es=l.stateNode,dn=!1),cr(s,a,l),Bc(l.stateNode),es=c,dn=f;break;case 5:Ss||Oa(l,a);case 6:if(c=es,f=dn,es=null,cr(s,a,l),es=c,dn=f,es!==null)if(dn)try{(es.nodeType===9?es.body:es.nodeName==="HTML"?es.ownerDocument.body:es).removeChild(l.stateNode)}catch(m){Pt(l,a,m)}else try{es.removeChild(l.stateNode)}catch(m){Pt(l,a,m)}break;case 18:es!==null&&(dn?(s=es,dv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),mo(s)):dv(es,l.stateNode));break;case 4:c=es,f=dn,es=l.stateNode.containerInfo,dn=!0,cr(s,a,l),es=c,dn=f;break;case 0:case 11:case 14:case 15:Hr(2,l,a),Ss||Hr(4,l,a),cr(s,a,l);break;case 1:Ss||(Oa(l,a),c=l.stateNode,typeof c.componentWillUnmount=="function"&&hy(l,a,c)),cr(s,a,l);break;case 21:cr(s,a,l);break;case 22:Ss=(c=Ss)||l.memoizedState!==null,cr(s,a,l),Ss=c;break;default:cr(s,a,l)}}function vy(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{mo(s)}catch(l){Pt(a,a.return,l)}}}function wy(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{mo(s)}catch(l){Pt(a,a.return,l)}}function CS(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new gy),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new gy),a;default:throw Error(i(435,s.tag))}}function Bd(s,a){var l=CS(s);a.forEach(function(c){if(!l.has(c)){l.add(c);var f=US.bind(null,s,c);c.then(f,f)}})}function hn(s,a){var l=a.deletions;if(l!==null)for(var c=0;c<l.length;c++){var f=l[c],m=s,v=a,C=v;e:for(;C!==null;){switch(C.tag){case 27:if(Jr(C.type)){es=C.stateNode,dn=!1;break e}break;case 5:es=C.stateNode,dn=!1;break e;case 3:case 4:es=C.stateNode.containerInfo,dn=!0;break e}C=C.return}if(es===null)throw Error(i(160));yy(m,v,f),es=null,dn=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Ny(a,s),a=a.sibling}var ha=null;function Ny(s,a){var l=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:hn(a,s),fn(s),c&4&&(Hr(3,s,s.return),Cc(3,s),Hr(5,s,s.return));break;case 1:hn(a,s),fn(s),c&512&&(Ss||l===null||Oa(l,l.return)),c&64&&or&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var f=ha;if(hn(a,s),fn(s),c&512&&(Ss||l===null||Oa(l,l.return)),c&4){var m=l!==null?l.memoizedState:null;if(c=s.memoizedState,l===null)if(c===null)if(s.stateNode===null){e:{c=s.type,l=s.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[wa]||m[is]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Us(m,c,l),m[is]=s,vs(m),c=m;break e;case"link":var v=Nv("link","href",f).get(c+(l.href||""));if(v){for(var C=0;C<v.length;C++)if(m=v[C],m.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&m.getAttribute("rel")===(l.rel==null?null:l.rel)&&m.getAttribute("title")===(l.title==null?null:l.title)&&m.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){v.splice(C,1);break t}}m=f.createElement(c),Us(m,c,l),f.head.appendChild(m);break;case"meta":if(v=Nv("meta","content",f).get(c+(l.content||""))){for(C=0;C<v.length;C++)if(m=v[C],m.getAttribute("content")===(l.content==null?null:""+l.content)&&m.getAttribute("name")===(l.name==null?null:l.name)&&m.getAttribute("property")===(l.property==null?null:l.property)&&m.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&m.getAttribute("charset")===(l.charSet==null?null:l.charSet)){v.splice(C,1);break t}}m=f.createElement(c),Us(m,c,l),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[is]=s,vs(m),c=m}s.stateNode=c}else _v(f,s.type,s.stateNode);else s.stateNode=wv(f,c,s.memoizedProps);else m!==c?(m===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):m.count--,c===null?_v(f,s.type,s.stateNode):wv(f,c,s.memoizedProps)):c===null&&s.stateNode!==null&&sp(s,s.memoizedProps,l.memoizedProps)}break;case 27:hn(a,s),fn(s),c&512&&(Ss||l===null||Oa(l,l.return)),l!==null&&c&4&&sp(s,s.memoizedProps,l.memoizedProps);break;case 5:if(hn(a,s),fn(s),c&512&&(Ss||l===null||Oa(l,l.return)),s.flags&32){f=s.stateNode;try{un(f,"")}catch(Pe){Pt(s,s.return,Pe)}}c&4&&s.stateNode!=null&&(f=s.memoizedProps,sp(s,f,l!==null?l.memoizedProps:f)),c&1024&&(rp=!0);break;case 6:if(hn(a,s),fn(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,l=s.stateNode;try{l.nodeValue=c}catch(Pe){Pt(s,s.return,Pe)}}break;case 3:if(sh=null,f=ha,ha=eh(a.containerInfo),hn(a,s),ha=f,fn(s),c&4&&l!==null&&l.memoizedState.isDehydrated)try{mo(a.containerInfo)}catch(Pe){Pt(s,s.return,Pe)}rp&&(rp=!1,_y(s));break;case 4:c=ha,ha=eh(s.stateNode.containerInfo),hn(a,s),fn(s),ha=c;break;case 12:hn(a,s),fn(s);break;case 31:hn(a,s),fn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Bd(s,c)));break;case 13:hn(a,s),fn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Fd=Ue()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Bd(s,c)));break;case 22:f=s.memoizedState!==null;var q=l!==null&&l.memoizedState!==null,te=or,he=Ss;if(or=te||f,Ss=he||q,hn(a,s),Ss=he,or=te,fn(s),c&8192)e:for(a=s.stateNode,a._visibility=f?a._visibility&-2:a._visibility|1,f&&(l===null||q||or||Ss||tl(s)),l=null,a=s;;){if(a.tag===5||a.tag===26){if(l===null){q=l=a;try{if(m=q.stateNode,f)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{C=q.stateNode;var be=q.memoizedProps.style,se=be!=null&&be.hasOwnProperty("display")?be.display:null;C.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Pe){Pt(q,q.return,Pe)}}}else if(a.tag===6){if(l===null){q=a;try{q.stateNode.nodeValue=f?"":q.memoizedProps}catch(Pe){Pt(q,q.return,Pe)}}}else if(a.tag===18){if(l===null){q=a;try{var oe=q.stateNode;f?hv(oe,!0):hv(q.stateNode,!1)}catch(Pe){Pt(q,q.return,Pe)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,Bd(s,l))));break;case 19:hn(a,s),fn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Bd(s,c)));break;case 30:break;case 21:break;default:hn(a,s),fn(s)}}function fn(s){var a=s.flags;if(a&2){try{for(var l,c=s.return;c!==null;){if(my(c)){l=c;break}c=c.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var f=l.stateNode,m=np(s);Ud(s,m,f);break;case 5:var v=l.stateNode;l.flags&32&&(un(v,""),l.flags&=-33);var C=np(s);Ud(s,C,v);break;case 3:case 4:var q=l.stateNode.containerInfo,te=np(s);ap(s,te,q);break;default:throw Error(i(161))}}catch(he){Pt(s,s.return,he)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function _y(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;_y(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function ur(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)xy(s,a.alternate,a),a=a.sibling}function tl(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Hr(4,a,a.return),tl(a);break;case 1:Oa(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&hy(a,a.return,l),tl(a);break;case 27:Bc(a.stateNode);case 26:case 5:Oa(a,a.return),tl(a);break;case 22:a.memoizedState===null&&tl(a);break;case 30:tl(a);break;default:tl(a)}s=s.sibling}}function dr(s,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,f=s,m=a,v=m.flags;switch(m.tag){case 0:case 11:case 15:dr(f,m,l),Cc(4,m);break;case 1:if(dr(f,m,l),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(te){Pt(c,c.return,te)}if(c=m,f=c.updateQueue,f!==null){var C=c.stateNode;try{var q=f.shared.hiddenCallbacks;if(q!==null)for(f.shared.hiddenCallbacks=null,f=0;f<q.length;f++)eb(q[f],C)}catch(te){Pt(c,c.return,te)}}l&&v&64&&dy(m),Rc(m,m.return);break;case 27:py(m);case 26:case 5:dr(f,m,l),l&&c===null&&v&4&&fy(m),Rc(m,m.return);break;case 12:dr(f,m,l);break;case 31:dr(f,m,l),l&&v&4&&vy(f,m);break;case 13:dr(f,m,l),l&&v&4&&wy(f,m);break;case 22:m.memoizedState===null&&dr(f,m,l),Rc(m,m.return);break;case 30:break;default:dr(f,m,l)}a=a.sibling}}function ip(s,a){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&xc(l))}function lp(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&xc(s))}function fa(s,a,l,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)jy(s,a,l,c),a=a.sibling}function jy(s,a,l,c){var f=a.flags;switch(a.tag){case 0:case 11:case 15:fa(s,a,l,c),f&2048&&Cc(9,a);break;case 1:fa(s,a,l,c);break;case 3:fa(s,a,l,c),f&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&xc(s)));break;case 12:if(f&2048){fa(s,a,l,c),s=a.stateNode;try{var m=a.memoizedProps,v=m.id,C=m.onPostCommit;typeof C=="function"&&C(v,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(q){Pt(a,a.return,q)}}else fa(s,a,l,c);break;case 31:fa(s,a,l,c);break;case 13:fa(s,a,l,c);break;case 23:break;case 22:m=a.stateNode,v=a.alternate,a.memoizedState!==null?m._visibility&2?fa(s,a,l,c):Ic(s,a):m._visibility&2?fa(s,a,l,c):(m._visibility|=2,so(s,a,l,c,(a.subtreeFlags&10256)!==0||!1)),f&2048&&ip(v,a);break;case 24:fa(s,a,l,c),f&2048&&lp(a.alternate,a);break;default:fa(s,a,l,c)}}function so(s,a,l,c,f){for(f=f&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var m=s,v=a,C=l,q=c,te=v.flags;switch(v.tag){case 0:case 11:case 15:so(m,v,C,q,f),Cc(8,v);break;case 23:break;case 22:var he=v.stateNode;v.memoizedState!==null?he._visibility&2?so(m,v,C,q,f):Ic(m,v):(he._visibility|=2,so(m,v,C,q,f)),f&&te&2048&&ip(v.alternate,v);break;case 24:so(m,v,C,q,f),f&&te&2048&&lp(v.alternate,v);break;default:so(m,v,C,q,f)}a=a.sibling}}function Ic(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=s,c=a,f=c.flags;switch(c.tag){case 22:Ic(l,c),f&2048&&ip(c.alternate,c);break;case 24:Ic(l,c),f&2048&&lp(c.alternate,c);break;default:Ic(l,c)}a=a.sibling}}var Dc=8192;function no(s,a,l){if(s.subtreeFlags&Dc)for(s=s.child;s!==null;)Sy(s,a,l),s=s.sibling}function Sy(s,a,l){switch(s.tag){case 26:no(s,a,l),s.flags&Dc&&s.memoizedState!==null&&gE(l,ha,s.memoizedState,s.memoizedProps);break;case 5:no(s,a,l);break;case 3:case 4:var c=ha;ha=eh(s.stateNode.containerInfo),no(s,a,l),ha=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Dc,Dc=16777216,no(s,a,l),Dc=c):no(s,a,l));break;default:no(s,a,l)}}function Ey(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Mc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];Ds=c,Ay(c,s)}Ey(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Ty(s),s=s.sibling}function Ty(s){switch(s.tag){case 0:case 11:case 15:Mc(s),s.flags&2048&&Hr(9,s,s.return);break;case 3:Mc(s);break;case 12:Mc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,zd(s)):Mc(s);break;default:Mc(s)}}function zd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];Ds=c,Ay(c,s)}Ey(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Hr(8,a,a.return),zd(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,zd(a));break;default:zd(a)}s=s.sibling}}function Ay(s,a){for(;Ds!==null;){var l=Ds;switch(l.tag){case 0:case 11:case 15:Hr(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:xc(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,Ds=c;else e:for(l=s;Ds!==null;){c=Ds;var f=c.sibling,m=c.return;if(by(c),c===l){Ds=null;break e}if(f!==null){f.return=m,Ds=f;break e}Ds=m}}}var RS={getCacheForType:function(s){var a=Vs(Ns),l=a.data.get(s);return l===void 0&&(l=s(),a.data.set(s,l)),l},cacheSignal:function(){return Vs(Ns).controller.signal}},IS=typeof WeakMap=="function"?WeakMap:Map,Rt=0,$t=null,pt=null,xt=0,Ot=0,In=null,Gr=!1,ao=!1,op=!1,hr=0,os=0,Yr=0,sl=0,cp=0,Dn=0,ro=0,Oc=null,mn=null,up=!1,Fd=0,ky=0,$d=1/0,qd=null,Wr=null,ks=0,Qr=null,io=null,fr=0,dp=0,hp=null,Cy=null,Pc=0,fp=null;function Mn(){return(Rt&2)!==0&&xt!==0?xt&-xt:O.T!==null?yp():Ri()}function Ry(){if(Dn===0)if((xt&536870912)===0||Nt){var s=de;de<<=1,(de&3932160)===0&&(de=262144),Dn=s}else Dn=536870912;return s=Cn.current,s!==null&&(s.flags|=32),Dn}function pn(s,a,l){(s===$t&&(Ot===2||Ot===9)||s.cancelPendingCommit!==null)&&(lo(s,0),Kr(s,xt,Dn,!1)),Wt(s,l),((Rt&2)===0||s!==$t)&&(s===$t&&((Rt&2)===0&&(sl|=l),os===4&&Kr(s,xt,Dn,!1)),Pa(s))}function Iy(s,a,l){if((Rt&6)!==0)throw Error(i(327));var c=!l&&(a&127)===0&&(a&s.expiredLanes)===0||it(s,a),f=c?OS(s,a):pp(s,a,!0),m=c;do{if(f===0){ao&&!c&&Kr(s,a,0,!1);break}else{if(l=s.current.alternate,m&&!DS(l)){f=pp(s,a,!1),m=!1;continue}if(f===2){if(m=a,s.errorRecoveryDisabledLanes&m)var v=0;else v=s.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){a=v;e:{var C=s;f=Oc;var q=C.current.memoizedState.isDehydrated;if(q&&(lo(C,v).flags|=256),v=pp(C,v,!1),v!==2){if(op&&!q){C.errorRecoveryDisabledLanes|=m,sl|=m,f=4;break e}m=mn,mn=f,m!==null&&(mn===null?mn=m:mn.push.apply(mn,m))}f=v}if(m=!1,f!==2)continue}}if(f===1){lo(s,0),Kr(s,a,0,!0);break}e:{switch(c=s,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Kr(c,a,Dn,!Gr);break e;case 2:mn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(f=Fd+300-Ue(),10<f)){if(Kr(c,a,Dn,!Gr),Be(c,0,!0)!==0)break e;fr=a,c.timeoutHandle=cv(Dy.bind(null,c,l,mn,qd,up,a,Dn,sl,ro,Gr,m,"Throttled",-0,0),f);break e}Dy(c,l,mn,qd,up,a,Dn,sl,ro,Gr,m,null,-0,0)}}break}while(!0);Pa(s)}function Dy(s,a,l,c,f,m,v,C,q,te,he,be,se,oe){if(s.timeoutHandle=-1,be=a.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ia},Sy(a,m,be);var Pe=(m&62914560)===m?Fd-Ue():(m&4194048)===m?ky-Ue():0;if(Pe=xE(be,Pe),Pe!==null){fr=m,s.cancelPendingCommit=Pe(zy.bind(null,s,a,m,l,c,f,v,C,q,he,be,null,se,oe)),Kr(s,m,v,!te);return}}zy(s,a,m,l,c,f,v,C,q)}function DS(s){for(var a=s;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var f=l[c],m=f.getSnapshot;f=f.value;try{if(!An(m(),f))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Kr(s,a,l,c){a&=~cp,a&=~sl,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var f=a;0<f;){var m=31-$(f),v=1<<m;c[m]=-1,f&=~v}l!==0&&ln(s,l,a)}function Hd(){return(Rt&6)===0?(Vc(0),!1):!0}function mp(){if(pt!==null){if(Ot===0)var s=pt.return;else s=pt,sr=Yi=null,Cm(s),Xl=null,yc=0,s=pt;for(;s!==null;)uy(s.alternate,s),s=s.return;pt=null}}function lo(s,a){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,ZS(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),fr=0,mp(),$t=s,pt=l=er(s.current,null),xt=a,Ot=0,In=null,Gr=!1,ao=it(s,a),op=!1,ro=Dn=cp=sl=Yr=os=0,mn=Oc=null,up=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var f=31-$(c),m=1<<f;a|=s[f],c&=~m}return hr=a,hd(),l}function My(s,a){ut=null,O.H=Tc,a===Kl||a===vd?(a=Kx(),Ot=3):a===bm?(a=Kx(),Ot=4):Ot=a===Gm?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,In=a,pt===null&&(os=1,Md(s,Hn(a,s.current)))}function Oy(){var s=Cn.current;return s===null?!0:(xt&4194048)===xt?Qn===null:(xt&62914560)===xt||(xt&536870912)!==0?s===Qn:!1}function Py(){var s=O.H;return O.H=Tc,s===null?Tc:s}function Vy(){var s=O.A;return O.A=RS,s}function Gd(){os=4,Gr||(xt&4194048)!==xt&&Cn.current!==null||(ao=!0),(Yr&134217727)===0&&(sl&134217727)===0||$t===null||Kr($t,xt,Dn,!1)}function pp(s,a,l){var c=Rt;Rt|=2;var f=Py(),m=Vy();($t!==s||xt!==a)&&(qd=null,lo(s,a)),a=!1;var v=os;e:do try{if(Ot!==0&&pt!==null){var C=pt,q=In;switch(Ot){case 8:mp(),v=6;break e;case 3:case 2:case 9:case 6:Cn.current===null&&(a=!0);var te=Ot;if(Ot=0,In=null,oo(s,C,q,te),l&&ao){v=0;break e}break;default:te=Ot,Ot=0,In=null,oo(s,C,q,te)}}MS(),v=os;break}catch(he){My(s,he)}while(!0);return a&&s.shellSuspendCounter++,sr=Yi=null,Rt=c,O.H=f,O.A=m,pt===null&&($t=null,xt=0,hd()),v}function MS(){for(;pt!==null;)Ly(pt)}function OS(s,a){var l=Rt;Rt|=2;var c=Py(),f=Vy();$t!==s||xt!==a?(qd=null,$d=Ue()+500,lo(s,a)):ao=it(s,a);e:do try{if(Ot!==0&&pt!==null){a=pt;var m=In;t:switch(Ot){case 1:Ot=0,In=null,oo(s,a,m,1);break;case 2:case 9:if(Wx(m)){Ot=0,In=null,Uy(a);break}a=function(){Ot!==2&&Ot!==9||$t!==s||(Ot=7),Pa(s)},m.then(a,a);break e;case 3:Ot=7;break e;case 4:Ot=5;break e;case 7:Wx(m)?(Ot=0,In=null,Uy(a)):(Ot=0,In=null,oo(s,a,m,7));break;case 5:var v=null;switch(pt.tag){case 26:v=pt.memoizedState;case 5:case 27:var C=pt;if(v?jv(v):C.stateNode.complete){Ot=0,In=null;var q=C.sibling;if(q!==null)pt=q;else{var te=C.return;te!==null?(pt=te,Yd(te)):pt=null}break t}}Ot=0,In=null,oo(s,a,m,5);break;case 6:Ot=0,In=null,oo(s,a,m,6);break;case 8:mp(),os=6;break e;default:throw Error(i(462))}}PS();break}catch(he){My(s,he)}while(!0);return sr=Yi=null,O.H=c,O.A=f,Rt=l,pt!==null?0:($t=null,xt=0,hd(),os)}function PS(){for(;pt!==null&&!me();)Ly(pt)}function Ly(s){var a=oy(s.alternate,s,hr);s.memoizedProps=s.pendingProps,a===null?Yd(s):pt=a}function Uy(s){var a=s,l=a.alternate;switch(a.tag){case 15:case 0:a=sy(l,a,a.pendingProps,a.type,void 0,xt);break;case 11:a=sy(l,a,a.pendingProps,a.type.render,a.ref,xt);break;case 5:Cm(a);default:uy(l,a),a=pt=Vx(a,hr),a=oy(l,a,hr)}s.memoizedProps=s.pendingProps,a===null?Yd(s):pt=a}function oo(s,a,l,c){sr=Yi=null,Cm(a),Xl=null,yc=0;var f=a.return;try{if(jS(s,f,a,l,xt)){os=1,Md(s,Hn(l,s.current)),pt=null;return}}catch(m){if(f!==null)throw pt=f,m;os=1,Md(s,Hn(l,s.current)),pt=null;return}a.flags&32768?(Nt||c===1?s=!0:ao||(xt&536870912)!==0?s=!1:(Gr=s=!0,(c===2||c===9||c===3||c===6)&&(c=Cn.current,c!==null&&c.tag===13&&(c.flags|=16384))),By(a,s)):Yd(a)}function Yd(s){var a=s;do{if((a.flags&32768)!==0){By(a,Gr);return}s=a.return;var l=TS(a.alternate,a,hr);if(l!==null){pt=l;return}if(a=a.sibling,a!==null){pt=a;return}pt=a=s}while(a!==null);os===0&&(os=5)}function By(s,a){do{var l=AS(s.alternate,s);if(l!==null){l.flags&=32767,pt=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(s=s.sibling,s!==null)){pt=s;return}pt=s=l}while(s!==null);os=6,pt=null}function zy(s,a,l,c,f,m,v,C,q){s.cancelPendingCommit=null;do Wd();while(ks!==0);if((Rt&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(m=a.lanes|a.childLanes,m|=nm,rn(s,l,m,v,C,q),s===$t&&(pt=$t=null,xt=0),io=a,Qr=s,fr=l,dp=m,hp=f,Cy=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,BS(Jt,function(){return Gy(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=O.T,O.T=null,f=Q.p,Q.p=2,v=Rt,Rt|=4;try{kS(s,a,l)}finally{Rt=v,Q.p=f,O.T=c}}ks=1,Fy(),$y(),qy()}}function Fy(){if(ks===1){ks=0;var s=Qr,a=io,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=O.T,O.T=null;var c=Q.p;Q.p=2;var f=Rt;Rt|=4;try{Ny(a,s);var m=Tp,v=Ax(s.containerInfo),C=m.focusedElem,q=m.selectionRange;if(v!==C&&C&&C.ownerDocument&&Tx(C.ownerDocument.documentElement,C)){if(q!==null&&Jf(C)){var te=q.start,he=q.end;if(he===void 0&&(he=te),"selectionStart"in C)C.selectionStart=te,C.selectionEnd=Math.min(he,C.value.length);else{var be=C.ownerDocument||document,se=be&&be.defaultView||window;if(se.getSelection){var oe=se.getSelection(),Pe=C.textContent.length,Je=Math.min(q.start,Pe),zt=q.end===void 0?Je:Math.min(q.end,Pe);!oe.extend&&Je>zt&&(v=zt,zt=Je,Je=v);var K=Ex(C,Je),G=Ex(C,zt);if(K&&G&&(oe.rangeCount!==1||oe.anchorNode!==K.node||oe.anchorOffset!==K.offset||oe.focusNode!==G.node||oe.focusOffset!==G.offset)){var Z=be.createRange();Z.setStart(K.node,K.offset),oe.removeAllRanges(),Je>zt?(oe.addRange(Z),oe.extend(G.node,G.offset)):(Z.setEnd(G.node,G.offset),oe.addRange(Z))}}}}for(be=[],oe=C;oe=oe.parentNode;)oe.nodeType===1&&be.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<be.length;C++){var pe=be[C];pe.element.scrollLeft=pe.left,pe.element.scrollTop=pe.top}}ih=!!Ep,Tp=Ep=null}finally{Rt=f,Q.p=c,O.T=l}}s.current=a,ks=2}}function $y(){if(ks===2){ks=0;var s=Qr,a=io,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=O.T,O.T=null;var c=Q.p;Q.p=2;var f=Rt;Rt|=4;try{xy(s,a.alternate,a)}finally{Rt=f,Q.p=c,O.T=l}}ks=3}}function qy(){if(ks===4||ks===3){ks=0,Ye();var s=Qr,a=io,l=fr,c=Cy;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?ks=5:(ks=0,io=Qr=null,Hy(s,s.pendingLanes));var f=s.pendingLanes;if(f===0&&(Wr=null),ns(l),a=a.stateNode,Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(gs,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=O.T,f=Q.p,Q.p=2,O.T=null;try{for(var m=s.onRecoverableError,v=0;v<c.length;v++){var C=c[v];m(C.value,{componentStack:C.stack})}}finally{O.T=a,Q.p=f}}(fr&3)!==0&&Wd(),Pa(s),f=s.pendingLanes,(l&261930)!==0&&(f&42)!==0?s===fp?Pc++:(Pc=0,fp=s):Pc=0,Vc(0)}}function Hy(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,xc(a)))}function Wd(){return Fy(),$y(),qy(),Gy()}function Gy(){if(ks!==5)return!1;var s=Qr,a=dp;dp=0;var l=ns(fr),c=O.T,f=Q.p;try{Q.p=32>l?32:l,O.T=null,l=hp,hp=null;var m=Qr,v=fr;if(ks=0,io=Qr=null,fr=0,(Rt&6)!==0)throw Error(i(331));var C=Rt;if(Rt|=4,Ty(m.current),jy(m,m.current,v,l),Rt=C,Vc(0,!1),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(gs,m)}catch{}return!0}finally{Q.p=f,O.T=c,Hy(s,a)}}function Yy(s,a,l){a=Hn(l,a),a=Hm(s.stateNode,a,2),s=Fr(s,a,2),s!==null&&(Wt(s,2),Pa(s))}function Pt(s,a,l){if(s.tag===3)Yy(s,s,l);else for(;a!==null;){if(a.tag===3){Yy(a,s,l);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Wr===null||!Wr.has(c))){s=Hn(l,s),l=Wb(2),c=Fr(a,l,2),c!==null&&(Qb(l,c,a,s),Wt(c,2),Pa(c));break}}a=a.return}}function gp(s,a,l){var c=s.pingCache;if(c===null){c=s.pingCache=new IS;var f=new Set;c.set(a,f)}else f=c.get(a),f===void 0&&(f=new Set,c.set(a,f));f.has(l)||(op=!0,f.add(l),s=VS.bind(null,s,a,l),a.then(s,s))}function VS(s,a,l){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,$t===s&&(xt&l)===l&&(os===4||os===3&&(xt&62914560)===xt&&300>Ue()-Fd?(Rt&2)===0&&lo(s,0):cp|=l,ro===xt&&(ro=0)),Pa(s)}function Wy(s,a){a===0&&(a=ze()),s=qi(s,a),s!==null&&(Wt(s,a),Pa(s))}function LS(s){var a=s.memoizedState,l=0;a!==null&&(l=a.retryLane),Wy(s,l)}function US(s,a){var l=0;switch(s.tag){case 31:case 13:var c=s.stateNode,f=s.memoizedState;f!==null&&(l=f.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),Wy(s,l)}function BS(s,a){return ke(s,a)}var Qd=null,co=null,xp=!1,Kd=!1,bp=!1,Xr=0;function Pa(s){s!==co&&s.next===null&&(co===null?Qd=co=s:co=co.next=s),Kd=!0,xp||(xp=!0,FS())}function Vc(s,a){if(!bp&&Kd){bp=!0;do for(var l=!1,c=Qd;c!==null;){if(s!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var v=c.suspendedLanes,C=c.pingedLanes;m=(1<<31-$(42|s)+1)-1,m&=f&~(v&~C),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(l=!0,Jy(c,m))}else m=xt,m=Be(c,c===$t?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||it(c,m)||(l=!0,Jy(c,m));c=c.next}while(l);bp=!1}}function zS(){Qy()}function Qy(){Kd=xp=!1;var s=0;Xr!==0&&JS()&&(s=Xr);for(var a=Ue(),l=null,c=Qd;c!==null;){var f=c.next,m=Ky(c,a);m===0?(c.next=null,l===null?Qd=f:l.next=f,f===null&&(co=l)):(l=c,(s!==0||(m&3)!==0)&&(Kd=!0)),c=f}ks!==0&&ks!==5||Vc(s),Xr!==0&&(Xr=0)}function Ky(s,a){for(var l=s.suspendedLanes,c=s.pingedLanes,f=s.expirationTimes,m=s.pendingLanes&-62914561;0<m;){var v=31-$(m),C=1<<v,q=f[v];q===-1?((C&l)===0||(C&c)!==0)&&(f[v]=Le(C,a)):q<=a&&(s.expiredLanes|=C),m&=~C}if(a=$t,l=xt,l=Be(s,s===a?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,l===0||s===a&&(Ot===2||Ot===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Oe(c),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||it(s,l)){if(a=l&-l,a===s.callbackPriority)return a;switch(c!==null&&Oe(c),ns(l)){case 2:case 8:l=Ge;break;case 32:l=Jt;break;case 268435456:l=jn;break;default:l=Jt}return c=Xy.bind(null,s),l=ke(l,c),s.callbackPriority=a,s.callbackNode=l,a}return c!==null&&c!==null&&Oe(c),s.callbackPriority=2,s.callbackNode=null,2}function Xy(s,a){if(ks!==0&&ks!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Wd()&&s.callbackNode!==l)return null;var c=xt;return c=Be(s,s===$t?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(Iy(s,c,a),Ky(s,Ue()),s.callbackNode!=null&&s.callbackNode===l?Xy.bind(null,s):null)}function Jy(s,a){if(Wd())return null;Iy(s,a,!0)}function FS(){eE(function(){(Rt&6)!==0?ke(qe,zS):Qy()})}function yp(){if(Xr===0){var s=Wl;s===0&&(s=Fe,Fe<<=1,(Fe&261888)===0&&(Fe=256)),Xr=s}return Xr}function Zy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Dl(""+s)}function ev(s,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,s.id&&l.setAttribute("form",s.id),a.parentNode.insertBefore(l,a),s=new FormData(s),l.parentNode.removeChild(l),s}function $S(s,a,l,c,f){if(a==="submit"&&l&&l.stateNode===f){var m=Zy((f[ys]||null).action),v=c.submitter;v&&(a=(a=v[ys]||null)?Zy(a.formAction):v.getAttribute("formAction"),a!==null&&(m=a,v=null));var C=new ka("action","action",null,c,f);s.push({event:C,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Xr!==0){var q=v?ev(f,v):new FormData(f);Um(l,{pending:!0,data:q,method:f.method,action:m},null,q)}}else typeof m=="function"&&(C.preventDefault(),q=v?ev(f,v):new FormData(f),Um(l,{pending:!0,data:q,method:f.method,action:m},m,q))},currentTarget:f}]})}}for(var vp=0;vp<sm.length;vp++){var wp=sm[vp],qS=wp.toLowerCase(),HS=wp[0].toUpperCase()+wp.slice(1);da(qS,"on"+HS)}da(Rx,"onAnimationEnd"),da(Ix,"onAnimationIteration"),da(Dx,"onAnimationStart"),da("dblclick","onDoubleClick"),da("focusin","onFocus"),da("focusout","onBlur"),da(lS,"onTransitionRun"),da(oS,"onTransitionStart"),da(cS,"onTransitionCancel"),da(Mx,"onTransitionEnd"),Sa("onMouseEnter",["mouseout","mouseover"]),Sa("onMouseLeave",["mouseout","mouseover"]),Sa("onPointerEnter",["pointerout","pointerover"]),Sa("onPointerLeave",["pointerout","pointerover"]),ja("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ja("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ja("onBeforeInput",["compositionend","keypress","textInput","paste"]),ja("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ja("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ja("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lc));function tv(s,a){a=(a&4)!==0;for(var l=0;l<s.length;l++){var c=s[l],f=c.event;c=c.listeners;e:{var m=void 0;if(a)for(var v=c.length-1;0<=v;v--){var C=c[v],q=C.instance,te=C.currentTarget;if(C=C.listener,q!==m&&f.isPropagationStopped())break e;m=C,f.currentTarget=te;try{m(f)}catch(he){dd(he)}f.currentTarget=null,m=q}else for(v=0;v<c.length;v++){if(C=c[v],q=C.instance,te=C.currentTarget,C=C.listener,q!==m&&f.isPropagationStopped())break e;m=C,f.currentTarget=te;try{m(f)}catch(he){dd(he)}f.currentTarget=null,m=q}}}}function gt(s,a){var l=a[Ii];l===void 0&&(l=a[Ii]=new Set);var c=s+"__bubble";l.has(c)||(sv(a,s,2,!1),l.add(c))}function Np(s,a,l){var c=0;a&&(c|=4),sv(l,s,c,a)}var Xd="_reactListening"+Math.random().toString(36).slice(2);function _p(s){if(!s[Xd]){s[Xd]=!0,Ko.forEach(function(l){l!=="selectionchange"&&(GS.has(l)||Np(l,!1,s),Np(l,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Xd]||(a[Xd]=!0,Np("selectionchange",!1,a))}}function sv(s,a,l,c){switch(Rv(a)){case 2:var f=vE;break;case 8:f=wE;break;default:f=Lp}l=f.bind(null,a,l,s),f=void 0,!Pi||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(f=!0),c?f!==void 0?s.addEventListener(a,l,{capture:!0,passive:f}):s.addEventListener(a,l,!0):f!==void 0?s.addEventListener(a,l,{passive:f}):s.addEventListener(a,l,!1)}function jp(s,a,l,c,f){var m=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var C=c.stateNode.containerInfo;if(C===f)break;if(v===4)for(v=c.return;v!==null;){var q=v.tag;if((q===3||q===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;C!==null;){if(v=Na(C),v===null)return;if(q=v.tag,q===5||q===6||q===26||q===27){c=m=v;continue e}C=C.parentNode}}c=c.return}Ir(function(){var te=m,he=zn(l),be=[];e:{var se=Ox.get(s);if(se!==void 0){var oe=ka,Pe=s;switch(s){case"keypress":if(Li(l)===0)break e;case"keydown":case"keyup":oe=od;break;case"focusin":Pe="focus",oe=Bi;break;case"focusout":Pe="blur",oe=Bi;break;case"beforeblur":case"afterblur":oe=Bi;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=cc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=Zu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=y;break;case Rx:case Ix:case Dx:oe=td;break;case Mx:oe=M;break;case"scroll":case"scrollend":oe=oc;break;case"wheel":oe=re;break;case"copy":case"cut":case"paste":oe=sd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=Za;break;case"toggle":case"beforetoggle":oe=ct}var Je=(a&4)!==0,zt=!Je&&(s==="scroll"||s==="scrollend"),K=Je?se!==null?se+"Capture":null:se;Je=[];for(var G=te,Z;G!==null;){var pe=G;if(Z=pe.stateNode,pe=pe.tag,pe!==5&&pe!==26&&pe!==27||Z===null||K===null||(pe=la(G,K),pe!=null&&Je.push(Uc(G,pe,Z))),zt)break;G=G.return}0<Je.length&&(se=new oe(se,Pe,null,l,he),be.push({event:se,listeners:Je}))}}if((a&7)===0){e:{if(se=s==="mouseover"||s==="pointerover",oe=s==="mouseout"||s==="pointerout",se&&l!==rc&&(Pe=l.relatedTarget||l.fromElement)&&(Na(Pe)||Pe[Sn]))break e;if((oe||se)&&(se=he.window===he?he:(se=he.ownerDocument)?se.defaultView||se.parentWindow:window,oe?(Pe=l.relatedTarget||l.toElement,oe=te,Pe=Pe?Na(Pe):null,Pe!==null&&(zt=u(Pe),Je=Pe.tag,Pe!==zt||Je!==5&&Je!==27&&Je!==6)&&(Pe=null)):(oe=null,Pe=te),oe!==Pe)){if(Je=cc,pe="onMouseLeave",K="onMouseEnter",G="mouse",(s==="pointerout"||s==="pointerover")&&(Je=Za,pe="onPointerLeave",K="onPointerEnter",G="pointer"),zt=oe==null?se:En(oe),Z=Pe==null?se:En(Pe),se=new Je(pe,G+"leave",oe,l,he),se.target=zt,se.relatedTarget=Z,pe=null,Na(he)===te&&(Je=new Je(K,G+"enter",Pe,l,he),Je.target=Z,Je.relatedTarget=zt,pe=Je),zt=pe,oe&&Pe)t:{for(Je=YS,K=oe,G=Pe,Z=0,pe=K;pe;pe=Je(pe))Z++;pe=0;for(var We=G;We;We=Je(We))pe++;for(;0<Z-pe;)K=Je(K),Z--;for(;0<pe-Z;)G=Je(G),pe--;for(;Z--;){if(K===G||G!==null&&K===G.alternate){Je=K;break t}K=Je(K),G=Je(G)}Je=null}else Je=null;oe!==null&&nv(be,se,oe,Je,!1),Pe!==null&&zt!==null&&nv(be,zt,Pe,Je,!0)}}e:{if(se=te?En(te):window,oe=se.nodeName&&se.nodeName.toLowerCase(),oe==="select"||oe==="input"&&se.type==="file")var Et=vx;else if(bx(se))if(wx)Et=aS;else{Et=sS;var $e=tS}else oe=se.nodeName,!oe||oe.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?te&&Il(te.elementType)&&(Et=vx):Et=nS;if(Et&&(Et=Et(s,te))){yx(be,Et,l,he);break e}$e&&$e(s,se,te),s==="focusout"&&te&&se.type==="number"&&te.memoizedProps.value!=null&&sc(se,"number",se.value)}switch($e=te?En(te):window,s){case"focusin":(bx($e)||$e.contentEditable==="true")&&(Bl=$e,Zf=te,mc=null);break;case"focusout":mc=Zf=Bl=null;break;case"mousedown":em=!0;break;case"contextmenu":case"mouseup":case"dragend":em=!1,kx(be,l,he);break;case"selectionchange":if(iS)break;case"keydown":case"keyup":kx(be,l,he)}var dt;if(Ct)e:{switch(s){case"compositionstart":var bt="onCompositionStart";break e;case"compositionend":bt="onCompositionEnd";break e;case"compositionupdate":bt="onCompositionUpdate";break e}bt=void 0}else Ul?zi(s,l)&&(bt="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(bt="onCompositionStart");bt&&(Ia&&l.locale!=="ko"&&(Ul||bt!=="onCompositionStart"?bt==="onCompositionEnd"&&Ul&&(dt=lc()):(Aa=he,ic="value"in Aa?Aa.value:Aa.textContent,Ul=!0)),$e=Jd(te,bt),0<$e.length&&(bt=new Ra(bt,s,null,l,he),be.push({event:bt,listeners:$e}),dt?bt.data=dt:(dt=Ll(l),dt!==null&&(bt.data=dt)))),(dt=$n?Xj(s,l):Jj(s,l))&&(bt=Jd(te,"onBeforeInput"),0<bt.length&&($e=new Ra("onBeforeInput","beforeinput",null,l,he),be.push({event:$e,listeners:bt}),$e.data=dt)),$S(be,s,te,l,he)}tv(be,a)})}function Uc(s,a,l){return{instance:s,listener:a,currentTarget:l}}function Jd(s,a){for(var l=a+"Capture",c=[];s!==null;){var f=s,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=la(s,l),f!=null&&c.unshift(Uc(s,f,m)),f=la(s,a),f!=null&&c.push(Uc(s,f,m))),s.tag===3)return c;s=s.return}return[]}function YS(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function nv(s,a,l,c,f){for(var m=a._reactName,v=[];l!==null&&l!==c;){var C=l,q=C.alternate,te=C.stateNode;if(C=C.tag,q!==null&&q===c)break;C!==5&&C!==26&&C!==27||te===null||(q=te,f?(te=la(l,m),te!=null&&v.unshift(Uc(l,te,q))):f||(te=la(l,m),te!=null&&v.push(Uc(l,te,q)))),l=l.return}v.length!==0&&s.push({event:a,listeners:v})}var WS=/\r\n?/g,QS=/\u0000|\uFFFD/g;function av(s){return(typeof s=="string"?s:""+s).replace(WS,`
`).replace(QS,"")}function rv(s,a){return a=av(a),av(s)===a}function Bt(s,a,l,c,f,m){switch(l){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||un(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&un(s,""+c);break;case"className":Tn(s,"class",c);break;case"tabIndex":Tn(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Tn(s,l,c);break;case"style":ac(s,c,m);break;case"data":if(a!=="object"){Tn(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||l!=="href")){s.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(l);break}c=Dl(""+c),s.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(l==="formAction"?(a!=="input"&&Bt(s,a,"name",f.name,f,null),Bt(s,a,"formEncType",f.formEncType,f,null),Bt(s,a,"formMethod",f.formMethod,f,null),Bt(s,a,"formTarget",f.formTarget,f,null)):(Bt(s,a,"encType",f.encType,f,null),Bt(s,a,"method",f.method,f,null),Bt(s,a,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(l);break}c=Dl(""+c),s.setAttribute(l,c);break;case"onClick":c!=null&&(s.onclick=ia);break;case"onScroll":c!=null&&gt("scroll",s);break;case"onScrollEnd":c!=null&&gt("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}l=Dl(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(l,""+c):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":c===!0?s.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(l,c):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(l,c):s.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(l):s.setAttribute(l,c);break;case"popover":gt("beforetoggle",s),gt("toggle",s),Cl(s,"popover",c);break;case"xlinkActuate":ws(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":ws(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":ws(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":ws(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":ws(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":ws(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":ws(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":ws(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":ws(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Cl(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Ju.get(l)||l,Cl(s,l,c))}}function Sp(s,a,l,c,f,m){switch(l){case"style":ac(s,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof c=="string"?un(s,c):(typeof c=="number"||typeof c=="bigint")&&un(s,""+c);break;case"onScroll":c!=null&&gt("scroll",s);break;case"onScrollEnd":c!=null&&gt("scrollend",s);break;case"onClick":c!=null&&(s.onclick=ia);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xo.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),a=l.slice(2,f?l.length-7:void 0),m=s[ys]||null,m=m!=null?m[l]:null,typeof m=="function"&&s.removeEventListener(a,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(a,c,f);break e}l in s?s[l]=c:c===!0?s.setAttribute(l,""):Cl(s,l,c)}}}function Us(s,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":gt("error",s),gt("load",s);var c=!1,f=!1,m;for(m in l)if(l.hasOwnProperty(m)){var v=l[m];if(v!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Bt(s,a,m,v,l,null)}}f&&Bt(s,a,"srcSet",l.srcSet,l,null),c&&Bt(s,a,"src",l.src,l,null);return;case"input":gt("invalid",s);var C=m=v=f=null,q=null,te=null;for(c in l)if(l.hasOwnProperty(c)){var he=l[c];if(he!=null)switch(c){case"name":f=he;break;case"type":v=he;break;case"checked":q=he;break;case"defaultChecked":te=he;break;case"value":m=he;break;case"defaultValue":C=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,a));break;default:Bt(s,a,c,he,l,null)}}Qu(s,m,C,q,te,v,f,!1);return;case"select":gt("invalid",s),c=v=m=null;for(f in l)if(l.hasOwnProperty(f)&&(C=l[f],C!=null))switch(f){case"value":m=C;break;case"defaultValue":v=C;break;case"multiple":c=C;default:Bt(s,a,f,C,l,null)}a=m,l=v,s.multiple=!!c,a!=null?Ar(s,!!c,a,!1):l!=null&&Ar(s,!!c,l,!0);return;case"textarea":gt("invalid",s),m=f=c=null;for(v in l)if(l.hasOwnProperty(v)&&(C=l[v],C!=null))switch(v){case"value":c=C;break;case"defaultValue":f=C;break;case"children":m=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(i(91));break;default:Bt(s,a,v,C,l,null)}kr(s,c,f,m);return;case"option":for(q in l)l.hasOwnProperty(q)&&(c=l[q],c!=null)&&(q==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Bt(s,a,q,c,l,null));return;case"dialog":gt("beforetoggle",s),gt("toggle",s),gt("cancel",s),gt("close",s);break;case"iframe":case"object":gt("load",s);break;case"video":case"audio":for(c=0;c<Lc.length;c++)gt(Lc[c],s);break;case"image":gt("error",s),gt("load",s);break;case"details":gt("toggle",s);break;case"embed":case"source":case"link":gt("error",s),gt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in l)if(l.hasOwnProperty(te)&&(c=l[te],c!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Bt(s,a,te,c,l,null)}return;default:if(Il(a)){for(he in l)l.hasOwnProperty(he)&&(c=l[he],c!==void 0&&Sp(s,a,he,c,l,void 0));return}}for(C in l)l.hasOwnProperty(C)&&(c=l[C],c!=null&&Bt(s,a,C,c,l,null))}function KS(s,a,l,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,v=null,C=null,q=null,te=null,he=null;for(oe in l){var be=l[oe];if(l.hasOwnProperty(oe)&&be!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":q=be;default:c.hasOwnProperty(oe)||Bt(s,a,oe,null,c,be)}}for(var se in c){var oe=c[se];if(be=l[se],c.hasOwnProperty(se)&&(oe!=null||be!=null))switch(se){case"type":m=oe;break;case"name":f=oe;break;case"checked":te=oe;break;case"defaultChecked":he=oe;break;case"value":v=oe;break;case"defaultValue":C=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,a));break;default:oe!==be&&Bt(s,a,se,oe,c,be)}}Rl(s,v,C,q,te,he,m,f);return;case"select":oe=v=C=se=null;for(m in l)if(q=l[m],l.hasOwnProperty(m)&&q!=null)switch(m){case"value":break;case"multiple":oe=q;default:c.hasOwnProperty(m)||Bt(s,a,m,null,c,q)}for(f in c)if(m=c[f],q=l[f],c.hasOwnProperty(f)&&(m!=null||q!=null))switch(f){case"value":se=m;break;case"defaultValue":C=m;break;case"multiple":v=m;default:m!==q&&Bt(s,a,f,m,c,q)}a=C,l=v,c=oe,se!=null?Ar(s,!!l,se,!1):!!c!=!!l&&(a!=null?Ar(s,!!l,a,!0):Ar(s,!!l,l?[]:"",!1));return;case"textarea":oe=se=null;for(C in l)if(f=l[C],l.hasOwnProperty(C)&&f!=null&&!c.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:Bt(s,a,C,null,c,f)}for(v in c)if(f=c[v],m=l[v],c.hasOwnProperty(v)&&(f!=null||m!=null))switch(v){case"value":se=f;break;case"defaultValue":oe=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&Bt(s,a,v,f,c,m)}Ku(s,se,oe);return;case"option":for(var Pe in l)se=l[Pe],l.hasOwnProperty(Pe)&&se!=null&&!c.hasOwnProperty(Pe)&&(Pe==="selected"?s.selected=!1:Bt(s,a,Pe,null,c,se));for(q in c)se=c[q],oe=l[q],c.hasOwnProperty(q)&&se!==oe&&(se!=null||oe!=null)&&(q==="selected"?s.selected=se&&typeof se!="function"&&typeof se!="symbol":Bt(s,a,q,se,c,oe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Je in l)se=l[Je],l.hasOwnProperty(Je)&&se!=null&&!c.hasOwnProperty(Je)&&Bt(s,a,Je,null,c,se);for(te in c)if(se=c[te],oe=l[te],c.hasOwnProperty(te)&&se!==oe&&(se!=null||oe!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,a));break;default:Bt(s,a,te,se,c,oe)}return;default:if(Il(a)){for(var zt in l)se=l[zt],l.hasOwnProperty(zt)&&se!==void 0&&!c.hasOwnProperty(zt)&&Sp(s,a,zt,void 0,c,se);for(he in c)se=c[he],oe=l[he],!c.hasOwnProperty(he)||se===oe||se===void 0&&oe===void 0||Sp(s,a,he,se,c,oe);return}}for(var K in l)se=l[K],l.hasOwnProperty(K)&&se!=null&&!c.hasOwnProperty(K)&&Bt(s,a,K,null,c,se);for(be in c)se=c[be],oe=l[be],!c.hasOwnProperty(be)||se===oe||se==null&&oe==null||Bt(s,a,be,se,c,oe)}function iv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function XS(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,l=performance.getEntriesByType("resource"),c=0;c<l.length;c++){var f=l[c],m=f.transferSize,v=f.initiatorType,C=f.duration;if(m&&C&&iv(v)){for(v=0,C=f.responseEnd,c+=1;c<l.length;c++){var q=l[c],te=q.startTime;if(te>C)break;var he=q.transferSize,be=q.initiatorType;he&&iv(be)&&(q=q.responseEnd,v+=he*(q<C?1:(C-te)/(q-te)))}if(--c,a+=8*(m+v)/(f.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Ep=null,Tp=null;function Zd(s){return s.nodeType===9?s:s.ownerDocument}function lv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ov(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function Ap(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var kp=null;function JS(){var s=window.event;return s&&s.type==="popstate"?s===kp?!1:(kp=s,!0):(kp=null,!1)}var cv=typeof setTimeout=="function"?setTimeout:void 0,ZS=typeof clearTimeout=="function"?clearTimeout:void 0,uv=typeof Promise=="function"?Promise:void 0,eE=typeof queueMicrotask=="function"?queueMicrotask:typeof uv<"u"?function(s){return uv.resolve(null).then(s).catch(tE)}:cv;function tE(s){setTimeout(function(){throw s})}function Jr(s){return s==="head"}function dv(s,a){var l=a,c=0;do{var f=l.nextSibling;if(s.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"||l==="/&"){if(c===0){s.removeChild(f),mo(a);return}c--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")c++;else if(l==="html")Bc(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,Bc(l);for(var m=l.firstChild;m;){var v=m.nextSibling,C=m.nodeName;m[wa]||C==="SCRIPT"||C==="STYLE"||C==="LINK"&&m.rel.toLowerCase()==="stylesheet"||l.removeChild(m),m=v}}else l==="body"&&Bc(s.ownerDocument.body);l=f}while(l);mo(a)}function hv(s,a){var l=s;s=0;do{var c=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),c&&c.nodeType===8)if(l=c.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=c}while(l)}function Cp(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Cp(l),kl(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function sE(s,a,l,c){for(;s.nodeType===1;){var f=l;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[wa])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(m=s.getAttribute("rel"),m==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(m!==f.rel||s.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||s.getAttribute("title")!==(f.title==null?null:f.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(m=s.getAttribute("src"),(m!==(f.src==null?null:f.src)||s.getAttribute("type")!==(f.type==null?null:f.type)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&s.getAttribute("name")===m)return s}else return s;if(s=Kn(s.nextSibling),s===null)break}return null}function nE(s,a,l){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Kn(s.nextSibling),s===null))return null;return s}function fv(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=Kn(s.nextSibling),s===null))return null;return s}function Rp(s){return s.data==="$?"||s.data==="$~"}function Ip(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function aE(s,a){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||l.readyState!=="loading")a();else{var c=function(){a(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function Kn(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var Dp=null;function mv(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(a===0)return Kn(s.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}s=s.nextSibling}return null}function pv(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return s;a--}else l!=="/$"&&l!=="/&"||a++}s=s.previousSibling}return null}function gv(s,a,l){switch(a=Zd(l),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Bc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);kl(s)}var Xn=new Map,xv=new Set;function eh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var mr=Q.d;Q.d={f:rE,r:iE,D:lE,C:oE,L:cE,m:uE,X:hE,S:dE,M:fE};function rE(){var s=mr.f(),a=Hd();return s||a}function iE(s){var a=Bn(s);a!==null&&a.tag===5&&a.type==="form"?Mb(a):mr.r(s)}var uo=typeof document>"u"?null:document;function bv(s,a,l){var c=uo;if(c&&typeof a=="string"&&a){var f=cn(a);f='link[rel="'+s+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),xv.has(f)||(xv.add(f),s={rel:s,crossOrigin:l,href:a},c.querySelector(f)===null&&(a=c.createElement("link"),Us(a,"link",s),vs(a),c.head.appendChild(a)))}}function lE(s){mr.D(s),bv("dns-prefetch",s,null)}function oE(s,a){mr.C(s,a),bv("preconnect",s,a)}function cE(s,a,l){mr.L(s,a,l);var c=uo;if(c&&s&&a){var f='link[rel="preload"][as="'+cn(a)+'"]';a==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+cn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+cn(l.imageSizes)+'"]')):f+='[href="'+cn(s)+'"]';var m=f;switch(a){case"style":m=ho(s);break;case"script":m=fo(s)}Xn.has(m)||(s=w({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:s,as:a},l),Xn.set(m,s),c.querySelector(f)!==null||a==="style"&&c.querySelector(zc(m))||a==="script"&&c.querySelector(Fc(m))||(a=c.createElement("link"),Us(a,"link",s),vs(a),c.head.appendChild(a)))}}function uE(s,a){mr.m(s,a);var l=uo;if(l&&s){var c=a&&typeof a.as=="string"?a.as:"script",f='link[rel="modulepreload"][as="'+cn(c)+'"][href="'+cn(s)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=fo(s)}if(!Xn.has(m)&&(s=w({rel:"modulepreload",href:s},a),Xn.set(m,s),l.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Fc(m)))return}c=l.createElement("link"),Us(c,"link",s),vs(c),l.head.appendChild(c)}}}function dE(s,a,l){mr.S(s,a,l);var c=uo;if(c&&s){var f=_a(c).hoistableStyles,m=ho(s);a=a||"default";var v=f.get(m);if(!v){var C={loading:0,preload:null};if(v=c.querySelector(zc(m)))C.loading=5;else{s=w({rel:"stylesheet",href:s,"data-precedence":a},l),(l=Xn.get(m))&&Mp(s,l);var q=v=c.createElement("link");vs(q),Us(q,"link",s),q._p=new Promise(function(te,he){q.onload=te,q.onerror=he}),q.addEventListener("load",function(){C.loading|=1}),q.addEventListener("error",function(){C.loading|=2}),C.loading|=4,th(v,a,c)}v={type:"stylesheet",instance:v,count:1,state:C},f.set(m,v)}}}function hE(s,a){mr.X(s,a);var l=uo;if(l&&s){var c=_a(l).hoistableScripts,f=fo(s),m=c.get(f);m||(m=l.querySelector(Fc(f)),m||(s=w({src:s,async:!0},a),(a=Xn.get(f))&&Op(s,a),m=l.createElement("script"),vs(m),Us(m,"link",s),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function fE(s,a){mr.M(s,a);var l=uo;if(l&&s){var c=_a(l).hoistableScripts,f=fo(s),m=c.get(f);m||(m=l.querySelector(Fc(f)),m||(s=w({src:s,async:!0,type:"module"},a),(a=Xn.get(f))&&Op(s,a),m=l.createElement("script"),vs(m),Us(m,"link",s),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function yv(s,a,l,c){var f=(f=Re.current)?eh(f):null;if(!f)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=ho(l.href),l=_a(f).hoistableStyles,c=l.get(a),c||(c={type:"style",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=ho(l.href);var m=_a(f).hoistableStyles,v=m.get(s);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(s,v),(m=f.querySelector(zc(s)))&&!m._p&&(v.instance=m,v.state.loading=5),Xn.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Xn.set(s,l),m||mE(f,s,l,v.state))),a&&c===null)throw Error(i(528,""));return v}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=fo(l),l=_a(f).hoistableScripts,c=l.get(a),c||(c={type:"script",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function ho(s){return'href="'+cn(s)+'"'}function zc(s){return'link[rel="stylesheet"]['+s+"]"}function vv(s){return w({},s,{"data-precedence":s.precedence,precedence:null})}function mE(s,a,l,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),Us(a,"link",l),vs(a),s.head.appendChild(a))}function fo(s){return'[src="'+cn(s)+'"]'}function Fc(s){return"script[async]"+s}function wv(s,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+cn(l.href)+'"]');if(c)return a.instance=c,vs(c),c;var f=w({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),vs(c),Us(c,"style",f),th(c,l.precedence,s),a.instance=c;case"stylesheet":f=ho(l.href);var m=s.querySelector(zc(f));if(m)return a.state.loading|=4,a.instance=m,vs(m),m;c=vv(l),(f=Xn.get(f))&&Mp(c,f),m=(s.ownerDocument||s).createElement("link"),vs(m);var v=m;return v._p=new Promise(function(C,q){v.onload=C,v.onerror=q}),Us(m,"link",c),a.state.loading|=4,th(m,l.precedence,s),a.instance=m;case"script":return m=fo(l.src),(f=s.querySelector(Fc(m)))?(a.instance=f,vs(f),f):(c=l,(f=Xn.get(m))&&(c=w({},l),Op(c,f)),s=s.ownerDocument||s,f=s.createElement("script"),vs(f),Us(f,"link",c),s.head.appendChild(f),a.instance=f);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,th(c,l.precedence,s));return a.instance}function th(s,a,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,v=0;v<c.length;v++){var C=c[v];if(C.dataset.precedence===a)m=C;else if(m!==f)break}m?m.parentNode.insertBefore(s,m.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(s,a.firstChild))}function Mp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function Op(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var sh=null;function Nv(s,a,l){if(sh===null){var c=new Map,f=sh=new Map;f.set(l,c)}else f=sh,c=f.get(l),c||(c=new Map,f.set(l,c));if(c.has(s))return c;for(c.set(s,null),l=l.getElementsByTagName(s),f=0;f<l.length;f++){var m=l[f];if(!(m[wa]||m[is]||s==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var v=m.getAttribute(a)||"";v=s+v;var C=c.get(v);C?C.push(m):c.set(v,[m])}}return c}function _v(s,a,l){s=s.ownerDocument||s,s.head.insertBefore(l,a==="title"?s.querySelector("head > title"):null)}function pE(s,a,l){if(l===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function jv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function gE(s,a,l,c){if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var f=ho(c.href),m=a.querySelector(zc(f));if(m){a=m._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=nh.bind(s),a.then(s,s)),l.state.loading|=4,l.instance=m,vs(m);return}m=a.ownerDocument||a,c=vv(c),(f=Xn.get(f))&&Mp(c,f),m=m.createElement("link"),vs(m);var v=m;v._p=new Promise(function(C,q){v.onload=C,v.onerror=q}),Us(m,"link",c),l.instance=m}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=nh.bind(s),a.addEventListener("load",l),a.addEventListener("error",l))}}var Pp=0;function xE(s,a){return s.stylesheets&&s.count===0&&rh(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var c=setTimeout(function(){if(s.stylesheets&&rh(s,s.stylesheets),s.unsuspend){var m=s.unsuspend;s.unsuspend=null,m()}},6e4+a);0<s.imgBytes&&Pp===0&&(Pp=62500*XS());var f=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&rh(s,s.stylesheets),s.unsuspend)){var m=s.unsuspend;s.unsuspend=null,m()}},(s.imgBytes>Pp?50:800)+a);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function nh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)rh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var ah=null;function rh(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,ah=new Map,a.forEach(bE,s),ah=null,nh.call(s))}function bE(s,a){if(!(a.state.loading&4)){var l=ah.get(s);if(l)var c=l.get(null);else{l=new Map,ah.set(s,l);for(var f=s.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var v=f[m];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(l.set(v.dataset.precedence,v),c=v)}c&&l.set(null,c)}f=a.instance,v=f.getAttribute("data-precedence"),m=l.get(v)||c,m===c&&l.set(null,f),l.set(v,f),this.count++,c=nh.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(f,s.firstChild)),a.state.loading|=4}}var $c={$$typeof:z,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function yE(s,a,l,c,f,m,v,C,q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=kt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kt(0),this.hiddenUpdates=kt(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function Sv(s,a,l,c,f,m,v,C,q,te,he,be){return s=new yE(s,a,l,v,q,te,he,be,C),a=1,m===!0&&(a|=24),m=kn(3,null,null,a),s.current=m,m.stateNode=s,a=pm(),a.refCount++,s.pooledCache=a,a.refCount++,m.memoizedState={element:c,isDehydrated:l,cache:a},ym(m),s}function Ev(s){return s?(s=$l,s):$l}function Tv(s,a,l,c,f,m){f=Ev(f),c.context===null?c.context=f:c.pendingContext=f,c=zr(a),c.payload={element:l},m=m===void 0?null:m,m!==null&&(c.callback=m),l=Fr(s,c,a),l!==null&&(pn(l,s,a),wc(l,s,a))}function Av(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<a?l:a}}function Vp(s,a){Av(s,a),(s=s.alternate)&&Av(s,a)}function kv(s){if(s.tag===13||s.tag===31){var a=qi(s,67108864);a!==null&&pn(a,s,67108864),Vp(s,67108864)}}function Cv(s){if(s.tag===13||s.tag===31){var a=Mn();a=ra(a);var l=qi(s,a);l!==null&&pn(l,s,a),Vp(s,a)}}var ih=!0;function vE(s,a,l,c){var f=O.T;O.T=null;var m=Q.p;try{Q.p=2,Lp(s,a,l,c)}finally{Q.p=m,O.T=f}}function wE(s,a,l,c){var f=O.T;O.T=null;var m=Q.p;try{Q.p=8,Lp(s,a,l,c)}finally{Q.p=m,O.T=f}}function Lp(s,a,l,c){if(ih){var f=Up(c);if(f===null)jp(s,a,c,lh,l),Iv(s,c);else if(_E(f,s,a,l,c))c.stopPropagation();else if(Iv(s,c),a&4&&-1<NE.indexOf(s)){for(;f!==null;){var m=Bn(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var v=Te(m.pendingLanes);if(v!==0){var C=m;for(C.pendingLanes|=2,C.entangledLanes|=2;v;){var q=1<<31-$(v);C.entanglements[1]|=q,v&=~q}Pa(m),(Rt&6)===0&&($d=Ue()+500,Vc(0))}}break;case 31:case 13:C=qi(m,2),C!==null&&pn(C,m,2),Hd(),Vp(m,2)}if(m=Up(c),m===null&&jp(s,a,c,lh,l),m===f)break;f=m}f!==null&&c.stopPropagation()}else jp(s,a,c,null,l)}}function Up(s){return s=zn(s),Bp(s)}var lh=null;function Bp(s){if(lh=null,s=Na(s),s!==null){var a=u(s);if(a===null)s=null;else{var l=a.tag;if(l===13){if(s=d(a),s!==null)return s;s=null}else if(l===31){if(s=p(a),s!==null)return s;s=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return lh=s,null}function Rv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(De()){case qe:return 2;case Ge:return 8;case Jt:case an:return 32;case jn:return 268435456;default:return 32}default:return 32}}var zp=!1,Zr=null,ei=null,ti=null,qc=new Map,Hc=new Map,si=[],NE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Iv(s,a){switch(s){case"focusin":case"focusout":Zr=null;break;case"dragenter":case"dragleave":ei=null;break;case"mouseover":case"mouseout":ti=null;break;case"pointerover":case"pointerout":qc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hc.delete(a.pointerId)}}function Gc(s,a,l,c,f,m){return s===null||s.nativeEvent!==m?(s={blockedOn:a,domEventName:l,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},a!==null&&(a=Bn(a),a!==null&&kv(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,f!==null&&a.indexOf(f)===-1&&a.push(f),s)}function _E(s,a,l,c,f){switch(a){case"focusin":return Zr=Gc(Zr,s,a,l,c,f),!0;case"dragenter":return ei=Gc(ei,s,a,l,c,f),!0;case"mouseover":return ti=Gc(ti,s,a,l,c,f),!0;case"pointerover":var m=f.pointerId;return qc.set(m,Gc(qc.get(m)||null,s,a,l,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Hc.set(m,Gc(Hc.get(m)||null,s,a,l,c,f)),!0}return!1}function Dv(s){var a=Na(s.target);if(a!==null){var l=u(a);if(l!==null){if(a=l.tag,a===13){if(a=d(l),a!==null){s.blockedOn=a,bs(s.priority,function(){Cv(l)});return}}else if(a===31){if(a=p(l),a!==null){s.blockedOn=a,bs(s.priority,function(){Cv(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function oh(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var l=Up(s.nativeEvent);if(l===null){l=s.nativeEvent;var c=new l.constructor(l.type,l);rc=c,l.target.dispatchEvent(c),rc=null}else return a=Bn(l),a!==null&&kv(a),s.blockedOn=l,!1;a.shift()}return!0}function Mv(s,a,l){oh(s)&&l.delete(a)}function jE(){zp=!1,Zr!==null&&oh(Zr)&&(Zr=null),ei!==null&&oh(ei)&&(ei=null),ti!==null&&oh(ti)&&(ti=null),qc.forEach(Mv),Hc.forEach(Mv)}function ch(s,a){s.blockedOn===a&&(s.blockedOn=null,zp||(zp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,jE)))}var uh=null;function Ov(s){uh!==s&&(uh=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){uh===s&&(uh=null);for(var a=0;a<s.length;a+=3){var l=s[a],c=s[a+1],f=s[a+2];if(typeof c!="function"){if(Bp(c||l)===null)continue;break}var m=Bn(l);m!==null&&(s.splice(a,3),a-=3,Um(m,{pending:!0,data:f,method:l.method,action:c},c,f))}}))}function mo(s){function a(q){return ch(q,s)}Zr!==null&&ch(Zr,s),ei!==null&&ch(ei,s),ti!==null&&ch(ti,s),qc.forEach(a),Hc.forEach(a);for(var l=0;l<si.length;l++){var c=si[l];c.blockedOn===s&&(c.blockedOn=null)}for(;0<si.length&&(l=si[0],l.blockedOn===null);)Dv(l),l.blockedOn===null&&si.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var f=l[c],m=l[c+1],v=f[ys]||null;if(typeof m=="function")v||Ov(l);else if(v){var C=null;if(m&&m.hasAttribute("formAction")){if(f=m,v=m[ys]||null)C=v.formAction;else if(Bp(f)!==null)continue}else C=v.action;typeof C=="function"?l[c+1]=C:(l.splice(c,3),c-=3),Ov(l)}}}function Pv(){function s(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function a(){f!==null&&(f(),f=null),c||setTimeout(l,20)}function l(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),f!==null&&(f(),f=null)}}}function Fp(s){this._internalRoot=s}dh.prototype.render=Fp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,c=Mn();Tv(l,c,s,a,null,null)},dh.prototype.unmount=Fp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;Tv(s.current,2,null,s,null,null),Hd(),a[Sn]=null}};function dh(s){this._internalRoot=s}dh.prototype.unstable_scheduleHydration=function(s){if(s){var a=Ri();s={blockedOn:null,target:s,priority:a};for(var l=0;l<si.length&&a!==0&&a<si[l].priority;l++);si.splice(l,0,s),l===0&&Dv(s)}};var Vv=e.version;if(Vv!=="19.2.4")throw Error(i(527,Vv,"19.2.4"));Q.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=x(a),s=s!==null?b(s):null,s=s===null?null:s.stateNode,s};var SE={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hh.isDisabled&&hh.supportsFiber)try{gs=hh.inject(SE),Vt=hh}catch{}}return Wc.createRoot=function(s,a){if(!o(s))throw Error(i(299));var l=!1,c="",f=qb,m=Hb,v=Gb;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(f=a.onUncaughtError),a.onCaughtError!==void 0&&(m=a.onCaughtError),a.onRecoverableError!==void 0&&(v=a.onRecoverableError)),a=Sv(s,1,!1,null,null,l,c,null,f,m,v,Pv),s[Sn]=a.current,_p(s),new Fp(a)},Wc.hydrateRoot=function(s,a,l){if(!o(s))throw Error(i(299));var c=!1,f="",m=qb,v=Hb,C=Gb,q=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError),l.formState!==void 0&&(q=l.formState)),a=Sv(s,1,!0,a,l??null,c,f,q,m,v,C,Pv),a.context=Ev(null),l=a.current,c=Mn(),c=ra(c),f=zr(c),f.callback=null,Fr(l,f,c),l=c,a.current.lanes=l,Wt(a,l),Pa(a),s[Sn]=a.current,_p(s),new dh(a)},Wc.version="19.2.4",Wc}var Yv;function OE(){if(Yv)return Hp.exports;Yv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Hp.exports=ME(),Hp.exports}var PE=OE();const VE=ag(PE);var Wv="popstate";function LE(n={}){function e(o,u){let{pathname:d="/",search:p="",hash:g=""}=Nl(o.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),v0("",{pathname:d,search:p,hash:g},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function t(o,u){let d=o.document.querySelector("base"),p="";if(d&&d.getAttribute("href")){let g=o.location.href,x=g.indexOf("#");p=x===-1?g:g.slice(0,x)}return p+"#"+(typeof u=="string"?u:bu(u))}function i(o,u){sa(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(u)})`)}return BE(e,t,i,n)}function ts(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function sa(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function UE(){return Math.random().toString(36).substring(2,10)}function Qv(n,e){return{usr:n.state,key:n.key,idx:e}}function v0(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Nl(e):e,state:t,key:e&&e.key||i||UE()}}function bu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Nl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function BE(n,e,t,i={}){let{window:o=document.defaultView,v5Compat:u=!1}=i,d=o.history,p="POP",g=null,x=b();x==null&&(x=0,d.replaceState({...d.state,idx:x},""));function b(){return(d.state||{idx:null}).idx}function w(){p="POP";let F=b(),H=F==null?null:F-x;x=F,g&&g({action:p,location:V.location,delta:H})}function S(F,H){p="PUSH";let W=v0(V.location,F,H);t&&t(W,F),x=b()+1;let z=Qv(W,x),ie=V.createHref(W);try{d.pushState(z,"",ie)}catch(ae){if(ae instanceof DOMException&&ae.name==="DataCloneError")throw ae;o.location.assign(ie)}u&&g&&g({action:p,location:V.location,delta:1})}function R(F,H){p="REPLACE";let W=v0(V.location,F,H);t&&t(W,F),x=b();let z=Qv(W,x),ie=V.createHref(W);d.replaceState(z,"",ie),u&&g&&g({action:p,location:V.location,delta:0})}function B(F){return zE(F)}let V={get action(){return p},get location(){return n(o,d)},listen(F){if(g)throw new Error("A history only accepts one active listener");return o.addEventListener(Wv,w),g=F,()=>{o.removeEventListener(Wv,w),g=null}},createHref(F){return e(o,F)},createURL:B,encodeLocation(F){let H=B(F);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:S,replace:R,go(F){return d.go(F)}};return V}function zE(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ts(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:bu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function pN(n,e,t="/"){return FE(n,e,t,!1)}function FE(n,e,t,i){let o=typeof e=="string"?Nl(e):e,u=wr(o.pathname||"/",t);if(u==null)return null;let d=gN(n);$E(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let x=eT(u);p=JE(d[g],x,i)}return p}function gN(n,e=[],t=[],i="",o=!1){let u=(d,p,g=o,x)=>{let b={relativePath:x===void 0?d.path||"":x,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&g)return;ts(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let w=br([i,b.relativePath]),S=t.concat(b);d.children&&d.children.length>0&&(ts(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),gN(d.children,e,S,w,g)),!(d.path==null&&!d.index)&&e.push({path:w,score:KE(w,d.index),routesMeta:S})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of xN(d.path))u(d,p,!0,g)}),e}function xN(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,o=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return o?[u,""]:[u];let d=xN(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),o&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function $E(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:XE(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var qE=/^:[\w-]+$/,HE=3,GE=2,YE=1,WE=10,QE=-2,Kv=n=>n==="*";function KE(n,e){let t=n.split("/"),i=t.length;return t.some(Kv)&&(i+=QE),e&&(i+=GE),t.filter(o=>!Kv(o)).reduce((o,u)=>o+(qE.test(u)?HE:u===""?YE:WE),i)}function XE(n,e){return n.length===e.length&&n.slice(0,-1).every((i,o)=>i===e[o])?n[n.length-1]-e[e.length-1]:0}function JE(n,e,t=!1){let{routesMeta:i}=n,o={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],x=p===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",w=Hh({path:g.relativePath,caseSensitive:g.caseSensitive,end:x},b),S=g.route;if(!w&&x&&t&&!i[i.length-1].route.index&&(w=Hh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},b)),!w)return null;Object.assign(o,w.params),d.push({params:o,pathname:br([u,w.pathname]),pathnameBase:aT(br([u,w.pathnameBase])),route:S}),w.pathnameBase!=="/"&&(u=br([u,w.pathnameBase]))}return d}function Hh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=ZE(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let u=o[0],d=u.replace(/(.)\/+$/,"$1"),p=o.slice(1);return{params:i.reduce((x,{paramName:b,isOptional:w},S)=>{if(b==="*"){let B=p[S]||"";d=u.slice(0,u.length-B.length).replace(/(.)\/+$/,"$1")}const R=p[S];return w&&!R?x[b]=void 0:x[b]=(R||"").replace(/%2F/g,"/"),x},{}),pathname:u,pathnameBase:d,pattern:n}}function ZE(n,e=!1,t=!0){sa(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function eT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return sa(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function wr(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var tT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function sT(n,e="/"){let{pathname:t,search:i="",hash:o=""}=typeof n=="string"?Nl(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=Xv(t.substring(1),"/"):u=Xv(t,e)):u=e,{pathname:u,search:rT(i),hash:iT(o)}}function Xv(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Qp(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function ig(n){let e=nT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function lg(n,e,t,i=!1){let o;typeof n=="string"?o=Nl(n):(o={...n},ts(!o.pathname||!o.pathname.includes("?"),Qp("?","pathname","search",o)),ts(!o.pathname||!o.pathname.includes("#"),Qp("#","pathname","hash",o)),ts(!o.search||!o.search.includes("#"),Qp("#","search","hash",o)));let u=n===""||o.pathname==="",d=u?"/":o.pathname,p;if(d==null)p=t;else{let w=e.length-1;if(!i&&d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),w-=1;o.pathname=S.join("/")}p=w>=0?e[w]:"/"}let g=sT(o,p),x=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(x||b)&&(g.pathname+="/"),g}var br=n=>n.join("/").replace(/\/\/+/g,"/"),aT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),rT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,iT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,lT=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function oT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function cT(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var bN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function yN(n,e){let t=n;if(typeof t!="string"||!tT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,o=!1;if(bN)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=wr(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:o=!0}catch{sa(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:o,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var vN=["POST","PUT","PATCH","DELETE"];new Set(vN);var uT=["GET",...vN];new Set(uT);var zo=j.createContext(null);zo.displayName="DataRouter";var bf=j.createContext(null);bf.displayName="DataRouterState";var dT=j.createContext(!1),wN=j.createContext({isTransitioning:!1});wN.displayName="ViewTransition";var hT=j.createContext(new Map);hT.displayName="Fetchers";var fT=j.createContext(null);fT.displayName="Await";var Un=j.createContext(null);Un.displayName="Navigation";var Ru=j.createContext(null);Ru.displayName="Location";var va=j.createContext({outlet:null,matches:[],isDataRoute:!1});va.displayName="Route";var og=j.createContext(null);og.displayName="RouteError";var NN="REACT_ROUTER_ERROR",mT="REDIRECT",pT="ROUTE_ERROR_RESPONSE";function gT(n){if(n.startsWith(`${NN}:${mT}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function xT(n){if(n.startsWith(`${NN}:${pT}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new lT(e.status,e.statusText,e.data)}catch{}}function bT(n,{relative:e}={}){ts(Fo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=j.useContext(Un),{hash:o,pathname:u,search:d}=Iu(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:br([t,u])),i.createHref({pathname:p,search:d,hash:o})}function Fo(){return j.useContext(Ru)!=null}function Si(){return ts(Fo(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(Ru).location}var _N="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function jN(n){j.useContext(Un).static||j.useLayoutEffect(n)}function _l(){let{isDataRoute:n}=j.useContext(va);return n?RT():yT()}function yT(){ts(Fo(),"useNavigate() may be used only in the context of a <Router> component.");let n=j.useContext(zo),{basename:e,navigator:t}=j.useContext(Un),{matches:i}=j.useContext(va),{pathname:o}=Si(),u=JSON.stringify(ig(i)),d=j.useRef(!1);return jN(()=>{d.current=!0}),j.useCallback((g,x={})=>{if(sa(d.current,_N),!d.current)return;if(typeof g=="number"){t.go(g);return}let b=lg(g,JSON.parse(u),o,x.relative==="path");n==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:br([e,b.pathname])),(x.replace?t.replace:t.push)(b,x.state,x)},[e,t,u,o,n])}j.createContext(null);function $o(){let{matches:n}=j.useContext(va),e=n[n.length-1];return e?e.params:{}}function Iu(n,{relative:e}={}){let{matches:t}=j.useContext(va),{pathname:i}=Si(),o=JSON.stringify(ig(t));return j.useMemo(()=>lg(n,JSON.parse(o),i,e==="path"),[n,o,i,e])}function vT(n,e){return SN(n,e)}function SN(n,e,t,i,o){ts(Fo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=j.useContext(Un),{matches:d}=j.useContext(va),p=d[d.length-1],g=p?p.params:{},x=p?p.pathname:"/",b=p?p.pathnameBase:"/",w=p&&p.route;{let W=w&&w.path||"";TN(x,!w||W.endsWith("*")||W.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${x}" (under <Route path="${W}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${W}"> to <Route path="${W==="/"?"*":`${W}/*`}">.`)}let S=Si(),R;if(e){let W=typeof e=="string"?Nl(e):e;ts(b==="/"||W.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${W.pathname}" was given in the \`location\` prop.`),R=W}else R=S;let B=R.pathname||"/",V=B;if(b!=="/"){let W=b.replace(/^\//,"").split("/");V="/"+B.replace(/^\//,"").split("/").slice(W.length).join("/")}let F=pN(n,{pathname:V});sa(w||F!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),sa(F==null||F[F.length-1].route.element!==void 0||F[F.length-1].route.Component!==void 0||F[F.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let H=ST(F&&F.map(W=>Object.assign({},W,{params:Object.assign({},g,W.params),pathname:br([b,u.encodeLocation?u.encodeLocation(W.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:W.pathname]),pathnameBase:W.pathnameBase==="/"?b:br([b,u.encodeLocation?u.encodeLocation(W.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:W.pathnameBase])})),d,t,i,o);return e&&H?j.createElement(Ru.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...R},navigationType:"POP"}},H):H}function wT(){let n=CT(),e=oT(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:u},"ErrorBoundary")," or"," ",j.createElement("code",{style:u},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:o},t):null,d)}var NT=j.createElement(wT,null),EN=class extends j.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=xT(n.digest);t&&(n=t)}let e=n!==void 0?j.createElement(va.Provider,{value:this.props.routeContext},j.createElement(og.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?j.createElement(_T,{error:n},e):e}};EN.contextType=dT;var Kp=new WeakMap;function _T({children:n,error:e}){let{basename:t}=j.useContext(Un);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=gT(e.digest);if(i){let o=Kp.get(e);if(o)throw o;let u=yN(i.location,t);if(bN&&!Kp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Kp.set(e,d),d}return j.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function jT({routeContext:n,match:e,children:t}){let i=j.useContext(zo);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),j.createElement(va.Provider,{value:n},t)}function ST(n,e=[],t=null,i=null,o=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let b=u.findIndex(w=>w.route.id&&d?.[w.route.id]!==void 0);ts(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let p=!1,g=-1;if(t)for(let b=0;b<u.length;b++){let w=u[b];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(g=b),w.route.id){let{loaderData:S,errors:R}=t,B=w.route.loader&&!S.hasOwnProperty(w.route.id)&&(!R||R[w.route.id]===void 0);if(w.route.lazy||B){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let x=t&&i?(b,w)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:cT(t.matches),errorInfo:w})}:void 0;return u.reduceRight((b,w,S)=>{let R,B=!1,V=null,F=null;t&&(R=d&&w.route.id?d[w.route.id]:void 0,V=w.route.errorElement||NT,p&&(g<0&&S===0?(TN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),B=!0,F=null):g===S&&(B=!0,F=w.route.hydrateFallbackElement||null)));let H=e.concat(u.slice(0,S+1)),W=()=>{let z;return R?z=V:B?z=F:w.route.Component?z=j.createElement(w.route.Component,null):w.route.element?z=w.route.element:z=b,j.createElement(jT,{match:w,routeContext:{outlet:b,matches:H,isDataRoute:t!=null},children:z})};return t&&(w.route.ErrorBoundary||w.route.errorElement||S===0)?j.createElement(EN,{location:t.location,revalidation:t.revalidation,component:V,error:R,children:W(),routeContext:{outlet:null,matches:H,isDataRoute:!0},onError:x}):W()},null)}function cg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ET(n){let e=j.useContext(zo);return ts(e,cg(n)),e}function TT(n){let e=j.useContext(bf);return ts(e,cg(n)),e}function AT(n){let e=j.useContext(va);return ts(e,cg(n)),e}function ug(n){let e=AT(n),t=e.matches[e.matches.length-1];return ts(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function kT(){return ug("useRouteId")}function CT(){let n=j.useContext(og),e=TT("useRouteError"),t=ug("useRouteError");return n!==void 0?n:e.errors?.[t]}function RT(){let{router:n}=ET("useNavigate"),e=ug("useNavigate"),t=j.useRef(!1);return jN(()=>{t.current=!0}),j.useCallback(async(o,u={})=>{sa(t.current,_N),t.current&&(typeof o=="number"?await n.navigate(o):await n.navigate(o,{fromRouteId:e,...u}))},[n,e])}var Jv={};function TN(n,e,t){!e&&!Jv[n]&&(Jv[n]=!0,sa(!1,t))}j.memo(IT);function IT({routes:n,future:e,state:t,onError:i}){return SN(n,void 0,t,i,e)}function Zv({to:n,replace:e,state:t,relative:i}){ts(Fo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=j.useContext(Un);sa(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=j.useContext(va),{pathname:d}=Si(),p=_l(),g=lg(n,ig(u),d,i==="path"),x=JSON.stringify(g);return j.useEffect(()=>{p(JSON.parse(x),{replace:e,state:t,relative:i})},[p,x,i,e,t]),null}function Jn(n){ts(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function DT({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:o,static:u=!1,unstable_useTransitions:d}){ts(!Fo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=j.useMemo(()=>({basename:p,navigator:o,static:u,unstable_useTransitions:d,future:{}}),[p,o,u,d]);typeof t=="string"&&(t=Nl(t));let{pathname:x="/",search:b="",hash:w="",state:S=null,key:R="default"}=t,B=j.useMemo(()=>{let V=wr(x,p);return V==null?null:{location:{pathname:V,search:b,hash:w,state:S,key:R},navigationType:i}},[p,x,b,w,S,R,i]);return sa(B!=null,`<Router basename="${p}"> is not able to match the URL "${x}${b}${w}" because it does not start with the basename, so the <Router> won't render anything.`),B==null?null:j.createElement(Un.Provider,{value:g},j.createElement(Ru.Provider,{children:e,value:B}))}function MT({children:n,location:e}){return vT(w0(n),e)}function w0(n,e=[]){let t=[];return j.Children.forEach(n,(i,o)=>{if(!j.isValidElement(i))return;let u=[...e,o];if(i.type===j.Fragment){t.push.apply(t,w0(i.props.children,u));return}ts(i.type===Jn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ts(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=w0(i.props.children,u)),t.push(d)}),t}var Ah="get",kh="application/x-www-form-urlencoded";function yf(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function OT(n){return yf(n)&&n.tagName.toLowerCase()==="button"}function PT(n){return yf(n)&&n.tagName.toLowerCase()==="form"}function VT(n){return yf(n)&&n.tagName.toLowerCase()==="input"}function LT(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function UT(n,e){return n.button===0&&(!e||e==="_self")&&!LT(n)}var fh=null;function BT(){if(fh===null)try{new FormData(document.createElement("form"),0),fh=!1}catch{fh=!0}return fh}var zT=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Xp(n){return n!=null&&!zT.has(n)?(sa(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${kh}"`),null):n}function FT(n,e){let t,i,o,u,d;if(PT(n)){let p=n.getAttribute("action");i=p?wr(p,e):null,t=n.getAttribute("method")||Ah,o=Xp(n.getAttribute("enctype"))||kh,u=new FormData(n)}else if(OT(n)||VT(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?wr(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||Ah,o=Xp(n.getAttribute("formenctype"))||Xp(p.getAttribute("enctype"))||kh,u=new FormData(p,n),!BT()){let{name:x,type:b,value:w}=n;if(b==="image"){let S=x?`${x}.`:"";u.append(`${S}x`,"0"),u.append(`${S}y`,"0")}else x&&u.append(x,w)}}else{if(yf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Ah,i=null,o=kh,d=n}return u&&o==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:o,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function dg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function $T(n,e,t,i){let o=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${i}`:o.pathname=`${o.pathname}.${i}`:o.pathname==="/"?o.pathname=`_root.${i}`:e&&wr(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${i}`,o}async function qT(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function HT(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function GT(n,e,t){let i=await Promise.all(n.map(async o=>{let u=e.routes[o.route.id];if(u){let d=await qT(u,t);return d.links?d.links():[]}return[]}));return KT(i.flat(1).filter(HT).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function ew(n,e,t,i,o,u){let d=(g,x)=>t[x]?g.route.id!==t[x].route.id:!0,p=(g,x)=>t[x].pathname!==g.pathname||t[x].route.path?.endsWith("*")&&t[x].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,x)=>d(g,x)||p(g,x)):u==="data"?e.filter((g,x)=>{let b=i.routes[g.route.id];if(!b||!b.hasLoader)return!1;if(d(g,x)||p(g,x))return!0;if(g.route.shouldRevalidate){let w=g.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function YT(n,e,{includeHydrateFallback:t}={}){return WT(n.map(i=>{let o=e.routes[i.route.id];if(!o)return[];let u=[o.module];return o.clientActionModule&&(u=u.concat(o.clientActionModule)),o.clientLoaderModule&&(u=u.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(u=u.concat(o.hydrateFallbackModule)),o.imports&&(u=u.concat(o.imports)),u}).flat(1))}function WT(n){return[...new Set(n)]}function QT(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function KT(n,e){let t=new Set;return new Set(e),n.reduce((i,o)=>{let u=JSON.stringify(QT(o));return t.has(u)||(t.add(u),i.push({key:u,link:o})),i},[])}function AN(){let n=j.useContext(zo);return dg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function XT(){let n=j.useContext(bf);return dg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var hg=j.createContext(void 0);hg.displayName="FrameworkContext";function kN(){let n=j.useContext(hg);return dg(n,"You must render this element inside a <HydratedRouter> element"),n}function JT(n,e){let t=j.useContext(hg),[i,o]=j.useState(!1),[u,d]=j.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:x,onMouseLeave:b,onTouchStart:w}=e,S=j.useRef(null);j.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let V=H=>{H.forEach(W=>{d(W.isIntersecting)})},F=new IntersectionObserver(V,{threshold:.5});return S.current&&F.observe(S.current),()=>{F.disconnect()}}},[n]),j.useEffect(()=>{if(i){let V=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(V)}}},[i]);let R=()=>{o(!0)},B=()=>{o(!1),d(!1)};return t?n!=="intent"?[u,S,{}]:[u,S,{onFocus:Qc(p,R),onBlur:Qc(g,B),onMouseEnter:Qc(x,R),onMouseLeave:Qc(b,B),onTouchStart:Qc(w,R)}]:[!1,S,{}]}function Qc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function ZT({page:n,...e}){let{router:t}=AN(),i=j.useMemo(()=>pN(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?j.createElement(t5,{page:n,matches:i,...e}):null}function e5(n){let{manifest:e,routeModules:t}=kN(),[i,o]=j.useState([]);return j.useEffect(()=>{let u=!1;return GT(n,e,t).then(d=>{u||o(d)}),()=>{u=!0}},[n,e,t]),i}function t5({page:n,matches:e,...t}){let i=Si(),{future:o,manifest:u,routeModules:d}=kN(),{basename:p}=AN(),{loaderData:g,matches:x}=XT(),b=j.useMemo(()=>ew(n,e,x,u,i,"data"),[n,e,x,u,i]),w=j.useMemo(()=>ew(n,e,x,u,i,"assets"),[n,e,x,u,i]),S=j.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let V=new Set,F=!1;if(e.forEach(W=>{let z=u.routes[W.route.id];!z||!z.hasLoader||(!b.some(ie=>ie.route.id===W.route.id)&&W.route.id in g&&d[W.route.id]?.shouldRevalidate||z.hasClientLoader?F=!0:V.add(W.route.id))}),V.size===0)return[];let H=$T(n,p,o.unstable_trailingSlashAwareDataRequests,"data");return F&&V.size>0&&H.searchParams.set("_routes",e.filter(W=>V.has(W.route.id)).map(W=>W.route.id).join(",")),[H.pathname+H.search]},[p,o.unstable_trailingSlashAwareDataRequests,g,i,u,b,e,n,d]),R=j.useMemo(()=>YT(w,u),[w,u]),B=e5(w);return j.createElement(j.Fragment,null,S.map(V=>j.createElement("link",{key:V,rel:"prefetch",as:"fetch",href:V,...t})),R.map(V=>j.createElement("link",{key:V,rel:"modulepreload",href:V,...t})),B.map(({key:V,link:F})=>j.createElement("link",{key:V,nonce:t.nonce,...F,crossOrigin:F.crossOrigin??t.crossOrigin})))}function s5(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var n5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{n5&&(window.__reactRouterVersion="7.13.0")}catch{}function a5({basename:n,children:e,unstable_useTransitions:t,window:i}){let o=j.useRef();o.current==null&&(o.current=LE({window:i,v5Compat:!0}));let u=o.current,[d,p]=j.useState({action:u.action,location:u.location}),g=j.useCallback(x=>{t===!1?p(x):j.startTransition(()=>p(x))},[t]);return j.useLayoutEffect(()=>u.listen(g),[u,g]),j.createElement(DT,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var CN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nt=j.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:o,reloadDocument:u,replace:d,state:p,target:g,to:x,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:S,...R},B){let{basename:V,unstable_useTransitions:F}=j.useContext(Un),H=typeof x=="string"&&CN.test(x),W=yN(x,V);x=W.to;let z=bT(x,{relative:o}),[ie,ae,Y]=JT(i,R),A=o5(x,{replace:d,state:p,target:g,preventScrollReset:b,relative:o,viewTransition:w,unstable_defaultShouldRevalidate:S,unstable_useTransitions:F});function T(I){e&&e(I),I.defaultPrevented||A(I)}let E=j.createElement("a",{...R,...Y,href:W.absoluteURL||z,onClick:W.isExternal||u?e:T,ref:s5(B,ae),target:g,"data-discover":!H&&t==="render"?"true":void 0});return ie&&!H?j.createElement(j.Fragment,null,E,j.createElement(ZT,{page:z})):E});nt.displayName="Link";var r5=j.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:o=!1,style:u,to:d,viewTransition:p,children:g,...x},b){let w=Iu(d,{relative:x.relative}),S=Si(),R=j.useContext(bf),{navigator:B,basename:V}=j.useContext(Un),F=R!=null&&f5(w)&&p===!0,H=B.encodeLocation?B.encodeLocation(w).pathname:w.pathname,W=S.pathname,z=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;t||(W=W.toLowerCase(),z=z?z.toLowerCase():null,H=H.toLowerCase()),z&&V&&(z=wr(z,V)||z);const ie=H!=="/"&&H.endsWith("/")?H.length-1:H.length;let ae=W===H||!o&&W.startsWith(H)&&W.charAt(ie)==="/",Y=z!=null&&(z===H||!o&&z.startsWith(H)&&z.charAt(H.length)==="/"),A={isActive:ae,isPending:Y,isTransitioning:F},T=ae?e:void 0,E;typeof i=="function"?E=i(A):E=[i,ae?"active":null,Y?"pending":null,F?"transitioning":null].filter(Boolean).join(" ");let I=typeof u=="function"?u(A):u;return j.createElement(nt,{...x,"aria-current":T,className:E,ref:b,style:I,to:d,viewTransition:p},typeof g=="function"?g(A):g)});r5.displayName="NavLink";var i5=j.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:o,state:u,method:d=Ah,action:p,onSubmit:g,relative:x,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:S,...R},B)=>{let{unstable_useTransitions:V}=j.useContext(Un),F=d5(),H=h5(p,{relative:x}),W=d.toLowerCase()==="get"?"get":"post",z=typeof p=="string"&&CN.test(p),ie=ae=>{if(g&&g(ae),ae.defaultPrevented)return;ae.preventDefault();let Y=ae.nativeEvent.submitter,A=Y?.getAttribute("formmethod")||d,T=()=>F(Y||ae.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:o,state:u,relative:x,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:S});V&&t!==!1?j.startTransition(()=>T()):T()};return j.createElement("form",{ref:B,method:W,action:H,onSubmit:i?g:ie,...R,"data-discover":!z&&n==="render"?"true":void 0})});i5.displayName="Form";function l5(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function RN(n){let e=j.useContext(zo);return ts(e,l5(n)),e}function o5(n,{target:e,replace:t,state:i,preventScrollReset:o,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let x=_l(),b=Si(),w=Iu(n,{relative:u});return j.useCallback(S=>{if(UT(S,e)){S.preventDefault();let R=t!==void 0?t:bu(b)===bu(w),B=()=>x(n,{replace:R,state:i,preventScrollReset:o,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?j.startTransition(()=>B()):B()}},[b,x,w,t,i,e,n,o,u,d,p,g])}var c5=0,u5=()=>`__${String(++c5)}__`;function d5(){let{router:n}=RN("useSubmit"),{basename:e}=j.useContext(Un),t=kT(),i=n.fetch,o=n.navigate;return j.useCallback(async(u,d={})=>{let{action:p,method:g,encType:x,formData:b,body:w}=FT(u,e);if(d.navigate===!1){let S=d.fetcherKey||u5();await i(S,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:w,formMethod:d.method||g,formEncType:d.encType||x,flushSync:d.flushSync})}else await o(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:w,formMethod:d.method||g,formEncType:d.encType||x,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,o,e,t])}function h5(n,{relative:e}={}){let{basename:t}=j.useContext(Un),i=j.useContext(va);ts(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),u={...Iu(n||".",{relative:e})},d=Si();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(b=>b==="")){p.delete("index"),g.filter(w=>w).forEach(w=>p.append("index",w));let b=p.toString();u.search=b?`?${b}`:""}}return(!n||n===".")&&o.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:br([t,u.pathname])),bu(u)}function f5(n,{relative:e}={}){let t=j.useContext(wN);ts(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=RN("useViewTransitionState"),o=Iu(n,{relative:e});if(!t.isTransitioning)return!1;let u=wr(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=wr(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Hh(o.pathname,d)!=null||Hh(o.pathname,u)!=null}const m5=()=>{};var tw={};const IN=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},p5=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const u=n[t++];e[i++]=String.fromCharCode((o&31)<<6|u&63)}else if(o>239&&o<365){const u=n[t++],d=n[t++],p=n[t++],g=((o&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(u&63)<<6|d&63)}}return e.join("")},DN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const u=n[o],d=o+1<n.length,p=d?n[o+1]:0,g=o+2<n.length,x=g?n[o+2]:0,b=u>>2,w=(u&3)<<4|p>>4;let S=(p&15)<<2|x>>6,R=x&63;g||(R=64,d||(S=64)),i.push(t[b],t[w],t[S],t[R])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(IN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):p5(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const u=t[n.charAt(o++)],p=o<n.length?t[n.charAt(o)]:0;++o;const x=o<n.length?t[n.charAt(o)]:64;++o;const w=o<n.length?t[n.charAt(o)]:64;if(++o,u==null||p==null||x==null||w==null)throw new g5;const S=u<<2|p>>4;if(i.push(S),x!==64){const R=p<<4&240|x>>2;if(i.push(R),w!==64){const B=x<<6&192|w;i.push(B)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class g5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const x5=function(n){const e=IN(n);return DN.encodeByteArray(e,!0)},Gh=function(n){return x5(n).replace(/\./g,"")},MN=function(n){try{return DN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function b5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const y5=()=>b5().__FIREBASE_DEFAULTS__,v5=()=>{if(typeof process>"u"||typeof tw>"u")return;const n=tw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},w5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&MN(n[1]);return e&&JSON.parse(e)},vf=()=>{try{return m5()||y5()||v5()||w5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ON=n=>vf()?.emulatorHosts?.[n],PN=n=>{const e=ON(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},VN=()=>vf()?.config,LN=n=>vf()?.[`_${n}`];class N5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Ei(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function fg(n){return(await fetch(n,{credentials:"include"})).ok}function UN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Gh(JSON.stringify(t)),Gh(JSON.stringify(d)),""].join(".")}const uu={};function _5(){const n={prod:[],emulator:[]};for(const e of Object.keys(uu))uu[e]?n.emulator.push(e):n.prod.push(e);return n}function j5(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let sw=!1;function mg(n,e){if(typeof window>"u"||typeof document>"u"||!Ei(window.location.host)||uu[n]===e||uu[n]||sw)return;uu[n]=e;function t(S){return`__firebase__banner__${S}`}const i="__firebase__banner",u=_5().prod.length>0;function d(){const S=document.getElementById(i);S&&S.remove()}function p(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function g(S,R){S.setAttribute("width","24"),S.setAttribute("id",R),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function x(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{sw=!0,d()},S}function b(S,R){S.setAttribute("id",R),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function w(){const S=j5(i),R=t("text"),B=document.getElementById(R)||document.createElement("span"),V=t("learnmore"),F=document.getElementById(V)||document.createElement("a"),H=t("preprendIcon"),W=document.getElementById(H)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const z=S.element;p(z),b(F,V);const ie=x();g(W,H),z.append(W,B,F,ie),document.body.appendChild(z)}u?(B.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}function Xs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function S5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xs())}function E5(){const n=vf()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function T5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function A5(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function k5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function C5(){const n=Xs();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function R5(){return!E5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function I5(){try{return typeof indexedDB=="object"}catch{return!1}}function D5(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}const M5="FirebaseError";class Ka extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=M5,Object.setPrototypeOf(this,Ka.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Du.prototype.create)}}class Du{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,u=this.errors[e],d=u?O5(u,i):"Error",p=`${this.serviceName}: ${d} (${o}).`;return new Ka(o,p,i)}}function O5(n,e){return n.replace(P5,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const P5=/\{\$([^}]+)}/g;function V5(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function fl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const u=n[o],d=e[o];if(nw(u)&&nw(d)){if(!fl(u,d))return!1}else if(u!==d)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function nw(n){return n!==null&&typeof n=="object"}function Mu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function nu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,u]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(u)}}),e}function au(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function L5(n,e){const t=new U5(n,e);return t.subscribe.bind(t)}class U5{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");B5(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=Jp),o.error===void 0&&(o.error=Jp),o.complete===void 0&&(o.complete=Jp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function B5(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Jp(){}function ss(n){return n&&n._delegate?n._delegate:n}class xi{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ll="[DEFAULT]";class z5{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new N5;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($5(e))try{this.getOrInitializeService({instanceIdentifier:ll})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:o});i.resolve(u)}catch{}}}}clearInstance(e=ll){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ll){return this.instances.has(e)}getOptions(e=ll){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const u=this.instances.get(i);return u&&e(u,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:F5(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ll){return this.component?this.component.multipleInstances?e:ll:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function F5(n){return n===ll?void 0:n}function $5(n){return n.instantiationMode==="EAGER"}class q5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new z5(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var yt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yt||(yt={}));const H5={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},G5=yt.INFO,Y5={[yt.DEBUG]:"log",[yt.VERBOSE]:"log",[yt.INFO]:"info",[yt.WARN]:"warn",[yt.ERROR]:"error"},W5=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=Y5[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class pg{constructor(e){this.name=e,this._logLevel=G5,this._logHandler=W5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?H5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yt.DEBUG,...e),this._logHandler(this,yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yt.VERBOSE,...e),this._logHandler(this,yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yt.INFO,...e),this._logHandler(this,yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yt.WARN,...e),this._logHandler(this,yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yt.ERROR,...e),this._logHandler(this,yt.ERROR,...e)}}const Q5=(n,e)=>e.some(t=>n instanceof t);let aw,rw;function K5(){return aw||(aw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function X5(){return rw||(rw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const BN=new WeakMap,N0=new WeakMap,zN=new WeakMap,Zp=new WeakMap,gg=new WeakMap;function J5(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(hi(n.result)),o()},d=()=>{i(n.error),o()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&BN.set(t,n)}).catch(()=>{}),gg.set(e,n),e}function Z5(n){if(N0.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),o()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});N0.set(n,e)}let _0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return N0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||zN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return hi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function eA(n){_0=n(_0)}function tA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(e0(this),e,...t);return zN.set(i,e.sort?e.sort():[e]),hi(i)}:X5().includes(n)?function(...e){return n.apply(e0(this),e),hi(BN.get(this))}:function(...e){return hi(n.apply(e0(this),e))}}function sA(n){return typeof n=="function"?tA(n):(n instanceof IDBTransaction&&Z5(n),Q5(n,K5())?new Proxy(n,_0):n)}function hi(n){if(n instanceof IDBRequest)return J5(n);if(Zp.has(n))return Zp.get(n);const e=sA(n);return e!==n&&(Zp.set(n,e),gg.set(e,n)),e}const e0=n=>gg.get(n);function nA(n,e,{blocked:t,upgrade:i,blocking:o,terminated:u}={}){const d=indexedDB.open(n,e),p=hi(d);return i&&d.addEventListener("upgradeneeded",g=>{i(hi(d.result),g.oldVersion,g.newVersion,hi(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),o&&g.addEventListener("versionchange",x=>o(x.oldVersion,x.newVersion,x))}).catch(()=>{}),p}const aA=["get","getKey","getAll","getAllKeys","count"],rA=["put","add","delete","clear"],t0=new Map;function iw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(t0.get(e))return t0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=rA.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||aA.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,o?"readwrite":"readonly");let x=g.store;return i&&(x=x.index(p.shift())),(await Promise.all([x[t](...p),o&&g.done]))[0]};return t0.set(e,u),u}eA(n=>({...n,get:(e,t,i)=>iw(e,t)||n.get(e,t,i),has:(e,t)=>!!iw(e,t)||n.has(e,t)}));class iA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(lA(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function lA(n){return n.getComponent()?.type==="VERSION"}const j0="@firebase/app",lw="0.14.7";const Nr=new pg("@firebase/app"),oA="@firebase/app-compat",cA="@firebase/analytics-compat",uA="@firebase/analytics",dA="@firebase/app-check-compat",hA="@firebase/app-check",fA="@firebase/auth",mA="@firebase/auth-compat",pA="@firebase/database",gA="@firebase/data-connect",xA="@firebase/database-compat",bA="@firebase/functions",yA="@firebase/functions-compat",vA="@firebase/installations",wA="@firebase/installations-compat",NA="@firebase/messaging",_A="@firebase/messaging-compat",jA="@firebase/performance",SA="@firebase/performance-compat",EA="@firebase/remote-config",TA="@firebase/remote-config-compat",AA="@firebase/storage",kA="@firebase/storage-compat",CA="@firebase/firestore",RA="@firebase/ai",IA="@firebase/firestore-compat",DA="firebase",MA="12.8.0";const S0="[DEFAULT]",OA={[j0]:"fire-core",[oA]:"fire-core-compat",[uA]:"fire-analytics",[cA]:"fire-analytics-compat",[hA]:"fire-app-check",[dA]:"fire-app-check-compat",[fA]:"fire-auth",[mA]:"fire-auth-compat",[pA]:"fire-rtdb",[gA]:"fire-data-connect",[xA]:"fire-rtdb-compat",[bA]:"fire-fn",[yA]:"fire-fn-compat",[vA]:"fire-iid",[wA]:"fire-iid-compat",[NA]:"fire-fcm",[_A]:"fire-fcm-compat",[jA]:"fire-perf",[SA]:"fire-perf-compat",[EA]:"fire-rc",[TA]:"fire-rc-compat",[AA]:"fire-gcs",[kA]:"fire-gcs-compat",[CA]:"fire-fst",[IA]:"fire-fst-compat",[RA]:"fire-vertex","fire-js":"fire-js",[DA]:"fire-js-all"};const Yh=new Map,PA=new Map,E0=new Map;function ow(n,e){try{n.container.addComponent(e)}catch(t){Nr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ml(n){const e=n.name;if(E0.has(e))return Nr.debug(`There were multiple attempts to register component ${e}.`),!1;E0.set(e,n);for(const t of Yh.values())ow(t,n);for(const t of PA.values())ow(t,n);return!0}function wf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function On(n){return n==null?!1:n.settings!==void 0}const VA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fi=new Du("app","Firebase",VA);class LA{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new xi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fi.create("app-deleted",{appName:this._name})}}const jl=MA;function FN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:S0,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw fi.create("bad-app-name",{appName:String(o)});if(t||(t=VN()),!t)throw fi.create("no-options");const u=Yh.get(o);if(u){if(fl(t,u.options)&&fl(i,u.config))return u;throw fi.create("duplicate-app",{appName:o})}const d=new q5(o);for(const g of E0.values())d.addComponent(g);const p=new LA(t,i,d);return Yh.set(o,p),p}function xg(n=S0){const e=Yh.get(n);if(!e&&n===S0&&VN())return FN();if(!e)throw fi.create("no-app",{appName:n});return e}function za(n,e,t){let i=OA[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),u=e.match(/\s|\//);if(o||u){const d=[`Unable to register library "${i}" with version "${e}":`];o&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Nr.warn(d.join(" "));return}ml(new xi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const UA="firebase-heartbeat-database",BA=1,yu="firebase-heartbeat-store";let s0=null;function $N(){return s0||(s0=nA(UA,BA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(yu)}catch(t){console.warn(t)}}}}).catch(n=>{throw fi.create("idb-open",{originalErrorMessage:n.message})})),s0}async function zA(n){try{const t=(await $N()).transaction(yu),i=await t.objectStore(yu).get(qN(n));return await t.done,i}catch(e){if(e instanceof Ka)Nr.warn(e.message);else{const t=fi.create("idb-get",{originalErrorMessage:e?.message});Nr.warn(t.message)}}}async function cw(n,e){try{const i=(await $N()).transaction(yu,"readwrite");await i.objectStore(yu).put(e,qN(n)),await i.done}catch(t){if(t instanceof Ka)Nr.warn(t.message);else{const i=fi.create("idb-set",{originalErrorMessage:t?.message});Nr.warn(i.message)}}}function qN(n){return`${n.name}!${n.options.appId}`}const FA=1024,$A=30;class qA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new GA(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=uw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>$A){const o=YA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Nr.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=uw(),{heartbeatsToSend:t,unsentEntries:i}=HA(this._heartbeatsCache.heartbeats),o=Gh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Nr.warn(e),""}}}function uw(){return new Date().toISOString().substring(0,10)}function HA(n,e=FA){const t=[];let i=n.slice();for(const o of n){const u=t.find(d=>d.agent===o.agent);if(u){if(u.dates.push(o.date),dw(t)>e){u.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),dw(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class GA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return I5()?D5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zA(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return cw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return cw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function dw(n){return Gh(JSON.stringify({version:2,heartbeats:n})).length}function YA(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function WA(n){ml(new xi("platform-logger",e=>new iA(e),"PRIVATE")),ml(new xi("heartbeat",e=>new qA(e),"PRIVATE")),za(j0,lw,n),za(j0,lw,"esm2020"),za("fire-js","")}WA("");function HN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QA=HN,GN=new Du("auth","Firebase",HN());const Wh=new pg("@firebase/auth");function KA(n,...e){Wh.logLevel<=yt.WARN&&Wh.warn(`Auth (${jl}): ${n}`,...e)}function Ch(n,...e){Wh.logLevel<=yt.ERROR&&Wh.error(`Auth (${jl}): ${n}`,...e)}function xa(n,...e){throw bg(n,...e)}function Fa(n,...e){return bg(n,...e)}function YN(n,e,t){const i={...QA(),[e]:t};return new Du("auth","Firebase",i).create(e,{appName:n.name})}function yr(n){return YN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function bg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return GN.create(n,...e)}function tt(n,e,...t){if(!n)throw bg(e,...t)}function pr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ch(e),new Error(e)}function _r(n,e){n||pr(e)}function T0(){return typeof self<"u"&&self.location?.href||""}function XA(){return hw()==="http:"||hw()==="https:"}function hw(){return typeof self<"u"&&self.location?.protocol||null}function JA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XA()||A5()||"connection"in navigator)?navigator.onLine:!0}function ZA(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ou{constructor(e,t){this.shortDelay=e,this.longDelay=t,_r(t>e,"Short delay should be less than long delay!"),this.isMobile=S5()||k5()}get(){return JA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function yg(n,e){_r(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class WN{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;pr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;pr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;pr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ek={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const tk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sk=new Ou(3e4,6e4);function Ti(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ai(n,e,t,i,o={}){return QN(n,o,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Mu({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const x={method:e,headers:g,...u};return T5()||(x.referrerPolicy="no-referrer"),n.emulatorConfig&&Ei(n.emulatorConfig.host)&&(x.credentials="include"),WN.fetch()(await KN(n,n.config.apiHost,t,p),x)})}async function QN(n,e,t){n._canInitEmulator=!1;const i={...ek,...e};try{const o=new ak(n),u=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw mh(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,x]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw mh(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw mh(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw mh(n,"user-disabled",d);const b=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(x)throw YN(n,b,x);xa(n,b)}}catch(o){if(o instanceof Ka)throw o;xa(n,"network-request-failed",{message:String(o)})}}async function Pu(n,e,t,i,o={}){const u=await Ai(n,e,t,i,o);return"mfaPendingCredential"in u&&xa(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function KN(n,e,t,i){const o=`${e}${t}?${i}`,u=n,d=u.config.emulator?yg(n.config,o):`${n.config.apiScheme}://${o}`;return tk.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function nk(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ak{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Fa(this.auth,"network-request-failed")),sk.get())})}}function mh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=Fa(n,e,i);return o.customData._tokenResponse=t,o}function fw(n){return n!==void 0&&n.enterprise!==void 0}class rk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return nk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function ik(n,e){return Ai(n,"GET","/v2/recaptchaConfig",Ti(n,e))}async function lk(n,e){return Ai(n,"POST","/v1/accounts:delete",e)}async function Qh(n,e){return Ai(n,"POST","/v1/accounts:lookup",e)}function du(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ok(n,e=!1){const t=ss(n),i=await t.getIdToken(e),o=vg(i);tt(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const u=typeof o.firebase=="object"?o.firebase:void 0,d=u?.sign_in_provider;return{claims:o,token:i,authTime:du(n0(o.auth_time)),issuedAtTime:du(n0(o.iat)),expirationTime:du(n0(o.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function n0(n){return Number(n)*1e3}function vg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Ch("JWT malformed, contained fewer than 3 sections"),null;try{const o=MN(t);return o?JSON.parse(o):(Ch("Failed to decode base64 JWT payload"),null)}catch(o){return Ch("Caught error parsing JWT payload as JSON",o?.toString()),null}}function mw(n){const e=vg(n);return tt(e,"internal-error"),tt(typeof e.exp<"u","internal-error"),tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function vu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Ka&&ck(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function ck({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class uk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class A0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=du(this.lastLoginAt),this.creationTime=du(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Kh(n){const e=n.auth,t=await n.getIdToken(),i=await vu(n,Qh(e,{idToken:t}));tt(i?.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const u=o.providerUserInfo?.length?XN(o.providerUserInfo):[],d=hk(n.providerData,u),p=n.isAnonymous,g=!(n.email&&o.passwordHash)&&!d?.length,x=p?g:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new A0(o.createdAt,o.lastLoginAt),isAnonymous:x};Object.assign(n,b)}async function dk(n){const e=ss(n);await Kh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hk(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function XN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function fk(n,e){const t=await QN(n,{},async()=>{const i=Mu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:u}=n.config,d=await KN(n,o,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&Ei(n.emulatorConfig.host)&&(g.credentials="include"),WN.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function mk(n,e){return Ai(n,"POST","/v2/accounts:revokeToken",Ti(n,e))}class No{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt(typeof e.idToken<"u","internal-error"),tt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):mw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){tt(e.length!==0,"internal-error");const t=mw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:u}=await fk(e,t);this.updateTokensAndExpiration(i,o,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:u}=t,d=new No;return i&&(tt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),o&&(tt(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),u&&(tt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new No,this.toJSON())}_performRefresh(){return pr("not implemented")}}function ai(n,e){tt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ma{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new uk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new A0(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await vu(this,this.stsTokenManager.getToken(this.auth,e));return tt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return ok(this,e)}reload(){return dk(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ma({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Kh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(On(this.auth.app))return Promise.reject(yr(this.auth));const e=await this.getIdToken();return await vu(this,lk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,x=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:w,emailVerified:S,isAnonymous:R,providerData:B,stsTokenManager:V}=t;tt(w&&V,e,"internal-error");const F=No.fromJSON(this.name,V);tt(typeof w=="string",e,"internal-error"),ai(i,e.name),ai(o,e.name),tt(typeof S=="boolean",e,"internal-error"),tt(typeof R=="boolean",e,"internal-error"),ai(u,e.name),ai(d,e.name),ai(p,e.name),ai(g,e.name),ai(x,e.name),ai(b,e.name);const H=new ma({uid:w,auth:e,email:o,emailVerified:S,displayName:i,isAnonymous:R,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:F,createdAt:x,lastLoginAt:b});return B&&Array.isArray(B)&&(H.providerData=B.map(W=>({...W}))),g&&(H._redirectEventId=g),H}static async _fromIdTokenResponse(e,t,i=!1){const o=new No;o.updateFromServerResponse(t);const u=new ma({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await Kh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];tt(o.localId!==void 0,"internal-error");const u=o.providerUserInfo!==void 0?XN(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!u?.length,p=new No;p.updateFromIdToken(i);const g=new ma({uid:o.localId,auth:e,stsTokenManager:p,isAnonymous:d}),x={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new A0(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!u?.length};return Object.assign(g,x),g}}const pw=new Map;function gr(n){_r(n instanceof Function,"Expected a class definition");let e=pw.get(n);return e?(_r(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,pw.set(n,e),e)}class JN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}JN.type="NONE";const gw=JN;function Rh(n,e,t){return`firebase:${n}:${e}:${t}`}class _o{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:u}=this.auth;this.fullUserKey=Rh(this.userKey,o.apiKey,u),this.fullPersistenceKey=Rh("persistence",o.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Qh(this.auth,{idToken:e}).catch(()=>{});return t?ma._fromGetAccountInfoResponse(this.auth,t,e):null}return ma._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new _o(gr(gw),e,i);const o=(await Promise.all(t.map(async x=>{if(await x._isAvailable())return x}))).filter(x=>x);let u=o[0]||gr(gw);const d=Rh(i,e.config.apiKey,e.name);let p=null;for(const x of t)try{const b=await x._get(d);if(b){let w;if(typeof b=="string"){const S=await Qh(e,{idToken:b}).catch(()=>{});if(!S)break;w=await ma._fromGetAccountInfoResponse(e,S,b)}else w=ma._fromJSON(e,b);x!==u&&(p=w),u=x;break}}catch{}const g=o.filter(x=>x._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new _o(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async x=>{if(x!==u)try{await x._remove(d)}catch{}})),new _o(u,e,i))}}function xw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(s_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ZN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(a_(e))return"Blackberry";if(r_(e))return"Webos";if(e_(e))return"Safari";if((e.includes("chrome/")||t_(e))&&!e.includes("edge/"))return"Chrome";if(n_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function ZN(n=Xs()){return/firefox\//i.test(n)}function e_(n=Xs()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function t_(n=Xs()){return/crios\//i.test(n)}function s_(n=Xs()){return/iemobile/i.test(n)}function n_(n=Xs()){return/android/i.test(n)}function a_(n=Xs()){return/blackberry/i.test(n)}function r_(n=Xs()){return/webos/i.test(n)}function wg(n=Xs()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function pk(n=Xs()){return wg(n)&&!!window.navigator?.standalone}function gk(){return C5()&&document.documentMode===10}function i_(n=Xs()){return wg(n)||n_(n)||r_(n)||a_(n)||/windows phone/i.test(n)||s_(n)}function l_(n,e=[]){let t;switch(n){case"Browser":t=xw(Xs());break;case"Worker":t=`${xw(Xs())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${jl}/${i}`}class xk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function bk(n,e={}){return Ai(n,"GET","/v2/passwordPolicy",Ti(n,e))}const yk=6;class vk{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??yk,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class wk{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bw(this),this.idTokenSubscription=new bw(this),this.beforeStateQueue=new xk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=GN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=gr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await _o.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Qh(this,{idToken:e}),i=await ma._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(On(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Kh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ZA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(On(this.app))return Promise.reject(yr(this));const t=e?ss(e):null;return t&&tt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return On(this.app)?Promise.reject(yr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return On(this.app)?Promise.reject(yr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(gr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bk(this),t=new vk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Du("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await mk(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&gr(e)||this._popupRedirectResolver;tt(t,this,"argument-error"),this.redirectPersistenceManager=await _o.create(this,[gr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,o);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=l_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(On(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&KA(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Sl(n){return ss(n)}class bw{constructor(e){this.auth=e,this.observer=null,this.addObserver=L5(t=>this.observer=t)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Nf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Nk(n){Nf=n}function o_(n){return Nf.loadJS(n)}function _k(){return Nf.recaptchaEnterpriseScript}function jk(){return Nf.gapiScript}function Sk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Ek{constructor(){this.enterprise=new Tk}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Tk{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Ak="recaptcha-enterprise",c_="NO_RECAPTCHA";class kk{constructor(e){this.type=Ak,this.auth=Sl(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{ik(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const x=new rk(g);return u.tenantId==null?u._agentRecaptchaConfig=x:u._tenantRecaptchaConfigs[u.tenantId]=x,d(x.siteKey)}}).catch(g=>{p(g)})})}function o(u,d,p){const g=window.grecaptcha;fw(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(x=>{d(x)}).catch(()=>{d(c_)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Ek().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&fw(window.grecaptcha))o(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=_k();g.length!==0&&(g+=p),o_(g).then(()=>{o(p,u,d)}).catch(x=>{d(x)})}}).catch(p=>{d(p)})})}}async function yw(n,e,t,i=!1,o=!1){const u=new kk(n);let d;if(o)d=c_;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,x=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:x,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function k0(n,e,t,i,o){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await yw(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await yw(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function Ck(n,e){const t=wf(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),u=t.getOptions();if(fl(u,e??{}))return o;xa(o,"already-initialized")}return t.initialize({options:e})}function Rk(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(gr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function Ik(n,e,t){const i=Sl(n);tt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,u=u_(e),{host:d,port:p}=Dk(e),g=p===null?"":`:${p}`,x={url:`${u}//${d}${g}/`},b=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){tt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),tt(fl(x,i.config.emulator)&&fl(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=x,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,Ei(d)?(fg(`${u}//${d}${g}`),mg("Auth",!0)):Mk()}function u_(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Dk(n){const e=u_(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const u=o[1];return{host:u,port:vw(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:vw(d)}}}function vw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Mk(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Ng{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return pr("not implemented")}_getIdTokenResponse(e){return pr("not implemented")}_linkToIdToken(e,t){return pr("not implemented")}_getReauthenticationResolver(e){return pr("not implemented")}}async function Ok(n,e){return Ai(n,"POST","/v1/accounts:signUp",e)}async function Pk(n,e){return Pu(n,"POST","/v1/accounts:signInWithPassword",Ti(n,e))}async function Vk(n,e){return Pu(n,"POST","/v1/accounts:signInWithEmailLink",Ti(n,e))}async function Lk(n,e){return Pu(n,"POST","/v1/accounts:signInWithEmailLink",Ti(n,e))}class wu extends Ng{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new wu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new wu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return k0(e,t,"signInWithPassword",Pk);case"emailLink":return Vk(e,{email:this._email,oobCode:this._password});default:xa(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return k0(e,i,"signUpPassword",Ok);case"emailLink":return Lk(e,{idToken:t,email:this._email,oobCode:this._password});default:xa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function jo(n,e){return Pu(n,"POST","/v1/accounts:signInWithIdp",Ti(n,e))}const Uk="http://localhost";class pl extends Ng{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):xa("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...u}=t;if(!i||!o)return null;const d=new pl(i,o);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return jo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,jo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,jo(e,t)}buildRequest(){const e={requestUri:Uk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Mu(t)}return e}}function Bk(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function zk(n){const e=nu(au(n)).link,t=e?nu(au(e)).deep_link_id:null,i=nu(au(n)).deep_link_id;return(i?nu(au(i)).link:null)||i||t||e||n}class _g{constructor(e){const t=nu(au(e)),i=t.apiKey??null,o=t.oobCode??null,u=Bk(t.mode??null);tt(i&&o&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=zk(e);try{return new _g(t)}catch{return null}}}class qo{constructor(){this.providerId=qo.PROVIDER_ID}static credential(e,t){return wu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=_g.parseLink(t);return tt(i,"argument-error"),wu._fromEmailAndCode(e,i.code,i.tenantId)}}qo.PROVIDER_ID="password";qo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";qo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class d_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Vu extends d_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ii extends Vu{constructor(){super("facebook.com")}static credential(e){return pl._fromParams({providerId:ii.PROVIDER_ID,signInMethod:ii.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ii.credentialFromTaggedObject(e)}static credentialFromError(e){return ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ii.credential(e.oauthAccessToken)}catch{return null}}}ii.FACEBOOK_SIGN_IN_METHOD="facebook.com";ii.PROVIDER_ID="facebook.com";class li extends Vu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pl._fromParams({providerId:li.PROVIDER_ID,signInMethod:li.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return li.credentialFromTaggedObject(e)}static credentialFromError(e){return li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return li.credential(t,i)}catch{return null}}}li.GOOGLE_SIGN_IN_METHOD="google.com";li.PROVIDER_ID="google.com";class oi extends Vu{constructor(){super("github.com")}static credential(e){return pl._fromParams({providerId:oi.PROVIDER_ID,signInMethod:oi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oi.credentialFromTaggedObject(e)}static credentialFromError(e){return oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oi.credential(e.oauthAccessToken)}catch{return null}}}oi.GITHUB_SIGN_IN_METHOD="github.com";oi.PROVIDER_ID="github.com";class ci extends Vu{constructor(){super("twitter.com")}static credential(e,t){return pl._fromParams({providerId:ci.PROVIDER_ID,signInMethod:ci.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ci.credentialFromTaggedObject(e)}static credentialFromError(e){return ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return ci.credential(t,i)}catch{return null}}}ci.TWITTER_SIGN_IN_METHOD="twitter.com";ci.PROVIDER_ID="twitter.com";async function Fk(n,e){return Pu(n,"POST","/v1/accounts:signUp",Ti(n,e))}class gl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const u=await ma._fromIdTokenResponse(e,i,o),d=ww(i);return new gl({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=ww(i);return new gl({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function ww(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Xh extends Ka{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,Xh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new Xh(e,t,i,o)}}function h_(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Xh._fromErrorAndOperation(n,u,e,i):u})}async function $k(n,e,t=!1){const i=await vu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return gl._forOperation(n,"link",i)}async function qk(n,e,t=!1){const{auth:i}=n;if(On(i.app))return Promise.reject(yr(i));const o="reauthenticate";try{const u=await vu(n,h_(i,o,e,n),t);tt(u.idToken,i,"internal-error");const d=vg(u.idToken);tt(d,i,"internal-error");const{sub:p}=d;return tt(n.uid===p,i,"user-mismatch"),gl._forOperation(n,o,u)}catch(u){throw u?.code==="auth/user-not-found"&&xa(i,"user-mismatch"),u}}async function f_(n,e,t=!1){if(On(n.app))return Promise.reject(yr(n));const i="signIn",o=await h_(n,i,e),u=await gl._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(u.user),u}async function Hk(n,e){return f_(Sl(n),e)}async function m_(n){const e=Sl(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Gk(n,e,t){if(On(n.app))return Promise.reject(yr(n));const i=Sl(n),d=await k0(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Fk).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&m_(n),g}),p=await gl._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function p_(n,e,t){return On(n.app)?Promise.reject(yr(n)):Hk(ss(n),qo.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&m_(n),i})}function Yk(n,e,t,i){return ss(n).onIdTokenChanged(e,t,i)}function Wk(n,e,t){return ss(n).beforeAuthStateChanged(e,t)}function Qk(n,e,t,i){return ss(n).onAuthStateChanged(e,t,i)}function g_(n){return ss(n).signOut()}const Jh="__sak";class x_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jh,"1"),this.storage.removeItem(Jh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Kk=1e3,Xk=10;class b_ extends x_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=i_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);gk()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,Xk):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},Kk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}b_.type="LOCAL";const Jk=b_;class y_ extends x_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}y_.type="SESSION";const v_=y_;function Zk(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class _f{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new _f(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:u}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const p=Array.from(d).map(async x=>x(t.origin,u)),g=await Zk(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_f.receivers=[];function jg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class eC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const x=jg("",20);o.port1.start();const b=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:o,onMessage(w){const S=w;if(S.data.eventId===x)switch(S.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(S.data.response);break;default:clearTimeout(b),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:x,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function $a(){return window}function tC(n){$a().location.href=n}function w_(){return typeof $a().WorkerGlobalScope<"u"&&typeof $a().importScripts=="function"}async function sC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function nC(){return navigator?.serviceWorker?.controller||null}function aC(){return w_()?self:null}const N_="firebaseLocalStorageDb",rC=1,Zh="firebaseLocalStorage",__="fbase_key";class Lu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function jf(n,e){return n.transaction([Zh],e?"readwrite":"readonly").objectStore(Zh)}function iC(){const n=indexedDB.deleteDatabase(N_);return new Lu(n).toPromise()}function C0(){const n=indexedDB.open(N_,rC);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Zh,{keyPath:__})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Zh)?e(i):(i.close(),await iC(),e(await C0()))})})}async function Nw(n,e,t){const i=jf(n,!0).put({[__]:e,value:t});return new Lu(i).toPromise()}async function lC(n,e){const t=jf(n,!1).get(e),i=await new Lu(t).toPromise();return i===void 0?null:i.value}function _w(n,e){const t=jf(n,!0).delete(e);return new Lu(t).toPromise()}const oC=800,cC=3;class j_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await C0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>cC)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return w_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_f._getInstance(aC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await sC(),!this.activeServiceWorker)return;this.sender=new eC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||nC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await C0();return await Nw(e,Jh,"1"),await _w(e,Jh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Nw(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>lC(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_w(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const u=jf(o,!1).getAll();return new Lu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:u}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(u)&&(this.notifyListeners(o,u),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),oC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}j_.type="LOCAL";const uC=j_;new Ou(3e4,6e4);function dC(n,e){return e?gr(e):(tt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Sg extends Ng{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return jo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return jo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return jo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function hC(n){return f_(n.auth,new Sg(n),n.bypassAuthState)}function fC(n){const{auth:e,user:t}=n;return tt(t,e,"internal-error"),qk(t,new Sg(n),n.bypassAuthState)}async function mC(n){const{auth:e,user:t}=n;return tt(t,e,"internal-error"),$k(t,new Sg(n),n.bypassAuthState)}class S_{constructor(e,t,i,o,u=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(x){this.reject(x)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return hC;case"linkViaPopup":case"linkViaRedirect":return mC;case"reauthViaPopup":case"reauthViaRedirect":return fC;default:xa(this.auth,"internal-error")}}resolve(e){_r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const pC=new Ou(2e3,1e4);class vo extends S_{constructor(e,t,i,o,u){super(e,t,o,u),this.provider=i,this.authWindow=null,this.pollId=null,vo.currentPopupAction&&vo.currentPopupAction.cancel(),vo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){_r(this.filter.length===1,"Popup operations only handle one event");const e=jg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Fa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Fa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,pC.get())};e()}}vo.currentPopupAction=null;const gC="pendingRedirect",Ih=new Map;class xC extends S_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Ih.get(this.auth._key());if(!e){try{const i=await bC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Ih.set(this.auth._key(),e)}return this.bypassAuthState||Ih.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function bC(n,e){const t=wC(e),i=vC(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function yC(n,e){Ih.set(n._key(),e)}function vC(n){return gr(n._redirectPersistence)}function wC(n){return Rh(gC,n.config.apiKey,n.name)}async function NC(n,e,t=!1){if(On(n.app))return Promise.reject(yr(n));const i=Sl(n),o=dC(i,e),d=await new xC(i,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const _C=600*1e3;class jC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!SC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!E_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Fa(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_C&&this.cachedEventUids.clear(),this.cachedEventUids.has(jw(e))}saveEventToCache(e){this.cachedEventUids.add(jw(e)),this.lastProcessedEventTime=Date.now()}}function jw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function E_({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function SC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return E_(n);default:return!1}}async function EC(n,e={}){return Ai(n,"GET","/v1/projects",e)}const TC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,AC=/^https?/;async function kC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await EC(n);for(const t of e)try{if(CC(t))return}catch{}xa(n,"unauthorized-domain")}function CC(n){const e=T0(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!AC.test(t))return!1;if(TC.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}const RC=new Ou(3e4,6e4);function Sw(){const n=$a().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function IC(n){return new Promise((e,t)=>{function i(){Sw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Sw(),t(Fa(n,"network-request-failed"))},timeout:RC.get()})}if($a().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if($a().gapi?.load)i();else{const o=Sk("iframefcb");return $a()[o]=()=>{gapi.load?i():t(Fa(n,"network-request-failed"))},o_(`${jk()}?onload=${o}`).catch(u=>t(u))}}).catch(e=>{throw Dh=null,e})}let Dh=null;function DC(n){return Dh=Dh||IC(n),Dh}const MC=new Ou(5e3,15e3),OC="__/auth/iframe",PC="emulator/auth/iframe",VC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},LC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function UC(n){const e=n.config;tt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?yg(e,PC):`https://${n.config.authDomain}/${OC}`,i={apiKey:e.apiKey,appName:n.name,v:jl},o=LC.get(n.config.apiHost);o&&(i.eid=o);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Mu(i).slice(1)}`}async function BC(n){const e=await DC(n),t=$a().gapi;return tt(t,n,"internal-error"),e.open({where:document.body,url:UC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:VC,dontclear:!0},i=>new Promise(async(o,u)=>{await i.restyle({setHideOnLeave:!1});const d=Fa(n,"network-request-failed"),p=$a().setTimeout(()=>{u(d)},MC.get());function g(){$a().clearTimeout(p),o(i)}i.ping(g).then(g,()=>{u(d)})}))}const zC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},FC=500,$C=600,qC="_blank",HC="http://localhost";class Ew{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function GC(n,e,t,i=FC,o=$C){const u=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...zC,width:i.toString(),height:o.toString(),top:u,left:d},x=Xs().toLowerCase();t&&(p=t_(x)?qC:t),ZN(x)&&(e=e||HC,g.scrollbars="yes");const b=Object.entries(g).reduce((S,[R,B])=>`${S}${R}=${B},`,"");if(pk(x)&&p!=="_self")return YC(e||"",p),new Ew(null);const w=window.open(e||"",p,b);tt(w,n,"popup-blocked");try{w.focus()}catch{}return new Ew(w)}function YC(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const WC="__/auth/handler",QC="emulator/auth/handler",KC=encodeURIComponent("fac");async function Tw(n,e,t,i,o,u){tt(n.config.authDomain,n,"auth-domain-config-required"),tt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:jl,eventId:o};if(e instanceof d_){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",V5(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,w]of Object.entries({}))d[b]=w}if(e instanceof Vu){const b=e.getScopes().filter(w=>w!=="");b.length>0&&(d.scopes=b.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const g=await n._getAppCheckToken(),x=g?`#${KC}=${encodeURIComponent(g)}`:"";return`${XC(n)}?${Mu(p).slice(1)}${x}`}function XC({config:n}){return n.emulator?yg(n,QC):`https://${n.authDomain}/${WC}`}const a0="webStorageSupport";class JC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=v_,this._completeRedirectFn=NC,this._overrideRedirectResult=yC}async _openPopup(e,t,i,o){_r(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await Tw(e,t,i,T0(),o);return GC(e,u,jg())}async _openRedirect(e,t,i,o){await this._originValidation(e);const u=await Tw(e,t,i,T0(),o);return tC(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:u}=this.eventManagers[t];return o?Promise.resolve(o):(_r(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await BC(e),i=new jC(e);return t.register("authEvent",o=>(tt(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(a0,{type:a0},o=>{const u=o?.[0]?.[a0];u!==void 0&&t(!!u),xa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=kC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return i_()||e_()||wg()}}const ZC=JC;var Aw="@firebase/auth",kw="1.12.0";class e4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function t4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function s4(n){ml(new xi("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;tt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:l_(n)},x=new wk(i,o,u,g);return Rk(x,t),x},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ml(new xi("auth-internal",e=>{const t=Sl(e.getProvider("auth").getImmediate());return(i=>new e4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),za(Aw,kw,t4(n)),za(Aw,kw,"esm2020")}const n4=300,a4=LN("authIdTokenMaxAge")||n4;let Cw=null;const r4=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>a4)return;const o=t?.token;Cw!==o&&(Cw=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function i4(n=xg()){const e=wf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Ck(n,{popupRedirectResolver:ZC,persistence:[uC,Jk,v_]}),i=LN("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=r4(u.toString());Wk(t,d,()=>d(t.currentUser)),Yk(t,p=>d(p))}}const o=ON("auth");return o&&Ik(t,`http://${o}`),t}function l4(){return document.getElementsByTagName("head")?.[0]??document}Nk({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const u=Fa("internal-error");u.customData=o,t(u)},i.type="text/javascript",i.charset="UTF-8",l4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});s4("Browser");var o4="firebase",c4="12.8.0";za(o4,c4,"app");var Rw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var mi,T_;(function(){var n;function e(A,T){function E(){}E.prototype=T.prototype,A.F=T.prototype,A.prototype=new E,A.prototype.constructor=A,A.D=function(I,_,D){for(var k=Array(arguments.length-2),L=2;L<arguments.length;L++)k[L-2]=arguments[L];return T.prototype[_].apply(I,k)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(A,T,E){E||(E=0);const I=Array(16);if(typeof T=="string")for(var _=0;_<16;++_)I[_]=T.charCodeAt(E++)|T.charCodeAt(E++)<<8|T.charCodeAt(E++)<<16|T.charCodeAt(E++)<<24;else for(_=0;_<16;++_)I[_]=T[E++]|T[E++]<<8|T[E++]<<16|T[E++]<<24;T=A.g[0],E=A.g[1],_=A.g[2];let D=A.g[3],k;k=T+(D^E&(_^D))+I[0]+3614090360&4294967295,T=E+(k<<7&4294967295|k>>>25),k=D+(_^T&(E^_))+I[1]+3905402710&4294967295,D=T+(k<<12&4294967295|k>>>20),k=_+(E^D&(T^E))+I[2]+606105819&4294967295,_=D+(k<<17&4294967295|k>>>15),k=E+(T^_&(D^T))+I[3]+3250441966&4294967295,E=_+(k<<22&4294967295|k>>>10),k=T+(D^E&(_^D))+I[4]+4118548399&4294967295,T=E+(k<<7&4294967295|k>>>25),k=D+(_^T&(E^_))+I[5]+1200080426&4294967295,D=T+(k<<12&4294967295|k>>>20),k=_+(E^D&(T^E))+I[6]+2821735955&4294967295,_=D+(k<<17&4294967295|k>>>15),k=E+(T^_&(D^T))+I[7]+4249261313&4294967295,E=_+(k<<22&4294967295|k>>>10),k=T+(D^E&(_^D))+I[8]+1770035416&4294967295,T=E+(k<<7&4294967295|k>>>25),k=D+(_^T&(E^_))+I[9]+2336552879&4294967295,D=T+(k<<12&4294967295|k>>>20),k=_+(E^D&(T^E))+I[10]+4294925233&4294967295,_=D+(k<<17&4294967295|k>>>15),k=E+(T^_&(D^T))+I[11]+2304563134&4294967295,E=_+(k<<22&4294967295|k>>>10),k=T+(D^E&(_^D))+I[12]+1804603682&4294967295,T=E+(k<<7&4294967295|k>>>25),k=D+(_^T&(E^_))+I[13]+4254626195&4294967295,D=T+(k<<12&4294967295|k>>>20),k=_+(E^D&(T^E))+I[14]+2792965006&4294967295,_=D+(k<<17&4294967295|k>>>15),k=E+(T^_&(D^T))+I[15]+1236535329&4294967295,E=_+(k<<22&4294967295|k>>>10),k=T+(_^D&(E^_))+I[1]+4129170786&4294967295,T=E+(k<<5&4294967295|k>>>27),k=D+(E^_&(T^E))+I[6]+3225465664&4294967295,D=T+(k<<9&4294967295|k>>>23),k=_+(T^E&(D^T))+I[11]+643717713&4294967295,_=D+(k<<14&4294967295|k>>>18),k=E+(D^T&(_^D))+I[0]+3921069994&4294967295,E=_+(k<<20&4294967295|k>>>12),k=T+(_^D&(E^_))+I[5]+3593408605&4294967295,T=E+(k<<5&4294967295|k>>>27),k=D+(E^_&(T^E))+I[10]+38016083&4294967295,D=T+(k<<9&4294967295|k>>>23),k=_+(T^E&(D^T))+I[15]+3634488961&4294967295,_=D+(k<<14&4294967295|k>>>18),k=E+(D^T&(_^D))+I[4]+3889429448&4294967295,E=_+(k<<20&4294967295|k>>>12),k=T+(_^D&(E^_))+I[9]+568446438&4294967295,T=E+(k<<5&4294967295|k>>>27),k=D+(E^_&(T^E))+I[14]+3275163606&4294967295,D=T+(k<<9&4294967295|k>>>23),k=_+(T^E&(D^T))+I[3]+4107603335&4294967295,_=D+(k<<14&4294967295|k>>>18),k=E+(D^T&(_^D))+I[8]+1163531501&4294967295,E=_+(k<<20&4294967295|k>>>12),k=T+(_^D&(E^_))+I[13]+2850285829&4294967295,T=E+(k<<5&4294967295|k>>>27),k=D+(E^_&(T^E))+I[2]+4243563512&4294967295,D=T+(k<<9&4294967295|k>>>23),k=_+(T^E&(D^T))+I[7]+1735328473&4294967295,_=D+(k<<14&4294967295|k>>>18),k=E+(D^T&(_^D))+I[12]+2368359562&4294967295,E=_+(k<<20&4294967295|k>>>12),k=T+(E^_^D)+I[5]+4294588738&4294967295,T=E+(k<<4&4294967295|k>>>28),k=D+(T^E^_)+I[8]+2272392833&4294967295,D=T+(k<<11&4294967295|k>>>21),k=_+(D^T^E)+I[11]+1839030562&4294967295,_=D+(k<<16&4294967295|k>>>16),k=E+(_^D^T)+I[14]+4259657740&4294967295,E=_+(k<<23&4294967295|k>>>9),k=T+(E^_^D)+I[1]+2763975236&4294967295,T=E+(k<<4&4294967295|k>>>28),k=D+(T^E^_)+I[4]+1272893353&4294967295,D=T+(k<<11&4294967295|k>>>21),k=_+(D^T^E)+I[7]+4139469664&4294967295,_=D+(k<<16&4294967295|k>>>16),k=E+(_^D^T)+I[10]+3200236656&4294967295,E=_+(k<<23&4294967295|k>>>9),k=T+(E^_^D)+I[13]+681279174&4294967295,T=E+(k<<4&4294967295|k>>>28),k=D+(T^E^_)+I[0]+3936430074&4294967295,D=T+(k<<11&4294967295|k>>>21),k=_+(D^T^E)+I[3]+3572445317&4294967295,_=D+(k<<16&4294967295|k>>>16),k=E+(_^D^T)+I[6]+76029189&4294967295,E=_+(k<<23&4294967295|k>>>9),k=T+(E^_^D)+I[9]+3654602809&4294967295,T=E+(k<<4&4294967295|k>>>28),k=D+(T^E^_)+I[12]+3873151461&4294967295,D=T+(k<<11&4294967295|k>>>21),k=_+(D^T^E)+I[15]+530742520&4294967295,_=D+(k<<16&4294967295|k>>>16),k=E+(_^D^T)+I[2]+3299628645&4294967295,E=_+(k<<23&4294967295|k>>>9),k=T+(_^(E|~D))+I[0]+4096336452&4294967295,T=E+(k<<6&4294967295|k>>>26),k=D+(E^(T|~_))+I[7]+1126891415&4294967295,D=T+(k<<10&4294967295|k>>>22),k=_+(T^(D|~E))+I[14]+2878612391&4294967295,_=D+(k<<15&4294967295|k>>>17),k=E+(D^(_|~T))+I[5]+4237533241&4294967295,E=_+(k<<21&4294967295|k>>>11),k=T+(_^(E|~D))+I[12]+1700485571&4294967295,T=E+(k<<6&4294967295|k>>>26),k=D+(E^(T|~_))+I[3]+2399980690&4294967295,D=T+(k<<10&4294967295|k>>>22),k=_+(T^(D|~E))+I[10]+4293915773&4294967295,_=D+(k<<15&4294967295|k>>>17),k=E+(D^(_|~T))+I[1]+2240044497&4294967295,E=_+(k<<21&4294967295|k>>>11),k=T+(_^(E|~D))+I[8]+1873313359&4294967295,T=E+(k<<6&4294967295|k>>>26),k=D+(E^(T|~_))+I[15]+4264355552&4294967295,D=T+(k<<10&4294967295|k>>>22),k=_+(T^(D|~E))+I[6]+2734768916&4294967295,_=D+(k<<15&4294967295|k>>>17),k=E+(D^(_|~T))+I[13]+1309151649&4294967295,E=_+(k<<21&4294967295|k>>>11),k=T+(_^(E|~D))+I[4]+4149444226&4294967295,T=E+(k<<6&4294967295|k>>>26),k=D+(E^(T|~_))+I[11]+3174756917&4294967295,D=T+(k<<10&4294967295|k>>>22),k=_+(T^(D|~E))+I[2]+718787259&4294967295,_=D+(k<<15&4294967295|k>>>17),k=E+(D^(_|~T))+I[9]+3951481745&4294967295,A.g[0]=A.g[0]+T&4294967295,A.g[1]=A.g[1]+(_+(k<<21&4294967295|k>>>11))&4294967295,A.g[2]=A.g[2]+_&4294967295,A.g[3]=A.g[3]+D&4294967295}i.prototype.v=function(A,T){T===void 0&&(T=A.length);const E=T-this.blockSize,I=this.C;let _=this.h,D=0;for(;D<T;){if(_==0)for(;D<=E;)o(this,A,D),D+=this.blockSize;if(typeof A=="string"){for(;D<T;)if(I[_++]=A.charCodeAt(D++),_==this.blockSize){o(this,I),_=0;break}}else for(;D<T;)if(I[_++]=A[D++],_==this.blockSize){o(this,I),_=0;break}}this.h=_,this.o+=T},i.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var T=1;T<A.length-8;++T)A[T]=0;T=this.o*8;for(var E=A.length-8;E<A.length;++E)A[E]=T&255,T/=256;for(this.v(A),A=Array(16),T=0,E=0;E<4;++E)for(let I=0;I<32;I+=8)A[T++]=this.g[E]>>>I&255;return A};function u(A,T){var E=p;return Object.prototype.hasOwnProperty.call(E,A)?E[A]:E[A]=T(A)}function d(A,T){this.h=T;const E=[];let I=!0;for(let _=A.length-1;_>=0;_--){const D=A[_]|0;I&&D==T||(E[_]=D,I=!1)}this.g=E}var p={};function g(A){return-128<=A&&A<128?u(A,function(T){return new d([T|0],T<0?-1:0)}):new d([A|0],A<0?-1:0)}function x(A){if(isNaN(A)||!isFinite(A))return w;if(A<0)return F(x(-A));const T=[];let E=1;for(let I=0;A>=E;I++)T[I]=A/E|0,E*=4294967296;return new d(T,0)}function b(A,T){if(A.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(A.charAt(0)=="-")return F(b(A.substring(1),T));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=x(Math.pow(T,8));let I=w;for(let D=0;D<A.length;D+=8){var _=Math.min(8,A.length-D);const k=parseInt(A.substring(D,D+_),T);_<8?(_=x(Math.pow(T,_)),I=I.j(_).add(x(k))):(I=I.j(E),I=I.add(x(k)))}return I}var w=g(0),S=g(1),R=g(16777216);n=d.prototype,n.m=function(){if(V(this))return-F(this).m();let A=0,T=1;for(let E=0;E<this.g.length;E++){const I=this.i(E);A+=(I>=0?I:4294967296+I)*T,T*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(B(this))return"0";if(V(this))return"-"+F(this).toString(A);const T=x(Math.pow(A,6));var E=this;let I="";for(;;){const _=ie(E,T).g;E=H(E,_.j(T));let D=((E.g.length>0?E.g[0]:E.h)>>>0).toString(A);if(E=_,B(E))return D+I;for(;D.length<6;)D="0"+D;I=D+I}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function B(A){if(A.h!=0)return!1;for(let T=0;T<A.g.length;T++)if(A.g[T]!=0)return!1;return!0}function V(A){return A.h==-1}n.l=function(A){return A=H(this,A),V(A)?-1:B(A)?0:1};function F(A){const T=A.g.length,E=[];for(let I=0;I<T;I++)E[I]=~A.g[I];return new d(E,~A.h).add(S)}n.abs=function(){return V(this)?F(this):this},n.add=function(A){const T=Math.max(this.g.length,A.g.length),E=[];let I=0;for(let _=0;_<=T;_++){let D=I+(this.i(_)&65535)+(A.i(_)&65535),k=(D>>>16)+(this.i(_)>>>16)+(A.i(_)>>>16);I=k>>>16,D&=65535,k&=65535,E[_]=k<<16|D}return new d(E,E[E.length-1]&-2147483648?-1:0)};function H(A,T){return A.add(F(T))}n.j=function(A){if(B(this)||B(A))return w;if(V(this))return V(A)?F(this).j(F(A)):F(F(this).j(A));if(V(A))return F(this.j(F(A)));if(this.l(R)<0&&A.l(R)<0)return x(this.m()*A.m());const T=this.g.length+A.g.length,E=[];for(var I=0;I<2*T;I++)E[I]=0;for(I=0;I<this.g.length;I++)for(let _=0;_<A.g.length;_++){const D=this.i(I)>>>16,k=this.i(I)&65535,L=A.i(_)>>>16,P=A.i(_)&65535;E[2*I+2*_]+=k*P,W(E,2*I+2*_),E[2*I+2*_+1]+=D*P,W(E,2*I+2*_+1),E[2*I+2*_+1]+=k*L,W(E,2*I+2*_+1),E[2*I+2*_+2]+=D*L,W(E,2*I+2*_+2)}for(A=0;A<T;A++)E[A]=E[2*A+1]<<16|E[2*A];for(A=T;A<2*T;A++)E[A]=0;return new d(E,0)};function W(A,T){for(;(A[T]&65535)!=A[T];)A[T+1]+=A[T]>>>16,A[T]&=65535,T++}function z(A,T){this.g=A,this.h=T}function ie(A,T){if(B(T))throw Error("division by zero");if(B(A))return new z(w,w);if(V(A))return T=ie(F(A),T),new z(F(T.g),F(T.h));if(V(T))return T=ie(A,F(T)),new z(F(T.g),T.h);if(A.g.length>30){if(V(A)||V(T))throw Error("slowDivide_ only works with positive integers.");for(var E=S,I=T;I.l(A)<=0;)E=ae(E),I=ae(I);var _=Y(E,1),D=Y(I,1);for(I=Y(I,2),E=Y(E,2);!B(I);){var k=D.add(I);k.l(A)<=0&&(_=_.add(E),D=k),I=Y(I,1),E=Y(E,1)}return T=H(A,_.j(T)),new z(_,T)}for(_=w;A.l(T)>=0;){for(E=Math.max(1,Math.floor(A.m()/T.m())),I=Math.ceil(Math.log(E)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),D=x(E),k=D.j(T);V(k)||k.l(A)>0;)E-=I,D=x(E),k=D.j(T);B(D)&&(D=S),_=_.add(D),A=H(A,k)}return new z(_,A)}n.B=function(A){return ie(this,A).h},n.and=function(A){const T=Math.max(this.g.length,A.g.length),E=[];for(let I=0;I<T;I++)E[I]=this.i(I)&A.i(I);return new d(E,this.h&A.h)},n.or=function(A){const T=Math.max(this.g.length,A.g.length),E=[];for(let I=0;I<T;I++)E[I]=this.i(I)|A.i(I);return new d(E,this.h|A.h)},n.xor=function(A){const T=Math.max(this.g.length,A.g.length),E=[];for(let I=0;I<T;I++)E[I]=this.i(I)^A.i(I);return new d(E,this.h^A.h)};function ae(A){const T=A.g.length+1,E=[];for(let I=0;I<T;I++)E[I]=A.i(I)<<1|A.i(I-1)>>>31;return new d(E,A.h)}function Y(A,T){const E=T>>5;T%=32;const I=A.g.length-E,_=[];for(let D=0;D<I;D++)_[D]=T>0?A.i(D+E)>>>T|A.i(D+E+1)<<32-T:A.i(D+E);return new d(_,A.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,T_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=x,d.fromString=b,mi=d}).apply(typeof Rw<"u"?Rw:typeof self<"u"?self:typeof window<"u"?window:{});var ph=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var A_,ru,k_,Mh,R0,C_,R_,I_;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ph=="object"&&ph];for(var y=0;y<h.length;++y){var N=h[y];if(N&&N.Math==Math)return N}throw Error("Cannot find global object")}var i=t(this);function o(h,y){if(y)e:{var N=i;h=h.split(".");for(var M=0;M<h.length-1;M++){var J=h[M];if(!(J in N))break e;N=N[J]}h=h[h.length-1],M=N[h],y=y(M),y!=M&&y!=null&&e(N,h,{configurable:!0,writable:!0,value:y})}}o("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(h){return h||function(y){var N=[],M;for(M in y)Object.prototype.hasOwnProperty.call(y,M)&&N.push([M,y[M]]);return N}});var u=u||{},d=this||self;function p(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function g(h,y,N){return h.call.apply(h.bind,arguments)}function x(h,y,N){return x=g,x.apply(null,arguments)}function b(h,y){var N=Array.prototype.slice.call(arguments,1);return function(){var M=N.slice();return M.push.apply(M,arguments),h.apply(this,M)}}function w(h,y){function N(){}N.prototype=y.prototype,h.Z=y.prototype,h.prototype=new N,h.prototype.constructor=h,h.Ob=function(M,J,re){for(var Ae=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)Ae[ct-2]=arguments[ct];return y.prototype[J].apply(M,Ae)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function R(h){const y=h.length;if(y>0){const N=Array(y);for(let M=0;M<y;M++)N[M]=h[M];return N}return[]}function B(h,y){for(let M=1;M<arguments.length;M++){const J=arguments[M];var N=typeof J;if(N=N!="object"?N:J?Array.isArray(J)?"array":N:"null",N=="array"||N=="object"&&typeof J.length=="number"){N=h.length||0;const re=J.length||0;h.length=N+re;for(let Ae=0;Ae<re;Ae++)h[N+Ae]=J[Ae]}else h.push(J)}}class V{constructor(y,N){this.i=y,this.j=N,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function F(h){d.setTimeout(()=>{throw h},0)}function H(){var h=A;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class W{constructor(){this.h=this.g=null}add(y,N){const M=z.get();M.set(y,N),this.h?this.h.next=M:this.g=M,this.h=M}}var z=new V(()=>new ie,h=>h.reset());class ie{constructor(){this.next=this.g=this.h=null}set(y,N){this.h=y,this.g=N,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,Y=!1,A=new W,T=()=>{const h=Promise.resolve(void 0);ae=()=>{h.then(E)}};function E(){for(var h;h=H();){try{h.h.call(h.g)}catch(N){F(N)}var y=z;y.j(h),y.h<100&&(y.h++,h.next=y.g,y.g=h)}Y=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}_.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const N=()=>{};d.addEventListener("test",N,y),d.removeEventListener("test",N,y)}catch{}return h})();function k(h){return/^[\s\xa0]*$/.test(h)}function L(h,y){_.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,y)}w(L,_),L.prototype.init=function(h,y){const N=this.type=h.type,M=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget,y||(N=="mouseover"?y=h.fromElement:N=="mouseout"&&(y=h.toElement)),this.relatedTarget=y,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&L.Z.h.call(this)},L.prototype.h=function(){L.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var P="closure_listenable_"+(Math.random()*1e6|0),O=0;function Q(h,y,N,M,J){this.listener=h,this.proxy=null,this.src=y,this.type=N,this.capture=!!M,this.ha=J,this.key=++O,this.da=this.fa=!1}function le(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ee(h,y,N){for(const M in h)y.call(N,h[M],M,h)}function xe(h,y){for(const N in h)y.call(void 0,h[N],N,h)}function U(h){const y={};for(const N in h)y[N]=h[N];return y}const ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(h,y){let N,M;for(let J=1;J<arguments.length;J++){M=arguments[J];for(N in M)h[N]=M[N];for(let re=0;re<ee.length;re++)N=ee[re],Object.prototype.hasOwnProperty.call(M,N)&&(h[N]=M[N])}}function fe(h){this.src=h,this.g={},this.h=0}fe.prototype.add=function(h,y,N,M,J){const re=h.toString();h=this.g[re],h||(h=this.g[re]=[],this.h++);const Ae=Re(h,y,M,J);return Ae>-1?(y=h[Ae],N||(y.fa=!1)):(y=new Q(y,this.src,re,!!M,J),y.fa=N,h.push(y)),y};function ge(h,y){const N=y.type;if(N in h.g){var M=h.g[N],J=Array.prototype.indexOf.call(M,y,void 0),re;(re=J>=0)&&Array.prototype.splice.call(M,J,1),re&&(le(y),h.g[N].length==0&&(delete h.g[N],h.h--))}}function Re(h,y,N,M){for(let J=0;J<h.length;++J){const re=h[J];if(!re.da&&re.listener==y&&re.capture==!!N&&re.ha==M)return J}return-1}var He="closure_lm_"+(Math.random()*1e6|0),At={};function ht(h,y,N,M,J){if(Array.isArray(y)){for(let re=0;re<y.length;re++)ht(h,y[re],N,M,J);return null}return N=ft(N),h&&h[P]?h.J(y,N,p(M)?!!M.capture:!1,J):rs(h,y,N,!1,M,J)}function rs(h,y,N,M,J,re){if(!y)throw Error("Invalid event type");const Ae=p(J)?!!J.capture:!!J;let ct=St(h);if(ct||(h[He]=ct=new fe(h)),N=ct.add(y,N,M,Ae,re),N.proxy)return N;if(M=ne(),N.proxy=M,M.src=h,M.listener=N,h.addEventListener)D||(J=Ae),J===void 0&&(J=!1),h.addEventListener(y.toString(),M,J);else if(h.attachEvent)h.attachEvent(Ke(y.toString()),M);else if(h.addListener&&h.removeListener)h.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return N}function ne(){function h(N){return y.call(h.src,h.listener,N)}const y=et;return h}function Se(h,y,N,M,J){if(Array.isArray(y))for(var re=0;re<y.length;re++)Se(h,y[re],N,M,J);else M=p(M)?!!M.capture:!!M,N=ft(N),h&&h[P]?(h=h.i,re=String(y).toString(),re in h.g&&(y=h.g[re],N=Re(y,N,M,J),N>-1&&(le(y[N]),Array.prototype.splice.call(y,N,1),y.length==0&&(delete h.g[re],h.h--)))):h&&(h=St(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Re(y,N,M,J)),(N=h>-1?y[h]:null)&&Ve(N))}function Ve(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[P])ge(y.i,h);else{var N=h.type,M=h.proxy;y.removeEventListener?y.removeEventListener(N,M,h.capture):y.detachEvent?y.detachEvent(Ke(N),M):y.addListener&&y.removeListener&&y.removeListener(M),(N=St(y))?(ge(N,h),N.h==0&&(N.src=null,y[He]=null)):le(h)}}}function Ke(h){return h in At?At[h]:At[h]="on"+h}function et(h,y){if(h.da)h=!0;else{y=new L(y,this);const N=h.listener,M=h.ha||h.src;h.fa&&Ve(h),h=N.call(M,y)}return h}function St(h){return h=h[He],h instanceof fe?h:null}var qs="__closure_events_fn_"+(Math.random()*1e9>>>0);function ft(h){return typeof h=="function"?h:(h[qs]||(h[qs]=function(y){return h.handleEvent(y)}),h[qs])}function mt(){I.call(this),this.i=new fe(this),this.M=this,this.G=null}w(mt,I),mt.prototype[P]=!0,mt.prototype.removeEventListener=function(h,y,N,M){Se(this,h,y,N,M)};function ke(h,y){var N,M=h.G;if(M)for(N=[];M;M=M.G)N.push(M);if(h=h.M,M=y.type||y,typeof y=="string")y=new _(y,h);else if(y instanceof _)y.target=y.target||h;else{var J=y;y=new _(M,h),ue(y,J)}J=!0;let re,Ae;if(N)for(Ae=N.length-1;Ae>=0;Ae--)re=y.g=N[Ae],J=Oe(re,M,!0,y)&&J;if(re=y.g=h,J=Oe(re,M,!0,y)&&J,J=Oe(re,M,!1,y)&&J,N)for(Ae=0;Ae<N.length;Ae++)re=y.g=N[Ae],J=Oe(re,M,!1,y)&&J}mt.prototype.N=function(){if(mt.Z.N.call(this),this.i){var h=this.i;for(const y in h.g){const N=h.g[y];for(let M=0;M<N.length;M++)le(N[M]);delete h.g[y],h.h--}}this.G=null},mt.prototype.J=function(h,y,N,M){return this.i.add(String(h),y,!1,N,M)},mt.prototype.K=function(h,y,N,M){return this.i.add(String(h),y,!0,N,M)};function Oe(h,y,N,M){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();let J=!0;for(let re=0;re<y.length;++re){const Ae=y[re];if(Ae&&!Ae.da&&Ae.capture==N){const ct=Ae.listener,hs=Ae.ha||Ae.src;Ae.fa&&ge(h.i,Ae),J=ct.call(hs,M)!==!1&&J}}return J&&!M.defaultPrevented}function me(h,y){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=x(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:d.setTimeout(h,y||0)}function Ye(h){h.g=me(()=>{h.g=null,h.i&&(h.i=!1,Ye(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Ue extends I{constructor(y,N){super(),this.m=y,this.l=N,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Ye(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function De(h){I.call(this),this.h=h,this.g={}}w(De,I);var qe=[];function Ge(h){Ee(h.g,function(y,N){this.g.hasOwnProperty(N)&&Ve(y)},h),h.g={}}De.prototype.N=function(){De.Z.N.call(this),Ge(this)},De.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Jt=d.JSON.stringify,an=d.JSON.parse,jn=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Js(){}function Hs(){}var gs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Vt(){_.call(this,"d")}w(Vt,_);function xs(){_.call(this,"c")}w(xs,_);var $={},ce=null;function _e(){return ce=ce||new mt}$.Ia="serverreachability";function je(h){_.call(this,$.Ia,h)}w(je,_);function Fe(h){const y=_e();ke(y,new je(y))}$.STAT_EVENT="statevent";function de(h,y){_.call(this,$.STAT_EVENT,h),this.stat=y}w(de,_);function we(h){const y=_e();ke(y,new de(y,h))}$.Ja="timingevent";function Te(h,y){_.call(this,$.Ja,h),this.size=y}w(Te,_);function Be(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},y)}function it(){this.g=!0}it.prototype.ua=function(){this.g=!1};function Le(h,y,N,M,J,re){h.info(function(){if(h.g)if(re){var Ae="",ct=re.split("&");for(let Ct=0;Ct<ct.length;Ct++){var hs=ct[Ct].split("=");if(hs.length>1){const Zt=hs[0];hs=hs[1];const $n=Zt.split("_");Ae=$n.length>=2&&$n[1]=="type"?Ae+(Zt+"="+hs+"&"):Ae+(Zt+"=redacted&")}}}else Ae=null;else Ae=re;return"XMLHTTP REQ ("+M+") [attempt "+J+"]: "+y+`
`+N+`
`+Ae})}function ze(h,y,N,M,J,re,Ae){h.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+J+"]: "+y+`
`+N+`
`+re+" "+Ae})}function kt(h,y,N,M){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+rn(h,N)+(M?" "+M:"")})}function Wt(h,y){h.info(function(){return"TIMEOUT: "+y})}it.prototype.info=function(){};function rn(h,y){if(!h.g)return y;if(!y)return null;try{const re=JSON.parse(y);if(re){for(h=0;h<re.length;h++)if(Array.isArray(re[h])){var N=re[h];if(!(N.length<2)){var M=N[1];if(Array.isArray(M)&&!(M.length<1)){var J=M[0];if(J!="noop"&&J!="stop"&&J!="close")for(let Ae=1;Ae<M.length;Ae++)M[Ae]=""}}}}return Jt(re)}catch{return y}}var ln={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},na={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},aa;function ra(){}w(ra,Js),ra.prototype.g=function(){return new XMLHttpRequest},aa=new ra;function ns(h){return encodeURIComponent(String(h))}function Ri(h){var y=1;h=h.split(":");const N=[];for(;y>0&&h.length;)N.push(h.shift()),y--;return h.length&&N.push(h.join(":")),N}function bs(h,y,N,M){this.j=h,this.i=y,this.l=N,this.S=M||1,this.V=new De(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new on}function on(){this.i=null,this.g="",this.h=!1}var is={},ys={};function Sn(h,y,N){h.M=1,h.A=Di(ws(y)),h.u=N,h.R=!0,Ii(h,null)}function Ii(h,y){h.F=Date.now(),wa(h),h.B=ws(h.A);var N=h.B,M=h.S;Array.isArray(M)||(M=[String(M)]),Il(N.i,"t",M),h.C=0,N=h.j.L,h.h=new on,h.g=id(h.j,N?y:null,!h.u),h.P>0&&(h.O=new Ue(x(h.Y,h,h.g),h.P)),y=h.V,N=h.g,M=h.ba;var J="readystatechange";Array.isArray(J)||(J&&(qe[0]=J.toString()),J=qe);for(let re=0;re<J.length;re++){const Ae=ht(N,J[re],M||y.handleEvent,!1,y.h||y);if(!Ae)break;y.g[Ae.key]=Ae}y=h.J?U(h.J):{},h.u?(h.v||(h.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,y)):(h.v="GET",h.g.ea(h.B,h.v,null,y)),Fe(),Le(h.i,h.v,h.B,h.l,h.S,h.u)}bs.prototype.ba=function(h){h=h.target;const y=this.O;y&&oa(h)==3?y.j():this.Y(h)},bs.prototype.Y=function(h){try{if(h==this.g)e:{const ct=oa(this.g),hs=this.g.ya(),Ct=this.g.ca();if(!(ct<3)&&(ct!=3||this.g&&(this.h.h||this.g.la()||Os(this.g)))){this.K||ct!=4||hs==7||(hs==8||Ct<=0?Fe(3):Fe(2)),Na(this);var y=this.g.ca();this.X=y;var N=Qf(this);if(this.o=y==200,ze(this.i,this.v,this.B,this.l,this.S,ct,y),this.o){if(this.U&&!this.L){t:{if(this.g){var M,J=this.g;if((M=J.g?J.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(M)){var re=M;break t}}re=null}if(h=re)kt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,_a(this,h);else{this.o=!1,this.m=3,we(12),En(this),Bn(this);break e}}if(this.R){h=!0;let Zt;for(;!this.K&&this.C<N.length;)if(Zt=Yu(this,N),Zt==ys){ct==4&&(this.m=4,we(14),h=!1),kt(this.i,this.l,null,"[Incomplete Response]");break}else if(Zt==is){this.m=4,we(15),kt(this.i,this.l,N,"[Invalid Chunk]"),h=!1;break}else kt(this.i,this.l,Zt,null),_a(this,Zt);if(Gu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ct!=4||N.length!=0||this.h.h||(this.m=1,we(16),h=!1),this.o=this.o&&h,!h)kt(this.i,this.l,N,"[Invalid Chunked Response]"),En(this),Bn(this);else if(N.length>0&&!this.W){this.W=!0;var Ae=this.j;Ae.g==this&&Ae.aa&&!Ae.P&&(Ae.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),uc(Ae),Ae.P=!0,we(11))}}else kt(this.i,this.l,N,null),_a(this,N);ct==4&&En(this),this.o&&!this.K&&(ct==4?sd(this.j,this):(this.o=!1,wa(this)))}else Ja(this.g),y==400&&N.indexOf("Unknown SID")>0?(this.m=3,we(12)):(this.m=0,we(13)),En(this),Bn(this)}}}catch{}};function Qf(h){if(!Gu(h))return h.g.la();const y=Os(h.g);if(y==="")return"";let N="";const M=y.length,J=oa(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return En(h),Bn(h),"";h.h.i=new d.TextDecoder}for(let re=0;re<M;re++)h.h.h=!0,N+=h.h.i.decode(y[re],{stream:!(J&&re==M-1)});return y.length=0,h.h.g+=N,h.C=0,h.h.g}function Gu(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Yu(h,y){var N=h.C,M=y.indexOf(`
`,N);return M==-1?ys:(N=Number(y.substring(N,M)),isNaN(N)?is:(M+=1,M+N>y.length?ys:(y=y.slice(M,M+N),h.C=M+N,y)))}bs.prototype.cancel=function(){this.K=!0,En(this)};function wa(h){h.T=Date.now()+h.H,kl(h,h.H)}function kl(h,y){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Be(x(h.aa,h),y)}function Na(h){h.D&&(d.clearTimeout(h.D),h.D=null)}bs.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Wt(this.i,this.B),this.M!=2&&(Fe(),we(17)),En(this),this.m=2,Bn(this)):kl(this,this.T-h)};function Bn(h){h.j.I==0||h.K||sd(h.j,h)}function En(h){Na(h);var y=h.O;y&&typeof y.dispose=="function"&&y.dispose(),h.O=null,Ge(h.V),h.g&&(y=h.g,h.g=null,y.abort(),y.dispose())}function _a(h,y){try{var N=h.j;if(N.I!=0&&(N.g==h||Sa(N.h,h))){if(!h.L&&Sa(N.h,h)&&N.I==3){try{var M=N.Ba.g.parse(y)}catch{M=null}if(Array.isArray(M)&&M.length==3){var J=M;if(J[0]==0){e:if(!N.v){if(N.g)if(N.g.F+3e3<h.F)Vl(N),Mr(N);else break e;Bi(N),we(18)}}else N.xa=J[1],0<N.xa-N.K&&J[2]<37500&&N.F&&N.A==0&&!N.C&&(N.C=Be(x(N.Va,N),6e3));ja(N.h)<=1&&N.ta&&(N.ta=void 0)}else Ra(N,11)}else if((h.L||N.g==h)&&Vl(N),!k(y))for(J=N.Ba.g.parse(y),y=0;y<J.length;y++){let Ct=J[y];const Zt=Ct[0];if(!(Zt<=N.K))if(N.K=Zt,Ct=Ct[1],N.I==2)if(Ct[0]=="c"){N.M=Ct[1],N.ba=Ct[2];const $n=Ct[3];$n!=null&&(N.ka=$n,N.j.info("VER="+N.ka));const Ia=Ct[4];Ia!=null&&(N.za=Ia,N.j.info("SVER="+N.za));const ca=Ct[5];ca!=null&&typeof ca=="number"&&ca>0&&(M=1.5*ca,N.O=M,N.j.info("backChannelRequestTimeoutMs_="+M)),M=N;const ua=h.g;if(ua){const zi=ua.g?ua.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(zi){var re=M.h;re.g||zi.indexOf("spdy")==-1&&zi.indexOf("quic")==-1&&zi.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&(Jo(re,re.h),re.h=null))}if(M.G){const Ll=ua.g?ua.g.getResponseHeader("X-HTTP-Session-Id"):null;Ll&&(M.wa=Ll,Mt(M.J,M.G,Ll))}}N.I=3,N.l&&N.l.ra(),N.aa&&(N.T=Date.now()-h.F,N.j.info("Handshake RTT: "+N.T+"ms")),M=N;var Ae=h;if(M.na=rd(M,M.L?M.ba:null,M.W),Ae.L){Zo(M.h,Ae);var ct=Ae,hs=M.O;hs&&(ct.H=hs),ct.D&&(Na(ct),wa(ct)),M.g=Ae}else ed(M);N.i.length>0&&Ca(N)}else Ct[0]!="stop"&&Ct[0]!="close"||Ra(N,7);else N.I==3&&(Ct[0]=="stop"||Ct[0]=="close"?Ct[0]=="stop"?Ra(N,7):oc(N):Ct[0]!="noop"&&N.l&&N.l.qa(Ct),N.A=0)}}Fe(4)}catch{}}var vs=class{constructor(h,y){this.g=h,this.map=y}};function Ko(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Xo(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ja(h){return h.h?1:h.g?h.g.size:0}function Sa(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Jo(h,y){h.g?h.g.add(y):h.h=y}function Zo(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Ko.prototype.cancel=function(){if(this.i=ec(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function ec(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const N of h.g.values())y=y.concat(N.G);return y}return R(h.i)}var Wu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cl(h,y){if(h){h=h.split("&");for(let N=0;N<h.length;N++){const M=h[N].indexOf("=");let J,re=null;M>=0?(J=h[N].substring(0,M),re=h[N].substring(M+1)):J=h[N],y(J,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function Tn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;h instanceof Tn?(this.l=h.l,Is(this,h.j),this.o=h.o,this.g=h.g,Tr(this,h.u),this.h=h.h,tc(this,Ju(h.i)),this.m=h.m):h&&(y=String(h).match(Wu))?(this.l=!1,Is(this,y[1]||"",!0),this.o=Ea(y[2]||""),this.g=Ea(y[3]||"",!0),Tr(this,y[4]),this.h=Ea(y[5]||"",!0),tc(this,y[6]||"",!0),this.m=Ea(y[7]||"")):(this.l=!1,this.i=new kr(null,this.l))}Tn.prototype.toString=function(){const h=[];var y=this.j;y&&h.push(Mi(y,Rl,!0),":");var N=this.g;return(N||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Mi(y,Rl,!0),"@"),h.push(ns(N).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N=this.u,N!=null&&h.push(":",String(N))),(N=this.h)&&(this.g&&N.charAt(0)!="/"&&h.push("/"),h.push(Mi(N,N.charAt(0)=="/"?sc:Qu,!0))),(N=this.i.toString())&&h.push("?",N),(N=this.m)&&h.push("#",Mi(N,Ku)),h.join("")},Tn.prototype.resolve=function(h){const y=ws(this);let N=!!h.j;N?Is(y,h.j):N=!!h.o,N?y.o=h.o:N=!!h.g,N?y.g=h.g:N=h.u!=null;var M=h.h;if(N)Tr(y,h.u);else if(N=!!h.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var J=y.h.lastIndexOf("/");J!=-1&&(M=y.h.slice(0,J+1)+M)}if(J=M,J==".."||J==".")M="";else if(J.indexOf("./")!=-1||J.indexOf("/.")!=-1){M=J.lastIndexOf("/",0)==0,J=J.split("/");const re=[];for(let Ae=0;Ae<J.length;){const ct=J[Ae++];ct=="."?M&&Ae==J.length&&re.push(""):ct==".."?((re.length>1||re.length==1&&re[0]!="")&&re.pop(),M&&Ae==J.length&&re.push("")):(re.push(ct),M=!0)}M=re.join("/")}else M=J}return N?y.h=M:N=h.i.toString()!=="",N?tc(y,Ju(h.i)):N=!!h.m,N&&(y.m=h.m),y};function ws(h){return new Tn(h)}function Is(h,y,N){h.j=N?Ea(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Tr(h,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);h.u=y}else h.u=null}function tc(h,y,N){y instanceof kr?(h.i=y,Dl(h.i,h.l)):(N||(y=Mi(y,Ar)),h.i=new kr(y,h.l))}function Mt(h,y,N){h.i.set(y,N)}function Di(h){return Mt(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Ea(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Mi(h,y,N){return typeof h=="string"?(h=encodeURI(h).replace(y,cn),N&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function cn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Rl=/[#\/\?@]/g,Qu=/[#\?:]/g,sc=/[#\?]/g,Ar=/[#\?@]/g,Ku=/#/g;function kr(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function un(h){h.g||(h.g=new Map,h.h=0,h.i&&Cl(h.i,function(y,N){h.add(decodeURIComponent(y.replace(/\+/g," ")),N)}))}n=kr.prototype,n.add=function(h,y){un(this),this.i=null,h=Cr(this,h);let N=this.g.get(h);return N||this.g.set(h,N=[]),N.push(y),this.h+=1,this};function Xu(h,y){un(h),y=Cr(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function nc(h,y){return un(h),y=Cr(h,y),h.g.has(y)}n.forEach=function(h,y){un(this),this.g.forEach(function(N,M){N.forEach(function(J){h.call(y,J,M,this)},this)},this)};function ac(h,y){un(h);let N=[];if(typeof y=="string")nc(h,y)&&(N=N.concat(h.g.get(Cr(h,y))));else for(h=Array.from(h.g.values()),y=0;y<h.length;y++)N=N.concat(h[y]);return N}n.set=function(h,y){return un(this),this.i=null,h=Cr(this,h),nc(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=ac(this,h),h.length>0?String(h[0]):y):y};function Il(h,y,N){Xu(h,y),N.length>0&&(h.i=null,h.g.set(Cr(h,y),R(N)),h.h+=N.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(let M=0;M<y.length;M++){var N=y[M];const J=ns(N);N=ac(this,N);for(let re=0;re<N.length;re++){let Ae=J;N[re]!==""&&(Ae+="="+ns(N[re])),h.push(Ae)}}return this.i=h.join("&")};function Ju(h){const y=new kr;return y.i=h.i,h.g&&(y.g=new Map(h.g),y.h=h.h),y}function Cr(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Dl(h,y){y&&!h.j&&(un(h),h.i=null,h.g.forEach(function(N,M){const J=M.toLowerCase();M!=J&&(Xu(this,M),Il(this,J,N))},h)),h.j=y}function ia(h,y){const N=new it;if(d.Image){const M=new Image;M.onload=b(zn,N,"TestLoadImage: loaded",!0,y,M),M.onerror=b(zn,N,"TestLoadImage: error",!1,y,M),M.onabort=b(zn,N,"TestLoadImage: abort",!1,y,M),M.ontimeout=b(zn,N,"TestLoadImage: timeout",!1,y,M),d.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=h}else y(!1)}function rc(h,y){const N=new it,M=new AbortController,J=setTimeout(()=>{M.abort(),zn(N,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:M.signal}).then(re=>{clearTimeout(J),re.ok?zn(N,"TestPingServer: ok",!0,y):zn(N,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(J),zn(N,"TestPingServer: error",!1,y)})}function zn(h,y,N,M,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),M(N)}catch{}}function Rr(){this.g=new jn}function Ta(h){this.i=h.Sb||null,this.h=h.ab||!1}w(Ta,Js),Ta.prototype.g=function(){return new Oi(this.i,this.h)};function Oi(h,y){mt.call(this),this.H=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(Oi,mt),n=Oi.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=y,this.readyState=1,la(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(y.body=h),(this.H||d).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ir(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,la(this)),this.g&&(this.readyState=3,la(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ml(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ml(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Ir(this):la(this),this.readyState==3&&Ml(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,Ir(this))},n.Na=function(h){this.g&&(this.response=h,Ir(this))},n.ga=function(){this.g&&Ir(this)};function Ir(h){h.readyState=4,h.l=null,h.j=null,h.B=null,la(h)}n.setRequestHeader=function(h,y){this.A.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var N=y.next();!N.done;)N=N.value,h.push(N[0]+": "+N[1]),N=y.next();return h.join(`\r
`)};function la(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Oi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Fn(h){let y="";return Ee(h,function(N,M){y+=M,y+=":",y+=N,y+=`\r
`}),y}function Pi(h,y,N){e:{for(M in N){var M=!1;break e}M=!0}M||(N=Fn(N),typeof h=="string"?N!=null&&ns(N):Mt(h,y,N))}function Lt(h){mt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(Lt,mt);var Aa=/^https?$/i,ic=["POST","PUT"];n=Lt.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,y,N,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():aa.g(),this.g.onreadystatechange=S(x(this.Ca,this));try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(re){Vi(this,re);return}if(h=N||"",N=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var J in M)N.set(J,M[J]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const re of M.keys())N.set(re,M.get(re));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(N.keys()).find(re=>re.toLowerCase()=="content-type"),J=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(ic,y,void 0)>=0)||M||J||N.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,Ae]of N)this.g.setRequestHeader(re,Ae);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(re){Vi(this,re)}};function Vi(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.o=5,lc(h),Xa(h)}function lc(h){h.A||(h.A=!0,ke(h,"complete"),ke(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,ke(this,"complete"),ke(this,"abort"),Xa(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xa(this,!0)),Lt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Li(this):this.Xa())},n.Xa=function(){Li(this)};function Li(h){if(h.h&&typeof u<"u"){if(h.v&&oa(h)==4)setTimeout(h.Ca.bind(h),0);else if(ke(h,"readystatechange"),oa(h)==4){h.h=!1;try{const re=h.ca();e:switch(re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var N;if(!(N=y)){var M;if(M=re===0){let Ae=String(h.D).match(Wu)[1]||null;!Ae&&d.self&&d.self.location&&(Ae=d.self.location.protocol.slice(0,-1)),M=!Aa.test(Ae?Ae.toLowerCase():"")}N=M}if(N)ke(h,"complete"),ke(h,"success");else{h.o=6;try{var J=oa(h)>2?h.g.statusText:""}catch{J=""}h.l=J+" ["+h.ca()+"]",lc(h)}}finally{Xa(h)}}}}function Xa(h,y){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const N=h.g;h.g=null,y||ke(h,"ready");try{N.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function oa(h){return h.g?h.g.readyState:0}n.ca=function(){try{return oa(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),an(y)}};function Os(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Ja(h){const y={};h=(h.g&&oa(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<h.length;M++){if(k(h[M]))continue;var N=Ri(h[M]);const J=N[0];if(N=N[1],typeof N!="string")continue;N=N.trim();const re=y[J]||[];y[J]=re,re.push(N)}xe(y,function(M){return M.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ka(h,y,N){return N&&N.internalChannelParams&&N.internalChannelParams[h]||y}function Dr(h){this.za=0,this.i=[],this.j=new it,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ka("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ka("baseRetryDelayMs",5e3,h),this.Za=ka("retryDelaySeedMs",1e4,h),this.Ta=ka("forwardChannelMaxRetries",2,h),this.va=ka("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Ko(h&&h.concurrentRequestLimit),this.Ba=new Rr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Dr.prototype,n.ka=8,n.I=1,n.connect=function(h,y,N,M){we(0),this.W=h,this.H=y||{},N&&M!==void 0&&(this.H.OSID=N,this.H.OAID=M),this.F=this.X,this.J=rd(this,null,this.W),Ca(this)};function oc(h){if(Ol(h),h.I==3){var y=h.V++,N=ws(h.J);if(Mt(N,"SID",h.M),Mt(N,"RID",y),Mt(N,"TYPE","terminate"),Ui(h,N),y=new bs(h,h.j,y),y.M=2,y.A=Di(ws(N)),N=!1,d.navigator&&d.navigator.sendBeacon)try{N=d.navigator.sendBeacon(y.A.toString(),"")}catch{}!N&&d.Image&&(new Image().src=y.A,N=!0),N||(y.g=id(y.j,null),y.g.ea(y.A)),y.F=Date.now(),wa(y)}ad(h)}function Mr(h){h.g&&(uc(h),h.g.cancel(),h.g=null)}function Ol(h){Mr(h),h.v&&(d.clearTimeout(h.v),h.v=null),Vl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Ca(h){if(!Xo(h.h)&&!h.m){h.m=!0;var y=h.Ea;ae||T(),Y||(ae(),Y=!0),A.add(y,h),h.D=0}}function Pl(h,y){return ja(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=y.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Be(x(h.Ea,h,y),nd(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const J=new bs(this,this.j,h);let re=this.o;if(this.U&&(re?(re=U(re),ue(re,this.U)):re=this.U),this.u!==null||this.R||(J.J=re,re=null),this.S)e:{for(var y=0,N=0;N<this.i.length;N++){t:{var M=this.i[N];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(y+=M,y>4096){y=N;break e}if(y===4096||N===this.i.length-1){y=N+1;break e}}y=1e3}else y=1e3;y=Zu(this,J,y),N=ws(this.J),Mt(N,"RID",h),Mt(N,"CVER",22),this.G&&Mt(N,"X-HTTP-Session-Id",this.G),Ui(this,N),re&&(this.R?y="headers="+ns(Fn(re))+"&"+y:this.u&&Pi(N,this.u,re)),Jo(this.h,J),this.Ra&&Mt(N,"TYPE","init"),this.S?(Mt(N,"$req",y),Mt(N,"SID","null"),J.U=!0,Sn(J,N,null)):Sn(J,N,y),this.I=2}}else this.I==3&&(h?cc(this,h):this.i.length==0||Xo(this.h)||cc(this))};function cc(h,y){var N;y?N=y.l:N=h.V++;const M=ws(h.J);Mt(M,"SID",h.M),Mt(M,"RID",N),Mt(M,"AID",h.K),Ui(h,M),h.u&&h.o&&Pi(M,h.u,h.o),N=new bs(h,h.j,N,h.D+1),h.u===null&&(N.J=h.o),y&&(h.i=y.G.concat(h.i)),y=Zu(h,N,1e3),N.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Jo(h.h,N),Sn(N,M,y)}function Ui(h,y){h.H&&Ee(h.H,function(N,M){Mt(y,M,N)}),h.l&&Ee({},function(N,M){Mt(y,M,N)})}function Zu(h,y,N){N=Math.min(h.i.length,N);const M=h.l?x(h.l.Ka,h.l,h):null;e:{var J=h.i;let ct=-1;for(;;){const hs=["count="+N];ct==-1?N>0?(ct=J[0].g,hs.push("ofs="+ct)):ct=0:hs.push("ofs="+ct);let Ct=!0;for(let Zt=0;Zt<N;Zt++){var re=J[Zt].g;const $n=J[Zt].map;if(re-=ct,re<0)ct=Math.max(0,J[Zt].g-100),Ct=!1;else try{re="req"+re+"_"||"";try{var Ae=$n instanceof Map?$n:Object.entries($n);for(const[Ia,ca]of Ae){let ua=ca;p(ca)&&(ua=Jt(ca)),hs.push(re+Ia+"="+encodeURIComponent(ua))}}catch(Ia){throw hs.push(re+"type="+encodeURIComponent("_badmap")),Ia}}catch{M&&M($n)}}if(Ct){Ae=hs.join("&");break e}}Ae=void 0}return h=h.i.splice(0,N),y.G=h,Ae}function ed(h){if(!h.g&&!h.v){h.Y=1;var y=h.Da;ae||T(),Y||(ae(),Y=!0),A.add(y,h),h.A=0}}function Bi(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Be(x(h.Da,h),nd(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,td(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Be(x(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,we(10),Mr(this),td(this))};function uc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function td(h){h.g=new bs(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var y=ws(h.na);Mt(y,"RID","rpc"),Mt(y,"SID",h.M),Mt(y,"AID",h.K),Mt(y,"CI",h.F?"0":"1"),!h.F&&h.ia&&Mt(y,"TO",h.ia),Mt(y,"TYPE","xmlhttp"),Ui(h,y),h.u&&h.o&&Pi(y,h.u,h.o),h.O&&(h.g.H=h.O);var N=h.g;h=h.ba,N.M=1,N.A=Di(ws(y)),N.u=null,N.R=!0,Ii(N,h)}n.Va=function(){this.C!=null&&(this.C=null,Mr(this),Bi(this),we(19))};function Vl(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function sd(h,y){var N=null;if(h.g==y){Vl(h),uc(h),h.g=null;var M=2}else if(Sa(h.h,y))N=y.G,Zo(h.h,y),M=1;else return;if(h.I!=0){if(y.o)if(M==1){N=y.u?y.u.length:0,y=Date.now()-y.F;var J=h.D;M=_e(),ke(M,new Te(M,N)),Ca(h)}else ed(h);else if(J=y.m,J==3||J==0&&y.X>0||!(M==1&&Pl(h,y)||M==2&&Bi(h)))switch(N&&N.length>0&&(y=h.h,y.i=y.i.concat(N)),J){case 1:Ra(h,5);break;case 4:Ra(h,10);break;case 3:Ra(h,6);break;default:Ra(h,2)}}}function nd(h,y){let N=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(N*=2),N*y}function Ra(h,y){if(h.j.info("Error code "+y),y==2){var N=x(h.bb,h),M=h.Ua;const J=!M;M=new Tn(M||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Is(M,"https"),Di(M),J?ia(M.toString(),N):rc(M.toString(),N)}else we(2);h.I=0,h.l&&h.l.pa(y),ad(h),Ol(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),we(2)):(this.j.info("Failed to ping google.com"),we(1))};function ad(h){if(h.I=0,h.ja=[],h.l){const y=ec(h.h);(y.length!=0||h.i.length!=0)&&(B(h.ja,y),B(h.ja,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.oa()}}function rd(h,y,N){var M=N instanceof Tn?ws(N):new Tn(N);if(M.g!="")y&&(M.g=y+"."+M.g),Tr(M,M.u);else{var J=d.location;M=J.protocol,y=y?y+"."+J.hostname:J.hostname,J=+J.port;const re=new Tn(null);M&&Is(re,M),y&&(re.g=y),J&&Tr(re,J),N&&(re.h=N),M=re}return N=h.G,y=h.wa,N&&y&&Mt(M,N,y),Mt(M,"VER",h.ka),Ui(h,M),M}function id(h,y,N){if(y&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Aa&&!h.ma?new Lt(new Ta({ab:N})):new Lt(h.ma),y.Fa(h.L),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ld(){}n=ld.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Or(){}Or.prototype.g=function(h,y){return new Zs(h,y)};function Zs(h,y){mt.call(this),this.g=new Dr(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(h?h["X-WebChannel-Client-Profile"]=y.sa:h={"X-WebChannel-Client-Profile":y.sa}),this.g.U=h,(h=y&&y.Qb)&&!k(h)&&(this.g.u=h),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!k(y)&&(this.g.G=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new Za(this)}w(Zs,mt),Zs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Zs.prototype.close=function(){oc(this.g)},Zs.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var N={};N.__data__=h,h=N}else this.v&&(N={},N.__data__=Jt(h),h=N);y.i.push(new vs(y.Ya++,h)),y.I==3&&Ca(y)},Zs.prototype.N=function(){this.g.l=null,delete this.j,oc(this.g),delete this.g,Zs.Z.N.call(this)};function od(h){Vt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const N in y){h=N;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}w(od,Vt);function cd(){xs.call(this),this.status=1}w(cd,xs);function Za(h){this.g=h}w(Za,ld),Za.prototype.ra=function(){ke(this.g,"a")},Za.prototype.qa=function(h){ke(this.g,new od(h))},Za.prototype.pa=function(h){ke(this.g,new cd)},Za.prototype.oa=function(){ke(this.g,"b")},Or.prototype.createWebChannel=Or.prototype.g,Zs.prototype.send=Zs.prototype.o,Zs.prototype.open=Zs.prototype.m,Zs.prototype.close=Zs.prototype.close,I_=function(){return new Or},R_=function(){return _e()},C_=$,R0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ln.NO_ERROR=0,ln.TIMEOUT=8,ln.HTTP_ERROR=6,Mh=ln,na.COMPLETE="complete",k_=na,Hs.EventType=gs,gs.OPEN="a",gs.CLOSE="b",gs.ERROR="c",gs.MESSAGE="d",mt.prototype.listen=mt.prototype.J,ru=Hs,Lt.prototype.listenOnce=Lt.prototype.K,Lt.prototype.getLastError=Lt.prototype.Ha,Lt.prototype.getLastErrorCode=Lt.prototype.ya,Lt.prototype.getStatus=Lt.prototype.ca,Lt.prototype.getResponseJson=Lt.prototype.La,Lt.prototype.getResponseText=Lt.prototype.la,Lt.prototype.send=Lt.prototype.ea,Lt.prototype.setWithCredentials=Lt.prototype.Fa,A_=Lt}).apply(typeof ph<"u"?ph:typeof self<"u"?self:typeof window<"u"?window:{});let Ws=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ws.UNAUTHENTICATED=new Ws(null),Ws.GOOGLE_CREDENTIALS=new Ws("google-credentials-uid"),Ws.FIRST_PARTY=new Ws("first-party-uid"),Ws.MOCK_USER=new Ws("mock-user");let Ho="12.8.0";function u4(n){Ho=n}const xl=new pg("@firebase/firestore");function go(){return xl.logLevel}function Me(n,...e){if(xl.logLevel<=yt.DEBUG){const t=e.map(Eg);xl.debug(`Firestore (${Ho}): ${n}`,...t)}}function jr(n,...e){if(xl.logLevel<=yt.ERROR){const t=e.map(Eg);xl.error(`Firestore (${Ho}): ${n}`,...t)}}function Co(n,...e){if(xl.logLevel<=yt.WARN){const t=e.map(Eg);xl.warn(`Firestore (${Ho}): ${n}`,...t)}}function Eg(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function st(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,D_(n,i,t)}function D_(n,e,t){let i=`FIRESTORE (${Ho}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw jr(i),new Error(i)}function Dt(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||D_(e,o,i)}function ot(n,e){return n}const ye={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends Ka{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class vr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class M_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class d4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ws.UNAUTHENTICATED)))}shutdown(){}}class h4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class f4{constructor(e){this.t=e,this.currentUser=Ws.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Dt(this.o===void 0,42304);let i=this.i;const o=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new vr;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new vr,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await o(this.currentUser)}))},p=g=>{Me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(Me("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new vr)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Dt(typeof i.accessToken=="string",31837,{l:i}),new M_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Dt(e===null||typeof e=="string",2055,{h:e}),new Ws(e)}}class m4{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Ws.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class p4{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new m4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ws.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Iw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class g4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,On(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Dt(this.o===void 0,3512);const i=u=>{u.error!=null&&Me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,Me("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const o=u=>{Me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>o(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?o(u):Me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Iw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Dt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Iw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function x4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Tg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=x4(40);for(let u=0;u<o.length;++u)i.length<20&&o[u]<t&&(i+=e.charAt(o[u]%62))}return i}}function vt(n,e){return n<e?-1:n>e?1:0}function I0(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),u=e.charAt(i);if(o!==u)return r0(o)===r0(u)?vt(o,u):r0(o)?1:-1}return vt(n.length,e.length)}const b4=55296,y4=57343;function r0(n){const e=n.charCodeAt(0);return e>=b4&&e<=y4}function Ro(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}const Dw="__name__";class Va{constructor(e,t,i){t===void 0?t=0:t>e.length&&st(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&st(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Va.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Va?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const u=Va.compareSegments(e.get(o),t.get(o));if(u!==0)return u}return vt(e.length,t.length)}static compareSegments(e,t){const i=Va.isNumericId(e),o=Va.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?Va.extractNumericId(e).compare(Va.extractNumericId(t)):I0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return mi.fromString(e.substring(4,e.length-2))}}class Yt extends Va{construct(e,t,i){return new Yt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ie(ye.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new Yt(t)}static emptyPath(){return new Yt([])}}const v4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zs extends Va{construct(e,t,i){return new zs(e,t,i)}static isValidIdentifier(e){return v4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Dw}static keyField(){return new zs([Dw])}static fromServerFormat(e){const t=[];let i="",o=0;const u=()=>{if(i.length===0)throw new Ie(ye.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;o<e.length;){const p=e[o];if(p==="\\"){if(o+1===e.length)throw new Ie(ye.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[o+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ie(ye.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,o+=2}else p==="`"?(d=!d,o++):p!=="."||d?(i+=p,o++):(u(),o++)}if(u(),d)throw new Ie(ye.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zs(t)}static emptyPath(){return new zs([])}}class Qe{constructor(e){this.path=e}static fromPath(e){return new Qe(Yt.fromString(e))}static fromName(e){return new Qe(Yt.fromString(e).popFirst(5))}static empty(){return new Qe(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Yt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Qe(new Yt(e.slice()))}}function O_(n,e,t){if(!t)throw new Ie(ye.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function w4(n,e,t,i){if(e===!0&&i===!0)throw new Ie(ye.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Mw(n){if(!Qe.isDocumentKey(n))throw new Ie(ye.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ow(n){if(Qe.isDocumentKey(n))throw new Ie(ye.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function P_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Sf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":st(12329,{type:typeof n})}function vn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ie(ye.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Sf(n);throw new Ie(ye.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function As(n,e){const t={typeString:n};return e&&(t.value=e),t}function Uu(n,e){if(!P_(n))throw new Ie(ye.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(o&&typeof d!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new Ie(ye.INVALID_ARGUMENT,t);return!0}const Pw=-62135596800,Vw=1e6;class It{static now(){return It.fromMillis(Date.now())}static fromDate(e){return It.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*Vw);return new It(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ie(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ie(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Pw)throw new Ie(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Vw}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:It._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Uu(e,It._jsonSchema))return new It(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Pw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}It._jsonSchemaVersion="firestore/timestamp/1.0",It._jsonSchema={type:As("string",It._jsonSchemaVersion),seconds:As("number"),nanoseconds:As("number")};class rt{static fromTimestamp(e){return new rt(e)}static min(){return new rt(new It(0,0))}static max(){return new rt(new It(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Nu=-1;function N4(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=rt.fromTimestamp(i===1e9?new It(t+1,0):new It(t,i));return new bi(o,Qe.empty(),e)}function _4(n){return new bi(n.readTime,n.key,Nu)}class bi{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new bi(rt.min(),Qe.empty(),Nu)}static max(){return new bi(rt.max(),Qe.empty(),Nu)}}function j4(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Qe.comparator(n.documentKey,e.documentKey),t!==0?t:vt(n.largestBatchId,e.largestBatchId))}const S4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class E4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Go(n){if(n.code!==ye.FAILED_PRECONDITION||n.message!==S4)throw n;Me("LocalStore","Unexpectedly lost primary lease")}class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&st(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ve(((i,o)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,o)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ve?t:ve.resolve(t)}catch(t){return ve.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ve.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ve.reject(t)}static resolve(e){return new ve(((t,i)=>{t(e)}))}static reject(e){return new ve(((t,i)=>{i(e)}))}static waitFor(e){return new ve(((t,i)=>{let o=0,u=0,d=!1;e.forEach((p=>{++o,p.next((()=>{++u,d&&u===o&&t()}),(g=>i(g)))})),d=!0,u===o&&t()}))}static or(e){let t=ve.resolve(!1);for(const i of e)t=t.next((o=>o?ve.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,u)=>{i.push(t.call(this,o,u))})),this.waitFor(i)}static mapArray(e,t){return new ve(((i,o)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const x=g;t(e[x]).next((b=>{d[x]=b,++p,p===u&&i(d)}),(b=>o(b)))}}))}static doWhile(e,t){return new ve(((i,o)=>{const u=()=>{e()===!0?t().next((()=>{u()}),o):i()};u()}))}}function T4(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Yo(n){return n.name==="IndexedDbTransactionError"}class Ef{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ef.ce=-1;const Ag=-1;function Tf(n){return n==null}function ef(n){return n===0&&1/n==-1/0}function A4(n){return typeof n=="number"&&Number.isInteger(n)&&!ef(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const V_="";function k4(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Lw(e)),e=C4(n.get(t),e);return Lw(e)}function C4(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const u=n.charAt(o);switch(u){case"\0":t+="";break;case V_:t+="";break;default:t+=u}}return t}function Lw(n){return n+V_+""}function Uw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ki(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function L_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class as{constructor(e,t){this.comparator=e,this.root=t||Bs.EMPTY}insert(e,t){return new as(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bs.BLACK,null,null))}remove(e){return new as(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gh(this.root,e,this.comparator,!1)}getReverseIterator(){return new gh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gh(this.root,e,this.comparator,!0)}}class gh{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&o&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bs{constructor(e,t,i,o,u){this.key=e,this.value=t,this.color=i??Bs.RED,this.left=o??Bs.EMPTY,this.right=u??Bs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,u){return new Bs(e??this.key,t??this.value,i??this.color,o??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const u=i(e,o.key);return o=u<0?o.copy(null,null,null,o.left.insert(e,t,i),null):u===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Bs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Bs.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw st(43730,{key:this.key,value:this.value});if(this.right.isRed())throw st(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw st(27949);return e+(this.isRed()?0:1)}}Bs.EMPTY=null,Bs.RED=!0,Bs.BLACK=!1;Bs.EMPTY=new class{constructor(){this.size=0}get key(){throw st(57766)}get value(){throw st(16141)}get color(){throw st(16727)}get left(){throw st(29726)}get right(){throw st(36894)}copy(e,t,i,o,u){return this}insert(e,t,i){return new Bs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Rs{constructor(e){this.comparator=e,this.data=new as(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Bw(this.data.getIterator())}getIteratorFrom(e){return new Bw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Rs)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,u=i.getNext().key;if(this.comparator(o,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Rs(this.comparator);return t.data=e,t}}class Bw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Pn{constructor(e){this.fields=e,e.sort(zs.comparator)}static empty(){return new Pn([])}unionWith(e){let t=new Rs(zs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Pn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ro(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class U_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class $s{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new U_("Invalid base64 string: "+u):u}})(e);return new $s(t)}static fromUint8Array(e){const t=(function(o){let u="";for(let d=0;d<o.length;++d)u+=String.fromCharCode(o[d]);return u})(e);return new $s(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}$s.EMPTY_BYTE_STRING=new $s("");const R4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yi(n){if(Dt(!!n,39018),typeof n=="string"){let e=0;const t=R4.exec(n);if(Dt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ps(n.seconds),nanos:ps(n.nanos)}}function ps(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function vi(n){return typeof n=="string"?$s.fromBase64String(n):$s.fromUint8Array(n)}const B_="server_timestamp",z_="__type__",F_="__previous_value__",$_="__local_write_time__";function kg(n){return(n?.mapValue?.fields||{})[z_]?.stringValue===B_}function Af(n){const e=n.mapValue.fields[F_];return kg(e)?Af(e):e}function _u(n){const e=yi(n.mapValue.fields[$_].timestampValue);return new It(e.seconds,e.nanos)}class I4{constructor(e,t,i,o,u,d,p,g,x,b,w){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=x,this.isUsingEmulator=b,this.apiKey=w}}const tf="(default)";class ju{constructor(e,t){this.projectId=e,this.database=t||tf}static empty(){return new ju("","")}get isDefaultDatabase(){return this.database===tf}isEqual(e){return e instanceof ju&&e.projectId===this.projectId&&e.database===this.database}}function D4(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Ie(ye.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ju(n.options.projectId,e)}const q_="__type__",M4="__max__",xh={mapValue:{}},H_="__vector__",sf="value";function wi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?kg(n)?4:P4(n)?9007199254740991:O4(n)?10:11:st(28295,{value:n})}function Wa(n,e){if(n===e)return!0;const t=wi(n);if(t!==wi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return _u(n).isEqual(_u(e));case 3:return(function(o,u){if(typeof o.timestampValue=="string"&&typeof u.timestampValue=="string"&&o.timestampValue.length===u.timestampValue.length)return o.timestampValue===u.timestampValue;const d=yi(o.timestampValue),p=yi(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,u){return vi(o.bytesValue).isEqual(vi(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,u){return ps(o.geoPointValue.latitude)===ps(u.geoPointValue.latitude)&&ps(o.geoPointValue.longitude)===ps(u.geoPointValue.longitude)})(n,e);case 2:return(function(o,u){if("integerValue"in o&&"integerValue"in u)return ps(o.integerValue)===ps(u.integerValue);if("doubleValue"in o&&"doubleValue"in u){const d=ps(o.doubleValue),p=ps(u.doubleValue);return d===p?ef(d)===ef(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return Ro(n.arrayValue.values||[],e.arrayValue.values||[],Wa);case 10:case 11:return(function(o,u){const d=o.mapValue.fields||{},p=u.mapValue.fields||{};if(Uw(d)!==Uw(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Wa(d[g],p[g])))return!1;return!0})(n,e);default:return st(52216,{left:n})}}function Su(n,e){return(n.values||[]).find((t=>Wa(t,e)))!==void 0}function Io(n,e){if(n===e)return 0;const t=wi(n),i=wi(e);if(t!==i)return vt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return vt(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=ps(u.integerValue||u.doubleValue),g=ps(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return zw(n.timestampValue,e.timestampValue);case 4:return zw(_u(n),_u(e));case 5:return I0(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=vi(u),g=vi(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let x=0;x<p.length&&x<g.length;x++){const b=vt(p[x],g[x]);if(b!==0)return b}return vt(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=vt(ps(u.latitude),ps(d.latitude));return p!==0?p:vt(ps(u.longitude),ps(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Fw(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},x=p[sf]?.arrayValue,b=g[sf]?.arrayValue,w=vt(x?.values?.length||0,b?.values?.length||0);return w!==0?w:Fw(x,b)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===xh.mapValue&&d===xh.mapValue)return 0;if(u===xh.mapValue)return 1;if(d===xh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),x=d.fields||{},b=Object.keys(x);g.sort(),b.sort();for(let w=0;w<g.length&&w<b.length;++w){const S=I0(g[w],b[w]);if(S!==0)return S;const R=Io(p[g[w]],x[b[w]]);if(R!==0)return R}return vt(g.length,b.length)})(n.mapValue,e.mapValue);default:throw st(23264,{he:t})}}function zw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return vt(n,e);const t=yi(n),i=yi(e),o=vt(t.seconds,i.seconds);return o!==0?o:vt(t.nanos,i.nanos)}function Fw(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const u=Io(t[o],i[o]);if(u)return u}return vt(t.length,i.length)}function Do(n){return D0(n)}function D0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=yi(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return vi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Qe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const u of t.values||[])o?o=!1:i+=",",i+=D0(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",u=!0;for(const d of i)u?u=!1:o+=",",o+=`${d}:${D0(t.fields[d])}`;return o+"}"})(n.mapValue):st(61005,{value:n})}function Oh(n){switch(wi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Af(n);return e?16+Oh(e):16;case 5:return 2*n.stringValue.length;case 6:return vi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,u)=>o+Oh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return ki(i.fields,((u,d)=>{o+=u.length+Oh(d)})),o})(n.mapValue);default:throw st(13486,{value:n})}}function $w(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function M0(n){return!!n&&"integerValue"in n}function Cg(n){return!!n&&"arrayValue"in n}function qw(n){return!!n&&"nullValue"in n}function Hw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ph(n){return!!n&&"mapValue"in n}function O4(n){return(n?.mapValue?.fields||{})[q_]?.stringValue===H_}function hu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ki(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=hu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hu(n.arrayValue.values[t]);return e}return{...n}}function P4(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===M4}class xn{constructor(e){this.value=e}static empty(){return new xn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ph(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hu(t)}setAll(e){let t=zs.emptyPath(),i={},o=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,o),i={},o=[],t=p.popLast()}d?i[p.lastSegment()]=hu(d):o.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,o)}delete(e){const t=this.field(e.popLast());Ph(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];Ph(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){ki(t,((o,u)=>e[o]=u));for(const o of i)delete e[o]}clone(){return new xn(hu(this.value))}}function G_(n){const e=[];return ki(n.fields,((t,i)=>{const o=new zs([t]);if(Ph(i)){const u=G_(i.mapValue).fields;if(u.length===0)e.push(o);else for(const d of u)e.push(o.child(d))}else e.push(o)})),new Pn(e)}class Qs{constructor(e,t,i,o,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new Qs(e,0,rt.min(),rt.min(),rt.min(),xn.empty(),0)}static newFoundDocument(e,t,i,o){return new Qs(e,1,t,rt.min(),i,o,0)}static newNoDocument(e,t){return new Qs(e,2,t,rt.min(),rt.min(),xn.empty(),0)}static newUnknownDocument(e,t){return new Qs(e,3,t,rt.min(),rt.min(),xn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class nf{constructor(e,t){this.position=e,this.inclusive=t}}function Gw(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const u=e[o],d=n.position[o];if(u.field.isKeyField()?i=Qe.comparator(Qe.fromName(d.referenceValue),t.key):i=Io(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Yw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Wa(n.position[t],e.position[t]))return!1;return!0}class af{constructor(e,t="asc"){this.field=e,this.dir=t}}function V4(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Y_{}class Ts extends Y_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new U4(e,t,i):t==="array-contains"?new F4(e,i):t==="in"?new $4(e,i):t==="not-in"?new q4(e,i):t==="array-contains-any"?new H4(e,i):new Ts(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new B4(e,i):new z4(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Io(t,this.value)):t!==null&&wi(this.value)===wi(t)&&this.matchesComparison(Io(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return st(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ba extends Y_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ba(e,t)}matches(e){return W_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function W_(n){return n.op==="and"}function Q_(n){return L4(n)&&W_(n)}function L4(n){for(const e of n.filters)if(e instanceof ba)return!1;return!0}function O0(n){if(n instanceof Ts)return n.field.canonicalString()+n.op.toString()+Do(n.value);if(Q_(n))return n.filters.map((e=>O0(e))).join(",");{const e=n.filters.map((t=>O0(t))).join(",");return`${n.op}(${e})`}}function K_(n,e){return n instanceof Ts?(function(i,o){return o instanceof Ts&&i.op===o.op&&i.field.isEqual(o.field)&&Wa(i.value,o.value)})(n,e):n instanceof ba?(function(i,o){return o instanceof ba&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((u,d,p)=>u&&K_(d,o.filters[p])),!0):!1})(n,e):void st(19439)}function X_(n){return n instanceof Ts?(function(t){return`${t.field.canonicalString()} ${t.op} ${Do(t.value)}`})(n):n instanceof ba?(function(t){return t.op.toString()+" {"+t.getFilters().map(X_).join(" ,")+"}"})(n):"Filter"}class U4 extends Ts{constructor(e,t,i){super(e,t,i),this.key=Qe.fromName(i.referenceValue)}matches(e){const t=Qe.comparator(e.key,this.key);return this.matchesComparison(t)}}class B4 extends Ts{constructor(e,t){super(e,"in",t),this.keys=J_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class z4 extends Ts{constructor(e,t){super(e,"not-in",t),this.keys=J_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function J_(n,e){return(e.arrayValue?.values||[]).map((t=>Qe.fromName(t.referenceValue)))}class F4 extends Ts{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Cg(t)&&Su(t.arrayValue,this.value)}}class $4 extends Ts{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Su(this.value.arrayValue,t)}}class q4 extends Ts{constructor(e,t){super(e,"not-in",t)}matches(e){if(Su(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Su(this.value.arrayValue,t)}}class H4 extends Ts{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Cg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Su(this.value.arrayValue,i)))}}class G4{constructor(e,t=null,i=[],o=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Ww(n,e=null,t=[],i=[],o=null,u=null,d=null){return new G4(n,e,t,i,o,u,d)}function Rg(n){const e=ot(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>O0(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),Tf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Do(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Do(i))).join(",")),e.Te=t}return e.Te}function Ig(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!V4(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!K_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Yw(n.startAt,e.startAt)&&Yw(n.endAt,e.endAt)}function P0(n){return Qe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Bu{constructor(e,t=null,i=[],o=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Y4(n,e,t,i,o,u,d,p){return new Bu(n,e,t,i,o,u,d,p)}function kf(n){return new Bu(n)}function Qw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function W4(n){return Qe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Z_(n){return n.collectionGroup!==null}function fu(n){const e=ot(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Rs(zs.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((x=>{x.isInequality()&&(p=p.add(x.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new af(u,i))})),t.has(zs.keyField().canonicalString())||e.Ie.push(new af(zs.keyField(),i))}return e.Ie}function qa(n){const e=ot(n);return e.Ee||(e.Ee=Q4(e,fu(n))),e.Ee}function Q4(n,e){if(n.limitType==="F")return Ww(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const u=o.dir==="desc"?"asc":"desc";return new af(o.field,u)}));const t=n.endAt?new nf(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new nf(n.startAt.position,n.startAt.inclusive):null;return Ww(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function V0(n,e){const t=n.filters.concat([e]);return new Bu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function L0(n,e,t){return new Bu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Cf(n,e){return Ig(qa(n),qa(e))&&n.limitType===e.limitType}function e2(n){return`${Rg(qa(n))}|lt:${n.limitType}`}function xo(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>X_(o))).join(", ")}]`),Tf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>Do(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>Do(o))).join(",")),`Target(${i})`})(qa(n))}; limitType=${n.limitType})`}function Rf(n,e){return e.isFoundDocument()&&(function(i,o){const u=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):Qe.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,o){for(const u of fu(i))if(!u.field.isKeyField()&&o.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const u of i.filters)if(!u.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(d,p,g){const x=Gw(d,p,g);return d.inclusive?x<=0:x<0})(i.startAt,fu(i),o)||i.endAt&&!(function(d,p,g){const x=Gw(d,p,g);return d.inclusive?x>=0:x>0})(i.endAt,fu(i),o))})(n,e)}function K4(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function t2(n){return(e,t)=>{let i=!1;for(const o of fu(n)){const u=X4(o,e,t);if(u!==0)return u;i=i||o.field.isKeyField()}return 0}}function X4(n,e,t){const i=n.field.isKeyField()?Qe.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),x=p.data.field(u);return g!==null&&x!==null?Io(g,x):st(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return st(19790,{direction:n.dir})}}class El{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,u]of i)if(this.equalsFn(o,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<o.length;u++)if(this.equalsFn(o[u][0],e))return void(o[u]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){ki(this.inner,((t,i)=>{for(const[o,u]of i)e(o,u)}))}isEmpty(){return L_(this.inner)}size(){return this.innerSize}}const J4=new as(Qe.comparator);function Sr(){return J4}const s2=new as(Qe.comparator);function iu(...n){let e=s2;for(const t of n)e=e.insert(t.key,t);return e}function n2(n){let e=s2;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function ol(){return mu()}function a2(){return mu()}function mu(){return new El((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Z4=new as(Qe.comparator),eR=new Rs(Qe.comparator);function wt(...n){let e=eR;for(const t of n)e=e.add(t);return e}const tR=new Rs(vt);function sR(){return tR}function Dg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ef(e)?"-0":e}}function r2(n){return{integerValue:""+n}}function nR(n,e){return A4(e)?r2(e):Dg(n,e)}class If{constructor(){this._=void 0}}function aR(n,e,t){return n instanceof Eu?(function(o,u){const d={fields:{[z_]:{stringValue:B_},[$_]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return u&&kg(u)&&(u=Af(u)),u&&(d.fields[F_]=u),{mapValue:d}})(t,e):n instanceof Tu?l2(n,e):n instanceof Au?o2(n,e):(function(o,u){const d=i2(o,u),p=Kw(d)+Kw(o.Ae);return M0(d)&&M0(o.Ae)?r2(p):Dg(o.serializer,p)})(n,e)}function rR(n,e,t){return n instanceof Tu?l2(n,e):n instanceof Au?o2(n,e):t}function i2(n,e){return n instanceof rf?(function(i){return M0(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Eu extends If{}class Tu extends If{constructor(e){super(),this.elements=e}}function l2(n,e){const t=c2(e);for(const i of n.elements)t.some((o=>Wa(o,i)))||t.push(i);return{arrayValue:{values:t}}}class Au extends If{constructor(e){super(),this.elements=e}}function o2(n,e){let t=c2(e);for(const i of n.elements)t=t.filter((o=>!Wa(o,i)));return{arrayValue:{values:t}}}class rf extends If{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Kw(n){return ps(n.integerValue||n.doubleValue)}function c2(n){return Cg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class iR{constructor(e,t){this.field=e,this.transform=t}}function lR(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof Tu&&o instanceof Tu||i instanceof Au&&o instanceof Au?Ro(i.elements,o.elements,Wa):i instanceof rf&&o instanceof rf?Wa(i.Ae,o.Ae):i instanceof Eu&&o instanceof Eu})(n.transform,e.transform)}class oR{constructor(e,t){this.version=e,this.transformResults=t}}class ta{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ta}static exists(e){return new ta(void 0,e)}static updateTime(e){return new ta(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Df{}function u2(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Mg(n.key,ta.none()):new zu(n.key,n.data,ta.none());{const t=n.data,i=xn.empty();let o=new Rs(zs.comparator);for(let u of e.fields)if(!o.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),o=o.add(u)}return new Ci(n.key,i,new Pn(o.toArray()),ta.none())}}function cR(n,e,t){n instanceof zu?(function(o,u,d){const p=o.value.clone(),g=Jw(o.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof Ci?(function(o,u,d){if(!Vh(o.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Jw(o.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(d2(o)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(o,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function pu(n,e,t,i){return n instanceof zu?(function(u,d,p,g){if(!Vh(u.precondition,d))return p;const x=u.value.clone(),b=Zw(u.fieldTransforms,g,d);return x.setAll(b),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),null})(n,e,t,i):n instanceof Ci?(function(u,d,p,g){if(!Vh(u.precondition,d))return p;const x=Zw(u.fieldTransforms,g,d),b=d.data;return b.setAll(d2(u)),b.setAll(x),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((w=>w.field)))})(n,e,t,i):(function(u,d,p){return Vh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function uR(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),u=i2(i.transform,o||null);u!=null&&(t===null&&(t=xn.empty()),t.set(i.field,u))}return t||null}function Xw(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Ro(i,o,((u,d)=>lR(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class zu extends Df{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Ci extends Df{constructor(e,t,i,o,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function d2(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Jw(n,e,t){const i=new Map;Dt(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let o=0;o<t.length;o++){const u=n[o],d=u.transform,p=e.data.field(u.field);i.set(u.field,rR(d,p,t[o]))}return i}function Zw(n,e,t){const i=new Map;for(const o of n){const u=o.transform,d=t.data.field(o.field);i.set(o.field,aR(u,d,e))}return i}class Mg extends Df{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dR extends Df{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class hR{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const u=this.mutations[o];u.key.isEqual(e.key)&&cR(u,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=pu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=pu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=a2();return this.mutations.forEach((o=>{const u=e.get(o.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(o.key)?null:p;const g=u2(d,p);g!==null&&i.set(o.key,g),d.isValidDocument()||d.convertToNoDocument(rt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),wt())}isEqual(e){return this.batchId===e.batchId&&Ro(this.mutations,e.mutations,((t,i)=>Xw(t,i)))&&Ro(this.baseMutations,e.baseMutations,((t,i)=>Xw(t,i)))}}class Og{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){Dt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return Z4})();const u=e.mutations;for(let d=0;d<u.length;d++)o=o.insert(u[d].key,i[d].version);return new Og(e,t,i,o)}}class fR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class mR{constructor(e,t){this.count=e,this.unchangedNames=t}}var Es,_t;function pR(n){switch(n){case ye.OK:return st(64938);case ye.CANCELLED:case ye.UNKNOWN:case ye.DEADLINE_EXCEEDED:case ye.RESOURCE_EXHAUSTED:case ye.INTERNAL:case ye.UNAVAILABLE:case ye.UNAUTHENTICATED:return!1;case ye.INVALID_ARGUMENT:case ye.NOT_FOUND:case ye.ALREADY_EXISTS:case ye.PERMISSION_DENIED:case ye.FAILED_PRECONDITION:case ye.ABORTED:case ye.OUT_OF_RANGE:case ye.UNIMPLEMENTED:case ye.DATA_LOSS:return!0;default:return st(15467,{code:n})}}function h2(n){if(n===void 0)return jr("GRPC error has no .code"),ye.UNKNOWN;switch(n){case Es.OK:return ye.OK;case Es.CANCELLED:return ye.CANCELLED;case Es.UNKNOWN:return ye.UNKNOWN;case Es.DEADLINE_EXCEEDED:return ye.DEADLINE_EXCEEDED;case Es.RESOURCE_EXHAUSTED:return ye.RESOURCE_EXHAUSTED;case Es.INTERNAL:return ye.INTERNAL;case Es.UNAVAILABLE:return ye.UNAVAILABLE;case Es.UNAUTHENTICATED:return ye.UNAUTHENTICATED;case Es.INVALID_ARGUMENT:return ye.INVALID_ARGUMENT;case Es.NOT_FOUND:return ye.NOT_FOUND;case Es.ALREADY_EXISTS:return ye.ALREADY_EXISTS;case Es.PERMISSION_DENIED:return ye.PERMISSION_DENIED;case Es.FAILED_PRECONDITION:return ye.FAILED_PRECONDITION;case Es.ABORTED:return ye.ABORTED;case Es.OUT_OF_RANGE:return ye.OUT_OF_RANGE;case Es.UNIMPLEMENTED:return ye.UNIMPLEMENTED;case Es.DATA_LOSS:return ye.DATA_LOSS;default:return st(39323,{code:n})}}(_t=Es||(Es={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";function gR(){return new TextEncoder}const xR=new mi([4294967295,4294967295],0);function e1(n){const e=gR().encode(n),t=new T_;return t.update(e),new Uint8Array(t.digest())}function t1(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new mi([t,i],0),new mi([o,u],0)]}class Pg{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new lu(`Invalid padding: ${t}`);if(i<0)throw new lu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new lu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new lu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=mi.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(mi.fromNumber(i)));return o.compare(xR)===1&&(o=new mi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=e1(e),[i,o]=t1(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,o,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new Pg(u,o,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=e1(e),[i,o]=t1(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,o,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class lu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Mf{constructor(e,t,i,o,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Fu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Mf(rt.min(),o,new as(vt),Sr(),wt())}}class Fu{constructor(e,t,i,o,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Fu(i,t,wt(),wt(),wt())}}class Lh{constructor(e,t,i,o){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=o}}class f2{constructor(e,t){this.targetId=e,this.Ce=t}}class m2{constructor(e,t,i=$s.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class s1{constructor(){this.ve=0,this.Fe=n1(),this.Me=$s.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=wt(),t=wt(),i=wt();return this.Fe.forEach(((o,u)=>{switch(u){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:st(38017,{changeType:u})}})),new Fu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=n1()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Dt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class bR{constructor(e){this.Ge=e,this.ze=new Map,this.je=Sr(),this.He=bh(),this.Je=bh(),this.Ze=new as(vt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:st(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const u=o.target;if(P0(u))if(i===0){const d=new Qe(u.path);this.et(t,d,Qs.newNoDocument(d,rt.min()))}else Dt(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const x=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,x)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:u=0}=t;let d,p;try{d=vi(i).toUint8Array()}catch(g){if(g instanceof U_)return Co("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new Pg(d,o,u)}catch(g){return Co(g instanceof lu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&P0(p.target)){const g=new Qe(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,Qs.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=wt();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const x=this.ot(g);return!x||x.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const o=new Mf(e,t,this.Ze,this.je,i);return this.je=Sr(),this.He=bh(),this.Je=bh(),this.Ze=new as(vt),o}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.qe(t,1):o.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new s1,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Rs(vt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Rs(vt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Me("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new s1),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function bh(){return new as(Qe.comparator)}function n1(){return new as(Qe.comparator)}const yR={asc:"ASCENDING",desc:"DESCENDING"},vR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wR={and:"AND",or:"OR"};class NR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function U0(n,e){return n.useProto3Json||Tf(e)?e:{value:e}}function lf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function p2(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function _R(n,e){return lf(n,e.toTimestamp())}function Ha(n){return Dt(!!n,49232),rt.fromTimestamp((function(t){const i=yi(t);return new It(i.seconds,i.nanos)})(n))}function Vg(n,e){return B0(n,e).canonicalString()}function B0(n,e){const t=(function(o){return new Yt(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function g2(n){const e=Yt.fromString(n);return Dt(w2(e),10190,{key:e.toString()}),e}function z0(n,e){return Vg(n.databaseId,e.path)}function i0(n,e){const t=g2(e);if(t.get(1)!==n.databaseId.projectId)throw new Ie(ye.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ie(ye.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Qe(b2(t))}function x2(n,e){return Vg(n.databaseId,e)}function jR(n){const e=g2(n);return e.length===4?Yt.emptyPath():b2(e)}function F0(n){return new Yt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function b2(n){return Dt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function a1(n,e,t){return{name:z0(n,e),fields:t.value.mapValue.fields}}function SR(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(x){return x==="NO_CHANGE"?0:x==="ADD"?1:x==="REMOVE"?2:x==="CURRENT"?3:x==="RESET"?4:st(39313,{state:x})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],u=(function(x,b){return x.useProto3Json?(Dt(b===void 0||typeof b=="string",58123),$s.fromBase64String(b||"")):(Dt(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),$s.fromUint8Array(b||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(x){const b=x.code===void 0?ye.UNKNOWN:h2(x.code);return new Ie(b,x.message||"")})(d);t=new m2(i,o,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=i0(n,i.document.name),u=Ha(i.document.updateTime),d=i.document.createTime?Ha(i.document.createTime):rt.min(),p=new xn({mapValue:{fields:i.document.fields}}),g=Qs.newFoundDocument(o,u,d,p),x=i.targetIds||[],b=i.removedTargetIds||[];t=new Lh(x,b,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=i0(n,i.document),u=i.readTime?Ha(i.readTime):rt.min(),d=Qs.newNoDocument(o,u),p=i.removedTargetIds||[];t=new Lh([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=i0(n,i.document),u=i.removedTargetIds||[];t=new Lh([],u,o,null)}else{if(!("filter"in e))return st(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:u}=i,d=new mR(o,u),p=i.targetId;t=new f2(p,d)}}return t}function ER(n,e){let t;if(e instanceof zu)t={update:a1(n,e.key,e.value)};else if(e instanceof Mg)t={delete:z0(n,e.key)};else if(e instanceof Ci)t={update:a1(n,e.key,e.data),updateMask:OR(e.fieldMask)};else{if(!(e instanceof dR))return st(16599,{dt:e.type});t={verify:z0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof Eu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Tu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Au)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof rf)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw st(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(o,u){return u.updateTime!==void 0?{updateTime:_R(o,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:st(27497)})(n,e.precondition)),t}function TR(n,e){return n&&n.length>0?(Dt(e!==void 0,14353),n.map((t=>(function(o,u){let d=o.updateTime?Ha(o.updateTime):Ha(u);return d.isEqual(rt.min())&&(d=Ha(u)),new oR(d,o.transformResults||[])})(t,e)))):[]}function AR(n,e){return{documents:[x2(n,e.path)]}}function kR(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=x2(n,o);const u=(function(x){if(x.length!==0)return v2(ba.create(x,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(x){if(x.length!==0)return x.map((b=>(function(S){return{field:bo(S.field),direction:IR(S.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=U0(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(x){return{before:x.inclusive,values:x.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(x){return{before:!x.inclusive,values:x.position}})(e.endAt)),{ft:t,parent:o}}function CR(n){let e=jR(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){Dt(i===1,65062);const b=t.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(w){const S=y2(w);return S instanceof ba&&Q_(S)?S.getFilters():[S]})(t.where));let d=[];t.orderBy&&(d=(function(w){return w.map((S=>(function(B){return new af(yo(B.field),(function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(S)))})(t.orderBy));let p=null;t.limit&&(p=(function(w){let S;return S=typeof w=="object"?w.value:w,Tf(S)?null:S})(t.limit));let g=null;t.startAt&&(g=(function(w){const S=!!w.before,R=w.values||[];return new nf(R,S)})(t.startAt));let x=null;return t.endAt&&(x=(function(w){const S=!w.before,R=w.values||[];return new nf(R,S)})(t.endAt)),Y4(e,o,d,u,p,"F",g,x)}function RR(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return st(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function y2(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=yo(t.unaryFilter.field);return Ts.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=yo(t.unaryFilter.field);return Ts.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=yo(t.unaryFilter.field);return Ts.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=yo(t.unaryFilter.field);return Ts.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return st(61313);default:return st(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ts.create(yo(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return st(58110);default:return st(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ba.create(t.compositeFilter.filters.map((i=>y2(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return st(1026)}})(t.compositeFilter.op))})(n):st(30097,{filter:n})}function IR(n){return yR[n]}function DR(n){return vR[n]}function MR(n){return wR[n]}function bo(n){return{fieldPath:n.canonicalString()}}function yo(n){return zs.fromServerFormat(n.fieldPath)}function v2(n){return n instanceof Ts?(function(t){if(t.op==="=="){if(Hw(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NAN"}};if(qw(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Hw(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NOT_NAN"}};if(qw(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bo(t.field),op:DR(t.op),value:t.value}}})(n):n instanceof ba?(function(t){const i=t.getFilters().map((o=>v2(o)));return i.length===1?i[0]:{compositeFilter:{op:MR(t.op),filters:i}}})(n):st(54877,{filter:n})}function OR(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function w2(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function N2(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class di{constructor(e,t,i,o,u=rt.min(),d=rt.min(),p=$s.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new di(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new di(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class PR{constructor(e){this.yt=e}}function VR(n){const e=CR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?L0(e,e.limit,"L"):e}class LR{constructor(){this.Sn=new UR}addToCollectionParentIndex(e,t){return this.Sn.add(t),ve.resolve()}getCollectionParents(e,t){return ve.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ve.resolve()}deleteFieldIndex(e,t){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,t){return ve.resolve()}getDocumentsMatchingTarget(e,t){return ve.resolve(null)}getIndexType(e,t){return ve.resolve(0)}getFieldIndexes(e,t){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,t){return ve.resolve(bi.min())}getMinOffsetFromCollectionGroup(e,t){return ve.resolve(bi.min())}updateCollectionGroup(e,t,i){return ve.resolve()}updateIndexEntries(e,t){return ve.resolve()}}class UR{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new Rs(Yt.comparator),u=!o.has(i);return this.index[t]=o.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new Rs(Yt.comparator)).toArray()}}const r1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_2=41943040;class gn{static withCacheSize(e){return new gn(e,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}gn.DEFAULT_COLLECTION_PERCENTILE=10,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gn.DEFAULT=new gn(_2,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gn.DISABLED=new gn(-1,0,0);class Mo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Mo(0)}static ar(){return new Mo(-1)}}const i1="LruGarbageCollector",BR=1048576;function l1([n,e],[t,i]){const o=vt(n,t);return o===0?vt(e,i):o}class zR{constructor(e){this.Pr=e,this.buffer=new Rs(l1),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();l1(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class FR{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Me(i1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Yo(t)?Me(i1,"Ignoring IndexedDB error during garbage collection: ",t):await Go(t)}await this.Ar(3e5)}))}}class $R{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return ve.resolve(Ef.ce);const i=new zR(t);return this.Vr.forEachTarget(e,(o=>i.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>i.Er(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Me("LruGarbageCollector","Garbage collection skipped; disabled"),ve.resolve(r1)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Me("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),r1):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,o,u,d,p,g,x;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(Me("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),o=this.params.maximumSequenceNumbersToCollect):o=w,d=Date.now(),this.nthSequenceNumber(e,o)))).next((w=>(i=w,p=Date.now(),this.removeTargets(e,i,t)))).next((w=>(u=w,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((w=>(x=Date.now(),go()<=yt.DEBUG&&Me("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${o} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${w} documents in `+(x-g)+`ms
Total Duration: ${x-b}ms`),ve.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:u,documentsRemoved:w}))))}}function qR(n,e){return new $R(n,e)}class HR{constructor(){this.changes=new El((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?ve.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class GR{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class YR{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&pu(i.mutation,o,Pn.empty(),It.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,wt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=wt()){const o=ol();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((u=>{let d=iu();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=ol();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,wt())))}populateOverlays(e,t,i){const o=[];return i.forEach((u=>{t.has(u)||o.push(u)})),this.documentOverlayCache.getOverlays(e,o).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,o){let u=Sr();const d=mu(),p=(function(){return mu()})();return t.forEach(((g,x)=>{const b=i.get(x.key);o.has(x.key)&&(b===void 0||b.mutation instanceof Ci)?u=u.insert(x.key,x):b!==void 0?(d.set(x.key,b.mutation.getFieldMask()),pu(b.mutation,x,b.mutation.getFieldMask(),It.now())):d.set(x.key,Pn.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((x,b)=>d.set(x,b))),t.forEach(((x,b)=>p.set(x,new GR(b,d.get(x)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=mu();let o=new as(((d,p)=>d-p)),u=wt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const x=t.get(g);if(x===null)return;let b=i.get(g)||Pn.empty();b=p.applyToLocalView(x,b),i.set(g,b);const w=(o.get(p.batchId)||wt()).add(g);o=o.insert(p.batchId,w)}))})).next((()=>{const d=[],p=o.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),x=g.key,b=g.value,w=a2();b.forEach((S=>{if(!u.has(S)){const R=u2(t.get(S),i.get(S));R!==null&&w.set(S,R),u=u.add(S)}})),d.push(this.documentOverlayCache.saveOverlays(e,x,w))}return ve.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return W4(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Z_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((u=>{const d=o-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-u.size):ve.resolve(ol());let p=Nu,g=u;return d.next((x=>ve.forEach(x,((b,w)=>(p<w.largestBatchId&&(p=w.largestBatchId),u.get(b)?ve.resolve():this.remoteDocumentCache.getEntry(e,b).next((S=>{g=g.insert(b,S)}))))).next((()=>this.populateOverlays(e,x,u))).next((()=>this.computeViews(e,g,x,wt()))).next((b=>({batchId:p,changes:n2(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Qe(t)).next((i=>{let o=iu();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const u=t.collectionGroup;let d=iu();return this.indexManager.getCollectionParents(e,u).next((p=>ve.forEach(p,(g=>{const x=(function(w,S){return new Bu(S,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,x,i,o).next((b=>{b.forEach(((w,S)=>{d=d.insert(w,S)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,o)))).next((d=>{u.forEach(((g,x)=>{const b=x.getKey();d.get(b)===null&&(d=d.insert(b,Qs.newInvalidDocument(b)))}));let p=iu();return d.forEach(((g,x)=>{const b=u.get(g);b!==void 0&&pu(b.mutation,x,Pn.empty(),It.now()),Rf(t,x)&&(p=p.insert(g,x))})),p}))}}class WR{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ve.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Ha(o.createTime)}})(t)),ve.resolve()}getNamedQuery(e,t){return ve.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(o){return{name:o.name,query:VR(o.bundledQuery),readTime:Ha(o.readTime)}})(t)),ve.resolve()}}class QR{constructor(){this.overlays=new as(Qe.comparator),this.Lr=new Map}getOverlay(e,t){return ve.resolve(this.overlays.get(t))}getOverlays(e,t){const i=ol();return ve.forEach(t,(o=>this.getOverlay(e,o).next((u=>{u!==null&&i.set(o,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,u)=>{this.bt(e,t,u)})),ve.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.Lr.get(i);return o!==void 0&&(o.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),ve.resolve()}getOverlaysForCollection(e,t,i){const o=ol(),u=t.length+1,d=new Qe(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,x=g.getKey();if(!t.isPrefixOf(x.path))break;x.path.length===u&&g.largestBatchId>i&&o.set(g.getKey(),g)}return ve.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let u=new as(((x,b)=>x-b));const d=this.overlays.getIterator();for(;d.hasNext();){const x=d.getNext().value;if(x.getKey().getCollectionGroup()===t&&x.largestBatchId>i){let b=u.get(x.largestBatchId);b===null&&(b=ol(),u=u.insert(x.largestBatchId,b)),b.set(x.getKey(),x)}}const p=ol(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((x,b)=>p.set(x,b))),!(p.size()>=o)););return ve.resolve(p)}bt(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const d=this.Lr.get(o.largestBatchId).delete(i.key);this.Lr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new fR(t,i));let u=this.Lr.get(t);u===void 0&&(u=wt(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class KR{constructor(){this.sessionToken=$s.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ve.resolve()}}class Lg{constructor(){this.kr=new Rs(Ms.Kr),this.qr=new Rs(Ms.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Ms(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Ms(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Qe(new Yt([])),i=new Ms(t,e),o=new Ms(t,e+1),u=[];return this.qr.forEachInRange([i,o],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Qe(new Yt([])),i=new Ms(t,e),o=new Ms(t,e+1);let u=wt();return this.qr.forEachInRange([i,o],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Ms(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Ms{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Qe.comparator(e.key,t.key)||vt(e.Hr,t.Hr)}static Ur(e,t){return vt(e.Hr,t.Hr)||Qe.comparator(e.key,t.key)}}class XR{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Rs(Ms.Kr)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new hR(u,t,i,o);this.mutationQueue.push(d);for(const p of o)this.Jr=this.Jr.add(new Ms(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return ve.resolve(d)}lookupMutationBatch(e,t){return ve.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.Xr(i),u=o<0?0:o;return ve.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?Ag:this.Yn-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Ms(t,0),o=new Ms(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,o],(d=>{const p=this.Zr(d.Hr);u.push(p)})),ve.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Rs(vt);return t.forEach((o=>{const u=new Ms(o,0),d=new Ms(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),ve.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let u=i;Qe.isDocumentKey(u)||(u=u.child(""));const d=new Ms(new Qe(u),0);let p=new Rs(vt);return this.Jr.forEachWhile((g=>{const x=g.key.path;return!!i.isPrefixOf(x)&&(x.length===o&&(p=p.add(g.Hr)),!0)}),d),ve.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const o=this.Zr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){Dt(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return ve.forEach(t.mutations,(o=>{const u=new Ms(o.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Ms(t,0),o=this.Jr.firstAfterOrEqual(i);return ve.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class JR{constructor(e){this.ti=e,this.docs=(function(){return new as(Qe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),u=o?o.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return ve.resolve(i?i.document.mutableCopy():Qs.newInvalidDocument(t))}getEntries(e,t){let i=Sr();return t.forEach((o=>{const u=this.docs.get(o);i=i.insert(o,u?u.document.mutableCopy():Qs.newInvalidDocument(o))})),ve.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let u=Sr();const d=t.path,p=new Qe(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:x,value:{document:b}}=g.getNext();if(!d.isPrefixOf(x.path))break;x.path.length>d.length+1||j4(_4(b),i)<=0||(o.has(b.key)||Rf(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return ve.resolve(u)}getAllFromCollectionGroup(e,t,i,o){st(9500)}ni(e,t){return ve.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new ZR(this)}getSize(e){return ve.resolve(this.size)}}class ZR extends HR{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(i)})),ve.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class e6{constructor(e){this.persistence=e,this.ri=new El((t=>Rg(t)),Ig),this.lastRemoteSnapshotVersion=rt.min(),this.highestTargetId=0,this.ii=0,this.si=new Lg,this.targetCount=0,this.oi=Mo._r()}forEachTarget(e,t){return this.ri.forEach(((i,o)=>t(o))),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),ve.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Mo(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ve.resolve()}updateTargetData(e,t){return this.lr(t),ve.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,t,i){let o=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),o++)})),ve.waitFor(u).next((()=>o))}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return ve.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),ve.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const o=this.persistence.referenceDelegate,u=[];return o&&t.forEach((d=>{u.push(o.markPotentiallyOrphaned(e,d))})),ve.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ve.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return ve.resolve(i)}containsKey(e,t){return ve.resolve(this.si.containsKey(t))}}class j2{constructor(e,t){this._i={},this.overlays={},this.ai=new Ef(0),this.ui=!1,this.ui=!0,this.ci=new KR,this.referenceDelegate=e(this),this.li=new e6(this),this.indexManager=new LR,this.remoteDocumentCache=(function(o){return new JR(o)})((i=>this.referenceDelegate.hi(i))),this.serializer=new PR(t),this.Pi=new WR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new QR,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new XR(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Me("MemoryPersistence","Starting transaction:",e);const o=new t6(this.ai.next());return this.referenceDelegate.Ti(),i(o).next((u=>this.referenceDelegate.Ii(o).next((()=>u)))).toPromise().then((u=>(o.raiseOnCommittedEvent(),u)))}Ei(e,t){return ve.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class t6 extends E4{constructor(e){super(),this.currentSequenceNumber=e}}class Ug{constructor(e){this.persistence=e,this.Ri=new Lg,this.Ai=null}static Vi(e){return new Ug(e)}get di(){if(this.Ai)return this.Ai;throw st(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),ve.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),ve.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ve.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((o=>this.di.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.di,(i=>{const o=Qe.fromPath(i);return this.mi(e,o).next((u=>{u||t.removeEntry(o,rt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return ve.or([()=>ve.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class of{constructor(e,t){this.persistence=e,this.fi=new El((i=>k4(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=qR(this,t)}static Vi(e,t){return new of(e,t)}Ti(){}Ii(e){return ve.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return ve.forEach(this.fi,((i,o)=>this.wr(e,i,o).next((u=>u?ve.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),u=o.newChangeBuffer();return o.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,rt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ve.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ve.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ve.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ve.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Oh(e.data.value)),t}wr(e,t,i){return ve.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.fi.get(t);return ve.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Bg{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=o}static Es(e,t){let i=wt(),o=wt();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:o=o.add(u.doc.key)}return new Bg(e,t.fromCache,i,o)}}class s6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class n6{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return R5()?8:T4(Xs())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,o,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new s6;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,o){return i.documentReadCount<this.Vs?(go()<=yt.DEBUG&&Me("QueryEngine","SDK will not create cache indexes for query:",xo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ve.resolve()):(go()<=yt.DEBUG&&Me("QueryEngine","Query:",xo(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.ds*o?(go()<=yt.DEBUG&&Me("QueryEngine","The SDK decides to create cache indexes for query:",xo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qa(t))):ve.resolve())}gs(e,t){if(Qw(t))return ve.resolve(null);let i=qa(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=L0(t,null,"F"),i=qa(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=wt(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const x=this.bs(t,p);return this.Ss(t,x,d,g.readTime)?this.gs(e,L0(t,null,"F")):this.Ds(e,x,t,g)}))))})))))}ps(e,t,i,o){return Qw(t)||o.isEqual(rt.min())?ve.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,o)?ve.resolve(null):(go()<=yt.DEBUG&&Me("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),xo(t)),this.Ds(e,d,t,N4(o,Nu)).next((p=>p)))}))}bs(e,t){let i=new Rs(t2(e));return t.forEach(((o,u)=>{Rf(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(o)>0)}ys(e,t,i){return go()<=yt.DEBUG&&Me("QueryEngine","Using full collection scan to execute query:",xo(t)),this.fs.getDocumentsMatchingQuery(e,t,bi.min(),i)}Ds(e,t,i,o){return this.fs.getDocumentsMatchingQuery(e,i,o).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const zg="LocalStore",a6=3e8;class r6{constructor(e,t,i,o){this.persistence=e,this.Cs=t,this.serializer=o,this.vs=new as(vt),this.Fs=new El((u=>Rg(u)),Ig),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YR(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function i6(n,e,t,i){return new r6(n,e,t,i)}async function S2(n,e){const t=ot(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((u=>(o=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=wt();for(const x of o){d.push(x.batchId);for(const b of x.mutations)g=g.add(b.key)}for(const x of u){p.push(x.batchId);for(const b of x.mutations)g=g.add(b.key)}return t.localDocuments.getDocuments(i,g).next((x=>({Ns:x,removedBatchIds:d,addedBatchIds:p})))}))}))}function l6(n,e){const t=ot(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,x,b){const w=x.batch,S=w.keys();let R=ve.resolve();return S.forEach((B=>{R=R.next((()=>b.getEntry(g,B))).next((V=>{const F=x.docVersions.get(B);Dt(F!==null,48541),V.version.compareTo(F)<0&&(w.applyToRemoteDocument(V,x),V.isValidDocument()&&(V.setReadTime(x.commitVersion),b.addEntry(V)))}))})),R.next((()=>p.mutationQueue.removeMutationBatch(g,w)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=wt();for(let x=0;x<p.mutationResults.length;++x)p.mutationResults[x].transformResults.length>0&&(g=g.add(p.batch.mutations[x].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,o)))}))}function E2(n){const e=ot(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function o6(n,e){const t=ot(n),i=e.snapshotVersion;let o=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});o=t.vs;const p=[];e.targetChanges.forEach(((b,w)=>{const S=o.get(w);if(!S)return;p.push(t.li.removeMatchingKeys(u,b.removedDocuments,w).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,w))));let R=S.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(w)!==null?R=R.withResumeToken($s.EMPTY_BYTE_STRING,rt.min()).withLastLimboFreeSnapshotVersion(rt.min()):b.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(b.resumeToken,i)),o=o.insert(w,R),(function(V,F,H){return V.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=a6?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0})(S,R,b)&&p.push(t.li.updateTargetData(u,R))}));let g=Sr(),x=wt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),p.push(c6(u,d,e.documentUpdates).next((b=>{g=b.Bs,x=b.Ls}))),!i.isEqual(rt.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((w=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(b)}return ve.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,x))).next((()=>g))})).then((u=>(t.vs=o,u)))}function c6(n,e,t){let i=wt(),o=wt();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=Sr();return t.forEach(((p,g)=>{const x=u.get(p);g.isFoundDocument()!==x.isFoundDocument()&&(o=o.add(p)),g.isNoDocument()&&g.version.isEqual(rt.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!x.isValidDocument()||g.version.compareTo(x.version)>0||g.version.compareTo(x.version)===0&&x.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):Me(zg,"Ignoring outdated watch update for ",p,". Current version:",x.version," Watch version:",g.version)})),{Bs:d,Ls:o}}))}function u6(n,e){const t=ot(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Ag),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function d6(n,e){const t=ot(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.li.getTargetData(i,e).next((u=>u?(o=u,ve.resolve(o)):t.li.allocateTargetId(i).next((d=>(o=new di(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.vs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function $0(n,e,t){const i=ot(n),o=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!Yo(d))throw d;Me(zg,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(o.target)}function o1(n,e,t){const i=ot(n);let o=rt.min(),u=wt();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,x,b){const w=ot(g),S=w.Fs.get(b);return S!==void 0?ve.resolve(w.vs.get(S)):w.li.getTargetData(x,b)})(i,d,qa(e)).next((p=>{if(p)return o=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?o:rt.min(),t?u:wt()))).next((p=>(h6(i,K4(e),p),{documents:p,ks:u})))))}function h6(n,e,t){let i=n.Ms.get(e)||rt.min();t.forEach(((o,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class c1{constructor(){this.activeTargetIds=sR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class f6{constructor(){this.vo=new c1,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new c1,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class m6{Mo(e){}shutdown(){}}const u1="ConnectivityMonitor";class d1{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Me(u1,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Me(u1,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let yh=null;function q0(){return yh===null?yh=(function(){return 268435456+Math.round(2147483648*Math.random())})():yh++,"0x"+yh.toString(16)}const l0="RestConnection",p6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class g6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${o}`,this.$o=this.databaseId.database===tf?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Wo(e,t,i,o,u){const d=q0(),p=this.Qo(e,t.toUriEncodedString());Me(l0,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,o,u);const{host:x}=new URL(p),b=Ei(x);return this.zo(e,p,g,i,b).then((w=>(Me(l0,`Received RPC '${e}' ${d}: `,w),w)),(w=>{throw Co(l0,`RPC '${e}' ${d} failed with error: `,w,"url: ",p,"request:",i),w}))}jo(e,t,i,o,u,d){return this.Wo(e,t,i,o,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ho})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,u)=>e[u]=o)),i&&i.headers.forEach(((o,u)=>e[u]=o))}Qo(e,t){const i=p6[e];let o=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class x6{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Ys="WebChannelConnection",Kc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(o){setTimeout((()=>{throw o}),0)}}))};class So extends g6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!So.c_){const e=R_();Kc(e,C_.STAT_EVENT,(t=>{t.stat===R0.PROXY?Me(Ys,"STAT_EVENT: detected buffering proxy"):t.stat===R0.NOPROXY&&Me(Ys,"STAT_EVENT: detected no buffering proxy")})),So.c_=!0}}zo(e,t,i,o,u){const d=q0();return new Promise(((p,g)=>{const x=new A_;x.setWithCredentials(!0),x.listenOnce(k_.COMPLETE,(()=>{try{switch(x.getLastErrorCode()){case Mh.NO_ERROR:const w=x.getResponseJson();Me(Ys,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(w)),p(w);break;case Mh.TIMEOUT:Me(Ys,`RPC '${e}' ${d} timed out`),g(new Ie(ye.DEADLINE_EXCEEDED,"Request time out"));break;case Mh.HTTP_ERROR:const S=x.getStatus();if(Me(Ys,`RPC '${e}' ${d} failed with status:`,S,"response text:",x.getResponseText()),S>0){let R=x.getResponseJson();Array.isArray(R)&&(R=R[0]);const B=R?.error;if(B&&B.status&&B.message){const V=(function(H){const W=H.toLowerCase().replace(/_/g,"-");return Object.values(ye).indexOf(W)>=0?W:ye.UNKNOWN})(B.status);g(new Ie(V,B.message))}else g(new Ie(ye.UNKNOWN,"Server responded with status "+x.getStatus()))}else g(new Ie(ye.UNAVAILABLE,"Connection failed."));break;default:st(9055,{l_:e,streamId:d,h_:x.getLastErrorCode(),P_:x.getLastError()})}}finally{Me(Ys,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(o);Me(Ys,`RPC '${e}' ${d} sending request:`,o),x.send(t,"POST",b,i,15)}))}T_(e,t,i){const o=q0(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const x=u.join("");Me(Ys,`Creating RPC '${e}' stream ${o}: ${x}`,p);const b=d.createWebChannel(x,p);this.I_(b);let w=!1,S=!1;const R=new x6({Ho:B=>{S?Me(Ys,`Not sending because RPC '${e}' stream ${o} is closed:`,B):(w||(Me(Ys,`Opening RPC '${e}' stream ${o} transport.`),b.open(),w=!0),Me(Ys,`RPC '${e}' stream ${o} sending:`,B),b.send(B))},Jo:()=>b.close()});return Kc(b,ru.EventType.OPEN,(()=>{S||(Me(Ys,`RPC '${e}' stream ${o} transport opened.`),R.i_())})),Kc(b,ru.EventType.CLOSE,(()=>{S||(S=!0,Me(Ys,`RPC '${e}' stream ${o} transport closed`),R.o_(),this.E_(b))})),Kc(b,ru.EventType.ERROR,(B=>{S||(S=!0,Co(Ys,`RPC '${e}' stream ${o} transport errored. Name:`,B.name,"Message:",B.message),R.o_(new Ie(ye.UNAVAILABLE,"The operation could not be completed")))})),Kc(b,ru.EventType.MESSAGE,(B=>{if(!S){const V=B.data[0];Dt(!!V,16349);const F=V,H=F?.error||F[0]?.error;if(H){Me(Ys,`RPC '${e}' stream ${o} received error:`,H);const W=H.status;let z=(function(Y){const A=Es[Y];if(A!==void 0)return h2(A)})(W),ie=H.message;z===void 0&&(z=ye.INTERNAL,ie="Unknown error status: "+W+" with message "+H.message),S=!0,R.o_(new Ie(z,ie)),b.close()}else Me(Ys,`RPC '${e}' stream ${o} received:`,V),R.__(V)}})),So.u_(),setTimeout((()=>{R.s_()}),0),R}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return I_()}}function b6(n){return new So(n)}function o0(){return typeof document<"u"?document:null}function Of(n){return new NR(n,!0)}So.c_=!1;class T2{constructor(e,t,i=1e3,o=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=o,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&Me("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const h1="PersistentStream";class A2{constructor(e,t,i,o,u,d,p,g){this.Ci=e,this.b_=i,this.S_=o,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new T2(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ye.RESOURCE_EXHAUSTED?(jr(t.toString()),jr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ye.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new Ie(ye.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Me(h1,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Me(h1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class y6 extends A2{constructor(e,t,i,o,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=SR(this.serializer,e),i=(function(u){if(!("targetChange"in u))return rt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?rt.min():d.readTime?Ha(d.readTime):rt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=F0(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=P0(g)?{documents:AR(u,g)}:{query:kR(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=p2(u,d.resumeToken);const x=U0(u,d.expectedCount);x!==null&&(p.expectedCount=x)}else if(d.snapshotVersion.compareTo(rt.min())>0){p.readTime=lf(u,d.snapshotVersion.toTimestamp());const x=U0(u,d.expectedCount);x!==null&&(p.expectedCount=x)}return p})(this.serializer,e);const i=RR(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=F0(this.serializer),t.removeTarget=e,this.K_(t)}}class v6 extends A2{constructor(e,t,i,o,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Dt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Dt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Dt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=TR(e.writeResults,e.commitTime),i=Ha(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=F0(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>ER(this.serializer,i)))};this.K_(t)}}class w6{}class N6 extends w6{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ie(ye.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,B0(t,i),o,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ie(ye.UNKNOWN,u.toString())}))}jo(e,t,i,o,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,B0(t,i),o,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Ie(ye.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function _6(n,e,t,i){return new N6(n,e,t,i)}class j6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(jr(t),this.aa=!1):Me("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const bl="RemoteStore";class S6{constructor(e,t,i,o,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{Tl(this)&&(Me(bl,"Restarting streams for network reachability change."),await(async function(g){const x=ot(g);x.Ea.add(4),await $u(x),x.Va.set("Unknown"),x.Ea.delete(4),await Pf(x)})(this))}))})),this.Va=new j6(i,o)}}async function Pf(n){if(Tl(n))for(const e of n.Ra)await e(!0)}async function $u(n){for(const e of n.Ra)await e(!1)}function k2(n,e){const t=ot(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Hg(t)?qg(t):Wo(t).O_()&&$g(t,e))}function Fg(n,e){const t=ot(n),i=Wo(t);t.Ia.delete(e),i.O_()&&C2(t,e),t.Ia.size===0&&(i.O_()?i.L_():Tl(t)&&t.Va.set("Unknown"))}function $g(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(rt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Wo(n).Z_(e)}function C2(n,e){n.da.$e(e),Wo(n).X_(e)}function qg(n){n.da=new bR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Wo(n).start(),n.Va.ua()}function Hg(n){return Tl(n)&&!Wo(n).x_()&&n.Ia.size>0}function Tl(n){return ot(n).Ea.size===0}function R2(n){n.da=void 0}async function E6(n){n.Va.set("Online")}async function T6(n){n.Ia.forEach(((e,t)=>{$g(n,e)}))}async function A6(n,e){R2(n),Hg(n)?(n.Va.ha(e),qg(n)):n.Va.set("Unknown")}async function k6(n,e,t){if(n.Va.set("Online"),e instanceof m2&&e.state===2&&e.cause)try{await(async function(o,u){const d=u.cause;for(const p of u.targetIds)o.Ia.has(p)&&(await o.remoteSyncer.rejectListen(p,d),o.Ia.delete(p),o.da.removeTarget(p))})(n,e)}catch(i){Me(bl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await cf(n,i)}else if(e instanceof Lh?n.da.Xe(e):e instanceof f2?n.da.st(e):n.da.tt(e),!t.isEqual(rt.min()))try{const i=await E2(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,x)=>{if(g.resumeToken.approximateByteSize()>0){const b=u.Ia.get(x);b&&u.Ia.set(x,b.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,x)=>{const b=u.Ia.get(g);if(!b)return;u.Ia.set(g,b.withResumeToken($s.EMPTY_BYTE_STRING,b.snapshotVersion)),C2(u,g);const w=new di(b.target,g,x,b.sequenceNumber);$g(u,w)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){Me(bl,"Failed to raise snapshot:",i),await cf(n,i)}}async function cf(n,e,t){if(!Yo(e))throw e;n.Ea.add(1),await $u(n),n.Va.set("Offline"),t||(t=()=>E2(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Me(bl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Pf(n)}))}function I2(n,e){return e().catch((t=>cf(n,t,e)))}async function Vf(n){const e=ot(n),t=Ni(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ag;for(;C6(e);)try{const o=await u6(e.localStore,i);if(o===null){e.Ta.length===0&&t.L_();break}i=o.batchId,R6(e,o)}catch(o){await cf(e,o)}D2(e)&&M2(e)}function C6(n){return Tl(n)&&n.Ta.length<10}function R6(n,e){n.Ta.push(e);const t=Ni(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function D2(n){return Tl(n)&&!Ni(n).x_()&&n.Ta.length>0}function M2(n){Ni(n).start()}async function I6(n){Ni(n).ra()}async function D6(n){const e=Ni(n);for(const t of n.Ta)e.ea(t.mutations)}async function M6(n,e,t){const i=n.Ta.shift(),o=Og.from(i,e,t);await I2(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await Vf(n)}async function O6(n,e){e&&Ni(n).Y_&&await(async function(i,o){if((function(d){return pR(d)&&d!==ye.ABORTED})(o.code)){const u=i.Ta.shift();Ni(i).B_(),await I2(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,o))),await Vf(i)}})(n,e),D2(n)&&M2(n)}async function f1(n,e){const t=ot(n);t.asyncQueue.verifyOperationInProgress(),Me(bl,"RemoteStore received new credentials");const i=Tl(t);t.Ea.add(3),await $u(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Pf(t)}async function P6(n,e){const t=ot(n);e?(t.Ea.delete(2),await Pf(t)):e||(t.Ea.add(2),await $u(t),t.Va.set("Unknown"))}function Wo(n){return n.ma||(n.ma=(function(t,i,o){const u=ot(t);return u.sa(),new y6(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(n.datastore,n.asyncQueue,{Zo:E6.bind(null,n),Yo:T6.bind(null,n),t_:A6.bind(null,n),J_:k6.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),Hg(n)?qg(n):n.Va.set("Unknown")):(await n.ma.stop(),R2(n))}))),n.ma}function Ni(n){return n.fa||(n.fa=(function(t,i,o){const u=ot(t);return u.sa(),new v6(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:I6.bind(null,n),t_:O6.bind(null,n),ta:D6.bind(null,n),na:M6.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Vf(n)):(await n.fa.stop(),n.Ta.length>0&&(Me(bl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Gg{constructor(e,t,i,o,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=u,this.deferred=new vr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,u){const d=Date.now()+i,p=new Gg(e,t,d,o,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(ye.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yg(n,e){if(jr("AsyncQueue",`${e}: ${n}`),Yo(n))return new Ie(ye.UNAVAILABLE,`${e}: ${n}`);throw n}class Eo{static emptySet(e){return new Eo(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Qe.comparator(t.key,i.key):(t,i)=>Qe.comparator(t.key,i.key),this.keyedMap=iu(),this.sortedSet=new as(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Eo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,u=i.getNext().key;if(!o.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Eo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class m1{constructor(){this.ga=new as(Qe.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):st(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Oo{constructor(e,t,i,o,u,d,p,g,x){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=x}static fromInitialDocuments(e,t,i,o,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new Oo(e,t,Eo.emptySet(t),d,i,o,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Cf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}class V6{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class L6{constructor(){this.queries=p1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=ot(t),u=o.queries;o.queries=p1(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new Ie(ye.ABORTED,"Firestore shutting down"))}}function p1(){return new El((n=>e2(n)),Cf)}async function Wg(n,e){const t=ot(n);let i=3;const o=e.query;let u=t.queries.get(o);u?!u.Sa()&&e.Da()&&(i=2):(u=new V6,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(o,!0);break;case 1:u.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const p=Yg(d,`Initialization of query '${xo(e.query)}' failed`);return void e.onError(p)}t.queries.set(o,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Kg(t)}async function Qg(n,e){const t=ot(n),i=e.query;let o=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?o=e.Da()?0:1:!u.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function U6(n,e){const t=ot(n);let i=!1;for(const o of e){const u=o.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(o)&&(i=!0);d.wa=o}}i&&Kg(t)}function B6(n,e,t){const i=ot(n),o=i.queries.get(e);if(o)for(const u of o.ba)u.onError(t);i.queries.delete(e)}function Kg(n){n.Ca.forEach((e=>{e.next()}))}var H0,g1;(g1=H0||(H0={})).Ma="default",g1.Cache="cache";class Xg{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new Oo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Oo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==H0.Cache}}class O2{constructor(e){this.key=e}}class P2{constructor(e){this.key=e}}class z6{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=wt(),this.mutatedKeys=wt(),this.eu=t2(e),this.tu=new Eo(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new m1,o=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=o,p=!1;const g=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,x=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,w)=>{const S=o.get(b),R=Rf(this.query,w)?w:null,B=!!S&&this.mutatedKeys.has(S.key),V=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let F=!1;S&&R?S.data.isEqual(R.data)?B!==V&&(i.track({type:3,doc:R}),F=!0):this.su(S,R)||(i.track({type:2,doc:R}),F=!0,(g&&this.eu(R,g)>0||x&&this.eu(R,x)<0)&&(p=!0)):!S&&R?(i.track({type:0,doc:R}),F=!0):S&&!R&&(i.track({type:1,doc:S}),F=!0,(g||x)&&(p=!0)),F&&(R?(d=d.add(R),u=V?u.add(b):u.delete(b)):(d=d.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,w)=>(function(R,B){const V=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return st(20277,{Vt:F})}};return V(R)-V(B)})(b.type,w.type)||this.eu(b.doc,w.doc))),this.ou(i),o=o??!1;const p=t&&!o?this._u():[],g=this.Ya.size===0&&this.current&&!o?1:0,x=g!==this.Xa;return this.Xa=g,d.length!==0||x?{snapshot:new Oo(this.query,e.tu,u,d,e.mutatedKeys,g===0,x,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new m1,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=wt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new P2(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new O2(i))})),t}cu(e){this.Za=e.ks,this.Ya=wt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Oo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Jg="SyncEngine";class F6{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class $6{constructor(e){this.key=e,this.hu=!1}}class q6{constructor(e,t,i,o,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new El((p=>e2(p)),Cf),this.Iu=new Map,this.Eu=new Set,this.Ru=new as(Qe.comparator),this.Au=new Map,this.Vu=new Lg,this.du={},this.mu=new Map,this.fu=Mo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function H6(n,e,t=!0){const i=F2(n);let o;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),o=u.view.lu()):o=await V2(i,e,t,!0),o}async function G6(n,e){const t=F2(n);await V2(t,e,!0,!1)}async function V2(n,e,t,i){const o=await d6(n.localStore,qa(e)),u=o.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await Y6(n,e,u,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&k2(n.remoteStore,o),p}async function Y6(n,e,t,i,o){n.pu=(w,S,R)=>(async function(V,F,H,W){let z=F.view.ru(H);z.Ss&&(z=await o1(V.localStore,F.query,!1).then((({documents:A})=>F.view.ru(A,z))));const ie=W&&W.targetChanges.get(F.targetId),ae=W&&W.targetMismatches.get(F.targetId)!=null,Y=F.view.applyChanges(z,V.isPrimaryClient,ie,ae);return b1(V,F.targetId,Y.au),Y.snapshot})(n,w,S,R);const u=await o1(n.localStore,e,!0),d=new z6(e,u.ks),p=d.ru(u.documents),g=Fu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),x=d.applyChanges(p,n.isPrimaryClient,g);b1(n,t,x.au);const b=new F6(e,t,d);return n.Tu.set(e,b),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),x.snapshot}async function W6(n,e,t){const i=ot(n),o=i.Tu.get(e),u=i.Iu.get(o.targetId);if(u.length>1)return i.Iu.set(o.targetId,u.filter((d=>!Cf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await $0(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&Fg(i.remoteStore,o.targetId),G0(i,o.targetId)})).catch(Go)):(G0(i,o.targetId),await $0(i.localStore,o.targetId,!0))}async function Q6(n,e){const t=ot(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Fg(t.remoteStore,i.targetId))}async function K6(n,e,t){const i=n3(n);try{const o=await(function(d,p){const g=ot(d),x=It.now(),b=p.reduce(((R,B)=>R.add(B.key)),wt());let w,S;return g.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let B=Sr(),V=wt();return g.xs.getEntries(R,b).next((F=>{B=F,B.forEach(((H,W)=>{W.isValidDocument()||(V=V.add(H))}))})).next((()=>g.localDocuments.getOverlayedDocuments(R,B))).next((F=>{w=F;const H=[];for(const W of p){const z=uR(W,w.get(W.key).overlayedDocument);z!=null&&H.push(new Ci(W.key,z,G_(z.value.mapValue),ta.exists(!0)))}return g.mutationQueue.addMutationBatch(R,x,H,p)})).next((F=>{S=F;const H=F.applyToLocalDocumentSet(w,V);return g.documentOverlayCache.saveOverlays(R,F.batchId,H)}))})).then((()=>({batchId:S.batchId,changes:n2(w)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(d,p,g){let x=d.du[d.currentUser.toKey()];x||(x=new as(vt)),x=x.insert(p,g),d.du[d.currentUser.toKey()]=x})(i,o.batchId,t),await qu(i,o.changes),await Vf(i.remoteStore)}catch(o){const u=Yg(o,"Failed to persist write");t.reject(u)}}async function L2(n,e){const t=ot(n);try{const i=await o6(t.localStore,e);e.targetChanges.forEach(((o,u)=>{const d=t.Au.get(u);d&&(Dt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?Dt(d.hu,14607):o.removedDocuments.size>0&&(Dt(d.hu,42227),d.hu=!1))})),await qu(t,i,e)}catch(i){await Go(i)}}function x1(n,e,t){const i=ot(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&o.push(p.snapshot)})),(function(d,p){const g=ot(d);g.onlineState=p;let x=!1;g.queries.forEach(((b,w)=>{for(const S of w.ba)S.va(p)&&(x=!0)})),x&&Kg(g)})(i.eventManager,e),o.length&&i.Pu.J_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function X6(n,e,t){const i=ot(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),u=o&&o.key;if(u){let d=new as(Qe.comparator);d=d.insert(u,Qs.newNoDocument(u,rt.min()));const p=wt().add(u),g=new Mf(rt.min(),new Map,new as(vt),d,p);await L2(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Zg(i)}else await $0(i.localStore,e,!1).then((()=>G0(i,e,t))).catch(Go)}async function J6(n,e){const t=ot(n),i=e.batch.batchId;try{const o=await l6(t.localStore,e);B2(t,i,null),U2(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await qu(t,o)}catch(o){await Go(o)}}async function Z6(n,e,t){const i=ot(n);try{const o=await(function(d,p){const g=ot(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(x=>{let b;return g.mutationQueue.lookupMutationBatch(x,p).next((w=>(Dt(w!==null,37113),b=w.keys(),g.mutationQueue.removeMutationBatch(x,w)))).next((()=>g.mutationQueue.performConsistencyCheck(x))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(x,b,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(x,b))).next((()=>g.localDocuments.getDocuments(x,b)))}))})(i.localStore,e);B2(i,e,t),U2(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await qu(i,o)}catch(o){await Go(o)}}function U2(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function B2(n,e,t){const i=ot(n);let o=i.du[i.currentUser.toKey()];if(o){const u=o.get(e);u&&(t?u.reject(t):u.resolve(),o=o.remove(e)),i.du[i.currentUser.toKey()]=o}}function G0(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||z2(n,i)}))}function z2(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(Fg(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Zg(n))}function b1(n,e,t){for(const i of t)i instanceof O2?(n.Vu.addReference(i.key,e),e3(n,i)):i instanceof P2?(Me(Jg,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||z2(n,i.key)):st(19791,{wu:i})}function e3(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(Me(Jg,"New document in limbo: "+t),n.Eu.add(i),Zg(n))}function Zg(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Qe(Yt.fromString(e)),i=n.fu.next();n.Au.set(i,new $6(t)),n.Ru=n.Ru.insert(t,i),k2(n.remoteStore,new di(qa(kf(t.path)),i,"TargetPurposeLimboResolution",Ef.ce))}}async function qu(n,e,t){const i=ot(n),o=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((x=>{if((x||t)&&i.isPrimaryClient){const b=x?!x.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,b?"current":"not-current")}if(x){o.push(x);const b=Bg.Es(g.targetId,x);u.push(b)}})))})),await Promise.all(d),i.Pu.J_(o),await(async function(g,x){const b=ot(g);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>ve.forEach(x,(S=>ve.forEach(S.Ts,(R=>b.persistence.referenceDelegate.addReference(w,S.targetId,R))).next((()=>ve.forEach(S.Is,(R=>b.persistence.referenceDelegate.removeReference(w,S.targetId,R)))))))))}catch(w){if(!Yo(w))throw w;Me(zg,"Failed to update sequence numbers: "+w)}for(const w of x){const S=w.targetId;if(!w.fromCache){const R=b.vs.get(S),B=R.snapshotVersion,V=R.withLastLimboFreeSnapshotVersion(B);b.vs=b.vs.insert(S,V)}}})(i.localStore,u))}async function t3(n,e){const t=ot(n);if(!t.currentUser.isEqual(e)){Me(Jg,"User change. New user:",e.toKey());const i=await S2(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new Ie(ye.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await qu(t,i.Ns)}}function s3(n,e){const t=ot(n),i=t.Au.get(e);if(i&&i.hu)return wt().add(i.key);{let o=wt();const u=t.Iu.get(e);if(!u)return o;for(const d of u){const p=t.Tu.get(d);o=o.unionWith(p.view.nu)}return o}}function F2(n){const e=ot(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=L2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=s3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=X6.bind(null,e),e.Pu.J_=U6.bind(null,e.eventManager),e.Pu.yu=B6.bind(null,e.eventManager),e}function n3(n){const e=ot(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=J6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Z6.bind(null,e),e}class uf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Of(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return i6(this.persistence,new n6,e.initialUser,this.serializer)}Cu(e){return new j2(Ug.Vi,this.serializer)}Du(e){return new f6}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}uf.provider={build:()=>new uf};class a3 extends uf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Dt(this.persistence.referenceDelegate instanceof of,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new FR(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?gn.withCacheSize(this.cacheSizeBytes):gn.DEFAULT;return new j2((i=>of.Vi(i,t)),this.serializer)}}class Y0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>x1(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=t3.bind(null,this.syncEngine),await P6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new L6})()}createDatastore(e){const t=Of(e.databaseInfo.databaseId),i=b6(e.databaseInfo);return _6(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,u,d,p){return new S6(i,o,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>x1(this.syncEngine,t,0)),(function(){return d1.v()?new d1:new m6})())}createSyncEngine(e,t){return(function(o,u,d,p,g,x,b){const w=new q6(o,u,d,p,g,x);return b&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=ot(t);Me(bl,"RemoteStore shutting down."),i.Ea.add(5),await $u(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Y0.provider={build:()=>new Y0};class ex{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):jr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const _i="FirestoreClient";class r3{constructor(e,t,i,o,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=o,this.user=Ws.UNAUTHENTICATED,this.clientId=Tg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{Me(_i,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Me(_i,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Yg(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function c0(n,e){n.asyncQueue.verifyOperationInProgress(),Me(_i,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await S2(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function y1(n,e){n.asyncQueue.verifyOperationInProgress();const t=await i3(n);Me(_i,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>f1(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>f1(e.remoteStore,o))),n._onlineComponents=e}async function i3(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Me(_i,"Using user provided OfflineComponentProvider");try{await c0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ye.FAILED_PRECONDITION||o.code===ye.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Co("Error using user provided cache. Falling back to memory cache: "+t),await c0(n,new uf)}}else Me(_i,"Using default OfflineComponentProvider"),await c0(n,new a3(void 0));return n._offlineComponents}async function $2(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Me(_i,"Using user provided OnlineComponentProvider"),await y1(n,n._uninitializedComponentsProvider._online)):(Me(_i,"Using default OnlineComponentProvider"),await y1(n,new Y0))),n._onlineComponents}function l3(n){return $2(n).then((e=>e.syncEngine))}async function df(n){const e=await $2(n),t=e.eventManager;return t.onListen=H6.bind(null,e.syncEngine),t.onUnlisten=W6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=G6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Q6.bind(null,e.syncEngine),t}function o3(n,e,t,i){const o=new ex(i),u=new Xg(e,o,t);return n.asyncQueue.enqueueAndForget((async()=>Wg(await df(n),u))),()=>{o.Nu(),n.asyncQueue.enqueueAndForget((async()=>Qg(await df(n),u)))}}function c3(n,e,t={}){const i=new vr;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,x){const b=new ex({next:S=>{b.Nu(),d.enqueueAndForget((()=>Qg(u,w)));const R=S.docs.has(p);!R&&S.fromCache?x.reject(new Ie(ye.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&S.fromCache&&g&&g.source==="server"?x.reject(new Ie(ye.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):x.resolve(S)},error:S=>x.reject(S)}),w=new Xg(kf(p.path),b,{includeMetadataChanges:!0,Ka:!0});return Wg(u,w)})(await df(n),n.asyncQueue,e,t,i))),i.promise}function u3(n,e,t={}){const i=new vr;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,x){const b=new ex({next:S=>{b.Nu(),d.enqueueAndForget((()=>Qg(u,w))),S.fromCache&&g.source==="server"?x.reject(new Ie(ye.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):x.resolve(S)},error:S=>x.reject(S)}),w=new Xg(p,b,{includeMetadataChanges:!0,Ka:!0});return Wg(u,w)})(await df(n),n.asyncQueue,e,t,i))),i.promise}function d3(n,e){const t=new vr;return n.asyncQueue.enqueueAndForget((async()=>K6(await l3(n),e,t))),t.promise}function q2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const h3="ComponentProvider",v1=new Map;function f3(n,e,t,i,o){return new I4(n,e,t,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,q2(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,i)}const H2="firestore.googleapis.com",w1=!0;class N1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(ye.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=H2,this.ssl=w1}else this.host=e.host,this.ssl=e.ssl??w1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=_2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<BR)throw new Ie(ye.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}w4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=q2(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ie(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ie(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ie(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Lf{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new N1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(ye.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(ye.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new N1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new d4;switch(i.type){case"firstParty":return new p4(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ie(ye.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=v1.get(t);i&&(Me(h3,"Removing Datastore"),v1.delete(t),i.terminate())})(this),Promise.resolve()}}function m3(n,e,t,i={}){n=vn(n,Lf);const o=Ei(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;o&&(fg(`https://${p}`),mg("Firestore",!0)),u.host!==H2&&u.host!==p&&Co("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:o,emulatorOptions:i};if(!fl(g,d)&&(n._setSettings(g),i.mockUserToken)){let x,b;if(typeof i.mockUserToken=="string")x=i.mockUserToken,b=Ws.MOCK_USER;else{x=UN(i.mockUserToken,n._app?.options.projectId);const w=i.mockUserToken.sub||i.mockUserToken.user_id;if(!w)throw new Ie(ye.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Ws(w)}n._authCredentials=new h4(new M_(x,b))}}class Al{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Al(this.firestore,e,this._query)}}class cs{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cs(this.firestore,e,this._key)}toJSON(){return{type:cs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Uu(t,cs._jsonSchema))return new cs(e,i||null,new Qe(Yt.fromString(t.referencePath)))}}cs._jsonSchemaVersion="firestore/documentReference/1.0",cs._jsonSchema={type:As("string",cs._jsonSchemaVersion),referencePath:As("string")};class pi extends Al{constructor(e,t,i){super(e,t,kf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cs(this.firestore,null,new Qe(e))}withConverter(e){return new pi(this.firestore,e,this._path)}}function Ze(n,e,...t){if(n=ss(n),O_("collection","path",e),n instanceof Lf){const i=Yt.fromString(e,...t);return Ow(i),new pi(n,null,i)}{if(!(n instanceof cs||n instanceof pi))throw new Ie(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Yt.fromString(e,...t));return Ow(i),new pi(n.firestore,null,i)}}function Xe(n,e,...t){if(n=ss(n),arguments.length===1&&(e=Tg.newId()),O_("doc","path",e),n instanceof Lf){const i=Yt.fromString(e,...t);return Mw(i),new cs(n,null,new Qe(i))}{if(!(n instanceof cs||n instanceof pi))throw new Ie(ye.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Yt.fromString(e,...t));return Mw(i),new cs(n.firestore,n instanceof pi?n.converter:null,new Qe(i))}}const _1="AsyncQueue";class j1{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new T2(this,"async_queue_retry"),this._c=()=>{const i=o0();i&&Me(_1,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=o0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=o0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new vr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Yo(e))throw e;Me(_1,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,jr("INTERNAL UNHANDLED ERROR: ",S1(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=Gg.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(o),o}uc(){this.nc&&st(47125,{Pc:S1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function S1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Er extends Lf{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new j1,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new j1(e),this._firestoreClient=void 0,await e}}}function p3(n,e){const t=typeof n=="object"?n:xg(),i=typeof n=="string"?n:tf,o=wf(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const u=PN("firestore");u&&m3(o,...u)}return o}function Uf(n){if(n._terminated)throw new Ie(ye.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||g3(n),n._firestoreClient}function g3(n){const e=n._freezeSettings(),t=f3(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new r3(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(o){const u=o?._online.build();return{_offline:o?._offline.build(u),_online:u}})(n._componentsProvider))}class Zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zn($s.fromBase64String(e))}catch(t){throw new Ie(ye.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Zn($s.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Zn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Uu(e,Zn._jsonSchema))return Zn.fromBase64String(e.bytes)}}Zn._jsonSchemaVersion="firestore/bytes/1.0",Zn._jsonSchema={type:As("string",Zn._jsonSchemaVersion),bytes:As("string")};class tx{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ie(ye.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Bf{constructor(e){this._methodName=e}}class Ga{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ie(ye.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ie(ye.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ga._jsonSchemaVersion}}static fromJSON(e){if(Uu(e,Ga._jsonSchema))return new Ga(e.latitude,e.longitude)}}Ga._jsonSchemaVersion="firestore/geoPoint/1.0",Ga._jsonSchema={type:As("string",Ga._jsonSchemaVersion),latitude:As("number"),longitude:As("number")};class pa{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==o[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:pa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Uu(e,pa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new pa(e.vectorValues);throw new Ie(ye.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}pa._jsonSchemaVersion="firestore/vectorValue/1.0",pa._jsonSchema={type:As("string",pa._jsonSchemaVersion),vectorValues:As("object")};const x3=/^__.*__$/;class b3{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ci(e,this.data,this.fieldMask,t,this.fieldTransforms):new zu(e,this.data,t,this.fieldTransforms)}}class G2{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Ci(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Y2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw st(40011,{dataSource:n})}}class sx{constructor(e,t,i,o,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new sx({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return hf(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Y2(this.dataSource)&&x3.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class y3{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Of(e)}createContext(e,t,i,o=!1){return new sx({dataSource:e,methodName:t,targetDoc:i,path:zs.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zf(n){const e=n._freezeSettings(),t=Of(n._databaseId);return new y3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function W2(n,e,t,i,o,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,o);ax("Data must be an object, but it was:",d,i);const p=Q2(i,d);let g,x;if(u.merge)g=new Pn(d.fieldMask),x=d.fieldTransforms;else if(u.mergeFields){const b=[];for(const w of u.mergeFields){const S=Po(e,w,t);if(!d.contains(S))throw new Ie(ye.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);J2(b,S)||b.push(S)}g=new Pn(b),x=d.fieldTransforms.filter((w=>g.covers(w.field)))}else g=null,x=d.fieldTransforms;return new b3(new xn(p),g,x)}class Ff extends Bf{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ff}}class nx extends Bf{_toFieldTransform(e){return new iR(e.path,new Eu)}isEqual(e){return e instanceof nx}}function v3(n,e,t,i){const o=n.createContext(1,e,t);ax("Data must be an object, but it was:",o,i);const u=[],d=xn.empty();ki(i,((g,x)=>{const b=X2(e,g,t);x=ss(x);const w=o.childContextForFieldPath(b);if(x instanceof Ff)u.push(b);else{const S=Hu(x,w);S!=null&&(u.push(b),d.set(b,S))}}));const p=new Pn(u);return new G2(d,p,o.fieldTransforms)}function w3(n,e,t,i,o,u){const d=n.createContext(1,e,t),p=[Po(e,i,t)],g=[o];if(u.length%2!=0)throw new Ie(ye.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<u.length;S+=2)p.push(Po(e,u[S])),g.push(u[S+1]);const x=[],b=xn.empty();for(let S=p.length-1;S>=0;--S)if(!J2(x,p[S])){const R=p[S];let B=g[S];B=ss(B);const V=d.childContextForFieldPath(R);if(B instanceof Ff)x.push(R);else{const F=Hu(B,V);F!=null&&(x.push(R),b.set(R,F))}}const w=new Pn(x);return new G2(b,w,d.fieldTransforms)}function N3(n,e,t,i=!1){return Hu(t,n.createContext(i?4:3,e))}function Hu(n,e){if(K2(n=ss(n)))return ax("Unsupported field value:",e,n),Q2(n,e);if(n instanceof Bf)return(function(i,o){if(!Y2(o.dataSource))throw o.createError(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(o);u&&o.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,o){const u=[];let d=0;for(const p of i){let g=Hu(p,o.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,o){if((i=ss(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return nR(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=It.fromDate(i);return{timestampValue:lf(o.serializer,u)}}if(i instanceof It){const u=new It(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:lf(o.serializer,u)}}if(i instanceof Ga)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Zn)return{bytesValue:p2(o.serializer,i._byteString)};if(i instanceof cs){const u=o.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw o.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Vg(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof pa)return(function(d,p){const g=d instanceof pa?d.toArray():d;return{mapValue:{fields:{[q_]:{stringValue:H_},[sf]:{arrayValue:{values:g.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return Dg(p.serializer,b)}))}}}}}})(i,o);if(N2(i))return i._toProto(o.serializer);throw o.createError(`Unsupported field value: ${Sf(i)}`)})(n,e)}function Q2(n,e){const t={};return L_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ki(n,((i,o)=>{const u=Hu(o,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function K2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof It||n instanceof Ga||n instanceof Zn||n instanceof cs||n instanceof Bf||n instanceof pa||N2(n))}function ax(n,e,t){if(!K2(t)||!P_(t)){const i=Sf(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Po(n,e,t){if((e=ss(e))instanceof tx)return e._internalPath;if(typeof e=="string")return X2(n,e);throw hf("Field path arguments must be of type string or ",n,!1,void 0,t)}const _3=new RegExp("[~\\*/\\[\\]]");function X2(n,e,t){if(e.search(_3)>=0)throw hf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new tx(...e.split("."))._internalPath}catch{throw hf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function hf(n,e,t,i,o){const u=i&&!i.isEmpty(),d=o!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${o}`),g+=")"),new Ie(ye.INVALID_ARGUMENT,p+n+g)}function J2(n,e){return n.some((t=>t.isEqual(e)))}class j3{convertValue(e,t="none"){switch(wi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ps(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(vi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw st(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return ki(e,((o,u)=>{i[o]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[sf].arrayValue?.values?.map((i=>ps(i.doubleValue)));return new pa(t)}convertGeoPoint(e){return new Ga(ps(e.latitude),ps(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Af(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(_u(e));default:return null}}convertTimestamp(e){const t=yi(e);return new It(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Yt.fromString(e);Dt(w2(i),9688,{name:e});const o=new ju(i.get(1),i.get(3)),u=new Qe(i.popFirst(5));return o.isEqual(t)||jr(`Document ${u} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class rx extends j3{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cs(this.firestore,null,t)}}function To(){return new nx("serverTimestamp")}const E1="@firebase/firestore",T1="4.10.0";function A1(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const u of i)if(u in o&&typeof o[u]=="function")return!0;return!1})(n,["next","error","complete"])}class Z2{constructor(e,t,i,o,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new cs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new S3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Po("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class S3 extends Z2{data(){return super.data()}}function ej(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ie(ye.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ix{}class E3 extends ix{}function Ln(n,e,...t){let i=[];e instanceof ix&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof lx)).length,p=u.filter((g=>g instanceof $f)).length;if(d>1||d>0&&p>0)throw new Ie(ye.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const o of i)n=o._apply(n);return n}class $f extends E3{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new $f(e,t,i)}_apply(e){const t=this._parse(e);return tj(e._query,t),new Al(e.firestore,e.converter,V0(e._query,t))}_parse(e){const t=zf(e.firestore);return(function(u,d,p,g,x,b,w){let S;if(x.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Ie(ye.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){C1(w,b);const B=[];for(const V of w)B.push(k1(g,u,V));S={arrayValue:{values:B}}}else S=k1(g,u,w)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||C1(w,b),S=N3(p,d,w,b==="in"||b==="not-in");return Ts.create(x,b,S)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bn(n,e,t){const i=e,o=Po("where",n);return $f._create(o,i,t)}class lx extends ix{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new lx(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ba.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,u){let d=o;const p=u.getFlattenedFilters();for(const g of p)tj(d,g),d=V0(d,g)})(e._query,t),new Al(e.firestore,e.converter,V0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function k1(n,e,t){if(typeof(t=ss(t))=="string"){if(t==="")throw new Ie(ye.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Z_(e)&&t.indexOf("/")!==-1)throw new Ie(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Yt.fromString(t));if(!Qe.isDocumentKey(i))throw new Ie(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return $w(n,new Qe(i))}if(t instanceof cs)return $w(n,t._key);throw new Ie(ye.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sf(t)}.`)}function C1(n,e){if(!Array.isArray(n)||n.length===0)throw new Ie(ye.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tj(n,e){const t=(function(o,u){for(const d of o)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ie(ye.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(ye.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function sj(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class ou{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cl extends Z2{constructor(e,t,i,o,u,d){super(e,t,i,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Uh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Po("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ye.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=cl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}cl._jsonSchemaVersion="firestore/documentSnapshot/1.0",cl._jsonSchema={type:As("string",cl._jsonSchemaVersion),bundleSource:As("string","DocumentSnapshot"),bundleName:As("string"),bundle:As("string")};class Uh extends cl{data(e={}){return super.data(e)}}class ul{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new ou(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Uh(this._firestore,this._userDataWriter,i.key,i,new ou(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ie(ye.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,u){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((p=>{const g=new Uh(o._firestore,o._userDataWriter,p.doc.key,p.doc,new ou(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Uh(o._firestore,o._userDataWriter,p.doc.key,p.doc,new ou(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);let x=-1,b=-1;return p.type!==0&&(x=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),b=d.indexOf(p.doc.key)),{type:T3(p.type),doc:g,oldIndex:x,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ye.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ul._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Tg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),o.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function T3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return st(61501,{type:n})}}ul._jsonSchemaVersion="firestore/querySnapshot/1.0",ul._jsonSchema={type:As("string",ul._jsonSchemaVersion),bundleSource:As("string","QuerySnapshot"),bundleName:As("string"),bundle:As("string")};function u0(n){n=vn(n,cs);const e=vn(n.firestore,Er),t=Uf(e);return c3(t,n._key).then((i=>aj(e,n,i)))}function nn(n){n=vn(n,Al);const e=vn(n.firestore,Er),t=Uf(e),i=new rx(e);return ej(n._query),u3(t,n._query).then((o=>new ul(e,i,n,o)))}function d0(n,e,t){n=vn(n,cs);const i=vn(n.firestore,Er),o=sj(n.converter,e),u=zf(i);return qf(i,[W2(u,"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,ta.none())])}function at(n,e,t,...i){n=vn(n,cs);const o=vn(n.firestore,Er),u=zf(o);let d;return d=typeof(e=ss(e))=="string"||e instanceof tx?w3(u,"updateDoc",n._key,e,t,i):v3(u,"updateDoc",n._key,e),qf(o,[d.toMutation(n._key,ta.exists(!0))])}function nj(n){return qf(vn(n.firestore,Er),[new Mg(n._key,ta.none())])}function ya(n,e){const t=vn(n.firestore,Er),i=Xe(n),o=sj(n.converter,e),u=zf(n.firestore);return qf(t,[W2(u,"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,ta.exists(!1))]).then((()=>i))}function Gt(n,...e){n=ss(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||A1(e[i])||(t=e[i++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(A1(e[i])){const x=e[i];e[i]=x.next?.bind(x),e[i+1]=x.error?.bind(x),e[i+2]=x.complete?.bind(x)}let u,d,p;if(n instanceof cs)d=vn(n.firestore,Er),p=kf(n._key.path),u={next:x=>{e[i]&&e[i](aj(d,n,x))},error:e[i+1],complete:e[i+2]};else{const x=vn(n,Al);d=vn(x.firestore,Er),p=x._query;const b=new rx(d);u={next:w=>{e[i]&&e[i](new ul(d,b,x,w))},error:e[i+1],complete:e[i+2]},ej(n._query)}const g=Uf(d);return o3(g,p,o,u)}function qf(n,e){const t=Uf(n);return d3(t,e)}function aj(n,e,t){const i=t.docs.get(e._key),o=new rx(n);return new cl(n,o,e._key,i,new ou(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){u4(jl),ml(new xi("firestore",((i,{instanceIdentifier:o,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Er(new f4(i.getProvider("auth-internal")),new g4(d,i.getProvider("app-check-internal")),D4(d,o),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),za(E1,T1,e),za(E1,T1,"esm2020")})();const rj="firebasestorage.googleapis.com",ij="storageBucket",A3=120*1e3,k3=600*1e3;class ds extends Ka{constructor(e,t,i=0){super(h0(e),`Firebase Storage: ${t} (${h0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return h0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var us;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(us||(us={}));function h0(n){return"storage/"+n}function ox(){const n="An unknown error occurred, please check the error payload for server response.";return new ds(us.UNKNOWN,n)}function C3(n){return new ds(us.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function R3(n){return new ds(us.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function I3(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ds(us.UNAUTHENTICATED,n)}function D3(){return new ds(us.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function M3(n){return new ds(us.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function O3(){return new ds(us.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function P3(){return new ds(us.CANCELED,"User canceled the upload/download.")}function V3(n){return new ds(us.INVALID_URL,"Invalid URL '"+n+"'.")}function L3(n){return new ds(us.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function U3(){return new ds(us.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+ij+"' property when initializing the app?")}function B3(){return new ds(us.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function z3(){return new ds(us.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function F3(n){return new ds(us.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function W0(n){return new ds(us.INVALID_ARGUMENT,n)}function lj(){return new ds(us.APP_DELETED,"The Firebase app was deleted.")}function $3(n){return new ds(us.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function gu(n,e){return new ds(us.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Xc(n){throw new ds(us.INTERNAL_ERROR,"Internal error: "+n)}class Vn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Vn.makeFromUrl(e,t)}catch{return new Vn(e,"")}if(i.path==="")return i;throw L3(e)}static makeFromUrl(e,t){let i=null;const o="([A-Za-z0-9.\\-_]+)";function u(ie){ie.path.charAt(ie.path.length-1)==="/"&&(ie.path_=ie.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+o+d,"i"),g={bucket:1,path:3};function x(ie){ie.path_=decodeURIComponent(ie.path)}const b="v[A-Za-z0-9_]+",w=t.replace(/[.]/g,"\\."),S="(/([^?#]*).*)?$",R=new RegExp(`^https?://${w}/${b}/b/${o}/o${S}`,"i"),B={bucket:1,path:3},V=t===rj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,F="([^?#]*)",H=new RegExp(`^https?://${V}/${o}/${F}`,"i"),z=[{regex:p,indices:g,postModify:u},{regex:R,indices:B,postModify:x},{regex:H,indices:{bucket:1,path:2},postModify:x}];for(let ie=0;ie<z.length;ie++){const ae=z[ie],Y=ae.regex.exec(e);if(Y){const A=Y[ae.indices.bucket];let T=Y[ae.indices.path];T||(T=""),i=new Vn(A,T),ae.postModify(i);break}}if(i==null)throw V3(e);return i}}class q3{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function H3(n,e,t){let i=1,o=null,u=null,d=!1,p=0;function g(){return p===2}let x=!1;function b(...F){x||(x=!0,e.apply(null,F))}function w(F){o=setTimeout(()=>{o=null,n(R,g())},F)}function S(){u&&clearTimeout(u)}function R(F,...H){if(x){S();return}if(F){S(),b.call(null,F,...H);return}if(g()||d){S(),b.call(null,F,...H);return}i<64&&(i*=2);let z;p===1?(p=2,z=0):z=(i+Math.random())*1e3,w(z)}let B=!1;function V(F){B||(B=!0,S(),!x&&(o!==null?(F||(p=2),clearTimeout(o),w(0)):F||(p=1)))}return w(0),u=setTimeout(()=>{d=!0,V(!0)},t),V}function G3(n){n(!1)}function Y3(n){return n!==void 0}function W3(n){return typeof n=="object"&&!Array.isArray(n)}function cx(n){return typeof n=="string"||n instanceof String}function R1(n){return ux()&&n instanceof Blob}function ux(){return typeof Blob<"u"}function I1(n,e,t,i){if(i<e)throw W0(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw W0(`Invalid value for '${n}'. Expected ${t} or less.`)}function Hf(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function oj(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const o=e(i)+"="+e(n[i]);t=t+o+"&"}return t=t.slice(0,-1),t}var dl;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(dl||(dl={}));function Q3(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||o||u}class K3{constructor(e,t,i,o,u,d,p,g,x,b,w,S=!0,R=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=o,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=x,this.progressCallback_=b,this.connectionFactory_=w,this.retry=S,this.isUsingEmulator=R,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((B,V)=>{this.resolve_=B,this.reject_=V,this.start_()})}start_(){const e=(i,o)=>{if(o){i(!1,new vh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,x=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,x)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===dl.NO_ERROR,g=u.getStatus();if(!p||Q3(g,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===dl.ABORT;i(!1,new vh(!1,null,b));return}const x=this.successCodes_.indexOf(g)!==-1;i(!0,new vh(x,u))})},t=(i,o)=>{const u=this.resolve_,d=this.reject_,p=o.connection;if(o.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());Y3(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=ox();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(o.canceled){const g=this.appDelete_?lj():P3();d(g)}else{const g=O3();d(g)}};this.canceled_?t(!1,new vh(!1,null,!0)):this.backoffId_=H3(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&G3(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class vh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function X3(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function J3(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Z3(n,e){e&&(n["X-Firebase-GMPID"]=e)}function eI(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function tI(n,e,t,i,o,u,d=!0,p=!1){const g=oj(n.urlParams),x=n.url+g,b=Object.assign({},n.headers);return Z3(b,e),X3(b,t),J3(b,u),eI(b,i),new K3(x,n.method,b,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,p)}function sI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function nI(...n){const e=sI();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(ux())return new Blob(n);throw new ds(us.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function aI(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function rI(n){if(typeof atob>"u")throw F3("base-64");return atob(n)}const Ua={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class f0{constructor(e,t){this.data=e,this.contentType=t||null}}function iI(n,e){switch(n){case Ua.RAW:return new f0(cj(e));case Ua.BASE64:case Ua.BASE64URL:return new f0(uj(n,e));case Ua.DATA_URL:return new f0(oI(e),cI(e))}throw ox()}function cj(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function lI(n){let e;try{e=decodeURIComponent(n)}catch{throw gu(Ua.DATA_URL,"Malformed data URL.")}return cj(e)}function uj(n,e){switch(n){case Ua.BASE64:{const o=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(o||u)throw gu(n,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Ua.BASE64URL:{const o=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(o||u)throw gu(n,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=rI(e)}catch(o){throw o.message.includes("polyfill")?o:gu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}class dj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw gu(Ua.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=uI(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function oI(n){const e=new dj(n);return e.base64?uj(Ua.BASE64,e.rest):lI(e.rest)}function cI(n){return new dj(n).contentType}function uI(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class ui{constructor(e,t){let i=0,o="";R1(e)?(this.data_=e,i=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(R1(this.data_)){const i=this.data_,o=aI(i,e,t);return o===null?null:new ui(o)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new ui(i,!0)}}static getBlob(...e){if(ux()){const t=e.map(i=>i instanceof ui?i.data_:i);return new ui(nI.apply(null,t))}else{const t=e.map(d=>cx(d)?iI(Ua.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const o=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)o[u++]=d[p]}),new ui(o,!0)}}uploadData(){return this.data_}}function hj(n){let e;try{e=JSON.parse(n)}catch{return null}return W3(e)?e:null}function dI(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function hI(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function fj(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function fI(n,e){return e}class tn{constructor(e,t,i,o){this.server=e,this.local=t||e,this.writable=!!i,this.xform=o||fI}}let wh=null;function mI(n){return!cx(n)||n.length<2?n:fj(n)}function mj(){if(wh)return wh;const n=[];n.push(new tn("bucket")),n.push(new tn("generation")),n.push(new tn("metageneration")),n.push(new tn("name","fullPath",!0));function e(u,d){return mI(d)}const t=new tn("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const o=new tn("size");return o.xform=i,n.push(o),n.push(new tn("timeCreated")),n.push(new tn("updated")),n.push(new tn("md5Hash",null,!0)),n.push(new tn("cacheControl",null,!0)),n.push(new tn("contentDisposition",null,!0)),n.push(new tn("contentEncoding",null,!0)),n.push(new tn("contentLanguage",null,!0)),n.push(new tn("contentType",null,!0)),n.push(new tn("metadata","customMetadata",!0)),wh=n,wh}function pI(n,e){function t(){const i=n.bucket,o=n.fullPath,u=new Vn(i,o);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function gI(n,e,t){const i={};i.type="file";const o=t.length;for(let u=0;u<o;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return pI(i,n),i}function pj(n,e,t){const i=hj(e);return i===null?null:gI(n,i,t)}function xI(n,e,t,i){const o=hj(e);if(o===null||!cx(o.downloadTokens))return null;const u=o.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(x=>{const b=n.bucket,w=n.fullPath,S="/b/"+d(b)+"/o/"+d(w),R=Hf(S,t,i),B=oj({alt:"media",token:x});return R+B})[0]}function bI(n,e){const t={},i=e.length;for(let o=0;o<i;o++){const u=e[o];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}class dx{constructor(e,t,i,o){this.url=e,this.method=t,this.handler=i,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function gj(n){if(!n)throw ox()}function yI(n,e){function t(i,o){const u=pj(n,o,e);return gj(u!==null),u}return t}function vI(n,e){function t(i,o){const u=pj(n,o,e);return gj(u!==null),xI(u,o,n.host,n._protocol)}return t}function xj(n){function e(t,i){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=D3():o=I3():t.getStatus()===402?o=R3(n.bucket):t.getStatus()===403?o=M3(n.path):o=i,o.status=t.getStatus(),o.serverResponse=i.serverResponse,o}return e}function bj(n){const e=xj(n);function t(i,o){let u=e(i,o);return i.getStatus()===404&&(u=C3(n.path)),u.serverResponse=o.serverResponse,u}return t}function wI(n,e,t){const i=e.fullServerUrl(),o=Hf(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new dx(o,u,vI(n,t),d);return p.errorHandler=bj(e),p}function NI(n,e){const t=e.fullServerUrl(),i=Hf(t,n.host,n._protocol),o="DELETE",u=n.maxOperationRetryTime;function d(g,x){}const p=new dx(i,o,d,u);return p.successCodes=[200,204],p.errorHandler=bj(e),p}function _I(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function jI(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=_I(null,e)),i}function SI(n,e,t,i,o){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let z="";for(let ie=0;ie<2;ie++)z=z+Math.random().toString().slice(2);return z}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const x=jI(e,i,o),b=bI(x,t),w="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+g+`\r
Content-Type: `+x.contentType+`\r
\r
`,S=`\r
--`+g+"--",R=ui.getBlob(w,i,S);if(R===null)throw B3();const B={name:x.fullPath},V=Hf(u,n.host,n._protocol),F="POST",H=n.maxUploadRetryTime,W=new dx(V,F,yI(n,t),H);return W.urlParams=B,W.headers=d,W.body=R.uploadData(),W.errorHandler=xj(e),W}class EI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=dl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=dl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=dl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,o,u){if(this.sent_)throw Xc("cannot .send() more than once");if(Ei(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Xc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Xc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Xc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Xc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class TI extends EI{initXhr(){this.xhr_.responseType="text"}}function hx(){return new TI}class yl{constructor(e,t){this._service=e,t instanceof Vn?this._location=t:this._location=Vn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new yl(e,t)}get root(){const e=new Vn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return fj(this._location.path)}get storage(){return this._service}get parent(){const e=dI(this._location.path);if(e===null)return null;const t=new Vn(this._location.bucket,e);return new yl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw $3(e)}}function AI(n,e,t){n._throwIfRoot("uploadBytes");const i=SI(n.storage,n._location,mj(),new ui(e,!0),t);return n.storage.makeRequestWithTokens(i,hx).then(o=>({metadata:o,ref:n}))}function kI(n){n._throwIfRoot("getDownloadURL");const e=wI(n.storage,n._location,mj());return n.storage.makeRequestWithTokens(e,hx).then(t=>{if(t===null)throw z3();return t})}function CI(n){n._throwIfRoot("deleteObject");const e=NI(n.storage,n._location);return n.storage.makeRequestWithTokens(e,hx)}function RI(n,e){const t=hI(n._location.path,e),i=new Vn(n._location.bucket,t);return new yl(n.storage,i)}function II(n){return/^[A-Za-z]+:\/\//.test(n)}function DI(n,e){return new yl(n,e)}function yj(n,e){if(n instanceof fx){const t=n;if(t._bucket==null)throw U3();const i=new yl(t,t._bucket);return e!=null?yj(i,e):i}else return e!==void 0?RI(n,e):n}function MI(n,e){if(e&&II(e)){if(n instanceof fx)return DI(n,e);throw W0("To use ref(service, url), the first argument must be a Storage instance.")}else return yj(n,e)}function D1(n,e){const t=e?.[ij];return t==null?null:Vn.makeFromBucketSpec(t,n)}function OI(n,e,t,i={}){n.host=`${e}:${t}`;const o=Ei(e);o&&(fg(`https://${n.host}/b`),mg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:UN(u,n.app.options.projectId))}class fx{constructor(e,t,i,o,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=o,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=rj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=A3,this._maxUploadRetryTime=k3,this._requests=new Set,o!=null?this._bucket=Vn.makeFromBucketSpec(o,this._host):this._bucket=D1(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Vn.makeFromBucketSpec(this._url,e):this._bucket=D1(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){I1("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){I1("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(On(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new yl(this,e)}_makeRequest(e,t,i,o,u=!0){if(this._deleted)return new q3(lj());{const d=tI(e,this._appId,i,o,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,o).getPromise()}}const M1="@firebase/storage",O1="0.14.0";const vj="storage";function PI(n,e,t){return n=ss(n),AI(n,e,t)}function VI(n){return n=ss(n),kI(n)}function LI(n){return n=ss(n),CI(n)}function P1(n,e){return n=ss(n),MI(n,e)}function UI(n=xg(),e){n=ss(n);const i=wf(n,vj).getImmediate({identifier:e}),o=PN("storage");return o&&BI(i,...o),i}function BI(n,e,t,i={}){OI(n,e,t,i)}function zI(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new fx(t,i,o,e,jl)}function FI(){ml(new xi(vj,zI,"PUBLIC").setMultipleInstances(!0)),za(M1,O1,""),za(M1,O1,"esm2020")}FI();const $I={apiKey:"AIzaSyC1qZ9fK-6LFBxVWZsAD4dZq-KVg36A7f8",authDomain:"scheduler-65e51.firebaseapp.com",projectId:"scheduler-65e51",storageBucket:"scheduler-65e51.firebasestorage.app",messagingSenderId:"93993791456",appId:"1:93993791456:web:3a777a2da0dad4b8b74585"},mx=FN($I),Ne=p3(mx),ji=i4(mx),V1=UI(mx);const wj=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();const qI=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const HI=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase());const L1=n=>{const e=HI(n);return e.charAt(0).toUpperCase()+e.slice(1)};var GI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const YI=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const WI=j.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:o="",children:u,iconNode:d,...p},g)=>j.createElement("svg",{ref:g,...GI,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:wj("lucide",o),...!u&&!YI(p)&&{"aria-hidden":"true"},...p},[...d.map(([x,b])=>j.createElement(x,b)),...Array.isArray(u)?u:[u]]));const Ce=(n,e)=>{const t=j.forwardRef(({className:i,...o},u)=>j.createElement(WI,{ref:u,iconNode:e,className:wj(`lucide-${qI(L1(n))}`,`lucide-${n}`,i),...o}));return t.displayName=L1(n),t};const QI=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],KI=Ce("arrow-down-right",QI);const XI=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ya=Ce("arrow-left",XI);const JI=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Ao=Ce("arrow-right",JI);const ZI=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],eD=Ce("arrow-up-down",ZI);const tD=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Nj=Ce("arrow-up-right",tD);const sD=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],nD=Ce("ban",sD);const aD=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],wo=Ce("bell",aD);const rD=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],iD=Ce("bot",rD);const lD=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],oD=Ce("building-2",lD);const cD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],ga=Ce("calendar-check",cD);const uD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],U1=Ce("calendar-days",uD);const dD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],jt=Ce("calendar",dD);const hD=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],fD=Ce("camera",hD);const mD=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],px=Ce("chart-column",mD);const pD=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],_j=Ce("chart-pie",pD);const gD=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ks=Ce("check",gD);const xD=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ku=Ce("chevron-down",xD);const bD=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],jj=Ce("chevron-left",bD);const yD=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Gf=Ce("chevron-right",yD);const vD=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Q0=Ce("chevron-up",vD);const wD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Cu=Ce("circle-alert",wD);const ND=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Cs=Ce("circle-check-big",ND);const _D=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],La=Ce("circle-x",_D);const jD=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Xt=Ce("clock",jD);const SD=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],ED=Ce("code",SD);const TD=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],ff=Ce("coffee",TD);const AD=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Sj=Ce("copy",AD);const kD=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],yn=Ce("credit-card",kD);const CD=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Vo=Ce("crown",CD);const RD=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ko=Ce("dollar-sign",RD);const ID=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],hl=Ce("external-link",ID);const DD=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],xu=Ce("eye",DD);const MD=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],OD=Ce("ghost",MD);const PD=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],VD=Ce("gift",PD);const LD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],UD=Ce("globe",LD);const BD=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],zD=Ce("headphones",BD);const FD=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],gx=Ce("heart",FD);const $D=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],qD=Ce("image",$D);const HD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],B1=Ce("info",HD);const GD=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],K0=Ce("list-ordered",GD);const YD=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]],mf=Ce("list-plus",YD);const WD=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ea=Ce("loader-circle",WD);const QD=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],pf=Ce("lock",QD);const KD=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],X0=Ce("log-out",KD);const XD=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],gf=Ce("mail",XD);const JD=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ZD=Ce("map-pin",JD);const eM=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],tM=Ce("menu",eM);const sM=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],xf=Ce("message-circle",sM);const nM=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],J0=Ce("message-square",nM);const aM=[["path",{d:"M5 12h14",key:"1ays0h"}]],rM=Ce("minus",aM);const iM=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],lM=Ce("palette",iM);const oM=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],Ej=Ce("party-popper",oM);const cM=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],xx=Ce("pen-line",cM);const uM=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Z0=Ce("phone",uM);const dM=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],m0=Ce("play",dM);const hM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Qa=Ce("plus",hM);const fM=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Yf=Ce("refresh-cw",fM);const mM=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],gi=Ce("repeat",mM);const pM=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Tj=Ce("save",pM);const gM=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],eg=Ce("search",gM);const xM=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Bh=Ce("send",xM);const bM=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zh=Ce("settings",bM);const yM=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Aj=Ce("shield",yM);const vM=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],kj=Ce("sparkles",vM);const wM=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],z1=Ce("star",wM);const NM=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],F1=Ce("sticky-note",NM);const _M=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],nl=Ce("store",_M);const jM=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],wn=Ce("tag",jM);const SM=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],Cj=Ce("thermometer",SM);const EM=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Rj=Ce("timer",EM);const TM=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Lo=Ce("trash-2",TM);const AM=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Uo=Ce("trending-up",AM);const kM=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],vl=Ce("triangle-alert",kM);const CM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Ij=Ce("user-plus",CM);const RM=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],wl=Ce("user",RM);const IM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ft=Ce("users",IM);const DM=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],$1=Ce("wallet",DM);const MM=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Fs=Ce("x",MM);const OM=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Qo=Ce("zap",OM);function q1({className:n=""}){return r.jsxs(nt,{to:"/",className:`flex items-center gap-2.5 ${n}`,children:[r.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:r.jsx(ga,{className:"w-[18px] h-[18px] text-white"})}),r.jsxs("span",{className:"text-xl font-extrabold tracking-tight text-slate-900",children:["Spot",r.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function PM(){return r.jsxs("div",{className:"min-h-screen bg-white",children:[r.jsx("nav",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-100",children:r.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsx(q1,{}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(nt,{to:"/login",className:"px-4 py-2.5 text-sm font-semibold text-slate-600 hover:text-slate-900 transition-colors",children:"Sign In"}),r.jsxs(nt,{to:"/register",className:"hidden sm:inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:["Get Started Free",r.jsx(Ao,{className:"w-4 h-4"})]}),r.jsx(nt,{to:"/register",className:"sm:hidden px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all",children:"Start Free"})]})]})}),r.jsxs("section",{className:"relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 -z-10",children:[r.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-blue-50 rounded-full blur-3xl opacity-60 -translate-y-1/2 translate-x-1/3"}),r.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-violet-50 rounded-full blur-3xl opacity-50 translate-y-1/3 -translate-x-1/4"})]}),r.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 pt-16 sm:pt-24 pb-16 sm:pb-20",children:r.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-16 items-center",children:[r.jsxs("div",{className:"animate-fade-in-up",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 px-3.5 py-1.5 bg-blue-50 border border-blue-100 rounded-full text-sm font-medium text-blue-700 mb-6",children:[r.jsx(kj,{className:"w-3.5 h-3.5"}),"Free for beauty professionals"]}),r.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-[3.5rem] font-extrabold text-slate-900 leading-[1.1] mb-6 tracking-tight",children:["Online booking",r.jsx("br",{}),r.jsx("span",{className:"text-blue-600",children:"made effortless"})]}),r.jsx("p",{className:"text-lg sm:text-xl text-slate-600 leading-relaxed mb-8 max-w-lg",children:"Let clients book 24/7. Manage your team, services, and schedule from one beautiful dashboard. No more phone tag."}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-10",children:[r.jsxs(nt,{to:"/register",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-base shadow-lg shadow-blue-600/25 hover:shadow-xl hover:shadow-blue-600/30 transition-all hover:-translate-y-0.5",children:["Start for Free",r.jsx(Ao,{className:"w-4 h-4"})]}),r.jsx("a",{href:"#how-it-works",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-base border border-slate-200 transition-all",children:"See How It Works"})]}),r.jsxs("div",{className:"flex items-center gap-5 text-sm text-slate-500",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Cs,{className:"w-4 h-4 text-emerald-500"}),r.jsx("span",{children:"Free to use"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Cs,{className:"w-4 h-4 text-emerald-500"}),r.jsx("span",{children:"No credit card"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Cs,{className:"w-4 h-4 text-emerald-500"}),r.jsx("span",{children:"Setup in 2 min"})]})]})]}),r.jsxs("div",{className:"relative animate-fade-in-up",style:{animationDelay:"150ms"},children:[r.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl shadow-slate-200/60 border border-slate-200/80 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-slate-50 border-b border-slate-100",children:[r.jsxs("div",{className:"flex gap-1.5",children:[r.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),r.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),r.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"})]}),r.jsx("div",{className:"flex-1 mx-4",children:r.jsx("div",{className:"bg-white border border-slate-200 rounded-lg px-3 py-1.5 text-xs text-slate-400 font-mono",children:"bookflow.app/shop/janes-salon"})})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-sm font-bold",children:"J"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-slate-900",children:"Jane's Salon"}),r.jsx("div",{className:"text-xs text-slate-500",children:"Book your next appointment"})]})]}),r.jsx("div",{className:"space-y-2.5",children:[{name:"Haircut & Style",price:"$45",time:"45 min",color:"bg-blue-500"},{name:"Color Treatment",price:"$120",time:"2 hours",color:"bg-violet-500"},{name:"Blowout",price:"$35",time:"30 min",color:"bg-emerald-500"}].map(n=>r.jsxs("div",{className:"flex items-center justify-between p-3.5 bg-slate-50 rounded-xl border border-slate-100 group hover:border-blue-200 hover:bg-blue-50/50 transition-all cursor-default",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-2 h-8 ${n.color} rounded-full`}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold text-slate-800",children:n.name}),r.jsx("div",{className:"text-xs text-slate-500",children:n.time})]})]}),r.jsx("div",{className:"text-sm font-bold text-slate-900",children:n.price})]},n.name))})]})]}),r.jsxs("div",{className:"absolute -bottom-4 -left-4 bg-white rounded-xl shadow-lg shadow-slate-200/60 border border-slate-100 px-4 py-3 flex items-center gap-3 animate-float",children:[r.jsx("div",{className:"w-9 h-9 bg-emerald-100 rounded-full flex items-center justify-center",children:r.jsx(Cs,{className:"w-5 h-5 text-emerald-600"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-slate-500",children:"Booking confirmed"}),r.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Tomorrow at 2:00 PM"})]})]})]})]})})]}),r.jsx("section",{className:"border-y border-slate-100 bg-slate-50/50",children:r.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-8 sm:py-10",children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-8 sm:gap-16 text-center",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"500+"}),r.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Businesses trust SpotBookie"})]}),r.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"10,000+"}),r.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Appointments booked"})]}),r.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl sm:text-3xl font-extrabold text-slate-900",children:["4.9 ",r.jsx(z1,{className:"w-5 h-5 text-amber-400 fill-amber-400"})]}),r.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Average rating"})]})]})})}),r.jsx("section",{className:"py-20 sm:py-28",children:r.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[r.jsxs("div",{className:"text-center mb-14",children:[r.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Everything you need to run your bookings"}),r.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Built specifically for beauty professionals, salons, and service businesses. Simple, powerful, and free."})]}),r.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 stagger-children",children:[{icon:r.jsx(jt,{className:"w-6 h-6"}),title:"Smart Scheduling",desc:"Set weekly hours with breaks. Slots auto-generate so your calendar is always up to date.",color:"bg-blue-100 text-blue-600"},{icon:r.jsx(Ft,{className:"w-6 h-6"}),title:"Multi-Staff Support",desc:"Add your whole team. Each member gets their own schedule, hours, and bookings.",color:"bg-violet-100 text-violet-600"},{icon:r.jsx(Qo,{className:"w-6 h-6"}),title:"Instant Booking",desc:"Clients pick a service, choose a stylist, and book  all in under a minute.",color:"bg-amber-100 text-amber-600"},{icon:r.jsx(UD,{className:"w-6 h-6"}),title:"Your Own Booking Page",desc:"Get a unique link to share anywhere. No app downloads needed for your clients.",color:"bg-emerald-100 text-emerald-600"}].map(n=>r.jsxs("div",{className:"group bg-white rounded-2xl p-7 border border-slate-200/80 hover:border-slate-300 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[r.jsx("div",{className:`w-12 h-12 ${n.color} rounded-xl flex items-center justify-center mb-5 group-hover:scale-110 transition-transform duration-300`,children:n.icon}),r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:n.title}),r.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:n.desc})]},n.title))})]})}),r.jsx("section",{id:"how-it-works",className:"py-20 sm:py-28 bg-slate-50 border-y border-slate-100",children:r.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[r.jsxs("div",{className:"text-center mb-14",children:[r.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Up and running in minutes"}),r.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Three simple steps to start accepting online bookings today."})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-8 lg:gap-12 relative",children:[r.jsx("div",{className:"hidden md:block absolute top-14 left-[calc(16.67%+1rem)] right-[calc(16.67%+1rem)] h-px bg-gradient-to-r from-blue-200 via-violet-200 to-emerald-200"}),[{step:"1",title:"Create your account",desc:"Sign up free in 30 seconds. Name your shop and you're in.",color:"from-blue-500 to-blue-600",shadow:"shadow-blue-500/30"},{step:"2",title:"Set up your shop",desc:"Add your services, team, and weekly hours. SpotBookie handles the rest.",color:"from-violet-500 to-violet-600",shadow:"shadow-violet-500/30"},{step:"3",title:"Share your link",desc:"Send your booking page to clients. They book, you get notified.",color:"from-emerald-500 to-emerald-600",shadow:"shadow-emerald-500/30"}].map(n=>r.jsxs("div",{className:"relative text-center",children:[r.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${n.color} rounded-2xl flex items-center justify-center mx-auto mb-6 text-white text-xl font-extrabold shadow-lg ${n.shadow} relative z-10`,children:n.step}),r.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:n.title}),r.jsx("p",{className:"text-slate-600 leading-relaxed max-w-xs mx-auto",children:n.desc})]},n.step))]})]})}),r.jsx("section",{className:"py-20 sm:py-28",children:r.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[r.jsxs("div",{className:"text-center mb-14",children:[r.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Loved by professionals"}),r.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"See why salons and stylists are switching to SpotBookie."})]}),r.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{quote:"SpotBookie replaced our paper appointment book. Clients love being able to book online anytime.",name:"Maria Santos",role:"Salon Owner",initials:"MS",color:"bg-blue-100 text-blue-700"},{quote:"Setting up was incredibly easy. I had my booking page live and shared with clients in under 10 minutes.",name:"David Chen",role:"Barber",initials:"DC",color:"bg-violet-100 text-violet-700"},{quote:"The multi-staff feature is perfect. Each stylist manages their own schedule and clients can pick who they want.",name:"Lisa Park",role:"Studio Manager",initials:"LP",color:"bg-emerald-100 text-emerald-700"}].map(n=>r.jsxs("div",{className:"bg-white rounded-2xl p-7 border border-slate-200/80 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[r.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(5)].map((e,t)=>r.jsx(z1,{className:"w-4 h-4 text-amber-400 fill-amber-400"},t))}),r.jsxs("p",{className:"text-slate-700 leading-relaxed mb-6",children:['"',n.quote,'"']}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-10 h-10 ${n.color} rounded-full flex items-center justify-center text-sm font-bold`,children:n.initials}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:n.name}),r.jsx("div",{className:"text-xs text-slate-500",children:n.role})]})]})]},n.name))})]})}),r.jsxs("section",{className:"py-20 sm:py-28 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 -z-0",children:[r.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-violet-500/10 rounded-full blur-3xl"})]}),r.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto px-5 sm:px-8 text-center",children:[r.jsx("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-extrabold text-white mb-6 leading-tight",children:"Ready to streamline your bookings?"}),r.jsx("p",{className:"text-lg text-slate-400 mb-10 max-w-xl mx-auto",children:"Join hundreds of professionals who have ditched the old appointment book. Set up in minutes, free forever."}),r.jsxs(nt,{to:"/register",className:"inline-flex items-center gap-2 px-8 py-4 bg-white hover:bg-slate-50 text-slate-900 rounded-xl font-bold text-lg transition-all hover:shadow-xl hover:shadow-white/10 hover:-translate-y-0.5",children:["Create Your Free Account",r.jsx(Ao,{className:"w-5 h-5"})]})]})]}),r.jsx("footer",{className:"bg-white border-t border-slate-100",children:r.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-10",children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[r.jsx(q1,{}),r.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500",children:[r.jsx(nt,{to:"/register",className:"hover:text-slate-900 transition-colors",children:"Sign Up"}),r.jsx("span",{className:"text-slate-200",children:""}),r.jsx(nt,{to:"/login",className:"hover:text-slate-900 transition-colors",children:"Sign In"}),r.jsx("span",{className:"text-slate-200",children:""}),r.jsx("a",{href:"#how-it-works",className:"hover:text-slate-900 transition-colors",children:"How It Works"})]}),r.jsxs("p",{className:"text-xs text-slate-400",children:[" ",new Date().getFullYear()," SpotBookie. All rights reserved."]})]})})})]})}function VM(n){return n.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function LM(){const n=_l(),[e,t]=j.useState(""),[i,o]=j.useState(""),[u,d]=j.useState(""),[p,g]=j.useState(""),[x,b]=j.useState(!1),w=VM(e),S=async R=>{if(R.preventDefault(),g(""),!w){g("Please enter a valid shop name");return}if(u.length<6){g("Password must be at least 6 characters");return}b(!0);try{const B=Ln(Ze(Ne,"shops"),bn("slug","==",w));if(!(await nn(B)).empty){g("A shop with that name already exists. Please choose a different name."),b(!1);return}const H=(await Gk(ji,i,u)).user;await ya(Ze(Ne,"shops"),{name:e.trim(),slug:w,ownerUid:H.uid,ownerEmail:i,createdAt:To()}),n(`/shop/${w}/dashboard`)}catch(B){switch(B.code){case"auth/email-already-in-use":g("An account with this email already exists");break;case"auth/invalid-email":g("Please enter a valid email address");break;case"auth/weak-password":g("Password must be at least 6 characters");break;default:g("Registration failed. Please try again.")}}finally{b(!1)}};return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[r.jsx("div",{className:"text-center mb-8",children:r.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2.5",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:r.jsx(ga,{className:"w-5 h-5 text-white"})}),r.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",r.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),r.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Create your shop"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Set up your booking page in seconds  it's free"})]}),r.jsxs("form",{onSubmit:S,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Shop Name"}),r.jsx("input",{type:"text",value:e,onChange:R=>{t(R.target.value),g("")},placeholder:"Jane's Salon",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),w&&r.jsxs("p",{className:"mt-1.5 text-xs text-slate-400",children:["Your page: ",r.jsxs("span",{className:"font-mono text-blue-600 font-medium",children:["bookflow.app/shop/",w]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),r.jsx("input",{type:"email",value:i,onChange:R=>{o(R.target.value),g("")},placeholder:"you@example.com",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),r.jsx("input",{type:"password",value:u,onChange:R=>{d(R.target.value),g("")},placeholder:"At least 6 characters",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${p?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),p&&r.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[r.jsx("span",{children:""})," ",p]})]}),r.jsx("button",{type:"submit",disabled:x,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:x?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Creating your shop"]}):r.jsxs(r.Fragment,{children:["Create Shop",r.jsx(Ao,{className:"w-4 h-4"})]})})]}),r.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:r.jsxs("p",{className:"text-sm text-slate-500",children:["Already have an account?"," ",r.jsx(nt,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Sign in"})]})})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs(nt,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[r.jsx(Ya,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function UM({user:n}){const e=_l(),[t,i]=j.useState(""),[o,u]=j.useState(""),[d,p]=j.useState(""),[g,x]=j.useState(!1);j.useState(()=>{if(!n)return;(async()=>{const S=Ln(Ze(Ne,"shops"),bn("ownerUid","==",n.uid)),R=await nn(S);if(!R.empty){const B=R.docs[0].data();e(`/shop/${B.slug}/dashboard`,{replace:!0})}})()},[n,e]);const b=async w=>{w.preventDefault(),p(""),x(!0);try{const R=(await p_(ji,t,o)).user,B=Ln(Ze(Ne,"shops"),bn("ownerUid","==",R.uid)),V=await nn(B);if(V.empty){p("No shop found for this account. Need to create one?"),await ji.signOut(),x(!1);return}const F=V.docs[0].data();e(`/shop/${F.slug}/dashboard`,{replace:!0})}catch(S){switch(S.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":p("Invalid email or password");break;case"auth/invalid-email":p("Please enter a valid email address");break;case"auth/too-many-requests":p("Too many failed attempts. Please try again later.");break;default:p("Login failed. Please try again.")}u("")}finally{x(!1)}};return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[r.jsx("div",{className:"text-center mb-8",children:r.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2.5",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:r.jsx(ga,{className:"w-5 h-5 text-white"})}),r.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",r.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),r.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),r.jsxs("form",{onSubmit:b,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),r.jsx("input",{type:"email",value:t,onChange:w=>{i(w.target.value),p("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),r.jsx("input",{type:"password",value:o,onChange:w=>{u(w.target.value),p("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${d?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),d&&r.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[r.jsx("span",{children:""})," ",d]})]}),r.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):r.jsxs(r.Fragment,{children:["Sign In",r.jsx(Ao,{className:"w-4 h-4"})]})})]}),r.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:r.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",r.jsx(nt,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs(nt,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[r.jsx(Ya,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function Dj({availableDates:n,selectedDate:e,onSelectDate:t}){const[i,o]=j.useState(new Date),u=H=>{const W=H.getFullYear(),z=H.getMonth(),ie=new Date(W,z,1),Y=new Date(W,z+1,0).getDate(),A=ie.getDay();return{daysInMonth:Y,startingDayOfWeek:A,year:W,month:z}},{daysInMonth:d,startingDayOfWeek:p,year:g,month:x}=u(i),b=()=>{o(new Date(i.getFullYear(),i.getMonth()-1))},w=()=>{o(new Date(i.getFullYear(),i.getMonth()+1))},S=H=>{const W=`${g}-${String(x+1).padStart(2,"0")}-${String(H).padStart(2,"0")}`;return n.includes(W)},R=H=>`${g}-${String(x+1).padStart(2,"0")}-${String(H).padStart(2,"0")}`===e,B=H=>{if(S(H)){const W=`${g}-${String(x+1).padStart(2,"0")}-${String(H).padStart(2,"0")}`;t(W)}},V=["January","February","March","April","May","June","July","August","September","October","November","December"],F=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return r.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-5 sm:p-6 shadow-sm",children:[r.jsxs("div",{className:"flex justify-between items-center mb-5",children:[r.jsx("button",{onClick:b,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(jj,{className:"w-5 h-5 text-slate-600"})}),r.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[V[x]," ",g]}),r.jsx("button",{onClick:w,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(Gf,{className:"w-5 h-5 text-slate-600"})})]}),r.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:F.map(H=>r.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:H},H))}),r.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:p}).map((H,W)=>r.jsx("div",{},`empty-${W}`)),Array.from({length:d}).map((H,W)=>{const z=W+1,ie=S(z),ae=R(z),Y=new Date,A=Y.getDate()===z&&Y.getMonth()===x&&Y.getFullYear()===g;return r.jsxs("button",{onClick:()=>B(z),disabled:!ie,className:`
                relative p-2.5 sm:p-3 text-center rounded-lg text-sm font-semibold transition-all duration-200
                ${ae?"bg-blue-600 text-white shadow-md shadow-blue-600/30":ie?"bg-emerald-50 text-emerald-700 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-300 cursor-pointer":A?"text-slate-900 font-bold":"text-slate-300 cursor-not-allowed"}
              `,children:[z,A&&!ae&&r.jsx("span",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]},z)})]}),r.jsxs("div",{className:"mt-4 flex gap-5 text-xs text-slate-500",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3 h-3 bg-emerald-50 border border-emerald-200 rounded"}),r.jsx("span",{children:"Available"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded"}),r.jsx("span",{children:"Selected"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-1 h-1 bg-blue-500 rounded-full"}),r.jsx("span",{children:"Today"})]})]})]})}const BM=[{key:"monday",label:"Mon"},{key:"tuesday",label:"Tue"},{key:"wednesday",label:"Wed"},{key:"thursday",label:"Thu"},{key:"friday",label:"Fri"},{key:"saturday",label:"Sat"},{key:"sunday",label:"Sun"}],H1=[{key:"morning",label:"Morning (9AM12PM)",start:"09:00",end:"12:00"},{key:"afternoon",label:"Afternoon (12PM5PM)",start:"12:00",end:"17:00"},{key:"evening",label:"Evening (5PM9PM)",start:"17:00",end:"21:00"},{key:"any",label:"Any time",start:"00:00",end:"23:59"}];function zM(){const n="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="WL";for(let t=0;t<4;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}function G1({shopId:n,slug:e,selectedService:t,selectedStaff:i,staffMembers:o,preferredDate:u,onSuccess:d,onCancel:p}){const[g,x]=j.useState({name:"",email:"",phone:""}),[b,w]=j.useState([]),[S,R]=j.useState("any"),[B,V]=j.useState(!1),[F,H]=j.useState(!1),[W,z]=j.useState(""),ie=Y=>{w(A=>A.includes(Y)?A.filter(T=>T!==Y):[...A,Y])},ae=async Y=>{Y.preventDefault(),V(!0);try{const A=zM(),T=H1.find(D=>D.key===S),E=i&&i!=="any"?i.id:"any",I=i&&i!=="any"?i.name:"Any Available",_={clientName:g.name,clientEmail:g.email,clientPhone:g.phone,serviceId:t?.id||null,serviceName:t?.name||"Any Service",staffId:E,staffName:I,preferredDate:u||null,preferredDays:b.length>0?b:null,preferredTimeRange:T?{start:T.start,end:T.end}:null,status:"waiting",refCode:A,createdAt:new Date().toISOString(),notifiedAt:null,notifiedSlot:null};await ya(Ze(Ne,"shops",n,"waitlist"),_),z(A),H(!0),d&&d(A)}catch(A){console.error("Waitlist error:",A)}finally{V(!1)}};return F?r.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg shadow-blue-100/50 p-8 text-center animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(Cs,{className:"w-8 h-8 text-blue-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"You're on the Waitlist!"}),r.jsxs("p",{className:"text-slate-600 mb-4",children:["We'll notify you when a slot opens up",t?` for ${t.name}`:"","."]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your waitlist reference"}),r.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:W})]}),r.jsxs("a",{href:`#/shop/${e}/waitlist/${W}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[r.jsx(Xt,{className:"w-4 h-4"}),"Check Waitlist Status"]}),r.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to check your position and get notified"})]}):r.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg p-6 animate-fade-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:r.jsx(mf,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Join the Waitlist"}),r.jsx("p",{className:"text-sm text-slate-500",children:"We'll notify you when a slot opens up"})]})]}),r.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),r.jsx("input",{type:"text",value:g.name,onChange:Y=>x({...g,name:Y.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),r.jsx("input",{type:"email",value:g.email,onChange:Y=>x({...g,email:Y.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),r.jsx("input",{type:"tel",value:g.phone,onChange:Y=>x({...g,phone:Y.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["Preferred Days ",r.jsx("span",{className:"text-slate-400 font-normal",children:"(optional)"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:BM.map(Y=>r.jsx("button",{type:"button",onClick:()=>ie(Y.key),className:`px-3.5 py-2 rounded-lg text-sm font-semibold transition-all border ${b.includes(Y.key)?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:Y.label},Y.key))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preferred Time"}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:H1.map(Y=>r.jsx("button",{type:"button",onClick:()=>R(Y.key),className:`px-3.5 py-2.5 rounded-lg text-sm font-medium transition-all border text-left ${S===Y.key?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:Y.label},Y.key))})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"submit",disabled:B,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:B?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Joining"]}):r.jsxs(r.Fragment,{children:[r.jsx(mf,{className:"w-4 h-4"}),"Join Waitlist"]})}),p&&r.jsx("button",{type:"button",onClick:p,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]})}function FM(){return r.jsxs("div",{className:"flex items-end gap-2 mb-3",children:[r.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:r.jsx(xf,{className:"w-3.5 h-3.5 text-white"})}),r.jsx("div",{className:"bg-slate-100 rounded-2xl rounded-bl-md px-4 py-3",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),r.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),r.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})}function $M({message:n,onSelectService:e,onQuickReply:t}){const i=n.sender==="bot";return r.jsxs("div",{className:`flex items-end gap-2 mb-3 ${i?"":"flex-row-reverse"}`,children:[i&&r.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:r.jsx(xf,{className:"w-3.5 h-3.5 text-white"})}),r.jsxs("div",{className:"max-w-[85%] space-y-2",children:[r.jsx("div",{className:`px-4 py-2.5 text-sm leading-relaxed whitespace-pre-line ${i?"bg-slate-100 text-slate-800 rounded-2xl rounded-bl-md":"bg-blue-600 text-white rounded-2xl rounded-br-md"}`,children:n.text}),n.serviceCards&&n.serviceCards.length>0&&r.jsx("div",{className:"space-y-1.5",children:n.serviceCards.map(o=>r.jsxs("button",{onClick:()=>e(o),className:"w-full flex items-center justify-between gap-2 px-3.5 py-2.5 bg-white border border-slate-200 hover:border-blue-400 rounded-xl text-left transition-all hover:shadow-sm group",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-semibold text-slate-800 group-hover:text-blue-700 truncate",children:o.name}),r.jsxs("p",{className:"text-xs text-slate-500",children:[Fh(o.duration),"  ",tg(o.price)]})]}),r.jsxs("span",{className:"text-xs font-semibold text-blue-600 whitespace-nowrap flex items-center gap-0.5",children:["Book ",r.jsx(Gf,{className:"w-3 h-3"})]})]},o.id))}),n.quickReplies&&n.quickReplies.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1.5 pt-1",children:n.quickReplies.map((o,u)=>r.jsx("button",{onClick:()=>t(o),className:"px-3 py-1.5 text-xs font-medium text-blue-600 bg-white border border-blue-200 hover:bg-blue-50 hover:border-blue-400 rounded-full transition-all",children:o},u))})]})]})}function tg(n){return n==null?"":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(n)}function Fh(n){if(!n)return"";if(n<60)return`${n} min`;const e=Math.floor(n/60),t=n%60;return t?`${e}h ${t}m`:`${e} hour${e>1?"s":""}`}function qM(n,{services:e,staffMembers:t,shop:i}){const o=n.toLowerCase().trim(),u=i?.name||"our shop";if(/^(hi|hello|hey|howdy|sup|yo|hiya|good\s*(morning|afternoon|evening))/.test(o))return{text:`Hi!  I'm here to help you book an appointment at ${u}. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]};if(/how (do i|to|can i) book|help.*(book|appoint)|booking help/i.test(o))return{text:`Booking is easy! Here's how:

1 Choose a service
2 Pick your stylist
3 Select a date & time
4 Fill in your details

That's it! Would you like to start?`,quickReplies:["View Services","View Staff"]};if(/what (services|do you offer)|menu|prices|how much|service list|your services/i.test(o)||o==="view services")return!e||e.length===0?{text:"We don't have any services listed right now. Please check back later!"}:{text:`Here are our services:

${e.map(p=>` ${p.name}  ${Fh(p.duration)}  ${tg(p.price)}`).join(`
`)}

Would you like to book one of these? Just tap below! `,serviceCards:e};if(e&&e.length>0){const d=e.find(p=>{const g=p.name.toLowerCase();return o.includes(g)||g.includes(o)});if(d&&o.length>2)return{text:`Great choice! Here are the details for **${d.name}**:

 Duration: ${Fh(d.duration)}
 Price: ${tg(d.price)}${d.description?`
 ${d.description}`:""}

Would you like to book this service? Tap "Book" below!`,serviceCards:[d],quickReplies:["View All Services","View Staff"]}}if(/how long|how much time|duration/i.test(o))return!e||e.length===0?{text:"No services are listed right now. Check back soon!"}:{text:`Here's how long each service takes:

${e.map(p=>` ${p.name}: ${Fh(p.duration)}`).join(`
`)}`,quickReplies:["View Services","How to Book"]};if(/who works|stylists?|staff|team|barber|who('s| is) (here|available)|your (team|people)/i.test(o)||o==="view staff")return!t||t.length===0?{text:"We don't have any team members listed right now."}:{text:`Meet our team! 

${t.map(p=>{let g=` ${p.name}`;return p.role&&(g+=`  ${p.role}`),p.bio&&(g+=`
  "${p.bio.slice(0,80)}${p.bio.length>80?"":""}"`),g}).join(`
`)}

You can pick your preferred stylist during booking.`,quickReplies:["View Services","How to Book"]};if(/available|open slot|when can i|next available|free slot|any opening/i.test(o)){const d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],p=new Set;return t&&t.length>0&&t.forEach(x=>{x.weeklyHours&&Object.entries(x.weeklyHours).forEach(([b,w])=>{w&&w.enabled&&p.add(b)})}),{text:`You can check available times by selecting a service and date in the booking flow above. We're generally available on ${p.size>0?[...p].sort((x,b)=>d.indexOf(x)-d.indexOf(b)).join(", "):"most days"}. `,quickReplies:["View Services","How to Book"]}}if(/hours|when are you open|business hours|open hours|what time|operating/i.test(o)){const d=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],p={};if(t&&t.length>0&&t.forEach(g=>{g.weeklyHours&&Object.entries(g.weeklyHours).forEach(([x,b])=>{b&&b.enabled&&b.start&&b.end&&(p[x]?(b.start<p[x].start&&(p[x].start=b.start),b.end>p[x].end&&(p[x].end=b.end)):p[x]={start:b.start,end:b.end})})}),Object.keys(p).length>0){const g=b=>{const[w,S]=b.split(":"),R=parseInt(w),B=R>=12?"PM":"AM";return`${R%12||12}:${S} ${B}`};return{text:`Here are our general hours:

${d.filter(b=>p[b]).map(b=>` ${b}: ${g(p[b].start)}  ${g(p[b].end)}`).join(`
`)}

Hours may vary by stylist. Select a service to see exact availability.`,quickReplies:["View Services","View Staff"]}}return{text:"Our hours vary by stylist. You can see exact availability by selecting a service above.",quickReplies:["View Services","How to Book"]}}return/phone|address|contact|where|location|email|reach/i.test(o)?{text:"For contact information, please reach out to the shop directly. You can also find us through the booking confirmation email after you book! ",quickReplies:["View Services","How to Book"]}:/cancel|reschedule|change my (booking|appointment)|modify/i.test(o)?{text:"You can manage your booking using the reference code you received. Go to your confirmation email and click 'Manage Booking' to reschedule or cancel. ",quickReplies:["How to Book","View Services"]}:/waitlist|no availability|fully booked|no slots|all booked|sold out/i.test(o)?{text:"If there are no available slots, you can join our waitlist and we'll notify you when something opens up! Look for the 'Join Waitlist' button when viewing available times. ",quickReplies:["View Services","How to Book"]}:/^(thanks?|thank you|thx|ty|cheers|appreciate)/i.test(o)?{text:"You're welcome!  Let me know if you need anything else.",quickReplies:["View Services","View Staff","How to Book"]}:{text:"I'm not sure about that. You can browse our services above, or try asking about our services, staff, or availability! ",quickReplies:["View Services","View Staff","How to Book"]}}function HM({services:n,staffMembers:e,shop:t,onSelectService:i}){const[o,u]=j.useState(!1),[d,p]=j.useState([]),[g,x]=j.useState(""),[b,w]=j.useState(!1),[S,R]=j.useState(!1),[B,V]=j.useState(!1),[F,H]=j.useState(!1),W=j.useRef(null),z=j.useRef(null),ie=t?.name||"our shop";j.useEffect(()=>{W.current?.scrollIntoView({behavior:"smooth"})},[d,b]),j.useEffect(()=>{o&&setTimeout(()=>z.current?.focus(),100)},[o]);const ae=j.useCallback(()=>{V(!1),H(!0),u(!0),d.length===0&&p([{id:"welcome",sender:"bot",text:`Hi!  Welcome to ${ie}. I can help you find the right service and book an appointment. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]}])},[d.length,ie]),Y=j.useCallback(_=>{w(!0);const D=400+Math.random()*600;setTimeout(()=>{const k=qM(_,{services:n,staffMembers:e,shop:t});p(L=>[...L,{id:`bot-${Date.now()}`,sender:"bot",text:k.text,serviceCards:k.serviceCards||null,quickReplies:k.quickReplies||null}]),w(!1)},D)},[n,e,t]),A=j.useCallback(()=>{const _=g.trim();_&&(p(D=>[...D,{id:`user-${Date.now()}`,sender:"user",text:_}]),x(""),Y(_))},[g,Y]),T=j.useCallback(_=>{p(D=>[...D,{id:`user-${Date.now()}`,sender:"user",text:_}]),Y(_)},[Y]),E=j.useCallback(_=>{i&&(i(_),p(D=>[...D,{id:`bot-${Date.now()}`,sender:"bot",text:`Great! I've selected "${_.name}" for you. You can now pick your stylist and time above. `}]),setTimeout(()=>u(!1),1500))},[i]),I=_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),A())};return r.jsxs(r.Fragment,{children:[B&&!o&&r.jsxs("div",{className:"fixed bottom-24 right-5 z-50 animate-fade-in",children:[r.jsx("button",{onClick:ae,className:"bg-white border border-slate-200 shadow-lg rounded-2xl rounded-br-md px-4 py-3 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all max-w-[220px]",children:"Need help booking? "}),r.jsx("button",{onClick:()=>{V(!1),H(!0)},className:"absolute -top-2 -right-2 w-5 h-5 bg-slate-200 hover:bg-slate-300 rounded-full flex items-center justify-center text-slate-500 transition-colors",children:r.jsx(Fs,{className:"w-3 h-3"})})]}),o&&r.jsxs("div",{className:`fixed bottom-20 right-5 z-50 bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden animate-scale-in
                     w-[calc(100vw-2.5rem)] max-w-[380px] h-[min(500px,calc(100vh-7rem))]
                     sm:w-[380px] sm:right-5 sm:bottom-20`,style:{transformOrigin:"bottom right"},children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:r.jsx(xf,{className:"w-4 h-4"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold leading-tight",children:"SpotBookie Assistant"}),r.jsx("p",{className:"text-[11px] text-blue-100",children:"Ask me anything about booking"})]})]}),r.jsx("button",{onClick:()=>u(!1),className:"w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors","aria-label":"Close chat",children:r.jsx(Fs,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-0 bg-slate-50/50",children:[d.map(_=>r.jsx($M,{message:_,onSelectService:E,onQuickReply:T},_.id)),b&&r.jsx(FM,{}),r.jsx("div",{ref:W})]}),r.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 border-t border-slate-200 bg-white flex-shrink-0",children:[r.jsx("input",{ref:z,type:"text",value:g,onChange:_=>x(_.target.value),onKeyDown:I,placeholder:"Type a message",className:"flex-1 px-3.5 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder:text-slate-400"}),r.jsx("button",{onClick:A,disabled:!g.trim(),className:"w-10 h-10 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-200 disabled:cursor-not-allowed text-white disabled:text-slate-400 rounded-xl flex items-center justify-center transition-all flex-shrink-0","aria-label":"Send message",children:r.jsx(Bh,{className:"w-4 h-4"})})]})]}),r.jsx("button",{onClick:()=>{o?u(!1):ae()},className:`fixed bottom-5 right-5 z-50 w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 hover:scale-105 hover:shadow-xl ${o?"bg-slate-700 hover:bg-slate-800":"bg-blue-600 hover:bg-blue-700 chat-bubble-pulse"}`,"aria-label":o?"Close chat assistant":"Open chat assistant",children:o?r.jsx(Fs,{className:"w-6 h-6 text-white"}):r.jsx(xf,{className:"w-6 h-6 text-white"})})]})}var p0={exports:{}},g0,Y1;function GM(){if(Y1)return g0;Y1=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return g0=n,g0}var x0,W1;function YM(){if(W1)return x0;W1=1;var n=GM();function e(){}function t(){}return t.resetWarningCache=e,x0=function(){function i(d,p,g,x,b,w){if(w!==n){var S=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw S.name="Invariant Violation",S}}i.isRequired=i;function o(){return i}var u={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:o,element:i,elementType:i,instanceOf:o,node:i,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:t,resetWarningCache:e};return u.PropTypes=u,u},x0}var Q1;function WM(){return Q1||(Q1=1,p0.exports=YM()()),p0.exports}var QM=WM();const qt=ag(QM);function K1(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,i)}return t}function X1(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?K1(Object(t),!0).forEach(function(i){Mj(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):K1(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function $h(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$h=function(e){return typeof e}:$h=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$h(n)}function Mj(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function KM(n,e){if(n==null)return{};var t={},i=Object.keys(n),o,u;for(u=0;u<i.length;u++)o=i[u],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function XM(n,e){if(n==null)return{};var t=KM(n,e),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);for(o=0;o<u.length;o++)i=u[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function Oj(n,e){return JM(n)||ZM(n,e)||eO(n,e)||tO()}function JM(n){if(Array.isArray(n))return n}function ZM(n,e){var t=n&&(typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"]);if(t!=null){var i=[],o=!0,u=!1,d,p;try{for(t=t.call(n);!(o=(d=t.next()).done)&&(i.push(d.value),!(e&&i.length===e));o=!0);}catch(g){u=!0,p=g}finally{try{!o&&t.return!=null&&t.return()}finally{if(u)throw p}}return i}}function eO(n,e){if(n){if(typeof n=="string")return J1(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return J1(n,e)}}function J1(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function tO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn=function(e,t,i){var o=!!i,u=Ht.useRef(i);Ht.useEffect(function(){u.current=i},[i]),Ht.useEffect(function(){if(!o||!e)return function(){};var d=function(){u.current&&u.current.apply(u,arguments)};return e.on(t,d),function(){e.off(t,d)}},[o,t,e,u])},sg=function(e){var t=Ht.useRef(e);return Ht.useEffect(function(){t.current=e},[e]),t.current},Bo=function(e){return e!==null&&$h(e)==="object"},sO=function(e){return Bo(e)&&typeof e.then=="function"},nO=function(e){return Bo(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},Z1="[object Object]",aO=function n(e,t){if(!Bo(e)||!Bo(t))return e===t;var i=Array.isArray(e),o=Array.isArray(t);if(i!==o)return!1;var u=Object.prototype.toString.call(e)===Z1,d=Object.prototype.toString.call(t)===Z1;if(u!==d)return!1;if(!u&&!i)return e===t;var p=Object.keys(e),g=Object.keys(t);if(p.length!==g.length)return!1;for(var x={},b=0;b<p.length;b+=1)x[p[b]]=!0;for(var w=0;w<g.length;w+=1)x[g[w]]=!0;var S=Object.keys(x);if(S.length!==p.length)return!1;var R=e,B=t,V=function(H){return n(R[H],B[H])};return S.every(V)},Pj=function(e,t,i){return Bo(e)?Object.keys(e).reduce(function(o,u){var d=!Bo(t)||!aO(e[u],t[u]);return i.includes(u)?(d&&console.warn("Unsupported prop change: options.".concat(u," is not a mutable property.")),o):d?X1(X1({},o||{}),{},Mj({},u,e[u])):o},null):null},Vj="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",eN=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vj;if(e===null||nO(e))return e;throw new Error(t)},rO=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vj;if(sO(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(o){return eN(o,t)})};var i=eN(e,t);return i===null?{tag:"empty"}:{tag:"sync",stripe:i}},iO=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.6.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.6.0",url:"https://stripe.com/docs/stripe-js/react"}))},Wf=Ht.createContext(null);Wf.displayName="ElementsContext";var Lj=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},Uj=function(e){var t=e.stripe,i=e.options,o=e.children,u=Ht.useMemo(function(){return rO(t)},[t]),d=Ht.useState(function(){return{stripe:u.tag==="sync"?u.stripe:null,elements:u.tag==="sync"?u.stripe.elements(i):null}}),p=Oj(d,2),g=p[0],x=p[1];Ht.useEffect(function(){var S=!0,R=function(V){x(function(F){return F.stripe?F:{stripe:V,elements:V.elements(i)}})};return u.tag==="async"&&!g.stripe?u.stripePromise.then(function(B){B&&S&&R(B)}):u.tag==="sync"&&!g.stripe&&R(u.stripe),function(){S=!1}},[u,g,i]);var b=sg(t);Ht.useEffect(function(){b!==null&&b!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[b,t]);var w=sg(i);return Ht.useEffect(function(){if(g.elements){var S=Pj(i,w,["clientSecret","fonts"]);S&&g.elements.update(S)}},[i,w,g.elements]),Ht.useEffect(function(){iO(g.stripe)},[g.stripe]),Ht.createElement(Wf.Provider,{value:g},o)};Uj.propTypes={stripe:qt.any,options:qt.object};var lO=function(e){var t=Ht.useContext(Wf);return Lj(t,e)},oO=function(){var e=lO("calls useElements()"),t=e.elements;return t};qt.func.isRequired;var Bj=Ht.createContext(null);Bj.displayName="CheckoutContext";qt.any,qt.shape({clientSecret:qt.oneOfType([qt.string,qt.instanceOf(Promise)]).isRequired,elementsOptions:qt.object}).isRequired;var ng=function(e){var t=Ht.useContext(Bj),i=Ht.useContext(Wf);if(t){if(i)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t}else return Lj(i,e)},cO=["mode"],uO=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Nn=function(e,t){var i="".concat(uO(e),"Element"),o=function(g){var x=g.id,b=g.className,w=g.options,S=w===void 0?{}:w,R=g.onBlur,B=g.onFocus,V=g.onReady,F=g.onChange,H=g.onEscape,W=g.onClick,z=g.onLoadError,ie=g.onLoaderStart,ae=g.onNetworksChange,Y=g.onConfirm,A=g.onCancel,T=g.onShippingAddressChange,E=g.onShippingRateChange,I=g.onSavedPaymentMethodRemove,_=g.onSavedPaymentMethodUpdate,D=ng("mounts <".concat(i,">")),k="elements"in D?D.elements:null,L="checkoutState"in D?D.checkoutState:null,P=L?.type==="success"||L?.type==="loading"?L.sdk:null,O=Ht.useState(null),Q=Oj(O,2),le=Q[0],Ee=Q[1],xe=Ht.useRef(null),U=Ht.useRef(null);sn(le,"blur",R),sn(le,"focus",B),sn(le,"escape",H),sn(le,"click",W),sn(le,"loaderror",z),sn(le,"loaderstart",ie),sn(le,"networkschange",ae),sn(le,"confirm",Y),sn(le,"cancel",A),sn(le,"shippingaddresschange",T),sn(le,"shippingratechange",E),sn(le,"savedpaymentmethodremove",I),sn(le,"savedpaymentmethodupdate",_),sn(le,"change",F);var ee;V&&(e==="expressCheckout"?ee=V:ee=function(){V(le)}),sn(le,"ready",ee),Ht.useLayoutEffect(function(){if(xe.current===null&&U.current!==null&&(k||P)){var fe=null;if(P)switch(e){case"paymentForm":fe=P.createPaymentFormElement(S);break;case"payment":fe=P.createPaymentElement(S);break;case"address":if("mode"in S){var ge=S.mode,Re=XM(S,cO);if(ge==="shipping")fe=P.createShippingAddressElement(Re);else if(ge==="billing")fe=P.createBillingAddressElement(Re);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":fe=P.createExpressCheckoutElement(S);break;case"currencySelector":fe=P.createCurrencySelectorElement();break;case"taxId":fe=P.createTaxIdElement(S);break;default:throw new Error("Invalid Element type ".concat(i,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else k&&(fe=k.create(e,S));xe.current=fe,Ee(fe),fe&&fe.mount(U.current)}},[k,P,S]);var ue=sg(S);return Ht.useEffect(function(){if(xe.current){var fe=Pj(S,ue,["paymentRequest"]);fe&&"update"in xe.current&&xe.current.update(fe)}},[S,ue]),Ht.useLayoutEffect(function(){return function(){if(xe.current&&typeof xe.current.destroy=="function")try{xe.current.destroy(),xe.current=null}catch{}}},[]),Ht.createElement("div",{id:x,className:b,ref:U})},u=function(g){ng("mounts <".concat(i,">"));var x=g.id,b=g.className;return Ht.createElement("div",{id:x,className:b})},d=t?u:o;return d.propTypes={id:qt.string,className:qt.string,onChange:qt.func,onBlur:qt.func,onFocus:qt.func,onReady:qt.func,onEscape:qt.func,onClick:qt.func,onLoadError:qt.func,onLoaderStart:qt.func,onNetworksChange:qt.func,onConfirm:qt.func,onCancel:qt.func,onShippingAddressChange:qt.func,onShippingRateChange:qt.func,onSavedPaymentMethodRemove:qt.func,onSavedPaymentMethodUpdate:qt.func,options:qt.object},d.displayName=i,d.__elementType=e,d},_n=typeof window>"u",dO=Ht.createContext(null);dO.displayName="EmbeddedCheckoutProviderContext";var hO=function(){var e=ng("calls useStripe()"),t=e.stripe;return t};Nn("auBankAccount",_n);var tN=Nn("card",_n);Nn("cardNumber",_n);Nn("cardExpiry",_n);Nn("cardCvc",_n);Nn("iban",_n);Nn("payment",_n);Nn("expressCheckout",_n);Nn("paymentRequestButton",_n);Nn("linkAuthentication",_n);Nn("address",_n);Nn("shippingAddress",_n);Nn("paymentMethodMessaging",_n);Nn("taxId",_n);function qh(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qh=function(e){return typeof e}:qh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qh(n)}var zj="clover",fO=function(e){return e===3?"v3":e},Fj="https://js.stripe.com",mO="".concat(Fj,"/").concat(zj,"/stripe.js"),pO=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,gO=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var xO=function(e){return pO.test(e)||gO.test(e)},bO=function(){for(var e=document.querySelectorAll('script[src^="'.concat(Fj,'"]')),t=0;t<e.length;t++){var i=e[t];if(xO(i.src))return i}return null},sN=function(e){var t="",i=document.createElement("script");i.src="".concat(mO).concat(t);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(i),i},yO=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.7.0",startTime:t})},Jc=null,Nh=null,_h=null,vO=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},wO=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},NO=function(e){return Jc!==null?Jc:(Jc=new Promise(function(t,i){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var o=bO();if(!(o&&e)){if(!o)o=sN(e);else if(o&&_h!==null&&Nh!==null){var u;o.removeEventListener("load",_h),o.removeEventListener("error",Nh),(u=o.parentNode)===null||u===void 0||u.removeChild(o),o=sN(e)}}_h=wO(t,i),Nh=vO(i),o.addEventListener("load",_h),o.addEventListener("error",Nh)}catch(d){i(d);return}}),Jc.catch(function(t){return Jc=null,Promise.reject(t)}))},_O=function(e,t,i){if(e===null)return null;var o=t[0];if(typeof o!="string")throw new Error("Expected publishable key to be of type string, got type ".concat(qh(o)," instead."));var u=o.match(/^pk_test/),d=fO(e.version),p=zj;u&&d!==p&&console.warn("Stripe.js@".concat(d," was loaded on the page, but @stripe/stripe-js@").concat("8.7.0"," expected Stripe.js@").concat(p,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var g=e.apply(void 0,t);return yO(g,i),g},Zc,$j=!1,qj=function(){return Zc||(Zc=NO(null).catch(function(e){return Zc=null,Promise.reject(e)}),Zc)};Promise.resolve().then(function(){return qj()}).catch(function(n){$j||console.warn(n)});var jO=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];$j=!0;var o=Date.now();return qj().then(function(u){return _O(u,t,o)})};const SO=jO("pk_test_51NXZytLhwB1Jyzw82kEuknbGp3F4vTdnqmBrVmzsHqKYeldrpbiWInM6U2v2ojnsLW4u251zbpRk2UiXnwBgiQZo00bK99q5kj"),EO="https://us-central1-scheduler-65e51.cloudfunctions.net",TO={style:{base:{fontSize:"16px",color:"#1e293b",fontFamily:"system-ui, -apple-system, sans-serif","::placeholder":{color:"#94a3b8"}},invalid:{color:"#ef4444",iconColor:"#ef4444"}}};function AO({amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:u,bookingRefCode:d,shopHasConnect:p=!0}){const g=hO(),x=oO(),[b,w]=j.useState(!1),[S,R]=j.useState(null),[B,V]=j.useState(!1),F=async W=>{if(W.preventDefault(),!g||!x)return;w(!0),R(null);const z=x.getElement(tN),{error:ie,paymentMethod:ae}=await g.createPaymentMethod({type:"card",card:z,billing_details:{name:i.name,email:i.email,phone:i.phone}});if(ie){R(ie.message),w(!1);return}if(p&&u)try{const Y=await fetch(`${EO}/createDepositPaymentIntent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:u,amount:n,serviceName:o,clientName:i.name,clientEmail:i.email,bookingRefCode:d,paymentMethodId:ae.id})}),A=await Y.json();if(!Y.ok){A.needsConnect?R("This shop has not connected Stripe yet. Please contact the shop owner."):A.needsOnboarding?R("This shop is still setting up payments. Please try again later."):R(A.error||"Payment failed. Please try again."),w(!1);return}console.log("Payment processed:",A.paymentIntentId),w(!1),e({paymentMethodId:ae.id,paymentIntentId:A.paymentIntentId,last4:ae.card.last4,brand:ae.card.brand,amount:A.amount})}catch(Y){console.error("Payment error:",Y),R("Payment failed. Please try again."),w(!1)}else console.log("Payment method created (no Connect):",ae.id),await new Promise(Y=>setTimeout(Y,500)),w(!1),e({paymentMethodId:ae.id,last4:ae.card.last4,brand:ae.card.brand})},H=W=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(W/100);return r.jsxs("form",{onSubmit:F,className:"space-y-5",children:[r.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 rounded-xl p-5 text-white",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("p",{className:"text-emerald-100 text-sm font-medium",children:["Deposit for ",o]}),r.jsx("p",{className:"text-3xl font-bold mt-1",children:H(n)})]}),r.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:r.jsx(yn,{className:"w-6 h-6"})})]})}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Card Details"}),r.jsx("div",{className:"p-4 border-2 border-slate-200 rounded-xl focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-500/20 transition-all bg-white",children:r.jsx(tN,{options:TO,onChange:W=>{V(W.complete),W.error?R(W.error.message):R(null)}})})]}),S&&r.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:[r.jsx(Cu,{className:"w-4 h-4 flex-shrink-0"}),S]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[r.jsx(pf,{className:"w-3.5 h-3.5"}),r.jsx("span",{children:"Your payment is secured with 256-bit encryption"})]}),r.jsxs("div",{className:"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-700",children:[r.jsx(Cu,{className:"w-4 h-4 flex-shrink-0"}),r.jsxs("span",{children:[r.jsx("strong",{children:"Test Mode:"})," Use card number ",r.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"4242 4242 4242 4242"})," with any future date and CVC."]})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"submit",disabled:b||!g||!B,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold shadow-md shadow-emerald-600/20 hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:b?r.jsxs(r.Fragment,{children:[r.jsx(ea,{className:"w-4 h-4 animate-spin"}),"Processing"]}):r.jsxs(r.Fragment,{children:[r.jsx(pf,{className:"w-4 h-4"}),"Pay ",H(n)]})}),r.jsx("button",{type:"button",onClick:t,disabled:b,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 disabled:opacity-50",children:"Back"})]})]})}function kO({amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:u,bookingRefCode:d,shopHasConnect:p=!0}){return r.jsx(Uj,{stripe:SO,children:r.jsx(AO,{amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:u,bookingRefCode:d,shopHasConnect:p})})}const CO=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function Ba(n){const[e,t]=n.split(":").map(Number);return e*60+t}function nN(n){const e=Math.floor(n/60),t=n%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}function RO(n){const e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${i}`}function IO(n,e,t){if(!t||t.length===0)return!1;for(const i of t){if(!i||!i.start||!i.end)continue;const o=Ba(i.start),u=Ba(i.end);if(n<u&&e>o)return!0}return!1}function DO(n,e){if(!e||e.length===0)return n;const t=[...e].filter(o=>o&&o.start&&o.end).sort((o,u)=>Ba(o.start)-Ba(u.start));let i=n;for(const o of t){const u=Ba(o.start),d=Ba(o.end);if(i<u)break;i<d&&(i=d)}return i}function MO(n,e,t,i,o,u){if(!n)return[];const p=new Date(e+"T12:00:00").getDay(),g=CO[p],x=n[g];if(!x||!x.enabled)return[];const b=Ba(x.start),w=Ba(x.end),S=x.breaks||(x.break?[x.break]:[]),R=t+i,B=[];let V=b;for(;V+t<=w;){const F=V+t;if(IO(V,F,S)){V=DO(V,S);continue}B.push({id:`wh-${o}-${e}-${nN(V)}`,date:e,time:nN(V),duration:t,available:!0,staffId:o,staffName:u,generated:!0}),V+=R}return B}function Hj(n,e,t=0,i=4){const o=[],u=new Date;u.setHours(0,0,0,0);const d=new Date(u);d.setDate(d.getDate()+i*7);for(const p of n){if(!p.weeklyHours)continue;const g=new Date(u);for(;g<d;){const x=RO(g),b=MO(p.weeklyHours,x,e,t,p.id,p.name);o.push(...b),g.setDate(g.getDate()+1)}}return o}function Gj(n,e,t=0){const i=e.filter(o=>!o.status||o.status==="pending"||o.status==="confirmed");return n.filter(o=>{const u=Ba(o.time),d=u+o.duration;return!i.some(g=>{if(o.staffId&&g.staffId&&g.staffId!==o.staffId||g.date!==o.date)return!1;const x=Ba(g.time),b=g.serviceDuration||g.duration||o.duration,w=x+b;return!(d+t<=x||w+t<=u)})})}function Yj(n,e){const t=new Set(e.map(o=>`${o.staffId||""}-${o.date}-${o.time}`)),i=n.filter(o=>{const u=`${o.staffId||""}-${o.date}-${o.time}`;return!t.has(u)});return[...e,...i]}function cu({name:n,className:e="w-12 h-12",bgClass:t="bg-blue-100 text-blue-700"}){const i=(n||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return r.jsx("div",{className:`${e} ${t} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function OO(){return r.jsxs(nt,{to:"/",className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:r.jsx(ga,{className:"w-3.5 h-3.5 text-white"})}),r.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",r.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function PO({member:n,onClose:e}){const[t,i]=j.useState(null),o=n.portfolio||[];return j.useEffect(()=>{const u=d=>{d.key==="Escape"&&(t!==null?i(null):e())};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[t,e]),r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),r.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in",children:[r.jsx("button",{onClick:e,className:"absolute top-4 right-4 w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center text-slate-600 transition-all z-10",children:r.jsx(X,{className:"w-4 h-4"})}),r.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(cu,{name:n.name,className:"w-14 h-14",bgClass:"bg-violet-100 text-violet-700"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name}),n.role&&r.jsx("p",{className:"text-sm text-violet-600 font-medium",children:n.role})]})]}),n.bio&&r.jsx("p",{className:"mt-3 text-sm text-slate-600 leading-relaxed",children:n.bio})]}),r.jsx("div",{className:"p-6",children:o.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Image,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet"})]}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:o.map((u,d)=>r.jsxs("button",{onClick:()=>i(d),className:"group relative aspect-square rounded-xl overflow-hidden bg-slate-100 shadow-sm hover:shadow-md transition-all hover:-translate-y-0.5",children:[r.jsx("img",{src:u.url,alt:u.caption||"Portfolio",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),u.caption&&r.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/70 to-transparent p-2.5 pt-6",children:r.jsx("p",{className:"text-xs text-white font-medium truncate",children:u.caption})})]},d))})})]}),t!==null&&o[t]&&r.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/90",children:[r.jsx("button",{onClick:()=>i(null),className:"absolute top-4 right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:r.jsx(X,{className:"w-5 h-5"})}),t>0&&r.jsx("button",{onClick:()=>i(t-1),className:"absolute left-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:r.jsx(ChevronLeft,{className:"w-5 h-5"})}),t<o.length-1&&r.jsx("button",{onClick:()=>i(t+1),className:"absolute right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:r.jsx(ChevronRight,{className:"w-5 h-5"})}),r.jsxs("div",{className:"max-w-4xl max-h-[85vh] flex flex-col items-center",children:[r.jsx("img",{src:o[t].url,alt:o[t].caption||"Portfolio",className:"max-w-full max-h-[75vh] object-contain rounded-lg"}),o[t].caption&&r.jsx("p",{className:"mt-3 text-sm text-white/90 font-medium text-center px-4",children:o[t].caption}),r.jsxs("p",{className:"mt-1 text-xs text-white/50",children:[t+1," / ",o.length]})]})]})]})}function VO(){const{slug:n}=$o(),[e,t]=j.useState(null),[i,o]=j.useState(null),[u,d]=j.useState(!0),[p,g]=j.useState(!1),[x,b]=j.useState([]),[w,S]=j.useState([]),[R,B]=j.useState(null),[V,F]=j.useState(null),[H,W]=j.useState([]),[z,ie]=j.useState([]),[ae,Y]=j.useState(!1),[A,T]=j.useState(null),[E,I]=j.useState(null),[_,D]=j.useState(""),[k,L]=j.useState(!1),[P,O]=j.useState({name:"",email:"",phone:""}),[Q,le]=j.useState(""),[Ee,xe]=j.useState(!1),[U,ee]=j.useState(null),[ue,fe]=j.useState(!1),[ge,Re]=j.useState("biweekly"),[He,At]=j.useState(null),[ht,rs]=j.useState(!1),[ne,Se]=j.useState(null);j.useEffect(()=>{(async()=>{d(!0),g(!1);try{const we=Ln(Ze(Ne,"shops"),bn("slug","==",n)),Te=await nn(we);if(Te.empty)g(!0);else{const Be=Te.docs[0];t(Be.data()),o(Be.id)}}catch(we){console.error("Error looking up shop:",we),g(!0)}finally{d(!1)}})()},[n]),j.useEffect(()=>{if(!i)return;const de=Gt(Ze(Ne,"shops",i,"services"),it=>{const Le=it.docs.map(ze=>({id:ze.id,...ze.data()})).filter(ze=>ze.active!==!1).sort((ze,kt)=>(ze.name||"").localeCompare(kt.name||""));b(Le)}),we=Gt(Ze(Ne,"shops",i,"availability"),it=>{const Le=new Date,ze=it.docs.map(kt=>({id:kt.id,...kt.data()})).filter(kt=>new Date(`${kt.date}T${kt.time}`)>Le);W(ze)}),Te=Gt(Ze(Ne,"shops",i,"bookings"),it=>{const Le=it.docs.map(ze=>({id:ze.id,...ze.data()}));ie(Le)}),Be=Gt(Ze(Ne,"shops",i,"staff"),it=>{const Le=it.docs.map(ze=>({id:ze.id,...ze.data()})).filter(ze=>ze.active!==!1).sort((ze,kt)=>(ze.name||"").localeCompare(kt.name||""));S(Le)});return()=>{de(),we(),Te(),Be()}},[i]),j.useEffect(()=>{w.length===1?F(w[0]):w.length===0&&F(null)},[w]);const Ve=x.length>0;w.length>0;const Ke=w.length>1,et=e?.bufferMinutes||0,St=j.useMemo(()=>{const de=new Date;let we=H.filter(Le=>Le.available);if(R&&(we=we.filter(Le=>Le.duration>=R.duration)),V&&V!=="any"&&(we=we.filter(Le=>Le.staffId===V.id||!Le.staffId)),!R)return we;const Te=V&&V!=="any"?w.filter(Le=>Le.id===V.id):w,Be=Hj(Te,R.duration,et,4).filter(Le=>new Date(`${Le.date}T${Le.time}`)>de),it=Yj(Be,we);return Gj(it,z,et)},[H,R,V,w,z,et]),qs=(de,we,Te=3)=>{const Be=[],it=new Date(de+"T12:00:00"),Le=new Date(it);Le.setMonth(Le.getMonth()+Te);let ze=new Date(it);for(we==="weekly"?ze.setDate(ze.getDate()+7):we==="biweekly"?ze.setDate(ze.getDate()+14):we==="fourweekly"?ze.setDate(ze.getDate()+28):we==="monthly"&&ze.setMonth(ze.getMonth()+1);ze<=Le;){const kt=ze.getFullYear(),Wt=String(ze.getMonth()+1).padStart(2,"0"),rn=String(ze.getDate()).padStart(2,"0");Be.push(`${kt}-${Wt}-${rn}`),we==="weekly"?ze.setDate(ze.getDate()+7):we==="biweekly"?ze.setDate(ze.getDate()+14):we==="fourweekly"?ze.setDate(ze.getDate()+28):we==="monthly"&&ze.setMonth(ze.getMonth()+1)}return Be},ft=j.useMemo(()=>{if(!ue||!A)return null;const de=qs(A.date,ge),we=R?R.duration:A.duration||60,Te=V&&V!=="any"?V.id:A.staffId,Be=A.time,it=z.filter(ns=>!ns.status||ns.status==="pending"||ns.status==="confirmed"),Le=ns=>{const[Ri,bs]=ns.split(":").map(Number);return Ri*60+bs},ze=Le(Be),kt=ze+we;let Wt=[],rn=[];const ln=new Set;de.forEach(ns=>{it.some(bs=>{if(Te&&bs.staffId&&bs.staffId!==Te||bs.date!==ns)return!1;const on=Le(bs.time),is=bs.serviceDuration||bs.duration||we,ys=on+is,Sn=et||0;return!(kt+Sn<=on||ys+Sn<=ze)})||ln.has(ns)?rn.push(ns):(Wt.push(ns),ln.add(ns))});const na=de.length>0?de[de.length-1]:A.date,aa=new Date(na+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),ra={weekly:"week",biweekly:"2 weeks",fourweekly:"4 weeks",monthly:"month"};return{available:Wt,conflicts:rn,total:Wt.length+1,skipped:rn.length,endDate:aa,intervalLabel:ra[ge]||ge}},[ue,ge,A,R,V,z,et]),mt=de=>{B(de),w.length>1&&F(null),I(null),T(null),Y(!1),D("")},ke=de=>{F(de),I(null),T(null),Y(!1),D("")},Oe=()=>{B(null),w.length>1&&F(null),I(null),T(null),Y(!1)},me=()=>{I(null),T(null),Y(!1),Ke?F(null):Ve&&B(null)},Ye=de=>{T(de),Y(!0),D("")},Ue=()=>{const de="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let we="BK";for(let Te=0;Te<4;Te++)we+=de.charAt(Math.floor(Math.random()*de.length));return we},De=de=>{de.preventDefault(),Vt?rs(!0):Ge()},qe=de=>{Se(de),Ge(de)},Ge=async(de=null)=>{L(!0),At(null);try{const we=Ue(),Te=e?.requireApproval?"pending":"confirmed",Be=ue?`rg-${Date.now()}-${Math.random().toString(36).slice(2,8)}`:null,it=ue&&ft?ft.endDate:null,Le={slotId:A.id,date:A.date,time:A.time,duration:R?R.duration:A.duration,clientName:P.name,clientEmail:P.email,clientPhone:P.phone,bookedAt:new Date().toISOString(),status:Te,refCode:we};if(R&&(Le.serviceId=R.id,Le.serviceName=R.name,Le.servicePrice=R.price,Le.serviceDuration=R.duration,Le.depositPercent=R.depositPercent||0),de||ne){const Wt=de||ne;Le.depositPaid=!0,Le.depositAmount=xs/100,Le.paymentMethodId=Wt.paymentMethodId,Le.cardLast4=Wt.last4,Le.cardBrand=Wt.brand}V&&V!=="any"?(Le.staffId=V.id,Le.staffName=V.name):A.staffId&&(Le.staffId=A.staffId,Le.staffName=A.staffName||""),ue&&Be&&(Le.recurring=!0,Le.recurringInterval=ge,Le.recurringGroupId=Be,Le.recurringUntil=it),await ya(Ze(Ne,"shops",i,"bookings"),Le),A.generated||await at(Xe(Ne,"shops",i,"availability",A.id),{available:!1});let ze=1,kt=0;if(ue&&ft){const Wt=ft.available;kt=ft.skipped;for(const rn of Wt){const ln=Ue(),na={...Le,date:rn,slotId:`recurring-${Be}-${rn}`,refCode:ln,bookedAt:new Date().toISOString()};await ya(Ze(Ne,"shops",i,"bookings"),na),ze++}At({created:ze,skipped:kt})}O({name:"",email:"",phone:""}),Y(!1),rs(!1),Se(null),T(null),B(null),I(null),F(w.length===1?w[0]:null),fe(!1),le(we),e?.requireApproval?D(" Your booking request has been submitted! The shop will review and confirm it shortly."):D(" Booking confirmed! You will receive a confirmation email shortly.")}catch(we){console.error("Booking error:",we),D(" Something went wrong. Please try again.")}finally{L(!1)}},Jt=de=>new Date(de+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),an=de=>{const[we,Te]=de.split(":"),Be=parseInt(we),it=Be>=12?"PM":"AM";return`${Be%12||12}:${Te} ${it}`},jn=de=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(de),Js=de=>{if(de<60)return`${de} min`;const we=Math.floor(de/60),Te=de%60;return Te?`${we}h ${Te}m`:`${we} hour${we>1?"s":""}`};if(u)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking page"})]})});if(p)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(jt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),r.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,r.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),r.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Ya,{className:"w-4 h-4"}),"Go Home"]})]})});const Hs=[...new Set(St.map(de=>de.date))].sort(),gs=E?St.filter(de=>de.date===E):St,Vt=R&&R.depositPercent>0,xs=Vt?Math.round(R.price*(R.depositPercent/100)*100):0,ce=ht?"payment":ae?"form":Ve&&!R?"services":Ke&&!V?"staff":"calendar",_e=[];Ve&&_e.push({key:"services",label:"Service"}),Ke&&_e.push({key:"staff",label:"Stylist"}),_e.push({key:"calendar",label:"Date & Time"}),_e.push({key:"form",label:"Details"}),Vt&&_e.push({key:"payment",label:"Payment"});const je=_e.findIndex(de=>de.key===ce),Fe=["border-l-blue-500","border-l-violet-500","border-l-emerald-500","border-l-amber-500","border-l-rose-500","border-l-cyan-500","border-l-indigo-500","border-l-pink-500","border-l-teal-500"];return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Book your appointment"})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs(nt,{to:`/shop/${n}/login`,className:"flex items-center gap-1.5 px-3.5 py-2 text-xs font-medium text-slate-500 hover:text-slate-700 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[r.jsx(pf,{className:"w-3.5 h-3.5"}),r.jsx("span",{className:"hidden sm:inline",children:"Owner"})]}),r.jsx(OO,{})]})]})}),r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[_e.length>1&&r.jsx("div",{className:"flex items-center justify-center gap-0 mb-8 animate-fade-in",children:_e.map((de,we)=>{const Te=de.key===ce,Be=we<je;return r.jsxs(j.Fragment,{children:[we>0&&r.jsx("div",{className:`w-8 sm:w-14 h-0.5 transition-colors duration-300 ${we<=je?"bg-blue-500":"bg-slate-200"}`}),r.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[r.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 ${Te?"bg-blue-600 text-white shadow-md shadow-blue-600/30 scale-110":Be?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:Be?r.jsx(Cs,{className:"w-5 h-5"}):we+1}),r.jsx("span",{className:`text-xs font-medium hidden sm:block transition-colors ${Te?"text-blue-700":Be?"text-blue-600":"text-slate-400"}`,children:de.label})]})]},de.key)})}),_&&r.jsx("div",{className:"mb-8 animate-scale-in",children:_.startsWith("")?r.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(Ej,{className:"w-8 h-8 text-emerald-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Confirmed!"}),r.jsx("p",{className:"text-slate-600 mb-4",children:"You're all set. We'll send a confirmation to your email."}),He&&r.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[r.jsx(gi,{className:"w-4 h-4"}),"Recurring Series Created"]}),r.jsxs("p",{className:"text-sm text-slate-700",children:[He.created," appointment",He.created!==1?"s":""," booked"]}),He.skipped>0&&r.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",He.skipped," date",He.skipped!==1?"s":""," skipped due to conflicts"]})]}),Q&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),r.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:Q})]}),Q&&r.jsxs("div",{className:"mb-4",children:[r.jsxs(nt,{to:`/shop/${n}/booking/${Q}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[r.jsx(ga,{className:"w-4 h-4"}),"Manage Your Booking"]}),r.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),r.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-lg text-sm text-emerald-700 font-medium",children:[r.jsx(ga,{className:"w-4 h-4"}),"Add to your calendar to remember"]})]}):_.startsWith("")?r.jsxs("div",{className:"bg-white rounded-2xl border border-amber-200 shadow-lg shadow-amber-100/50 p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(Xt,{className:"w-8 h-8 text-amber-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Request Submitted!"}),r.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking request has been submitted! The shop will review and confirm it shortly."}),He&&r.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[r.jsx(gi,{className:"w-4 h-4"}),"Recurring Series Created"]}),r.jsxs("p",{className:"text-sm text-slate-700",children:[He.created," appointment",He.created!==1?"s":""," submitted"]}),He.skipped>0&&r.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",He.skipped," date",He.skipped!==1?"s":""," skipped due to conflicts"]})]}),Q&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),r.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:Q})]}),Q&&r.jsxs("div",{className:"mb-4",children:[r.jsxs(nt,{to:`/shop/${n}/booking/${Q}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[r.jsx(ga,{className:"w-4 h-4"}),"Manage Your Booking"]}),r.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),r.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-700 font-medium",children:[r.jsx(Xt,{className:"w-4 h-4"}),"You'll be notified once it's confirmed"]})]}):r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[r.jsx("span",{children:""}),r.jsx("span",{children:"Something went wrong. Please try again."})]})}),ce==="services"&&r.jsxs("div",{className:"animate-fade-in",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a Service"}),r.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select the service you'd like to book"})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 stagger-children",children:x.map((de,we)=>r.jsxs("button",{onClick:()=>mt(de),className:`group text-left bg-white border-l-4 ${Fe[we%Fe.length]} border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5`,children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors pr-2",children:de.name}),r.jsx("span",{className:"text-xl font-extrabold text-blue-600 whitespace-nowrap",children:jn(de.price)})]}),de.description&&r.jsx("p",{className:"text-sm text-slate-500 mb-3 line-clamp-2 leading-relaxed",children:de.description}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-400",children:[r.jsx(Xt,{className:"w-3.5 h-3.5"}),r.jsx("span",{children:Js(de.duration)})]}),r.jsx("span",{className:"text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]})]},de.id))})]}),ce==="staff"&&r.jsxs("div",{className:"animate-fade-in",children:[Ve&&R&&r.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[r.jsxs("button",{onClick:Oe,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[r.jsx(Ya,{className:"w-3.5 h-3.5"}),"Back"]}),r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[r.jsx(wn,{className:"w-3.5 h-3.5 text-blue-500"}),r.jsx("span",{className:"font-semibold text-slate-800",children:R.name}),r.jsx("span",{className:"text-blue-600 font-bold",children:jn(R.price)})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose Your Stylist"}),r.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select your preferred professional"})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 stagger-children",children:[r.jsxs("button",{onClick:()=>ke("any"),className:"group text-left bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[r.jsxs("div",{className:"flex items-center gap-3.5 mb-3",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(Ft,{className:"w-5 h-5 text-slate-500"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:"Any Available"}),r.jsx("p",{className:"text-xs text-slate-500",children:"First available professional"})]})]}),r.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),w.map(de=>{const we=de.portfolio||[];return r.jsxs("div",{className:"group bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[r.jsxs("button",{onClick:()=>ke(de),className:"w-full text-left",children:[r.jsxs("div",{className:"flex items-center gap-3.5 mb-2",children:[r.jsx(cu,{name:de.name}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:de.name}),de.role&&r.jsx("p",{className:"text-xs text-slate-500",children:de.role})]})]}),de.bio&&r.jsx("p",{className:"text-xs text-slate-500 leading-relaxed mb-2 line-clamp-2",children:de.bio}),we.length>0&&r.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[we.slice(0,3).map((Te,Be)=>r.jsx("img",{src:Te.url,alt:Te.caption||"Work",className:"w-10 h-10 rounded-md object-cover border border-slate-200"},Be)),we.length>3&&r.jsxs("span",{className:"w-10 h-10 rounded-md bg-slate-100 border border-slate-200 flex items-center justify-center text-xs text-slate-500 font-semibold",children:["+",we.length-3]})]}),r.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),we.length>0&&r.jsxs("button",{onClick:Te=>{Te.stopPropagation(),ee(de)},className:"mt-2 w-full flex items-center justify-center gap-1.5 py-1.5 text-xs font-semibold text-violet-600 hover:text-violet-700 hover:bg-violet-50 rounded-lg transition-all",children:[r.jsx(Image,{className:"w-3.5 h-3.5"}),"View Portfolio (",we.length,")"]})]},de.id)})]})]}),ce==="calendar"&&r.jsxs("div",{className:"animate-fade-in",children:[(Ve||Ke)&&r.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[r.jsxs("button",{onClick:me,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[r.jsx(Ya,{className:"w-3.5 h-3.5"}),"Back"]}),R&&r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[r.jsx(wn,{className:"w-3.5 h-3.5 text-blue-500"}),r.jsx("span",{className:"font-semibold text-slate-800",children:R.name}),r.jsx("span",{className:"text-blue-600 font-bold",children:jn(R.price)}),r.jsxs("span",{className:"text-slate-400",children:[" ",Js(R.duration)]})]}),V&&V!=="any"&&r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[r.jsx(cu,{name:V.name,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),r.jsx("span",{className:"font-semibold text-slate-800",children:V.name})]}),V==="any"&&r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm",children:[r.jsx(Ft,{className:"w-3.5 h-3.5 text-slate-500"}),r.jsx("span",{className:"font-semibold text-slate-700",children:"Any Available"})]})]}),Hs.length===0?r.jsx("div",{children:Ee?r.jsx("div",{className:"max-w-lg mx-auto",children:r.jsx(G1,{shopId:i,slug:n,selectedService:R,selectedStaff:V,staffMembers:w,preferredDate:null,onCancel:()=>xe(!1)})}):r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:r.jsx(jt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),r.jsx("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:R?`No time slots available for ${R.name} (${Js(R.duration)}). Join the waitlist to be notified when a slot opens up!`:"Check back soon for new availability, or join the waitlist!"}),r.jsxs("button",{onClick:()=>xe(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:[r.jsx(mf,{className:"w-4 h-4"}),"Join Waitlist"]})]})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Select a Date"}),r.jsx("p",{className:"text-slate-500 text-sm",children:"Pick a day that works for you"})]}),r.jsx("div",{className:"mb-8",children:r.jsx(Dj,{availableDates:Hs,selectedDate:E,onSelectDate:I})}),E&&r.jsxs("div",{className:"animate-slide-down",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",Jt(E)]}),r.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[gs.length," slot",gs.length!==1?"s":""]})]}),gs.length===0?r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:[r.jsx("p",{className:"text-slate-500 mb-4",children:"No times available for this date"}),Ee?r.jsx("div",{className:"mt-4 text-left",children:r.jsx(G1,{shopId:i,slug:n,selectedService:R,selectedStaff:V,staffMembers:w,preferredDate:E,onCancel:()=>xe(!1)})}):r.jsxs("button",{onClick:()=>xe(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[r.jsx(mf,{className:"w-4 h-4"}),"Join the Waitlist"]})]}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:gs.sort((de,we)=>de.time.localeCompare(we.time)).map(de=>r.jsxs("button",{onClick:()=>Ye(de),className:"group bg-white border border-slate-200 hover:border-blue-400 rounded-xl p-4 transition-all duration-200 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5 text-center",children:[r.jsx("div",{className:"text-lg font-bold text-slate-900 group-hover:text-blue-700 transition-colors mb-1",children:an(de.time)}),de.staffName&&V==="any"&&r.jsxs("div",{className:"text-xs text-violet-600 mb-0.5 flex items-center justify-center gap-1",children:[r.jsx(Ft,{className:"w-3 h-3"}),de.staffName]}),r.jsx("div",{className:"text-xs text-slate-400",children:R?Js(R.duration):`${de.duration} min`})]},de.id))})]}),!E&&r.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]}),ce==="form"&&r.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Complete Your Booking"}),r.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Review your details and confirm"}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[R&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(wn,{className:"w-4 h-4 text-blue-600"})}),r.jsx("span",{className:"font-semibold text-slate-800",children:R.name})]}),r.jsx("span",{className:"font-bold text-blue-600",children:jn(R.price)})]}),V&&V!=="any"&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx(cu,{name:V.name,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-800",children:V.name}),V.role&&r.jsxs("span",{className:"text-slate-400 text-sm ml-1.5",children:[" ",V.role]})]})]}),V==="any"&&A?.staffName&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx(cu,{name:A.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),r.jsx("span",{className:"font-semibold text-slate-800",children:A.staffName})]}),r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(jt,{className:"w-4 h-4 text-slate-600"})}),r.jsxs("span",{className:"font-semibold text-slate-800",children:[Jt(A.date)," at ",an(A.time)]})]}),r.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(Xt,{className:"w-4 h-4 text-slate-500"})}),r.jsx("span",{children:R?Js(R.duration):`${A.duration} min`})]})]}),r.jsxs("form",{onSubmit:De,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),r.jsx("input",{type:"text",value:P.name,onChange:de=>O({...P,name:de.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),r.jsx("input",{type:"email",value:P.email,onChange:de=>O({...P,email:de.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),r.jsx("input",{type:"tel",value:P.phone,onChange:de=>O({...P,phone:de.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(gi,{className:"w-4 h-4 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Make this recurring"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Book the same slot on a regular schedule"})]})]}),r.jsx("button",{type:"button",onClick:()=>fe(!ue),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${ue?"bg-blue-500":"bg-slate-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${ue?"translate-x-6":"translate-x-1"}`})})]}),ue&&r.jsxs("div",{className:"space-y-3 pt-1 animate-fade-in",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Repeat every"}),r.jsxs("select",{value:ge,onChange:de=>Re(de.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[r.jsx("option",{value:"weekly",children:"Week"}),r.jsx("option",{value:"biweekly",children:"2 Weeks"}),r.jsx("option",{value:"fourweekly",children:"4 Weeks"}),r.jsx("option",{value:"monthly",children:"Month"})]})]}),ft&&r.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[r.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:[" Every ",ft.intervalLabel," through ",ft.endDate]}),r.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[ft.total," total appointment",ft.total!==1?"s":""]}),ft.skipped>0&&r.jsxs("p",{className:"text-xs text-amber-600 mt-1 font-medium",children:[" ",ft.skipped," date",ft.skipped!==1?"s":""," will be skipped due to existing bookings"]})]})]})]}),Vt&&r.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[r.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:r.jsx(yn,{className:"w-5 h-5 text-emerald-600"})}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-sm font-semibold text-emerald-800",children:["$",(xs/100).toFixed(2)," deposit required"]}),r.jsxs("p",{className:"text-xs text-emerald-600",children:[R.depositPercent,"% of service price  Remaining $",(R.price-xs/100).toFixed(2)," due at appointment"]})]})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"submit",disabled:k,className:`flex-1 flex items-center justify-center gap-2 px-6 py-3.5 ${Vt?"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-600/20 hover:shadow-emerald-600/25":"bg-blue-600 hover:bg-blue-700 shadow-blue-600/20 hover:shadow-blue-600/25"} text-white rounded-xl font-semibold shadow-md hover:shadow-lg transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0`,children:k?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):Vt?r.jsxs(r.Fragment,{children:[r.jsx(yn,{className:"w-4 h-4"}),"Continue to Payment"]}):r.jsxs(r.Fragment,{children:[r.jsx(Cs,{className:"w-4 h-4"}),"Confirm Booking"]})}),r.jsx("button",{type:"button",onClick:()=>{Y(!1),T(null)},className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]}),ce==="payment"&&r.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Secure Payment"}),r.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Complete your deposit to confirm your booking"}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4 mb-6",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(jt,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-slate-800",children:R?.name}),r.jsxs("p",{className:"text-sm text-slate-500",children:[A&&Jt(A.date)," at ",A&&an(A.time)]})]})]}),r.jsxs("div",{className:"text-sm text-slate-600 pl-13",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Client:"})," ",P.name]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Email:"})," ",P.email]})]})]}),!e?.payoutsEnabled&&(!e?.subscriptionTier||e?.subscriptionTier==="free")&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:r.jsx(yn,{className:"w-4 h-4 text-red-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-red-800 text-sm",children:"Booking Unavailable"}),r.jsx("p",{className:"text-xs text-red-700 mt-1",children:"This shop is still setting up their payment system and cannot accept bookings yet. Please check back later or contact the shop directly."})]})]})}),!e?.payoutsEnabled&&e?.subscriptionTier&&e?.subscriptionTier!=="free"&&r.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:r.jsx(yn,{className:"w-4 h-4 text-amber-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-amber-800 text-sm",children:"Payment Setup in Progress"}),r.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"This shop is still setting up their payment system. You can still book, but payment will be collected at the time of your appointment."}),r.jsx("button",{onClick:()=>Ge(),disabled:k,className:"mt-3 flex items-center gap-2 px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg font-semibold text-sm transition-all disabled:opacity-50",children:k?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):r.jsxs(r.Fragment,{children:[r.jsx(Cs,{className:"w-4 h-4"}),"Book Without Deposit"]})})]})]})}),e?.payoutsEnabled&&r.jsx(kO,{amount:xs,serviceName:R?.name||"Service",clientInfo:P,onSuccess:qe,onCancel:()=>rs(!1),shopId:i,bookingRefCode:null,shopHasConnect:e?.payoutsEnabled}),!e?.payoutsEnabled&&r.jsx("button",{onClick:()=>rs(!1),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 mt-4",children:" Back"})]})]}),U&&r.jsx(PO,{member:U,onClose:()=>ee(null)}),r.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:r.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",r.jsx(nt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})}),r.jsx(HM,{services:x,staffMembers:w,shop:e,onSelectService:mt})]})}function LO({slotsByDate:n,bookingsByDate:e,selectedDate:t,onSelectDate:i,recurringDayFlags:o={},breaksByDate:u={}}){const[d,p]=j.useState(new Date),g=ae=>{const Y=ae.getFullYear(),A=ae.getMonth(),T=new Date(Y,A,1),I=new Date(Y,A+1,0).getDate(),_=T.getDay();return{daysInMonth:I,startingDayOfWeek:_,year:Y,month:A}},{daysInMonth:x,startingDayOfWeek:b,year:w,month:S}=g(d),R=()=>{p(new Date(d.getFullYear(),d.getMonth()-1))},B=()=>{p(new Date(d.getFullYear(),d.getMonth()+1))},V=ae=>`${w}-${String(S+1).padStart(2,"0")}-${String(ae).padStart(2,"0")}`,F=ae=>{const Y=V(ae),A=n[Y]||[],T=e[Y]||[],E=u[Y]||[],I=A.filter(k=>k.available).length,_=T.length,D=E.length;return{availableCount:I,bookedCount:_,breakCount:D,hasData:A.length>0||T.length>0||D>0}},H=ae=>{const Y=V(ae);i(Y===t?null:Y)},W=["January","February","March","April","May","June","July","August","September","October","November","December"],z=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ie=new Date;return ie.setHours(0,0,0,0),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-5",children:[r.jsx("button",{onClick:R,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(jj,{className:"w-5 h-5 text-slate-600"})}),r.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[W[S]," ",w]}),r.jsx("button",{onClick:B,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(Gf,{className:"w-5 h-5 text-slate-600"})})]}),r.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:z.map(ae=>r.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:ae},ae))}),r.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:b}).map((ae,Y)=>r.jsx("div",{},`empty-${Y}`)),Array.from({length:x}).map((ae,Y)=>{const A=Y+1,T=V(A),{availableCount:E,bookedCount:I,breakCount:_,hasData:D}=F(A),k=T===t,L=new Date,P=L.getDate()===A&&L.getMonth()===S&&L.getFullYear()===w,O=new Date(w,S,A),Q=O.getDay(),le=o[Q]&&O>=ie;return r.jsxs("button",{onClick:()=>H(A),className:`
                relative p-2 text-center rounded-lg text-sm font-semibold transition-all duration-200 min-h-[56px] flex flex-col items-center justify-start cursor-pointer
                ${k?"bg-blue-600 text-white shadow-md shadow-blue-600/30":D||le?"bg-slate-50 hover:bg-slate-100 text-slate-900 border border-slate-200 hover:border-slate-300":P?"text-slate-900 font-bold hover:bg-slate-50":"text-slate-400 hover:bg-slate-50"}
              `,children:[r.jsxs("span",{className:`text-sm ${P&&!k?"relative":""}`,children:[A,P&&!k&&r.jsx("span",{className:"absolute -bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]}),(D||le)&&r.jsxs("div",{className:"flex gap-0.5 mt-1 flex-wrap justify-center",children:[le&&r.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${k?"bg-white/20 text-white":"bg-violet-100 text-violet-700"}`,children:"R"}),_>0&&r.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${k?"bg-white/20 text-white":"bg-amber-100 text-amber-700"}`,children:""}),E>0&&r.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${k?"bg-white/20 text-white":"bg-emerald-100 text-emerald-700"}`,children:E}),I>0&&r.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${k?"bg-white/20 text-white":"bg-blue-100 text-blue-700"}`,children:I})]})]},A)})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-xs text-slate-500",children:[Object.keys(o).length>0&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3.5 h-3.5 bg-violet-100 border border-violet-200 rounded flex items-center justify-center text-[7px] font-bold text-violet-700",children:"R"}),r.jsx("span",{children:"Recurring"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3.5 h-3.5 bg-amber-100 border border-amber-200 rounded flex items-center justify-center text-[8px]",children:""}),r.jsx("span",{children:"Break"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3.5 h-3.5 bg-emerald-100 border border-emerald-200 rounded"}),r.jsx("span",{children:"Available"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3.5 h-3.5 bg-blue-100 border border-blue-200 rounded"}),r.jsx("span",{children:"Booked"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3.5 h-3.5 bg-blue-600 rounded"}),r.jsx("span",{children:"Selected"})]})]})]})}const UO=[{value:15,label:"15 min"},{value:30,label:"30 min"},{value:45,label:"45 min"},{value:60,label:"1 hour"},{value:90,label:"1.5 hours"},{value:120,label:"2 hours"}],BO=[{value:0,label:"No deposit required"},{value:10,label:"10%"},{value:20,label:"20%"},{value:25,label:"25%"},{value:50,label:"50%"},{value:100,label:"Full payment upfront"}];function zO({shopId:n}){const[e,t]=j.useState([]),[i,o]=j.useState(!1),[u,d]=j.useState(null),[p,g]=j.useState({name:"",description:"",duration:30,price:"",depositPercent:0}),[x,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;const H=Gt(Ze(Ne,"shops",n,"services"),W=>{const z=W.docs.map(ie=>({id:ie.id,...ie.data()})).filter(ie=>ie.active!==!1).sort((ie,ae)=>(ie.name||"").localeCompare(ae.name||""));t(z)});return()=>H()},[n]);const w=()=>{g({name:"",description:"",duration:30,price:"",depositPercent:0}),o(!1),d(null)},S=async H=>{H.preventDefault(),b(!0);const W={name:p.name.trim(),description:p.description.trim(),duration:parseInt(p.duration),price:parseFloat(p.price),depositPercent:parseInt(p.depositPercent)||0,active:!0};try{u?await at(Xe(Ne,"shops",n,"services",u),W):await ya(Ze(Ne,"shops",n,"services"),{...W,createdAt:To()}),w()}catch(z){console.error("Error saving service:",z)}finally{b(!1)}},R=H=>{g({name:H.name,description:H.description||"",duration:H.duration,price:H.price.toString(),depositPercent:H.depositPercent||0}),d(H.id),o(!0)},B=async H=>{try{await at(Xe(Ne,"shops",n,"services",H),{active:!1})}catch(W){console.error("Error deleting service:",W)}},V=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),F=H=>{if(H<60)return`${H} min`;const W=Math.floor(H/60),z=H%60;return z?`${W}h ${z}m`:`${W}h`};return r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Services"}),r.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Define the services you offer  clients will pick one before booking"})]}),!i&&r.jsxs("button",{onClick:()=>{w(),o(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[r.jsx(Qa,{className:"w-4 h-4"}),"Add Service"]})]}),i&&r.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:u?"Edit Service":"New Service"}),r.jsxs("form",{onSubmit:S,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Service Name *"}),r.jsx("input",{type:"text",value:p.name,onChange:H=>g({...p,name:H.target.value}),required:!0,placeholder:"e.g. Haircut",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description (optional)"}),r.jsx("input",{type:"text",value:p.description,onChange:H=>g({...p,description:H.target.value}),placeholder:"e.g. Classic cut and style",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Duration *"}),r.jsx("select",{value:p.duration,onChange:H=>g({...p,duration:H.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:UO.map(H=>r.jsx("option",{value:H.value,children:H.label},H.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Price (USD) *"}),r.jsxs("div",{className:"relative",children:[r.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-semibold",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:p.price,onChange:H=>g({...p,price:H.target.value}),required:!0,placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:r.jsxs("span",{className:"flex items-center gap-1.5",children:[r.jsx(yn,{className:"w-4 h-4 text-emerald-500"}),"Deposit Required"]})}),r.jsx("select",{value:p.depositPercent,onChange:H=>g({...p,depositPercent:H.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:BO.map(H=>r.jsx("option",{value:H.value,children:H.label},H.value))})]})]}),p.depositPercent>0&&p.price&&r.jsxs("div",{className:"flex items-center gap-2 p-3 bg-emerald-50 border border-emerald-200 rounded-lg text-sm",children:[r.jsx(yn,{className:"w-4 h-4 text-emerald-600"}),r.jsxs("span",{className:"text-emerald-800",children:["Clients will pay ",r.jsxs("strong",{children:["$",((parseFloat(p.price)||0)*(parseInt(p.depositPercent)/100)).toFixed(2)]})," deposit at booking",parseInt(p.depositPercent)<100&&r.jsxs("span",{children:[" ($",((parseFloat(p.price)||0)*(1-parseInt(p.depositPercent)/100)).toFixed(2)," remaining due at appointment)"]})]})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsxs("button",{type:"submit",disabled:x,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[r.jsx(Ks,{className:"w-4 h-4"}),x?"Saving":u?"Update Service":"Add Service"]}),r.jsxs("button",{type:"button",onClick:w,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[r.jsx(Fs,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length===0?r.jsxs("div",{className:"text-center py-16",children:[r.jsx("div",{className:"text-5xl mb-3",children:""}),r.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No services yet"}),r.jsx("p",{className:"text-sm text-slate-600",children:"Add your first service so clients can choose what to book"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(H=>r.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:H.name}),H.description&&r.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:H.description})]}),r.jsx("span",{className:"text-xl font-bold text-blue-600 whitespace-nowrap ml-3",children:V(H.price)})]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500 mb-4 flex-wrap",children:[r.jsxs("span",{className:"flex items-center gap-1.5",children:[r.jsx(Xt,{className:"w-4 h-4"}),F(H.duration)]}),H.depositPercent>0&&r.jsxs("span",{className:"flex items-center gap-1.5 text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full text-xs font-medium",children:[r.jsx(yn,{className:"w-3 h-3"}),H.depositPercent,"% deposit"]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:()=>R(H),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:[r.jsx(xx,{className:"w-3.5 h-3.5"}),"Edit"]}),r.jsx("button",{onClick:()=>B(H.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:r.jsx(Lo,{className:"w-3.5 h-3.5"})})]})]},H.id))})]})}const eu=[{key:"monday",label:"Monday",short:"Mon"},{key:"tuesday",label:"Tuesday",short:"Tue"},{key:"wednesday",label:"Wednesday",short:"Wed"},{key:"thursday",label:"Thursday",short:"Thu"},{key:"friday",label:"Friday",short:"Fri"},{key:"saturday",label:"Saturday",short:"Sat"},{key:"sunday",label:"Sunday",short:"Sun"}],aN={enabled:!1,start:"09:00",end:"17:00",breaks:[]};function FO({shopId:n,staffId:e,staffName:t,weeklyHours:i,onClose:o}){const[u,d]=j.useState(()=>{const T={};for(const E of eu){const I=i?.[E.key];if(I){const _=I.breaks||(I.break?[I.break]:[]);T[E.key]={enabled:!!I.enabled,start:I.start||"09:00",end:I.end||"17:00",breaks:_}}else T[E.key]={...aN,breaks:[]}}return T}),[p,g]=j.useState(!1),[x,b]=j.useState(null),[w,S]=j.useState([]),[R,B]=j.useState(!1),[V,F]=j.useState(null);j.useEffect(()=>{if(!n)return;const T=Gt(Ze(Ne,"shops",n,"schedulePresets"),E=>{const I=E.docs.map(_=>({id:_.id,..._.data()})).sort((_,D)=>_.isDefault&&!D.isDefault?-1:!_.isDefault&&D.isDefault?1:(_.name||"").localeCompare(D.name||""));S(I)});return()=>T()},[n]);const H=(T,E,I)=>{d(_=>({..._,[T]:{..._[T],[E]:I}})),F(null)},W=T=>{d(E=>({...E,[T]:{...E[T],breaks:[...E[T].breaks||[],{start:"12:00",end:"13:00"}]}})),F(null)},z=(T,E,I,_)=>{d(D=>{const k=[...D[T].breaks||[]];return k[E]={...k[E],[I]:_},{...D,[T]:{...D[T],breaks:k}}}),F(null)},ie=(T,E)=>{d(I=>({...I,[T]:{...I[T],breaks:I[T].breaks.filter((_,D)=>D!==E)}})),F(null)},ae=T=>{const E=u[T];d(I=>{const _={...I};for(const D of eu)D.key!==T&&(_[D.key]={enabled:E.enabled,start:E.start,end:E.end,breaks:E.breaks.map(k=>({...k}))});return _}),b(T),F(null),setTimeout(()=>b(null),1500)},Y=T=>{if(!T.days)return;const E={};for(const I of eu){const _=T.days[I.key];if(_){const D=_.breaks||(_.break?[_.break]:[]);E[I.key]={enabled:!!_.enabled,start:_.start||"09:00",end:_.end||"17:00",breaks:D.map(k=>({...k}))}}else E[I.key]={...aN,breaks:[]}}d(E),B(!1),F(T.name),setTimeout(()=>F(null),2e3)},A=async()=>{g(!0);try{const T={};for(const E of eu){const I=u[E.key];T[E.key]={enabled:I.enabled,start:I.start,end:I.end,breaks:I.breaks||[],break:I.breaks&&I.breaks.length>0?I.breaks[0]:null}}await at(Xe(Ne,"shops",n,"staff",e),{weeklyHours:T}),o()}catch(T){console.error("Error saving weekly hours:",T)}finally{g(!1)}};return r.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Weekly Hours"}),r.jsx("p",{className:"text-sm text-slate-500",children:t})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[w.length>0&&r.jsxs("div",{className:"relative",children:[r.jsxs("button",{type:"button",onClick:()=>B(!R),className:"flex items-center gap-2 px-4 py-2 bg-violet-50 hover:bg-violet-100 text-violet-700 border border-violet-200 rounded-xl text-sm font-semibold transition-all",children:[r.jsx(jt,{className:"w-4 h-4"}),"Apply Preset",r.jsx(ku,{className:`w-4 h-4 transition-transform ${R?"rotate-180":""}`})]}),R&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>B(!1)}),r.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white border border-slate-200 rounded-xl shadow-xl z-20 py-2 max-h-80 overflow-y-auto",children:w.map(T=>r.jsxs("button",{onClick:()=>Y(T),className:"w-full px-4 py-3 text-left hover:bg-blue-50 transition-colors",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:T.name}),T.isDefault&&r.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded",children:"DEFAULT"})]}),T.description&&r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:T.description})]},T.id))})]})]}),r.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(Fs,{className:"w-5 h-5 text-slate-400"})})]})]}),V&&r.jsxs("div",{className:"mb-4 px-4 py-3 bg-green-50 border border-green-200 rounded-xl flex items-center gap-2 text-sm text-green-700 font-medium animate-fade-in",children:[r.jsx(Ks,{className:"w-4 h-4"}),'Applied "',V,'" preset  click Save to keep changes']}),r.jsx("div",{className:"space-y-3",children:eu.map(({key:T,label:E})=>{const I=u[T],_=I.breaks||[];return r.jsxs("div",{className:`rounded-xl p-4 transition-all ${I.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{type:"button",onClick:()=>H(T,"enabled",!I.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${I.enabled?"bg-blue-500":"bg-slate-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${I.enabled?"translate-x-6":"translate-x-1"}`})}),r.jsx("span",{className:`font-semibold text-sm ${I.enabled?"text-slate-900":"text-slate-400"}`,children:E}),!I.enabled&&r.jsx("span",{className:"text-sm text-slate-400 italic ml-2",children:"Day off"})]}),I.enabled&&r.jsxs("div",{className:"mt-3 ml-14 space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx(Xt,{className:"w-4 h-4 text-blue-500"}),r.jsx("input",{type:"time",value:I.start,onChange:D=>H(T,"start",D.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),r.jsx("input",{type:"time",value:I.end,onChange:D=>H(T,"end",D.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("button",{type:"button",onClick:()=>W(T),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${_.length>0?"bg-amber-100 text-amber-700 border border-amber-200":"bg-slate-100 text-slate-500 border border-slate-200 hover:bg-amber-50 hover:text-amber-600 hover:border-amber-200"}`,children:[r.jsx(ff,{className:"w-3.5 h-3.5"}),_.length>0?`${_.length} Break${_.length>1?"s":""}`:"+ Break"]}),r.jsx("button",{type:"button",onClick:()=>ae(T),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:x===T?" Copied!":"Copy to all"})]})]}),I.enabled&&_.length>0&&r.jsx("div",{className:"mt-2 ml-14 space-y-2",children:_.map((D,k)=>r.jsxs("div",{className:"flex items-start gap-2 animate-fade-in",children:[r.jsx(ff,{className:"w-3.5 h-3.5 text-amber-500 mt-2"}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("span",{className:"text-xs text-slate-500 block mb-1",children:["Break ",k+1]}),r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("input",{type:"time",value:D.start,onChange:L=>z(T,k,"start",L.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),r.jsx("span",{className:"text-slate-400 text-xs",children:"to"}),r.jsx("input",{type:"time",value:D.end,onChange:L=>z(T,k,"end",L.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),r.jsx("button",{type:"button",onClick:()=>ie(T,k),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",title:"Remove break",children:r.jsx(Fs,{className:"w-3.5 h-3.5"})})]})]})]},k))})]},T)})}),r.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t border-slate-200",children:[r.jsxs("button",{onClick:A,disabled:p,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[r.jsx(Tj,{className:"w-4 h-4"}),p?"Saving":"Save Hours"]}),r.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[r.jsx(Fs,{className:"w-4 h-4"}),"Cancel"]})]})]})}const po=[{key:"monday",short:"Mon",label:"Monday"},{key:"tuesday",short:"Tue",label:"Tuesday"},{key:"wednesday",short:"Wed",label:"Wednesday"},{key:"thursday",short:"Thu",label:"Thursday"},{key:"friday",short:"Fri",label:"Friday"},{key:"saturday",short:"Sat",label:"Saturday"},{key:"sunday",short:"Sun",label:"Sunday"}],$O=[{name:"Full-time 9-5",description:"Monday to Friday, 9am to 5pm with lunch break",days:{monday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},tuesday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},wednesday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},thursday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},friday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},saturday:{enabled:!1,start:"09:00",end:"17:00",breaks:[]},sunday:{enabled:!1,start:"09:00",end:"17:00",breaks:[]}},isDefault:!0},{name:"Part-time Mornings",description:"Monday to Friday, 9am to 1pm",days:{monday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},tuesday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},wednesday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},thursday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},friday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},saturday:{enabled:!1,start:"09:00",end:"13:00",breaks:[]},sunday:{enabled:!1,start:"09:00",end:"13:00",breaks:[]}},isDefault:!0},{name:"Weekends Only",description:"Saturday and Sunday, 10am to 6pm",days:{monday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},tuesday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},wednesday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},thursday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},friday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},saturday:{enabled:!0,start:"10:00",end:"18:00",breaks:[{start:"13:00",end:"14:00"}]},sunday:{enabled:!0,start:"10:00",end:"18:00",breaks:[{start:"13:00",end:"14:00"}]}},isDefault:!0}],jh={enabled:!1,start:"09:00",end:"17:00",breaks:[]};function rN(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return t===0?`${o}${i}`:`${o}:${t.toString().padStart(2,"0")}${i}`}function qO({shopId:n}){const[e,t]=j.useState([]),[i,o]=j.useState(!0),[u,d]=j.useState(!1),[p,g]=j.useState(null),[x,b]=j.useState(!1),[w,S]=j.useState({name:"",description:"",days:{}});j.useEffect(()=>{R()},[]),j.useEffect(()=>{if(!n)return;const E=Gt(Ze(Ne,"shops",n,"schedulePresets"),I=>{const _=I.docs.map(D=>({id:D.id,...D.data()})).sort((D,k)=>D.isDefault&&!k.isDefault?-1:!D.isDefault&&k.isDefault?1:(D.name||"").localeCompare(k.name||""));t(_),o(!1)});return()=>E()},[n]);const R=()=>{const E={};po.forEach(I=>{E[I.key]={...jh,breaks:[]}}),S({name:"",description:"",days:E}),g(null),d(!1)},B=async()=>{try{for(const E of $O)await ya(Ze(Ne,"shops",n,"schedulePresets"),{...E,createdAt:To()})}catch(E){console.error("Error initializing default presets:",E)}},V=async E=>{if(E.preventDefault(),!!w.name.trim()){b(!0);try{const I={name:w.name.trim(),description:w.description.trim(),days:w.days,isDefault:!1,updatedAt:To()};p?await at(Xe(Ne,"shops",n,"schedulePresets",p.id),I):await ya(Ze(Ne,"shops",n,"schedulePresets"),{...I,createdAt:To()}),R()}catch(I){console.error("Error saving preset:",I)}finally{b(!1)}}},F=E=>{const I={};po.forEach(_=>{const D=E.days?.[_.key];D?I[_.key]={enabled:!!D.enabled,start:D.start||"09:00",end:D.end||"17:00",breaks:D.breaks||(D.break?[D.break]:[])}:I[_.key]={...jh,breaks:[]}}),S({name:E.name,description:E.description||"",days:I}),g(E),d(!0)},H=async E=>{if(confirm("Delete this schedule preset?"))try{await nj(Xe(Ne,"shops",n,"schedulePresets",E))}catch(I){console.error("Error deleting preset:",I)}},W=E=>{const I={};po.forEach(_=>{const D=E.days?.[_.key];D?I[_.key]={enabled:!!D.enabled,start:D.start||"09:00",end:D.end||"17:00",breaks:[...D.breaks||(D.break?[D.break]:[])]}:I[_.key]={...jh,breaks:[]}}),S({name:`${E.name} (Copy)`,description:E.description||"",days:I}),g(null),d(!0)},z=(E,I,_)=>{S(D=>({...D,days:{...D.days,[E]:{...D.days[E],[I]:_}}}))},ie=E=>{S(I=>({...I,days:{...I.days,[E]:{...I.days[E],breaks:[...I.days[E].breaks||[],{start:"12:00",end:"13:00"}]}}}))},ae=(E,I,_,D)=>{S(k=>{const L=[...k.days[E].breaks||[]];return L[I]={...L[I],[_]:D},{...k,days:{...k.days,[E]:{...k.days[E],breaks:L}}}})},Y=(E,I)=>{S(_=>({..._,days:{..._.days,[E]:{..._.days[E],breaks:_.days[E].breaks.filter((D,k)=>k!==I)}}}))},A=E=>{const I=w.days[E];S(_=>{const D={..._.days};return po.forEach(k=>{k.key!==E&&(D[k.key]={enabled:I.enabled,start:I.start,end:I.end,breaks:I.breaks.map(L=>({...L}))})}),{..._,days:D}})},T=E=>{if(!E.days)return"No schedule configured";const I=po.filter(D=>E.days[D.key]?.enabled);return I.length===0?"No working days":I.map(D=>{const k=E.days[D.key],L=k.breaks||(k.break?[k.break]:[]),P=L.length>0?` (${L.length} break${L.length>1?"s":""})`:"";return`${D.short} ${rN(k.start)}${rN(k.end)}${P}`}).join("  ")};return i?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("div",{className:"spinner"})}):r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Schedule Presets"}),r.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create reusable schedule templates with breaks to quickly apply to staff"})]}),!u&&r.jsxs("button",{onClick:()=>{R(),d(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[r.jsx(Qa,{className:"w-4 h-4"}),"New Preset"]})]}),e.length===0&&!u&&r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 text-center mb-6",children:[r.jsx(jt,{className:"w-10 h-10 text-blue-500 mx-auto mb-3"}),r.jsx("h3",{className:"font-bold text-slate-900 mb-2",children:"Get started with presets"}),r.jsx("p",{className:"text-sm text-slate-600 mb-4",children:'Add common schedule templates like "Full-time 9-5" or "Weekends Only"'}),r.jsxs("button",{onClick:B,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Qa,{className:"w-4 h-4"}),"Add Default Presets"]})]}),u&&r.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 mb-6 shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:p?"Edit Preset":"New Schedule Preset"}),r.jsx("button",{onClick:R,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(Fs,{className:"w-5 h-5 text-slate-400"})})]}),r.jsxs("form",{onSubmit:V,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preset Name *"}),r.jsx("input",{type:"text",value:w.name,onChange:E=>S({...w,name:E.target.value}),placeholder:"e.g., Full-time 9-5",required:!0,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description"}),r.jsx("input",{type:"text",value:w.description,onChange:E=>S({...w,description:E.target.value}),placeholder:"e.g., Standard work week with lunch break",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Weekly Schedule"}),po.map(({key:E,label:I})=>{const _=w.days[E]||jh;return r.jsxs("div",{className:`rounded-xl p-4 transition-all ${_.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:[r.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[r.jsxs("div",{className:"flex items-center gap-3 min-w-[140px]",children:[r.jsx("button",{type:"button",onClick:()=>z(E,"enabled",!_.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${_.enabled?"bg-blue-500":"bg-slate-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${_.enabled?"translate-x-6":"translate-x-1"}`})}),r.jsx("span",{className:`font-semibold text-sm ${_.enabled?"text-slate-900":"text-slate-400"}`,children:I})]}),_.enabled?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Xt,{className:"w-4 h-4 text-blue-500"}),r.jsx("input",{type:"time",value:_.start,onChange:D=>z(E,"start",D.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),r.jsx("input",{type:"time",value:_.end,onChange:D=>z(E,"end",D.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("button",{type:"button",onClick:()=>ie(E),className:"flex items-center gap-1.5 px-3 py-1.5 bg-amber-100 hover:bg-amber-200 text-amber-700 border border-amber-200 rounded-lg text-xs font-semibold transition-all",children:[r.jsx(ff,{className:"w-3.5 h-3.5"}),"+ Break"]}),r.jsx("button",{type:"button",onClick:()=>A(E),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:"Copy to all"})]}):r.jsx("span",{className:"text-sm text-slate-400 italic",children:"Day off"})]}),_.enabled&&_.breaks&&_.breaks.length>0&&r.jsx("div",{className:"mt-3 ml-[140px] space-y-2",children:_.breaks.map((D,k)=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ff,{className:"w-3.5 h-3.5 text-amber-500"}),r.jsx("span",{className:"text-xs text-slate-500",children:"Break:"}),r.jsx("input",{type:"time",value:D.start,onChange:L=>ae(E,k,"start",L.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),r.jsx("span",{className:"text-slate-400 text-xs",children:""}),r.jsx("input",{type:"time",value:D.end,onChange:L=>ae(E,k,"end",L.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),r.jsx("button",{type:"button",onClick:()=>Y(E,k),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",children:r.jsx(Fs,{className:"w-3.5 h-3.5"})})]},k))})]},E)})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsxs("button",{type:"submit",disabled:x,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[r.jsx(Tj,{className:"w-4 h-4"}),x?"Saving":p?"Update Preset":"Save Preset"]}),r.jsxs("button",{type:"button",onClick:R,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[r.jsx(Fs,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length>0&&r.jsx("div",{className:"space-y-3",children:e.map(E=>r.jsx("div",{className:"bg-white border border-slate-200 rounded-xl p-5 hover:shadow-md transition-all",children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h3",{className:"text-base font-bold text-slate-900",children:E.name}),E.isDefault&&r.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-[10px] font-bold rounded-md",children:"DEFAULT"})]}),E.description&&r.jsx("p",{className:"text-sm text-slate-500 mb-2",children:E.description}),r.jsx("p",{className:"text-xs text-slate-400 leading-relaxed",children:T(E)})]}),r.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[r.jsx("button",{onClick:()=>W(E),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"Duplicate preset",children:r.jsx(Sj,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>F(E),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"Edit preset",children:r.jsx(xx,{className:"w-4 h-4"})}),!E.isDefault&&r.jsx("button",{onClick:()=>H(E.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Delete preset",children:r.jsx(Lo,{className:"w-4 h-4"})})]})]})},E.id))})]})}const xr={free:{name:"Free",price:0,staffLimit:1,platformFeePercent:5,features:["basicBooking","emailNotifications"]},pro:{name:"Pro",price:29,priceId:null,staffLimit:5,platformFeePercent:0,features:["basicBooking","emailNotifications","aiAssistant","recurringBookings","waitlist","crm","analytics","smsNotifications","customBranding"]},unlimited:{name:"Unlimited",price:79,priceId:null,staffLimit:1/0,platformFeePercent:0,features:["basicBooking","emailNotifications","aiAssistant","recurringBookings","waitlist","crm","analytics","smsNotifications","customBranding","walkIns","multiLocation","noBranding","apiAccess","prioritySupport"]}},HO={basicBooking:{name:"Online Booking",description:"Accept bookings through your booking page"},emailNotifications:{name:"Email Notifications",description:"Automatic booking confirmations and reminders"},aiAssistant:{name:"AI Booking Assistant",description:"Smart suggestions and automated responses"},recurringBookings:{name:"Recurring Bookings",description:"Schedule repeating appointments"},waitlist:{name:"Waitlist",description:"Let clients join a waitlist when fully booked"},crm:{name:"Client CRM",description:"Client notes, history, and win-back tracking"},analytics:{name:"Analytics",description:"Detailed booking and revenue analytics"},smsNotifications:{name:"SMS Notifications",description:"Send text message reminders to clients"},customBranding:{name:"Custom Branding",description:"Customize colors and branding on your booking page"},walkIns:{name:"Walk-in Queue",description:"Manage walk-in clients with live queue"},multiLocation:{name:"Multi-Location",description:"Manage multiple business locations"},noBranding:{name:"Remove SpotBookie Branding",description:"White-label your booking experience"},apiAccess:{name:"API Access",description:"Integrate with external tools and systems"},prioritySupport:{name:"Priority Support",description:"24/7 priority customer support"}};function Wj(n){const e=n?.subscriptionTier||"free";return xr[e]?.staffLimit||1}function GO(n,e){const t=Wj(n);return e<t}function YO(n,e){const t=xr[n]||xr.free,i=xr[e];return i?i.features.filter(o=>!t.features.includes(o)):[]}function WO(n){const e=["free","pro","unlimited"],t=e.indexOf(n||"free");return e.slice(t+1).map(i=>({key:i,...xr[i],newFeatures:YO(n,i)}))}const QO="https://us-central1-scheduler-65e51.cloudfunctions.net",KO={pro:"price_1Sxx7ILhwB1Jyzw8UvRxE5FT",unlimited:"price_1Sxx7JLhwB1Jyzw8uw9BRYhO"};function XO({isOpen:n,onClose:e,shopId:t,slug:i,currentTier:o="free",feature:u,title:d,description:p}){const[g,x]=j.useState(null),[b,w]=j.useState(null);if(!n)return null;const S=WO(o),R=async B=>{x(B),w(null);try{const V=await fetch(`${QO}/createCheckoutSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:t,priceId:KO[B],successUrl:`${window.location.origin}/#/shop/${i}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/#/shop/${i}/dashboard?subscription=canceled`})}),F=await V.json();if(!V.ok)throw new Error(F.error||"Failed to create checkout session");window.location.href=F.url}catch(V){console.error("Upgrade error:",V),w(V.message),x(null)}};return r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-violet-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20",children:r.jsx(Vo,{className:"w-6 h-6 text-white"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:d||"Upgrade Required"}),r.jsx("p",{className:"text-sm text-slate-500",children:p||"Unlock more features with a premium plan"})]})]}),r.jsx("button",{onClick:e,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",children:r.jsx(Fs,{className:"w-5 h-5"})})]}),b&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:b}),r.jsx("div",{className:"space-y-3",children:S.map(B=>r.jsxs("div",{className:`border-2 rounded-xl p-4 transition-all ${B.key==="pro"?"border-blue-300 bg-blue-50/50":"border-violet-300 bg-violet-50/50"}`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-slate-900",children:B.name}),r.jsxs("p",{className:"text-lg font-extrabold text-slate-900",children:["$",B.price,r.jsx("span",{className:"text-sm font-normal text-slate-500",children:"/month"})]})]}),r.jsx("button",{onClick:()=>R(B.key),disabled:g,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-semibold text-sm transition-all disabled:opacity-50 ${B.key==="pro"?"bg-blue-500 hover:bg-blue-600 text-white shadow-md shadow-blue-500/20":"bg-violet-500 hover:bg-violet-600 text-white shadow-md shadow-violet-500/20"}`,children:g===B.key?r.jsx(ea,{className:"w-4 h-4 animate-spin"}):r.jsxs(r.Fragment,{children:[r.jsx(Qo,{className:"w-4 h-4"}),"Upgrade"]})})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[B.key==="pro"&&r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-blue-200 rounded-lg text-xs font-medium text-blue-700",children:[r.jsx(Ft,{className:"w-3 h-3"}),"5 staff"]}),B.key==="unlimited"&&r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-violet-200 rounded-lg text-xs font-medium text-violet-700",children:[r.jsx(Ft,{className:"w-3 h-3"}),"Unlimited staff"]}),r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-emerald-50 border border-emerald-200 rounded-lg text-xs font-medium text-emerald-700",children:[r.jsx(Ks,{className:"w-3 h-3"}),"No platform fees"]})]})]},B.key))}),r.jsx("p",{className:"text-xs text-slate-400 text-center mt-4",children:"Cancel anytime  14-day money-back guarantee"})]})})}function JO({currentCount:n,limit:e,onUpgradeClick:t}){const i=n>=e,o=n>=e-1&&n<e;return!i&&!o?null:r.jsxs("div",{className:`rounded-xl p-4 flex items-center justify-between gap-4 mb-4 ${i?"bg-amber-50 border border-amber-200":"bg-blue-50 border border-blue-200"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${i?"bg-amber-100":"bg-blue-100"}`,children:r.jsx(Ft,{className:`w-5 h-5 ${i?"text-amber-600":"text-blue-600"}`})}),r.jsxs("div",{children:[r.jsx("p",{className:`font-semibold text-sm ${i?"text-amber-900":"text-blue-900"}`,children:i?"Staff limit reached":"Almost at staff limit"}),r.jsxs("p",{className:"text-xs text-slate-600",children:["You have ",n," of ",e," staff member",e!==1?"s":"",".",i?" Upgrade to add more.":" Upgrade before you need more."]})]})]}),r.jsxs("button",{onClick:t,className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-semibold text-sm transition-all shadow-md flex-shrink-0 ${i?"bg-amber-500 hover:bg-amber-600 text-white shadow-amber-500/20":"bg-blue-500 hover:bg-blue-600 text-white shadow-blue-500/20"}`,children:[r.jsx(Qo,{className:"w-4 h-4"}),"Upgrade"]})]})}const ZO=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}],e9=5*1024*1024,t9=["image/jpeg","image/png","image/webp"];function iN(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return t===0?`${o}${i}`:`${o}:${t.toString().padStart(2,"0")}${i}`}function s9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState([]),[u,d]=j.useState(!1),[p,g]=j.useState(null),[x,b]=j.useState(null),[w,S]=j.useState(null),[R,B]=j.useState({name:"",role:""}),[V,F]=j.useState(!1),[H,W]=j.useState(!1),[z,ie]=j.useState("staff"),[ae,Y]=j.useState([]),[A,T]=j.useState(null),[E,I]=j.useState(null),_=Wj(e),D=GO(e,i.length),[k,L]=j.useState(null),[P,O]=j.useState(""),[Q,le]=j.useState(!1),[Ee,xe]=j.useState(!1),[U,ee]=j.useState(""),[ue,fe]=j.useState(null),[ge,Re]=j.useState(null),[He,At]=j.useState(null),ht=j.useRef(null);j.useEffect(()=>{if(!n)return;const me=Gt(Ze(Ne,"shops",n,"staff"),Ue=>{const De=Ue.docs.map(qe=>({id:qe.id,...qe.data()})).filter(qe=>qe.active!==!1).sort((qe,Ge)=>(qe.name||"").localeCompare(Ge.name||""));o(De)}),Ye=Gt(Ze(Ne,"shops",n,"schedulePresets"),Ue=>{const De=Ue.docs.map(qe=>({id:qe.id,...qe.data()})).sort((qe,Ge)=>qe.isDefault&&!Ge.isDefault?-1:!qe.isDefault&&Ge.isDefault?1:(qe.name||"").localeCompare(Ge.name||""));Y(De)});return()=>{me(),Ye()}},[n]);const rs=async(me,Ye)=>{if(Ye.days)try{const Ue={},De=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];for(const qe of De){const Ge=Ye.days[qe];if(Ge){const Jt=Ge.breaks||(Ge.break?[Ge.break]:[]);Ue[qe]={enabled:!!Ge.enabled,start:Ge.start||"09:00",end:Ge.end||"17:00",breaks:Jt,break:Jt.length>0?Jt[0]:null}}else Ue[qe]={enabled:!1,start:"09:00",end:"17:00",breaks:[],break:null}}await at(Xe(Ne,"shops",n,"staff",me),{weeklyHours:Ue}),T(null),I({staffId:me,presetName:Ye.name}),setTimeout(()=>I(null),2500)}catch(Ue){console.error("Error applying preset:",Ue)}},ne=()=>{B({name:"",role:""}),d(!1),g(null)},Se=async me=>{me.preventDefault(),F(!0);const Ye={name:R.name.trim(),role:R.role.trim(),active:!0};try{p?await at(Xe(Ne,"shops",n,"staff",p),Ye):await ya(Ze(Ne,"shops",n,"staff"),{...Ye,email:"",bio:"",portfolio:[],createdAt:To()}),ne()}catch(Ue){console.error("Error saving staff member:",Ue)}finally{F(!1)}},Ve=me=>{B({name:me.name,role:me.role||""}),g(me.id),d(!0)},Ke=async me=>{try{await at(Xe(Ne,"shops",n,"staff",me),{active:!1})}catch(Ye){console.error("Error deleting staff member:",Ye)}},et=me=>{L(me.id),O(me.bio||"")},St=async me=>{le(!0);try{await at(Xe(Ne,"shops",n,"staff",me),{bio:P.trim()}),L(null),O("")}catch(Ye){console.error("Error saving bio:",Ye)}finally{le(!1)}},qs=me=>{fe(me),ee(""),Re(null),setTimeout(()=>{ht.current&&(ht.current.value="",ht.current.click())},50)},ft=me=>{const Ye=me.target.files?.[0];if(Ye){if(!t9.includes(Ye.type)){alert("Please select a JPG, PNG, or WebP image.");return}if(Ye.size>e9){alert("File size must be under 5MB.");return}Re(Ye)}},mt=async me=>{if(ge){xe(!0);try{const Ye=Date.now(),Ue=ge.name.split(".").pop(),De=`${Ye}.${Ue}`,qe=`shops/${n}/staff/${me}/portfolio/${De}`,Ge=P1(V1,qe);await PI(Ge,ge);const Jt=await VI(Ge),jn=i.find(Js=>Js.id===me)?.portfolio||[];await at(Xe(Ne,"shops",n,"staff",me),{portfolio:[...jn,{url:Jt,storagePath:qe,caption:U.trim(),uploadedAt:new Date().toISOString()}]}),fe(null),ee(""),Re(null)}catch(Ye){console.error("Error uploading photo:",Ye),alert("Upload failed. Please try again.")}finally{xe(!1)}}},ke=async(me,Ye)=>{const Ue=i.find(qe=>qe.id===me);if(!Ue)return;const De=Ue.portfolio[Ye];if(De){At(`${me}-${Ye}`);try{if(De.storagePath)try{const Ge=P1(V1,De.storagePath);await LI(Ge)}catch(Ge){console.warn("Storage delete warning:",Ge)}const qe=Ue.portfolio.filter((Ge,Jt)=>Jt!==Ye);await at(Xe(Ne,"shops",n,"staff",me),{portfolio:qe})}catch(qe){console.error("Error deleting photo:",qe),alert("Failed to delete photo.")}finally{At(null)}}},Oe=me=>{if(!me)return null;const Ye=ZO.filter(Ue=>me[Ue.key]?.enabled);return Ye.length===0?null:Ye.map(Ue=>{const De=me[Ue.key],qe=De.breaks||(De.break?[De.break]:[]),Ge=qe.length>0?` ${qe.length>1?qe.length:""}`:"";return`${Ue.short} ${iN(De.start)}${iN(De.end)}${Ge}`})};return r.jsxs("div",{children:[r.jsx("input",{ref:ht,type:"file",accept:".jpg,.jpeg,.png,.webp",className:"hidden",onChange:ft}),r.jsxs("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl mb-6 w-fit",children:[r.jsxs("button",{onClick:()=>ie("staff"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${z==="staff"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[r.jsx(Ft,{className:"w-4 h-4"}),"Staff Members"]}),r.jsxs("button",{onClick:()=>ie("presets"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${z==="presets"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[r.jsx(jt,{className:"w-4 h-4"}),"Schedule Presets"]})]}),z==="presets"&&r.jsx(qO,{shopId:n}),z==="staff"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Staff"}),r.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Manage your team  assign availability and bookings per staff member"})]}),!u&&(D?r.jsxs("button",{onClick:()=>{ne(),d(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[r.jsx(Qa,{className:"w-4 h-4"}),"Add Staff"]}):r.jsxs("button",{onClick:()=>W(!0),className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white rounded-xl font-semibold shadow-lg shadow-amber-500/30 hover:shadow-xl hover:shadow-amber-500/40 transition-all hover:-translate-y-0.5",children:[r.jsx(Vo,{className:"w-4 h-4"}),"Upgrade to Add More"]}))]}),r.jsx(JO,{currentCount:i.length,limit:_,onUpgradeClick:()=>W(!0)}),r.jsx(XO,{isOpen:H,onClose:()=>W(!1),shopId:n,slug:t,currentTier:e?.subscriptionTier||"free",title:"Add More Staff Members",description:`Your ${e?.subscriptionTier||"Free"} plan allows ${_} staff member${_!==1?"s":""}. Upgrade to add more.`}),u&&r.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:p?"Edit Staff Member":"New Staff Member"}),r.jsxs("form",{onSubmit:Se,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Name *"}),r.jsx("input",{type:"text",value:R.name,onChange:me=>B({...R,name:me.target.value}),required:!0,placeholder:"e.g. Jane Smith",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Role (optional)"}),r.jsx("input",{type:"text",value:R.role,onChange:me=>B({...R,role:me.target.value}),placeholder:"e.g. Senior Stylist",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsxs("button",{type:"submit",disabled:V,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[r.jsx(Ks,{className:"w-4 h-4"}),V?"Saving":p?"Update Staff":"Add Staff"]}),r.jsxs("button",{type:"button",onClick:ne,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[r.jsx(Fs,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),i.length===0?r.jsxs("div",{className:"text-center py-16",children:[r.jsx("div",{className:"text-5xl mb-3",children:""}),r.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No staff members yet"}),r.jsx("p",{className:"text-sm text-slate-600",children:"Add your team members to assign them availability and bookings"})]}):r.jsx("div",{className:"space-y-4",children:i.map(me=>{const Ye=Oe(me.weeklyHours),Ue=me.portfolio||[];return r.jsxs("div",{children:[r.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:me.name}),me.role&&r.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:me.role})]}),r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(Ft,{className:"w-5 h-5 text-blue-600"})})]}),r.jsx("div",{className:"mb-3",children:k===me.id?r.jsxs("div",{className:"space-y-2",children:[r.jsx("textarea",{value:P,onChange:De=>O(De.target.value),placeholder:"Write a short bio  specialties, experience, personality",rows:3,maxLength:500,className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none transition-all"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>St(me.id),disabled:Q,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[Q?r.jsx(ea,{className:"w-3 h-3 animate-spin"}):r.jsx(Ks,{className:"w-3 h-3"}),"Save Bio"]}),r.jsx("button",{onClick:()=>{L(null),O("")},className:"px-3 py-1.5 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"}),r.jsxs("span",{className:"text-xs text-slate-400 ml-auto",children:[P.length,"/500"]})]})]}):r.jsx("div",{onClick:()=>et(me),className:"cursor-pointer group",children:me.bio?r.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed group-hover:text-slate-800 transition-colors",children:[me.bio,r.jsx("span",{className:"ml-1.5 text-xs text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",children:"edit"})]}):r.jsx("p",{className:"text-sm text-slate-400 italic group-hover:text-blue-500 transition-colors",children:"+ Add a bio"})})}),Ye?r.jsx("div",{className:"mb-3 flex flex-wrap gap-1.5",children:Ye.map((De,qe)=>r.jsx("span",{className:"inline-block px-2 py-0.5 bg-green-50 text-green-700 border border-green-200 rounded text-xs font-medium",children:De},qe))}):r.jsx("p",{className:"text-xs text-slate-400 mb-3 italic",children:"No weekly hours set"}),Ue.length>0&&w!==me.id&&r.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[r.jsx("div",{className:"flex -space-x-1",children:Ue.slice(0,4).map((De,qe)=>r.jsx("img",{src:De.url,alt:De.caption||"Portfolio",className:"w-10 h-10 rounded-lg object-cover border-2 border-white shadow-sm"},qe))}),r.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[Ue.length," photo",Ue.length!==1?"s":""]})]}),E?.staffId===me.id&&r.jsxs("div",{className:"mb-3 px-3 py-2 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-xs text-green-700 font-medium animate-fade-in",children:[r.jsx(Ks,{className:"w-3.5 h-3.5"}),'Applied "',E.presetName,'" schedule']}),r.jsxs("div",{className:"flex gap-2 flex-wrap",children:[r.jsxs("button",{onClick:()=>b(x===me.id?null:me.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${x===me.id?"bg-blue-100 text-blue-700 border-blue-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:[r.jsx(Xt,{className:"w-3.5 h-3.5"}),"Set Hours"]}),ae.length>0&&r.jsxs("div",{className:"relative",children:[r.jsxs("button",{onClick:()=>T(A===me.id?null:me.id),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${A===me.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-violet-50 hover:bg-violet-100 text-violet-700 border-violet-200"}`,children:[r.jsx(jt,{className:"w-3.5 h-3.5"}),"Apply Preset",r.jsx(ku,{className:`w-3 h-3 transition-transform ${A===me.id?"rotate-180":""}`})]}),A===me.id&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>T(null)}),r.jsx("div",{className:"absolute top-full right-0 mt-1 w-56 bg-white border border-slate-200 rounded-xl shadow-xl z-20 py-2 max-h-64 overflow-y-auto",children:ae.map(De=>r.jsxs("button",{onClick:()=>rs(me.id,De),className:"w-full px-4 py-2.5 text-left hover:bg-blue-50 transition-colors",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-medium text-slate-900 text-sm",children:De.name}),De.isDefault&&r.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded",children:"DEFAULT"})]}),De.description&&r.jsx("p",{className:"text-xs text-slate-500 mt-0.5 line-clamp-1",children:De.description})]},De.id))})]})]}),r.jsx("button",{onClick:()=>S(w===me.id?null:me.id),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${w===me.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:r.jsx(fD,{className:"w-3.5 h-3.5"})}),r.jsx("button",{onClick:()=>Ve(me),className:"flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:r.jsx(xx,{className:"w-3.5 h-3.5"})}),r.jsx("button",{onClick:()=>Ke(me.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:r.jsx(Lo,{className:"w-3.5 h-3.5"})})]})]}),x===me.id&&r.jsx("div",{className:"mt-2",children:r.jsx(FO,{shopId:n,staffId:me.id,staffName:me.name,weeklyHours:me.weeklyHours,onClose:()=>b(null)})}),w===me.id&&r.jsxs("div",{className:"mt-2 bg-white border-2 border-violet-200 rounded-xl p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h4",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[r.jsx(qD,{className:"w-4 h-4 text-violet-600"}),"Portfolio  ",me.name]}),r.jsxs("button",{onClick:()=>qs(me.id),disabled:Ee,className:"flex items-center gap-1.5 px-3 py-1.5 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[r.jsx(Qa,{className:"w-3 h-3"}),"Add Photo"]})]}),ue===me.id&&ge&&r.jsxs("div",{className:"mb-4 p-3 bg-violet-50 border border-violet-200 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"w-16 h-16 rounded-lg bg-slate-200 overflow-hidden flex-shrink-0",children:r.jsx("img",{src:URL.createObjectURL(ge),alt:"Preview",className:"w-full h-full object-cover"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-xs text-slate-600 font-medium mb-1 truncate",children:ge.name}),r.jsxs("p",{className:"text-xs text-slate-400",children:[(ge.size/1024/1024).toFixed(1)," MB"]})]})]}),r.jsx("input",{type:"text",value:U,onChange:De=>ee(De.target.value),placeholder:"Add a caption (optional)",maxLength:200,className:"w-full px-3 py-2 text-sm border border-violet-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-400 focus:border-transparent mb-2"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>mt(me.id),disabled:Ee,className:"flex items-center gap-1.5 px-4 py-2 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:Ee?r.jsxs(r.Fragment,{children:[r.jsx(ea,{className:"w-3 h-3 animate-spin"}),"Uploading"]}):r.jsxs(r.Fragment,{children:[r.jsx(Ks,{className:"w-3 h-3"}),"Upload"]})}),r.jsx("button",{onClick:()=>{fe(null),Re(null),ee("")},className:"px-3 py-2 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}),Ue.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"text-3xl mb-2",children:""}),r.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet. Add some to showcase work!"})]}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:Ue.map((De,qe)=>r.jsxs("div",{className:"group relative bg-slate-50 rounded-lg overflow-hidden border border-slate-200 shadow-sm",children:[r.jsx("div",{className:"aspect-square",children:r.jsx("img",{src:De.url,alt:De.caption||"Portfolio photo",className:"w-full h-full object-cover"})}),De.caption&&r.jsx("div",{className:"px-2 py-1.5",children:r.jsx("p",{className:"text-xs text-slate-600 truncate",children:De.caption})}),r.jsx("button",{onClick:()=>ke(me.id,qe),disabled:He===`${me.id}-${qe}`,className:"absolute top-1.5 right-1.5 w-7 h-7 bg-red-500/90 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-md disabled:opacity-50",title:"Delete photo",children:He===`${me.id}-${qe}`?r.jsx(ea,{className:"w-3.5 h-3.5 animate-spin"}):r.jsx(Lo,{className:"w-3.5 h-3.5"})})]},qe))})]})]},me.id)})})]})]})}function al(n){return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}function n9(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function rl(n){return`$${Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function lN(n){return new Date(n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}function oN(n){return new Date(n+"T12:00:00").toLocaleDateString("en-US",{weekday:"short"})}function b0(n,e){return e===0&&n===0?0:e===0?100:(n-e)/e*100}function a9({bookings:n}){const[e,t]=j.useState(null),[i,o]=j.useState(null),u=j.useMemo(()=>n.filter(L=>L.status==="confirmed"||L.status==="pending"||!L.status),[n]),d=j.useMemo(()=>{const L=new Date;return L.setHours(0,0,0,0),L},[]),p=j.useMemo(()=>al(d),[d]),g=j.useMemo(()=>n9(d),[d]),x=j.useMemo(()=>{const L=new Date(g);return L.setDate(L.getDate()+6),L},[g]),b=j.useMemo(()=>{const L=new Date(g);return L.setDate(L.getDate()-7),L},[g]),w=j.useMemo(()=>{const L=new Date(b);return L.setDate(L.getDate()+6),L},[b]),S=j.useMemo(()=>new Date(d.getFullYear(),d.getMonth(),1),[d]),R=j.useMemo(()=>new Date(d.getFullYear(),d.getMonth()-1,1),[d]),B=j.useMemo(()=>{const L=new Date(S);return L.setDate(L.getDate()-1),L},[S]),V=j.useMemo(()=>{const L=new Date(d);return L.setDate(L.getDate()-1),al(L)},[d]),F=j.useMemo(()=>{const L=ue=>ue.reduce((fe,ge)=>fe+(Number(ge.servicePrice)||0),0),P=(ue,fe,ge)=>ue.date>=al(fe)&&ue.date<=al(ge),O=L(u.filter(ue=>ue.date===p)),Q=L(u.filter(ue=>ue.date===V)),le=L(u.filter(ue=>P(ue,g,x))),Ee=L(u.filter(ue=>P(ue,b,w))),xe=L(u.filter(ue=>P(ue,S,d))),U=L(u.filter(ue=>P(ue,R,B))),ee=L(u);return{today:O,todayChange:b0(O,Q),week:le,weekChange:b0(le,Ee),month:xe,monthChange:b0(xe,U),allTime:ee}},[u,p,V,g,x,b,w,S,B,d]),H=j.useMemo(()=>{const L=[];for(let P=13;P>=0;P--){const O=new Date(d);O.setDate(O.getDate()-P),L.push(al(O))}return L},[d]),W=j.useMemo(()=>{const L={};return H.forEach(P=>{L[P]=0}),u.forEach(P=>{L[P.date]!==void 0&&(L[P.date]+=Number(P.servicePrice)||0)}),H.map(P=>({date:P,value:L[P]}))},[u,H]),z=j.useMemo(()=>Math.max(...W.map(L=>L.value),1),[W]),ie=j.useMemo(()=>{const L={},P={};return H.forEach(O=>{L[O]=0,P[O]=0}),n.forEach(O=>{L[O.date]!==void 0&&(O.status==="cancelled"||O.status==="rejected"?P[O.date]++:L[O.date]++)}),H.map(O=>({date:O,confirmed:L[O],cancelled:P[O],total:L[O]+P[O]}))},[n,H]),ae=j.useMemo(()=>Math.max(...ie.map(L=>L.total),1),[ie]),Y=j.useMemo(()=>{const L=n.length;if(L===0)return 100;const P=n.filter(O=>O.status==="cancelled"||O.status==="rejected").length;return Math.round((L-P)/L*100)},[n]),A=j.useMemo(()=>{const L=Array.from({length:7},()=>Array(24).fill(0));u.forEach(O=>{if(!O.date||!O.time)return;const le=new Date(O.date+"T12:00:00").getDay(),Ee=parseInt(O.time.split(":")[0],10);!isNaN(le)&&!isNaN(Ee)&&L[le][Ee]++});let P=0;return L.forEach(O=>O.forEach(Q=>{Q>P&&(P=Q)})),{grid:L,max:P}},[u]),T=j.useMemo(()=>{const L={};return u.forEach(P=>{const O=P.serviceName||"Unknown";L[O]||(L[O]={name:O,count:0,revenue:0}),L[O].count++,L[O].revenue+=Number(P.servicePrice)||0}),Object.values(L).map(P=>({...P,avgRevenue:P.count>0?P.revenue/P.count:0})).sort((P,O)=>O.revenue-P.revenue)},[u]),E=j.useMemo(()=>{const L={};return u.forEach(P=>{const O=P.staffName||"Unassigned";L[O]||(L[O]={name:O,count:0,revenue:0,clients:new Set}),L[O].count++,L[O].revenue+=Number(P.servicePrice)||0,P.clientEmail&&L[O].clients.add(P.clientEmail.toLowerCase())}),Object.values(L).map(P=>({...P,clientCount:P.clients.size})).sort((P,O)=>O.revenue-P.revenue)},[u]),I=j.useMemo(()=>{const L=u.map(ge=>ge.clientEmail?.toLowerCase()).filter(Boolean),P=new Set(L).size,O=u.filter(ge=>ge.date>=al(S)&&ge.date<=p),Q=new Set(O.map(ge=>ge.clientEmail?.toLowerCase()).filter(Boolean)),le=u.filter(ge=>ge.date<al(S)),Ee=new Set(le.map(ge=>ge.clientEmail?.toLowerCase()).filter(Boolean));let xe=0,U=0;Q.forEach(ge=>{Ee.has(ge)?U++:xe++});const ee={};u.forEach(ge=>{const Re=ge.clientEmail?.toLowerCase();Re&&(ee[Re]||(ee[Re]={email:Re,name:ge.clientName||Re,count:0}),ee[Re].count++,ge.clientName&&(ee[Re].name=ge.clientName))});const ue=Object.values(ee).sort((ge,Re)=>Re.count-ge.count).slice(0,10),fe=P>0?u.length/P:0;return{uniqueClients:P,newThisMonth:xe,returningThisMonth:U,topClients:ue,avgBookingsPerClient:fe}},[u,S,p]),_=({value:L,suffix:P="vs prev"})=>{if(L===0)return r.jsxs("span",{className:"flex items-center gap-0.5 text-xs font-medium text-slate-400",children:[r.jsx(rM,{className:"w-3 h-3"})," 0% ",P]});const O=L>0;return r.jsxs("span",{className:`flex items-center gap-0.5 text-xs font-semibold ${O?"text-emerald-600":"text-red-500"}`,children:[O?r.jsx(Nj,{className:"w-3 h-3"}):r.jsx(KI,{className:"w-3 h-3"}),O?"+":"",Math.round(L),"% ",P]})},D=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],k=Array.from({length:15},(L,P)=>P+7);return r.jsxs("div",{className:"animate-fade-in space-y-6",children:[r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Today's Revenue",value:F.today,change:F.todayChange,suffix:"vs yesterday",icon:ko,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:F.week,change:F.weekChange,suffix:"vs last week",icon:Uo,color:"bg-violet-100 text-violet-600"},{label:"This Month",value:F.month,change:F.monthChange,suffix:"vs last month",icon:jt,color:"bg-emerald-100 text-emerald-600"},{label:"All-time Revenue",value:F.allTime,change:null,icon:px,color:"bg-amber-100 text-amber-600"}].map(L=>{const P=L.icon;return r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:`w-10 h-10 ${L.color} rounded-xl flex items-center justify-center`,children:r.jsx(P,{className:"w-5 h-5"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:rl(L.value)}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5 mb-1",children:L.label}),L.change!==null&&r.jsx(_,{value:L.change,suffix:L.suffix})]},L.label)})}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Revenue"}),r.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Last 14 days  confirmed & pending bookings"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[600px]",children:[r.jsxs("div",{className:"flex items-end gap-0",children:[r.jsxs("div",{className:"flex flex-col justify-between h-48 pr-2 text-right flex-shrink-0 w-16",children:[r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:rl(z)}),r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:rl(z/2)}),r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"$0"})]}),r.jsx("div",{className:"flex-1 flex items-end gap-1 h-48 border-b border-l border-slate-200 pl-1 pb-0 relative",children:W.map((L,P)=>{const O=z>0?L.value/z*100:0,Q=e===P;return r.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative group",onMouseEnter:()=>t(P),onMouseLeave:()=>t(null),onTouchStart:()=>t(P),children:[Q&&r.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[rl(L.value),r.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),r.jsx("div",{className:"w-full rounded-t-md transition-all duration-200 cursor-pointer",style:{height:`${Math.max(O,L.value>0?2:0)}%`,background:Q?"linear-gradient(to top, #2563eb, #60a5fa)":"linear-gradient(to top, #3b82f6, #93c5fd)",minHeight:L.value>0?"4px":"0px"}})]},L.date)})})]}),r.jsx("div",{className:"flex ml-16 pl-1",children:W.map(L=>r.jsxs("div",{className:"flex-1 text-center",children:[r.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:oN(L.date)}),r.jsx("div",{className:"text-[9px] text-slate-400",children:lN(L.date)})]},L.date))})]})})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-5",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Booking Trends"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Last 14 days breakdown"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[r.jsxs("span",{className:"flex items-center gap-1.5",children:[r.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-blue-500"})," Confirmed"]}),r.jsxs("span",{className:"flex items-center gap-1.5",children:[r.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-red-400"})," Cancelled"]}),r.jsxs("span",{className:"px-2.5 py-1 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-lg font-semibold",children:[Y,"% completion"]})]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[600px]",children:[r.jsxs("div",{className:"flex items-end gap-0",children:[r.jsxs("div",{className:"flex flex-col justify-between h-40 pr-2 text-right flex-shrink-0 w-16",children:[r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:ae}),r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:Math.round(ae/2)}),r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"0"})]}),r.jsx("div",{className:"flex-1 flex items-end gap-1 h-40 border-b border-l border-slate-200 pl-1 relative",children:ie.map((L,P)=>{const O=ae>0?L.confirmed/ae*100:0,Q=ae>0?L.cancelled/ae*100:0,le=i===P;return r.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative",onMouseEnter:()=>o(P),onMouseLeave:()=>o(null),onTouchStart:()=>o(P),children:[le&&r.jsxs("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[L.confirmed," confirmed, ",L.cancelled," cancelled",r.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),r.jsxs("div",{className:"w-full flex flex-col items-stretch",children:[L.cancelled>0&&r.jsx("div",{className:"w-full rounded-t-md bg-red-400 transition-all duration-200",style:{height:`${Math.max(Q,2)}%`}}),L.confirmed>0&&r.jsx("div",{className:`w-full bg-blue-500 transition-all duration-200 ${L.cancelled===0?"rounded-t-md":""}`,style:{height:`${Math.max(O,2)}%`}})]})]},L.date)})})]}),r.jsx("div",{className:"flex ml-16 pl-1",children:ie.map(L=>r.jsxs("div",{className:"flex-1 text-center",children:[r.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:oN(L.date)}),r.jsx("div",{className:"text-[9px] text-slate-400",children:lN(L.date)})]},L.date))})]})})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Busiest Times"}),r.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Booking density by day of week and hour"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[600px]",children:[r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"w-12"}),k.map(L=>r.jsxs("th",{className:"text-[10px] text-slate-400 font-medium pb-2 text-center px-0.5",children:[L%12||12,L>=12?"p":"a"]},L))]})}),r.jsx("tbody",{children:[1,2,3,4,5,6,0].map(L=>r.jsxs("tr",{children:[r.jsx("td",{className:"text-[11px] text-slate-500 font-semibold pr-2 py-0.5 text-right",children:D[L]}),k.map(P=>{const O=A.grid[L][P],Q=A.max||1,le=O/Q;let Ee="bg-slate-50";return O>0&&(le<=.2?Ee="bg-blue-100":le<=.4?Ee="bg-blue-200":le<=.6?Ee="bg-blue-300":le<=.8?Ee="bg-blue-500 text-white":Ee="bg-blue-700 text-white"),r.jsx("td",{className:"px-0.5 py-0.5",children:r.jsx("div",{className:`w-full aspect-square rounded-sm ${Ee} flex items-center justify-center text-[9px] font-bold transition-all hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 cursor-default`,title:`${D[L]} ${P}:00  ${O} booking${O!==1?"s":""}`,children:O>0?O:""})},P)})]},L))})]}),r.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-3",children:[r.jsx("span",{className:"text-[10px] text-slate-400",children:"Less"}),["bg-slate-50","bg-blue-100","bg-blue-200","bg-blue-300","bg-blue-500","bg-blue-700"].map((L,P)=>r.jsx("div",{className:`w-4 h-4 rounded-sm ${L} border border-slate-200`},P)),r.jsx("span",{className:"text-[10px] text-slate-400",children:"More"})]})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Top Services"}),r.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Ranked by revenue from confirmed & pending bookings"}),T.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(wn,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-slate-400",children:"No service data yet"})]}):r.jsx("div",{className:"space-y-2",children:T.map((L,P)=>r.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm flex-shrink-0",children:P+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:L.name}),r.jsxs("div",{className:"text-xs text-slate-500",children:[L.count," booking",L.count!==1?"s":"","  avg ",rl(L.avgRevenue)]})]}),r.jsx("div",{className:"text-sm font-bold text-blue-600 flex-shrink-0",children:rl(L.revenue)})]},L.name))})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Staff Performance"}),r.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Bookings, revenue & clients per staff member"}),E.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Ft,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-slate-400",children:"No staff data yet"})]}):r.jsx("div",{className:"space-y-2",children:E.map((L,P)=>r.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[r.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center text-violet-600 font-bold text-sm flex-shrink-0",children:P+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:L.name}),r.jsxs("div",{className:"text-xs text-slate-500",children:[L.count," booking",L.count!==1?"s":"","  ",L.clientCount," client",L.clientCount!==1?"s":""]})]}),r.jsx("div",{className:"text-sm font-bold text-violet-600 flex-shrink-0",children:rl(L.revenue)})]},L.name))})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Insights"}),r.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Understanding your client base"}),r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[r.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-100 p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:I.uniqueClients}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Unique Clients"})]}),r.jsxs("div",{className:"bg-emerald-50 rounded-xl border border-emerald-100 p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-extrabold text-emerald-700",children:I.newThisMonth}),r.jsx("div",{className:"text-xs font-medium text-emerald-600 mt-0.5",children:"New This Month"})]}),r.jsxs("div",{className:"bg-blue-50 rounded-xl border border-blue-100 p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-extrabold text-blue-700",children:I.returningThisMonth}),r.jsx("div",{className:"text-xs font-medium text-blue-600 mt-0.5",children:"Returning This Month"})]}),r.jsxs("div",{className:"bg-violet-50 rounded-xl border border-violet-100 p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-extrabold text-violet-700",children:I.avgBookingsPerClient.toFixed(1)}),r.jsx("div",{className:"text-xs font-medium text-violet-600 mt-0.5",children:"Avg Bookings / Client"})]})]}),r.jsx("h4",{className:"text-sm font-bold text-slate-700 mb-3",children:"Top Clients by Frequency"}),I.topClients.length===0?r.jsxs("div",{className:"text-center py-6",children:[r.jsx(wl,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-slate-400",children:"No client data yet"})]}):r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:I.topClients.map((L,P)=>r.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[r.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center text-amber-700 font-bold text-xs flex-shrink-0",children:P+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:L.name}),r.jsx("div",{className:"text-xs text-slate-400 truncate",children:L.email})]}),r.jsxs("div",{className:"flex-shrink-0 px-2.5 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-bold",children:[L.count," visit",L.count!==1?"s":""]})]},L.email))})]})]})}function Qj({waitingAhead:n=[],inProgress:e=[],staffCount:t=1,upcomingBookings:i=[],defaultDuration:o=30}){const u=Math.max(t,1),d=Date.now(),p=e.map(b=>{const w=b.startedAt?.toDate?.()||(b.startedAt?new Date(b.startedAt):null);if(!w)return 0;const S=(d-w.getTime())/6e4,R=b.estimatedDuration||o;return Math.max(0,R-S)});p.sort((b,w)=>b-w);const g=[];for(let b=0;b<u;b++)g.push(p[b]||0);g.sort((b,w)=>b-w);const x=n.map(b=>b.estimatedDuration||o);for(const b of x)g[0]+=b,g.sort((w,S)=>w-S);return Math.round(g[0])}function Kj({waitingQueue:n=[],inProgress:e=[],staffCount:t=1,upcomingBookings:i=[],defaultDuration:o=30}){const u=new Map;for(let d=0;d<n.length;d++){const p=n.slice(0,d),g=Qj({waitingAhead:p,inProgress:e,staffCount:t,upcomingBookings:i,defaultDuration:o});u.set(n[d].id,g)}return u}function r9(n=[],e=3){const t=new Date,i=new Date(t.getTime()+e*60*60*1e3),o=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return n.filter(u=>{if(u.status==="cancelled"||u.status==="rejected"||u.date!==o)return!1;const d=new Date(`${u.date}T${u.time}`);return d>=t&&d<=i}).sort((u,d)=>`${u.time}`.localeCompare(`${d.time}`))}function i9(n){if(!n)return"0m";const e=n?.toDate?.()||new Date(n),t=Math.floor((Date.now()-e.getTime())/6e4);if(t<1)return"<1m";if(t<60)return`${t}m`;const i=Math.floor(t/60),o=t%60;return o>0?`${i}h ${o}m`:`${i}h`}function l9(n){if(n==null)return"";if(n<1)return"Next up";if(n<60)return`~${n}m`;const e=Math.floor(n/60),t=n%60;return t>0?`~${e}h ${t}m`:`~${e}h`}function o9({shopId:n,services:e,staff:t,bookings:i}){const[o,u]=j.useState([]),[d,p]=j.useState(!1),[g,x]=j.useState(!1),[b,w]=j.useState(!1),[S,R]=j.useState({clientName:"",serviceId:"",staffId:"",estimatedDuration:30});j.useEffect(()=>{if(!n)return;const P=Gt(Ze(Ne,"shops",n,"walkins"),O=>{const Q=O.docs.map(le=>({id:le.id,...le.data()}));u(Q)});return()=>P()},[n]);const B=j.useMemo(()=>o.filter(P=>P.status==="waiting").sort((P,O)=>(P.position||0)-(O.position||0)),[o]),V=j.useMemo(()=>o.filter(P=>P.status==="in-progress").sort((P,O)=>{const Q=P.startedAt?.toDate?.()?.getTime()||0,le=O.startedAt?.toDate?.()?.getTime()||0;return Q-le}),[o]),F=j.useMemo(()=>{const P=new Date;return P.setHours(0,0,0,0),P},[]),H=j.useMemo(()=>o.filter(P=>{if(P.status!=="completed"&&P.status!=="no-show")return!1;const O=P.completedAt?.toDate?.()||(P.completedAt?new Date(P.completedAt):null);return O?O>=F:!1}).sort((P,O)=>{const Q=P.completedAt?.toDate?.()?.getTime()||0;return(O.completedAt?.toDate?.()?.getTime()||0)-Q}),[o,F]),W=j.useMemo(()=>Math.max(t.filter(P=>P.active!==!1).length,1),[t]),z=j.useMemo(()=>r9(i,3),[i]),ie=j.useMemo(()=>Kj({waitingQueue:B,inProgress:V,staffCount:W,upcomingBookings:z,defaultDuration:30}),[B,V,W,z]),ae=j.useMemo(()=>{const P=H.filter(Q=>Q.status==="completed"&&Q.joinedAt&&Q.startedAt).map(Q=>{const le=Q.joinedAt?.toDate?.()||new Date(Q.joinedAt),Ee=Q.startedAt?.toDate?.()||new Date(Q.startedAt);return Math.floor((Ee.getTime()-le.getTime())/6e4)}).filter(Q=>Q>=0),O=P.length>0?Math.round(P.reduce((Q,le)=>Q+le,0)/P.length):0;return{waiting:B.length,avgWait:O,completedToday:H.filter(Q=>Q.status==="completed").length}},[B,H]),Y=P=>{const O=e.find(Q=>Q.id===P);R(Q=>({...Q,serviceId:P,estimatedDuration:O?.duration||30}))},A=()=>B.length===0?1:Math.max(...B.map(P=>P.position||0))+1,T=j.useMemo(()=>o.filter(P=>{const O=P.joinedAt?.toDate?.()||(P.joinedAt?new Date(P.joinedAt):null);return O&&O>=F}).length,[o,F]),E=async P=>{P.preventDefault(),w(!0);const O=e.find(xe=>xe.id===S.serviceId),Q=t.find(xe=>xe.id===S.staffId),le=A(),Ee=S.clientName.trim()||`Walk-in #${T+1}`;try{await ya(Ze(Ne,"shops",n,"walkins"),{clientName:Ee,serviceId:S.serviceId||null,serviceName:O?.name||null,staffId:S.staffId||null,staffName:Q?.name||null,estimatedDuration:parseInt(S.estimatedDuration)||30,status:"waiting",position:le,joinedAt:It.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),R({clientName:"",serviceId:"",staffId:"",estimatedDuration:30}),p(!1)}catch(xe){console.error("Error adding walk-in:",xe)}finally{w(!1)}},I=async P=>{try{await at(Xe(Ne,"shops",n,"walkins",P),{status:"in-progress",startedAt:It.now()});const O=B.filter(Q=>Q.id!==P).sort((Q,le)=>(Q.position||0)-(le.position||0));for(let Q=0;Q<O.length;Q++)await at(Xe(Ne,"shops",n,"walkins",O[Q].id),{position:Q+1})}catch(O){console.error("Error starting service:",O)}},_=async P=>{try{await at(Xe(Ne,"shops",n,"walkins",P),{status:"completed",completedAt:It.now()})}catch(O){console.error("Error completing service:",O)}},D=async P=>{try{await at(Xe(Ne,"shops",n,"walkins",P),{status:"no-show",completedAt:It.now()});const O=B.filter(Q=>Q.id!==P).sort((Q,le)=>(Q.position||0)-(le.position||0));for(let Q=0;Q<O.length;Q++)await at(Xe(Ne,"shops",n,"walkins",O[Q].id),{position:Q+1})}catch(O){console.error("Error marking no-show:",O)}},k=async P=>{const O=B.findIndex(Ee=>Ee.id===P);if(O<=0)return;const Q=B[O-1],le=B[O];try{await at(Xe(Ne,"shops",n,"walkins",le.id),{position:Q.position}),await at(Xe(Ne,"shops",n,"walkins",Q.id),{position:le.position})}catch(Ee){console.error("Error reordering:",Ee)}},L=async P=>{const O=B.findIndex(Ee=>Ee.id===P);if(O<0||O>=B.length-1)return;const Q=B[O+1],le=B[O];try{await at(Xe(Ne,"shops",n,"walkins",le.id),{position:Q.position}),await at(Xe(Ne,"shops",n,"walkins",Q.id),{position:le.position})}catch(Ee){console.error("Error reordering:",Ee)}};return r.jsxs("div",{className:"animate-fade-in",children:[r.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[{label:"Currently Waiting",value:ae.waiting,icon:Ft,color:"bg-blue-100 text-blue-600"},{label:"Avg Wait",value:ae.avgWait>0?`${ae.avgWait}m`:"",icon:Rj,color:"bg-amber-100 text-amber-600"},{label:"Completed Today",value:ae.completedToday,icon:Uo,color:"bg-emerald-100 text-emerald-600"}].map(P=>{const O=P.icon;return r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:`w-10 h-10 ${P.color} rounded-xl flex items-center justify-center`,children:r.jsx(O,{className:"w-5 h-5"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:P.value}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:P.label})]},P.label)})}),z.length>0&&r.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(vl,{className:"w-4 h-4 text-amber-600"}),r.jsx("span",{className:"text-sm font-bold text-amber-800",children:"Upcoming Online Bookings"})]}),r.jsx("div",{className:"space-y-1",children:z.slice(0,5).map(P=>{const[O,Q]=(P.time||"").split(":"),le=parseInt(O),Ee=`${le%12||12}:${Q} ${le>=12?"PM":"AM"}`;return r.jsxs("div",{className:"text-xs text-amber-700 flex items-center gap-2",children:[r.jsx(Xt,{className:"w-3 h-3"}),r.jsx("span",{className:"font-medium",children:Ee}),r.jsx("span",{children:""}),r.jsx("span",{children:P.clientName}),P.serviceName&&r.jsxs("span",{className:"text-amber-500",children:["(",P.serviceName,")"]}),P.staffName&&r.jsxs("span",{className:"text-violet-600",children:["with ",P.staffName]})]},P.id)})})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Walk-in Queue"}),!d&&r.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[r.jsx(Qa,{className:"w-4 h-4"}),"Add Walk-in"]})]}),d&&r.jsxs("form",{onSubmit:E,className:"mb-5 p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[r.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3",children:"New Walk-in"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Client Name"}),r.jsx("input",{type:"text",value:S.clientName,onChange:P=>R(O=>({...O,clientName:P.target.value})),placeholder:`Walk-in #${T+1}`,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Service"}),r.jsxs("select",{value:S.serviceId,onChange:P=>Y(P.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[r.jsx("option",{value:"",children:"No service selected"}),e.map(P=>r.jsxs("option",{value:P.id,children:[P.name," (",P.duration,"min)"]},P.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Staff Preference"}),r.jsxs("select",{value:S.staffId,onChange:P=>R(O=>({...O,staffId:P.target.value})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[r.jsx("option",{value:"",children:"Next available"}),t.map(P=>r.jsx("option",{value:P.id,children:P.name},P.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Est. Duration (min)"}),r.jsx("select",{value:S.estimatedDuration,onChange:P=>R(O=>({...O,estimatedDuration:parseInt(P.target.value)})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[15,30,45,60,90,120].map(P=>r.jsx("option",{value:P,children:P<60?`${P} min`:`${P/60}h${P%60?` ${P%60}m`:""}`},P))})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{type:"submit",disabled:b,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[r.jsx(Qa,{className:"w-4 h-4"}),b?"Adding":"Add to Queue"]}),r.jsx("button",{type:"button",onClick:()=>{p(!1),R({clientName:"",serviceId:"",staffId:"",estimatedDuration:30})},className:"px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Cancel"})]})]}),B.length===0&&V.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Ft,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No walk-ins in queue"}),r.jsx("p",{className:"text-xs text-slate-400",children:"Add a walk-in client to start the queue."})]}):r.jsxs(r.Fragment,{children:[B.length>0&&r.jsxs("div",{className:"mb-5",children:[r.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[r.jsx(Xt,{className:"w-4 h-4 text-blue-500"}),"Waiting",r.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:B.length})]}),r.jsx("div",{className:"space-y-2",children:B.map((P,O)=>{const Q=ie.get(P.id);return r.jsxs("div",{className:"group flex items-center gap-3 border border-slate-200 rounded-xl p-3.5 hover:border-slate-300 hover:shadow-sm transition-all",children:[r.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[r.jsx("button",{onClick:()=>k(P.id),disabled:O===0,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:r.jsx(Q0,{className:"w-4 h-4"})}),r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center font-bold text-blue-700 text-sm",children:O+1}),r.jsx("button",{onClick:()=>L(P.id),disabled:O===B.length-1,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:r.jsx(ku,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:P.clientName}),r.jsx("span",{className:"px-2 py-0.5 bg-blue-50 text-blue-600 border border-blue-200 text-[10px] font-bold rounded-md",children:"WAITING"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[P.serviceName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(wn,{className:"w-3 h-3 text-blue-400"}),P.serviceName]}),P.staffName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(wl,{className:"w-3 h-3 text-violet-400"}),P.staffName]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Xt,{className:"w-3 h-3"}),P.estimatedDuration||30,"min"]})]})]}),r.jsxs("div",{className:"text-right mr-2",children:[r.jsx("div",{className:"text-sm font-bold text-amber-600",children:l9(Q)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"est. wait"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsxs("button",{onClick:()=>I(P.id),className:"flex items-center gap-1 px-3 py-2 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 border border-emerald-200 rounded-lg text-xs font-semibold transition-all",title:"Start Service",children:[r.jsx(m0,{className:"w-3.5 h-3.5"}),r.jsx("span",{className:"hidden sm:inline",children:"Start"})]}),r.jsxs("button",{onClick:()=>D(P.id),className:"flex items-center gap-1 px-3 py-2 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all",title:"No-show",children:[r.jsx(La,{className:"w-3.5 h-3.5"}),r.jsx("span",{className:"hidden sm:inline",children:"No-show"})]})]})]},P.id)})})]}),V.length>0&&r.jsxs("div",{className:"mb-5",children:[r.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[r.jsx(m0,{className:"w-4 h-4 text-emerald-500"}),"In Progress",r.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 border border-emerald-200 text-xs font-bold rounded-full",children:V.length})]}),r.jsx("div",{className:"space-y-2",children:V.map(P=>r.jsxs("div",{className:"flex items-center gap-3 border border-emerald-200 bg-emerald-50/50 rounded-xl p-3.5 transition-all",children:[r.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center",children:r.jsx(m0,{className:"w-4 h-4 text-emerald-600"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:P.clientName}),r.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 text-[10px] font-bold rounded-md",children:"IN PROGRESS"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[P.serviceName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(wn,{className:"w-3 h-3 text-blue-400"}),P.serviceName]}),P.staffName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(wl,{className:"w-3 h-3 text-violet-400"}),P.staffName]})]})]}),r.jsxs("div",{className:"text-right mr-2",children:[r.jsx("div",{className:"text-sm font-bold text-emerald-600",children:i9(P.startedAt)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"elapsed"})]}),r.jsxs("button",{onClick:()=>_(P.id),className:"flex items-center gap-1 px-3 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 rounded-lg text-xs font-semibold transition-all",title:"Complete",children:[r.jsx(Cs,{className:"w-3.5 h-3.5"}),r.jsx("span",{className:"hidden sm:inline",children:"Complete"})]})]},P.id))})]})]})]}),H.length>0&&r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("button",{onClick:()=>x(!g),className:"w-full flex items-center justify-between",children:[r.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[r.jsx(Cs,{className:"w-4 h-4 text-slate-400"}),"Completed Today",r.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-500 border border-slate-200 text-xs font-bold rounded-full",children:H.length})]}),r.jsx(Gf,{className:`w-4 h-4 text-slate-400 transition-transform ${g?"rotate-90":""}`})]}),g&&r.jsx("div",{className:"mt-3 space-y-2",children:H.map(P=>r.jsxs("div",{className:"flex items-center gap-3 border border-slate-100 rounded-lg p-3 bg-slate-50/50",children:[r.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center bg-slate-100",children:P.status==="no-show"?r.jsx(La,{className:"w-3.5 h-3.5 text-red-400"}):r.jsx(Cs,{className:"w-3.5 h-3.5 text-emerald-400"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-medium text-slate-700 text-sm truncate",children:P.clientName}),r.jsx("span",{className:`text-[10px] font-bold rounded-md px-1.5 py-0.5 border ${P.status==="no-show"?"bg-red-50 text-red-600 border-red-200":"bg-emerald-50 text-emerald-600 border-emerald-200"}`,children:P.status==="no-show"?"NO-SHOW":"COMPLETED"})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[P.serviceName&&r.jsx("span",{children:P.serviceName}),P.staffName&&r.jsxs("span",{children:[" ",P.staffName]})]})]})]},P.id))})]})]})}function c9(n,e){const t=new Date(n+"T12:00:00"),i=e.getTime()-t.getTime();return Math.floor(i/864e5)}function Sh(n){return`$${Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function tu(n){return n?new Date(n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function u9(n,e,t){return n>90?"lost":n>t?"at-risk":n>e?"getting-cold":"active"}const Eh={active:{label:"Active",bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200",icon:gx,iconColor:"text-emerald-500"},"getting-cold":{label:"Getting Cold",bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",icon:Cj,iconColor:"text-amber-500"},"at-risk":{label:"At Risk",bg:"bg-orange-50",text:"text-orange-700",border:"border-orange-200",icon:vl,iconColor:"text-orange-500"},lost:{label:"Lost",bg:"bg-red-50",text:"text-red-700",border:"border-red-200",icon:OD,iconColor:"text-red-500"}};function d9({shopId:n,bookings:e,shop:t,slug:i}){const[o,u]=j.useState({}),[d,p]=j.useState(null),[g,x]=j.useState(null),[b,w]=j.useState(""),[S,R]=j.useState(""),[B,V]=j.useState("all"),[F,H]=j.useState("lastVisit"),[W,z]=j.useState("asc"),[ie,ae]=j.useState(null),[Y,A]=j.useState(!1),[T,E]=j.useState(null),[I,_]=j.useState(!1),[D,k]=j.useState(null),L=t?.winbackSettings?.warningDays||30,P=t?.winbackSettings?.inactiveDays||60,O=t?.winbackSettings?.enabled!==!1,Q=ne=>ne.toLowerCase().replace(/\./g,"_dot_").replace(/@/g,"_at_");j.useEffect(()=>{if(!n)return;const ne=Gt(Ze(Ne,"shops",n,"clientNotes"),Se=>{const Ve={};Se.docs.forEach(Ke=>{Ve[Ke.id]=Ke.data()}),u(Ve)});return()=>ne()},[n]);const le=j.useMemo(()=>new Date,[]),Ee=j.useMemo(()=>e.filter(ne=>ne.status==="confirmed"||ne.status==="pending"||!ne.status),[e]),xe=j.useMemo(()=>{const ne={};return Ee.forEach(Se=>{const Ve=Se.clientEmail?.toLowerCase();if(!Ve)return;ne[Ve]||(ne[Ve]={email:Ve,name:Se.clientName||Ve,phone:Se.clientPhone||"",totalVisits:0,totalSpent:0,lastVisitDate:null,firstVisitDate:null,bookings:[],serviceFrequency:{},staffFrequency:{}});const Ke=ne[Ve];Se.clientName&&(Ke.name=Se.clientName),Se.clientPhone&&(Ke.phone=Se.clientPhone),Ke.totalVisits++,Ke.totalSpent+=Number(Se.servicePrice)||0,Ke.bookings.push(Se),(!Ke.lastVisitDate||Se.date>Ke.lastVisitDate)&&(Ke.lastVisitDate=Se.date),(!Ke.firstVisitDate||Se.date<Ke.firstVisitDate)&&(Ke.firstVisitDate=Se.date),Se.serviceName&&(Ke.serviceFrequency[Se.serviceName]=(Ke.serviceFrequency[Se.serviceName]||0)+1),Se.staffName&&(Ke.staffFrequency[Se.staffName]=(Ke.staffFrequency[Se.staffName]||0)+1)}),Object.values(ne).map(Se=>{const Ve=Se.lastVisitDate?c9(Se.lastVisitDate,le):999,Ke=u9(Ve,L,P),et=Object.entries(Se.serviceFrequency).sort((ke,Oe)=>Oe[1]-ke[1])[0]?.[0]||null,St=Object.entries(Se.staffFrequency).sort((ke,Oe)=>Oe[1]-ke[1])[0]?.[0]||null,qs=Se.totalVisits>0?Se.totalSpent/Se.totalVisits:0,ft=Q(Se.email),mt=o[ft];return{...Se,daysSinceLastVisit:Ve,status:Ke,favoriteService:et,favoriteStaff:St,avgSpending:qs,encodedEmail:ft,notes:mt?.notes||"",contacted:mt?.contacted||!1,contactedAt:mt?.contactedAt||null,tags:mt?.tags||[]}})},[Ee,le,L,P,o]),U=j.useMemo(()=>{const ne={all:xe.length,active:0,"getting-cold":0,"at-risk":0,lost:0};return xe.forEach(Se=>{ne[Se.status]++}),ne},[xe]),ee=j.useMemo(()=>xe.filter(ne=>(ne.status==="at-risk"||ne.status==="lost")&&!ne.contacted),[xe]),ue=j.useMemo(()=>{let ne=xe;if(S.trim()){const Se=S.toLowerCase();ne=ne.filter(Ve=>Ve.name.toLowerCase().includes(Se)||Ve.email.includes(Se)||Ve.phone.includes(Se))}return B!=="all"&&(ne=ne.filter(Se=>Se.status===B)),ne=[...ne].sort((Se,Ve)=>{if(F==="lastVisit"){const Ke=(Se.lastVisitDate||"").localeCompare(Ve.lastVisitDate||"");return W==="asc"?Ke:-Ke}return F==="totalVisits"?W==="desc"?Ve.totalVisits-Se.totalVisits:Se.totalVisits-Ve.totalVisits:F==="totalSpent"?W==="desc"?Ve.totalSpent-Se.totalSpent:Se.totalSpent-Ve.totalSpent:0}),ne},[xe,S,B,F,W]),fe=ne=>{F===ne?z(Se=>Se==="asc"?"desc":"asc"):(H(ne),z(ne==="lastVisit"?"asc":"desc"))},ge=j.useCallback(ne=>{const Se=t?.name||"our shop",Ve=`${window.location.origin}${window.location.pathname}#/shop/${i}`;return`Hi ${ne.name.split(" ")[0]}, we miss you at ${Se}! It's been ${ne.daysSinceLastVisit} days since your last visit.${ne.favoriteService?` Book your next ${ne.favoriteService} today:`:" Book your next appointment:"} ${Ve}`},[t,i]),Re=ne=>{const Se=ge(ne);E({email:ne.email,encodedEmail:ne.encodedEmail,name:ne.name,message:Se})},He=async(ne,Se)=>{try{await navigator.clipboard.writeText(ne),ae(Se),setTimeout(()=>ae(null),2e3)}catch(Ve){console.error("Failed to copy:",Ve)}},At=async ne=>{k(ne);try{const Se=Xe(Ne,"shops",n,"clientNotes",ne),Ve=await u0(Se),Ke=Ve.exists()?Ve.data():{};await d0(Se,{...Ke,contacted:!0,contactedAt:new Date().toISOString()}),E(null)}catch(Se){console.error("Error marking as contacted:",Se)}finally{k(null)}},ht=async ne=>{try{const Se=Xe(Ne,"shops",n,"clientNotes",ne),Ve=await u0(Se),Ke=Ve.exists()?Ve.data():{};await d0(Se,{...Ke,contacted:!1,contactedAt:null})}catch(Se){console.error("Error resetting contacted status:",Se)}},rs=async ne=>{_(!0);try{const Se=Xe(Ne,"shops",n,"clientNotes",ne),Ve=await u0(Se),Ke=Ve.exists()?Ve.data():{};await d0(Se,{...Ke,notes:b}),x(null)}catch(Se){console.error("Error saving notes:",Se)}finally{_(!1)}};return r.jsxs("div",{className:"animate-fade-in space-y-6",children:[O&&ee.length>0&&r.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-5",children:[r.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>A(!Y),children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:r.jsx(vl,{className:"w-5 h-5 text-orange-600"})}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[ee.length," client",ee.length!==1?"s":""," need",ee.length===1?"s":""," attention"]}),r.jsxs("p",{className:"text-xs text-slate-500",children:["Haven't visited in over ",P," days  send a win-back message to re-engage"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"px-2.5 py-1 bg-orange-100 text-orange-700 border border-orange-200 text-xs font-bold rounded-lg",children:ee.length}),Y?r.jsx(Q0,{className:"w-5 h-5 text-slate-400"}):r.jsx(ku,{className:"w-5 h-5 text-slate-400"})]})]}),Y&&r.jsx("div",{className:"mt-4 space-y-2.5",children:ee.sort((ne,Se)=>Se.daysSinceLastVisit-ne.daysSinceLastVisit).map(ne=>r.jsxs("div",{className:"bg-white rounded-xl border border-orange-100 p-4 flex items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[r.jsx("div",{className:"w-9 h-9 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(wl,{className:"w-4 h-4 text-orange-600"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:ne.name}),r.jsxs("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Eh[ne.status].bg} ${Eh[ne.status].text} ${Eh[ne.status].border}`,children:[ne.daysSinceLastVisit," days ago"]})]}),r.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 flex-wrap mt-0.5",children:[r.jsxs("span",{children:["Last: ",tu(ne.lastVisitDate)]}),ne.favoriteService&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-slate-300",children:""}),r.jsxs("span",{className:"text-blue-600",children:["Loves ",ne.favoriteService]})]}),r.jsx("span",{className:"text-slate-300",children:""}),r.jsxs("span",{children:[ne.totalVisits," visit",ne.totalVisits!==1?"s":""]})]})]})]}),r.jsxs("button",{onClick:Se=>{Se.stopPropagation(),Re(ne)},className:"flex items-center gap-1.5 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-xl text-xs font-semibold transition-all shadow-sm flex-shrink-0",children:[r.jsx(Bh,{className:"w-3.5 h-3.5"}),"Send Win-back"]})]},ne.email))})]}),T&&r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:r.jsx(J0,{className:"w-5 h-5 text-orange-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Win-back Message"}),r.jsxs("p",{className:"text-sm text-slate-500",children:["Send to ",T.name]})]})]}),r.jsx("div",{className:"bg-slate-50 rounded-xl p-4 mb-4 border border-slate-200",children:r.jsx("textarea",{value:T.message,onChange:ne=>E({...T,message:ne.target.value}),rows:4,className:"w-full bg-transparent text-sm text-slate-700 resize-none focus:outline-none leading-relaxed"})}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{He(T.message,T.email)},className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:ie===T.email?r.jsxs(r.Fragment,{children:[r.jsx(Ks,{className:"w-4 h-4"}),"Copied!"]}):r.jsxs(r.Fragment,{children:[r.jsx(Sj,{className:"w-4 h-4"}),"Copy to Clipboard"]})}),r.jsxs("button",{onClick:()=>At(T.encodedEmail),disabled:D===T.encodedEmail,className:"flex items-center justify-center gap-2 px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-emerald-600/20 disabled:opacity-50",children:[r.jsx(Ks,{className:"w-4 h-4"}),"Mark Contacted"]}),r.jsx("button",{onClick:()=>E(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Close"})]})]})}),r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Clients",value:U.all,icon:Ft,color:"bg-blue-100 text-blue-600"},{label:"Active",value:U.active,icon:gx,color:"bg-emerald-100 text-emerald-600"},{label:"Getting Cold",value:U["getting-cold"],icon:Cj,color:"bg-amber-100 text-amber-600"},{label:"At Risk / Lost",value:U["at-risk"]+U.lost,icon:vl,color:"bg-red-100 text-red-600"}].map(ne=>{const Se=ne.icon;return r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:`w-10 h-10 ${ne.color} rounded-xl flex items-center justify-center`,children:r.jsx(Se,{className:"w-5 h-5"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:ne.value}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:ne.label})]},ne.label)})}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Clients"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Derived from booking history"})]}),r.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[ue.length," client",ue.length!==1?"s":""]})]}),r.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[r.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[r.jsx(eg,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2"}),r.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:S,onChange:ne=>R(ne.target.value),className:"w-full pl-10 pr-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),S&&r.jsx("button",{onClick:()=>R(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:r.jsx(Fs,{className:"w-4 h-4 text-slate-400 hover:text-slate-600"})})]}),r.jsx("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl overflow-x-auto",children:[{key:"all",label:"All"},{key:"active",label:"Active"},{key:"getting-cold",label:"Cold"},{key:"at-risk",label:"At Risk"},{key:"lost",label:"Lost"}].map(ne=>r.jsxs("button",{onClick:()=>V(ne.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap ${B===ne.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[ne.label,r.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${B===ne.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:U[ne.key]??0})]},ne.key))}),r.jsx("div",{className:"flex items-center gap-1",children:[{key:"lastVisit",label:"Last Visit"},{key:"totalVisits",label:"Visits"},{key:"totalSpent",label:"Spent"}].map(ne=>r.jsxs("button",{onClick:()=>fe(ne.key),className:`flex items-center gap-1 px-3 py-2 rounded-lg text-xs font-semibold transition-all border ${F===ne.key?"bg-blue-50 text-blue-700 border-blue-200":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[ne.label,F===ne.key&&r.jsx(eD,{className:"w-3 h-3"})]},ne.key))})]}),ue.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Ft,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No clients found"}),r.jsx("p",{className:"text-xs text-slate-400",children:S?"Try a different search term":"Client data will appear as bookings come in"})]}):r.jsx("div",{className:"space-y-2",children:ue.map(ne=>{const Se=d===ne.email,Ve=Eh[ne.status],Ke=Ve.icon;return r.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden hover:border-slate-300 transition-all",children:[r.jsxs("div",{className:"flex items-center gap-3 p-4 cursor-pointer hover:bg-slate-50/50 transition-all",onClick:()=>p(Se?null:ne.email),children:[r.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(wl,{className:"w-4 h-4 text-blue-600"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:ne.name}),r.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-bold rounded-md border ${Ve.bg} ${Ve.text} ${Ve.border}`,children:[r.jsx(Ke,{className:"w-3 h-3"}),Ve.label]}),ne.contacted&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",children:[r.jsx(Bh,{className:"w-2.5 h-2.5"}),"Contacted"]}),ne.notes&&r.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-violet-50 text-violet-600 border-violet-200",children:r.jsx(F1,{className:"w-2.5 h-2.5"})})]}),r.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-3 mt-0.5 flex-wrap",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(gf,{className:"w-3 h-3"}),ne.email]}),ne.phone&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Z0,{className:"w-3 h-3"}),ne.phone]})]})]}),r.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-shrink-0",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900",children:ne.totalVisits}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-sm font-bold text-blue-600",children:Sh(ne.totalSpent)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-sm font-bold text-slate-700",children:tu(ne.lastVisitDate)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),r.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(ne.status==="at-risk"||ne.status==="lost")&&!ne.contacted&&r.jsx("button",{onClick:et=>{et.stopPropagation(),Re(ne)},className:"p-2 text-orange-500 hover:text-orange-700 hover:bg-orange-50 rounded-lg transition-all",title:"Send win-back message",children:r.jsx(Bh,{className:"w-4 h-4"})}),Se?r.jsx(Q0,{className:"w-4 h-4 text-slate-400"}):r.jsx(ku,{className:"w-4 h-4 text-slate-400"})]})]}),Se&&r.jsxs("div",{className:"border-t border-slate-200 bg-slate-50/50 p-5 space-y-5",children:[r.jsxs("div",{className:"sm:hidden grid grid-cols-3 gap-3",children:[r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[r.jsx("div",{className:"text-lg font-bold text-slate-900",children:ne.totalVisits}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[r.jsx("div",{className:"text-lg font-bold text-blue-600",children:Sh(ne.totalSpent)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[r.jsx("div",{className:"text-sm font-bold text-slate-700",children:tu(ne.lastVisitDate)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Avg per Visit"}),r.jsx("div",{className:"text-sm font-bold text-slate-900",children:Sh(ne.avgSpending)})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"First Visit"}),r.jsx("div",{className:"text-sm font-bold text-slate-900",children:tu(ne.firstVisitDate)})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Days Since Last Visit"}),r.jsxs("div",{className:"text-sm font-bold text-slate-900",children:[ne.daysSinceLastVisit,"d"]})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Favorite Service"}),r.jsx("div",{className:"text-sm font-bold text-blue-600 truncate",children:ne.favoriteService||""})]})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[r.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[r.jsx(wn,{className:"w-3.5 h-3.5 text-blue-500"}),"Services Used"]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(ne.serviceFrequency).sort((et,St)=>St[1]-et[1]).map(([et,St])=>r.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg text-xs font-medium",children:[et,r.jsxs("span",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[St,""]})]},et))})]}),Object.keys(ne.staffFrequency).length>0&&r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[r.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[r.jsx(Ft,{className:"w-3.5 h-3.5 text-violet-500"}),"Staff Members Seen"]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(ne.staffFrequency).sort((et,St)=>St[1]-et[1]).map(([et,St])=>r.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-violet-50 text-violet-700 border border-violet-200 rounded-lg text-xs font-medium",children:[et,r.jsxs("span",{className:"bg-violet-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[St,""]})]},et))})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[r.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[r.jsx(jt,{className:"w-3.5 h-3.5 text-emerald-500"}),"Booking History",r.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",ne.bookings.length,")"]})]}),r.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:ne.bookings.sort((et,St)=>(St.date+St.time).localeCompare(et.date+et.time)).map((et,St)=>r.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded-lg hover:bg-slate-50 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-medium text-slate-700",children:tu(et.date)}),r.jsx("span",{className:"text-slate-400",children:et.time}),et.serviceName&&r.jsx("span",{className:"text-blue-600",children:et.serviceName})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[et.staffName&&r.jsx("span",{className:"text-violet-600",children:et.staffName}),et.servicePrice!=null&&r.jsx("span",{className:"font-semibold text-slate-900",children:Sh(et.servicePrice)})]})]},St))})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("h4",{className:"text-sm font-bold text-slate-700 flex items-center gap-1.5",children:[r.jsx(F1,{className:"w-3.5 h-3.5 text-amber-500"}),"Notes"]}),g!==ne.encodedEmail&&r.jsx("button",{onClick:()=>{x(ne.encodedEmail),w(ne.notes||"")},className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:ne.notes?"Edit":"Add Notes"})]}),g===ne.encodedEmail?r.jsxs("div",{className:"space-y-2",children:[r.jsx("textarea",{value:b,onChange:et=>w(et.target.value),placeholder:"Add notes about this client (e.g., preferences, allergies, favorite styles...)",rows:3,className:"w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>rs(ne.encodedEmail),disabled:I,className:"px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:I?"Saving...":"Save"}),r.jsx("button",{onClick:()=>x(null),className:"px-4 py-1.5 bg-white hover:bg-slate-50 text-slate-600 border border-slate-200 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}):r.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:ne.notes||'No notes yet. Click "Add Notes" to save preferences, allergies, or anything useful.'})]}),ne.contacted&&r.jsxs("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg px-4 py-3",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[r.jsx(Ks,{className:"w-4 h-4"}),r.jsxs("span",{className:"font-medium",children:["Contacted",ne.contactedAt?` on ${new Date(ne.contactedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`:""]})]}),r.jsx("button",{onClick:()=>ht(ne.encodedEmail),className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:"Reset"})]})]})]},ne.email)})})]})]})}const cN="https://us-central1-scheduler-65e51.cloudfunctions.net",h9={pro:"price_1Sxx7ILhwB1Jyzw8UvRxE5FT",unlimited:"price_1Sxx7JLhwB1Jyzw8uw9BRYhO"},f9={basicBooking:jt,emailNotifications:J0,aiAssistant:iD,recurringBookings:Xt,waitlist:Ft,crm:Ft,analytics:px,smsNotifications:J0,customBranding:lM,walkIns:Ij,multiLocation:ZD,noBranding:kj,apiAccess:ED,prioritySupport:zD};function m9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState(e),[u,d]=j.useState(!1),[p,g]=j.useState(null),[x,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;const z=Gt(Xe(Ne,"shops",n),ie=>{ie.exists()&&o(ie.data())});return()=>z()},[n]);const w=i?.subscriptionTier||"free",S=xr[w],R=i?.subscriptionStatus,B=i?.subscriptionEndsAt,V=z=>z?(z.toDate?z.toDate():new Date(z)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):null,F=async z=>{d(z),g(null);try{const ie=await fetch(`${cN}/createCheckoutSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,priceId:h9[z],successUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?subscription=canceled`})}),ae=await ie.json();if(!ie.ok)throw new Error(ae.error||"Failed to create checkout session");window.location.href=ae.url}catch(ie){console.error("Upgrade error:",ie),g(ie.message),d(null)}},H=async()=>{b(!0),g(null);try{const z=await fetch(`${cN}/createBillingPortalSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,returnUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard`})}),ie=await z.json();if(!z.ok)throw new Error(ie.error||"Failed to open billing portal");window.location.href=ie.url}catch(z){console.error("Billing portal error:",z),g(z.message),b(!1)}},W=[{key:"free",name:"Free",price:"$0",period:"forever",description:"Perfect for getting started",color:"slate",features:[{key:"staff",text:"1 staff member"},{key:"basicBooking",text:"Online booking"},{key:"emailNotifications",text:"Email notifications"},{key:"fee",text:"5% platform fee on deposits",negative:!0}]},{key:"pro",name:"Pro",price:"$29",period:"/month",description:"For growing businesses",color:"blue",popular:!0,features:[{key:"staff",text:"Up to 5 staff members"},{key:"basicBooking",text:"Online booking"},{key:"emailNotifications",text:"Email notifications"},{key:"aiAssistant",text:"AI booking assistant"},{key:"recurringBookings",text:"Recurring bookings"},{key:"waitlist",text:"Waitlist management"},{key:"crm",text:"Client CRM & notes"},{key:"analytics",text:"Analytics dashboard"},{key:"smsNotifications",text:"SMS notifications"},{key:"fee",text:"No platform fees",highlight:!0}]},{key:"unlimited",name:"Unlimited",price:"$79",period:"/month",description:"For established businesses",color:"violet",features:[{key:"staff",text:"Unlimited staff members"},{key:"everything",text:"Everything in Pro, plus:"},{key:"walkIns",text:"Walk-in queue management"},{key:"multiLocation",text:"Multi-location support"},{key:"noBranding",text:"Remove SpotBookie branding"},{key:"apiAccess",text:"API access"},{key:"prioritySupport",text:"Priority support"}]}];return r.jsxs("div",{className:"animate-fade-in",children:[r.jsx("div",{className:`rounded-2xl p-6 mb-8 ${w==="unlimited"?"bg-gradient-to-r from-violet-500 to-purple-600":w==="pro"?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gradient-to-r from-slate-600 to-slate-700"}`,children:r.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:r.jsx(Vo,{className:"w-7 h-7 text-white"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("h2",{className:"text-xl font-bold text-white",children:[S.name," Plan"]}),R==="past_due"&&r.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full",children:"Payment Failed"}),B&&r.jsx("span",{className:"px-2 py-0.5 bg-amber-500 text-white text-xs font-bold rounded-full",children:"Canceling"})]}),r.jsx("p",{className:"text-white/80 text-sm mt-0.5",children:w==="free"?"Upgrade to unlock more features":B?`Access until ${V(B)}`:"Your subscription is active"})]})]}),w!=="free"&&r.jsxs("button",{onClick:H,disabled:x,className:"flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 text-white rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[x?r.jsx(ea,{className:"w-4 h-4 animate-spin"}):r.jsx(hl,{className:"w-4 h-4"}),"Manage Billing"]})]})}),p&&r.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[r.jsx(Cu,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-red-800",children:"Something went wrong"}),r.jsx("p",{className:"text-sm text-red-600",children:p})]})]}),R==="past_due"&&r.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl flex items-start gap-3",children:[r.jsx(Cu,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-amber-800",children:"Payment Failed"}),r.jsx("p",{className:"text-sm text-amber-600",children:"Your last payment failed. Please update your payment method to keep your subscription active."}),r.jsx("button",{onClick:H,className:"mt-2 text-sm font-semibold text-amber-700 hover:text-amber-800 underline",children:"Update Payment Method "})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:W.map(z=>{const ie=z.key===w,ae=["free","pro","unlimited"].indexOf(z.key)<["free","pro","unlimited"].indexOf(w),Y=!ie&&!ae;return r.jsxs("div",{className:`relative bg-white rounded-2xl border-2 p-6 transition-all ${z.popular?"border-blue-500 shadow-lg shadow-blue-500/10":ie?"border-emerald-500":"border-slate-200 hover:border-slate-300"}`,children:[z.popular&&r.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:r.jsx("span",{className:"px-3 py-1 bg-blue-500 text-white text-xs font-bold rounded-full",children:"Most Popular"})}),ie&&r.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:r.jsx("span",{className:"px-3 py-1 bg-emerald-500 text-white text-xs font-bold rounded-full",children:"Current Plan"})}),r.jsxs("div",{className:"text-center mb-6 pt-2",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:z.name}),r.jsxs("div",{className:"mt-2 flex items-baseline justify-center gap-1",children:[r.jsx("span",{className:"text-4xl font-extrabold text-slate-900",children:z.price}),r.jsx("span",{className:"text-slate-500 text-sm",children:z.period})]}),r.jsx("p",{className:"text-sm text-slate-500 mt-2",children:z.description})]}),r.jsx("ul",{className:"space-y-3 mb-6",children:z.features.map((A,T)=>(f9[A.key],r.jsxs("li",{className:"flex items-start gap-2.5",children:[r.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5 ${A.negative?"bg-red-100 text-red-500":A.highlight?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-600"}`,children:A.negative?r.jsx("span",{className:"text-xs font-bold",children:"%"}):r.jsx(Ks,{className:"w-3 h-3"})}),r.jsx("span",{className:`text-sm ${A.negative?"text-red-600":A.highlight?"text-emerald-700 font-medium":"text-slate-700"}`,children:A.text})]},T)))}),Y?r.jsx("button",{onClick:()=>F(z.key),disabled:u,className:`w-full flex items-center justify-center gap-2 py-3 rounded-xl font-semibold text-sm transition-all ${z.key==="unlimited"?"bg-gradient-to-r from-violet-500 to-purple-600 hover:from-violet-600 hover:to-purple-700 text-white shadow-lg shadow-violet-500/20":z.key==="pro"?"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg shadow-blue-500/20":"bg-slate-100 hover:bg-slate-200 text-slate-700"} disabled:opacity-50`,children:u===z.key?r.jsxs(r.Fragment,{children:[r.jsx(ea,{className:"w-4 h-4 animate-spin"}),"Redirecting..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Qo,{className:"w-4 h-4"}),"Upgrade to ",z.name]})}):ie?r.jsx("div",{className:"w-full py-3 text-center text-sm font-semibold text-emerald-600 bg-emerald-50 rounded-xl border border-emerald-200",children:" Your Current Plan"}):r.jsx("div",{className:"w-full py-3 text-center text-sm font-medium text-slate-400 bg-slate-50 rounded-xl",children:"Included in your plan"})]},z.key)})}),r.jsxs("div",{className:"mt-12",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Feature Comparison"}),r.jsx("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[r.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Feature"}),r.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-slate-700",children:"Free"}),r.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-blue-600",children:"Pro"}),r.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-violet-600",children:"Unlimited"})]})}),r.jsxs("tbody",{children:[r.jsxs("tr",{className:"border-b border-slate-100",children:[r.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:"Staff Members"}),r.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"1"}),r.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"5"}),r.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"Unlimited"})]}),r.jsxs("tr",{className:"border-b border-slate-100",children:[r.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:"Platform Fee"}),r.jsx("td",{className:"py-3 px-4 text-center text-sm text-red-500",children:"5%"}),r.jsx("td",{className:"py-3 px-4 text-center text-sm text-emerald-600",children:"0%"}),r.jsx("td",{className:"py-3 px-4 text-center text-sm text-emerald-600",children:"0%"})]}),Object.entries(HO).map(([z,ie])=>r.jsxs("tr",{className:"border-b border-slate-100 last:border-b-0",children:[r.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:ie.name}),r.jsx("td",{className:"py-3 px-4 text-center",children:xr.free.features.includes(z)?r.jsx(Ks,{className:"w-5 h-5 text-emerald-500 mx-auto"}):r.jsx("span",{className:"text-slate-300",children:""})}),r.jsx("td",{className:"py-3 px-4 text-center",children:xr.pro.features.includes(z)?r.jsx(Ks,{className:"w-5 h-5 text-emerald-500 mx-auto"}):r.jsx("span",{className:"text-slate-300",children:""})}),r.jsx("td",{className:"py-3 px-4 text-center",children:xr.unlimited.features.includes(z)?r.jsx(Ks,{className:"w-5 h-5 text-emerald-500 mx-auto"}):r.jsx("span",{className:"text-slate-300",children:""})})]},z))]})]})})]}),r.jsxs("div",{className:"mt-12",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Frequently Asked Questions"}),r.jsx("div",{className:"space-y-4",children:[{q:"Can I cancel anytime?",a:"Yes! You can cancel your subscription at any time. You'll continue to have access until the end of your billing period."},{q:"What happens if I downgrade?",a:"When you downgrade, you'll keep your current plan until the end of the billing period. After that, feature limits (like staff count) will apply."},{q:"What is the platform fee?",a:"On the Free plan, we charge a 5% fee on any deposits collected through SpotBookie. Pro and Unlimited plans have no platform fees."},{q:"Do you offer refunds?",a:"We offer a 14-day money-back guarantee for first-time subscribers. Contact us if you're not satisfied."}].map((z,ie)=>r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:z.q}),r.jsx("p",{className:"text-sm text-slate-600",children:z.a})]},ie))})]})]})}const Th="https://us-central1-scheduler-65e51.cloudfunctions.net";function p9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState(e),[u,d]=j.useState(null),[p,g]=j.useState(null),[x,b]=j.useState(null);j.useEffect(()=>{if(!n)return;const Y=Gt(Xe(Ne,"shops",n),A=>{A.exists()&&o(A.data())});return()=>Y()},[n]);const w=!!i?.stripeAccountId,S=i?.stripeOnboardingComplete,R=i?.payoutsEnabled;i?.stripeAccountStatus;const B=i?.subscriptionTier||"free",V=B==="free"?"5%":"0%",F=async()=>{d("create"),g(null);try{const Y=await fetch(`${Th}/createConnectAccount`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,email:i.ownerEmail,businessName:i.name})}),A=await Y.json();if(!Y.ok)throw new Error(A.error||"Failed to create account");(!A.alreadyExists||!i.stripeOnboardingComplete)&&await H()}catch(Y){console.error("Create account error:",Y),g(Y.message)}finally{d(null)}},H=async()=>{d("onboard"),g(null);try{const Y=await fetch(`${Th}/createAccountLink`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,returnUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?connect=return`,refreshUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?connect=refresh`})}),A=await Y.json();if(!Y.ok)throw new Error(A.error||"Failed to create onboarding link");window.location.href=A.url}catch(Y){console.error("Onboarding error:",Y),g(Y.message),d(null)}},W=async()=>{d("dashboard"),g(null);try{const Y=await fetch(`${Th}/getConnectDashboardLink`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n})}),A=await Y.json();if(!Y.ok)throw new Error(A.error||"Failed to get dashboard link");window.open(A.url,"_blank")}catch(Y){console.error("Dashboard link error:",Y),g(Y.message)}finally{d(null)}},z=async()=>{d("balance"),g(null);try{const Y=await fetch(`${Th}/getConnectBalance`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n})}),A=await Y.json();if(!Y.ok)throw new Error(A.error||"Failed to fetch balance");b(A)}catch(Y){console.error("Balance fetch error:",Y),g(Y.message)}finally{d(null)}};j.useEffect(()=>{R&&!x&&z()},[R]);const ie=(Y,A="usd")=>new Intl.NumberFormat("en-US",{style:"currency",currency:A.toUpperCase()}).format(Y/100),ae=Y=>new Date(Y*1e3).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Payments"}),r.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:"Connect Stripe to accept deposits and get paid"})]}),w&&R&&r.jsxs("button",{onClick:z,disabled:u==="balance",className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-all",children:[u==="balance"?r.jsx(ea,{className:"w-3.5 h-3.5 animate-spin"}):r.jsx(Yf,{className:"w-3.5 h-3.5"}),"Refresh"]})]}),p&&r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[r.jsx(Cu,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-red-800 text-sm",children:"Something went wrong"}),r.jsx("p",{className:"text-sm text-red-600",children:p})]})]}),!w&&r.jsx("div",{className:"bg-gradient-to-br from-violet-50 to-blue-50 rounded-2xl border border-violet-200 p-8",children:r.jsxs("div",{className:"flex flex-col items-center text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-lg flex items-center justify-center mb-5",children:r.jsx(yn,{className:"w-8 h-8 text-violet-600"})}),r.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"Accept Payments"}),r.jsx("p",{className:"text-slate-600 max-w-md mb-6",children:"Connect your Stripe account to accept deposit payments from clients when they book. Funds are transferred directly to your bank account."}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 w-full max-w-xl mb-8",children:[{icon:Aj,label:"Secure payments",desc:"256-bit encryption"},{icon:Qo,label:"Fast payouts",desc:"2-day transfers"},{icon:ko,label:"Low fees",desc:"2.9% + 30"}].map(({icon:Y,label:A,desc:T})=>r.jsxs("div",{className:"bg-white/70 rounded-xl p-4 text-center",children:[r.jsx(Y,{className:"w-5 h-5 text-violet-600 mx-auto mb-2"}),r.jsx("p",{className:"text-sm font-semibold text-slate-900",children:A}),r.jsx("p",{className:"text-xs text-slate-500",children:T})]},A))}),r.jsx("button",{onClick:F,disabled:u==="create",className:"flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-violet-600 to-blue-600 hover:from-violet-700 hover:to-blue-700 text-white rounded-xl font-bold text-base shadow-lg shadow-violet-600/25 transition-all disabled:opacity-50",children:u==="create"?r.jsxs(r.Fragment,{children:[r.jsx(ea,{className:"w-5 h-5 animate-spin"}),"Setting up..."]}):r.jsxs(r.Fragment,{children:[r.jsx(yn,{className:"w-5 h-5"}),"Connect with Stripe",r.jsx(Ao,{className:"w-5 h-5"})]})}),B==="free"&&r.jsxs("p",{className:"mt-4 text-xs text-slate-500 flex items-center gap-1",children:[r.jsx(B1,{className:"w-3.5 h-3.5"}),"Free tier: ",V," platform fee on deposits.",r.jsx("a",{href:"#",className:"text-violet-600 hover:underline",children:"Upgrade to remove"})]})]})}),w&&!S&&r.jsx("div",{className:"bg-amber-50 rounded-2xl border border-amber-200 p-6",children:r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0",children:r.jsx(Xt,{className:"w-6 h-6 text-amber-600"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Complete Your Setup"}),r.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Your Stripe account is created, but you need to complete the onboarding process to start accepting payments."}),r.jsx("button",{onClick:H,disabled:u==="onboard",className:"flex items-center gap-2 px-5 py-2.5 bg-amber-600 hover:bg-amber-700 text-white rounded-xl font-semibold text-sm shadow-md transition-all disabled:opacity-50",children:u==="onboard"?r.jsxs(r.Fragment,{children:[r.jsx(ea,{className:"w-4 h-4 animate-spin"}),"Redirecting..."]}):r.jsxs(r.Fragment,{children:[r.jsx(hl,{className:"w-4 h-4"}),"Complete Setup"]})})]})]})}),w&&S&&!R&&r.jsx("div",{className:"bg-blue-50 rounded-2xl border border-blue-200 p-6",children:r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:r.jsx(oD,{className:"w-6 h-6 text-blue-600"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Verification in Progress"}),r.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Stripe is reviewing your account. This usually takes a few minutes. Once approved, you'll be able to accept payments."}),r.jsx("div",{className:"flex items-center gap-3",children:r.jsxs("button",{onClick:H,disabled:u==="onboard",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[u==="onboard"?r.jsx(ea,{className:"w-4 h-4 animate-spin"}):r.jsx(hl,{className:"w-4 h-4"}),"Check Status"]})})]})]})}),w&&R&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl p-6 text-white",children:r.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:r.jsx(Cs,{className:"w-7 h-7"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h3",{className:"text-xl font-bold",children:"Stripe Connected"}),r.jsx("span",{className:"px-2 py-0.5 bg-white/20 text-xs font-bold rounded-full",children:"Active"})]}),r.jsx("p",{className:"text-white/80 text-sm mt-0.5",children:"You're ready to accept deposit payments"})]})]}),r.jsxs("button",{onClick:W,disabled:u==="dashboard",className:"flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[u==="dashboard"?r.jsx(ea,{className:"w-4 h-4 animate-spin"}):r.jsx(hl,{className:"w-4 h-4"}),"Stripe Dashboard"]})]})}),x&&r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Available"}),r.jsx($1,{className:"w-4 h-4 text-emerald-500"})]}),r.jsx("p",{className:"text-2xl font-bold text-slate-900",children:x.balance.available[0]?ie(x.balance.available[0].amount,x.balance.available[0].currency):"$0.00"}),r.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Ready to pay out"})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Pending"}),r.jsx(Xt,{className:"w-4 h-4 text-blue-500"})]}),r.jsx("p",{className:"text-2xl font-bold text-slate-900",children:x.balance.pending[0]?ie(x.balance.pending[0].amount,x.balance.pending[0].currency):"$0.00"}),r.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Processing"})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Platform Fee"}),r.jsx(ko,{className:"w-4 h-4 text-violet-500"})]}),r.jsx("p",{className:"text-2xl font-bold text-slate-900",children:V}),r.jsx("p",{className:"text-xs text-slate-400 mt-1",children:B==="free"?"Upgrade to remove":"No platform fees"})]})]}),x?.recentCharges?.length>0&&r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"font-bold text-slate-900",children:"Recent Payments"}),r.jsx("button",{onClick:W,className:"text-xs font-medium text-blue-600 hover:text-blue-700",children:"View All "})]}),r.jsx("div",{className:"space-y-3",children:x.recentCharges.slice(0,5).map(Y=>r.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${Y.status==="succeeded"?"bg-emerald-100":"bg-slate-100"}`,children:Y.status==="succeeded"?r.jsx(Cs,{className:"w-4 h-4 text-emerald-600"}):r.jsx(Xt,{className:"w-4 h-4 text-slate-400"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-slate-900",children:Y.metadata?.clientName||"Payment"}),r.jsxs("p",{className:"text-xs text-slate-400",children:[ae(Y.created),Y.metadata?.serviceName&&`  ${Y.metadata.serviceName}`]})]})]}),r.jsx("span",{className:"text-sm font-bold text-slate-900",children:ie(Y.amount,Y.currency)})]},Y.id))})]}),x?.recentPayouts?.length>0&&r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"font-bold text-slate-900",children:"Recent Payouts"}),r.jsx(Uo,{className:"w-4 h-4 text-slate-400"})]}),r.jsx("div",{className:"space-y-3",children:x.recentPayouts.slice(0,3).map(Y=>r.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${Y.status==="paid"?"bg-emerald-100":"bg-amber-100"}`,children:r.jsx($1,{className:`w-4 h-4 ${Y.status==="paid"?"text-emerald-600":"text-amber-600"}`})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-slate-900 capitalize",children:Y.status}),r.jsx("p",{className:"text-xs text-slate-400",children:Y.arrivalDate?`Arrives ${ae(Y.arrivalDate)}`:ae(Y.created)})]})]}),r.jsx("span",{className:"text-sm font-bold text-emerald-600",children:ie(Y.amount,Y.currency)})]},Y.id))})]})]}),r.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-5",children:[r.jsxs("h3",{className:"font-bold text-slate-900 mb-3 flex items-center gap-2",children:[r.jsx(B1,{className:"w-4 h-4 text-blue-500"}),"How it works"]}),r.jsxs("ul",{className:"space-y-2 text-sm text-slate-600",children:[r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"1"}),r.jsx("span",{children:"Client books an appointment and pays the deposit"})]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"2"}),r.jsxs("span",{children:["Payment goes directly to your Stripe account (minus Stripe's 2.9% + 30 fee",B==="free"&&` and ${V} platform fee`,")"]})]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"3"}),r.jsx("span",{children:"Stripe automatically transfers funds to your bank (usually within 2 days)"})]})]})]})]})}const g9=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function y0(n){const[e,t]=n.split(":").map(Number);return e*60+t}function x9(n,e){if(n.status!=="waiting"||n.serviceId&&e.serviceId&&n.serviceId!==e.serviceId||n.staffId&&n.staffId!=="any"&&e.staffId&&n.staffId!==e.staffId)return!1;if(e.date){if(n.preferredDate&&n.preferredDate!==e.date)return!1;if(n.preferredDays&&n.preferredDays.length>0){const t=new Date(e.date+"T12:00:00"),i=g9[t.getDay()];if(!n.preferredDays.includes(i))return!1}}if(e.time&&n.preferredTimeRange){const t=y0(e.time),i=y0(n.preferredTimeRange.start),o=y0(n.preferredTimeRange.end);if(!(n.preferredTimeRange.start==="00:00"&&n.preferredTimeRange.end==="23:59")&&(t<i||t>o))return!1}return!0}function b9(n,e){return n.filter(t=>x9(t,e)).sort((t,i)=>(t.createdAt||"").localeCompare(i.createdAt||""))}const uN=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}];function ri(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"PM":"AM";return`${e%12||12}:${t.toString().padStart(2,"0")} ${i}`}function y9({user:n}){const{slug:e}=$o(),t=_l(),[i,o]=j.useState(null),[u,d]=j.useState(null),[p,g]=j.useState(!0),[x,b]=j.useState(!1),[w,S]=j.useState([]),[R,B]=j.useState([]),[V,F]=j.useState([]),[H,W]=j.useState([]),[z,ie]=j.useState("schedule"),[ae,Y]=j.useState(null),[A,T]=j.useState("all"),[E,I]=j.useState("all"),[_,D]=j.useState([]),[k,L]=j.useState(null),[P,O]=j.useState(null),[Q,le]=j.useState(!1),[Ee,xe]=j.useState({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""});j.useEffect(()=>{if(!n){t(`/shop/${e}/login`,{replace:!0});return}(async()=>{g(!0);try{const ce=Ln(Ze(Ne,"shops"),bn("slug","==",e)),_e=await nn(ce);if(_e.empty){b(!0),g(!1);return}const je=_e.docs[0],Fe=je.data();if(Fe.ownerUid!==n.uid){b(!0),g(!1);return}o(Fe),d(je.id)}catch(ce){console.error("Error checking ownership:",ce),b(!0)}finally{g(!1)}})()},[n,e,t]),j.useEffect(()=>{if(!u)return;const $=Gt(Ze(Ne,"shops",u,"availability"),de=>{const we=de.docs.map(Te=>({id:Te.id,...Te.data()}));S(we)}),ce=Gt(Ze(Ne,"shops",u,"bookings"),de=>{const we=de.docs.map(Te=>({id:Te.id,...Te.data()}));B(we)}),_e=Gt(Ze(Ne,"shops",u,"staff"),de=>{const we=de.docs.map(Te=>({id:Te.id,...Te.data()})).filter(Te=>Te.active!==!1).sort((Te,Be)=>(Te.name||"").localeCompare(Be.name||""));F(we)}),je=Gt(Ze(Ne,"shops",u,"waitlist"),de=>{const we=de.docs.map(Te=>({id:Te.id,...Te.data()})).sort((Te,Be)=>(Te.createdAt||"").localeCompare(Be.createdAt||""));D(we)}),Fe=Gt(Ze(Ne,"shops",u,"services"),de=>{const we=de.docs.map(Te=>({id:Te.id,...Te.data()})).filter(Te=>Te.active!==!1).sort((Te,Be)=>(Te.name||"").localeCompare(Be.name||""));W(we)});return()=>{$(),ce(),_e(),je(),Fe()}},[u]);const U=async()=>{await g_(ji),t(`/shop/${e}`,{replace:!0})},ee=async $=>{$.preventDefault();const{date:ce,startTime:_e,endTime:je,slotDuration:Fe,staffId:de}=Ee,we=parseInt(Fe),[Te,Be]=_e.split(":").map(Number),[it,Le]=je.split(":").map(Number),ze=Te*60+Be,kt=it*60+Le;let Wt=ze;for(;Wt+we<=kt;){const rn=Math.floor(Wt/60),ln=Wt%60,na=`${rn.toString().padStart(2,"0")}:${ln.toString().padStart(2,"0")}`,aa={date:ce,time:na,duration:we,available:!0};if(de){const ra=V.find(ns=>ns.id===de);aa.staffId=de,aa.staffName=ra?.name||""}await ya(Ze(Ne,"shops",u,"availability"),aa),Wt+=we}xe({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""})},ue=async $=>{await nj(Xe(Ne,"shops",u,"availability",$))},fe=$=>{const ce={date:$.date,time:$.time,staffId:$.staffId||null,serviceId:$.serviceId||null},_e=b9(_,ce);_e.length>0&&L({matches:_e,slot:ce})},ge=async($,ce)=>{for(const _e of $)await at(Xe(Ne,"shops",u,"waitlist",_e.id),{status:"notified",notifiedAt:new Date().toISOString(),notifiedSlot:{date:ce.date,time:ce.time,staffId:ce.staffId||null,staffName:ce.staffName||null}});L(null)},Re=async $=>{await at(Xe(Ne,"shops",u,"waitlist",$),{status:"notified",notifiedAt:new Date().toISOString()})},He=async $=>{await at(Xe(Ne,"shops",u,"waitlist",$),{status:"expired"})},At=async $=>{const ce=R.find(_e=>_e.id===$);if(ce&&ce.recurringGroupId){O({bookingId:$,recurringGroupId:ce.recurringGroupId});return}if(await at(Xe(Ne,"shops",u,"bookings",$),{status:"cancelled"}),ce&&ce.slotId&&!ce.slotId.startsWith("wh-")&&!ce.slotId.startsWith("recurring-"))try{await at(Xe(Ne,"shops",u,"availability",ce.slotId),{available:!0})}catch(_e){console.warn("Could not re-open slot:",_e)}ce&&fe(ce)},ht=async $=>{const ce=R.find(_e=>_e.id===$);if(await at(Xe(Ne,"shops",u,"bookings",$),{status:"cancelled"}),ce&&ce.slotId&&!ce.slotId.startsWith("wh-")&&!ce.slotId.startsWith("recurring-"))try{await at(Xe(Ne,"shops",u,"availability",ce.slotId),{available:!0})}catch(_e){console.warn("Could not re-open slot:",_e)}ce&&fe(ce),O(null)},rs=async($,ce)=>{const _e=R.find(Fe=>Fe.id===$);if(!_e)return;const je=R.filter(Fe=>Fe.recurringGroupId===ce&&Fe.date>=_e.date&&(Fe.status==="pending"||Fe.status==="confirmed"));for(const Fe of je)if(await at(Xe(Ne,"shops",u,"bookings",Fe.id),{status:"cancelled"}),Fe.slotId&&!Fe.slotId.startsWith("wh-")&&!Fe.slotId.startsWith("recurring-"))try{await at(Xe(Ne,"shops",u,"availability",Fe.slotId),{available:!0})}catch(de){console.warn("Could not re-open slot:",de)}_e&&fe(_e),O(null)},ne=async $=>{await at(Xe(Ne,"shops",u,"bookings",$),{status:"confirmed"})},Se=async $=>{const ce=R.find(_e=>_e.id===$);if(await at(Xe(Ne,"shops",u,"bookings",$),{status:"rejected"}),ce&&ce.slotId&&!ce.slotId.startsWith("wh-"))try{await at(Xe(Ne,"shops",u,"availability",ce.slotId),{available:!0})}catch(_e){console.warn("Could not re-open slot:",_e)}ce&&fe(ce)},Ve=async()=>{const $=!i?.requireApproval;try{await at(Xe(Ne,"shops",u),{requireApproval:$}),o(ce=>({...ce,requireApproval:$}))}catch(ce){console.error("Error updating requireApproval:",ce)}},Ke=async $=>{const ce=parseInt($);try{await at(Xe(Ne,"shops",u),{bufferMinutes:ce}),o(_e=>({..._e,bufferMinutes:ce}))}catch(_e){console.error("Error updating buffer minutes:",_e)}},et=($,ce)=>new Date(`${$}T${ce}`).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),St=j.useMemo(()=>{const $={},ce=A==="all"?V:V.filter(je=>je.id===A),_e=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(const je of ce)je.weeklyHours&&_e.forEach((Fe,de)=>{je.weeklyHours[Fe]?.enabled&&($[de]=!0)});return $},[V,A]),qs=j.useMemo(()=>{const $={},ce=A==="all"?V:V.filter(Fe=>Fe.id===A),_e=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],je=new Date;je.setHours(0,0,0,0);for(let Fe=0;Fe<60;Fe++){const de=new Date(je);de.setDate(de.getDate()+Fe);const we=de.getDay(),Te=_e[we],Be=`${de.getFullYear()}-${String(de.getMonth()+1).padStart(2,"0")}-${String(de.getDate()).padStart(2,"0")}`;for(const it of ce){if(!it.weeklyHours||!it.weeklyHours[Te]?.enabled)continue;const Le=it.weeklyHours[Te],ze=Le.breaks||(Le.break?[Le.break]:[]);ze.length>0&&($[Be]||($[Be]=[]),$[Be].push(...ze.map(kt=>({...kt,staffId:it.id,staffName:it.name}))))}}return $},[V,A]),ft=j.useMemo(()=>(A==="all"?V:V.filter(ce=>ce.id===A)).filter(ce=>ce.weeklyHours?uN.some(_e=>ce.weeklyHours[_e.key]?.enabled):!1),[V,A]),mt=j.useMemo(()=>{const $=new Date,ce=`${$.getFullYear()}-${String($.getMonth()+1).padStart(2,"0")}-${String($.getDate()).padStart(2,"0")}`,_e=$.getDay(),je=_e===0?-6:1-_e,Fe=new Date($);Fe.setDate($.getDate()+je),Fe.setHours(0,0,0,0);const de=new Date(Fe);de.setDate(Fe.getDate()+6),de.setHours(23,59,59,999);const we=`${Fe.getFullYear()}-${String(Fe.getMonth()+1).padStart(2,"0")}-${String(Fe.getDate()).padStart(2,"0")}`,Te=`${de.getFullYear()}-${String(de.getMonth()+1).padStart(2,"0")}-${String(de.getDate()).padStart(2,"0")}`,Be=R.filter(ze=>ze.date===ce).length,it=R.filter(ze=>ze.date>=we&&ze.date<=Te).length,Le=new Set(R.map(ze=>ze.clientEmail?.toLowerCase()).filter(Boolean)).size;return{todayBookings:Be,weekBookings:it,uniqueClients:Le,totalBookings:R.length}},[R]),ke=j.useMemo(()=>R.filter($=>$.status==="pending").length,[R]),Oe=j.useMemo(()=>_.filter($=>$.status==="waiting").length,[_]),[me,Ye]=j.useState(0),[Ue,De]=j.useState({}),qe=j.useMemo(()=>{if(!i)return 0;i?.winbackSettings?.warningDays;const $=i?.winbackSettings?.inactiveDays||60;if(!(i?.winbackSettings?.enabled!==!1))return 0;const _e=new Date,je=R.filter(Te=>Te.status==="confirmed"||Te.status==="pending"||!Te.status),Fe={};je.forEach(Te=>{const Be=Te.clientEmail?.toLowerCase();Be&&(!Fe[Be]||Te.date>Fe[Be])&&(Fe[Be]=Te.date)});let de=0;const we=Te=>Te.replace(/\./g,"_dot_").replace(/@/g,"_at_");return Object.entries(Fe).forEach(([Te,Be])=>{if(Math.floor((_e.getTime()-new Date(Be+"T12:00:00").getTime())/864e5)>$){const Le=we(Te);Ue[Le]?.contacted||de++}}),de},[R,i,Ue]);if(j.useEffect(()=>{if(!u)return;const $=Gt(Ze(Ne,"shops",u,"clientNotes"),ce=>{const _e={};ce.docs.forEach(je=>{_e[je.id]=je.data()}),De(_e)});return()=>$()},[u]),j.useEffect(()=>{if(!u)return;const $=Gt(Ze(Ne,"shops",u,"walkins"),ce=>{const _e=ce.docs.filter(je=>je.data().status==="waiting").length;Ye(_e)});return()=>$()},[u]),p)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading dashboard"})]})});if(x)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(pf,{className:"w-8 h-8 text-red-500"})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Unauthorized"}),r.jsx("p",{className:"text-slate-600 mb-6",children:"You don't have access to this dashboard."}),r.jsx(nt,{to:`/shop/${e}/login`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:"Login"})]})});const Ge=A==="all"?w:w.filter($=>$.staffId===A),Jt=A==="all"?R:R.filter($=>$.staffId===A),an=Ge.reduce(($,ce)=>($[ce.date]||($[ce.date]=[]),$[ce.date].push(ce),$),{}),jn=Jt.reduce(($,ce)=>($[ce.date]||($[ce.date]=[]),$[ce.date].push(ce),$),{}),Js=ae?Object.keys(an).filter($=>$===ae).sort():Object.keys(an).sort(),Hs=ae?Jt.filter($=>$.date===ae):Jt,gs=E==="all"?Hs:E==="pending"?Hs.filter($=>$.status==="pending"):E==="confirmed"?Hs.filter($=>!$.status||$.status==="confirmed"):Hs.filter($=>$.status==="cancelled"||$.status==="rejected"),Vt={all:Hs.length,pending:Hs.filter($=>$.status==="pending").length,confirmed:Hs.filter($=>!$.status||$.status==="confirmed").length,cancelled:Hs.filter($=>$.status==="cancelled"||$.status==="rejected").length},xs=[{key:"schedule",label:"Schedule",icon:jt},{key:"clients",label:"Clients",icon:gx},{key:"walkins",label:"Walk-ins",icon:Ij},{key:"analytics",label:"Analytics",icon:_j},{key:"waitlist",label:"Waitlist",icon:K0},{key:"staff",label:"Staff",icon:Ft},{key:"services",label:"Services",icon:wn},{key:"subscription",label:"Plan",icon:Vo},{key:"settings",label:"Settings",icon:zh}];return r.jsxs("div",{className:"min-h-screen bg-slate-50",children:[r.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>le(!0),className:"lg:hidden p-2 -ml-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:r.jsx(tM,{className:"w-6 h-6"})}),r.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(i.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{className:"hidden sm:block",children:[r.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:i.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),r.jsx("div",{className:"hidden lg:flex items-center bg-slate-100 p-1 rounded-xl",children:xs.map($=>{const ce=$.icon,je=$.key==="schedule"&&ke>0?{count:ke,color:"bg-amber-500"}:$.key==="clients"&&qe>0?{count:qe,color:"bg-orange-500"}:$.key==="walkins"&&me>0?{count:me,color:"bg-emerald-500"}:$.key==="waitlist"&&Oe>0?{count:Oe,color:"bg-blue-500"}:null;return r.jsxs("button",{onClick:()=>ie($.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${z===$.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[r.jsx(ce,{className:"w-4 h-4"}),r.jsx("span",{children:$.label}),je&&r.jsx("span",{className:`ml-1 px-1.5 py-0.5 ${je.color} text-white text-[10px] font-bold rounded-full leading-none`,children:je.count})]},$.key)})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(nt,{to:`/shop/${e}`,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[r.jsx(xu,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"View Page"})]}),r.jsxs("button",{onClick:U,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",children:[r.jsx(X0,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),Q&&r.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>le(!1)}),r.jsxs("div",{className:"fixed inset-y-0 left-0 w-72 bg-white shadow-2xl animate-slide-in-left",children:[r.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-slate-200",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm",children:(i.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h2",{className:"font-bold text-slate-900",children:i.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),r.jsx("button",{onClick:()=>le(!1),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",children:r.jsx(Fs,{className:"w-5 h-5"})})]}),r.jsx("div",{className:"p-3 space-y-1",children:xs.map($=>{const ce=$.icon,je=$.key==="schedule"&&ke>0?{count:ke,color:"bg-amber-500"}:$.key==="clients"&&qe>0?{count:qe,color:"bg-orange-500"}:$.key==="walkins"&&me>0?{count:me,color:"bg-emerald-500"}:$.key==="waitlist"&&Oe>0?{count:Oe,color:"bg-blue-500"}:null;return r.jsxs("button",{onClick:()=>{ie($.key),le(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left font-medium transition-all ${z===$.key?"bg-blue-50 text-blue-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,children:[r.jsx(ce,{className:`w-5 h-5 ${z===$.key?"text-blue-600":"text-slate-400"}`}),r.jsx("span",{className:"flex-1",children:$.label}),je&&r.jsx("span",{className:`px-2 py-0.5 ${je.color} text-white text-xs font-bold rounded-full`,children:je.count})]},$.key)})}),r.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 border-t border-slate-200 bg-slate-50",children:[r.jsxs(nt,{to:`/shop/${e}`,onClick:()=>le(!1),className:"flex items-center gap-3 px-4 py-3 text-slate-600 hover:bg-white rounded-xl font-medium transition-all",children:[r.jsx(xu,{className:"w-5 h-5 text-slate-400"}),"View Public Page"]}),r.jsxs("button",{onClick:()=>{le(!1),U()},className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl font-medium transition-all",children:[r.jsx(X0,{className:"w-5 h-5"}),"Logout"]})]})]})]}),r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[z==="schedule"&&r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8 animate-fade-in",children:[{label:"Today's Bookings",value:mt.todayBookings,icon:U1,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:mt.weekBookings,icon:Uo,color:"bg-violet-100 text-violet-600"},{label:"Total Bookings",value:mt.totalBookings,icon:px,color:"bg-emerald-100 text-emerald-600"},{label:"Unique Clients",value:mt.uniqueClients,icon:Ft,color:"bg-amber-100 text-amber-600"}].map($=>{const ce=$.icon;return r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:`w-10 h-10 ${$.color} rounded-xl flex items-center justify-center`,children:r.jsx(ce,{className:"w-5 h-5"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:$.value}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:$.label})]},$.label)})}),z==="clients"&&r.jsx(d9,{shopId:u,bookings:R,shop:i,slug:e}),z==="walkins"&&r.jsx(o9,{shopId:u,services:H,staff:V,bookings:R}),z==="analytics"&&r.jsx(a9,{bookings:R}),z==="staff"&&r.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:r.jsx(s9,{shopId:u,shop:i,slug:e})}),z==="services"&&r.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:r.jsx(zO,{shopId:u})}),z==="subscription"&&r.jsx(m9,{shopId:u,shop:i,slug:e}),k&&r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:r.jsx(wo,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Waitlist Match!"}),r.jsxs("p",{className:"text-sm text-slate-500",children:[k.matches.length," client",k.matches.length!==1?"s":""," on the waitlist match this freed slot"]})]})]}),r.jsx("div",{className:"bg-slate-50 rounded-xl p-3 mb-4 text-sm",children:r.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[r.jsx(jt,{className:"w-4 h-4 text-blue-500"}),r.jsxs("span",{className:"font-medium",children:[new Date(k.slot.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})," at ",(()=>{const[$,ce]=k.slot.time.split(":"),_e=parseInt($);return`${_e%12||12}:${ce} ${_e>=12?"PM":"AM"}`})()]})]})}),r.jsx("div",{className:"space-y-2 mb-5 max-h-48 overflow-y-auto",children:k.matches.map($=>r.jsx("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-50 border border-blue-100 rounded-lg",children:r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:$.clientName}),r.jsx("span",{className:"text-xs text-slate-500 ml-2",children:$.serviceName})]})},$.id))}),r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("button",{onClick:()=>ge(k.matches,k.slot),className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:[r.jsx(wo,{className:"w-4 h-4"}),"Notify All"]}),r.jsx("button",{onClick:()=>L(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Dismiss"})]})]})}),P&&r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center",children:r.jsx(gi,{className:"w-5 h-5 text-red-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Cancel Recurring Booking"}),r.jsx("p",{className:"text-sm text-slate-500",children:"This booking is part of a recurring series"})]})]}),r.jsxs("div",{className:"space-y-2 mb-5",children:[r.jsxs("button",{onClick:()=>ht(P.bookingId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[r.jsx(La,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this one only"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments stay active"})]})]}),r.jsxs("button",{onClick:()=>rs(P.bookingId,P.recurringGroupId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[r.jsx(gi,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future in series"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments"})]})]})]}),r.jsx("button",{onClick:()=>O(null),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Never mind"})]})}),z==="waitlist"&&r.jsx("div",{className:"animate-fade-in",children:r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-5",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Waitlist"}),Oe>0&&r.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:[Oe," waiting"]})]}),r.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[_.length," total"]})]}),_.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(K0,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No waitlist entries yet"}),r.jsx("p",{className:"text-xs text-slate-400",children:"Clients can join the waitlist when no slots are available on your booking page."})]}):r.jsx("div",{children:(()=>{const $={};return _.forEach(ce=>{const _e=ce.serviceName||"Other";$[_e]||($[_e]=[]),$[_e].push(ce)}),Object.entries($).sort(([ce],[_e])=>ce.localeCompare(_e)).map(([ce,_e])=>r.jsxs("div",{className:"mb-6 last:mb-0",children:[r.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100 flex items-center gap-2",children:[r.jsx(wn,{className:"w-3.5 h-3.5 text-blue-500"}),ce,r.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",_e.filter(je=>je.status==="waiting").length," waiting)"]})]}),r.jsx("div",{className:"space-y-2.5",children:_e.sort((je,Fe)=>(je.createdAt||"").localeCompare(Fe.createdAt||"")).map(je=>{const Fe={waiting:"bg-blue-50 text-blue-700 border-blue-200",notified:"bg-emerald-50 text-emerald-700 border-emerald-200",booked:"bg-emerald-50 text-emerald-700 border-emerald-200",expired:"bg-slate-100 text-slate-500 border-slate-200"},de={waiting:"Waiting",notified:"Notified",booked:"Booked",expired:"Removed"},we=je.createdAt?(()=>{const Be=Date.now()-new Date(je.createdAt).getTime(),it=Math.floor(Be/864e5),Le=Math.floor(Be/36e5);return it>0?`${it}d`:`${Le}h`})():"",Te={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return r.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(wl,{className:"w-4 h-4 text-blue-600"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:je.clientName}),r.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Fe[je.status]||Fe.waiting}`,children:de[je.status]||"Waiting"})]}),r.jsxs("div",{className:"text-xs text-slate-500",children:["Joined ",we," ago",je.refCode&&r.jsx("span",{className:"font-mono text-slate-400 ml-2",children:je.refCode})]})]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[je.status==="waiting"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>Re(je.id),className:"p-1.5 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-all",title:"Notify client",children:r.jsx(wo,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>He(je.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove from waitlist",children:r.jsx(Fs,{className:"w-4 h-4"})})]}),je.status==="notified"&&r.jsx("button",{onClick:()=>He(je.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove",children:r.jsx(Fs,{className:"w-3.5 h-3.5"})})]})]}),r.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[je.staffName&&je.staffName!=="Any Available"&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Ft,{className:"w-3 h-3 text-violet-400"}),r.jsx("span",{className:"text-violet-600",children:je.staffName})]}),je.preferredDate&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(jt,{className:"w-3 h-3 text-slate-400"}),r.jsxs("span",{children:["Preferred: ",new Date(je.preferredDate+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]})]}),je.preferredDays&&je.preferredDays.length>0&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(jt,{className:"w-3 h-3 text-slate-400"}),r.jsxs("span",{children:["Days: ",je.preferredDays.map(Be=>Te[Be]||Be).join(", ")]})]}),je.preferredTimeRange&&!(je.preferredTimeRange.start==="00:00"&&je.preferredTimeRange.end==="23:59")&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Xt,{className:"w-3 h-3 text-slate-400"}),r.jsxs("span",{children:["Time: ",ri(je.preferredTimeRange.start),"",ri(je.preferredTimeRange.end)]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(gf,{className:"w-3 h-3"}),je.clientEmail]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Z0,{className:"w-3 h-3"}),je.clientPhone]})]}),je.status==="notified"&&je.notifiedSlot&&r.jsxs("div",{className:"mt-1.5 px-2.5 py-1.5 bg-emerald-50 border border-emerald-200 rounded-lg inline-flex items-center gap-1.5",children:[r.jsx(wo,{className:"w-3 h-3 text-emerald-500"}),r.jsxs("span",{className:"text-emerald-700 font-medium",children:["Notified about ",new Date(je.notifiedSlot.date+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})," at ",ri(je.notifiedSlot.time)]})]})]})]},je.id)})})]},ce))})()})]})}),z==="settings"&&r.jsxs("div",{className:"max-w-2xl animate-fade-in space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Settings"}),r.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure your booking preferences"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsxs("div",{className:"pr-4",children:[r.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Require Booking Approval"}),r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Review and approve bookings before they're confirmed"})]}),r.jsx("button",{type:"button",onClick:Ve,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${i?.requireApproval?"bg-blue-500":"bg-slate-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${i?.requireApproval?"translate-x-6":"translate-x-1"}`})})]}),i?.requireApproval&&r.jsxs("div",{className:"p-3.5 bg-amber-50 border border-amber-200 rounded-xl text-xs text-amber-800 leading-relaxed",children:[r.jsx("strong",{children:" Approval mode is on."}),' New bookings will appear as "Pending" until you approve or reject them. Time slots are held while pending to prevent double-booking.']}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsxs("div",{className:"pr-4",children:[r.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Buffer Time Between Bookings"}),r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Add a gap between consecutive appointments"})]}),r.jsxs("select",{value:i?.bufferMinutes||0,onChange:$=>Ke($.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[r.jsx("option",{value:"0",children:"No buffer"}),r.jsx("option",{value:"5",children:"5 minutes"}),r.jsx("option",{value:"10",children:"10 minutes"}),r.jsx("option",{value:"15",children:"15 minutes"}),r.jsx("option",{value:"30",children:"30 minutes"})]})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Retention"}),r.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure win-back alerts to re-engage inactive clients"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsxs("div",{className:"pr-4",children:[r.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Enable Win-back Alerts"}),r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Show alerts when clients haven't visited in a while"})]}),r.jsx("button",{type:"button",onClick:async()=>{const $=i?.winbackSettings||{},ce=$.enabled===!1;try{await at(Xe(Ne,"shops",u),{winbackSettings:{...$,enabled:ce}}),o(_e=>({..._e,winbackSettings:{..._e.winbackSettings||{},enabled:ce}}))}catch(_e){console.error("Error updating winback settings:",_e)}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${i?.winbackSettings?.enabled!==!1?"bg-blue-500":"bg-slate-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${i?.winbackSettings?.enabled!==!1?"translate-x-6":"translate-x-1"}`})})]}),i?.winbackSettings?.enabled!==!1&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsxs("div",{className:"pr-4",children:[r.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Getting Cold Threshold"}),r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "Getting Cold" after this many days without a booking'})]}),r.jsxs("select",{value:i?.winbackSettings?.warningDays||30,onChange:async $=>{const ce=parseInt($.target.value),_e=i?.winbackSettings||{};try{await at(Xe(Ne,"shops",u),{winbackSettings:{..._e,warningDays:ce}}),o(je=>({...je,winbackSettings:{...je.winbackSettings||{},warningDays:ce}}))}catch(je){console.error("Error updating warning days:",je)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[r.jsx("option",{value:"14",children:"14 days"}),r.jsx("option",{value:"21",children:"21 days"}),r.jsx("option",{value:"30",children:"30 days"}),r.jsx("option",{value:"45",children:"45 days"}),r.jsx("option",{value:"60",children:"60 days"})]})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsxs("div",{className:"pr-4",children:[r.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"At Risk Threshold"}),r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "At Risk" after this many days without a booking'})]}),r.jsxs("select",{value:i?.winbackSettings?.inactiveDays||60,onChange:async $=>{const ce=parseInt($.target.value),_e=i?.winbackSettings||{};try{await at(Xe(Ne,"shops",u),{winbackSettings:{..._e,inactiveDays:ce}}),o(je=>({...je,winbackSettings:{...je.winbackSettings||{},inactiveDays:ce}}))}catch(je){console.error("Error updating inactive days:",je)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[r.jsx("option",{value:"30",children:"30 days"}),r.jsx("option",{value:"45",children:"45 days"}),r.jsx("option",{value:"60",children:"60 days"}),r.jsx("option",{value:"90",children:"90 days"}),r.jsx("option",{value:"120",children:"120 days"})]})]}),r.jsxs("div",{className:"p-3.5 bg-orange-50 border border-orange-200 rounded-xl text-xs text-orange-800 leading-relaxed",children:[r.jsx("strong",{children:" Tip:"}),' Clients flagged as "Lost" (over 90 days) will also appear in win-back alerts. Visit the ',r.jsx("strong",{children:"Clients"})," tab to view at-risk clients and send win-back messages."]})]})]})]}),r.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:r.jsx(p9,{shopId:u,shop:i,slug:e})})]}),z==="schedule"&&r.jsxs("div",{className:"animate-fade-in",children:[V.length>0&&r.jsx("div",{className:"flex flex-wrap gap-4 mb-6",children:r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5",children:"Filter by Staff"}),r.jsxs("select",{value:A,onChange:$=>T($.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[r.jsx("option",{value:"all",children:"All Staff"}),V.map($=>r.jsxs("option",{value:$.id,children:[$.name,$.role?`  ${$.role}`:""]},$.id))]})]})}),ft.length>0&&r.jsxs("div",{className:"mb-6 bg-violet-50 border border-violet-200 rounded-xl p-5",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(Yf,{className:"w-4 h-4 text-violet-600"}),r.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Recurring Weekly Hours"})]}),r.jsx("div",{className:"space-y-2.5",children:ft.map($=>{const ce=uN.filter(_e=>$.weeklyHours[_e.key]?.enabled);return r.jsxs("div",{className:"flex items-start gap-2.5",children:[r.jsx("div",{className:"w-7 h-7 bg-violet-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:r.jsx(Ft,{className:"w-3.5 h-3.5 text-violet-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-slate-900 text-sm",children:$.name}),r.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:ce.map(_e=>{const je=$.weeklyHours[_e.key];return r.jsxs("span",{className:"inline-block px-2 py-0.5 bg-white text-violet-700 border border-violet-200 rounded text-xs font-medium",children:[_e.short," ",ri(je.start),"",ri(je.end),je.break&&r.jsxs("span",{className:"text-amber-600 ml-1",children:["(break ",ri(je.break.start),"",ri(je.break.end),")"]})]},_e.key)})})]})]},$.id)})}),r.jsx("p",{className:"text-xs text-violet-500 mt-3",children:"Slots auto-generate on the booking page. Manage hours in the Staff tab."})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Monthly Overview"}),r.jsx(LO,{slotsByDate:an,bookingsByDate:jn,selectedDate:ae,onSelectDate:Y,recurringDayFlags:St,breaksByDate:qs}),ae&&r.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[r.jsxs("span",{className:"text-sm text-slate-600",children:["Showing: ",r.jsx("strong",{className:"text-slate-900",children:new Date(ae+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),r.jsx("button",{onClick:()=>Y(null),className:"text-xs px-3 py-1 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-medium transition-all border border-slate-200",children:"Show All"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:ft.length>0?"Add Custom Slots":"Create Time Slots"}),ft.length>0&&r.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Use this for one-off availability outside regular hours."}),!ft.length&&r.jsx("div",{className:"mb-4"}),r.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[V.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Staff Member"}),r.jsxs("select",{value:Ee.staffId,onChange:$=>xe({...Ee,staffId:$.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[r.jsx("option",{value:"",children:"Select a staff member"}),V.map($=>r.jsxs("option",{value:$.id,children:[$.name,$.role?`  ${$.role}`:""]},$.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Date"}),r.jsx("input",{type:"date",value:Ee.date,onChange:$=>xe({...Ee,date:$.target.value}),required:!0,min:new Date().toISOString().split("T")[0],className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Start"}),r.jsx("input",{type:"time",value:Ee.startTime,onChange:$=>xe({...Ee,startTime:$.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"End"}),r.jsx("input",{type:"time",value:Ee.endTime,onChange:$=>xe({...Ee,endTime:$.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Slot Duration"}),(()=>{const[$,ce]=Ee.startTime.split(":").map(Number),[_e,je]=Ee.endTime.split(":").map(Number),Fe=_e*60+je-($*60+ce),de=[{value:"15",label:"15 minutes"},{value:"30",label:"30 minutes"},{value:"45",label:"45 minutes"},{value:"60",label:"1 hour"},{value:"90",label:"1.5 hours"},{value:"120",label:"2 hours"}].filter(we=>parseInt(we.value)<=Fe);return r.jsx("select",{value:Ee.slotDuration,onChange:we=>xe({...Ee,slotDuration:we.target.value}),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:de.length>0?de.map(we=>r.jsx("option",{value:we.value,children:we.label},we.value)):r.jsx("option",{value:"15",children:"15 minutes"})})})()]}),r.jsxs("button",{type:"submit",className:"w-full flex items-center justify-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[r.jsx(Qa,{className:"w-4 h-4"}),"Generate Slots"]})]}),r.jsxs("div",{className:"mt-4 p-3.5 bg-blue-50 border border-blue-100 rounded-xl text-xs text-slate-600 leading-relaxed",children:[r.jsx("strong",{className:"text-slate-700",children:" Tip:"})," ",ft.length>0?"Weekly hours auto-generate slots. Use this for one-off slots outside regular hours.":V.length>0?"Select a staff member, pick a date, and set working hours to create slots.":"Set your hours and slot duration. We'll create all the time slots for that day."]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:ae?"Bookings":"All Bookings"}),Vt.pending>0&&r.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 border border-amber-200 text-xs font-bold rounded-full",children:[Vt.pending," pending"]})]}),r.jsx("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:gs.length})]}),r.jsx("div",{className:"flex items-center gap-1 mb-4 p-1 bg-slate-100 rounded-lg overflow-x-auto",children:[{key:"all",label:"All"},{key:"pending",label:"Pending"},{key:"confirmed",label:"Confirmed"},{key:"cancelled",label:"Cancelled"}].map($=>r.jsxs("button",{onClick:()=>I($.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-semibold transition-all whitespace-nowrap ${E===$.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[$.label,r.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${E===$.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:Vt[$.key]})]},$.key))}),gs.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(U1,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium",children:E!=="all"?`No ${E} bookings`:ae?"No bookings for this date":"No bookings yet"})]}):r.jsx("div",{className:"space-y-2.5 max-h-[500px] overflow-y-auto pr-1",children:gs.sort(($,ce)=>`${$.date}${$.time}`.localeCompare(`${ce.date}${ce.time}`)).map($=>{const ce=$.status||"confirmed",_e={pending:"bg-amber-50 text-amber-700 border-amber-200",confirmed:"bg-emerald-50 text-emerald-700 border-emerald-200",rejected:"bg-red-50 text-red-700 border-red-200",cancelled:"bg-slate-100 text-slate-500 border-slate-200"},je={pending:"Pending",confirmed:"Confirmed",rejected:"Rejected",cancelled:"Cancelled"};return r.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(wl,{className:"w-4 h-4 text-blue-600"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:$.clientName}),r.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${_e[ce]}`,children:je[ce]}),$.recurring&&r.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",title:"Recurring appointment",children:r.jsx(gi,{className:"w-2.5 h-2.5"})})]}),r.jsx("div",{className:"text-xs text-slate-500",children:et($.date,$.time)})]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[ce==="pending"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>ne($.id),className:"p-1.5 text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50 rounded-lg transition-all",title:"Approve booking",children:r.jsx(Ks,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>Se($.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Reject booking",children:r.jsx(La,{className:"w-4 h-4"})})]}),ce==="confirmed"&&r.jsx("button",{onClick:()=>At($.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Cancel booking",children:r.jsx(Lo,{className:"w-3.5 h-3.5"})})]})]}),r.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[$.serviceName&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(wn,{className:"w-3 h-3 text-blue-400"}),r.jsx("span",{className:"font-medium text-slate-700",children:$.serviceName}),$.servicePrice!=null&&r.jsxs("span",{className:"text-blue-600 font-semibold",children:["$",Number($.servicePrice).toFixed(2)]})]}),$.staffName&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Ft,{className:"w-3 h-3 text-violet-400"}),r.jsx("span",{className:"text-violet-600",children:$.staffName})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(gf,{className:"w-3 h-3"}),$.clientEmail]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Z0,{className:"w-3 h-3"}),$.clientPhone]})]}),r.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[$.refCode&&r.jsxs("span",{className:"font-mono text-[10px] text-slate-400",children:["REF: ",$.refCode]}),$.recurring&&r.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-indigo-50 border border-indigo-200 rounded text-[10px] font-semibold text-indigo-600",children:" Recurring"})]})]})]},$.id)})})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:ae?"Custom Time Slots":"All Custom Time Slots"}),r.jsx("span",{className:"text-xs font-semibold text-slate-500 bg-slate-100 px-2.5 py-1 rounded-lg",children:ae?(an[ae]||[]).length:Ge.length})]}),ft.length>0&&r.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Recurring slots from weekly hours auto-generate  not shown here."}),!ft.length&&r.jsx("div",{className:"mb-4"}),Js.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(jt,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:ae?"No custom slots for this date":"No custom slots yet"}),r.jsx("p",{className:"text-xs text-slate-400",children:ft.length>0?"Recurring hours handle most scheduling.":"Use the form above to generate availability."})]}):r.jsx("div",{className:"space-y-6",children:Js.map($=>r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100",children:new Date($).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-2.5",children:an[$].sort((ce,_e)=>ce.time.localeCompare(_e.time)).map(ce=>r.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-3.5 text-center group hover:border-slate-300 transition-all",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 mb-0.5",children:ri(ce.time)}),r.jsxs("div",{className:"text-xs text-slate-500 mb-1",children:[ce.duration," min"]}),ce.staffName&&r.jsxs("div",{className:"text-xs text-violet-600 mb-1.5 flex items-center justify-center gap-1",children:[r.jsx(Ft,{className:"w-3 h-3"}),ce.staffName]}),r.jsx("div",{className:"mb-2",children:ce.available?r.jsx("span",{className:"inline-block px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-md text-xs font-medium",children:"Available"}):r.jsx("span",{className:"inline-block px-2 py-0.5 bg-red-50 text-red-700 border border-red-200 rounded-md text-xs font-medium",children:"Booked"})}),ce.available&&r.jsxs("button",{onClick:()=>ue(ce.id),className:"opacity-0 group-hover:opacity-100 flex items-center justify-center gap-1 w-full px-2 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-xs font-medium transition-all border border-red-200",children:[r.jsx(Lo,{className:"w-3 h-3"}),"Remove"]})]},ce.id))})]},$))})]})]})]})]})}function v9({user:n}){const{slug:e}=$o(),t=_l(),[i,o]=j.useState(""),[u,d]=j.useState(""),[p,g]=j.useState(""),[x,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;(async()=>{const R=Ln(Ze(Ne,"shops"),bn("slug","==",e)),B=await nn(R);B.empty||B.docs[0].data().ownerUid===n.uid&&t(`/shop/${e}/dashboard`,{replace:!0})})()},[n,e,t]);const w=async S=>{S.preventDefault(),g(""),b(!0);try{const B=(await p_(ji,i,u)).user,V=Ln(Ze(Ne,"shops"),bn("slug","==",e)),F=await nn(V);if(F.empty){g("Shop not found"),b(!1);return}if(F.docs[0].data().ownerUid!==B.uid){g("You are not the owner of this shop"),await ji.signOut(),b(!1);return}t(`/shop/${e}/dashboard`,{replace:!0})}catch(R){switch(R.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":g("Invalid email or password");break;case"auth/invalid-email":g("Please enter a valid email address");break;case"auth/too-many-requests":g("Too many failed attempts. Please try again later.");break;default:g("Login failed. Please try again.")}d("")}finally{b(!1)}};return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[r.jsx("div",{className:"text-center mb-8",children:r.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2.5",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:r.jsx(ga,{className:"w-5 h-5 text-white"})}),r.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",r.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),r.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),r.jsxs("form",{onSubmit:w,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),r.jsx("input",{type:"email",value:i,onChange:S=>{o(S.target.value),g("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),r.jsx("input",{type:"password",value:u,onChange:S=>{d(S.target.value),g("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${p?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),p&&r.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[r.jsx("span",{children:""})," ",p]})]}),r.jsx("button",{type:"submit",disabled:x,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:x?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):"Sign In"})]}),r.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:r.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",r.jsx(nt,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs(nt,{to:`/shop/${e}`,className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[r.jsx(Ya,{className:"w-3.5 h-3.5"}),"Back to booking page"]})})]})})}function dN({name:n,className:e="w-12 h-12",bgClass:t="bg-blue-100 text-blue-700"}){const i=(n||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return r.jsx("div",{className:`${e} ${t} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function hN(){return r.jsxs(nt,{to:"/",className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:r.jsx(ga,{className:"w-3.5 h-3.5 text-white"})}),r.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",r.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function w9(){const{slug:n,refCode:e}=$o(),[t,i]=j.useState(null),[o,u]=j.useState(null),[d,p]=j.useState(!0),[g,x]=j.useState(!1),[b,w]=j.useState(null),[S,R]=j.useState(null),[B,V]=j.useState(!1),[F,H]=j.useState([]),[W,z]=j.useState([]),[ie,ae]=j.useState([]),[Y,A]=j.useState([]),[T,E]=j.useState(!1),[I,_]=j.useState(!1),[D,k]=j.useState(null),[L,P]=j.useState(null),[O,Q]=j.useState(null),[le,Ee]=j.useState(!1),[xe,U]=j.useState("");j.useEffect(()=>{(async()=>{p(!0);try{const Oe=Ln(Ze(Ne,"shops"),bn("slug","==",n)),me=await nn(Oe);if(me.empty)x(!0);else{const Ye=me.docs[0];i(Ye.data()),u(Ye.id)}}catch(Oe){console.error("Error looking up shop:",Oe),x(!0)}finally{p(!1)}})()},[n]),j.useEffect(()=>{if(!o)return;(async()=>{try{const Oe=Ln(Ze(Ne,"shops",o,"bookings"),bn("refCode","==",e.toUpperCase())),me=await nn(Oe);if(me.empty)V(!0);else{const Ye=me.docs[0];w(Ye.data()),R(Ye.id)}}catch(Oe){console.error("Error looking up booking:",Oe),V(!0)}})()},[o,e]),j.useEffect(()=>{if(!o||!b)return;const ke=Gt(Ze(Ne,"shops",o,"bookings"),Ue=>{H(Ue.docs.map(De=>({id:De.id,...De.data()})))}),Oe=Gt(Ze(Ne,"shops",o,"availability"),Ue=>{const De=new Date,qe=Ue.docs.map(Ge=>({id:Ge.id,...Ge.data()})).filter(Ge=>new Date(`${Ge.date}T${Ge.time}`)>De);z(qe)}),me=Gt(Ze(Ne,"shops",o,"staff"),Ue=>{ae(Ue.docs.map(De=>({id:De.id,...De.data()})).filter(De=>De.active!==!1).sort((De,qe)=>(De.name||"").localeCompare(qe.name||"")))}),Ye=Gt(Ze(Ne,"shops",o,"services"),Ue=>{A(Ue.docs.map(De=>({id:De.id,...De.data()})).filter(De=>De.active!==!1))});return()=>{ke(),Oe(),me(),Ye()}},[o,b]);const ee=t?.bufferMinutes||0,ue=j.useMemo(()=>{if(!b)return null;if(b.serviceId){const ke=Y.find(Oe=>Oe.id===b.serviceId);if(ke)return ke}return b.serviceName?{id:b.serviceId,name:b.serviceName,price:b.servicePrice,duration:b.serviceDuration||b.duration}:null},[b,Y]),fe=j.useMemo(()=>{if(!T||!b)return[];const ke=new Date,Oe=ue?.duration||b.duration||60;let me=W.filter(Ge=>Ge.available);me=me.filter(Ge=>Ge.duration>=Oe),b.staffId&&(me=me.filter(Ge=>Ge.staffId===b.staffId||!Ge.staffId));const Ye=b.staffId?ie.filter(Ge=>Ge.id===b.staffId):ie,Ue=Hj(Ye,Oe,ee,4).filter(Ge=>new Date(`${Ge.date}T${Ge.time}`)>ke),De=Yj(Ue,me),qe=F.filter(Ge=>Ge.id!==S);return Gj(De,qe,ee)},[T,b,S,W,ie,F,ee,ue]),ge=j.useMemo(()=>[...new Set(fe.map(ke=>ke.date))].sort(),[fe]),Re=j.useMemo(()=>L?fe.filter(ke=>ke.date===L):[],[L,fe]),He=async(ke="single")=>{Ee(!0);try{if(await at(Xe(Ne,"shops",o,"bookings",S),{status:"cancelled"}),b.slotId&&!b.slotId.startsWith("wh-")&&!b.slotId.startsWith("recurring-"))try{await at(Xe(Ne,"shops",o,"availability",b.slotId),{available:!0})}catch(Oe){console.warn("Could not re-open slot:",Oe)}if(ke==="future"&&b.recurringGroupId){const Oe=F.filter(me=>me.recurringGroupId===b.recurringGroupId&&me.id!==S&&me.date>=b.date&&(me.status==="pending"||me.status==="confirmed"));for(const me of Oe)if(await at(Xe(Ne,"shops",o,"bookings",me.id),{status:"cancelled"}),me.slotId&&!me.slotId.startsWith("wh-")&&!me.slotId.startsWith("recurring-"))try{await at(Xe(Ne,"shops",o,"availability",me.slotId),{available:!0})}catch(Ye){console.warn("Could not re-open slot:",Ye)}}w(Oe=>({...Oe,status:"cancelled"})),_(!1),k(null),U("cancelled")}catch(Oe){console.error("Cancel error:",Oe),U("error")}finally{Ee(!1)}},At=async()=>{if(O){Ee(!0);try{const ke={date:O.date,time:O.time,slotId:O.id};if(O.staffId&&(ke.staffId=O.staffId,ke.staffName=O.staffName||""),t?.requireApproval&&(ke.status="pending"),b.slotId&&!b.slotId.startsWith("wh-"))try{await at(Xe(Ne,"shops",o,"availability",b.slotId),{available:!0})}catch(Oe){console.warn("Could not re-open old slot:",Oe)}if(!O.generated&&O.id)try{await at(Xe(Ne,"shops",o,"availability",O.id),{available:!1})}catch(Oe){console.warn("Could not block new slot:",Oe)}await at(Xe(Ne,"shops",o,"bookings",S),ke),w(Oe=>({...Oe,...ke})),E(!1),P(null),Q(null),U("rescheduled")}catch(ke){console.error("Reschedule error:",ke),U("error")}finally{Ee(!1)}}},ht=ke=>new Date(ke+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),rs=ke=>{const[Oe,me]=ke.split(":"),Ye=parseInt(Oe),Ue=Ye>=12?"PM":"AM";return`${Ye%12||12}:${me} ${Ue}`},ne=ke=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(ke),Se=ke=>{if(!ke)return"";if(ke<60)return`${ke} min`;const Oe=Math.floor(ke/60),me=ke%60;return me?`${Oe}h ${me}m`:`${Oe} hour${Oe>1?"s":""}`};if(d)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(g)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(jt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),r.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,r.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),r.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Ya,{className:"w-4 h-4"}),"Go Home"]})]})});if(B)return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),r.jsx(hN,{})]})}),r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(vl,{className:"w-8 h-8 text-amber-500"})}),r.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Not Found"}),r.jsx("p",{className:"text-slate-600 mb-2",children:"No booking found with reference code"}),r.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),r.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(jt,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking"})]})});const Ve=b.status||"confirmed",Ke=Ve==="pending"||Ve==="confirmed",et=Ve==="cancelled",St=Ve==="rejected",qs={pending:{label:"Pending Approval",color:"bg-amber-100 text-amber-700 border-amber-200",icon:Xt},confirmed:{label:"Confirmed",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Cs},cancelled:{label:"Cancelled",color:"bg-slate-100 text-slate-500 border-slate-200",icon:La},rejected:{label:"Rejected",color:"bg-red-100 text-red-700 border-red-200",icon:La}},ft=qs[Ve]||qs.confirmed,mt=ft.icon;return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),r.jsx(hN,{})]})}),r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[xe==="rescheduled"&&r.jsx("div",{className:"mb-6 animate-scale-in",children:r.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(Ej,{className:"w-8 h-8 text-emerald-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Rescheduled!"}),r.jsx("p",{className:"text-slate-600 mb-4",children:t?.requireApproval?"Your booking has been rescheduled and is pending approval.":"Your booking has been successfully rescheduled."}),r.jsx("button",{onClick:()=>U(""),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View updated details "})]})}),xe==="cancelled"&&r.jsx("div",{className:"mb-6 animate-scale-in",children:r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(La,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Cancelled"}),r.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking has been cancelled."}),r.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[r.jsx(jt,{className:"w-4 h-4"}),"Book a new appointment"]})]})}),xe==="error"&&r.jsx("div",{className:"mb-6 animate-scale-in",children:r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[r.jsx("span",{children:""}),r.jsx("span",{children:"Something went wrong. Please try again."})]})}),!T&&r.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Your Booking"}),r.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference: ",r.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),(et||St)&&r.jsxs("div",{className:`mb-4 p-4 rounded-xl border flex items-center gap-3 ${et?"bg-slate-50 border-slate-200":"bg-red-50 border-red-200"}`,children:[r.jsx(mt,{className:`w-5 h-5 ${et?"text-slate-400":"text-red-500"}`}),r.jsx("span",{className:`font-medium text-sm ${et?"text-slate-600":"text-red-700"}`,children:et?"This booking has been cancelled.":"This booking has been rejected by the shop."})]}),b.recurringGroupId&&r.jsxs("div",{className:"mb-4 p-3.5 bg-blue-50 border border-blue-200 rounded-xl flex items-center gap-2.5",children:[r.jsx(gi,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Part of a recurring series"}),b.recurringInterval&&r.jsxs("p",{className:"text-xs text-blue-600 mt-0.5",children:["Repeats every ",b.recurringInterval==="weekly"?"week":b.recurringInterval==="biweekly"?"2 weeks":b.recurringInterval==="fourweekly"?"4 weeks":b.recurringInterval==="monthly"?"month":b.recurringInterval]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),r.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${ft.color}`,children:[r.jsx(mt,{className:"w-3.5 h-3.5"}),ft.label]})]}),b.serviceName&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(wn,{className:"w-4 h-4 text-blue-600"})}),r.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.servicePrice!=null&&r.jsx("span",{className:"font-bold text-blue-600",children:ne(b.servicePrice)})]}),b.staffName&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx(dN,{name:b.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),r.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(jt,{className:"w-4 h-4 text-slate-600"})}),r.jsxs("span",{className:"font-semibold text-slate-800",children:[ht(b.date)," at ",rs(b.time)]})]}),r.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(Xt,{className:"w-4 h-4 text-slate-500"})}),r.jsx("span",{children:Se(b.serviceDuration||b.duration)})]})]}),Ke&&!xe&&r.jsx("div",{className:"space-y-3",children:I?r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 animate-scale-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(vl,{className:"w-5 h-5 text-red-500"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-slate-900",children:"Are you sure?"}),r.jsx("p",{className:"text-sm text-slate-600",children:"This action cannot be undone."})]})]}),b.recurringGroupId&&!D&&r.jsxs("div",{className:"space-y-2 mb-4",children:[r.jsxs("button",{onClick:()=>k("single"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[r.jsx(La,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this appointment only"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments in the series remain active"})]})]}),r.jsxs("button",{onClick:()=>k("future"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[r.jsx(gi,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future appointments"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments in the series"})]})]}),r.jsx("button",{onClick:()=>_(!1),className:"w-full px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Go Back"})]}),(!b.recurringGroupId||D)&&r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("button",{onClick:()=>He(D||"single"),disabled:le,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold transition-all disabled:opacity-50",children:[le?r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}):r.jsx(La,{className:"w-4 h-4"}),le?"Cancelling":D==="future"?"Cancel All Future":"Yes, Cancel"]}),r.jsx("button",{onClick:()=>{D?k(null):_(!1)},disabled:le,className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Go Back"})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>{E(!0),U("")},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[r.jsx(Yf,{className:"w-4 h-4"}),"Reschedule Booking"]}),r.jsxs("button",{onClick:()=>{_(!0),k(null)},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-white hover:bg-red-50 text-red-600 rounded-xl font-semibold border border-red-200 hover:border-red-300 transition-all",children:[r.jsx(La,{className:"w-4 h-4"}),"Cancel Booking"]})]})}),(et||St)&&r.jsx("div",{className:"text-center",children:r.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[r.jsx(jt,{className:"w-4 h-4"}),"Book Again"]})})]}),T&&r.jsxs("div",{className:"animate-fade-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[r.jsxs("button",{onClick:()=>{E(!1),P(null),Q(null)},className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[r.jsx(Ya,{className:"w-3.5 h-3.5"}),"Back to Booking"]}),b.serviceName&&r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[r.jsx(wn,{className:"w-3.5 h-3.5 text-blue-500"}),r.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName}),b.servicePrice!=null&&r.jsx("span",{className:"text-blue-600 font-bold",children:ne(b.servicePrice)})]}),b.staffName&&r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[r.jsx(dN,{name:b.staffName,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),r.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a New Time"}),r.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Pick a new date and time for your appointment"})]}),ge.length===0?r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:r.jsx(jt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),r.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"No time slots are currently available. Check back soon!"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mb-8",children:r.jsx(Dj,{availableDates:ge,selectedDate:L,onSelectDate:ke=>{P(ke),Q(null)}})}),L&&r.jsxs("div",{className:"animate-slide-down",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",ht(L)]}),r.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[Re.length," slot",Re.length!==1?"s":""]})]}),Re.length===0?r.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:r.jsx("p",{className:"text-slate-500",children:"No slots available for this date"})}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:Re.sort((ke,Oe)=>ke.time.localeCompare(Oe.time)).map(ke=>{const Oe=O?.id===ke.id;return r.jsxs("button",{onClick:()=>Q(ke),className:`group border rounded-xl p-4 transition-all duration-200 text-center ${Oe?"bg-blue-600 border-blue-600 text-white shadow-md shadow-blue-600/30":"bg-white border-slate-200 hover:border-blue-400 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5"}`,children:[r.jsx("div",{className:`text-lg font-bold mb-1 ${Oe?"text-white":"text-slate-900 group-hover:text-blue-700"} transition-colors`,children:rs(ke.time)}),ke.staffName&&r.jsxs("div",{className:`text-xs mb-0.5 flex items-center justify-center gap-1 ${Oe?"text-blue-100":"text-violet-600"}`,children:[r.jsx(Ft,{className:"w-3 h-3"}),ke.staffName]}),r.jsx("div",{className:`text-xs ${Oe?"text-blue-200":"text-slate-400"}`,children:Se(b.serviceDuration||b.duration)})]},ke.id)})}),O&&r.jsxs("div",{className:"mt-6 animate-fade-in",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-blue-200 shadow-sm p-5 mb-4",children:[r.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"New Appointment Time"}),r.jsxs("div",{className:"flex items-center gap-2.5 text-sm",children:[r.jsx(jt,{className:"w-4 h-4 text-blue-500"}),r.jsxs("span",{className:"font-semibold text-slate-800",children:[ht(O.date)," at ",rs(O.time)]})]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:At,disabled:le,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed",children:le?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Rescheduling"]}):r.jsxs(r.Fragment,{children:[r.jsx(Cs,{className:"w-4 h-4"}),"Confirm Reschedule"]})}),r.jsx("button",{onClick:()=>Q(null),className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]})]}),!L&&r.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]})]}),r.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:r.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",r.jsx(nt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})})]})}function fN(){return r.jsxs(nt,{to:"/",className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:r.jsx(ga,{className:"w-3.5 h-3.5 text-white"})}),r.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",r.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function N9(n){if(!n)return"Any time";const e=t=>{const[i,o]=t.split(":").map(Number),u=i>=12?"PM":"AM",d=i%12||12;return o===0?`${d}${u}`:`${d}:${o.toString().padStart(2,"0")}${u}`};return n.start==="00:00"&&n.end==="23:59"?"Any time":`${e(n.start)}  ${e(n.end)}`}function _9(n){if(!n||n.length===0)return"Any day";const e={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return n.map(t=>e[t]||t).join(", ")}function j9(n){if(!n)return"";const e=new Date,t=new Date(n),i=e-t,o=Math.floor(i/6e4);if(o<60)return`${o}m ago`;const u=Math.floor(o/60);return u<24?`${u}h ago`:`${Math.floor(u/24)}d ago`}function S9(){const{slug:n,refCode:e}=$o(),[t,i]=j.useState(null),[o,u]=j.useState(null),[d,p]=j.useState(!0),[g,x]=j.useState(!1),[b,w]=j.useState(null),[S,R]=j.useState(!1),[B,V]=j.useState(null);if(j.useEffect(()=>{(async()=>{p(!0);try{const Y=Ln(Ze(Ne,"shops"),bn("slug","==",n)),A=await nn(Y);if(A.empty)x(!0);else{const T=A.docs[0];i(T.data()),u(T.id)}}catch(Y){console.error("Error looking up shop:",Y),x(!0)}finally{p(!1)}})()},[n]),j.useEffect(()=>{if(!o)return;(async()=>{try{const Y=Ln(Ze(Ne,"shops",o,"waitlist"),bn("refCode","==",e.toUpperCase())),A=await nn(Y);if(A.empty){R(!0);return}const T=A.docs[0],E={id:T.id,...T.data()};w(E);const I=Ln(Ze(Ne,"shops",o,"waitlist"),bn("serviceId","==",E.serviceId),bn("status","==","waiting")),k=(await nn(I)).docs.map(L=>({id:L.id,...L.data()})).sort((L,P)=>(L.createdAt||"").localeCompare(P.createdAt||"")).findIndex(L=>L.id===E.id);k>=0&&V(k+1)}catch(Y){console.error("Error looking up waitlist entry:",Y),R(!0)}})()},[o,e]),d)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(g)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(jt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),r.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,r.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),r.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Ya,{className:"w-4 h-4"}),"Go Home"]})]})});if(S)return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),r.jsx(fN,{})]})}),r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(vl,{className:"w-8 h-8 text-amber-500"})}),r.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Waitlist Entry Not Found"}),r.jsx("p",{className:"text-slate-600 mb-2",children:"No waitlist entry found with reference code"}),r.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),r.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(jt,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading waitlist"})]})});const F={waiting:{label:"Waiting",color:"bg-blue-100 text-blue-700 border-blue-200",icon:Xt},notified:{label:"Slot Available!",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:wo},booked:{label:"Booked",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Cs},expired:{label:"Expired",color:"bg-slate-100 text-slate-500 border-slate-200",icon:Xt}},H=F[b.status]||F.waiting,W=H.icon,z=ae=>ae?new Date(ae+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):"",ie=ae=>{if(!ae)return"";const[Y,A]=ae.split(":"),T=parseInt(Y),E=T>=12?"PM":"AM";return`${T%12||12}:${A} ${E}`};return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),r.jsx(fN,{})]})}),r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:r.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[b.status==="notified"&&r.jsx("div",{className:"mb-6 animate-scale-in",children:r.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(wo,{className:"w-8 h-8 text-emerald-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"A Slot Is Available!"}),r.jsxs("p",{className:"text-slate-600 mb-4",children:["A slot has opened up for ",b.serviceName,". Book now before it's taken!"]}),b.notifiedSlot&&r.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-xl text-sm text-emerald-700 font-medium mb-4",children:[r.jsx(jt,{className:"w-4 h-4"}),z(b.notifiedSlot.date)," at"," ",ie(b.notifiedSlot.time),b.notifiedSlot.staffName&&r.jsxs("span",{className:"text-emerald-600",children:[" ","with ",b.notifiedSlot.staffName]})]}),r.jsx("div",{children:r.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-emerald-600/20 hover:shadow-lg",children:[r.jsx(jt,{className:"w-4 h-4"}),"Book Now "]})})]})}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Waitlist Status"}),r.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference:"," ",r.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),r.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${H.color}`,children:[r.jsx(W,{className:"w-3.5 h-3.5"}),H.label]})]}),b.status==="waiting"&&B!=null&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Position"}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(K0,{className:"w-4 h-4 text-blue-500"}),r.jsxs("span",{className:"font-bold text-slate-900 text-lg",children:["#",B]}),r.jsx("span",{className:"text-sm text-slate-500",children:"in line"})]})]}),b.serviceName&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(wn,{className:"w-4 h-4 text-blue-600"})}),r.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.staffName&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center",children:r.jsx(Ft,{className:"w-4 h-4 text-violet-600"})}),r.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),b.preferredDate&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(jt,{className:"w-4 h-4 text-slate-600"})}),r.jsxs("span",{className:"text-sm text-slate-700",children:["Preferred: ",z(b.preferredDate)]})]}),b.preferredDays&&b.preferredDays.length>0&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(jt,{className:"w-4 h-4 text-slate-600"})}),r.jsxs("span",{className:"text-sm text-slate-700",children:["Days: ",_9(b.preferredDays)]})]}),b.preferredTimeRange&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(Xt,{className:"w-4 h-4 text-slate-500"})}),r.jsxs("span",{className:"text-sm text-slate-700",children:["Time: ",N9(b.preferredTimeRange)]})]}),b.createdAt&&r.jsxs("div",{className:"pt-2 border-t border-slate-100 text-xs text-slate-400",children:["Joined ",j9(b.createdAt)]})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[r.jsx(jt,{className:"w-4 h-4"}),b.status==="notified"?"Book Now":"Check Available Slots"]})})]})}),r.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:r.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",r.jsx(nt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})})]})}function E9(){return r.jsxs(nt,{to:"/",className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:r.jsx(ga,{className:"w-3.5 h-3.5 text-white"})}),r.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",r.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function mN(n){if(n==null)return"";if(n<1)return"Next up!";if(n<60)return`~${n} min`;const e=Math.floor(n/60),t=n%60;return t>0?`~${e}h ${t}m`:`~${e}h`}function T9(){const{slug:n}=$o(),[e,t]=j.useState(null),[i,o]=j.useState(null),[u,d]=j.useState(!0),[p,g]=j.useState(!1),[x,b]=j.useState([]),[w,S]=j.useState([]),[R,B]=j.useState([]),[V,F]=j.useState(!1),[H,W]=j.useState(!1),[z,ie]=j.useState(!1),[ae,Y]=j.useState(""),[A,T]=j.useState(0),[E,I]=j.useState({clientName:"",serviceId:""}),[_,D]=j.useState(Date.now());j.useEffect(()=>{const xe=setInterval(()=>D(Date.now()),3e4);return()=>clearInterval(xe)},[]),j.useEffect(()=>{(async()=>{d(!0);try{const U=Ln(Ze(Ne,"shops"),bn("slug","==",n)),ee=await nn(U);if(ee.empty)g(!0);else{const ue=ee.docs[0];t(ue.data()),o(ue.id)}}catch(U){console.error("Error looking up shop:",U),g(!0)}finally{d(!1)}})()},[n]),j.useEffect(()=>{if(!i)return;const xe=Gt(Ze(Ne,"shops",i,"walkins"),ue=>{const fe=ue.docs.map(ge=>({id:ge.id,...ge.data()}));b(fe)}),U=Gt(Ze(Ne,"shops",i,"staff"),ue=>{const fe=ue.docs.map(ge=>({id:ge.id,...ge.data()})).filter(ge=>ge.active!==!1);S(fe)}),ee=Gt(Ze(Ne,"shops",i,"services"),ue=>{const fe=ue.docs.map(ge=>({id:ge.id,...ge.data()})).filter(ge=>ge.active!==!1).sort((ge,Re)=>(ge.name||"").localeCompare(Re.name||""));B(fe)});return()=>{xe(),U(),ee()}},[i]);const k=j.useMemo(()=>x.filter(xe=>xe.status==="waiting").sort((xe,U)=>(xe.position||0)-(U.position||0)),[x]),L=j.useMemo(()=>x.filter(xe=>xe.status==="in-progress"),[x]),P=j.useMemo(()=>Math.max(w.length,1),[w]),O=j.useMemo(()=>Kj({waitingQueue:k,inProgress:L,staffCount:P,defaultDuration:30}),[k,L,P]),Q=j.useMemo(()=>Qj({waitingAhead:k,inProgress:L,staffCount:P,defaultDuration:30}),[k,L,P]),le=j.useMemo(()=>{const xe=new Date;return xe.setHours(0,0,0,0),x.filter(U=>{const ee=U.joinedAt?.toDate?.()||(U.joinedAt?new Date(U.joinedAt):null);return ee&&ee>=xe}).length},[x]),Ee=async xe=>{xe.preventDefault(),W(!0);const U=R.find(ge=>ge.id===E.serviceId),ue=(k.length>0?Math.max(...k.map(ge=>ge.position||0)):0)+1,fe=E.clientName.trim()||`Walk-in #${le+1}`;try{await ya(Ze(Ne,"shops",i,"walkins"),{clientName:fe,serviceId:E.serviceId||null,serviceName:U?.name||null,staffId:null,staffName:null,estimatedDuration:U?.duration||30,status:"waiting",position:ue,joinedAt:It.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),Y(fe),T(ue),ie(!0),F(!1),I({clientName:"",serviceId:""})}catch(ge){console.error("Error joining queue:",ge)}finally{W(!1)}};return u?r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):p?r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(jt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),r.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,r.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),r.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Ya,{className:"w-4 h-4"}),"Go Home"]})]})}):r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e?.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e?.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Live Queue"})]})]}),r.jsx(E9,{})]})}),r.jsxs("div",{className:"max-w-2xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[z&&r.jsxs("div",{className:"mb-6 bg-emerald-50 border border-emerald-200 rounded-2xl p-6 text-center animate-scale-in",children:[r.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-3",children:r.jsx(Ft,{className:"w-7 h-7 text-emerald-600"})}),r.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"You're in the queue!"}),r.jsxs("p",{className:"text-slate-600 text-sm mb-2",children:[r.jsx("strong",{children:ae}),"  Position #",A]}),r.jsx("button",{onClick:()=>ie(!1),className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"Dismiss"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Ft,{className:"w-6 h-6 text-blue-600"})}),r.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:k.length}),r.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"People Waiting"})]}),r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[r.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Rj,{className:"w-6 h-6 text-amber-600"})}),r.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:mN(Q)}),r.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"Est. Wait (New)"})]})]}),L.length>0&&r.jsxs("div",{className:"mb-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[r.jsx(Scissors,{className:"w-5 h-5 text-emerald-500"}),"Currently Being Served"]}),r.jsx("div",{className:"space-y-2",children:L.map(xe=>r.jsxs("div",{className:"bg-white rounded-xl border border-emerald-200 p-4 flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:r.jsx(Scissors,{className:"w-5 h-5 text-emerald-600"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-semibold text-slate-900",children:xe.clientName}),r.jsx("div",{className:"text-xs text-slate-500",children:xe.serviceName||"Service in progress"})]})]},xe.id))})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[r.jsx(Xt,{className:"w-5 h-5 text-blue-500"}),"Queue"]}),k.length===0?r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-10 text-center",children:[r.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Ft,{className:"w-7 h-7 text-emerald-500"})}),r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"No Wait!"}),r.jsx("p",{className:"text-sm text-slate-500",children:"The queue is empty  you can walk right in!"})]}):r.jsx("div",{className:"space-y-2",children:k.map((xe,U)=>{const ee=O.get(xe.id);return r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4 flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center font-extrabold text-blue-700 text-lg flex-shrink-0",children:U+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-semibold text-slate-900 text-lg truncate",children:xe.clientName}),xe.serviceName&&r.jsxs("div",{className:"text-sm text-slate-500 flex items-center gap-1",children:[r.jsx(wn,{className:"w-3 h-3"}),xe.serviceName]})]}),r.jsxs("div",{className:"text-right flex-shrink-0",children:[r.jsx("div",{className:"text-lg font-bold text-amber-600",children:mN(ee)}),r.jsx("div",{className:"text-xs text-slate-400",children:"est. wait"})]})]},xe.id)})})]}),!z&&r.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:V?r.jsxs("form",{onSubmit:Ee,children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Join the Queue"}),r.jsxs("div",{className:"space-y-3 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Your Name"}),r.jsx("input",{type:"text",value:E.clientName,onChange:xe=>I(U=>({...U,clientName:xe.target.value})),placeholder:"Optional",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg"})]}),R.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Service"}),r.jsxs("select",{value:E.serviceId,onChange:xe=>I(U=>({...U,serviceId:xe.target.value})),className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg",children:[r.jsx("option",{value:"",children:"Select a service"}),R.map(xe=>r.jsxs("option",{value:xe.id,children:[xe.name," (",xe.duration,"min  $",Number(xe.price).toFixed(2),")"]},xe.id))]})]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("button",{type:"submit",disabled:H,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[r.jsx(Qa,{className:"w-5 h-5"}),H?"Joining":"Join Queue"]}),r.jsx("button",{type:"button",onClick:()=>{F(!1),I({clientName:"",serviceId:""})},className:"px-6 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]}):r.jsxs("button",{onClick:()=>F(!0),className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[r.jsx(Qa,{className:"w-5 h-5"}),"Join the Queue"]})})]}),r.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-between",children:[r.jsxs(nt,{to:`/shop/${n}`,className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[r.jsx(jt,{className:"w-4 h-4"}),"Book Online"]}),r.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",r.jsx(nt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})]})})]})}const A9=["aaron.sharp2011@gmail.com"],su={free:0,pro:29,unlimited:79},il={free:{label:"Free",color:"bg-slate-100 text-slate-700 border-slate-200"},pro:{label:"Pro",color:"bg-blue-100 text-blue-700 border-blue-200"},unlimited:{label:"Unlimited",color:"bg-violet-100 text-violet-700 border-violet-200"}};function k9({user:n}){const e=_l(),[t,i]=j.useState(!0),[o,u]=j.useState([]),[d,p]=j.useState([]),[g,x]=j.useState("overview"),[b,w]=j.useState(""),[S,R]=j.useState(null),[B,V]=j.useState(null),F=n&&A9.includes(n.email?.toLowerCase());j.useEffect(()=>{if(!n){e("/",{replace:!0});return}if(!F){e("/",{replace:!0});return}H()},[n,F,e]);const H=async()=>{i(!0);try{const D=(await nn(Ze(Ne,"shops"))).docs.map(P=>({id:P.id,...P.data()}));u(D);const L=(await nn(Ze(Ne,"users"))).docs.map(P=>({id:P.id,...P.data()}));p(L)}catch(_){console.error("Error fetching admin data:",_)}finally{i(!1)}},W=async()=>{await g_(ji),e("/",{replace:!0})},z=j.useMemo(()=>{const _={free:0,pro:0,unlimited:0};let D=0,k=0;o.forEach(Q=>{const le=Q.subscriptionTier||"free";_[le]=(_[le]||0)+1,Q.stripeConnectAccountId&&(Q.stripeConnectComplete?D++:k++)});const L=_.pro*su.pro+_.unlimited*su.unlimited,P=new Date;P.setDate(P.getDate()-30);const O=o.filter(Q=>Q.createdAt?(Q.createdAt.toDate?Q.createdAt.toDate():new Date(Q.createdAt))>P:!1);return{totalShops:o.length,tierCounts:_,mrr:L,stripeConnectedCount:D,stripePendingCount:k,recentShops:O.length}},[o]),ie=j.useMemo(()=>{if(!b.trim())return o;const _=b.toLowerCase();return o.filter(D=>D.name?.toLowerCase().includes(_)||D.slug?.toLowerCase().includes(_)||D.ownerEmail?.toLowerCase().includes(_))},[o,b]),ae=j.useMemo(()=>[...ie].sort((_,D)=>{const k=_.createdAt?.toDate?_.createdAt.toDate():new Date(_.createdAt||0);return(D.createdAt?.toDate?D.createdAt.toDate():new Date(D.createdAt||0))-k}),[ie]),Y=async(_,D)=>{V(_);try{await at(Xe(Ne,"shops",_),{subscriptionTier:D}),u(k=>k.map(L=>L.id===_?{...L,subscriptionTier:D}:L))}catch(k){console.error("Error changing tier:",k)}finally{V(null)}},A=async(_,D)=>{V(_);try{await at(Xe(Ne,"shops",_),{disabled:!D}),u(k=>k.map(L=>L.id===_?{...L,disabled:!D}:L))}catch(k){console.error("Error toggling shop status:",k)}finally{V(null)}},T=_=>_?(_.toDate?_.toDate():new Date(_)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",E=_=>_.stripeConnectAccountId?_.stripeConnectComplete?{label:"Connected",color:"bg-emerald-100 text-emerald-700",icon:Cs}:{label:"Pending",color:"bg-amber-100 text-amber-700",icon:Xt}:{label:"None",color:"bg-slate-100 text-slate-500",icon:null};if(t)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading admin panel"})]})});if(!F)return null;const I=[{key:"overview",label:"Overview",icon:_j},{key:"shops",label:"Shops",icon:nl},{key:"revenue",label:"Revenue",icon:ko},{key:"support",label:"Support",icon:zh}];return r.jsxs("div",{className:"min-h-screen bg-slate-50",children:[r.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-violet-600 to-purple-600 rounded-xl flex items-center justify-center text-white shadow-md shadow-violet-600/20",children:r.jsx(Aj,{className:"w-5 h-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:"SpotBookie Admin"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Platform Management"})]})]}),r.jsx("div",{className:"hidden md:flex items-center bg-slate-100 p-1 rounded-xl",children:I.map(_=>{const D=_.icon;return r.jsxs("button",{onClick:()=>x(_.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${g===_.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[r.jsx(D,{className:"w-4 h-4"}),r.jsx("span",{children:_.label})]},_.key)})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:H,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all",children:[r.jsx(Yf,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),r.jsxs("button",{onClick:W,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",children:[r.jsx(X0,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),r.jsx("div",{className:"md:hidden bg-white border-b border-slate-200 px-4 py-2",children:r.jsx("div",{className:"flex items-center gap-1 overflow-x-auto",children:I.map(_=>{const D=_.icon;return r.jsxs("button",{onClick:()=>x(_.key),className:`flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-semibold whitespace-nowrap transition-all ${g===_.key?"bg-violet-100 text-violet-700":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:[r.jsx(D,{className:"w-4 h-4"}),r.jsx("span",{children:_.label})]},_.key)})})}),r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[g==="overview"&&r.jsxs("div",{className:"animate-fade-in",children:[r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:r.jsx(nl,{className:"w-5 h-5 text-blue-600"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:z.totalShops}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Shops"})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:r.jsx(ko,{className:"w-5 h-5 text-emerald-600"})})}),r.jsxs("div",{className:"text-2xl font-extrabold text-slate-900",children:["$",z.mrr]}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Monthly Recurring Revenue"})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:"w-10 h-10 bg-violet-100 rounded-xl flex items-center justify-center",children:r.jsx(yn,{className:"w-5 h-5 text-violet-600"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:z.stripeConnectedCount}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Stripe Connected"})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center",children:r.jsx(Uo,{className:"w-5 h-5 text-amber-600"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:z.recentShops}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"New (Last 30 Days)"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[r.jsx(Vo,{className:"w-5 h-5 text-amber-500"}),"Subscription Tiers"]}),r.jsx("div",{className:"space-y-4",children:Object.entries(z.tierCounts).map(([_,D])=>{const k=il[_]||il.free,L=z.totalShops>0?Math.round(D/z.totalShops*100):0;return r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-24",children:r.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-bold border ${k.color}`,children:k.label})}),r.jsx("div",{className:"flex-1",children:r.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:r.jsx("div",{className:`h-full rounded-full transition-all ${_==="free"?"bg-slate-400":_==="pro"?"bg-blue-500":"bg-violet-500"}`,style:{width:`${L}%`}})})}),r.jsxs("div",{className:"w-20 text-right",children:[r.jsx("span",{className:"text-sm font-bold text-slate-900",children:D}),r.jsxs("span",{className:"text-xs text-slate-500 ml-1",children:["(",L,"%)"]})]})]},_)})})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[r.jsx(yn,{className:"w-5 h-5 text-violet-500"}),"Payment Status"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Cs,{className:"w-5 h-5 text-emerald-600"}),r.jsx("span",{className:"font-semibold text-slate-900",children:"Stripe Connected"})]}),r.jsx("span",{className:"text-lg font-bold text-emerald-700",children:z.stripeConnectedCount})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Xt,{className:"w-5 h-5 text-amber-600"}),r.jsx("span",{className:"font-semibold text-slate-900",children:"Pending Setup"})]}),r.jsx("span",{className:"text-lg font-bold text-amber-700",children:z.stripePendingCount})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(nl,{className:"w-5 h-5 text-slate-500"}),r.jsx("span",{className:"font-semibold text-slate-900",children:"No Payments"})]}),r.jsx("span",{className:"text-lg font-bold text-slate-700",children:z.totalShops-z.stripeConnectedCount-z.stripePendingCount})]})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[r.jsx(Uo,{className:"w-5 h-5 text-blue-500"}),"Recent Signups"]}),r.jsx("div",{className:"space-y-3",children:ae.slice(0,5).map(_=>{const D=il[_.subscriptionTier]||il.free;return r.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-xl border border-slate-200 hover:border-slate-300 transition-all",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:r.jsx(nl,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:_.name||"Unnamed Shop"}),r.jsx("div",{className:"text-xs text-slate-500",children:_.ownerEmail})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-bold border ${D.color}`,children:D.label}),r.jsx("span",{className:"text-xs text-slate-500",children:T(_.createdAt)})]})]},_.id)})})]})]}),g==="shops"&&r.jsxs("div",{className:"animate-fade-in",children:[r.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-4 mb-6",children:r.jsxs("div",{className:"relative",children:[r.jsx(eg,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),r.jsx("input",{type:"text",placeholder:"Search by name, slug, or email...",value:b,onChange:_=>w(_.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]})}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[r.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Shops"}),r.jsxs("span",{className:"text-sm font-medium text-slate-500",children:[ie.length," shop",ie.length!==1?"s":""]})]}),r.jsxs("div",{className:"divide-y divide-slate-100",children:[ae.map(_=>{const D=il[_.subscriptionTier]||il.free,k=E(_),L=k.icon;return r.jsx("div",{className:`p-4 hover:bg-slate-50 transition-all ${_.disabled?"opacity-60":""}`,children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:(_.name||"S")[0].toUpperCase()}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:_.name||"Unnamed Shop"}),r.jsx("span",{className:`px-2 py-0.5 rounded-lg text-[10px] font-bold border ${D.color}`,children:D.label}),_.disabled&&r.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold bg-red-100 text-red-700 border border-red-200",children:"Disabled"})]}),r.jsxs("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:["/",_.slug,"  ",_.ownerEmail]}),r.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs",children:[r.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-md ${k.color}`,children:[L&&r.jsx(L,{className:"w-3 h-3"}),"Stripe: ",k.label]}),r.jsxs("span",{className:"text-slate-400",children:["Created: ",T(_.createdAt)]})]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[r.jsx(nt,{to:`/shop/${_.slug}`,target:"_blank",className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"View public page",children:r.jsx(xu,{className:"w-4 h-4"})}),r.jsx(nt,{to:`/shop/${_.slug}/dashboard`,target:"_blank",className:"p-2 text-slate-400 hover:text-violet-600 hover:bg-violet-50 rounded-lg transition-all",title:"View dashboard (impersonate)",children:r.jsx(hl,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>R(_),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",title:"Manage shop",children:r.jsx(zh,{className:"w-4 h-4"})})]})]})},_.id)}),ae.length===0&&r.jsxs("div",{className:"p-12 text-center",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(nl,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"No shops found"}),b&&r.jsx("button",{onClick:()=>w(""),className:"mt-2 text-sm text-violet-600 hover:underline",children:"Clear search"})]})]})]})]}),g==="revenue"&&r.jsxs("div",{className:"animate-fade-in",children:[r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[r.jsx(ko,{className:"w-5 h-5 text-emerald-500"}),"MRR Breakdown"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-900",children:"Pro Plans"}),r.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[z.tierCounts.pro," shops  $29/mo"]})]}),r.jsxs("span",{className:"text-lg font-bold text-blue-700",children:["$",z.tierCounts.pro*su.pro]})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-violet-50 border border-violet-200 rounded-xl",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-900",children:"Unlimited Plans"}),r.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[z.tierCounts.unlimited," shops  $79/mo"]})]}),r.jsxs("span",{className:"text-lg font-bold text-violet-700",children:["$",z.tierCounts.unlimited*su.unlimited]})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[r.jsx("div",{children:r.jsx("span",{className:"font-bold text-slate-900",children:"Total MRR"})}),r.jsxs("span",{className:"text-2xl font-extrabold text-emerald-700",children:["$",z.mrr]})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[r.jsx(yn,{className:"w-5 h-5 text-violet-500"}),"Platform Fees"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(VD,{className:"w-4 h-4 text-slate-500"}),r.jsx("span",{className:"font-semibold text-slate-900",children:"Free Tier"})]}),r.jsx("p",{className:"text-sm text-slate-600",children:"5% platform fee on deposit payments via Stripe Connect"})]}),r.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Qo,{className:"w-4 h-4 text-blue-500"}),r.jsx("span",{className:"font-semibold text-slate-900",children:"Pro & Unlimited"})]}),r.jsx("p",{className:"text-sm text-slate-600",children:"No platform fees  shops keep 100% of payments"})]})]}),r.jsx("div",{className:"mt-6 pt-4 border-t border-slate-200",children:r.jsxs("a",{href:"https://dashboard.stripe.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-violet-600 hover:bg-violet-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-violet-600/20 transition-all",children:[r.jsx(hl,{className:"w-4 h-4"}),"Open Stripe Dashboard"]})})]})]}),r.jsxs("div",{className:"mt-6 bg-white rounded-xl border border-slate-200 p-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[r.jsx(nl,{className:"w-5 h-5 text-blue-500"}),"Stripe Connect Accounts"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl text-center",children:[r.jsx("div",{className:"text-3xl font-extrabold text-emerald-700",children:z.stripeConnectedCount}),r.jsx("div",{className:"text-sm font-medium text-emerald-600 mt-1",children:"Fully Connected"})]}),r.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl text-center",children:[r.jsx("div",{className:"text-3xl font-extrabold text-amber-700",children:z.stripePendingCount}),r.jsx("div",{className:"text-sm font-medium text-amber-600 mt-1",children:"Pending Setup"})]}),r.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl text-center",children:[r.jsx("div",{className:"text-3xl font-extrabold text-slate-700",children:z.totalShops-z.stripeConnectedCount-z.stripePendingCount}),r.jsx("div",{className:"text-sm font-medium text-slate-600 mt-1",children:"Not Started"})]})]})]})]}),g==="support"&&r.jsxs("div",{className:"animate-fade-in",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[r.jsx(zh,{className:"w-5 h-5 text-violet-500"}),"Support Tools"]}),r.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Manage shops, impersonate dashboards, and take quick actions."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(xu,{className:"w-4 h-4 text-blue-500"}),r.jsx("span",{className:"font-semibold text-slate-900",children:"View Dashboard"})]}),r.jsx("p",{className:"text-sm text-slate-600",children:"Click the external link icon on any shop to view their dashboard. You must be logged in as an admin."})]}),r.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Vo,{className:"w-4 h-4 text-amber-500"}),r.jsx("span",{className:"font-semibold text-slate-900",children:"Change Tier"})]}),r.jsx("p",{className:"text-sm text-slate-600",children:"Click the settings icon on any shop to change their subscription tier or disable the account."})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Quick Shop Lookup"}),r.jsxs("div",{className:"relative mb-4",children:[r.jsx(eg,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),r.jsx("input",{type:"text",placeholder:"Search by name, slug, or email...",value:b,onChange:_=>w(_.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),b&&r.jsx("div",{className:"space-y-2",children:ie.slice(0,10).map(_=>r.jsxs("button",{onClick:()=>R(_),className:"w-full flex items-center justify-between p-3 bg-slate-50 hover:bg-slate-100 rounded-xl border border-slate-200 transition-all text-left",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(nl,{className:"w-4 h-4 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:_.name}),r.jsxs("div",{className:"text-xs text-slate-500",children:["/",_.slug]})]})]}),r.jsx(Nj,{className:"w-4 h-4 text-slate-400"})]},_.id))})]})]})]}),S&&r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl flex items-center justify-center text-white font-bold",children:(S.name||"S")[0].toUpperCase()}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:S.name}),r.jsxs("p",{className:"text-sm text-slate-500",children:["/",S.slug]})]})]}),r.jsx("button",{onClick:()=>R(null),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",children:r.jsx(Fs,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"space-y-3 mb-6",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(gf,{className:"w-4 h-4 text-slate-400"}),r.jsx("span",{className:"text-slate-600",children:S.ownerEmail})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(jt,{className:"w-4 h-4 text-slate-400"}),r.jsxs("span",{className:"text-slate-600",children:["Created: ",T(S.createdAt)]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(yn,{className:"w-4 h-4 text-slate-400"}),r.jsxs("span",{className:"text-slate-600",children:["Stripe: ",E(S).label,S.stripeConnectAccountId&&r.jsxs("span",{className:"ml-1 text-xs text-slate-400 font-mono",children:["(",S.stripeConnectAccountId,")"]})]})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2",children:"Subscription Tier"}),r.jsx("div",{className:"flex gap-2",children:["free","pro","unlimited"].map(_=>{const D=il[_],k=(S.subscriptionTier||"free")===_;return r.jsxs("button",{onClick:()=>Y(S.id,_),disabled:B===S.id,className:`flex-1 px-4 py-3 rounded-xl font-semibold text-sm transition-all border-2 ${k?_==="free"?"border-slate-400 bg-slate-100 text-slate-900":_==="pro"?"border-blue-500 bg-blue-50 text-blue-700":"border-violet-500 bg-violet-50 text-violet-700":"border-slate-200 bg-white text-slate-500 hover:border-slate-300"}`,children:[D.label,_!=="free"&&r.jsxs("span",{className:"block text-xs font-normal mt-0.5",children:["$",su[_],"/mo"]})]},_)})})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Quick Actions"}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs(nt,{to:`/shop/${S.slug}`,target:"_blank",className:"flex items-center justify-center gap-2 px-4 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-medium text-sm transition-all",children:[r.jsx(xu,{className:"w-4 h-4"}),"View Page"]}),r.jsxs(nt,{to:`/shop/${S.slug}/dashboard`,target:"_blank",className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-xl font-medium text-sm transition-all",children:[r.jsx(hl,{className:"w-4 h-4"}),"Dashboard"]})]}),r.jsx("button",{onClick:()=>A(S.id,S.disabled),disabled:B===S.id,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all ${S.disabled?"bg-emerald-100 hover:bg-emerald-200 text-emerald-700":"bg-red-100 hover:bg-red-200 text-red-700"}`,children:S.disabled?r.jsxs(r.Fragment,{children:[r.jsx(Cs,{className:"w-4 h-4"}),"Enable Shop"]}):r.jsxs(r.Fragment,{children:[r.jsx(nD,{className:"w-4 h-4"}),"Disable Shop"]})})]})]})})]})}const C9=["aaron.sharp2011@gmail.com"];function R9(){const[n,e]=j.useState(null),[t,i]=j.useState(!0);return j.useEffect(()=>{const o=Qk(ji,u=>{e(u),i(!1)});return()=>o()},[]),t?r.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):r.jsx(a5,{children:r.jsxs(MT,{children:[r.jsx(Jn,{path:"/",element:r.jsx(PM,{})}),r.jsx(Jn,{path:"/register",element:r.jsx(LM,{})}),r.jsx(Jn,{path:"/login",element:r.jsx(UM,{user:n})}),r.jsx(Jn,{path:"/shop/:slug",element:r.jsx(VO,{})}),r.jsx(Jn,{path:"/shop/:slug/booking/:refCode",element:r.jsx(w9,{})}),r.jsx(Jn,{path:"/shop/:slug/waitlist/:refCode",element:r.jsx(S9,{})}),r.jsx(Jn,{path:"/shop/:slug/queue",element:r.jsx(T9,{})}),r.jsx(Jn,{path:"/shop/:slug/login",element:r.jsx(v9,{user:n})}),r.jsx(Jn,{path:"/shop/:slug/dashboard",element:r.jsx(y9,{user:n})}),r.jsx(Jn,{path:"/admin",element:n&&C9.includes(n.email?.toLowerCase())?r.jsx(k9,{user:n}):r.jsx(Zv,{to:"/",replace:!0})}),r.jsx(Jn,{path:"*",element:r.jsx(Zv,{to:"/",replace:!0})})]})})}VE.createRoot(document.getElementById("root")).render(r.jsx(Ht.StrictMode,{children:r.jsx(R9,{})}));
