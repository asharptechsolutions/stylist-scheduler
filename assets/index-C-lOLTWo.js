(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();function mx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Jp={exports:{}},Qc={};var Qv;function BE(){if(Qv)return Qc;Qv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var p in o)p!=="key"&&(c[p]=o[p])}else c=o;return o=c.ref,{$$typeof:n,type:i,key:d,ref:o!==void 0?o:null,props:c}}return Qc.Fragment=e,Qc.jsx=t,Qc.jsxs=t,Qc}var Kv;function zE(){return Kv||(Kv=1,Jp.exports=BE()),Jp.exports}var a=zE(),Zp={exports:{}},ct={};var Xv;function FE(){if(Xv)return ct;Xv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),_=Symbol.iterator;function A(U){return U===null||typeof U!="object"?null:(U=_&&U[_]||U["@@iterator"],typeof U=="function"?U:null)}var L={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,F={};function q(U,Z,ue){this.props=U,this.context=Z,this.refs=F,this.updater=ue||L}q.prototype.isReactComponent={},q.prototype.setState=function(U,Z){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,Z,"setState")},q.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function Q(){}Q.prototype=q.prototype;function H(U,Z,ue){this.props=U,this.context=Z,this.refs=F,this.updater=ue||L}var ie=H.prototype=new Q;ie.constructor=H,V(ie,q.prototype),ie.isPureReactComponent=!0;var le=Array.isArray;function Y(){}var T={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function S(U,Z,ue){var me=ue.ref;return{$$typeof:n,type:U,key:Z,ref:me!==void 0?me:null,props:ue}}function I(U,Z){return S(U.type,Z,U.props)}function C(U){return typeof U=="object"&&U!==null&&U.$$typeof===n}function M(U){var Z={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ue){return Z[ue]})}var R=/\/+/g;function B(U,Z){return typeof U=="object"&&U!==null&&U.key!=null?M(""+U.key):Z.toString(36)}function P(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(Y,Y):(U.status="pending",U.then(function(Z){U.status==="pending"&&(U.status="fulfilled",U.value=Z)},function(Z){U.status==="pending"&&(U.status="rejected",U.reason=Z)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function O(U,Z,ue,me,ge){var De=typeof U;(De==="undefined"||De==="boolean")&&(U=null);var Ye=!1;if(U===null)Ye=!0;else switch(De){case"bigint":case"string":case"number":Ye=!0;break;case"object":switch(U.$$typeof){case n:case e:Ye=!0;break;case b:return Ye=U._init,O(Ye(U._payload),Z,ue,me,ge)}}if(Ye)return ge=ge(U),Ye=me===""?"."+B(U,0):me,le(ge)?(ue="",Ye!=null&&(ue=Ye.replace(R,"$&/")+"/"),O(ge,Z,ue,"",function(Wt){return Wt})):ge!=null&&(C(ge)&&(ge=I(ge,ue+(ge.key==null||U&&U.key===ge.key?"":(""+ge.key).replace(R,"$&/")+"/")+Ye)),Z.push(ge)),1;Ye=0;var pt=me===""?".":me+":";if(le(U))for(var dt=0;dt<U.length;dt++)me=U[dt],De=pt+B(me,dt),Ye+=O(me,Z,ue,De,ge);else if(dt=A(U),typeof dt=="function")for(U=dt.call(U),dt=0;!(me=U.next()).done;)me=me.value,De=pt+B(me,dt++),Ye+=O(me,Z,ue,De,ge);else if(De==="object"){if(typeof U.then=="function")return O(P(U),Z,ue,me,ge);throw Z=String(U),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return Ye}function K(U,Z,ue){if(U==null)return U;var me=[],ge=0;return O(U,me,"","",function(De){return Z.call(ue,De,ge++)}),me}function oe(U){if(U._status===-1){var Z=U._result;Z=Z(),Z.then(function(ue){(U._status===0||U._status===-1)&&(U._status=1,U._result=ue)},function(ue){(U._status===0||U._status===-1)&&(U._status=2,U._result=ue)}),U._status===-1&&(U._status=0,U._result=Z)}if(U._status===1)return U._result.default;throw U._result}var be=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},fe={map:K,forEach:function(U,Z,ue){K(U,function(){Z.apply(this,arguments)},ue)},count:function(U){var Z=0;return K(U,function(){Z++}),Z},toArray:function(U){return K(U,function(Z){return Z})||[]},only:function(U){if(!C(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return ct.Activity=w,ct.Children=fe,ct.Component=q,ct.Fragment=t,ct.Profiler=o,ct.PureComponent=H,ct.StrictMode=i,ct.Suspense=x,ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,ct.__COMPILER_RUNTIME={__proto__:null,c:function(U){return T.H.useMemoCache(U)}},ct.cache=function(U){return function(){return U.apply(null,arguments)}},ct.cacheSignal=function(){return null},ct.cloneElement=function(U,Z,ue){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var me=V({},U.props),ge=U.key;if(Z!=null)for(De in Z.key!==void 0&&(ge=""+Z.key),Z)!E.call(Z,De)||De==="key"||De==="__self"||De==="__source"||De==="ref"&&Z.ref===void 0||(me[De]=Z[De]);var De=arguments.length-2;if(De===1)me.children=ue;else if(1<De){for(var Ye=Array(De),pt=0;pt<De;pt++)Ye[pt]=arguments[pt+2];me.children=Ye}return S(U.type,ge,me)},ct.createContext=function(U){return U={$$typeof:d,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:c,_context:U},U},ct.createElement=function(U,Z,ue){var me,ge={},De=null;if(Z!=null)for(me in Z.key!==void 0&&(De=""+Z.key),Z)E.call(Z,me)&&me!=="key"&&me!=="__self"&&me!=="__source"&&(ge[me]=Z[me]);var Ye=arguments.length-2;if(Ye===1)ge.children=ue;else if(1<Ye){for(var pt=Array(Ye),dt=0;dt<Ye;dt++)pt[dt]=arguments[dt+2];ge.children=pt}if(U&&U.defaultProps)for(me in Ye=U.defaultProps,Ye)ge[me]===void 0&&(ge[me]=Ye[me]);return S(U,De,ge)},ct.createRef=function(){return{current:null}},ct.forwardRef=function(U){return{$$typeof:p,render:U}},ct.isValidElement=C,ct.lazy=function(U){return{$$typeof:b,_payload:{_status:-1,_result:U},_init:oe}},ct.memo=function(U,Z){return{$$typeof:g,type:U,compare:Z===void 0?null:Z}},ct.startTransition=function(U){var Z=T.T,ue={};T.T=ue;try{var me=U(),ge=T.S;ge!==null&&ge(ue,me),typeof me=="object"&&me!==null&&typeof me.then=="function"&&me.then(Y,be)}catch(De){be(De)}finally{Z!==null&&ue.types!==null&&(Z.types=ue.types),T.T=Z}},ct.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},ct.use=function(U){return T.H.use(U)},ct.useActionState=function(U,Z,ue){return T.H.useActionState(U,Z,ue)},ct.useCallback=function(U,Z){return T.H.useCallback(U,Z)},ct.useContext=function(U){return T.H.useContext(U)},ct.useDebugValue=function(){},ct.useDeferredValue=function(U,Z){return T.H.useDeferredValue(U,Z)},ct.useEffect=function(U,Z){return T.H.useEffect(U,Z)},ct.useEffectEvent=function(U){return T.H.useEffectEvent(U)},ct.useId=function(){return T.H.useId()},ct.useImperativeHandle=function(U,Z,ue){return T.H.useImperativeHandle(U,Z,ue)},ct.useInsertionEffect=function(U,Z){return T.H.useInsertionEffect(U,Z)},ct.useLayoutEffect=function(U,Z){return T.H.useLayoutEffect(U,Z)},ct.useMemo=function(U,Z){return T.H.useMemo(U,Z)},ct.useOptimistic=function(U,Z){return T.H.useOptimistic(U,Z)},ct.useReducer=function(U,Z,ue){return T.H.useReducer(U,Z,ue)},ct.useRef=function(U){return T.H.useRef(U)},ct.useState=function(U){return T.H.useState(U)},ct.useSyncExternalStore=function(U,Z,ue){return T.H.useSyncExternalStore(U,Z,ue)},ct.useTransition=function(){return T.H.useTransition()},ct.version="19.2.4",ct}var Jv;function px(){return Jv||(Jv=1,Zp.exports=FE()),Zp.exports}var j=px();const Ht=mx(j);var e0={exports:{}},Kc={},t0={exports:{}},s0={};var Zv;function $E(){return Zv||(Zv=1,(function(n){function e(O,K){var oe=O.length;O.push(K);e:for(;0<oe;){var be=oe-1>>>1,fe=O[be];if(0<o(fe,K))O[be]=K,O[oe]=fe,oe=be;else break e}}function t(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var K=O[0],oe=O.pop();if(oe!==K){O[0]=oe;e:for(var be=0,fe=O.length,U=fe>>>1;be<U;){var Z=2*(be+1)-1,ue=O[Z],me=Z+1,ge=O[me];if(0>o(ue,oe))me<fe&&0>o(ge,ue)?(O[be]=ge,O[me]=oe,be=me):(O[be]=ue,O[Z]=oe,be=Z);else if(me<fe&&0>o(ge,oe))O[be]=ge,O[me]=oe,be=me;else break e}}return K}function o(O,K){var oe=O.sortIndex-K.sortIndex;return oe!==0?oe:O.id-K.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var x=[],g=[],b=1,w=null,_=3,A=!1,L=!1,V=!1,F=!1,q=typeof setTimeout=="function"?setTimeout:null,Q=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function ie(O){for(var K=t(g);K!==null;){if(K.callback===null)i(g);else if(K.startTime<=O)i(g),K.sortIndex=K.expirationTime,e(x,K);else break;K=t(g)}}function le(O){if(V=!1,ie(O),!L)if(t(x)!==null)L=!0,Y||(Y=!0,M());else{var K=t(g);K!==null&&P(le,K.startTime-O)}}var Y=!1,T=-1,E=5,S=-1;function I(){return F?!0:!(n.unstable_now()-S<E)}function C(){if(F=!1,Y){var O=n.unstable_now();S=O;var K=!0;try{e:{L=!1,V&&(V=!1,Q(T),T=-1),A=!0;var oe=_;try{t:{for(ie(O),w=t(x);w!==null&&!(w.expirationTime>O&&I());){var be=w.callback;if(typeof be=="function"){w.callback=null,_=w.priorityLevel;var fe=be(w.expirationTime<=O);if(O=n.unstable_now(),typeof fe=="function"){w.callback=fe,ie(O),K=!0;break t}w===t(x)&&i(x),ie(O)}else i(x);w=t(x)}if(w!==null)K=!0;else{var U=t(g);U!==null&&P(le,U.startTime-O),K=!1}}break e}finally{w=null,_=oe,A=!1}K=void 0}}finally{K?M():Y=!1}}}var M;if(typeof H=="function")M=function(){H(C)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,B=R.port2;R.port1.onmessage=C,M=function(){B.postMessage(null)}}else M=function(){q(C,0)};function P(O,K){T=q(function(){O(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_next=function(O){switch(_){case 1:case 2:case 3:var K=3;break;default:K=_}var oe=_;_=K;try{return O()}finally{_=oe}},n.unstable_requestPaint=function(){F=!0},n.unstable_runWithPriority=function(O,K){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var oe=_;_=O;try{return K()}finally{_=oe}},n.unstable_scheduleCallback=function(O,K,oe){var be=n.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?be+oe:be):oe=be,O){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=oe+fe,O={id:b++,callback:K,priorityLevel:O,startTime:oe,expirationTime:fe,sortIndex:-1},oe>be?(O.sortIndex=oe,e(g,O),t(x)===null&&O===t(g)&&(V?(Q(T),T=-1):V=!0,P(le,oe-be))):(O.sortIndex=fe,e(x,O),L||A||(L=!0,Y||(Y=!0,M()))),O},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(O){var K=_;return function(){var oe=_;_=K;try{return O.apply(this,arguments)}finally{_=oe}}}})(s0)),s0}var ew;function qE(){return ew||(ew=1,t0.exports=$E()),t0.exports}var n0={exports:{}},Gs={};var tw;function HE(){if(tw)return Gs;tw=1;var n=px();function e(x){var g="https://react.dev/errors/"+x;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+x+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(x,g,b){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:w==null?null:""+w,children:x,containerInfo:g,implementation:b}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(x,g){if(x==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return Gs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Gs.createPortal=function(x,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(x,g,null,b)},Gs.flushSync=function(x){var g=d.T,b=i.p;try{if(d.T=null,i.p=2,x)return x()}finally{d.T=g,i.p=b,i.d.f()}},Gs.preconnect=function(x,g){typeof x=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(x,g))},Gs.prefetchDNS=function(x){typeof x=="string"&&i.d.D(x)},Gs.preinit=function(x,g){if(typeof x=="string"&&g&&typeof g.as=="string"){var b=g.as,w=p(b,g.crossOrigin),_=typeof g.integrity=="string"?g.integrity:void 0,A=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?i.d.S(x,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:w,integrity:_,fetchPriority:A}):b==="script"&&i.d.X(x,{crossOrigin:w,integrity:_,fetchPriority:A,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},Gs.preinitModule=function(x,g){if(typeof x=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=p(g.as,g.crossOrigin);i.d.M(x,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(x)},Gs.preload=function(x,g){if(typeof x=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,w=p(b,g.crossOrigin);i.d.L(x,b,{crossOrigin:w,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},Gs.preloadModule=function(x,g){if(typeof x=="string")if(g){var b=p(g.as,g.crossOrigin);i.d.m(x,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(x)},Gs.requestFormReset=function(x){i.d.r(x)},Gs.unstable_batchedUpdates=function(x,g){return x(g)},Gs.useFormState=function(x,g,b){return d.H.useFormState(x,g,b)},Gs.useFormStatus=function(){return d.H.useHostTransitionStatus()},Gs.version="19.2.4",Gs}var sw;function GE(){if(sw)return n0.exports;sw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),n0.exports=HE(),n0.exports}var nw;function YE(){if(nw)return Kc;nw=1;var n=qE(),e=px(),t=GE();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var r=s,l=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(l=r.return),s=r.return;while(s)}return r.tag===3?l:null}function d(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function p(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function x(s){if(c(s)!==s)throw Error(i(188))}function g(s){var r=s.alternate;if(!r){if(r=c(s),r===null)throw Error(i(188));return r!==s?null:s}for(var l=s,u=r;;){var f=l.return;if(f===null)break;var m=f.alternate;if(m===null){if(u=f.return,u!==null){l=u;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===l)return x(f),s;if(m===u)return x(f),r;m=m.sibling}throw Error(i(188))}if(l.return!==u.return)l=f,u=m;else{for(var v=!1,k=f.child;k;){if(k===l){v=!0,l=f,u=m;break}if(k===u){v=!0,u=f,l=m;break}k=k.sibling}if(!v){for(k=m.child;k;){if(k===l){v=!0,l=m,u=f;break}if(k===u){v=!0,u=m,l=f;break}k=k.sibling}if(!v)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:r}function b(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=b(s),r!==null)return r;s=s.sibling}return null}var w=Object.assign,_=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),L=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),q=Symbol.for("react.profiler"),Q=Symbol.for("react.consumer"),H=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),C=Symbol.iterator;function M(s){return s===null||typeof s!="object"?null:(s=C&&s[C]||s["@@iterator"],typeof s=="function"?s:null)}var R=Symbol.for("react.client.reference");function B(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===R?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case V:return"Fragment";case q:return"Profiler";case F:return"StrictMode";case le:return"Suspense";case Y:return"SuspenseList";case S:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case L:return"Portal";case H:return s.displayName||"Context";case Q:return(s._context.displayName||"Context")+".Consumer";case ie:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case T:return r=s.displayName||null,r!==null?r:B(s.type)||"Memo";case E:r=s._payload,s=s._init;try{return B(s(r))}catch{}}return null}var P=Array.isArray,O=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},be=[],fe=-1;function U(s){return{current:s}}function Z(s){0>fe||(s.current=be[fe],be[fe]=null,fe--)}function ue(s,r){fe++,be[fe]=s.current,s.current=r}var me=U(null),ge=U(null),De=U(null),Ye=U(null);function pt(s,r){switch(ue(De,r),ue(ge,s),ue(me,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?bv(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=bv(r),s=yv(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Z(me),ue(me,s)}function dt(){Z(me),Z(ge),Z(De)}function Wt(s){s.memoizedState!==null&&ue(Ye,s);var r=me.current,l=yv(r,s.type);r!==l&&(ue(ge,s),ue(me,l))}function ne(s){ge.current===s&&(Z(me),Z(ge)),Ye.current===s&&(Z(Ye),Hc._currentValue=oe)}var Te,W;function ye(s){if(Te===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);Te=r&&r[1]||"",W=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Te+s+W}var Ae=!1;function Ve(s,r){if(!s||Ae)return"";Ae=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(ce){var se=ce}Reflect.construct(s,[],ve)}else{try{ve.call()}catch(ce){se=ce}s.call(ve.prototype)}}else{try{throw Error()}catch(ce){se=ce}(ve=s())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(ce){if(ce&&se&&typeof ce.stack=="string")return[ce.stack,se.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=u.DetermineComponentFrameRoot(),v=m[0],k=m[1];if(v&&k){var $=v.split(`
`),te=k.split(`
`);for(f=u=0;u<$.length&&!$[u].includes("DetermineComponentFrameRoot");)u++;for(;f<te.length&&!te[f].includes("DetermineComponentFrameRoot");)f++;if(u===$.length||f===te.length)for(u=$.length-1,f=te.length-1;1<=u&&0<=f&&$[u]!==te[f];)f--;for(;1<=u&&0<=f;u--,f--)if($[u]!==te[f]){if(u!==1||f!==1)do if(u--,f--,0>f||$[u]!==te[f]){var he=`
`+$[u].replace(" at new "," at ");return s.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",s.displayName)),he}while(1<=u&&0<=f);break}}}finally{Ae=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?ye(l):""}function xt(s,r){switch(s.tag){case 26:case 27:case 5:return ye(s.type);case 16:return ye("Lazy");case 13:return s.child!==r&&r!==null?ye("Suspense Fallback"):ye("Suspense");case 19:return ye("SuspenseList");case 0:case 15:return Ve(s.type,!1);case 11:return Ve(s.type.render,!1);case 1:return Ve(s.type,!0);case 31:return ye("Activity");default:return""}}function it(s){try{var r="",l=null;do r+=xt(s,l),l=s,s=s.return;while(s);return r}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var rt=Object.prototype.hasOwnProperty,Ce=n.unstable_scheduleCallback,Le=n.unstable_cancelCallback,pe=n.unstable_shouldYield,Ke=n.unstable_requestPaint,Fe=n.unstable_now,Oe=n.unstable_getCurrentPriorityLevel,We=n.unstable_ImmediatePriority,Qe=n.unstable_UserBlockingPriority,es=n.unstable_NormalPriority,nn=n.unstable_LowPriority,Sn=n.unstable_IdlePriority,Js=n.log,Hs=n.unstable_setDisableYieldValue,xs=null,Lt=null;function gs(s){if(typeof Js=="function"&&Hs(s),Lt&&typeof Lt.setStrictMode=="function")try{Lt.setStrictMode(xs,s)}catch{}}var z=Math.clz32?Math.clz32:Se,ae=Math.log,Ee=Math.LN2;function Se(s){return s>>>=0,s===0?32:31-(ae(s)/Ee|0)|0}var Ue=256,de=262144,je=4194304;function ke(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function $e(s,r,l){var u=s.pendingLanes;if(u===0)return 0;var f=0,m=s.suspendedLanes,v=s.pingedLanes;s=s.warmLanes;var k=u&134217727;return k!==0?(u=k&~m,u!==0?f=ke(u):(v&=k,v!==0?f=ke(v):l||(l=k&~s,l!==0&&(f=ke(l))))):(k=u&~m,k!==0?f=ke(k):v!==0?f=ke(v):l||(l=u&~s,l!==0&&(f=ke(l)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,l=r&-r,m>=l||m===32&&(l&4194048)!==0)?r:f}function ot(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function ze(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qe(){var s=je;return je<<=1,(je&62914560)===0&&(je=4194304),s}function kt(s){for(var r=[],l=0;31>l;l++)r.push(s);return r}function Kt(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function an(s,r,l,u,f,m){var v=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var k=s.entanglements,$=s.expirationTimes,te=s.hiddenUpdates;for(l=v&~l;0<l;){var he=31-z(l),ve=1<<he;k[he]=0,$[he]=-1;var se=te[he];if(se!==null)for(te[he]=null,he=0;he<se.length;he++){var ce=se[he];ce!==null&&(ce.lane&=-536870913)}l&=~ve}u!==0&&rn(s,u,0),m!==0&&f===0&&s.tag!==0&&(s.suspendedLanes|=m&~(v&~r))}function rn(s,r,l){s.pendingLanes|=r,s.suspendedLanes&=~r;var u=31-z(r);s.entangledLanes|=r,s.entanglements[u]=s.entanglements[u]|1073741824|l&261930}function ra(s,r){var l=s.entangledLanes|=r;for(s=s.entanglements;l;){var u=31-z(l),f=1<<u;f&r|s[u]&r&&(s[u]|=r),l&=~f}}function ia(s,r){var l=r&-r;return l=(l&42)!==0?1:la(l),(l&(s.suspendedLanes|r))!==0?0:l}function la(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function as(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Pi(){var s=K.p;return s!==0?s:(s=window.event,s===void 0?32:Fv(s.type))}function bs(s,r){var l=K.p;try{return K.p=s,r()}finally{K.p=l}}var ln=Math.random().toString(36).slice(2),is="__reactFiber$"+ln,ys="__reactProps$"+ln,En="__reactContainer$"+ln,Vi="__reactEvents$"+ln,am="__reactListeners$"+ln,Xu="__reactHandles$"+ln,Ju="__reactResources$"+ln,Ea="__reactMarker$"+ln;function Rl(s){delete s[is],delete s[ys],delete s[Vi],delete s[am],delete s[Xu]}function Ta(s){var r=s[is];if(r)return r;for(var l=s.parentNode;l;){if(r=l[En]||l[is]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(s=Ev(s);s!==null;){if(l=s[is])return l;s=Ev(s)}return r}s=l,l=s.parentNode}return null}function Bn(s){if(s=s[is]||s[En]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function Tn(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function Aa(s){var r=s[Ju];return r||(r=s[Ju]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function vs(s){s[Ea]=!0}var Jo=new Set,Zo={};function ka(s,r){Ca(s,r),Ca(s+"Capture",r)}function Ca(s,r){for(Zo[s]=r,s=0;s<r.length;s++)Jo.add(r[s])}var ec=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tc={},sc={};function Zu(s){return rt.call(sc,s)?!0:rt.call(tc,s)?!1:ec.test(s)?sc[s]=!0:(tc[s]=!0,!1)}function Il(s,r,l){if(Zu(r))if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+l)}}function An(s,r,l){if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+l)}}function ws(s,r,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(r,l,""+u)}}function Ms(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Dr(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function nc(s,r,l){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var f=u.get,m=u.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return f.call(this)},set:function(v){l=""+v,m.call(this,v)}}),Object.defineProperty(s,r,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(v){l=""+v},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Ot(s){if(!s._valueTracker){var r=Dr(s)?"checked":"value";s._valueTracker=nc(s,r,""+s[r])}}function Li(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return s&&(u=Dr(s)?s.checked?"true":"false":s.value),s=u,s!==l?(r.setValue(s),!0):!1}function Ra(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Ui=/[\n"\\]/g;function on(s){return s.replace(Ui,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Dl(s,r,l,u,f,m,v,k){s.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?s.type=v:s.removeAttribute("type"),r!=null?v==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+Ms(r)):s.value!==""+Ms(r)&&(s.value=""+Ms(r)):v!=="submit"&&v!=="reset"||s.removeAttribute("value"),r!=null?ac(s,v,Ms(r)):l!=null?ac(s,v,Ms(l)):u!=null&&s.removeAttribute("value"),f==null&&m!=null&&(s.defaultChecked=!!m),f!=null&&(s.checked=f&&typeof f!="function"&&typeof f!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.name=""+Ms(k):s.removeAttribute("name")}function ed(s,r,l,u,f,m,v,k){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(s.type=m),r!=null||l!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){Ot(s);return}l=l!=null?""+Ms(l):"",r=r!=null?""+Ms(r):l,k||r===s.value||(s.value=r),s.defaultValue=r}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=k?s.checked:!!u,s.defaultChecked=!!u,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.name=v),Ot(s)}function ac(s,r,l){r==="number"&&Ra(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function Mr(s,r,l,u){if(s=s.options,r){r={};for(var f=0;f<l.length;f++)r["$"+l[f]]=!0;for(l=0;l<s.length;l++)f=r.hasOwnProperty("$"+s[l].value),s[l].selected!==f&&(s[l].selected=f),f&&u&&(s[l].defaultSelected=!0)}else{for(l=""+Ms(l),r=null,f=0;f<s.length;f++){if(s[f].value===l){s[f].selected=!0,u&&(s[f].defaultSelected=!0);return}r!==null||s[f].disabled||(r=s[f])}r!==null&&(r.selected=!0)}}function td(s,r,l){if(r!=null&&(r=""+Ms(r),r!==s.value&&(s.value=r),l==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=l!=null?""+Ms(l):""}function Or(s,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(i(92));if(P(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=Ms(r),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u),Ot(s)}function cn(s,r){if(r){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=r;return}}s.textContent=r}var sd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rc(s,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":u?s.setProperty(r,l):typeof l!="number"||l===0||sd.has(r)?r==="float"?s.cssFloat=l:s[r]=(""+l).trim():s[r]=l+"px"}function ic(s,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var f in r)u=r[f],r.hasOwnProperty(f)&&l[f]!==u&&rc(s,f,u)}else for(var m in r)r.hasOwnProperty(m)&&rc(s,m,r[m])}function Ml(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ol(s){return Pr.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function oa(){}var lc=null;function zn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Vr=null,Ia=null;function Bi(s){var r=Bn(s);if(r&&(s=r.stateNode)){var l=s[ys]||null;e:switch(s=r.stateNode,r.type){case"input":if(Dl(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+on(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==s&&u.form===s.form){var f=u[ys]||null;if(!f)throw Error(i(90));Dl(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===s.form&&Li(u)}break e;case"textarea":td(s,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&Mr(s,!!l.multiple,r,!1)}}}var Pl=!1;function Lr(s,r,l){if(Pl)return s(r,l);Pl=!0;try{var u=s(r);return u}finally{if(Pl=!1,(Vr!==null||Ia!==null)&&(Kd(),Vr&&(r=Vr,s=Ia,Ia=Vr=null,Bi(r),s)))for(r=0;r<s.length;r++)Bi(s[r])}}function ca(s,r){var l=s.stateNode;if(l===null)return null;var u=l[ys]||null;if(u===null)return null;l=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var Fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zi=!1;if(Fn)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){zi=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch{zi=!1}var Da=null,oc=null,Fi=null;function cc(){if(Fi)return Fi;var s,r=oc,l=r.length,u,f="value"in Da?Da.value:Da.textContent,m=f.length;for(s=0;s<l&&r[s]===f[s];s++);var v=l-s;for(u=1;u<=v&&r[l-u]===f[m-u];u++);return Fi=f.slice(s,1<u?1-u:void 0)}function $i(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function er(){return!0}function ua(){return!1}function Vs(s){function r(l,u,f,m,v){this._reactName=l,this._targetInst=f,this.type=u,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var k in s)s.hasOwnProperty(k)&&(l=s[k],this[k]=l?l(m):m[k]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?er:ua,this.isPropagationStopped=ua,this}return w(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=er)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=er)},persist:function(){},isPersistent:er}),r}var tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ma=Vs(tr),Ur=w({},tr,{view:0,detail:0}),uc=Vs(Ur),Br,Vl,Oa,Ll=w({},Ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Oa&&(Oa&&s.type==="mousemove"?(Br=s.screenX-Oa.screenX,Vl=s.screenY-Oa.screenY):Vl=Br=0,Oa=s),Br)},movementY:function(s){return"movementY"in s?s.movementY:Vl}}),dc=Vs(Ll),qi=w({},Ll,{dataTransfer:0}),ad=Vs(qi),rd=w({},Ur,{relatedTarget:0}),Hi=Vs(rd),hc=w({},tr,{animationName:0,elapsedTime:0,pseudoElement:0}),id=Vs(hc),Ul=w({},tr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ld=Vs(Ul),od=w({},tr,{data:0}),Pa=Vs(od),cd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ud={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hd(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=dd[s])?!!r[s]:!1}function zr(){return hd}var Zs=w({},Ur,{key:function(s){if(s.key){var r=cd[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=$i(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ud[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zr,charCode:function(s){return s.type==="keypress"?$i(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?$i(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),fd=Vs(Zs),md=w({},Ll,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sr=Vs(md),h=w({},Ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zr}),y=Vs(h),N=w({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0}),D=Vs(N),J=w({},Ll,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),re=Vs(J),Re=w({},tr,{newState:0,oldState:0}),ht=Vs(Re),hs=[9,13,27,32],Ct=Fn&&"CompositionEvent"in window,ts=null;Fn&&"documentMode"in document&&(ts=document.documentMode);var $n=Fn&&"TextEvent"in window&&!ts,Va=Fn&&(!Ct||ts&&8<ts&&11>=ts),da=" ",ha=!1;function Gi(s,r){switch(s){case"keyup":return hs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var zl=!1;function uS(s,r){switch(s){case"compositionend":return Bl(r);case"keypress":return r.which!==32?null:(ha=!0,da);case"textInput":return s=r.data,s===da&&ha?null:s;default:return null}}function dS(s,r){if(zl)return s==="compositionend"||!Ct&&Gi(s,r)?(s=cc(),Fi=oc=Da=null,zl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Va&&r.locale!=="ko"?null:r.data;default:return null}}var hS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kg(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!hS[s.type]:r==="textarea"}function Cg(s,r,l,u){Vr?Ia?Ia.push(u):Ia=[u]:Vr=u,r=nh(r,"onChange"),0<r.length&&(l=new Ma("onChange","change",null,l,u),s.push({event:l,listeners:r}))}var fc=null,mc=null;function fS(s){hv(s,0)}function pd(s){var r=Tn(s);if(Li(r))return s}function Rg(s,r){if(s==="change")return r}var Ig=!1;if(Fn){var rm;if(Fn){var im="oninput"in document;if(!im){var Dg=document.createElement("div");Dg.setAttribute("oninput","return;"),im=typeof Dg.oninput=="function"}rm=im}else rm=!1;Ig=rm&&(!document.documentMode||9<document.documentMode)}function Mg(){fc&&(fc.detachEvent("onpropertychange",Og),mc=fc=null)}function Og(s){if(s.propertyName==="value"&&pd(mc)){var r=[];Cg(r,mc,s,zn(s)),Lr(fS,r)}}function mS(s,r,l){s==="focusin"?(Mg(),fc=r,mc=l,fc.attachEvent("onpropertychange",Og)):s==="focusout"&&Mg()}function pS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return pd(mc)}function xS(s,r){if(s==="click")return pd(r)}function gS(s,r){if(s==="input"||s==="change")return pd(r)}function bS(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var kn=typeof Object.is=="function"?Object.is:bS;function pc(s,r){if(kn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var l=Object.keys(s),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var f=l[u];if(!rt.call(r,f)||!kn(s[f],r[f]))return!1}return!0}function Pg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Vg(s,r){var l=Pg(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=r&&u>=r)return{node:l,offset:r-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Pg(l)}}function Lg(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?Lg(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Ug(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Ra(s.document);r instanceof s.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)s=r.contentWindow;else break;r=Ra(s.document)}return r}function lm(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var yS=Fn&&"documentMode"in document&&11>=document.documentMode,Fl=null,om=null,xc=null,cm=!1;function Bg(s,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;cm||Fl==null||Fl!==Ra(u)||(u=Fl,"selectionStart"in u&&lm(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),xc&&pc(xc,u)||(xc=u,u=nh(om,"onSelect"),0<u.length&&(r=new Ma("onSelect","select",null,r,l),s.push({event:r,listeners:u}),r.target=Fl)))}function Yi(s,r){var l={};return l[s.toLowerCase()]=r.toLowerCase(),l["Webkit"+s]="webkit"+r,l["Moz"+s]="moz"+r,l}var $l={animationend:Yi("Animation","AnimationEnd"),animationiteration:Yi("Animation","AnimationIteration"),animationstart:Yi("Animation","AnimationStart"),transitionrun:Yi("Transition","TransitionRun"),transitionstart:Yi("Transition","TransitionStart"),transitioncancel:Yi("Transition","TransitionCancel"),transitionend:Yi("Transition","TransitionEnd")},um={},zg={};Fn&&(zg=document.createElement("div").style,"AnimationEvent"in window||(delete $l.animationend.animation,delete $l.animationiteration.animation,delete $l.animationstart.animation),"TransitionEvent"in window||delete $l.transitionend.transition);function Wi(s){if(um[s])return um[s];if(!$l[s])return s;var r=$l[s],l;for(l in r)if(r.hasOwnProperty(l)&&l in zg)return um[s]=r[l];return s}var Fg=Wi("animationend"),$g=Wi("animationiteration"),qg=Wi("animationstart"),vS=Wi("transitionrun"),wS=Wi("transitionstart"),NS=Wi("transitioncancel"),Hg=Wi("transitionend"),Gg=new Map,dm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");dm.push("scrollEnd");function fa(s,r){Gg.set(s,r),ka(r,[s])}var xd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},qn=[],ql=0,hm=0;function gd(){for(var s=ql,r=hm=ql=0;r<s;){var l=qn[r];qn[r++]=null;var u=qn[r];qn[r++]=null;var f=qn[r];qn[r++]=null;var m=qn[r];if(qn[r++]=null,u!==null&&f!==null){var v=u.pending;v===null?f.next=f:(f.next=v.next,v.next=f),u.pending=f}m!==0&&Yg(l,f,m)}}function bd(s,r,l,u){qn[ql++]=s,qn[ql++]=r,qn[ql++]=l,qn[ql++]=u,hm|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function fm(s,r,l,u){return bd(s,r,l,u),yd(s)}function Qi(s,r){return bd(s,null,null,r),yd(s)}function Yg(s,r,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var f=!1,m=s.return;m!==null;)m.childLanes|=l,u=m.alternate,u!==null&&(u.childLanes|=l),m.tag===22&&(s=m.stateNode,s===null||s._visibility&1||(f=!0)),s=m,m=m.return;return s.tag===3?(m=s.stateNode,f&&r!==null&&(f=31-z(l),s=m.hiddenUpdates,u=s[f],u===null?s[f]=[r]:u.push(r),r.lane=l|536870912),m):null}function yd(s){if(50<Lc)throw Lc=0,Np=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var Hl={};function _S(s,r,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cn(s,r,l,u){return new _S(s,r,l,u)}function mm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function nr(s,r){var l=s.alternate;return l===null?(l=Cn(s.tag,r,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=r,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,r=s.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Wg(s,r){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,r=l.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function vd(s,r,l,u,f,m){var v=0;if(u=s,typeof s=="function")mm(s)&&(v=1);else if(typeof s=="string")v=AE(s,l,me.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case S:return s=Cn(31,l,r,f),s.elementType=S,s.lanes=m,s;case V:return Ki(l.children,f,m,r);case F:v=8,f|=24;break;case q:return s=Cn(12,l,r,f|2),s.elementType=q,s.lanes=m,s;case le:return s=Cn(13,l,r,f),s.elementType=le,s.lanes=m,s;case Y:return s=Cn(19,l,r,f),s.elementType=Y,s.lanes=m,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case H:v=10;break e;case Q:v=9;break e;case ie:v=11;break e;case T:v=14;break e;case E:v=16,u=null;break e}v=29,l=Error(i(130,s===null?"null":typeof s,"")),u=null}return r=Cn(v,l,r,f),r.elementType=s,r.type=u,r.lanes=m,r}function Ki(s,r,l,u){return s=Cn(7,s,u,r),s.lanes=l,s}function pm(s,r,l){return s=Cn(6,s,null,r),s.lanes=l,s}function Qg(s){var r=Cn(18,null,null,0);return r.stateNode=s,r}function xm(s,r,l){return r=Cn(4,s.children!==null?s.children:[],s.key,r),r.lanes=l,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var Kg=new WeakMap;function Hn(s,r){if(typeof s=="object"&&s!==null){var l=Kg.get(s);return l!==void 0?l:(r={value:s,source:r,stack:it(r)},Kg.set(s,r),r)}return{value:s,source:r,stack:it(r)}}var Gl=[],Yl=0,wd=null,gc=0,Gn=[],Yn=0,Fr=null,La=1,Ua="";function ar(s,r){Gl[Yl++]=gc,Gl[Yl++]=wd,wd=s,gc=r}function Xg(s,r,l){Gn[Yn++]=La,Gn[Yn++]=Ua,Gn[Yn++]=Fr,Fr=s;var u=La;s=Ua;var f=32-z(u)-1;u&=~(1<<f),l+=1;var m=32-z(r)+f;if(30<m){var v=f-f%5;m=(u&(1<<v)-1).toString(32),u>>=v,f-=v,La=1<<32-z(r)+f|l<<f|u,Ua=m+s}else La=1<<m|l<<f|u,Ua=s}function gm(s){s.return!==null&&(ar(s,1),Xg(s,1,0))}function bm(s){for(;s===wd;)wd=Gl[--Yl],Gl[Yl]=null,gc=Gl[--Yl],Gl[Yl]=null;for(;s===Fr;)Fr=Gn[--Yn],Gn[Yn]=null,Ua=Gn[--Yn],Gn[Yn]=null,La=Gn[--Yn],Gn[Yn]=null}function Jg(s,r){Gn[Yn++]=La,Gn[Yn++]=Ua,Gn[Yn++]=Fr,La=r.id,Ua=r.overflow,Fr=s}var Ls=null,Xt=null,jt=!1,$r=null,Wn=!1,ym=Error(i(519));function qr(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bc(Hn(r,s)),ym}function Zg(s){var r=s.stateNode,l=s.type,u=s.memoizedProps;switch(r[is]=s,r[ys]=u,l){case"dialog":bt("cancel",r),bt("close",r);break;case"iframe":case"object":case"embed":bt("load",r);break;case"video":case"audio":for(l=0;l<Bc.length;l++)bt(Bc[l],r);break;case"source":bt("error",r);break;case"img":case"image":case"link":bt("error",r),bt("load",r);break;case"details":bt("toggle",r);break;case"input":bt("invalid",r),ed(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":bt("invalid",r);break;case"textarea":bt("invalid",r),Or(r,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||xv(r.textContent,l)?(u.popover!=null&&(bt("beforetoggle",r),bt("toggle",r)),u.onScroll!=null&&bt("scroll",r),u.onScrollEnd!=null&&bt("scrollend",r),u.onClick!=null&&(r.onclick=oa),r=!0):r=!1,r||qr(s,!0)}function eb(s){for(Ls=s.return;Ls;)switch(Ls.tag){case 5:case 31:case 13:Wn=!1;return;case 27:case 3:Wn=!0;return;default:Ls=Ls.return}}function Wl(s){if(s!==Ls)return!1;if(!jt)return eb(s),jt=!0,!1;var r=s.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||Vp(s.type,s.memoizedProps)),l=!l),l&&Xt&&qr(s),eb(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Xt=Sv(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Xt=Sv(s)}else r===27?(r=Xt,ai(s.type)?(s=Fp,Fp=null,Xt=s):Xt=r):Xt=Ls?Kn(s.stateNode.nextSibling):null;return!0}function Xi(){Xt=Ls=null,jt=!1}function vm(){var s=$r;return s!==null&&(fn===null?fn=s:fn.push.apply(fn,s),$r=null),s}function bc(s){$r===null?$r=[s]:$r.push(s)}var wm=U(null),Ji=null,rr=null;function Hr(s,r,l){ue(wm,r._currentValue),r._currentValue=l}function ir(s){s._currentValue=wm.current,Z(wm)}function Nm(s,r,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),s===l)break;s=s.return}}function _m(s,r,l,u){var f=s.child;for(f!==null&&(f.return=s);f!==null;){var m=f.dependencies;if(m!==null){var v=f.child;m=m.firstContext;e:for(;m!==null;){var k=m;m=f;for(var $=0;$<r.length;$++)if(k.context===r[$]){m.lanes|=l,k=m.alternate,k!==null&&(k.lanes|=l),Nm(m.return,l,s),u||(v=null);break e}m=k.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(i(341));v.lanes|=l,m=v.alternate,m!==null&&(m.lanes|=l),Nm(v,l,s),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===s){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function Ql(s,r,l,u){s=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(i(387));if(v=v.memoizedProps,v!==null){var k=f.type;kn(f.pendingProps.value,v.value)||(s!==null?s.push(k):s=[k])}}else if(f===Ye.current){if(v=f.alternate,v===null)throw Error(i(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(s!==null?s.push(Hc):s=[Hc])}f=f.return}s!==null&&_m(r,s,l,u),r.flags|=262144}function Nd(s){for(s=s.firstContext;s!==null;){if(!kn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Zi(s){Ji=s,rr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Us(s){return tb(Ji,s)}function _d(s,r){return Ji===null&&Zi(s),tb(s,r)}function tb(s,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},rr===null){if(s===null)throw Error(i(308));rr=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else rr=rr.next=r;return l}var jS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){r.aborted=!0,s.forEach(function(l){return l()})}},SS=n.unstable_scheduleCallback,ES=n.unstable_NormalPriority,Ns={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jm(){return{controller:new jS,data:new Map,refCount:0}}function yc(s){s.refCount--,s.refCount===0&&SS(ES,function(){s.controller.abort()})}var vc=null,Sm=0,Kl=0,Xl=null;function TS(s,r){if(vc===null){var l=vc=[];Sm=0,Kl=Ap(),Xl={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Sm++,r.then(sb,sb),r}function sb(){if(--Sm===0&&vc!==null){Xl!==null&&(Xl.status="fulfilled");var s=vc;vc=null,Kl=0,Xl=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function AS(s,r){var l=[],u={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return s.then(function(){u.status="fulfilled",u.value=r;for(var f=0;f<l.length;f++)(0,l[f])(r)},function(f){for(u.status="rejected",u.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),u}var nb=O.S;O.S=function(s,r){By=Fe(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&TS(s,r),nb!==null&&nb(s,r)};var el=U(null);function Em(){var s=el.current;return s!==null?s:$t.pooledCache}function jd(s,r){r===null?ue(el,el.current):ue(el,r.pool)}function ab(){var s=Em();return s===null?null:{parent:Ns._currentValue,pool:s}}var Jl=Error(i(460)),Tm=Error(i(474)),Sd=Error(i(542)),Ed={then:function(){}};function rb(s){return s=s.status,s==="fulfilled"||s==="rejected"}function ib(s,r,l){switch(l=s[l],l===void 0?s.push(r):l!==r&&(r.then(oa,oa),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,ob(s),s;default:if(typeof r.status=="string")r.then(oa,oa);else{if(s=$t,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(u){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=u}},function(u){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,ob(s),s}throw sl=r,Jl}}function tl(s){try{var r=s._init;return r(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(sl=l,Jl):l}}var sl=null;function lb(){if(sl===null)throw Error(i(459));var s=sl;return sl=null,s}function ob(s){if(s===Jl||s===Sd)throw Error(i(483))}var Zl=null,wc=0;function Td(s){var r=wc;return wc+=1,Zl===null&&(Zl=[]),ib(Zl,s,r)}function Nc(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function Ad(s,r){throw r.$$typeof===_?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function cb(s){function r(X,G){if(s){var ee=X.deletions;ee===null?(X.deletions=[G],X.flags|=16):ee.push(G)}}function l(X,G){if(!s)return null;for(;G!==null;)r(X,G),G=G.sibling;return null}function u(X){for(var G=new Map;X!==null;)X.key!==null?G.set(X.key,X):G.set(X.index,X),X=X.sibling;return G}function f(X,G){return X=nr(X,G),X.index=0,X.sibling=null,X}function m(X,G,ee){return X.index=ee,s?(ee=X.alternate,ee!==null?(ee=ee.index,ee<G?(X.flags|=67108866,G):ee):(X.flags|=67108866,G)):(X.flags|=1048576,G)}function v(X){return s&&X.alternate===null&&(X.flags|=67108866),X}function k(X,G,ee,xe){return G===null||G.tag!==6?(G=pm(ee,X.mode,xe),G.return=X,G):(G=f(G,ee),G.return=X,G)}function $(X,G,ee,xe){var Xe=ee.type;return Xe===V?he(X,G,ee.props.children,xe,ee.key):G!==null&&(G.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===E&&tl(Xe)===G.type)?(G=f(G,ee.props),Nc(G,ee),G.return=X,G):(G=vd(ee.type,ee.key,ee.props,null,X.mode,xe),Nc(G,ee),G.return=X,G)}function te(X,G,ee,xe){return G===null||G.tag!==4||G.stateNode.containerInfo!==ee.containerInfo||G.stateNode.implementation!==ee.implementation?(G=xm(ee,X.mode,xe),G.return=X,G):(G=f(G,ee.children||[]),G.return=X,G)}function he(X,G,ee,xe,Xe){return G===null||G.tag!==7?(G=Ki(ee,X.mode,xe,Xe),G.return=X,G):(G=f(G,ee),G.return=X,G)}function ve(X,G,ee){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=pm(""+G,X.mode,ee),G.return=X,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case A:return ee=vd(G.type,G.key,G.props,null,X.mode,ee),Nc(ee,G),ee.return=X,ee;case L:return G=xm(G,X.mode,ee),G.return=X,G;case E:return G=tl(G),ve(X,G,ee)}if(P(G)||M(G))return G=Ki(G,X.mode,ee,null),G.return=X,G;if(typeof G.then=="function")return ve(X,Td(G),ee);if(G.$$typeof===H)return ve(X,_d(X,G),ee);Ad(X,G)}return null}function se(X,G,ee,xe){var Xe=G!==null?G.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return Xe!==null?null:k(X,G,""+ee,xe);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case A:return ee.key===Xe?$(X,G,ee,xe):null;case L:return ee.key===Xe?te(X,G,ee,xe):null;case E:return ee=tl(ee),se(X,G,ee,xe)}if(P(ee)||M(ee))return Xe!==null?null:he(X,G,ee,xe,null);if(typeof ee.then=="function")return se(X,G,Td(ee),xe);if(ee.$$typeof===H)return se(X,G,_d(X,ee),xe);Ad(X,ee)}return null}function ce(X,G,ee,xe,Xe){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return X=X.get(ee)||null,k(G,X,""+xe,Xe);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case A:return X=X.get(xe.key===null?ee:xe.key)||null,$(G,X,xe,Xe);case L:return X=X.get(xe.key===null?ee:xe.key)||null,te(G,X,xe,Xe);case E:return xe=tl(xe),ce(X,G,ee,xe,Xe)}if(P(xe)||M(xe))return X=X.get(ee)||null,he(G,X,xe,Xe,null);if(typeof xe.then=="function")return ce(X,G,ee,Td(xe),Xe);if(xe.$$typeof===H)return ce(X,G,ee,_d(G,xe),Xe);Ad(G,xe)}return null}function Be(X,G,ee,xe){for(var Xe=null,Tt=null,He=G,mt=G=0,vt=null;He!==null&&mt<ee.length;mt++){He.index>mt?(vt=He,He=null):vt=He.sibling;var At=se(X,He,ee[mt],xe);if(At===null){He===null&&(He=vt);break}s&&He&&At.alternate===null&&r(X,He),G=m(At,G,mt),Tt===null?Xe=At:Tt.sibling=At,Tt=At,He=vt}if(mt===ee.length)return l(X,He),jt&&ar(X,mt),Xe;if(He===null){for(;mt<ee.length;mt++)He=ve(X,ee[mt],xe),He!==null&&(G=m(He,G,mt),Tt===null?Xe=He:Tt.sibling=He,Tt=He);return jt&&ar(X,mt),Xe}for(He=u(He);mt<ee.length;mt++)vt=ce(He,X,mt,ee[mt],xe),vt!==null&&(s&&vt.alternate!==null&&He.delete(vt.key===null?mt:vt.key),G=m(vt,G,mt),Tt===null?Xe=vt:Tt.sibling=vt,Tt=vt);return s&&He.forEach(function(ci){return r(X,ci)}),jt&&ar(X,mt),Xe}function et(X,G,ee,xe){if(ee==null)throw Error(i(151));for(var Xe=null,Tt=null,He=G,mt=G=0,vt=null,At=ee.next();He!==null&&!At.done;mt++,At=ee.next()){He.index>mt?(vt=He,He=null):vt=He.sibling;var ci=se(X,He,At.value,xe);if(ci===null){He===null&&(He=vt);break}s&&He&&ci.alternate===null&&r(X,He),G=m(ci,G,mt),Tt===null?Xe=ci:Tt.sibling=ci,Tt=ci,He=vt}if(At.done)return l(X,He),jt&&ar(X,mt),Xe;if(He===null){for(;!At.done;mt++,At=ee.next())At=ve(X,At.value,xe),At!==null&&(G=m(At,G,mt),Tt===null?Xe=At:Tt.sibling=At,Tt=At);return jt&&ar(X,mt),Xe}for(He=u(He);!At.done;mt++,At=ee.next())At=ce(He,X,mt,At.value,xe),At!==null&&(s&&At.alternate!==null&&He.delete(At.key===null?mt:At.key),G=m(At,G,mt),Tt===null?Xe=At:Tt.sibling=At,Tt=At);return s&&He.forEach(function(UE){return r(X,UE)}),jt&&ar(X,mt),Xe}function Ft(X,G,ee,xe){if(typeof ee=="object"&&ee!==null&&ee.type===V&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case A:e:{for(var Xe=ee.key;G!==null;){if(G.key===Xe){if(Xe=ee.type,Xe===V){if(G.tag===7){l(X,G.sibling),xe=f(G,ee.props.children),xe.return=X,X=xe;break e}}else if(G.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===E&&tl(Xe)===G.type){l(X,G.sibling),xe=f(G,ee.props),Nc(xe,ee),xe.return=X,X=xe;break e}l(X,G);break}else r(X,G);G=G.sibling}ee.type===V?(xe=Ki(ee.props.children,X.mode,xe,ee.key),xe.return=X,X=xe):(xe=vd(ee.type,ee.key,ee.props,null,X.mode,xe),Nc(xe,ee),xe.return=X,X=xe)}return v(X);case L:e:{for(Xe=ee.key;G!==null;){if(G.key===Xe)if(G.tag===4&&G.stateNode.containerInfo===ee.containerInfo&&G.stateNode.implementation===ee.implementation){l(X,G.sibling),xe=f(G,ee.children||[]),xe.return=X,X=xe;break e}else{l(X,G);break}else r(X,G);G=G.sibling}xe=xm(ee,X.mode,xe),xe.return=X,X=xe}return v(X);case E:return ee=tl(ee),Ft(X,G,ee,xe)}if(P(ee))return Be(X,G,ee,xe);if(M(ee)){if(Xe=M(ee),typeof Xe!="function")throw Error(i(150));return ee=Xe.call(ee),et(X,G,ee,xe)}if(typeof ee.then=="function")return Ft(X,G,Td(ee),xe);if(ee.$$typeof===H)return Ft(X,G,_d(X,ee),xe);Ad(X,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,G!==null&&G.tag===6?(l(X,G.sibling),xe=f(G,ee),xe.return=X,X=xe):(l(X,G),xe=pm(ee,X.mode,xe),xe.return=X,X=xe),v(X)):l(X,G)}return function(X,G,ee,xe){try{wc=0;var Xe=Ft(X,G,ee,xe);return Zl=null,Xe}catch(He){if(He===Jl||He===Sd)throw He;var Tt=Cn(29,He,null,X.mode);return Tt.lanes=xe,Tt.return=X,Tt}}}var nl=cb(!0),ub=cb(!1),Gr=!1;function Am(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function km(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Yr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Wr(s,r,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(Rt&2)!==0){var f=u.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),u.pending=r,r=yd(s),Yg(s,null,l),r}return bd(s,u,r,l),yd(s)}function _c(s,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,ra(s,l)}}function Cm(s,r){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var f=null,m=null;if(l=l.firstBaseUpdate,l!==null){do{var v={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};m===null?f=m=v:m=m.next=v,l=l.next}while(l!==null);m===null?f=m=r:m=m.next=r}else f=m=r;l={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=r:s.next=r,l.lastBaseUpdate=r}var Rm=!1;function jc(){if(Rm){var s=Xl;if(s!==null)throw s}}function Sc(s,r,l,u){Rm=!1;var f=s.updateQueue;Gr=!1;var m=f.firstBaseUpdate,v=f.lastBaseUpdate,k=f.shared.pending;if(k!==null){f.shared.pending=null;var $=k,te=$.next;$.next=null,v===null?m=te:v.next=te,v=$;var he=s.alternate;he!==null&&(he=he.updateQueue,k=he.lastBaseUpdate,k!==v&&(k===null?he.firstBaseUpdate=te:k.next=te,he.lastBaseUpdate=$))}if(m!==null){var ve=f.baseState;v=0,he=te=$=null,k=m;do{var se=k.lane&-536870913,ce=se!==k.lane;if(ce?(yt&se)===se:(u&se)===se){se!==0&&se===Kl&&(Rm=!0),he!==null&&(he=he.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Be=s,et=k;se=r;var Ft=l;switch(et.tag){case 1:if(Be=et.payload,typeof Be=="function"){ve=Be.call(Ft,ve,se);break e}ve=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=et.payload,se=typeof Be=="function"?Be.call(Ft,ve,se):Be,se==null)break e;ve=w({},ve,se);break e;case 2:Gr=!0}}se=k.callback,se!==null&&(s.flags|=64,ce&&(s.flags|=8192),ce=f.callbacks,ce===null?f.callbacks=[se]:ce.push(se))}else ce={lane:se,tag:k.tag,payload:k.payload,callback:k.callback,next:null},he===null?(te=he=ce,$=ve):he=he.next=ce,v|=se;if(k=k.next,k===null){if(k=f.shared.pending,k===null)break;ce=k,k=ce.next,ce.next=null,f.lastBaseUpdate=ce,f.shared.pending=null}}while(!0);he===null&&($=ve),f.baseState=$,f.firstBaseUpdate=te,f.lastBaseUpdate=he,m===null&&(f.shared.lanes=0),Zr|=v,s.lanes=v,s.memoizedState=ve}}function db(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function hb(s,r){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)db(l[s],r)}var eo=U(null),kd=U(0);function fb(s,r){s=pr,ue(kd,s),ue(eo,r),pr=s|r.baseLanes}function Im(){ue(kd,pr),ue(eo,eo.current)}function Dm(){pr=kd.current,Z(eo),Z(kd)}var Rn=U(null),Qn=null;function Qr(s){var r=s.alternate;ue(fs,fs.current&1),ue(Rn,s),Qn===null&&(r===null||eo.current!==null||r.memoizedState!==null)&&(Qn=s)}function Mm(s){ue(fs,fs.current),ue(Rn,s),Qn===null&&(Qn=s)}function mb(s){s.tag===22?(ue(fs,fs.current),ue(Rn,s),Qn===null&&(Qn=s)):Kr()}function Kr(){ue(fs,fs.current),ue(Rn,Rn.current)}function In(s){Z(Rn),Qn===s&&(Qn=null),Z(fs)}var fs=U(0);function Cd(s){for(var r=s;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Bp(l)||zp(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var lr=0,ft=null,Bt=null,_s=null,Rd=!1,to=!1,al=!1,Id=0,Ec=0,so=null,kS=0;function ls(){throw Error(i(321))}function Om(s,r){if(r===null)return!1;for(var l=0;l<r.length&&l<s.length;l++)if(!kn(s[l],r[l]))return!1;return!0}function Pm(s,r,l,u,f,m){return lr=m,ft=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,O.H=s===null||s.memoizedState===null?Xb:Xm,al=!1,m=l(u,f),al=!1,to&&(m=xb(r,l,u,f)),pb(s),m}function pb(s){O.H=kc;var r=Bt!==null&&Bt.next!==null;if(lr=0,_s=Bt=ft=null,Rd=!1,Ec=0,so=null,r)throw Error(i(300));s===null||js||(s=s.dependencies,s!==null&&Nd(s)&&(js=!0))}function xb(s,r,l,u){ft=s;var f=0;do{if(to&&(so=null),Ec=0,to=!1,25<=f)throw Error(i(301));if(f+=1,_s=Bt=null,s.updateQueue!=null){var m=s.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}O.H=Jb,m=r(l,u)}while(to);return m}function CS(){var s=O.H,r=s.useState()[0];return r=typeof r.then=="function"?Tc(r):r,s=s.useState()[0],(Bt!==null?Bt.memoizedState:null)!==s&&(ft.flags|=1024),r}function Vm(){var s=Id!==0;return Id=0,s}function Lm(s,r,l){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~l}function Um(s){if(Rd){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Rd=!1}lr=0,_s=Bt=ft=null,to=!1,Ec=Id=0,so=null}function en(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _s===null?ft.memoizedState=_s=s:_s=_s.next=s,_s}function ms(){if(Bt===null){var s=ft.alternate;s=s!==null?s.memoizedState:null}else s=Bt.next;var r=_s===null?ft.memoizedState:_s.next;if(r!==null)_s=r,Bt=s;else{if(s===null)throw ft.alternate===null?Error(i(467)):Error(i(310));Bt=s,s={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},_s===null?ft.memoizedState=_s=s:_s=_s.next=s}return _s}function Dd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Tc(s){var r=Ec;return Ec+=1,so===null&&(so=[]),s=ib(so,s,r),r=ft,(_s===null?r.memoizedState:_s.next)===null&&(r=r.alternate,O.H=r===null||r.memoizedState===null?Xb:Xm),s}function Md(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Tc(s);if(s.$$typeof===H)return Us(s)}throw Error(i(438,String(s)))}function Bm(s){var r=null,l=ft.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=ft.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=Dd(),ft.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(s),u=0;u<s;u++)l[u]=I;return r.index++,l}function or(s,r){return typeof r=="function"?r(s):r}function Od(s){var r=ms();return zm(r,Bt,s)}function zm(s,r,l){var u=s.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var f=s.baseQueue,m=u.pending;if(m!==null){if(f!==null){var v=f.next;f.next=m.next,m.next=v}r.baseQueue=f=m,u.pending=null}if(m=s.baseState,f===null)s.memoizedState=m;else{r=f.next;var k=v=null,$=null,te=r,he=!1;do{var ve=te.lane&-536870913;if(ve!==te.lane?(yt&ve)===ve:(lr&ve)===ve){var se=te.revertLane;if(se===0)$!==null&&($=$.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),ve===Kl&&(he=!0);else if((lr&se)===se){te=te.next,se===Kl&&(he=!0);continue}else ve={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},$===null?(k=$=ve,v=m):$=$.next=ve,ft.lanes|=se,Zr|=se;ve=te.action,al&&l(m,ve),m=te.hasEagerState?te.eagerState:l(m,ve)}else se={lane:ve,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},$===null?(k=$=se,v=m):$=$.next=se,ft.lanes|=ve,Zr|=ve;te=te.next}while(te!==null&&te!==r);if($===null?v=m:$.next=k,!kn(m,s.memoizedState)&&(js=!0,he&&(l=Xl,l!==null)))throw l;s.memoizedState=m,s.baseState=v,s.baseQueue=$,u.lastRenderedState=m}return f===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function Fm(s){var r=ms(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var u=l.dispatch,f=l.pending,m=r.memoizedState;if(f!==null){l.pending=null;var v=f=f.next;do m=s(m,v.action),v=v.next;while(v!==f);kn(m,r.memoizedState)||(js=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),l.lastRenderedState=m}return[m,u]}function gb(s,r,l){var u=ft,f=ms(),m=jt;if(m){if(l===void 0)throw Error(i(407));l=l()}else l=r();var v=!kn((Bt||f).memoizedState,l);if(v&&(f.memoizedState=l,js=!0),f=f.queue,Hm(vb.bind(null,u,f,s),[s]),f.getSnapshot!==r||v||_s!==null&&_s.memoizedState.tag&1){if(u.flags|=2048,no(9,{destroy:void 0},yb.bind(null,u,f,l,r),null),$t===null)throw Error(i(349));m||(lr&127)!==0||bb(u,r,l)}return l}function bb(s,r,l){s.flags|=16384,s={getSnapshot:r,value:l},r=ft.updateQueue,r===null?(r=Dd(),ft.updateQueue=r,r.stores=[s]):(l=r.stores,l===null?r.stores=[s]:l.push(s))}function yb(s,r,l,u){r.value=l,r.getSnapshot=u,wb(r)&&Nb(s)}function vb(s,r,l){return l(function(){wb(r)&&Nb(s)})}function wb(s){var r=s.getSnapshot;s=s.value;try{var l=r();return!kn(s,l)}catch{return!0}}function Nb(s){var r=Qi(s,2);r!==null&&mn(r,s,2)}function $m(s){var r=en();if(typeof s=="function"){var l=s;if(s=l(),al){gs(!0);try{l()}finally{gs(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:s},r}function _b(s,r,l,u){return s.baseState=l,zm(s,Bt,typeof u=="function"?u:or)}function RS(s,r,l,u,f){if(Ld(s))throw Error(i(485));if(s=r.action,s!==null){var m={payload:f,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){m.listeners.push(v)}};O.T!==null?l(!0):m.isTransition=!1,u(m),l=r.pending,l===null?(m.next=r.pending=m,jb(r,m)):(m.next=l.next,r.pending=l.next=m)}}function jb(s,r){var l=r.action,u=r.payload,f=s.state;if(r.isTransition){var m=O.T,v={};O.T=v;try{var k=l(f,u),$=O.S;$!==null&&$(v,k),Sb(s,r,k)}catch(te){qm(s,r,te)}finally{m!==null&&v.types!==null&&(m.types=v.types),O.T=m}}else try{m=l(f,u),Sb(s,r,m)}catch(te){qm(s,r,te)}}function Sb(s,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Eb(s,r,u)},function(u){return qm(s,r,u)}):Eb(s,r,l)}function Eb(s,r,l){r.status="fulfilled",r.value=l,Tb(r),s.state=l,r=s.pending,r!==null&&(l=r.next,l===r?s.pending=null:(l=l.next,r.next=l,jb(s,l)))}function qm(s,r,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,Tb(r),r=r.next;while(r!==u)}s.action=null}function Tb(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function Ab(s,r){return r}function kb(s,r){if(jt){var l=$t.formState;if(l!==null){e:{var u=ft;if(jt){if(Xt){t:{for(var f=Xt,m=Wn;f.nodeType!==8;){if(!m){f=null;break t}if(f=Kn(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Xt=Kn(f.nextSibling),u=f.data==="F!";break e}}qr(u)}u=!1}u&&(r=l[0])}}return l=en(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ab,lastRenderedState:r},l.queue=u,l=Wb.bind(null,ft,u),u.dispatch=l,u=$m(!1),m=Km.bind(null,ft,!1,u.queue),u=en(),f={state:r,dispatch:null,action:s,pending:null},u.queue=f,l=RS.bind(null,ft,f,m,l),f.dispatch=l,u.memoizedState=s,[r,l,!1]}function Cb(s){var r=ms();return Rb(r,Bt,s)}function Rb(s,r,l){if(r=zm(s,r,Ab)[0],s=Od(or)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=Tc(r)}catch(v){throw v===Jl?Sd:v}else u=r;r=ms();var f=r.queue,m=f.dispatch;return l!==r.memoizedState&&(ft.flags|=2048,no(9,{destroy:void 0},IS.bind(null,f,l),null)),[u,m,s]}function IS(s,r){s.action=r}function Ib(s){var r=ms(),l=Bt;if(l!==null)return Rb(r,l,s);ms(),r=r.memoizedState,l=ms();var u=l.queue.dispatch;return l.memoizedState=s,[r,u,!1]}function no(s,r,l,u){return s={tag:s,create:l,deps:u,inst:r,next:null},r=ft.updateQueue,r===null&&(r=Dd(),ft.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,r.lastEffect=s),s}function Db(){return ms().memoizedState}function Pd(s,r,l,u){var f=en();ft.flags|=s,f.memoizedState=no(1|r,{destroy:void 0},l,u===void 0?null:u)}function Vd(s,r,l,u){var f=ms();u=u===void 0?null:u;var m=f.memoizedState.inst;Bt!==null&&u!==null&&Om(u,Bt.memoizedState.deps)?f.memoizedState=no(r,m,l,u):(ft.flags|=s,f.memoizedState=no(1|r,m,l,u))}function Mb(s,r){Pd(8390656,8,s,r)}function Hm(s,r){Vd(2048,8,s,r)}function DS(s){ft.flags|=4;var r=ft.updateQueue;if(r===null)r=Dd(),ft.updateQueue=r,r.events=[s];else{var l=r.events;l===null?r.events=[s]:l.push(s)}}function Ob(s){var r=ms().memoizedState;return DS({ref:r,nextImpl:s}),function(){if((Rt&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Pb(s,r){return Vd(4,2,s,r)}function Vb(s,r){return Vd(4,4,s,r)}function Lb(s,r){if(typeof r=="function"){s=s();var l=r(s);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Ub(s,r,l){l=l!=null?l.concat([s]):null,Vd(4,4,Lb.bind(null,r,s),l)}function Gm(){}function Bb(s,r){var l=ms();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&Om(r,u[1])?u[0]:(l.memoizedState=[s,r],s)}function zb(s,r){var l=ms();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&Om(r,u[1]))return u[0];if(u=s(),al){gs(!0);try{s()}finally{gs(!1)}}return l.memoizedState=[u,r],u}function Ym(s,r,l){return l===void 0||(lr&1073741824)!==0&&(yt&261930)===0?s.memoizedState=r:(s.memoizedState=l,s=Fy(),ft.lanes|=s,Zr|=s,l)}function Fb(s,r,l,u){return kn(l,r)?l:eo.current!==null?(s=Ym(s,l,u),kn(s,r)||(js=!0),s):(lr&42)===0||(lr&1073741824)!==0&&(yt&261930)===0?(js=!0,s.memoizedState=l):(s=Fy(),ft.lanes|=s,Zr|=s,r)}function $b(s,r,l,u,f){var m=K.p;K.p=m!==0&&8>m?m:8;var v=O.T,k={};O.T=k,Km(s,!1,r,l);try{var $=f(),te=O.S;if(te!==null&&te(k,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var he=AS($,u);Ac(s,r,he,On(s))}else Ac(s,r,u,On(s))}catch(ve){Ac(s,r,{then:function(){},status:"rejected",reason:ve},On())}finally{K.p=m,v!==null&&k.types!==null&&(v.types=k.types),O.T=v}}function MS(){}function Wm(s,r,l,u){if(s.tag!==5)throw Error(i(476));var f=qb(s).queue;$b(s,f,r,oe,l===null?MS:function(){return Hb(s),l(u)})}function qb(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:oe},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:l},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function Hb(s){var r=qb(s);r.next===null&&(r=s.alternate.memoizedState),Ac(s,r.next.queue,{},On())}function Qm(){return Us(Hc)}function Gb(){return ms().memoizedState}function Yb(){return ms().memoizedState}function OS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var l=On();s=Yr(l);var u=Wr(r,s,l);u!==null&&(mn(u,r,l),_c(u,r,l)),r={cache:jm()},s.payload=r;return}r=r.return}}function PS(s,r,l){var u=On();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Ld(s)?Qb(r,l):(l=fm(s,r,l,u),l!==null&&(mn(l,s,u),Kb(l,r,u)))}function Wb(s,r,l){var u=On();Ac(s,r,l,u)}function Ac(s,r,l,u){var f={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Ld(s))Qb(r,f);else{var m=s.alternate;if(s.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var v=r.lastRenderedState,k=m(v,l);if(f.hasEagerState=!0,f.eagerState=k,kn(k,v))return bd(s,r,f,0),$t===null&&gd(),!1}catch{}if(l=fm(s,r,f,u),l!==null)return mn(l,s,u),Kb(l,r,u),!0}return!1}function Km(s,r,l,u){if(u={lane:2,revertLane:Ap(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Ld(s)){if(r)throw Error(i(479))}else r=fm(s,l,u,2),r!==null&&mn(r,s,2)}function Ld(s){var r=s.alternate;return s===ft||r!==null&&r===ft}function Qb(s,r){to=Rd=!0;var l=s.pending;l===null?r.next=r:(r.next=l.next,l.next=r),s.pending=r}function Kb(s,r,l){if((l&4194048)!==0){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,ra(s,l)}}var kc={readContext:Us,use:Md,useCallback:ls,useContext:ls,useEffect:ls,useImperativeHandle:ls,useLayoutEffect:ls,useInsertionEffect:ls,useMemo:ls,useReducer:ls,useRef:ls,useState:ls,useDebugValue:ls,useDeferredValue:ls,useTransition:ls,useSyncExternalStore:ls,useId:ls,useHostTransitionStatus:ls,useFormState:ls,useActionState:ls,useOptimistic:ls,useMemoCache:ls,useCacheRefresh:ls};kc.useEffectEvent=ls;var Xb={readContext:Us,use:Md,useCallback:function(s,r){return en().memoizedState=[s,r===void 0?null:r],s},useContext:Us,useEffect:Mb,useImperativeHandle:function(s,r,l){l=l!=null?l.concat([s]):null,Pd(4194308,4,Lb.bind(null,r,s),l)},useLayoutEffect:function(s,r){return Pd(4194308,4,s,r)},useInsertionEffect:function(s,r){Pd(4,2,s,r)},useMemo:function(s,r){var l=en();r=r===void 0?null:r;var u=s();if(al){gs(!0);try{s()}finally{gs(!1)}}return l.memoizedState=[u,r],u},useReducer:function(s,r,l){var u=en();if(l!==void 0){var f=l(r);if(al){gs(!0);try{l(r)}finally{gs(!1)}}}else f=r;return u.memoizedState=u.baseState=f,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:f},u.queue=s,s=s.dispatch=PS.bind(null,ft,s),[u.memoizedState,s]},useRef:function(s){var r=en();return s={current:s},r.memoizedState=s},useState:function(s){s=$m(s);var r=s.queue,l=Wb.bind(null,ft,r);return r.dispatch=l,[s.memoizedState,l]},useDebugValue:Gm,useDeferredValue:function(s,r){var l=en();return Ym(l,s,r)},useTransition:function(){var s=$m(!1);return s=$b.bind(null,ft,s.queue,!0,!1),en().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,l){var u=ft,f=en();if(jt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),$t===null)throw Error(i(349));(yt&127)!==0||bb(u,r,l)}f.memoizedState=l;var m={value:l,getSnapshot:r};return f.queue=m,Mb(vb.bind(null,u,m,s),[s]),u.flags|=2048,no(9,{destroy:void 0},yb.bind(null,u,m,l,r),null),l},useId:function(){var s=en(),r=$t.identifierPrefix;if(jt){var l=Ua,u=La;l=(u&~(1<<32-z(u)-1)).toString(32)+l,r="_"+r+"R_"+l,l=Id++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=kS++,r="_"+r+"r_"+l.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:Qm,useFormState:kb,useActionState:kb,useOptimistic:function(s){var r=en();r.memoizedState=r.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=Km.bind(null,ft,!0,l),l.dispatch=r,[s,r]},useMemoCache:Bm,useCacheRefresh:function(){return en().memoizedState=OS.bind(null,ft)},useEffectEvent:function(s){var r=en(),l={impl:s};return r.memoizedState=l,function(){if((Rt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},Xm={readContext:Us,use:Md,useCallback:Bb,useContext:Us,useEffect:Hm,useImperativeHandle:Ub,useInsertionEffect:Pb,useLayoutEffect:Vb,useMemo:zb,useReducer:Od,useRef:Db,useState:function(){return Od(or)},useDebugValue:Gm,useDeferredValue:function(s,r){var l=ms();return Fb(l,Bt.memoizedState,s,r)},useTransition:function(){var s=Od(or)[0],r=ms().memoizedState;return[typeof s=="boolean"?s:Tc(s),r]},useSyncExternalStore:gb,useId:Gb,useHostTransitionStatus:Qm,useFormState:Cb,useActionState:Cb,useOptimistic:function(s,r){var l=ms();return _b(l,Bt,s,r)},useMemoCache:Bm,useCacheRefresh:Yb};Xm.useEffectEvent=Ob;var Jb={readContext:Us,use:Md,useCallback:Bb,useContext:Us,useEffect:Hm,useImperativeHandle:Ub,useInsertionEffect:Pb,useLayoutEffect:Vb,useMemo:zb,useReducer:Fm,useRef:Db,useState:function(){return Fm(or)},useDebugValue:Gm,useDeferredValue:function(s,r){var l=ms();return Bt===null?Ym(l,s,r):Fb(l,Bt.memoizedState,s,r)},useTransition:function(){var s=Fm(or)[0],r=ms().memoizedState;return[typeof s=="boolean"?s:Tc(s),r]},useSyncExternalStore:gb,useId:Gb,useHostTransitionStatus:Qm,useFormState:Ib,useActionState:Ib,useOptimistic:function(s,r){var l=ms();return Bt!==null?_b(l,Bt,s,r):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:Bm,useCacheRefresh:Yb};Jb.useEffectEvent=Ob;function Jm(s,r,l,u){r=s.memoizedState,l=l(u,r),l=l==null?r:w({},r,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Zm={enqueueSetState:function(s,r,l){s=s._reactInternals;var u=On(),f=Yr(u);f.payload=r,l!=null&&(f.callback=l),r=Wr(s,f,u),r!==null&&(mn(r,s,u),_c(r,s,u))},enqueueReplaceState:function(s,r,l){s=s._reactInternals;var u=On(),f=Yr(u);f.tag=1,f.payload=r,l!=null&&(f.callback=l),r=Wr(s,f,u),r!==null&&(mn(r,s,u),_c(r,s,u))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var l=On(),u=Yr(l);u.tag=2,r!=null&&(u.callback=r),r=Wr(s,u,l),r!==null&&(mn(r,s,l),_c(r,s,l))}};function Zb(s,r,l,u,f,m,v){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,m,v):r.prototype&&r.prototype.isPureReactComponent?!pc(l,u)||!pc(f,m):!0}function ey(s,r,l,u){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==s&&Zm.enqueueReplaceState(r,r.state,null)}function rl(s,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(s=s.defaultProps){l===r&&(l=w({},l));for(var f in s)l[f]===void 0&&(l[f]=s[f])}return l}function ty(s){xd(s)}function sy(s){console.error(s)}function ny(s){xd(s)}function Ud(s,r){try{var l=s.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function ay(s,r,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function ep(s,r,l){return l=Yr(l),l.tag=3,l.payload={element:null},l.callback=function(){Ud(s,r)},l}function ry(s){return s=Yr(s),s.tag=3,s}function iy(s,r,l,u){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var m=u.value;s.payload=function(){return f(m)},s.callback=function(){ay(r,l,u)}}var v=l.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){ay(r,l,u),typeof f!="function"&&(ei===null?ei=new Set([this]):ei.add(this));var k=u.stack;this.componentDidCatch(u.value,{componentStack:k!==null?k:""})})}function VS(s,r,l,u,f){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&Ql(r,l,f,!0),l=Rn.current,l!==null){switch(l.tag){case 31:case 13:return Qn===null?Xd():l.alternate===null&&os===0&&(os=3),l.flags&=-257,l.flags|=65536,l.lanes=f,u===Ed?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),Sp(s,u,f)),!1;case 22:return l.flags|=65536,u===Ed?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),Sp(s,u,f)),!1}throw Error(i(435,l.tag))}return Sp(s,u,f),Xd(),!1}if(jt)return r=Rn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,u!==ym&&(s=Error(i(422),{cause:u}),bc(Hn(s,l)))):(u!==ym&&(r=Error(i(423),{cause:u}),bc(Hn(r,l))),s=s.current.alternate,s.flags|=65536,f&=-f,s.lanes|=f,u=Hn(u,l),f=ep(s.stateNode,u,f),Cm(s,f),os!==4&&(os=2)),!1;var m=Error(i(520),{cause:u});if(m=Hn(m,l),Vc===null?Vc=[m]:Vc.push(m),os!==4&&(os=2),r===null)return!0;u=Hn(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,s=f&-f,l.lanes|=s,s=ep(l.stateNode,u,s),Cm(l,s),!1;case 1:if(r=l.type,m=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(ei===null||!ei.has(m))))return l.flags|=65536,f&=-f,l.lanes|=f,f=ry(f),iy(f,s,l,u),Cm(l,f),!1}l=l.return}while(l!==null);return!1}var tp=Error(i(461)),js=!1;function Bs(s,r,l,u){r.child=s===null?ub(r,null,l,u):nl(r,s.child,l,u)}function ly(s,r,l,u,f){l=l.render;var m=r.ref;if("ref"in u){var v={};for(var k in u)k!=="ref"&&(v[k]=u[k])}else v=u;return Zi(r),u=Pm(s,r,l,v,m,f),k=Vm(),s!==null&&!js?(Lm(s,r,f),cr(s,r,f)):(jt&&k&&gm(r),r.flags|=1,Bs(s,r,u,f),r.child)}function oy(s,r,l,u,f){if(s===null){var m=l.type;return typeof m=="function"&&!mm(m)&&m.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=m,cy(s,r,m,u,f)):(s=vd(l.type,null,u,r,r.mode,f),s.ref=r.ref,s.return=r,r.child=s)}if(m=s.child,!cp(s,f)){var v=m.memoizedProps;if(l=l.compare,l=l!==null?l:pc,l(v,u)&&s.ref===r.ref)return cr(s,r,f)}return r.flags|=1,s=nr(m,u),s.ref=r.ref,s.return=r,r.child=s}function cy(s,r,l,u,f){if(s!==null){var m=s.memoizedProps;if(pc(m,u)&&s.ref===r.ref)if(js=!1,r.pendingProps=u=m,cp(s,f))(s.flags&131072)!==0&&(js=!0);else return r.lanes=s.lanes,cr(s,r,f)}return sp(s,r,l,u,f)}function uy(s,r,l,u){var f=u.children,m=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|l:l,s!==null){for(u=r.child=s.child,f=0;u!==null;)f=f|u.lanes|u.childLanes,u=u.sibling;u=f&~m}else u=0,r.child=null;return dy(s,r,m,l,u)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&jd(r,m!==null?m.cachePool:null),m!==null?fb(r,m):Im(),mb(r);else return u=r.lanes=536870912,dy(s,r,m!==null?m.baseLanes|l:l,l,u)}else m!==null?(jd(r,m.cachePool),fb(r,m),Kr(),r.memoizedState=null):(s!==null&&jd(r,null),Im(),Kr());return Bs(s,r,f,l),r.child}function Cc(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function dy(s,r,l,u,f){var m=Em();return m=m===null?null:{parent:Ns._currentValue,pool:m},r.memoizedState={baseLanes:l,cachePool:m},s!==null&&jd(r,null),Im(),mb(r),s!==null&&Ql(s,r,u,!0),r.childLanes=f,null}function Bd(s,r){return r=Fd({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function hy(s,r,l){return nl(r,s.child,null,l),s=Bd(r,r.pendingProps),s.flags|=2,In(r),r.memoizedState=null,s}function LS(s,r,l){var u=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(jt){if(u.mode==="hidden")return s=Bd(r,u),r.lanes=536870912,Cc(null,s);if(Mm(r),(s=Xt)?(s=jv(s,Wn),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Fr!==null?{id:La,overflow:Ua}:null,retryLane:536870912,hydrationErrors:null},l=Qg(s),l.return=r,r.child=l,Ls=r,Xt=null)):s=null,s===null)throw qr(r);return r.lanes=536870912,null}return Bd(r,u)}var m=s.memoizedState;if(m!==null){var v=m.dehydrated;if(Mm(r),f)if(r.flags&256)r.flags&=-257,r=hy(s,r,l);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(js||Ql(s,r,l,!1),f=(l&s.childLanes)!==0,js||f){if(u=$t,u!==null&&(v=ia(u,l),v!==0&&v!==m.retryLane))throw m.retryLane=v,Qi(s,v),mn(u,s,v),tp;Xd(),r=hy(s,r,l)}else s=m.treeContext,Xt=Kn(v.nextSibling),Ls=r,jt=!0,$r=null,Wn=!1,s!==null&&Jg(r,s),r=Bd(r,u),r.flags|=4096;return r}return s=nr(s.child,{mode:u.mode,children:u.children}),s.ref=r.ref,r.child=s,s.return=r,s}function zd(s,r){var l=r.ref;if(l===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(r.flags|=4194816)}}function sp(s,r,l,u,f){return Zi(r),l=Pm(s,r,l,u,void 0,f),u=Vm(),s!==null&&!js?(Lm(s,r,f),cr(s,r,f)):(jt&&u&&gm(r),r.flags|=1,Bs(s,r,l,f),r.child)}function fy(s,r,l,u,f,m){return Zi(r),r.updateQueue=null,l=xb(r,u,l,f),pb(s),u=Vm(),s!==null&&!js?(Lm(s,r,m),cr(s,r,m)):(jt&&u&&gm(r),r.flags|=1,Bs(s,r,l,m),r.child)}function my(s,r,l,u,f){if(Zi(r),r.stateNode===null){var m=Hl,v=l.contextType;typeof v=="object"&&v!==null&&(m=Us(v)),m=new l(u,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Zm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=u,m.state=r.memoizedState,m.refs={},Am(r),v=l.contextType,m.context=typeof v=="object"&&v!==null?Us(v):Hl,m.state=r.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(Jm(r,l,v,u),m.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(v=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),v!==m.state&&Zm.enqueueReplaceState(m,m.state,null),Sc(r,u,m,f),jc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(s===null){m=r.stateNode;var k=r.memoizedProps,$=rl(l,k);m.props=$;var te=m.context,he=l.contextType;v=Hl,typeof he=="object"&&he!==null&&(v=Us(he));var ve=l.getDerivedStateFromProps;he=typeof ve=="function"||typeof m.getSnapshotBeforeUpdate=="function",k=r.pendingProps!==k,he||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(k||te!==v)&&ey(r,m,u,v),Gr=!1;var se=r.memoizedState;m.state=se,Sc(r,u,m,f),jc(),te=r.memoizedState,k||se!==te||Gr?(typeof ve=="function"&&(Jm(r,l,ve,u),te=r.memoizedState),($=Gr||Zb(r,l,$,u,se,te,v))?(he||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=te),m.props=u,m.state=te,m.context=v,u=$):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{m=r.stateNode,km(s,r),v=r.memoizedProps,he=rl(l,v),m.props=he,ve=r.pendingProps,se=m.context,te=l.contextType,$=Hl,typeof te=="object"&&te!==null&&($=Us(te)),k=l.getDerivedStateFromProps,(te=typeof k=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==ve||se!==$)&&ey(r,m,u,$),Gr=!1,se=r.memoizedState,m.state=se,Sc(r,u,m,f),jc();var ce=r.memoizedState;v!==ve||se!==ce||Gr||s!==null&&s.dependencies!==null&&Nd(s.dependencies)?(typeof k=="function"&&(Jm(r,l,k,u),ce=r.memoizedState),(he=Gr||Zb(r,l,he,u,se,ce,$)||s!==null&&s.dependencies!==null&&Nd(s.dependencies))?(te||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(u,ce,$),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(u,ce,$)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===s.memoizedProps&&se===s.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&se===s.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=ce),m.props=u,m.state=ce,m.context=$,u=he):(typeof m.componentDidUpdate!="function"||v===s.memoizedProps&&se===s.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&se===s.memoizedState||(r.flags|=1024),u=!1)}return m=u,zd(s,r),u=(r.flags&128)!==0,m||u?(m=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,s!==null&&u?(r.child=nl(r,s.child,null,f),r.child=nl(r,null,l,f)):Bs(s,r,l,f),r.memoizedState=m.state,s=r.child):s=cr(s,r,f),s}function py(s,r,l,u){return Xi(),r.flags|=256,Bs(s,r,l,u),r.child}var np={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ap(s){return{baseLanes:s,cachePool:ab()}}function rp(s,r,l){return s=s!==null?s.childLanes&~l:0,r&&(s|=Mn),s}function xy(s,r,l){var u=r.pendingProps,f=!1,m=(r.flags&128)!==0,v;if((v=m)||(v=s!==null&&s.memoizedState===null?!1:(fs.current&2)!==0),v&&(f=!0,r.flags&=-129),v=(r.flags&32)!==0,r.flags&=-33,s===null){if(jt){if(f?Qr(r):Kr(),(s=Xt)?(s=jv(s,Wn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Fr!==null?{id:La,overflow:Ua}:null,retryLane:536870912,hydrationErrors:null},l=Qg(s),l.return=r,r.child=l,Ls=r,Xt=null)):s=null,s===null)throw qr(r);return zp(s)?r.lanes=32:r.lanes=536870912,null}var k=u.children;return u=u.fallback,f?(Kr(),f=r.mode,k=Fd({mode:"hidden",children:k},f),u=Ki(u,f,l,null),k.return=r,u.return=r,k.sibling=u,r.child=k,u=r.child,u.memoizedState=ap(l),u.childLanes=rp(s,v,l),r.memoizedState=np,Cc(null,u)):(Qr(r),ip(r,k))}var $=s.memoizedState;if($!==null&&(k=$.dehydrated,k!==null)){if(m)r.flags&256?(Qr(r),r.flags&=-257,r=lp(s,r,l)):r.memoizedState!==null?(Kr(),r.child=s.child,r.flags|=128,r=null):(Kr(),k=u.fallback,f=r.mode,u=Fd({mode:"visible",children:u.children},f),k=Ki(k,f,l,null),k.flags|=2,u.return=r,k.return=r,u.sibling=k,r.child=u,nl(r,s.child,null,l),u=r.child,u.memoizedState=ap(l),u.childLanes=rp(s,v,l),r.memoizedState=np,r=Cc(null,u));else if(Qr(r),zp(k)){if(v=k.nextSibling&&k.nextSibling.dataset,v)var te=v.dgst;v=te,u=Error(i(419)),u.stack="",u.digest=v,bc({value:u,source:null,stack:null}),r=lp(s,r,l)}else if(js||Ql(s,r,l,!1),v=(l&s.childLanes)!==0,js||v){if(v=$t,v!==null&&(u=ia(v,l),u!==0&&u!==$.retryLane))throw $.retryLane=u,Qi(s,u),mn(v,s,u),tp;Bp(k)||Xd(),r=lp(s,r,l)}else Bp(k)?(r.flags|=192,r.child=s.child,r=null):(s=$.treeContext,Xt=Kn(k.nextSibling),Ls=r,jt=!0,$r=null,Wn=!1,s!==null&&Jg(r,s),r=ip(r,u.children),r.flags|=4096);return r}return f?(Kr(),k=u.fallback,f=r.mode,$=s.child,te=$.sibling,u=nr($,{mode:"hidden",children:u.children}),u.subtreeFlags=$.subtreeFlags&65011712,te!==null?k=nr(te,k):(k=Ki(k,f,l,null),k.flags|=2),k.return=r,u.return=r,u.sibling=k,r.child=u,Cc(null,u),u=r.child,k=s.child.memoizedState,k===null?k=ap(l):(f=k.cachePool,f!==null?($=Ns._currentValue,f=f.parent!==$?{parent:$,pool:$}:f):f=ab(),k={baseLanes:k.baseLanes|l,cachePool:f}),u.memoizedState=k,u.childLanes=rp(s,v,l),r.memoizedState=np,Cc(s.child,u)):(Qr(r),l=s.child,s=l.sibling,l=nr(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,s!==null&&(v=r.deletions,v===null?(r.deletions=[s],r.flags|=16):v.push(s)),r.child=l,r.memoizedState=null,l)}function ip(s,r){return r=Fd({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Fd(s,r){return s=Cn(22,s,null,r),s.lanes=0,s}function lp(s,r,l){return nl(r,s.child,null,l),s=ip(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function gy(s,r,l){s.lanes|=r;var u=s.alternate;u!==null&&(u.lanes|=r),Nm(s.return,r,l)}function op(s,r,l,u,f,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:f,treeForkCount:m}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=l,v.tailMode=f,v.treeForkCount=m)}function by(s,r,l){var u=r.pendingProps,f=u.revealOrder,m=u.tail;u=u.children;var v=fs.current,k=(v&2)!==0;if(k?(v=v&1|2,r.flags|=128):v&=1,ue(fs,v),Bs(s,r,u,l),u=jt?gc:0,!k&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&gy(s,l,r);else if(s.tag===19)gy(s,l,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(f){case"forwards":for(l=r.child,f=null;l!==null;)s=l.alternate,s!==null&&Cd(s)===null&&(f=l),l=l.sibling;l=f,l===null?(f=r.child,r.child=null):(f=l.sibling,l.sibling=null),op(r,!1,f,l,m,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,f=r.child,r.child=null;f!==null;){if(s=f.alternate,s!==null&&Cd(s)===null){r.child=f;break}s=f.sibling,f.sibling=l,l=f,f=s}op(r,!0,l,null,m,u);break;case"together":op(r,!1,null,null,void 0,u);break;default:r.memoizedState=null}return r.child}function cr(s,r,l){if(s!==null&&(r.dependencies=s.dependencies),Zr|=r.lanes,(l&r.childLanes)===0)if(s!==null){if(Ql(s,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,l=nr(s,s.pendingProps),r.child=l,l.return=r;s.sibling!==null;)s=s.sibling,l=l.sibling=nr(s,s.pendingProps),l.return=r;l.sibling=null}return r.child}function cp(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&Nd(s)))}function US(s,r,l){switch(r.tag){case 3:pt(r,r.stateNode.containerInfo),Hr(r,Ns,s.memoizedState.cache),Xi();break;case 27:case 5:Wt(r);break;case 4:pt(r,r.stateNode.containerInfo);break;case 10:Hr(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Mm(r),null;break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(Qr(r),r.flags|=128,null):(l&r.child.childLanes)!==0?xy(s,r,l):(Qr(r),s=cr(s,r,l),s!==null?s.sibling:null);Qr(r);break;case 19:var f=(s.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||(Ql(s,r,l,!1),u=(l&r.childLanes)!==0),f){if(u)return by(s,r,l);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ue(fs,fs.current),u)break;return null;case 22:return r.lanes=0,uy(s,r,l,r.pendingProps);case 24:Hr(r,Ns,s.memoizedState.cache)}return cr(s,r,l)}function yy(s,r,l){if(s!==null)if(s.memoizedProps!==r.pendingProps)js=!0;else{if(!cp(s,l)&&(r.flags&128)===0)return js=!1,US(s,r,l);js=(s.flags&131072)!==0}else js=!1,jt&&(r.flags&1048576)!==0&&Xg(r,gc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var u=r.pendingProps;if(s=tl(r.elementType),r.type=s,typeof s=="function")mm(s)?(u=rl(s,u),r.tag=1,r=my(null,r,s,u,l)):(r.tag=0,r=sp(null,r,s,u,l));else{if(s!=null){var f=s.$$typeof;if(f===ie){r.tag=11,r=ly(null,r,s,u,l);break e}else if(f===T){r.tag=14,r=oy(null,r,s,u,l);break e}}throw r=B(s)||s,Error(i(306,r,""))}}return r;case 0:return sp(s,r,r.type,r.pendingProps,l);case 1:return u=r.type,f=rl(u,r.pendingProps),my(s,r,u,f,l);case 3:e:{if(pt(r,r.stateNode.containerInfo),s===null)throw Error(i(387));u=r.pendingProps;var m=r.memoizedState;f=m.element,km(s,r),Sc(r,u,null,l);var v=r.memoizedState;if(u=v.cache,Hr(r,Ns,u),u!==m.cache&&_m(r,[Ns],l,!0),jc(),u=v.element,m.isDehydrated)if(m={element:u,isDehydrated:!1,cache:v.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=py(s,r,u,l);break e}else if(u!==f){f=Hn(Error(i(424)),r),bc(f),r=py(s,r,u,l);break e}else for(s=r.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,Xt=Kn(s.firstChild),Ls=r,jt=!0,$r=null,Wn=!0,l=ub(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Xi(),u===f){r=cr(s,r,l);break e}Bs(s,r,u,l)}r=r.child}return r;case 26:return zd(s,r),s===null?(l=Cv(r.type,null,r.pendingProps,null))?r.memoizedState=l:jt||(l=r.type,s=r.pendingProps,u=ah(De.current).createElement(l),u[is]=r,u[ys]=s,zs(u,l,s),vs(u),r.stateNode=u):r.memoizedState=Cv(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Wt(r),s===null&&jt&&(u=r.stateNode=Tv(r.type,r.pendingProps,De.current),Ls=r,Wn=!0,f=Xt,ai(r.type)?(Fp=f,Xt=Kn(u.firstChild)):Xt=f),Bs(s,r,r.pendingProps.children,l),zd(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&jt&&((f=u=Xt)&&(u=pE(u,r.type,r.pendingProps,Wn),u!==null?(r.stateNode=u,Ls=r,Xt=Kn(u.firstChild),Wn=!1,f=!0):f=!1),f||qr(r)),Wt(r),f=r.type,m=r.pendingProps,v=s!==null?s.memoizedProps:null,u=m.children,Vp(f,m)?u=null:v!==null&&Vp(f,v)&&(r.flags|=32),r.memoizedState!==null&&(f=Pm(s,r,CS,null,null,l),Hc._currentValue=f),zd(s,r),Bs(s,r,u,l),r.child;case 6:return s===null&&jt&&((s=l=Xt)&&(l=xE(l,r.pendingProps,Wn),l!==null?(r.stateNode=l,Ls=r,Xt=null,s=!0):s=!1),s||qr(r)),null;case 13:return xy(s,r,l);case 4:return pt(r,r.stateNode.containerInfo),u=r.pendingProps,s===null?r.child=nl(r,null,u,l):Bs(s,r,u,l),r.child;case 11:return ly(s,r,r.type,r.pendingProps,l);case 7:return Bs(s,r,r.pendingProps,l),r.child;case 8:return Bs(s,r,r.pendingProps.children,l),r.child;case 12:return Bs(s,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,Hr(r,r.type,u.value),Bs(s,r,u.children,l),r.child;case 9:return f=r.type._context,u=r.pendingProps.children,Zi(r),f=Us(f),u=u(f),r.flags|=1,Bs(s,r,u,l),r.child;case 14:return oy(s,r,r.type,r.pendingProps,l);case 15:return cy(s,r,r.type,r.pendingProps,l);case 19:return by(s,r,l);case 31:return LS(s,r,l);case 22:return uy(s,r,l,r.pendingProps);case 24:return Zi(r),u=Us(Ns),s===null?(f=Em(),f===null&&(f=$t,m=jm(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=l),f=m),r.memoizedState={parent:u,cache:f},Am(r),Hr(r,Ns,f)):((s.lanes&l)!==0&&(km(s,r),Sc(r,null,null,l),jc()),f=s.memoizedState,m=r.memoizedState,f.parent!==u?(f={parent:u,cache:u},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),Hr(r,Ns,u)):(u=m.cache,Hr(r,Ns,u),u!==f.cache&&_m(r,[Ns],l,!0))),Bs(s,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function ur(s){s.flags|=4}function up(s,r,l,u,f){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(f&335544128)===f)if(s.stateNode.complete)s.flags|=8192;else if(Gy())s.flags|=8192;else throw sl=Ed,Tm}else s.flags&=-16777217}function vy(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Ov(r))if(Gy())s.flags|=8192;else throw sl=Ed,Tm}function $d(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?qe():536870912,s.lanes|=r,lo|=r)}function Rc(s,r){if(!jt)switch(s.tailMode){case"hidden":r=s.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function Jt(s){var r=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(r)for(var f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=s,f=f.sibling;else for(f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=s,f=f.sibling;return s.subtreeFlags|=u,s.childLanes=l,r}function BS(s,r,l){var u=r.pendingProps;switch(bm(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(r),null;case 1:return Jt(r),null;case 3:return l=r.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),ir(Ns),dt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Wl(r)?ur(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,vm())),Jt(r),null;case 26:var f=r.type,m=r.memoizedState;return s===null?(ur(r),m!==null?(Jt(r),vy(r,m)):(Jt(r),up(r,f,null,u,l))):m?m!==s.memoizedState?(ur(r),Jt(r),vy(r,m)):(Jt(r),r.flags&=-16777217):(s=s.memoizedProps,s!==u&&ur(r),Jt(r),up(r,f,s,u,l)),null;case 27:if(ne(r),l=De.current,f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&ur(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Jt(r),null}s=me.current,Wl(r)?Zg(r):(s=Tv(f,u,l),r.stateNode=s,ur(r))}return Jt(r),null;case 5:if(ne(r),f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&ur(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Jt(r),null}if(m=me.current,Wl(r))Zg(r);else{var v=ah(De.current);switch(m){case 1:m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=v.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof u.is=="string"?v.createElement("select",{is:u.is}):v.createElement("select"),u.multiple?m.multiple=!0:u.size&&(m.size=u.size);break;default:m=typeof u.is=="string"?v.createElement(f,{is:u.is}):v.createElement(f)}}m[is]=r,m[ys]=u;e:for(v=r.child;v!==null;){if(v.tag===5||v.tag===6)m.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===r)break e;for(;v.sibling===null;){if(v.return===null||v.return===r)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}r.stateNode=m;e:switch(zs(m,f,u),f){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&ur(r)}}return Jt(r),up(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,l),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==u&&ur(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(s=De.current,Wl(r)){if(s=r.stateNode,l=r.memoizedProps,u=null,f=Ls,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}s[is]=r,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||xv(s.nodeValue,l)),s||qr(r,!0)}else s=ah(s).createTextNode(u),s[is]=r,r.stateNode=s}return Jt(r),null;case 31:if(l=r.memoizedState,s===null||s.memoizedState!==null){if(u=Wl(r),l!==null){if(s===null){if(!u)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[is]=r}else Xi(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Jt(r),s=!1}else l=vm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return r.flags&256?(In(r),r):(In(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Jt(r),null;case 13:if(u=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(f=Wl(r),u!==null&&u.dehydrated!==null){if(s===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[is]=r}else Xi(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Jt(r),f=!1}else f=vm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(In(r),r):(In(r),null)}return In(r),(r.flags&128)!==0?(r.lanes=l,r):(l=u!==null,s=s!==null&&s.memoizedState!==null,l&&(u=r.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool),m=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),m!==f&&(u.flags|=2048)),l!==s&&l&&(r.child.flags|=8192),$d(r,r.updateQueue),Jt(r),null);case 4:return dt(),s===null&&Ip(r.stateNode.containerInfo),Jt(r),null;case 10:return ir(r.type),Jt(r),null;case 19:if(Z(fs),u=r.memoizedState,u===null)return Jt(r),null;if(f=(r.flags&128)!==0,m=u.rendering,m===null)if(f)Rc(u,!1);else{if(os!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(m=Cd(s),m!==null){for(r.flags|=128,Rc(u,!1),s=m.updateQueue,r.updateQueue=s,$d(r,s),r.subtreeFlags=0,s=l,l=r.child;l!==null;)Wg(l,s),l=l.sibling;return ue(fs,fs.current&1|2),jt&&ar(r,u.treeForkCount),r.child}s=s.sibling}u.tail!==null&&Fe()>Wd&&(r.flags|=128,f=!0,Rc(u,!1),r.lanes=4194304)}else{if(!f)if(s=Cd(m),s!==null){if(r.flags|=128,f=!0,s=s.updateQueue,r.updateQueue=s,$d(r,s),Rc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!m.alternate&&!jt)return Jt(r),null}else 2*Fe()-u.renderingStartTime>Wd&&l!==536870912&&(r.flags|=128,f=!0,Rc(u,!1),r.lanes=4194304);u.isBackwards?(m.sibling=r.child,r.child=m):(s=u.last,s!==null?s.sibling=m:r.child=m,u.last=m)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=Fe(),s.sibling=null,l=fs.current,ue(fs,f?l&1|2:l&1),jt&&ar(r,u.treeForkCount),s):(Jt(r),null);case 22:case 23:return In(r),Dm(),u=r.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(Jt(r),r.subtreeFlags&6&&(r.flags|=8192)):Jt(r),l=r.updateQueue,l!==null&&$d(r,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),s!==null&&Z(el),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),ir(Ns),Jt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function zS(s,r){switch(bm(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return ir(Ns),dt(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return ne(r),null;case 31:if(r.memoizedState!==null){if(In(r),r.alternate===null)throw Error(i(340));Xi()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(In(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Xi()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return Z(fs),null;case 4:return dt(),null;case 10:return ir(r.type),null;case 22:case 23:return In(r),Dm(),s!==null&&Z(el),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return ir(Ns),null;case 25:return null;default:return null}}function wy(s,r){switch(bm(r),r.tag){case 3:ir(Ns),dt();break;case 26:case 27:case 5:ne(r);break;case 4:dt();break;case 31:r.memoizedState!==null&&In(r);break;case 13:In(r);break;case 19:Z(fs);break;case 10:ir(r.type);break;case 22:case 23:In(r),Dm(),s!==null&&Z(el);break;case 24:ir(Ns)}}function Ic(s,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&s)===s){u=void 0;var m=l.create,v=l.inst;u=m(),v.destroy=u}l=l.next}while(l!==f)}}catch(k){Vt(r,r.return,k)}}function Xr(s,r,l){try{var u=r.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var m=f.next;u=m;do{if((u.tag&s)===s){var v=u.inst,k=v.destroy;if(k!==void 0){v.destroy=void 0,f=r;var $=l,te=k;try{te()}catch(he){Vt(f,$,he)}}}u=u.next}while(u!==m)}}catch(he){Vt(r,r.return,he)}}function Ny(s){var r=s.updateQueue;if(r!==null){var l=s.stateNode;try{hb(r,l)}catch(u){Vt(s,s.return,u)}}}function _y(s,r,l){l.props=rl(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){Vt(s,r,u)}}function Dc(s,r){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(f){Vt(s,r,f)}}function Ba(s,r){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(f){Vt(s,r,f)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){Vt(s,r,f)}else l.current=null}function jy(s){var r=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(f){Vt(s,s.return,f)}}function dp(s,r,l){try{var u=s.stateNode;cE(u,s.type,l,r),u[ys]=r}catch(f){Vt(s,s.return,f)}}function Sy(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ai(s.type)||s.tag===4}function hp(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Sy(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ai(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function fp(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(s),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=oa));else if(u!==4&&(u===27&&ai(s.type)&&(l=s.stateNode,r=null),s=s.child,s!==null))for(fp(s,r,l),s=s.sibling;s!==null;)fp(s,r,l),s=s.sibling}function qd(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?l.insertBefore(s,r):l.appendChild(s);else if(u!==4&&(u===27&&ai(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(qd(s,r,l),s=s.sibling;s!==null;)qd(s,r,l),s=s.sibling}function Ey(s){var r=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);zs(r,u,l),r[is]=s,r[ys]=l}catch(m){Vt(s,s.return,m)}}var dr=!1,Ss=!1,mp=!1,Ty=typeof WeakSet=="function"?WeakSet:Set,Os=null;function FS(s,r){if(s=s.containerInfo,Op=dh,s=Ug(s),lm(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var f=u.anchorOffset,m=u.focusNode;u=u.focusOffset;try{l.nodeType,m.nodeType}catch{l=null;break e}var v=0,k=-1,$=-1,te=0,he=0,ve=s,se=null;t:for(;;){for(var ce;ve!==l||f!==0&&ve.nodeType!==3||(k=v+f),ve!==m||u!==0&&ve.nodeType!==3||($=v+u),ve.nodeType===3&&(v+=ve.nodeValue.length),(ce=ve.firstChild)!==null;)se=ve,ve=ce;for(;;){if(ve===s)break t;if(se===l&&++te===f&&(k=v),se===m&&++he===u&&($=v),(ce=ve.nextSibling)!==null)break;ve=se,se=ve.parentNode}ve=ce}l=k===-1||$===-1?null:{start:k,end:$}}else l=null}l=l||{start:0,end:0}}else l=null;for(Pp={focusedElem:s,selectionRange:l},dh=!1,Os=r;Os!==null;)if(r=Os,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,Os=s;else for(;Os!==null;){switch(r=Os,m=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)f=s[l],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&m!==null){s=void 0,l=r,f=m.memoizedProps,m=m.memoizedState,u=l.stateNode;try{var Be=rl(l.type,f);s=u.getSnapshotBeforeUpdate(Be,m),u.__reactInternalSnapshotBeforeUpdate=s}catch(et){Vt(l,l.return,et)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,l=s.nodeType,l===9)Up(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Up(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,Os=s;break}Os=r.return}}function Ay(s,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:fr(s,l),u&4&&Ic(5,l);break;case 1:if(fr(s,l),u&4)if(s=l.stateNode,r===null)try{s.componentDidMount()}catch(v){Vt(l,l.return,v)}else{var f=rl(l.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(f,r,s.__reactInternalSnapshotBeforeUpdate)}catch(v){Vt(l,l.return,v)}}u&64&&Ny(l),u&512&&Dc(l,l.return);break;case 3:if(fr(s,l),u&64&&(s=l.updateQueue,s!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{hb(s,r)}catch(v){Vt(l,l.return,v)}}break;case 27:r===null&&u&4&&Ey(l);case 26:case 5:fr(s,l),r===null&&u&4&&jy(l),u&512&&Dc(l,l.return);break;case 12:fr(s,l);break;case 31:fr(s,l),u&4&&Ry(s,l);break;case 13:fr(s,l),u&4&&Iy(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=XS.bind(null,l),gE(s,l))));break;case 22:if(u=l.memoizedState!==null||dr,!u){r=r!==null&&r.memoizedState!==null||Ss,f=dr;var m=Ss;dr=u,(Ss=r)&&!m?mr(s,l,(l.subtreeFlags&8772)!==0):fr(s,l),dr=f,Ss=m}break;case 30:break;default:fr(s,l)}}function ky(s){var r=s.alternate;r!==null&&(s.alternate=null,ky(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Rl(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ss=null,un=!1;function hr(s,r,l){for(l=l.child;l!==null;)Cy(s,r,l),l=l.sibling}function Cy(s,r,l){if(Lt&&typeof Lt.onCommitFiberUnmount=="function")try{Lt.onCommitFiberUnmount(xs,l)}catch{}switch(l.tag){case 26:Ss||Ba(l,r),hr(s,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ss||Ba(l,r);var u=ss,f=un;ai(l.type)&&(ss=l.stateNode,un=!1),hr(s,r,l),Fc(l.stateNode),ss=u,un=f;break;case 5:Ss||Ba(l,r);case 6:if(u=ss,f=un,ss=null,hr(s,r,l),ss=u,un=f,ss!==null)if(un)try{(ss.nodeType===9?ss.body:ss.nodeName==="HTML"?ss.ownerDocument.body:ss).removeChild(l.stateNode)}catch(m){Vt(l,r,m)}else try{ss.removeChild(l.stateNode)}catch(m){Vt(l,r,m)}break;case 18:ss!==null&&(un?(s=ss,Nv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),xo(s)):Nv(ss,l.stateNode));break;case 4:u=ss,f=un,ss=l.stateNode.containerInfo,un=!0,hr(s,r,l),ss=u,un=f;break;case 0:case 11:case 14:case 15:Xr(2,l,r),Ss||Xr(4,l,r),hr(s,r,l);break;case 1:Ss||(Ba(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&_y(l,r,u)),hr(s,r,l);break;case 21:hr(s,r,l);break;case 22:Ss=(u=Ss)||l.memoizedState!==null,hr(s,r,l),Ss=u;break;default:hr(s,r,l)}}function Ry(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{xo(s)}catch(l){Vt(r,r.return,l)}}}function Iy(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{xo(s)}catch(l){Vt(r,r.return,l)}}function $S(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new Ty),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new Ty),r;default:throw Error(i(435,s.tag))}}function Hd(s,r){var l=$S(s);r.forEach(function(u){if(!l.has(u)){l.add(u);var f=JS.bind(null,s,u);u.then(f,f)}})}function dn(s,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var f=l[u],m=s,v=r,k=v;e:for(;k!==null;){switch(k.tag){case 27:if(ai(k.type)){ss=k.stateNode,un=!1;break e}break;case 5:ss=k.stateNode,un=!1;break e;case 3:case 4:ss=k.stateNode.containerInfo,un=!0;break e}k=k.return}if(ss===null)throw Error(i(160));Cy(m,v,f),ss=null,un=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Dy(r,s),r=r.sibling}var ma=null;function Dy(s,r){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:dn(r,s),hn(s),u&4&&(Xr(3,s,s.return),Ic(3,s),Xr(5,s,s.return));break;case 1:dn(r,s),hn(s),u&512&&(Ss||l===null||Ba(l,l.return)),u&64&&dr&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var f=ma;if(dn(r,s),hn(s),u&512&&(Ss||l===null||Ba(l,l.return)),u&4){var m=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":m=f.getElementsByTagName("title")[0],(!m||m[Ea]||m[is]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(u),f.head.insertBefore(m,f.querySelector("head > title"))),zs(m,u,l),m[is]=s,vs(m),u=m;break e;case"link":var v=Dv("link","href",f).get(u+(l.href||""));if(v){for(var k=0;k<v.length;k++)if(m=v[k],m.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&m.getAttribute("rel")===(l.rel==null?null:l.rel)&&m.getAttribute("title")===(l.title==null?null:l.title)&&m.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){v.splice(k,1);break t}}m=f.createElement(u),zs(m,u,l),f.head.appendChild(m);break;case"meta":if(v=Dv("meta","content",f).get(u+(l.content||""))){for(k=0;k<v.length;k++)if(m=v[k],m.getAttribute("content")===(l.content==null?null:""+l.content)&&m.getAttribute("name")===(l.name==null?null:l.name)&&m.getAttribute("property")===(l.property==null?null:l.property)&&m.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&m.getAttribute("charset")===(l.charSet==null?null:l.charSet)){v.splice(k,1);break t}}m=f.createElement(u),zs(m,u,l),f.head.appendChild(m);break;default:throw Error(i(468,u))}m[is]=s,vs(m),u=m}s.stateNode=u}else Mv(f,s.type,s.stateNode);else s.stateNode=Iv(f,u,s.memoizedProps);else m!==u?(m===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):m.count--,u===null?Mv(f,s.type,s.stateNode):Iv(f,u,s.memoizedProps)):u===null&&s.stateNode!==null&&dp(s,s.memoizedProps,l.memoizedProps)}break;case 27:dn(r,s),hn(s),u&512&&(Ss||l===null||Ba(l,l.return)),l!==null&&u&4&&dp(s,s.memoizedProps,l.memoizedProps);break;case 5:if(dn(r,s),hn(s),u&512&&(Ss||l===null||Ba(l,l.return)),s.flags&32){f=s.stateNode;try{cn(f,"")}catch(Be){Vt(s,s.return,Be)}}u&4&&s.stateNode!=null&&(f=s.memoizedProps,dp(s,f,l!==null?l.memoizedProps:f)),u&1024&&(mp=!0);break;case 6:if(dn(r,s),hn(s),u&4){if(s.stateNode===null)throw Error(i(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(Be){Vt(s,s.return,Be)}}break;case 3:if(lh=null,f=ma,ma=rh(r.containerInfo),dn(r,s),ma=f,hn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{xo(r.containerInfo)}catch(Be){Vt(s,s.return,Be)}mp&&(mp=!1,My(s));break;case 4:u=ma,ma=rh(s.stateNode.containerInfo),dn(r,s),hn(s),ma=u;break;case 12:dn(r,s),hn(s);break;case 31:dn(r,s),hn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Hd(s,u)));break;case 13:dn(r,s),hn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Yd=Fe()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Hd(s,u)));break;case 22:f=s.memoizedState!==null;var $=l!==null&&l.memoizedState!==null,te=dr,he=Ss;if(dr=te||f,Ss=he||$,dn(r,s),Ss=he,dr=te,hn(s),u&8192)e:for(r=s.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(l===null||$||dr||Ss||il(s)),l=null,r=s;;){if(r.tag===5||r.tag===26){if(l===null){$=l=r;try{if(m=$.stateNode,f)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{k=$.stateNode;var ve=$.memoizedProps.style,se=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;k.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Be){Vt($,$.return,Be)}}}else if(r.tag===6){if(l===null){$=r;try{$.stateNode.nodeValue=f?"":$.memoizedProps}catch(Be){Vt($,$.return,Be)}}}else if(r.tag===18){if(l===null){$=r;try{var ce=$.stateNode;f?_v(ce,!0):_v($.stateNode,!1)}catch(Be){Vt($,$.return,Be)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Hd(s,l))));break;case 19:dn(r,s),hn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Hd(s,u)));break;case 30:break;case 21:break;default:dn(r,s),hn(s)}}function hn(s){var r=s.flags;if(r&2){try{for(var l,u=s.return;u!==null;){if(Sy(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var f=l.stateNode,m=hp(s);qd(s,m,f);break;case 5:var v=l.stateNode;l.flags&32&&(cn(v,""),l.flags&=-33);var k=hp(s);qd(s,k,v);break;case 3:case 4:var $=l.stateNode.containerInfo,te=hp(s);fp(s,te,$);break;default:throw Error(i(161))}}catch(he){Vt(s,s.return,he)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function My(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;My(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function fr(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Ay(s,r.alternate,r),r=r.sibling}function il(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:Xr(4,r,r.return),il(r);break;case 1:Ba(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&_y(r,r.return,l),il(r);break;case 27:Fc(r.stateNode);case 26:case 5:Ba(r,r.return),il(r);break;case 22:r.memoizedState===null&&il(r);break;case 30:il(r);break;default:il(r)}s=s.sibling}}function mr(s,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,f=s,m=r,v=m.flags;switch(m.tag){case 0:case 11:case 15:mr(f,m,l),Ic(4,m);break;case 1:if(mr(f,m,l),u=m,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(te){Vt(u,u.return,te)}if(u=m,f=u.updateQueue,f!==null){var k=u.stateNode;try{var $=f.shared.hiddenCallbacks;if($!==null)for(f.shared.hiddenCallbacks=null,f=0;f<$.length;f++)db($[f],k)}catch(te){Vt(u,u.return,te)}}l&&v&64&&Ny(m),Dc(m,m.return);break;case 27:Ey(m);case 26:case 5:mr(f,m,l),l&&u===null&&v&4&&jy(m),Dc(m,m.return);break;case 12:mr(f,m,l);break;case 31:mr(f,m,l),l&&v&4&&Ry(f,m);break;case 13:mr(f,m,l),l&&v&4&&Iy(f,m);break;case 22:m.memoizedState===null&&mr(f,m,l),Dc(m,m.return);break;case 30:break;default:mr(f,m,l)}r=r.sibling}}function pp(s,r){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&yc(l))}function xp(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&yc(s))}function pa(s,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Oy(s,r,l,u),r=r.sibling}function Oy(s,r,l,u){var f=r.flags;switch(r.tag){case 0:case 11:case 15:pa(s,r,l,u),f&2048&&Ic(9,r);break;case 1:pa(s,r,l,u);break;case 3:pa(s,r,l,u),f&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&yc(s)));break;case 12:if(f&2048){pa(s,r,l,u),s=r.stateNode;try{var m=r.memoizedProps,v=m.id,k=m.onPostCommit;typeof k=="function"&&k(v,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch($){Vt(r,r.return,$)}}else pa(s,r,l,u);break;case 31:pa(s,r,l,u);break;case 13:pa(s,r,l,u);break;case 23:break;case 22:m=r.stateNode,v=r.alternate,r.memoizedState!==null?m._visibility&2?pa(s,r,l,u):Mc(s,r):m._visibility&2?pa(s,r,l,u):(m._visibility|=2,ao(s,r,l,u,(r.subtreeFlags&10256)!==0||!1)),f&2048&&pp(v,r);break;case 24:pa(s,r,l,u),f&2048&&xp(r.alternate,r);break;default:pa(s,r,l,u)}}function ao(s,r,l,u,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=s,v=r,k=l,$=u,te=v.flags;switch(v.tag){case 0:case 11:case 15:ao(m,v,k,$,f),Ic(8,v);break;case 23:break;case 22:var he=v.stateNode;v.memoizedState!==null?he._visibility&2?ao(m,v,k,$,f):Mc(m,v):(he._visibility|=2,ao(m,v,k,$,f)),f&&te&2048&&pp(v.alternate,v);break;case 24:ao(m,v,k,$,f),f&&te&2048&&xp(v.alternate,v);break;default:ao(m,v,k,$,f)}r=r.sibling}}function Mc(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=s,u=r,f=u.flags;switch(u.tag){case 22:Mc(l,u),f&2048&&pp(u.alternate,u);break;case 24:Mc(l,u),f&2048&&xp(u.alternate,u);break;default:Mc(l,u)}r=r.sibling}}var Oc=8192;function ro(s,r,l){if(s.subtreeFlags&Oc)for(s=s.child;s!==null;)Py(s,r,l),s=s.sibling}function Py(s,r,l){switch(s.tag){case 26:ro(s,r,l),s.flags&Oc&&s.memoizedState!==null&&kE(l,ma,s.memoizedState,s.memoizedProps);break;case 5:ro(s,r,l);break;case 3:case 4:var u=ma;ma=rh(s.stateNode.containerInfo),ro(s,r,l),ma=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Oc,Oc=16777216,ro(s,r,l),Oc=u):ro(s,r,l));break;default:ro(s,r,l)}}function Vy(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Pc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Os=u,Uy(u,s)}Vy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Ly(s),s=s.sibling}function Ly(s){switch(s.tag){case 0:case 11:case 15:Pc(s),s.flags&2048&&Xr(9,s,s.return);break;case 3:Pc(s);break;case 12:Pc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Gd(s)):Pc(s);break;default:Pc(s)}}function Gd(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Os=u,Uy(u,s)}Vy(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:Xr(8,r,r.return),Gd(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,Gd(r));break;default:Gd(r)}s=s.sibling}}function Uy(s,r){for(;Os!==null;){var l=Os;switch(l.tag){case 0:case 11:case 15:Xr(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:yc(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Os=u;else e:for(l=s;Os!==null;){u=Os;var f=u.sibling,m=u.return;if(ky(u),u===l){Os=null;break e}if(f!==null){f.return=m,Os=f;break e}Os=m}}}var qS={getCacheForType:function(s){var r=Us(Ns),l=r.data.get(s);return l===void 0&&(l=s(),r.data.set(s,l)),l},cacheSignal:function(){return Us(Ns).controller.signal}},HS=typeof WeakMap=="function"?WeakMap:Map,Rt=0,$t=null,gt=null,yt=0,Pt=0,Dn=null,Jr=!1,io=!1,gp=!1,pr=0,os=0,Zr=0,ll=0,bp=0,Mn=0,lo=0,Vc=null,fn=null,yp=!1,Yd=0,By=0,Wd=1/0,Qd=null,ei=null,ks=0,ti=null,oo=null,xr=0,vp=0,wp=null,zy=null,Lc=0,Np=null;function On(){return(Rt&2)!==0&&yt!==0?yt&-yt:O.T!==null?Ap():Pi()}function Fy(){if(Mn===0)if((yt&536870912)===0||jt){var s=de;de<<=1,(de&3932160)===0&&(de=262144),Mn=s}else Mn=536870912;return s=Rn.current,s!==null&&(s.flags|=32),Mn}function mn(s,r,l){(s===$t&&(Pt===2||Pt===9)||s.cancelPendingCommit!==null)&&(co(s,0),si(s,yt,Mn,!1)),Kt(s,l),((Rt&2)===0||s!==$t)&&(s===$t&&((Rt&2)===0&&(ll|=l),os===4&&si(s,yt,Mn,!1)),za(s))}function $y(s,r,l){if((Rt&6)!==0)throw Error(i(327));var u=!l&&(r&127)===0&&(r&s.expiredLanes)===0||ot(s,r),f=u?WS(s,r):jp(s,r,!0),m=u;do{if(f===0){io&&!u&&si(s,r,0,!1);break}else{if(l=s.current.alternate,m&&!GS(l)){f=jp(s,r,!1),m=!1;continue}if(f===2){if(m=r,s.errorRecoveryDisabledLanes&m)var v=0;else v=s.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){r=v;e:{var k=s;f=Vc;var $=k.current.memoizedState.isDehydrated;if($&&(co(k,v).flags|=256),v=jp(k,v,!1),v!==2){if(gp&&!$){k.errorRecoveryDisabledLanes|=m,ll|=m,f=4;break e}m=fn,fn=f,m!==null&&(fn===null?fn=m:fn.push.apply(fn,m))}f=v}if(m=!1,f!==2)continue}}if(f===1){co(s,0),si(s,r,0,!0);break}e:{switch(u=s,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:si(u,r,Mn,!Jr);break e;case 2:fn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Yd+300-Fe(),10<f)){if(si(u,r,Mn,!Jr),$e(u,0,!0)!==0)break e;xr=r,u.timeoutHandle=vv(qy.bind(null,u,l,fn,Qd,yp,r,Mn,ll,lo,Jr,m,"Throttled",-0,0),f);break e}qy(u,l,fn,Qd,yp,r,Mn,ll,lo,Jr,m,null,-0,0)}}break}while(!0);za(s)}function qy(s,r,l,u,f,m,v,k,$,te,he,ve,se,ce){if(s.timeoutHandle=-1,ve=r.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:oa},Py(r,m,ve);var Be=(m&62914560)===m?Yd-Fe():(m&4194048)===m?By-Fe():0;if(Be=CE(ve,Be),Be!==null){xr=m,s.cancelPendingCommit=Be(Jy.bind(null,s,r,m,l,u,f,v,k,$,he,ve,null,se,ce)),si(s,m,v,!te);return}}Jy(s,r,m,l,u,f,v,k,$)}function GS(s){for(var r=s;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var f=l[u],m=f.getSnapshot;f=f.value;try{if(!kn(m(),f))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function si(s,r,l,u){r&=~bp,r&=~ll,s.suspendedLanes|=r,s.pingedLanes&=~r,u&&(s.warmLanes|=r),u=s.expirationTimes;for(var f=r;0<f;){var m=31-z(f),v=1<<m;u[m]=-1,f&=~v}l!==0&&rn(s,l,r)}function Kd(){return(Rt&6)===0?(Uc(0),!1):!0}function _p(){if(gt!==null){if(Pt===0)var s=gt.return;else s=gt,rr=Ji=null,Um(s),Zl=null,wc=0,s=gt;for(;s!==null;)wy(s.alternate,s),s=s.return;gt=null}}function co(s,r){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,hE(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),xr=0,_p(),$t=s,gt=l=nr(s.current,null),yt=r,Pt=0,Dn=null,Jr=!1,io=ot(s,r),gp=!1,lo=Mn=bp=ll=Zr=os=0,fn=Vc=null,yp=!1,(r&8)!==0&&(r|=r&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=r;0<u;){var f=31-z(u),m=1<<f;r|=s[f],u&=~m}return pr=r,gd(),l}function Hy(s,r){ft=null,O.H=kc,r===Jl||r===Sd?(r=lb(),Pt=3):r===Tm?(r=lb(),Pt=4):Pt=r===tp?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Dn=r,gt===null&&(os=1,Ud(s,Hn(r,s.current)))}function Gy(){var s=Rn.current;return s===null?!0:(yt&4194048)===yt?Qn===null:(yt&62914560)===yt||(yt&536870912)!==0?s===Qn:!1}function Yy(){var s=O.H;return O.H=kc,s===null?kc:s}function Wy(){var s=O.A;return O.A=qS,s}function Xd(){os=4,Jr||(yt&4194048)!==yt&&Rn.current!==null||(io=!0),(Zr&134217727)===0&&(ll&134217727)===0||$t===null||si($t,yt,Mn,!1)}function jp(s,r,l){var u=Rt;Rt|=2;var f=Yy(),m=Wy();($t!==s||yt!==r)&&(Qd=null,co(s,r)),r=!1;var v=os;e:do try{if(Pt!==0&&gt!==null){var k=gt,$=Dn;switch(Pt){case 8:_p(),v=6;break e;case 3:case 2:case 9:case 6:Rn.current===null&&(r=!0);var te=Pt;if(Pt=0,Dn=null,uo(s,k,$,te),l&&io){v=0;break e}break;default:te=Pt,Pt=0,Dn=null,uo(s,k,$,te)}}YS(),v=os;break}catch(he){Hy(s,he)}while(!0);return r&&s.shellSuspendCounter++,rr=Ji=null,Rt=u,O.H=f,O.A=m,gt===null&&($t=null,yt=0,gd()),v}function YS(){for(;gt!==null;)Qy(gt)}function WS(s,r){var l=Rt;Rt|=2;var u=Yy(),f=Wy();$t!==s||yt!==r?(Qd=null,Wd=Fe()+500,co(s,r)):io=ot(s,r);e:do try{if(Pt!==0&&gt!==null){r=gt;var m=Dn;t:switch(Pt){case 1:Pt=0,Dn=null,uo(s,r,m,1);break;case 2:case 9:if(rb(m)){Pt=0,Dn=null,Ky(r);break}r=function(){Pt!==2&&Pt!==9||$t!==s||(Pt=7),za(s)},m.then(r,r);break e;case 3:Pt=7;break e;case 4:Pt=5;break e;case 7:rb(m)?(Pt=0,Dn=null,Ky(r)):(Pt=0,Dn=null,uo(s,r,m,7));break;case 5:var v=null;switch(gt.tag){case 26:v=gt.memoizedState;case 5:case 27:var k=gt;if(v?Ov(v):k.stateNode.complete){Pt=0,Dn=null;var $=k.sibling;if($!==null)gt=$;else{var te=k.return;te!==null?(gt=te,Jd(te)):gt=null}break t}}Pt=0,Dn=null,uo(s,r,m,5);break;case 6:Pt=0,Dn=null,uo(s,r,m,6);break;case 8:_p(),os=6;break e;default:throw Error(i(462))}}QS();break}catch(he){Hy(s,he)}while(!0);return rr=Ji=null,O.H=u,O.A=f,Rt=l,gt!==null?0:($t=null,yt=0,gd(),os)}function QS(){for(;gt!==null&&!pe();)Qy(gt)}function Qy(s){var r=yy(s.alternate,s,pr);s.memoizedProps=s.pendingProps,r===null?Jd(s):gt=r}function Ky(s){var r=s,l=r.alternate;switch(r.tag){case 15:case 0:r=fy(l,r,r.pendingProps,r.type,void 0,yt);break;case 11:r=fy(l,r,r.pendingProps,r.type.render,r.ref,yt);break;case 5:Um(r);default:wy(l,r),r=gt=Wg(r,pr),r=yy(l,r,pr)}s.memoizedProps=s.pendingProps,r===null?Jd(s):gt=r}function uo(s,r,l,u){rr=Ji=null,Um(r),Zl=null,wc=0;var f=r.return;try{if(VS(s,f,r,l,yt)){os=1,Ud(s,Hn(l,s.current)),gt=null;return}}catch(m){if(f!==null)throw gt=f,m;os=1,Ud(s,Hn(l,s.current)),gt=null;return}r.flags&32768?(jt||u===1?s=!0:io||(yt&536870912)!==0?s=!1:(Jr=s=!0,(u===2||u===9||u===3||u===6)&&(u=Rn.current,u!==null&&u.tag===13&&(u.flags|=16384))),Xy(r,s)):Jd(r)}function Jd(s){var r=s;do{if((r.flags&32768)!==0){Xy(r,Jr);return}s=r.return;var l=BS(r.alternate,r,pr);if(l!==null){gt=l;return}if(r=r.sibling,r!==null){gt=r;return}gt=r=s}while(r!==null);os===0&&(os=5)}function Xy(s,r){do{var l=zS(s.alternate,s);if(l!==null){l.flags&=32767,gt=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(s=s.sibling,s!==null)){gt=s;return}gt=s=l}while(s!==null);os=6,gt=null}function Jy(s,r,l,u,f,m,v,k,$){s.cancelPendingCommit=null;do Zd();while(ks!==0);if((Rt&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=hm,an(s,l,m,v,k,$),s===$t&&(gt=$t=null,yt=0),oo=r,ti=s,xr=l,vp=m,wp=f,zy=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,ZS(es,function(){return nv(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=O.T,O.T=null,f=K.p,K.p=2,v=Rt,Rt|=4;try{FS(s,r,l)}finally{Rt=v,K.p=f,O.T=u}}ks=1,Zy(),ev(),tv()}}function Zy(){if(ks===1){ks=0;var s=ti,r=oo,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=O.T,O.T=null;var u=K.p;K.p=2;var f=Rt;Rt|=4;try{Dy(r,s);var m=Pp,v=Ug(s.containerInfo),k=m.focusedElem,$=m.selectionRange;if(v!==k&&k&&k.ownerDocument&&Lg(k.ownerDocument.documentElement,k)){if($!==null&&lm(k)){var te=$.start,he=$.end;if(he===void 0&&(he=te),"selectionStart"in k)k.selectionStart=te,k.selectionEnd=Math.min(he,k.value.length);else{var ve=k.ownerDocument||document,se=ve&&ve.defaultView||window;if(se.getSelection){var ce=se.getSelection(),Be=k.textContent.length,et=Math.min($.start,Be),Ft=$.end===void 0?et:Math.min($.end,Be);!ce.extend&&et>Ft&&(v=Ft,Ft=et,et=v);var X=Vg(k,et),G=Vg(k,Ft);if(X&&G&&(ce.rangeCount!==1||ce.anchorNode!==X.node||ce.anchorOffset!==X.offset||ce.focusNode!==G.node||ce.focusOffset!==G.offset)){var ee=ve.createRange();ee.setStart(X.node,X.offset),ce.removeAllRanges(),et>Ft?(ce.addRange(ee),ce.extend(G.node,G.offset)):(ee.setEnd(G.node,G.offset),ce.addRange(ee))}}}}for(ve=[],ce=k;ce=ce.parentNode;)ce.nodeType===1&&ve.push({element:ce,left:ce.scrollLeft,top:ce.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<ve.length;k++){var xe=ve[k];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}dh=!!Op,Pp=Op=null}finally{Rt=f,K.p=u,O.T=l}}s.current=r,ks=2}}function ev(){if(ks===2){ks=0;var s=ti,r=oo,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=O.T,O.T=null;var u=K.p;K.p=2;var f=Rt;Rt|=4;try{Ay(s,r.alternate,r)}finally{Rt=f,K.p=u,O.T=l}}ks=3}}function tv(){if(ks===4||ks===3){ks=0,Ke();var s=ti,r=oo,l=xr,u=zy;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?ks=5:(ks=0,oo=ti=null,sv(s,s.pendingLanes));var f=s.pendingLanes;if(f===0&&(ei=null),as(l),r=r.stateNode,Lt&&typeof Lt.onCommitFiberRoot=="function")try{Lt.onCommitFiberRoot(xs,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=O.T,f=K.p,K.p=2,O.T=null;try{for(var m=s.onRecoverableError,v=0;v<u.length;v++){var k=u[v];m(k.value,{componentStack:k.stack})}}finally{O.T=r,K.p=f}}(xr&3)!==0&&Zd(),za(s),f=s.pendingLanes,(l&261930)!==0&&(f&42)!==0?s===Np?Lc++:(Lc=0,Np=s):Lc=0,Uc(0)}}function sv(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,yc(r)))}function Zd(){return Zy(),ev(),tv(),nv()}function nv(){if(ks!==5)return!1;var s=ti,r=vp;vp=0;var l=as(xr),u=O.T,f=K.p;try{K.p=32>l?32:l,O.T=null,l=wp,wp=null;var m=ti,v=xr;if(ks=0,oo=ti=null,xr=0,(Rt&6)!==0)throw Error(i(331));var k=Rt;if(Rt|=4,Ly(m.current),Oy(m,m.current,v,l),Rt=k,Uc(0,!1),Lt&&typeof Lt.onPostCommitFiberRoot=="function")try{Lt.onPostCommitFiberRoot(xs,m)}catch{}return!0}finally{K.p=f,O.T=u,sv(s,r)}}function av(s,r,l){r=Hn(l,r),r=ep(s.stateNode,r,2),s=Wr(s,r,2),s!==null&&(Kt(s,2),za(s))}function Vt(s,r,l){if(s.tag===3)av(s,s,l);else for(;r!==null;){if(r.tag===3){av(r,s,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ei===null||!ei.has(u))){s=Hn(l,s),l=ry(2),u=Wr(r,l,2),u!==null&&(iy(l,u,r,s),Kt(u,2),za(u));break}}r=r.return}}function Sp(s,r,l){var u=s.pingCache;if(u===null){u=s.pingCache=new HS;var f=new Set;u.set(r,f)}else f=u.get(r),f===void 0&&(f=new Set,u.set(r,f));f.has(l)||(gp=!0,f.add(l),s=KS.bind(null,s,r,l),r.then(s,s))}function KS(s,r,l){var u=s.pingCache;u!==null&&u.delete(r),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,$t===s&&(yt&l)===l&&(os===4||os===3&&(yt&62914560)===yt&&300>Fe()-Yd?(Rt&2)===0&&co(s,0):bp|=l,lo===yt&&(lo=0)),za(s)}function rv(s,r){r===0&&(r=qe()),s=Qi(s,r),s!==null&&(Kt(s,r),za(s))}function XS(s){var r=s.memoizedState,l=0;r!==null&&(l=r.retryLane),rv(s,l)}function JS(s,r){var l=0;switch(s.tag){case 31:case 13:var u=s.stateNode,f=s.memoizedState;f!==null&&(l=f.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),rv(s,l)}function ZS(s,r){return Ce(s,r)}var eh=null,ho=null,Ep=!1,th=!1,Tp=!1,ni=0;function za(s){s!==ho&&s.next===null&&(ho===null?eh=ho=s:ho=ho.next=s),th=!0,Ep||(Ep=!0,tE())}function Uc(s,r){if(!Tp&&th){Tp=!0;do for(var l=!1,u=eh;u!==null;){if(s!==0){var f=u.pendingLanes;if(f===0)var m=0;else{var v=u.suspendedLanes,k=u.pingedLanes;m=(1<<31-z(42|s)+1)-1,m&=f&~(v&~k),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(l=!0,cv(u,m))}else m=yt,m=$e(u,u===$t?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(m&3)===0||ot(u,m)||(l=!0,cv(u,m));u=u.next}while(l);Tp=!1}}function eE(){iv()}function iv(){th=Ep=!1;var s=0;ni!==0&&dE()&&(s=ni);for(var r=Fe(),l=null,u=eh;u!==null;){var f=u.next,m=lv(u,r);m===0?(u.next=null,l===null?eh=f:l.next=f,f===null&&(ho=l)):(l=u,(s!==0||(m&3)!==0)&&(th=!0)),u=f}ks!==0&&ks!==5||Uc(s),ni!==0&&(ni=0)}function lv(s,r){for(var l=s.suspendedLanes,u=s.pingedLanes,f=s.expirationTimes,m=s.pendingLanes&-62914561;0<m;){var v=31-z(m),k=1<<v,$=f[v];$===-1?((k&l)===0||(k&u)!==0)&&(f[v]=ze(k,r)):$<=r&&(s.expiredLanes|=k),m&=~k}if(r=$t,l=yt,l=$e(s,s===r?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===r&&(Pt===2||Pt===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Le(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||ot(s,l)){if(r=l&-l,r===s.callbackPriority)return r;switch(u!==null&&Le(u),as(l)){case 2:case 8:l=Qe;break;case 32:l=es;break;case 268435456:l=Sn;break;default:l=es}return u=ov.bind(null,s),l=Ce(l,u),s.callbackPriority=r,s.callbackNode=l,r}return u!==null&&u!==null&&Le(u),s.callbackPriority=2,s.callbackNode=null,2}function ov(s,r){if(ks!==0&&ks!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Zd()&&s.callbackNode!==l)return null;var u=yt;return u=$e(s,s===$t?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:($y(s,u,r),lv(s,Fe()),s.callbackNode!=null&&s.callbackNode===l?ov.bind(null,s):null)}function cv(s,r){if(Zd())return null;$y(s,r,!0)}function tE(){fE(function(){(Rt&6)!==0?Ce(We,eE):iv()})}function Ap(){if(ni===0){var s=Kl;s===0&&(s=Ue,Ue<<=1,(Ue&261888)===0&&(Ue=256)),ni=s}return ni}function uv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ol(""+s)}function dv(s,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,s.id&&l.setAttribute("form",s.id),r.parentNode.insertBefore(l,r),s=new FormData(s),l.parentNode.removeChild(l),s}function sE(s,r,l,u,f){if(r==="submit"&&l&&l.stateNode===f){var m=uv((f[ys]||null).action),v=u.submitter;v&&(r=(r=v[ys]||null)?uv(r.formAction):v.getAttribute("formAction"),r!==null&&(m=r,v=null));var k=new Ma("action","action",null,u,f);s.push({event:k,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ni!==0){var $=v?dv(f,v):new FormData(f);Wm(l,{pending:!0,data:$,method:f.method,action:m},null,$)}}else typeof m=="function"&&(k.preventDefault(),$=v?dv(f,v):new FormData(f),Wm(l,{pending:!0,data:$,method:f.method,action:m},m,$))},currentTarget:f}]})}}for(var kp=0;kp<dm.length;kp++){var Cp=dm[kp],nE=Cp.toLowerCase(),aE=Cp[0].toUpperCase()+Cp.slice(1);fa(nE,"on"+aE)}fa(Fg,"onAnimationEnd"),fa($g,"onAnimationIteration"),fa(qg,"onAnimationStart"),fa("dblclick","onDoubleClick"),fa("focusin","onFocus"),fa("focusout","onBlur"),fa(vS,"onTransitionRun"),fa(wS,"onTransitionStart"),fa(NS,"onTransitionCancel"),fa(Hg,"onTransitionEnd"),Ca("onMouseEnter",["mouseout","mouseover"]),Ca("onMouseLeave",["mouseout","mouseover"]),Ca("onPointerEnter",["pointerout","pointerover"]),Ca("onPointerLeave",["pointerout","pointerover"]),ka("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ka("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ka("onBeforeInput",["compositionend","keypress","textInput","paste"]),ka("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ka("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ka("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bc));function hv(s,r){r=(r&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],f=u.event;u=u.listeners;e:{var m=void 0;if(r)for(var v=u.length-1;0<=v;v--){var k=u[v],$=k.instance,te=k.currentTarget;if(k=k.listener,$!==m&&f.isPropagationStopped())break e;m=k,f.currentTarget=te;try{m(f)}catch(he){xd(he)}f.currentTarget=null,m=$}else for(v=0;v<u.length;v++){if(k=u[v],$=k.instance,te=k.currentTarget,k=k.listener,$!==m&&f.isPropagationStopped())break e;m=k,f.currentTarget=te;try{m(f)}catch(he){xd(he)}f.currentTarget=null,m=$}}}}function bt(s,r){var l=r[Vi];l===void 0&&(l=r[Vi]=new Set);var u=s+"__bubble";l.has(u)||(fv(r,s,2,!1),l.add(u))}function Rp(s,r,l){var u=0;r&&(u|=4),fv(l,s,u,r)}var sh="_reactListening"+Math.random().toString(36).slice(2);function Ip(s){if(!s[sh]){s[sh]=!0,Jo.forEach(function(l){l!=="selectionchange"&&(rE.has(l)||Rp(l,!1,s),Rp(l,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[sh]||(r[sh]=!0,Rp("selectionchange",!1,r))}}function fv(s,r,l,u){switch(Fv(r)){case 2:var f=DE;break;case 8:f=ME;break;default:f=Yp}l=f.bind(null,r,l,s),f=void 0,!zi||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),u?f!==void 0?s.addEventListener(r,l,{capture:!0,passive:f}):s.addEventListener(r,l,!0):f!==void 0?s.addEventListener(r,l,{passive:f}):s.addEventListener(r,l,!1)}function Dp(s,r,l,u,f){var m=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var k=u.stateNode.containerInfo;if(k===f)break;if(v===4)for(v=u.return;v!==null;){var $=v.tag;if(($===3||$===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;k!==null;){if(v=Ta(k),v===null)return;if($=v.tag,$===5||$===6||$===26||$===27){u=m=v;continue e}k=k.parentNode}}u=u.return}Lr(function(){var te=m,he=zn(l),ve=[];e:{var se=Gg.get(s);if(se!==void 0){var ce=Ma,Be=s;switch(s){case"keypress":if($i(l)===0)break e;case"keydown":case"keyup":ce=fd;break;case"focusin":Be="focus",ce=Hi;break;case"focusout":Be="blur",ce=Hi;break;case"beforeblur":case"afterblur":ce=Hi;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=dc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=ad;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=y;break;case Fg:case $g:case qg:ce=id;break;case Hg:ce=D;break;case"scroll":case"scrollend":ce=uc;break;case"wheel":ce=re;break;case"copy":case"cut":case"paste":ce=ld;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=sr;break;case"toggle":case"beforetoggle":ce=ht}var et=(r&4)!==0,Ft=!et&&(s==="scroll"||s==="scrollend"),X=et?se!==null?se+"Capture":null:se;et=[];for(var G=te,ee;G!==null;){var xe=G;if(ee=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||ee===null||X===null||(xe=ca(G,X),xe!=null&&et.push(zc(G,xe,ee))),Ft)break;G=G.return}0<et.length&&(se=new ce(se,Be,null,l,he),ve.push({event:se,listeners:et}))}}if((r&7)===0){e:{if(se=s==="mouseover"||s==="pointerover",ce=s==="mouseout"||s==="pointerout",se&&l!==lc&&(Be=l.relatedTarget||l.fromElement)&&(Ta(Be)||Be[En]))break e;if((ce||se)&&(se=he.window===he?he:(se=he.ownerDocument)?se.defaultView||se.parentWindow:window,ce?(Be=l.relatedTarget||l.toElement,ce=te,Be=Be?Ta(Be):null,Be!==null&&(Ft=c(Be),et=Be.tag,Be!==Ft||et!==5&&et!==27&&et!==6)&&(Be=null)):(ce=null,Be=te),ce!==Be)){if(et=dc,xe="onMouseLeave",X="onMouseEnter",G="mouse",(s==="pointerout"||s==="pointerover")&&(et=sr,xe="onPointerLeave",X="onPointerEnter",G="pointer"),Ft=ce==null?se:Tn(ce),ee=Be==null?se:Tn(Be),se=new et(xe,G+"leave",ce,l,he),se.target=Ft,se.relatedTarget=ee,xe=null,Ta(he)===te&&(et=new et(X,G+"enter",Be,l,he),et.target=ee,et.relatedTarget=Ft,xe=et),Ft=xe,ce&&Be)t:{for(et=iE,X=ce,G=Be,ee=0,xe=X;xe;xe=et(xe))ee++;xe=0;for(var Xe=G;Xe;Xe=et(Xe))xe++;for(;0<ee-xe;)X=et(X),ee--;for(;0<xe-ee;)G=et(G),xe--;for(;ee--;){if(X===G||G!==null&&X===G.alternate){et=X;break t}X=et(X),G=et(G)}et=null}else et=null;ce!==null&&mv(ve,se,ce,et,!1),Be!==null&&Ft!==null&&mv(ve,Ft,Be,et,!0)}}e:{if(se=te?Tn(te):window,ce=se.nodeName&&se.nodeName.toLowerCase(),ce==="select"||ce==="input"&&se.type==="file")var Tt=Rg;else if(kg(se))if(Ig)Tt=gS;else{Tt=pS;var He=mS}else ce=se.nodeName,!ce||ce.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?te&&Ml(te.elementType)&&(Tt=Rg):Tt=xS;if(Tt&&(Tt=Tt(s,te))){Cg(ve,Tt,l,he);break e}He&&He(s,se,te),s==="focusout"&&te&&se.type==="number"&&te.memoizedProps.value!=null&&ac(se,"number",se.value)}switch(He=te?Tn(te):window,s){case"focusin":(kg(He)||He.contentEditable==="true")&&(Fl=He,om=te,xc=null);break;case"focusout":xc=om=Fl=null;break;case"mousedown":cm=!0;break;case"contextmenu":case"mouseup":case"dragend":cm=!1,Bg(ve,l,he);break;case"selectionchange":if(yS)break;case"keydown":case"keyup":Bg(ve,l,he)}var mt;if(Ct)e:{switch(s){case"compositionstart":var vt="onCompositionStart";break e;case"compositionend":vt="onCompositionEnd";break e;case"compositionupdate":vt="onCompositionUpdate";break e}vt=void 0}else zl?Gi(s,l)&&(vt="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(vt="onCompositionStart");vt&&(Va&&l.locale!=="ko"&&(zl||vt!=="onCompositionStart"?vt==="onCompositionEnd"&&zl&&(mt=cc()):(Da=he,oc="value"in Da?Da.value:Da.textContent,zl=!0)),He=nh(te,vt),0<He.length&&(vt=new Pa(vt,s,null,l,he),ve.push({event:vt,listeners:He}),mt?vt.data=mt:(mt=Bl(l),mt!==null&&(vt.data=mt)))),(mt=$n?uS(s,l):dS(s,l))&&(vt=nh(te,"onBeforeInput"),0<vt.length&&(He=new Pa("onBeforeInput","beforeinput",null,l,he),ve.push({event:He,listeners:vt}),He.data=mt)),sE(ve,s,te,l,he)}hv(ve,r)})}function zc(s,r,l){return{instance:s,listener:r,currentTarget:l}}function nh(s,r){for(var l=r+"Capture",u=[];s!==null;){var f=s,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=ca(s,l),f!=null&&u.unshift(zc(s,f,m)),f=ca(s,r),f!=null&&u.push(zc(s,f,m))),s.tag===3)return u;s=s.return}return[]}function iE(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function mv(s,r,l,u,f){for(var m=r._reactName,v=[];l!==null&&l!==u;){var k=l,$=k.alternate,te=k.stateNode;if(k=k.tag,$!==null&&$===u)break;k!==5&&k!==26&&k!==27||te===null||($=te,f?(te=ca(l,m),te!=null&&v.unshift(zc(l,te,$))):f||(te=ca(l,m),te!=null&&v.push(zc(l,te,$)))),l=l.return}v.length!==0&&s.push({event:r,listeners:v})}var lE=/\r\n?/g,oE=/\u0000|\uFFFD/g;function pv(s){return(typeof s=="string"?s:""+s).replace(lE,`
`).replace(oE,"")}function xv(s,r){return r=pv(r),pv(s)===r}function zt(s,r,l,u,f,m){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||cn(s,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&cn(s,""+u);break;case"className":An(s,"class",u);break;case"tabIndex":An(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":An(s,l,u);break;case"style":ic(s,u,m);break;case"data":if(r!=="object"){An(s,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Ol(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(l==="formAction"?(r!=="input"&&zt(s,r,"name",f.name,f,null),zt(s,r,"formEncType",f.formEncType,f,null),zt(s,r,"formMethod",f.formMethod,f,null),zt(s,r,"formTarget",f.formTarget,f,null)):(zt(s,r,"encType",f.encType,f,null),zt(s,r,"method",f.method,f,null),zt(s,r,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Ol(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=oa);break;case"onScroll":u!=null&&bt("scroll",s);break;case"onScrollEnd":u!=null&&bt("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Ol(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":bt("beforetoggle",s),bt("toggle",s),Il(s,"popover",u);break;case"xlinkActuate":ws(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":ws(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":ws(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":ws(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":ws(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":ws(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":ws(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":ws(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":ws(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Il(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=nd.get(l)||l,Il(s,l,u))}}function Mp(s,r,l,u,f,m){switch(l){case"style":ic(s,u,m);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof u=="string"?cn(s,u):(typeof u=="number"||typeof u=="bigint")&&cn(s,""+u);break;case"onScroll":u!=null&&bt("scroll",s);break;case"onScrollEnd":u!=null&&bt("scrollend",s);break;case"onClick":u!=null&&(s.onclick=oa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Zo.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),r=l.slice(2,f?l.length-7:void 0),m=s[ys]||null,m=m!=null?m[l]:null,typeof m=="function"&&s.removeEventListener(r,m,f),typeof u=="function")){typeof m!="function"&&m!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(r,u,f);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Il(s,l,u)}}}function zs(s,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":bt("error",s),bt("load",s);var u=!1,f=!1,m;for(m in l)if(l.hasOwnProperty(m)){var v=l[m];if(v!=null)switch(m){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:zt(s,r,m,v,l,null)}}f&&zt(s,r,"srcSet",l.srcSet,l,null),u&&zt(s,r,"src",l.src,l,null);return;case"input":bt("invalid",s);var k=m=v=f=null,$=null,te=null;for(u in l)if(l.hasOwnProperty(u)){var he=l[u];if(he!=null)switch(u){case"name":f=he;break;case"type":v=he;break;case"checked":$=he;break;case"defaultChecked":te=he;break;case"value":m=he;break;case"defaultValue":k=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,r));break;default:zt(s,r,u,he,l,null)}}ed(s,m,k,$,te,v,f,!1);return;case"select":bt("invalid",s),u=v=m=null;for(f in l)if(l.hasOwnProperty(f)&&(k=l[f],k!=null))switch(f){case"value":m=k;break;case"defaultValue":v=k;break;case"multiple":u=k;default:zt(s,r,f,k,l,null)}r=m,l=v,s.multiple=!!u,r!=null?Mr(s,!!u,r,!1):l!=null&&Mr(s,!!u,l,!0);return;case"textarea":bt("invalid",s),m=f=u=null;for(v in l)if(l.hasOwnProperty(v)&&(k=l[v],k!=null))switch(v){case"value":u=k;break;case"defaultValue":f=k;break;case"children":m=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(i(91));break;default:zt(s,r,v,k,l,null)}Or(s,u,f,m);return;case"option":for($ in l)l.hasOwnProperty($)&&(u=l[$],u!=null)&&($==="selected"?s.selected=u&&typeof u!="function"&&typeof u!="symbol":zt(s,r,$,u,l,null));return;case"dialog":bt("beforetoggle",s),bt("toggle",s),bt("cancel",s),bt("close",s);break;case"iframe":case"object":bt("load",s);break;case"video":case"audio":for(u=0;u<Bc.length;u++)bt(Bc[u],s);break;case"image":bt("error",s),bt("load",s);break;case"details":bt("toggle",s);break;case"embed":case"source":case"link":bt("error",s),bt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in l)if(l.hasOwnProperty(te)&&(u=l[te],u!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:zt(s,r,te,u,l,null)}return;default:if(Ml(r)){for(he in l)l.hasOwnProperty(he)&&(u=l[he],u!==void 0&&Mp(s,r,he,u,l,void 0));return}}for(k in l)l.hasOwnProperty(k)&&(u=l[k],u!=null&&zt(s,r,k,u,l,null))}function cE(s,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,v=null,k=null,$=null,te=null,he=null;for(ce in l){var ve=l[ce];if(l.hasOwnProperty(ce)&&ve!=null)switch(ce){case"checked":break;case"value":break;case"defaultValue":$=ve;default:u.hasOwnProperty(ce)||zt(s,r,ce,null,u,ve)}}for(var se in u){var ce=u[se];if(ve=l[se],u.hasOwnProperty(se)&&(ce!=null||ve!=null))switch(se){case"type":m=ce;break;case"name":f=ce;break;case"checked":te=ce;break;case"defaultChecked":he=ce;break;case"value":v=ce;break;case"defaultValue":k=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,r));break;default:ce!==ve&&zt(s,r,se,ce,u,ve)}}Dl(s,v,k,$,te,he,m,f);return;case"select":ce=v=k=se=null;for(m in l)if($=l[m],l.hasOwnProperty(m)&&$!=null)switch(m){case"value":break;case"multiple":ce=$;default:u.hasOwnProperty(m)||zt(s,r,m,null,u,$)}for(f in u)if(m=u[f],$=l[f],u.hasOwnProperty(f)&&(m!=null||$!=null))switch(f){case"value":se=m;break;case"defaultValue":k=m;break;case"multiple":v=m;default:m!==$&&zt(s,r,f,m,u,$)}r=k,l=v,u=ce,se!=null?Mr(s,!!l,se,!1):!!u!=!!l&&(r!=null?Mr(s,!!l,r,!0):Mr(s,!!l,l?[]:"",!1));return;case"textarea":ce=se=null;for(k in l)if(f=l[k],l.hasOwnProperty(k)&&f!=null&&!u.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:zt(s,r,k,null,u,f)}for(v in u)if(f=u[v],m=l[v],u.hasOwnProperty(v)&&(f!=null||m!=null))switch(v){case"value":se=f;break;case"defaultValue":ce=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&zt(s,r,v,f,u,m)}td(s,se,ce);return;case"option":for(var Be in l)se=l[Be],l.hasOwnProperty(Be)&&se!=null&&!u.hasOwnProperty(Be)&&(Be==="selected"?s.selected=!1:zt(s,r,Be,null,u,se));for($ in u)se=u[$],ce=l[$],u.hasOwnProperty($)&&se!==ce&&(se!=null||ce!=null)&&($==="selected"?s.selected=se&&typeof se!="function"&&typeof se!="symbol":zt(s,r,$,se,u,ce));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var et in l)se=l[et],l.hasOwnProperty(et)&&se!=null&&!u.hasOwnProperty(et)&&zt(s,r,et,null,u,se);for(te in u)if(se=u[te],ce=l[te],u.hasOwnProperty(te)&&se!==ce&&(se!=null||ce!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:zt(s,r,te,se,u,ce)}return;default:if(Ml(r)){for(var Ft in l)se=l[Ft],l.hasOwnProperty(Ft)&&se!==void 0&&!u.hasOwnProperty(Ft)&&Mp(s,r,Ft,void 0,u,se);for(he in u)se=u[he],ce=l[he],!u.hasOwnProperty(he)||se===ce||se===void 0&&ce===void 0||Mp(s,r,he,se,u,ce);return}}for(var X in l)se=l[X],l.hasOwnProperty(X)&&se!=null&&!u.hasOwnProperty(X)&&zt(s,r,X,null,u,se);for(ve in u)se=u[ve],ce=l[ve],!u.hasOwnProperty(ve)||se===ce||se==null&&ce==null||zt(s,r,ve,se,u,ce)}function gv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function uE(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var f=l[u],m=f.transferSize,v=f.initiatorType,k=f.duration;if(m&&k&&gv(v)){for(v=0,k=f.responseEnd,u+=1;u<l.length;u++){var $=l[u],te=$.startTime;if(te>k)break;var he=$.transferSize,ve=$.initiatorType;he&&gv(ve)&&($=$.responseEnd,v+=he*($<k?1:(k-te)/($-te)))}if(--u,r+=8*(m+v)/(f.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Op=null,Pp=null;function ah(s){return s.nodeType===9?s:s.ownerDocument}function bv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yv(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function Vp(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Lp=null;function dE(){var s=window.event;return s&&s.type==="popstate"?s===Lp?!1:(Lp=s,!0):(Lp=null,!1)}var vv=typeof setTimeout=="function"?setTimeout:void 0,hE=typeof clearTimeout=="function"?clearTimeout:void 0,wv=typeof Promise=="function"?Promise:void 0,fE=typeof queueMicrotask=="function"?queueMicrotask:typeof wv<"u"?function(s){return wv.resolve(null).then(s).catch(mE)}:vv;function mE(s){setTimeout(function(){throw s})}function ai(s){return s==="head"}function Nv(s,r){var l=r,u=0;do{var f=l.nextSibling;if(s.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"||l==="/&"){if(u===0){s.removeChild(f),xo(r);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")Fc(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,Fc(l);for(var m=l.firstChild;m;){var v=m.nextSibling,k=m.nodeName;m[Ea]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&m.rel.toLowerCase()==="stylesheet"||l.removeChild(m),m=v}}else l==="body"&&Fc(s.ownerDocument.body);l=f}while(l);xo(r)}function _v(s,r){var l=s;s=0;do{var u=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=u}while(l)}function Up(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Up(l),Rl(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function pE(s,r,l,u){for(;s.nodeType===1;){var f=l;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Ea])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(m=s.getAttribute("rel"),m==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(m!==f.rel||s.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||s.getAttribute("title")!==(f.title==null?null:f.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(m=s.getAttribute("src"),(m!==(f.src==null?null:f.src)||s.getAttribute("type")!==(f.type==null?null:f.type)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&s.getAttribute("name")===m)return s}else return s;if(s=Kn(s.nextSibling),s===null)break}return null}function xE(s,r,l){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Kn(s.nextSibling),s===null))return null;return s}function jv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=Kn(s.nextSibling),s===null))return null;return s}function Bp(s){return s.data==="$?"||s.data==="$~"}function zp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function gE(s,r){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||l.readyState!=="loading")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function Kn(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var Fp=null;function Sv(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(r===0)return Kn(s.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}s=s.nextSibling}return null}function Ev(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return s;r--}else l!=="/$"&&l!=="/&"||r++}s=s.previousSibling}return null}function Tv(s,r,l){switch(r=ah(l),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Fc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Rl(s)}var Xn=new Map,Av=new Set;function rh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var gr=K.d;K.d={f:bE,r:yE,D:vE,C:wE,L:NE,m:_E,X:SE,S:jE,M:EE};function bE(){var s=gr.f(),r=Kd();return s||r}function yE(s){var r=Bn(s);r!==null&&r.tag===5&&r.type==="form"?Hb(r):gr.r(s)}var fo=typeof document>"u"?null:document;function kv(s,r,l){var u=fo;if(u&&typeof r=="string"&&r){var f=on(r);f='link[rel="'+s+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),Av.has(f)||(Av.add(f),s={rel:s,crossOrigin:l,href:r},u.querySelector(f)===null&&(r=u.createElement("link"),zs(r,"link",s),vs(r),u.head.appendChild(r)))}}function vE(s){gr.D(s),kv("dns-prefetch",s,null)}function wE(s,r){gr.C(s,r),kv("preconnect",s,r)}function NE(s,r,l){gr.L(s,r,l);var u=fo;if(u&&s&&r){var f='link[rel="preload"][as="'+on(r)+'"]';r==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+on(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+on(l.imageSizes)+'"]')):f+='[href="'+on(s)+'"]';var m=f;switch(r){case"style":m=mo(s);break;case"script":m=po(s)}Xn.has(m)||(s=w({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:s,as:r},l),Xn.set(m,s),u.querySelector(f)!==null||r==="style"&&u.querySelector($c(m))||r==="script"&&u.querySelector(qc(m))||(r=u.createElement("link"),zs(r,"link",s),vs(r),u.head.appendChild(r)))}}function _E(s,r){gr.m(s,r);var l=fo;if(l&&s){var u=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+on(u)+'"][href="'+on(s)+'"]',m=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=po(s)}if(!Xn.has(m)&&(s=w({rel:"modulepreload",href:s},r),Xn.set(m,s),l.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(qc(m)))return}u=l.createElement("link"),zs(u,"link",s),vs(u),l.head.appendChild(u)}}}function jE(s,r,l){gr.S(s,r,l);var u=fo;if(u&&s){var f=Aa(u).hoistableStyles,m=mo(s);r=r||"default";var v=f.get(m);if(!v){var k={loading:0,preload:null};if(v=u.querySelector($c(m)))k.loading=5;else{s=w({rel:"stylesheet",href:s,"data-precedence":r},l),(l=Xn.get(m))&&$p(s,l);var $=v=u.createElement("link");vs($),zs($,"link",s),$._p=new Promise(function(te,he){$.onload=te,$.onerror=he}),$.addEventListener("load",function(){k.loading|=1}),$.addEventListener("error",function(){k.loading|=2}),k.loading|=4,ih(v,r,u)}v={type:"stylesheet",instance:v,count:1,state:k},f.set(m,v)}}}function SE(s,r){gr.X(s,r);var l=fo;if(l&&s){var u=Aa(l).hoistableScripts,f=po(s),m=u.get(f);m||(m=l.querySelector(qc(f)),m||(s=w({src:s,async:!0},r),(r=Xn.get(f))&&qp(s,r),m=l.createElement("script"),vs(m),zs(m,"link",s),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(f,m))}}function EE(s,r){gr.M(s,r);var l=fo;if(l&&s){var u=Aa(l).hoistableScripts,f=po(s),m=u.get(f);m||(m=l.querySelector(qc(f)),m||(s=w({src:s,async:!0,type:"module"},r),(r=Xn.get(f))&&qp(s,r),m=l.createElement("script"),vs(m),zs(m,"link",s),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(f,m))}}function Cv(s,r,l,u){var f=(f=De.current)?rh(f):null;if(!f)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=mo(l.href),l=Aa(f).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=mo(l.href);var m=Aa(f).hoistableStyles,v=m.get(s);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(s,v),(m=f.querySelector($c(s)))&&!m._p&&(v.instance=m,v.state.loading=5),Xn.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Xn.set(s,l),m||TE(f,s,l,v.state))),r&&u===null)throw Error(i(528,""));return v}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=po(l),l=Aa(f).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function mo(s){return'href="'+on(s)+'"'}function $c(s){return'link[rel="stylesheet"]['+s+"]"}function Rv(s){return w({},s,{"data-precedence":s.precedence,precedence:null})}function TE(s,r,l,u){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=s.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),zs(r,"link",l),vs(r),s.head.appendChild(r))}function po(s){return'[src="'+on(s)+'"]'}function qc(s){return"script[async]"+s}function Iv(s,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=s.querySelector('style[data-href~="'+on(l.href)+'"]');if(u)return r.instance=u,vs(u),u;var f=w({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),vs(u),zs(u,"style",f),ih(u,l.precedence,s),r.instance=u;case"stylesheet":f=mo(l.href);var m=s.querySelector($c(f));if(m)return r.state.loading|=4,r.instance=m,vs(m),m;u=Rv(l),(f=Xn.get(f))&&$p(u,f),m=(s.ownerDocument||s).createElement("link"),vs(m);var v=m;return v._p=new Promise(function(k,$){v.onload=k,v.onerror=$}),zs(m,"link",u),r.state.loading|=4,ih(m,l.precedence,s),r.instance=m;case"script":return m=po(l.src),(f=s.querySelector(qc(m)))?(r.instance=f,vs(f),f):(u=l,(f=Xn.get(m))&&(u=w({},l),qp(u,f)),s=s.ownerDocument||s,f=s.createElement("script"),vs(f),zs(f,"link",u),s.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,ih(u,l.precedence,s));return r.instance}function ih(s,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,m=f,v=0;v<u.length;v++){var k=u[v];if(k.dataset.precedence===r)m=k;else if(m!==f)break}m?m.parentNode.insertBefore(s,m.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(s,r.firstChild))}function $p(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function qp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var lh=null;function Dv(s,r,l){if(lh===null){var u=new Map,f=lh=new Map;f.set(l,u)}else f=lh,u=f.get(l),u||(u=new Map,f.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),f=0;f<l.length;f++){var m=l[f];if(!(m[Ea]||m[is]||s==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var v=m.getAttribute(r)||"";v=s+v;var k=u.get(v);k?k.push(m):u.set(v,[m])}}return u}function Mv(s,r,l){s=s.ownerDocument||s,s.head.insertBefore(l,r==="title"?s.querySelector("head > title"):null)}function AE(s,r,l){if(l===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(s=r.disabled,typeof r.precedence=="string"&&s==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Ov(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function kE(s,r,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var f=mo(u.href),m=r.querySelector($c(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=oh.bind(s),r.then(s,s)),l.state.loading|=4,l.instance=m,vs(m);return}m=r.ownerDocument||r,u=Rv(u),(f=Xn.get(f))&&$p(u,f),m=m.createElement("link"),vs(m);var v=m;v._p=new Promise(function(k,$){v.onload=k,v.onerror=$}),zs(m,"link",u),l.instance=m}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=oh.bind(s),r.addEventListener("load",l),r.addEventListener("error",l))}}var Hp=0;function CE(s,r){return s.stylesheets&&s.count===0&&uh(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var u=setTimeout(function(){if(s.stylesheets&&uh(s,s.stylesheets),s.unsuspend){var m=s.unsuspend;s.unsuspend=null,m()}},6e4+r);0<s.imgBytes&&Hp===0&&(Hp=62500*uE());var f=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&uh(s,s.stylesheets),s.unsuspend)){var m=s.unsuspend;s.unsuspend=null,m()}},(s.imgBytes>Hp?50:800)+r);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(f)}}:null}function oh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)uh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var ch=null;function uh(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,ch=new Map,r.forEach(RE,s),ch=null,oh.call(s))}function RE(s,r){if(!(r.state.loading&4)){var l=ch.get(s);if(l)var u=l.get(null);else{l=new Map,ch.set(s,l);for(var f=s.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var v=f[m];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(l.set(v.dataset.precedence,v),u=v)}u&&l.set(null,u)}f=r.instance,v=f.getAttribute("data-precedence"),m=l.get(v)||u,m===u&&l.set(null,f),l.set(v,f),this.count++,u=oh.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),m?m.parentNode.insertBefore(f,m.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(f,s.firstChild)),r.state.loading|=4}}var Hc={$$typeof:H,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function IE(s,r,l,u,f,m,v,k,$){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=kt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kt(0),this.hiddenUpdates=kt(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=$,this.incompleteTransitions=new Map}function Pv(s,r,l,u,f,m,v,k,$,te,he,ve){return s=new IE(s,r,l,v,$,te,he,ve,k),r=1,m===!0&&(r|=24),m=Cn(3,null,null,r),s.current=m,m.stateNode=s,r=jm(),r.refCount++,s.pooledCache=r,r.refCount++,m.memoizedState={element:u,isDehydrated:l,cache:r},Am(m),s}function Vv(s){return s?(s=Hl,s):Hl}function Lv(s,r,l,u,f,m){f=Vv(f),u.context===null?u.context=f:u.pendingContext=f,u=Yr(r),u.payload={element:l},m=m===void 0?null:m,m!==null&&(u.callback=m),l=Wr(s,u,r),l!==null&&(mn(l,s,r),_c(l,s,r))}function Uv(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<r?l:r}}function Gp(s,r){Uv(s,r),(s=s.alternate)&&Uv(s,r)}function Bv(s){if(s.tag===13||s.tag===31){var r=Qi(s,67108864);r!==null&&mn(r,s,67108864),Gp(s,67108864)}}function zv(s){if(s.tag===13||s.tag===31){var r=On();r=la(r);var l=Qi(s,r);l!==null&&mn(l,s,r),Gp(s,r)}}var dh=!0;function DE(s,r,l,u){var f=O.T;O.T=null;var m=K.p;try{K.p=2,Yp(s,r,l,u)}finally{K.p=m,O.T=f}}function ME(s,r,l,u){var f=O.T;O.T=null;var m=K.p;try{K.p=8,Yp(s,r,l,u)}finally{K.p=m,O.T=f}}function Yp(s,r,l,u){if(dh){var f=Wp(u);if(f===null)Dp(s,r,u,hh,l),$v(s,u);else if(PE(f,s,r,l,u))u.stopPropagation();else if($v(s,u),r&4&&-1<OE.indexOf(s)){for(;f!==null;){var m=Bn(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var v=ke(m.pendingLanes);if(v!==0){var k=m;for(k.pendingLanes|=2,k.entangledLanes|=2;v;){var $=1<<31-z(v);k.entanglements[1]|=$,v&=~$}za(m),(Rt&6)===0&&(Wd=Fe()+500,Uc(0))}}break;case 31:case 13:k=Qi(m,2),k!==null&&mn(k,m,2),Kd(),Gp(m,2)}if(m=Wp(u),m===null&&Dp(s,r,u,hh,l),m===f)break;f=m}f!==null&&u.stopPropagation()}else Dp(s,r,u,null,l)}}function Wp(s){return s=zn(s),Qp(s)}var hh=null;function Qp(s){if(hh=null,s=Ta(s),s!==null){var r=c(s);if(r===null)s=null;else{var l=r.tag;if(l===13){if(s=d(r),s!==null)return s;s=null}else if(l===31){if(s=p(r),s!==null)return s;s=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return hh=s,null}function Fv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Oe()){case We:return 2;case Qe:return 8;case es:case nn:return 32;case Sn:return 268435456;default:return 32}default:return 32}}var Kp=!1,ri=null,ii=null,li=null,Gc=new Map,Yc=new Map,oi=[],OE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $v(s,r){switch(s){case"focusin":case"focusout":ri=null;break;case"dragenter":case"dragleave":ii=null;break;case"mouseover":case"mouseout":li=null;break;case"pointerover":case"pointerout":Gc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yc.delete(r.pointerId)}}function Wc(s,r,l,u,f,m){return s===null||s.nativeEvent!==m?(s={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:m,targetContainers:[f]},r!==null&&(r=Bn(r),r!==null&&Bv(r)),s):(s.eventSystemFlags|=u,r=s.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),s)}function PE(s,r,l,u,f){switch(r){case"focusin":return ri=Wc(ri,s,r,l,u,f),!0;case"dragenter":return ii=Wc(ii,s,r,l,u,f),!0;case"mouseover":return li=Wc(li,s,r,l,u,f),!0;case"pointerover":var m=f.pointerId;return Gc.set(m,Wc(Gc.get(m)||null,s,r,l,u,f)),!0;case"gotpointercapture":return m=f.pointerId,Yc.set(m,Wc(Yc.get(m)||null,s,r,l,u,f)),!0}return!1}function qv(s){var r=Ta(s.target);if(r!==null){var l=c(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){s.blockedOn=r,bs(s.priority,function(){zv(l)});return}}else if(r===31){if(r=p(l),r!==null){s.blockedOn=r,bs(s.priority,function(){zv(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function fh(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var l=Wp(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);lc=u,l.target.dispatchEvent(u),lc=null}else return r=Bn(l),r!==null&&Bv(r),s.blockedOn=l,!1;r.shift()}return!0}function Hv(s,r,l){fh(s)&&l.delete(r)}function VE(){Kp=!1,ri!==null&&fh(ri)&&(ri=null),ii!==null&&fh(ii)&&(ii=null),li!==null&&fh(li)&&(li=null),Gc.forEach(Hv),Yc.forEach(Hv)}function mh(s,r){s.blockedOn===r&&(s.blockedOn=null,Kp||(Kp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,VE)))}var ph=null;function Gv(s){ph!==s&&(ph=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ph===s&&(ph=null);for(var r=0;r<s.length;r+=3){var l=s[r],u=s[r+1],f=s[r+2];if(typeof u!="function"){if(Qp(u||l)===null)continue;break}var m=Bn(l);m!==null&&(s.splice(r,3),r-=3,Wm(m,{pending:!0,data:f,method:l.method,action:u},u,f))}}))}function xo(s){function r($){return mh($,s)}ri!==null&&mh(ri,s),ii!==null&&mh(ii,s),li!==null&&mh(li,s),Gc.forEach(r),Yc.forEach(r);for(var l=0;l<oi.length;l++){var u=oi[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<oi.length&&(l=oi[0],l.blockedOn===null);)qv(l),l.blockedOn===null&&oi.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var f=l[u],m=l[u+1],v=f[ys]||null;if(typeof m=="function")v||Gv(l);else if(v){var k=null;if(m&&m.hasAttribute("formAction")){if(f=m,v=m[ys]||null)k=v.formAction;else if(Qp(f)!==null)continue}else k=v.action;typeof k=="function"?l[u+1]=k:(l.splice(u,3),u-=3),Gv(l)}}}function Yv(){function s(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,f=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function Xp(s){this._internalRoot=s}xh.prototype.render=Xp.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,u=On();Lv(l,u,s,r,null,null)},xh.prototype.unmount=Xp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;Lv(s.current,2,null,s,null,null),Kd(),r[En]=null}};function xh(s){this._internalRoot=s}xh.prototype.unstable_scheduleHydration=function(s){if(s){var r=Pi();s={blockedOn:null,target:s,priority:r};for(var l=0;l<oi.length&&r!==0&&r<oi[l].priority;l++);oi.splice(l,0,s),l===0&&qv(s)}};var Wv=e.version;if(Wv!=="19.2.4")throw Error(i(527,Wv,"19.2.4"));K.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=g(r),s=s!==null?b(s):null,s=s===null?null:s.stateNode,s};var LE={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gh.isDisabled&&gh.supportsFiber)try{xs=gh.inject(LE),Lt=gh}catch{}}return Kc.createRoot=function(s,r){if(!o(s))throw Error(i(299));var l=!1,u="",f=ty,m=sy,v=ny;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(v=r.onRecoverableError)),r=Pv(s,1,!1,null,null,l,u,null,f,m,v,Yv),s[En]=r.current,Ip(s),new Xp(r)},Kc.hydrateRoot=function(s,r,l){if(!o(s))throw Error(i(299));var u=!1,f="",m=ty,v=sy,k=ny,$=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(k=l.onRecoverableError),l.formState!==void 0&&($=l.formState)),r=Pv(s,1,!0,r,l??null,u,f,$,m,v,k,Yv),r.context=Vv(null),l=r.current,u=On(),u=la(u),f=Yr(u),f.callback=null,Wr(l,f,u),l=u,r.current.lanes=l,Kt(r,l),za(r),s[En]=r.current,Ip(s),new xh(r)},Kc.version="19.2.4",Kc}var aw;function WE(){if(aw)return e0.exports;aw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),e0.exports=YE(),e0.exports}var QE=WE();const KE=mx(QE);var rw="popstate";function XE(n={}){function e(o,c){let{pathname:d="/",search:p="",hash:x=""}=jl(o.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),k0("",{pathname:d,search:p,hash:x},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function t(o,c){let d=o.document.querySelector("base"),p="";if(d&&d.getAttribute("href")){let x=o.location.href,g=x.indexOf("#");p=g===-1?x:x.slice(0,g)}return p+"#"+(typeof c=="string"?c:wu(c))}function i(o,c){aa(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(c)})`)}return ZE(e,t,i,n)}function ns(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function aa(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function JE(){return Math.random().toString(36).substring(2,10)}function iw(n,e){return{usr:n.state,key:n.key,idx:e}}function k0(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?jl(e):e,state:t,key:e&&e.key||i||JE()}}function wu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function jl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function ZE(n,e,t,i={}){let{window:o=document.defaultView,v5Compat:c=!1}=i,d=o.history,p="POP",x=null,g=b();g==null&&(g=0,d.replaceState({...d.state,idx:g},""));function b(){return(d.state||{idx:null}).idx}function w(){p="POP";let F=b(),q=F==null?null:F-g;g=F,x&&x({action:p,location:V.location,delta:q})}function _(F,q){p="PUSH";let Q=k0(V.location,F,q);t&&t(Q,F),g=b()+1;let H=iw(Q,g),ie=V.createHref(Q);try{d.pushState(H,"",ie)}catch(le){if(le instanceof DOMException&&le.name==="DataCloneError")throw le;o.location.assign(ie)}c&&x&&x({action:p,location:V.location,delta:1})}function A(F,q){p="REPLACE";let Q=k0(V.location,F,q);t&&t(Q,F),g=b();let H=iw(Q,g),ie=V.createHref(Q);d.replaceState(H,"",ie),c&&x&&x({action:p,location:V.location,delta:0})}function L(F){return eT(F)}let V={get action(){return p},get location(){return n(o,d)},listen(F){if(x)throw new Error("A history only accepts one active listener");return o.addEventListener(rw,w),x=F,()=>{o.removeEventListener(rw,w),x=null}},createHref(F){return e(o,F)},createURL:L,encodeLocation(F){let q=L(F);return{pathname:q.pathname,search:q.search,hash:q.hash}},push:_,replace:A,go(F){return d.go(F)}};return V}function eT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ns(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:wu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function kN(n,e,t="/"){return tT(n,e,t,!1)}function tT(n,e,t,i){let o=typeof e=="string"?jl(e):e,c=Sr(o.pathname||"/",t);if(c==null)return null;let d=CN(n);sT(d);let p=null;for(let x=0;p==null&&x<d.length;++x){let g=fT(c);p=dT(d[x],g,i)}return p}function CN(n,e=[],t=[],i="",o=!1){let c=(d,p,x=o,g)=>{let b={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&x)return;ns(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let w=Nr([i,b.relativePath]),_=t.concat(b);d.children&&d.children.length>0&&(ns(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),CN(d.children,e,_,w,x)),!(d.path==null&&!d.index)&&e.push({path:w,score:cT(w,d.index),routesMeta:_})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))c(d,p);else for(let x of RN(d.path))c(d,p,!0,x)}),e}function RN(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,o=t.endsWith("?"),c=t.replace(/\?$/,"");if(i.length===0)return o?[c,""]:[c];let d=RN(i.join("/")),p=[];return p.push(...d.map(x=>x===""?c:[c,x].join("/"))),o&&p.push(...d),p.map(x=>n.startsWith("/")&&x===""?"/":x)}function sT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:uT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var nT=/^:[\w-]+$/,aT=3,rT=2,iT=1,lT=10,oT=-2,lw=n=>n==="*";function cT(n,e){let t=n.split("/"),i=t.length;return t.some(lw)&&(i+=oT),e&&(i+=rT),t.filter(o=>!lw(o)).reduce((o,c)=>o+(nT.test(c)?aT:c===""?iT:lT),i)}function uT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,o)=>i===e[o])?n[n.length-1]-e[e.length-1]:0}function dT(n,e,t=!1){let{routesMeta:i}=n,o={},c="/",d=[];for(let p=0;p<i.length;++p){let x=i[p],g=p===i.length-1,b=c==="/"?e:e.slice(c.length)||"/",w=Xh({path:x.relativePath,caseSensitive:x.caseSensitive,end:g},b),_=x.route;if(!w&&g&&t&&!i[i.length-1].route.index&&(w=Xh({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},b)),!w)return null;Object.assign(o,w.params),d.push({params:o,pathname:Nr([c,w.pathname]),pathnameBase:gT(Nr([c,w.pathnameBase])),route:_}),w.pathnameBase!=="/"&&(c=Nr([c,w.pathnameBase]))}return d}function Xh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=hT(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),p=o.slice(1);return{params:i.reduce((g,{paramName:b,isOptional:w},_)=>{if(b==="*"){let L=p[_]||"";d=c.slice(0,c.length-L.length).replace(/(.)\/+$/,"$1")}const A=p[_];return w&&!A?g[b]=void 0:g[b]=(A||"").replace(/%2F/g,"/"),g},{}),pathname:c,pathnameBase:d,pattern:n}}function hT(n,e=!1,t=!0){aa(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,x)=>(i.push({paramName:p,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function fT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return aa(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Sr(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var mT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function pT(n,e="/"){let{pathname:t,search:i="",hash:o=""}=typeof n=="string"?jl(n):n,c;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?c=ow(t.substring(1),"/"):c=ow(t,e)):c=e,{pathname:c,search:bT(i),hash:yT(o)}}function ow(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function a0(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function xT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function xx(n){let e=xT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function gx(n,e,t,i=!1){let o;typeof n=="string"?o=jl(n):(o={...n},ns(!o.pathname||!o.pathname.includes("?"),a0("?","pathname","search",o)),ns(!o.pathname||!o.pathname.includes("#"),a0("#","pathname","hash",o)),ns(!o.search||!o.search.includes("#"),a0("#","search","hash",o)));let c=n===""||o.pathname==="",d=c?"/":o.pathname,p;if(d==null)p=t;else{let w=e.length-1;if(!i&&d.startsWith("..")){let _=d.split("/");for(;_[0]==="..";)_.shift(),w-=1;o.pathname=_.join("/")}p=w>=0?e[w]:"/"}let x=pT(o,p),g=d&&d!=="/"&&d.endsWith("/"),b=(c||d===".")&&t.endsWith("/");return!x.pathname.endsWith("/")&&(g||b)&&(x.pathname+="/"),x}var Nr=n=>n.join("/").replace(/\/\/+/g,"/"),gT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),bT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,yT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,vT=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function wT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function NT(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var IN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function DN(n,e){let t=n;if(typeof t!="string"||!mT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,o=!1;if(IN)try{let c=new URL(window.location.href),d=t.startsWith("//")?new URL(c.protocol+t):new URL(t),p=Sr(d.pathname,e);d.origin===c.origin&&p!=null?t=p+d.search+d.hash:o=!0}catch{aa(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:o,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var MN=["POST","PUT","PATCH","DELETE"];new Set(MN);var _T=["GET",...MN];new Set(_T);var $o=j.createContext(null);$o.displayName="DataRouter";var Ef=j.createContext(null);Ef.displayName="DataRouterState";var jT=j.createContext(!1),ON=j.createContext({isTransitioning:!1});ON.displayName="ViewTransition";var ST=j.createContext(new Map);ST.displayName="Fetchers";var ET=j.createContext(null);ET.displayName="Await";var Un=j.createContext(null);Un.displayName="Navigation";var Mu=j.createContext(null);Mu.displayName="Location";var ja=j.createContext({outlet:null,matches:[],isDataRoute:!1});ja.displayName="Route";var bx=j.createContext(null);bx.displayName="RouteError";var PN="REACT_ROUTER_ERROR",TT="REDIRECT",AT="ROUTE_ERROR_RESPONSE";function kT(n){if(n.startsWith(`${PN}:${TT}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function CT(n){if(n.startsWith(`${PN}:${AT}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new vT(e.status,e.statusText,e.data)}catch{}}function RT(n,{relative:e}={}){ns(qo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=j.useContext(Un),{hash:o,pathname:c,search:d}=Ou(n,{relative:e}),p=c;return t!=="/"&&(p=c==="/"?t:Nr([t,c])),i.createHref({pathname:p,search:d,hash:o})}function qo(){return j.useContext(Mu)!=null}function Ri(){return ns(qo(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(Mu).location}var VN="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function LN(n){j.useContext(Un).static||j.useLayoutEffect(n)}function Sl(){let{isDataRoute:n}=j.useContext(ja);return n?qT():IT()}function IT(){ns(qo(),"useNavigate() may be used only in the context of a <Router> component.");let n=j.useContext($o),{basename:e,navigator:t}=j.useContext(Un),{matches:i}=j.useContext(ja),{pathname:o}=Ri(),c=JSON.stringify(xx(i)),d=j.useRef(!1);return LN(()=>{d.current=!0}),j.useCallback((x,g={})=>{if(aa(d.current,VN),!d.current)return;if(typeof x=="number"){t.go(x);return}let b=gx(x,JSON.parse(c),o,g.relative==="path");n==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Nr([e,b.pathname])),(g.replace?t.replace:t.push)(b,g.state,g)},[e,t,c,o,n])}j.createContext(null);function Ho(){let{matches:n}=j.useContext(ja),e=n[n.length-1];return e?e.params:{}}function Ou(n,{relative:e}={}){let{matches:t}=j.useContext(ja),{pathname:i}=Ri(),o=JSON.stringify(xx(t));return j.useMemo(()=>gx(n,JSON.parse(o),i,e==="path"),[n,o,i,e])}function DT(n,e){return UN(n,e)}function UN(n,e,t,i,o){ns(qo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=j.useContext(Un),{matches:d}=j.useContext(ja),p=d[d.length-1],x=p?p.params:{},g=p?p.pathname:"/",b=p?p.pathnameBase:"/",w=p&&p.route;{let Q=w&&w.path||"";zN(g,!w||Q.endsWith("*")||Q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${Q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Q}"> to <Route path="${Q==="/"?"*":`${Q}/*`}">.`)}let _=Ri(),A;if(e){let Q=typeof e=="string"?jl(e):e;ns(b==="/"||Q.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${Q.pathname}" was given in the \`location\` prop.`),A=Q}else A=_;let L=A.pathname||"/",V=L;if(b!=="/"){let Q=b.replace(/^\//,"").split("/");V="/"+L.replace(/^\//,"").split("/").slice(Q.length).join("/")}let F=kN(n,{pathname:V});aa(w||F!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),aa(F==null||F[F.length-1].route.element!==void 0||F[F.length-1].route.Component!==void 0||F[F.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let q=LT(F&&F.map(Q=>Object.assign({},Q,{params:Object.assign({},x,Q.params),pathname:Nr([b,c.encodeLocation?c.encodeLocation(Q.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Q.pathname]),pathnameBase:Q.pathnameBase==="/"?b:Nr([b,c.encodeLocation?c.encodeLocation(Q.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Q.pathnameBase])})),d,t,i,o);return e&&q?j.createElement(Mu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},q):q}function MT(){let n=$T(),e=wT(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},c={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:c},"ErrorBoundary")," or"," ",j.createElement("code",{style:c},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:o},t):null,d)}var OT=j.createElement(MT,null),BN=class extends j.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=CT(n.digest);t&&(n=t)}let e=n!==void 0?j.createElement(ja.Provider,{value:this.props.routeContext},j.createElement(bx.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?j.createElement(PT,{error:n},e):e}};BN.contextType=jT;var r0=new WeakMap;function PT({children:n,error:e}){let{basename:t}=j.useContext(Un);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=kT(e.digest);if(i){let o=r0.get(e);if(o)throw o;let c=DN(i.location,t);if(IN&&!r0.get(e))if(c.isExternal||i.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:i.replace}));throw r0.set(e,d),d}return j.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return n}function VT({routeContext:n,match:e,children:t}){let i=j.useContext($o);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),j.createElement(ja.Provider,{value:n},t)}function LT(n,e=[],t=null,i=null,o=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,d=t?.errors;if(d!=null){let b=c.findIndex(w=>w.route.id&&d?.[w.route.id]!==void 0);ns(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,b+1))}let p=!1,x=-1;if(t)for(let b=0;b<c.length;b++){let w=c[b];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(x=b),w.route.id){let{loaderData:_,errors:A}=t,L=w.route.loader&&!_.hasOwnProperty(w.route.id)&&(!A||A[w.route.id]===void 0);if(w.route.lazy||L){p=!0,x>=0?c=c.slice(0,x+1):c=[c[0]];break}}}let g=t&&i?(b,w)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:NT(t.matches),errorInfo:w})}:void 0;return c.reduceRight((b,w,_)=>{let A,L=!1,V=null,F=null;t&&(A=d&&w.route.id?d[w.route.id]:void 0,V=w.route.errorElement||OT,p&&(x<0&&_===0?(zN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),L=!0,F=null):x===_&&(L=!0,F=w.route.hydrateFallbackElement||null)));let q=e.concat(c.slice(0,_+1)),Q=()=>{let H;return A?H=V:L?H=F:w.route.Component?H=j.createElement(w.route.Component,null):w.route.element?H=w.route.element:H=b,j.createElement(VT,{match:w,routeContext:{outlet:b,matches:q,isDataRoute:t!=null},children:H})};return t&&(w.route.ErrorBoundary||w.route.errorElement||_===0)?j.createElement(BN,{location:t.location,revalidation:t.revalidation,component:V,error:A,children:Q(),routeContext:{outlet:null,matches:q,isDataRoute:!0},onError:g}):Q()},null)}function yx(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function UT(n){let e=j.useContext($o);return ns(e,yx(n)),e}function BT(n){let e=j.useContext(Ef);return ns(e,yx(n)),e}function zT(n){let e=j.useContext(ja);return ns(e,yx(n)),e}function vx(n){let e=zT(n),t=e.matches[e.matches.length-1];return ns(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function FT(){return vx("useRouteId")}function $T(){let n=j.useContext(bx),e=BT("useRouteError"),t=vx("useRouteError");return n!==void 0?n:e.errors?.[t]}function qT(){let{router:n}=UT("useNavigate"),e=vx("useNavigate"),t=j.useRef(!1);return LN(()=>{t.current=!0}),j.useCallback(async(o,c={})=>{aa(t.current,VN),t.current&&(typeof o=="number"?await n.navigate(o):await n.navigate(o,{fromRouteId:e,...c}))},[n,e])}var cw={};function zN(n,e,t){!e&&!cw[n]&&(cw[n]=!0,aa(!1,t))}j.memo(HT);function HT({routes:n,future:e,state:t,onError:i}){return UN(n,void 0,t,i,e)}function uw({to:n,replace:e,state:t,relative:i}){ns(qo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=j.useContext(Un);aa(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=j.useContext(ja),{pathname:d}=Ri(),p=Sl(),x=gx(n,xx(c),d,i==="path"),g=JSON.stringify(x);return j.useEffect(()=>{p(JSON.parse(g),{replace:e,state:t,relative:i})},[p,g,i,e,t]),null}function Jn(n){ns(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function GT({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:o,static:c=!1,unstable_useTransitions:d}){ns(!qo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),x=j.useMemo(()=>({basename:p,navigator:o,static:c,unstable_useTransitions:d,future:{}}),[p,o,c,d]);typeof t=="string"&&(t=jl(t));let{pathname:g="/",search:b="",hash:w="",state:_=null,key:A="default"}=t,L=j.useMemo(()=>{let V=Sr(g,p);return V==null?null:{location:{pathname:V,search:b,hash:w,state:_,key:A},navigationType:i}},[p,g,b,w,_,A,i]);return aa(L!=null,`<Router basename="${p}"> is not able to match the URL "${g}${b}${w}" because it does not start with the basename, so the <Router> won't render anything.`),L==null?null:j.createElement(Un.Provider,{value:x},j.createElement(Mu.Provider,{children:e,value:L}))}function YT({children:n,location:e}){return DT(C0(n),e)}function C0(n,e=[]){let t=[];return j.Children.forEach(n,(i,o)=>{if(!j.isValidElement(i))return;let c=[...e,o];if(i.type===j.Fragment){t.push.apply(t,C0(i.props.children,c));return}ns(i.type===Jn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ns(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||c.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=C0(i.props.children,c)),t.push(d)}),t}var Dh="get",Mh="application/x-www-form-urlencoded";function Tf(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function WT(n){return Tf(n)&&n.tagName.toLowerCase()==="button"}function QT(n){return Tf(n)&&n.tagName.toLowerCase()==="form"}function KT(n){return Tf(n)&&n.tagName.toLowerCase()==="input"}function XT(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function JT(n,e){return n.button===0&&(!e||e==="_self")&&!XT(n)}var bh=null;function ZT(){if(bh===null)try{new FormData(document.createElement("form"),0),bh=!1}catch{bh=!0}return bh}var e5=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function i0(n){return n!=null&&!e5.has(n)?(aa(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Mh}"`),null):n}function t5(n,e){let t,i,o,c,d;if(QT(n)){let p=n.getAttribute("action");i=p?Sr(p,e):null,t=n.getAttribute("method")||Dh,o=i0(n.getAttribute("enctype"))||Mh,c=new FormData(n)}else if(WT(n)||KT(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let x=n.getAttribute("formaction")||p.getAttribute("action");if(i=x?Sr(x,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||Dh,o=i0(n.getAttribute("formenctype"))||i0(p.getAttribute("enctype"))||Mh,c=new FormData(p,n),!ZT()){let{name:g,type:b,value:w}=n;if(b==="image"){let _=g?`${g}.`:"";c.append(`${_}x`,"0"),c.append(`${_}y`,"0")}else g&&c.append(g,w)}}else{if(Tf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Dh,i=null,o=Mh,d=n}return c&&o==="text/plain"&&(d=c,c=void 0),{action:i,method:t.toLowerCase(),encType:o,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function wx(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function s5(n,e,t,i){let o=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${i}`:o.pathname=`${o.pathname}.${i}`:o.pathname==="/"?o.pathname=`_root.${i}`:e&&Sr(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${i}`,o}async function n5(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function a5(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function r5(n,e,t){let i=await Promise.all(n.map(async o=>{let c=e.routes[o.route.id];if(c){let d=await n5(c,t);return d.links?d.links():[]}return[]}));return c5(i.flat(1).filter(a5).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function dw(n,e,t,i,o,c){let d=(x,g)=>t[g]?x.route.id!==t[g].route.id:!0,p=(x,g)=>t[g].pathname!==x.pathname||t[g].route.path?.endsWith("*")&&t[g].params["*"]!==x.params["*"];return c==="assets"?e.filter((x,g)=>d(x,g)||p(x,g)):c==="data"?e.filter((x,g)=>{let b=i.routes[x.route.id];if(!b||!b.hasLoader)return!1;if(d(x,g)||p(x,g))return!0;if(x.route.shouldRevalidate){let w=x.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:x.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function i5(n,e,{includeHydrateFallback:t}={}){return l5(n.map(i=>{let o=e.routes[i.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function l5(n){return[...new Set(n)]}function o5(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function c5(n,e){let t=new Set;return new Set(e),n.reduce((i,o)=>{let c=JSON.stringify(o5(o));return t.has(c)||(t.add(c),i.push({key:c,link:o})),i},[])}function FN(){let n=j.useContext($o);return wx(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function u5(){let n=j.useContext(Ef);return wx(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Nx=j.createContext(void 0);Nx.displayName="FrameworkContext";function $N(){let n=j.useContext(Nx);return wx(n,"You must render this element inside a <HydratedRouter> element"),n}function d5(n,e){let t=j.useContext(Nx),[i,o]=j.useState(!1),[c,d]=j.useState(!1),{onFocus:p,onBlur:x,onMouseEnter:g,onMouseLeave:b,onTouchStart:w}=e,_=j.useRef(null);j.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let V=q=>{q.forEach(Q=>{d(Q.isIntersecting)})},F=new IntersectionObserver(V,{threshold:.5});return _.current&&F.observe(_.current),()=>{F.disconnect()}}},[n]),j.useEffect(()=>{if(i){let V=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(V)}}},[i]);let A=()=>{o(!0)},L=()=>{o(!1),d(!1)};return t?n!=="intent"?[c,_,{}]:[c,_,{onFocus:Xc(p,A),onBlur:Xc(x,L),onMouseEnter:Xc(g,A),onMouseLeave:Xc(b,L),onTouchStart:Xc(w,A)}]:[!1,_,{}]}function Xc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function h5({page:n,...e}){let{router:t}=FN(),i=j.useMemo(()=>kN(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?j.createElement(m5,{page:n,matches:i,...e}):null}function f5(n){let{manifest:e,routeModules:t}=$N(),[i,o]=j.useState([]);return j.useEffect(()=>{let c=!1;return r5(n,e,t).then(d=>{c||o(d)}),()=>{c=!0}},[n,e,t]),i}function m5({page:n,matches:e,...t}){let i=Ri(),{future:o,manifest:c,routeModules:d}=$N(),{basename:p}=FN(),{loaderData:x,matches:g}=u5(),b=j.useMemo(()=>dw(n,e,g,c,i,"data"),[n,e,g,c,i]),w=j.useMemo(()=>dw(n,e,g,c,i,"assets"),[n,e,g,c,i]),_=j.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let V=new Set,F=!1;if(e.forEach(Q=>{let H=c.routes[Q.route.id];!H||!H.hasLoader||(!b.some(ie=>ie.route.id===Q.route.id)&&Q.route.id in x&&d[Q.route.id]?.shouldRevalidate||H.hasClientLoader?F=!0:V.add(Q.route.id))}),V.size===0)return[];let q=s5(n,p,o.unstable_trailingSlashAwareDataRequests,"data");return F&&V.size>0&&q.searchParams.set("_routes",e.filter(Q=>V.has(Q.route.id)).map(Q=>Q.route.id).join(",")),[q.pathname+q.search]},[p,o.unstable_trailingSlashAwareDataRequests,x,i,c,b,e,n,d]),A=j.useMemo(()=>i5(w,c),[w,c]),L=f5(w);return j.createElement(j.Fragment,null,_.map(V=>j.createElement("link",{key:V,rel:"prefetch",as:"fetch",href:V,...t})),A.map(V=>j.createElement("link",{key:V,rel:"modulepreload",href:V,...t})),L.map(({key:V,link:F})=>j.createElement("link",{key:V,nonce:t.nonce,...F,crossOrigin:F.crossOrigin??t.crossOrigin})))}function p5(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var x5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{x5&&(window.__reactRouterVersion="7.13.0")}catch{}function g5({basename:n,children:e,unstable_useTransitions:t,window:i}){let o=j.useRef();o.current==null&&(o.current=XE({window:i,v5Compat:!0}));let c=o.current,[d,p]=j.useState({action:c.action,location:c.location}),x=j.useCallback(g=>{t===!1?p(g):j.startTransition(()=>p(g))},[t]);return j.useLayoutEffect(()=>c.listen(x),[c,x]),j.createElement(GT,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:c,unstable_useTransitions:t})}var qN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nt=j.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:o,reloadDocument:c,replace:d,state:p,target:x,to:g,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:_,...A},L){let{basename:V,unstable_useTransitions:F}=j.useContext(Un),q=typeof g=="string"&&qN.test(g),Q=DN(g,V);g=Q.to;let H=RT(g,{relative:o}),[ie,le,Y]=d5(i,A),T=w5(g,{replace:d,state:p,target:x,preventScrollReset:b,relative:o,viewTransition:w,unstable_defaultShouldRevalidate:_,unstable_useTransitions:F});function E(I){e&&e(I),I.defaultPrevented||T(I)}let S=j.createElement("a",{...A,...Y,href:Q.absoluteURL||H,onClick:Q.isExternal||c?e:E,ref:p5(L,le),target:x,"data-discover":!q&&t==="render"?"true":void 0});return ie&&!q?j.createElement(j.Fragment,null,S,j.createElement(h5,{page:H})):S});nt.displayName="Link";var b5=j.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:o=!1,style:c,to:d,viewTransition:p,children:x,...g},b){let w=Ou(d,{relative:g.relative}),_=Ri(),A=j.useContext(Ef),{navigator:L,basename:V}=j.useContext(Un),F=A!=null&&E5(w)&&p===!0,q=L.encodeLocation?L.encodeLocation(w).pathname:w.pathname,Q=_.pathname,H=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;t||(Q=Q.toLowerCase(),H=H?H.toLowerCase():null,q=q.toLowerCase()),H&&V&&(H=Sr(H,V)||H);const ie=q!=="/"&&q.endsWith("/")?q.length-1:q.length;let le=Q===q||!o&&Q.startsWith(q)&&Q.charAt(ie)==="/",Y=H!=null&&(H===q||!o&&H.startsWith(q)&&H.charAt(q.length)==="/"),T={isActive:le,isPending:Y,isTransitioning:F},E=le?e:void 0,S;typeof i=="function"?S=i(T):S=[i,le?"active":null,Y?"pending":null,F?"transitioning":null].filter(Boolean).join(" ");let I=typeof c=="function"?c(T):c;return j.createElement(nt,{...g,"aria-current":E,className:S,ref:b,style:I,to:d,viewTransition:p},typeof x=="function"?x(T):x)});b5.displayName="NavLink";var y5=j.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:o,state:c,method:d=Dh,action:p,onSubmit:x,relative:g,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:_,...A},L)=>{let{unstable_useTransitions:V}=j.useContext(Un),F=j5(),q=S5(p,{relative:g}),Q=d.toLowerCase()==="get"?"get":"post",H=typeof p=="string"&&qN.test(p),ie=le=>{if(x&&x(le),le.defaultPrevented)return;le.preventDefault();let Y=le.nativeEvent.submitter,T=Y?.getAttribute("formmethod")||d,E=()=>F(Y||le.currentTarget,{fetcherKey:e,method:T,navigate:t,replace:o,state:c,relative:g,preventScrollReset:b,viewTransition:w,unstable_defaultShouldRevalidate:_});V&&t!==!1?j.startTransition(()=>E()):E()};return j.createElement("form",{ref:L,method:Q,action:q,onSubmit:i?x:ie,...A,"data-discover":!H&&n==="render"?"true":void 0})});y5.displayName="Form";function v5(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function HN(n){let e=j.useContext($o);return ns(e,v5(n)),e}function w5(n,{target:e,replace:t,state:i,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:x}={}){let g=Sl(),b=Ri(),w=Ou(n,{relative:c});return j.useCallback(_=>{if(JT(_,e)){_.preventDefault();let A=t!==void 0?t:wu(b)===wu(w),L=()=>g(n,{replace:A,state:i,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:p});x?j.startTransition(()=>L()):L()}},[b,g,w,t,i,e,n,o,c,d,p,x])}var N5=0,_5=()=>`__${String(++N5)}__`;function j5(){let{router:n}=HN("useSubmit"),{basename:e}=j.useContext(Un),t=FT(),i=n.fetch,o=n.navigate;return j.useCallback(async(c,d={})=>{let{action:p,method:x,encType:g,formData:b,body:w}=t5(c,e);if(d.navigate===!1){let _=d.fetcherKey||_5();await i(_,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:w,formMethod:d.method||x,formEncType:d.encType||g,flushSync:d.flushSync})}else await o(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:w,formMethod:d.method||x,formEncType:d.encType||g,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,o,e,t])}function S5(n,{relative:e}={}){let{basename:t}=j.useContext(Un),i=j.useContext(ja);ns(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),c={...Ou(n||".",{relative:e})},d=Ri();if(n==null){c.search=d.search;let p=new URLSearchParams(c.search),x=p.getAll("index");if(x.some(b=>b==="")){p.delete("index"),x.filter(w=>w).forEach(w=>p.append("index",w));let b=p.toString();c.search=b?`?${b}`:""}}return(!n||n===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(c.pathname=c.pathname==="/"?t:Nr([t,c.pathname])),wu(c)}function E5(n,{relative:e}={}){let t=j.useContext(ON);ns(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=HN("useViewTransitionState"),o=Ou(n,{relative:e});if(!t.isTransitioning)return!1;let c=Sr(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=Sr(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Xh(o.pathname,d)!=null||Xh(o.pathname,c)!=null}const T5=()=>{};var hw={};const GN=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},A5=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[i++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],p=n[t++],x=((o&7)<<18|(c&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(x>>10)),e[i++]=String.fromCharCode(56320+(x&1023))}else{const c=n[t++],d=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},YN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,p=d?n[o+1]:0,x=o+2<n.length,g=x?n[o+2]:0,b=c>>2,w=(c&3)<<4|p>>4;let _=(p&15)<<2|g>>6,A=g&63;x||(A=64,d||(_=64)),i.push(t[b],t[w],t[_],t[A])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(GN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):A5(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],p=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const w=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||p==null||g==null||w==null)throw new k5;const _=c<<2|p>>4;if(i.push(_),g!==64){const A=p<<4&240|g>>2;if(i.push(A),w!==64){const L=g<<6&192|w;i.push(L)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class k5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const C5=function(n){const e=GN(n);return YN.encodeByteArray(e,!0)},Jh=function(n){return C5(n).replace(/\./g,"")},WN=function(n){try{return YN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function R5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const I5=()=>R5().__FIREBASE_DEFAULTS__,D5=()=>{if(typeof process>"u"||typeof hw>"u")return;const n=hw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},M5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&WN(n[1]);return e&&JSON.parse(e)},Af=()=>{try{return T5()||I5()||D5()||M5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},QN=n=>Af()?.emulatorHosts?.[n],_x=n=>{const e=QN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},KN=()=>Af()?.config,XN=n=>Af()?.[`_${n}`];class O5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Za(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function kf(n){return(await fetch(n,{credentials:"include"})).ok}function JN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Jh(JSON.stringify(t)),Jh(JSON.stringify(d)),""].join(".")}const hu={};function P5(){const n={prod:[],emulator:[]};for(const e of Object.keys(hu))hu[e]?n.emulator.push(e):n.prod.push(e);return n}function V5(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let fw=!1;function Cf(n,e){if(typeof window>"u"||typeof document>"u"||!Za(window.location.host)||hu[n]===e||hu[n]||fw)return;hu[n]=e;function t(_){return`__firebase__banner__${_}`}const i="__firebase__banner",c=P5().prod.length>0;function d(){const _=document.getElementById(i);_&&_.remove()}function p(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function x(_,A){_.setAttribute("width","24"),_.setAttribute("id",A),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function g(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{fw=!0,d()},_}function b(_,A){_.setAttribute("id",A),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function w(){const _=V5(i),A=t("text"),L=document.getElementById(A)||document.createElement("span"),V=t("learnmore"),F=document.getElementById(V)||document.createElement("a"),q=t("preprendIcon"),Q=document.getElementById(q)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const H=_.element;p(H),b(F,V);const ie=g();x(Q,q),H.append(Q,L,F,ie),document.body.appendChild(H)}c?(L.innerText="Preview backend disconnected.",Q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,L.innerText="Preview backend running in this workspace."),L.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}function Xs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function L5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xs())}function U5(){const n=Af()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function B5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function z5(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function F5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $5(){const n=Xs();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function q5(){return!U5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function H5(){try{return typeof indexedDB=="object"}catch{return!1}}function G5(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}const Y5="FirebaseError";class Sa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Y5,Object.setPrototypeOf(this,Sa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pu.prototype.create)}}class Pu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?W5(c,i):"Error",p=`${this.serviceName}: ${d} (${o}).`;return new Sa(o,p,i)}}function W5(n,e){return n.replace(Q5,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const Q5=/\{\$([^}]+)}/g;function K5(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function gl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const c=n[o],d=e[o];if(mw(c)&&mw(d)){if(!gl(c,d))return!1}else if(c!==d)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function mw(n){return n!==null&&typeof n=="object"}function Vu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ru(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,c]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function iu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function X5(n,e){const t=new J5(n,e);return t.subscribe.bind(t)}class J5{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Z5(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=l0),o.error===void 0&&(o.error=l0),o.complete===void 0&&(o.complete=l0);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Z5(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function l0(){}function Yt(n){return n&&n._delegate?n._delegate:n}class Er{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const dl="[DEFAULT]";class eA{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new O5;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sA(e))try{this.getOrInitializeService({instanceIdentifier:dl})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});i.resolve(c)}catch{}}}}clearInstance(e=dl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=dl){return this.instances.has(e)}getOptions(e=dl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[c,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(c);i===p&&d.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const c=this.instances.get(i);return c&&e(c,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:tA(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=dl){return this.component?this.component.multipleInstances?e:dl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function tA(n){return n===dl?void 0:n}function sA(n){return n.instantiationMode==="EAGER"}class nA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new eA(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var wt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(wt||(wt={}));const aA={debug:wt.DEBUG,verbose:wt.VERBOSE,info:wt.INFO,warn:wt.WARN,error:wt.ERROR,silent:wt.SILENT},rA=wt.INFO,iA={[wt.DEBUG]:"log",[wt.VERBOSE]:"log",[wt.INFO]:"info",[wt.WARN]:"warn",[wt.ERROR]:"error"},lA=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=iA[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class jx{constructor(e){this.name=e,this._logLevel=rA,this._logHandler=lA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,wt.DEBUG,...e),this._logHandler(this,wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,wt.VERBOSE,...e),this._logHandler(this,wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,wt.INFO,...e),this._logHandler(this,wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,wt.WARN,...e),this._logHandler(this,wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,wt.ERROR,...e),this._logHandler(this,wt.ERROR,...e)}}const oA=(n,e)=>e.some(t=>n instanceof t);let pw,xw;function cA(){return pw||(pw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uA(){return xw||(xw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ZN=new WeakMap,R0=new WeakMap,e_=new WeakMap,o0=new WeakMap,Sx=new WeakMap;function dA(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(bi(n.result)),o()},d=()=>{i(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&ZN.set(t,n)}).catch(()=>{}),Sx.set(e,n),e}function hA(n){if(R0.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});R0.set(n,e)}let I0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return R0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||e_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function fA(n){I0=n(I0)}function mA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(c0(this),e,...t);return e_.set(i,e.sort?e.sort():[e]),bi(i)}:uA().includes(n)?function(...e){return n.apply(c0(this),e),bi(ZN.get(this))}:function(...e){return bi(n.apply(c0(this),e))}}function pA(n){return typeof n=="function"?mA(n):(n instanceof IDBTransaction&&hA(n),oA(n,cA())?new Proxy(n,I0):n)}function bi(n){if(n instanceof IDBRequest)return dA(n);if(o0.has(n))return o0.get(n);const e=pA(n);return e!==n&&(o0.set(n,e),Sx.set(e,n)),e}const c0=n=>Sx.get(n);function xA(n,e,{blocked:t,upgrade:i,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),p=bi(d);return i&&d.addEventListener("upgradeneeded",x=>{i(bi(d.result),x.oldVersion,x.newVersion,bi(d.transaction),x)}),t&&d.addEventListener("blocked",x=>t(x.oldVersion,x.newVersion,x)),p.then(x=>{c&&x.addEventListener("close",()=>c()),o&&x.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),p}const gA=["get","getKey","getAll","getAllKeys","count"],bA=["put","add","delete","clear"],u0=new Map;function gw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(u0.get(e))return u0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=bA.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||gA.includes(t)))return;const c=async function(d,...p){const x=this.transaction(d,o?"readwrite":"readonly");let g=x.store;return i&&(g=g.index(p.shift())),(await Promise.all([g[t](...p),o&&x.done]))[0]};return u0.set(e,c),c}fA(n=>({...n,get:(e,t,i)=>gw(e,t)||n.get(e,t,i),has:(e,t)=>!!gw(e,t)||n.has(e,t)}));class yA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(vA(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function vA(n){return n.getComponent()?.type==="VERSION"}const D0="@firebase/app",bw="0.14.7";const Tr=new jx("@firebase/app"),wA="@firebase/app-compat",NA="@firebase/analytics-compat",_A="@firebase/analytics",jA="@firebase/app-check-compat",SA="@firebase/app-check",EA="@firebase/auth",TA="@firebase/auth-compat",AA="@firebase/database",kA="@firebase/data-connect",CA="@firebase/database-compat",RA="@firebase/functions",IA="@firebase/functions-compat",DA="@firebase/installations",MA="@firebase/installations-compat",OA="@firebase/messaging",PA="@firebase/messaging-compat",VA="@firebase/performance",LA="@firebase/performance-compat",UA="@firebase/remote-config",BA="@firebase/remote-config-compat",zA="@firebase/storage",FA="@firebase/storage-compat",$A="@firebase/firestore",qA="@firebase/ai",HA="@firebase/firestore-compat",GA="firebase",YA="12.8.0";const M0="[DEFAULT]",WA={[D0]:"fire-core",[wA]:"fire-core-compat",[_A]:"fire-analytics",[NA]:"fire-analytics-compat",[SA]:"fire-app-check",[jA]:"fire-app-check-compat",[EA]:"fire-auth",[TA]:"fire-auth-compat",[AA]:"fire-rtdb",[kA]:"fire-data-connect",[CA]:"fire-rtdb-compat",[RA]:"fire-fn",[IA]:"fire-fn-compat",[DA]:"fire-iid",[MA]:"fire-iid-compat",[OA]:"fire-fcm",[PA]:"fire-fcm-compat",[VA]:"fire-perf",[LA]:"fire-perf-compat",[UA]:"fire-rc",[BA]:"fire-rc-compat",[zA]:"fire-gcs",[FA]:"fire-gcs-compat",[$A]:"fire-fst",[HA]:"fire-fst-compat",[qA]:"fire-vertex","fire-js":"fire-js",[GA]:"fire-js-all"};const Zh=new Map,QA=new Map,O0=new Map;function yw(n,e){try{n.container.addComponent(e)}catch(t){Tr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ji(n){const e=n.name;if(O0.has(e))return Tr.debug(`There were multiple attempts to register component ${e}.`),!1;O0.set(e,n);for(const t of Zh.values())yw(t,n);for(const t of QA.values())yw(t,n);return!0}function Lu(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function xn(n){return n==null?!1:n.settings!==void 0}const KA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yi=new Pu("app","Firebase",KA);class XA{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Er("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yi.create("app-deleted",{appName:this._name})}}const El=YA;function t_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:M0,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw yi.create("bad-app-name",{appName:String(o)});if(t||(t=KN()),!t)throw yi.create("no-options");const c=Zh.get(o);if(c){if(gl(t,c.options)&&gl(i,c.config))return c;throw yi.create("duplicate-app",{appName:o})}const d=new nA(o);for(const x of O0.values())d.addComponent(x);const p=new XA(t,i,d);return Zh.set(o,p),p}function Rf(n=M0){const e=Zh.get(n);if(!e&&n===M0&&KN())return t_();if(!e)throw yi.create("no-app",{appName:n});return e}function sa(n,e,t){let i=WA[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const d=[`Unable to register library "${i}" with version "${e}":`];o&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Tr.warn(d.join(" "));return}ji(new Er(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const JA="firebase-heartbeat-database",ZA=1,Nu="firebase-heartbeat-store";let d0=null;function s_(){return d0||(d0=xA(JA,ZA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Nu)}catch(t){console.warn(t)}}}}).catch(n=>{throw yi.create("idb-open",{originalErrorMessage:n.message})})),d0}async function ek(n){try{const t=(await s_()).transaction(Nu),i=await t.objectStore(Nu).get(n_(n));return await t.done,i}catch(e){if(e instanceof Sa)Tr.warn(e.message);else{const t=yi.create("idb-get",{originalErrorMessage:e?.message});Tr.warn(t.message)}}}async function vw(n,e){try{const i=(await s_()).transaction(Nu,"readwrite");await i.objectStore(Nu).put(e,n_(n)),await i.done}catch(t){if(t instanceof Sa)Tr.warn(t.message);else{const i=yi.create("idb-set",{originalErrorMessage:t?.message});Tr.warn(i.message)}}}function n_(n){return`${n.name}!${n.options.appId}`}const tk=1024,sk=30;class nk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new rk(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ww();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>sk){const o=ik(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Tr.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ww(),{heartbeatsToSend:t,unsentEntries:i}=ak(this._heartbeatsCache.heartbeats),o=Jh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Tr.warn(e),""}}}function ww(){return new Date().toISOString().substring(0,10)}function ak(n,e=tk){const t=[];let i=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),Nw(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Nw(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class rk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return H5()?G5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await ek(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return vw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return vw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Nw(n){return Jh(JSON.stringify({version:2,heartbeats:n})).length}function ik(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function lk(n){ji(new Er("platform-logger",e=>new yA(e),"PRIVATE")),ji(new Er("heartbeat",e=>new nk(e),"PRIVATE")),sa(D0,bw,n),sa(D0,bw,"esm2020"),sa("fire-js","")}lk("");function a_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ok=a_,r_=new Pu("auth","Firebase",a_());const ef=new jx("@firebase/auth");function ck(n,...e){ef.logLevel<=wt.WARN&&ef.warn(`Auth (${El}): ${n}`,...e)}function Oh(n,...e){ef.logLevel<=wt.ERROR&&ef.error(`Auth (${El}): ${n}`,...e)}function wa(n,...e){throw Ex(n,...e)}function Ga(n,...e){return Ex(n,...e)}function i_(n,e,t){const i={...ok(),[e]:t};return new Pu("auth","Firebase",i).create(e,{appName:n.name})}function _r(n){return i_(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ex(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return r_.create(n,...e)}function st(n,e,...t){if(!n)throw Ex(e,...t)}function yr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Oh(e),new Error(e)}function Ar(n,e){n||yr(e)}function P0(){return typeof self<"u"&&self.location?.href||""}function uk(){return _w()==="http:"||_w()==="https:"}function _w(){return typeof self<"u"&&self.location?.protocol||null}function dk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(uk()||z5()||"connection"in navigator)?navigator.onLine:!0}function hk(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ar(t>e,"Short delay should be less than long delay!"),this.isMobile=L5()||F5()}get(){return dk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Tx(n,e){Ar(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class l_{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;yr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;yr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;yr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const fk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const mk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],pk=new Uu(3e4,6e4);function Ii(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Di(n,e,t,i,o={}){return o_(n,o,async()=>{let c={},d={};i&&(e==="GET"?d=i:c={body:JSON.stringify(i)});const p=Vu({key:n.config.apiKey,...d}).slice(1),x=await n._getAdditionalHeaders();x["Content-Type"]="application/json",n.languageCode&&(x["X-Firebase-Locale"]=n.languageCode);const g={method:e,headers:x,...c};return B5()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&Za(n.emulatorConfig.host)&&(g.credentials="include"),l_.fetch()(await c_(n,n.config.apiHost,t,p),g)})}async function o_(n,e,t){n._canInitEmulator=!1;const i={...fk,...e};try{const o=new gk(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw yh(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const p=c.ok?d.errorMessage:d.error.message,[x,g]=p.split(" : ");if(x==="FEDERATED_USER_ID_ALREADY_LINKED")throw yh(n,"credential-already-in-use",d);if(x==="EMAIL_EXISTS")throw yh(n,"email-already-in-use",d);if(x==="USER_DISABLED")throw yh(n,"user-disabled",d);const b=i[x]||x.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw i_(n,b,g);wa(n,b)}}catch(o){if(o instanceof Sa)throw o;wa(n,"network-request-failed",{message:String(o)})}}async function Bu(n,e,t,i,o={}){const c=await Di(n,e,t,i,o);return"mfaPendingCredential"in c&&wa(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function c_(n,e,t,i){const o=`${e}${t}?${i}`,c=n,d=c.config.emulator?Tx(n.config,o):`${n.config.apiScheme}://${o}`;return mk.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function xk(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class gk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ga(this.auth,"network-request-failed")),pk.get())})}}function yh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=Ga(n,e,i);return o.customData._tokenResponse=t,o}function jw(n){return n!==void 0&&n.enterprise!==void 0}class bk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return xk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function yk(n,e){return Di(n,"GET","/v2/recaptchaConfig",Ii(n,e))}async function vk(n,e){return Di(n,"POST","/v1/accounts:delete",e)}async function tf(n,e){return Di(n,"POST","/v1/accounts:lookup",e)}function fu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function wk(n,e=!1){const t=Yt(n),i=await t.getIdToken(e),o=Ax(i);st(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:i,authTime:fu(h0(o.auth_time)),issuedAtTime:fu(h0(o.iat)),expirationTime:fu(h0(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function h0(n){return Number(n)*1e3}function Ax(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Oh("JWT malformed, contained fewer than 3 sections"),null;try{const o=WN(t);return o?JSON.parse(o):(Oh("Failed to decode base64 JWT payload"),null)}catch(o){return Oh("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Sw(n){const e=Ax(n);return st(e,"internal-error"),st(typeof e.exp<"u","internal-error"),st(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function _u(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Sa&&Nk(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Nk({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class _k{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class V0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fu(this.lastLoginAt),this.creationTime=fu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function sf(n){const e=n.auth,t=await n.getIdToken(),i=await _u(n,tf(e,{idToken:t}));st(i?.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const c=o.providerUserInfo?.length?u_(o.providerUserInfo):[],d=Sk(n.providerData,c),p=n.isAnonymous,x=!(n.email&&o.passwordHash)&&!d?.length,g=p?x:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new V0(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(n,b)}async function jk(n){const e=Yt(n);await sf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Sk(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function u_(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function Ek(n,e){const t=await o_(n,{},async()=>{const i=Vu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await c_(n,o,"/v1/token",`key=${c}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const x={method:"POST",headers:p,body:i};return n.emulatorConfig&&Za(n.emulatorConfig.host)&&(x.credentials="include"),l_.fetch()(d,x)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Tk(n,e){return Di(n,"POST","/v2/accounts:revokeToken",Ii(n,e))}class jo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){st(e.idToken,"internal-error"),st(typeof e.idToken<"u","internal-error"),st(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Sw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){st(e.length!==0,"internal-error");const t=Sw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(st(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:c}=await Ek(e,t);this.updateTokensAndExpiration(i,o,Number(c))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:c}=t,d=new jo;return i&&(st(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),o&&(st(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(st(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jo,this.toJSON())}_performRefresh(){return yr("not implemented")}}function ui(n,e){st(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class xa{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new _k(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new V0(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await _u(this,this.stsTokenManager.getToken(this.auth,e));return st(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return wk(this,e)}reload(){return jk(this)}_assign(e){this!==e&&(st(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new xa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){st(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await sf(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xn(this.auth.app))return Promise.reject(_r(this.auth));const e=await this.getIdToken();return await _u(this,vk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,c=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,x=t._redirectEventId??void 0,g=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:w,emailVerified:_,isAnonymous:A,providerData:L,stsTokenManager:V}=t;st(w&&V,e,"internal-error");const F=jo.fromJSON(this.name,V);st(typeof w=="string",e,"internal-error"),ui(i,e.name),ui(o,e.name),st(typeof _=="boolean",e,"internal-error"),st(typeof A=="boolean",e,"internal-error"),ui(c,e.name),ui(d,e.name),ui(p,e.name),ui(x,e.name),ui(g,e.name),ui(b,e.name);const q=new xa({uid:w,auth:e,email:o,emailVerified:_,displayName:i,isAnonymous:A,photoURL:d,phoneNumber:c,tenantId:p,stsTokenManager:F,createdAt:g,lastLoginAt:b});return L&&Array.isArray(L)&&(q.providerData=L.map(Q=>({...Q}))),x&&(q._redirectEventId=x),q}static async _fromIdTokenResponse(e,t,i=!1){const o=new jo;o.updateFromServerResponse(t);const c=new xa({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await sf(c),c}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];st(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?u_(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,p=new jo;p.updateFromIdToken(i);const x=new xa({uid:o.localId,auth:e,stsTokenManager:p,isAnonymous:d}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new V0(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(x,g),x}}const Ew=new Map;function vr(n){Ar(n instanceof Function,"Expected a class definition");let e=Ew.get(n);return e?(Ar(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Ew.set(n,e),e)}class d_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}d_.type="NONE";const Tw=d_;function Ph(n,e,t){return`firebase:${n}:${e}:${t}`}class So{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:c}=this.auth;this.fullUserKey=Ph(this.userKey,o.apiKey,c),this.fullPersistenceKey=Ph("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await tf(this.auth,{idToken:e}).catch(()=>{});return t?xa._fromGetAccountInfoResponse(this.auth,t,e):null}return xa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new So(vr(Tw),e,i);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||vr(Tw);const d=Ph(i,e.config.apiKey,e.name);let p=null;for(const g of t)try{const b=await g._get(d);if(b){let w;if(typeof b=="string"){const _=await tf(e,{idToken:b}).catch(()=>{});if(!_)break;w=await xa._fromGetAccountInfoResponse(e,_,b)}else w=xa._fromJSON(e,b);g!==c&&(p=w),c=g;break}}catch{}const x=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!x.length?new So(c,e,i):(c=x[0],p&&await c._set(d,p.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(d)}catch{}})),new So(c,e,i))}}function Aw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(p_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(h_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(g_(e))return"Blackberry";if(b_(e))return"Webos";if(f_(e))return"Safari";if((e.includes("chrome/")||m_(e))&&!e.includes("edge/"))return"Chrome";if(x_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function h_(n=Xs()){return/firefox\//i.test(n)}function f_(n=Xs()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function m_(n=Xs()){return/crios\//i.test(n)}function p_(n=Xs()){return/iemobile/i.test(n)}function x_(n=Xs()){return/android/i.test(n)}function g_(n=Xs()){return/blackberry/i.test(n)}function b_(n=Xs()){return/webos/i.test(n)}function kx(n=Xs()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Ak(n=Xs()){return kx(n)&&!!window.navigator?.standalone}function kk(){return $5()&&document.documentMode===10}function y_(n=Xs()){return kx(n)||x_(n)||b_(n)||g_(n)||/windows phone/i.test(n)||p_(n)}function v_(n,e=[]){let t;switch(n){case"Browser":t=Aw(Xs());break;case"Worker":t=`${Aw(Xs())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${El}/${i}`}class Ck{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=c=>new Promise((d,p)=>{try{const x=e(c);d(x)}catch(x){p(x)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function Rk(n,e={}){return Di(n,"GET","/v2/passwordPolicy",Ii(n,e))}const Ik=6;class Dk{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Ik,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}class Mk{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new kw(this),this.idTokenSubscription=new kw(this),this.beforeStateQueue=new Ck(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=r_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=vr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await So.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await tf(this,{idToken:e}),i=await xa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(xn(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!c||c===d)&&p?.user&&(i=p.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return st(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await sf(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=hk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xn(this.app))return Promise.reject(_r(this));const t=e?Yt(e):null;return t&&st(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&st(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xn(this.app)?Promise.reject(_r(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xn(this.app)?Promise.reject(_r(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(vr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Rk(this),t=new Dk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Pu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await Tk(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&vr(e)||this._popupRedirectResolver;st(t,this,"argument-error"),this.redirectPersistenceManager=await So.create(this,[vr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(st(p,this,"internal-error"),p.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const x=e.addObserver(t,i,o);return()=>{d=!0,x()}}else{const x=e.addObserver(t);return()=>{d=!0,x()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return st(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=v_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(xn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ck(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Tl(n){return Yt(n)}class kw{constructor(e){this.auth=e,this.observer=null,this.addObserver=X5(t=>this.observer=t)}get next(){return st(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let If={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ok(n){If=n}function w_(n){return If.loadJS(n)}function Pk(){return If.recaptchaEnterpriseScript}function Vk(){return If.gapiScript}function Lk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Uk{constructor(){this.enterprise=new Bk}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Bk{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const zk="recaptcha-enterprise",N_="NO_RECAPTCHA";class Fk{constructor(e){this.type=zk,this.auth=Tl(e)}async verify(e="verify",t=!1){async function i(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,p)=>{yk(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(x=>{if(x.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const g=new bk(x);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,d(g.siteKey)}}).catch(x=>{p(x)})})}function o(c,d,p){const x=window.grecaptcha;jw(x)?x.enterprise.ready(()=>{x.enterprise.execute(c,{action:e}).then(g=>{d(g)}).catch(()=>{d(N_)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Uk().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{i(this.auth).then(p=>{if(!t&&jw(window.grecaptcha))o(p,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let x=Pk();x.length!==0&&(x+=p),w_(x).then(()=>{o(p,c,d)}).catch(g=>{d(g)})}}).catch(p=>{d(p)})})}}async function Cw(n,e,t,i=!1,o=!1){const c=new Fk(n);let d;if(o)d=N_;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const x=p.phoneEnrollmentInfo.phoneNumber,g=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:x,recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const x=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:x,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function L0(n,e,t,i,o){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Cw(n,e,t,t==="getOobCode");return i(n,c)}else return i(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Cw(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(c)})}function $k(n,e){const t=Lu(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(gl(c,e??{}))return o;wa(o,"already-initialized")}return t.initialize({options:e})}function qk(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(vr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function Hk(n,e,t){const i=Tl(n);st(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,c=__(e),{host:d,port:p}=Gk(e),x=p===null?"":`:${p}`,g={url:`${c}//${d}${x}/`},b=Object.freeze({host:d,port:p,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){st(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),st(gl(g,i.config.emulator)&&gl(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,Za(d)?(kf(`${c}//${d}${x}`),Cf("Auth",!0)):Yk()}function __(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Gk(n){const e=__(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const c=o[1];return{host:c,port:Rw(i.substr(c.length+1))}}else{const[c,d]=i.split(":");return{host:c,port:Rw(d)}}}function Rw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Yk(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Cx{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return yr("not implemented")}_getIdTokenResponse(e){return yr("not implemented")}_linkToIdToken(e,t){return yr("not implemented")}_getReauthenticationResolver(e){return yr("not implemented")}}async function Wk(n,e){return Di(n,"POST","/v1/accounts:signUp",e)}async function Qk(n,e){return Bu(n,"POST","/v1/accounts:signInWithPassword",Ii(n,e))}async function Kk(n,e){return Bu(n,"POST","/v1/accounts:signInWithEmailLink",Ii(n,e))}async function Xk(n,e){return Bu(n,"POST","/v1/accounts:signInWithEmailLink",Ii(n,e))}class ju extends Cx{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new ju(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new ju(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return L0(e,t,"signInWithPassword",Qk);case"emailLink":return Kk(e,{email:this._email,oobCode:this._password});default:wa(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return L0(e,i,"signUpPassword",Wk);case"emailLink":return Xk(e,{idToken:t,email:this._email,oobCode:this._password});default:wa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Eo(n,e){return Bu(n,"POST","/v1/accounts:signInWithIdp",Ii(n,e))}const Jk="http://localhost";class bl extends Cx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new bl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):wa("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...c}=t;if(!i||!o)return null;const d=new bl(i,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Eo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Eo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Eo(e,t)}buildRequest(){const e={requestUri:Jk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Vu(t)}return e}}function Zk(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function eC(n){const e=ru(iu(n)).link,t=e?ru(iu(e)).deep_link_id:null,i=ru(iu(n)).deep_link_id;return(i?ru(iu(i)).link:null)||i||t||e||n}class Rx{constructor(e){const t=ru(iu(e)),i=t.apiKey??null,o=t.oobCode??null,c=Zk(t.mode??null);st(i&&o&&c,"argument-error"),this.apiKey=i,this.operation=c,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=eC(e);try{return new Rx(t)}catch{return null}}}class Go{constructor(){this.providerId=Go.PROVIDER_ID}static credential(e,t){return ju._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Rx.parseLink(t);return st(i,"argument-error"),ju._fromEmailAndCode(e,i.code,i.tenantId)}}Go.PROVIDER_ID="password";Go.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Go.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class j_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class zu extends j_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class hi extends zu{constructor(){super("facebook.com")}static credential(e){return bl._fromParams({providerId:hi.PROVIDER_ID,signInMethod:hi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hi.credentialFromTaggedObject(e)}static credentialFromError(e){return hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hi.credential(e.oauthAccessToken)}catch{return null}}}hi.FACEBOOK_SIGN_IN_METHOD="facebook.com";hi.PROVIDER_ID="facebook.com";class fi extends zu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return bl._fromParams({providerId:fi.PROVIDER_ID,signInMethod:fi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return fi.credentialFromTaggedObject(e)}static credentialFromError(e){return fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return fi.credential(t,i)}catch{return null}}}fi.GOOGLE_SIGN_IN_METHOD="google.com";fi.PROVIDER_ID="google.com";class mi extends zu{constructor(){super("github.com")}static credential(e){return bl._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.GITHUB_SIGN_IN_METHOD="github.com";mi.PROVIDER_ID="github.com";class pi extends zu{constructor(){super("twitter.com")}static credential(e,t){return bl._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return pi.credential(t,i)}catch{return null}}}pi.TWITTER_SIGN_IN_METHOD="twitter.com";pi.PROVIDER_ID="twitter.com";async function tC(n,e){return Bu(n,"POST","/v1/accounts:signUp",Ii(n,e))}class yl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const c=await xa._fromIdTokenResponse(e,i,o),d=Iw(i);return new yl({user:c,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=Iw(i);return new yl({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function Iw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class nf extends Sa{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,nf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new nf(e,t,i,o)}}function S_(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?nf._fromErrorAndOperation(n,c,e,i):c})}async function sC(n,e,t=!1){const i=await _u(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return yl._forOperation(n,"link",i)}async function nC(n,e,t=!1){const{auth:i}=n;if(xn(i.app))return Promise.reject(_r(i));const o="reauthenticate";try{const c=await _u(n,S_(i,o,e,n),t);st(c.idToken,i,"internal-error");const d=Ax(c.idToken);st(d,i,"internal-error");const{sub:p}=d;return st(n.uid===p,i,"user-mismatch"),yl._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&wa(i,"user-mismatch"),c}}async function E_(n,e,t=!1){if(xn(n.app))return Promise.reject(_r(n));const i="signIn",o=await S_(n,i,e),c=await yl._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(c.user),c}async function aC(n,e){return E_(Tl(n),e)}async function T_(n){const e=Tl(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function rC(n,e,t){if(xn(n.app))return Promise.reject(_r(n));const i=Tl(n),d=await L0(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tC).catch(x=>{throw x.code==="auth/password-does-not-meet-requirements"&&T_(n),x}),p=await yl._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function A_(n,e,t){return xn(n.app)?Promise.reject(_r(n)):aC(Yt(n),Go.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&T_(n),i})}function iC(n,e,t,i){return Yt(n).onIdTokenChanged(e,t,i)}function lC(n,e,t){return Yt(n).beforeAuthStateChanged(e,t)}function oC(n,e,t,i){return Yt(n).onAuthStateChanged(e,t,i)}function U0(n){return Yt(n).signOut()}const af="__sak";class k_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(af,"1"),this.storage.removeItem(af),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const cC=1e3,uC=10;class C_ extends k_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=y_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,x)=>{this.notifyListeners(d,x)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},c=this.storage.getItem(i);kk()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,uC):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},cC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}C_.type="LOCAL";const dC=C_;class R_ extends k_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}R_.type="SESSION";const I_=R_;function hC(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Df{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Df(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const p=Array.from(d).map(async g=>g(t.origin,c)),x=await hC(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:x})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Df.receivers=[];function Ix(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class fC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((p,x)=>{const g=Ix("",20);o.port1.start();const b=setTimeout(()=>{x(new Error("unsupported_event"))},i);d={messageChannel:o,onMessage(w){const _=w;if(_.data.eventId===g)switch(_.data.status){case"ack":clearTimeout(b),c=setTimeout(()=>{x(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),p(_.data.response);break;default:clearTimeout(b),clearTimeout(c),x(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ya(){return window}function mC(n){Ya().location.href=n}function D_(){return typeof Ya().WorkerGlobalScope<"u"&&typeof Ya().importScripts=="function"}async function pC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function xC(){return navigator?.serviceWorker?.controller||null}function gC(){return D_()?self:null}const M_="firebaseLocalStorageDb",bC=1,rf="firebaseLocalStorage",O_="fbase_key";class Fu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Mf(n,e){return n.transaction([rf],e?"readwrite":"readonly").objectStore(rf)}function yC(){const n=indexedDB.deleteDatabase(M_);return new Fu(n).toPromise()}function B0(){const n=indexedDB.open(M_,bC);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(rf,{keyPath:O_})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(rf)?e(i):(i.close(),await yC(),e(await B0()))})})}async function Dw(n,e,t){const i=Mf(n,!0).put({[O_]:e,value:t});return new Fu(i).toPromise()}async function vC(n,e){const t=Mf(n,!1).get(e),i=await new Fu(t).toPromise();return i===void 0?null:i.value}function Mw(n,e){const t=Mf(n,!0).delete(e);return new Fu(t).toPromise()}const wC=800,NC=3;class P_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await B0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>NC)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return D_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Df._getInstance(gC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await pC(),!this.activeServiceWorker)return;this.sender=new fC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||xC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await B0();return await Dw(e,af,"1"),await Mw(e,af),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Dw(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>vC(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Mw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Mf(o,!1).getAll();return new Fu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}P_.type="LOCAL";const _C=P_;new Uu(3e4,6e4);function jC(n,e){return e?vr(e):(st(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Dx extends Cx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Eo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Eo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Eo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function SC(n){return E_(n.auth,new Dx(n),n.bypassAuthState)}function EC(n){const{auth:e,user:t}=n;return st(t,e,"internal-error"),nC(t,new Dx(n),n.bypassAuthState)}async function TC(n){const{auth:e,user:t}=n;return st(t,e,"internal-error"),sC(t,new Dx(n),n.bypassAuthState)}class V_{constructor(e,t,i,o,c=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:c,error:d,type:p}=e;if(d){this.reject(d);return}const x={auth:this.auth,requestUri:t,sessionId:i,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(x))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return SC;case"linkViaPopup":case"linkViaRedirect":return TC;case"reauthViaPopup":case"reauthViaRedirect":return EC;default:wa(this.auth,"internal-error")}}resolve(e){Ar(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ar(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const AC=new Uu(2e3,1e4);class No extends V_{constructor(e,t,i,o,c){super(e,t,o,c),this.provider=i,this.authWindow=null,this.pollId=null,No.currentPopupAction&&No.currentPopupAction.cancel(),No.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return st(e,this.auth,"internal-error"),e}async onExecution(){Ar(this.filter.length===1,"Popup operations only handle one event");const e=Ix();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ga(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ga(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,No.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ga(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,AC.get())};e()}}No.currentPopupAction=null;const kC="pendingRedirect",Vh=new Map;class CC extends V_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Vh.get(this.auth._key());if(!e){try{const i=await RC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Vh.set(this.auth._key(),e)}return this.bypassAuthState||Vh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function RC(n,e){const t=MC(e),i=DC(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function IC(n,e){Vh.set(n._key(),e)}function DC(n){return vr(n._redirectPersistence)}function MC(n){return Ph(kC,n.config.apiKey,n.name)}async function OC(n,e,t=!1){if(xn(n.app))return Promise.reject(_r(n));const i=Tl(n),o=jC(i,e),d=await new CC(i,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const PC=600*1e3;class VC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!LC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!L_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ga(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=PC&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ow(e))}saveEventToCache(e){this.cachedEventUids.add(Ow(e)),this.lastProcessedEventTime=Date.now()}}function Ow(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function L_({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function LC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return L_(n);default:return!1}}async function UC(n,e={}){return Di(n,"GET","/v1/projects",e)}const BC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zC=/^https?/;async function FC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await UC(n);for(const t of e)try{if($C(t))return}catch{}wa(n,"unauthorized-domain")}function $C(n){const e=P0(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!zC.test(t))return!1;if(BC.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}const qC=new Uu(3e4,6e4);function Pw(){const n=Ya().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function HC(n){return new Promise((e,t)=>{function i(){Pw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Pw(),t(Ga(n,"network-request-failed"))},timeout:qC.get()})}if(Ya().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ya().gapi?.load)i();else{const o=Lk("iframefcb");return Ya()[o]=()=>{gapi.load?i():t(Ga(n,"network-request-failed"))},w_(`${Vk()}?onload=${o}`).catch(c=>t(c))}}).catch(e=>{throw Lh=null,e})}let Lh=null;function GC(n){return Lh=Lh||HC(n),Lh}const YC=new Uu(5e3,15e3),WC="__/auth/iframe",QC="emulator/auth/iframe",KC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},XC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function JC(n){const e=n.config;st(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Tx(e,QC):`https://${n.config.authDomain}/${WC}`,i={apiKey:e.apiKey,appName:n.name,v:El},o=XC.get(n.config.apiHost);o&&(i.eid=o);const c=n._getFrameworks();return c.length&&(i.fw=c.join(",")),`${t}?${Vu(i).slice(1)}`}async function ZC(n){const e=await GC(n),t=Ya().gapi;return st(t,n,"internal-error"),e.open({where:document.body,url:JC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:KC,dontclear:!0},i=>new Promise(async(o,c)=>{await i.restyle({setHideOnLeave:!1});const d=Ga(n,"network-request-failed"),p=Ya().setTimeout(()=>{c(d)},YC.get());function x(){Ya().clearTimeout(p),o(i)}i.ping(x).then(x,()=>{c(d)})}))}const e4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},t4=500,s4=600,n4="_blank",a4="http://localhost";class Vw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function r4(n,e,t,i=t4,o=s4){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const x={...e4,width:i.toString(),height:o.toString(),top:c,left:d},g=Xs().toLowerCase();t&&(p=m_(g)?n4:t),h_(g)&&(e=e||a4,x.scrollbars="yes");const b=Object.entries(x).reduce((_,[A,L])=>`${_}${A}=${L},`,"");if(Ak(g)&&p!=="_self")return i4(e||"",p),new Vw(null);const w=window.open(e||"",p,b);st(w,n,"popup-blocked");try{w.focus()}catch{}return new Vw(w)}function i4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const l4="__/auth/handler",o4="emulator/auth/handler",c4=encodeURIComponent("fac");async function Lw(n,e,t,i,o,c){st(n.config.authDomain,n,"auth-domain-config-required"),st(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:El,eventId:o};if(e instanceof j_){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",K5(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,w]of Object.entries({}))d[b]=w}if(e instanceof zu){const b=e.getScopes().filter(w=>w!=="");b.length>0&&(d.scopes=b.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const x=await n._getAppCheckToken(),g=x?`#${c4}=${encodeURIComponent(x)}`:"";return`${u4(n)}?${Vu(p).slice(1)}${g}`}function u4({config:n}){return n.emulator?Tx(n,o4):`https://${n.authDomain}/${l4}`}const f0="webStorageSupport";class d4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=I_,this._completeRedirectFn=OC,this._overrideRedirectResult=IC}async _openPopup(e,t,i,o){Ar(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const c=await Lw(e,t,i,P0(),o);return r4(e,c,Ix())}async _openRedirect(e,t,i,o){await this._originValidation(e);const c=await Lw(e,t,i,P0(),o);return mC(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Ar(c,"If manager is not set, promise should be"),c)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await ZC(e),i=new VC(e);return t.register("authEvent",o=>(st(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(f0,{type:f0},o=>{const c=o?.[0]?.[f0];c!==void 0&&t(!!c),wa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=FC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return y_()||f_()||kx()}}const h4=d4;var Uw="@firebase/auth",Bw="1.12.0";class f4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){st(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function m4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function p4(n){ji(new Er("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;st(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const x={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:v_(n)},g=new Mk(i,o,c,x);return qk(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ji(new Er("auth-internal",e=>{const t=Tl(e.getProvider("auth").getImmediate());return(i=>new f4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),sa(Uw,Bw,m4(n)),sa(Uw,Bw,"esm2020")}const x4=300,g4=XN("authIdTokenMaxAge")||x4;let zw=null;const b4=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>g4)return;const o=t?.token;zw!==o&&(zw=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function y4(n=Rf()){const e=Lu(n,"auth");if(e.isInitialized())return e.getImmediate();const t=$k(n,{popupRedirectResolver:h4,persistence:[_C,dC,I_]}),i=XN("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(i,location.origin);if(location.origin===c.origin){const d=b4(c.toString());lC(t,d,()=>d(t.currentUser)),iC(t,p=>d(p))}}const o=QN("auth");return o&&Hk(t,`http://${o}`),t}function v4(){return document.getElementsByTagName("head")?.[0]??document}Ok({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const c=Ga("internal-error");c.customData=o,t(c)},i.type="text/javascript",i.charset="UTF-8",v4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});p4("Browser");var w4="firebase",N4="12.8.0";sa(w4,N4,"app");var Fw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var vi,U_;(function(){var n;function e(T,E){function S(){}S.prototype=E.prototype,T.F=E.prototype,T.prototype=new S,T.prototype.constructor=T,T.D=function(I,C,M){for(var R=Array(arguments.length-2),B=2;B<arguments.length;B++)R[B-2]=arguments[B];return E.prototype[C].apply(I,R)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(T,E,S){S||(S=0);const I=Array(16);if(typeof E=="string")for(var C=0;C<16;++C)I[C]=E.charCodeAt(S++)|E.charCodeAt(S++)<<8|E.charCodeAt(S++)<<16|E.charCodeAt(S++)<<24;else for(C=0;C<16;++C)I[C]=E[S++]|E[S++]<<8|E[S++]<<16|E[S++]<<24;E=T.g[0],S=T.g[1],C=T.g[2];let M=T.g[3],R;R=E+(M^S&(C^M))+I[0]+3614090360&4294967295,E=S+(R<<7&4294967295|R>>>25),R=M+(C^E&(S^C))+I[1]+3905402710&4294967295,M=E+(R<<12&4294967295|R>>>20),R=C+(S^M&(E^S))+I[2]+606105819&4294967295,C=M+(R<<17&4294967295|R>>>15),R=S+(E^C&(M^E))+I[3]+3250441966&4294967295,S=C+(R<<22&4294967295|R>>>10),R=E+(M^S&(C^M))+I[4]+4118548399&4294967295,E=S+(R<<7&4294967295|R>>>25),R=M+(C^E&(S^C))+I[5]+1200080426&4294967295,M=E+(R<<12&4294967295|R>>>20),R=C+(S^M&(E^S))+I[6]+2821735955&4294967295,C=M+(R<<17&4294967295|R>>>15),R=S+(E^C&(M^E))+I[7]+4249261313&4294967295,S=C+(R<<22&4294967295|R>>>10),R=E+(M^S&(C^M))+I[8]+1770035416&4294967295,E=S+(R<<7&4294967295|R>>>25),R=M+(C^E&(S^C))+I[9]+2336552879&4294967295,M=E+(R<<12&4294967295|R>>>20),R=C+(S^M&(E^S))+I[10]+4294925233&4294967295,C=M+(R<<17&4294967295|R>>>15),R=S+(E^C&(M^E))+I[11]+2304563134&4294967295,S=C+(R<<22&4294967295|R>>>10),R=E+(M^S&(C^M))+I[12]+1804603682&4294967295,E=S+(R<<7&4294967295|R>>>25),R=M+(C^E&(S^C))+I[13]+4254626195&4294967295,M=E+(R<<12&4294967295|R>>>20),R=C+(S^M&(E^S))+I[14]+2792965006&4294967295,C=M+(R<<17&4294967295|R>>>15),R=S+(E^C&(M^E))+I[15]+1236535329&4294967295,S=C+(R<<22&4294967295|R>>>10),R=E+(C^M&(S^C))+I[1]+4129170786&4294967295,E=S+(R<<5&4294967295|R>>>27),R=M+(S^C&(E^S))+I[6]+3225465664&4294967295,M=E+(R<<9&4294967295|R>>>23),R=C+(E^S&(M^E))+I[11]+643717713&4294967295,C=M+(R<<14&4294967295|R>>>18),R=S+(M^E&(C^M))+I[0]+3921069994&4294967295,S=C+(R<<20&4294967295|R>>>12),R=E+(C^M&(S^C))+I[5]+3593408605&4294967295,E=S+(R<<5&4294967295|R>>>27),R=M+(S^C&(E^S))+I[10]+38016083&4294967295,M=E+(R<<9&4294967295|R>>>23),R=C+(E^S&(M^E))+I[15]+3634488961&4294967295,C=M+(R<<14&4294967295|R>>>18),R=S+(M^E&(C^M))+I[4]+3889429448&4294967295,S=C+(R<<20&4294967295|R>>>12),R=E+(C^M&(S^C))+I[9]+568446438&4294967295,E=S+(R<<5&4294967295|R>>>27),R=M+(S^C&(E^S))+I[14]+3275163606&4294967295,M=E+(R<<9&4294967295|R>>>23),R=C+(E^S&(M^E))+I[3]+4107603335&4294967295,C=M+(R<<14&4294967295|R>>>18),R=S+(M^E&(C^M))+I[8]+1163531501&4294967295,S=C+(R<<20&4294967295|R>>>12),R=E+(C^M&(S^C))+I[13]+2850285829&4294967295,E=S+(R<<5&4294967295|R>>>27),R=M+(S^C&(E^S))+I[2]+4243563512&4294967295,M=E+(R<<9&4294967295|R>>>23),R=C+(E^S&(M^E))+I[7]+1735328473&4294967295,C=M+(R<<14&4294967295|R>>>18),R=S+(M^E&(C^M))+I[12]+2368359562&4294967295,S=C+(R<<20&4294967295|R>>>12),R=E+(S^C^M)+I[5]+4294588738&4294967295,E=S+(R<<4&4294967295|R>>>28),R=M+(E^S^C)+I[8]+2272392833&4294967295,M=E+(R<<11&4294967295|R>>>21),R=C+(M^E^S)+I[11]+1839030562&4294967295,C=M+(R<<16&4294967295|R>>>16),R=S+(C^M^E)+I[14]+4259657740&4294967295,S=C+(R<<23&4294967295|R>>>9),R=E+(S^C^M)+I[1]+2763975236&4294967295,E=S+(R<<4&4294967295|R>>>28),R=M+(E^S^C)+I[4]+1272893353&4294967295,M=E+(R<<11&4294967295|R>>>21),R=C+(M^E^S)+I[7]+4139469664&4294967295,C=M+(R<<16&4294967295|R>>>16),R=S+(C^M^E)+I[10]+3200236656&4294967295,S=C+(R<<23&4294967295|R>>>9),R=E+(S^C^M)+I[13]+681279174&4294967295,E=S+(R<<4&4294967295|R>>>28),R=M+(E^S^C)+I[0]+3936430074&4294967295,M=E+(R<<11&4294967295|R>>>21),R=C+(M^E^S)+I[3]+3572445317&4294967295,C=M+(R<<16&4294967295|R>>>16),R=S+(C^M^E)+I[6]+76029189&4294967295,S=C+(R<<23&4294967295|R>>>9),R=E+(S^C^M)+I[9]+3654602809&4294967295,E=S+(R<<4&4294967295|R>>>28),R=M+(E^S^C)+I[12]+3873151461&4294967295,M=E+(R<<11&4294967295|R>>>21),R=C+(M^E^S)+I[15]+530742520&4294967295,C=M+(R<<16&4294967295|R>>>16),R=S+(C^M^E)+I[2]+3299628645&4294967295,S=C+(R<<23&4294967295|R>>>9),R=E+(C^(S|~M))+I[0]+4096336452&4294967295,E=S+(R<<6&4294967295|R>>>26),R=M+(S^(E|~C))+I[7]+1126891415&4294967295,M=E+(R<<10&4294967295|R>>>22),R=C+(E^(M|~S))+I[14]+2878612391&4294967295,C=M+(R<<15&4294967295|R>>>17),R=S+(M^(C|~E))+I[5]+4237533241&4294967295,S=C+(R<<21&4294967295|R>>>11),R=E+(C^(S|~M))+I[12]+1700485571&4294967295,E=S+(R<<6&4294967295|R>>>26),R=M+(S^(E|~C))+I[3]+2399980690&4294967295,M=E+(R<<10&4294967295|R>>>22),R=C+(E^(M|~S))+I[10]+4293915773&4294967295,C=M+(R<<15&4294967295|R>>>17),R=S+(M^(C|~E))+I[1]+2240044497&4294967295,S=C+(R<<21&4294967295|R>>>11),R=E+(C^(S|~M))+I[8]+1873313359&4294967295,E=S+(R<<6&4294967295|R>>>26),R=M+(S^(E|~C))+I[15]+4264355552&4294967295,M=E+(R<<10&4294967295|R>>>22),R=C+(E^(M|~S))+I[6]+2734768916&4294967295,C=M+(R<<15&4294967295|R>>>17),R=S+(M^(C|~E))+I[13]+1309151649&4294967295,S=C+(R<<21&4294967295|R>>>11),R=E+(C^(S|~M))+I[4]+4149444226&4294967295,E=S+(R<<6&4294967295|R>>>26),R=M+(S^(E|~C))+I[11]+3174756917&4294967295,M=E+(R<<10&4294967295|R>>>22),R=C+(E^(M|~S))+I[2]+718787259&4294967295,C=M+(R<<15&4294967295|R>>>17),R=S+(M^(C|~E))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+E&4294967295,T.g[1]=T.g[1]+(C+(R<<21&4294967295|R>>>11))&4294967295,T.g[2]=T.g[2]+C&4294967295,T.g[3]=T.g[3]+M&4294967295}i.prototype.v=function(T,E){E===void 0&&(E=T.length);const S=E-this.blockSize,I=this.C;let C=this.h,M=0;for(;M<E;){if(C==0)for(;M<=S;)o(this,T,M),M+=this.blockSize;if(typeof T=="string"){for(;M<E;)if(I[C++]=T.charCodeAt(M++),C==this.blockSize){o(this,I),C=0;break}}else for(;M<E;)if(I[C++]=T[M++],C==this.blockSize){o(this,I),C=0;break}}this.h=C,this.o+=E},i.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var E=1;E<T.length-8;++E)T[E]=0;E=this.o*8;for(var S=T.length-8;S<T.length;++S)T[S]=E&255,E/=256;for(this.v(T),T=Array(16),E=0,S=0;S<4;++S)for(let I=0;I<32;I+=8)T[E++]=this.g[S]>>>I&255;return T};function c(T,E){var S=p;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=E(T)}function d(T,E){this.h=E;const S=[];let I=!0;for(let C=T.length-1;C>=0;C--){const M=T[C]|0;I&&M==E||(S[C]=M,I=!1)}this.g=S}var p={};function x(T){return-128<=T&&T<128?c(T,function(E){return new d([E|0],E<0?-1:0)}):new d([T|0],T<0?-1:0)}function g(T){if(isNaN(T)||!isFinite(T))return w;if(T<0)return F(g(-T));const E=[];let S=1;for(let I=0;T>=S;I++)E[I]=T/S|0,S*=4294967296;return new d(E,0)}function b(T,E){if(T.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(T.charAt(0)=="-")return F(b(T.substring(1),E));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=g(Math.pow(E,8));let I=w;for(let M=0;M<T.length;M+=8){var C=Math.min(8,T.length-M);const R=parseInt(T.substring(M,M+C),E);C<8?(C=g(Math.pow(E,C)),I=I.j(C).add(g(R))):(I=I.j(S),I=I.add(g(R)))}return I}var w=x(0),_=x(1),A=x(16777216);n=d.prototype,n.m=function(){if(V(this))return-F(this).m();let T=0,E=1;for(let S=0;S<this.g.length;S++){const I=this.i(S);T+=(I>=0?I:4294967296+I)*E,E*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(L(this))return"0";if(V(this))return"-"+F(this).toString(T);const E=g(Math.pow(T,6));var S=this;let I="";for(;;){const C=ie(S,E).g;S=q(S,C.j(E));let M=((S.g.length>0?S.g[0]:S.h)>>>0).toString(T);if(S=C,L(S))return M+I;for(;M.length<6;)M="0"+M;I=M+I}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function L(T){if(T.h!=0)return!1;for(let E=0;E<T.g.length;E++)if(T.g[E]!=0)return!1;return!0}function V(T){return T.h==-1}n.l=function(T){return T=q(this,T),V(T)?-1:L(T)?0:1};function F(T){const E=T.g.length,S=[];for(let I=0;I<E;I++)S[I]=~T.g[I];return new d(S,~T.h).add(_)}n.abs=function(){return V(this)?F(this):this},n.add=function(T){const E=Math.max(this.g.length,T.g.length),S=[];let I=0;for(let C=0;C<=E;C++){let M=I+(this.i(C)&65535)+(T.i(C)&65535),R=(M>>>16)+(this.i(C)>>>16)+(T.i(C)>>>16);I=R>>>16,M&=65535,R&=65535,S[C]=R<<16|M}return new d(S,S[S.length-1]&-2147483648?-1:0)};function q(T,E){return T.add(F(E))}n.j=function(T){if(L(this)||L(T))return w;if(V(this))return V(T)?F(this).j(F(T)):F(F(this).j(T));if(V(T))return F(this.j(F(T)));if(this.l(A)<0&&T.l(A)<0)return g(this.m()*T.m());const E=this.g.length+T.g.length,S=[];for(var I=0;I<2*E;I++)S[I]=0;for(I=0;I<this.g.length;I++)for(let C=0;C<T.g.length;C++){const M=this.i(I)>>>16,R=this.i(I)&65535,B=T.i(C)>>>16,P=T.i(C)&65535;S[2*I+2*C]+=R*P,Q(S,2*I+2*C),S[2*I+2*C+1]+=M*P,Q(S,2*I+2*C+1),S[2*I+2*C+1]+=R*B,Q(S,2*I+2*C+1),S[2*I+2*C+2]+=M*B,Q(S,2*I+2*C+2)}for(T=0;T<E;T++)S[T]=S[2*T+1]<<16|S[2*T];for(T=E;T<2*E;T++)S[T]=0;return new d(S,0)};function Q(T,E){for(;(T[E]&65535)!=T[E];)T[E+1]+=T[E]>>>16,T[E]&=65535,E++}function H(T,E){this.g=T,this.h=E}function ie(T,E){if(L(E))throw Error("division by zero");if(L(T))return new H(w,w);if(V(T))return E=ie(F(T),E),new H(F(E.g),F(E.h));if(V(E))return E=ie(T,F(E)),new H(F(E.g),E.h);if(T.g.length>30){if(V(T)||V(E))throw Error("slowDivide_ only works with positive integers.");for(var S=_,I=E;I.l(T)<=0;)S=le(S),I=le(I);var C=Y(S,1),M=Y(I,1);for(I=Y(I,2),S=Y(S,2);!L(I);){var R=M.add(I);R.l(T)<=0&&(C=C.add(S),M=R),I=Y(I,1),S=Y(S,1)}return E=q(T,C.j(E)),new H(C,E)}for(C=w;T.l(E)>=0;){for(S=Math.max(1,Math.floor(T.m()/E.m())),I=Math.ceil(Math.log(S)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),M=g(S),R=M.j(E);V(R)||R.l(T)>0;)S-=I,M=g(S),R=M.j(E);L(M)&&(M=_),C=C.add(M),T=q(T,R)}return new H(C,T)}n.B=function(T){return ie(this,T).h},n.and=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let I=0;I<E;I++)S[I]=this.i(I)&T.i(I);return new d(S,this.h&T.h)},n.or=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let I=0;I<E;I++)S[I]=this.i(I)|T.i(I);return new d(S,this.h|T.h)},n.xor=function(T){const E=Math.max(this.g.length,T.g.length),S=[];for(let I=0;I<E;I++)S[I]=this.i(I)^T.i(I);return new d(S,this.h^T.h)};function le(T){const E=T.g.length+1,S=[];for(let I=0;I<E;I++)S[I]=T.i(I)<<1|T.i(I-1)>>>31;return new d(S,T.h)}function Y(T,E){const S=E>>5;E%=32;const I=T.g.length-S,C=[];for(let M=0;M<I;M++)C[M]=E>0?T.i(M+S)>>>E|T.i(M+S+1)<<32-E:T.i(M+S);return new d(C,T.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,U_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=g,d.fromString=b,vi=d}).apply(typeof Fw<"u"?Fw:typeof self<"u"?self:typeof window<"u"?window:{});var vh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var B_,lu,z_,Uh,z0,F_,$_,q_;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof vh=="object"&&vh];for(var y=0;y<h.length;++y){var N=h[y];if(N&&N.Math==Math)return N}throw Error("Cannot find global object")}var i=t(this);function o(h,y){if(y)e:{var N=i;h=h.split(".");for(var D=0;D<h.length-1;D++){var J=h[D];if(!(J in N))break e;N=N[J]}h=h[h.length-1],D=N[h],y=y(D),y!=D&&y!=null&&e(N,h,{configurable:!0,writable:!0,value:y})}}o("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(h){return h||function(y){var N=[],D;for(D in y)Object.prototype.hasOwnProperty.call(y,D)&&N.push([D,y[D]]);return N}});var c=c||{},d=this||self;function p(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function x(h,y,N){return h.call.apply(h.bind,arguments)}function g(h,y,N){return g=x,g.apply(null,arguments)}function b(h,y){var N=Array.prototype.slice.call(arguments,1);return function(){var D=N.slice();return D.push.apply(D,arguments),h.apply(this,D)}}function w(h,y){function N(){}N.prototype=y.prototype,h.Z=y.prototype,h.prototype=new N,h.prototype.constructor=h,h.Ob=function(D,J,re){for(var Re=Array(arguments.length-2),ht=2;ht<arguments.length;ht++)Re[ht-2]=arguments[ht];return y.prototype[J].apply(D,Re)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function A(h){const y=h.length;if(y>0){const N=Array(y);for(let D=0;D<y;D++)N[D]=h[D];return N}return[]}function L(h,y){for(let D=1;D<arguments.length;D++){const J=arguments[D];var N=typeof J;if(N=N!="object"?N:J?Array.isArray(J)?"array":N:"null",N=="array"||N=="object"&&typeof J.length=="number"){N=h.length||0;const re=J.length||0;h.length=N+re;for(let Re=0;Re<re;Re++)h[N+Re]=J[Re]}else h.push(J)}}class V{constructor(y,N){this.i=y,this.j=N,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function F(h){d.setTimeout(()=>{throw h},0)}function q(){var h=T;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class Q{constructor(){this.h=this.g=null}add(y,N){const D=H.get();D.set(y,N),this.h?this.h.next=D:this.g=D,this.h=D}}var H=new V(()=>new ie,h=>h.reset());class ie{constructor(){this.next=this.g=this.h=null}set(y,N){this.h=y,this.g=N,this.next=null}reset(){this.next=this.g=this.h=null}}let le,Y=!1,T=new Q,E=()=>{const h=Promise.resolve(void 0);le=()=>{h.then(S)}};function S(){for(var h;h=q();){try{h.h.call(h.g)}catch(N){F(N)}var y=H;y.j(h),y.h<100&&(y.h++,h.next=y.g,y.g=h)}Y=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const N=()=>{};d.addEventListener("test",N,y),d.removeEventListener("test",N,y)}catch{}return h})();function R(h){return/^[\s\xa0]*$/.test(h)}function B(h,y){C.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,y)}w(B,C),B.prototype.init=function(h,y){const N=this.type=h.type,D=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget,y||(N=="mouseover"?y=h.fromElement:N=="mouseout"&&(y=h.toElement)),this.relatedTarget=y,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&B.Z.h.call(this)},B.prototype.h=function(){B.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var P="closure_listenable_"+(Math.random()*1e6|0),O=0;function K(h,y,N,D,J){this.listener=h,this.proxy=null,this.src=y,this.type=N,this.capture=!!D,this.ha=J,this.key=++O,this.da=this.fa=!1}function oe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function be(h,y,N){for(const D in h)y.call(N,h[D],D,h)}function fe(h,y){for(const N in h)y.call(void 0,h[N],N,h)}function U(h){const y={};for(const N in h)y[N]=h[N];return y}const Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(h,y){let N,D;for(let J=1;J<arguments.length;J++){D=arguments[J];for(N in D)h[N]=D[N];for(let re=0;re<Z.length;re++)N=Z[re],Object.prototype.hasOwnProperty.call(D,N)&&(h[N]=D[N])}}function me(h){this.src=h,this.g={},this.h=0}me.prototype.add=function(h,y,N,D,J){const re=h.toString();h=this.g[re],h||(h=this.g[re]=[],this.h++);const Re=De(h,y,D,J);return Re>-1?(y=h[Re],N||(y.fa=!1)):(y=new K(y,this.src,re,!!D,J),y.fa=N,h.push(y)),y};function ge(h,y){const N=y.type;if(N in h.g){var D=h.g[N],J=Array.prototype.indexOf.call(D,y,void 0),re;(re=J>=0)&&Array.prototype.splice.call(D,J,1),re&&(oe(y),h.g[N].length==0&&(delete h.g[N],h.h--))}}function De(h,y,N,D){for(let J=0;J<h.length;++J){const re=h[J];if(!re.da&&re.listener==y&&re.capture==!!N&&re.ha==D)return J}return-1}var Ye="closure_lm_"+(Math.random()*1e6|0),pt={};function dt(h,y,N,D,J){if(Array.isArray(y)){for(let re=0;re<y.length;re++)dt(h,y[re],N,D,J);return null}return N=it(N),h&&h[P]?h.J(y,N,p(D)?!!D.capture:!1,J):Wt(h,y,N,!1,D,J)}function Wt(h,y,N,D,J,re){if(!y)throw Error("Invalid event type");const Re=p(J)?!!J.capture:!!J;let ht=Ve(h);if(ht||(h[Ye]=ht=new me(h)),N=ht.add(y,N,D,Re,re),N.proxy)return N;if(D=ne(),N.proxy=D,D.src=h,D.listener=N,h.addEventListener)M||(J=Re),J===void 0&&(J=!1),h.addEventListener(y.toString(),D,J);else if(h.attachEvent)h.attachEvent(ye(y.toString()),D);else if(h.addListener&&h.removeListener)h.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return N}function ne(){function h(N){return y.call(h.src,h.listener,N)}const y=Ae;return h}function Te(h,y,N,D,J){if(Array.isArray(y))for(var re=0;re<y.length;re++)Te(h,y[re],N,D,J);else D=p(D)?!!D.capture:!!D,N=it(N),h&&h[P]?(h=h.i,re=String(y).toString(),re in h.g&&(y=h.g[re],N=De(y,N,D,J),N>-1&&(oe(y[N]),Array.prototype.splice.call(y,N,1),y.length==0&&(delete h.g[re],h.h--)))):h&&(h=Ve(h))&&(y=h.g[y.toString()],h=-1,y&&(h=De(y,N,D,J)),(N=h>-1?y[h]:null)&&W(N))}function W(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[P])ge(y.i,h);else{var N=h.type,D=h.proxy;y.removeEventListener?y.removeEventListener(N,D,h.capture):y.detachEvent?y.detachEvent(ye(N),D):y.addListener&&y.removeListener&&y.removeListener(D),(N=Ve(y))?(ge(N,h),N.h==0&&(N.src=null,y[Ye]=null)):oe(h)}}}function ye(h){return h in pt?pt[h]:pt[h]="on"+h}function Ae(h,y){if(h.da)h=!0;else{y=new B(y,this);const N=h.listener,D=h.ha||h.src;h.fa&&W(h),h=N.call(D,y)}return h}function Ve(h){return h=h[Ye],h instanceof me?h:null}var xt="__closure_events_fn_"+(Math.random()*1e9>>>0);function it(h){return typeof h=="function"?h:(h[xt]||(h[xt]=function(y){return h.handleEvent(y)}),h[xt])}function rt(){I.call(this),this.i=new me(this),this.M=this,this.G=null}w(rt,I),rt.prototype[P]=!0,rt.prototype.removeEventListener=function(h,y,N,D){Te(this,h,y,N,D)};function Ce(h,y){var N,D=h.G;if(D)for(N=[];D;D=D.G)N.push(D);if(h=h.M,D=y.type||y,typeof y=="string")y=new C(y,h);else if(y instanceof C)y.target=y.target||h;else{var J=y;y=new C(D,h),ue(y,J)}J=!0;let re,Re;if(N)for(Re=N.length-1;Re>=0;Re--)re=y.g=N[Re],J=Le(re,D,!0,y)&&J;if(re=y.g=h,J=Le(re,D,!0,y)&&J,J=Le(re,D,!1,y)&&J,N)for(Re=0;Re<N.length;Re++)re=y.g=N[Re],J=Le(re,D,!1,y)&&J}rt.prototype.N=function(){if(rt.Z.N.call(this),this.i){var h=this.i;for(const y in h.g){const N=h.g[y];for(let D=0;D<N.length;D++)oe(N[D]);delete h.g[y],h.h--}}this.G=null},rt.prototype.J=function(h,y,N,D){return this.i.add(String(h),y,!1,N,D)},rt.prototype.K=function(h,y,N,D){return this.i.add(String(h),y,!0,N,D)};function Le(h,y,N,D){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();let J=!0;for(let re=0;re<y.length;++re){const Re=y[re];if(Re&&!Re.da&&Re.capture==N){const ht=Re.listener,hs=Re.ha||Re.src;Re.fa&&ge(h.i,Re),J=ht.call(hs,D)!==!1&&J}}return J&&!D.defaultPrevented}function pe(h,y){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:d.setTimeout(h,y||0)}function Ke(h){h.g=pe(()=>{h.g=null,h.i&&(h.i=!1,Ke(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Fe extends I{constructor(y,N){super(),this.m=y,this.l=N,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Ke(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Oe(h){I.call(this),this.h=h,this.g={}}w(Oe,I);var We=[];function Qe(h){be(h.g,function(y,N){this.g.hasOwnProperty(N)&&W(y)},h),h.g={}}Oe.prototype.N=function(){Oe.Z.N.call(this),Qe(this)},Oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var es=d.JSON.stringify,nn=d.JSON.parse,Sn=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Js(){}function Hs(){}var xs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Lt(){C.call(this,"d")}w(Lt,C);function gs(){C.call(this,"c")}w(gs,C);var z={},ae=null;function Ee(){return ae=ae||new rt}z.Ia="serverreachability";function Se(h){C.call(this,z.Ia,h)}w(Se,C);function Ue(h){const y=Ee();Ce(y,new Se(y))}z.STAT_EVENT="statevent";function de(h,y){C.call(this,z.STAT_EVENT,h),this.stat=y}w(de,C);function je(h){const y=Ee();Ce(y,new de(y,h))}z.Ja="timingevent";function ke(h,y){C.call(this,z.Ja,h),this.size=y}w(ke,C);function $e(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},y)}function ot(){this.g=!0}ot.prototype.ua=function(){this.g=!1};function ze(h,y,N,D,J,re){h.info(function(){if(h.g)if(re){var Re="",ht=re.split("&");for(let Ct=0;Ct<ht.length;Ct++){var hs=ht[Ct].split("=");if(hs.length>1){const ts=hs[0];hs=hs[1];const $n=ts.split("_");Re=$n.length>=2&&$n[1]=="type"?Re+(ts+"="+hs+"&"):Re+(ts+"=redacted&")}}}else Re=null;else Re=re;return"XMLHTTP REQ ("+D+") [attempt "+J+"]: "+y+`
`+N+`
`+Re})}function qe(h,y,N,D,J,re,Re){h.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+J+"]: "+y+`
`+N+`
`+re+" "+Re})}function kt(h,y,N,D){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+an(h,N)+(D?" "+D:"")})}function Kt(h,y){h.info(function(){return"TIMEOUT: "+y})}ot.prototype.info=function(){};function an(h,y){if(!h.g)return y;if(!y)return null;try{const re=JSON.parse(y);if(re){for(h=0;h<re.length;h++)if(Array.isArray(re[h])){var N=re[h];if(!(N.length<2)){var D=N[1];if(Array.isArray(D)&&!(D.length<1)){var J=D[0];if(J!="noop"&&J!="stop"&&J!="close")for(let Re=1;Re<D.length;Re++)D[Re]=""}}}}return es(re)}catch{return y}}var rn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ra={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ia;function la(){}w(la,Js),la.prototype.g=function(){return new XMLHttpRequest},ia=new la;function as(h){return encodeURIComponent(String(h))}function Pi(h){var y=1;h=h.split(":");const N=[];for(;y>0&&h.length;)N.push(h.shift()),y--;return h.length&&N.push(h.join(":")),N}function bs(h,y,N,D){this.j=h,this.i=y,this.l=N,this.S=D||1,this.V=new Oe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ln}function ln(){this.i=null,this.g="",this.h=!1}var is={},ys={};function En(h,y,N){h.M=1,h.A=Li(ws(y)),h.u=N,h.R=!0,Vi(h,null)}function Vi(h,y){h.F=Date.now(),Ea(h),h.B=ws(h.A);var N=h.B,D=h.S;Array.isArray(D)||(D=[String(D)]),Ml(N.i,"t",D),h.C=0,N=h.j.L,h.h=new ln,h.g=dd(h.j,N?y:null,!h.u),h.P>0&&(h.O=new Fe(g(h.Y,h,h.g),h.P)),y=h.V,N=h.g,D=h.ba;var J="readystatechange";Array.isArray(J)||(J&&(We[0]=J.toString()),J=We);for(let re=0;re<J.length;re++){const Re=dt(N,J[re],D||y.handleEvent,!1,y.h||y);if(!Re)break;y.g[Re.key]=Re}y=h.J?U(h.J):{},h.u?(h.v||(h.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,y)):(h.v="GET",h.g.ea(h.B,h.v,null,y)),Ue(),ze(h.i,h.v,h.B,h.l,h.S,h.u)}bs.prototype.ba=function(h){h=h.target;const y=this.O;y&&ua(h)==3?y.j():this.Y(h)},bs.prototype.Y=function(h){try{if(h==this.g)e:{const ht=ua(this.g),hs=this.g.ya(),Ct=this.g.ca();if(!(ht<3)&&(ht!=3||this.g&&(this.h.h||this.g.la()||Vs(this.g)))){this.K||ht!=4||hs==7||(hs==8||Ct<=0?Ue(3):Ue(2)),Ta(this);var y=this.g.ca();this.X=y;var N=am(this);if(this.o=y==200,qe(this.i,this.v,this.B,this.l,this.S,ht,y),this.o){if(this.U&&!this.L){t:{if(this.g){var D,J=this.g;if((D=J.g?J.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(D)){var re=D;break t}}re=null}if(h=re)kt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Aa(this,h);else{this.o=!1,this.m=3,je(12),Tn(this),Bn(this);break e}}if(this.R){h=!0;let ts;for(;!this.K&&this.C<N.length;)if(ts=Ju(this,N),ts==ys){ht==4&&(this.m=4,je(14),h=!1),kt(this.i,this.l,null,"[Incomplete Response]");break}else if(ts==is){this.m=4,je(15),kt(this.i,this.l,N,"[Invalid Chunk]"),h=!1;break}else kt(this.i,this.l,ts,null),Aa(this,ts);if(Xu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ht!=4||N.length!=0||this.h.h||(this.m=1,je(16),h=!1),this.o=this.o&&h,!h)kt(this.i,this.l,N,"[Invalid Chunked Response]"),Tn(this),Bn(this);else if(N.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),hc(Re),Re.P=!0,je(11))}}else kt(this.i,this.l,N,null),Aa(this,N);ht==4&&Tn(this),this.o&&!this.K&&(ht==4?ld(this.j,this):(this.o=!1,Ea(this)))}else tr(this.g),y==400&&N.indexOf("Unknown SID")>0?(this.m=3,je(12)):(this.m=0,je(13)),Tn(this),Bn(this)}}}catch{}};function am(h){if(!Xu(h))return h.g.la();const y=Vs(h.g);if(y==="")return"";let N="";const D=y.length,J=ua(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Tn(h),Bn(h),"";h.h.i=new d.TextDecoder}for(let re=0;re<D;re++)h.h.h=!0,N+=h.h.i.decode(y[re],{stream:!(J&&re==D-1)});return y.length=0,h.h.g+=N,h.C=0,h.h.g}function Xu(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Ju(h,y){var N=h.C,D=y.indexOf(`
`,N);return D==-1?ys:(N=Number(y.substring(N,D)),isNaN(N)?is:(D+=1,D+N>y.length?ys:(y=y.slice(D,D+N),h.C=D+N,y)))}bs.prototype.cancel=function(){this.K=!0,Tn(this)};function Ea(h){h.T=Date.now()+h.H,Rl(h,h.H)}function Rl(h,y){if(h.D!=null)throw Error("WatchDog timer not null");h.D=$e(g(h.aa,h),y)}function Ta(h){h.D&&(d.clearTimeout(h.D),h.D=null)}bs.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Kt(this.i,this.B),this.M!=2&&(Ue(),je(17)),Tn(this),this.m=2,Bn(this)):Rl(this,this.T-h)};function Bn(h){h.j.I==0||h.K||ld(h.j,h)}function Tn(h){Ta(h);var y=h.O;y&&typeof y.dispose=="function"&&y.dispose(),h.O=null,Qe(h.V),h.g&&(y=h.g,h.g=null,y.abort(),y.dispose())}function Aa(h,y){try{var N=h.j;if(N.I!=0&&(N.g==h||Ca(N.h,h))){if(!h.L&&Ca(N.h,h)&&N.I==3){try{var D=N.Ba.g.parse(y)}catch{D=null}if(Array.isArray(D)&&D.length==3){var J=D;if(J[0]==0){e:if(!N.v){if(N.g)if(N.g.F+3e3<h.F)Ul(N),Br(N);else break e;Hi(N),je(18)}}else N.xa=J[1],0<N.xa-N.K&&J[2]<37500&&N.F&&N.A==0&&!N.C&&(N.C=$e(g(N.Va,N),6e3));ka(N.h)<=1&&N.ta&&(N.ta=void 0)}else Pa(N,11)}else if((h.L||N.g==h)&&Ul(N),!R(y))for(J=N.Ba.g.parse(y),y=0;y<J.length;y++){let Ct=J[y];const ts=Ct[0];if(!(ts<=N.K))if(N.K=ts,Ct=Ct[1],N.I==2)if(Ct[0]=="c"){N.M=Ct[1],N.ba=Ct[2];const $n=Ct[3];$n!=null&&(N.ka=$n,N.j.info("VER="+N.ka));const Va=Ct[4];Va!=null&&(N.za=Va,N.j.info("SVER="+N.za));const da=Ct[5];da!=null&&typeof da=="number"&&da>0&&(D=1.5*da,N.O=D,N.j.info("backChannelRequestTimeoutMs_="+D)),D=N;const ha=h.g;if(ha){const Gi=ha.g?ha.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Gi){var re=D.h;re.g||Gi.indexOf("spdy")==-1&&Gi.indexOf("quic")==-1&&Gi.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&(ec(re,re.h),re.h=null))}if(D.G){const Bl=ha.g?ha.g.getResponseHeader("X-HTTP-Session-Id"):null;Bl&&(D.wa=Bl,Ot(D.J,D.G,Bl))}}N.I=3,N.l&&N.l.ra(),N.aa&&(N.T=Date.now()-h.F,N.j.info("Handshake RTT: "+N.T+"ms")),D=N;var Re=h;if(D.na=ud(D,D.L?D.ba:null,D.W),Re.L){tc(D.h,Re);var ht=Re,hs=D.O;hs&&(ht.H=hs),ht.D&&(Ta(ht),Ea(ht)),D.g=Re}else rd(D);N.i.length>0&&Oa(N)}else Ct[0]!="stop"&&Ct[0]!="close"||Pa(N,7);else N.I==3&&(Ct[0]=="stop"||Ct[0]=="close"?Ct[0]=="stop"?Pa(N,7):uc(N):Ct[0]!="noop"&&N.l&&N.l.qa(Ct),N.A=0)}}Ue(4)}catch{}}var vs=class{constructor(h,y){this.g=h,this.map=y}};function Jo(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Zo(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ka(h){return h.h?1:h.g?h.g.size:0}function Ca(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function ec(h,y){h.g?h.g.add(y):h.h=y}function tc(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Jo.prototype.cancel=function(){if(this.i=sc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function sc(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const N of h.g.values())y=y.concat(N.G);return y}return A(h.i)}var Zu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Il(h,y){if(h){h=h.split("&");for(let N=0;N<h.length;N++){const D=h[N].indexOf("=");let J,re=null;D>=0?(J=h[N].substring(0,D),re=h[N].substring(D+1)):J=h[N],y(J,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function An(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;h instanceof An?(this.l=h.l,Ms(this,h.j),this.o=h.o,this.g=h.g,Dr(this,h.u),this.h=h.h,nc(this,nd(h.i)),this.m=h.m):h&&(y=String(h).match(Zu))?(this.l=!1,Ms(this,y[1]||"",!0),this.o=Ra(y[2]||""),this.g=Ra(y[3]||"",!0),Dr(this,y[4]),this.h=Ra(y[5]||"",!0),nc(this,y[6]||"",!0),this.m=Ra(y[7]||"")):(this.l=!1,this.i=new Or(null,this.l))}An.prototype.toString=function(){const h=[];var y=this.j;y&&h.push(Ui(y,Dl,!0),":");var N=this.g;return(N||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Ui(y,Dl,!0),"@"),h.push(as(N).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N=this.u,N!=null&&h.push(":",String(N))),(N=this.h)&&(this.g&&N.charAt(0)!="/"&&h.push("/"),h.push(Ui(N,N.charAt(0)=="/"?ac:ed,!0))),(N=this.i.toString())&&h.push("?",N),(N=this.m)&&h.push("#",Ui(N,td)),h.join("")},An.prototype.resolve=function(h){const y=ws(this);let N=!!h.j;N?Ms(y,h.j):N=!!h.o,N?y.o=h.o:N=!!h.g,N?y.g=h.g:N=h.u!=null;var D=h.h;if(N)Dr(y,h.u);else if(N=!!h.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var J=y.h.lastIndexOf("/");J!=-1&&(D=y.h.slice(0,J+1)+D)}if(J=D,J==".."||J==".")D="";else if(J.indexOf("./")!=-1||J.indexOf("/.")!=-1){D=J.lastIndexOf("/",0)==0,J=J.split("/");const re=[];for(let Re=0;Re<J.length;){const ht=J[Re++];ht=="."?D&&Re==J.length&&re.push(""):ht==".."?((re.length>1||re.length==1&&re[0]!="")&&re.pop(),D&&Re==J.length&&re.push("")):(re.push(ht),D=!0)}D=re.join("/")}else D=J}return N?y.h=D:N=h.i.toString()!=="",N?nc(y,nd(h.i)):N=!!h.m,N&&(y.m=h.m),y};function ws(h){return new An(h)}function Ms(h,y,N){h.j=N?Ra(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Dr(h,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);h.u=y}else h.u=null}function nc(h,y,N){y instanceof Or?(h.i=y,Ol(h.i,h.l)):(N||(y=Ui(y,Mr)),h.i=new Or(y,h.l))}function Ot(h,y,N){h.i.set(y,N)}function Li(h){return Ot(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Ra(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ui(h,y,N){return typeof h=="string"?(h=encodeURI(h).replace(y,on),N&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function on(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Dl=/[#\/\?@]/g,ed=/[#\?:]/g,ac=/[#\?]/g,Mr=/[#\?@]/g,td=/#/g;function Or(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function cn(h){h.g||(h.g=new Map,h.h=0,h.i&&Il(h.i,function(y,N){h.add(decodeURIComponent(y.replace(/\+/g," ")),N)}))}n=Or.prototype,n.add=function(h,y){cn(this),this.i=null,h=Pr(this,h);let N=this.g.get(h);return N||this.g.set(h,N=[]),N.push(y),this.h+=1,this};function sd(h,y){cn(h),y=Pr(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function rc(h,y){return cn(h),y=Pr(h,y),h.g.has(y)}n.forEach=function(h,y){cn(this),this.g.forEach(function(N,D){N.forEach(function(J){h.call(y,J,D,this)},this)},this)};function ic(h,y){cn(h);let N=[];if(typeof y=="string")rc(h,y)&&(N=N.concat(h.g.get(Pr(h,y))));else for(h=Array.from(h.g.values()),y=0;y<h.length;y++)N=N.concat(h[y]);return N}n.set=function(h,y){return cn(this),this.i=null,h=Pr(this,h),rc(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=ic(this,h),h.length>0?String(h[0]):y):y};function Ml(h,y,N){sd(h,y),N.length>0&&(h.i=null,h.g.set(Pr(h,y),A(N)),h.h+=N.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(let D=0;D<y.length;D++){var N=y[D];const J=as(N);N=ic(this,N);for(let re=0;re<N.length;re++){let Re=J;N[re]!==""&&(Re+="="+as(N[re])),h.push(Re)}}return this.i=h.join("&")};function nd(h){const y=new Or;return y.i=h.i,h.g&&(y.g=new Map(h.g),y.h=h.h),y}function Pr(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Ol(h,y){y&&!h.j&&(cn(h),h.i=null,h.g.forEach(function(N,D){const J=D.toLowerCase();D!=J&&(sd(this,D),Ml(this,J,N))},h)),h.j=y}function oa(h,y){const N=new ot;if(d.Image){const D=new Image;D.onload=b(zn,N,"TestLoadImage: loaded",!0,y,D),D.onerror=b(zn,N,"TestLoadImage: error",!1,y,D),D.onabort=b(zn,N,"TestLoadImage: abort",!1,y,D),D.ontimeout=b(zn,N,"TestLoadImage: timeout",!1,y,D),d.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=h}else y(!1)}function lc(h,y){const N=new ot,D=new AbortController,J=setTimeout(()=>{D.abort(),zn(N,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:D.signal}).then(re=>{clearTimeout(J),re.ok?zn(N,"TestPingServer: ok",!0,y):zn(N,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(J),zn(N,"TestPingServer: error",!1,y)})}function zn(h,y,N,D,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),D(N)}catch{}}function Vr(){this.g=new Sn}function Ia(h){this.i=h.Sb||null,this.h=h.ab||!1}w(Ia,Js),Ia.prototype.g=function(){return new Bi(this.i,this.h)};function Bi(h,y){rt.call(this),this.H=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(Bi,rt),n=Bi.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=y,this.readyState=1,ca(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(y.body=h),(this.H||d).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Lr(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ca(this)),this.g&&(this.readyState=3,ca(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Pl(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Pl(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Lr(this):ca(this),this.readyState==3&&Pl(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,Lr(this))},n.Na=function(h){this.g&&(this.response=h,Lr(this))},n.ga=function(){this.g&&Lr(this)};function Lr(h){h.readyState=4,h.l=null,h.j=null,h.B=null,ca(h)}n.setRequestHeader=function(h,y){this.A.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var N=y.next();!N.done;)N=N.value,h.push(N[0]+": "+N[1]),N=y.next();return h.join(`\r
`)};function ca(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Bi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Fn(h){let y="";return be(h,function(N,D){y+=D,y+=":",y+=N,y+=`\r
`}),y}function zi(h,y,N){e:{for(D in N){var D=!1;break e}D=!0}D||(N=Fn(N),typeof h=="string"?N!=null&&as(N):Ot(h,y,N))}function Ut(h){rt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(Ut,rt);var Da=/^https?$/i,oc=["POST","PUT"];n=Ut.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,y,N,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ia.g(),this.g.onreadystatechange=_(g(this.Ca,this));try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(re){Fi(this,re);return}if(h=N||"",N=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var J in D)N.set(J,D[J]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const re of D.keys())N.set(re,D.get(re));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(N.keys()).find(re=>re.toLowerCase()=="content-type"),J=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(oc,y,void 0)>=0)||D||J||N.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,Re]of N)this.g.setRequestHeader(re,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(re){Fi(this,re)}};function Fi(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.o=5,cc(h),er(h)}function cc(h){h.A||(h.A=!0,Ce(h,"complete"),Ce(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ce(this,"complete"),Ce(this,"abort"),er(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),er(this,!0)),Ut.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?$i(this):this.Xa())},n.Xa=function(){$i(this)};function $i(h){if(h.h&&typeof c<"u"){if(h.v&&ua(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ce(h,"readystatechange"),ua(h)==4){h.h=!1;try{const re=h.ca();e:switch(re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var N;if(!(N=y)){var D;if(D=re===0){let Re=String(h.D).match(Zu)[1]||null;!Re&&d.self&&d.self.location&&(Re=d.self.location.protocol.slice(0,-1)),D=!Da.test(Re?Re.toLowerCase():"")}N=D}if(N)Ce(h,"complete"),Ce(h,"success");else{h.o=6;try{var J=ua(h)>2?h.g.statusText:""}catch{J=""}h.l=J+" ["+h.ca()+"]",cc(h)}}finally{er(h)}}}}function er(h,y){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const N=h.g;h.g=null,y||Ce(h,"ready");try{N.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ua(h){return h.g?h.g.readyState:0}n.ca=function(){try{return ua(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),nn(y)}};function Vs(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function tr(h){const y={};h=(h.g&&ua(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<h.length;D++){if(R(h[D]))continue;var N=Pi(h[D]);const J=N[0];if(N=N[1],typeof N!="string")continue;N=N.trim();const re=y[J]||[];y[J]=re,re.push(N)}fe(y,function(D){return D.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ma(h,y,N){return N&&N.internalChannelParams&&N.internalChannelParams[h]||y}function Ur(h){this.za=0,this.i=[],this.j=new ot,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ma("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ma("baseRetryDelayMs",5e3,h),this.Za=Ma("retryDelaySeedMs",1e4,h),this.Ta=Ma("forwardChannelMaxRetries",2,h),this.va=Ma("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Jo(h&&h.concurrentRequestLimit),this.Ba=new Vr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ur.prototype,n.ka=8,n.I=1,n.connect=function(h,y,N,D){je(0),this.W=h,this.H=y||{},N&&D!==void 0&&(this.H.OSID=N,this.H.OAID=D),this.F=this.X,this.J=ud(this,null,this.W),Oa(this)};function uc(h){if(Vl(h),h.I==3){var y=h.V++,N=ws(h.J);if(Ot(N,"SID",h.M),Ot(N,"RID",y),Ot(N,"TYPE","terminate"),qi(h,N),y=new bs(h,h.j,y),y.M=2,y.A=Li(ws(N)),N=!1,d.navigator&&d.navigator.sendBeacon)try{N=d.navigator.sendBeacon(y.A.toString(),"")}catch{}!N&&d.Image&&(new Image().src=y.A,N=!0),N||(y.g=dd(y.j,null),y.g.ea(y.A)),y.F=Date.now(),Ea(y)}cd(h)}function Br(h){h.g&&(hc(h),h.g.cancel(),h.g=null)}function Vl(h){Br(h),h.v&&(d.clearTimeout(h.v),h.v=null),Ul(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Oa(h){if(!Zo(h.h)&&!h.m){h.m=!0;var y=h.Ea;le||E(),Y||(le(),Y=!0),T.add(y,h),h.D=0}}function Ll(h,y){return ka(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=y.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=$e(g(h.Ea,h,y),od(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const J=new bs(this,this.j,h);let re=this.o;if(this.U&&(re?(re=U(re),ue(re,this.U)):re=this.U),this.u!==null||this.R||(J.J=re,re=null),this.S)e:{for(var y=0,N=0;N<this.i.length;N++){t:{var D=this.i[N];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(y+=D,y>4096){y=N;break e}if(y===4096||N===this.i.length-1){y=N+1;break e}}y=1e3}else y=1e3;y=ad(this,J,y),N=ws(this.J),Ot(N,"RID",h),Ot(N,"CVER",22),this.G&&Ot(N,"X-HTTP-Session-Id",this.G),qi(this,N),re&&(this.R?y="headers="+as(Fn(re))+"&"+y:this.u&&zi(N,this.u,re)),ec(this.h,J),this.Ra&&Ot(N,"TYPE","init"),this.S?(Ot(N,"$req",y),Ot(N,"SID","null"),J.U=!0,En(J,N,null)):En(J,N,y),this.I=2}}else this.I==3&&(h?dc(this,h):this.i.length==0||Zo(this.h)||dc(this))};function dc(h,y){var N;y?N=y.l:N=h.V++;const D=ws(h.J);Ot(D,"SID",h.M),Ot(D,"RID",N),Ot(D,"AID",h.K),qi(h,D),h.u&&h.o&&zi(D,h.u,h.o),N=new bs(h,h.j,N,h.D+1),h.u===null&&(N.J=h.o),y&&(h.i=y.G.concat(h.i)),y=ad(h,N,1e3),N.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),ec(h.h,N),En(N,D,y)}function qi(h,y){h.H&&be(h.H,function(N,D){Ot(y,D,N)}),h.l&&be({},function(N,D){Ot(y,D,N)})}function ad(h,y,N){N=Math.min(h.i.length,N);const D=h.l?g(h.l.Ka,h.l,h):null;e:{var J=h.i;let ht=-1;for(;;){const hs=["count="+N];ht==-1?N>0?(ht=J[0].g,hs.push("ofs="+ht)):ht=0:hs.push("ofs="+ht);let Ct=!0;for(let ts=0;ts<N;ts++){var re=J[ts].g;const $n=J[ts].map;if(re-=ht,re<0)ht=Math.max(0,J[ts].g-100),Ct=!1;else try{re="req"+re+"_"||"";try{var Re=$n instanceof Map?$n:Object.entries($n);for(const[Va,da]of Re){let ha=da;p(da)&&(ha=es(da)),hs.push(re+Va+"="+encodeURIComponent(ha))}}catch(Va){throw hs.push(re+"type="+encodeURIComponent("_badmap")),Va}}catch{D&&D($n)}}if(Ct){Re=hs.join("&");break e}}Re=void 0}return h=h.i.splice(0,N),y.G=h,Re}function rd(h){if(!h.g&&!h.v){h.Y=1;var y=h.Da;le||E(),Y||(le(),Y=!0),T.add(y,h),h.A=0}}function Hi(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=$e(g(h.Da,h),od(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,id(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=$e(g(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,je(10),Br(this),id(this))};function hc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function id(h){h.g=new bs(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var y=ws(h.na);Ot(y,"RID","rpc"),Ot(y,"SID",h.M),Ot(y,"AID",h.K),Ot(y,"CI",h.F?"0":"1"),!h.F&&h.ia&&Ot(y,"TO",h.ia),Ot(y,"TYPE","xmlhttp"),qi(h,y),h.u&&h.o&&zi(y,h.u,h.o),h.O&&(h.g.H=h.O);var N=h.g;h=h.ba,N.M=1,N.A=Li(ws(y)),N.u=null,N.R=!0,Vi(N,h)}n.Va=function(){this.C!=null&&(this.C=null,Br(this),Hi(this),je(19))};function Ul(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function ld(h,y){var N=null;if(h.g==y){Ul(h),hc(h),h.g=null;var D=2}else if(Ca(h.h,y))N=y.G,tc(h.h,y),D=1;else return;if(h.I!=0){if(y.o)if(D==1){N=y.u?y.u.length:0,y=Date.now()-y.F;var J=h.D;D=Ee(),Ce(D,new ke(D,N)),Oa(h)}else rd(h);else if(J=y.m,J==3||J==0&&y.X>0||!(D==1&&Ll(h,y)||D==2&&Hi(h)))switch(N&&N.length>0&&(y=h.h,y.i=y.i.concat(N)),J){case 1:Pa(h,5);break;case 4:Pa(h,10);break;case 3:Pa(h,6);break;default:Pa(h,2)}}}function od(h,y){let N=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(N*=2),N*y}function Pa(h,y){if(h.j.info("Error code "+y),y==2){var N=g(h.bb,h),D=h.Ua;const J=!D;D=new An(D||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Ms(D,"https"),Li(D),J?oa(D.toString(),N):lc(D.toString(),N)}else je(2);h.I=0,h.l&&h.l.pa(y),cd(h),Vl(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),je(2)):(this.j.info("Failed to ping google.com"),je(1))};function cd(h){if(h.I=0,h.ja=[],h.l){const y=sc(h.h);(y.length!=0||h.i.length!=0)&&(L(h.ja,y),L(h.ja,h.i),h.h.i.length=0,A(h.i),h.i.length=0),h.l.oa()}}function ud(h,y,N){var D=N instanceof An?ws(N):new An(N);if(D.g!="")y&&(D.g=y+"."+D.g),Dr(D,D.u);else{var J=d.location;D=J.protocol,y=y?y+"."+J.hostname:J.hostname,J=+J.port;const re=new An(null);D&&Ms(re,D),y&&(re.g=y),J&&Dr(re,J),N&&(re.h=N),D=re}return N=h.G,y=h.wa,N&&y&&Ot(D,N,y),Ot(D,"VER",h.ka),qi(h,D),D}function dd(h,y,N){if(y&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Aa&&!h.ma?new Ut(new Ia({ab:N})):new Ut(h.ma),y.Fa(h.L),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function hd(){}n=hd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function zr(){}zr.prototype.g=function(h,y){return new Zs(h,y)};function Zs(h,y){rt.call(this),this.g=new Ur(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(h?h["X-WebChannel-Client-Profile"]=y.sa:h={"X-WebChannel-Client-Profile":y.sa}),this.g.U=h,(h=y&&y.Qb)&&!R(h)&&(this.g.u=h),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!R(y)&&(this.g.G=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new sr(this)}w(Zs,rt),Zs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Zs.prototype.close=function(){uc(this.g)},Zs.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var N={};N.__data__=h,h=N}else this.v&&(N={},N.__data__=es(h),h=N);y.i.push(new vs(y.Ya++,h)),y.I==3&&Oa(y)},Zs.prototype.N=function(){this.g.l=null,delete this.j,uc(this.g),delete this.g,Zs.Z.N.call(this)};function fd(h){Lt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const N in y){h=N;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}w(fd,Lt);function md(){gs.call(this),this.status=1}w(md,gs);function sr(h){this.g=h}w(sr,hd),sr.prototype.ra=function(){Ce(this.g,"a")},sr.prototype.qa=function(h){Ce(this.g,new fd(h))},sr.prototype.pa=function(h){Ce(this.g,new md)},sr.prototype.oa=function(){Ce(this.g,"b")},zr.prototype.createWebChannel=zr.prototype.g,Zs.prototype.send=Zs.prototype.o,Zs.prototype.open=Zs.prototype.m,Zs.prototype.close=Zs.prototype.close,q_=function(){return new zr},$_=function(){return Ee()},F_=z,z0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rn.NO_ERROR=0,rn.TIMEOUT=8,rn.HTTP_ERROR=6,Uh=rn,ra.COMPLETE="complete",z_=ra,Hs.EventType=xs,xs.OPEN="a",xs.CLOSE="b",xs.ERROR="c",xs.MESSAGE="d",rt.prototype.listen=rt.prototype.J,lu=Hs,Ut.prototype.listenOnce=Ut.prototype.K,Ut.prototype.getLastError=Ut.prototype.Ha,Ut.prototype.getLastErrorCode=Ut.prototype.ya,Ut.prototype.getStatus=Ut.prototype.ca,Ut.prototype.getResponseJson=Ut.prototype.La,Ut.prototype.getResponseText=Ut.prototype.la,Ut.prototype.send=Ut.prototype.ea,Ut.prototype.setWithCredentials=Ut.prototype.Fa,B_=Ut}).apply(typeof vh<"u"?vh:typeof self<"u"?self:typeof window<"u"?window:{});let Ws=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ws.UNAUTHENTICATED=new Ws(null),Ws.GOOGLE_CREDENTIALS=new Ws("google-credentials-uid"),Ws.FIRST_PARTY=new Ws("first-party-uid"),Ws.MOCK_USER=new Ws("mock-user");let Yo="12.8.0";function _4(n){Yo=n}const vl=new jx("@firebase/firestore");function bo(){return vl.logLevel}function Pe(n,...e){if(vl.logLevel<=wt.DEBUG){const t=e.map(Mx);vl.debug(`Firestore (${Yo}): ${n}`,...t)}}function kr(n,...e){if(vl.logLevel<=wt.ERROR){const t=e.map(Mx);vl.error(`Firestore (${Yo}): ${n}`,...t)}}function Io(n,...e){if(vl.logLevel<=wt.WARN){const t=e.map(Mx);vl.warn(`Firestore (${Yo}): ${n}`,...t)}}function Mx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function at(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,H_(n,i,t)}function H_(n,e,t){let i=`FIRESTORE (${Yo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw kr(i),new Error(i)}function Mt(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||H_(e,o,i)}function ut(n,e){return n}const Ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Me extends Sa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class jr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class G_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class j4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ws.UNAUTHENTICATED)))}shutdown(){}}class S4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class E4{constructor(e){this.t=e,this.currentUser=Ws.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Mt(this.o===void 0,42304);let i=this.i;const o=x=>this.i!==i?(i=this.i,t(x)):Promise.resolve();let c=new jr;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new jr,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const x=c;e.enqueueRetryable((async()=>{await x.promise,await o(this.currentUser)}))},p=x=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=x,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((x=>p(x))),setTimeout((()=>{if(!this.auth){const x=this.t.getImmediate({optional:!0});x?p(x):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new jr)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Mt(typeof i.accessToken=="string",31837,{l:i}),new G_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Mt(e===null||typeof e=="string",2055,{h:e}),new Ws(e)}}class T4{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Ws.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class A4{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new T4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ws.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class $w{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class k4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Mt(this.o===void 0,3512);const i=c=>{c.error!=null&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,Pe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>i(c)))};const o=c=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>o(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new $w(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Mt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new $w(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function C4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Ox{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=C4(40);for(let c=0;c<o.length;++c)i.length<20&&o[c]<t&&(i+=e.charAt(o[c]%62))}return i}}function Nt(n,e){return n<e?-1:n>e?1:0}function F0(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),c=e.charAt(i);if(o!==c)return m0(o)===m0(c)?Nt(o,c):m0(o)?1:-1}return Nt(n.length,e.length)}const R4=55296,I4=57343;function m0(n){const e=n.charCodeAt(0);return e>=R4&&e<=I4}function Do(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}const qw="__name__";class Fa{constructor(e,t,i){t===void 0?t=0:t>e.length&&at(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&at(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Fa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Fa?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const c=Fa.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Nt(e.length,t.length)}static compareSegments(e,t){const i=Fa.isNumericId(e),o=Fa.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?Fa.extractNumericId(e).compare(Fa.extractNumericId(t)):F0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return vi.fromString(e.substring(4,e.length-2))}}class Qt extends Fa{construct(e,t,i){return new Qt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Me(Ne.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new Qt(t)}static emptyPath(){return new Qt([])}}const D4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $s extends Fa{construct(e,t,i){return new $s(e,t,i)}static isValidIdentifier(e){return D4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$s.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===qw}static keyField(){return new $s([qw])}static fromServerFormat(e){const t=[];let i="",o=0;const c=()=>{if(i.length===0)throw new Me(Ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;o<e.length;){const p=e[o];if(p==="\\"){if(o+1===e.length)throw new Me(Ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const x=e[o+1];if(x!=="\\"&&x!=="."&&x!=="`")throw new Me(Ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=x,o+=2}else p==="`"?(d=!d,o++):p!=="."||d?(i+=p,o++):(c(),o++)}if(c(),d)throw new Me(Ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $s(t)}static emptyPath(){return new $s([])}}class Ze{constructor(e){this.path=e}static fromPath(e){return new Ze(Qt.fromString(e))}static fromName(e){return new Ze(Qt.fromString(e).popFirst(5))}static empty(){return new Ze(Qt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Qt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Qt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ze(new Qt(e.slice()))}}function Y_(n,e,t){if(!t)throw new Me(Ne.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function M4(n,e,t,i){if(e===!0&&i===!0)throw new Me(Ne.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Hw(n){if(!Ze.isDocumentKey(n))throw new Me(Ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Gw(n){if(Ze.isDocumentKey(n))throw new Me(Ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function W_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Of(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":at(12329,{type:typeof n})}function wn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Me(Ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Of(n);throw new Me(Ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function As(n,e){const t={typeString:n};return e&&(t.value=e),t}function $u(n,e){if(!W_(n))throw new Me(Ne.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,c="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(o&&typeof d!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(c!==void 0&&d!==c.value){t=`Expected '${i}' field to equal '${c.value}'`;break}}if(t)throw new Me(Ne.INVALID_ARGUMENT,t);return!0}const Yw=-62135596800,Ww=1e6;class It{static now(){return It.fromMillis(Date.now())}static fromDate(e){return It.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*Ww);return new It(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Me(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Me(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Yw)throw new Me(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Me(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ww}_compareTo(e){return this.seconds===e.seconds?Nt(this.nanoseconds,e.nanoseconds):Nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:It._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($u(e,It._jsonSchema))return new It(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Yw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}It._jsonSchemaVersion="firestore/timestamp/1.0",It._jsonSchema={type:As("string",It._jsonSchemaVersion),seconds:As("number"),nanoseconds:As("number")};class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new It(0,0))}static max(){return new lt(new It(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Su=-1;function O4(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=lt.fromTimestamp(i===1e9?new It(t+1,0):new It(t,i));return new Si(o,Ze.empty(),e)}function P4(n){return new Si(n.readTime,n.key,Su)}class Si{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Si(lt.min(),Ze.empty(),Su)}static max(){return new Si(lt.max(),Ze.empty(),Su)}}function V4(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ze.comparator(n.documentKey,e.documentKey),t!==0?t:Nt(n.largestBatchId,e.largestBatchId))}const L4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class U4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Wo(n){if(n.code!==Ne.FAILED_PRECONDITION||n.message!==L4)throw n;Pe("LocalStore","Unexpectedly lost primary lease")}class _e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&at(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new _e(((i,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(i,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof _e?t:_e.resolve(t)}catch(t){return _e.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):_e.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):_e.reject(t)}static resolve(e){return new _e(((t,i)=>{t(e)}))}static reject(e){return new _e(((t,i)=>{i(e)}))}static waitFor(e){return new _e(((t,i)=>{let o=0,c=0,d=!1;e.forEach((p=>{++o,p.next((()=>{++c,d&&c===o&&t()}),(x=>i(x)))})),d=!0,c===o&&t()}))}static or(e){let t=_e.resolve(!1);for(const i of e)t=t.next((o=>o?_e.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,c)=>{i.push(t.call(this,o,c))})),this.waitFor(i)}static mapArray(e,t){return new _e(((i,o)=>{const c=e.length,d=new Array(c);let p=0;for(let x=0;x<c;x++){const g=x;t(e[g]).next((b=>{d[g]=b,++p,p===c&&i(d)}),(b=>o(b)))}}))}static doWhile(e,t){return new _e(((i,o)=>{const c=()=>{e()===!0?t().next((()=>{c()}),o):i()};c()}))}}function B4(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Qo(n){return n.name==="IndexedDbTransactionError"}class Pf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Pf.ce=-1;const Px=-1;function Vf(n){return n==null}function lf(n){return n===0&&1/n==-1/0}function z4(n){return typeof n=="number"&&Number.isInteger(n)&&!lf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Q_="";function F4(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Qw(e)),e=$4(n.get(t),e);return Qw(e)}function $4(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case Q_:t+="";break;default:t+=c}}return t}function Qw(n){return n+Q_+""}function Kw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Mi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function K_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class rs{constructor(e,t){this.comparator=e,this.root=t||Fs.EMPTY}insert(e,t){return new rs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Fs.BLACK,null,null))}remove(e){return new rs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wh(this.root,e,this.comparator,!1)}getReverseIterator(){return new wh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wh(this.root,e,this.comparator,!0)}}class wh{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?i(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fs{constructor(e,t,i,o,c){this.key=e,this.value=t,this.color=i??Fs.RED,this.left=o??Fs.EMPTY,this.right=c??Fs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,c){return new Fs(e??this.key,t??this.value,i??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const c=i(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,i),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Fs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Fs.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw at(43730,{key:this.key,value:this.value});if(this.right.isRed())throw at(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw at(27949);return e+(this.isRed()?0:1)}}Fs.EMPTY=null,Fs.RED=!0,Fs.BLACK=!1;Fs.EMPTY=new class{constructor(){this.size=0}get key(){throw at(57766)}get value(){throw at(16141)}get color(){throw at(16727)}get left(){throw at(29726)}get right(){throw at(36894)}copy(e,t,i,o,c){return this}insert(e,t,i){return new Fs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Is{constructor(e){this.comparator=e,this.data=new rs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Xw(this.data.getIterator())}getIteratorFrom(e){return new Xw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Is)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Is(this.comparator);return t.data=e,t}}class Xw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Pn{constructor(e){this.fields=e,e.sort($s.comparator)}static empty(){return new Pn([])}unionWith(e){let t=new Is($s.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Pn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Do(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class X_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class qs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new X_("Invalid base64 string: "+c):c}})(e);return new qs(t)}static fromUint8Array(e){const t=(function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c})(e);return new qs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qs.EMPTY_BYTE_STRING=new qs("");const q4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ei(n){if(Mt(!!n,39018),typeof n=="string"){let e=0;const t=q4.exec(n);if(Mt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ps(n.seconds),nanos:ps(n.nanos)}}function ps(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ti(n){return typeof n=="string"?qs.fromBase64String(n):qs.fromUint8Array(n)}const J_="server_timestamp",Z_="__type__",ej="__previous_value__",tj="__local_write_time__";function Vx(n){return(n?.mapValue?.fields||{})[Z_]?.stringValue===J_}function Lf(n){const e=n.mapValue.fields[ej];return Vx(e)?Lf(e):e}function Eu(n){const e=Ei(n.mapValue.fields[tj].timestampValue);return new It(e.seconds,e.nanos)}class H4{constructor(e,t,i,o,c,d,p,x,g,b,w){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=x,this.useFetchStreams=g,this.isUsingEmulator=b,this.apiKey=w}}const of="(default)";class Tu{constructor(e,t){this.projectId=e,this.database=t||of}static empty(){return new Tu("","")}get isDefaultDatabase(){return this.database===of}isEqual(e){return e instanceof Tu&&e.projectId===this.projectId&&e.database===this.database}}function G4(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Me(Ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tu(n.options.projectId,e)}const sj="__type__",Y4="__max__",Nh={mapValue:{}},nj="__vector__",cf="value";function Ai(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Vx(n)?4:Q4(n)?9007199254740991:W4(n)?10:11:at(28295,{value:n})}function Xa(n,e){if(n===e)return!0;const t=Ai(n);if(t!==Ai(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Eu(n).isEqual(Eu(e));case 3:return(function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=Ei(o.timestampValue),p=Ei(c.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,c){return Ti(o.bytesValue).isEqual(Ti(c.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,c){return ps(o.geoPointValue.latitude)===ps(c.geoPointValue.latitude)&&ps(o.geoPointValue.longitude)===ps(c.geoPointValue.longitude)})(n,e);case 2:return(function(o,c){if("integerValue"in o&&"integerValue"in c)return ps(o.integerValue)===ps(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=ps(o.doubleValue),p=ps(c.doubleValue);return d===p?lf(d)===lf(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return Do(n.arrayValue.values||[],e.arrayValue.values||[],Xa);case 10:case 11:return(function(o,c){const d=o.mapValue.fields||{},p=c.mapValue.fields||{};if(Kw(d)!==Kw(p))return!1;for(const x in d)if(d.hasOwnProperty(x)&&(p[x]===void 0||!Xa(d[x],p[x])))return!1;return!0})(n,e);default:return at(52216,{left:n})}}function Au(n,e){return(n.values||[]).find((t=>Xa(t,e)))!==void 0}function Mo(n,e){if(n===e)return 0;const t=Ai(n),i=Ai(e);if(t!==i)return Nt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Nt(n.booleanValue,e.booleanValue);case 2:return(function(c,d){const p=ps(c.integerValue||c.doubleValue),x=ps(d.integerValue||d.doubleValue);return p<x?-1:p>x?1:p===x?0:isNaN(p)?isNaN(x)?0:-1:1})(n,e);case 3:return Jw(n.timestampValue,e.timestampValue);case 4:return Jw(Eu(n),Eu(e));case 5:return F0(n.stringValue,e.stringValue);case 6:return(function(c,d){const p=Ti(c),x=Ti(d);return p.compareTo(x)})(n.bytesValue,e.bytesValue);case 7:return(function(c,d){const p=c.split("/"),x=d.split("/");for(let g=0;g<p.length&&g<x.length;g++){const b=Nt(p[g],x[g]);if(b!==0)return b}return Nt(p.length,x.length)})(n.referenceValue,e.referenceValue);case 8:return(function(c,d){const p=Nt(ps(c.latitude),ps(d.latitude));return p!==0?p:Nt(ps(c.longitude),ps(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Zw(n.arrayValue,e.arrayValue);case 10:return(function(c,d){const p=c.fields||{},x=d.fields||{},g=p[cf]?.arrayValue,b=x[cf]?.arrayValue,w=Nt(g?.values?.length||0,b?.values?.length||0);return w!==0?w:Zw(g,b)})(n.mapValue,e.mapValue);case 11:return(function(c,d){if(c===Nh.mapValue&&d===Nh.mapValue)return 0;if(c===Nh.mapValue)return 1;if(d===Nh.mapValue)return-1;const p=c.fields||{},x=Object.keys(p),g=d.fields||{},b=Object.keys(g);x.sort(),b.sort();for(let w=0;w<x.length&&w<b.length;++w){const _=F0(x[w],b[w]);if(_!==0)return _;const A=Mo(p[x[w]],g[b[w]]);if(A!==0)return A}return Nt(x.length,b.length)})(n.mapValue,e.mapValue);default:throw at(23264,{he:t})}}function Jw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Nt(n,e);const t=Ei(n),i=Ei(e),o=Nt(t.seconds,i.seconds);return o!==0?o:Nt(t.nanos,i.nanos)}function Zw(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const c=Mo(t[o],i[o]);if(c)return c}return Nt(t.length,i.length)}function Oo(n){return $0(n)}function $0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Ei(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ti(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ze.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const c of t.values||[])o?o=!1:i+=",",i+=$0(c);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of i)c?c=!1:o+=",",o+=`${d}:${$0(t.fields[d])}`;return o+"}"})(n.mapValue):at(61005,{value:n})}function Bh(n){switch(Ai(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Lf(n);return e?16+Bh(e):16;case 5:return 2*n.stringValue.length;case 6:return Ti(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,c)=>o+Bh(c)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return Mi(i.fields,((c,d)=>{o+=c.length+Bh(d)})),o})(n.mapValue);default:throw at(13486,{value:n})}}function e1(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function q0(n){return!!n&&"integerValue"in n}function Lx(n){return!!n&&"arrayValue"in n}function t1(n){return!!n&&"nullValue"in n}function s1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function zh(n){return!!n&&"mapValue"in n}function W4(n){return(n?.mapValue?.fields||{})[sj]?.stringValue===nj}function mu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Mi(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=mu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=mu(n.arrayValue.values[t]);return e}return{...n}}function Q4(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Y4}class gn{constructor(e){this.value=e}static empty(){return new gn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!zh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mu(t)}setAll(e){let t=$s.emptyPath(),i={},o=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const x=this.getFieldsMap(t);this.applyChanges(x,i,o),i={},o=[],t=p.popLast()}d?i[p.lastSegment()]=mu(d):o.push(p.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,i,o)}delete(e){const t=this.field(e.popLast());zh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];zh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Mi(t,((o,c)=>e[o]=c));for(const o of i)delete e[o]}clone(){return new gn(mu(this.value))}}function aj(n){const e=[];return Mi(n.fields,((t,i)=>{const o=new $s([t]);if(zh(i)){const c=aj(i.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)})),new Pn(e)}class Qs{constructor(e,t,i,o,c,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=c,this.data=d,this.documentState=p}static newInvalidDocument(e){return new Qs(e,0,lt.min(),lt.min(),lt.min(),gn.empty(),0)}static newFoundDocument(e,t,i,o){return new Qs(e,1,t,lt.min(),i,o,0)}static newNoDocument(e,t){return new Qs(e,2,t,lt.min(),lt.min(),gn.empty(),0)}static newUnknownDocument(e,t){return new Qs(e,3,t,lt.min(),lt.min(),gn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class uf{constructor(e,t){this.position=e,this.inclusive=t}}function n1(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?i=Ze.comparator(Ze.fromName(d.referenceValue),t.key):i=Mo(d,t.data.field(c.field)),c.dir==="desc"&&(i*=-1),i!==0)break}return i}function a1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xa(n.position[t],e.position[t]))return!1;return!0}class df{constructor(e,t="asc"){this.field=e,this.dir=t}}function K4(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class rj{}class Ts extends rj{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new J4(e,t,i):t==="array-contains"?new tR(e,i):t==="in"?new sR(e,i):t==="not-in"?new nR(e,i):t==="array-contains-any"?new aR(e,i):new Ts(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new Z4(e,i):new eR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Mo(t,this.value)):t!==null&&Ai(this.value)===Ai(t)&&this.matchesComparison(Mo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return at(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Na extends rj{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Na(e,t)}matches(e){return ij(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ij(n){return n.op==="and"}function lj(n){return X4(n)&&ij(n)}function X4(n){for(const e of n.filters)if(e instanceof Na)return!1;return!0}function H0(n){if(n instanceof Ts)return n.field.canonicalString()+n.op.toString()+Oo(n.value);if(lj(n))return n.filters.map((e=>H0(e))).join(",");{const e=n.filters.map((t=>H0(t))).join(",");return`${n.op}(${e})`}}function oj(n,e){return n instanceof Ts?(function(i,o){return o instanceof Ts&&i.op===o.op&&i.field.isEqual(o.field)&&Xa(i.value,o.value)})(n,e):n instanceof Na?(function(i,o){return o instanceof Na&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((c,d,p)=>c&&oj(d,o.filters[p])),!0):!1})(n,e):void at(19439)}function cj(n){return n instanceof Ts?(function(t){return`${t.field.canonicalString()} ${t.op} ${Oo(t.value)}`})(n):n instanceof Na?(function(t){return t.op.toString()+" {"+t.getFilters().map(cj).join(" ,")+"}"})(n):"Filter"}class J4 extends Ts{constructor(e,t,i){super(e,t,i),this.key=Ze.fromName(i.referenceValue)}matches(e){const t=Ze.comparator(e.key,this.key);return this.matchesComparison(t)}}class Z4 extends Ts{constructor(e,t){super(e,"in",t),this.keys=uj("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class eR extends Ts{constructor(e,t){super(e,"not-in",t),this.keys=uj("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function uj(n,e){return(e.arrayValue?.values||[]).map((t=>Ze.fromName(t.referenceValue)))}class tR extends Ts{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Lx(t)&&Au(t.arrayValue,this.value)}}class sR extends Ts{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Au(this.value.arrayValue,t)}}class nR extends Ts{constructor(e,t){super(e,"not-in",t)}matches(e){if(Au(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Au(this.value.arrayValue,t)}}class aR extends Ts{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Lx(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Au(this.value.arrayValue,i)))}}class rR{constructor(e,t=null,i=[],o=[],c=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=c,this.startAt=d,this.endAt=p,this.Te=null}}function r1(n,e=null,t=[],i=[],o=null,c=null,d=null){return new rR(n,e,t,i,o,c,d)}function Ux(n){const e=ut(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>H0(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(c){return c.field.canonicalString()+c.dir})(i))).join(","),Vf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Oo(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Oo(i))).join(",")),e.Te=t}return e.Te}function Bx(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!K4(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!oj(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!a1(n.startAt,e.startAt)&&a1(n.endAt,e.endAt)}function G0(n){return Ze.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class qu{constructor(e,t=null,i=[],o=[],c=null,d="F",p=null,x=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=c,this.limitType=d,this.startAt=p,this.endAt=x,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function iR(n,e,t,i,o,c,d,p){return new qu(n,e,t,i,o,c,d,p)}function Uf(n){return new qu(n)}function i1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lR(n){return Ze.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function dj(n){return n.collectionGroup!==null}function pu(n){const e=ut(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),t.add(c.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Is($s.comparator);return d.filters.forEach((x=>{x.getFlattenedFilters().forEach((g=>{g.isInequality()&&(p=p.add(g.field))}))})),p})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new df(c,i))})),t.has($s.keyField().canonicalString())||e.Ie.push(new df($s.keyField(),i))}return e.Ie}function Wa(n){const e=ut(n);return e.Ee||(e.Ee=oR(e,pu(n))),e.Ee}function oR(n,e){if(n.limitType==="F")return r1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const c=o.dir==="desc"?"asc":"desc";return new df(o.field,c)}));const t=n.endAt?new uf(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new uf(n.startAt.position,n.startAt.inclusive):null;return r1(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Y0(n,e){const t=n.filters.concat([e]);return new qu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function W0(n,e,t){return new qu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Bf(n,e){return Bx(Wa(n),Wa(e))&&n.limitType===e.limitType}function hj(n){return`${Ux(Wa(n))}|lt:${n.limitType}`}function yo(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>cj(o))).join(", ")}]`),Vf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>Oo(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>Oo(o))).join(",")),`Target(${i})`})(Wa(n))}; limitType=${n.limitType})`}function zf(n,e){return e.isFoundDocument()&&(function(i,o){const c=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(c):Ze.isDocumentKey(i.path)?i.path.isEqual(c):i.path.isImmediateParentOf(c)})(n,e)&&(function(i,o){for(const c of pu(i))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const c of i.filters)if(!c.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(d,p,x){const g=n1(d,p,x);return d.inclusive?g<=0:g<0})(i.startAt,pu(i),o)||i.endAt&&!(function(d,p,x){const g=n1(d,p,x);return d.inclusive?g>=0:g>0})(i.endAt,pu(i),o))})(n,e)}function cR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function fj(n){return(e,t)=>{let i=!1;for(const o of pu(n)){const c=uR(o,e,t);if(c!==0)return c;i=i||o.field.isKeyField()}return 0}}function uR(n,e,t){const i=n.field.isKeyField()?Ze.comparator(e.key,t.key):(function(c,d,p){const x=d.data.field(c),g=p.data.field(c);return x!==null&&g!==null?Mo(x,g):at(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return at(19790,{direction:n.dir})}}class Al{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,c]of i)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Mi(this.inner,((t,i)=>{for(const[o,c]of i)e(o,c)}))}isEmpty(){return K_(this.inner)}size(){return this.innerSize}}const dR=new rs(Ze.comparator);function Cr(){return dR}const mj=new rs(Ze.comparator);function ou(...n){let e=mj;for(const t of n)e=e.insert(t.key,t);return e}function pj(n){let e=mj;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function hl(){return xu()}function xj(){return xu()}function xu(){return new Al((n=>n.toString()),((n,e)=>n.isEqual(e)))}const hR=new rs(Ze.comparator),fR=new Is(Ze.comparator);function _t(...n){let e=fR;for(const t of n)e=e.add(t);return e}const mR=new Is(Nt);function pR(){return mR}function zx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lf(e)?"-0":e}}function gj(n){return{integerValue:""+n}}function xR(n,e){return z4(e)?gj(e):zx(n,e)}class Ff{constructor(){this._=void 0}}function gR(n,e,t){return n instanceof ku?(function(o,c){const d={fields:{[Z_]:{stringValue:J_},[tj]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Vx(c)&&(c=Lf(c)),c&&(d.fields[ej]=c),{mapValue:d}})(t,e):n instanceof Cu?yj(n,e):n instanceof Ru?vj(n,e):(function(o,c){const d=bj(o,c),p=l1(d)+l1(o.Ae);return q0(d)&&q0(o.Ae)?gj(p):zx(o.serializer,p)})(n,e)}function bR(n,e,t){return n instanceof Cu?yj(n,e):n instanceof Ru?vj(n,e):t}function bj(n,e){return n instanceof hf?(function(i){return q0(i)||(function(c){return!!c&&"doubleValue"in c})(i)})(e)?e:{integerValue:0}:null}class ku extends Ff{}class Cu extends Ff{constructor(e){super(),this.elements=e}}function yj(n,e){const t=wj(e);for(const i of n.elements)t.some((o=>Xa(o,i)))||t.push(i);return{arrayValue:{values:t}}}class Ru extends Ff{constructor(e){super(),this.elements=e}}function vj(n,e){let t=wj(e);for(const i of n.elements)t=t.filter((o=>!Xa(o,i)));return{arrayValue:{values:t}}}class hf extends Ff{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function l1(n){return ps(n.integerValue||n.doubleValue)}function wj(n){return Lx(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class yR{constructor(e,t){this.field=e,this.transform=t}}function vR(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof Cu&&o instanceof Cu||i instanceof Ru&&o instanceof Ru?Do(i.elements,o.elements,Xa):i instanceof hf&&o instanceof hf?Xa(i.Ae,o.Ae):i instanceof ku&&o instanceof ku})(n.transform,e.transform)}class wR{constructor(e,t){this.version=e,this.transformResults=t}}class na{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new na}static exists(e){return new na(void 0,e)}static updateTime(e){return new na(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Fh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class $f{}function Nj(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Fx(n.key,na.none()):new Hu(n.key,n.data,na.none());{const t=n.data,i=gn.empty();let o=new Is($s.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?i.delete(c):i.set(c,d),o=o.add(c)}return new Oi(n.key,i,new Pn(o.toArray()),na.none())}}function NR(n,e,t){n instanceof Hu?(function(o,c,d){const p=o.value.clone(),x=c1(o.fieldTransforms,c,d.transformResults);p.setAll(x),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof Oi?(function(o,c,d){if(!Fh(o.precondition,c))return void c.convertToUnknownDocument(d.version);const p=c1(o.fieldTransforms,c,d.transformResults),x=c.data;x.setAll(_j(o)),x.setAll(p),c.convertToFoundDocument(d.version,x).setHasCommittedMutations()})(n,e,t):(function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function gu(n,e,t,i){return n instanceof Hu?(function(c,d,p,x){if(!Fh(c.precondition,d))return p;const g=c.value.clone(),b=u1(c.fieldTransforms,x,d);return g.setAll(b),d.convertToFoundDocument(d.version,g).setHasLocalMutations(),null})(n,e,t,i):n instanceof Oi?(function(c,d,p,x){if(!Fh(c.precondition,d))return p;const g=u1(c.fieldTransforms,x,d),b=d.data;return b.setAll(_j(c)),b.setAll(g),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),p===null?null:p.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((w=>w.field)))})(n,e,t,i):(function(c,d,p){return Fh(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function _R(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),c=bj(i.transform,o||null);c!=null&&(t===null&&(t=gn.empty()),t.set(i.field,c))}return t||null}function o1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Do(i,o,((c,d)=>vR(c,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Hu extends $f{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Oi extends $f{constructor(e,t,i,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function _j(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function c1(n,e,t){const i=new Map;Mt(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,p=e.data.field(c.field);i.set(c.field,bR(d,p,t[o]))}return i}function u1(n,e,t){const i=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);i.set(o.field,gR(c,d,e))}return i}class Fx extends $f{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class jR extends $f{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class SR{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&NR(c,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=gu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=gu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=xj();return this.mutations.forEach((o=>{const c=e.get(o.key),d=c.overlayedDocument;let p=this.applyToLocalView(d,c.mutatedFields);p=t.has(o.key)?null:p;const x=Nj(d,p);x!==null&&i.set(o.key,x),d.isValidDocument()||d.convertToNoDocument(lt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),_t())}isEqual(e){return this.batchId===e.batchId&&Do(this.mutations,e.mutations,((t,i)=>o1(t,i)))&&Do(this.baseMutations,e.baseMutations,((t,i)=>o1(t,i)))}}class $x{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){Mt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return hR})();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,i[d].version);return new $x(e,t,i,o)}}class ER{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class TR{constructor(e,t){this.count=e,this.unchangedNames=t}}var Es,St;function AR(n){switch(n){case Ne.OK:return at(64938);case Ne.CANCELLED:case Ne.UNKNOWN:case Ne.DEADLINE_EXCEEDED:case Ne.RESOURCE_EXHAUSTED:case Ne.INTERNAL:case Ne.UNAVAILABLE:case Ne.UNAUTHENTICATED:return!1;case Ne.INVALID_ARGUMENT:case Ne.NOT_FOUND:case Ne.ALREADY_EXISTS:case Ne.PERMISSION_DENIED:case Ne.FAILED_PRECONDITION:case Ne.ABORTED:case Ne.OUT_OF_RANGE:case Ne.UNIMPLEMENTED:case Ne.DATA_LOSS:return!0;default:return at(15467,{code:n})}}function jj(n){if(n===void 0)return kr("GRPC error has no .code"),Ne.UNKNOWN;switch(n){case Es.OK:return Ne.OK;case Es.CANCELLED:return Ne.CANCELLED;case Es.UNKNOWN:return Ne.UNKNOWN;case Es.DEADLINE_EXCEEDED:return Ne.DEADLINE_EXCEEDED;case Es.RESOURCE_EXHAUSTED:return Ne.RESOURCE_EXHAUSTED;case Es.INTERNAL:return Ne.INTERNAL;case Es.UNAVAILABLE:return Ne.UNAVAILABLE;case Es.UNAUTHENTICATED:return Ne.UNAUTHENTICATED;case Es.INVALID_ARGUMENT:return Ne.INVALID_ARGUMENT;case Es.NOT_FOUND:return Ne.NOT_FOUND;case Es.ALREADY_EXISTS:return Ne.ALREADY_EXISTS;case Es.PERMISSION_DENIED:return Ne.PERMISSION_DENIED;case Es.FAILED_PRECONDITION:return Ne.FAILED_PRECONDITION;case Es.ABORTED:return Ne.ABORTED;case Es.OUT_OF_RANGE:return Ne.OUT_OF_RANGE;case Es.UNIMPLEMENTED:return Ne.UNIMPLEMENTED;case Es.DATA_LOSS:return Ne.DATA_LOSS;default:return at(39323,{code:n})}}(St=Es||(Es={}))[St.OK=0]="OK",St[St.CANCELLED=1]="CANCELLED",St[St.UNKNOWN=2]="UNKNOWN",St[St.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",St[St.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",St[St.NOT_FOUND=5]="NOT_FOUND",St[St.ALREADY_EXISTS=6]="ALREADY_EXISTS",St[St.PERMISSION_DENIED=7]="PERMISSION_DENIED",St[St.UNAUTHENTICATED=16]="UNAUTHENTICATED",St[St.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",St[St.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",St[St.ABORTED=10]="ABORTED",St[St.OUT_OF_RANGE=11]="OUT_OF_RANGE",St[St.UNIMPLEMENTED=12]="UNIMPLEMENTED",St[St.INTERNAL=13]="INTERNAL",St[St.UNAVAILABLE=14]="UNAVAILABLE",St[St.DATA_LOSS=15]="DATA_LOSS";function kR(){return new TextEncoder}const CR=new vi([4294967295,4294967295],0);function d1(n){const e=kR().encode(n),t=new U_;return t.update(e),new Uint8Array(t.digest())}function h1(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new vi([t,i],0),new vi([o,c],0)]}class qx{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new cu(`Invalid padding: ${t}`);if(i<0)throw new cu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new cu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new cu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=vi.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(vi.fromNumber(i)));return o.compare(CR)===1&&(o=new vi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=d1(e),[i,o]=h1(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(i,o,c);if(!this.we(d))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new qx(c,o,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=d1(e),[i,o]=h1(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(i,o,c);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class qf{constructor(e,t,i,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Gu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new qf(lt.min(),o,new rs(Nt),Cr(),_t())}}class Gu{constructor(e,t,i,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Gu(i,t,_t(),_t(),_t())}}class $h{constructor(e,t,i,o){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=o}}class Sj{constructor(e,t){this.targetId=e,this.Ce=t}}class Ej{constructor(e,t,i=qs.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class f1{constructor(){this.ve=0,this.Fe=m1(),this.Me=qs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=_t(),t=_t(),i=_t();return this.Fe.forEach(((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:at(38017,{changeType:c})}})),new Gu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=m1()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Mt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class RR{constructor(e){this.Ge=e,this.ze=new Map,this.je=Cr(),this.He=_h(),this.Je=_h(),this.Ze=new rs(Nt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:at(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const c=o.target;if(G0(c))if(i===0){const d=new Ze(c.path);this.et(t,d,Qs.newNoDocument(d,lt.min()))}else Mt(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),x=p?this.ct(p,e,d):1;if(x!==0){this.it(t);const g=x===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:c=0}=t;let d,p;try{d=Ti(i).toUint8Array()}catch(x){if(x instanceof X_)return Io("Decoding the base64 bloom filter in existence filter failed ("+x.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw x}try{p=new qx(d,o,c)}catch(x){return Io(x instanceof cu?"BloomFilter error: ":"Applying bloom filter failed: ",x),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((c=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(p)||(this.et(t,c,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((c,d)=>{const p=this.ot(d);if(p){if(c.current&&G0(p.target)){const x=new Ze(p.target.path);this.It(x).has(d)||this.Et(d,x)||this.et(d,x,Qs.newNoDocument(x,e))}c.Be&&(t.set(d,c.ke()),c.Ke())}}));let i=_t();this.Je.forEach(((c,d)=>{let p=!0;d.forEachWhile((x=>{const g=this.ot(x);return!g||g.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(c))})),this.je.forEach(((c,d)=>d.setReadTime(e)));const o=new qf(e,t,this.Ze,this.je,i);return this.je=Cr(),this.He=_h(),this.Je=_h(),this.Ze=new rs(Nt),o}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.qe(t,1):o.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new f1,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Is(Nt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Is(Nt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new f1),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function _h(){return new rs(Ze.comparator)}function m1(){return new rs(Ze.comparator)}const IR={asc:"ASCENDING",desc:"DESCENDING"},DR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},MR={and:"AND",or:"OR"};class OR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Q0(n,e){return n.useProto3Json||Vf(e)?e:{value:e}}function ff(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Tj(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function PR(n,e){return ff(n,e.toTimestamp())}function Qa(n){return Mt(!!n,49232),lt.fromTimestamp((function(t){const i=Ei(t);return new It(i.seconds,i.nanos)})(n))}function Hx(n,e){return K0(n,e).canonicalString()}function K0(n,e){const t=(function(o){return new Qt(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Aj(n){const e=Qt.fromString(n);return Mt(Dj(e),10190,{key:e.toString()}),e}function X0(n,e){return Hx(n.databaseId,e.path)}function p0(n,e){const t=Aj(e);if(t.get(1)!==n.databaseId.projectId)throw new Me(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Me(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ze(Cj(t))}function kj(n,e){return Hx(n.databaseId,e)}function VR(n){const e=Aj(n);return e.length===4?Qt.emptyPath():Cj(e)}function J0(n){return new Qt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Cj(n){return Mt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function p1(n,e,t){return{name:X0(n,e),fields:t.value.mapValue.fields}}function LR(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:at(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=(function(g,b){return g.useProto3Json?(Mt(b===void 0||typeof b=="string",58123),qs.fromBase64String(b||"")):(Mt(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),qs.fromUint8Array(b||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(g){const b=g.code===void 0?Ne.UNKNOWN:jj(g.code);return new Me(b,g.message||"")})(d);t=new Ej(i,o,c,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=p0(n,i.document.name),c=Qa(i.document.updateTime),d=i.document.createTime?Qa(i.document.createTime):lt.min(),p=new gn({mapValue:{fields:i.document.fields}}),x=Qs.newFoundDocument(o,c,d,p),g=i.targetIds||[],b=i.removedTargetIds||[];t=new $h(g,b,x.key,x)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=p0(n,i.document),c=i.readTime?Qa(i.readTime):lt.min(),d=Qs.newNoDocument(o,c),p=i.removedTargetIds||[];t=new $h([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=p0(n,i.document),c=i.removedTargetIds||[];t=new $h([],c,o,null)}else{if(!("filter"in e))return at(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:c}=i,d=new TR(o,c),p=i.targetId;t=new Sj(p,d)}}return t}function UR(n,e){let t;if(e instanceof Hu)t={update:p1(n,e.key,e.value)};else if(e instanceof Fx)t={delete:X0(n,e.key)};else if(e instanceof Oi)t={update:p1(n,e.key,e.data),updateMask:WR(e.fieldMask)};else{if(!(e instanceof jR))return at(16599,{dt:e.type});t={verify:X0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(c,d){const p=d.transform;if(p instanceof ku)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Cu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Ru)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof hf)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw at(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(o,c){return c.updateTime!==void 0?{updateTime:PR(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:at(27497)})(n,e.precondition)),t}function BR(n,e){return n&&n.length>0?(Mt(e!==void 0,14353),n.map((t=>(function(o,c){let d=o.updateTime?Qa(o.updateTime):Qa(c);return d.isEqual(lt.min())&&(d=Qa(c)),new wR(d,o.transformResults||[])})(t,e)))):[]}function zR(n,e){return{documents:[kj(n,e.path)]}}function FR(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=kj(n,o);const c=(function(g){if(g.length!==0)return Ij(Na.create(g,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const d=(function(g){if(g.length!==0)return g.map((b=>(function(_){return{field:vo(_.field),direction:HR(_.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=Q0(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:o}}function $R(n){let e=VR(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){Mt(i===1,65062);const b=t.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let c=[];t.where&&(c=(function(w){const _=Rj(w);return _ instanceof Na&&lj(_)?_.getFilters():[_]})(t.where));let d=[];t.orderBy&&(d=(function(w){return w.map((_=>(function(L){return new df(wo(L.field),(function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(L.direction))})(_)))})(t.orderBy));let p=null;t.limit&&(p=(function(w){let _;return _=typeof w=="object"?w.value:w,Vf(_)?null:_})(t.limit));let x=null;t.startAt&&(x=(function(w){const _=!!w.before,A=w.values||[];return new uf(A,_)})(t.startAt));let g=null;return t.endAt&&(g=(function(w){const _=!w.before,A=w.values||[];return new uf(A,_)})(t.endAt)),iR(e,o,d,c,p,"F",x,g)}function qR(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return at(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Rj(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=wo(t.unaryFilter.field);return Ts.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=wo(t.unaryFilter.field);return Ts.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=wo(t.unaryFilter.field);return Ts.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=wo(t.unaryFilter.field);return Ts.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return at(61313);default:return at(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ts.create(wo(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return at(58110);default:return at(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Na.create(t.compositeFilter.filters.map((i=>Rj(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return at(1026)}})(t.compositeFilter.op))})(n):at(30097,{filter:n})}function HR(n){return IR[n]}function GR(n){return DR[n]}function YR(n){return MR[n]}function vo(n){return{fieldPath:n.canonicalString()}}function wo(n){return $s.fromServerFormat(n.fieldPath)}function Ij(n){return n instanceof Ts?(function(t){if(t.op==="=="){if(s1(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NAN"}};if(t1(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(s1(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NOT_NAN"}};if(t1(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vo(t.field),op:GR(t.op),value:t.value}}})(n):n instanceof Na?(function(t){const i=t.getFilters().map((o=>Ij(o)));return i.length===1?i[0]:{compositeFilter:{op:YR(t.op),filters:i}}})(n):at(54877,{filter:n})}function WR(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Dj(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function Mj(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class gi{constructor(e,t,i,o,c=lt.min(),d=lt.min(),p=qs.EMPTY_BYTE_STRING,x=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=x}withSequenceNumber(e){return new gi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class QR{constructor(e){this.yt=e}}function KR(n){const e=$R({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?W0(e,e.limit,"L"):e}class XR{constructor(){this.Sn=new JR}addToCollectionParentIndex(e,t){return this.Sn.add(t),_e.resolve()}getCollectionParents(e,t){return _e.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return _e.resolve()}deleteFieldIndex(e,t){return _e.resolve()}deleteAllFieldIndexes(e){return _e.resolve()}createTargetIndexes(e,t){return _e.resolve()}getDocumentsMatchingTarget(e,t){return _e.resolve(null)}getIndexType(e,t){return _e.resolve(0)}getFieldIndexes(e,t){return _e.resolve([])}getNextCollectionGroupToUpdate(e){return _e.resolve(null)}getMinOffset(e,t){return _e.resolve(Si.min())}getMinOffsetFromCollectionGroup(e,t){return _e.resolve(Si.min())}updateCollectionGroup(e,t,i){return _e.resolve()}updateIndexEntries(e,t){return _e.resolve()}}class JR{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new Is(Qt.comparator),c=!o.has(i);return this.index[t]=o.add(i),c}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new Is(Qt.comparator)).toArray()}}const x1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Oj=41943040;class pn{static withCacheSize(e){return new pn(e,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}pn.DEFAULT_COLLECTION_PERCENTILE=10,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pn.DEFAULT=new pn(Oj,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pn.DISABLED=new pn(-1,0,0);class Po{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Po(0)}static ar(){return new Po(-1)}}const g1="LruGarbageCollector",ZR=1048576;function b1([n,e],[t,i]){const o=Nt(n,t);return o===0?Nt(e,i):o}class e6{constructor(e){this.Pr=e,this.buffer=new Is(b1),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();b1(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class t6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Pe(g1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Qo(t)?Pe(g1,"Ignoring IndexedDB error during garbage collection: ",t):await Wo(t)}await this.Ar(3e5)}))}}class s6{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return _e.resolve(Pf.ce);const i=new e6(t);return this.Vr.forEachTarget(e,(o=>i.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>i.Er(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Pe("LruGarbageCollector","Garbage collection skipped; disabled"),_e.resolve(x1)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),x1):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,o,c,d,p,x,g;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(Pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),o=this.params.maximumSequenceNumbersToCollect):o=w,d=Date.now(),this.nthSequenceNumber(e,o)))).next((w=>(i=w,p=Date.now(),this.removeTargets(e,i,t)))).next((w=>(c=w,x=Date.now(),this.removeOrphanedDocuments(e,i)))).next((w=>(g=Date.now(),bo()<=wt.DEBUG&&Pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${o} in `+(p-d)+`ms
	Removed ${c} targets in `+(x-p)+`ms
	Removed ${w} documents in `+(g-x)+`ms
Total Duration: ${g-b}ms`),_e.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:w}))))}}function n6(n,e){return new s6(n,e)}class a6{constructor(){this.changes=new Al((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?_e.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class r6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class i6{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&gu(i.mutation,o,Pn.empty(),It.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,_t()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=_t()){const o=hl();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((c=>{let d=ou();return c.forEach(((p,x)=>{d=d.insert(p,x.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=hl();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,_t())))}populateOverlays(e,t,i){const o=[];return i.forEach((c=>{t.has(c)||o.push(c)})),this.documentOverlayCache.getOverlays(e,o).next((c=>{c.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,o){let c=Cr();const d=xu(),p=(function(){return xu()})();return t.forEach(((x,g)=>{const b=i.get(g.key);o.has(g.key)&&(b===void 0||b.mutation instanceof Oi)?c=c.insert(g.key,g):b!==void 0?(d.set(g.key,b.mutation.getFieldMask()),gu(b.mutation,g,b.mutation.getFieldMask(),It.now())):d.set(g.key,Pn.empty())})),this.recalculateAndSaveOverlays(e,c).next((x=>(x.forEach(((g,b)=>d.set(g,b))),t.forEach(((g,b)=>p.set(g,new r6(b,d.get(g)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=xu();let o=new rs(((d,p)=>d-p)),c=_t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((x=>{const g=t.get(x);if(g===null)return;let b=i.get(x)||Pn.empty();b=p.applyToLocalView(g,b),i.set(x,b);const w=(o.get(p.batchId)||_t()).add(x);o=o.insert(p.batchId,w)}))})).next((()=>{const d=[],p=o.getReverseIterator();for(;p.hasNext();){const x=p.getNext(),g=x.key,b=x.value,w=xj();b.forEach((_=>{if(!c.has(_)){const A=Nj(t.get(_),i.get(_));A!==null&&w.set(_,A),c=c.add(_)}})),d.push(this.documentOverlayCache.saveOverlays(e,g,w))}return _e.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return lR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dj(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-c.size):_e.resolve(hl());let p=Su,x=c;return d.next((g=>_e.forEach(g,((b,w)=>(p<w.largestBatchId&&(p=w.largestBatchId),c.get(b)?_e.resolve():this.remoteDocumentCache.getEntry(e,b).next((_=>{x=x.insert(b,_)}))))).next((()=>this.populateOverlays(e,g,c))).next((()=>this.computeViews(e,x,g,_t()))).next((b=>({batchId:p,changes:pj(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ze(t)).next((i=>{let o=ou();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const c=t.collectionGroup;let d=ou();return this.indexManager.getCollectionParents(e,c).next((p=>_e.forEach(p,(x=>{const g=(function(w,_){return new qu(_,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,x.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,i,o).next((b=>{b.forEach(((w,_)=>{d=d.insert(w,_)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,c,o)))).next((d=>{c.forEach(((x,g)=>{const b=g.getKey();d.get(b)===null&&(d=d.insert(b,Qs.newInvalidDocument(b)))}));let p=ou();return d.forEach(((x,g)=>{const b=c.get(x);b!==void 0&&gu(b.mutation,g,Pn.empty(),It.now()),zf(t,g)&&(p=p.insert(x,g))})),p}))}}class l6{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return _e.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Qa(o.createTime)}})(t)),_e.resolve()}getNamedQuery(e,t){return _e.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(o){return{name:o.name,query:KR(o.bundledQuery),readTime:Qa(o.readTime)}})(t)),_e.resolve()}}class o6{constructor(){this.overlays=new rs(Ze.comparator),this.Lr=new Map}getOverlay(e,t){return _e.resolve(this.overlays.get(t))}getOverlays(e,t){const i=hl();return _e.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&i.set(o,c)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,c)=>{this.bt(e,t,c)})),_e.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.Lr.get(i);return o!==void 0&&(o.forEach((c=>this.overlays=this.overlays.remove(c))),this.Lr.delete(i)),_e.resolve()}getOverlaysForCollection(e,t,i){const o=hl(),c=t.length+1,d=new Ze(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const x=p.getNext().value,g=x.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&x.largestBatchId>i&&o.set(x.getKey(),x)}return _e.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let c=new rs(((g,b)=>g-b));const d=this.overlays.getIterator();for(;d.hasNext();){const g=d.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>i){let b=c.get(g.largestBatchId);b===null&&(b=hl(),c=c.insert(g.largestBatchId,b)),b.set(g.getKey(),g)}}const p=hl(),x=c.getIterator();for(;x.hasNext()&&(x.getNext().value.forEach(((g,b)=>p.set(g,b))),!(p.size()>=o)););return _e.resolve(p)}bt(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const d=this.Lr.get(o.largestBatchId).delete(i.key);this.Lr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new ER(t,i));let c=this.Lr.get(t);c===void 0&&(c=_t(),this.Lr.set(t,c)),this.Lr.set(t,c.add(i.key))}}class c6{constructor(){this.sessionToken=qs.EMPTY_BYTE_STRING}getSessionToken(e){return _e.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,_e.resolve()}}class Gx{constructor(){this.kr=new Is(Ps.Kr),this.qr=new Is(Ps.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Ps(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Ps(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Ze(new Qt([])),i=new Ps(t,e),o=new Ps(t,e+1),c=[];return this.qr.forEachInRange([i,o],(d=>{this.Wr(d),c.push(d.key)})),c}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Ze(new Qt([])),i=new Ps(t,e),o=new Ps(t,e+1);let c=_t();return this.qr.forEachInRange([i,o],(d=>{c=c.add(d.key)})),c}containsKey(e){const t=new Ps(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Ps{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Ze.comparator(e.key,t.key)||Nt(e.Hr,t.Hr)}static Ur(e,t){return Nt(e.Hr,t.Hr)||Ze.comparator(e.key,t.key)}}class u6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Is(Ps.Kr)}checkEmpty(e){return _e.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const c=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new SR(c,t,i,o);this.mutationQueue.push(d);for(const p of o)this.Jr=this.Jr.add(new Ps(p.key,c)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return _e.resolve(d)}lookupMutationBatch(e,t){return _e.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.Xr(i),c=o<0?0:o;return _e.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return _e.resolve(this.mutationQueue.length===0?Px:this.Yn-1)}getAllMutationBatches(e){return _e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Ps(t,0),o=new Ps(t,Number.POSITIVE_INFINITY),c=[];return this.Jr.forEachInRange([i,o],(d=>{const p=this.Zr(d.Hr);c.push(p)})),_e.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Is(Nt);return t.forEach((o=>{const c=new Ps(o,0),d=new Ps(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([c,d],(p=>{i=i.add(p.Hr)}))})),_e.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let c=i;Ze.isDocumentKey(c)||(c=c.child(""));const d=new Ps(new Ze(c),0);let p=new Is(Nt);return this.Jr.forEachWhile((x=>{const g=x.key.path;return!!i.isPrefixOf(g)&&(g.length===o&&(p=p.add(x.Hr)),!0)}),d),_e.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const o=this.Zr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){Mt(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return _e.forEach(t.mutations,(o=>{const c=new Ps(o.key,t.batchId);return i=i.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Ps(t,0),o=this.Jr.firstAfterOrEqual(i);return _e.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,_e.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class d6{constructor(e){this.ti=e,this.docs=(function(){return new rs(Ze.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),c=o?o.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return _e.resolve(i?i.document.mutableCopy():Qs.newInvalidDocument(t))}getEntries(e,t){let i=Cr();return t.forEach((o=>{const c=this.docs.get(o);i=i.insert(o,c?c.document.mutableCopy():Qs.newInvalidDocument(o))})),_e.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let c=Cr();const d=t.path,p=new Ze(d.child("__id-9223372036854775808__")),x=this.docs.getIteratorFrom(p);for(;x.hasNext();){const{key:g,value:{document:b}}=x.getNext();if(!d.isPrefixOf(g.path))break;g.path.length>d.length+1||V4(P4(b),i)<=0||(o.has(b.key)||zf(t,b))&&(c=c.insert(b.key,b.mutableCopy()))}return _e.resolve(c)}getAllFromCollectionGroup(e,t,i,o){at(9500)}ni(e,t){return _e.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new h6(this)}getSize(e){return _e.resolve(this.size)}}class h6 extends a6{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(i)})),_e.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class f6{constructor(e){this.persistence=e,this.ri=new Al((t=>Ux(t)),Bx),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.ii=0,this.si=new Gx,this.targetCount=0,this.oi=Po._r()}forEachTarget(e,t){return this.ri.forEach(((i,o)=>t(o))),_e.resolve()}getLastRemoteSnapshotVersion(e){return _e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _e.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),_e.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),_e.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Po(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,_e.resolve()}updateTargetData(e,t){return this.lr(t),_e.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,_e.resolve()}removeTargets(e,t,i){let o=0;const c=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),c.push(this.removeMatchingKeysForTargetId(e,p.targetId)),o++)})),_e.waitFor(c).next((()=>o))}getTargetCount(e){return _e.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return _e.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),_e.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach((d=>{c.push(o.markPotentiallyOrphaned(e,d))})),_e.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),_e.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return _e.resolve(i)}containsKey(e,t){return _e.resolve(this.si.containsKey(t))}}class Pj{constructor(e,t){this._i={},this.overlays={},this.ai=new Pf(0),this.ui=!1,this.ui=!0,this.ci=new c6,this.referenceDelegate=e(this),this.li=new f6(this),this.indexManager=new XR,this.remoteDocumentCache=(function(o){return new d6(o)})((i=>this.referenceDelegate.hi(i))),this.serializer=new QR(t),this.Pi=new l6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new o6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new u6(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Pe("MemoryPersistence","Starting transaction:",e);const o=new m6(this.ai.next());return this.referenceDelegate.Ti(),i(o).next((c=>this.referenceDelegate.Ii(o).next((()=>c)))).toPromise().then((c=>(o.raiseOnCommittedEvent(),c)))}Ei(e,t){return _e.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class m6 extends U4{constructor(e){super(),this.currentSequenceNumber=e}}class Yx{constructor(e){this.persistence=e,this.Ri=new Gx,this.Ai=null}static Vi(e){return new Yx(e)}get di(){if(this.Ai)return this.Ai;throw at(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),_e.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),_e.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),_e.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((o=>this.di.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((c=>this.di.add(c.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _e.forEach(this.di,(i=>{const o=Ze.fromPath(i);return this.mi(e,o).next((c=>{c||t.removeEntry(o,lt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return _e.or([()=>_e.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class mf{constructor(e,t){this.persistence=e,this.fi=new Al((i=>F4(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=n6(this,t)}static Vi(e,t){return new mf(e,t)}Ti(){}Ii(e){return _e.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return _e.forEach(this.fi,((i,o)=>this.wr(e,i,o).next((c=>c?_e.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,c.removeEntry(d,lt.min()))})))).next((()=>c.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),_e.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),_e.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),_e.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),_e.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Bh(e.data.value)),t}wr(e,t,i){return _e.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.fi.get(t);return _e.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Wx{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=o}static Es(e,t){let i=_t(),o=_t();for(const c of t.docChanges)switch(c.type){case 0:i=i.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new Wx(e,t.fromCache,i,o)}}class p6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class x6{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return q5()?8:B4(Xs())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const c={result:null};return this.gs(e,t).next((d=>{c.result=d})).next((()=>{if(!c.result)return this.ps(e,t,o,i).next((d=>{c.result=d}))})).next((()=>{if(c.result)return;const d=new p6;return this.ys(e,t,d).next((p=>{if(c.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>c.result))}ws(e,t,i,o){return i.documentReadCount<this.Vs?(bo()<=wt.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",yo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),_e.resolve()):(bo()<=wt.DEBUG&&Pe("QueryEngine","Query:",yo(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.ds*o?(bo()<=wt.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",yo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wa(t))):_e.resolve())}gs(e,t){if(i1(t))return _e.resolve(null);let i=Wa(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=W0(t,null,"F"),i=Wa(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((c=>{const d=_t(...c);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((x=>{const g=this.bs(t,p);return this.Ss(t,g,d,x.readTime)?this.gs(e,W0(t,null,"F")):this.Ds(e,g,t,x)}))))})))))}ps(e,t,i,o){return i1(t)||o.isEqual(lt.min())?_e.resolve(null):this.fs.getDocuments(e,i).next((c=>{const d=this.bs(t,c);return this.Ss(t,d,i,o)?_e.resolve(null):(bo()<=wt.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),yo(t)),this.Ds(e,d,t,O4(o,Su)).next((p=>p)))}))}bs(e,t){let i=new Is(fj(e));return t.forEach(((o,c)=>{zf(e,c)&&(i=i.add(c))})),i}Ss(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}ys(e,t,i){return bo()<=wt.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",yo(t)),this.fs.getDocumentsMatchingQuery(e,t,Si.min(),i)}Ds(e,t,i,o){return this.fs.getDocumentsMatchingQuery(e,i,o).next((c=>(t.forEach((d=>{c=c.insert(d.key,d)})),c)))}}const Qx="LocalStore",g6=3e8;class b6{constructor(e,t,i,o){this.persistence=e,this.Cs=t,this.serializer=o,this.vs=new rs(Nt),this.Fs=new Al((c=>Ux(c)),Bx),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new i6(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function y6(n,e,t,i){return new b6(n,e,t,i)}async function Vj(n,e){const t=ut(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((c=>(o=c,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((c=>{const d=[],p=[];let x=_t();for(const g of o){d.push(g.batchId);for(const b of g.mutations)x=x.add(b.key)}for(const g of c){p.push(g.batchId);for(const b of g.mutations)x=x.add(b.key)}return t.localDocuments.getDocuments(i,x).next((g=>({Ns:g,removedBatchIds:d,addedBatchIds:p})))}))}))}function v6(n,e){const t=ut(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),c=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,x,g,b){const w=g.batch,_=w.keys();let A=_e.resolve();return _.forEach((L=>{A=A.next((()=>b.getEntry(x,L))).next((V=>{const F=g.docVersions.get(L);Mt(F!==null,48541),V.version.compareTo(F)<0&&(w.applyToRemoteDocument(V,g),V.isValidDocument()&&(V.setReadTime(g.commitVersion),b.addEntry(V)))}))})),A.next((()=>p.mutationQueue.removeMutationBatch(x,w)))})(t,i,e,c).next((()=>c.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let x=_t();for(let g=0;g<p.mutationResults.length;++g)p.mutationResults[g].transformResults.length>0&&(x=x.add(p.batch.mutations[g].key));return x})(e)))).next((()=>t.localDocuments.getDocuments(i,o)))}))}function Lj(n){const e=ut(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function w6(n,e){const t=ut(n),i=e.snapshotVersion;let o=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});o=t.vs;const p=[];e.targetChanges.forEach(((b,w)=>{const _=o.get(w);if(!_)return;p.push(t.li.removeMatchingKeys(c,b.removedDocuments,w).next((()=>t.li.addMatchingKeys(c,b.addedDocuments,w))));let A=_.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(w)!==null?A=A.withResumeToken(qs.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):b.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(b.resumeToken,i)),o=o.insert(w,A),(function(V,F,q){return V.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=g6?!0:q.addedDocuments.size+q.modifiedDocuments.size+q.removedDocuments.size>0})(_,A,b)&&p.push(t.li.updateTargetData(c,A))}));let x=Cr(),g=_t();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(c,b))})),p.push(N6(c,d,e.documentUpdates).next((b=>{x=b.Bs,g=b.Ls}))),!i.isEqual(lt.min())){const b=t.li.getLastRemoteSnapshotVersion(c).next((w=>t.li.setTargetsMetadata(c,c.currentSequenceNumber,i)));p.push(b)}return _e.waitFor(p).next((()=>d.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,x,g))).next((()=>x))})).then((c=>(t.vs=o,c)))}function N6(n,e,t){let i=_t(),o=_t();return t.forEach((c=>i=i.add(c))),e.getEntries(n,i).next((c=>{let d=Cr();return t.forEach(((p,x)=>{const g=c.get(p);x.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(p)),x.isNoDocument()&&x.version.isEqual(lt.min())?(e.removeEntry(p,x.readTime),d=d.insert(p,x)):!g.isValidDocument()||x.version.compareTo(g.version)>0||x.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(x),d=d.insert(p,x)):Pe(Qx,"Ignoring outdated watch update for ",p,". Current version:",g.version," Watch version:",x.version)})),{Bs:d,Ls:o}}))}function _6(n,e){const t=ut(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Px),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function j6(n,e){const t=ut(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.li.getTargetData(i,e).next((c=>c?(o=c,_e.resolve(o)):t.li.allocateTargetId(i).next((d=>(o=new gi(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.vs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Z0(n,e,t){const i=ut(n),o=i.vs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",c,(d=>i.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!Qo(d))throw d;Pe(Qx,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(o.target)}function y1(n,e,t){const i=ut(n);let o=lt.min(),c=_t();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(x,g,b){const w=ut(x),_=w.Fs.get(b);return _!==void 0?_e.resolve(w.vs.get(_)):w.li.getTargetData(g,b)})(i,d,Wa(e)).next((p=>{if(p)return o=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((x=>{c=x}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?o:lt.min(),t?c:_t()))).next((p=>(S6(i,cR(e),p),{documents:p,ks:c})))))}function S6(n,e,t){let i=n.Ms.get(e)||lt.min();t.forEach(((o,c)=>{c.readTime.compareTo(i)>0&&(i=c.readTime)})),n.Ms.set(e,i)}class v1{constructor(){this.activeTargetIds=pR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class E6{constructor(){this.vo=new v1,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new v1,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class T6{Mo(e){}shutdown(){}}const w1="ConnectivityMonitor";class N1{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Pe(w1,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Pe(w1,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let jh=null;function ex(){return jh===null?jh=(function(){return 268435456+Math.round(2147483648*Math.random())})():jh++,"0x"+jh.toString(16)}const x0="RestConnection",A6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class k6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${o}`,this.$o=this.databaseId.database===of?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Wo(e,t,i,o,c){const d=ex(),p=this.Qo(e,t.toUriEncodedString());Pe(x0,`Sending RPC '${e}' ${d}:`,p,i);const x={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(x,o,c);const{host:g}=new URL(p),b=Za(g);return this.zo(e,p,x,i,b).then((w=>(Pe(x0,`Received RPC '${e}' ${d}: `,w),w)),(w=>{throw Io(x0,`RPC '${e}' ${d} failed with error: `,w,"url: ",p,"request:",i),w}))}jo(e,t,i,o,c,d){return this.Wo(e,t,i,o,c)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Yo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,c)=>e[c]=o)),i&&i.headers.forEach(((o,c)=>e[c]=o))}Qo(e,t){const i=A6[e];let o=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class C6{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Ys="WebChannelConnection",Jc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(o){setTimeout((()=>{throw o}),0)}}))};class To extends k6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!To.c_){const e=$_();Jc(e,F_.STAT_EVENT,(t=>{t.stat===z0.PROXY?Pe(Ys,"STAT_EVENT: detected buffering proxy"):t.stat===z0.NOPROXY&&Pe(Ys,"STAT_EVENT: detected no buffering proxy")})),To.c_=!0}}zo(e,t,i,o,c){const d=ex();return new Promise(((p,x)=>{const g=new B_;g.setWithCredentials(!0),g.listenOnce(z_.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case Uh.NO_ERROR:const w=g.getResponseJson();Pe(Ys,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(w)),p(w);break;case Uh.TIMEOUT:Pe(Ys,`RPC '${e}' ${d} timed out`),x(new Me(Ne.DEADLINE_EXCEEDED,"Request time out"));break;case Uh.HTTP_ERROR:const _=g.getStatus();if(Pe(Ys,`RPC '${e}' ${d} failed with status:`,_,"response text:",g.getResponseText()),_>0){let A=g.getResponseJson();Array.isArray(A)&&(A=A[0]);const L=A?.error;if(L&&L.status&&L.message){const V=(function(q){const Q=q.toLowerCase().replace(/_/g,"-");return Object.values(Ne).indexOf(Q)>=0?Q:Ne.UNKNOWN})(L.status);x(new Me(V,L.message))}else x(new Me(Ne.UNKNOWN,"Server responded with status "+g.getStatus()))}else x(new Me(Ne.UNAVAILABLE,"Connection failed."));break;default:at(9055,{l_:e,streamId:d,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Pe(Ys,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(o);Pe(Ys,`RPC '${e}' ${d} sending request:`,o),g.send(t,"POST",b,i,15)}))}T_(e,t,i){const o=ex(),c=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},x=this.longPollingOptions.timeoutSeconds;x!==void 0&&(p.longPollingTimeout=Math.round(1e3*x)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const g=c.join("");Pe(Ys,`Creating RPC '${e}' stream ${o}: ${g}`,p);const b=d.createWebChannel(g,p);this.I_(b);let w=!1,_=!1;const A=new C6({Ho:L=>{_?Pe(Ys,`Not sending because RPC '${e}' stream ${o} is closed:`,L):(w||(Pe(Ys,`Opening RPC '${e}' stream ${o} transport.`),b.open(),w=!0),Pe(Ys,`RPC '${e}' stream ${o} sending:`,L),b.send(L))},Jo:()=>b.close()});return Jc(b,lu.EventType.OPEN,(()=>{_||(Pe(Ys,`RPC '${e}' stream ${o} transport opened.`),A.i_())})),Jc(b,lu.EventType.CLOSE,(()=>{_||(_=!0,Pe(Ys,`RPC '${e}' stream ${o} transport closed`),A.o_(),this.E_(b))})),Jc(b,lu.EventType.ERROR,(L=>{_||(_=!0,Io(Ys,`RPC '${e}' stream ${o} transport errored. Name:`,L.name,"Message:",L.message),A.o_(new Me(Ne.UNAVAILABLE,"The operation could not be completed")))})),Jc(b,lu.EventType.MESSAGE,(L=>{if(!_){const V=L.data[0];Mt(!!V,16349);const F=V,q=F?.error||F[0]?.error;if(q){Pe(Ys,`RPC '${e}' stream ${o} received error:`,q);const Q=q.status;let H=(function(Y){const T=Es[Y];if(T!==void 0)return jj(T)})(Q),ie=q.message;H===void 0&&(H=Ne.INTERNAL,ie="Unknown error status: "+Q+" with message "+q.message),_=!0,A.o_(new Me(H,ie)),b.close()}else Pe(Ys,`RPC '${e}' stream ${o} received:`,V),A.__(V)}})),To.u_(),setTimeout((()=>{A.s_()}),0),A}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return q_()}}function R6(n){return new To(n)}function g0(){return typeof document<"u"?document:null}function Hf(n){return new OR(n,!0)}To.c_=!1;class Uj{constructor(e,t,i=1e3,o=1.5,c=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=o,this.V_=c,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&Pe("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const _1="PersistentStream";class Bj{constructor(e,t,i,o,c,d,p,x){this.Ci=e,this.b_=i,this.S_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=x,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Uj(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ne.RESOURCE_EXHAUSTED?(kr(t.toString()),kr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new Me(Ne.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Pe(_1,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Pe(_1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class I6 extends Bj{constructor(e,t,i,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=LR(this.serializer,e),i=(function(c){if(!("targetChange"in c))return lt.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?lt.min():d.readTime?Qa(d.readTime):lt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=J0(this.serializer),t.addTarget=(function(c,d){let p;const x=d.target;if(p=G0(x)?{documents:zR(c,x)}:{query:FR(c,x).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=Tj(c,d.resumeToken);const g=Q0(c,d.expectedCount);g!==null&&(p.expectedCount=g)}else if(d.snapshotVersion.compareTo(lt.min())>0){p.readTime=ff(c,d.snapshotVersion.toTimestamp());const g=Q0(c,d.expectedCount);g!==null&&(p.expectedCount=g)}return p})(this.serializer,e);const i=qR(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=J0(this.serializer),t.removeTarget=e,this.K_(t)}}class D6 extends Bj{constructor(e,t,i,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Mt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Mt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Mt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=BR(e.writeResults,e.commitTime),i=Qa(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=J0(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>UR(this.serializer,i)))};this.K_(t)}}class M6{}class O6 extends M6{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Me(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Wo(e,K0(t,i),o,c,d))).catch((c=>{throw c.name==="FirebaseError"?(c.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Me(Ne.UNKNOWN,c.toString())}))}jo(e,t,i,o,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,K0(t,i),o,d,p,c))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Me(Ne.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function P6(n,e,t,i){return new O6(n,e,t,i)}class V6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(kr(t),this.aa=!1):Pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const wl="RemoteStore";class L6{constructor(e,t,i,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=c,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{kl(this)&&(Pe(wl,"Restarting streams for network reachability change."),await(async function(x){const g=ut(x);g.Ea.add(4),await Yu(g),g.Va.set("Unknown"),g.Ea.delete(4),await Gf(g)})(this))}))})),this.Va=new V6(i,o)}}async function Gf(n){if(kl(n))for(const e of n.Ra)await e(!0)}async function Yu(n){for(const e of n.Ra)await e(!1)}function zj(n,e){const t=ut(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Zx(t)?Jx(t):Ko(t).O_()&&Xx(t,e))}function Kx(n,e){const t=ut(n),i=Ko(t);t.Ia.delete(e),i.O_()&&Fj(t,e),t.Ia.size===0&&(i.O_()?i.L_():kl(t)&&t.Va.set("Unknown"))}function Xx(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ko(n).Z_(e)}function Fj(n,e){n.da.$e(e),Ko(n).X_(e)}function Jx(n){n.da=new RR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ko(n).start(),n.Va.ua()}function Zx(n){return kl(n)&&!Ko(n).x_()&&n.Ia.size>0}function kl(n){return ut(n).Ea.size===0}function $j(n){n.da=void 0}async function U6(n){n.Va.set("Online")}async function B6(n){n.Ia.forEach(((e,t)=>{Xx(n,e)}))}async function z6(n,e){$j(n),Zx(n)?(n.Va.ha(e),Jx(n)):n.Va.set("Unknown")}async function F6(n,e,t){if(n.Va.set("Online"),e instanceof Ej&&e.state===2&&e.cause)try{await(async function(o,c){const d=c.cause;for(const p of c.targetIds)o.Ia.has(p)&&(await o.remoteSyncer.rejectListen(p,d),o.Ia.delete(p),o.da.removeTarget(p))})(n,e)}catch(i){Pe(wl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await pf(n,i)}else if(e instanceof $h?n.da.Xe(e):e instanceof Sj?n.da.st(e):n.da.tt(e),!t.isEqual(lt.min()))try{const i=await Lj(n.localStore);t.compareTo(i)>=0&&await(function(c,d){const p=c.da.Tt(d);return p.targetChanges.forEach(((x,g)=>{if(x.resumeToken.approximateByteSize()>0){const b=c.Ia.get(g);b&&c.Ia.set(g,b.withResumeToken(x.resumeToken,d))}})),p.targetMismatches.forEach(((x,g)=>{const b=c.Ia.get(x);if(!b)return;c.Ia.set(x,b.withResumeToken(qs.EMPTY_BYTE_STRING,b.snapshotVersion)),Fj(c,x);const w=new gi(b.target,x,g,b.sequenceNumber);Xx(c,w)})),c.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){Pe(wl,"Failed to raise snapshot:",i),await pf(n,i)}}async function pf(n,e,t){if(!Qo(e))throw e;n.Ea.add(1),await Yu(n),n.Va.set("Offline"),t||(t=()=>Lj(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Pe(wl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Gf(n)}))}function qj(n,e){return e().catch((t=>pf(n,t,e)))}async function Yf(n){const e=ut(n),t=ki(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Px;for(;$6(e);)try{const o=await _6(e.localStore,i);if(o===null){e.Ta.length===0&&t.L_();break}i=o.batchId,q6(e,o)}catch(o){await pf(e,o)}Hj(e)&&Gj(e)}function $6(n){return kl(n)&&n.Ta.length<10}function q6(n,e){n.Ta.push(e);const t=ki(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function Hj(n){return kl(n)&&!ki(n).x_()&&n.Ta.length>0}function Gj(n){ki(n).start()}async function H6(n){ki(n).ra()}async function G6(n){const e=ki(n);for(const t of n.Ta)e.ea(t.mutations)}async function Y6(n,e,t){const i=n.Ta.shift(),o=$x.from(i,e,t);await qj(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await Yf(n)}async function W6(n,e){e&&ki(n).Y_&&await(async function(i,o){if((function(d){return AR(d)&&d!==Ne.ABORTED})(o.code)){const c=i.Ta.shift();ki(i).B_(),await qj(i,(()=>i.remoteSyncer.rejectFailedWrite(c.batchId,o))),await Yf(i)}})(n,e),Hj(n)&&Gj(n)}async function j1(n,e){const t=ut(n);t.asyncQueue.verifyOperationInProgress(),Pe(wl,"RemoteStore received new credentials");const i=kl(t);t.Ea.add(3),await Yu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Gf(t)}async function Q6(n,e){const t=ut(n);e?(t.Ea.delete(2),await Gf(t)):e||(t.Ea.add(2),await Yu(t),t.Va.set("Unknown"))}function Ko(n){return n.ma||(n.ma=(function(t,i,o){const c=ut(t);return c.sa(),new I6(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:U6.bind(null,n),Yo:B6.bind(null,n),t_:z6.bind(null,n),J_:F6.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),Zx(n)?Jx(n):n.Va.set("Unknown")):(await n.ma.stop(),$j(n))}))),n.ma}function ki(n){return n.fa||(n.fa=(function(t,i,o){const c=ut(t);return c.sa(),new D6(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:H6.bind(null,n),t_:W6.bind(null,n),ta:G6.bind(null,n),na:Y6.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Yf(n)):(await n.fa.stop(),n.Ta.length>0&&(Pe(wl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class eg{constructor(e,t,i,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=c,this.deferred=new jr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,c){const d=Date.now()+i,p=new eg(e,t,d,o,c);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Me(Ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tg(n,e){if(kr("AsyncQueue",`${e}: ${n}`),Qo(n))return new Me(Ne.UNAVAILABLE,`${e}: ${n}`);throw n}class Ao{static emptySet(e){return new Ao(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ze.comparator(t.key,i.key):(t,i)=>Ze.comparator(t.key,i.key),this.keyedMap=ou(),this.sortedSet=new rs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ao)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Ao;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class S1{constructor(){this.ga=new rs(Ze.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):at(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Vo{constructor(e,t,i,o,c,d,p,x,g){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=x,this.hasCachedResults=g}static fromInitialDocuments(e,t,i,o,c){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new Vo(e,t,Ao.emptySet(t),d,i,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Bf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}class K6{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class X6{constructor(){this.queries=E1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=ut(t),c=o.queries;o.queries=E1(),c.forEach(((d,p)=>{for(const x of p.ba)x.onError(i)}))})(this,new Me(Ne.ABORTED,"Firestore shutting down"))}}function E1(){return new Al((n=>hj(n)),Bf)}async function sg(n,e){const t=ut(n);let i=3;const o=e.query;let c=t.queries.get(o);c?!c.Sa()&&e.Da()&&(i=2):(c=new K6,i=e.Da()?0:1);try{switch(i){case 0:c.wa=await t.onListen(o,!0);break;case 1:c.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const p=tg(d,`Initialization of query '${yo(e.query)}' failed`);return void e.onError(p)}t.queries.set(o,c),c.ba.push(e),e.va(t.onlineState),c.wa&&e.Fa(c.wa)&&ag(t)}async function ng(n,e){const t=ut(n),i=e.query;let o=3;const c=t.queries.get(i);if(c){const d=c.ba.indexOf(e);d>=0&&(c.ba.splice(d,1),c.ba.length===0?o=e.Da()?0:1:!c.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function J6(n,e){const t=ut(n);let i=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const p of d.ba)p.Fa(o)&&(i=!0);d.wa=o}}i&&ag(t)}function Z6(n,e,t){const i=ut(n),o=i.queries.get(e);if(o)for(const c of o.ba)c.onError(t);i.queries.delete(e)}function ag(n){n.Ca.forEach((e=>{e.next()}))}var tx,T1;(T1=tx||(tx={})).Ma="default",T1.Cache="cache";class rg{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new Vo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Vo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tx.Cache}}class Yj{constructor(e){this.key=e}}class Wj{constructor(e){this.key=e}}class e3{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=_t(),this.mutatedKeys=_t(),this.eu=fj(e),this.tu=new Ao(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new S1,o=t?t.tu:this.tu;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,p=!1;const x=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,w)=>{const _=o.get(b),A=zf(this.query,w)?w:null,L=!!_&&this.mutatedKeys.has(_.key),V=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let F=!1;_&&A?_.data.isEqual(A.data)?L!==V&&(i.track({type:3,doc:A}),F=!0):this.su(_,A)||(i.track({type:2,doc:A}),F=!0,(x&&this.eu(A,x)>0||g&&this.eu(A,g)<0)&&(p=!0)):!_&&A?(i.track({type:0,doc:A}),F=!0):_&&!A&&(i.track({type:1,doc:_}),F=!0,(x||g)&&(p=!0)),F&&(A?(d=d.add(A),c=V?c.add(b):c.delete(b)):(d=d.delete(b),c=c.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),c=c.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:p,mutatedKeys:c}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,w)=>(function(A,L){const V=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return at(20277,{Vt:F})}};return V(A)-V(L)})(b.type,w.type)||this.eu(b.doc,w.doc))),this.ou(i),o=o??!1;const p=t&&!o?this._u():[],x=this.Ya.size===0&&this.current&&!o?1:0,g=x!==this.Xa;return this.Xa=x,d.length!==0||g?{snapshot:new Vo(this.query,e.tu,c,d,e.mutatedKeys,x===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new S1,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=_t(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Wj(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Yj(i))})),t}cu(e){this.Za=e.ks,this.Ya=_t();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Vo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const ig="SyncEngine";class t3{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class s3{constructor(e){this.key=e,this.hu=!1}}class n3{constructor(e,t,i,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Al((p=>hj(p)),Bf),this.Iu=new Map,this.Eu=new Set,this.Ru=new rs(Ze.comparator),this.Au=new Map,this.Vu=new Gx,this.du={},this.mu=new Map,this.fu=Po.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function a3(n,e,t=!0){const i=e2(n);let o;const c=i.Tu.get(e);return c?(i.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.lu()):o=await Qj(i,e,t,!0),o}async function r3(n,e){const t=e2(n);await Qj(t,e,!0,!1)}async function Qj(n,e,t,i){const o=await j6(n.localStore,Wa(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let p;return i&&(p=await i3(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&zj(n.remoteStore,o),p}async function i3(n,e,t,i,o){n.pu=(w,_,A)=>(async function(V,F,q,Q){let H=F.view.ru(q);H.Ss&&(H=await y1(V.localStore,F.query,!1).then((({documents:T})=>F.view.ru(T,H))));const ie=Q&&Q.targetChanges.get(F.targetId),le=Q&&Q.targetMismatches.get(F.targetId)!=null,Y=F.view.applyChanges(H,V.isPrimaryClient,ie,le);return k1(V,F.targetId,Y.au),Y.snapshot})(n,w,_,A);const c=await y1(n.localStore,e,!0),d=new e3(e,c.ks),p=d.ru(c.documents),x=Gu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),g=d.applyChanges(p,n.isPrimaryClient,x);k1(n,t,g.au);const b=new t3(e,t,d);return n.Tu.set(e,b),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),g.snapshot}async function l3(n,e,t){const i=ut(n),o=i.Tu.get(e),c=i.Iu.get(o.targetId);if(c.length>1)return i.Iu.set(o.targetId,c.filter((d=>!Bf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await Z0(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&Kx(i.remoteStore,o.targetId),sx(i,o.targetId)})).catch(Wo)):(sx(i,o.targetId),await Z0(i.localStore,o.targetId,!0))}async function o3(n,e){const t=ut(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Kx(t.remoteStore,i.targetId))}async function c3(n,e,t){const i=x3(n);try{const o=await(function(d,p){const x=ut(d),g=It.now(),b=p.reduce(((A,L)=>A.add(L.key)),_t());let w,_;return x.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let L=Cr(),V=_t();return x.xs.getEntries(A,b).next((F=>{L=F,L.forEach(((q,Q)=>{Q.isValidDocument()||(V=V.add(q))}))})).next((()=>x.localDocuments.getOverlayedDocuments(A,L))).next((F=>{w=F;const q=[];for(const Q of p){const H=_R(Q,w.get(Q.key).overlayedDocument);H!=null&&q.push(new Oi(Q.key,H,aj(H.value.mapValue),na.exists(!0)))}return x.mutationQueue.addMutationBatch(A,g,q,p)})).next((F=>{_=F;const q=F.applyToLocalDocumentSet(w,V);return x.documentOverlayCache.saveOverlays(A,F.batchId,q)}))})).then((()=>({batchId:_.batchId,changes:pj(w)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(d,p,x){let g=d.du[d.currentUser.toKey()];g||(g=new rs(Nt)),g=g.insert(p,x),d.du[d.currentUser.toKey()]=g})(i,o.batchId,t),await Wu(i,o.changes),await Yf(i.remoteStore)}catch(o){const c=tg(o,"Failed to persist write");t.reject(c)}}async function Kj(n,e){const t=ut(n);try{const i=await w6(t.localStore,e);e.targetChanges.forEach(((o,c)=>{const d=t.Au.get(c);d&&(Mt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?Mt(d.hu,14607):o.removedDocuments.size>0&&(Mt(d.hu,42227),d.hu=!1))})),await Wu(t,i,e)}catch(i){await Wo(i)}}function A1(n,e,t){const i=ut(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((c,d)=>{const p=d.view.va(e);p.snapshot&&o.push(p.snapshot)})),(function(d,p){const x=ut(d);x.onlineState=p;let g=!1;x.queries.forEach(((b,w)=>{for(const _ of w.ba)_.va(p)&&(g=!0)})),g&&ag(x)})(i.eventManager,e),o.length&&i.Pu.J_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function u3(n,e,t){const i=ut(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),c=o&&o.key;if(c){let d=new rs(Ze.comparator);d=d.insert(c,Qs.newNoDocument(c,lt.min()));const p=_t().add(c),x=new qf(lt.min(),new Map,new rs(Nt),d,p);await Kj(i,x),i.Ru=i.Ru.remove(c),i.Au.delete(e),lg(i)}else await Z0(i.localStore,e,!1).then((()=>sx(i,e,t))).catch(Wo)}async function d3(n,e){const t=ut(n),i=e.batch.batchId;try{const o=await v6(t.localStore,e);Jj(t,i,null),Xj(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Wu(t,o)}catch(o){await Wo(o)}}async function h3(n,e,t){const i=ut(n);try{const o=await(function(d,p){const x=ut(d);return x.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let b;return x.mutationQueue.lookupMutationBatch(g,p).next((w=>(Mt(w!==null,37113),b=w.keys(),x.mutationQueue.removeMutationBatch(g,w)))).next((()=>x.mutationQueue.performConsistencyCheck(g))).next((()=>x.documentOverlayCache.removeOverlaysForBatchId(g,b,p))).next((()=>x.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,b))).next((()=>x.localDocuments.getDocuments(g,b)))}))})(i.localStore,e);Jj(i,e,t),Xj(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Wu(i,o)}catch(o){await Wo(o)}}function Xj(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Jj(n,e,t){const i=ut(n);let o=i.du[i.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),i.du[i.currentUser.toKey()]=o}}function sx(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||Zj(n,i)}))}function Zj(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(Kx(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),lg(n))}function k1(n,e,t){for(const i of t)i instanceof Yj?(n.Vu.addReference(i.key,e),f3(n,i)):i instanceof Wj?(Pe(ig,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||Zj(n,i.key)):at(19791,{wu:i})}function f3(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(Pe(ig,"New document in limbo: "+t),n.Eu.add(i),lg(n))}function lg(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ze(Qt.fromString(e)),i=n.fu.next();n.Au.set(i,new s3(t)),n.Ru=n.Ru.insert(t,i),zj(n.remoteStore,new gi(Wa(Uf(t.path)),i,"TargetPurposeLimboResolution",Pf.ce))}}async function Wu(n,e,t){const i=ut(n),o=[],c=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,x)=>{d.push(i.pu(x,e,t).then((g=>{if((g||t)&&i.isPrimaryClient){const b=g?!g.fromCache:t?.targetChanges.get(x.targetId)?.current;i.sharedClientState.updateQueryState(x.targetId,b?"current":"not-current")}if(g){o.push(g);const b=Wx.Es(x.targetId,g);c.push(b)}})))})),await Promise.all(d),i.Pu.J_(o),await(async function(x,g){const b=ut(x);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>_e.forEach(g,(_=>_e.forEach(_.Ts,(A=>b.persistence.referenceDelegate.addReference(w,_.targetId,A))).next((()=>_e.forEach(_.Is,(A=>b.persistence.referenceDelegate.removeReference(w,_.targetId,A)))))))))}catch(w){if(!Qo(w))throw w;Pe(Qx,"Failed to update sequence numbers: "+w)}for(const w of g){const _=w.targetId;if(!w.fromCache){const A=b.vs.get(_),L=A.snapshotVersion,V=A.withLastLimboFreeSnapshotVersion(L);b.vs=b.vs.insert(_,V)}}})(i.localStore,c))}async function m3(n,e){const t=ut(n);if(!t.currentUser.isEqual(e)){Pe(ig,"User change. New user:",e.toKey());const i=await Vj(t.localStore,e);t.currentUser=e,(function(c,d){c.mu.forEach((p=>{p.forEach((x=>{x.reject(new Me(Ne.CANCELLED,d))}))})),c.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Wu(t,i.Ns)}}function p3(n,e){const t=ut(n),i=t.Au.get(e);if(i&&i.hu)return _t().add(i.key);{let o=_t();const c=t.Iu.get(e);if(!c)return o;for(const d of c){const p=t.Tu.get(d);o=o.unionWith(p.view.nu)}return o}}function e2(n){const e=ut(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Kj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=p3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=u3.bind(null,e),e.Pu.J_=J6.bind(null,e.eventManager),e.Pu.yu=Z6.bind(null,e.eventManager),e}function x3(n){const e=ut(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=d3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=h3.bind(null,e),e}class xf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return y6(this.persistence,new x6,e.initialUser,this.serializer)}Cu(e){return new Pj(Yx.Vi,this.serializer)}Du(e){return new E6}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}xf.provider={build:()=>new xf};class g3 extends xf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Mt(this.persistence.referenceDelegate instanceof mf,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new t6(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new Pj((i=>mf.Vi(i,t)),this.serializer)}}class nx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>A1(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=m3.bind(null,this.syncEngine),await Q6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new X6})()}createDatastore(e){const t=Hf(e.databaseInfo.databaseId),i=R6(e.databaseInfo);return P6(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,c,d,p){return new L6(i,o,c,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>A1(this.syncEngine,t,0)),(function(){return N1.v()?new N1:new T6})())}createSyncEngine(e,t){return(function(o,c,d,p,x,g,b){const w=new n3(o,c,d,p,x,g);return b&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=ut(t);Pe(wl,"RemoteStore shutting down."),i.Ea.add(5),await Yu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}nx.provider={build:()=>new nx};class og{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):kr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Ci="FirestoreClient";class b3{constructor(e,t,i,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=o,this.user=Ws.UNAUTHENTICATED,this.clientId=Ox.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(i,(async d=>{Pe(Ci,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Pe(Ci,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new jr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=tg(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function b0(n,e){n.asyncQueue.verifyOperationInProgress(),Pe(Ci,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await Vj(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function C1(n,e){n.asyncQueue.verifyOperationInProgress();const t=await y3(n);Pe(Ci,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>j1(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>j1(e.remoteStore,o))),n._onlineComponents=e}async function y3(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Pe(Ci,"Using user provided OfflineComponentProvider");try{await b0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===Ne.FAILED_PRECONDITION||o.code===Ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Io("Error using user provided cache. Falling back to memory cache: "+t),await b0(n,new xf)}}else Pe(Ci,"Using default OfflineComponentProvider"),await b0(n,new g3(void 0));return n._offlineComponents}async function t2(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Pe(Ci,"Using user provided OnlineComponentProvider"),await C1(n,n._uninitializedComponentsProvider._online)):(Pe(Ci,"Using default OnlineComponentProvider"),await C1(n,new nx))),n._onlineComponents}function v3(n){return t2(n).then((e=>e.syncEngine))}async function gf(n){const e=await t2(n),t=e.eventManager;return t.onListen=a3.bind(null,e.syncEngine),t.onUnlisten=l3.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=r3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=o3.bind(null,e.syncEngine),t}function w3(n,e,t,i){const o=new og(i),c=new rg(e,o,t);return n.asyncQueue.enqueueAndForget((async()=>sg(await gf(n),c))),()=>{o.Nu(),n.asyncQueue.enqueueAndForget((async()=>ng(await gf(n),c)))}}function N3(n,e,t={}){const i=new jr;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,p,x,g){const b=new og({next:_=>{b.Nu(),d.enqueueAndForget((()=>ng(c,w)));const A=_.docs.has(p);!A&&_.fromCache?g.reject(new Me(Ne.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&_.fromCache&&x&&x.source==="server"?g.reject(new Me(Ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(_)},error:_=>g.reject(_)}),w=new rg(Uf(p.path),b,{includeMetadataChanges:!0,Ka:!0});return sg(c,w)})(await gf(n),n.asyncQueue,e,t,i))),i.promise}function _3(n,e,t={}){const i=new jr;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,p,x,g){const b=new og({next:_=>{b.Nu(),d.enqueueAndForget((()=>ng(c,w))),_.fromCache&&x.source==="server"?g.reject(new Me(Ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(_)},error:_=>g.reject(_)}),w=new rg(p,b,{includeMetadataChanges:!0,Ka:!0});return sg(c,w)})(await gf(n),n.asyncQueue,e,t,i))),i.promise}function j3(n,e){const t=new jr;return n.asyncQueue.enqueueAndForget((async()=>c3(await v3(n),e,t))),t.promise}function s2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const S3="ComponentProvider",R1=new Map;function E3(n,e,t,i,o){return new H4(n,e,t,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,s2(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,i)}const n2="firestore.googleapis.com",I1=!0;class D1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Me(Ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=n2,this.ssl=I1}else this.host=e.host,this.ssl=e.ssl??I1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Oj;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ZR)throw new Me(Ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}M4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=s2(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Me(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Me(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Me(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Wf{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new D1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Me(Ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Me(Ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new D1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new j4;switch(i.type){case"firstParty":return new A4(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Me(Ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=R1.get(t);i&&(Pe(S3,"Removing Datastore"),R1.delete(t),i.terminate())})(this),Promise.resolve()}}function T3(n,e,t,i={}){n=wn(n,Wf);const o=Za(e),c=n._getSettings(),d={...c,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;o&&(kf(`https://${p}`),Cf("Firestore",!0)),c.host!==n2&&c.host!==p&&Io("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const x={...c,host:p,ssl:o,emulatorOptions:i};if(!gl(x,d)&&(n._setSettings(x),i.mockUserToken)){let g,b;if(typeof i.mockUserToken=="string")g=i.mockUserToken,b=Ws.MOCK_USER;else{g=JN(i.mockUserToken,n._app?.options.projectId);const w=i.mockUserToken.sub||i.mockUserToken.user_id;if(!w)throw new Me(Ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Ws(w)}n._authCredentials=new S4(new G_(g,b))}}class Cl{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Cl(this.firestore,e,this._query)}}class cs{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cs(this.firestore,e,this._key)}toJSON(){return{type:cs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if($u(t,cs._jsonSchema))return new cs(e,i||null,new Ze(Qt.fromString(t.referencePath)))}}cs._jsonSchemaVersion="firestore/documentReference/1.0",cs._jsonSchema={type:As("string",cs._jsonSchemaVersion),referencePath:As("string")};class wi extends Cl{constructor(e,t,i){super(e,t,Uf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cs(this.firestore,null,new Ze(e))}withConverter(e){return new wi(this.firestore,e,this._path)}}function Je(n,e,...t){if(n=Yt(n),Y_("collection","path",e),n instanceof Wf){const i=Qt.fromString(e,...t);return Gw(i),new wi(n,null,i)}{if(!(n instanceof cs||n instanceof wi))throw new Me(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Qt.fromString(e,...t));return Gw(i),new wi(n.firestore,null,i)}}function Ge(n,e,...t){if(n=Yt(n),arguments.length===1&&(e=Ox.newId()),Y_("doc","path",e),n instanceof Wf){const i=Qt.fromString(e,...t);return Hw(i),new cs(n,null,new Ze(i))}{if(!(n instanceof cs||n instanceof wi))throw new Me(Ne.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Qt.fromString(e,...t));return Hw(i),new cs(n.firestore,n instanceof wi?n.converter:null,new Ze(i))}}const M1="AsyncQueue";class O1{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Uj(this,"async_queue_retry"),this._c=()=>{const i=g0();i&&Pe(M1,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=g0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=g0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new jr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Qo(e))throw e;Pe(M1,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,kr("INTERNAL UNHANDLED ERROR: ",P1(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=eg.createAndSchedule(this,e,t,i,(c=>this.hc(c)));return this.tc.push(o),o}uc(){this.nc&&at(47125,{Pc:P1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function P1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Rr extends Wf{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new O1,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new O1(e),this._firestoreClient=void 0,await e}}}function A3(n,e){const t=typeof n=="object"?n:Rf(),i=typeof n=="string"?n:of,o=Lu(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const c=_x("firestore");c&&T3(o,...c)}return o}function Qf(n){if(n._terminated)throw new Me(Ne.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||k3(n),n._firestoreClient}function k3(n){const e=n._freezeSettings(),t=E3(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new b3(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(o){const c=o?._online.build();return{_offline:o?._offline.build(c),_online:c}})(n._componentsProvider))}class Zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zn(qs.fromBase64String(e))}catch(t){throw new Me(Ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Zn(qs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Zn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($u(e,Zn._jsonSchema))return Zn.fromBase64String(e.bytes)}}Zn._jsonSchemaVersion="firestore/bytes/1.0",Zn._jsonSchema={type:As("string",Zn._jsonSchemaVersion),bytes:As("string")};class cg{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Me(Ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $s(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Kf{constructor(e){this._methodName=e}}class Ka{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Me(Ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Me(Ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Nt(this._lat,e._lat)||Nt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ka._jsonSchemaVersion}}static fromJSON(e){if($u(e,Ka._jsonSchema))return new Ka(e.latitude,e.longitude)}}Ka._jsonSchemaVersion="firestore/geoPoint/1.0",Ka._jsonSchema={type:As("string",Ka._jsonSchemaVersion),latitude:As("number"),longitude:As("number")};class ya{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let c=0;c<i.length;++c)if(i[c]!==o[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ya._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($u(e,ya._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ya(e.vectorValues);throw new Me(Ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ya._jsonSchemaVersion="firestore/vectorValue/1.0",ya._jsonSchema={type:As("string",ya._jsonSchemaVersion),vectorValues:As("object")};const C3=/^__.*__$/;class R3{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Oi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hu(e,this.data,t,this.fieldTransforms)}}class a2{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Oi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function r2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw at(40011,{dataSource:n})}}class ug{constructor(e,t,i,o,c,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,c===void 0&&this.validatePath(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new ug({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return bf(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(r2(this.dataSource)&&C3.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class I3{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Hf(e)}createContext(e,t,i,o=!1){return new ug({dataSource:e,methodName:t,targetDoc:i,path:$s.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xf(n){const e=n._freezeSettings(),t=Hf(n._databaseId);return new I3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function i2(n,e,t,i,o,c={}){const d=n.createContext(c.merge||c.mergeFields?2:0,e,t,o);hg("Data must be an object, but it was:",d,i);const p=l2(i,d);let x,g;if(c.merge)x=new Pn(d.fieldMask),g=d.fieldTransforms;else if(c.mergeFields){const b=[];for(const w of c.mergeFields){const _=Lo(e,w,t);if(!d.contains(_))throw new Me(Ne.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);u2(b,_)||b.push(_)}x=new Pn(b),g=d.fieldTransforms.filter((w=>x.covers(w.field)))}else x=null,g=d.fieldTransforms;return new R3(new gn(p),x,g)}class Jf extends Kf{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jf}}class dg extends Kf{_toFieldTransform(e){return new yR(e.path,new ku)}isEqual(e){return e instanceof dg}}function D3(n,e,t,i){const o=n.createContext(1,e,t);hg("Data must be an object, but it was:",o,i);const c=[],d=gn.empty();Mi(i,((x,g)=>{const b=c2(e,x,t);g=Yt(g);const w=o.childContextForFieldPath(b);if(g instanceof Jf)c.push(b);else{const _=Qu(g,w);_!=null&&(c.push(b),d.set(b,_))}}));const p=new Pn(c);return new a2(d,p,o.fieldTransforms)}function M3(n,e,t,i,o,c){const d=n.createContext(1,e,t),p=[Lo(e,i,t)],x=[o];if(c.length%2!=0)throw new Me(Ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<c.length;_+=2)p.push(Lo(e,c[_])),x.push(c[_+1]);const g=[],b=gn.empty();for(let _=p.length-1;_>=0;--_)if(!u2(g,p[_])){const A=p[_];let L=x[_];L=Yt(L);const V=d.childContextForFieldPath(A);if(L instanceof Jf)g.push(A);else{const F=Qu(L,V);F!=null&&(g.push(A),b.set(A,F))}}const w=new Pn(g);return new a2(b,w,d.fieldTransforms)}function O3(n,e,t,i=!1){return Qu(t,n.createContext(i?4:3,e))}function Qu(n,e){if(o2(n=Yt(n)))return hg("Unsupported field value:",e,n),l2(n,e);if(n instanceof Kf)return(function(i,o){if(!r2(o.dataSource))throw o.createError(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${i._methodName}() is not currently supported inside arrays`);const c=i._toFieldTransform(o);c&&o.fieldTransforms.push(c)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,o){const c=[];let d=0;for(const p of i){let x=Qu(p,o.childContextForArray(d));x==null&&(x={nullValue:"NULL_VALUE"}),c.push(x),d++}return{arrayValue:{values:c}}})(n,e)}return(function(i,o){if((i=Yt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return xR(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const c=It.fromDate(i);return{timestampValue:ff(o.serializer,c)}}if(i instanceof It){const c=new It(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:ff(o.serializer,c)}}if(i instanceof Ka)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Zn)return{bytesValue:Tj(o.serializer,i._byteString)};if(i instanceof cs){const c=o.databaseId,d=i.firestore._databaseId;if(!d.isEqual(c))throw o.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Hx(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof ya)return(function(d,p){const x=d instanceof ya?d.toArray():d;return{mapValue:{fields:{[sj]:{stringValue:nj},[cf]:{arrayValue:{values:x.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return zx(p.serializer,b)}))}}}}}})(i,o);if(Mj(i))return i._toProto(o.serializer);throw o.createError(`Unsupported field value: ${Of(i)}`)})(n,e)}function l2(n,e){const t={};return K_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Mi(n,((i,o)=>{const c=Qu(o,e.childContextForField(i));c!=null&&(t[i]=c)})),{mapValue:{fields:t}}}function o2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof It||n instanceof Ka||n instanceof Zn||n instanceof cs||n instanceof Kf||n instanceof ya||Mj(n))}function hg(n,e,t){if(!o2(t)||!W_(t)){const i=Of(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Lo(n,e,t){if((e=Yt(e))instanceof cg)return e._internalPath;if(typeof e=="string")return c2(n,e);throw bf("Field path arguments must be of type string or ",n,!1,void 0,t)}const P3=new RegExp("[~\\*/\\[\\]]");function c2(n,e,t){if(e.search(P3)>=0)throw bf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new cg(...e.split("."))._internalPath}catch{throw bf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function bf(n,e,t,i,o){const c=i&&!i.isEmpty(),d=o!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let x="";return(c||d)&&(x+=" (found",c&&(x+=` in field ${i}`),d&&(x+=` in document ${o}`),x+=")"),new Me(Ne.INVALID_ARGUMENT,p+n+x)}function u2(n,e){return n.some((t=>t.isEqual(e)))}class V3{convertValue(e,t="none"){switch(Ai(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ps(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ti(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw at(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Mi(e,((o,c)=>{i[o]=this.convertValue(c,t)})),i}convertVectorValue(e){const t=e.fields?.[cf].arrayValue?.values?.map((i=>ps(i.doubleValue)));return new ya(t)}convertGeoPoint(e){return new Ka(ps(e.latitude),ps(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Lf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Eu(e));default:return null}}convertTimestamp(e){const t=Ei(e);return new It(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Qt.fromString(e);Mt(Dj(i),9688,{name:e});const o=new Tu(i.get(1),i.get(3)),c=new Ze(i.popFirst(5));return o.isEqual(t)||kr(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}class fg extends V3{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cs(this.firestore,null,t)}}function Ni(){return new dg("serverTimestamp")}const V1="@firebase/firestore",L1="4.10.0";function U1(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of i)if(c in o&&typeof o[c]=="function")return!0;return!1})(n,["next","error","complete"])}class d2{constructor(e,t,i,o,c){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new cs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new L3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Lo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class L3 extends d2{data(){return super.data()}}function h2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Me(Ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mg{}class U3 extends mg{}function Ln(n,e,...t){let i=[];e instanceof mg&&i.push(e),i=i.concat(t),(function(c){const d=c.filter((x=>x instanceof pg)).length,p=c.filter((x=>x instanceof Zf)).length;if(d>1||d>0&&p>0)throw new Me(Ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const o of i)n=o._apply(n);return n}class Zf extends U3{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Zf(e,t,i)}_apply(e){const t=this._parse(e);return f2(e._query,t),new Cl(e.firestore,e.converter,Y0(e._query,t))}_parse(e){const t=Xf(e.firestore);return(function(c,d,p,x,g,b,w){let _;if(g.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Me(Ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){z1(w,b);const L=[];for(const V of w)L.push(B1(x,c,V));_={arrayValue:{values:L}}}else _=B1(x,c,w)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||z1(w,b),_=O3(p,d,w,b==="in"||b==="not-in");return Ts.create(g,b,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bn(n,e,t){const i=e,o=Lo("where",n);return Zf._create(o,i,t)}class pg extends mg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new pg(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Na.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,c){let d=o;const p=c.getFlattenedFilters();for(const x of p)f2(d,x),d=Y0(d,x)})(e._query,t),new Cl(e.firestore,e.converter,Y0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function B1(n,e,t){if(typeof(t=Yt(t))=="string"){if(t==="")throw new Me(Ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dj(e)&&t.indexOf("/")!==-1)throw new Me(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Qt.fromString(t));if(!Ze.isDocumentKey(i))throw new Me(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return e1(n,new Ze(i))}if(t instanceof cs)return e1(n,t._key);throw new Me(Ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Of(t)}.`)}function z1(n,e){if(!Array.isArray(n)||n.length===0)throw new Me(Ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function f2(n,e){const t=(function(o,c){for(const d of o)for(const p of d.getFlattenedFilters())if(c.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Me(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Me(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function m2(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class uu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fl extends d2{constructor(e,t,i,o,c,d){super(e,t,i,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new qh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Lo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Me(Ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=fl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}fl._jsonSchemaVersion="firestore/documentSnapshot/1.0",fl._jsonSchema={type:As("string",fl._jsonSchemaVersion),bundleSource:As("string","DocumentSnapshot"),bundleName:As("string"),bundle:As("string")};class qh extends fl{data(e={}){return super.data(e)}}class ml{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new uu(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new qh(this._firestore,this._userDataWriter,i.key,i,new uu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Me(Ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((p=>{const x=new qh(o._firestore,o._userDataWriter,p.doc.key,p.doc,new uu(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);return p.doc,{type:"added",doc:x,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((p=>c||p.type!==3)).map((p=>{const x=new qh(o._firestore,o._userDataWriter,p.doc.key,p.doc,new uu(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,b=-1;return p.type!==0&&(g=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),b=d.indexOf(p.doc.key)),{type:B3(p.type),doc:x,oldIndex:g,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Me(Ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ml._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ox.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),i.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function B3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return at(61501,{type:n})}}ml._jsonSchemaVersion="firestore/querySnapshot/1.0",ml._jsonSchema={type:As("string",ml._jsonSchemaVersion),bundleSource:As("string","QuerySnapshot"),bundleName:As("string"),bundle:As("string")};function y0(n){n=wn(n,cs);const e=wn(n.firestore,Rr),t=Qf(e);return N3(t,n._key).then((i=>p2(e,n,i)))}function Cs(n){n=wn(n,Cl);const e=wn(n.firestore,Rr),t=Qf(e),i=new fg(e);return h2(n._query),_3(t,n._query).then((o=>new ml(e,i,n,o)))}function v0(n,e,t){n=wn(n,cs);const i=wn(n.firestore,Rr),o=m2(n.converter,e),c=Xf(i);return em(i,[i2(c,"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,na.none())])}function tt(n,e,t,...i){n=wn(n,cs);const o=wn(n.firestore,Rr),c=Xf(o);let d;return d=typeof(e=Yt(e))=="string"||e instanceof cg?M3(c,"updateDoc",n._key,e,t,i):D3(c,"updateDoc",n._key,e),em(o,[d.toMutation(n._key,na.exists(!0))])}function ko(n){return em(wn(n.firestore,Rr),[new Fx(n._key,na.none())])}function _a(n,e){const t=wn(n.firestore,Rr),i=Ge(n),o=m2(n.converter,e),c=Xf(n.firestore);return em(t,[i2(c,"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,na.exists(!1))]).then((()=>i))}function Gt(n,...e){n=Yt(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||U1(e[i])||(t=e[i++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(U1(e[i])){const g=e[i];e[i]=g.next?.bind(g),e[i+1]=g.error?.bind(g),e[i+2]=g.complete?.bind(g)}let c,d,p;if(n instanceof cs)d=wn(n.firestore,Rr),p=Uf(n._key.path),c={next:g=>{e[i]&&e[i](p2(d,n,g))},error:e[i+1],complete:e[i+2]};else{const g=wn(n,Cl);d=wn(g.firestore,Rr),p=g._query;const b=new fg(d);c={next:w=>{e[i]&&e[i](new ml(d,b,g,w))},error:e[i+1],complete:e[i+2]},h2(n._query)}const x=Qf(d);return w3(x,p,o,c)}function em(n,e){const t=Qf(n);return j3(t,e)}function p2(n,e,t){const i=t.docs.get(e._key),o=new fg(n);return new fl(n,o,e._key,i,new uu(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){_4(El),ji(new Er("firestore",((i,{instanceIdentifier:o,options:c})=>{const d=i.getProvider("app").getImmediate(),p=new Rr(new E4(i.getProvider("auth-internal")),new k4(d,i.getProvider("app-check-internal")),G4(d,o),d);return c={useFetchStreams:t,...c},p._setSettings(c),p}),"PUBLIC").setMultipleInstances(!0)),sa(V1,L1,e),sa(V1,L1,"esm2020")})();const x2="firebasestorage.googleapis.com",g2="storageBucket",z3=120*1e3,F3=600*1e3;class ds extends Sa{constructor(e,t,i=0){super(w0(e),`Firebase Storage: ${t} (${w0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return w0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var us;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(us||(us={}));function w0(n){return"storage/"+n}function xg(){const n="An unknown error occurred, please check the error payload for server response.";return new ds(us.UNKNOWN,n)}function $3(n){return new ds(us.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function q3(n){return new ds(us.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function H3(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ds(us.UNAUTHENTICATED,n)}function G3(){return new ds(us.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Y3(n){return new ds(us.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function W3(){return new ds(us.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Q3(){return new ds(us.CANCELED,"User canceled the upload/download.")}function K3(n){return new ds(us.INVALID_URL,"Invalid URL '"+n+"'.")}function X3(n){return new ds(us.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function J3(){return new ds(us.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+g2+"' property when initializing the app?")}function Z3(){return new ds(us.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function eI(){return new ds(us.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function tI(n){return new ds(us.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ax(n){return new ds(us.INVALID_ARGUMENT,n)}function b2(){return new ds(us.APP_DELETED,"The Firebase app was deleted.")}function sI(n){return new ds(us.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function bu(n,e){return new ds(us.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Zc(n){throw new ds(us.INTERNAL_ERROR,"Internal error: "+n)}class Vn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Vn.makeFromUrl(e,t)}catch{return new Vn(e,"")}if(i.path==="")return i;throw X3(e)}static makeFromUrl(e,t){let i=null;const o="([A-Za-z0-9.\\-_]+)";function c(ie){ie.path.charAt(ie.path.length-1)==="/"&&(ie.path_=ie.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+o+d,"i"),x={bucket:1,path:3};function g(ie){ie.path_=decodeURIComponent(ie.path)}const b="v[A-Za-z0-9_]+",w=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",A=new RegExp(`^https?://${w}/${b}/b/${o}/o${_}`,"i"),L={bucket:1,path:3},V=t===x2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,F="([^?#]*)",q=new RegExp(`^https?://${V}/${o}/${F}`,"i"),H=[{regex:p,indices:x,postModify:c},{regex:A,indices:L,postModify:g},{regex:q,indices:{bucket:1,path:2},postModify:g}];for(let ie=0;ie<H.length;ie++){const le=H[ie],Y=le.regex.exec(e);if(Y){const T=Y[le.indices.bucket];let E=Y[le.indices.path];E||(E=""),i=new Vn(T,E),le.postModify(i);break}}if(i==null)throw K3(e);return i}}class nI{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function aI(n,e,t){let i=1,o=null,c=null,d=!1,p=0;function x(){return p===2}let g=!1;function b(...F){g||(g=!0,e.apply(null,F))}function w(F){o=setTimeout(()=>{o=null,n(A,x())},F)}function _(){c&&clearTimeout(c)}function A(F,...q){if(g){_();return}if(F){_(),b.call(null,F,...q);return}if(x()||d){_(),b.call(null,F,...q);return}i<64&&(i*=2);let H;p===1?(p=2,H=0):H=(i+Math.random())*1e3,w(H)}let L=!1;function V(F){L||(L=!0,_(),!g&&(o!==null?(F||(p=2),clearTimeout(o),w(0)):F||(p=1)))}return w(0),c=setTimeout(()=>{d=!0,V(!0)},t),V}function rI(n){n(!1)}function iI(n){return n!==void 0}function lI(n){return typeof n=="object"&&!Array.isArray(n)}function gg(n){return typeof n=="string"||n instanceof String}function F1(n){return bg()&&n instanceof Blob}function bg(){return typeof Blob<"u"}function $1(n,e,t,i){if(i<e)throw ax(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw ax(`Invalid value for '${n}'. Expected ${t} or less.`)}function tm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function y2(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const o=e(i)+"="+e(n[i]);t=t+o+"&"}return t=t.slice(0,-1),t}var pl;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(pl||(pl={}));function oI(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}class cI{constructor(e,t,i,o,c,d,p,x,g,b,w,_=!0,A=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=x,this.timeout_=g,this.progressCallback_=b,this.connectionFactory_=w,this.retry=_,this.isUsingEmulator=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((L,V)=>{this.resolve_=L,this.reject_=V,this.start_()})}start_(){const e=(i,o)=>{if(o){i(!1,new Sh(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=p=>{const x=p.loaded,g=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(x,g)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const p=c.getErrorCode()===pl.NO_ERROR,x=c.getStatus();if(!p||oI(x,this.additionalRetryCodes_)&&this.retry){const b=c.getErrorCode()===pl.ABORT;i(!1,new Sh(!1,null,b));return}const g=this.successCodes_.indexOf(x)!==-1;i(!0,new Sh(g,c))})},t=(i,o)=>{const c=this.resolve_,d=this.reject_,p=o.connection;if(o.wasSuccessCode)try{const x=this.callback_(p,p.getResponse());iI(x)?c(x):c()}catch(x){d(x)}else if(p!==null){const x=xg();x.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,x)):d(x)}else if(o.canceled){const x=this.appDelete_?b2():Q3();d(x)}else{const x=W3();d(x)}};this.canceled_?t(!1,new Sh(!1,null,!0)):this.backoffId_=aI(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&rI(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Sh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function uI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function dI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function hI(n,e){e&&(n["X-Firebase-GMPID"]=e)}function fI(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function mI(n,e,t,i,o,c,d=!0,p=!1){const x=y2(n.urlParams),g=n.url+x,b=Object.assign({},n.headers);return hI(b,e),uI(b,t),dI(b,c),fI(b,i),new cI(g,n.method,b,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,p)}function pI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function xI(...n){const e=pI();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(bg())return new Blob(n);throw new ds(us.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function gI(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function bI(n){if(typeof atob>"u")throw tI("base-64");return atob(n)}const qa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class N0{constructor(e,t){this.data=e,this.contentType=t||null}}function yI(n,e){switch(n){case qa.RAW:return new N0(v2(e));case qa.BASE64:case qa.BASE64URL:return new N0(w2(n,e));case qa.DATA_URL:return new N0(wI(e),NI(e))}throw xg()}function v2(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const c=i,d=n.charCodeAt(++t);i=65536|(c&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function vI(n){let e;try{e=decodeURIComponent(n)}catch{throw bu(qa.DATA_URL,"Malformed data URL.")}return v2(e)}function w2(n,e){switch(n){case qa.BASE64:{const o=e.indexOf("-")!==-1,c=e.indexOf("_")!==-1;if(o||c)throw bu(n,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case qa.BASE64URL:{const o=e.indexOf("+")!==-1,c=e.indexOf("/")!==-1;if(o||c)throw bu(n,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=bI(e)}catch(o){throw o.message.includes("polyfill")?o:bu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}class N2{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw bu(qa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=_I(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function wI(n){const e=new N2(n);return e.base64?w2(qa.BASE64,e.rest):vI(e.rest)}function NI(n){return new N2(n).contentType}function _I(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class xi{constructor(e,t){let i=0,o="";F1(e)?(this.data_=e,i=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(F1(this.data_)){const i=this.data_,o=gI(i,e,t);return o===null?null:new xi(o)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new xi(i,!0)}}static getBlob(...e){if(bg()){const t=e.map(i=>i instanceof xi?i.data_:i);return new xi(xI.apply(null,t))}else{const t=e.map(d=>gg(d)?yI(qa.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const o=new Uint8Array(i);let c=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)o[c++]=d[p]}),new xi(o,!0)}}uploadData(){return this.data_}}function _2(n){let e;try{e=JSON.parse(n)}catch{return null}return lI(e)?e:null}function jI(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function SI(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function j2(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function EI(n,e){return e}class tn{constructor(e,t,i,o){this.server=e,this.local=t||e,this.writable=!!i,this.xform=o||EI}}let Eh=null;function TI(n){return!gg(n)||n.length<2?n:j2(n)}function S2(){if(Eh)return Eh;const n=[];n.push(new tn("bucket")),n.push(new tn("generation")),n.push(new tn("metageneration")),n.push(new tn("name","fullPath",!0));function e(c,d){return TI(d)}const t=new tn("name");t.xform=e,n.push(t);function i(c,d){return d!==void 0?Number(d):d}const o=new tn("size");return o.xform=i,n.push(o),n.push(new tn("timeCreated")),n.push(new tn("updated")),n.push(new tn("md5Hash",null,!0)),n.push(new tn("cacheControl",null,!0)),n.push(new tn("contentDisposition",null,!0)),n.push(new tn("contentEncoding",null,!0)),n.push(new tn("contentLanguage",null,!0)),n.push(new tn("contentType",null,!0)),n.push(new tn("metadata","customMetadata",!0)),Eh=n,Eh}function AI(n,e){function t(){const i=n.bucket,o=n.fullPath,c=new Vn(i,o);return e._makeStorageReference(c)}Object.defineProperty(n,"ref",{get:t})}function kI(n,e,t){const i={};i.type="file";const o=t.length;for(let c=0;c<o;c++){const d=t[c];i[d.local]=d.xform(i,e[d.server])}return AI(i,n),i}function E2(n,e,t){const i=_2(e);return i===null?null:kI(n,i,t)}function CI(n,e,t,i){const o=_2(e);if(o===null||!gg(o.downloadTokens))return null;const c=o.downloadTokens;if(c.length===0)return null;const d=encodeURIComponent;return c.split(",").map(g=>{const b=n.bucket,w=n.fullPath,_="/b/"+d(b)+"/o/"+d(w),A=tm(_,t,i),L=y2({alt:"media",token:g});return A+L})[0]}function RI(n,e){const t={},i=e.length;for(let o=0;o<i;o++){const c=e[o];c.writable&&(t[c.server]=n[c.local])}return JSON.stringify(t)}class yg{constructor(e,t,i,o){this.url=e,this.method=t,this.handler=i,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function T2(n){if(!n)throw xg()}function II(n,e){function t(i,o){const c=E2(n,o,e);return T2(c!==null),c}return t}function DI(n,e){function t(i,o){const c=E2(n,o,e);return T2(c!==null),CI(c,o,n.host,n._protocol)}return t}function A2(n){function e(t,i){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=G3():o=H3():t.getStatus()===402?o=q3(n.bucket):t.getStatus()===403?o=Y3(n.path):o=i,o.status=t.getStatus(),o.serverResponse=i.serverResponse,o}return e}function k2(n){const e=A2(n);function t(i,o){let c=e(i,o);return i.getStatus()===404&&(c=$3(n.path)),c.serverResponse=o.serverResponse,c}return t}function MI(n,e,t){const i=e.fullServerUrl(),o=tm(i,n.host,n._protocol),c="GET",d=n.maxOperationRetryTime,p=new yg(o,c,DI(n,t),d);return p.errorHandler=k2(e),p}function OI(n,e){const t=e.fullServerUrl(),i=tm(t,n.host,n._protocol),o="DELETE",c=n.maxOperationRetryTime;function d(x,g){}const p=new yg(i,o,d,c);return p.successCodes=[200,204],p.errorHandler=k2(e),p}function PI(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function VI(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=PI(null,e)),i}function LI(n,e,t,i,o){const c=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let H="";for(let ie=0;ie<2;ie++)H=H+Math.random().toString().slice(2);return H}const x=p();d["Content-Type"]="multipart/related; boundary="+x;const g=VI(e,i,o),b=RI(g,t),w="--"+x+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+x+`\r
Content-Type: `+g.contentType+`\r
\r
`,_=`\r
--`+x+"--",A=xi.getBlob(w,i,_);if(A===null)throw Z3();const L={name:g.fullPath},V=tm(c,n.host,n._protocol),F="POST",q=n.maxUploadRetryTime,Q=new yg(V,F,II(n,t),q);return Q.urlParams=L,Q.headers=d,Q.body=A.uploadData(),Q.errorHandler=A2(e),Q}class UI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=pl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=pl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=pl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,o,c){if(this.sent_)throw Zc("cannot .send() more than once");if(Za(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),c!==void 0)for(const d in c)c.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,c[d].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Zc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Zc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Zc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Zc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class BI extends UI{initXhr(){this.xhr_.responseType="text"}}function vg(){return new BI}class Nl{constructor(e,t){this._service=e,t instanceof Vn?this._location=t:this._location=Vn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Nl(e,t)}get root(){const e=new Vn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return j2(this._location.path)}get storage(){return this._service}get parent(){const e=jI(this._location.path);if(e===null)return null;const t=new Vn(this._location.bucket,e);return new Nl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw sI(e)}}function zI(n,e,t){n._throwIfRoot("uploadBytes");const i=LI(n.storage,n._location,S2(),new xi(e,!0),t);return n.storage.makeRequestWithTokens(i,vg).then(o=>({metadata:o,ref:n}))}function FI(n){n._throwIfRoot("getDownloadURL");const e=MI(n.storage,n._location,S2());return n.storage.makeRequestWithTokens(e,vg).then(t=>{if(t===null)throw eI();return t})}function $I(n){n._throwIfRoot("deleteObject");const e=OI(n.storage,n._location);return n.storage.makeRequestWithTokens(e,vg)}function qI(n,e){const t=SI(n._location.path,e),i=new Vn(n._location.bucket,t);return new Nl(n.storage,i)}function HI(n){return/^[A-Za-z]+:\/\//.test(n)}function GI(n,e){return new Nl(n,e)}function C2(n,e){if(n instanceof wg){const t=n;if(t._bucket==null)throw J3();const i=new Nl(t,t._bucket);return e!=null?C2(i,e):i}else return e!==void 0?qI(n,e):n}function YI(n,e){if(e&&HI(e)){if(n instanceof wg)return GI(n,e);throw ax("To use ref(service, url), the first argument must be a Storage instance.")}else return C2(n,e)}function q1(n,e){const t=e?.[g2];return t==null?null:Vn.makeFromBucketSpec(t,n)}function WI(n,e,t,i={}){n.host=`${e}:${t}`;const o=Za(e);o&&(kf(`https://${n.host}/b`),Cf("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=i;c&&(n._overrideAuthToken=typeof c=="string"?c:JN(c,n.app.options.projectId))}class wg{constructor(e,t,i,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=x2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=z3,this._maxUploadRetryTime=F3,this._requests=new Set,o!=null?this._bucket=Vn.makeFromBucketSpec(o,this._host):this._bucket=q1(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Vn.makeFromBucketSpec(this._url,e):this._bucket=q1(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$1("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$1("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(xn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Nl(this,e)}_makeRequest(e,t,i,o,c=!0){if(this._deleted)return new nI(b2());{const d=mI(e,this._appId,i,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,o).getPromise()}}const H1="@firebase/storage",G1="0.14.0";const R2="storage";function QI(n,e,t){return n=Yt(n),zI(n,e,t)}function KI(n){return n=Yt(n),FI(n)}function XI(n){return n=Yt(n),$I(n)}function Y1(n,e){return n=Yt(n),YI(n,e)}function JI(n=Rf(),e){n=Yt(n);const i=Lu(n,R2).getImmediate({identifier:e}),o=_x("storage");return o&&ZI(i,...o),i}function ZI(n,e,t,i={}){WI(n,e,t,i)}function eD(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new wg(t,i,o,e,El)}function tD(){ji(new Er(R2,eD,"PUBLIC").setMultipleInstances(!0)),sa(H1,G1,""),sa(H1,G1,"esm2020")}tD();const sD={apiKey:"AIzaSyC1qZ9fK-6LFBxVWZsAD4dZq-KVg36A7f8",authDomain:"scheduler-65e51.firebaseapp.com",projectId:"scheduler-65e51",storageBucket:"scheduler-65e51.firebasestorage.app",messagingSenderId:"93993791456",appId:"1:93993791456:web:3a777a2da0dad4b8b74585"},Ng=t_(sD),we=A3(Ng),Ir=y4(Ng),W1=JI(Ng);const I2=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();const nD=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const aD=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase());const Q1=n=>{const e=aD(n);return e.charAt(0).toUpperCase()+e.slice(1)};var rD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const iD=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const lD=j.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:o="",children:c,iconNode:d,...p},x)=>j.createElement("svg",{ref:x,...rD,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:I2("lucide",o),...!c&&!iD(p)&&{"aria-hidden":"true"},...p},[...d.map(([g,b])=>j.createElement(g,b)),...Array.isArray(c)?c:[c]]));const Ie=(n,e)=>{const t=j.forwardRef(({className:i,...o},c)=>j.createElement(lD,{ref:c,iconNode:e,className:I2(`lucide-${nD(Q1(n))}`,`lucide-${n}`,i),...o}));return t.displayName=Q1(n),t};const oD=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],yu=Ie("archive",oD);const cD=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],uD=Ie("arrow-down-right",cD);const dD=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ga=Ie("arrow-left",dD);const hD=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Co=Ie("arrow-right",hD);const fD=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],mD=Ie("arrow-up-down",fD);const pD=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],D2=Ie("arrow-up-right",pD);const xD=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],gD=Ie("ban",xD);const bD=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],_o=Ie("bell",bD);const yD=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],vD=Ie("bot",yD);const wD=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],ND=Ie("building-2",wD);const _D=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],va=Ie("calendar-check",_D);const jD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],K1=Ie("calendar-days",jD);const SD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Et=Ie("calendar",SD);const ED=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],TD=Ie("camera",ED);const AD=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],_g=Ie("chart-column",AD);const kD=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],M2=Ie("chart-pie",kD);const CD=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ks=Ie("check",CD);const RD=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Iu=Ie("chevron-down",RD);const ID=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],jg=Ie("chevron-left",ID);const DD=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ku=Ie("chevron-right",DD);const MD=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],rx=Ie("chevron-up",MD);const OD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Du=Ie("circle-alert",OD);const PD=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Rs=Ie("circle-check-big",PD);const VD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],$a=Ie("circle-x",VD);const LD=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Zt=Ie("clock",LD);const UD=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],BD=Ie("code",UD);const zD=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],yf=Ie("coffee",zD);const FD=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],O2=Ie("copy",FD);const $D=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],yn=Ie("credit-card",$D);const qD=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Uo=Ie("crown",qD);const HD=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ro=Ie("dollar-sign",HD);const GD=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],xl=Ie("external-link",GD);const YD=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],vu=Ie("eye",YD);const WD=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],QD=Ie("ghost",WD);const KD=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],XD=Ie("gift",KD);const JD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],ZD=Ie("globe",JD);const eM=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],tM=Ie("headphones",eM);const sM=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Sg=Ie("heart",sM);const nM=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Eg=Ie("image",nM);const aM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],X1=Ie("info",aM);const rM=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],ix=Ie("list-ordered",rM);const iM=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]],vf=Ie("list-plus",iM);const lM=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ea=Ie("loader-circle",lM);const oM=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],wf=Ie("lock",oM);const cM=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],lx=Ie("log-out",cM);const uM=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Nf=Ie("mail",uM);const dM=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],hM=Ie("map-pin",dM);const fM=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],mM=Ie("menu",fM);const pM=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],_f=Ie("message-circle",pM);const xM=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],ox=Ie("message-square",xM);const gM=[["path",{d:"M5 12h14",key:"1ays0h"}]],bM=Ie("minus",gM);const yM=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],vM=Ie("palette",yM);const wM=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],P2=Ie("party-popper",wM);const NM=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Tg=Ie("pen-line",NM);const _M=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],cx=Ie("phone",_M);const jM=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],_0=Ie("play",jM);const SM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ja=Ie("plus",SM);const EM=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],sm=Ie("refresh-cw",EM);const TM=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],_i=Ie("repeat",TM);const AM=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],V2=Ie("save",AM);const kM=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Hh=Ie("search",kM);const CM=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Gh=Ie("send",CM);const RM=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Yh=Ie("settings",RM);const IM=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],L2=Ie("shield",IM);const DM=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],U2=Ie("sparkles",DM);const MM=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],J1=Ie("star",MM);const OM=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],Z1=Ie("sticky-note",OM);const PM=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],br=Ie("store",PM);const VM=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Nn=Ie("tag",VM);const LM=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],B2=Ie("thermometer",LM);const UM=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],z2=Ie("timer",UM);const BM=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ba=Ie("trash-2",BM);const zM=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Bo=Ie("trending-up",zM);const FM=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ta=Ie("triangle-alert",FM);const $M=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],F2=Ie("user-plus",$M);const qM=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],_l=Ie("user",qM);const HM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Dt=Ie("users",HM);const GM=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],eN=Ie("wallet",GM);const YM=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ds=Ie("x",YM);const WM=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Xo=Ie("zap",WM);function tN({className:n=""}){return a.jsxs(nt,{to:"/",className:`flex items-center gap-2.5 ${n}`,children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(va,{className:"w-[18px] h-[18px] text-white"})}),a.jsxs("span",{className:"text-xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function QM(){return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("nav",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-100",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsx(tN,{}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(nt,{to:"/login",className:"px-4 py-2.5 text-sm font-semibold text-slate-600 hover:text-slate-900 transition-colors",children:"Sign In"}),a.jsxs(nt,{to:"/register",className:"hidden sm:inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:["Get Started Free",a.jsx(Co,{className:"w-4 h-4"})]}),a.jsx(nt,{to:"/register",className:"sm:hidden px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all",children:"Start Free"})]})]})}),a.jsxs("section",{className:"relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 -z-10",children:[a.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-blue-50 rounded-full blur-3xl opacity-60 -translate-y-1/2 translate-x-1/3"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-violet-50 rounded-full blur-3xl opacity-50 translate-y-1/3 -translate-x-1/4"})]}),a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 pt-16 sm:pt-24 pb-16 sm:pb-20",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-16 items-center",children:[a.jsxs("div",{className:"animate-fade-in-up",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 px-3.5 py-1.5 bg-blue-50 border border-blue-100 rounded-full text-sm font-medium text-blue-700 mb-6",children:[a.jsx(U2,{className:"w-3.5 h-3.5"}),"Free for beauty professionals"]}),a.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-[3.5rem] font-extrabold text-slate-900 leading-[1.1] mb-6 tracking-tight",children:["Online booking",a.jsx("br",{}),a.jsx("span",{className:"text-blue-600",children:"made effortless"})]}),a.jsx("p",{className:"text-lg sm:text-xl text-slate-600 leading-relaxed mb-8 max-w-lg",children:"Let clients book 24/7. Manage your team, services, and schedule from one beautiful dashboard. No more phone tag."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-10",children:[a.jsxs(nt,{to:"/register",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-base shadow-lg shadow-blue-600/25 hover:shadow-xl hover:shadow-blue-600/30 transition-all hover:-translate-y-0.5",children:["Start for Free",a.jsx(Co,{className:"w-4 h-4"})]}),a.jsx("a",{href:"#how-it-works",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-base border border-slate-200 transition-all",children:"See How It Works"})]}),a.jsxs("div",{className:"flex items-center gap-5 text-sm text-slate-500",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Rs,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"Free to use"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Rs,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"No credit card"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Rs,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:"Setup in 2 min"})]})]})]}),a.jsxs("div",{className:"relative animate-fade-in-up",style:{animationDelay:"150ms"},children:[a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl shadow-slate-200/60 border border-slate-200/80 overflow-hidden",children:[a.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-slate-50 border-b border-slate-100",children:[a.jsxs("div",{className:"flex gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),a.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"})]}),a.jsx("div",{className:"flex-1 mx-4",children:a.jsx("div",{className:"bg-white border border-slate-200 rounded-lg px-3 py-1.5 text-xs text-slate-400 font-mono",children:"bookflow.app/shop/janes-salon"})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-sm font-bold",children:"J"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-slate-900",children:"Jane's Salon"}),a.jsx("div",{className:"text-xs text-slate-500",children:"Book your next appointment"})]})]}),a.jsx("div",{className:"space-y-2.5",children:[{name:"Haircut & Style",price:"$45",time:"45 min",color:"bg-blue-500"},{name:"Color Treatment",price:"$120",time:"2 hours",color:"bg-violet-500"},{name:"Blowout",price:"$35",time:"30 min",color:"bg-emerald-500"}].map(n=>a.jsxs("div",{className:"flex items-center justify-between p-3.5 bg-slate-50 rounded-xl border border-slate-100 group hover:border-blue-200 hover:bg-blue-50/50 transition-all cursor-default",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-2 h-8 ${n.color} rounded-full`}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-800",children:n.name}),a.jsx("div",{className:"text-xs text-slate-500",children:n.time})]})]}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:n.price})]},n.name))})]})]}),a.jsxs("div",{className:"absolute -bottom-4 -left-4 bg-white rounded-xl shadow-lg shadow-slate-200/60 border border-slate-100 px-4 py-3 flex items-center gap-3 animate-float",children:[a.jsx("div",{className:"w-9 h-9 bg-emerald-100 rounded-full flex items-center justify-center",children:a.jsx(Rs,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-slate-500",children:"Booking confirmed"}),a.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Tomorrow at 2:00 PM"})]})]})]})]})})]}),a.jsx("section",{className:"border-y border-slate-100 bg-slate-50/50",children:a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-8 sm:py-10",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-8 sm:gap-16 text-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"500+"}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Businesses trust SpotBookie"})]}),a.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"10,000+"}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Appointments booked"})]}),a.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl sm:text-3xl font-extrabold text-slate-900",children:["4.9 ",a.jsx(J1,{className:"w-5 h-5 text-amber-400 fill-amber-400"})]}),a.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Average rating"})]})]})})}),a.jsx("section",{className:"py-20 sm:py-28",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Everything you need to run your bookings"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Built specifically for beauty professionals, salons, and service businesses. Simple, powerful, and free."})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 stagger-children",children:[{icon:a.jsx(Et,{className:"w-6 h-6"}),title:"Smart Scheduling",desc:"Set weekly hours with breaks. Slots auto-generate so your calendar is always up to date.",color:"bg-blue-100 text-blue-600"},{icon:a.jsx(Dt,{className:"w-6 h-6"}),title:"Multi-Staff Support",desc:"Add your whole team. Each member gets their own schedule, hours, and bookings.",color:"bg-violet-100 text-violet-600"},{icon:a.jsx(Xo,{className:"w-6 h-6"}),title:"Instant Booking",desc:"Clients pick a service, choose a stylist, and book  all in under a minute.",color:"bg-amber-100 text-amber-600"},{icon:a.jsx(ZD,{className:"w-6 h-6"}),title:"Your Own Booking Page",desc:"Get a unique link to share anywhere. No app downloads needed for your clients.",color:"bg-emerald-100 text-emerald-600"}].map(n=>a.jsxs("div",{className:"group bg-white rounded-2xl p-7 border border-slate-200/80 hover:border-slate-300 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[a.jsx("div",{className:`w-12 h-12 ${n.color} rounded-xl flex items-center justify-center mb-5 group-hover:scale-110 transition-transform duration-300`,children:n.icon}),a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:n.title}),a.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:n.desc})]},n.title))})]})}),a.jsx("section",{id:"how-it-works",className:"py-20 sm:py-28 bg-slate-50 border-y border-slate-100",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Up and running in minutes"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Three simple steps to start accepting online bookings today."})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-8 lg:gap-12 relative",children:[a.jsx("div",{className:"hidden md:block absolute top-14 left-[calc(16.67%+1rem)] right-[calc(16.67%+1rem)] h-px bg-gradient-to-r from-blue-200 via-violet-200 to-emerald-200"}),[{step:"1",title:"Create your account",desc:"Sign up free in 30 seconds. Name your shop and you're in.",color:"from-blue-500 to-blue-600",shadow:"shadow-blue-500/30"},{step:"2",title:"Set up your shop",desc:"Add your services, team, and weekly hours. SpotBookie handles the rest.",color:"from-violet-500 to-violet-600",shadow:"shadow-violet-500/30"},{step:"3",title:"Share your link",desc:"Send your booking page to clients. They book, you get notified.",color:"from-emerald-500 to-emerald-600",shadow:"shadow-emerald-500/30"}].map(n=>a.jsxs("div",{className:"relative text-center",children:[a.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${n.color} rounded-2xl flex items-center justify-center mx-auto mb-6 text-white text-xl font-extrabold shadow-lg ${n.shadow} relative z-10`,children:n.step}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:n.title}),a.jsx("p",{className:"text-slate-600 leading-relaxed max-w-xs mx-auto",children:n.desc})]},n.step))]})]})}),a.jsx("section",{className:"py-20 sm:py-28",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[a.jsxs("div",{className:"text-center mb-14",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Loved by professionals"}),a.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"See why salons and stylists are switching to SpotBookie."})]}),a.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{quote:"SpotBookie replaced our paper appointment book. Clients love being able to book online anytime.",name:"Maria Santos",role:"Salon Owner",initials:"MS",color:"bg-blue-100 text-blue-700"},{quote:"Setting up was incredibly easy. I had my booking page live and shared with clients in under 10 minutes.",name:"David Chen",role:"Barber",initials:"DC",color:"bg-violet-100 text-violet-700"},{quote:"The multi-staff feature is perfect. Each stylist manages their own schedule and clients can pick who they want.",name:"Lisa Park",role:"Studio Manager",initials:"LP",color:"bg-emerald-100 text-emerald-700"}].map(n=>a.jsxs("div",{className:"bg-white rounded-2xl p-7 border border-slate-200/80 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[a.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(5)].map((e,t)=>a.jsx(J1,{className:"w-4 h-4 text-amber-400 fill-amber-400"},t))}),a.jsxs("p",{className:"text-slate-700 leading-relaxed mb-6",children:['"',n.quote,'"']}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 ${n.color} rounded-full flex items-center justify-center text-sm font-bold`,children:n.initials}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:n.name}),a.jsx("div",{className:"text-xs text-slate-500",children:n.role})]})]})]},n.name))})]})}),a.jsxs("section",{className:"py-20 sm:py-28 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 -z-0",children:[a.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-violet-500/10 rounded-full blur-3xl"})]}),a.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto px-5 sm:px-8 text-center",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-extrabold text-white mb-6 leading-tight",children:"Ready to streamline your bookings?"}),a.jsx("p",{className:"text-lg text-slate-400 mb-10 max-w-xl mx-auto",children:"Join hundreds of professionals who have ditched the old appointment book. Set up in minutes, free forever."}),a.jsxs(nt,{to:"/register",className:"inline-flex items-center gap-2 px-8 py-4 bg-white hover:bg-slate-50 text-slate-900 rounded-xl font-bold text-lg transition-all hover:shadow-xl hover:shadow-white/10 hover:-translate-y-0.5",children:["Create Your Free Account",a.jsx(Co,{className:"w-5 h-5"})]})]})]}),a.jsx("footer",{className:"bg-white border-t border-slate-100",children:a.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-10",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[a.jsx(tN,{}),a.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500",children:[a.jsx(nt,{to:"/register",className:"hover:text-slate-900 transition-colors",children:"Sign Up"}),a.jsx("span",{className:"text-slate-200",children:""}),a.jsx(nt,{to:"/login",className:"hover:text-slate-900 transition-colors",children:"Sign In"}),a.jsx("span",{className:"text-slate-200",children:""}),a.jsx("a",{href:"#how-it-works",className:"hover:text-slate-900 transition-colors",children:"How It Works"})]}),a.jsxs("p",{className:"text-xs text-slate-400",children:[" ",new Date().getFullYear()," SpotBookie. All rights reserved."]})]})})})]})}function KM(n){return n.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function XM(){const n=Sl(),[e,t]=j.useState(""),[i,o]=j.useState(""),[c,d]=j.useState(""),[p,x]=j.useState(""),[g,b]=j.useState(!1),w=KM(e),_=async A=>{if(A.preventDefault(),x(""),!w){x("Please enter a valid shop name");return}if(c.length<6){x("Password must be at least 6 characters");return}b(!0);try{const L=Ln(Je(we,"shops"),bn("slug","==",w));if(!(await Cs(L)).empty){x("A shop with that name already exists. Please choose a different name."),b(!1);return}const q=(await rC(Ir,i,c)).user;await _a(Je(we,"shops"),{name:e.trim(),slug:w,ownerUid:q.uid,ownerEmail:i,createdAt:Ni()}),n(`/shop/${w}/dashboard`)}catch(L){switch(L.code){case"auth/email-already-in-use":x("An account with this email already exists");break;case"auth/invalid-email":x("Please enter a valid email address");break;case"auth/weak-password":x("Password must be at least 6 characters");break;default:x("Registration failed. Please try again.")}}finally{b(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(va,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Create your shop"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Set up your booking page in seconds  it's free"})]}),a.jsxs("form",{onSubmit:_,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Shop Name"}),a.jsx("input",{type:"text",value:e,onChange:A=>{t(A.target.value),x("")},placeholder:"Jane's Salon",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),w&&a.jsxs("p",{className:"mt-1.5 text-xs text-slate-400",children:["Your page: ",a.jsxs("span",{className:"font-mono text-blue-600 font-medium",children:["bookflow.app/shop/",w]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:i,onChange:A=>{o(A.target.value),x("")},placeholder:"you@example.com",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:c,onChange:A=>{d(A.target.value),x("")},placeholder:"At least 6 characters",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${p?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),p&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",p]})]}),a.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Creating your shop"]}):a.jsxs(a.Fragment,{children:["Create Shop",a.jsx(Co,{className:"w-4 h-4"})]})})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Already have an account?"," ",a.jsx(nt,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Sign in"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(nt,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(ga,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function JM({user:n}){const e=Sl(),[t,i]=j.useState(""),[o,c]=j.useState(""),[d,p]=j.useState(""),[x,g]=j.useState(!1);j.useState(()=>{if(!n)return;(async()=>{const _=Ln(Je(we,"shops"),bn("ownerUid","==",n.uid)),A=await Cs(_);if(!A.empty){const L=A.docs[0].data();e(`/shop/${L.slug}/dashboard`,{replace:!0})}})()},[n,e]);const b=async w=>{w.preventDefault(),p(""),g(!0);try{const A=(await A_(Ir,t,o)).user,L=Ln(Je(we,"shops"),bn("ownerUid","==",A.uid)),V=await Cs(L);if(V.empty){p("No shop found for this account. Need to create one?"),await Ir.signOut(),g(!1);return}const F=V.docs[0].data();e(`/shop/${F.slug}/dashboard`,{replace:!0})}catch(_){switch(_.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":p("Invalid email or password");break;case"auth/invalid-email":p("Please enter a valid email address");break;case"auth/too-many-requests":p("Too many failed attempts. Please try again later.");break;default:p("Login failed. Please try again.")}c("")}finally{g(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(va,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:t,onChange:w=>{i(w.target.value),p("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:o,onChange:w=>{c(w.target.value),p("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${d?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),d&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",d]})]}),a.jsx("button",{type:"submit",disabled:x,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:x?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):a.jsxs(a.Fragment,{children:["Sign In",a.jsx(Co,{className:"w-4 h-4"})]})})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",a.jsx(nt,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(nt,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(ga,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function $2({availableDates:n,selectedDate:e,onSelectDate:t}){const[i,o]=j.useState(new Date),c=q=>{const Q=q.getFullYear(),H=q.getMonth(),ie=new Date(Q,H,1),Y=new Date(Q,H+1,0).getDate(),T=ie.getDay();return{daysInMonth:Y,startingDayOfWeek:T,year:Q,month:H}},{daysInMonth:d,startingDayOfWeek:p,year:x,month:g}=c(i),b=()=>{o(new Date(i.getFullYear(),i.getMonth()-1))},w=()=>{o(new Date(i.getFullYear(),i.getMonth()+1))},_=q=>{const Q=`${x}-${String(g+1).padStart(2,"0")}-${String(q).padStart(2,"0")}`;return n.includes(Q)},A=q=>`${x}-${String(g+1).padStart(2,"0")}-${String(q).padStart(2,"0")}`===e,L=q=>{if(_(q)){const Q=`${x}-${String(g+1).padStart(2,"0")}-${String(q).padStart(2,"0")}`;t(Q)}},V=["January","February","March","April","May","June","July","August","September","October","November","December"],F=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return a.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-5 sm:p-6 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-5",children:[a.jsx("button",{onClick:b,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(jg,{className:"w-5 h-5 text-slate-600"})}),a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[V[g]," ",x]}),a.jsx("button",{onClick:w,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Ku,{className:"w-5 h-5 text-slate-600"})})]}),a.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:F.map(q=>a.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:q},q))}),a.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:p}).map((q,Q)=>a.jsx("div",{},`empty-${Q}`)),Array.from({length:d}).map((q,Q)=>{const H=Q+1,ie=_(H),le=A(H),Y=new Date,T=Y.getDate()===H&&Y.getMonth()===g&&Y.getFullYear()===x;return a.jsxs("button",{onClick:()=>L(H),disabled:!ie,className:`
                relative p-2.5 sm:p-3 text-center rounded-lg text-sm font-semibold transition-all duration-200
                ${le?"bg-blue-600 text-white shadow-md shadow-blue-600/30":ie?"bg-emerald-50 text-emerald-700 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-300 cursor-pointer":T?"text-slate-900 font-bold":"text-slate-300 cursor-not-allowed"}
              `,children:[H,T&&!le&&a.jsx("span",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]},H)})]}),a.jsxs("div",{className:"mt-4 flex gap-5 text-xs text-slate-500",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 bg-emerald-50 border border-emerald-200 rounded"}),a.jsx("span",{children:"Available"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded"}),a.jsx("span",{children:"Selected"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-1 h-1 bg-blue-500 rounded-full"}),a.jsx("span",{children:"Today"})]})]})]})}const ZM=[{key:"monday",label:"Mon"},{key:"tuesday",label:"Tue"},{key:"wednesday",label:"Wed"},{key:"thursday",label:"Thu"},{key:"friday",label:"Fri"},{key:"saturday",label:"Sat"},{key:"sunday",label:"Sun"}],sN=[{key:"morning",label:"Morning (9AM12PM)",start:"09:00",end:"12:00"},{key:"afternoon",label:"Afternoon (12PM5PM)",start:"12:00",end:"17:00"},{key:"evening",label:"Evening (5PM9PM)",start:"17:00",end:"21:00"},{key:"any",label:"Any time",start:"00:00",end:"23:59"}];function eO(){const n="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="WL";for(let t=0;t<4;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}function nN({shopId:n,slug:e,selectedService:t,selectedStaff:i,staffMembers:o,preferredDate:c,onSuccess:d,onCancel:p}){const[x,g]=j.useState({name:"",email:"",phone:""}),[b,w]=j.useState([]),[_,A]=j.useState("any"),[L,V]=j.useState(!1),[F,q]=j.useState(!1),[Q,H]=j.useState(""),ie=Y=>{w(T=>T.includes(Y)?T.filter(E=>E!==Y):[...T,Y])},le=async Y=>{Y.preventDefault(),V(!0);try{const T=eO(),E=sN.find(M=>M.key===_),S=i&&i!=="any"?i.id:"any",I=i&&i!=="any"?i.name:"Any Available",C={clientName:x.name,clientEmail:x.email,clientPhone:x.phone,serviceId:t?.id||null,serviceName:t?.name||"Any Service",staffId:S,staffName:I,preferredDate:c||null,preferredDays:b.length>0?b:null,preferredTimeRange:E?{start:E.start,end:E.end}:null,status:"waiting",refCode:T,createdAt:new Date().toISOString(),notifiedAt:null,notifiedSlot:null};await _a(Je(we,"shops",n,"waitlist"),C),H(T),q(!0),d&&d(T)}catch(T){console.error("Waitlist error:",T)}finally{V(!1)}};return F?a.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg shadow-blue-100/50 p-8 text-center animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Rs,{className:"w-8 h-8 text-blue-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"You're on the Waitlist!"}),a.jsxs("p",{className:"text-slate-600 mb-4",children:["We'll notify you when a slot opens up",t?` for ${t.name}`:"","."]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your waitlist reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:Q})]}),a.jsxs("a",{href:`#/shop/${e}/waitlist/${Q}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(Zt,{className:"w-4 h-4"}),"Check Waitlist Status"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to check your position and get notified"})]}):a.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg p-6 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(vf,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Join the Waitlist"}),a.jsx("p",{className:"text-sm text-slate-500",children:"We'll notify you when a slot opens up"})]})]}),a.jsxs("form",{onSubmit:le,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),a.jsx("input",{type:"text",value:x.name,onChange:Y=>g({...x,name:Y.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:x.email,onChange:Y=>g({...x,email:Y.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),a.jsx("input",{type:"tel",value:x.phone,onChange:Y=>g({...x,phone:Y.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["Preferred Days ",a.jsx("span",{className:"text-slate-400 font-normal",children:"(optional)"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ZM.map(Y=>a.jsx("button",{type:"button",onClick:()=>ie(Y.key),className:`px-3.5 py-2 rounded-lg text-sm font-semibold transition-all border ${b.includes(Y.key)?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:Y.label},Y.key))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preferred Time"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:sN.map(Y=>a.jsx("button",{type:"button",onClick:()=>A(Y.key),className:`px-3.5 py-2.5 rounded-lg text-sm font-medium transition-all border text-left ${_===Y.key?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:Y.label},Y.key))})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:L,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:L?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Joining"]}):a.jsxs(a.Fragment,{children:[a.jsx(vf,{className:"w-4 h-4"}),"Join Waitlist"]})}),p&&a.jsx("button",{type:"button",onClick:p,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]})}function tO(){return a.jsxs("div",{className:"flex items-end gap-2 mb-3",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:a.jsx(_f,{className:"w-3.5 h-3.5 text-white"})}),a.jsx("div",{className:"bg-slate-100 rounded-2xl rounded-bl-md px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})}function sO({message:n,onSelectService:e,onQuickReply:t}){const i=n.sender==="bot";return a.jsxs("div",{className:`flex items-end gap-2 mb-3 ${i?"":"flex-row-reverse"}`,children:[i&&a.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:a.jsx(_f,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("div",{className:"max-w-[85%] space-y-2",children:[a.jsx("div",{className:`px-4 py-2.5 text-sm leading-relaxed whitespace-pre-line ${i?"bg-slate-100 text-slate-800 rounded-2xl rounded-bl-md":"bg-blue-600 text-white rounded-2xl rounded-br-md"}`,children:n.text}),n.serviceCards&&n.serviceCards.length>0&&a.jsx("div",{className:"space-y-1.5",children:n.serviceCards.map(o=>a.jsxs("button",{onClick:()=>e(o),className:"w-full flex items-center justify-between gap-2 px-3.5 py-2.5 bg-white border border-slate-200 hover:border-blue-400 rounded-xl text-left transition-all hover:shadow-sm group",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold text-slate-800 group-hover:text-blue-700 truncate",children:o.name}),a.jsxs("p",{className:"text-xs text-slate-500",children:[Wh(o.duration),"  ",ux(o.price)]})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 whitespace-nowrap flex items-center gap-0.5",children:["Book ",a.jsx(Ku,{className:"w-3 h-3"})]})]},o.id))}),n.quickReplies&&n.quickReplies.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5 pt-1",children:n.quickReplies.map((o,c)=>a.jsx("button",{onClick:()=>t(o),className:"px-3 py-1.5 text-xs font-medium text-blue-600 bg-white border border-blue-200 hover:bg-blue-50 hover:border-blue-400 rounded-full transition-all",children:o},c))})]})]})}function ux(n){return n==null?"":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(n)}function Wh(n){if(!n)return"";if(n<60)return`${n} min`;const e=Math.floor(n/60),t=n%60;return t?`${e}h ${t}m`:`${e} hour${e>1?"s":""}`}function nO(n,{services:e,staffMembers:t,shop:i}){const o=n.toLowerCase().trim(),c=i?.name||"our shop";if(/^(hi|hello|hey|howdy|sup|yo|hiya|good\s*(morning|afternoon|evening))/.test(o))return{text:`Hi!  I'm here to help you book an appointment at ${c}. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]};if(/how (do i|to|can i) book|help.*(book|appoint)|booking help/i.test(o))return{text:`Booking is easy! Here's how:

1 Choose a service
2 Pick your stylist
3 Select a date & time
4 Fill in your details

That's it! Would you like to start?`,quickReplies:["View Services","View Staff"]};if(/what (services|do you offer)|menu|prices|how much|service list|your services/i.test(o)||o==="view services")return!e||e.length===0?{text:"We don't have any services listed right now. Please check back later!"}:{text:`Here are our services:

${e.map(p=>` ${p.name}  ${Wh(p.duration)}  ${ux(p.price)}`).join(`
`)}

Would you like to book one of these? Just tap below! `,serviceCards:e};if(e&&e.length>0){const d=e.find(p=>{const x=p.name.toLowerCase();return o.includes(x)||x.includes(o)});if(d&&o.length>2)return{text:`Great choice! Here are the details for **${d.name}**:

 Duration: ${Wh(d.duration)}
 Price: ${ux(d.price)}${d.description?`
 ${d.description}`:""}

Would you like to book this service? Tap "Book" below!`,serviceCards:[d],quickReplies:["View All Services","View Staff"]}}if(/how long|how much time|duration/i.test(o))return!e||e.length===0?{text:"No services are listed right now. Check back soon!"}:{text:`Here's how long each service takes:

${e.map(p=>` ${p.name}: ${Wh(p.duration)}`).join(`
`)}`,quickReplies:["View Services","How to Book"]};if(/who works|stylists?|staff|team|barber|who('s| is) (here|available)|your (team|people)/i.test(o)||o==="view staff")return!t||t.length===0?{text:"We don't have any team members listed right now."}:{text:`Meet our team! 

${t.map(p=>{let x=` ${p.name}`;return p.role&&(x+=`  ${p.role}`),p.bio&&(x+=`
  "${p.bio.slice(0,80)}${p.bio.length>80?"":""}"`),x}).join(`
`)}

You can pick your preferred stylist during booking.`,quickReplies:["View Services","How to Book"]};if(/available|open slot|when can i|next available|free slot|any opening/i.test(o)){const d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],p=new Set;return t&&t.length>0&&t.forEach(g=>{g.weeklyHours&&Object.entries(g.weeklyHours).forEach(([b,w])=>{w&&w.enabled&&p.add(b)})}),{text:`You can check available times by selecting a service and date in the booking flow above. We're generally available on ${p.size>0?[...p].sort((g,b)=>d.indexOf(g)-d.indexOf(b)).join(", "):"most days"}. `,quickReplies:["View Services","How to Book"]}}if(/hours|when are you open|business hours|open hours|what time|operating/i.test(o)){const d=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],p={};if(t&&t.length>0&&t.forEach(x=>{x.weeklyHours&&Object.entries(x.weeklyHours).forEach(([g,b])=>{b&&b.enabled&&b.start&&b.end&&(p[g]?(b.start<p[g].start&&(p[g].start=b.start),b.end>p[g].end&&(p[g].end=b.end)):p[g]={start:b.start,end:b.end})})}),Object.keys(p).length>0){const x=b=>{const[w,_]=b.split(":"),A=parseInt(w),L=A>=12?"PM":"AM";return`${A%12||12}:${_} ${L}`};return{text:`Here are our general hours:

${d.filter(b=>p[b]).map(b=>` ${b}: ${x(p[b].start)}  ${x(p[b].end)}`).join(`
`)}

Hours may vary by stylist. Select a service to see exact availability.`,quickReplies:["View Services","View Staff"]}}return{text:"Our hours vary by stylist. You can see exact availability by selecting a service above.",quickReplies:["View Services","How to Book"]}}return/phone|address|contact|where|location|email|reach/i.test(o)?{text:"For contact information, please reach out to the shop directly. You can also find us through the booking confirmation email after you book! ",quickReplies:["View Services","How to Book"]}:/cancel|reschedule|change my (booking|appointment)|modify/i.test(o)?{text:"You can manage your booking using the reference code you received. Go to your confirmation email and click 'Manage Booking' to reschedule or cancel. ",quickReplies:["How to Book","View Services"]}:/waitlist|no availability|fully booked|no slots|all booked|sold out/i.test(o)?{text:"If there are no available slots, you can join our waitlist and we'll notify you when something opens up! Look for the 'Join Waitlist' button when viewing available times. ",quickReplies:["View Services","How to Book"]}:/^(thanks?|thank you|thx|ty|cheers|appreciate)/i.test(o)?{text:"You're welcome!  Let me know if you need anything else.",quickReplies:["View Services","View Staff","How to Book"]}:{text:"I'm not sure about that. You can browse our services above, or try asking about our services, staff, or availability! ",quickReplies:["View Services","View Staff","How to Book"]}}function aO({services:n,staffMembers:e,shop:t,onSelectService:i}){const[o,c]=j.useState(!1),[d,p]=j.useState([]),[x,g]=j.useState(""),[b,w]=j.useState(!1),[_,A]=j.useState(!1),[L,V]=j.useState(!1),[F,q]=j.useState(!1),Q=j.useRef(null),H=j.useRef(null),ie=t?.name||"our shop";j.useEffect(()=>{Q.current?.scrollIntoView({behavior:"smooth"})},[d,b]),j.useEffect(()=>{o&&setTimeout(()=>H.current?.focus(),100)},[o]);const le=j.useCallback(()=>{V(!1),q(!0),c(!0),d.length===0&&p([{id:"welcome",sender:"bot",text:`Hi!  Welcome to ${ie}. I can help you find the right service and book an appointment. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]}])},[d.length,ie]),Y=j.useCallback(C=>{w(!0);const M=400+Math.random()*600;setTimeout(()=>{const R=nO(C,{services:n,staffMembers:e,shop:t});p(B=>[...B,{id:`bot-${Date.now()}`,sender:"bot",text:R.text,serviceCards:R.serviceCards||null,quickReplies:R.quickReplies||null}]),w(!1)},M)},[n,e,t]),T=j.useCallback(()=>{const C=x.trim();C&&(p(M=>[...M,{id:`user-${Date.now()}`,sender:"user",text:C}]),g(""),Y(C))},[x,Y]),E=j.useCallback(C=>{p(M=>[...M,{id:`user-${Date.now()}`,sender:"user",text:C}]),Y(C)},[Y]),S=j.useCallback(C=>{i&&(i(C),p(M=>[...M,{id:`bot-${Date.now()}`,sender:"bot",text:`Great! I've selected "${C.name}" for you. You can now pick your stylist and time above. `}]),setTimeout(()=>c(!1),1500))},[i]),I=C=>{C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),T())};return a.jsxs(a.Fragment,{children:[L&&!o&&a.jsxs("div",{className:"fixed bottom-24 right-5 z-50 animate-fade-in",children:[a.jsx("button",{onClick:le,className:"bg-white border border-slate-200 shadow-lg rounded-2xl rounded-br-md px-4 py-3 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all max-w-[220px]",children:"Need help booking? "}),a.jsx("button",{onClick:()=>{V(!1),q(!0)},className:"absolute -top-2 -right-2 w-5 h-5 bg-slate-200 hover:bg-slate-300 rounded-full flex items-center justify-center text-slate-500 transition-colors",children:a.jsx(Ds,{className:"w-3 h-3"})})]}),o&&a.jsxs("div",{className:`fixed bottom-20 right-5 z-50 bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden animate-scale-in
                     w-[calc(100vw-2.5rem)] max-w-[380px] h-[min(500px,calc(100vh-7rem))]
                     sm:w-[380px] sm:right-5 sm:bottom-20`,style:{transformOrigin:"bottom right"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(_f,{className:"w-4 h-4"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-bold leading-tight",children:"SpotBookie Assistant"}),a.jsx("p",{className:"text-[11px] text-blue-100",children:"Ask me anything about booking"})]})]}),a.jsx("button",{onClick:()=>c(!1),className:"w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors","aria-label":"Close chat",children:a.jsx(Ds,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-0 bg-slate-50/50",children:[d.map(C=>a.jsx(sO,{message:C,onSelectService:S,onQuickReply:E},C.id)),b&&a.jsx(tO,{}),a.jsx("div",{ref:Q})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 border-t border-slate-200 bg-white flex-shrink-0",children:[a.jsx("input",{ref:H,type:"text",value:x,onChange:C=>g(C.target.value),onKeyDown:I,placeholder:"Type a message",className:"flex-1 px-3.5 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder:text-slate-400"}),a.jsx("button",{onClick:T,disabled:!x.trim(),className:"w-10 h-10 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-200 disabled:cursor-not-allowed text-white disabled:text-slate-400 rounded-xl flex items-center justify-center transition-all flex-shrink-0","aria-label":"Send message",children:a.jsx(Gh,{className:"w-4 h-4"})})]})]}),a.jsx("button",{onClick:()=>{o?c(!1):le()},className:`fixed bottom-5 right-5 z-50 w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 hover:scale-105 hover:shadow-xl ${o?"bg-slate-700 hover:bg-slate-800":"bg-blue-600 hover:bg-blue-700 chat-bubble-pulse"}`,"aria-label":o?"Close chat assistant":"Open chat assistant",children:o?a.jsx(Ds,{className:"w-6 h-6 text-white"}):a.jsx(_f,{className:"w-6 h-6 text-white"})})]})}var j0={exports:{}},S0,aN;function rO(){if(aN)return S0;aN=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return S0=n,S0}var E0,rN;function iO(){if(rN)return E0;rN=1;var n=rO();function e(){}function t(){}return t.resetWarningCache=e,E0=function(){function i(d,p,x,g,b,w){if(w!==n){var _=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw _.name="Invariant Violation",_}}i.isRequired=i;function o(){return i}var c={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:o,element:i,elementType:i,instanceOf:o,node:i,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:t,resetWarningCache:e};return c.PropTypes=c,c},E0}var iN;function lO(){return iN||(iN=1,j0.exports=iO()()),j0.exports}var oO=lO();const qt=mx(oO);function lN(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,i)}return t}function oN(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lN(Object(t),!0).forEach(function(i){q2(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):lN(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Qh(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Qh=function(e){return typeof e}:Qh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qh(n)}function q2(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cO(n,e){if(n==null)return{};var t={},i=Object.keys(n),o,c;for(c=0;c<i.length;c++)o=i[c],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function uO(n,e){if(n==null)return{};var t=cO(n,e),i,o;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(o=0;o<c.length;o++)i=c[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function H2(n,e){return dO(n)||hO(n,e)||fO(n,e)||mO()}function dO(n){if(Array.isArray(n))return n}function hO(n,e){var t=n&&(typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"]);if(t!=null){var i=[],o=!0,c=!1,d,p;try{for(t=t.call(n);!(o=(d=t.next()).done)&&(i.push(d.value),!(e&&i.length===e));o=!0);}catch(x){c=!0,p=x}finally{try{!o&&t.return!=null&&t.return()}finally{if(c)throw p}}return i}}function fO(n,e){if(n){if(typeof n=="string")return cN(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return cN(n,e)}}function cN(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function mO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn=function(e,t,i){var o=!!i,c=Ht.useRef(i);Ht.useEffect(function(){c.current=i},[i]),Ht.useEffect(function(){if(!o||!e)return function(){};var d=function(){c.current&&c.current.apply(c,arguments)};return e.on(t,d),function(){e.off(t,d)}},[o,t,e,c])},dx=function(e){var t=Ht.useRef(e);return Ht.useEffect(function(){t.current=e},[e]),t.current},zo=function(e){return e!==null&&Qh(e)==="object"},pO=function(e){return zo(e)&&typeof e.then=="function"},xO=function(e){return zo(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},uN="[object Object]",gO=function n(e,t){if(!zo(e)||!zo(t))return e===t;var i=Array.isArray(e),o=Array.isArray(t);if(i!==o)return!1;var c=Object.prototype.toString.call(e)===uN,d=Object.prototype.toString.call(t)===uN;if(c!==d)return!1;if(!c&&!i)return e===t;var p=Object.keys(e),x=Object.keys(t);if(p.length!==x.length)return!1;for(var g={},b=0;b<p.length;b+=1)g[p[b]]=!0;for(var w=0;w<x.length;w+=1)g[x[w]]=!0;var _=Object.keys(g);if(_.length!==p.length)return!1;var A=e,L=t,V=function(q){return n(A[q],L[q])};return _.every(V)},G2=function(e,t,i){return zo(e)?Object.keys(e).reduce(function(o,c){var d=!zo(t)||!gO(e[c],t[c]);return i.includes(c)?(d&&console.warn("Unsupported prop change: options.".concat(c," is not a mutable property.")),o):d?oN(oN({},o||{}),{},q2({},c,e[c])):o},null):null},Y2="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",dN=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y2;if(e===null||xO(e))return e;throw new Error(t)},bO=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y2;if(pO(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(o){return dN(o,t)})};var i=dN(e,t);return i===null?{tag:"empty"}:{tag:"sync",stripe:i}},yO=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.6.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.6.0",url:"https://stripe.com/docs/stripe-js/react"}))},nm=Ht.createContext(null);nm.displayName="ElementsContext";var W2=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},Q2=function(e){var t=e.stripe,i=e.options,o=e.children,c=Ht.useMemo(function(){return bO(t)},[t]),d=Ht.useState(function(){return{stripe:c.tag==="sync"?c.stripe:null,elements:c.tag==="sync"?c.stripe.elements(i):null}}),p=H2(d,2),x=p[0],g=p[1];Ht.useEffect(function(){var _=!0,A=function(V){g(function(F){return F.stripe?F:{stripe:V,elements:V.elements(i)}})};return c.tag==="async"&&!x.stripe?c.stripePromise.then(function(L){L&&_&&A(L)}):c.tag==="sync"&&!x.stripe&&A(c.stripe),function(){_=!1}},[c,x,i]);var b=dx(t);Ht.useEffect(function(){b!==null&&b!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[b,t]);var w=dx(i);return Ht.useEffect(function(){if(x.elements){var _=G2(i,w,["clientSecret","fonts"]);_&&x.elements.update(_)}},[i,w,x.elements]),Ht.useEffect(function(){yO(x.stripe)},[x.stripe]),Ht.createElement(nm.Provider,{value:x},o)};Q2.propTypes={stripe:qt.any,options:qt.object};var vO=function(e){var t=Ht.useContext(nm);return W2(t,e)},wO=function(){var e=vO("calls useElements()"),t=e.elements;return t};qt.func.isRequired;var K2=Ht.createContext(null);K2.displayName="CheckoutContext";qt.any,qt.shape({clientSecret:qt.oneOfType([qt.string,qt.instanceOf(Promise)]).isRequired,elementsOptions:qt.object}).isRequired;var hx=function(e){var t=Ht.useContext(K2),i=Ht.useContext(nm);if(t){if(i)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t}else return W2(i,e)},NO=["mode"],_O=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},_n=function(e,t){var i="".concat(_O(e),"Element"),o=function(x){var g=x.id,b=x.className,w=x.options,_=w===void 0?{}:w,A=x.onBlur,L=x.onFocus,V=x.onReady,F=x.onChange,q=x.onEscape,Q=x.onClick,H=x.onLoadError,ie=x.onLoaderStart,le=x.onNetworksChange,Y=x.onConfirm,T=x.onCancel,E=x.onShippingAddressChange,S=x.onShippingRateChange,I=x.onSavedPaymentMethodRemove,C=x.onSavedPaymentMethodUpdate,M=hx("mounts <".concat(i,">")),R="elements"in M?M.elements:null,B="checkoutState"in M?M.checkoutState:null,P=B?.type==="success"||B?.type==="loading"?B.sdk:null,O=Ht.useState(null),K=H2(O,2),oe=K[0],be=K[1],fe=Ht.useRef(null),U=Ht.useRef(null);sn(oe,"blur",A),sn(oe,"focus",L),sn(oe,"escape",q),sn(oe,"click",Q),sn(oe,"loaderror",H),sn(oe,"loaderstart",ie),sn(oe,"networkschange",le),sn(oe,"confirm",Y),sn(oe,"cancel",T),sn(oe,"shippingaddresschange",E),sn(oe,"shippingratechange",S),sn(oe,"savedpaymentmethodremove",I),sn(oe,"savedpaymentmethodupdate",C),sn(oe,"change",F);var Z;V&&(e==="expressCheckout"?Z=V:Z=function(){V(oe)}),sn(oe,"ready",Z),Ht.useLayoutEffect(function(){if(fe.current===null&&U.current!==null&&(R||P)){var me=null;if(P)switch(e){case"paymentForm":me=P.createPaymentFormElement(_);break;case"payment":me=P.createPaymentElement(_);break;case"address":if("mode"in _){var ge=_.mode,De=uO(_,NO);if(ge==="shipping")me=P.createShippingAddressElement(De);else if(ge==="billing")me=P.createBillingAddressElement(De);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":me=P.createExpressCheckoutElement(_);break;case"currencySelector":me=P.createCurrencySelectorElement();break;case"taxId":me=P.createTaxIdElement(_);break;default:throw new Error("Invalid Element type ".concat(i,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else R&&(me=R.create(e,_));fe.current=me,be(me),me&&me.mount(U.current)}},[R,P,_]);var ue=dx(_);return Ht.useEffect(function(){if(fe.current){var me=G2(_,ue,["paymentRequest"]);me&&"update"in fe.current&&fe.current.update(me)}},[_,ue]),Ht.useLayoutEffect(function(){return function(){if(fe.current&&typeof fe.current.destroy=="function")try{fe.current.destroy(),fe.current=null}catch{}}},[]),Ht.createElement("div",{id:g,className:b,ref:U})},c=function(x){hx("mounts <".concat(i,">"));var g=x.id,b=x.className;return Ht.createElement("div",{id:g,className:b})},d=t?c:o;return d.propTypes={id:qt.string,className:qt.string,onChange:qt.func,onBlur:qt.func,onFocus:qt.func,onReady:qt.func,onEscape:qt.func,onClick:qt.func,onLoadError:qt.func,onLoaderStart:qt.func,onNetworksChange:qt.func,onConfirm:qt.func,onCancel:qt.func,onShippingAddressChange:qt.func,onShippingRateChange:qt.func,onSavedPaymentMethodRemove:qt.func,onSavedPaymentMethodUpdate:qt.func,options:qt.object},d.displayName=i,d.__elementType=e,d},jn=typeof window>"u",jO=Ht.createContext(null);jO.displayName="EmbeddedCheckoutProviderContext";var SO=function(){var e=hx("calls useStripe()"),t=e.stripe;return t};_n("auBankAccount",jn);var hN=_n("card",jn);_n("cardNumber",jn);_n("cardExpiry",jn);_n("cardCvc",jn);_n("iban",jn);_n("payment",jn);_n("expressCheckout",jn);_n("paymentRequestButton",jn);_n("linkAuthentication",jn);_n("address",jn);_n("shippingAddress",jn);_n("paymentMethodMessaging",jn);_n("taxId",jn);function Kh(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Kh=function(e){return typeof e}:Kh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kh(n)}var X2="clover",EO=function(e){return e===3?"v3":e},J2="https://js.stripe.com",TO="".concat(J2,"/").concat(X2,"/stripe.js"),AO=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,kO=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var CO=function(e){return AO.test(e)||kO.test(e)},RO=function(){for(var e=document.querySelectorAll('script[src^="'.concat(J2,'"]')),t=0;t<e.length;t++){var i=e[t];if(CO(i.src))return i}return null},fN=function(e){var t="",i=document.createElement("script");i.src="".concat(TO).concat(t);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(i),i},IO=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.7.0",startTime:t})},eu=null,Th=null,Ah=null,DO=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},MO=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},OO=function(e){return eu!==null?eu:(eu=new Promise(function(t,i){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var o=RO();if(!(o&&e)){if(!o)o=fN(e);else if(o&&Ah!==null&&Th!==null){var c;o.removeEventListener("load",Ah),o.removeEventListener("error",Th),(c=o.parentNode)===null||c===void 0||c.removeChild(o),o=fN(e)}}Ah=MO(t,i),Th=DO(i),o.addEventListener("load",Ah),o.addEventListener("error",Th)}catch(d){i(d);return}}),eu.catch(function(t){return eu=null,Promise.reject(t)}))},PO=function(e,t,i){if(e===null)return null;var o=t[0];if(typeof o!="string")throw new Error("Expected publishable key to be of type string, got type ".concat(Kh(o)," instead."));var c=o.match(/^pk_test/),d=EO(e.version),p=X2;c&&d!==p&&console.warn("Stripe.js@".concat(d," was loaded on the page, but @stripe/stripe-js@").concat("8.7.0"," expected Stripe.js@").concat(p,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var x=e.apply(void 0,t);return IO(x,i),x},tu,Z2=!1,eS=function(){return tu||(tu=OO(null).catch(function(e){return tu=null,Promise.reject(e)}),tu)};Promise.resolve().then(function(){return eS()}).catch(function(n){Z2||console.warn(n)});var VO=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];Z2=!0;var o=Date.now();return eS().then(function(c){return PO(c,t,o)})};const LO=VO("pk_test_51NXZytLhwB1Jyzw82kEuknbGp3F4vTdnqmBrVmzsHqKYeldrpbiWInM6U2v2ojnsLW4u251zbpRk2UiXnwBgiQZo00bK99q5kj"),UO="https://us-central1-scheduler-65e51.cloudfunctions.net",BO={style:{base:{fontSize:"16px",color:"#1e293b",fontFamily:"system-ui, -apple-system, sans-serif","::placeholder":{color:"#94a3b8"}},invalid:{color:"#ef4444",iconColor:"#ef4444"}}};function zO({amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:p=!0}){const x=SO(),g=wO(),[b,w]=j.useState(!1),[_,A]=j.useState(null),[L,V]=j.useState(!1),F=async Q=>{if(Q.preventDefault(),!x||!g)return;w(!0),A(null);const H=g.getElement(hN),{error:ie,paymentMethod:le}=await x.createPaymentMethod({type:"card",card:H,billing_details:{name:i.name,email:i.email,phone:i.phone}});if(ie){A(ie.message),w(!1);return}if(p&&c)try{const Y=await fetch(`${UO}/createDepositPaymentIntent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:c,amount:n,serviceName:o,clientName:i.name,clientEmail:i.email,bookingRefCode:d,paymentMethodId:le.id})}),T=await Y.json();if(!Y.ok){T.needsConnect?A("This shop has not connected Stripe yet. Please contact the shop owner."):T.needsOnboarding?A("This shop is still setting up payments. Please try again later."):A(T.error||"Payment failed. Please try again."),w(!1);return}console.log("Payment processed:",T.paymentIntentId),w(!1),e({paymentMethodId:le.id,paymentIntentId:T.paymentIntentId,last4:le.card.last4,brand:le.card.brand,amount:T.amount})}catch(Y){console.error("Payment error:",Y),A("Payment failed. Please try again."),w(!1)}else console.log("Payment method created (no Connect):",le.id),await new Promise(Y=>setTimeout(Y,500)),w(!1),e({paymentMethodId:le.id,last4:le.card.last4,brand:le.card.brand})},q=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q/100);return a.jsxs("form",{onSubmit:F,className:"space-y-5",children:[a.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 rounded-xl p-5 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-emerald-100 text-sm font-medium",children:["Deposit for ",o]}),a.jsx("p",{className:"text-3xl font-bold mt-1",children:q(n)})]}),a.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:a.jsx(yn,{className:"w-6 h-6"})})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Card Details"}),a.jsx("div",{className:"p-4 border-2 border-slate-200 rounded-xl focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-500/20 transition-all bg-white",children:a.jsx(hN,{options:BO,onChange:Q=>{V(Q.complete),Q.error?A(Q.error.message):A(null)}})})]}),_&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:[a.jsx(Du,{className:"w-4 h-4 flex-shrink-0"}),_]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[a.jsx(wf,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:"Your payment is secured with 256-bit encryption"})]}),a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-700",children:[a.jsx(Du,{className:"w-4 h-4 flex-shrink-0"}),a.jsxs("span",{children:[a.jsx("strong",{children:"Test Mode:"})," Use card number ",a.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"4242 4242 4242 4242"})," with any future date and CVC."]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:b||!x||!L,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold shadow-md shadow-emerald-600/20 hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:b?a.jsxs(a.Fragment,{children:[a.jsx(ea,{className:"w-4 h-4 animate-spin"}),"Processing"]}):a.jsxs(a.Fragment,{children:[a.jsx(wf,{className:"w-4 h-4"}),"Pay ",q(n)]})}),a.jsx("button",{type:"button",onClick:t,disabled:b,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 disabled:opacity-50",children:"Back"})]})]})}function FO({amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:p=!0}){return a.jsx(Q2,{stripe:LO,children:a.jsx(zO,{amount:n,onSuccess:e,onCancel:t,clientInfo:i,serviceName:o,shopId:c,bookingRefCode:d,shopHasConnect:p})})}const $O=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function Ha(n){const[e,t]=n.split(":").map(Number);return e*60+t}function mN(n){const e=Math.floor(n/60),t=n%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}function qO(n){const e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${i}`}function HO(n,e,t){if(!t||t.length===0)return!1;for(const i of t){if(!i||!i.start||!i.end)continue;const o=Ha(i.start),c=Ha(i.end);if(n<c&&e>o)return!0}return!1}function GO(n,e){if(!e||e.length===0)return n;const t=[...e].filter(o=>o&&o.start&&o.end).sort((o,c)=>Ha(o.start)-Ha(c.start));let i=n;for(const o of t){const c=Ha(o.start),d=Ha(o.end);if(i<c)break;i<d&&(i=d)}return i}function YO(n,e,t,i,o,c){if(!n)return[];const p=new Date(e+"T12:00:00").getDay(),x=$O[p],g=n[x];if(!g||!g.enabled)return[];const b=Ha(g.start),w=Ha(g.end),_=g.breaks||(g.break?[g.break]:[]),A=t+i,L=[];let V=b;for(;V+t<=w;){const F=V+t;if(HO(V,F,_)){V=GO(V,_);continue}L.push({id:`wh-${o}-${e}-${mN(V)}`,date:e,time:mN(V),duration:t,available:!0,staffId:o,staffName:c,generated:!0}),V+=A}return L}function tS(n,e,t=0,i=4){const o=[],c=new Date;c.setHours(0,0,0,0);const d=new Date(c);d.setDate(d.getDate()+i*7);for(const p of n){if(!p.weeklyHours)continue;const x=new Date(c);for(;x<d;){const g=qO(x),b=YO(p.weeklyHours,g,e,t,p.id,p.name);o.push(...b),x.setDate(x.getDate()+1)}}return o}function sS(n,e,t=0){const i=e.filter(o=>!o.status||o.status==="pending"||o.status==="confirmed");return n.filter(o=>{const c=Ha(o.time),d=c+o.duration;return!i.some(x=>{if(o.staffId&&x.staffId&&x.staffId!==o.staffId||x.date!==o.date)return!1;const g=Ha(x.time),b=x.serviceDuration||x.duration||o.duration,w=g+b;return!(d+t<=g||w+t<=c)})})}function nS(n,e){const t=new Set(e.map(o=>`${o.staffId||""}-${o.date}-${o.time}`)),i=n.filter(o=>{const c=`${o.staffId||""}-${o.date}-${o.time}`;return!t.has(c)});return[...e,...i]}function du({name:n,className:e="w-12 h-12",bgClass:t="bg-blue-100 text-blue-700"}){const i=(n||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return a.jsx("div",{className:`${e} ${t} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function WO(){return a.jsxs(nt,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(va,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function QO({member:n,onClose:e}){const[t,i]=j.useState(null),o=n.portfolio||[];return j.useEffect(()=>{const c=d=>{d.key==="Escape"&&(t!==null?i(null):e())};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t,e]),a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in",children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center text-slate-600 transition-all z-10",children:a.jsx(Ds,{className:"w-4 h-4"})}),a.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(du,{name:n.name,className:"w-14 h-14",bgClass:"bg-violet-100 text-violet-700"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name}),n.role&&a.jsx("p",{className:"text-sm text-violet-600 font-medium",children:n.role})]})]}),n.bio&&a.jsx("p",{className:"mt-3 text-sm text-slate-600 leading-relaxed",children:n.bio})]}),a.jsx("div",{className:"p-6",children:o.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Eg,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:o.map((c,d)=>a.jsxs("button",{onClick:()=>i(d),className:"group relative aspect-square rounded-xl overflow-hidden bg-slate-100 shadow-sm hover:shadow-md transition-all hover:-translate-y-0.5",children:[a.jsx("img",{src:c.url,alt:c.caption||"Portfolio",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),c.caption&&a.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/70 to-transparent p-2.5 pt-6",children:a.jsx("p",{className:"text-xs text-white font-medium truncate",children:c.caption})})]},d))})})]}),t!==null&&o[t]&&a.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/90",children:[a.jsx("button",{onClick:()=>i(null),className:"absolute top-4 right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(Ds,{className:"w-5 h-5"})}),t>0&&a.jsx("button",{onClick:()=>i(t-1),className:"absolute left-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(jg,{className:"w-5 h-5"})}),t<o.length-1&&a.jsx("button",{onClick:()=>i(t+1),className:"absolute right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:a.jsx(Ku,{className:"w-5 h-5"})}),a.jsxs("div",{className:"max-w-4xl max-h-[85vh] flex flex-col items-center",children:[a.jsx("img",{src:o[t].url,alt:o[t].caption||"Portfolio",className:"max-w-full max-h-[75vh] object-contain rounded-lg"}),o[t].caption&&a.jsx("p",{className:"mt-3 text-sm text-white/90 font-medium text-center px-4",children:o[t].caption}),a.jsxs("p",{className:"mt-1 text-xs text-white/50",children:[t+1," / ",o.length]})]})]})]})}function KO(){const{slug:n}=Ho(),[e,t]=j.useState(null),[i,o]=j.useState(null),[c,d]=j.useState(!0),[p,x]=j.useState(!1),[g,b]=j.useState([]),[w,_]=j.useState([]),[A,L]=j.useState(null),[V,F]=j.useState(null),[q,Q]=j.useState([]),[H,ie]=j.useState([]),[le,Y]=j.useState(!1),[T,E]=j.useState(null),[S,I]=j.useState(null),[C,M]=j.useState(""),[R,B]=j.useState(!1),[P,O]=j.useState({name:"",email:"",phone:""}),[K,oe]=j.useState(""),[be,fe]=j.useState(!1),[U,Z]=j.useState(null),[ue,me]=j.useState(!1),[ge,De]=j.useState("biweekly"),[Ye,pt]=j.useState(null),[dt,Wt]=j.useState(!1),[ne,Te]=j.useState(null);j.useEffect(()=>{(async()=>{d(!0),x(!1);try{const je=Ln(Je(we,"shops"),bn("slug","==",n)),ke=await Cs(je);if(ke.empty)x(!0);else{const $e=ke.docs[0];t($e.data()),o($e.id)}}catch(je){console.error("Error looking up shop:",je),x(!0)}finally{d(!1)}})()},[n]),j.useEffect(()=>{if(!i)return;const de=Gt(Je(we,"shops",i,"services"),ot=>{const ze=ot.docs.map(qe=>({id:qe.id,...qe.data()})).filter(qe=>qe.active!==!1).sort((qe,kt)=>(qe.name||"").localeCompare(kt.name||""));b(ze)}),je=Gt(Je(we,"shops",i,"availability"),ot=>{const ze=new Date,qe=ot.docs.map(kt=>({id:kt.id,...kt.data()})).filter(kt=>new Date(`${kt.date}T${kt.time}`)>ze);Q(qe)}),ke=Gt(Je(we,"shops",i,"bookings"),ot=>{const ze=ot.docs.map(qe=>({id:qe.id,...qe.data()}));ie(ze)}),$e=Gt(Je(we,"shops",i,"staff"),ot=>{const ze=ot.docs.map(qe=>({id:qe.id,...qe.data()})).filter(qe=>qe.active!==!1).sort((qe,kt)=>(qe.name||"").localeCompare(kt.name||""));_(ze)});return()=>{de(),je(),ke(),$e()}},[i]),j.useEffect(()=>{w.length===1?F(w[0]):w.length===0&&F(null)},[w]);const W=g.length>0;w.length>0;const ye=w.length>1,Ae=e?.bufferMinutes||0,Ve=j.useMemo(()=>{const de=new Date;let je=q.filter(ze=>ze.available);if(A&&(je=je.filter(ze=>ze.duration>=A.duration)),V&&V!=="any"&&(je=je.filter(ze=>ze.staffId===V.id||!ze.staffId)),!A)return je;const ke=V&&V!=="any"?w.filter(ze=>ze.id===V.id):w,$e=tS(ke,A.duration,Ae,4).filter(ze=>new Date(`${ze.date}T${ze.time}`)>de),ot=nS($e,je);return sS(ot,H,Ae)},[q,A,V,w,H,Ae]),xt=(de,je,ke=3)=>{const $e=[],ot=new Date(de+"T12:00:00"),ze=new Date(ot);ze.setMonth(ze.getMonth()+ke);let qe=new Date(ot);for(je==="weekly"?qe.setDate(qe.getDate()+7):je==="biweekly"?qe.setDate(qe.getDate()+14):je==="fourweekly"?qe.setDate(qe.getDate()+28):je==="monthly"&&qe.setMonth(qe.getMonth()+1);qe<=ze;){const kt=qe.getFullYear(),Kt=String(qe.getMonth()+1).padStart(2,"0"),an=String(qe.getDate()).padStart(2,"0");$e.push(`${kt}-${Kt}-${an}`),je==="weekly"?qe.setDate(qe.getDate()+7):je==="biweekly"?qe.setDate(qe.getDate()+14):je==="fourweekly"?qe.setDate(qe.getDate()+28):je==="monthly"&&qe.setMonth(qe.getMonth()+1)}return $e},it=j.useMemo(()=>{if(!ue||!T)return null;const de=xt(T.date,ge),je=A?A.duration:T.duration||60,ke=V&&V!=="any"?V.id:T.staffId,$e=T.time,ot=H.filter(as=>!as.status||as.status==="pending"||as.status==="confirmed"),ze=as=>{const[Pi,bs]=as.split(":").map(Number);return Pi*60+bs},qe=ze($e),kt=qe+je;let Kt=[],an=[];const rn=new Set;de.forEach(as=>{ot.some(bs=>{if(ke&&bs.staffId&&bs.staffId!==ke||bs.date!==as)return!1;const ln=ze(bs.time),is=bs.serviceDuration||bs.duration||je,ys=ln+is,En=Ae||0;return!(kt+En<=ln||ys+En<=qe)})||rn.has(as)?an.push(as):(Kt.push(as),rn.add(as))});const ra=de.length>0?de[de.length-1]:T.date,ia=new Date(ra+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),la={weekly:"week",biweekly:"2 weeks",fourweekly:"4 weeks",monthly:"month"};return{available:Kt,conflicts:an,total:Kt.length+1,skipped:an.length,endDate:ia,intervalLabel:la[ge]||ge}},[ue,ge,T,A,V,H,Ae]),rt=de=>{L(de),w.length>1&&F(null),I(null),E(null),Y(!1),M("")},Ce=de=>{F(de),I(null),E(null),Y(!1),M("")},Le=()=>{L(null),w.length>1&&F(null),I(null),E(null),Y(!1)},pe=()=>{I(null),E(null),Y(!1),ye?F(null):W&&L(null)},Ke=de=>{E(de),Y(!0),M("")},Fe=()=>{const de="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let je="BK";for(let ke=0;ke<4;ke++)je+=de.charAt(Math.floor(Math.random()*de.length));return je},Oe=de=>{de.preventDefault(),Lt?Wt(!0):Qe()},We=de=>{Te(de),Qe(de)},Qe=async(de=null)=>{B(!0),pt(null);try{const je=Fe(),ke=e?.requireApproval?"pending":"confirmed",$e=ue?`rg-${Date.now()}-${Math.random().toString(36).slice(2,8)}`:null,ot=ue&&it?it.endDate:null,ze={slotId:T.id,date:T.date,time:T.time,duration:A?A.duration:T.duration,clientName:P.name,clientEmail:P.email,clientPhone:P.phone,bookedAt:new Date().toISOString(),status:ke,refCode:je};if(A&&(ze.serviceId=A.id,ze.serviceName=A.name,ze.servicePrice=A.price,ze.serviceDuration=A.duration,ze.depositPercent=A.depositPercent||0),de||ne){const Kt=de||ne;ze.depositPaid=!0,ze.depositAmount=gs/100,ze.paymentMethodId=Kt.paymentMethodId,ze.cardLast4=Kt.last4,ze.cardBrand=Kt.brand}V&&V!=="any"?(ze.staffId=V.id,ze.staffName=V.name):T.staffId&&(ze.staffId=T.staffId,ze.staffName=T.staffName||""),ue&&$e&&(ze.recurring=!0,ze.recurringInterval=ge,ze.recurringGroupId=$e,ze.recurringUntil=ot),await _a(Je(we,"shops",i,"bookings"),ze),T.generated||await tt(Ge(we,"shops",i,"availability",T.id),{available:!1});let qe=1,kt=0;if(ue&&it){const Kt=it.available;kt=it.skipped;for(const an of Kt){const rn=Fe(),ra={...ze,date:an,slotId:`recurring-${$e}-${an}`,refCode:rn,bookedAt:new Date().toISOString()};await _a(Je(we,"shops",i,"bookings"),ra),qe++}pt({created:qe,skipped:kt})}O({name:"",email:"",phone:""}),Y(!1),Wt(!1),Te(null),E(null),L(null),I(null),F(w.length===1?w[0]:null),me(!1),oe(je),e?.requireApproval?M(" Your booking request has been submitted! The shop will review and confirm it shortly."):M(" Booking confirmed! You will receive a confirmation email shortly.")}catch(je){console.error("Booking error:",je),M(" Something went wrong. Please try again.")}finally{B(!1)}},es=de=>new Date(de+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),nn=de=>{const[je,ke]=de.split(":"),$e=parseInt(je),ot=$e>=12?"PM":"AM";return`${$e%12||12}:${ke} ${ot}`},Sn=de=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(de),Js=de=>{if(de<60)return`${de} min`;const je=Math.floor(de/60),ke=de%60;return ke?`${je}h ${ke}m`:`${je} hour${je>1?"s":""}`};if(c)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking page"})]})});if(p)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Et,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(ga,{className:"w-4 h-4"}),"Go Home"]})]})});if(e?.archived)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-amber-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(yu,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Unavailable"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[a.jsx("span",{className:"font-semibold",children:e.name})," is currently not accepting new bookings. Please check back later or contact the shop directly."]}),a.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(ga,{className:"w-4 h-4"}),"Go Home"]})]})});const Hs=[...new Set(Ve.map(de=>de.date))].sort(),xs=S?Ve.filter(de=>de.date===S):Ve,Lt=A&&A.depositPercent>0,gs=Lt?Math.round(A.price*(A.depositPercent/100)*100):0,ae=dt?"payment":le?"form":W&&!A?"services":ye&&!V?"staff":"calendar",Ee=[];W&&Ee.push({key:"services",label:"Service"}),ye&&Ee.push({key:"staff",label:"Stylist"}),Ee.push({key:"calendar",label:"Date & Time"}),Ee.push({key:"form",label:"Details"}),Lt&&Ee.push({key:"payment",label:"Payment"});const Se=Ee.findIndex(de=>de.key===ae),Ue=["border-l-blue-500","border-l-violet-500","border-l-emerald-500","border-l-amber-500","border-l-rose-500","border-l-cyan-500","border-l-indigo-500","border-l-pink-500","border-l-teal-500"];return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Book your appointment"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(nt,{to:`/shop/${n}/login`,className:"flex items-center gap-1.5 px-3.5 py-2 text-xs font-medium text-slate-500 hover:text-slate-700 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[a.jsx(wf,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Owner"})]}),a.jsx(WO,{})]})]})}),a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[Ee.length>1&&a.jsx("div",{className:"flex items-center justify-center gap-0 mb-8 animate-fade-in",children:Ee.map((de,je)=>{const ke=de.key===ae,$e=je<Se;return a.jsxs(j.Fragment,{children:[je>0&&a.jsx("div",{className:`w-8 sm:w-14 h-0.5 transition-colors duration-300 ${je<=Se?"bg-blue-500":"bg-slate-200"}`}),a.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[a.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 ${ke?"bg-blue-600 text-white shadow-md shadow-blue-600/30 scale-110":$e?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:$e?a.jsx(Rs,{className:"w-5 h-5"}):je+1}),a.jsx("span",{className:`text-xs font-medium hidden sm:block transition-colors ${ke?"text-blue-700":$e?"text-blue-600":"text-slate-400"}`,children:de.label})]})]},de.key)})}),C&&a.jsx("div",{className:"mb-8 animate-scale-in",children:C.startsWith("")?a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(P2,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Confirmed!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"You're all set. We'll send a confirmation to your email."}),Ye&&a.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[a.jsx(_i,{className:"w-4 h-4"}),"Recurring Series Created"]}),a.jsxs("p",{className:"text-sm text-slate-700",children:[Ye.created," appointment",Ye.created!==1?"s":""," booked"]}),Ye.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",Ye.skipped," date",Ye.skipped!==1?"s":""," skipped due to conflicts"]})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:K})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsxs(nt,{to:`/shop/${n}/booking/${K}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(va,{className:"w-4 h-4"}),"Manage Your Booking"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-lg text-sm text-emerald-700 font-medium",children:[a.jsx(va,{className:"w-4 h-4"}),"Add to your calendar to remember"]})]}):C.startsWith("")?a.jsxs("div",{className:"bg-white rounded-2xl border border-amber-200 shadow-lg shadow-amber-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Zt,{className:"w-8 h-8 text-amber-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Request Submitted!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking request has been submitted! The shop will review and confirm it shortly."}),Ye&&a.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[a.jsx(_i,{className:"w-4 h-4"}),"Recurring Series Created"]}),a.jsxs("p",{className:"text-sm text-slate-700",children:[Ye.created," appointment",Ye.created!==1?"s":""," submitted"]}),Ye.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",Ye.skipped," date",Ye.skipped!==1?"s":""," skipped due to conflicts"]})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),a.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:K})]}),K&&a.jsxs("div",{className:"mb-4",children:[a.jsxs(nt,{to:`/shop/${n}/booking/${K}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(va,{className:"w-4 h-4"}),"Manage Your Booking"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-700 font-medium",children:[a.jsx(Zt,{className:"w-4 h-4"}),"You'll be notified once it's confirmed"]})]}):a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Something went wrong. Please try again."})]})}),ae==="services"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a Service"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select the service you'd like to book"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 stagger-children",children:g.map((de,je)=>a.jsxs("button",{onClick:()=>rt(de),className:`group text-left bg-white border-l-4 ${Ue[je%Ue.length]} border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5`,children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors pr-2",children:de.name}),a.jsx("span",{className:"text-xl font-extrabold text-blue-600 whitespace-nowrap",children:Sn(de.price)})]}),de.description&&a.jsx("p",{className:"text-sm text-slate-500 mb-3 line-clamp-2 leading-relaxed",children:de.description}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-400",children:[a.jsx(Zt,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:Js(de.duration)})]}),a.jsx("span",{className:"text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]})]},de.id))})]}),ae==="staff"&&a.jsxs("div",{className:"animate-fade-in",children:[W&&A&&a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:Le,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(ga,{className:"w-3.5 h-3.5"}),"Back"]}),a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Nn,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:A.name}),a.jsx("span",{className:"text-blue-600 font-bold",children:Sn(A.price)})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose Your Stylist"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select your preferred professional"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 stagger-children",children:[a.jsxs("button",{onClick:()=>Ce("any"),className:"group text-left bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-3.5 mb-3",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Dt,{className:"w-5 h-5 text-slate-500"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:"Any Available"}),a.jsx("p",{className:"text-xs text-slate-500",children:"First available professional"})]})]}),a.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),w.map(de=>{const je=de.portfolio||[];return a.jsxs("div",{className:"group bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[a.jsxs("button",{onClick:()=>Ce(de),className:"w-full text-left",children:[a.jsxs("div",{className:"flex items-center gap-3.5 mb-2",children:[a.jsx(du,{name:de.name}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:de.name}),de.role&&a.jsx("p",{className:"text-xs text-slate-500",children:de.role})]})]}),de.bio&&a.jsx("p",{className:"text-xs text-slate-500 leading-relaxed mb-2 line-clamp-2",children:de.bio}),je.length>0&&a.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[je.slice(0,3).map((ke,$e)=>a.jsx("img",{src:ke.url,alt:ke.caption||"Work",className:"w-10 h-10 rounded-md object-cover border border-slate-200"},$e)),je.length>3&&a.jsxs("span",{className:"w-10 h-10 rounded-md bg-slate-100 border border-slate-200 flex items-center justify-center text-xs text-slate-500 font-semibold",children:["+",je.length-3]})]}),a.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),je.length>0&&a.jsxs("button",{onClick:ke=>{ke.stopPropagation(),Z(de)},className:"mt-2 w-full flex items-center justify-center gap-1.5 py-1.5 text-xs font-semibold text-violet-600 hover:text-violet-700 hover:bg-violet-50 rounded-lg transition-all",children:[a.jsx(Eg,{className:"w-3.5 h-3.5"}),"View Portfolio (",je.length,")"]})]},de.id)})]})]}),ae==="calendar"&&a.jsxs("div",{className:"animate-fade-in",children:[(W||ye)&&a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:pe,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(ga,{className:"w-3.5 h-3.5"}),"Back"]}),A&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Nn,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:A.name}),a.jsx("span",{className:"text-blue-600 font-bold",children:Sn(A.price)}),a.jsxs("span",{className:"text-slate-400",children:[" ",Js(A.duration)]})]}),V&&V!=="any"&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[a.jsx(du,{name:V.name,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:V.name})]}),V==="any"&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm",children:[a.jsx(Dt,{className:"w-3.5 h-3.5 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-700",children:"Any Available"})]})]}),Hs.length===0?a.jsx("div",{children:be?a.jsx("div",{className:"max-w-lg mx-auto",children:a.jsx(nN,{shopId:i,slug:n,selectedService:A,selectedStaff:V,staffMembers:w,preferredDate:null,onCancel:()=>fe(!1)})}):a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(Et,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),a.jsx("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:A?`No time slots available for ${A.name} (${Js(A.duration)}). Join the waitlist to be notified when a slot opens up!`:"Check back soon for new availability, or join the waitlist!"}),a.jsxs("button",{onClick:()=>fe(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:[a.jsx(vf,{className:"w-4 h-4"}),"Join Waitlist"]})]})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Select a Date"}),a.jsx("p",{className:"text-slate-500 text-sm",children:"Pick a day that works for you"})]}),a.jsx("div",{className:"mb-8",children:a.jsx($2,{availableDates:Hs,selectedDate:S,onSelectDate:I})}),S&&a.jsxs("div",{className:"animate-slide-down",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",es(S)]}),a.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[xs.length," slot",xs.length!==1?"s":""]})]}),xs.length===0?a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:[a.jsx("p",{className:"text-slate-500 mb-4",children:"No times available for this date"}),be?a.jsx("div",{className:"mt-4 text-left",children:a.jsx(nN,{shopId:i,slug:n,selectedService:A,selectedStaff:V,staffMembers:w,preferredDate:S,onCancel:()=>fe(!1)})}):a.jsxs("button",{onClick:()=>fe(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(vf,{className:"w-4 h-4"}),"Join the Waitlist"]})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:xs.sort((de,je)=>de.time.localeCompare(je.time)).map(de=>a.jsxs("button",{onClick:()=>Ke(de),className:"group bg-white border border-slate-200 hover:border-blue-400 rounded-xl p-4 transition-all duration-200 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-slate-900 group-hover:text-blue-700 transition-colors mb-1",children:nn(de.time)}),de.staffName&&V==="any"&&a.jsxs("div",{className:"text-xs text-violet-600 mb-0.5 flex items-center justify-center gap-1",children:[a.jsx(Dt,{className:"w-3 h-3"}),de.staffName]}),a.jsx("div",{className:"text-xs text-slate-400",children:A?Js(A.duration):`${de.duration} min`})]},de.id))})]}),!S&&a.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]}),ae==="form"&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Complete Your Booking"}),a.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Review your details and confirm"}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[A&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Nn,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:A.name})]}),a.jsx("span",{className:"font-bold text-blue-600",children:Sn(A.price)})]}),V&&V!=="any"&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(du,{name:V.name,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-800",children:V.name}),V.role&&a.jsxs("span",{className:"text-slate-400 text-sm ml-1.5",children:[" ",V.role]})]})]}),V==="any"&&T?.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(du,{name:T.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:T.staffName})]}),a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Et,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[es(T.date)," at ",nn(T.time)]})]}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Zt,{className:"w-4 h-4 text-slate-500"})}),a.jsx("span",{children:A?Js(A.duration):`${T.duration} min`})]})]}),a.jsxs("form",{onSubmit:Oe,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),a.jsx("input",{type:"text",value:P.name,onChange:de=>O({...P,name:de.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:P.email,onChange:de=>O({...P,email:de.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),a.jsx("input",{type:"tel",value:P.phone,onChange:de=>O({...P,phone:de.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(_i,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Make this recurring"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Book the same slot on a regular schedule"})]})]}),a.jsx("button",{type:"button",onClick:()=>me(!ue),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${ue?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${ue?"translate-x-6":"translate-x-1"}`})})]}),ue&&a.jsxs("div",{className:"space-y-3 pt-1 animate-fade-in",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Repeat every"}),a.jsxs("select",{value:ge,onChange:de=>De(de.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[a.jsx("option",{value:"weekly",children:"Week"}),a.jsx("option",{value:"biweekly",children:"2 Weeks"}),a.jsx("option",{value:"fourweekly",children:"4 Weeks"}),a.jsx("option",{value:"monthly",children:"Month"})]})]}),it&&a.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:[" Every ",it.intervalLabel," through ",it.endDate]}),a.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[it.total," total appointment",it.total!==1?"s":""]}),it.skipped>0&&a.jsxs("p",{className:"text-xs text-amber-600 mt-1 font-medium",children:[" ",it.skipped," date",it.skipped!==1?"s":""," will be skipped due to existing bookings"]})]})]})]}),Lt&&a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(yn,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm font-semibold text-emerald-800",children:["$",(gs/100).toFixed(2)," deposit required"]}),a.jsxs("p",{className:"text-xs text-emerald-600",children:[A.depositPercent,"% of service price  Remaining $",(A.price-gs/100).toFixed(2)," due at appointment"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"submit",disabled:R,className:`flex-1 flex items-center justify-center gap-2 px-6 py-3.5 ${Lt?"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-600/20 hover:shadow-emerald-600/25":"bg-blue-600 hover:bg-blue-700 shadow-blue-600/20 hover:shadow-blue-600/25"} text-white rounded-xl font-semibold shadow-md hover:shadow-lg transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0`,children:R?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):Lt?a.jsxs(a.Fragment,{children:[a.jsx(yn,{className:"w-4 h-4"}),"Continue to Payment"]}):a.jsxs(a.Fragment,{children:[a.jsx(Rs,{className:"w-4 h-4"}),"Confirm Booking"]})}),a.jsx("button",{type:"button",onClick:()=>{Y(!1),E(null)},className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]}),ae==="payment"&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Secure Payment"}),a.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Complete your deposit to confirm your booking"}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Et,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-800",children:A?.name}),a.jsxs("p",{className:"text-sm text-slate-500",children:[T&&es(T.date)," at ",T&&nn(T.time)]})]})]}),a.jsxs("div",{className:"text-sm text-slate-600 pl-13",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Client:"})," ",P.name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",P.email]})]})]}),!e?.payoutsEnabled&&(!e?.subscriptionTier||e?.subscriptionTier==="free")&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(yn,{className:"w-4 h-4 text-red-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800 text-sm",children:"Booking Unavailable"}),a.jsx("p",{className:"text-xs text-red-700 mt-1",children:"This shop is still setting up their payment system and cannot accept bookings yet. Please check back later or contact the shop directly."})]})]})}),!e?.payoutsEnabled&&e?.subscriptionTier&&e?.subscriptionTier!=="free"&&a.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(yn,{className:"w-4 h-4 text-amber-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-amber-800 text-sm",children:"Payment Setup in Progress"}),a.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"This shop is still setting up their payment system. You can still book, but payment will be collected at the time of your appointment."}),a.jsx("button",{onClick:()=>Qe(),disabled:R,className:"mt-3 flex items-center gap-2 px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg font-semibold text-sm transition-all disabled:opacity-50",children:R?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):a.jsxs(a.Fragment,{children:[a.jsx(Rs,{className:"w-4 h-4"}),"Book Without Deposit"]})})]})]})}),e?.payoutsEnabled&&a.jsx(FO,{amount:gs,serviceName:A?.name||"Service",clientInfo:P,onSuccess:We,onCancel:()=>Wt(!1),shopId:i,bookingRefCode:null,shopHasConnect:e?.payoutsEnabled}),!e?.payoutsEnabled&&a.jsx("button",{onClick:()=>Wt(!1),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200 mt-4",children:" Back"})]})]}),U&&a.jsx(QO,{member:U,onClose:()=>Z(null)}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(nt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})}),a.jsx(aO,{services:g,staffMembers:w,shop:e,onSelectService:rt})]})}function XO({slotsByDate:n,bookingsByDate:e,selectedDate:t,onSelectDate:i,recurringDayFlags:o={},breaksByDate:c={}}){const[d,p]=j.useState(new Date),x=le=>{const Y=le.getFullYear(),T=le.getMonth(),E=new Date(Y,T,1),I=new Date(Y,T+1,0).getDate(),C=E.getDay();return{daysInMonth:I,startingDayOfWeek:C,year:Y,month:T}},{daysInMonth:g,startingDayOfWeek:b,year:w,month:_}=x(d),A=()=>{p(new Date(d.getFullYear(),d.getMonth()-1))},L=()=>{p(new Date(d.getFullYear(),d.getMonth()+1))},V=le=>`${w}-${String(_+1).padStart(2,"0")}-${String(le).padStart(2,"0")}`,F=le=>{const Y=V(le),T=n[Y]||[],E=e[Y]||[],S=c[Y]||[],I=T.filter(R=>R.available).length,C=E.length,M=S.length;return{availableCount:I,bookedCount:C,breakCount:M,hasData:T.length>0||E.length>0||M>0}},q=le=>{const Y=V(le);i(Y===t?null:Y)},Q=["January","February","March","April","May","June","July","August","September","October","November","December"],H=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ie=new Date;return ie.setHours(0,0,0,0),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-5",children:[a.jsx("button",{onClick:A,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(jg,{className:"w-5 h-5 text-slate-600"})}),a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[Q[_]," ",w]}),a.jsx("button",{onClick:L,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Ku,{className:"w-5 h-5 text-slate-600"})})]}),a.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:H.map(le=>a.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:le},le))}),a.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:b}).map((le,Y)=>a.jsx("div",{},`empty-${Y}`)),Array.from({length:g}).map((le,Y)=>{const T=Y+1,E=V(T),{availableCount:S,bookedCount:I,breakCount:C,hasData:M}=F(T),R=E===t,B=new Date,P=B.getDate()===T&&B.getMonth()===_&&B.getFullYear()===w,O=new Date(w,_,T),K=O.getDay(),oe=o[K]&&O>=ie;return a.jsxs("button",{onClick:()=>q(T),className:`
                relative p-2 text-center rounded-lg text-sm font-semibold transition-all duration-200 min-h-[56px] flex flex-col items-center justify-start cursor-pointer
                ${R?"bg-blue-600 text-white shadow-md shadow-blue-600/30":M||oe?"bg-slate-50 hover:bg-slate-100 text-slate-900 border border-slate-200 hover:border-slate-300":P?"text-slate-900 font-bold hover:bg-slate-50":"text-slate-400 hover:bg-slate-50"}
              `,children:[a.jsxs("span",{className:`text-sm ${P&&!R?"relative":""}`,children:[T,P&&!R&&a.jsx("span",{className:"absolute -bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]}),(M||oe)&&a.jsxs("div",{className:"flex gap-0.5 mt-1 flex-wrap justify-center",children:[oe&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${R?"bg-white/20 text-white":"bg-violet-100 text-violet-700"}`,children:"R"}),C>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${R?"bg-white/20 text-white":"bg-amber-100 text-amber-700"}`,children:""}),S>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${R?"bg-white/20 text-white":"bg-emerald-100 text-emerald-700"}`,children:S}),I>0&&a.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${R?"bg-white/20 text-white":"bg-blue-100 text-blue-700"}`,children:I})]})]},T)})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-xs text-slate-500",children:[Object.keys(o).length>0&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-violet-100 border border-violet-200 rounded flex items-center justify-center text-[7px] font-bold text-violet-700",children:"R"}),a.jsx("span",{children:"Recurring"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-amber-100 border border-amber-200 rounded flex items-center justify-center text-[8px]",children:""}),a.jsx("span",{children:"Break"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-emerald-100 border border-emerald-200 rounded"}),a.jsx("span",{children:"Available"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-blue-100 border border-blue-200 rounded"}),a.jsx("span",{children:"Booked"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-blue-600 rounded"}),a.jsx("span",{children:"Selected"})]})]})]})}const JO=[{value:15,label:"15 min"},{value:30,label:"30 min"},{value:45,label:"45 min"},{value:60,label:"1 hour"},{value:90,label:"1.5 hours"},{value:120,label:"2 hours"}],ZO=[{value:0,label:"No deposit required"},{value:10,label:"10%"},{value:20,label:"20%"},{value:25,label:"25%"},{value:50,label:"50%"},{value:100,label:"Full payment upfront"}];function e9({shopId:n}){const[e,t]=j.useState([]),[i,o]=j.useState(!1),[c,d]=j.useState(null),[p,x]=j.useState({name:"",description:"",duration:30,price:"",depositPercent:0}),[g,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;const q=Gt(Je(we,"shops",n,"services"),Q=>{const H=Q.docs.map(ie=>({id:ie.id,...ie.data()})).filter(ie=>ie.active!==!1).sort((ie,le)=>(ie.name||"").localeCompare(le.name||""));t(H)});return()=>q()},[n]);const w=()=>{x({name:"",description:"",duration:30,price:"",depositPercent:0}),o(!1),d(null)},_=async q=>{q.preventDefault(),b(!0);const Q={name:p.name.trim(),description:p.description.trim(),duration:parseInt(p.duration),price:parseFloat(p.price),depositPercent:parseInt(p.depositPercent)||0,active:!0};try{c?await tt(Ge(we,"shops",n,"services",c),Q):await _a(Je(we,"shops",n,"services"),{...Q,createdAt:Ni()}),w()}catch(H){console.error("Error saving service:",H)}finally{b(!1)}},A=q=>{x({name:q.name,description:q.description||"",duration:q.duration,price:q.price.toString(),depositPercent:q.depositPercent||0}),d(q.id),o(!0)},L=async q=>{try{await tt(Ge(we,"shops",n,"services",q),{active:!1})}catch(Q){console.error("Error deleting service:",Q)}},V=q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(q),F=q=>{if(q<60)return`${q} min`;const Q=Math.floor(q/60),H=q%60;return H?`${Q}h ${H}m`:`${Q}h`};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Services"}),a.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Define the services you offer  clients will pick one before booking"})]}),!i&&a.jsxs("button",{onClick:()=>{w(),o(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(Ja,{className:"w-4 h-4"}),"Add Service"]})]}),i&&a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:c?"Edit Service":"New Service"}),a.jsxs("form",{onSubmit:_,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Service Name *"}),a.jsx("input",{type:"text",value:p.name,onChange:q=>x({...p,name:q.target.value}),required:!0,placeholder:"e.g. Haircut",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description (optional)"}),a.jsx("input",{type:"text",value:p.description,onChange:q=>x({...p,description:q.target.value}),placeholder:"e.g. Classic cut and style",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Duration *"}),a.jsx("select",{value:p.duration,onChange:q=>x({...p,duration:q.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:JO.map(q=>a.jsx("option",{value:q.value,children:q.label},q.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Price (USD) *"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-semibold",children:"$"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:p.price,onChange:q=>x({...p,price:q.target.value}),required:!0,placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx(yn,{className:"w-4 h-4 text-emerald-500"}),"Deposit Required"]})}),a.jsx("select",{value:p.depositPercent,onChange:q=>x({...p,depositPercent:q.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:ZO.map(q=>a.jsx("option",{value:q.value,children:q.label},q.value))})]})]}),p.depositPercent>0&&p.price&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-emerald-50 border border-emerald-200 rounded-lg text-sm",children:[a.jsx(yn,{className:"w-4 h-4 text-emerald-600"}),a.jsxs("span",{className:"text-emerald-800",children:["Clients will pay ",a.jsxs("strong",{children:["$",((parseFloat(p.price)||0)*(parseInt(p.depositPercent)/100)).toFixed(2)]})," deposit at booking",parseInt(p.depositPercent)<100&&a.jsxs("span",{children:[" ($",((parseFloat(p.price)||0)*(1-parseInt(p.depositPercent)/100)).toFixed(2)," remaining due at appointment)"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:g,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(Ks,{className:"w-4 h-4"}),g?"Saving":c?"Update Service":"Add Service"]}),a.jsxs("button",{type:"button",onClick:w,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Ds,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"text-5xl mb-3",children:""}),a.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No services yet"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Add your first service so clients can choose what to book"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(q=>a.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:q.name}),q.description&&a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:q.description})]}),a.jsx("span",{className:"text-xl font-bold text-blue-600 whitespace-nowrap ml-3",children:V(q.price)})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500 mb-4 flex-wrap",children:[a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx(Zt,{className:"w-4 h-4"}),F(q.duration)]}),q.depositPercent>0&&a.jsxs("span",{className:"flex items-center gap-1.5 text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full text-xs font-medium",children:[a.jsx(yn,{className:"w-3 h-3"}),q.depositPercent,"% deposit"]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>A(q),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:[a.jsx(Tg,{className:"w-3.5 h-3.5"}),"Edit"]}),a.jsx("button",{onClick:()=>L(q.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:a.jsx(ba,{className:"w-3.5 h-3.5"})})]})]},q.id))})]})}const su=[{key:"monday",label:"Monday",short:"Mon"},{key:"tuesday",label:"Tuesday",short:"Tue"},{key:"wednesday",label:"Wednesday",short:"Wed"},{key:"thursday",label:"Thursday",short:"Thu"},{key:"friday",label:"Friday",short:"Fri"},{key:"saturday",label:"Saturday",short:"Sat"},{key:"sunday",label:"Sunday",short:"Sun"}],pN={enabled:!1,start:"09:00",end:"17:00",breaks:[]};function t9({shopId:n,staffId:e,staffName:t,weeklyHours:i,onClose:o}){const[c,d]=j.useState(()=>{const E={};for(const S of su){const I=i?.[S.key];if(I){const C=I.breaks||(I.break?[I.break]:[]);E[S.key]={enabled:!!I.enabled,start:I.start||"09:00",end:I.end||"17:00",breaks:C}}else E[S.key]={...pN,breaks:[]}}return E}),[p,x]=j.useState(!1),[g,b]=j.useState(null),[w,_]=j.useState([]),[A,L]=j.useState(!1),[V,F]=j.useState(null);j.useEffect(()=>{if(!n)return;const E=Gt(Je(we,"shops",n,"schedulePresets"),S=>{const I=S.docs.map(C=>({id:C.id,...C.data()})).sort((C,M)=>C.isDefault&&!M.isDefault?-1:!C.isDefault&&M.isDefault?1:(C.name||"").localeCompare(M.name||""));_(I)});return()=>E()},[n]);const q=(E,S,I)=>{d(C=>({...C,[E]:{...C[E],[S]:I}})),F(null)},Q=E=>{d(S=>({...S,[E]:{...S[E],breaks:[...S[E].breaks||[],{start:"12:00",end:"13:00"}]}})),F(null)},H=(E,S,I,C)=>{d(M=>{const R=[...M[E].breaks||[]];return R[S]={...R[S],[I]:C},{...M,[E]:{...M[E],breaks:R}}}),F(null)},ie=(E,S)=>{d(I=>({...I,[E]:{...I[E],breaks:I[E].breaks.filter((C,M)=>M!==S)}})),F(null)},le=E=>{const S=c[E];d(I=>{const C={...I};for(const M of su)M.key!==E&&(C[M.key]={enabled:S.enabled,start:S.start,end:S.end,breaks:S.breaks.map(R=>({...R}))});return C}),b(E),F(null),setTimeout(()=>b(null),1500)},Y=E=>{if(!E.days)return;const S={};for(const I of su){const C=E.days[I.key];if(C){const M=C.breaks||(C.break?[C.break]:[]);S[I.key]={enabled:!!C.enabled,start:C.start||"09:00",end:C.end||"17:00",breaks:M.map(R=>({...R}))}}else S[I.key]={...pN,breaks:[]}}d(S),L(!1),F(E.name),setTimeout(()=>F(null),2e3)},T=async()=>{x(!0);try{const E={};for(const S of su){const I=c[S.key];E[S.key]={enabled:I.enabled,start:I.start,end:I.end,breaks:I.breaks||[],break:I.breaks&&I.breaks.length>0?I.breaks[0]:null}}await tt(Ge(we,"shops",n,"staff",e),{weeklyHours:E}),o()}catch(E){console.error("Error saving weekly hours:",E)}finally{x(!1)}};return a.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Weekly Hours"}),a.jsx("p",{className:"text-sm text-slate-500",children:t})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[w.length>0&&a.jsxs("div",{className:"relative",children:[a.jsxs("button",{type:"button",onClick:()=>L(!A),className:"flex items-center gap-2 px-4 py-2 bg-violet-50 hover:bg-violet-100 text-violet-700 border border-violet-200 rounded-xl text-sm font-semibold transition-all",children:[a.jsx(Et,{className:"w-4 h-4"}),"Apply Preset",a.jsx(Iu,{className:`w-4 h-4 transition-transform ${A?"rotate-180":""}`})]}),A&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>L(!1)}),a.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white border border-slate-200 rounded-xl shadow-xl z-20 py-2 max-h-80 overflow-y-auto",children:w.map(E=>a.jsxs("button",{onClick:()=>Y(E),className:"w-full px-4 py-3 text-left hover:bg-blue-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:E.name}),E.isDefault&&a.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded",children:"DEFAULT"})]}),E.description&&a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:E.description})]},E.id))})]})]}),a.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Ds,{className:"w-5 h-5 text-slate-400"})})]})]}),V&&a.jsxs("div",{className:"mb-4 px-4 py-3 bg-green-50 border border-green-200 rounded-xl flex items-center gap-2 text-sm text-green-700 font-medium animate-fade-in",children:[a.jsx(Ks,{className:"w-4 h-4"}),'Applied "',V,'" preset  click Save to keep changes']}),a.jsx("div",{className:"space-y-3",children:su.map(({key:E,label:S})=>{const I=c[E],C=I.breaks||[];return a.jsxs("div",{className:`rounded-xl p-4 transition-all ${I.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{type:"button",onClick:()=>q(E,"enabled",!I.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${I.enabled?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${I.enabled?"translate-x-6":"translate-x-1"}`})}),a.jsx("span",{className:`font-semibold text-sm ${I.enabled?"text-slate-900":"text-slate-400"}`,children:S}),!I.enabled&&a.jsx("span",{className:"text-sm text-slate-400 italic ml-2",children:"Day off"})]}),I.enabled&&a.jsxs("div",{className:"mt-3 ml-14 space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx(Zt,{className:"w-4 h-4 text-blue-500"}),a.jsx("input",{type:"time",value:I.start,onChange:M=>q(E,"start",M.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),a.jsx("input",{type:"time",value:I.end,onChange:M=>q(E,"end",M.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{type:"button",onClick:()=>Q(E),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${C.length>0?"bg-amber-100 text-amber-700 border border-amber-200":"bg-slate-100 text-slate-500 border border-slate-200 hover:bg-amber-50 hover:text-amber-600 hover:border-amber-200"}`,children:[a.jsx(yf,{className:"w-3.5 h-3.5"}),C.length>0?`${C.length} Break${C.length>1?"s":""}`:"+ Break"]}),a.jsx("button",{type:"button",onClick:()=>le(E),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:g===E?" Copied!":"Copy to all"})]})]}),I.enabled&&C.length>0&&a.jsx("div",{className:"mt-2 ml-14 space-y-2",children:C.map((M,R)=>a.jsxs("div",{className:"flex items-start gap-2 animate-fade-in",children:[a.jsx(yf,{className:"w-3.5 h-3.5 text-amber-500 mt-2"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("span",{className:"text-xs text-slate-500 block mb-1",children:["Break ",R+1]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("input",{type:"time",value:M.start,onChange:B=>H(E,R,"start",B.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("span",{className:"text-slate-400 text-xs",children:"to"}),a.jsx("input",{type:"time",value:M.end,onChange:B=>H(E,R,"end",B.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("button",{type:"button",onClick:()=>ie(E,R),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",title:"Remove break",children:a.jsx(Ds,{className:"w-3.5 h-3.5"})})]})]})]},R))})]},E)})}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t border-slate-200",children:[a.jsxs("button",{onClick:T,disabled:p,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(V2,{className:"w-4 h-4"}),p?"Saving":"Save Hours"]}),a.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Ds,{className:"w-4 h-4"}),"Cancel"]})]})]})}const go=[{key:"monday",short:"Mon",label:"Monday"},{key:"tuesday",short:"Tue",label:"Tuesday"},{key:"wednesday",short:"Wed",label:"Wednesday"},{key:"thursday",short:"Thu",label:"Thursday"},{key:"friday",short:"Fri",label:"Friday"},{key:"saturday",short:"Sat",label:"Saturday"},{key:"sunday",short:"Sun",label:"Sunday"}],s9=[{name:"Full-time 9-5",description:"Monday to Friday, 9am to 5pm with lunch break",days:{monday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},tuesday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},wednesday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},thursday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},friday:{enabled:!0,start:"09:00",end:"17:00",breaks:[{start:"12:00",end:"13:00"}]},saturday:{enabled:!1,start:"09:00",end:"17:00",breaks:[]},sunday:{enabled:!1,start:"09:00",end:"17:00",breaks:[]}},isDefault:!0},{name:"Part-time Mornings",description:"Monday to Friday, 9am to 1pm",days:{monday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},tuesday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},wednesday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},thursday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},friday:{enabled:!0,start:"09:00",end:"13:00",breaks:[]},saturday:{enabled:!1,start:"09:00",end:"13:00",breaks:[]},sunday:{enabled:!1,start:"09:00",end:"13:00",breaks:[]}},isDefault:!0},{name:"Weekends Only",description:"Saturday and Sunday, 10am to 6pm",days:{monday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},tuesday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},wednesday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},thursday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},friday:{enabled:!1,start:"10:00",end:"18:00",breaks:[]},saturday:{enabled:!0,start:"10:00",end:"18:00",breaks:[{start:"13:00",end:"14:00"}]},sunday:{enabled:!0,start:"10:00",end:"18:00",breaks:[{start:"13:00",end:"14:00"}]}},isDefault:!0}],kh={enabled:!1,start:"09:00",end:"17:00",breaks:[]};function xN(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return t===0?`${o}${i}`:`${o}:${t.toString().padStart(2,"0")}${i}`}function n9({shopId:n}){const[e,t]=j.useState([]),[i,o]=j.useState(!0),[c,d]=j.useState(!1),[p,x]=j.useState(null),[g,b]=j.useState(!1),[w,_]=j.useState({name:"",description:"",days:{}});j.useEffect(()=>{A()},[]),j.useEffect(()=>{if(!n)return;const S=Gt(Je(we,"shops",n,"schedulePresets"),I=>{const C=I.docs.map(M=>({id:M.id,...M.data()})).sort((M,R)=>M.isDefault&&!R.isDefault?-1:!M.isDefault&&R.isDefault?1:(M.name||"").localeCompare(R.name||""));t(C),o(!1)});return()=>S()},[n]);const A=()=>{const S={};go.forEach(I=>{S[I.key]={...kh,breaks:[]}}),_({name:"",description:"",days:S}),x(null),d(!1)},L=async()=>{try{for(const S of s9)await _a(Je(we,"shops",n,"schedulePresets"),{...S,createdAt:Ni()})}catch(S){console.error("Error initializing default presets:",S)}},V=async S=>{if(S.preventDefault(),!!w.name.trim()){b(!0);try{const I={name:w.name.trim(),description:w.description.trim(),days:w.days,isDefault:!1,updatedAt:Ni()};p?await tt(Ge(we,"shops",n,"schedulePresets",p.id),I):await _a(Je(we,"shops",n,"schedulePresets"),{...I,createdAt:Ni()}),A()}catch(I){console.error("Error saving preset:",I)}finally{b(!1)}}},F=S=>{const I={};go.forEach(C=>{const M=S.days?.[C.key];M?I[C.key]={enabled:!!M.enabled,start:M.start||"09:00",end:M.end||"17:00",breaks:M.breaks||(M.break?[M.break]:[])}:I[C.key]={...kh,breaks:[]}}),_({name:S.name,description:S.description||"",days:I}),x(S),d(!0)},q=async S=>{if(confirm("Delete this schedule preset?"))try{await ko(Ge(we,"shops",n,"schedulePresets",S))}catch(I){console.error("Error deleting preset:",I)}},Q=S=>{const I={};go.forEach(C=>{const M=S.days?.[C.key];M?I[C.key]={enabled:!!M.enabled,start:M.start||"09:00",end:M.end||"17:00",breaks:[...M.breaks||(M.break?[M.break]:[])]}:I[C.key]={...kh,breaks:[]}}),_({name:`${S.name} (Copy)`,description:S.description||"",days:I}),x(null),d(!0)},H=(S,I,C)=>{_(M=>({...M,days:{...M.days,[S]:{...M.days[S],[I]:C}}}))},ie=S=>{_(I=>({...I,days:{...I.days,[S]:{...I.days[S],breaks:[...I.days[S].breaks||[],{start:"12:00",end:"13:00"}]}}}))},le=(S,I,C,M)=>{_(R=>{const B=[...R.days[S].breaks||[]];return B[I]={...B[I],[C]:M},{...R,days:{...R.days,[S]:{...R.days[S],breaks:B}}}})},Y=(S,I)=>{_(C=>({...C,days:{...C.days,[S]:{...C.days[S],breaks:C.days[S].breaks.filter((M,R)=>R!==I)}}}))},T=S=>{const I=w.days[S];_(C=>{const M={...C.days};return go.forEach(R=>{R.key!==S&&(M[R.key]={enabled:I.enabled,start:I.start,end:I.end,breaks:I.breaks.map(B=>({...B}))})}),{...C,days:M}})},E=S=>{if(!S.days)return"No schedule configured";const I=go.filter(M=>S.days[M.key]?.enabled);return I.length===0?"No working days":I.map(M=>{const R=S.days[M.key],B=R.breaks||(R.break?[R.break]:[]),P=B.length>0?` (${B.length} break${B.length>1?"s":""})`:"";return`${M.short} ${xN(R.start)}${xN(R.end)}${P}`}).join("  ")};return i?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"spinner"})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Schedule Presets"}),a.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create reusable schedule templates with breaks to quickly apply to staff"})]}),!c&&a.jsxs("button",{onClick:()=>{A(),d(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(Ja,{className:"w-4 h-4"}),"New Preset"]})]}),e.length===0&&!c&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 text-center mb-6",children:[a.jsx(Et,{className:"w-10 h-10 text-blue-500 mx-auto mb-3"}),a.jsx("h3",{className:"font-bold text-slate-900 mb-2",children:"Get started with presets"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:'Add common schedule templates like "Full-time 9-5" or "Weekends Only"'}),a.jsxs("button",{onClick:L,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Ja,{className:"w-4 h-4"}),"Add Default Presets"]})]}),c&&a.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 mb-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:p?"Edit Preset":"New Schedule Preset"}),a.jsx("button",{onClick:A,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:a.jsx(Ds,{className:"w-5 h-5 text-slate-400"})})]}),a.jsxs("form",{onSubmit:V,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preset Name *"}),a.jsx("input",{type:"text",value:w.name,onChange:S=>_({...w,name:S.target.value}),placeholder:"e.g., Full-time 9-5",required:!0,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description"}),a.jsx("input",{type:"text",value:w.description,onChange:S=>_({...w,description:S.target.value}),placeholder:"e.g., Standard work week with lunch break",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Weekly Schedule"}),go.map(({key:S,label:I})=>{const C=w.days[S]||kh;return a.jsxs("div",{className:`rounded-xl p-4 transition-all ${C.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-[140px]",children:[a.jsx("button",{type:"button",onClick:()=>H(S,"enabled",!C.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${C.enabled?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${C.enabled?"translate-x-6":"translate-x-1"}`})}),a.jsx("span",{className:`font-semibold text-sm ${C.enabled?"text-slate-900":"text-slate-400"}`,children:I})]}),C.enabled?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Zt,{className:"w-4 h-4 text-blue-500"}),a.jsx("input",{type:"time",value:C.start,onChange:M=>H(S,"start",M.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),a.jsx("input",{type:"time",value:C.end,onChange:M=>H(S,"end",M.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("button",{type:"button",onClick:()=>ie(S),className:"flex items-center gap-1.5 px-3 py-1.5 bg-amber-100 hover:bg-amber-200 text-amber-700 border border-amber-200 rounded-lg text-xs font-semibold transition-all",children:[a.jsx(yf,{className:"w-3.5 h-3.5"}),"+ Break"]}),a.jsx("button",{type:"button",onClick:()=>T(S),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:"Copy to all"})]}):a.jsx("span",{className:"text-sm text-slate-400 italic",children:"Day off"})]}),C.enabled&&C.breaks&&C.breaks.length>0&&a.jsx("div",{className:"mt-3 ml-[140px] space-y-2",children:C.breaks.map((M,R)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(yf,{className:"w-3.5 h-3.5 text-amber-500"}),a.jsx("span",{className:"text-xs text-slate-500",children:"Break:"}),a.jsx("input",{type:"time",value:M.start,onChange:B=>le(S,R,"start",B.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("span",{className:"text-slate-400 text-xs",children:""}),a.jsx("input",{type:"time",value:M.end,onChange:B=>le(S,R,"end",B.target.value),className:"px-2 py-1 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),a.jsx("button",{type:"button",onClick:()=>Y(S,R),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",children:a.jsx(Ds,{className:"w-3.5 h-3.5"})})]},R))})]},S)})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:g,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(V2,{className:"w-4 h-4"}),g?"Saving":p?"Update Preset":"Save Preset"]}),a.jsxs("button",{type:"button",onClick:A,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Ds,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length>0&&a.jsx("div",{className:"space-y-3",children:e.map(S=>a.jsx("div",{className:"bg-white border border-slate-200 rounded-xl p-5 hover:shadow-md transition-all",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h3",{className:"text-base font-bold text-slate-900",children:S.name}),S.isDefault&&a.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-[10px] font-bold rounded-md",children:"DEFAULT"})]}),S.description&&a.jsx("p",{className:"text-sm text-slate-500 mb-2",children:S.description}),a.jsx("p",{className:"text-xs text-slate-400 leading-relaxed",children:E(S)})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx("button",{onClick:()=>Q(S),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"Duplicate preset",children:a.jsx(O2,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>F(S),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"Edit preset",children:a.jsx(Tg,{className:"w-4 h-4"})}),!S.isDefault&&a.jsx("button",{onClick:()=>q(S.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Delete preset",children:a.jsx(ba,{className:"w-4 h-4"})})]})]})},S.id))})]})}const wr={free:{name:"Free",price:0,staffLimit:1,platformFeePercent:5,features:["basicBooking","emailNotifications"]},pro:{name:"Pro",price:29,priceId:null,staffLimit:5,platformFeePercent:0,features:["basicBooking","emailNotifications","aiAssistant","recurringBookings","waitlist","crm","analytics","smsNotifications","customBranding"]},unlimited:{name:"Unlimited",price:79,priceId:null,staffLimit:1/0,platformFeePercent:0,features:["basicBooking","emailNotifications","aiAssistant","recurringBookings","waitlist","crm","analytics","smsNotifications","customBranding","walkIns","multiLocation","noBranding","apiAccess","prioritySupport"]}},a9={basicBooking:{name:"Online Booking",description:"Accept bookings through your booking page"},emailNotifications:{name:"Email Notifications",description:"Automatic booking confirmations and reminders"},aiAssistant:{name:"AI Booking Assistant",description:"Smart suggestions and automated responses"},recurringBookings:{name:"Recurring Bookings",description:"Schedule repeating appointments"},waitlist:{name:"Waitlist",description:"Let clients join a waitlist when fully booked"},crm:{name:"Client CRM",description:"Client notes, history, and win-back tracking"},analytics:{name:"Analytics",description:"Detailed booking and revenue analytics"},smsNotifications:{name:"SMS Notifications",description:"Send text message reminders to clients"},customBranding:{name:"Custom Branding",description:"Customize colors and branding on your booking page"},walkIns:{name:"Walk-in Queue",description:"Manage walk-in clients with live queue"},multiLocation:{name:"Multi-Location",description:"Manage multiple business locations"},noBranding:{name:"Remove SpotBookie Branding",description:"White-label your booking experience"},apiAccess:{name:"API Access",description:"Integrate with external tools and systems"},prioritySupport:{name:"Priority Support",description:"24/7 priority customer support"}};function aS(n){const e=n?.subscriptionTier||"free";return wr[e]?.staffLimit||1}function r9(n,e){const t=aS(n);return e<t}function i9(n,e){const t=wr[n]||wr.free,i=wr[e];return i?i.features.filter(o=>!t.features.includes(o)):[]}function l9(n){const e=["free","pro","unlimited"],t=e.indexOf(n||"free");return e.slice(t+1).map(i=>({key:i,...wr[i],newFeatures:i9(n,i)}))}const o9="https://us-central1-scheduler-65e51.cloudfunctions.net",c9={pro:"price_1Sxx7ILhwB1Jyzw8UvRxE5FT",unlimited:"price_1Sxx7JLhwB1Jyzw8uw9BRYhO"};function u9({isOpen:n,onClose:e,shopId:t,slug:i,currentTier:o="free",feature:c,title:d,description:p}){const[x,g]=j.useState(null),[b,w]=j.useState(null);if(!n)return null;const _=l9(o),A=async L=>{g(L),w(null);try{const V=await fetch(`${o9}/createCheckoutSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:t,priceId:c9[L],successUrl:`${window.location.origin}/#/shop/${i}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/#/shop/${i}/dashboard?subscription=canceled`})}),F=await V.json();if(!V.ok)throw new Error(F.error||"Failed to create checkout session");window.location.href=F.url}catch(V){console.error("Upgrade error:",V),w(V.message),g(null)}};return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-violet-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20",children:a.jsx(Uo,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:d||"Upgrade Required"}),a.jsx("p",{className:"text-sm text-slate-500",children:p||"Unlock more features with a premium plan"})]})]}),a.jsx("button",{onClick:e,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",children:a.jsx(Ds,{className:"w-5 h-5"})})]}),b&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:b}),a.jsx("div",{className:"space-y-3",children:_.map(L=>a.jsxs("div",{className:`border-2 rounded-xl p-4 transition-all ${L.key==="pro"?"border-blue-300 bg-blue-50/50":"border-violet-300 bg-violet-50/50"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-slate-900",children:L.name}),a.jsxs("p",{className:"text-lg font-extrabold text-slate-900",children:["$",L.price,a.jsx("span",{className:"text-sm font-normal text-slate-500",children:"/month"})]})]}),a.jsx("button",{onClick:()=>A(L.key),disabled:x,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-semibold text-sm transition-all disabled:opacity-50 ${L.key==="pro"?"bg-blue-500 hover:bg-blue-600 text-white shadow-md shadow-blue-500/20":"bg-violet-500 hover:bg-violet-600 text-white shadow-md shadow-violet-500/20"}`,children:x===L.key?a.jsx(ea,{className:"w-4 h-4 animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(Xo,{className:"w-4 h-4"}),"Upgrade"]})})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[L.key==="pro"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-blue-200 rounded-lg text-xs font-medium text-blue-700",children:[a.jsx(Dt,{className:"w-3 h-3"}),"5 staff"]}),L.key==="unlimited"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white border border-violet-200 rounded-lg text-xs font-medium text-violet-700",children:[a.jsx(Dt,{className:"w-3 h-3"}),"Unlimited staff"]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-emerald-50 border border-emerald-200 rounded-lg text-xs font-medium text-emerald-700",children:[a.jsx(Ks,{className:"w-3 h-3"}),"No platform fees"]})]})]},L.key))}),a.jsx("p",{className:"text-xs text-slate-400 text-center mt-4",children:"Cancel anytime  14-day money-back guarantee"})]})})}function d9({currentCount:n,limit:e,onUpgradeClick:t}){const i=n>=e,o=n>=e-1&&n<e;return!i&&!o?null:a.jsxs("div",{className:`rounded-xl p-4 flex items-center justify-between gap-4 mb-4 ${i?"bg-amber-50 border border-amber-200":"bg-blue-50 border border-blue-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${i?"bg-amber-100":"bg-blue-100"}`,children:a.jsx(Dt,{className:`w-5 h-5 ${i?"text-amber-600":"text-blue-600"}`})}),a.jsxs("div",{children:[a.jsx("p",{className:`font-semibold text-sm ${i?"text-amber-900":"text-blue-900"}`,children:i?"Staff limit reached":"Almost at staff limit"}),a.jsxs("p",{className:"text-xs text-slate-600",children:["You have ",n," of ",e," staff member",e!==1?"s":"",".",i?" Upgrade to add more.":" Upgrade before you need more."]})]})]}),a.jsxs("button",{onClick:t,className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-semibold text-sm transition-all shadow-md flex-shrink-0 ${i?"bg-amber-500 hover:bg-amber-600 text-white shadow-amber-500/20":"bg-blue-500 hover:bg-blue-600 text-white shadow-blue-500/20"}`,children:[a.jsx(Xo,{className:"w-4 h-4"}),"Upgrade"]})]})}const h9=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}],f9=5*1024*1024,m9=["image/jpeg","image/png","image/webp"];function gN(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return t===0?`${o}${i}`:`${o}:${t.toString().padStart(2,"0")}${i}`}function p9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState([]),[c,d]=j.useState(!1),[p,x]=j.useState(null),[g,b]=j.useState(null),[w,_]=j.useState(null),[A,L]=j.useState({name:"",role:""}),[V,F]=j.useState(!1),[q,Q]=j.useState(!1),[H,ie]=j.useState("staff"),[le,Y]=j.useState([]),[T,E]=j.useState(null),[S,I]=j.useState(null),C=aS(e),M=r9(e,i.length),[R,B]=j.useState(null),[P,O]=j.useState(""),[K,oe]=j.useState(!1),[be,fe]=j.useState(!1),[U,Z]=j.useState(""),[ue,me]=j.useState(null),[ge,De]=j.useState(null),[Ye,pt]=j.useState(null),dt=j.useRef(null);j.useEffect(()=>{if(!n)return;const pe=Gt(Je(we,"shops",n,"staff"),Fe=>{const Oe=Fe.docs.map(We=>({id:We.id,...We.data()})).filter(We=>We.active!==!1).sort((We,Qe)=>(We.name||"").localeCompare(Qe.name||""));o(Oe)}),Ke=Gt(Je(we,"shops",n,"schedulePresets"),Fe=>{const Oe=Fe.docs.map(We=>({id:We.id,...We.data()})).sort((We,Qe)=>We.isDefault&&!Qe.isDefault?-1:!We.isDefault&&Qe.isDefault?1:(We.name||"").localeCompare(Qe.name||""));Y(Oe)});return()=>{pe(),Ke()}},[n]);const Wt=async(pe,Ke)=>{if(Ke.days)try{const Fe={},Oe=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];for(const We of Oe){const Qe=Ke.days[We];if(Qe){const es=Qe.breaks||(Qe.break?[Qe.break]:[]);Fe[We]={enabled:!!Qe.enabled,start:Qe.start||"09:00",end:Qe.end||"17:00",breaks:es,break:es.length>0?es[0]:null}}else Fe[We]={enabled:!1,start:"09:00",end:"17:00",breaks:[],break:null}}await tt(Ge(we,"shops",n,"staff",pe),{weeklyHours:Fe}),E(null),I({staffId:pe,presetName:Ke.name}),setTimeout(()=>I(null),2500)}catch(Fe){console.error("Error applying preset:",Fe)}},ne=()=>{L({name:"",role:""}),d(!1),x(null)},Te=async pe=>{pe.preventDefault(),F(!0);const Ke={name:A.name.trim(),role:A.role.trim(),active:!0};try{p?await tt(Ge(we,"shops",n,"staff",p),Ke):await _a(Je(we,"shops",n,"staff"),{...Ke,email:"",bio:"",portfolio:[],createdAt:Ni()}),ne()}catch(Fe){console.error("Error saving staff member:",Fe)}finally{F(!1)}},W=pe=>{L({name:pe.name,role:pe.role||""}),x(pe.id),d(!0)},ye=async pe=>{try{await tt(Ge(we,"shops",n,"staff",pe),{active:!1})}catch(Ke){console.error("Error deleting staff member:",Ke)}},Ae=pe=>{B(pe.id),O(pe.bio||"")},Ve=async pe=>{oe(!0);try{await tt(Ge(we,"shops",n,"staff",pe),{bio:P.trim()}),B(null),O("")}catch(Ke){console.error("Error saving bio:",Ke)}finally{oe(!1)}},xt=pe=>{me(pe),Z(""),De(null),setTimeout(()=>{dt.current&&(dt.current.value="",dt.current.click())},50)},it=pe=>{const Ke=pe.target.files?.[0];if(Ke){if(!m9.includes(Ke.type)){alert("Please select a JPG, PNG, or WebP image.");return}if(Ke.size>f9){alert("File size must be under 5MB.");return}De(Ke)}},rt=async pe=>{if(ge){fe(!0);try{const Ke=Date.now(),Fe=ge.name.split(".").pop(),Oe=`${Ke}.${Fe}`,We=`shops/${n}/staff/${pe}/portfolio/${Oe}`,Qe=Y1(W1,We);await QI(Qe,ge);const es=await KI(Qe),Sn=i.find(Js=>Js.id===pe)?.portfolio||[];await tt(Ge(we,"shops",n,"staff",pe),{portfolio:[...Sn,{url:es,storagePath:We,caption:U.trim(),uploadedAt:new Date().toISOString()}]}),me(null),Z(""),De(null)}catch(Ke){console.error("Error uploading photo:",Ke),alert("Upload failed. Please try again.")}finally{fe(!1)}}},Ce=async(pe,Ke)=>{const Fe=i.find(We=>We.id===pe);if(!Fe)return;const Oe=Fe.portfolio[Ke];if(Oe){pt(`${pe}-${Ke}`);try{if(Oe.storagePath)try{const Qe=Y1(W1,Oe.storagePath);await XI(Qe)}catch(Qe){console.warn("Storage delete warning:",Qe)}const We=Fe.portfolio.filter((Qe,es)=>es!==Ke);await tt(Ge(we,"shops",n,"staff",pe),{portfolio:We})}catch(We){console.error("Error deleting photo:",We),alert("Failed to delete photo.")}finally{pt(null)}}},Le=pe=>{if(!pe)return null;const Ke=h9.filter(Fe=>pe[Fe.key]?.enabled);return Ke.length===0?null:Ke.map(Fe=>{const Oe=pe[Fe.key],We=Oe.breaks||(Oe.break?[Oe.break]:[]),Qe=We.length>0?` ${We.length>1?We.length:""}`:"";return`${Fe.short} ${gN(Oe.start)}${gN(Oe.end)}${Qe}`})};return a.jsxs("div",{children:[a.jsx("input",{ref:dt,type:"file",accept:".jpg,.jpeg,.png,.webp",className:"hidden",onChange:it}),a.jsxs("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl mb-6 w-fit",children:[a.jsxs("button",{onClick:()=>ie("staff"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${H==="staff"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(Dt,{className:"w-4 h-4"}),"Staff Members"]}),a.jsxs("button",{onClick:()=>ie("presets"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${H==="presets"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(Et,{className:"w-4 h-4"}),"Schedule Presets"]})]}),H==="presets"&&a.jsx(n9,{shopId:n}),H==="staff"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Staff"}),a.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Manage your team  assign availability and bookings per staff member"})]}),!c&&(M?a.jsxs("button",{onClick:()=>{ne(),d(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(Ja,{className:"w-4 h-4"}),"Add Staff"]}):a.jsxs("button",{onClick:()=>Q(!0),className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white rounded-xl font-semibold shadow-lg shadow-amber-500/30 hover:shadow-xl hover:shadow-amber-500/40 transition-all hover:-translate-y-0.5",children:[a.jsx(Uo,{className:"w-4 h-4"}),"Upgrade to Add More"]}))]}),a.jsx(d9,{currentCount:i.length,limit:C,onUpgradeClick:()=>Q(!0)}),a.jsx(u9,{isOpen:q,onClose:()=>Q(!1),shopId:n,slug:t,currentTier:e?.subscriptionTier||"free",title:"Add More Staff Members",description:`Your ${e?.subscriptionTier||"Free"} plan allows ${C} staff member${C!==1?"s":""}. Upgrade to add more.`}),c&&a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:p?"Edit Staff Member":"New Staff Member"}),a.jsxs("form",{onSubmit:Te,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Name *"}),a.jsx("input",{type:"text",value:A.name,onChange:pe=>L({...A,name:pe.target.value}),required:!0,placeholder:"e.g. Jane Smith",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Role (optional)"}),a.jsx("input",{type:"text",value:A.role,onChange:pe=>L({...A,role:pe.target.value}),placeholder:"e.g. Senior Stylist",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsxs("button",{type:"submit",disabled:V,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[a.jsx(Ks,{className:"w-4 h-4"}),V?"Saving":p?"Update Staff":"Add Staff"]}),a.jsxs("button",{type:"button",onClick:ne,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[a.jsx(Ds,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),i.length===0?a.jsxs("div",{className:"text-center py-16",children:[a.jsx("div",{className:"text-5xl mb-3",children:""}),a.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No staff members yet"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Add your team members to assign them availability and bookings"})]}):a.jsx("div",{className:"space-y-4",children:i.map(pe=>{const Ke=Le(pe.weeklyHours),Fe=pe.portfolio||[];return a.jsxs("div",{children:[a.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:pe.name}),pe.role&&a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:pe.role})]}),a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Dt,{className:"w-5 h-5 text-blue-600"})})]}),a.jsx("div",{className:"mb-3",children:R===pe.id?a.jsxs("div",{className:"space-y-2",children:[a.jsx("textarea",{value:P,onChange:Oe=>O(Oe.target.value),placeholder:"Write a short bio  specialties, experience, personality",rows:3,maxLength:500,className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none transition-all"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>Ve(pe.id),disabled:K,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[K?a.jsx(ea,{className:"w-3 h-3 animate-spin"}):a.jsx(Ks,{className:"w-3 h-3"}),"Save Bio"]}),a.jsx("button",{onClick:()=>{B(null),O("")},className:"px-3 py-1.5 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"}),a.jsxs("span",{className:"text-xs text-slate-400 ml-auto",children:[P.length,"/500"]})]})]}):a.jsx("div",{onClick:()=>Ae(pe),className:"cursor-pointer group",children:pe.bio?a.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed group-hover:text-slate-800 transition-colors",children:[pe.bio,a.jsx("span",{className:"ml-1.5 text-xs text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",children:"edit"})]}):a.jsx("p",{className:"text-sm text-slate-400 italic group-hover:text-blue-500 transition-colors",children:"+ Add a bio"})})}),Ke?a.jsx("div",{className:"mb-3 flex flex-wrap gap-1.5",children:Ke.map((Oe,We)=>a.jsx("span",{className:"inline-block px-2 py-0.5 bg-green-50 text-green-700 border border-green-200 rounded text-xs font-medium",children:Oe},We))}):a.jsx("p",{className:"text-xs text-slate-400 mb-3 italic",children:"No weekly hours set"}),Fe.length>0&&w!==pe.id&&a.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[a.jsx("div",{className:"flex -space-x-1",children:Fe.slice(0,4).map((Oe,We)=>a.jsx("img",{src:Oe.url,alt:Oe.caption||"Portfolio",className:"w-10 h-10 rounded-lg object-cover border-2 border-white shadow-sm"},We))}),a.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[Fe.length," photo",Fe.length!==1?"s":""]})]}),S?.staffId===pe.id&&a.jsxs("div",{className:"mb-3 px-3 py-2 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-xs text-green-700 font-medium animate-fade-in",children:[a.jsx(Ks,{className:"w-3.5 h-3.5"}),'Applied "',S.presetName,'" schedule']}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs("button",{onClick:()=>b(g===pe.id?null:pe.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${g===pe.id?"bg-blue-100 text-blue-700 border-blue-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:[a.jsx(Zt,{className:"w-3.5 h-3.5"}),"Set Hours"]}),le.length>0&&a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>E(T===pe.id?null:pe.id),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${T===pe.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-violet-50 hover:bg-violet-100 text-violet-700 border-violet-200"}`,children:[a.jsx(Et,{className:"w-3.5 h-3.5"}),"Apply Preset",a.jsx(Iu,{className:`w-3 h-3 transition-transform ${T===pe.id?"rotate-180":""}`})]}),T===pe.id&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>E(null)}),a.jsx("div",{className:"absolute top-full right-0 mt-1 w-56 bg-white border border-slate-200 rounded-xl shadow-xl z-20 py-2 max-h-64 overflow-y-auto",children:le.map(Oe=>a.jsxs("button",{onClick:()=>Wt(pe.id,Oe),className:"w-full px-4 py-2.5 text-left hover:bg-blue-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-900 text-sm",children:Oe.name}),Oe.isDefault&&a.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-[9px] font-bold rounded",children:"DEFAULT"})]}),Oe.description&&a.jsx("p",{className:"text-xs text-slate-500 mt-0.5 line-clamp-1",children:Oe.description})]},Oe.id))})]})]}),a.jsx("button",{onClick:()=>_(w===pe.id?null:pe.id),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${w===pe.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:a.jsx(TD,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>W(pe),className:"flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:a.jsx(Tg,{className:"w-3.5 h-3.5"})}),a.jsx("button",{onClick:()=>ye(pe.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:a.jsx(ba,{className:"w-3.5 h-3.5"})})]})]}),g===pe.id&&a.jsx("div",{className:"mt-2",children:a.jsx(t9,{shopId:n,staffId:pe.id,staffName:pe.name,weeklyHours:pe.weeklyHours,onClose:()=>b(null)})}),w===pe.id&&a.jsxs("div",{className:"mt-2 bg-white border-2 border-violet-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[a.jsx(Eg,{className:"w-4 h-4 text-violet-600"}),"Portfolio  ",pe.name]}),a.jsxs("button",{onClick:()=>xt(pe.id),disabled:be,className:"flex items-center gap-1.5 px-3 py-1.5 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[a.jsx(Ja,{className:"w-3 h-3"}),"Add Photo"]})]}),ue===pe.id&&ge&&a.jsxs("div",{className:"mb-4 p-3 bg-violet-50 border border-violet-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-16 h-16 rounded-lg bg-slate-200 overflow-hidden flex-shrink-0",children:a.jsx("img",{src:URL.createObjectURL(ge),alt:"Preview",className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-xs text-slate-600 font-medium mb-1 truncate",children:ge.name}),a.jsxs("p",{className:"text-xs text-slate-400",children:[(ge.size/1024/1024).toFixed(1)," MB"]})]})]}),a.jsx("input",{type:"text",value:U,onChange:Oe=>Z(Oe.target.value),placeholder:"Add a caption (optional)",maxLength:200,className:"w-full px-3 py-2 text-sm border border-violet-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-400 focus:border-transparent mb-2"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>rt(pe.id),disabled:be,className:"flex items-center gap-1.5 px-4 py-2 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:be?a.jsxs(a.Fragment,{children:[a.jsx(ea,{className:"w-3 h-3 animate-spin"}),"Uploading"]}):a.jsxs(a.Fragment,{children:[a.jsx(Ks,{className:"w-3 h-3"}),"Upload"]})}),a.jsx("button",{onClick:()=>{me(null),De(null),Z("")},className:"px-3 py-2 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}),Fe.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-3xl mb-2",children:""}),a.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet. Add some to showcase work!"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:Fe.map((Oe,We)=>a.jsxs("div",{className:"group relative bg-slate-50 rounded-lg overflow-hidden border border-slate-200 shadow-sm",children:[a.jsx("div",{className:"aspect-square",children:a.jsx("img",{src:Oe.url,alt:Oe.caption||"Portfolio photo",className:"w-full h-full object-cover"})}),Oe.caption&&a.jsx("div",{className:"px-2 py-1.5",children:a.jsx("p",{className:"text-xs text-slate-600 truncate",children:Oe.caption})}),a.jsx("button",{onClick:()=>Ce(pe.id,We),disabled:Ye===`${pe.id}-${We}`,className:"absolute top-1.5 right-1.5 w-7 h-7 bg-red-500/90 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-md disabled:opacity-50",title:"Delete photo",children:Ye===`${pe.id}-${We}`?a.jsx(ea,{className:"w-3.5 h-3.5 animate-spin"}):a.jsx(ba,{className:"w-3.5 h-3.5"})})]},We))})]})]},pe.id)})})]})]})}function ol(n){return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}function x9(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function cl(n){return`$${Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function bN(n){return new Date(n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}function yN(n){return new Date(n+"T12:00:00").toLocaleDateString("en-US",{weekday:"short"})}function T0(n,e){return e===0&&n===0?0:e===0?100:(n-e)/e*100}function g9({bookings:n}){const[e,t]=j.useState(null),[i,o]=j.useState(null),c=j.useMemo(()=>n.filter(B=>B.status==="confirmed"||B.status==="pending"||!B.status),[n]),d=j.useMemo(()=>{const B=new Date;return B.setHours(0,0,0,0),B},[]),p=j.useMemo(()=>ol(d),[d]),x=j.useMemo(()=>x9(d),[d]),g=j.useMemo(()=>{const B=new Date(x);return B.setDate(B.getDate()+6),B},[x]),b=j.useMemo(()=>{const B=new Date(x);return B.setDate(B.getDate()-7),B},[x]),w=j.useMemo(()=>{const B=new Date(b);return B.setDate(B.getDate()+6),B},[b]),_=j.useMemo(()=>new Date(d.getFullYear(),d.getMonth(),1),[d]),A=j.useMemo(()=>new Date(d.getFullYear(),d.getMonth()-1,1),[d]),L=j.useMemo(()=>{const B=new Date(_);return B.setDate(B.getDate()-1),B},[_]),V=j.useMemo(()=>{const B=new Date(d);return B.setDate(B.getDate()-1),ol(B)},[d]),F=j.useMemo(()=>{const B=ue=>ue.reduce((me,ge)=>me+(Number(ge.servicePrice)||0),0),P=(ue,me,ge)=>ue.date>=ol(me)&&ue.date<=ol(ge),O=B(c.filter(ue=>ue.date===p)),K=B(c.filter(ue=>ue.date===V)),oe=B(c.filter(ue=>P(ue,x,g))),be=B(c.filter(ue=>P(ue,b,w))),fe=B(c.filter(ue=>P(ue,_,d))),U=B(c.filter(ue=>P(ue,A,L))),Z=B(c);return{today:O,todayChange:T0(O,K),week:oe,weekChange:T0(oe,be),month:fe,monthChange:T0(fe,U),allTime:Z}},[c,p,V,x,g,b,w,_,L,d]),q=j.useMemo(()=>{const B=[];for(let P=13;P>=0;P--){const O=new Date(d);O.setDate(O.getDate()-P),B.push(ol(O))}return B},[d]),Q=j.useMemo(()=>{const B={};return q.forEach(P=>{B[P]=0}),c.forEach(P=>{B[P.date]!==void 0&&(B[P.date]+=Number(P.servicePrice)||0)}),q.map(P=>({date:P,value:B[P]}))},[c,q]),H=j.useMemo(()=>Math.max(...Q.map(B=>B.value),1),[Q]),ie=j.useMemo(()=>{const B={},P={};return q.forEach(O=>{B[O]=0,P[O]=0}),n.forEach(O=>{B[O.date]!==void 0&&(O.status==="cancelled"||O.status==="rejected"?P[O.date]++:B[O.date]++)}),q.map(O=>({date:O,confirmed:B[O],cancelled:P[O],total:B[O]+P[O]}))},[n,q]),le=j.useMemo(()=>Math.max(...ie.map(B=>B.total),1),[ie]),Y=j.useMemo(()=>{const B=n.length;if(B===0)return 100;const P=n.filter(O=>O.status==="cancelled"||O.status==="rejected").length;return Math.round((B-P)/B*100)},[n]),T=j.useMemo(()=>{const B=Array.from({length:7},()=>Array(24).fill(0));c.forEach(O=>{if(!O.date||!O.time)return;const oe=new Date(O.date+"T12:00:00").getDay(),be=parseInt(O.time.split(":")[0],10);!isNaN(oe)&&!isNaN(be)&&B[oe][be]++});let P=0;return B.forEach(O=>O.forEach(K=>{K>P&&(P=K)})),{grid:B,max:P}},[c]),E=j.useMemo(()=>{const B={};return c.forEach(P=>{const O=P.serviceName||"Unknown";B[O]||(B[O]={name:O,count:0,revenue:0}),B[O].count++,B[O].revenue+=Number(P.servicePrice)||0}),Object.values(B).map(P=>({...P,avgRevenue:P.count>0?P.revenue/P.count:0})).sort((P,O)=>O.revenue-P.revenue)},[c]),S=j.useMemo(()=>{const B={};return c.forEach(P=>{const O=P.staffName||"Unassigned";B[O]||(B[O]={name:O,count:0,revenue:0,clients:new Set}),B[O].count++,B[O].revenue+=Number(P.servicePrice)||0,P.clientEmail&&B[O].clients.add(P.clientEmail.toLowerCase())}),Object.values(B).map(P=>({...P,clientCount:P.clients.size})).sort((P,O)=>O.revenue-P.revenue)},[c]),I=j.useMemo(()=>{const B=c.map(ge=>ge.clientEmail?.toLowerCase()).filter(Boolean),P=new Set(B).size,O=c.filter(ge=>ge.date>=ol(_)&&ge.date<=p),K=new Set(O.map(ge=>ge.clientEmail?.toLowerCase()).filter(Boolean)),oe=c.filter(ge=>ge.date<ol(_)),be=new Set(oe.map(ge=>ge.clientEmail?.toLowerCase()).filter(Boolean));let fe=0,U=0;K.forEach(ge=>{be.has(ge)?U++:fe++});const Z={};c.forEach(ge=>{const De=ge.clientEmail?.toLowerCase();De&&(Z[De]||(Z[De]={email:De,name:ge.clientName||De,count:0}),Z[De].count++,ge.clientName&&(Z[De].name=ge.clientName))});const ue=Object.values(Z).sort((ge,De)=>De.count-ge.count).slice(0,10),me=P>0?c.length/P:0;return{uniqueClients:P,newThisMonth:fe,returningThisMonth:U,topClients:ue,avgBookingsPerClient:me}},[c,_,p]),C=({value:B,suffix:P="vs prev"})=>{if(B===0)return a.jsxs("span",{className:"flex items-center gap-0.5 text-xs font-medium text-slate-400",children:[a.jsx(bM,{className:"w-3 h-3"})," 0% ",P]});const O=B>0;return a.jsxs("span",{className:`flex items-center gap-0.5 text-xs font-semibold ${O?"text-emerald-600":"text-red-500"}`,children:[O?a.jsx(D2,{className:"w-3 h-3"}):a.jsx(uD,{className:"w-3 h-3"}),O?"+":"",Math.round(B),"% ",P]})},M=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],R=Array.from({length:15},(B,P)=>P+7);return a.jsxs("div",{className:"animate-fade-in space-y-6",children:[a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Today's Revenue",value:F.today,change:F.todayChange,suffix:"vs yesterday",icon:Ro,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:F.week,change:F.weekChange,suffix:"vs last week",icon:Bo,color:"bg-violet-100 text-violet-600"},{label:"This Month",value:F.month,change:F.monthChange,suffix:"vs last month",icon:Et,color:"bg-emerald-100 text-emerald-600"},{label:"All-time Revenue",value:F.allTime,change:null,icon:_g,color:"bg-amber-100 text-amber-600"}].map(B=>{const P=B.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${B.color} rounded-xl flex items-center justify-center`,children:a.jsx(P,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:cl(B.value)}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5 mb-1",children:B.label}),B.change!==null&&a.jsx(C,{value:B.change,suffix:B.suffix})]},B.label)})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Revenue"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Last 14 days  confirmed & pending bookings"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("div",{className:"flex items-end gap-0",children:[a.jsxs("div",{className:"flex flex-col justify-between h-48 pr-2 text-right flex-shrink-0 w-16",children:[a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:cl(H)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:cl(H/2)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"$0"})]}),a.jsx("div",{className:"flex-1 flex items-end gap-1 h-48 border-b border-l border-slate-200 pl-1 pb-0 relative",children:Q.map((B,P)=>{const O=H>0?B.value/H*100:0,K=e===P;return a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative group",onMouseEnter:()=>t(P),onMouseLeave:()=>t(null),onTouchStart:()=>t(P),children:[K&&a.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[cl(B.value),a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),a.jsx("div",{className:"w-full rounded-t-md transition-all duration-200 cursor-pointer",style:{height:`${Math.max(O,B.value>0?2:0)}%`,background:K?"linear-gradient(to top, #2563eb, #60a5fa)":"linear-gradient(to top, #3b82f6, #93c5fd)",minHeight:B.value>0?"4px":"0px"}})]},B.date)})})]}),a.jsx("div",{className:"flex ml-16 pl-1",children:Q.map(B=>a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:yN(B.date)}),a.jsx("div",{className:"text-[9px] text-slate-400",children:bN(B.date)})]},B.date))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-5",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Booking Trends"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Last 14 days breakdown"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-blue-500"})," Confirmed"]}),a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-red-400"})," Cancelled"]}),a.jsxs("span",{className:"px-2.5 py-1 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-lg font-semibold",children:[Y,"% completion"]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("div",{className:"flex items-end gap-0",children:[a.jsxs("div",{className:"flex flex-col justify-between h-40 pr-2 text-right flex-shrink-0 w-16",children:[a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:le}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:Math.round(le/2)}),a.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"0"})]}),a.jsx("div",{className:"flex-1 flex items-end gap-1 h-40 border-b border-l border-slate-200 pl-1 relative",children:ie.map((B,P)=>{const O=le>0?B.confirmed/le*100:0,K=le>0?B.cancelled/le*100:0,oe=i===P;return a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative",onMouseEnter:()=>o(P),onMouseLeave:()=>o(null),onTouchStart:()=>o(P),children:[oe&&a.jsxs("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[B.confirmed," confirmed, ",B.cancelled," cancelled",a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),a.jsxs("div",{className:"w-full flex flex-col items-stretch",children:[B.cancelled>0&&a.jsx("div",{className:"w-full rounded-t-md bg-red-400 transition-all duration-200",style:{height:`${Math.max(K,2)}%`}}),B.confirmed>0&&a.jsx("div",{className:`w-full bg-blue-500 transition-all duration-200 ${B.cancelled===0?"rounded-t-md":""}`,style:{height:`${Math.max(O,2)}%`}})]})]},B.date)})})]}),a.jsx("div",{className:"flex ml-16 pl-1",children:ie.map(B=>a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:yN(B.date)}),a.jsx("div",{className:"text-[9px] text-slate-400",children:bN(B.date)})]},B.date))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Busiest Times"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Booking density by day of week and hour"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("div",{className:"min-w-[600px]",children:[a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"w-12"}),R.map(B=>a.jsxs("th",{className:"text-[10px] text-slate-400 font-medium pb-2 text-center px-0.5",children:[B%12||12,B>=12?"p":"a"]},B))]})}),a.jsx("tbody",{children:[1,2,3,4,5,6,0].map(B=>a.jsxs("tr",{children:[a.jsx("td",{className:"text-[11px] text-slate-500 font-semibold pr-2 py-0.5 text-right",children:M[B]}),R.map(P=>{const O=T.grid[B][P],K=T.max||1,oe=O/K;let be="bg-slate-50";return O>0&&(oe<=.2?be="bg-blue-100":oe<=.4?be="bg-blue-200":oe<=.6?be="bg-blue-300":oe<=.8?be="bg-blue-500 text-white":be="bg-blue-700 text-white"),a.jsx("td",{className:"px-0.5 py-0.5",children:a.jsx("div",{className:`w-full aspect-square rounded-sm ${be} flex items-center justify-center text-[9px] font-bold transition-all hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 cursor-default`,title:`${M[B]} ${P}:00  ${O} booking${O!==1?"s":""}`,children:O>0?O:""})},P)})]},B))})]}),a.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-3",children:[a.jsx("span",{className:"text-[10px] text-slate-400",children:"Less"}),["bg-slate-50","bg-blue-100","bg-blue-200","bg-blue-300","bg-blue-500","bg-blue-700"].map((B,P)=>a.jsx("div",{className:`w-4 h-4 rounded-sm ${B} border border-slate-200`},P)),a.jsx("span",{className:"text-[10px] text-slate-400",children:"More"})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Top Services"}),a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Ranked by revenue from confirmed & pending bookings"}),E.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Nn,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No service data yet"})]}):a.jsx("div",{className:"space-y-2",children:E.map((B,P)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm flex-shrink-0",children:P+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:B.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:[B.count," booking",B.count!==1?"s":"","  avg ",cl(B.avgRevenue)]})]}),a.jsx("div",{className:"text-sm font-bold text-blue-600 flex-shrink-0",children:cl(B.revenue)})]},B.name))})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Staff Performance"}),a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Bookings, revenue & clients per staff member"}),S.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Dt,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No staff data yet"})]}):a.jsx("div",{className:"space-y-2",children:S.map((B,P)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center text-violet-600 font-bold text-sm flex-shrink-0",children:P+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:B.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:[B.count," booking",B.count!==1?"s":"","  ",B.clientCount," client",B.clientCount!==1?"s":""]})]}),a.jsx("div",{className:"text-sm font-bold text-violet-600 flex-shrink-0",children:cl(B.revenue)})]},B.name))})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Insights"}),a.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Understanding your client base"}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[a.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:I.uniqueClients}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Unique Clients"})]}),a.jsxs("div",{className:"bg-emerald-50 rounded-xl border border-emerald-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-emerald-700",children:I.newThisMonth}),a.jsx("div",{className:"text-xs font-medium text-emerald-600 mt-0.5",children:"New This Month"})]}),a.jsxs("div",{className:"bg-blue-50 rounded-xl border border-blue-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-blue-700",children:I.returningThisMonth}),a.jsx("div",{className:"text-xs font-medium text-blue-600 mt-0.5",children:"Returning This Month"})]}),a.jsxs("div",{className:"bg-violet-50 rounded-xl border border-violet-100 p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-extrabold text-violet-700",children:I.avgBookingsPerClient.toFixed(1)}),a.jsx("div",{className:"text-xs font-medium text-violet-600 mt-0.5",children:"Avg Bookings / Client"})]})]}),a.jsx("h4",{className:"text-sm font-bold text-slate-700 mb-3",children:"Top Clients by Frequency"}),I.topClients.length===0?a.jsxs("div",{className:"text-center py-6",children:[a.jsx(_l,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-400",children:"No client data yet"})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:I.topClients.map((B,P)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center text-amber-700 font-bold text-xs flex-shrink-0",children:P+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:B.name}),a.jsx("div",{className:"text-xs text-slate-400 truncate",children:B.email})]}),a.jsxs("div",{className:"flex-shrink-0 px-2.5 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-bold",children:[B.count," visit",B.count!==1?"s":""]})]},B.email))})]})]})}function rS({waitingAhead:n=[],inProgress:e=[],staffCount:t=1,upcomingBookings:i=[],defaultDuration:o=30}){const c=Math.max(t,1),d=Date.now(),p=e.map(b=>{const w=b.startedAt?.toDate?.()||(b.startedAt?new Date(b.startedAt):null);if(!w)return 0;const _=(d-w.getTime())/6e4,A=b.estimatedDuration||o;return Math.max(0,A-_)});p.sort((b,w)=>b-w);const x=[];for(let b=0;b<c;b++)x.push(p[b]||0);x.sort((b,w)=>b-w);const g=n.map(b=>b.estimatedDuration||o);for(const b of g)x[0]+=b,x.sort((w,_)=>w-_);return Math.round(x[0])}function iS({waitingQueue:n=[],inProgress:e=[],staffCount:t=1,upcomingBookings:i=[],defaultDuration:o=30}){const c=new Map;for(let d=0;d<n.length;d++){const p=n.slice(0,d),x=rS({waitingAhead:p,inProgress:e,staffCount:t,upcomingBookings:i,defaultDuration:o});c.set(n[d].id,x)}return c}function b9(n=[],e=3){const t=new Date,i=new Date(t.getTime()+e*60*60*1e3),o=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return n.filter(c=>{if(c.status==="cancelled"||c.status==="rejected"||c.date!==o)return!1;const d=new Date(`${c.date}T${c.time}`);return d>=t&&d<=i}).sort((c,d)=>`${c.time}`.localeCompare(`${d.time}`))}function y9(n){if(!n)return"0m";const e=n?.toDate?.()||new Date(n),t=Math.floor((Date.now()-e.getTime())/6e4);if(t<1)return"<1m";if(t<60)return`${t}m`;const i=Math.floor(t/60),o=t%60;return o>0?`${i}h ${o}m`:`${i}h`}function v9(n){if(n==null)return"";if(n<1)return"Next up";if(n<60)return`~${n}m`;const e=Math.floor(n/60),t=n%60;return t>0?`~${e}h ${t}m`:`~${e}h`}function w9({shopId:n,services:e,staff:t,bookings:i}){const[o,c]=j.useState([]),[d,p]=j.useState(!1),[x,g]=j.useState(!1),[b,w]=j.useState(!1),[_,A]=j.useState({clientName:"",serviceId:"",staffId:"",estimatedDuration:30});j.useEffect(()=>{if(!n)return;const P=Gt(Je(we,"shops",n,"walkins"),O=>{const K=O.docs.map(oe=>({id:oe.id,...oe.data()}));c(K)});return()=>P()},[n]);const L=j.useMemo(()=>o.filter(P=>P.status==="waiting").sort((P,O)=>(P.position||0)-(O.position||0)),[o]),V=j.useMemo(()=>o.filter(P=>P.status==="in-progress").sort((P,O)=>{const K=P.startedAt?.toDate?.()?.getTime()||0,oe=O.startedAt?.toDate?.()?.getTime()||0;return K-oe}),[o]),F=j.useMemo(()=>{const P=new Date;return P.setHours(0,0,0,0),P},[]),q=j.useMemo(()=>o.filter(P=>{if(P.status!=="completed"&&P.status!=="no-show")return!1;const O=P.completedAt?.toDate?.()||(P.completedAt?new Date(P.completedAt):null);return O?O>=F:!1}).sort((P,O)=>{const K=P.completedAt?.toDate?.()?.getTime()||0;return(O.completedAt?.toDate?.()?.getTime()||0)-K}),[o,F]),Q=j.useMemo(()=>Math.max(t.filter(P=>P.active!==!1).length,1),[t]),H=j.useMemo(()=>b9(i,3),[i]),ie=j.useMemo(()=>iS({waitingQueue:L,inProgress:V,staffCount:Q,upcomingBookings:H,defaultDuration:30}),[L,V,Q,H]),le=j.useMemo(()=>{const P=q.filter(K=>K.status==="completed"&&K.joinedAt&&K.startedAt).map(K=>{const oe=K.joinedAt?.toDate?.()||new Date(K.joinedAt),be=K.startedAt?.toDate?.()||new Date(K.startedAt);return Math.floor((be.getTime()-oe.getTime())/6e4)}).filter(K=>K>=0),O=P.length>0?Math.round(P.reduce((K,oe)=>K+oe,0)/P.length):0;return{waiting:L.length,avgWait:O,completedToday:q.filter(K=>K.status==="completed").length}},[L,q]),Y=P=>{const O=e.find(K=>K.id===P);A(K=>({...K,serviceId:P,estimatedDuration:O?.duration||30}))},T=()=>L.length===0?1:Math.max(...L.map(P=>P.position||0))+1,E=j.useMemo(()=>o.filter(P=>{const O=P.joinedAt?.toDate?.()||(P.joinedAt?new Date(P.joinedAt):null);return O&&O>=F}).length,[o,F]),S=async P=>{P.preventDefault(),w(!0);const O=e.find(fe=>fe.id===_.serviceId),K=t.find(fe=>fe.id===_.staffId),oe=T(),be=_.clientName.trim()||`Walk-in #${E+1}`;try{await _a(Je(we,"shops",n,"walkins"),{clientName:be,serviceId:_.serviceId||null,serviceName:O?.name||null,staffId:_.staffId||null,staffName:K?.name||null,estimatedDuration:parseInt(_.estimatedDuration)||30,status:"waiting",position:oe,joinedAt:It.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),A({clientName:"",serviceId:"",staffId:"",estimatedDuration:30}),p(!1)}catch(fe){console.error("Error adding walk-in:",fe)}finally{w(!1)}},I=async P=>{try{await tt(Ge(we,"shops",n,"walkins",P),{status:"in-progress",startedAt:It.now()});const O=L.filter(K=>K.id!==P).sort((K,oe)=>(K.position||0)-(oe.position||0));for(let K=0;K<O.length;K++)await tt(Ge(we,"shops",n,"walkins",O[K].id),{position:K+1})}catch(O){console.error("Error starting service:",O)}},C=async P=>{try{await tt(Ge(we,"shops",n,"walkins",P),{status:"completed",completedAt:It.now()})}catch(O){console.error("Error completing service:",O)}},M=async P=>{try{await tt(Ge(we,"shops",n,"walkins",P),{status:"no-show",completedAt:It.now()});const O=L.filter(K=>K.id!==P).sort((K,oe)=>(K.position||0)-(oe.position||0));for(let K=0;K<O.length;K++)await tt(Ge(we,"shops",n,"walkins",O[K].id),{position:K+1})}catch(O){console.error("Error marking no-show:",O)}},R=async P=>{const O=L.findIndex(be=>be.id===P);if(O<=0)return;const K=L[O-1],oe=L[O];try{await tt(Ge(we,"shops",n,"walkins",oe.id),{position:K.position}),await tt(Ge(we,"shops",n,"walkins",K.id),{position:oe.position})}catch(be){console.error("Error reordering:",be)}},B=async P=>{const O=L.findIndex(be=>be.id===P);if(O<0||O>=L.length-1)return;const K=L[O+1],oe=L[O];try{await tt(Ge(we,"shops",n,"walkins",oe.id),{position:K.position}),await tt(Ge(we,"shops",n,"walkins",K.id),{position:oe.position})}catch(be){console.error("Error reordering:",be)}};return a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[{label:"Currently Waiting",value:le.waiting,icon:Dt,color:"bg-blue-100 text-blue-600"},{label:"Avg Wait",value:le.avgWait>0?`${le.avgWait}m`:"",icon:z2,color:"bg-amber-100 text-amber-600"},{label:"Completed Today",value:le.completedToday,icon:Bo,color:"bg-emerald-100 text-emerald-600"}].map(P=>{const O=P.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${P.color} rounded-xl flex items-center justify-center`,children:a.jsx(O,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:P.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:P.label})]},P.label)})}),H.length>0&&a.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ta,{className:"w-4 h-4 text-amber-600"}),a.jsx("span",{className:"text-sm font-bold text-amber-800",children:"Upcoming Online Bookings"})]}),a.jsx("div",{className:"space-y-1",children:H.slice(0,5).map(P=>{const[O,K]=(P.time||"").split(":"),oe=parseInt(O),be=`${oe%12||12}:${K} ${oe>=12?"PM":"AM"}`;return a.jsxs("div",{className:"text-xs text-amber-700 flex items-center gap-2",children:[a.jsx(Zt,{className:"w-3 h-3"}),a.jsx("span",{className:"font-medium",children:be}),a.jsx("span",{children:""}),a.jsx("span",{children:P.clientName}),P.serviceName&&a.jsxs("span",{className:"text-amber-500",children:["(",P.serviceName,")"]}),P.staffName&&a.jsxs("span",{className:"text-violet-600",children:["with ",P.staffName]})]},P.id)})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Walk-in Queue"}),!d&&a.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[a.jsx(Ja,{className:"w-4 h-4"}),"Add Walk-in"]})]}),d&&a.jsxs("form",{onSubmit:S,className:"mb-5 p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3",children:"New Walk-in"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Client Name"}),a.jsx("input",{type:"text",value:_.clientName,onChange:P=>A(O=>({...O,clientName:P.target.value})),placeholder:`Walk-in #${E+1}`,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Service"}),a.jsxs("select",{value:_.serviceId,onChange:P=>Y(P.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"No service selected"}),e.map(P=>a.jsxs("option",{value:P.id,children:[P.name," (",P.duration,"min)"]},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Staff Preference"}),a.jsxs("select",{value:_.staffId,onChange:P=>A(O=>({...O,staffId:P.target.value})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"Next available"}),t.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Est. Duration (min)"}),a.jsx("select",{value:_.estimatedDuration,onChange:P=>A(O=>({...O,estimatedDuration:parseInt(P.target.value)})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[15,30,45,60,90,120].map(P=>a.jsx("option",{value:P,children:P<60?`${P} min`:`${P/60}h${P%60?` ${P%60}m`:""}`},P))})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{type:"submit",disabled:b,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[a.jsx(Ja,{className:"w-4 h-4"}),b?"Adding":"Add to Queue"]}),a.jsx("button",{type:"button",onClick:()=>{p(!1),A({clientName:"",serviceId:"",staffId:"",estimatedDuration:30})},className:"px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Cancel"})]})]}),L.length===0&&V.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Dt,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No walk-ins in queue"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Add a walk-in client to start the queue."})]}):a.jsxs(a.Fragment,{children:[L.length>0&&a.jsxs("div",{className:"mb-5",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx(Zt,{className:"w-4 h-4 text-blue-500"}),"Waiting",a.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:L.length})]}),a.jsx("div",{className:"space-y-2",children:L.map((P,O)=>{const K=ie.get(P.id);return a.jsxs("div",{className:"group flex items-center gap-3 border border-slate-200 rounded-xl p-3.5 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[a.jsx("button",{onClick:()=>R(P.id),disabled:O===0,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:a.jsx(rx,{className:"w-4 h-4"})}),a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center font-bold text-blue-700 text-sm",children:O+1}),a.jsx("button",{onClick:()=>B(P.id),disabled:O===L.length-1,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:a.jsx(Iu,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:P.clientName}),a.jsx("span",{className:"px-2 py-0.5 bg-blue-50 text-blue-600 border border-blue-200 text-[10px] font-bold rounded-md",children:"WAITING"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[P.serviceName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nn,{className:"w-3 h-3 text-blue-400"}),P.serviceName]}),P.staffName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(_l,{className:"w-3 h-3 text-violet-400"}),P.staffName]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Zt,{className:"w-3 h-3"}),P.estimatedDuration||30,"min"]})]})]}),a.jsxs("div",{className:"text-right mr-2",children:[a.jsx("div",{className:"text-sm font-bold text-amber-600",children:v9(K)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"est. wait"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs("button",{onClick:()=>I(P.id),className:"flex items-center gap-1 px-3 py-2 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 border border-emerald-200 rounded-lg text-xs font-semibold transition-all",title:"Start Service",children:[a.jsx(_0,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Start"})]}),a.jsxs("button",{onClick:()=>M(P.id),className:"flex items-center gap-1 px-3 py-2 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all",title:"No-show",children:[a.jsx($a,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"No-show"})]})]})]},P.id)})})]}),V.length>0&&a.jsxs("div",{className:"mb-5",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[a.jsx(_0,{className:"w-4 h-4 text-emerald-500"}),"In Progress",a.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 border border-emerald-200 text-xs font-bold rounded-full",children:V.length})]}),a.jsx("div",{className:"space-y-2",children:V.map(P=>a.jsxs("div",{className:"flex items-center gap-3 border border-emerald-200 bg-emerald-50/50 rounded-xl p-3.5 transition-all",children:[a.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center",children:a.jsx(_0,{className:"w-4 h-4 text-emerald-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:P.clientName}),a.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 text-[10px] font-bold rounded-md",children:"IN PROGRESS"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[P.serviceName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nn,{className:"w-3 h-3 text-blue-400"}),P.serviceName]}),P.staffName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(_l,{className:"w-3 h-3 text-violet-400"}),P.staffName]})]})]}),a.jsxs("div",{className:"text-right mr-2",children:[a.jsx("div",{className:"text-sm font-bold text-emerald-600",children:y9(P.startedAt)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"elapsed"})]}),a.jsxs("button",{onClick:()=>C(P.id),className:"flex items-center gap-1 px-3 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 rounded-lg text-xs font-semibold transition-all",title:"Complete",children:[a.jsx(Rs,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"Complete"})]})]},P.id))})]})]})]}),q.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("button",{onClick:()=>g(!x),className:"w-full flex items-center justify-between",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[a.jsx(Rs,{className:"w-4 h-4 text-slate-400"}),"Completed Today",a.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-500 border border-slate-200 text-xs font-bold rounded-full",children:q.length})]}),a.jsx(Ku,{className:`w-4 h-4 text-slate-400 transition-transform ${x?"rotate-90":""}`})]}),x&&a.jsx("div",{className:"mt-3 space-y-2",children:q.map(P=>a.jsxs("div",{className:"flex items-center gap-3 border border-slate-100 rounded-lg p-3 bg-slate-50/50",children:[a.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center bg-slate-100",children:P.status==="no-show"?a.jsx($a,{className:"w-3.5 h-3.5 text-red-400"}):a.jsx(Rs,{className:"w-3.5 h-3.5 text-emerald-400"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-700 text-sm truncate",children:P.clientName}),a.jsx("span",{className:`text-[10px] font-bold rounded-md px-1.5 py-0.5 border ${P.status==="no-show"?"bg-red-50 text-red-600 border-red-200":"bg-emerald-50 text-emerald-600 border-emerald-200"}`,children:P.status==="no-show"?"NO-SHOW":"COMPLETED"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[P.serviceName&&a.jsx("span",{children:P.serviceName}),P.staffName&&a.jsxs("span",{children:[" ",P.staffName]})]})]})]},P.id))})]})]})}function N9(n,e){const t=new Date(n+"T12:00:00"),i=e.getTime()-t.getTime();return Math.floor(i/864e5)}function Ch(n){return`$${Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function nu(n){return n?new Date(n+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function _9(n,e,t){return n>90?"lost":n>t?"at-risk":n>e?"getting-cold":"active"}const Rh={active:{label:"Active",bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200",icon:Sg,iconColor:"text-emerald-500"},"getting-cold":{label:"Getting Cold",bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",icon:B2,iconColor:"text-amber-500"},"at-risk":{label:"At Risk",bg:"bg-orange-50",text:"text-orange-700",border:"border-orange-200",icon:ta,iconColor:"text-orange-500"},lost:{label:"Lost",bg:"bg-red-50",text:"text-red-700",border:"border-red-200",icon:QD,iconColor:"text-red-500"}};function j9({shopId:n,bookings:e,shop:t,slug:i}){const[o,c]=j.useState({}),[d,p]=j.useState(null),[x,g]=j.useState(null),[b,w]=j.useState(""),[_,A]=j.useState(""),[L,V]=j.useState("all"),[F,q]=j.useState("lastVisit"),[Q,H]=j.useState("asc"),[ie,le]=j.useState(null),[Y,T]=j.useState(!1),[E,S]=j.useState(null),[I,C]=j.useState(!1),[M,R]=j.useState(null),B=t?.winbackSettings?.warningDays||30,P=t?.winbackSettings?.inactiveDays||60,O=t?.winbackSettings?.enabled!==!1,K=ne=>ne.toLowerCase().replace(/\./g,"_dot_").replace(/@/g,"_at_");j.useEffect(()=>{if(!n)return;const ne=Gt(Je(we,"shops",n,"clientNotes"),Te=>{const W={};Te.docs.forEach(ye=>{W[ye.id]=ye.data()}),c(W)});return()=>ne()},[n]);const oe=j.useMemo(()=>new Date,[]),be=j.useMemo(()=>e.filter(ne=>ne.status==="confirmed"||ne.status==="pending"||!ne.status),[e]),fe=j.useMemo(()=>{const ne={};return be.forEach(Te=>{const W=Te.clientEmail?.toLowerCase();if(!W)return;ne[W]||(ne[W]={email:W,name:Te.clientName||W,phone:Te.clientPhone||"",totalVisits:0,totalSpent:0,lastVisitDate:null,firstVisitDate:null,bookings:[],serviceFrequency:{},staffFrequency:{}});const ye=ne[W];Te.clientName&&(ye.name=Te.clientName),Te.clientPhone&&(ye.phone=Te.clientPhone),ye.totalVisits++,ye.totalSpent+=Number(Te.servicePrice)||0,ye.bookings.push(Te),(!ye.lastVisitDate||Te.date>ye.lastVisitDate)&&(ye.lastVisitDate=Te.date),(!ye.firstVisitDate||Te.date<ye.firstVisitDate)&&(ye.firstVisitDate=Te.date),Te.serviceName&&(ye.serviceFrequency[Te.serviceName]=(ye.serviceFrequency[Te.serviceName]||0)+1),Te.staffName&&(ye.staffFrequency[Te.staffName]=(ye.staffFrequency[Te.staffName]||0)+1)}),Object.values(ne).map(Te=>{const W=Te.lastVisitDate?N9(Te.lastVisitDate,oe):999,ye=_9(W,B,P),Ae=Object.entries(Te.serviceFrequency).sort((Ce,Le)=>Le[1]-Ce[1])[0]?.[0]||null,Ve=Object.entries(Te.staffFrequency).sort((Ce,Le)=>Le[1]-Ce[1])[0]?.[0]||null,xt=Te.totalVisits>0?Te.totalSpent/Te.totalVisits:0,it=K(Te.email),rt=o[it];return{...Te,daysSinceLastVisit:W,status:ye,favoriteService:Ae,favoriteStaff:Ve,avgSpending:xt,encodedEmail:it,notes:rt?.notes||"",contacted:rt?.contacted||!1,contactedAt:rt?.contactedAt||null,tags:rt?.tags||[]}})},[be,oe,B,P,o]),U=j.useMemo(()=>{const ne={all:fe.length,active:0,"getting-cold":0,"at-risk":0,lost:0};return fe.forEach(Te=>{ne[Te.status]++}),ne},[fe]),Z=j.useMemo(()=>fe.filter(ne=>(ne.status==="at-risk"||ne.status==="lost")&&!ne.contacted),[fe]),ue=j.useMemo(()=>{let ne=fe;if(_.trim()){const Te=_.toLowerCase();ne=ne.filter(W=>W.name.toLowerCase().includes(Te)||W.email.includes(Te)||W.phone.includes(Te))}return L!=="all"&&(ne=ne.filter(Te=>Te.status===L)),ne=[...ne].sort((Te,W)=>{if(F==="lastVisit"){const ye=(Te.lastVisitDate||"").localeCompare(W.lastVisitDate||"");return Q==="asc"?ye:-ye}return F==="totalVisits"?Q==="desc"?W.totalVisits-Te.totalVisits:Te.totalVisits-W.totalVisits:F==="totalSpent"?Q==="desc"?W.totalSpent-Te.totalSpent:Te.totalSpent-W.totalSpent:0}),ne},[fe,_,L,F,Q]),me=ne=>{F===ne?H(Te=>Te==="asc"?"desc":"asc"):(q(ne),H(ne==="lastVisit"?"asc":"desc"))},ge=j.useCallback(ne=>{const Te=t?.name||"our shop",W=`${window.location.origin}${window.location.pathname}#/shop/${i}`;return`Hi ${ne.name.split(" ")[0]}, we miss you at ${Te}! It's been ${ne.daysSinceLastVisit} days since your last visit.${ne.favoriteService?` Book your next ${ne.favoriteService} today:`:" Book your next appointment:"} ${W}`},[t,i]),De=ne=>{const Te=ge(ne);S({email:ne.email,encodedEmail:ne.encodedEmail,name:ne.name,message:Te})},Ye=async(ne,Te)=>{try{await navigator.clipboard.writeText(ne),le(Te),setTimeout(()=>le(null),2e3)}catch(W){console.error("Failed to copy:",W)}},pt=async ne=>{R(ne);try{const Te=Ge(we,"shops",n,"clientNotes",ne),W=await y0(Te),ye=W.exists()?W.data():{};await v0(Te,{...ye,contacted:!0,contactedAt:new Date().toISOString()}),S(null)}catch(Te){console.error("Error marking as contacted:",Te)}finally{R(null)}},dt=async ne=>{try{const Te=Ge(we,"shops",n,"clientNotes",ne),W=await y0(Te),ye=W.exists()?W.data():{};await v0(Te,{...ye,contacted:!1,contactedAt:null})}catch(Te){console.error("Error resetting contacted status:",Te)}},Wt=async ne=>{C(!0);try{const Te=Ge(we,"shops",n,"clientNotes",ne),W=await y0(Te),ye=W.exists()?W.data():{};await v0(Te,{...ye,notes:b}),g(null)}catch(Te){console.error("Error saving notes:",Te)}finally{C(!1)}};return a.jsxs("div",{className:"animate-fade-in space-y-6",children:[O&&Z.length>0&&a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>T(!Y),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:a.jsx(ta,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[Z.length," client",Z.length!==1?"s":""," need",Z.length===1?"s":""," attention"]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Haven't visited in over ",P," days  send a win-back message to re-engage"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-2.5 py-1 bg-orange-100 text-orange-700 border border-orange-200 text-xs font-bold rounded-lg",children:Z.length}),Y?a.jsx(rx,{className:"w-5 h-5 text-slate-400"}):a.jsx(Iu,{className:"w-5 h-5 text-slate-400"})]})]}),Y&&a.jsx("div",{className:"mt-4 space-y-2.5",children:Z.sort((ne,Te)=>Te.daysSinceLastVisit-ne.daysSinceLastVisit).map(ne=>a.jsxs("div",{className:"bg-white rounded-xl border border-orange-100 p-4 flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx("div",{className:"w-9 h-9 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(_l,{className:"w-4 h-4 text-orange-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:ne.name}),a.jsxs("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Rh[ne.status].bg} ${Rh[ne.status].text} ${Rh[ne.status].border}`,children:[ne.daysSinceLastVisit," days ago"]})]}),a.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 flex-wrap mt-0.5",children:[a.jsxs("span",{children:["Last: ",nu(ne.lastVisitDate)]}),ne.favoriteService&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-slate-300",children:""}),a.jsxs("span",{className:"text-blue-600",children:["Loves ",ne.favoriteService]})]}),a.jsx("span",{className:"text-slate-300",children:""}),a.jsxs("span",{children:[ne.totalVisits," visit",ne.totalVisits!==1?"s":""]})]})]})]}),a.jsxs("button",{onClick:Te=>{Te.stopPropagation(),De(ne)},className:"flex items-center gap-1.5 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-xl text-xs font-semibold transition-all shadow-sm flex-shrink-0",children:[a.jsx(Gh,{className:"w-3.5 h-3.5"}),"Send Win-back"]})]},ne.email))})]}),E&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:a.jsx(ox,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Win-back Message"}),a.jsxs("p",{className:"text-sm text-slate-500",children:["Send to ",E.name]})]})]}),a.jsx("div",{className:"bg-slate-50 rounded-xl p-4 mb-4 border border-slate-200",children:a.jsx("textarea",{value:E.message,onChange:ne=>S({...E,message:ne.target.value}),rows:4,className:"w-full bg-transparent text-sm text-slate-700 resize-none focus:outline-none leading-relaxed"})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{Ye(E.message,E.email)},className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:ie===E.email?a.jsxs(a.Fragment,{children:[a.jsx(Ks,{className:"w-4 h-4"}),"Copied!"]}):a.jsxs(a.Fragment,{children:[a.jsx(O2,{className:"w-4 h-4"}),"Copy to Clipboard"]})}),a.jsxs("button",{onClick:()=>pt(E.encodedEmail),disabled:M===E.encodedEmail,className:"flex items-center justify-center gap-2 px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-emerald-600/20 disabled:opacity-50",children:[a.jsx(Ks,{className:"w-4 h-4"}),"Mark Contacted"]}),a.jsx("button",{onClick:()=>S(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Close"})]})]})}),a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Clients",value:U.all,icon:Dt,color:"bg-blue-100 text-blue-600"},{label:"Active",value:U.active,icon:Sg,color:"bg-emerald-100 text-emerald-600"},{label:"Getting Cold",value:U["getting-cold"],icon:B2,color:"bg-amber-100 text-amber-600"},{label:"At Risk / Lost",value:U["at-risk"]+U.lost,icon:ta,color:"bg-red-100 text-red-600"}].map(ne=>{const Te=ne.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${ne.color} rounded-xl flex items-center justify-center`,children:a.jsx(Te,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:ne.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:ne.label})]},ne.label)})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Clients"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Derived from booking history"})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[ue.length," client",ue.length!==1?"s":""]})]}),a.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[a.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[a.jsx(Hh,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2"}),a.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:_,onChange:ne=>A(ne.target.value),className:"w-full pl-10 pr-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),_&&a.jsx("button",{onClick:()=>A(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:a.jsx(Ds,{className:"w-4 h-4 text-slate-400 hover:text-slate-600"})})]}),a.jsx("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl overflow-x-auto",children:[{key:"all",label:"All"},{key:"active",label:"Active"},{key:"getting-cold",label:"Cold"},{key:"at-risk",label:"At Risk"},{key:"lost",label:"Lost"}].map(ne=>a.jsxs("button",{onClick:()=>V(ne.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap ${L===ne.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[ne.label,a.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${L===ne.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:U[ne.key]??0})]},ne.key))}),a.jsx("div",{className:"flex items-center gap-1",children:[{key:"lastVisit",label:"Last Visit"},{key:"totalVisits",label:"Visits"},{key:"totalSpent",label:"Spent"}].map(ne=>a.jsxs("button",{onClick:()=>me(ne.key),className:`flex items-center gap-1 px-3 py-2 rounded-lg text-xs font-semibold transition-all border ${F===ne.key?"bg-blue-50 text-blue-700 border-blue-200":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[ne.label,F===ne.key&&a.jsx(mD,{className:"w-3 h-3"})]},ne.key))})]}),ue.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Dt,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No clients found"}),a.jsx("p",{className:"text-xs text-slate-400",children:_?"Try a different search term":"Client data will appear as bookings come in"})]}):a.jsx("div",{className:"space-y-2",children:ue.map(ne=>{const Te=d===ne.email,W=Rh[ne.status],ye=W.icon;return a.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden hover:border-slate-300 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 cursor-pointer hover:bg-slate-50/50 transition-all",onClick:()=>p(Te?null:ne.email),children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(_l,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:ne.name}),a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-bold rounded-md border ${W.bg} ${W.text} ${W.border}`,children:[a.jsx(ye,{className:"w-3 h-3"}),W.label]}),ne.contacted&&a.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",children:[a.jsx(Gh,{className:"w-2.5 h-2.5"}),"Contacted"]}),ne.notes&&a.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-violet-50 text-violet-600 border-violet-200",children:a.jsx(Z1,{className:"w-2.5 h-2.5"})})]}),a.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-3 mt-0.5 flex-wrap",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nf,{className:"w-3 h-3"}),ne.email]}),ne.phone&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(cx,{className:"w-3 h-3"}),ne.phone]})]})]}),a.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-shrink-0",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900",children:ne.totalVisits}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-blue-600",children:Ch(ne.totalSpent)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-700",children:nu(ne.lastVisitDate)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(ne.status==="at-risk"||ne.status==="lost")&&!ne.contacted&&a.jsx("button",{onClick:Ae=>{Ae.stopPropagation(),De(ne)},className:"p-2 text-orange-500 hover:text-orange-700 hover:bg-orange-50 rounded-lg transition-all",title:"Send win-back message",children:a.jsx(Gh,{className:"w-4 h-4"})}),Te?a.jsx(rx,{className:"w-4 h-4 text-slate-400"}):a.jsx(Iu,{className:"w-4 h-4 text-slate-400"})]})]}),Te&&a.jsxs("div",{className:"border-t border-slate-200 bg-slate-50/50 p-5 space-y-5",children:[a.jsxs("div",{className:"sm:hidden grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-slate-900",children:ne.totalVisits}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-lg font-bold text-blue-600",children:Ch(ne.totalSpent)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[a.jsx("div",{className:"text-sm font-bold text-slate-700",children:nu(ne.lastVisitDate)}),a.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Avg per Visit"}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:Ch(ne.avgSpending)})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"First Visit"}),a.jsx("div",{className:"text-sm font-bold text-slate-900",children:nu(ne.firstVisitDate)})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Days Since Last Visit"}),a.jsxs("div",{className:"text-sm font-bold text-slate-900",children:[ne.daysSinceLastVisit,"d"]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[a.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Favorite Service"}),a.jsx("div",{className:"text-sm font-bold text-blue-600 truncate",children:ne.favoriteService||""})]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Nn,{className:"w-3.5 h-3.5 text-blue-500"}),"Services Used"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(ne.serviceFrequency).sort((Ae,Ve)=>Ve[1]-Ae[1]).map(([Ae,Ve])=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg text-xs font-medium",children:[Ae,a.jsxs("span",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[Ve,""]})]},Ae))})]}),Object.keys(ne.staffFrequency).length>0&&a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Dt,{className:"w-3.5 h-3.5 text-violet-500"}),"Staff Members Seen"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(ne.staffFrequency).sort((Ae,Ve)=>Ve[1]-Ae[1]).map(([Ae,Ve])=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-violet-50 text-violet-700 border border-violet-200 rounded-lg text-xs font-medium",children:[Ae,a.jsxs("span",{className:"bg-violet-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[Ve,""]})]},Ae))})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[a.jsx(Et,{className:"w-3.5 h-3.5 text-emerald-500"}),"Booking History",a.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",ne.bookings.length,")"]})]}),a.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:ne.bookings.sort((Ae,Ve)=>(Ve.date+Ve.time).localeCompare(Ae.date+Ae.time)).map((Ae,Ve)=>a.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded-lg hover:bg-slate-50 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-slate-700",children:nu(Ae.date)}),a.jsx("span",{className:"text-slate-400",children:Ae.time}),Ae.serviceName&&a.jsx("span",{className:"text-blue-600",children:Ae.serviceName})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[Ae.staffName&&a.jsx("span",{className:"text-violet-600",children:Ae.staffName}),Ae.servicePrice!=null&&a.jsx("span",{className:"font-semibold text-slate-900",children:Ch(Ae.servicePrice)})]})]},Ve))})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h4",{className:"text-sm font-bold text-slate-700 flex items-center gap-1.5",children:[a.jsx(Z1,{className:"w-3.5 h-3.5 text-amber-500"}),"Notes"]}),x!==ne.encodedEmail&&a.jsx("button",{onClick:()=>{g(ne.encodedEmail),w(ne.notes||"")},className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:ne.notes?"Edit":"Add Notes"})]}),x===ne.encodedEmail?a.jsxs("div",{className:"space-y-2",children:[a.jsx("textarea",{value:b,onChange:Ae=>w(Ae.target.value),placeholder:"Add notes about this client (e.g., preferences, allergies, favorite styles...)",rows:3,className:"w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>Wt(ne.encodedEmail),disabled:I,className:"px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:I?"Saving...":"Save"}),a.jsx("button",{onClick:()=>g(null),className:"px-4 py-1.5 bg-white hover:bg-slate-50 text-slate-600 border border-slate-200 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}):a.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:ne.notes||'No notes yet. Click "Add Notes" to save preferences, allergies, or anything useful.'})]}),ne.contacted&&a.jsxs("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[a.jsx(Ks,{className:"w-4 h-4"}),a.jsxs("span",{className:"font-medium",children:["Contacted",ne.contactedAt?` on ${new Date(ne.contactedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`:""]})]}),a.jsx("button",{onClick:()=>dt(ne.encodedEmail),className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:"Reset"})]})]})]},ne.email)})})]})]})}const vN="https://us-central1-scheduler-65e51.cloudfunctions.net",S9={pro:"price_1Sxx7ILhwB1Jyzw8UvRxE5FT",unlimited:"price_1Sxx7JLhwB1Jyzw8uw9BRYhO"},E9={basicBooking:Et,emailNotifications:ox,aiAssistant:vD,recurringBookings:Zt,waitlist:Dt,crm:Dt,analytics:_g,smsNotifications:ox,customBranding:vM,walkIns:F2,multiLocation:hM,noBranding:U2,apiAccess:BD,prioritySupport:tM};function T9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState(e),[c,d]=j.useState(!1),[p,x]=j.useState(null),[g,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;const H=Gt(Ge(we,"shops",n),ie=>{ie.exists()&&o(ie.data())});return()=>H()},[n]);const w=i?.subscriptionTier||"free",_=wr[w],A=i?.subscriptionStatus,L=i?.subscriptionEndsAt,V=H=>H?(H.toDate?H.toDate():new Date(H)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):null,F=async H=>{d(H),x(null);try{const ie=await fetch(`${vN}/createCheckoutSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,priceId:S9[H],successUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?subscription=canceled`})}),le=await ie.json();if(!ie.ok)throw new Error(le.error||"Failed to create checkout session");window.location.href=le.url}catch(ie){console.error("Upgrade error:",ie),x(ie.message),d(null)}},q=async()=>{b(!0),x(null);try{const H=await fetch(`${vN}/createBillingPortalSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,returnUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard`})}),ie=await H.json();if(!H.ok)throw new Error(ie.error||"Failed to open billing portal");window.location.href=ie.url}catch(H){console.error("Billing portal error:",H),x(H.message),b(!1)}},Q=[{key:"free",name:"Free",price:"$0",period:"forever",description:"Perfect for getting started",color:"slate",features:[{key:"staff",text:"1 staff member"},{key:"basicBooking",text:"Online booking"},{key:"emailNotifications",text:"Email notifications"},{key:"fee",text:"5% platform fee on deposits",negative:!0}]},{key:"pro",name:"Pro",price:"$29",period:"/month",description:"For growing businesses",color:"blue",popular:!0,features:[{key:"staff",text:"Up to 5 staff members"},{key:"basicBooking",text:"Online booking"},{key:"emailNotifications",text:"Email notifications"},{key:"aiAssistant",text:"AI booking assistant"},{key:"recurringBookings",text:"Recurring bookings"},{key:"waitlist",text:"Waitlist management"},{key:"crm",text:"Client CRM & notes"},{key:"analytics",text:"Analytics dashboard"},{key:"smsNotifications",text:"SMS notifications"},{key:"fee",text:"No platform fees",highlight:!0}]},{key:"unlimited",name:"Unlimited",price:"$79",period:"/month",description:"For established businesses",color:"violet",features:[{key:"staff",text:"Unlimited staff members"},{key:"everything",text:"Everything in Pro, plus:"},{key:"walkIns",text:"Walk-in queue management"},{key:"multiLocation",text:"Multi-location support"},{key:"noBranding",text:"Remove SpotBookie branding"},{key:"apiAccess",text:"API access"},{key:"prioritySupport",text:"Priority support"}]}];return a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:`rounded-2xl p-6 mb-8 ${w==="unlimited"?"bg-gradient-to-r from-violet-500 to-purple-600":w==="pro"?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gradient-to-r from-slate-600 to-slate-700"}`,children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:a.jsx(Uo,{className:"w-7 h-7 text-white"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("h2",{className:"text-xl font-bold text-white",children:[_.name," Plan"]}),A==="past_due"&&a.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full",children:"Payment Failed"}),L&&a.jsx("span",{className:"px-2 py-0.5 bg-amber-500 text-white text-xs font-bold rounded-full",children:"Canceling"})]}),a.jsx("p",{className:"text-white/80 text-sm mt-0.5",children:w==="free"?"Upgrade to unlock more features":L?`Access until ${V(L)}`:"Your subscription is active"})]})]}),w!=="free"&&a.jsxs("button",{onClick:q,disabled:g,className:"flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 text-white rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[g?a.jsx(ea,{className:"w-4 h-4 animate-spin"}):a.jsx(xl,{className:"w-4 h-4"}),"Manage Billing"]})]})}),p&&a.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[a.jsx(Du,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800",children:"Something went wrong"}),a.jsx("p",{className:"text-sm text-red-600",children:p})]})]}),A==="past_due"&&a.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl flex items-start gap-3",children:[a.jsx(Du,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-amber-800",children:"Payment Failed"}),a.jsx("p",{className:"text-sm text-amber-600",children:"Your last payment failed. Please update your payment method to keep your subscription active."}),a.jsx("button",{onClick:q,className:"mt-2 text-sm font-semibold text-amber-700 hover:text-amber-800 underline",children:"Update Payment Method "})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Q.map(H=>{const ie=H.key===w,le=["free","pro","unlimited"].indexOf(H.key)<["free","pro","unlimited"].indexOf(w),Y=!ie&&!le;return a.jsxs("div",{className:`relative bg-white rounded-2xl border-2 p-6 transition-all ${H.popular?"border-blue-500 shadow-lg shadow-blue-500/10":ie?"border-emerald-500":"border-slate-200 hover:border-slate-300"}`,children:[H.popular&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsx("span",{className:"px-3 py-1 bg-blue-500 text-white text-xs font-bold rounded-full",children:"Most Popular"})}),ie&&a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:a.jsx("span",{className:"px-3 py-1 bg-emerald-500 text-white text-xs font-bold rounded-full",children:"Current Plan"})}),a.jsxs("div",{className:"text-center mb-6 pt-2",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:H.name}),a.jsxs("div",{className:"mt-2 flex items-baseline justify-center gap-1",children:[a.jsx("span",{className:"text-4xl font-extrabold text-slate-900",children:H.price}),a.jsx("span",{className:"text-slate-500 text-sm",children:H.period})]}),a.jsx("p",{className:"text-sm text-slate-500 mt-2",children:H.description})]}),a.jsx("ul",{className:"space-y-3 mb-6",children:H.features.map((T,E)=>(E9[T.key],a.jsxs("li",{className:"flex items-start gap-2.5",children:[a.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5 ${T.negative?"bg-red-100 text-red-500":T.highlight?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-600"}`,children:T.negative?a.jsx("span",{className:"text-xs font-bold",children:"%"}):a.jsx(Ks,{className:"w-3 h-3"})}),a.jsx("span",{className:`text-sm ${T.negative?"text-red-600":T.highlight?"text-emerald-700 font-medium":"text-slate-700"}`,children:T.text})]},E)))}),Y?a.jsx("button",{onClick:()=>F(H.key),disabled:c,className:`w-full flex items-center justify-center gap-2 py-3 rounded-xl font-semibold text-sm transition-all ${H.key==="unlimited"?"bg-gradient-to-r from-violet-500 to-purple-600 hover:from-violet-600 hover:to-purple-700 text-white shadow-lg shadow-violet-500/20":H.key==="pro"?"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg shadow-blue-500/20":"bg-slate-100 hover:bg-slate-200 text-slate-700"} disabled:opacity-50`,children:c===H.key?a.jsxs(a.Fragment,{children:[a.jsx(ea,{className:"w-4 h-4 animate-spin"}),"Redirecting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Xo,{className:"w-4 h-4"}),"Upgrade to ",H.name]})}):ie?a.jsx("div",{className:"w-full py-3 text-center text-sm font-semibold text-emerald-600 bg-emerald-50 rounded-xl border border-emerald-200",children:" Your Current Plan"}):a.jsx("div",{className:"w-full py-3 text-center text-sm font-medium text-slate-400 bg-slate-50 rounded-xl",children:"Included in your plan"})]},H.key)})}),a.jsxs("div",{className:"mt-12",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Feature Comparison"}),a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Feature"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-slate-700",children:"Free"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-blue-600",children:"Pro"}),a.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-violet-600",children:"Unlimited"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b border-slate-100",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:"Staff Members"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"1"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"5"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-slate-600",children:"Unlimited"})]}),a.jsxs("tr",{className:"border-b border-slate-100",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:"Platform Fee"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-red-500",children:"5%"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-emerald-600",children:"0%"}),a.jsx("td",{className:"py-3 px-4 text-center text-sm text-emerald-600",children:"0%"})]}),Object.entries(a9).map(([H,ie])=>a.jsxs("tr",{className:"border-b border-slate-100 last:border-b-0",children:[a.jsx("td",{className:"py-3 px-6 text-sm text-slate-700",children:ie.name}),a.jsx("td",{className:"py-3 px-4 text-center",children:wr.free.features.includes(H)?a.jsx(Ks,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})}),a.jsx("td",{className:"py-3 px-4 text-center",children:wr.pro.features.includes(H)?a.jsx(Ks,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})}),a.jsx("td",{className:"py-3 px-4 text-center",children:wr.unlimited.features.includes(H)?a.jsx(Ks,{className:"w-5 h-5 text-emerald-500 mx-auto"}):a.jsx("span",{className:"text-slate-300",children:""})})]},H))]})]})})]}),a.jsxs("div",{className:"mt-12",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Frequently Asked Questions"}),a.jsx("div",{className:"space-y-4",children:[{q:"Can I cancel anytime?",a:"Yes! You can cancel your subscription at any time. You'll continue to have access until the end of your billing period."},{q:"What happens if I downgrade?",a:"When you downgrade, you'll keep your current plan until the end of the billing period. After that, feature limits (like staff count) will apply."},{q:"What is the platform fee?",a:"On the Free plan, we charge a 5% fee on any deposits collected through SpotBookie. Pro and Unlimited plans have no platform fees."},{q:"Do you offer refunds?",a:"We offer a 14-day money-back guarantee for first-time subscribers. Contact us if you're not satisfied."}].map((H,ie)=>a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:H.q}),a.jsx("p",{className:"text-sm text-slate-600",children:H.a})]},ie))})]})]})}const Ih="https://us-central1-scheduler-65e51.cloudfunctions.net";function A9({shopId:n,shop:e,slug:t}){const[i,o]=j.useState(e),[c,d]=j.useState(null),[p,x]=j.useState(null),[g,b]=j.useState(null);j.useEffect(()=>{if(!n)return;const Y=Gt(Ge(we,"shops",n),T=>{T.exists()&&o(T.data())});return()=>Y()},[n]);const w=!!i?.stripeAccountId,_=i?.stripeOnboardingComplete,A=i?.payoutsEnabled;i?.stripeAccountStatus;const L=i?.subscriptionTier||"free",V=L==="free"?"5%":"0%",F=async()=>{d("create"),x(null);try{const Y=await fetch(`${Ih}/createConnectAccount`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,email:i.ownerEmail,businessName:i.name})}),T=await Y.json();if(!Y.ok)throw new Error(T.error||"Failed to create account");(!T.alreadyExists||!i.stripeOnboardingComplete)&&await q()}catch(Y){console.error("Create account error:",Y),x(Y.message)}finally{d(null)}},q=async()=>{d("onboard"),x(null);try{const Y=await fetch(`${Ih}/createAccountLink`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n,returnUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?connect=return`,refreshUrl:`${window.location.origin}/stylist-scheduler/#/shop/${t}/dashboard?connect=refresh`})}),T=await Y.json();if(!Y.ok)throw new Error(T.error||"Failed to create onboarding link");window.location.href=T.url}catch(Y){console.error("Onboarding error:",Y),x(Y.message),d(null)}},Q=async()=>{d("dashboard"),x(null);try{const Y=await fetch(`${Ih}/getConnectDashboardLink`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n})}),T=await Y.json();if(!Y.ok)throw new Error(T.error||"Failed to get dashboard link");window.open(T.url,"_blank")}catch(Y){console.error("Dashboard link error:",Y),x(Y.message)}finally{d(null)}},H=async()=>{d("balance"),x(null);try{const Y=await fetch(`${Ih}/getConnectBalance`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shopId:n})}),T=await Y.json();if(!Y.ok)throw new Error(T.error||"Failed to fetch balance");b(T)}catch(Y){console.error("Balance fetch error:",Y),x(Y.message)}finally{d(null)}};j.useEffect(()=>{A&&!g&&H()},[A]);const ie=(Y,T="usd")=>new Intl.NumberFormat("en-US",{style:"currency",currency:T.toUpperCase()}).format(Y/100),le=Y=>new Date(Y*1e3).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Payments"}),a.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:"Connect Stripe to accept deposits and get paid"})]}),w&&A&&a.jsxs("button",{onClick:H,disabled:c==="balance",className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-all",children:[c==="balance"?a.jsx(ea,{className:"w-3.5 h-3.5 animate-spin"}):a.jsx(sm,{className:"w-3.5 h-3.5"}),"Refresh"]})]}),p&&a.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[a.jsx(Du,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-red-800 text-sm",children:"Something went wrong"}),a.jsx("p",{className:"text-sm text-red-600",children:p})]})]}),!w&&a.jsx("div",{className:"bg-gradient-to-br from-violet-50 to-blue-50 rounded-2xl border border-violet-200 p-8",children:a.jsxs("div",{className:"flex flex-col items-center text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-lg flex items-center justify-center mb-5",children:a.jsx(yn,{className:"w-8 h-8 text-violet-600"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"Accept Payments"}),a.jsx("p",{className:"text-slate-600 max-w-md mb-6",children:"Connect your Stripe account to accept deposit payments from clients when they book. Funds are transferred directly to your bank account."}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 w-full max-w-xl mb-8",children:[{icon:L2,label:"Secure payments",desc:"256-bit encryption"},{icon:Xo,label:"Fast payouts",desc:"2-day transfers"},{icon:Ro,label:"Low fees",desc:"2.9% + 30"}].map(({icon:Y,label:T,desc:E})=>a.jsxs("div",{className:"bg-white/70 rounded-xl p-4 text-center",children:[a.jsx(Y,{className:"w-5 h-5 text-violet-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm font-semibold text-slate-900",children:T}),a.jsx("p",{className:"text-xs text-slate-500",children:E})]},T))}),a.jsx("button",{onClick:F,disabled:c==="create",className:"flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-violet-600 to-blue-600 hover:from-violet-700 hover:to-blue-700 text-white rounded-xl font-bold text-base shadow-lg shadow-violet-600/25 transition-all disabled:opacity-50",children:c==="create"?a.jsxs(a.Fragment,{children:[a.jsx(ea,{className:"w-5 h-5 animate-spin"}),"Setting up..."]}):a.jsxs(a.Fragment,{children:[a.jsx(yn,{className:"w-5 h-5"}),"Connect with Stripe",a.jsx(Co,{className:"w-5 h-5"})]})}),L==="free"&&a.jsxs("p",{className:"mt-4 text-xs text-slate-500 flex items-center gap-1",children:[a.jsx(X1,{className:"w-3.5 h-3.5"}),"Free tier: ",V," platform fee on deposits.",a.jsx("a",{href:"#",className:"text-violet-600 hover:underline",children:"Upgrade to remove"})]})]})}),w&&!_&&a.jsx("div",{className:"bg-amber-50 rounded-2xl border border-amber-200 p-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(Zt,{className:"w-6 h-6 text-amber-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Complete Your Setup"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Your Stripe account is created, but you need to complete the onboarding process to start accepting payments."}),a.jsx("button",{onClick:q,disabled:c==="onboard",className:"flex items-center gap-2 px-5 py-2.5 bg-amber-600 hover:bg-amber-700 text-white rounded-xl font-semibold text-sm shadow-md transition-all disabled:opacity-50",children:c==="onboard"?a.jsxs(a.Fragment,{children:[a.jsx(ea,{className:"w-4 h-4 animate-spin"}),"Redirecting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xl,{className:"w-4 h-4"}),"Complete Setup"]})})]})]})}),w&&_&&!A&&a.jsx("div",{className:"bg-blue-50 rounded-2xl border border-blue-200 p-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(ND,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Verification in Progress"}),a.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Stripe is reviewing your account. This usually takes a few minutes. Once approved, you'll be able to accept payments."}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("button",{onClick:q,disabled:c==="onboard",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[c==="onboard"?a.jsx(ea,{className:"w-4 h-4 animate-spin"}):a.jsx(xl,{className:"w-4 h-4"}),"Check Status"]})})]})]})}),w&&A&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:a.jsx(Rs,{className:"w-7 h-7"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Stripe Connected"}),a.jsx("span",{className:"px-2 py-0.5 bg-white/20 text-xs font-bold rounded-full",children:"Active"})]}),a.jsx("p",{className:"text-white/80 text-sm mt-0.5",children:"You're ready to accept deposit payments"})]})]}),a.jsxs("button",{onClick:Q,disabled:c==="dashboard",className:"flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:[c==="dashboard"?a.jsx(ea,{className:"w-4 h-4 animate-spin"}):a.jsx(xl,{className:"w-4 h-4"}),"Stripe Dashboard"]})]})}),g&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Available"}),a.jsx(eN,{className:"w-4 h-4 text-emerald-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:g.balance.available[0]?ie(g.balance.available[0].amount,g.balance.available[0].currency):"$0.00"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Ready to pay out"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Pending"}),a.jsx(Zt,{className:"w-4 h-4 text-blue-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:g.balance.pending[0]?ie(g.balance.pending[0].amount,g.balance.pending[0].currency):"$0.00"}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Processing"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Platform Fee"}),a.jsx(Ro,{className:"w-4 h-4 text-violet-500"})]}),a.jsx("p",{className:"text-2xl font-bold text-slate-900",children:V}),a.jsx("p",{className:"text-xs text-slate-400 mt-1",children:L==="free"?"Upgrade to remove":"No platform fees"})]})]}),g?.recentCharges?.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-bold text-slate-900",children:"Recent Payments"}),a.jsx("button",{onClick:Q,className:"text-xs font-medium text-blue-600 hover:text-blue-700",children:"View All "})]}),a.jsx("div",{className:"space-y-3",children:g.recentCharges.slice(0,5).map(Y=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${Y.status==="succeeded"?"bg-emerald-100":"bg-slate-100"}`,children:Y.status==="succeeded"?a.jsx(Rs,{className:"w-4 h-4 text-emerald-600"}):a.jsx(Zt,{className:"w-4 h-4 text-slate-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:Y.metadata?.clientName||"Payment"}),a.jsxs("p",{className:"text-xs text-slate-400",children:[le(Y.created),Y.metadata?.serviceName&&`  ${Y.metadata.serviceName}`]})]})]}),a.jsx("span",{className:"text-sm font-bold text-slate-900",children:ie(Y.amount,Y.currency)})]},Y.id))})]}),g?.recentPayouts?.length>0&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-bold text-slate-900",children:"Recent Payouts"}),a.jsx(Bo,{className:"w-4 h-4 text-slate-400"})]}),a.jsx("div",{className:"space-y-3",children:g.recentPayouts.slice(0,3).map(Y=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${Y.status==="paid"?"bg-emerald-100":"bg-amber-100"}`,children:a.jsx(eN,{className:`w-4 h-4 ${Y.status==="paid"?"text-emerald-600":"text-amber-600"}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900 capitalize",children:Y.status}),a.jsx("p",{className:"text-xs text-slate-400",children:Y.arrivalDate?`Arrives ${le(Y.arrivalDate)}`:le(Y.created)})]})]}),a.jsx("span",{className:"text-sm font-bold text-emerald-600",children:ie(Y.amount,Y.currency)})]},Y.id))})]})]}),a.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-5",children:[a.jsxs("h3",{className:"font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(X1,{className:"w-4 h-4 text-blue-500"}),"How it works"]}),a.jsxs("ul",{className:"space-y-2 text-sm text-slate-600",children:[a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"1"}),a.jsx("span",{children:"Client books an appointment and pays the deposit"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"2"}),a.jsxs("span",{children:["Payment goes directly to your Stripe account (minus Stripe's 2.9% + 30 fee",L==="free"&&` and ${V} platform fee`,")"]})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-5 h-5 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:"3"}),a.jsx("span",{children:"Stripe automatically transfers funds to your bank (usually within 2 days)"})]})]})]})]})}const k9=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function A0(n){const[e,t]=n.split(":").map(Number);return e*60+t}function C9(n,e){if(n.status!=="waiting"||n.serviceId&&e.serviceId&&n.serviceId!==e.serviceId||n.staffId&&n.staffId!=="any"&&e.staffId&&n.staffId!==e.staffId)return!1;if(e.date){if(n.preferredDate&&n.preferredDate!==e.date)return!1;if(n.preferredDays&&n.preferredDays.length>0){const t=new Date(e.date+"T12:00:00"),i=k9[t.getDay()];if(!n.preferredDays.includes(i))return!1}}if(e.time&&n.preferredTimeRange){const t=A0(e.time),i=A0(n.preferredTimeRange.start),o=A0(n.preferredTimeRange.end);if(!(n.preferredTimeRange.start==="00:00"&&n.preferredTimeRange.end==="23:59")&&(t<i||t>o))return!1}return!0}function R9(n,e){return n.filter(t=>C9(t,e)).sort((t,i)=>(t.createdAt||"").localeCompare(i.createdAt||""))}const wN=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}];function di(n){if(!n)return"";const[e,t]=n.split(":").map(Number),i=e>=12?"PM":"AM";return`${e%12||12}:${t.toString().padStart(2,"0")} ${i}`}function I9({user:n}){const{slug:e}=Ho(),t=Sl(),[i,o]=j.useState(null),[c,d]=j.useState(null),[p,x]=j.useState(!0),[g,b]=j.useState(!1),[w,_]=j.useState([]),[A,L]=j.useState([]),[V,F]=j.useState([]),[q,Q]=j.useState([]),[H,ie]=j.useState("schedule"),[le,Y]=j.useState(null),[T,E]=j.useState("all"),[S,I]=j.useState("all"),[C,M]=j.useState([]),[R,B]=j.useState(null),[P,O]=j.useState(null),[K,oe]=j.useState(!1),[be,fe]=j.useState({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""});j.useEffect(()=>{if(!n){t(`/shop/${e}/login`,{replace:!0});return}(async()=>{x(!0);try{const ae=Ln(Je(we,"shops"),bn("slug","==",e)),Ee=await Cs(ae);if(Ee.empty){b(!0),x(!1);return}const Se=Ee.docs[0],Ue=Se.data();if(Ue.ownerUid!==n.uid){b(!0),x(!1);return}o(Ue),d(Se.id)}catch(ae){console.error("Error checking ownership:",ae),b(!0)}finally{x(!1)}})()},[n,e,t]),j.useEffect(()=>{if(!c)return;const z=Gt(Je(we,"shops",c,"availability"),de=>{const je=de.docs.map(ke=>({id:ke.id,...ke.data()}));_(je)}),ae=Gt(Je(we,"shops",c,"bookings"),de=>{const je=de.docs.map(ke=>({id:ke.id,...ke.data()}));L(je)}),Ee=Gt(Je(we,"shops",c,"staff"),de=>{const je=de.docs.map(ke=>({id:ke.id,...ke.data()})).filter(ke=>ke.active!==!1).sort((ke,$e)=>(ke.name||"").localeCompare($e.name||""));F(je)}),Se=Gt(Je(we,"shops",c,"waitlist"),de=>{const je=de.docs.map(ke=>({id:ke.id,...ke.data()})).sort((ke,$e)=>(ke.createdAt||"").localeCompare($e.createdAt||""));M(je)}),Ue=Gt(Je(we,"shops",c,"services"),de=>{const je=de.docs.map(ke=>({id:ke.id,...ke.data()})).filter(ke=>ke.active!==!1).sort((ke,$e)=>(ke.name||"").localeCompare($e.name||""));Q(je)});return()=>{z(),ae(),Ee(),Se(),Ue()}},[c]);const U=async()=>{await U0(Ir),t(`/shop/${e}`,{replace:!0})},Z=async z=>{z.preventDefault();const{date:ae,startTime:Ee,endTime:Se,slotDuration:Ue,staffId:de}=be,je=parseInt(Ue),[ke,$e]=Ee.split(":").map(Number),[ot,ze]=Se.split(":").map(Number),qe=ke*60+$e,kt=ot*60+ze;let Kt=qe;for(;Kt+je<=kt;){const an=Math.floor(Kt/60),rn=Kt%60,ra=`${an.toString().padStart(2,"0")}:${rn.toString().padStart(2,"0")}`,ia={date:ae,time:ra,duration:je,available:!0};if(de){const la=V.find(as=>as.id===de);ia.staffId=de,ia.staffName=la?.name||""}await _a(Je(we,"shops",c,"availability"),ia),Kt+=je}fe({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""})},ue=async z=>{await ko(Ge(we,"shops",c,"availability",z))},me=z=>{const ae={date:z.date,time:z.time,staffId:z.staffId||null,serviceId:z.serviceId||null},Ee=R9(C,ae);Ee.length>0&&B({matches:Ee,slot:ae})},ge=async(z,ae)=>{for(const Ee of z)await tt(Ge(we,"shops",c,"waitlist",Ee.id),{status:"notified",notifiedAt:new Date().toISOString(),notifiedSlot:{date:ae.date,time:ae.time,staffId:ae.staffId||null,staffName:ae.staffName||null}});B(null)},De=async z=>{await tt(Ge(we,"shops",c,"waitlist",z),{status:"notified",notifiedAt:new Date().toISOString()})},Ye=async z=>{await tt(Ge(we,"shops",c,"waitlist",z),{status:"expired"})},pt=async z=>{const ae=A.find(Ee=>Ee.id===z);if(ae&&ae.recurringGroupId){O({bookingId:z,recurringGroupId:ae.recurringGroupId});return}if(await tt(Ge(we,"shops",c,"bookings",z),{status:"cancelled"}),ae&&ae.slotId&&!ae.slotId.startsWith("wh-")&&!ae.slotId.startsWith("recurring-"))try{await tt(Ge(we,"shops",c,"availability",ae.slotId),{available:!0})}catch(Ee){console.warn("Could not re-open slot:",Ee)}ae&&me(ae)},dt=async z=>{const ae=A.find(Ee=>Ee.id===z);if(await tt(Ge(we,"shops",c,"bookings",z),{status:"cancelled"}),ae&&ae.slotId&&!ae.slotId.startsWith("wh-")&&!ae.slotId.startsWith("recurring-"))try{await tt(Ge(we,"shops",c,"availability",ae.slotId),{available:!0})}catch(Ee){console.warn("Could not re-open slot:",Ee)}ae&&me(ae),O(null)},Wt=async(z,ae)=>{const Ee=A.find(Ue=>Ue.id===z);if(!Ee)return;const Se=A.filter(Ue=>Ue.recurringGroupId===ae&&Ue.date>=Ee.date&&(Ue.status==="pending"||Ue.status==="confirmed"));for(const Ue of Se)if(await tt(Ge(we,"shops",c,"bookings",Ue.id),{status:"cancelled"}),Ue.slotId&&!Ue.slotId.startsWith("wh-")&&!Ue.slotId.startsWith("recurring-"))try{await tt(Ge(we,"shops",c,"availability",Ue.slotId),{available:!0})}catch(de){console.warn("Could not re-open slot:",de)}Ee&&me(Ee),O(null)},ne=async z=>{await tt(Ge(we,"shops",c,"bookings",z),{status:"confirmed"})},Te=async z=>{const ae=A.find(Ee=>Ee.id===z);if(await tt(Ge(we,"shops",c,"bookings",z),{status:"rejected"}),ae&&ae.slotId&&!ae.slotId.startsWith("wh-"))try{await tt(Ge(we,"shops",c,"availability",ae.slotId),{available:!0})}catch(Ee){console.warn("Could not re-open slot:",Ee)}ae&&me(ae)},W=async()=>{const z=!i?.requireApproval;try{await tt(Ge(we,"shops",c),{requireApproval:z}),o(ae=>({...ae,requireApproval:z}))}catch(ae){console.error("Error updating requireApproval:",ae)}},ye=async z=>{const ae=parseInt(z);try{await tt(Ge(we,"shops",c),{bufferMinutes:ae}),o(Ee=>({...Ee,bufferMinutes:ae}))}catch(Ee){console.error("Error updating buffer minutes:",Ee)}},Ae=(z,ae)=>new Date(`${z}T${ae}`).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),Ve=j.useMemo(()=>{const z={},ae=T==="all"?V:V.filter(Se=>Se.id===T),Ee=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(const Se of ae)Se.weeklyHours&&Ee.forEach((Ue,de)=>{Se.weeklyHours[Ue]?.enabled&&(z[de]=!0)});return z},[V,T]),xt=j.useMemo(()=>{const z={},ae=T==="all"?V:V.filter(Ue=>Ue.id===T),Ee=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Se=new Date;Se.setHours(0,0,0,0);for(let Ue=0;Ue<60;Ue++){const de=new Date(Se);de.setDate(de.getDate()+Ue);const je=de.getDay(),ke=Ee[je],$e=`${de.getFullYear()}-${String(de.getMonth()+1).padStart(2,"0")}-${String(de.getDate()).padStart(2,"0")}`;for(const ot of ae){if(!ot.weeklyHours||!ot.weeklyHours[ke]?.enabled)continue;const ze=ot.weeklyHours[ke],qe=ze.breaks||(ze.break?[ze.break]:[]);qe.length>0&&(z[$e]||(z[$e]=[]),z[$e].push(...qe.map(kt=>({...kt,staffId:ot.id,staffName:ot.name}))))}}return z},[V,T]),it=j.useMemo(()=>(T==="all"?V:V.filter(ae=>ae.id===T)).filter(ae=>ae.weeklyHours?wN.some(Ee=>ae.weeklyHours[Ee.key]?.enabled):!1),[V,T]),rt=j.useMemo(()=>{const z=new Date,ae=`${z.getFullYear()}-${String(z.getMonth()+1).padStart(2,"0")}-${String(z.getDate()).padStart(2,"0")}`,Ee=z.getDay(),Se=Ee===0?-6:1-Ee,Ue=new Date(z);Ue.setDate(z.getDate()+Se),Ue.setHours(0,0,0,0);const de=new Date(Ue);de.setDate(Ue.getDate()+6),de.setHours(23,59,59,999);const je=`${Ue.getFullYear()}-${String(Ue.getMonth()+1).padStart(2,"0")}-${String(Ue.getDate()).padStart(2,"0")}`,ke=`${de.getFullYear()}-${String(de.getMonth()+1).padStart(2,"0")}-${String(de.getDate()).padStart(2,"0")}`,$e=A.filter(qe=>qe.date===ae).length,ot=A.filter(qe=>qe.date>=je&&qe.date<=ke).length,ze=new Set(A.map(qe=>qe.clientEmail?.toLowerCase()).filter(Boolean)).size;return{todayBookings:$e,weekBookings:ot,uniqueClients:ze,totalBookings:A.length}},[A]),Ce=j.useMemo(()=>A.filter(z=>z.status==="pending").length,[A]),Le=j.useMemo(()=>C.filter(z=>z.status==="waiting").length,[C]),[pe,Ke]=j.useState(0),[Fe,Oe]=j.useState({}),We=j.useMemo(()=>{if(!i)return 0;i?.winbackSettings?.warningDays;const z=i?.winbackSettings?.inactiveDays||60;if(!(i?.winbackSettings?.enabled!==!1))return 0;const Ee=new Date,Se=A.filter(ke=>ke.status==="confirmed"||ke.status==="pending"||!ke.status),Ue={};Se.forEach(ke=>{const $e=ke.clientEmail?.toLowerCase();$e&&(!Ue[$e]||ke.date>Ue[$e])&&(Ue[$e]=ke.date)});let de=0;const je=ke=>ke.replace(/\./g,"_dot_").replace(/@/g,"_at_");return Object.entries(Ue).forEach(([ke,$e])=>{if(Math.floor((Ee.getTime()-new Date($e+"T12:00:00").getTime())/864e5)>z){const ze=je(ke);Fe[ze]?.contacted||de++}}),de},[A,i,Fe]);if(j.useEffect(()=>{if(!c)return;const z=Gt(Je(we,"shops",c,"clientNotes"),ae=>{const Ee={};ae.docs.forEach(Se=>{Ee[Se.id]=Se.data()}),Oe(Ee)});return()=>z()},[c]),j.useEffect(()=>{if(!c)return;const z=Gt(Je(we,"shops",c,"walkins"),ae=>{const Ee=ae.docs.filter(Se=>Se.data().status==="waiting").length;Ke(Ee)});return()=>z()},[c]),p)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading dashboard"})]})});if(g)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(wf,{className:"w-8 h-8 text-red-500"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Unauthorized"}),a.jsx("p",{className:"text-slate-600 mb-6",children:"You don't have access to this dashboard."}),a.jsx(nt,{to:`/shop/${e}/login`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:"Login"})]})});const Qe=T==="all"?w:w.filter(z=>z.staffId===T),es=T==="all"?A:A.filter(z=>z.staffId===T),nn=Qe.reduce((z,ae)=>(z[ae.date]||(z[ae.date]=[]),z[ae.date].push(ae),z),{}),Sn=es.reduce((z,ae)=>(z[ae.date]||(z[ae.date]=[]),z[ae.date].push(ae),z),{}),Js=le?Object.keys(nn).filter(z=>z===le).sort():Object.keys(nn).sort(),Hs=le?es.filter(z=>z.date===le):es,xs=S==="all"?Hs:S==="pending"?Hs.filter(z=>z.status==="pending"):S==="confirmed"?Hs.filter(z=>!z.status||z.status==="confirmed"):Hs.filter(z=>z.status==="cancelled"||z.status==="rejected"),Lt={all:Hs.length,pending:Hs.filter(z=>z.status==="pending").length,confirmed:Hs.filter(z=>!z.status||z.status==="confirmed").length,cancelled:Hs.filter(z=>z.status==="cancelled"||z.status==="rejected").length},gs=[{key:"schedule",label:"Schedule",icon:Et},{key:"clients",label:"Clients",icon:Sg},{key:"walkins",label:"Walk-ins",icon:F2},{key:"analytics",label:"Analytics",icon:M2},{key:"waitlist",label:"Waitlist",icon:ix},{key:"staff",label:"Staff",icon:Dt},{key:"services",label:"Services",icon:Nn},{key:"subscription",label:"Plan",icon:Uo},{key:"settings",label:"Settings",icon:Yh}];return a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>oe(!0),className:"lg:hidden p-2 -ml-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:a.jsx(mM,{className:"w-6 h-6"})}),a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(i.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{className:"hidden sm:block",children:[a.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:i.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),a.jsx("div",{className:"hidden lg:flex items-center bg-slate-100 p-1 rounded-xl",children:gs.map(z=>{const ae=z.icon,Se=z.key==="schedule"&&Ce>0?{count:Ce,color:"bg-amber-500"}:z.key==="clients"&&We>0?{count:We,color:"bg-orange-500"}:z.key==="walkins"&&pe>0?{count:pe,color:"bg-emerald-500"}:z.key==="waitlist"&&Le>0?{count:Le,color:"bg-blue-500"}:null;return a.jsxs("button",{onClick:()=>ie(z.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${H===z.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(ae,{className:"w-4 h-4"}),a.jsx("span",{children:z.label}),Se&&a.jsx("span",{className:`ml-1 px-1.5 py-0.5 ${Se.color} text-white text-[10px] font-bold rounded-full leading-none`,children:Se.count})]},z.key)})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(nt,{to:`/shop/${e}`,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[a.jsx(vu,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"View Page"})]}),a.jsxs("button",{onClick:U,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",children:[a.jsx(lx,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),K&&a.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>oe(!1)}),a.jsxs("div",{className:"fixed inset-y-0 left-0 w-72 bg-white shadow-2xl animate-slide-in-left",children:[a.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-slate-200",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm",children:(i.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-bold text-slate-900",children:i.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),a.jsx("button",{onClick:()=>oe(!1),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",children:a.jsx(Ds,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"p-3 space-y-1",children:gs.map(z=>{const ae=z.icon,Se=z.key==="schedule"&&Ce>0?{count:Ce,color:"bg-amber-500"}:z.key==="clients"&&We>0?{count:We,color:"bg-orange-500"}:z.key==="walkins"&&pe>0?{count:pe,color:"bg-emerald-500"}:z.key==="waitlist"&&Le>0?{count:Le,color:"bg-blue-500"}:null;return a.jsxs("button",{onClick:()=>{ie(z.key),oe(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left font-medium transition-all ${H===z.key?"bg-blue-50 text-blue-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,children:[a.jsx(ae,{className:`w-5 h-5 ${H===z.key?"text-blue-600":"text-slate-400"}`}),a.jsx("span",{className:"flex-1",children:z.label}),Se&&a.jsx("span",{className:`px-2 py-0.5 ${Se.color} text-white text-xs font-bold rounded-full`,children:Se.count})]},z.key)})}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 border-t border-slate-200 bg-slate-50",children:[a.jsxs(nt,{to:`/shop/${e}`,onClick:()=>oe(!1),className:"flex items-center gap-3 px-4 py-3 text-slate-600 hover:bg-white rounded-xl font-medium transition-all",children:[a.jsx(vu,{className:"w-5 h-5 text-slate-400"}),"View Public Page"]}),a.jsxs("button",{onClick:()=>{oe(!1),U()},className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl font-medium transition-all",children:[a.jsx(lx,{className:"w-5 h-5"}),"Logout"]})]})]})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[H==="schedule"&&a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8 animate-fade-in",children:[{label:"Today's Bookings",value:rt.todayBookings,icon:K1,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:rt.weekBookings,icon:Bo,color:"bg-violet-100 text-violet-600"},{label:"Total Bookings",value:rt.totalBookings,icon:_g,color:"bg-emerald-100 text-emerald-600"},{label:"Unique Clients",value:rt.uniqueClients,icon:Dt,color:"bg-amber-100 text-amber-600"}].map(z=>{const ae=z.icon;return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 ${z.color} rounded-xl flex items-center justify-center`,children:a.jsx(ae,{className:"w-5 h-5"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:z.value}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:z.label})]},z.label)})}),H==="clients"&&a.jsx(j9,{shopId:c,bookings:A,shop:i,slug:e}),H==="walkins"&&a.jsx(w9,{shopId:c,services:q,staff:V,bookings:A}),H==="analytics"&&a.jsx(g9,{bookings:A}),H==="staff"&&a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:a.jsx(p9,{shopId:c,shop:i,slug:e})}),H==="services"&&a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:a.jsx(e9,{shopId:c})}),H==="subscription"&&a.jsx(T9,{shopId:c,shop:i,slug:e}),R&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(_o,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Waitlist Match!"}),a.jsxs("p",{className:"text-sm text-slate-500",children:[R.matches.length," client",R.matches.length!==1?"s":""," on the waitlist match this freed slot"]})]})]}),a.jsx("div",{className:"bg-slate-50 rounded-xl p-3 mb-4 text-sm",children:a.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[a.jsx(Et,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-medium",children:[new Date(R.slot.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})," at ",(()=>{const[z,ae]=R.slot.time.split(":"),Ee=parseInt(z);return`${Ee%12||12}:${ae} ${Ee>=12?"PM":"AM"}`})()]})]})}),a.jsx("div",{className:"space-y-2 mb-5 max-h-48 overflow-y-auto",children:R.matches.map(z=>a.jsx("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-50 border border-blue-100 rounded-lg",children:a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:z.clientName}),a.jsx("span",{className:"text-xs text-slate-500 ml-2",children:z.serviceName})]})},z.id))}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>ge(R.matches,R.slot),className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:[a.jsx(_o,{className:"w-4 h-4"}),"Notify All"]}),a.jsx("button",{onClick:()=>B(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Dismiss"})]})]})}),P&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center",children:a.jsx(_i,{className:"w-5 h-5 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Cancel Recurring Booking"}),a.jsx("p",{className:"text-sm text-slate-500",children:"This booking is part of a recurring series"})]})]}),a.jsxs("div",{className:"space-y-2 mb-5",children:[a.jsxs("button",{onClick:()=>dt(P.bookingId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx($a,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this one only"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments stay active"})]})]}),a.jsxs("button",{onClick:()=>Wt(P.bookingId,P.recurringGroupId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(_i,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future in series"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments"})]})]})]}),a.jsx("button",{onClick:()=>O(null),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Never mind"})]})}),H==="waitlist"&&a.jsx("div",{className:"animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-5",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Waitlist"}),Le>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:[Le," waiting"]})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[C.length," total"]})]}),C.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(ix,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No waitlist entries yet"}),a.jsx("p",{className:"text-xs text-slate-400",children:"Clients can join the waitlist when no slots are available on your booking page."})]}):a.jsx("div",{children:(()=>{const z={};return C.forEach(ae=>{const Ee=ae.serviceName||"Other";z[Ee]||(z[Ee]=[]),z[Ee].push(ae)}),Object.entries(z).sort(([ae],[Ee])=>ae.localeCompare(Ee)).map(([ae,Ee])=>a.jsxs("div",{className:"mb-6 last:mb-0",children:[a.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100 flex items-center gap-2",children:[a.jsx(Nn,{className:"w-3.5 h-3.5 text-blue-500"}),ae,a.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",Ee.filter(Se=>Se.status==="waiting").length," waiting)"]})]}),a.jsx("div",{className:"space-y-2.5",children:Ee.sort((Se,Ue)=>(Se.createdAt||"").localeCompare(Ue.createdAt||"")).map(Se=>{const Ue={waiting:"bg-blue-50 text-blue-700 border-blue-200",notified:"bg-emerald-50 text-emerald-700 border-emerald-200",booked:"bg-emerald-50 text-emerald-700 border-emerald-200",expired:"bg-slate-100 text-slate-500 border-slate-200"},de={waiting:"Waiting",notified:"Notified",booked:"Booked",expired:"Removed"},je=Se.createdAt?(()=>{const $e=Date.now()-new Date(Se.createdAt).getTime(),ot=Math.floor($e/864e5),ze=Math.floor($e/36e5);return ot>0?`${ot}d`:`${ze}h`})():"",ke={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return a.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(_l,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:Se.clientName}),a.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Ue[Se.status]||Ue.waiting}`,children:de[Se.status]||"Waiting"})]}),a.jsxs("div",{className:"text-xs text-slate-500",children:["Joined ",je," ago",Se.refCode&&a.jsx("span",{className:"font-mono text-slate-400 ml-2",children:Se.refCode})]})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[Se.status==="waiting"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>De(Se.id),className:"p-1.5 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-all",title:"Notify client",children:a.jsx(_o,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Ye(Se.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove from waitlist",children:a.jsx(Ds,{className:"w-4 h-4"})})]}),Se.status==="notified"&&a.jsx("button",{onClick:()=>Ye(Se.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove",children:a.jsx(Ds,{className:"w-3.5 h-3.5"})})]})]}),a.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[Se.staffName&&Se.staffName!=="Any Available"&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Dt,{className:"w-3 h-3 text-violet-400"}),a.jsx("span",{className:"text-violet-600",children:Se.staffName})]}),Se.preferredDate&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Et,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Preferred: ",new Date(Se.preferredDate+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]})]}),Se.preferredDays&&Se.preferredDays.length>0&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Et,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Days: ",Se.preferredDays.map($e=>ke[$e]||$e).join(", ")]})]}),Se.preferredTimeRange&&!(Se.preferredTimeRange.start==="00:00"&&Se.preferredTimeRange.end==="23:59")&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Zt,{className:"w-3 h-3 text-slate-400"}),a.jsxs("span",{children:["Time: ",di(Se.preferredTimeRange.start),"",di(Se.preferredTimeRange.end)]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nf,{className:"w-3 h-3"}),Se.clientEmail]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(cx,{className:"w-3 h-3"}),Se.clientPhone]})]}),Se.status==="notified"&&Se.notifiedSlot&&a.jsxs("div",{className:"mt-1.5 px-2.5 py-1.5 bg-emerald-50 border border-emerald-200 rounded-lg inline-flex items-center gap-1.5",children:[a.jsx(_o,{className:"w-3 h-3 text-emerald-500"}),a.jsxs("span",{className:"text-emerald-700 font-medium",children:["Notified about ",new Date(Se.notifiedSlot.date+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})," at ",di(Se.notifiedSlot.time)]})]})]})]},Se.id)})})]},ae))})()})]})}),H==="settings"&&a.jsxs("div",{className:"max-w-2xl animate-fade-in space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Settings"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure your booking preferences"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Require Booking Approval"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Review and approve bookings before they're confirmed"})]}),a.jsx("button",{type:"button",onClick:W,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${i?.requireApproval?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${i?.requireApproval?"translate-x-6":"translate-x-1"}`})})]}),i?.requireApproval&&a.jsxs("div",{className:"p-3.5 bg-amber-50 border border-amber-200 rounded-xl text-xs text-amber-800 leading-relaxed",children:[a.jsx("strong",{children:" Approval mode is on."}),' New bookings will appear as "Pending" until you approve or reject them. Time slots are held while pending to prevent double-booking.']}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Buffer Time Between Bookings"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Add a gap between consecutive appointments"})]}),a.jsxs("select",{value:i?.bufferMinutes||0,onChange:z=>ye(z.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"0",children:"No buffer"}),a.jsx("option",{value:"5",children:"5 minutes"}),a.jsx("option",{value:"10",children:"10 minutes"}),a.jsx("option",{value:"15",children:"15 minutes"}),a.jsx("option",{value:"30",children:"30 minutes"})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Retention"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure win-back alerts to re-engage inactive clients"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Enable Win-back Alerts"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Show alerts when clients haven't visited in a while"})]}),a.jsx("button",{type:"button",onClick:async()=>{const z=i?.winbackSettings||{},ae=z.enabled===!1;try{await tt(Ge(we,"shops",c),{winbackSettings:{...z,enabled:ae}}),o(Ee=>({...Ee,winbackSettings:{...Ee.winbackSettings||{},enabled:ae}}))}catch(Ee){console.error("Error updating winback settings:",Ee)}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${i?.winbackSettings?.enabled!==!1?"bg-blue-500":"bg-slate-300"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${i?.winbackSettings?.enabled!==!1?"translate-x-6":"translate-x-1"}`})})]}),i?.winbackSettings?.enabled!==!1&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Getting Cold Threshold"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "Getting Cold" after this many days without a booking'})]}),a.jsxs("select",{value:i?.winbackSettings?.warningDays||30,onChange:async z=>{const ae=parseInt(z.target.value),Ee=i?.winbackSettings||{};try{await tt(Ge(we,"shops",c),{winbackSettings:{...Ee,warningDays:ae}}),o(Se=>({...Se,winbackSettings:{...Se.winbackSettings||{},warningDays:ae}}))}catch(Se){console.error("Error updating warning days:",Se)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"14",children:"14 days"}),a.jsx("option",{value:"21",children:"21 days"}),a.jsx("option",{value:"30",children:"30 days"}),a.jsx("option",{value:"45",children:"45 days"}),a.jsx("option",{value:"60",children:"60 days"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"pr-4",children:[a.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"At Risk Threshold"}),a.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "At Risk" after this many days without a booking'})]}),a.jsxs("select",{value:i?.winbackSettings?.inactiveDays||60,onChange:async z=>{const ae=parseInt(z.target.value),Ee=i?.winbackSettings||{};try{await tt(Ge(we,"shops",c),{winbackSettings:{...Ee,inactiveDays:ae}}),o(Se=>({...Se,winbackSettings:{...Se.winbackSettings||{},inactiveDays:ae}}))}catch(Se){console.error("Error updating inactive days:",Se)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[a.jsx("option",{value:"30",children:"30 days"}),a.jsx("option",{value:"45",children:"45 days"}),a.jsx("option",{value:"60",children:"60 days"}),a.jsx("option",{value:"90",children:"90 days"}),a.jsx("option",{value:"120",children:"120 days"})]})]}),a.jsxs("div",{className:"p-3.5 bg-orange-50 border border-orange-200 rounded-xl text-xs text-orange-800 leading-relaxed",children:[a.jsx("strong",{children:" Tip:"}),' Clients flagged as "Lost" (over 90 days) will also appear in win-back alerts. Visit the ',a.jsx("strong",{children:"Clients"})," tab to view at-risk clients and send win-back messages."]})]})]})]}),a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:a.jsx(A9,{shopId:c,shop:i,slug:e})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Visibility"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Temporarily hide your shop from public view"}),i?.archived?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(yu,{className:"w-5 h-5 text-amber-600"}),a.jsx("span",{className:"font-semibold text-amber-800",children:"Shop is Archived"})]}),a.jsx("p",{className:"text-sm text-amber-700",children:"Your shop is currently hidden from the public booking page. You can still access your dashboard to view history."})]}),a.jsxs("button",{onClick:async()=>{try{await tt(Ge(we,"shops",c),{archived:!1,archivedAt:null}),o(z=>({...z,archived:!1,archivedAt:null}))}catch(z){console.error("Error unarchiving shop:",z)}},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-emerald-600/20 transition-all",children:[a.jsx(yu,{className:"w-4 h-4"}),"Unarchive Shop"]})]}):a.jsxs("button",{onClick:async()=>{if(window.confirm("Are you sure you want to archive your shop? It will be hidden from the public booking page."))try{await tt(Ge(we,"shops",c),{archived:!0,archivedAt:Ni()}),o(z=>({...z,archived:!0,archivedAt:new Date().toISOString()}))}catch(z){console.error("Error archiving shop:",z)}},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-amber-500 hover:bg-amber-600 text-white rounded-xl font-semibold text-sm shadow-md shadow-amber-500/20 transition-all",children:[a.jsx(yu,{className:"w-4 h-4"}),"Archive Shop"]}),a.jsx("p",{className:"text-xs text-slate-400 mt-3",children:"Archiving hides your shop but preserves all data. You can unarchive at any time."})]}),a.jsxs("div",{className:"bg-white rounded-xl border-2 border-red-200 p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(ta,{className:"w-5 h-5 text-red-500"}),a.jsx("h2",{className:"text-lg font-bold text-red-600",children:"Danger Zone"})]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Irreversible actions that will permanently affect your shop"}),a.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl mb-4",children:[a.jsx("h3",{className:"font-semibold text-red-800 mb-2",children:"Delete Shop Permanently"}),a.jsxs("p",{className:"text-sm text-red-700 mb-3",children:["This will permanently delete your shop, all staff, bookings, time slots, and settings.",a.jsx("strong",{children:" This cannot be undone."})]}),a.jsxs("button",{onClick:()=>{const z=new Date().toISOString().split("T")[0],ae=A.filter(Se=>Se.date>=z&&(Se.status==="pending"||Se.status==="confirmed"||!Se.status));if(ae.length>0){alert(`Cannot delete shop: You have ${ae.length} upcoming booking${ae.length!==1?"s":""}. Please cancel or complete all upcoming bookings before deleting your shop.`);return}const Ee=window.prompt(`To delete your shop, type "${i.name}" below:

 WARNING: This will permanently delete:
 Your shop and all settings
 All staff members
 All bookings (past and future)
 All time slots
 All waitlist entries
 All schedule presets`);Ee===i.name?(async()=>{try{const Ue=["staff","bookings","availability","waitlist","schedulePresets","services","walkins","clientNotes"];for(const de of Ue){const je=await Cs(Je(we,"shops",c,de));for(const ke of je.docs)await ko(Ge(we,"shops",c,de,ke.id))}await ko(Ge(we,"shops",c)),await U0(Ir),t("/",{replace:!0})}catch(Ue){console.error("Error deleting shop:",Ue),alert("An error occurred while deleting the shop. Please try again.")}})():Ee!==null&&alert("Shop name did not match. Deletion cancelled.")},className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-red-600/20 transition-all",children:[a.jsx(ba,{className:"w-4 h-4"}),"Delete Shop Forever"]})]})]})]}),H==="schedule"&&a.jsxs("div",{className:"animate-fade-in",children:[V.length>0&&a.jsx("div",{className:"flex flex-wrap gap-4 mb-6",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5",children:"Filter by Staff"}),a.jsxs("select",{value:T,onChange:z=>E(z.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[a.jsx("option",{value:"all",children:"All Staff"}),V.map(z=>a.jsxs("option",{value:z.id,children:[z.name,z.role?`  ${z.role}`:""]},z.id))]})]})}),it.length>0&&a.jsxs("div",{className:"mb-6 bg-violet-50 border border-violet-200 rounded-xl p-5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(sm,{className:"w-4 h-4 text-violet-600"}),a.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Recurring Weekly Hours"})]}),a.jsx("div",{className:"space-y-2.5",children:it.map(z=>{const ae=wN.filter(Ee=>z.weeklyHours[Ee.key]?.enabled);return a.jsxs("div",{className:"flex items-start gap-2.5",children:[a.jsx("div",{className:"w-7 h-7 bg-violet-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(Dt,{className:"w-3.5 h-3.5 text-violet-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-900 text-sm",children:z.name}),a.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:ae.map(Ee=>{const Se=z.weeklyHours[Ee.key];return a.jsxs("span",{className:"inline-block px-2 py-0.5 bg-white text-violet-700 border border-violet-200 rounded text-xs font-medium",children:[Ee.short," ",di(Se.start),"",di(Se.end),Se.break&&a.jsxs("span",{className:"text-amber-600 ml-1",children:["(break ",di(Se.break.start),"",di(Se.break.end),")"]})]},Ee.key)})})]})]},z.id)})}),a.jsx("p",{className:"text-xs text-violet-500 mt-3",children:"Slots auto-generate on the booking page. Manage hours in the Staff tab."})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Monthly Overview"}),a.jsx(XO,{slotsByDate:nn,bookingsByDate:Sn,selectedDate:le,onSelectDate:Y,recurringDayFlags:Ve,breaksByDate:xt}),le&&a.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[a.jsxs("span",{className:"text-sm text-slate-600",children:["Showing: ",a.jsx("strong",{className:"text-slate-900",children:new Date(le+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),a.jsx("button",{onClick:()=>Y(null),className:"text-xs px-3 py-1 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-medium transition-all border border-slate-200",children:"Show All"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:it.length>0?"Add Custom Slots":"Create Time Slots"}),it.length>0&&a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Use this for one-off availability outside regular hours."}),!it.length&&a.jsx("div",{className:"mb-4"}),a.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[V.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Staff Member"}),a.jsxs("select",{value:be.staffId,onChange:z=>fe({...be,staffId:z.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[a.jsx("option",{value:"",children:"Select a staff member"}),V.map(z=>a.jsxs("option",{value:z.id,children:[z.name,z.role?`  ${z.role}`:""]},z.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Date"}),a.jsx("input",{type:"date",value:be.date,onChange:z=>fe({...be,date:z.target.value}),required:!0,min:new Date().toISOString().split("T")[0],className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Start"}),a.jsx("input",{type:"time",value:be.startTime,onChange:z=>fe({...be,startTime:z.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"End"}),a.jsx("input",{type:"time",value:be.endTime,onChange:z=>fe({...be,endTime:z.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Slot Duration"}),(()=>{const[z,ae]=be.startTime.split(":").map(Number),[Ee,Se]=be.endTime.split(":").map(Number),Ue=Ee*60+Se-(z*60+ae),de=[{value:"15",label:"15 minutes"},{value:"30",label:"30 minutes"},{value:"45",label:"45 minutes"},{value:"60",label:"1 hour"},{value:"90",label:"1.5 hours"},{value:"120",label:"2 hours"}].filter(je=>parseInt(je.value)<=Ue);return a.jsx("select",{value:be.slotDuration,onChange:je=>fe({...be,slotDuration:je.target.value}),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:de.length>0?de.map(je=>a.jsx("option",{value:je.value,children:je.label},je.value)):a.jsx("option",{value:"15",children:"15 minutes"})})})()]}),a.jsxs("button",{type:"submit",className:"w-full flex items-center justify-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(Ja,{className:"w-4 h-4"}),"Generate Slots"]})]}),a.jsxs("div",{className:"mt-4 p-3.5 bg-blue-50 border border-blue-100 rounded-xl text-xs text-slate-600 leading-relaxed",children:[a.jsx("strong",{className:"text-slate-700",children:" Tip:"})," ",it.length>0?"Weekly hours auto-generate slots. Use this for one-off slots outside regular hours.":V.length>0?"Select a staff member, pick a date, and set working hours to create slots.":"Set your hours and slot duration. We'll create all the time slots for that day."]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:le?"Bookings":"All Bookings"}),Lt.pending>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 border border-amber-200 text-xs font-bold rounded-full",children:[Lt.pending," pending"]})]}),a.jsx("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:xs.length})]}),a.jsx("div",{className:"flex items-center gap-1 mb-4 p-1 bg-slate-100 rounded-lg overflow-x-auto",children:[{key:"all",label:"All"},{key:"pending",label:"Pending"},{key:"confirmed",label:"Confirmed"},{key:"cancelled",label:"Cancelled"}].map(z=>a.jsxs("button",{onClick:()=>I(z.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-semibold transition-all whitespace-nowrap ${S===z.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[z.label,a.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${S===z.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:Lt[z.key]})]},z.key))}),xs.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(K1,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium",children:S!=="all"?`No ${S} bookings`:le?"No bookings for this date":"No bookings yet"})]}):a.jsx("div",{className:"space-y-2.5 max-h-[500px] overflow-y-auto pr-1",children:xs.sort((z,ae)=>`${z.date}${z.time}`.localeCompare(`${ae.date}${ae.time}`)).map(z=>{const ae=z.status||"confirmed",Ee={pending:"bg-amber-50 text-amber-700 border-amber-200",confirmed:"bg-emerald-50 text-emerald-700 border-emerald-200",rejected:"bg-red-50 text-red-700 border-red-200",cancelled:"bg-slate-100 text-slate-500 border-slate-200"},Se={pending:"Pending",confirmed:"Confirmed",rejected:"Rejected",cancelled:"Cancelled"};return a.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(_l,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:z.clientName}),a.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Ee[ae]}`,children:Se[ae]}),z.recurring&&a.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",title:"Recurring appointment",children:a.jsx(_i,{className:"w-2.5 h-2.5"})})]}),a.jsx("div",{className:"text-xs text-slate-500",children:Ae(z.date,z.time)})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[ae==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>ne(z.id),className:"p-1.5 text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50 rounded-lg transition-all",title:"Approve booking",children:a.jsx(Ks,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Te(z.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Reject booking",children:a.jsx($a,{className:"w-4 h-4"})})]}),ae==="confirmed"&&a.jsx("button",{onClick:()=>pt(z.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Cancel booking",children:a.jsx(ba,{className:"w-3.5 h-3.5"})})]})]}),a.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[z.serviceName&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Nn,{className:"w-3 h-3 text-blue-400"}),a.jsx("span",{className:"font-medium text-slate-700",children:z.serviceName}),z.servicePrice!=null&&a.jsxs("span",{className:"text-blue-600 font-semibold",children:["$",Number(z.servicePrice).toFixed(2)]})]}),z.staffName&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Dt,{className:"w-3 h-3 text-violet-400"}),a.jsx("span",{className:"text-violet-600",children:z.staffName})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nf,{className:"w-3 h-3"}),z.clientEmail]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(cx,{className:"w-3 h-3"}),z.clientPhone]})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[z.refCode&&a.jsxs("span",{className:"font-mono text-[10px] text-slate-400",children:["REF: ",z.refCode]}),z.recurring&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-indigo-50 border border-indigo-200 rounded text-[10px] font-semibold text-indigo-600",children:" Recurring"})]})]})]},z.id)})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:le?"Custom Time Slots":"All Custom Time Slots"}),a.jsx("span",{className:"text-xs font-semibold text-slate-500 bg-slate-100 px-2.5 py-1 rounded-lg",children:le?(nn[le]||[]).length:Qe.length})]}),it.length>0&&a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Recurring slots from weekly hours auto-generate  not shown here."}),!it.length&&a.jsx("div",{className:"mb-4"}),Js.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Et,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:le?"No custom slots for this date":"No custom slots yet"}),a.jsx("p",{className:"text-xs text-slate-400",children:it.length>0?"Recurring hours handle most scheduling.":"Use the form above to generate availability."})]}):a.jsx("div",{className:"space-y-6",children:Js.map(z=>a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100",children:new Date(z).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-2.5",children:nn[z].sort((ae,Ee)=>ae.time.localeCompare(Ee.time)).map(ae=>a.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-3.5 text-center group hover:border-slate-300 transition-all",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900 mb-0.5",children:di(ae.time)}),a.jsxs("div",{className:"text-xs text-slate-500 mb-1",children:[ae.duration," min"]}),ae.staffName&&a.jsxs("div",{className:"text-xs text-violet-600 mb-1.5 flex items-center justify-center gap-1",children:[a.jsx(Dt,{className:"w-3 h-3"}),ae.staffName]}),a.jsx("div",{className:"mb-2",children:ae.available?a.jsx("span",{className:"inline-block px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-md text-xs font-medium",children:"Available"}):a.jsx("span",{className:"inline-block px-2 py-0.5 bg-red-50 text-red-700 border border-red-200 rounded-md text-xs font-medium",children:"Booked"})}),ae.available&&a.jsxs("button",{onClick:()=>ue(ae.id),className:"opacity-0 group-hover:opacity-100 flex items-center justify-center gap-1 w-full px-2 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-xs font-medium transition-all border border-red-200",children:[a.jsx(ba,{className:"w-3 h-3"}),"Remove"]})]},ae.id))})]},z))})]})]})]})]})}function D9({user:n}){const{slug:e}=Ho(),t=Sl(),[i,o]=j.useState(""),[c,d]=j.useState(""),[p,x]=j.useState(""),[g,b]=j.useState(!1);j.useEffect(()=>{if(!n)return;(async()=>{const A=Ln(Je(we,"shops"),bn("slug","==",e)),L=await Cs(A);L.empty||L.docs[0].data().ownerUid===n.uid&&t(`/shop/${e}/dashboard`,{replace:!0})})()},[n,e,t]);const w=async _=>{_.preventDefault(),x(""),b(!0);try{const L=(await A_(Ir,i,c)).user,V=Ln(Je(we,"shops"),bn("slug","==",e)),F=await Cs(V);if(F.empty){x("Shop not found"),b(!1);return}if(F.docs[0].data().ownerUid!==L.uid){x("You are not the owner of this shop"),await Ir.signOut(),b(!1);return}t(`/shop/${e}/dashboard`,{replace:!0})}catch(A){switch(A.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":x("Invalid email or password");break;case"auth/invalid-email":x("Please enter a valid email address");break;case"auth/too-many-requests":x("Too many failed attempts. Please try again later.");break;default:x("Login failed. Please try again.")}d("")}finally{b(!1)}};return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2.5",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:a.jsx(va,{className:"w-5 h-5 text-white"})}),a.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),a.jsxs("form",{onSubmit:w,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),a.jsx("input",{type:"email",value:i,onChange:_=>{o(_.target.value),x("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),a.jsx("input",{type:"password",value:c,onChange:_=>{d(_.target.value),x("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${p?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),p&&a.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[a.jsx("span",{children:""})," ",p]})]}),a.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):"Sign In"})]}),a.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:a.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",a.jsx(nt,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(nt,{to:`/shop/${e}`,className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[a.jsx(ga,{className:"w-3.5 h-3.5"}),"Back to booking page"]})})]})})}function NN({name:n,className:e="w-12 h-12",bgClass:t="bg-blue-100 text-blue-700"}){const i=(n||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return a.jsx("div",{className:`${e} ${t} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function _N(){return a.jsxs(nt,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(va,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function M9(){const{slug:n,refCode:e}=Ho(),[t,i]=j.useState(null),[o,c]=j.useState(null),[d,p]=j.useState(!0),[x,g]=j.useState(!1),[b,w]=j.useState(null),[_,A]=j.useState(null),[L,V]=j.useState(!1),[F,q]=j.useState([]),[Q,H]=j.useState([]),[ie,le]=j.useState([]),[Y,T]=j.useState([]),[E,S]=j.useState(!1),[I,C]=j.useState(!1),[M,R]=j.useState(null),[B,P]=j.useState(null),[O,K]=j.useState(null),[oe,be]=j.useState(!1),[fe,U]=j.useState("");j.useEffect(()=>{(async()=>{p(!0);try{const Le=Ln(Je(we,"shops"),bn("slug","==",n)),pe=await Cs(Le);if(pe.empty)g(!0);else{const Ke=pe.docs[0];i(Ke.data()),c(Ke.id)}}catch(Le){console.error("Error looking up shop:",Le),g(!0)}finally{p(!1)}})()},[n]),j.useEffect(()=>{if(!o)return;(async()=>{try{const Le=Ln(Je(we,"shops",o,"bookings"),bn("refCode","==",e.toUpperCase())),pe=await Cs(Le);if(pe.empty)V(!0);else{const Ke=pe.docs[0];w(Ke.data()),A(Ke.id)}}catch(Le){console.error("Error looking up booking:",Le),V(!0)}})()},[o,e]),j.useEffect(()=>{if(!o||!b)return;const Ce=Gt(Je(we,"shops",o,"bookings"),Fe=>{q(Fe.docs.map(Oe=>({id:Oe.id,...Oe.data()})))}),Le=Gt(Je(we,"shops",o,"availability"),Fe=>{const Oe=new Date,We=Fe.docs.map(Qe=>({id:Qe.id,...Qe.data()})).filter(Qe=>new Date(`${Qe.date}T${Qe.time}`)>Oe);H(We)}),pe=Gt(Je(we,"shops",o,"staff"),Fe=>{le(Fe.docs.map(Oe=>({id:Oe.id,...Oe.data()})).filter(Oe=>Oe.active!==!1).sort((Oe,We)=>(Oe.name||"").localeCompare(We.name||"")))}),Ke=Gt(Je(we,"shops",o,"services"),Fe=>{T(Fe.docs.map(Oe=>({id:Oe.id,...Oe.data()})).filter(Oe=>Oe.active!==!1))});return()=>{Ce(),Le(),pe(),Ke()}},[o,b]);const Z=t?.bufferMinutes||0,ue=j.useMemo(()=>{if(!b)return null;if(b.serviceId){const Ce=Y.find(Le=>Le.id===b.serviceId);if(Ce)return Ce}return b.serviceName?{id:b.serviceId,name:b.serviceName,price:b.servicePrice,duration:b.serviceDuration||b.duration}:null},[b,Y]),me=j.useMemo(()=>{if(!E||!b)return[];const Ce=new Date,Le=ue?.duration||b.duration||60;let pe=Q.filter(Qe=>Qe.available);pe=pe.filter(Qe=>Qe.duration>=Le),b.staffId&&(pe=pe.filter(Qe=>Qe.staffId===b.staffId||!Qe.staffId));const Ke=b.staffId?ie.filter(Qe=>Qe.id===b.staffId):ie,Fe=tS(Ke,Le,Z,4).filter(Qe=>new Date(`${Qe.date}T${Qe.time}`)>Ce),Oe=nS(Fe,pe),We=F.filter(Qe=>Qe.id!==_);return sS(Oe,We,Z)},[E,b,_,Q,ie,F,Z,ue]),ge=j.useMemo(()=>[...new Set(me.map(Ce=>Ce.date))].sort(),[me]),De=j.useMemo(()=>B?me.filter(Ce=>Ce.date===B):[],[B,me]),Ye=async(Ce="single")=>{be(!0);try{if(await tt(Ge(we,"shops",o,"bookings",_),{status:"cancelled"}),b.slotId&&!b.slotId.startsWith("wh-")&&!b.slotId.startsWith("recurring-"))try{await tt(Ge(we,"shops",o,"availability",b.slotId),{available:!0})}catch(Le){console.warn("Could not re-open slot:",Le)}if(Ce==="future"&&b.recurringGroupId){const Le=F.filter(pe=>pe.recurringGroupId===b.recurringGroupId&&pe.id!==_&&pe.date>=b.date&&(pe.status==="pending"||pe.status==="confirmed"));for(const pe of Le)if(await tt(Ge(we,"shops",o,"bookings",pe.id),{status:"cancelled"}),pe.slotId&&!pe.slotId.startsWith("wh-")&&!pe.slotId.startsWith("recurring-"))try{await tt(Ge(we,"shops",o,"availability",pe.slotId),{available:!0})}catch(Ke){console.warn("Could not re-open slot:",Ke)}}w(Le=>({...Le,status:"cancelled"})),C(!1),R(null),U("cancelled")}catch(Le){console.error("Cancel error:",Le),U("error")}finally{be(!1)}},pt=async()=>{if(O){be(!0);try{const Ce={date:O.date,time:O.time,slotId:O.id};if(O.staffId&&(Ce.staffId=O.staffId,Ce.staffName=O.staffName||""),t?.requireApproval&&(Ce.status="pending"),b.slotId&&!b.slotId.startsWith("wh-"))try{await tt(Ge(we,"shops",o,"availability",b.slotId),{available:!0})}catch(Le){console.warn("Could not re-open old slot:",Le)}if(!O.generated&&O.id)try{await tt(Ge(we,"shops",o,"availability",O.id),{available:!1})}catch(Le){console.warn("Could not block new slot:",Le)}await tt(Ge(we,"shops",o,"bookings",_),Ce),w(Le=>({...Le,...Ce})),S(!1),P(null),K(null),U("rescheduled")}catch(Ce){console.error("Reschedule error:",Ce),U("error")}finally{be(!1)}}},dt=Ce=>new Date(Ce+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),Wt=Ce=>{const[Le,pe]=Ce.split(":"),Ke=parseInt(Le),Fe=Ke>=12?"PM":"AM";return`${Ke%12||12}:${pe} ${Fe}`},ne=Ce=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(Ce),Te=Ce=>{if(!Ce)return"";if(Ce<60)return`${Ce} min`;const Le=Math.floor(Ce/60),pe=Ce%60;return pe?`${Le}h ${pe}m`:`${Le} hour${Le>1?"s":""}`};if(d)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(x)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Et,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(ga,{className:"w-4 h-4"}),"Go Home"]})]})});if(L)return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),a.jsx(_N,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(ta,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Not Found"}),a.jsx("p",{className:"text-slate-600 mb-2",children:"No booking found with reference code"}),a.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),a.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Et,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking"})]})});const W=b.status||"confirmed",ye=W==="pending"||W==="confirmed",Ae=W==="cancelled",Ve=W==="rejected",xt={pending:{label:"Pending Approval",color:"bg-amber-100 text-amber-700 border-amber-200",icon:Zt},confirmed:{label:"Confirmed",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Rs},cancelled:{label:"Cancelled",color:"bg-slate-100 text-slate-500 border-slate-200",icon:$a},rejected:{label:"Rejected",color:"bg-red-100 text-red-700 border-red-200",icon:$a}},it=xt[W]||xt.confirmed,rt=it.icon;return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),a.jsx(_N,{})]})}),a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[fe==="rescheduled"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(P2,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Rescheduled!"}),a.jsx("p",{className:"text-slate-600 mb-4",children:t?.requireApproval?"Your booking has been rescheduled and is pending approval.":"Your booking has been successfully rescheduled."}),a.jsx("button",{onClick:()=>U(""),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View updated details "})]})}),fe==="cancelled"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx($a,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Cancelled"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking has been cancelled."}),a.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[a.jsx(Et,{className:"w-4 h-4"}),"Book a new appointment"]})]})}),fe==="error"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Something went wrong. Please try again."})]})}),!E&&a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Your Booking"}),a.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference: ",a.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),(Ae||Ve)&&a.jsxs("div",{className:`mb-4 p-4 rounded-xl border flex items-center gap-3 ${Ae?"bg-slate-50 border-slate-200":"bg-red-50 border-red-200"}`,children:[a.jsx(rt,{className:`w-5 h-5 ${Ae?"text-slate-400":"text-red-500"}`}),a.jsx("span",{className:`font-medium text-sm ${Ae?"text-slate-600":"text-red-700"}`,children:Ae?"This booking has been cancelled.":"This booking has been rejected by the shop."})]}),b.recurringGroupId&&a.jsxs("div",{className:"mb-4 p-3.5 bg-blue-50 border border-blue-200 rounded-xl flex items-center gap-2.5",children:[a.jsx(_i,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Part of a recurring series"}),b.recurringInterval&&a.jsxs("p",{className:"text-xs text-blue-600 mt-0.5",children:["Repeats every ",b.recurringInterval==="weekly"?"week":b.recurringInterval==="biweekly"?"2 weeks":b.recurringInterval==="fourweekly"?"4 weeks":b.recurringInterval==="monthly"?"month":b.recurringInterval]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${it.color}`,children:[a.jsx(rt,{className:"w-3.5 h-3.5"}),it.label]})]}),b.serviceName&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Nn,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.servicePrice!=null&&a.jsx("span",{className:"font-bold text-blue-600",children:ne(b.servicePrice)})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx(NN,{name:b.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Et,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[dt(b.date)," at ",Wt(b.time)]})]}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Zt,{className:"w-4 h-4 text-slate-500"})}),a.jsx("span",{children:Te(b.serviceDuration||b.duration)})]})]}),ye&&!fe&&a.jsx("div",{className:"space-y-3",children:I?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 animate-scale-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(ta,{className:"w-5 h-5 text-red-500"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-slate-900",children:"Are you sure?"}),a.jsx("p",{className:"text-sm text-slate-600",children:"This action cannot be undone."})]})]}),b.recurringGroupId&&!M&&a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsxs("button",{onClick:()=>R("single"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx($a,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this appointment only"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments in the series remain active"})]})]}),a.jsxs("button",{onClick:()=>R("future"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[a.jsx(_i,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future appointments"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments in the series"})]})]}),a.jsx("button",{onClick:()=>C(!1),className:"w-full px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Go Back"})]}),(!b.recurringGroupId||M)&&a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>Ye(M||"single"),disabled:oe,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold transition-all disabled:opacity-50",children:[oe?a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}):a.jsx($a,{className:"w-4 h-4"}),oe?"Cancelling":M==="future"?"Cancel All Future":"Yes, Cancel"]}),a.jsx("button",{onClick:()=>{M?R(null):C(!1)},disabled:oe,className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Go Back"})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{S(!0),U("")},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(sm,{className:"w-4 h-4"}),"Reschedule Booking"]}),a.jsxs("button",{onClick:()=>{C(!0),R(null)},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-white hover:bg-red-50 text-red-600 rounded-xl font-semibold border border-red-200 hover:border-red-300 transition-all",children:[a.jsx($a,{className:"w-4 h-4"}),"Cancel Booking"]})]})}),(Ae||Ve)&&a.jsx("div",{className:"text-center",children:a.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[a.jsx(Et,{className:"w-4 h-4"}),"Book Again"]})})]}),E&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[a.jsxs("button",{onClick:()=>{S(!1),P(null),K(null)},className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[a.jsx(ga,{className:"w-3.5 h-3.5"}),"Back to Booking"]}),b.serviceName&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[a.jsx(Nn,{className:"w-3.5 h-3.5 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName}),b.servicePrice!=null&&a.jsx("span",{className:"text-blue-600 font-bold",children:ne(b.servicePrice)})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[a.jsx(NN,{name:b.staffName,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a New Time"}),a.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Pick a new date and time for your appointment"})]}),ge.length===0?a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(Et,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),a.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"No time slots are currently available. Check back soon!"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-8",children:a.jsx($2,{availableDates:ge,selectedDate:B,onSelectDate:Ce=>{P(Ce),K(null)}})}),B&&a.jsxs("div",{className:"animate-slide-down",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",dt(B)]}),a.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[De.length," slot",De.length!==1?"s":""]})]}),De.length===0?a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:a.jsx("p",{className:"text-slate-500",children:"No slots available for this date"})}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:De.sort((Ce,Le)=>Ce.time.localeCompare(Le.time)).map(Ce=>{const Le=O?.id===Ce.id;return a.jsxs("button",{onClick:()=>K(Ce),className:`group border rounded-xl p-4 transition-all duration-200 text-center ${Le?"bg-blue-600 border-blue-600 text-white shadow-md shadow-blue-600/30":"bg-white border-slate-200 hover:border-blue-400 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5"}`,children:[a.jsx("div",{className:`text-lg font-bold mb-1 ${Le?"text-white":"text-slate-900 group-hover:text-blue-700"} transition-colors`,children:Wt(Ce.time)}),Ce.staffName&&a.jsxs("div",{className:`text-xs mb-0.5 flex items-center justify-center gap-1 ${Le?"text-blue-100":"text-violet-600"}`,children:[a.jsx(Dt,{className:"w-3 h-3"}),Ce.staffName]}),a.jsx("div",{className:`text-xs ${Le?"text-blue-200":"text-slate-400"}`,children:Te(b.serviceDuration||b.duration)})]},Ce.id)})}),O&&a.jsxs("div",{className:"mt-6 animate-fade-in",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-blue-200 shadow-sm p-5 mb-4",children:[a.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"New Appointment Time"}),a.jsxs("div",{className:"flex items-center gap-2.5 text-sm",children:[a.jsx(Et,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-semibold text-slate-800",children:[dt(O.date)," at ",Wt(O.time)]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:pt,disabled:oe,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed",children:oe?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Rescheduling"]}):a.jsxs(a.Fragment,{children:[a.jsx(Rs,{className:"w-4 h-4"}),"Confirm Reschedule"]})}),a.jsx("button",{onClick:()=>K(null),className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]})]}),!B&&a.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]})]}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(nt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})})]})}function jN(){return a.jsxs(nt,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(va,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function O9(n){if(!n)return"Any time";const e=t=>{const[i,o]=t.split(":").map(Number),c=i>=12?"PM":"AM",d=i%12||12;return o===0?`${d}${c}`:`${d}:${o.toString().padStart(2,"0")}${c}`};return n.start==="00:00"&&n.end==="23:59"?"Any time":`${e(n.start)}  ${e(n.end)}`}function P9(n){if(!n||n.length===0)return"Any day";const e={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return n.map(t=>e[t]||t).join(", ")}function V9(n){if(!n)return"";const e=new Date,t=new Date(n),i=e-t,o=Math.floor(i/6e4);if(o<60)return`${o}m ago`;const c=Math.floor(o/60);return c<24?`${c}h ago`:`${Math.floor(c/24)}d ago`}function L9(){const{slug:n,refCode:e}=Ho(),[t,i]=j.useState(null),[o,c]=j.useState(null),[d,p]=j.useState(!0),[x,g]=j.useState(!1),[b,w]=j.useState(null),[_,A]=j.useState(!1),[L,V]=j.useState(null);if(j.useEffect(()=>{(async()=>{p(!0);try{const Y=Ln(Je(we,"shops"),bn("slug","==",n)),T=await Cs(Y);if(T.empty)g(!0);else{const E=T.docs[0];i(E.data()),c(E.id)}}catch(Y){console.error("Error looking up shop:",Y),g(!0)}finally{p(!1)}})()},[n]),j.useEffect(()=>{if(!o)return;(async()=>{try{const Y=Ln(Je(we,"shops",o,"waitlist"),bn("refCode","==",e.toUpperCase())),T=await Cs(Y);if(T.empty){A(!0);return}const E=T.docs[0],S={id:E.id,...E.data()};w(S);const I=Ln(Je(we,"shops",o,"waitlist"),bn("serviceId","==",S.serviceId),bn("status","==","waiting")),R=(await Cs(I)).docs.map(B=>({id:B.id,...B.data()})).sort((B,P)=>(B.createdAt||"").localeCompare(P.createdAt||"")).findIndex(B=>B.id===S.id);R>=0&&V(R+1)}catch(Y){console.error("Error looking up waitlist entry:",Y),A(!0)}})()},[o,e]),d)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(x)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Et,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(ga,{className:"w-4 h-4"}),"Go Home"]})]})});if(_)return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),a.jsx(jN,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(ta,{className:"w-8 h-8 text-amber-500"})}),a.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Waitlist Entry Not Found"}),a.jsx("p",{className:"text-slate-600 mb-2",children:"No waitlist entry found with reference code"}),a.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),a.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(Et,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!b)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading waitlist"})]})});const F={waiting:{label:"Waiting",color:"bg-blue-100 text-blue-700 border-blue-200",icon:Zt},notified:{label:"Slot Available!",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:_o},booked:{label:"Booked",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:Rs},expired:{label:"Expired",color:"bg-slate-100 text-slate-500 border-slate-200",icon:Zt}},q=F[b.status]||F.waiting,Q=q.icon,H=le=>le?new Date(le+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):"",ie=le=>{if(!le)return"";const[Y,T]=le.split(":"),E=parseInt(Y),S=E>=12?"PM":"AM";return`${E%12||12}:${T} ${S}`};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(t?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:t?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),a.jsx(jN,{})]})}),a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:a.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[b.status==="notified"&&a.jsx("div",{className:"mb-6 animate-scale-in",children:a.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(_o,{className:"w-8 h-8 text-emerald-600"})}),a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"A Slot Is Available!"}),a.jsxs("p",{className:"text-slate-600 mb-4",children:["A slot has opened up for ",b.serviceName,". Book now before it's taken!"]}),b.notifiedSlot&&a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-xl text-sm text-emerald-700 font-medium mb-4",children:[a.jsx(Et,{className:"w-4 h-4"}),H(b.notifiedSlot.date)," at"," ",ie(b.notifiedSlot.time),b.notifiedSlot.staffName&&a.jsxs("span",{className:"text-emerald-600",children:[" ","with ",b.notifiedSlot.staffName]})]}),a.jsx("div",{children:a.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-emerald-600/20 hover:shadow-lg",children:[a.jsx(Et,{className:"w-4 h-4"}),"Book Now "]})})]})}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Waitlist Status"}),a.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference:"," ",a.jsx("span",{className:"font-mono font-bold text-blue-600",children:(b.refCode||e).toUpperCase()})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${q.color}`,children:[a.jsx(Q,{className:"w-3.5 h-3.5"}),q.label]})]}),b.status==="waiting"&&L!=null&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Position"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(ix,{className:"w-4 h-4 text-blue-500"}),a.jsxs("span",{className:"font-bold text-slate-900 text-lg",children:["#",L]}),a.jsx("span",{className:"text-sm text-slate-500",children:"in line"})]})]}),b.serviceName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Nn,{className:"w-4 h-4 text-blue-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.serviceName})]}),b.staffName&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center",children:a.jsx(Dt,{className:"w-4 h-4 text-violet-600"})}),a.jsx("span",{className:"font-semibold text-slate-800",children:b.staffName})]}),b.preferredDate&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Et,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Preferred: ",H(b.preferredDate)]})]}),b.preferredDays&&b.preferredDays.length>0&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Et,{className:"w-4 h-4 text-slate-600"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Days: ",P9(b.preferredDays)]})]}),b.preferredTimeRange&&a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:a.jsx(Zt,{className:"w-4 h-4 text-slate-500"})}),a.jsxs("span",{className:"text-sm text-slate-700",children:["Time: ",O9(b.preferredTimeRange)]})]}),b.createdAt&&a.jsxs("div",{className:"pt-2 border-t border-slate-100 text-xs text-slate-400",children:["Joined ",V9(b.createdAt)]})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs(nt,{to:`/shop/${n}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[a.jsx(Et,{className:"w-4 h-4"}),b.status==="notified"?"Book Now":"Check Available Slots"]})})]})}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(nt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})})})]})}function U9(){return a.jsxs(nt,{to:"/",className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:a.jsx(va,{className:"w-3.5 h-3.5 text-white"})}),a.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Spot",a.jsx("span",{className:"text-amber-500",children:"Bookie"})]})]})}function SN(n){if(n==null)return"";if(n<1)return"Next up!";if(n<60)return`~${n} min`;const e=Math.floor(n/60),t=n%60;return t>0?`~${e}h ${t}m`:`~${e}h`}function B9(){const{slug:n}=Ho(),[e,t]=j.useState(null),[i,o]=j.useState(null),[c,d]=j.useState(!0),[p,x]=j.useState(!1),[g,b]=j.useState([]),[w,_]=j.useState([]),[A,L]=j.useState([]),[V,F]=j.useState(!1),[q,Q]=j.useState(!1),[H,ie]=j.useState(!1),[le,Y]=j.useState(""),[T,E]=j.useState(0),[S,I]=j.useState({clientName:"",serviceId:""}),[C,M]=j.useState(Date.now());j.useEffect(()=>{const fe=setInterval(()=>M(Date.now()),3e4);return()=>clearInterval(fe)},[]),j.useEffect(()=>{(async()=>{d(!0);try{const U=Ln(Je(we,"shops"),bn("slug","==",n)),Z=await Cs(U);if(Z.empty)x(!0);else{const ue=Z.docs[0];t(ue.data()),o(ue.id)}}catch(U){console.error("Error looking up shop:",U),x(!0)}finally{d(!1)}})()},[n]),j.useEffect(()=>{if(!i)return;const fe=Gt(Je(we,"shops",i,"walkins"),ue=>{const me=ue.docs.map(ge=>({id:ge.id,...ge.data()}));b(me)}),U=Gt(Je(we,"shops",i,"staff"),ue=>{const me=ue.docs.map(ge=>({id:ge.id,...ge.data()})).filter(ge=>ge.active!==!1);_(me)}),Z=Gt(Je(we,"shops",i,"services"),ue=>{const me=ue.docs.map(ge=>({id:ge.id,...ge.data()})).filter(ge=>ge.active!==!1).sort((ge,De)=>(ge.name||"").localeCompare(De.name||""));L(me)});return()=>{fe(),U(),Z()}},[i]);const R=j.useMemo(()=>g.filter(fe=>fe.status==="waiting").sort((fe,U)=>(fe.position||0)-(U.position||0)),[g]),B=j.useMemo(()=>g.filter(fe=>fe.status==="in-progress"),[g]),P=j.useMemo(()=>Math.max(w.length,1),[w]),O=j.useMemo(()=>iS({waitingQueue:R,inProgress:B,staffCount:P,defaultDuration:30}),[R,B,P]),K=j.useMemo(()=>rS({waitingAhead:R,inProgress:B,staffCount:P,defaultDuration:30}),[R,B,P]),oe=j.useMemo(()=>{const fe=new Date;return fe.setHours(0,0,0,0),g.filter(U=>{const Z=U.joinedAt?.toDate?.()||(U.joinedAt?new Date(U.joinedAt):null);return Z&&Z>=fe}).length},[g]),be=async fe=>{fe.preventDefault(),Q(!0);const U=A.find(ge=>ge.id===S.serviceId),ue=(R.length>0?Math.max(...R.map(ge=>ge.position||0)):0)+1,me=S.clientName.trim()||`Walk-in #${oe+1}`;try{await _a(Je(we,"shops",i,"walkins"),{clientName:me,serviceId:S.serviceId||null,serviceName:U?.name||null,staffId:null,staffName:null,estimatedDuration:U?.duration||30,status:"waiting",position:ue,joinedAt:It.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),Y(me),E(ue),ie(!0),F(!1),I({clientName:"",serviceId:""})}catch(ge){console.error("Error joining queue:",ge)}finally{Q(!1)}};return c?a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):p?a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:a.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:a.jsx(Et,{className:"w-8 h-8 text-slate-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),a.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,a.jsx("span",{className:"font-mono text-blue-600",children:n}),'".']}),a.jsxs(nt,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[a.jsx(ga,{className:"w-4 h-4"}),"Go Home"]})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e?.name||"")[0]?.toUpperCase()||"S"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e?.name}),a.jsx("p",{className:"text-xs text-slate-500",children:"Live Queue"})]})]}),a.jsx(U9,{})]})}),a.jsxs("div",{className:"max-w-2xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[H&&a.jsxs("div",{className:"mb-6 bg-emerald-50 border border-emerald-200 rounded-2xl p-6 text-center animate-scale-in",children:[a.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(Dt,{className:"w-7 h-7 text-emerald-600"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"You're in the queue!"}),a.jsxs("p",{className:"text-slate-600 text-sm mb-2",children:[a.jsx("strong",{children:le}),"  Position #",T]}),a.jsx("button",{onClick:()=>ie(!1),className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"Dismiss"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Dt,{className:"w-6 h-6 text-blue-600"})}),a.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:R.length}),a.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"People Waiting"})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:a.jsx(z2,{className:"w-6 h-6 text-amber-600"})}),a.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:SN(K)}),a.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"Est. Wait (New)"})]})]}),B.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(Scissors,{className:"w-5 h-5 text-emerald-500"}),"Currently Being Served"]}),a.jsx("div",{className:"space-y-2",children:B.map(fe=>a.jsxs("div",{className:"bg-white rounded-xl border border-emerald-200 p-4 flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:a.jsx(Scissors,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-slate-900",children:fe.clientName}),a.jsx("div",{className:"text-xs text-slate-500",children:fe.serviceName||"Service in progress"})]})]},fe.id))})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[a.jsx(Zt,{className:"w-5 h-5 text-blue-500"}),"Queue"]}),R.length===0?a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-10 text-center",children:[a.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(Dt,{className:"w-7 h-7 text-emerald-500"})}),a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"No Wait!"}),a.jsx("p",{className:"text-sm text-slate-500",children:"The queue is empty  you can walk right in!"})]}):a.jsx("div",{className:"space-y-2",children:R.map((fe,U)=>{const Z=O.get(fe.id);return a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4 flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center font-extrabold text-blue-700 text-lg flex-shrink-0",children:U+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-semibold text-slate-900 text-lg truncate",children:fe.clientName}),fe.serviceName&&a.jsxs("div",{className:"text-sm text-slate-500 flex items-center gap-1",children:[a.jsx(Nn,{className:"w-3 h-3"}),fe.serviceName]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsx("div",{className:"text-lg font-bold text-amber-600",children:SN(Z)}),a.jsx("div",{className:"text-xs text-slate-400",children:"est. wait"})]})]},fe.id)})})]}),!H&&a.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:V?a.jsxs("form",{onSubmit:be,children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Join the Queue"}),a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Your Name"}),a.jsx("input",{type:"text",value:S.clientName,onChange:fe=>I(U=>({...U,clientName:fe.target.value})),placeholder:"Optional",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg"})]}),A.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Service"}),a.jsxs("select",{value:S.serviceId,onChange:fe=>I(U=>({...U,serviceId:fe.target.value})),className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg",children:[a.jsx("option",{value:"",children:"Select a service"}),A.map(fe=>a.jsxs("option",{value:fe.id,children:[fe.name," (",fe.duration,"min  $",Number(fe.price).toFixed(2),")"]},fe.id))]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{type:"submit",disabled:q,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[a.jsx(Ja,{className:"w-5 h-5"}),q?"Joining":"Join Queue"]}),a.jsx("button",{type:"button",onClick:()=>{F(!1),I({clientName:"",serviceId:""})},className:"px-6 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]}):a.jsxs("button",{onClick:()=>F(!0),className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[a.jsx(Ja,{className:"w-5 h-5"}),"Join the Queue"]})})]}),a.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-between",children:[a.jsxs(nt,{to:`/shop/${n}`,className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[a.jsx(Et,{className:"w-4 h-4"}),"Book Online"]}),a.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",a.jsx(nt,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"SpotBookie"})]})]})})]})}const z9="type.googleapis.com/google.protobuf.Int64Value",F9="type.googleapis.com/google.protobuf.UInt64Value";function lS(n,e){const t={};for(const i in n)n.hasOwnProperty(i)&&(t[i]=e(n[i]));return t}function jf(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>jf(e));if(typeof n=="function"||typeof n=="object")return lS(n,e=>jf(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Fo(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case z9:case F9:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Fo(e)):typeof n=="function"||typeof n=="object"?lS(n,e=>Fo(e)):n}const Ag="functions";const EN={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class vn extends Sa{constructor(e,t,i){super(`${Ag}/${e}`,t||""),this.details=i,Object.setPrototypeOf(this,vn.prototype)}}function $9(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Sf(n,e){let t=$9(n),i=t,o;try{const c=e&&e.error;if(c){const d=c.status;if(typeof d=="string"){if(!EN[d])return new vn("internal","internal");t=EN[d],i=d}const p=c.message;typeof p=="string"&&(i=p),o=c.details,o!==void 0&&(o=Fo(o))}}catch{}return t==="ok"?null:new vn(t,i,o)}class q9{constructor(e,t,i,o){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,xn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=i.getImmediate({optional:!0}),this.auth||t.get().then(c=>this.auth=c,()=>{}),this.messaging||i.get().then(c=>this.messaging=c,()=>{}),this.appCheck||o?.get().then(c=>this.appCheck=c,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),i=await this.getMessagingToken(),o=await this.getAppCheckToken(e);return{authToken:t,messagingToken:i,appCheckToken:o}}}const fx="us-central1",H9=/^data: (.*?)(?:\n|$)/;function G9(n){let e=null;return{promise:new Promise((t,i)=>{e=setTimeout(()=>{i(new vn("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class Y9{constructor(e,t,i,o,c=fx,d=(...p)=>fetch(...p)){this.app=e,this.fetchImpl=d,this.emulatorOrigin=null,this.contextProvider=new q9(e,t,i,o),this.cancelAllRequests=new Promise(p=>{this.deleteService=()=>Promise.resolve(p())});try{const p=new URL(c);this.customDomain=p.origin+(p.pathname==="/"?"":p.pathname),this.region=fx}catch{this.customDomain=null,this.region=c}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function W9(n,e,t){const i=Za(e);n.emulatorOrigin=`http${i?"s":""}://${e}:${t}`,i&&(kf(n.emulatorOrigin+"/backends"),Cf("Functions",!0))}function Q9(n,e,t){const i=o=>X9(n,e,o,{});return i.stream=(o,c)=>Z9(n,e,o,c),i}function oS(n){return n.emulatorOrigin&&Za(n.emulatorOrigin)?"include":void 0}async function K9(n,e,t,i,o){t["Content-Type"]="application/json";let c;try{c=await i(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:oS(o)})}catch{return{status:0,json:null}}let d=null;try{d=await c.json()}catch{}return{status:c.status,json:d}}async function cS(n,e){const t={},i=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return i.authToken&&(t.Authorization="Bearer "+i.authToken),i.messagingToken&&(t["Firebase-Instance-ID-Token"]=i.messagingToken),i.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=i.appCheckToken),t}function X9(n,e,t,i){const o=n._url(e);return J9(n,o,t,i)}async function J9(n,e,t,i){t=jf(t);const o={data:t},c=await cS(n,i),d=i.timeout||7e4,p=G9(d),x=await Promise.race([K9(e,o,c,n.fetchImpl,n),p.promise,n.cancelAllRequests]);if(p.cancel(),!x)throw new vn("cancelled","Firebase Functions instance was deleted.");const g=Sf(x.status,x.json);if(g)throw g;if(!x.json)throw new vn("internal","Response is not valid JSON object.");let b=x.json.data;if(typeof b>"u"&&(b=x.json.result),typeof b>"u")throw new vn("internal","Response is missing data field.");return{data:Fo(b)}}function Z9(n,e,t,i){const o=n._url(e);return eP(n,o,t,i||{})}async function eP(n,e,t,i){t=jf(t);const o={data:t},c=await cS(n,i);c["Content-Type"]="application/json",c.Accept="text/event-stream";let d;try{d=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(o),headers:c,signal:i?.signal,credentials:oS(n)})}catch(_){if(_ instanceof Error&&_.name==="AbortError"){const L=new vn("cancelled","Request was cancelled.");return{data:Promise.reject(L),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(L)}}}}}}const A=Sf(0,null);return{data:Promise.reject(A),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(A)}}}}}}let p,x;const g=new Promise((_,A)=>{p=_,x=A});i?.signal?.addEventListener("abort",()=>{const _=new vn("cancelled","Request was cancelled.");x(_)});const b=d.body.getReader(),w=tP(b,p,x,i?.signal);return{stream:{[Symbol.asyncIterator](){const _=w.getReader();return{async next(){const{value:A,done:L}=await _.read();return{value:A,done:L}},async return(){return await _.cancel(),{done:!0,value:void 0}}}}},data:g}}function tP(n,e,t,i){const o=(d,p)=>{const x=d.match(H9);if(!x)return;const g=x[1];try{const b=JSON.parse(g);if("result"in b){e(Fo(b.result));return}if("message"in b){p.enqueue(Fo(b.message));return}if("error"in b){const w=Sf(0,b);p.error(w),t(w);return}}catch(b){if(b instanceof vn){p.error(b),t(b);return}}},c=new TextDecoder;return new ReadableStream({start(d){let p="";return x();async function x(){if(i?.aborted){const g=new vn("cancelled","Request was cancelled");return d.error(g),t(g),Promise.resolve()}try{const{value:g,done:b}=await n.read();if(b){p.trim()&&o(p.trim(),d),d.close();return}if(i?.aborted){const _=new vn("cancelled","Request was cancelled");d.error(_),t(_),await n.cancel();return}p+=c.decode(g,{stream:!0});const w=p.split(`
`);p=w.pop()||"";for(const _ of w)_.trim()&&o(_.trim(),d);return x()}catch(g){const b=g instanceof vn?g:Sf(0,null);d.error(b),t(b)}}},cancel(){return n.cancel()}})}const TN="@firebase/functions",AN="0.13.1";const sP="auth-internal",nP="app-check-internal",aP="messaging-internal";function rP(n){const e=(t,{instanceIdentifier:i})=>{const o=t.getProvider("app").getImmediate(),c=t.getProvider(sP),d=t.getProvider(aP),p=t.getProvider(nP);return new Y9(o,c,d,p,i)};ji(new Er(Ag,e,"PUBLIC").setMultipleInstances(!0)),sa(TN,AN,n),sa(TN,AN,"esm2020")}function iP(n=Rf(),e=fx){const i=Lu(Yt(n),Ag).getImmediate({identifier:e}),o=_x("functions");return o&&lP(i,...o),i}function lP(n,e,t){W9(Yt(n),e,t)}function oP(n,e,t){return Q9(Yt(n),e)}rP();const cP=iP(),uP=["aaron.sharp2011@gmail.com"],au={free:0,pro:29,unlimited:79},ul={free:{label:"Free",color:"bg-slate-100 text-slate-700 border-slate-200"},pro:{label:"Pro",color:"bg-blue-100 text-blue-700 border-blue-200"},unlimited:{label:"Unlimited",color:"bg-violet-100 text-violet-700 border-violet-200"}};function dP({user:n}){const e=Sl(),[t,i]=j.useState(!0),[o,c]=j.useState([]),[d,p]=j.useState([]),[x,g]=j.useState("overview"),[b,w]=j.useState(""),[_,A]=j.useState(null),[L,V]=j.useState(null),[F,q]=j.useState(null),[Q,H]=j.useState(""),[ie,le]=j.useState({}),[Y,T]=j.useState(!1),[E,S]=j.useState(null),[I,C]=j.useState(!0),[M,R]=j.useState(!1),[B,P]=j.useState(""),O=n&&uP.includes(n.email?.toLowerCase());j.useEffect(()=>{if(!n){e("/",{replace:!0});return}if(!O){e("/",{replace:!0});return}K()},[n,O,e]);const K=async()=>{i(!0);try{const ye=(await Cs(Je(we,"shops"))).docs.map(xt=>({id:xt.id,...xt.data()}));c(ye);const Ve=(await Cs(Je(we,"users"))).docs.map(xt=>({id:xt.id,...xt.data()}));p(Ve)}catch(W){console.error("Error fetching admin data:",W)}finally{i(!1)}},oe=async()=>{await U0(Ir),e("/",{replace:!0})},be=j.useMemo(()=>{const W={free:0,pro:0,unlimited:0};let ye=0,Ae=0;o.forEach(rt=>{const Ce=rt.subscriptionTier||"free";W[Ce]=(W[Ce]||0)+1,rt.stripeConnectAccountId&&(rt.stripeConnectComplete?ye++:Ae++)});const Ve=W.pro*au.pro+W.unlimited*au.unlimited,xt=new Date;xt.setDate(xt.getDate()-30);const it=o.filter(rt=>rt.createdAt?(rt.createdAt.toDate?rt.createdAt.toDate():new Date(rt.createdAt))>xt:!1);return{totalShops:o.length,tierCounts:W,mrr:Ve,stripeConnectedCount:ye,stripePendingCount:Ae,recentShops:it.length}},[o]),fe=j.useMemo(()=>{if(!b.trim())return o;const W=b.toLowerCase();return o.filter(ye=>ye.name?.toLowerCase().includes(W)||ye.slug?.toLowerCase().includes(W)||ye.ownerEmail?.toLowerCase().includes(W))},[o,b]),U=j.useMemo(()=>[...fe].sort((W,ye)=>{const Ae=W.createdAt?.toDate?W.createdAt.toDate():new Date(W.createdAt||0);return(ye.createdAt?.toDate?ye.createdAt.toDate():new Date(ye.createdAt||0))-Ae}),[fe]),Z=async(W,ye)=>{V(W);try{await tt(Ge(we,"shops",W),{subscriptionTier:ye}),c(Ae=>Ae.map(Ve=>Ve.id===W?{...Ve,subscriptionTier:ye}:Ve))}catch(Ae){console.error("Error changing tier:",Ae)}finally{V(null)}},ue=async(W,ye)=>{V(W);try{await tt(Ge(we,"shops",W),{disabled:!ye}),c(Ae=>Ae.map(Ve=>Ve.id===W?{...Ve,disabled:!ye}:Ve))}catch(Ae){console.error("Error toggling shop status:",Ae)}finally{V(null)}},me=async(W,ye)=>{V(W);try{await tt(Ge(we,"shops",W),{archived:!ye,archivedAt:ye?null:Ni()}),c(Ae=>Ae.map(Ve=>Ve.id===W?{...Ve,archived:!ye,archivedAt:ye?null:new Date().toISOString()}:Ve)),_?.id===W&&A(Ae=>({...Ae,archived:!ye}))}catch(Ae){console.error("Error toggling shop archive status:",Ae)}finally{V(null)}},ge=async W=>{try{const ye=await Cs(Je(we,"shops",W,"bookings")),Ae=new Date().toISOString().split("T")[0],Ve=ye.docs.filter(xt=>{const it=xt.data();return it.date>=Ae&&(it.status==="pending"||it.status==="confirmed"||!it.status)});return le(xt=>({...xt,[W]:Ve.length})),Ve.length}catch(ye){return console.error("Error checking bookings:",ye),0}},De=async W=>{V(W);try{const ye=["staff","bookings","availability","waitlist","schedulePresets","services","walkins","clientNotes"];for(const Ae of ye){const Ve=await Cs(Je(we,"shops",W,Ae));for(const xt of Ve.docs)await ko(Ge(we,"shops",W,Ae,xt.id))}await ko(Ge(we,"shops",W)),c(Ae=>Ae.filter(Ve=>Ve.id!==W)),A(null),q(null),H(""),T(!1)}catch(ye){console.error("Error deleting shop:",ye),alert("An error occurred while deleting the shop. Please try again.")}finally{V(null)}},Ye=async W=>{R(!0);try{const Ae=await oP(cP,"adminDeleteUser")({userId:W,deleteShops:I});if(Ae.data.success){if(p(Ve=>Ve.filter(xt=>xt.id!==W)),I&&Ae.data.shopsDeleted>0){const Ve=await Cs(Je(we,"shops"));c(Ve.docs.map(xt=>({id:xt.id,...xt.data()})))}S(null),C(!0),alert(`User deleted successfully. ${Ae.data.shopsDeleted} shop(s) deleted.`)}}catch(ye){console.error("Error deleting user:",ye),alert(ye.message||"Failed to delete user")}finally{R(!1)}},pt=W=>o.filter(ye=>ye.ownerId===W),dt=j.useMemo(()=>{if(!B)return d;const W=B.toLowerCase();return d.filter(ye=>ye.email?.toLowerCase().includes(W)||ye.displayName?.toLowerCase().includes(W)||ye.id.toLowerCase().includes(W))},[d,B]),Wt=W=>W?(W.toDate?W.toDate():new Date(W)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",ne=W=>W.stripeConnectAccountId?W.stripeConnectComplete?{label:"Connected",color:"bg-emerald-100 text-emerald-700",icon:Rs}:{label:"Pending",color:"bg-amber-100 text-amber-700",icon:Zt}:{label:"None",color:"bg-slate-100 text-slate-500",icon:null};if(t)return a.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading admin panel"})]})});if(!O)return null;const Te=[{key:"overview",label:"Overview",icon:M2},{key:"shops",label:"Shops",icon:br},{key:"users",label:"Users",icon:Dt},{key:"revenue",label:"Revenue",icon:Ro},{key:"support",label:"Support",icon:Yh}];return a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-violet-600 to-purple-600 rounded-xl flex items-center justify-center text-white shadow-md shadow-violet-600/20",children:a.jsx(L2,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:"SpotBookie Admin"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Platform Management"})]})]}),a.jsx("div",{className:"hidden md:flex items-center bg-slate-100 p-1 rounded-xl",children:Te.map(W=>{const ye=W.icon;return a.jsxs("button",{onClick:()=>g(W.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${x===W.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.jsx(ye,{className:"w-4 h-4"}),a.jsx("span",{children:W.label})]},W.key)})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:K,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all",children:[a.jsx(sm,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),a.jsxs("button",{onClick:oe,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",children:[a.jsx(lx,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),a.jsx("div",{className:"md:hidden bg-white border-b border-slate-200 px-4 py-2",children:a.jsx("div",{className:"flex items-center gap-1 overflow-x-auto",children:Te.map(W=>{const ye=W.icon;return a.jsxs("button",{onClick:()=>g(W.key),className:`flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-semibold whitespace-nowrap transition-all ${x===W.key?"bg-violet-100 text-violet-700":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:[a.jsx(ye,{className:"w-4 h-4"}),a.jsx("span",{children:W.label})]},W.key)})})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[x==="overview"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(br,{className:"w-5 h-5 text-blue-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:be.totalShops}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Shops"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:a.jsx(Ro,{className:"w-5 h-5 text-emerald-600"})})}),a.jsxs("div",{className:"text-2xl font-extrabold text-slate-900",children:["$",be.mrr]}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Monthly Recurring Revenue"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-violet-100 rounded-xl flex items-center justify-center",children:a.jsx(yn,{className:"w-5 h-5 text-violet-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:be.stripeConnectedCount}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Stripe Connected"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center",children:a.jsx(Bo,{className:"w-5 h-5 text-amber-600"})})}),a.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:be.recentShops}),a.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"New (Last 30 Days)"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Uo,{className:"w-5 h-5 text-amber-500"}),"Subscription Tiers"]}),a.jsx("div",{className:"space-y-4",children:Object.entries(be.tierCounts).map(([W,ye])=>{const Ae=ul[W]||ul.free,Ve=be.totalShops>0?Math.round(ye/be.totalShops*100):0;return a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-24",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-bold border ${Ae.color}`,children:Ae.label})}),a.jsx("div",{className:"flex-1",children:a.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full transition-all ${W==="free"?"bg-slate-400":W==="pro"?"bg-blue-500":"bg-violet-500"}`,style:{width:`${Ve}%`}})})}),a.jsxs("div",{className:"w-20 text-right",children:[a.jsx("span",{className:"text-sm font-bold text-slate-900",children:ye}),a.jsxs("span",{className:"text-xs text-slate-500 ml-1",children:["(",Ve,"%)"]})]})]},W)})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(yn,{className:"w-5 h-5 text-violet-500"}),"Payment Status"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Rs,{className:"w-5 h-5 text-emerald-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Stripe Connected"})]}),a.jsx("span",{className:"text-lg font-bold text-emerald-700",children:be.stripeConnectedCount})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Zt,{className:"w-5 h-5 text-amber-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Pending Setup"})]}),a.jsx("span",{className:"text-lg font-bold text-amber-700",children:be.stripePendingCount})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(br,{className:"w-5 h-5 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"No Payments"})]}),a.jsx("span",{className:"text-lg font-bold text-slate-700",children:be.totalShops-be.stripeConnectedCount-be.stripePendingCount})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Bo,{className:"w-5 h-5 text-blue-500"}),"Recent Signups"]}),a.jsx("div",{className:"space-y-3",children:U.slice(0,5).map(W=>{const ye=ul[W.subscriptionTier]||ul.free;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-xl border border-slate-200 hover:border-slate-300 transition-all",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:a.jsx(br,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:W.name||"Unnamed Shop"}),a.jsx("div",{className:"text-xs text-slate-500",children:W.ownerEmail})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-bold border ${ye.color}`,children:ye.label}),a.jsx("span",{className:"text-xs text-slate-500",children:Wt(W.createdAt)})]})]},W.id)})})]})]}),x==="shops"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-4 mb-6",children:a.jsxs("div",{className:"relative",children:[a.jsx(Hh,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by name, slug, or email...",value:b,onChange:W=>w(W.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]})}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Shops"}),a.jsxs("span",{className:"text-sm font-medium text-slate-500",children:[fe.length," shop",fe.length!==1?"s":""]})]}),a.jsxs("div",{className:"divide-y divide-slate-100",children:[U.map(W=>{const ye=ul[W.subscriptionTier]||ul.free,Ae=ne(W),Ve=Ae.icon;return a.jsx("div",{className:`p-4 hover:bg-slate-50 transition-all ${W.disabled?"opacity-60":""}`,children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:(W.name||"S")[0].toUpperCase()}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:W.name||"Unnamed Shop"}),a.jsx("span",{className:`px-2 py-0.5 rounded-lg text-[10px] font-bold border ${ye.color}`,children:ye.label}),W.archived&&a.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold bg-amber-100 text-amber-700 border border-amber-200",children:"Archived"}),W.disabled&&a.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold bg-red-100 text-red-700 border border-red-200",children:"Disabled"})]}),a.jsxs("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:["/",W.slug,"  ",W.ownerEmail]}),a.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs",children:[a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-md ${Ae.color}`,children:[Ve&&a.jsx(Ve,{className:"w-3 h-3"}),"Stripe: ",Ae.label]}),a.jsxs("span",{className:"text-slate-400",children:["Created: ",Wt(W.createdAt)]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(nt,{to:`/shop/${W.slug}`,target:"_blank",className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"View public page",children:a.jsx(vu,{className:"w-4 h-4"})}),a.jsx(nt,{to:`/shop/${W.slug}/dashboard`,target:"_blank",className:"p-2 text-slate-400 hover:text-violet-600 hover:bg-violet-50 rounded-lg transition-all",title:"View dashboard (impersonate)",children:a.jsx(xl,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>A(W),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",title:"Manage shop",children:a.jsx(Yh,{className:"w-4 h-4"})})]})]})},W.id)}),U.length===0&&a.jsxs("div",{className:"p-12 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:a.jsx(br,{className:"w-6 h-6 text-slate-400"})}),a.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"No shops found"}),b&&a.jsx("button",{onClick:()=>w(""),className:"mt-2 text-sm text-violet-600 hover:underline",children:"Clear search"})]})]})]})]}),x==="revenue"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Ro,{className:"w-5 h-5 text-emerald-500"}),"MRR Breakdown"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-900",children:"Pro Plans"}),a.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[be.tierCounts.pro," shops  $29/mo"]})]}),a.jsxs("span",{className:"text-lg font-bold text-blue-700",children:["$",be.tierCounts.pro*au.pro]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-violet-50 border border-violet-200 rounded-xl",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-slate-900",children:"Unlimited Plans"}),a.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[be.tierCounts.unlimited," shops  $79/mo"]})]}),a.jsxs("span",{className:"text-lg font-bold text-violet-700",children:["$",be.tierCounts.unlimited*au.unlimited]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:[a.jsx("div",{children:a.jsx("span",{className:"font-bold text-slate-900",children:"Total MRR"})}),a.jsxs("span",{className:"text-2xl font-extrabold text-emerald-700",children:["$",be.mrr]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(yn,{className:"w-5 h-5 text-violet-500"}),"Platform Fees"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(XD,{className:"w-4 h-4 text-slate-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Free Tier"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"5% platform fee on deposit payments via Stripe Connect"})]}),a.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Xo,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Pro & Unlimited"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"No platform fees  shops keep 100% of payments"})]})]}),a.jsx("div",{className:"mt-6 pt-4 border-t border-slate-200",children:a.jsxs("a",{href:"https://dashboard.stripe.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-5 py-3 bg-violet-600 hover:bg-violet-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-violet-600/20 transition-all",children:[a.jsx(xl,{className:"w-4 h-4"}),"Open Stripe Dashboard"]})})]})]}),a.jsxs("div",{className:"mt-6 bg-white rounded-xl border border-slate-200 p-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(br,{className:"w-5 h-5 text-blue-500"}),"Stripe Connect Accounts"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-emerald-700",children:be.stripeConnectedCount}),a.jsx("div",{className:"text-sm font-medium text-emerald-600 mt-1",children:"Fully Connected"})]}),a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-amber-700",children:be.stripePendingCount}),a.jsx("div",{className:"text-sm font-medium text-amber-600 mt-1",children:"Pending Setup"})]}),a.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl text-center",children:[a.jsx("div",{className:"text-3xl font-extrabold text-slate-700",children:be.totalShops-be.stripeConnectedCount-be.stripePendingCount}),a.jsx("div",{className:"text-sm font-medium text-slate-600 mt-1",children:"Not Started"})]})]})]})]}),x==="users"&&a.jsx("div",{className:"animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("div",{className:"flex items-center justify-between mb-6",children:a.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[a.jsx(Dt,{className:"w-5 h-5 text-violet-500"}),"All Users (",d.length,")"]})}),a.jsxs("div",{className:"relative mb-6",children:[a.jsx(Hh,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by email, name, or ID...",value:B,onChange:W=>P(W.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),a.jsx("div",{className:"space-y-3",children:dt.length===0?a.jsx("p",{className:"text-center text-slate-500 py-8",children:"No users found"}):dt.map(W=>{const ye=pt(W.id);return a.jsx("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-xl hover:border-slate-300 transition-all",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-violet-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:(W.email?.[0]||"?").toUpperCase()}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-semibold text-slate-900 truncate",children:W.email||"No email"}),a.jsx("div",{className:"text-xs text-slate-500 font-mono truncate",children:W.id}),ye.length>0&&a.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[a.jsx(br,{className:"w-3 h-3 text-blue-500"}),a.jsxs("span",{className:"text-xs text-blue-600",children:[ye.length," shop",ye.length>1?"s":""]})]})]})]}),a.jsxs("button",{onClick:()=>S(W),className:"px-3 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all flex items-center gap-1.5",children:[a.jsx(ba,{className:"w-3.5 h-3.5"}),"Delete"]})]})},W.id)})})]})}),x==="support"&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-6",children:[a.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[a.jsx(Yh,{className:"w-5 h-5 text-violet-500"}),"Support Tools"]}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Manage shops, impersonate dashboards, and take quick actions."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(vu,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"View Dashboard"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Click the external link icon on any shop to view their dashboard. You must be logged in as an admin."})]}),a.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Uo,{className:"w-4 h-4 text-amber-500"}),a.jsx("span",{className:"font-semibold text-slate-900",children:"Change Tier"})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Click the settings icon on any shop to change their subscription tier or disable the account."})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[a.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Quick Shop Lookup"}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(Hh,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),a.jsx("input",{type:"text",placeholder:"Search by name, slug, or email...",value:b,onChange:W=>w(W.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all text-sm"})]}),b&&a.jsx("div",{className:"space-y-2",children:fe.slice(0,10).map(W=>a.jsxs("button",{onClick:()=>A(W),className:"w-full flex items-center justify-between p-3 bg-slate-50 hover:bg-slate-100 rounded-xl border border-slate-200 transition-all text-left",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(br,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:W.name}),a.jsxs("div",{className:"text-xs text-slate-500",children:["/",W.slug]})]})]}),a.jsx(D2,{className:"w-4 h-4 text-slate-400"})]},W.id))})]})]})]}),_&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-violet-500 rounded-xl flex items-center justify-center text-white font-bold",children:(_.name||"S")[0].toUpperCase()}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:_.name}),a.jsxs("p",{className:"text-sm text-slate-500",children:["/",_.slug]})]})]}),a.jsx("button",{onClick:()=>A(null),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-all",children:a.jsx(Ds,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Nf,{className:"w-4 h-4 text-slate-400"}),a.jsx("span",{className:"text-slate-600",children:_.ownerEmail})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Et,{className:"w-4 h-4 text-slate-400"}),a.jsxs("span",{className:"text-slate-600",children:["Created: ",Wt(_.createdAt)]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(yn,{className:"w-4 h-4 text-slate-400"}),a.jsxs("span",{className:"text-slate-600",children:["Stripe: ",ne(_).label,_.stripeConnectAccountId&&a.jsxs("span",{className:"ml-1 text-xs text-slate-400 font-mono",children:["(",_.stripeConnectAccountId,")"]})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2",children:"Subscription Tier"}),a.jsx("div",{className:"flex gap-2",children:["free","pro","unlimited"].map(W=>{const ye=ul[W],Ae=(_.subscriptionTier||"free")===W;return a.jsxs("button",{onClick:()=>Z(_.id,W),disabled:L===_.id,className:`flex-1 px-4 py-3 rounded-xl font-semibold text-sm transition-all border-2 ${Ae?W==="free"?"border-slate-400 bg-slate-100 text-slate-900":W==="pro"?"border-blue-500 bg-blue-50 text-blue-700":"border-violet-500 bg-violet-50 text-violet-700":"border-slate-200 bg-white text-slate-500 hover:border-slate-300"}`,children:[ye.label,W!=="free"&&a.jsxs("span",{className:"block text-xs font-normal mt-0.5",children:["$",au[W],"/mo"]})]},W)})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Quick Actions"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs(nt,{to:`/shop/${_.slug}`,target:"_blank",className:"flex items-center justify-center gap-2 px-4 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-medium text-sm transition-all",children:[a.jsx(vu,{className:"w-4 h-4"}),"View Page"]}),a.jsxs(nt,{to:`/shop/${_.slug}/dashboard`,target:"_blank",className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-xl font-medium text-sm transition-all",children:[a.jsx(xl,{className:"w-4 h-4"}),"Dashboard"]})]}),a.jsx("button",{onClick:()=>ue(_.id,_.disabled),disabled:L===_.id,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all ${_.disabled?"bg-emerald-100 hover:bg-emerald-200 text-emerald-700":"bg-red-100 hover:bg-red-200 text-red-700"}`,children:_.disabled?a.jsxs(a.Fragment,{children:[a.jsx(Rs,{className:"w-4 h-4"}),"Enable Shop"]}):a.jsxs(a.Fragment,{children:[a.jsx(gD,{className:"w-4 h-4"}),"Disable Shop"]})}),a.jsxs("button",{onClick:()=>me(_.id,_.archived),disabled:L===_.id,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all ${_.archived?"bg-emerald-100 hover:bg-emerald-200 text-emerald-700":"bg-amber-100 hover:bg-amber-200 text-amber-700"}`,children:[a.jsx(yu,{className:"w-4 h-4"}),_.archived?"Unarchive Shop":"Archive Shop"]}),a.jsxs("div",{className:"pt-4 mt-4 border-t border-red-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(ta,{className:"w-4 h-4 text-red-500"}),a.jsx("span",{className:"text-xs font-bold text-red-600 uppercase tracking-wider",children:"Danger Zone"})]}),a.jsxs("button",{onClick:async()=>{await ge(_.id),q(_),H(""),T(!1)},disabled:L===_.id,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-medium text-sm transition-all shadow-md shadow-red-600/20",children:[a.jsx(ba,{className:"w-4 h-4"}),"Delete Shop Forever"]})]})]})]})}),F&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(ta,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Delete Shop Permanently"}),a.jsxs("p",{className:"text-sm text-slate-500",children:["/",F.slug]})]})]}),ie[F.id]>0&&a.jsxs("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ta,{className:"w-5 h-5 text-amber-600"}),a.jsxs("span",{className:"font-semibold text-amber-800",children:[ie[F.id]," Upcoming Booking",ie[F.id]!==1?"s":""]})]}),a.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"This shop has active bookings. Deleting it will cancel all bookings and notify no one."}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:Y,onChange:W=>T(W.target.checked),className:"w-4 h-4 rounded border-amber-400 text-red-600 focus:ring-red-500"}),a.jsx("span",{className:"text-sm font-medium text-amber-800",children:"I understand and want to force delete anyway"})]})]}),a.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-xl",children:[a.jsx("p",{className:"text-sm text-red-700 mb-2",children:a.jsx("strong",{children:"This will permanently delete:"})}),a.jsxs("ul",{className:"text-sm text-red-600 space-y-1 ml-4 list-disc",children:[a.jsx("li",{children:"Shop and all settings"}),a.jsx("li",{children:"All staff members"}),a.jsx("li",{children:"All bookings (past and future)"}),a.jsx("li",{children:"All time slots and schedule presets"}),a.jsx("li",{children:"All waitlist entries"}),a.jsx("li",{children:"All client notes"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:['Type "',a.jsx("span",{className:"text-red-600",children:F.name}),'" to confirm:']}),a.jsx("input",{type:"text",value:Q,onChange:W=>H(W.target.value),placeholder:"Enter shop name",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all text-sm"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{q(null),H(""),T(!1)},className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all",children:"Cancel"}),a.jsx("button",{onClick:()=>De(F.id),disabled:Q!==F.name||L===F.id||ie[F.id]>0&&!Y,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 disabled:bg-slate-300 disabled:cursor-not-allowed text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-red-600/20",children:L===F.id?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(ba,{className:"w-4 h-4"}),"Delete Forever"]})})]})]})}),E&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(ta,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Delete User Account"}),a.jsx("p",{className:"text-sm text-slate-500",children:E.email})]})]}),pt(E.id).length>0&&a.jsxs("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(br,{className:"w-5 h-5 text-amber-600"}),a.jsxs("span",{className:"font-semibold text-amber-800",children:[pt(E.id).length," Shop",pt(E.id).length!==1?"s":""," Owned"]})]}),a.jsx("ul",{className:"text-sm text-amber-700 mb-3 space-y-1",children:pt(E.id).map(W=>a.jsxs("li",{children:[" ",W.name," (/",W.slug,")"]},W.id))}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:I,onChange:W=>C(W.target.checked),className:"w-4 h-4 rounded border-amber-400 text-red-600 focus:ring-red-500"}),a.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Also delete all shops owned by this user"})]})]}),a.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-xl",children:[a.jsx("p",{className:"text-sm text-red-700 mb-2",children:a.jsx("strong",{children:"This will permanently delete:"})}),a.jsxs("ul",{className:"text-sm text-red-600 space-y-1 ml-4 list-disc",children:[a.jsx("li",{children:"User's Firebase Auth account"}),a.jsx("li",{children:"User document in database"}),I&&a.jsx("li",{children:"All shops and their data (bookings, staff, etc.)"})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{S(null),C(!0)},disabled:M,className:"flex-1 px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-all disabled:opacity-50",children:"Cancel"}),a.jsx("button",{onClick:()=>Ye(E.id),disabled:M,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-red-600/20",children:M?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(ba,{className:"w-4 h-4"}),"Delete User"]})})]})]})})]})}const hP=["aaron.sharp2011@gmail.com"];function fP(){const[n,e]=j.useState(null),[t,i]=j.useState(!0);return j.useEffect(()=>{const o=oC(Ir,c=>{e(c),i(!1)});return()=>o()},[]),t?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):a.jsx(g5,{children:a.jsxs(YT,{children:[a.jsx(Jn,{path:"/",element:a.jsx(QM,{})}),a.jsx(Jn,{path:"/register",element:a.jsx(XM,{})}),a.jsx(Jn,{path:"/login",element:a.jsx(JM,{user:n})}),a.jsx(Jn,{path:"/shop/:slug",element:a.jsx(KO,{})}),a.jsx(Jn,{path:"/shop/:slug/booking/:refCode",element:a.jsx(M9,{})}),a.jsx(Jn,{path:"/shop/:slug/waitlist/:refCode",element:a.jsx(L9,{})}),a.jsx(Jn,{path:"/shop/:slug/queue",element:a.jsx(B9,{})}),a.jsx(Jn,{path:"/shop/:slug/login",element:a.jsx(D9,{user:n})}),a.jsx(Jn,{path:"/shop/:slug/dashboard",element:a.jsx(I9,{user:n})}),a.jsx(Jn,{path:"/admin",element:n&&hP.includes(n.email?.toLowerCase())?a.jsx(dP,{user:n}):a.jsx(uw,{to:"/",replace:!0})}),a.jsx(Jn,{path:"*",element:a.jsx(uw,{to:"/",replace:!0})})]})})}KE.createRoot(document.getElementById("root")).render(a.jsx(Ht.StrictMode,{children:a.jsx(fP,{})}));
