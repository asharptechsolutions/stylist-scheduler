(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(o){if(o.ep)return;o.ep=!0;const u=n(o);fetch(o.href,u)}})();function h_(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var rp={exports:{}},Tc={};var Xy;function oS(){if(Xy)return Tc;Xy=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,o,u){var d=null;if(u!==void 0&&(d=""+u),o.key!==void 0&&(d=""+o.key),"key"in o){u={};for(var p in o)p!=="key"&&(u[p]=o[p])}else u=o;return o=u.ref,{$$typeof:s,type:i,key:d,ref:o!==void 0?o:null,props:u}}return Tc.Fragment=e,Tc.jsx=n,Tc.jsxs=n,Tc}var Jy;function cS(){return Jy||(Jy=1,rp.exports=oS()),rp.exports}var r=cS(),lp={exports:{}},Xe={};var Zy;function uS(){if(Zy)return Xe;Zy=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),S=Symbol.iterator;function C(V){return V===null||typeof V!="object"?null:(V=S&&V[S]||V["@@iterator"],typeof V=="function"?V:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,P={};function q(V,ne,le){this.props=V,this.context=ne,this.refs=P,this.updater=le||H}q.prototype.isReactComponent={},q.prototype.setState=function(V,ne){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,ne,"setState")},q.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function Y(){}Y.prototype=q.prototype;function W(V,ne,le){this.props=V,this.context=ne,this.refs=P,this.updater=le||H}var xe=W.prototype=new Y;xe.constructor=W,B(xe,q.prototype),xe.isPureReactComponent=!0;var me=Array.isArray;function re(){}var j={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function k(V,ne,le){var _e=le.ref;return{$$typeof:s,type:V,key:ne,ref:_e!==void 0?_e:null,props:le}}function L(V,ne){return k(V.type,ne,V.props)}function M(V){return typeof V=="object"&&V!==null&&V.$$typeof===s}function z(V){var ne={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(le){return ne[le]})}var D=/\/+/g;function F(V,ne){return typeof V=="object"&&V!==null&&V.key!=null?z(""+V.key):ne.toString(36)}function O(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(re,re):(V.status="pending",V.then(function(ne){V.status==="pending"&&(V.status="fulfilled",V.value=ne)},function(ne){V.status==="pending"&&(V.status="rejected",V.reason=ne)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function I(V,ne,le,_e,ye){var Ie=typeof V;(Ie==="undefined"||Ie==="boolean")&&(V=null);var ue=!1;if(V===null)ue=!0;else switch(Ie){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(V.$$typeof){case s:case e:ue=!0;break;case y:return ue=V._init,I(ue(V._payload),ne,le,_e,ye)}}if(ue)return ye=ye(V),ue=_e===""?"."+F(V,0):_e,me(ye)?(le="",ue!=null&&(le=ue.replace(D,"$&/")+"/"),I(ye,ne,le,"",function(Ge){return Ge})):ye!=null&&(M(ye)&&(ye=L(ye,le+(ye.key==null||V&&V.key===ye.key?"":(""+ye.key).replace(D,"$&/")+"/")+ue)),ne.push(ye)),1;ue=0;var ze=_e===""?".":_e+":";if(me(V))for(var Ue=0;Ue<V.length;Ue++)_e=V[Ue],Ie=ze+F(_e,Ue),ue+=I(_e,ne,le,Ie,ye);else if(Ue=C(V),typeof Ue=="function")for(V=Ue.call(V),Ue=0;!(_e=V.next()).done;)_e=_e.value,Ie=ze+F(_e,Ue++),ue+=I(_e,ne,le,Ie,ye);else if(Ie==="object"){if(typeof V.then=="function")return I(O(V),ne,le,_e,ye);throw ne=String(V),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return ue}function K(V,ne,le){if(V==null)return V;var _e=[],ye=0;return I(V,_e,"","",function(Ie){return ne.call(le,Ie,ye++)}),_e}function fe(V){if(V._status===-1){var ne=V._result;ne=ne(),ne.then(function(le){(V._status===0||V._status===-1)&&(V._status=1,V._result=le)},function(le){(V._status===0||V._status===-1)&&(V._status=2,V._result=le)}),V._status===-1&&(V._status=0,V._result=ne)}if(V._status===1)return V._result.default;throw V._result}var Se=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},we={map:K,forEach:function(V,ne,le){K(V,function(){ne.apply(this,arguments)},le)},count:function(V){var ne=0;return K(V,function(){ne++}),ne},toArray:function(V){return K(V,function(ne){return ne})||[]},only:function(V){if(!M(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Xe.Activity=_,Xe.Children=we,Xe.Component=q,Xe.Fragment=n,Xe.Profiler=o,Xe.PureComponent=W,Xe.StrictMode=i,Xe.Suspense=g,Xe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,Xe.__COMPILER_RUNTIME={__proto__:null,c:function(V){return j.H.useMemoCache(V)}},Xe.cache=function(V){return function(){return V.apply(null,arguments)}},Xe.cacheSignal=function(){return null},Xe.cloneElement=function(V,ne,le){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var _e=B({},V.props),ye=V.key;if(ne!=null)for(Ie in ne.key!==void 0&&(ye=""+ne.key),ne)!T.call(ne,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&ne.ref===void 0||(_e[Ie]=ne[Ie]);var Ie=arguments.length-2;if(Ie===1)_e.children=le;else if(1<Ie){for(var ue=Array(Ie),ze=0;ze<Ie;ze++)ue[ze]=arguments[ze+2];_e.children=ue}return k(V.type,ye,_e)},Xe.createContext=function(V){return V={$$typeof:d,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:u,_context:V},V},Xe.createElement=function(V,ne,le){var _e,ye={},Ie=null;if(ne!=null)for(_e in ne.key!==void 0&&(Ie=""+ne.key),ne)T.call(ne,_e)&&_e!=="key"&&_e!=="__self"&&_e!=="__source"&&(ye[_e]=ne[_e]);var ue=arguments.length-2;if(ue===1)ye.children=le;else if(1<ue){for(var ze=Array(ue),Ue=0;Ue<ue;Ue++)ze[Ue]=arguments[Ue+2];ye.children=ze}if(V&&V.defaultProps)for(_e in ue=V.defaultProps,ue)ye[_e]===void 0&&(ye[_e]=ue[_e]);return k(V,Ie,ye)},Xe.createRef=function(){return{current:null}},Xe.forwardRef=function(V){return{$$typeof:p,render:V}},Xe.isValidElement=M,Xe.lazy=function(V){return{$$typeof:y,_payload:{_status:-1,_result:V},_init:fe}},Xe.memo=function(V,ne){return{$$typeof:x,type:V,compare:ne===void 0?null:ne}},Xe.startTransition=function(V){var ne=j.T,le={};j.T=le;try{var _e=V(),ye=j.S;ye!==null&&ye(le,_e),typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&_e.then(re,Se)}catch(Ie){Se(Ie)}finally{ne!==null&&le.types!==null&&(ne.types=le.types),j.T=ne}},Xe.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},Xe.use=function(V){return j.H.use(V)},Xe.useActionState=function(V,ne,le){return j.H.useActionState(V,ne,le)},Xe.useCallback=function(V,ne){return j.H.useCallback(V,ne)},Xe.useContext=function(V){return j.H.useContext(V)},Xe.useDebugValue=function(){},Xe.useDeferredValue=function(V,ne){return j.H.useDeferredValue(V,ne)},Xe.useEffect=function(V,ne){return j.H.useEffect(V,ne)},Xe.useEffectEvent=function(V){return j.H.useEffectEvent(V)},Xe.useId=function(){return j.H.useId()},Xe.useImperativeHandle=function(V,ne,le){return j.H.useImperativeHandle(V,ne,le)},Xe.useInsertionEffect=function(V,ne){return j.H.useInsertionEffect(V,ne)},Xe.useLayoutEffect=function(V,ne){return j.H.useLayoutEffect(V,ne)},Xe.useMemo=function(V,ne){return j.H.useMemo(V,ne)},Xe.useOptimistic=function(V,ne){return j.H.useOptimistic(V,ne)},Xe.useReducer=function(V,ne,le){return j.H.useReducer(V,ne,le)},Xe.useRef=function(V){return j.H.useRef(V)},Xe.useState=function(V){return j.H.useState(V)},Xe.useSyncExternalStore=function(V,ne,le){return j.H.useSyncExternalStore(V,ne,le)},Xe.useTransition=function(){return j.H.useTransition()},Xe.version="19.2.4",Xe}var ev;function bg(){return ev||(ev=1,lp.exports=uS()),lp.exports}var N=bg();const dS=h_(N);var op={exports:{}},jc={},cp={exports:{}},up={};var tv;function hS(){return tv||(tv=1,(function(s){function e(I,K){var fe=I.length;I.push(K);e:for(;0<fe;){var Se=fe-1>>>1,we=I[Se];if(0<o(we,K))I[Se]=K,I[fe]=we,fe=Se;else break e}}function n(I){return I.length===0?null:I[0]}function i(I){if(I.length===0)return null;var K=I[0],fe=I.pop();if(fe!==K){I[0]=fe;e:for(var Se=0,we=I.length,V=we>>>1;Se<V;){var ne=2*(Se+1)-1,le=I[ne],_e=ne+1,ye=I[_e];if(0>o(le,fe))_e<we&&0>o(ye,le)?(I[Se]=ye,I[_e]=fe,Se=_e):(I[Se]=le,I[ne]=fe,Se=ne);else if(_e<we&&0>o(ye,fe))I[Se]=ye,I[_e]=fe,Se=_e;else break e}}return K}function o(I,K){var fe=I.sortIndex-K.sortIndex;return fe!==0?fe:I.id-K.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();s.unstable_now=function(){return d.now()-p}}var g=[],x=[],y=1,_=null,S=3,C=!1,H=!1,B=!1,P=!1,q=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;function xe(I){for(var K=n(x);K!==null;){if(K.callback===null)i(x);else if(K.startTime<=I)i(x),K.sortIndex=K.expirationTime,e(g,K);else break;K=n(x)}}function me(I){if(B=!1,xe(I),!H)if(n(g)!==null)H=!0,re||(re=!0,z());else{var K=n(x);K!==null&&O(me,K.startTime-I)}}var re=!1,j=-1,T=5,k=-1;function L(){return P?!0:!(s.unstable_now()-k<T)}function M(){if(P=!1,re){var I=s.unstable_now();k=I;var K=!0;try{e:{H=!1,B&&(B=!1,Y(j),j=-1),C=!0;var fe=S;try{t:{for(xe(I),_=n(g);_!==null&&!(_.expirationTime>I&&L());){var Se=_.callback;if(typeof Se=="function"){_.callback=null,S=_.priorityLevel;var we=Se(_.expirationTime<=I);if(I=s.unstable_now(),typeof we=="function"){_.callback=we,xe(I),K=!0;break t}_===n(g)&&i(g),xe(I)}else i(g);_=n(g)}if(_!==null)K=!0;else{var V=n(x);V!==null&&O(me,V.startTime-I),K=!1}}break e}finally{_=null,S=fe,C=!1}K=void 0}}finally{K?z():re=!1}}}var z;if(typeof W=="function")z=function(){W(M)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,F=D.port2;D.port1.onmessage=M,z=function(){F.postMessage(null)}}else z=function(){q(M,0)};function O(I,K){j=q(function(){I(s.unstable_now())},K)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(I){I.callback=null},s.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<I?Math.floor(1e3/I):5},s.unstable_getCurrentPriorityLevel=function(){return S},s.unstable_next=function(I){switch(S){case 1:case 2:case 3:var K=3;break;default:K=S}var fe=S;S=K;try{return I()}finally{S=fe}},s.unstable_requestPaint=function(){P=!0},s.unstable_runWithPriority=function(I,K){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var fe=S;S=I;try{return K()}finally{S=fe}},s.unstable_scheduleCallback=function(I,K,fe){var Se=s.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Se+fe:Se):fe=Se,I){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=fe+we,I={id:y++,callback:K,priorityLevel:I,startTime:fe,expirationTime:we,sortIndex:-1},fe>Se?(I.sortIndex=fe,e(x,I),n(g)===null&&I===n(x)&&(B?(Y(j),j=-1):B=!0,O(me,fe-Se))):(I.sortIndex=we,e(g,I),H||C||(H=!0,re||(re=!0,z()))),I},s.unstable_shouldYield=L,s.unstable_wrapCallback=function(I){var K=S;return function(){var fe=S;S=K;try{return I.apply(this,arguments)}finally{S=fe}}}})(up)),up}var nv;function fS(){return nv||(nv=1,cp.exports=hS()),cp.exports}var dp={exports:{}},Pn={};var sv;function mS(){if(sv)return Pn;sv=1;var s=bg();function e(g){var x="https://react.dev/errors/"+g;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)x+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+g+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");function u(g,x,y){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:_==null?null:""+_,children:g,containerInfo:x,implementation:y}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,x){if(g==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return Pn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Pn.createPortal=function(g,x){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(e(299));return u(g,x,null,y)},Pn.flushSync=function(g){var x=d.T,y=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=x,i.p=y,i.d.f()}},Pn.preconnect=function(g,x){typeof g=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,i.d.C(g,x))},Pn.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Pn.preinit=function(g,x){if(typeof g=="string"&&x&&typeof x.as=="string"){var y=x.as,_=p(y,x.crossOrigin),S=typeof x.integrity=="string"?x.integrity:void 0,C=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;y==="style"?i.d.S(g,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:_,integrity:S,fetchPriority:C}):y==="script"&&i.d.X(g,{crossOrigin:_,integrity:S,fetchPriority:C,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},Pn.preinitModule=function(g,x){if(typeof g=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var y=p(x.as,x.crossOrigin);i.d.M(g,{crossOrigin:y,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&i.d.M(g)},Pn.preload=function(g,x){if(typeof g=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var y=x.as,_=p(y,x.crossOrigin);i.d.L(g,y,{crossOrigin:_,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},Pn.preloadModule=function(g,x){if(typeof g=="string")if(x){var y=p(x.as,x.crossOrigin);i.d.m(g,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:y,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else i.d.m(g)},Pn.requestFormReset=function(g){i.d.r(g)},Pn.unstable_batchedUpdates=function(g,x){return g(x)},Pn.useFormState=function(g,x,y){return d.H.useFormState(g,x,y)},Pn.useFormStatus=function(){return d.H.useHostTransitionStatus()},Pn.version="19.2.4",Pn}var av;function pS(){if(av)return dp.exports;av=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),dp.exports=mS(),dp.exports}var iv;function gS(){if(iv)return jc;iv=1;var s=fS(),e=bg(),n=pS();function i(t){var a="https://react.dev/errors/"+t;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function u(t){var a=t,l=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,(a.flags&4098)!==0&&(l=a.return),t=a.return;while(t)}return a.tag===3?l:null}function d(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function p(t){if(t.tag===31){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function g(t){if(u(t)!==t)throw Error(i(188))}function x(t){var a=t.alternate;if(!a){if(a=u(t),a===null)throw Error(i(188));return a!==t?null:t}for(var l=t,c=a;;){var f=l.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){l=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===l)return g(f),t;if(m===c)return g(f),a;m=m.sibling}throw Error(i(188))}if(l.return!==c.return)l=f,c=m;else{for(var v=!1,E=f.child;E;){if(E===l){v=!0,l=f,c=m;break}if(E===c){v=!0,c=f,l=m;break}E=E.sibling}if(!v){for(E=m.child;E;){if(E===l){v=!0,l=m,c=f;break}if(E===c){v=!0,c=m,l=f;break}E=E.sibling}if(!v)throw Error(i(189))}}if(l.alternate!==c)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?t:a}function y(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(a=y(t),a!==null)return a;t=t.sibling}return null}var _=Object.assign,S=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),q=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),W=Symbol.for("react.context"),xe=Symbol.for("react.forward_ref"),me=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function z(t){return t===null||typeof t!="object"?null:(t=M&&t[M]||t["@@iterator"],typeof t=="function"?t:null)}var D=Symbol.for("react.client.reference");function F(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===D?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case B:return"Fragment";case q:return"Profiler";case P:return"StrictMode";case me:return"Suspense";case re:return"SuspenseList";case k:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case H:return"Portal";case W:return t.displayName||"Context";case Y:return(t._context.displayName||"Context")+".Consumer";case xe:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case j:return a=t.displayName||null,a!==null?a:F(t.type)||"Memo";case T:a=t._payload,t=t._init;try{return F(t(a))}catch{}}return null}var O=Array.isArray,I=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe={pending:!1,data:null,method:null,action:null},Se=[],we=-1;function V(t){return{current:t}}function ne(t){0>we||(t.current=Se[we],Se[we]=null,we--)}function le(t,a){we++,Se[we]=t.current,t.current=a}var _e=V(null),ye=V(null),Ie=V(null),ue=V(null);function ze(t,a){switch(le(Ie,a),le(ye,t),le(_e,null),a.nodeType){case 9:case 11:t=(t=a.documentElement)&&(t=t.namespaceURI)?vy(t):0;break;default:if(t=a.tagName,a=a.namespaceURI)a=vy(a),t=wy(a,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}ne(_e),le(_e,t)}function Ue(){ne(_e),ne(ye),ne(Ie)}function Ge(t){t.memoizedState!==null&&le(ue,t);var a=_e.current,l=wy(a,t.type);a!==l&&(le(ye,t),le(_e,l))}function J(t){ye.current===t&&(ne(_e),ne(ye)),ue.current===t&&(ne(ue),_c._currentValue=fe)}var ve,Ve;function Pe(t){if(ve===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);ve=a&&a[1]||"",Ve=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ve+t+Ve}var qe=!1;function gt(t,a){if(!t||qe)return"";qe=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var pe=function(){throw Error()};if(Object.defineProperty(pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pe,[])}catch(ie){var se=ie}Reflect.construct(t,[],pe)}else{try{pe.call()}catch(ie){se=ie}t.call(pe.prototype)}}else{try{throw Error()}catch(ie){se=ie}(pe=t())&&typeof pe.catch=="function"&&pe.catch(function(){})}}catch(ie){if(ie&&se&&typeof ie.stack=="string")return[ie.stack,se.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),v=m[0],E=m[1];if(v&&E){var U=v.split(`
`),te=E.split(`
`);for(f=c=0;c<U.length&&!U[c].includes("DetermineComponentFrameRoot");)c++;for(;f<te.length&&!te[f].includes("DetermineComponentFrameRoot");)f++;if(c===U.length||f===te.length)for(c=U.length-1,f=te.length-1;1<=c&&0<=f&&U[c]!==te[f];)f--;for(;1<=c&&0<=f;c--,f--)if(U[c]!==te[f]){if(c!==1||f!==1)do if(c--,f--,0>f||U[c]!==te[f]){var oe=`
`+U[c].replace(" at new "," at ");return t.displayName&&oe.includes("<anonymous>")&&(oe=oe.replace("<anonymous>",t.displayName)),oe}while(1<=c&&0<=f);break}}}finally{qe=!1,Error.prepareStackTrace=l}return(l=t?t.displayName||t.name:"")?Pe(l):""}function qn(t,a){switch(t.tag){case 26:case 27:case 5:return Pe(t.type);case 16:return Pe("Lazy");case 13:return t.child!==a&&a!==null?Pe("Suspense Fallback"):Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 15:return gt(t.type,!1);case 11:return gt(t.type.render,!1);case 1:return gt(t.type,!0);case 31:return Pe("Activity");default:return""}}function xn(t){try{var a="",l=null;do a+=qn(t,l),l=t,t=t.return;while(t);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var vt=Object.prototype.hasOwnProperty,je=s.unstable_scheduleCallback,Be=s.unstable_cancelCallback,it=s.unstable_shouldYield,Lt=s.unstable_requestPaint,xt=s.unstable_now,lt=s.unstable_getCurrentPriorityLevel,rn=s.unstable_ImmediatePriority,wt=s.unstable_UserBlockingPriority,_s=s.unstable_NormalPriority,bn=s.unstable_LowPriority,Vn=s.unstable_IdlePriority,Ls=s.log,Oa=s.unstable_setDisableYieldValue,R=null,G=null;function de(t){if(typeof Ls=="function"&&Oa(t),G&&typeof G.setStrictMode=="function")try{G.setStrictMode(R,t)}catch{}}var ce=Math.clz32?Math.clz32:Ce,Me=Math.log,Te=Math.LN2;function Ce(t){return t>>>=0,t===0?32:31-(Me(t)/Te|0)|0}var Re=256,rt=262144,ot=4194304;function $t(t){var a=t&42;if(a!==0)return a;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Gt(t,a,l){var c=t.pendingLanes;if(c===0)return 0;var f=0,m=t.suspendedLanes,v=t.pingedLanes;t=t.warmLanes;var E=c&134217727;return E!==0?(c=E&~m,c!==0?f=$t(c):(v&=E,v!==0?f=$t(v):l||(l=E&~t,l!==0&&(f=$t(l))))):(E=c&~m,E!==0?f=$t(E):v!==0?f=$t(v):l||(l=c&~t,l!==0&&(f=$t(l)))),f===0?0:a!==0&&a!==f&&(a&m)===0&&(m=f&-f,l=a&-a,m>=l||m===32&&(l&4194048)!==0)?a:f}function Fn(t,a){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&a)===0}function na(t,a){switch(t){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wn(){var t=ot;return ot<<=1,(ot&62914560)===0&&(ot=4194304),t}function Hn(t){for(var a=[],l=0;31>l;l++)a.push(t);return a}function _n(t,a){t.pendingLanes|=a,a!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function sa(t,a,l,c,f,m){var v=t.pendingLanes;t.pendingLanes=l,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=l,t.entangledLanes&=l,t.errorRecoveryDisabledLanes&=l,t.shellSuspendCounter=0;var E=t.entanglements,U=t.expirationTimes,te=t.hiddenUpdates;for(l=v&~l;0<l;){var oe=31-ce(l),pe=1<<oe;E[oe]=0,U[oe]=-1;var se=te[oe];if(se!==null)for(te[oe]=null,oe=0;oe<se.length;oe++){var ie=se[oe];ie!==null&&(ie.lane&=-536870913)}l&=~pe}c!==0&&Us(t,c,0),m!==0&&f===0&&t.tag!==0&&(t.suspendedLanes|=m&~(v&~a))}function Us(t,a,l){t.pendingLanes|=a,t.suspendedLanes&=~a;var c=31-ce(a);t.entangledLanes|=a,t.entanglements[c]=t.entanglements[c]|1073741824|l&261930}function Va(t,a){var l=t.entangledLanes|=a;for(t=t.entanglements;l;){var c=31-ce(l),f=1<<c;f&a|t[c]&a&&(t[c]|=a),l&=~f}}function mi(t,a){var l=a&-a;return l=(l&42)!==0?1:pi(l),(l&(t.suspendedLanes|a))!==0?0:l}function pi(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Pa(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function vu(){var t=K.p;return t!==0?t:(t=window.event,t===void 0?32:Hy(t.type))}function Bs(t,a){var l=K.p;try{return K.p=t,a()}finally{K.p=l}}var zs=Math.random().toString(36).slice(2),ln="__reactFiber$"+zs,Nn="__reactProps$"+zs,aa="__reactContainer$"+zs,ml="__reactEvents$"+zs,hf="__reactListeners$"+zs,wu="__reactHandles$"+zs,_u="__reactResources$"+zs,ia="__reactMarker$"+zs;function pl(t){delete t[ln],delete t[Nn],delete t[ml],delete t[hf],delete t[wu]}function ra(t){var a=t[ln];if(a)return a;for(var l=t.parentNode;l;){if(a=l[aa]||l[ln]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(t=Ay(t);t!==null;){if(l=t[ln])return l;t=Ay(t)}return a}t=l,l=t.parentNode}return null}function Ns(t){if(t=t[ln]||t[aa]){var a=t.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return t}return null}function rs(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t.stateNode;throw Error(i(33))}function la(t){var a=t[_u];return a||(a=t[_u]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function on(t){t[ia]=!0}var Co=new Set,Ro={};function oa(t,a){ca(t,a),ca(t+"Capture",a)}function ca(t,a){for(Ro[t]=a,t=0;t<a.length;t++)Co.add(a[t])}var ko=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Io={},Do={};function Nu(t){return vt.call(Do,t)?!0:vt.call(Io,t)?!1:ko.test(t)?Do[t]=!0:(Io[t]=!0,!1)}function gl(t,a,l){if(Nu(a))if(l===null)t.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":t.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(a);return}}t.setAttribute(a,""+l)}}function ls(t,a,l){if(l===null)t.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttribute(a,""+l)}}function cn(t,a,l,c){if(c===null)t.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(l);return}t.setAttributeNS(a,l,""+c)}}function En(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function gi(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Mo(t,a,l){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,a);if(!t.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return f.call(this)},set:function(v){l=""+v,m.call(this,v)}}),Object.defineProperty(t,a,{enumerable:c.enumerable}),{getValue:function(){return l},setValue:function(v){l=""+v},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function At(t){if(!t._valueTracker){var a=gi(t)?"checked":"value";t._valueTracker=Mo(t,a,""+t[a])}}function vr(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var l=a.getValue(),c="";return t&&(c=gi(t)?t.checked?"true":"false":t.value),t=c,t!==l?(a.setValue(t),!0):!1}function ua(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var wr=/[\n"\\]/g;function Kn(t){return t.replace(wr,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function xl(t,a,l,c,f,m,v,E){t.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?t.type=v:t.removeAttribute("type"),a!=null?v==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+En(a)):t.value!==""+En(a)&&(t.value=""+En(a)):v!=="submit"&&v!=="reset"||t.removeAttribute("value"),a!=null?Oo(t,v,En(a)):l!=null?Oo(t,v,En(l)):c!=null&&t.removeAttribute("value"),f==null&&m!=null&&(t.defaultChecked=!!m),f!=null&&(t.checked=f&&typeof f!="function"&&typeof f!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?t.name=""+En(E):t.removeAttribute("name")}function Eu(t,a,l,c,f,m,v,E){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(t.type=m),a!=null||l!=null){if(!(m!=="submit"&&m!=="reset"||a!=null)){At(t);return}l=l!=null?""+En(l):"",a=a!=null?""+En(a):l,E||a===t.value||(t.value=a),t.defaultValue=a}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=E?t.checked:!!c,t.defaultChecked=!!c,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(t.name=v),At(t)}function Oo(t,a,l){a==="number"&&ua(t.ownerDocument)===t||t.defaultValue===""+l||(t.defaultValue=""+l)}function xi(t,a,l,c){if(t=t.options,a){a={};for(var f=0;f<l.length;f++)a["$"+l[f]]=!0;for(l=0;l<t.length;l++)f=a.hasOwnProperty("$"+t[l].value),t[l].selected!==f&&(t[l].selected=f),f&&c&&(t[l].defaultSelected=!0)}else{for(l=""+En(l),a=null,f=0;f<t.length;f++){if(t[f].value===l){t[f].selected=!0,c&&(t[f].defaultSelected=!0);return}a!==null||t[f].disabled||(a=t[f])}a!==null&&(a.selected=!0)}}function Su(t,a,l){if(a!=null&&(a=""+En(a),a!==t.value&&(t.value=a),l==null)){t.defaultValue!==a&&(t.defaultValue=a);return}t.defaultValue=l!=null?""+En(l):""}function bi(t,a,l,c){if(a==null){if(c!=null){if(l!=null)throw Error(i(92));if(O(c)){if(1<c.length)throw Error(i(93));c=c[0]}l=c}l==null&&(l=""),a=l}l=En(a),t.defaultValue=l,c=t.textContent,c===l&&c!==""&&c!==null&&(t.value=c),At(t)}function Qn(t,a){if(a){var l=t.firstChild;if(l&&l===t.lastChild&&l.nodeType===3){l.nodeValue=a;return}}t.textContent=a}var Tu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vo(t,a,l){var c=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?t.setProperty(a,""):a==="float"?t.cssFloat="":t[a]="":c?t.setProperty(a,l):typeof l!="number"||l===0||Tu.has(a)?a==="float"?t.cssFloat=l:t[a]=(""+l).trim():t[a]=l+"px"}function Po(t,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(t=t.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var f in a)c=a[f],a.hasOwnProperty(f)&&l[f]!==c&&Vo(t,f,c)}else for(var m in a)a.hasOwnProperty(m)&&Vo(t,m,a[m])}function bl(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ju=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),yi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yl(t){return yi.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function qs(){}var Lo=null;function Es(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vi=null,da=null;function _r(t){var a=Ns(t);if(a&&(t=a.stateNode)){var l=t[Nn]||null;e:switch(t=a.stateNode,a.type){case"input":if(xl(t,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=t;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Kn(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var c=l[a];if(c!==t&&c.form===t.form){var f=c[Nn]||null;if(!f)throw Error(i(90));xl(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(a=0;a<l.length;a++)c=l[a],c.form===t.form&&vr(c)}break e;case"textarea":Su(t,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&xi(t,!!l.multiple,a,!1)}}}var vl=!1;function wi(t,a,l){if(vl)return t(a,l);vl=!0;try{var c=t(a);return c}finally{if(vl=!1,(vi!==null||da!==null)&&(vd(),vi&&(a=vi,t=da,da=vi=null,_r(a),t)))for(a=0;a<t.length;a++)_r(t[a])}}function Fs(t,a){var l=t.stateNode;if(l===null)return null;var c=l[Nn]||null;if(c===null)return null;l=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var Ss=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nr=!1;if(Ss)try{var kt={};Object.defineProperty(kt,"passive",{get:function(){Nr=!0}}),window.addEventListener("test",kt,kt),window.removeEventListener("test",kt,kt)}catch{Nr=!1}var ha=null,Uo=null,Er=null;function Bo(){if(Er)return Er;var t,a=Uo,l=a.length,c,f="value"in ha?ha.value:ha.textContent,m=f.length;for(t=0;t<l&&a[t]===f[t];t++);var v=l-t;for(c=1;c<=v&&a[l-c]===f[m-c];c++);return Er=f.slice(t,1<c?1-c:void 0)}function Sr(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function La(){return!0}function Hs(){return!1}function An(t){function a(l,c,f,m,v){this._reactName=l,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var E in t)t.hasOwnProperty(E)&&(l=t[E],this[E]=l?l(m):m[E]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?La:Hs,this.isPropagationStopped=Hs,this}return _(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=La)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=La)},persist:function(){},isPersistent:La}),a}var Ua={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fa=An(Ua),_i=_({},Ua,{view:0,detail:0}),zo=An(_i),Ni,wl,ma,_l=_({},_i,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ei,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ma&&(ma&&t.type==="mousemove"?(Ni=t.screenX-ma.screenX,wl=t.screenY-ma.screenY):wl=Ni=0,ma=t),Ni)},movementY:function(t){return"movementY"in t?t.movementY:wl}}),qo=An(_l),Tr=_({},_l,{dataTransfer:0}),Au=An(Tr),Cu=_({},_i,{relatedTarget:0}),jr=An(Cu),Fo=_({},Ua,{animationName:0,elapsedTime:0,pseudoElement:0}),Ru=An(Fo),Nl=_({},Ua,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ku=An(Nl),Iu=_({},Ua,{data:0}),pa=An(Iu),Du={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ou={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vu(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=Ou[t])?!!a[t]:!1}function Ei(){return Vu}var $n=_({},_i,{key:function(t){if(t.key){var a=Du[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=Sr(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Mu[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ei,charCode:function(t){return t.type==="keypress"?Sr(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Sr(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Pu=An($n),Lu=_({},_l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ba=An(Lu),h=_({},_i,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ei}),b=An(h),w=_({},Ua,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=An(w),Z=_({},_l,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ae=An(Z),Ee=_({},Ua,{newState:0,oldState:0}),tt=An(Ee),tn=[9,13,27,32],Et=Ss&&"CompositionEvent"in window,zt=null;Ss&&"documentMode"in document&&(zt=document.documentMode);var Ts=Ss&&"TextEvent"in window&&!zt,ga=Ss&&(!Et||zt&&8<zt&&11>=zt),$s=" ",Gs=!1;function Ar(t,a){switch(t){case"keyup":return tn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function El(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Sl=!1;function I2(t,a){switch(t){case"compositionend":return El(a);case"keypress":return a.which!==32?null:(Gs=!0,$s);case"textInput":return t=a.data,t===$s&&Gs?null:t;default:return null}}function D2(t,a){if(Sl)return t==="compositionend"||!Et&&Ar(t,a)?(t=Bo(),Er=Uo=ha=null,Sl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return ga&&a.locale!=="ko"?null:a.data;default:return null}}var M2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k0(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!M2[t.type]:a==="textarea"}function I0(t,a,l,c){vi?da?da.push(c):da=[c]:vi=c,a=jd(a,"onChange"),0<a.length&&(l=new fa("onChange","change",null,l,c),t.push({event:l,listeners:a}))}var Ho=null,$o=null;function O2(t){my(t,0)}function Uu(t){var a=rs(t);if(vr(a))return t}function D0(t,a){if(t==="change")return a}var M0=!1;if(Ss){var ff;if(Ss){var mf="oninput"in document;if(!mf){var O0=document.createElement("div");O0.setAttribute("oninput","return;"),mf=typeof O0.oninput=="function"}ff=mf}else ff=!1;M0=ff&&(!document.documentMode||9<document.documentMode)}function V0(){Ho&&(Ho.detachEvent("onpropertychange",P0),$o=Ho=null)}function P0(t){if(t.propertyName==="value"&&Uu($o)){var a=[];I0(a,$o,t,Es(t)),wi(O2,a)}}function V2(t,a,l){t==="focusin"?(V0(),Ho=a,$o=l,Ho.attachEvent("onpropertychange",P0)):t==="focusout"&&V0()}function P2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uu($o)}function L2(t,a){if(t==="click")return Uu(a)}function U2(t,a){if(t==="input"||t==="change")return Uu(a)}function B2(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var os=typeof Object.is=="function"?Object.is:B2;function Go(t,a){if(os(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var l=Object.keys(t),c=Object.keys(a);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var f=l[c];if(!vt.call(a,f)||!os(t[f],a[f]))return!1}return!0}function L0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function U0(t,a){var l=L0(t);t=0;for(var c;l;){if(l.nodeType===3){if(c=t+l.textContent.length,t<=a&&c>=a)return{node:l,offset:a-t};t=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=L0(l)}}function B0(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?B0(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function z0(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var a=ua(t.document);a instanceof t.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)t=a.contentWindow;else break;a=ua(t.document)}return a}function pf(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}var z2=Ss&&"documentMode"in document&&11>=document.documentMode,Tl=null,gf=null,Yo=null,xf=!1;function q0(t,a,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;xf||Tl==null||Tl!==ua(c)||(c=Tl,"selectionStart"in c&&pf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Yo&&Go(Yo,c)||(Yo=c,c=jd(gf,"onSelect"),0<c.length&&(a=new fa("onSelect","select",null,a,l),t.push({event:a,listeners:c}),a.target=Tl)))}function Cr(t,a){var l={};return l[t.toLowerCase()]=a.toLowerCase(),l["Webkit"+t]="webkit"+a,l["Moz"+t]="moz"+a,l}var jl={animationend:Cr("Animation","AnimationEnd"),animationiteration:Cr("Animation","AnimationIteration"),animationstart:Cr("Animation","AnimationStart"),transitionrun:Cr("Transition","TransitionRun"),transitionstart:Cr("Transition","TransitionStart"),transitioncancel:Cr("Transition","TransitionCancel"),transitionend:Cr("Transition","TransitionEnd")},bf={},F0={};Ss&&(F0=document.createElement("div").style,"AnimationEvent"in window||(delete jl.animationend.animation,delete jl.animationiteration.animation,delete jl.animationstart.animation),"TransitionEvent"in window||delete jl.transitionend.transition);function Rr(t){if(bf[t])return bf[t];if(!jl[t])return t;var a=jl[t],l;for(l in a)if(a.hasOwnProperty(l)&&l in F0)return bf[t]=a[l];return t}var H0=Rr("animationend"),$0=Rr("animationiteration"),G0=Rr("animationstart"),q2=Rr("transitionrun"),F2=Rr("transitionstart"),H2=Rr("transitioncancel"),Y0=Rr("transitionend"),K0=new Map,yf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");yf.push("scrollEnd");function Ys(t,a){K0.set(t,a),oa(a,[t])}var Bu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},js=[],Al=0,vf=0;function zu(){for(var t=Al,a=vf=Al=0;a<t;){var l=js[a];js[a++]=null;var c=js[a];js[a++]=null;var f=js[a];js[a++]=null;var m=js[a];if(js[a++]=null,c!==null&&f!==null){var v=c.pending;v===null?f.next=f:(f.next=v.next,v.next=f),c.pending=f}m!==0&&Q0(l,f,m)}}function qu(t,a,l,c){js[Al++]=t,js[Al++]=a,js[Al++]=l,js[Al++]=c,vf|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function wf(t,a,l,c){return qu(t,a,l,c),Fu(t)}function kr(t,a){return qu(t,null,null,a),Fu(t)}function Q0(t,a,l){t.lanes|=l;var c=t.alternate;c!==null&&(c.lanes|=l);for(var f=!1,m=t.return;m!==null;)m.childLanes|=l,c=m.alternate,c!==null&&(c.childLanes|=l),m.tag===22&&(t=m.stateNode,t===null||t._visibility&1||(f=!0)),t=m,m=m.return;return t.tag===3?(m=t.stateNode,f&&a!==null&&(f=31-ce(l),t=m.hiddenUpdates,c=t[f],c===null?t[f]=[a]:c.push(a),a.lane=l|536870912),m):null}function Fu(t){if(50<pc)throw pc=0,Rm=null,Error(i(185));for(var a=t.return;a!==null;)t=a,a=t.return;return t.tag===3?t.stateNode:null}var Cl={};function $2(t,a,l,c){this.tag=t,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cs(t,a,l,c){return new $2(t,a,l,c)}function _f(t){return t=t.prototype,!(!t||!t.isReactComponent)}function za(t,a){var l=t.alternate;return l===null?(l=cs(t.tag,a,t.key,t.mode),l.elementType=t.elementType,l.type=t.type,l.stateNode=t.stateNode,l.alternate=t,t.alternate=l):(l.pendingProps=a,l.type=t.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=t.flags&65011712,l.childLanes=t.childLanes,l.lanes=t.lanes,l.child=t.child,l.memoizedProps=t.memoizedProps,l.memoizedState=t.memoizedState,l.updateQueue=t.updateQueue,a=t.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=t.sibling,l.index=t.index,l.ref=t.ref,l.refCleanup=t.refCleanup,l}function W0(t,a){t.flags&=65011714;var l=t.alternate;return l===null?(t.childLanes=0,t.lanes=a,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=l.childLanes,t.lanes=l.lanes,t.child=l.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=l.memoizedProps,t.memoizedState=l.memoizedState,t.updateQueue=l.updateQueue,t.type=l.type,a=l.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),t}function Hu(t,a,l,c,f,m){var v=0;if(c=t,typeof t=="function")_f(t)&&(v=1);else if(typeof t=="string")v=WE(t,l,_e.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case k:return t=cs(31,l,a,f),t.elementType=k,t.lanes=m,t;case B:return Ir(l.children,f,m,a);case P:v=8,f|=24;break;case q:return t=cs(12,l,a,f|2),t.elementType=q,t.lanes=m,t;case me:return t=cs(13,l,a,f),t.elementType=me,t.lanes=m,t;case re:return t=cs(19,l,a,f),t.elementType=re,t.lanes=m,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case W:v=10;break e;case Y:v=9;break e;case xe:v=11;break e;case j:v=14;break e;case T:v=16,c=null;break e}v=29,l=Error(i(130,t===null?"null":typeof t,"")),c=null}return a=cs(v,l,a,f),a.elementType=t,a.type=c,a.lanes=m,a}function Ir(t,a,l,c){return t=cs(7,t,c,a),t.lanes=l,t}function Nf(t,a,l){return t=cs(6,t,null,a),t.lanes=l,t}function X0(t){var a=cs(18,null,null,0);return a.stateNode=t,a}function Ef(t,a,l){return a=cs(4,t.children!==null?t.children:[],t.key,a),a.lanes=l,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}var J0=new WeakMap;function As(t,a){if(typeof t=="object"&&t!==null){var l=J0.get(t);return l!==void 0?l:(a={value:t,source:a,stack:xn(a)},J0.set(t,a),a)}return{value:t,source:a,stack:xn(a)}}var Rl=[],kl=0,$u=null,Ko=0,Cs=[],Rs=0,Si=null,xa=1,ba="";function qa(t,a){Rl[kl++]=Ko,Rl[kl++]=$u,$u=t,Ko=a}function Z0(t,a,l){Cs[Rs++]=xa,Cs[Rs++]=ba,Cs[Rs++]=Si,Si=t;var c=xa;t=ba;var f=32-ce(c)-1;c&=~(1<<f),l+=1;var m=32-ce(a)+f;if(30<m){var v=f-f%5;m=(c&(1<<v)-1).toString(32),c>>=v,f-=v,xa=1<<32-ce(a)+f|l<<f|c,ba=m+t}else xa=1<<m|l<<f|c,ba=t}function Sf(t){t.return!==null&&(qa(t,1),Z0(t,1,0))}function Tf(t){for(;t===$u;)$u=Rl[--kl],Rl[kl]=null,Ko=Rl[--kl],Rl[kl]=null;for(;t===Si;)Si=Cs[--Rs],Cs[Rs]=null,ba=Cs[--Rs],Cs[Rs]=null,xa=Cs[--Rs],Cs[Rs]=null}function ex(t,a){Cs[Rs++]=xa,Cs[Rs++]=ba,Cs[Rs++]=Si,xa=a.id,ba=a.overflow,Si=t}var Cn=null,Ut=null,bt=!1,Ti=null,ks=!1,jf=Error(i(519));function ji(t){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Qo(As(a,t)),jf}function tx(t){var a=t.stateNode,l=t.type,c=t.memoizedProps;switch(a[ln]=t,a[Nn]=c,l){case"dialog":ut("cancel",a),ut("close",a);break;case"iframe":case"object":case"embed":ut("load",a);break;case"video":case"audio":for(l=0;l<xc.length;l++)ut(xc[l],a);break;case"source":ut("error",a);break;case"img":case"image":case"link":ut("error",a),ut("load",a);break;case"details":ut("toggle",a);break;case"input":ut("invalid",a),Eu(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ut("invalid",a);break;case"textarea":ut("invalid",a),bi(a,c.value,c.defaultValue,c.children)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||c.suppressHydrationWarning===!0||by(a.textContent,l)?(c.popover!=null&&(ut("beforetoggle",a),ut("toggle",a)),c.onScroll!=null&&ut("scroll",a),c.onScrollEnd!=null&&ut("scrollend",a),c.onClick!=null&&(a.onclick=qs),a=!0):a=!1,a||ji(t,!0)}function nx(t){for(Cn=t.return;Cn;)switch(Cn.tag){case 5:case 31:case 13:ks=!1;return;case 27:case 3:ks=!0;return;default:Cn=Cn.return}}function Il(t){if(t!==Cn)return!1;if(!bt)return nx(t),bt=!0,!1;var a=t.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=t.type,l=!(l!=="form"&&l!=="button")||$m(t.type,t.memoizedProps)),l=!l),l&&Ut&&ji(t),nx(t),a===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(317));Ut=jy(t)}else if(a===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(317));Ut=jy(t)}else a===27?(a=Ut,zi(t.type)?(t=Wm,Wm=null,Ut=t):Ut=a):Ut=Cn?Ds(t.stateNode.nextSibling):null;return!0}function Dr(){Ut=Cn=null,bt=!1}function Af(){var t=Ti;return t!==null&&(Zn===null?Zn=t:Zn.push.apply(Zn,t),Ti=null),t}function Qo(t){Ti===null?Ti=[t]:Ti.push(t)}var Cf=V(null),Mr=null,Fa=null;function Ai(t,a,l){le(Cf,a._currentValue),a._currentValue=l}function Ha(t){t._currentValue=Cf.current,ne(Cf)}function Rf(t,a,l){for(;t!==null;){var c=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),t===l)break;t=t.return}}function kf(t,a,l,c){var f=t.child;for(f!==null&&(f.return=t);f!==null;){var m=f.dependencies;if(m!==null){var v=f.child;m=m.firstContext;e:for(;m!==null;){var E=m;m=f;for(var U=0;U<a.length;U++)if(E.context===a[U]){m.lanes|=l,E=m.alternate,E!==null&&(E.lanes|=l),Rf(m.return,l,t),c||(v=null);break e}m=E.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(i(341));v.lanes|=l,m=v.alternate,m!==null&&(m.lanes|=l),Rf(v,l,t),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===t){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function Dl(t,a,l,c){t=null;for(var f=a,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(i(387));if(v=v.memoizedProps,v!==null){var E=f.type;os(f.pendingProps.value,v.value)||(t!==null?t.push(E):t=[E])}}else if(f===ue.current){if(v=f.alternate,v===null)throw Error(i(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(t!==null?t.push(_c):t=[_c])}f=f.return}t!==null&&kf(a,t,l,c),a.flags|=262144}function Gu(t){for(t=t.firstContext;t!==null;){if(!os(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Or(t){Mr=t,Fa=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Rn(t){return sx(Mr,t)}function Yu(t,a){return Mr===null&&Or(t),sx(t,a)}function sx(t,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Fa===null){if(t===null)throw Error(i(308));Fa=a,t.dependencies={lanes:0,firstContext:a},t.flags|=524288}else Fa=Fa.next=a;return l}var G2=typeof AbortController<"u"?AbortController:function(){var t=[],a=this.signal={aborted:!1,addEventListener:function(l,c){t.push(c)}};this.abort=function(){a.aborted=!0,t.forEach(function(l){return l()})}},Y2=s.unstable_scheduleCallback,K2=s.unstable_NormalPriority,un={$$typeof:W,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function If(){return{controller:new G2,data:new Map,refCount:0}}function Wo(t){t.refCount--,t.refCount===0&&Y2(K2,function(){t.controller.abort()})}var Xo=null,Df=0,Ml=0,Ol=null;function Q2(t,a){if(Xo===null){var l=Xo=[];Df=0,Ml=Vm(),Ol={status:"pending",value:void 0,then:function(c){l.push(c)}}}return Df++,a.then(ax,ax),a}function ax(){if(--Df===0&&Xo!==null){Ol!==null&&(Ol.status="fulfilled");var t=Xo;Xo=null,Ml=0,Ol=null;for(var a=0;a<t.length;a++)(0,t[a])()}}function W2(t,a){var l=[],c={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return t.then(function(){c.status="fulfilled",c.value=a;for(var f=0;f<l.length;f++)(0,l[f])(a)},function(f){for(c.status="rejected",c.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),c}var ix=I.S;I.S=function(t,a){qb=xt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Q2(t,a),ix!==null&&ix(t,a)};var Vr=V(null);function Mf(){var t=Vr.current;return t!==null?t:Ot.pooledCache}function Ku(t,a){a===null?le(Vr,Vr.current):le(Vr,a.pool)}function rx(){var t=Mf();return t===null?null:{parent:un._currentValue,pool:t}}var Vl=Error(i(460)),Of=Error(i(474)),Qu=Error(i(542)),Wu={then:function(){}};function lx(t){return t=t.status,t==="fulfilled"||t==="rejected"}function ox(t,a,l){switch(l=t[l],l===void 0?t.push(a):l!==a&&(a.then(qs,qs),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,ux(t),t;default:if(typeof a.status=="string")a.then(qs,qs);else{if(t=Ot,t!==null&&100<t.shellSuspendCounter)throw Error(i(482));t=a,t.status="pending",t.then(function(c){if(a.status==="pending"){var f=a;f.status="fulfilled",f.value=c}},function(c){if(a.status==="pending"){var f=a;f.status="rejected",f.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,ux(t),t}throw Lr=a,Vl}}function Pr(t){try{var a=t._init;return a(t._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Lr=l,Vl):l}}var Lr=null;function cx(){if(Lr===null)throw Error(i(459));var t=Lr;return Lr=null,t}function ux(t){if(t===Vl||t===Qu)throw Error(i(483))}var Pl=null,Jo=0;function Xu(t){var a=Jo;return Jo+=1,Pl===null&&(Pl=[]),ox(Pl,t,a)}function Zo(t,a){a=a.props.ref,t.ref=a!==void 0?a:null}function Ju(t,a){throw a.$$typeof===S?Error(i(525)):(t=Object.prototype.toString.call(a),Error(i(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t)))}function dx(t){function a(Q,$){if(t){var ee=Q.deletions;ee===null?(Q.deletions=[$],Q.flags|=16):ee.push($)}}function l(Q,$){if(!t)return null;for(;$!==null;)a(Q,$),$=$.sibling;return null}function c(Q){for(var $=new Map;Q!==null;)Q.key!==null?$.set(Q.key,Q):$.set(Q.index,Q),Q=Q.sibling;return $}function f(Q,$){return Q=za(Q,$),Q.index=0,Q.sibling=null,Q}function m(Q,$,ee){return Q.index=ee,t?(ee=Q.alternate,ee!==null?(ee=ee.index,ee<$?(Q.flags|=67108866,$):ee):(Q.flags|=67108866,$)):(Q.flags|=1048576,$)}function v(Q){return t&&Q.alternate===null&&(Q.flags|=67108866),Q}function E(Q,$,ee,he){return $===null||$.tag!==6?($=Nf(ee,Q.mode,he),$.return=Q,$):($=f($,ee),$.return=Q,$)}function U(Q,$,ee,he){var Fe=ee.type;return Fe===B?oe(Q,$,ee.props.children,he,ee.key):$!==null&&($.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===T&&Pr(Fe)===$.type)?($=f($,ee.props),Zo($,ee),$.return=Q,$):($=Hu(ee.type,ee.key,ee.props,null,Q.mode,he),Zo($,ee),$.return=Q,$)}function te(Q,$,ee,he){return $===null||$.tag!==4||$.stateNode.containerInfo!==ee.containerInfo||$.stateNode.implementation!==ee.implementation?($=Ef(ee,Q.mode,he),$.return=Q,$):($=f($,ee.children||[]),$.return=Q,$)}function oe(Q,$,ee,he,Fe){return $===null||$.tag!==7?($=Ir(ee,Q.mode,he,Fe),$.return=Q,$):($=f($,ee),$.return=Q,$)}function pe(Q,$,ee){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Nf(""+$,Q.mode,ee),$.return=Q,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case C:return ee=Hu($.type,$.key,$.props,null,Q.mode,ee),Zo(ee,$),ee.return=Q,ee;case H:return $=Ef($,Q.mode,ee),$.return=Q,$;case T:return $=Pr($),pe(Q,$,ee)}if(O($)||z($))return $=Ir($,Q.mode,ee,null),$.return=Q,$;if(typeof $.then=="function")return pe(Q,Xu($),ee);if($.$$typeof===W)return pe(Q,Yu(Q,$),ee);Ju(Q,$)}return null}function se(Q,$,ee,he){var Fe=$!==null?$.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return Fe!==null?null:E(Q,$,""+ee,he);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case C:return ee.key===Fe?U(Q,$,ee,he):null;case H:return ee.key===Fe?te(Q,$,ee,he):null;case T:return ee=Pr(ee),se(Q,$,ee,he)}if(O(ee)||z(ee))return Fe!==null?null:oe(Q,$,ee,he,null);if(typeof ee.then=="function")return se(Q,$,Xu(ee),he);if(ee.$$typeof===W)return se(Q,$,Yu(Q,ee),he);Ju(Q,ee)}return null}function ie(Q,$,ee,he,Fe){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return Q=Q.get(ee)||null,E($,Q,""+he,Fe);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case C:return Q=Q.get(he.key===null?ee:he.key)||null,U($,Q,he,Fe);case H:return Q=Q.get(he.key===null?ee:he.key)||null,te($,Q,he,Fe);case T:return he=Pr(he),ie(Q,$,ee,he,Fe)}if(O(he)||z(he))return Q=Q.get(ee)||null,oe($,Q,he,Fe,null);if(typeof he.then=="function")return ie(Q,$,ee,Xu(he),Fe);if(he.$$typeof===W)return ie(Q,$,ee,Yu($,he),Fe);Ju($,he)}return null}function De(Q,$,ee,he){for(var Fe=null,_t=null,Le=$,at=$=0,ht=null;Le!==null&&at<ee.length;at++){Le.index>at?(ht=Le,Le=null):ht=Le.sibling;var Nt=se(Q,Le,ee[at],he);if(Nt===null){Le===null&&(Le=ht);break}t&&Le&&Nt.alternate===null&&a(Q,Le),$=m(Nt,$,at),_t===null?Fe=Nt:_t.sibling=Nt,_t=Nt,Le=ht}if(at===ee.length)return l(Q,Le),bt&&qa(Q,at),Fe;if(Le===null){for(;at<ee.length;at++)Le=pe(Q,ee[at],he),Le!==null&&($=m(Le,$,at),_t===null?Fe=Le:_t.sibling=Le,_t=Le);return bt&&qa(Q,at),Fe}for(Le=c(Le);at<ee.length;at++)ht=ie(Le,Q,at,ee[at],he),ht!==null&&(t&&ht.alternate!==null&&Le.delete(ht.key===null?at:ht.key),$=m(ht,$,at),_t===null?Fe=ht:_t.sibling=ht,_t=ht);return t&&Le.forEach(function(Gi){return a(Q,Gi)}),bt&&qa(Q,at),Fe}function $e(Q,$,ee,he){if(ee==null)throw Error(i(151));for(var Fe=null,_t=null,Le=$,at=$=0,ht=null,Nt=ee.next();Le!==null&&!Nt.done;at++,Nt=ee.next()){Le.index>at?(ht=Le,Le=null):ht=Le.sibling;var Gi=se(Q,Le,Nt.value,he);if(Gi===null){Le===null&&(Le=ht);break}t&&Le&&Gi.alternate===null&&a(Q,Le),$=m(Gi,$,at),_t===null?Fe=Gi:_t.sibling=Gi,_t=Gi,Le=ht}if(Nt.done)return l(Q,Le),bt&&qa(Q,at),Fe;if(Le===null){for(;!Nt.done;at++,Nt=ee.next())Nt=pe(Q,Nt.value,he),Nt!==null&&($=m(Nt,$,at),_t===null?Fe=Nt:_t.sibling=Nt,_t=Nt);return bt&&qa(Q,at),Fe}for(Le=c(Le);!Nt.done;at++,Nt=ee.next())Nt=ie(Le,Q,at,Nt.value,he),Nt!==null&&(t&&Nt.alternate!==null&&Le.delete(Nt.key===null?at:Nt.key),$=m(Nt,$,at),_t===null?Fe=Nt:_t.sibling=Nt,_t=Nt);return t&&Le.forEach(function(lS){return a(Q,lS)}),bt&&qa(Q,at),Fe}function Mt(Q,$,ee,he){if(typeof ee=="object"&&ee!==null&&ee.type===B&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case C:e:{for(var Fe=ee.key;$!==null;){if($.key===Fe){if(Fe=ee.type,Fe===B){if($.tag===7){l(Q,$.sibling),he=f($,ee.props.children),he.return=Q,Q=he;break e}}else if($.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===T&&Pr(Fe)===$.type){l(Q,$.sibling),he=f($,ee.props),Zo(he,ee),he.return=Q,Q=he;break e}l(Q,$);break}else a(Q,$);$=$.sibling}ee.type===B?(he=Ir(ee.props.children,Q.mode,he,ee.key),he.return=Q,Q=he):(he=Hu(ee.type,ee.key,ee.props,null,Q.mode,he),Zo(he,ee),he.return=Q,Q=he)}return v(Q);case H:e:{for(Fe=ee.key;$!==null;){if($.key===Fe)if($.tag===4&&$.stateNode.containerInfo===ee.containerInfo&&$.stateNode.implementation===ee.implementation){l(Q,$.sibling),he=f($,ee.children||[]),he.return=Q,Q=he;break e}else{l(Q,$);break}else a(Q,$);$=$.sibling}he=Ef(ee,Q.mode,he),he.return=Q,Q=he}return v(Q);case T:return ee=Pr(ee),Mt(Q,$,ee,he)}if(O(ee))return De(Q,$,ee,he);if(z(ee)){if(Fe=z(ee),typeof Fe!="function")throw Error(i(150));return ee=Fe.call(ee),$e(Q,$,ee,he)}if(typeof ee.then=="function")return Mt(Q,$,Xu(ee),he);if(ee.$$typeof===W)return Mt(Q,$,Yu(Q,ee),he);Ju(Q,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,$!==null&&$.tag===6?(l(Q,$.sibling),he=f($,ee),he.return=Q,Q=he):(l(Q,$),he=Nf(ee,Q.mode,he),he.return=Q,Q=he),v(Q)):l(Q,$)}return function(Q,$,ee,he){try{Jo=0;var Fe=Mt(Q,$,ee,he);return Pl=null,Fe}catch(Le){if(Le===Vl||Le===Qu)throw Le;var _t=cs(29,Le,null,Q.mode);return _t.lanes=he,_t.return=Q,_t}}}var Ur=dx(!0),hx=dx(!1),Ci=!1;function Vf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pf(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Ri(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function ki(t,a,l){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(St&2)!==0){var f=c.pending;return f===null?a.next=a:(a.next=f.next,f.next=a),c.pending=a,a=Fu(t),Q0(t,null,l),a}return qu(t,c,a,l),Fu(t)}function ec(t,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var c=a.lanes;c&=t.pendingLanes,l|=c,a.lanes=l,Va(t,l)}}function Lf(t,a){var l=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var f=null,m=null;if(l=l.firstBaseUpdate,l!==null){do{var v={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};m===null?f=m=v:m=m.next=v,l=l.next}while(l!==null);m===null?f=m=a:m=m.next=a}else f=m=a;l={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},t.updateQueue=l;return}t=l.lastBaseUpdate,t===null?l.firstBaseUpdate=a:t.next=a,l.lastBaseUpdate=a}var Uf=!1;function tc(){if(Uf){var t=Ol;if(t!==null)throw t}}function nc(t,a,l,c){Uf=!1;var f=t.updateQueue;Ci=!1;var m=f.firstBaseUpdate,v=f.lastBaseUpdate,E=f.shared.pending;if(E!==null){f.shared.pending=null;var U=E,te=U.next;U.next=null,v===null?m=te:v.next=te,v=U;var oe=t.alternate;oe!==null&&(oe=oe.updateQueue,E=oe.lastBaseUpdate,E!==v&&(E===null?oe.firstBaseUpdate=te:E.next=te,oe.lastBaseUpdate=U))}if(m!==null){var pe=f.baseState;v=0,oe=te=U=null,E=m;do{var se=E.lane&-536870913,ie=se!==E.lane;if(ie?(dt&se)===se:(c&se)===se){se!==0&&se===Ml&&(Uf=!0),oe!==null&&(oe=oe.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var De=t,$e=E;se=a;var Mt=l;switch($e.tag){case 1:if(De=$e.payload,typeof De=="function"){pe=De.call(Mt,pe,se);break e}pe=De;break e;case 3:De.flags=De.flags&-65537|128;case 0:if(De=$e.payload,se=typeof De=="function"?De.call(Mt,pe,se):De,se==null)break e;pe=_({},pe,se);break e;case 2:Ci=!0}}se=E.callback,se!==null&&(t.flags|=64,ie&&(t.flags|=8192),ie=f.callbacks,ie===null?f.callbacks=[se]:ie.push(se))}else ie={lane:se,tag:E.tag,payload:E.payload,callback:E.callback,next:null},oe===null?(te=oe=ie,U=pe):oe=oe.next=ie,v|=se;if(E=E.next,E===null){if(E=f.shared.pending,E===null)break;ie=E,E=ie.next,ie.next=null,f.lastBaseUpdate=ie,f.shared.pending=null}}while(!0);oe===null&&(U=pe),f.baseState=U,f.firstBaseUpdate=te,f.lastBaseUpdate=oe,m===null&&(f.shared.lanes=0),Vi|=v,t.lanes=v,t.memoizedState=pe}}function fx(t,a){if(typeof t!="function")throw Error(i(191,t));t.call(a)}function mx(t,a){var l=t.callbacks;if(l!==null)for(t.callbacks=null,t=0;t<l.length;t++)fx(l[t],a)}var Ll=V(null),Zu=V(0);function px(t,a){t=Za,le(Zu,t),le(Ll,a),Za=t|a.baseLanes}function Bf(){le(Zu,Za),le(Ll,Ll.current)}function zf(){Za=Zu.current,ne(Ll),ne(Zu)}var us=V(null),Is=null;function Ii(t){var a=t.alternate;le(nn,nn.current&1),le(us,t),Is===null&&(a===null||Ll.current!==null||a.memoizedState!==null)&&(Is=t)}function qf(t){le(nn,nn.current),le(us,t),Is===null&&(Is=t)}function gx(t){t.tag===22?(le(nn,nn.current),le(us,t),Is===null&&(Is=t)):Di()}function Di(){le(nn,nn.current),le(us,us.current)}function ds(t){ne(us),Is===t&&(Is=null),ne(nn)}var nn=V(0);function ed(t){for(var a=t;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Km(l)||Qm(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var $a=0,nt=null,It=null,dn=null,td=!1,Ul=!1,Br=!1,nd=0,sc=0,Bl=null,X2=0;function Kt(){throw Error(i(321))}function Ff(t,a){if(a===null)return!1;for(var l=0;l<a.length&&l<t.length;l++)if(!os(t[l],a[l]))return!1;return!0}function Hf(t,a,l,c,f,m){return $a=m,nt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,I.H=t===null||t.memoizedState===null?Zx:im,Br=!1,m=l(c,f),Br=!1,Ul&&(m=bx(a,l,c,f)),xx(t),m}function xx(t){I.H=rc;var a=It!==null&&It.next!==null;if($a=0,dn=It=nt=null,td=!1,sc=0,Bl=null,a)throw Error(i(300));t===null||hn||(t=t.dependencies,t!==null&&Gu(t)&&(hn=!0))}function bx(t,a,l,c){nt=t;var f=0;do{if(Ul&&(Bl=null),sc=0,Ul=!1,25<=f)throw Error(i(301));if(f+=1,dn=It=null,t.updateQueue!=null){var m=t.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}I.H=eb,m=a(l,c)}while(Ul);return m}function J2(){var t=I.H,a=t.useState()[0];return a=typeof a.then=="function"?ac(a):a,t=t.useState()[0],(It!==null?It.memoizedState:null)!==t&&(nt.flags|=1024),a}function $f(){var t=nd!==0;return nd=0,t}function Gf(t,a,l){a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~l}function Yf(t){if(td){for(t=t.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}td=!1}$a=0,dn=It=nt=null,Ul=!1,sc=nd=0,Bl=null}function Gn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?nt.memoizedState=dn=t:dn=dn.next=t,dn}function sn(){if(It===null){var t=nt.alternate;t=t!==null?t.memoizedState:null}else t=It.next;var a=dn===null?nt.memoizedState:dn.next;if(a!==null)dn=a,It=t;else{if(t===null)throw nt.alternate===null?Error(i(467)):Error(i(310));It=t,t={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},dn===null?nt.memoizedState=dn=t:dn=dn.next=t}return dn}function sd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ac(t){var a=sc;return sc+=1,Bl===null&&(Bl=[]),t=ox(Bl,t,a),a=nt,(dn===null?a.memoizedState:dn.next)===null&&(a=a.alternate,I.H=a===null||a.memoizedState===null?Zx:im),t}function ad(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return ac(t);if(t.$$typeof===W)return Rn(t)}throw Error(i(438,String(t)))}function Kf(t){var a=null,l=nt.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var c=nt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(f){return f.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=sd(),nt.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(t),c=0;c<t;c++)l[c]=L;return a.index++,l}function Ga(t,a){return typeof a=="function"?a(t):a}function id(t){var a=sn();return Qf(a,It,t)}function Qf(t,a,l){var c=t.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=l;var f=t.baseQueue,m=c.pending;if(m!==null){if(f!==null){var v=f.next;f.next=m.next,m.next=v}a.baseQueue=f=m,c.pending=null}if(m=t.baseState,f===null)t.memoizedState=m;else{a=f.next;var E=v=null,U=null,te=a,oe=!1;do{var pe=te.lane&-536870913;if(pe!==te.lane?(dt&pe)===pe:($a&pe)===pe){var se=te.revertLane;if(se===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),pe===Ml&&(oe=!0);else if(($a&se)===se){te=te.next,se===Ml&&(oe=!0);continue}else pe={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},U===null?(E=U=pe,v=m):U=U.next=pe,nt.lanes|=se,Vi|=se;pe=te.action,Br&&l(m,pe),m=te.hasEagerState?te.eagerState:l(m,pe)}else se={lane:pe,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},U===null?(E=U=se,v=m):U=U.next=se,nt.lanes|=pe,Vi|=pe;te=te.next}while(te!==null&&te!==a);if(U===null?v=m:U.next=E,!os(m,t.memoizedState)&&(hn=!0,oe&&(l=Ol,l!==null)))throw l;t.memoizedState=m,t.baseState=v,t.baseQueue=U,c.lastRenderedState=m}return f===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function Wf(t){var a=sn(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=t;var c=l.dispatch,f=l.pending,m=a.memoizedState;if(f!==null){l.pending=null;var v=f=f.next;do m=t(m,v.action),v=v.next;while(v!==f);os(m,a.memoizedState)||(hn=!0),a.memoizedState=m,a.baseQueue===null&&(a.baseState=m),l.lastRenderedState=m}return[m,c]}function yx(t,a,l){var c=nt,f=sn(),m=bt;if(m){if(l===void 0)throw Error(i(407));l=l()}else l=a();var v=!os((It||f).memoizedState,l);if(v&&(f.memoizedState=l,hn=!0),f=f.queue,Zf(_x.bind(null,c,f,t),[t]),f.getSnapshot!==a||v||dn!==null&&dn.memoizedState.tag&1){if(c.flags|=2048,zl(9,{destroy:void 0},wx.bind(null,c,f,l,a),null),Ot===null)throw Error(i(349));m||($a&127)!==0||vx(c,a,l)}return l}function vx(t,a,l){t.flags|=16384,t={getSnapshot:a,value:l},a=nt.updateQueue,a===null?(a=sd(),nt.updateQueue=a,a.stores=[t]):(l=a.stores,l===null?a.stores=[t]:l.push(t))}function wx(t,a,l,c){a.value=l,a.getSnapshot=c,Nx(a)&&Ex(t)}function _x(t,a,l){return l(function(){Nx(a)&&Ex(t)})}function Nx(t){var a=t.getSnapshot;t=t.value;try{var l=a();return!os(t,l)}catch{return!0}}function Ex(t){var a=kr(t,2);a!==null&&es(a,t,2)}function Xf(t){var a=Gn();if(typeof t=="function"){var l=t;if(t=l(),Br){de(!0);try{l()}finally{de(!1)}}}return a.memoizedState=a.baseState=t,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ga,lastRenderedState:t},a}function Sx(t,a,l,c){return t.baseState=l,Qf(t,It,typeof c=="function"?c:Ga)}function Z2(t,a,l,c,f){if(od(t))throw Error(i(485));if(t=a.action,t!==null){var m={payload:f,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){m.listeners.push(v)}};I.T!==null?l(!0):m.isTransition=!1,c(m),l=a.pending,l===null?(m.next=a.pending=m,Tx(a,m)):(m.next=l.next,a.pending=l.next=m)}}function Tx(t,a){var l=a.action,c=a.payload,f=t.state;if(a.isTransition){var m=I.T,v={};I.T=v;try{var E=l(f,c),U=I.S;U!==null&&U(v,E),jx(t,a,E)}catch(te){Jf(t,a,te)}finally{m!==null&&v.types!==null&&(m.types=v.types),I.T=m}}else try{m=l(f,c),jx(t,a,m)}catch(te){Jf(t,a,te)}}function jx(t,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){Ax(t,a,c)},function(c){return Jf(t,a,c)}):Ax(t,a,l)}function Ax(t,a,l){a.status="fulfilled",a.value=l,Cx(a),t.state=l,a=t.pending,a!==null&&(l=a.next,l===a?t.pending=null:(l=l.next,a.next=l,Tx(t,l)))}function Jf(t,a,l){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=l,Cx(a),a=a.next;while(a!==c)}t.action=null}function Cx(t){t=t.listeners;for(var a=0;a<t.length;a++)(0,t[a])()}function Rx(t,a){return a}function kx(t,a){if(bt){var l=Ot.formState;if(l!==null){e:{var c=nt;if(bt){if(Ut){t:{for(var f=Ut,m=ks;f.nodeType!==8;){if(!m){f=null;break t}if(f=Ds(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Ut=Ds(f.nextSibling),c=f.data==="F!";break e}}ji(c)}c=!1}c&&(a=l[0])}}return l=Gn(),l.memoizedState=l.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rx,lastRenderedState:a},l.queue=c,l=Wx.bind(null,nt,c),c.dispatch=l,c=Xf(!1),m=am.bind(null,nt,!1,c.queue),c=Gn(),f={state:a,dispatch:null,action:t,pending:null},c.queue=f,l=Z2.bind(null,nt,f,m,l),f.dispatch=l,c.memoizedState=t,[a,l,!1]}function Ix(t){var a=sn();return Dx(a,It,t)}function Dx(t,a,l){if(a=Qf(t,a,Rx)[0],t=id(Ga)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=ac(a)}catch(v){throw v===Vl?Qu:v}else c=a;a=sn();var f=a.queue,m=f.dispatch;return l!==a.memoizedState&&(nt.flags|=2048,zl(9,{destroy:void 0},eE.bind(null,f,l),null)),[c,m,t]}function eE(t,a){t.action=a}function Mx(t){var a=sn(),l=It;if(l!==null)return Dx(a,l,t);sn(),a=a.memoizedState,l=sn();var c=l.queue.dispatch;return l.memoizedState=t,[a,c,!1]}function zl(t,a,l,c){return t={tag:t,create:l,deps:c,inst:a,next:null},a=nt.updateQueue,a===null&&(a=sd(),nt.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=t.next=t:(c=l.next,l.next=t,t.next=c,a.lastEffect=t),t}function Ox(){return sn().memoizedState}function rd(t,a,l,c){var f=Gn();nt.flags|=t,f.memoizedState=zl(1|a,{destroy:void 0},l,c===void 0?null:c)}function ld(t,a,l,c){var f=sn();c=c===void 0?null:c;var m=f.memoizedState.inst;It!==null&&c!==null&&Ff(c,It.memoizedState.deps)?f.memoizedState=zl(a,m,l,c):(nt.flags|=t,f.memoizedState=zl(1|a,m,l,c))}function Vx(t,a){rd(8390656,8,t,a)}function Zf(t,a){ld(2048,8,t,a)}function tE(t){nt.flags|=4;var a=nt.updateQueue;if(a===null)a=sd(),nt.updateQueue=a,a.events=[t];else{var l=a.events;l===null?a.events=[t]:l.push(t)}}function Px(t){var a=sn().memoizedState;return tE({ref:a,nextImpl:t}),function(){if((St&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function Lx(t,a){return ld(4,2,t,a)}function Ux(t,a){return ld(4,4,t,a)}function Bx(t,a){if(typeof a=="function"){t=t();var l=a(t);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function zx(t,a,l){l=l!=null?l.concat([t]):null,ld(4,4,Bx.bind(null,a,t),l)}function em(){}function qx(t,a){var l=sn();a=a===void 0?null:a;var c=l.memoizedState;return a!==null&&Ff(a,c[1])?c[0]:(l.memoizedState=[t,a],t)}function Fx(t,a){var l=sn();a=a===void 0?null:a;var c=l.memoizedState;if(a!==null&&Ff(a,c[1]))return c[0];if(c=t(),Br){de(!0);try{t()}finally{de(!1)}}return l.memoizedState=[c,a],c}function tm(t,a,l){return l===void 0||($a&1073741824)!==0&&(dt&261930)===0?t.memoizedState=a:(t.memoizedState=l,t=Hb(),nt.lanes|=t,Vi|=t,l)}function Hx(t,a,l,c){return os(l,a)?l:Ll.current!==null?(t=tm(t,l,c),os(t,a)||(hn=!0),t):($a&42)===0||($a&1073741824)!==0&&(dt&261930)===0?(hn=!0,t.memoizedState=l):(t=Hb(),nt.lanes|=t,Vi|=t,a)}function $x(t,a,l,c,f){var m=K.p;K.p=m!==0&&8>m?m:8;var v=I.T,E={};I.T=E,am(t,!1,a,l);try{var U=f(),te=I.S;if(te!==null&&te(E,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var oe=W2(U,c);ic(t,a,oe,ms(t))}else ic(t,a,c,ms(t))}catch(pe){ic(t,a,{then:function(){},status:"rejected",reason:pe},ms())}finally{K.p=m,v!==null&&E.types!==null&&(v.types=E.types),I.T=v}}function nE(){}function nm(t,a,l,c){if(t.tag!==5)throw Error(i(476));var f=Gx(t).queue;$x(t,f,a,fe,l===null?nE:function(){return Yx(t),l(c)})}function Gx(t){var a=t.memoizedState;if(a!==null)return a;a={memoizedState:fe,baseState:fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ga,lastRenderedState:fe},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ga,lastRenderedState:l},next:null},t.memoizedState=a,t=t.alternate,t!==null&&(t.memoizedState=a),a}function Yx(t){var a=Gx(t);a.next===null&&(a=t.alternate.memoizedState),ic(t,a.next.queue,{},ms())}function sm(){return Rn(_c)}function Kx(){return sn().memoizedState}function Qx(){return sn().memoizedState}function sE(t){for(var a=t.return;a!==null;){switch(a.tag){case 24:case 3:var l=ms();t=Ri(l);var c=ki(a,t,l);c!==null&&(es(c,a,l),ec(c,a,l)),a={cache:If()},t.payload=a;return}a=a.return}}function aE(t,a,l){var c=ms();l={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},od(t)?Xx(a,l):(l=wf(t,a,l,c),l!==null&&(es(l,t,c),Jx(l,a,c)))}function Wx(t,a,l){var c=ms();ic(t,a,l,c)}function ic(t,a,l,c){var f={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(od(t))Xx(a,f);else{var m=t.alternate;if(t.lanes===0&&(m===null||m.lanes===0)&&(m=a.lastRenderedReducer,m!==null))try{var v=a.lastRenderedState,E=m(v,l);if(f.hasEagerState=!0,f.eagerState=E,os(E,v))return qu(t,a,f,0),Ot===null&&zu(),!1}catch{}if(l=wf(t,a,f,c),l!==null)return es(l,t,c),Jx(l,a,c),!0}return!1}function am(t,a,l,c){if(c={lane:2,revertLane:Vm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},od(t)){if(a)throw Error(i(479))}else a=wf(t,l,c,2),a!==null&&es(a,t,2)}function od(t){var a=t.alternate;return t===nt||a!==null&&a===nt}function Xx(t,a){Ul=td=!0;var l=t.pending;l===null?a.next=a:(a.next=l.next,l.next=a),t.pending=a}function Jx(t,a,l){if((l&4194048)!==0){var c=a.lanes;c&=t.pendingLanes,l|=c,a.lanes=l,Va(t,l)}}var rc={readContext:Rn,use:ad,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useLayoutEffect:Kt,useInsertionEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useSyncExternalStore:Kt,useId:Kt,useHostTransitionStatus:Kt,useFormState:Kt,useActionState:Kt,useOptimistic:Kt,useMemoCache:Kt,useCacheRefresh:Kt};rc.useEffectEvent=Kt;var Zx={readContext:Rn,use:ad,useCallback:function(t,a){return Gn().memoizedState=[t,a===void 0?null:a],t},useContext:Rn,useEffect:Vx,useImperativeHandle:function(t,a,l){l=l!=null?l.concat([t]):null,rd(4194308,4,Bx.bind(null,a,t),l)},useLayoutEffect:function(t,a){return rd(4194308,4,t,a)},useInsertionEffect:function(t,a){rd(4,2,t,a)},useMemo:function(t,a){var l=Gn();a=a===void 0?null:a;var c=t();if(Br){de(!0);try{t()}finally{de(!1)}}return l.memoizedState=[c,a],c},useReducer:function(t,a,l){var c=Gn();if(l!==void 0){var f=l(a);if(Br){de(!0);try{l(a)}finally{de(!1)}}}else f=a;return c.memoizedState=c.baseState=f,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:f},c.queue=t,t=t.dispatch=aE.bind(null,nt,t),[c.memoizedState,t]},useRef:function(t){var a=Gn();return t={current:t},a.memoizedState=t},useState:function(t){t=Xf(t);var a=t.queue,l=Wx.bind(null,nt,a);return a.dispatch=l,[t.memoizedState,l]},useDebugValue:em,useDeferredValue:function(t,a){var l=Gn();return tm(l,t,a)},useTransition:function(){var t=Xf(!1);return t=$x.bind(null,nt,t.queue,!0,!1),Gn().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,a,l){var c=nt,f=Gn();if(bt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),Ot===null)throw Error(i(349));(dt&127)!==0||vx(c,a,l)}f.memoizedState=l;var m={value:l,getSnapshot:a};return f.queue=m,Vx(_x.bind(null,c,m,t),[t]),c.flags|=2048,zl(9,{destroy:void 0},wx.bind(null,c,m,l,a),null),l},useId:function(){var t=Gn(),a=Ot.identifierPrefix;if(bt){var l=ba,c=xa;l=(c&~(1<<32-ce(c)-1)).toString(32)+l,a="_"+a+"R_"+l,l=nd++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=X2++,a="_"+a+"r_"+l.toString(32)+"_";return t.memoizedState=a},useHostTransitionStatus:sm,useFormState:kx,useActionState:kx,useOptimistic:function(t){var a=Gn();a.memoizedState=a.baseState=t;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=am.bind(null,nt,!0,l),l.dispatch=a,[t,a]},useMemoCache:Kf,useCacheRefresh:function(){return Gn().memoizedState=sE.bind(null,nt)},useEffectEvent:function(t){var a=Gn(),l={impl:t};return a.memoizedState=l,function(){if((St&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},im={readContext:Rn,use:ad,useCallback:qx,useContext:Rn,useEffect:Zf,useImperativeHandle:zx,useInsertionEffect:Lx,useLayoutEffect:Ux,useMemo:Fx,useReducer:id,useRef:Ox,useState:function(){return id(Ga)},useDebugValue:em,useDeferredValue:function(t,a){var l=sn();return Hx(l,It.memoizedState,t,a)},useTransition:function(){var t=id(Ga)[0],a=sn().memoizedState;return[typeof t=="boolean"?t:ac(t),a]},useSyncExternalStore:yx,useId:Kx,useHostTransitionStatus:sm,useFormState:Ix,useActionState:Ix,useOptimistic:function(t,a){var l=sn();return Sx(l,It,t,a)},useMemoCache:Kf,useCacheRefresh:Qx};im.useEffectEvent=Px;var eb={readContext:Rn,use:ad,useCallback:qx,useContext:Rn,useEffect:Zf,useImperativeHandle:zx,useInsertionEffect:Lx,useLayoutEffect:Ux,useMemo:Fx,useReducer:Wf,useRef:Ox,useState:function(){return Wf(Ga)},useDebugValue:em,useDeferredValue:function(t,a){var l=sn();return It===null?tm(l,t,a):Hx(l,It.memoizedState,t,a)},useTransition:function(){var t=Wf(Ga)[0],a=sn().memoizedState;return[typeof t=="boolean"?t:ac(t),a]},useSyncExternalStore:yx,useId:Kx,useHostTransitionStatus:sm,useFormState:Mx,useActionState:Mx,useOptimistic:function(t,a){var l=sn();return It!==null?Sx(l,It,t,a):(l.baseState=t,[t,l.queue.dispatch])},useMemoCache:Kf,useCacheRefresh:Qx};eb.useEffectEvent=Px;function rm(t,a,l,c){a=t.memoizedState,l=l(c,a),l=l==null?a:_({},a,l),t.memoizedState=l,t.lanes===0&&(t.updateQueue.baseState=l)}var lm={enqueueSetState:function(t,a,l){t=t._reactInternals;var c=ms(),f=Ri(c);f.payload=a,l!=null&&(f.callback=l),a=ki(t,f,c),a!==null&&(es(a,t,c),ec(a,t,c))},enqueueReplaceState:function(t,a,l){t=t._reactInternals;var c=ms(),f=Ri(c);f.tag=1,f.payload=a,l!=null&&(f.callback=l),a=ki(t,f,c),a!==null&&(es(a,t,c),ec(a,t,c))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var l=ms(),c=Ri(l);c.tag=2,a!=null&&(c.callback=a),a=ki(t,c,l),a!==null&&(es(a,t,l),ec(a,t,l))}};function tb(t,a,l,c,f,m,v){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,m,v):a.prototype&&a.prototype.isPureReactComponent?!Go(l,c)||!Go(f,m):!0}function nb(t,a,l,c){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,c),a.state!==t&&lm.enqueueReplaceState(a,a.state,null)}function zr(t,a){var l=a;if("ref"in a){l={};for(var c in a)c!=="ref"&&(l[c]=a[c])}if(t=t.defaultProps){l===a&&(l=_({},l));for(var f in t)l[f]===void 0&&(l[f]=t[f])}return l}function sb(t){Bu(t)}function ab(t){console.error(t)}function ib(t){Bu(t)}function cd(t,a){try{var l=t.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function rb(t,a,l){try{var c=t.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function om(t,a,l){return l=Ri(l),l.tag=3,l.payload={element:null},l.callback=function(){cd(t,a)},l}function lb(t){return t=Ri(t),t.tag=3,t}function ob(t,a,l,c){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;t.payload=function(){return f(m)},t.callback=function(){rb(a,l,c)}}var v=l.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(t.callback=function(){rb(a,l,c),typeof f!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var E=c.stack;this.componentDidCatch(c.value,{componentStack:E!==null?E:""})})}function iE(t,a,l,c,f){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=l.alternate,a!==null&&Dl(a,l,f,!0),l=us.current,l!==null){switch(l.tag){case 31:case 13:return Is===null?wd():l.alternate===null&&Qt===0&&(Qt=3),l.flags&=-257,l.flags|=65536,l.lanes=f,c===Wu?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([c]):a.add(c),Dm(t,c,f)),!1;case 22:return l.flags|=65536,c===Wu?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([c]):l.add(c)),Dm(t,c,f)),!1}throw Error(i(435,l.tag))}return Dm(t,c,f),wd(),!1}if(bt)return a=us.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=f,c!==jf&&(t=Error(i(422),{cause:c}),Qo(As(t,l)))):(c!==jf&&(a=Error(i(423),{cause:c}),Qo(As(a,l))),t=t.current.alternate,t.flags|=65536,f&=-f,t.lanes|=f,c=As(c,l),f=om(t.stateNode,c,f),Lf(t,f),Qt!==4&&(Qt=2)),!1;var m=Error(i(520),{cause:c});if(m=As(m,l),mc===null?mc=[m]:mc.push(m),Qt!==4&&(Qt=2),a===null)return!0;c=As(c,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,t=f&-f,l.lanes|=t,t=om(l.stateNode,c,t),Lf(l,t),!1;case 1:if(a=l.type,m=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Pi===null||!Pi.has(m))))return l.flags|=65536,f&=-f,l.lanes|=f,f=lb(f),ob(f,t,l,c),Lf(l,f),!1}l=l.return}while(l!==null);return!1}var cm=Error(i(461)),hn=!1;function kn(t,a,l,c){a.child=t===null?hx(a,null,l,c):Ur(a,t.child,l,c)}function cb(t,a,l,c,f){l=l.render;var m=a.ref;if("ref"in c){var v={};for(var E in c)E!=="ref"&&(v[E]=c[E])}else v=c;return Or(a),c=Hf(t,a,l,v,m,f),E=$f(),t!==null&&!hn?(Gf(t,a,f),Ya(t,a,f)):(bt&&E&&Sf(a),a.flags|=1,kn(t,a,c,f),a.child)}function ub(t,a,l,c,f){if(t===null){var m=l.type;return typeof m=="function"&&!_f(m)&&m.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=m,db(t,a,m,c,f)):(t=Hu(l.type,null,c,a,a.mode,f),t.ref=a.ref,t.return=a,a.child=t)}if(m=t.child,!xm(t,f)){var v=m.memoizedProps;if(l=l.compare,l=l!==null?l:Go,l(v,c)&&t.ref===a.ref)return Ya(t,a,f)}return a.flags|=1,t=za(m,c),t.ref=a.ref,t.return=a,a.child=t}function db(t,a,l,c,f){if(t!==null){var m=t.memoizedProps;if(Go(m,c)&&t.ref===a.ref)if(hn=!1,a.pendingProps=c=m,xm(t,f))(t.flags&131072)!==0&&(hn=!0);else return a.lanes=t.lanes,Ya(t,a,f)}return um(t,a,l,c,f)}function hb(t,a,l,c){var f=c.children,m=t!==null?t.memoizedState:null;if(t===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(m=m!==null?m.baseLanes|l:l,t!==null){for(c=a.child=t.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,a.child=null;return fb(t,a,m,l,c)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},t!==null&&Ku(a,m!==null?m.cachePool:null),m!==null?px(a,m):Bf(),gx(a);else return c=a.lanes=536870912,fb(t,a,m!==null?m.baseLanes|l:l,l,c)}else m!==null?(Ku(a,m.cachePool),px(a,m),Di(),a.memoizedState=null):(t!==null&&Ku(a,null),Bf(),Di());return kn(t,a,f,l),a.child}function lc(t,a){return t!==null&&t.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function fb(t,a,l,c,f){var m=Mf();return m=m===null?null:{parent:un._currentValue,pool:m},a.memoizedState={baseLanes:l,cachePool:m},t!==null&&Ku(a,null),Bf(),gx(a),t!==null&&Dl(t,a,c,!0),a.childLanes=f,null}function ud(t,a){return a=hd({mode:a.mode,children:a.children},t.mode),a.ref=t.ref,t.child=a,a.return=t,a}function mb(t,a,l){return Ur(a,t.child,null,l),t=ud(a,a.pendingProps),t.flags|=2,ds(a),a.memoizedState=null,t}function rE(t,a,l){var c=a.pendingProps,f=(a.flags&128)!==0;if(a.flags&=-129,t===null){if(bt){if(c.mode==="hidden")return t=ud(a,c),a.lanes=536870912,lc(null,t);if(qf(a),(t=Ut)?(t=Ty(t,ks),t=t!==null&&t.data==="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Si!==null?{id:xa,overflow:ba}:null,retryLane:536870912,hydrationErrors:null},l=X0(t),l.return=a,a.child=l,Cn=a,Ut=null)):t=null,t===null)throw ji(a);return a.lanes=536870912,null}return ud(a,c)}var m=t.memoizedState;if(m!==null){var v=m.dehydrated;if(qf(a),f)if(a.flags&256)a.flags&=-257,a=mb(t,a,l);else if(a.memoizedState!==null)a.child=t.child,a.flags|=128,a=null;else throw Error(i(558));else if(hn||Dl(t,a,l,!1),f=(l&t.childLanes)!==0,hn||f){if(c=Ot,c!==null&&(v=mi(c,l),v!==0&&v!==m.retryLane))throw m.retryLane=v,kr(t,v),es(c,t,v),cm;wd(),a=mb(t,a,l)}else t=m.treeContext,Ut=Ds(v.nextSibling),Cn=a,bt=!0,Ti=null,ks=!1,t!==null&&ex(a,t),a=ud(a,c),a.flags|=4096;return a}return t=za(t.child,{mode:c.mode,children:c.children}),t.ref=a.ref,a.child=t,t.return=a,t}function dd(t,a){var l=a.ref;if(l===null)t!==null&&t.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(t===null||t.ref!==l)&&(a.flags|=4194816)}}function um(t,a,l,c,f){return Or(a),l=Hf(t,a,l,c,void 0,f),c=$f(),t!==null&&!hn?(Gf(t,a,f),Ya(t,a,f)):(bt&&c&&Sf(a),a.flags|=1,kn(t,a,l,f),a.child)}function pb(t,a,l,c,f,m){return Or(a),a.updateQueue=null,l=bx(a,c,l,f),xx(t),c=$f(),t!==null&&!hn?(Gf(t,a,m),Ya(t,a,m)):(bt&&c&&Sf(a),a.flags|=1,kn(t,a,l,m),a.child)}function gb(t,a,l,c,f){if(Or(a),a.stateNode===null){var m=Cl,v=l.contextType;typeof v=="object"&&v!==null&&(m=Rn(v)),m=new l(c,m),a.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=lm,a.stateNode=m,m._reactInternals=a,m=a.stateNode,m.props=c,m.state=a.memoizedState,m.refs={},Vf(a),v=l.contextType,m.context=typeof v=="object"&&v!==null?Rn(v):Cl,m.state=a.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(rm(a,l,v,c),m.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(v=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),v!==m.state&&lm.enqueueReplaceState(m,m.state,null),nc(a,c,m,f),tc(),m.state=a.memoizedState),typeof m.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(t===null){m=a.stateNode;var E=a.memoizedProps,U=zr(l,E);m.props=U;var te=m.context,oe=l.contextType;v=Cl,typeof oe=="object"&&oe!==null&&(v=Rn(oe));var pe=l.getDerivedStateFromProps;oe=typeof pe=="function"||typeof m.getSnapshotBeforeUpdate=="function",E=a.pendingProps!==E,oe||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(E||te!==v)&&nb(a,m,c,v),Ci=!1;var se=a.memoizedState;m.state=se,nc(a,c,m,f),tc(),te=a.memoizedState,E||se!==te||Ci?(typeof pe=="function"&&(rm(a,l,pe,c),te=a.memoizedState),(U=Ci||tb(a,l,U,c,se,te,v))?(oe||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(a.flags|=4194308)):(typeof m.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=te),m.props=c,m.state=te,m.context=v,c=U):(typeof m.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{m=a.stateNode,Pf(t,a),v=a.memoizedProps,oe=zr(l,v),m.props=oe,pe=a.pendingProps,se=m.context,te=l.contextType,U=Cl,typeof te=="object"&&te!==null&&(U=Rn(te)),E=l.getDerivedStateFromProps,(te=typeof E=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==pe||se!==U)&&nb(a,m,c,U),Ci=!1,se=a.memoizedState,m.state=se,nc(a,c,m,f),tc();var ie=a.memoizedState;v!==pe||se!==ie||Ci||t!==null&&t.dependencies!==null&&Gu(t.dependencies)?(typeof E=="function"&&(rm(a,l,E,c),ie=a.memoizedState),(oe=Ci||tb(a,l,oe,c,se,ie,U)||t!==null&&t.dependencies!==null&&Gu(t.dependencies))?(te||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,ie,U),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,ie,U)),typeof m.componentDidUpdate=="function"&&(a.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===t.memoizedProps&&se===t.memoizedState||(a.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===t.memoizedProps&&se===t.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=ie),m.props=c,m.state=ie,m.context=U,c=oe):(typeof m.componentDidUpdate!="function"||v===t.memoizedProps&&se===t.memoizedState||(a.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===t.memoizedProps&&se===t.memoizedState||(a.flags|=1024),c=!1)}return m=c,dd(t,a),c=(a.flags&128)!==0,m||c?(m=a.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:m.render(),a.flags|=1,t!==null&&c?(a.child=Ur(a,t.child,null,f),a.child=Ur(a,null,l,f)):kn(t,a,l,f),a.memoizedState=m.state,t=a.child):t=Ya(t,a,f),t}function xb(t,a,l,c){return Dr(),a.flags|=256,kn(t,a,l,c),a.child}var dm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hm(t){return{baseLanes:t,cachePool:rx()}}function fm(t,a,l){return t=t!==null?t.childLanes&~l:0,a&&(t|=fs),t}function bb(t,a,l){var c=a.pendingProps,f=!1,m=(a.flags&128)!==0,v;if((v=m)||(v=t!==null&&t.memoizedState===null?!1:(nn.current&2)!==0),v&&(f=!0,a.flags&=-129),v=(a.flags&32)!==0,a.flags&=-33,t===null){if(bt){if(f?Ii(a):Di(),(t=Ut)?(t=Ty(t,ks),t=t!==null&&t.data!=="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Si!==null?{id:xa,overflow:ba}:null,retryLane:536870912,hydrationErrors:null},l=X0(t),l.return=a,a.child=l,Cn=a,Ut=null)):t=null,t===null)throw ji(a);return Qm(t)?a.lanes=32:a.lanes=536870912,null}var E=c.children;return c=c.fallback,f?(Di(),f=a.mode,E=hd({mode:"hidden",children:E},f),c=Ir(c,f,l,null),E.return=a,c.return=a,E.sibling=c,a.child=E,c=a.child,c.memoizedState=hm(l),c.childLanes=fm(t,v,l),a.memoizedState=dm,lc(null,c)):(Ii(a),mm(a,E))}var U=t.memoizedState;if(U!==null&&(E=U.dehydrated,E!==null)){if(m)a.flags&256?(Ii(a),a.flags&=-257,a=pm(t,a,l)):a.memoizedState!==null?(Di(),a.child=t.child,a.flags|=128,a=null):(Di(),E=c.fallback,f=a.mode,c=hd({mode:"visible",children:c.children},f),E=Ir(E,f,l,null),E.flags|=2,c.return=a,E.return=a,c.sibling=E,a.child=c,Ur(a,t.child,null,l),c=a.child,c.memoizedState=hm(l),c.childLanes=fm(t,v,l),a.memoizedState=dm,a=lc(null,c));else if(Ii(a),Qm(E)){if(v=E.nextSibling&&E.nextSibling.dataset,v)var te=v.dgst;v=te,c=Error(i(419)),c.stack="",c.digest=v,Qo({value:c,source:null,stack:null}),a=pm(t,a,l)}else if(hn||Dl(t,a,l,!1),v=(l&t.childLanes)!==0,hn||v){if(v=Ot,v!==null&&(c=mi(v,l),c!==0&&c!==U.retryLane))throw U.retryLane=c,kr(t,c),es(v,t,c),cm;Km(E)||wd(),a=pm(t,a,l)}else Km(E)?(a.flags|=192,a.child=t.child,a=null):(t=U.treeContext,Ut=Ds(E.nextSibling),Cn=a,bt=!0,Ti=null,ks=!1,t!==null&&ex(a,t),a=mm(a,c.children),a.flags|=4096);return a}return f?(Di(),E=c.fallback,f=a.mode,U=t.child,te=U.sibling,c=za(U,{mode:"hidden",children:c.children}),c.subtreeFlags=U.subtreeFlags&65011712,te!==null?E=za(te,E):(E=Ir(E,f,l,null),E.flags|=2),E.return=a,c.return=a,c.sibling=E,a.child=c,lc(null,c),c=a.child,E=t.child.memoizedState,E===null?E=hm(l):(f=E.cachePool,f!==null?(U=un._currentValue,f=f.parent!==U?{parent:U,pool:U}:f):f=rx(),E={baseLanes:E.baseLanes|l,cachePool:f}),c.memoizedState=E,c.childLanes=fm(t,v,l),a.memoizedState=dm,lc(t.child,c)):(Ii(a),l=t.child,t=l.sibling,l=za(l,{mode:"visible",children:c.children}),l.return=a,l.sibling=null,t!==null&&(v=a.deletions,v===null?(a.deletions=[t],a.flags|=16):v.push(t)),a.child=l,a.memoizedState=null,l)}function mm(t,a){return a=hd({mode:"visible",children:a},t.mode),a.return=t,t.child=a}function hd(t,a){return t=cs(22,t,null,a),t.lanes=0,t}function pm(t,a,l){return Ur(a,t.child,null,l),t=mm(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function yb(t,a,l){t.lanes|=a;var c=t.alternate;c!==null&&(c.lanes|=a),Rf(t.return,a,l)}function gm(t,a,l,c,f,m){var v=t.memoizedState;v===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:f,treeForkCount:m}:(v.isBackwards=a,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=l,v.tailMode=f,v.treeForkCount=m)}function vb(t,a,l){var c=a.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var v=nn.current,E=(v&2)!==0;if(E?(v=v&1|2,a.flags|=128):v&=1,le(nn,v),kn(t,a,c,l),c=bt?Ko:0,!E&&t!==null&&(t.flags&128)!==0)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&yb(t,l,a);else if(t.tag===19)yb(t,l,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(f){case"forwards":for(l=a.child,f=null;l!==null;)t=l.alternate,t!==null&&ed(t)===null&&(f=l),l=l.sibling;l=f,l===null?(f=a.child,a.child=null):(f=l.sibling,l.sibling=null),gm(a,!1,f,l,m,c);break;case"backwards":case"unstable_legacy-backwards":for(l=null,f=a.child,a.child=null;f!==null;){if(t=f.alternate,t!==null&&ed(t)===null){a.child=f;break}t=f.sibling,f.sibling=l,l=f,f=t}gm(a,!0,l,null,m,c);break;case"together":gm(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function Ya(t,a,l){if(t!==null&&(a.dependencies=t.dependencies),Vi|=a.lanes,(l&a.childLanes)===0)if(t!==null){if(Dl(t,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(t!==null&&a.child!==t.child)throw Error(i(153));if(a.child!==null){for(t=a.child,l=za(t,t.pendingProps),a.child=l,l.return=a;t.sibling!==null;)t=t.sibling,l=l.sibling=za(t,t.pendingProps),l.return=a;l.sibling=null}return a.child}function xm(t,a){return(t.lanes&a)!==0?!0:(t=t.dependencies,!!(t!==null&&Gu(t)))}function lE(t,a,l){switch(a.tag){case 3:ze(a,a.stateNode.containerInfo),Ai(a,un,t.memoizedState.cache),Dr();break;case 27:case 5:Ge(a);break;case 4:ze(a,a.stateNode.containerInfo);break;case 10:Ai(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,qf(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Ii(a),a.flags|=128,null):(l&a.child.childLanes)!==0?bb(t,a,l):(Ii(a),t=Ya(t,a,l),t!==null?t.sibling:null);Ii(a);break;case 19:var f=(t.flags&128)!==0;if(c=(l&a.childLanes)!==0,c||(Dl(t,a,l,!1),c=(l&a.childLanes)!==0),f){if(c)return vb(t,a,l);a.flags|=128}if(f=a.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),le(nn,nn.current),c)break;return null;case 22:return a.lanes=0,hb(t,a,l,a.pendingProps);case 24:Ai(a,un,t.memoizedState.cache)}return Ya(t,a,l)}function wb(t,a,l){if(t!==null)if(t.memoizedProps!==a.pendingProps)hn=!0;else{if(!xm(t,l)&&(a.flags&128)===0)return hn=!1,lE(t,a,l);hn=(t.flags&131072)!==0}else hn=!1,bt&&(a.flags&1048576)!==0&&Z0(a,Ko,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(t=Pr(a.elementType),a.type=t,typeof t=="function")_f(t)?(c=zr(t,c),a.tag=1,a=gb(null,a,t,c,l)):(a.tag=0,a=um(null,a,t,c,l));else{if(t!=null){var f=t.$$typeof;if(f===xe){a.tag=11,a=cb(null,a,t,c,l);break e}else if(f===j){a.tag=14,a=ub(null,a,t,c,l);break e}}throw a=F(t)||t,Error(i(306,a,""))}}return a;case 0:return um(t,a,a.type,a.pendingProps,l);case 1:return c=a.type,f=zr(c,a.pendingProps),gb(t,a,c,f,l);case 3:e:{if(ze(a,a.stateNode.containerInfo),t===null)throw Error(i(387));c=a.pendingProps;var m=a.memoizedState;f=m.element,Pf(t,a),nc(a,c,null,l);var v=a.memoizedState;if(c=v.cache,Ai(a,un,c),c!==m.cache&&kf(a,[un],l,!0),tc(),c=v.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:v.cache},a.updateQueue.baseState=m,a.memoizedState=m,a.flags&256){a=xb(t,a,c,l);break e}else if(c!==f){f=As(Error(i(424)),a),Qo(f),a=xb(t,a,c,l);break e}else for(t=a.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,Ut=Ds(t.firstChild),Cn=a,bt=!0,Ti=null,ks=!0,l=hx(a,null,c,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Dr(),c===f){a=Ya(t,a,l);break e}kn(t,a,c,l)}a=a.child}return a;case 26:return dd(t,a),t===null?(l=Iy(a.type,null,a.pendingProps,null))?a.memoizedState=l:bt||(l=a.type,t=a.pendingProps,c=Ad(Ie.current).createElement(l),c[ln]=a,c[Nn]=t,In(c,l,t),on(c),a.stateNode=c):a.memoizedState=Iy(a.type,t.memoizedProps,a.pendingProps,t.memoizedState),null;case 27:return Ge(a),t===null&&bt&&(c=a.stateNode=Cy(a.type,a.pendingProps,Ie.current),Cn=a,ks=!0,f=Ut,zi(a.type)?(Wm=f,Ut=Ds(c.firstChild)):Ut=f),kn(t,a,a.pendingProps.children,l),dd(t,a),t===null&&(a.flags|=4194304),a.child;case 5:return t===null&&bt&&((f=c=Ut)&&(c=PE(c,a.type,a.pendingProps,ks),c!==null?(a.stateNode=c,Cn=a,Ut=Ds(c.firstChild),ks=!1,f=!0):f=!1),f||ji(a)),Ge(a),f=a.type,m=a.pendingProps,v=t!==null?t.memoizedProps:null,c=m.children,$m(f,m)?c=null:v!==null&&$m(f,v)&&(a.flags|=32),a.memoizedState!==null&&(f=Hf(t,a,J2,null,null,l),_c._currentValue=f),dd(t,a),kn(t,a,c,l),a.child;case 6:return t===null&&bt&&((t=l=Ut)&&(l=LE(l,a.pendingProps,ks),l!==null?(a.stateNode=l,Cn=a,Ut=null,t=!0):t=!1),t||ji(a)),null;case 13:return bb(t,a,l);case 4:return ze(a,a.stateNode.containerInfo),c=a.pendingProps,t===null?a.child=Ur(a,null,c,l):kn(t,a,c,l),a.child;case 11:return cb(t,a,a.type,a.pendingProps,l);case 7:return kn(t,a,a.pendingProps,l),a.child;case 8:return kn(t,a,a.pendingProps.children,l),a.child;case 12:return kn(t,a,a.pendingProps.children,l),a.child;case 10:return c=a.pendingProps,Ai(a,a.type,c.value),kn(t,a,c.children,l),a.child;case 9:return f=a.type._context,c=a.pendingProps.children,Or(a),f=Rn(f),c=c(f),a.flags|=1,kn(t,a,c,l),a.child;case 14:return ub(t,a,a.type,a.pendingProps,l);case 15:return db(t,a,a.type,a.pendingProps,l);case 19:return vb(t,a,l);case 31:return rE(t,a,l);case 22:return hb(t,a,l,a.pendingProps);case 24:return Or(a),c=Rn(un),t===null?(f=Mf(),f===null&&(f=Ot,m=If(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=l),f=m),a.memoizedState={parent:c,cache:f},Vf(a),Ai(a,un,f)):((t.lanes&l)!==0&&(Pf(t,a),nc(a,null,null,l),tc()),f=t.memoizedState,m=a.memoizedState,f.parent!==c?(f={parent:c,cache:c},a.memoizedState=f,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=f),Ai(a,un,c)):(c=m.cache,Ai(a,un,c),c!==f.cache&&kf(a,[un],l,!0))),kn(t,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Ka(t){t.flags|=4}function bm(t,a,l,c,f){if((a=(t.mode&32)!==0)&&(a=!1),a){if(t.flags|=16777216,(f&335544128)===f)if(t.stateNode.complete)t.flags|=8192;else if(Kb())t.flags|=8192;else throw Lr=Wu,Of}else t.flags&=-16777217}function _b(t,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Py(a))if(Kb())t.flags|=8192;else throw Lr=Wu,Of}function fd(t,a){a!==null&&(t.flags|=4),t.flags&16384&&(a=t.tag!==22?wn():536870912,t.lanes|=a,$l|=a)}function oc(t,a){if(!bt)switch(t.tailMode){case"hidden":a=t.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?t.tail=null:l.sibling=null;break;case"collapsed":l=t.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Bt(t){var a=t.alternate!==null&&t.alternate.child===t.child,l=0,c=0;if(a)for(var f=t.child;f!==null;)l|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)l|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=c,t.childLanes=l,a}function oE(t,a,l){var c=a.pendingProps;switch(Tf(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(a),null;case 1:return Bt(a),null;case 3:return l=a.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Ha(un),Ue(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(t===null||t.child===null)&&(Il(a)?Ka(a):t===null||t.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Af())),Bt(a),null;case 26:var f=a.type,m=a.memoizedState;return t===null?(Ka(a),m!==null?(Bt(a),_b(a,m)):(Bt(a),bm(a,f,null,c,l))):m?m!==t.memoizedState?(Ka(a),Bt(a),_b(a,m)):(Bt(a),a.flags&=-16777217):(t=t.memoizedProps,t!==c&&Ka(a),Bt(a),bm(a,f,t,c,l)),null;case 27:if(J(a),l=Ie.current,f=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==c&&Ka(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return Bt(a),null}t=_e.current,Il(a)?tx(a):(t=Cy(f,c,l),a.stateNode=t,Ka(a))}return Bt(a),null;case 5:if(J(a),f=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==c&&Ka(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return Bt(a),null}if(m=_e.current,Il(a))tx(a);else{var v=Ad(Ie.current);switch(m){case 1:m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=v.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?v.createElement("select",{is:c.is}):v.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?v.createElement(f,{is:c.is}):v.createElement(f)}}m[ln]=a,m[Nn]=c;e:for(v=a.child;v!==null;){if(v.tag===5||v.tag===6)m.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===a)break e;for(;v.sibling===null;){if(v.return===null||v.return===a)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}a.stateNode=m;e:switch(In(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Ka(a)}}return Bt(a),bm(a,a.type,t===null?null:t.memoizedProps,a.pendingProps,l),null;case 6:if(t&&a.stateNode!=null)t.memoizedProps!==c&&Ka(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(t=Ie.current,Il(a)){if(t=a.stateNode,l=a.memoizedProps,c=null,f=Cn,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}t[ln]=a,t=!!(t.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||by(t.nodeValue,l)),t||ji(a,!0)}else t=Ad(t).createTextNode(c),t[ln]=a,a.stateNode=t}return Bt(a),null;case 31:if(l=a.memoizedState,t===null||t.memoizedState!==null){if(c=Il(a),l!==null){if(t===null){if(!c)throw Error(i(318));if(t=a.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(557));t[ln]=a}else Dr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Bt(a),t=!1}else l=Af(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=l),t=!0;if(!t)return a.flags&256?(ds(a),a):(ds(a),null);if((a.flags&128)!==0)throw Error(i(558))}return Bt(a),null;case 13:if(c=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(f=Il(a),c!==null&&c.dehydrated!==null){if(t===null){if(!f)throw Error(i(318));if(f=a.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[ln]=a}else Dr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Bt(a),f=!1}else f=Af(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=f),f=!0;if(!f)return a.flags&256?(ds(a),a):(ds(a),null)}return ds(a),(a.flags&128)!==0?(a.lanes=l,a):(l=c!==null,t=t!==null&&t.memoizedState!==null,l&&(c=a.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),l!==t&&l&&(a.child.flags|=8192),fd(a,a.updateQueue),Bt(a),null);case 4:return Ue(),t===null&&Bm(a.stateNode.containerInfo),Bt(a),null;case 10:return Ha(a.type),Bt(a),null;case 19:if(ne(nn),c=a.memoizedState,c===null)return Bt(a),null;if(f=(a.flags&128)!==0,m=c.rendering,m===null)if(f)oc(c,!1);else{if(Qt!==0||t!==null&&(t.flags&128)!==0)for(t=a.child;t!==null;){if(m=ed(t),m!==null){for(a.flags|=128,oc(c,!1),t=m.updateQueue,a.updateQueue=t,fd(a,t),a.subtreeFlags=0,t=l,l=a.child;l!==null;)W0(l,t),l=l.sibling;return le(nn,nn.current&1|2),bt&&qa(a,c.treeForkCount),a.child}t=t.sibling}c.tail!==null&&xt()>bd&&(a.flags|=128,f=!0,oc(c,!1),a.lanes=4194304)}else{if(!f)if(t=ed(m),t!==null){if(a.flags|=128,f=!0,t=t.updateQueue,a.updateQueue=t,fd(a,t),oc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!bt)return Bt(a),null}else 2*xt()-c.renderingStartTime>bd&&l!==536870912&&(a.flags|=128,f=!0,oc(c,!1),a.lanes=4194304);c.isBackwards?(m.sibling=a.child,a.child=m):(t=c.last,t!==null?t.sibling=m:a.child=m,c.last=m)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=xt(),t.sibling=null,l=nn.current,le(nn,f?l&1|2:l&1),bt&&qa(a,c.treeForkCount),t):(Bt(a),null);case 22:case 23:return ds(a),zf(),c=a.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(l&536870912)!==0&&(a.flags&128)===0&&(Bt(a),a.subtreeFlags&6&&(a.flags|=8192)):Bt(a),l=a.updateQueue,l!==null&&fd(a,l.retryQueue),l=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==l&&(a.flags|=2048),t!==null&&ne(Vr),null;case 24:return l=null,t!==null&&(l=t.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Ha(un),Bt(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function cE(t,a){switch(Tf(a),a.tag){case 1:return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return Ha(un),Ue(),t=a.flags,(t&65536)!==0&&(t&128)===0?(a.flags=t&-65537|128,a):null;case 26:case 27:case 5:return J(a),null;case 31:if(a.memoizedState!==null){if(ds(a),a.alternate===null)throw Error(i(340));Dr()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 13:if(ds(a),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Dr()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return ne(nn),null;case 4:return Ue(),null;case 10:return Ha(a.type),null;case 22:case 23:return ds(a),zf(),t!==null&&ne(Vr),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 24:return Ha(un),null;case 25:return null;default:return null}}function Nb(t,a){switch(Tf(a),a.tag){case 3:Ha(un),Ue();break;case 26:case 27:case 5:J(a);break;case 4:Ue();break;case 31:a.memoizedState!==null&&ds(a);break;case 13:ds(a);break;case 19:ne(nn);break;case 10:Ha(a.type);break;case 22:case 23:ds(a),zf(),t!==null&&ne(Vr);break;case 24:Ha(un)}}function cc(t,a){try{var l=a.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var f=c.next;l=f;do{if((l.tag&t)===t){c=void 0;var m=l.create,v=l.inst;c=m(),v.destroy=c}l=l.next}while(l!==f)}}catch(E){Rt(a,a.return,E)}}function Mi(t,a,l){try{var c=a.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&t)===t){var v=c.inst,E=v.destroy;if(E!==void 0){v.destroy=void 0,f=a;var U=l,te=E;try{te()}catch(oe){Rt(f,U,oe)}}}c=c.next}while(c!==m)}}catch(oe){Rt(a,a.return,oe)}}function Eb(t){var a=t.updateQueue;if(a!==null){var l=t.stateNode;try{mx(a,l)}catch(c){Rt(t,t.return,c)}}}function Sb(t,a,l){l.props=zr(t.type,t.memoizedProps),l.state=t.memoizedState;try{l.componentWillUnmount()}catch(c){Rt(t,a,c)}}function uc(t,a){try{var l=t.ref;if(l!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof l=="function"?t.refCleanup=l(c):l.current=c}}catch(f){Rt(t,a,f)}}function ya(t,a){var l=t.ref,c=t.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(f){Rt(t,a,f)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){Rt(t,a,f)}else l.current=null}function Tb(t){var a=t.type,l=t.memoizedProps,c=t.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(f){Rt(t,t.return,f)}}function ym(t,a,l){try{var c=t.stateNode;kE(c,t.type,l,a),c[Nn]=a}catch(f){Rt(t,t.return,f)}}function jb(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&zi(t.type)||t.tag===4}function vm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||jb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&zi(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function wm(t,a,l){var c=t.tag;if(c===5||c===6)t=t.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(t,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(t),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=qs));else if(c!==4&&(c===27&&zi(t.type)&&(l=t.stateNode,a=null),t=t.child,t!==null))for(wm(t,a,l),t=t.sibling;t!==null;)wm(t,a,l),t=t.sibling}function md(t,a,l){var c=t.tag;if(c===5||c===6)t=t.stateNode,a?l.insertBefore(t,a):l.appendChild(t);else if(c!==4&&(c===27&&zi(t.type)&&(l=t.stateNode),t=t.child,t!==null))for(md(t,a,l),t=t.sibling;t!==null;)md(t,a,l),t=t.sibling}function Ab(t){var a=t.stateNode,l=t.memoizedProps;try{for(var c=t.type,f=a.attributes;f.length;)a.removeAttributeNode(f[0]);In(a,c,l),a[ln]=t,a[Nn]=l}catch(m){Rt(t,t.return,m)}}var Qa=!1,fn=!1,_m=!1,Cb=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function uE(t,a){if(t=t.containerInfo,Fm=Od,t=z0(t),pf(t)){if("selectionStart"in t)var l={start:t.selectionStart,end:t.selectionEnd};else e:{l=(l=t.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{l.nodeType,m.nodeType}catch{l=null;break e}var v=0,E=-1,U=-1,te=0,oe=0,pe=t,se=null;t:for(;;){for(var ie;pe!==l||f!==0&&pe.nodeType!==3||(E=v+f),pe!==m||c!==0&&pe.nodeType!==3||(U=v+c),pe.nodeType===3&&(v+=pe.nodeValue.length),(ie=pe.firstChild)!==null;)se=pe,pe=ie;for(;;){if(pe===t)break t;if(se===l&&++te===f&&(E=v),se===m&&++oe===c&&(U=v),(ie=pe.nextSibling)!==null)break;pe=se,se=pe.parentNode}pe=ie}l=E===-1||U===-1?null:{start:E,end:U}}else l=null}l=l||{start:0,end:0}}else l=null;for(Hm={focusedElem:t,selectionRange:l},Od=!1,Sn=a;Sn!==null;)if(a=Sn,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,Sn=t;else for(;Sn!==null;){switch(a=Sn,m=a.alternate,t=a.flags,a.tag){case 0:if((t&4)!==0&&(t=a.updateQueue,t=t!==null?t.events:null,t!==null))for(l=0;l<t.length;l++)f=t[l],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&m!==null){t=void 0,l=a,f=m.memoizedProps,m=m.memoizedState,c=l.stateNode;try{var De=zr(l.type,f);t=c.getSnapshotBeforeUpdate(De,m),c.__reactInternalSnapshotBeforeUpdate=t}catch($e){Rt(l,l.return,$e)}}break;case 3:if((t&1024)!==0){if(t=a.stateNode.containerInfo,l=t.nodeType,l===9)Ym(t);else if(l===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Ym(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(i(163))}if(t=a.sibling,t!==null){t.return=a.return,Sn=t;break}Sn=a.return}}function Rb(t,a,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:Xa(t,l),c&4&&cc(5,l);break;case 1:if(Xa(t,l),c&4)if(t=l.stateNode,a===null)try{t.componentDidMount()}catch(v){Rt(l,l.return,v)}else{var f=zr(l.type,a.memoizedProps);a=a.memoizedState;try{t.componentDidUpdate(f,a,t.__reactInternalSnapshotBeforeUpdate)}catch(v){Rt(l,l.return,v)}}c&64&&Eb(l),c&512&&uc(l,l.return);break;case 3:if(Xa(t,l),c&64&&(t=l.updateQueue,t!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{mx(t,a)}catch(v){Rt(l,l.return,v)}}break;case 27:a===null&&c&4&&Ab(l);case 26:case 5:Xa(t,l),a===null&&c&4&&Tb(l),c&512&&uc(l,l.return);break;case 12:Xa(t,l);break;case 31:Xa(t,l),c&4&&Db(t,l);break;case 13:Xa(t,l),c&4&&Mb(t,l),c&64&&(t=l.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(l=yE.bind(null,l),UE(t,l))));break;case 22:if(c=l.memoizedState!==null||Qa,!c){a=a!==null&&a.memoizedState!==null||fn,f=Qa;var m=fn;Qa=c,(fn=a)&&!m?Ja(t,l,(l.subtreeFlags&8772)!==0):Xa(t,l),Qa=f,fn=m}break;case 30:break;default:Xa(t,l)}}function kb(t){var a=t.alternate;a!==null&&(t.alternate=null,kb(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&pl(a)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var qt=null,Wn=!1;function Wa(t,a,l){for(l=l.child;l!==null;)Ib(t,a,l),l=l.sibling}function Ib(t,a,l){if(G&&typeof G.onCommitFiberUnmount=="function")try{G.onCommitFiberUnmount(R,l)}catch{}switch(l.tag){case 26:fn||ya(l,a),Wa(t,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:fn||ya(l,a);var c=qt,f=Wn;zi(l.type)&&(qt=l.stateNode,Wn=!1),Wa(t,a,l),yc(l.stateNode),qt=c,Wn=f;break;case 5:fn||ya(l,a);case 6:if(c=qt,f=Wn,qt=null,Wa(t,a,l),qt=c,Wn=f,qt!==null)if(Wn)try{(qt.nodeType===9?qt.body:qt.nodeName==="HTML"?qt.ownerDocument.body:qt).removeChild(l.stateNode)}catch(m){Rt(l,a,m)}else try{qt.removeChild(l.stateNode)}catch(m){Rt(l,a,m)}break;case 18:qt!==null&&(Wn?(t=qt,Ey(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,l.stateNode),Zl(t)):Ey(qt,l.stateNode));break;case 4:c=qt,f=Wn,qt=l.stateNode.containerInfo,Wn=!0,Wa(t,a,l),qt=c,Wn=f;break;case 0:case 11:case 14:case 15:Mi(2,l,a),fn||Mi(4,l,a),Wa(t,a,l);break;case 1:fn||(ya(l,a),c=l.stateNode,typeof c.componentWillUnmount=="function"&&Sb(l,a,c)),Wa(t,a,l);break;case 21:Wa(t,a,l);break;case 22:fn=(c=fn)||l.memoizedState!==null,Wa(t,a,l),fn=c;break;default:Wa(t,a,l)}}function Db(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Zl(t)}catch(l){Rt(a,a.return,l)}}}function Mb(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Zl(t)}catch(l){Rt(a,a.return,l)}}function dE(t){switch(t.tag){case 31:case 13:case 19:var a=t.stateNode;return a===null&&(a=t.stateNode=new Cb),a;case 22:return t=t.stateNode,a=t._retryCache,a===null&&(a=t._retryCache=new Cb),a;default:throw Error(i(435,t.tag))}}function pd(t,a){var l=dE(t);a.forEach(function(c){if(!l.has(c)){l.add(c);var f=vE.bind(null,t,c);c.then(f,f)}})}function Xn(t,a){var l=a.deletions;if(l!==null)for(var c=0;c<l.length;c++){var f=l[c],m=t,v=a,E=v;e:for(;E!==null;){switch(E.tag){case 27:if(zi(E.type)){qt=E.stateNode,Wn=!1;break e}break;case 5:qt=E.stateNode,Wn=!1;break e;case 3:case 4:qt=E.stateNode.containerInfo,Wn=!0;break e}E=E.return}if(qt===null)throw Error(i(160));Ib(m,v,f),qt=null,Wn=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Ob(a,t),a=a.sibling}var Ks=null;function Ob(t,a){var l=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Xn(a,t),Jn(t),c&4&&(Mi(3,t,t.return),cc(3,t),Mi(5,t,t.return));break;case 1:Xn(a,t),Jn(t),c&512&&(fn||l===null||ya(l,l.return)),c&64&&Qa&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(l=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var f=Ks;if(Xn(a,t),Jn(t),c&512&&(fn||l===null||ya(l,l.return)),c&4){var m=l!==null?l.memoizedState:null;if(c=t.memoizedState,l===null)if(c===null)if(t.stateNode===null){e:{c=t.type,l=t.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[ia]||m[ln]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),In(m,c,l),m[ln]=t,on(m),c=m;break e;case"link":var v=Oy("link","href",f).get(c+(l.href||""));if(v){for(var E=0;E<v.length;E++)if(m=v[E],m.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&m.getAttribute("rel")===(l.rel==null?null:l.rel)&&m.getAttribute("title")===(l.title==null?null:l.title)&&m.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){v.splice(E,1);break t}}m=f.createElement(c),In(m,c,l),f.head.appendChild(m);break;case"meta":if(v=Oy("meta","content",f).get(c+(l.content||""))){for(E=0;E<v.length;E++)if(m=v[E],m.getAttribute("content")===(l.content==null?null:""+l.content)&&m.getAttribute("name")===(l.name==null?null:l.name)&&m.getAttribute("property")===(l.property==null?null:l.property)&&m.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&m.getAttribute("charset")===(l.charSet==null?null:l.charSet)){v.splice(E,1);break t}}m=f.createElement(c),In(m,c,l),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[ln]=t,on(m),c=m}t.stateNode=c}else Vy(f,t.type,t.stateNode);else t.stateNode=My(f,c,t.memoizedProps);else m!==c?(m===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):m.count--,c===null?Vy(f,t.type,t.stateNode):My(f,c,t.memoizedProps)):c===null&&t.stateNode!==null&&ym(t,t.memoizedProps,l.memoizedProps)}break;case 27:Xn(a,t),Jn(t),c&512&&(fn||l===null||ya(l,l.return)),l!==null&&c&4&&ym(t,t.memoizedProps,l.memoizedProps);break;case 5:if(Xn(a,t),Jn(t),c&512&&(fn||l===null||ya(l,l.return)),t.flags&32){f=t.stateNode;try{Qn(f,"")}catch(De){Rt(t,t.return,De)}}c&4&&t.stateNode!=null&&(f=t.memoizedProps,ym(t,f,l!==null?l.memoizedProps:f)),c&1024&&(_m=!0);break;case 6:if(Xn(a,t),Jn(t),c&4){if(t.stateNode===null)throw Error(i(162));c=t.memoizedProps,l=t.stateNode;try{l.nodeValue=c}catch(De){Rt(t,t.return,De)}}break;case 3:if(kd=null,f=Ks,Ks=Cd(a.containerInfo),Xn(a,t),Ks=f,Jn(t),c&4&&l!==null&&l.memoizedState.isDehydrated)try{Zl(a.containerInfo)}catch(De){Rt(t,t.return,De)}_m&&(_m=!1,Vb(t));break;case 4:c=Ks,Ks=Cd(t.stateNode.containerInfo),Xn(a,t),Jn(t),Ks=c;break;case 12:Xn(a,t),Jn(t);break;case 31:Xn(a,t),Jn(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,pd(t,c)));break;case 13:Xn(a,t),Jn(t),t.child.flags&8192&&t.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(xd=xt()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,pd(t,c)));break;case 22:f=t.memoizedState!==null;var U=l!==null&&l.memoizedState!==null,te=Qa,oe=fn;if(Qa=te||f,fn=oe||U,Xn(a,t),fn=oe,Qa=te,Jn(t),c&8192)e:for(a=t.stateNode,a._visibility=f?a._visibility&-2:a._visibility|1,f&&(l===null||U||Qa||fn||qr(t)),l=null,a=t;;){if(a.tag===5||a.tag===26){if(l===null){U=l=a;try{if(m=U.stateNode,f)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{E=U.stateNode;var pe=U.memoizedProps.style,se=pe!=null&&pe.hasOwnProperty("display")?pe.display:null;E.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(De){Rt(U,U.return,De)}}}else if(a.tag===6){if(l===null){U=a;try{U.stateNode.nodeValue=f?"":U.memoizedProps}catch(De){Rt(U,U.return,De)}}}else if(a.tag===18){if(l===null){U=a;try{var ie=U.stateNode;f?Sy(ie,!0):Sy(U.stateNode,!1)}catch(De){Rt(U,U.return,De)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;a.sibling===null;){if(a.return===null||a.return===t)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=t.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,pd(t,l))));break;case 19:Xn(a,t),Jn(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,pd(t,c)));break;case 30:break;case 21:break;default:Xn(a,t),Jn(t)}}function Jn(t){var a=t.flags;if(a&2){try{for(var l,c=t.return;c!==null;){if(jb(c)){l=c;break}c=c.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var f=l.stateNode,m=vm(t);md(t,m,f);break;case 5:var v=l.stateNode;l.flags&32&&(Qn(v,""),l.flags&=-33);var E=vm(t);md(t,E,v);break;case 3:case 4:var U=l.stateNode.containerInfo,te=vm(t);wm(t,te,U);break;default:throw Error(i(161))}}catch(oe){Rt(t,t.return,oe)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function Vb(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var a=t;Vb(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),t=t.sibling}}function Xa(t,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Rb(t,a.alternate,a),a=a.sibling}function qr(t){for(t=t.child;t!==null;){var a=t;switch(a.tag){case 0:case 11:case 14:case 15:Mi(4,a,a.return),qr(a);break;case 1:ya(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&Sb(a,a.return,l),qr(a);break;case 27:yc(a.stateNode);case 26:case 5:ya(a,a.return),qr(a);break;case 22:a.memoizedState===null&&qr(a);break;case 30:qr(a);break;default:qr(a)}t=t.sibling}}function Ja(t,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,f=t,m=a,v=m.flags;switch(m.tag){case 0:case 11:case 15:Ja(f,m,l),cc(4,m);break;case 1:if(Ja(f,m,l),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(te){Rt(c,c.return,te)}if(c=m,f=c.updateQueue,f!==null){var E=c.stateNode;try{var U=f.shared.hiddenCallbacks;if(U!==null)for(f.shared.hiddenCallbacks=null,f=0;f<U.length;f++)fx(U[f],E)}catch(te){Rt(c,c.return,te)}}l&&v&64&&Eb(m),uc(m,m.return);break;case 27:Ab(m);case 26:case 5:Ja(f,m,l),l&&c===null&&v&4&&Tb(m),uc(m,m.return);break;case 12:Ja(f,m,l);break;case 31:Ja(f,m,l),l&&v&4&&Db(f,m);break;case 13:Ja(f,m,l),l&&v&4&&Mb(f,m);break;case 22:m.memoizedState===null&&Ja(f,m,l),uc(m,m.return);break;case 30:break;default:Ja(f,m,l)}a=a.sibling}}function Nm(t,a){var l=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),t=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(t=a.memoizedState.cachePool.pool),t!==l&&(t!=null&&t.refCount++,l!=null&&Wo(l))}function Em(t,a){t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&Wo(t))}function Qs(t,a,l,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Pb(t,a,l,c),a=a.sibling}function Pb(t,a,l,c){var f=a.flags;switch(a.tag){case 0:case 11:case 15:Qs(t,a,l,c),f&2048&&cc(9,a);break;case 1:Qs(t,a,l,c);break;case 3:Qs(t,a,l,c),f&2048&&(t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&Wo(t)));break;case 12:if(f&2048){Qs(t,a,l,c),t=a.stateNode;try{var m=a.memoizedProps,v=m.id,E=m.onPostCommit;typeof E=="function"&&E(v,a.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(U){Rt(a,a.return,U)}}else Qs(t,a,l,c);break;case 31:Qs(t,a,l,c);break;case 13:Qs(t,a,l,c);break;case 23:break;case 22:m=a.stateNode,v=a.alternate,a.memoizedState!==null?m._visibility&2?Qs(t,a,l,c):dc(t,a):m._visibility&2?Qs(t,a,l,c):(m._visibility|=2,ql(t,a,l,c,(a.subtreeFlags&10256)!==0||!1)),f&2048&&Nm(v,a);break;case 24:Qs(t,a,l,c),f&2048&&Em(a.alternate,a);break;default:Qs(t,a,l,c)}}function ql(t,a,l,c,f){for(f=f&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var m=t,v=a,E=l,U=c,te=v.flags;switch(v.tag){case 0:case 11:case 15:ql(m,v,E,U,f),cc(8,v);break;case 23:break;case 22:var oe=v.stateNode;v.memoizedState!==null?oe._visibility&2?ql(m,v,E,U,f):dc(m,v):(oe._visibility|=2,ql(m,v,E,U,f)),f&&te&2048&&Nm(v.alternate,v);break;case 24:ql(m,v,E,U,f),f&&te&2048&&Em(v.alternate,v);break;default:ql(m,v,E,U,f)}a=a.sibling}}function dc(t,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=t,c=a,f=c.flags;switch(c.tag){case 22:dc(l,c),f&2048&&Nm(c.alternate,c);break;case 24:dc(l,c),f&2048&&Em(c.alternate,c);break;default:dc(l,c)}a=a.sibling}}var hc=8192;function Fl(t,a,l){if(t.subtreeFlags&hc)for(t=t.child;t!==null;)Lb(t,a,l),t=t.sibling}function Lb(t,a,l){switch(t.tag){case 26:Fl(t,a,l),t.flags&hc&&t.memoizedState!==null&&XE(l,Ks,t.memoizedState,t.memoizedProps);break;case 5:Fl(t,a,l);break;case 3:case 4:var c=Ks;Ks=Cd(t.stateNode.containerInfo),Fl(t,a,l),Ks=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=hc,hc=16777216,Fl(t,a,l),hc=c):Fl(t,a,l));break;default:Fl(t,a,l)}}function Ub(t){var a=t.alternate;if(a!==null&&(t=a.child,t!==null)){a.child=null;do a=t.sibling,t.sibling=null,t=a;while(t!==null)}}function fc(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];Sn=c,zb(c,t)}Ub(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Bb(t),t=t.sibling}function Bb(t){switch(t.tag){case 0:case 11:case 15:fc(t),t.flags&2048&&Mi(9,t,t.return);break;case 3:fc(t);break;case 12:fc(t);break;case 22:var a=t.stateNode;t.memoizedState!==null&&a._visibility&2&&(t.return===null||t.return.tag!==13)?(a._visibility&=-3,gd(t)):fc(t);break;default:fc(t)}}function gd(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];Sn=c,zb(c,t)}Ub(t)}for(t=t.child;t!==null;){switch(a=t,a.tag){case 0:case 11:case 15:Mi(8,a,a.return),gd(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,gd(a));break;default:gd(a)}t=t.sibling}}function zb(t,a){for(;Sn!==null;){var l=Sn;switch(l.tag){case 0:case 11:case 15:Mi(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Wo(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,Sn=c;else e:for(l=t;Sn!==null;){c=Sn;var f=c.sibling,m=c.return;if(kb(c),c===l){Sn=null;break e}if(f!==null){f.return=m,Sn=f;break e}Sn=m}}}var hE={getCacheForType:function(t){var a=Rn(un),l=a.data.get(t);return l===void 0&&(l=t(),a.data.set(t,l)),l},cacheSignal:function(){return Rn(un).controller.signal}},fE=typeof WeakMap=="function"?WeakMap:Map,St=0,Ot=null,ct=null,dt=0,Ct=0,hs=null,Oi=!1,Hl=!1,Sm=!1,Za=0,Qt=0,Vi=0,Fr=0,Tm=0,fs=0,$l=0,mc=null,Zn=null,jm=!1,xd=0,qb=0,bd=1/0,yd=null,Pi=null,yn=0,Li=null,Gl=null,ei=0,Am=0,Cm=null,Fb=null,pc=0,Rm=null;function ms(){return(St&2)!==0&&dt!==0?dt&-dt:I.T!==null?Vm():vu()}function Hb(){if(fs===0)if((dt&536870912)===0||bt){var t=rt;rt<<=1,(rt&3932160)===0&&(rt=262144),fs=t}else fs=536870912;return t=us.current,t!==null&&(t.flags|=32),fs}function es(t,a,l){(t===Ot&&(Ct===2||Ct===9)||t.cancelPendingCommit!==null)&&(Yl(t,0),Ui(t,dt,fs,!1)),_n(t,l),((St&2)===0||t!==Ot)&&(t===Ot&&((St&2)===0&&(Fr|=l),Qt===4&&Ui(t,dt,fs,!1)),va(t))}function $b(t,a,l){if((St&6)!==0)throw Error(i(327));var c=!l&&(a&127)===0&&(a&t.expiredLanes)===0||Fn(t,a),f=c?gE(t,a):Im(t,a,!0),m=c;do{if(f===0){Hl&&!c&&Ui(t,a,0,!1);break}else{if(l=t.current.alternate,m&&!mE(l)){f=Im(t,a,!1),m=!1;continue}if(f===2){if(m=a,t.errorRecoveryDisabledLanes&m)var v=0;else v=t.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){a=v;e:{var E=t;f=mc;var U=E.current.memoizedState.isDehydrated;if(U&&(Yl(E,v).flags|=256),v=Im(E,v,!1),v!==2){if(Sm&&!U){E.errorRecoveryDisabledLanes|=m,Fr|=m,f=4;break e}m=Zn,Zn=f,m!==null&&(Zn===null?Zn=m:Zn.push.apply(Zn,m))}f=v}if(m=!1,f!==2)continue}}if(f===1){Yl(t,0),Ui(t,a,0,!0);break}e:{switch(c=t,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Ui(c,a,fs,!Oi);break e;case 2:Zn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(f=xd+300-xt(),10<f)){if(Ui(c,a,fs,!Oi),Gt(c,0,!0)!==0)break e;ei=a,c.timeoutHandle=_y(Gb.bind(null,c,l,Zn,yd,jm,a,fs,Fr,$l,Oi,m,"Throttled",-0,0),f);break e}Gb(c,l,Zn,yd,jm,a,fs,Fr,$l,Oi,m,null,-0,0)}}break}while(!0);va(t)}function Gb(t,a,l,c,f,m,v,E,U,te,oe,pe,se,ie){if(t.timeoutHandle=-1,pe=a.subtreeFlags,pe&8192||(pe&16785408)===16785408){pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:qs},Lb(a,m,pe);var De=(m&62914560)===m?xd-xt():(m&4194048)===m?qb-xt():0;if(De=JE(pe,De),De!==null){ei=m,t.cancelPendingCommit=De(ey.bind(null,t,a,m,l,c,f,v,E,U,oe,pe,null,se,ie)),Ui(t,m,v,!te);return}}ey(t,a,m,l,c,f,v,E,U)}function mE(t){for(var a=t;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var f=l[c],m=f.getSnapshot;f=f.value;try{if(!os(m(),f))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ui(t,a,l,c){a&=~Tm,a&=~Fr,t.suspendedLanes|=a,t.pingedLanes&=~a,c&&(t.warmLanes|=a),c=t.expirationTimes;for(var f=a;0<f;){var m=31-ce(f),v=1<<m;c[m]=-1,f&=~v}l!==0&&Us(t,l,a)}function vd(){return(St&6)===0?(gc(0),!1):!0}function km(){if(ct!==null){if(Ct===0)var t=ct.return;else t=ct,Fa=Mr=null,Yf(t),Pl=null,Jo=0,t=ct;for(;t!==null;)Nb(t.alternate,t),t=t.return;ct=null}}function Yl(t,a){var l=t.timeoutHandle;l!==-1&&(t.timeoutHandle=-1,ME(l)),l=t.cancelPendingCommit,l!==null&&(t.cancelPendingCommit=null,l()),ei=0,km(),Ot=t,ct=l=za(t.current,null),dt=a,Ct=0,hs=null,Oi=!1,Hl=Fn(t,a),Sm=!1,$l=fs=Tm=Fr=Vi=Qt=0,Zn=mc=null,jm=!1,(a&8)!==0&&(a|=a&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=a;0<c;){var f=31-ce(c),m=1<<f;a|=t[f],c&=~m}return Za=a,zu(),l}function Yb(t,a){nt=null,I.H=rc,a===Vl||a===Qu?(a=cx(),Ct=3):a===Of?(a=cx(),Ct=4):Ct=a===cm?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,hs=a,ct===null&&(Qt=1,cd(t,As(a,t.current)))}function Kb(){var t=us.current;return t===null?!0:(dt&4194048)===dt?Is===null:(dt&62914560)===dt||(dt&536870912)!==0?t===Is:!1}function Qb(){var t=I.H;return I.H=rc,t===null?rc:t}function Wb(){var t=I.A;return I.A=hE,t}function wd(){Qt=4,Oi||(dt&4194048)!==dt&&us.current!==null||(Hl=!0),(Vi&134217727)===0&&(Fr&134217727)===0||Ot===null||Ui(Ot,dt,fs,!1)}function Im(t,a,l){var c=St;St|=2;var f=Qb(),m=Wb();(Ot!==t||dt!==a)&&(yd=null,Yl(t,a)),a=!1;var v=Qt;e:do try{if(Ct!==0&&ct!==null){var E=ct,U=hs;switch(Ct){case 8:km(),v=6;break e;case 3:case 2:case 9:case 6:us.current===null&&(a=!0);var te=Ct;if(Ct=0,hs=null,Kl(t,E,U,te),l&&Hl){v=0;break e}break;default:te=Ct,Ct=0,hs=null,Kl(t,E,U,te)}}pE(),v=Qt;break}catch(oe){Yb(t,oe)}while(!0);return a&&t.shellSuspendCounter++,Fa=Mr=null,St=c,I.H=f,I.A=m,ct===null&&(Ot=null,dt=0,zu()),v}function pE(){for(;ct!==null;)Xb(ct)}function gE(t,a){var l=St;St|=2;var c=Qb(),f=Wb();Ot!==t||dt!==a?(yd=null,bd=xt()+500,Yl(t,a)):Hl=Fn(t,a);e:do try{if(Ct!==0&&ct!==null){a=ct;var m=hs;t:switch(Ct){case 1:Ct=0,hs=null,Kl(t,a,m,1);break;case 2:case 9:if(lx(m)){Ct=0,hs=null,Jb(a);break}a=function(){Ct!==2&&Ct!==9||Ot!==t||(Ct=7),va(t)},m.then(a,a);break e;case 3:Ct=7;break e;case 4:Ct=5;break e;case 7:lx(m)?(Ct=0,hs=null,Jb(a)):(Ct=0,hs=null,Kl(t,a,m,7));break;case 5:var v=null;switch(ct.tag){case 26:v=ct.memoizedState;case 5:case 27:var E=ct;if(v?Py(v):E.stateNode.complete){Ct=0,hs=null;var U=E.sibling;if(U!==null)ct=U;else{var te=E.return;te!==null?(ct=te,_d(te)):ct=null}break t}}Ct=0,hs=null,Kl(t,a,m,5);break;case 6:Ct=0,hs=null,Kl(t,a,m,6);break;case 8:km(),Qt=6;break e;default:throw Error(i(462))}}xE();break}catch(oe){Yb(t,oe)}while(!0);return Fa=Mr=null,I.H=c,I.A=f,St=l,ct!==null?0:(Ot=null,dt=0,zu(),Qt)}function xE(){for(;ct!==null&&!it();)Xb(ct)}function Xb(t){var a=wb(t.alternate,t,Za);t.memoizedProps=t.pendingProps,a===null?_d(t):ct=a}function Jb(t){var a=t,l=a.alternate;switch(a.tag){case 15:case 0:a=pb(l,a,a.pendingProps,a.type,void 0,dt);break;case 11:a=pb(l,a,a.pendingProps,a.type.render,a.ref,dt);break;case 5:Yf(a);default:Nb(l,a),a=ct=W0(a,Za),a=wb(l,a,Za)}t.memoizedProps=t.pendingProps,a===null?_d(t):ct=a}function Kl(t,a,l,c){Fa=Mr=null,Yf(a),Pl=null,Jo=0;var f=a.return;try{if(iE(t,f,a,l,dt)){Qt=1,cd(t,As(l,t.current)),ct=null;return}}catch(m){if(f!==null)throw ct=f,m;Qt=1,cd(t,As(l,t.current)),ct=null;return}a.flags&32768?(bt||c===1?t=!0:Hl||(dt&536870912)!==0?t=!1:(Oi=t=!0,(c===2||c===9||c===3||c===6)&&(c=us.current,c!==null&&c.tag===13&&(c.flags|=16384))),Zb(a,t)):_d(a)}function _d(t){var a=t;do{if((a.flags&32768)!==0){Zb(a,Oi);return}t=a.return;var l=oE(a.alternate,a,Za);if(l!==null){ct=l;return}if(a=a.sibling,a!==null){ct=a;return}ct=a=t}while(a!==null);Qt===0&&(Qt=5)}function Zb(t,a){do{var l=cE(t.alternate,t);if(l!==null){l.flags&=32767,ct=l;return}if(l=t.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(t=t.sibling,t!==null)){ct=t;return}ct=t=l}while(t!==null);Qt=6,ct=null}function ey(t,a,l,c,f,m,v,E,U){t.cancelPendingCommit=null;do Nd();while(yn!==0);if((St&6)!==0)throw Error(i(327));if(a!==null){if(a===t.current)throw Error(i(177));if(m=a.lanes|a.childLanes,m|=vf,sa(t,l,m,v,E,U),t===Ot&&(ct=Ot=null,dt=0),Gl=a,Li=t,ei=l,Am=m,Cm=f,Fb=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,wE(_s,function(){return iy(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=I.T,I.T=null,f=K.p,K.p=2,v=St,St|=4;try{uE(t,a,l)}finally{St=v,K.p=f,I.T=c}}yn=1,ty(),ny(),sy()}}function ty(){if(yn===1){yn=0;var t=Li,a=Gl,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=I.T,I.T=null;var c=K.p;K.p=2;var f=St;St|=4;try{Ob(a,t);var m=Hm,v=z0(t.containerInfo),E=m.focusedElem,U=m.selectionRange;if(v!==E&&E&&E.ownerDocument&&B0(E.ownerDocument.documentElement,E)){if(U!==null&&pf(E)){var te=U.start,oe=U.end;if(oe===void 0&&(oe=te),"selectionStart"in E)E.selectionStart=te,E.selectionEnd=Math.min(oe,E.value.length);else{var pe=E.ownerDocument||document,se=pe&&pe.defaultView||window;if(se.getSelection){var ie=se.getSelection(),De=E.textContent.length,$e=Math.min(U.start,De),Mt=U.end===void 0?$e:Math.min(U.end,De);!ie.extend&&$e>Mt&&(v=Mt,Mt=$e,$e=v);var Q=U0(E,$e),$=U0(E,Mt);if(Q&&$&&(ie.rangeCount!==1||ie.anchorNode!==Q.node||ie.anchorOffset!==Q.offset||ie.focusNode!==$.node||ie.focusOffset!==$.offset)){var ee=pe.createRange();ee.setStart(Q.node,Q.offset),ie.removeAllRanges(),$e>Mt?(ie.addRange(ee),ie.extend($.node,$.offset)):(ee.setEnd($.node,$.offset),ie.addRange(ee))}}}}for(pe=[],ie=E;ie=ie.parentNode;)ie.nodeType===1&&pe.push({element:ie,left:ie.scrollLeft,top:ie.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<pe.length;E++){var he=pe[E];he.element.scrollLeft=he.left,he.element.scrollTop=he.top}}Od=!!Fm,Hm=Fm=null}finally{St=f,K.p=c,I.T=l}}t.current=a,yn=2}}function ny(){if(yn===2){yn=0;var t=Li,a=Gl,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=I.T,I.T=null;var c=K.p;K.p=2;var f=St;St|=4;try{Rb(t,a.alternate,a)}finally{St=f,K.p=c,I.T=l}}yn=3}}function sy(){if(yn===4||yn===3){yn=0,Lt();var t=Li,a=Gl,l=ei,c=Fb;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?yn=5:(yn=0,Gl=Li=null,ay(t,t.pendingLanes));var f=t.pendingLanes;if(f===0&&(Pi=null),Pa(l),a=a.stateNode,G&&typeof G.onCommitFiberRoot=="function")try{G.onCommitFiberRoot(R,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=I.T,f=K.p,K.p=2,I.T=null;try{for(var m=t.onRecoverableError,v=0;v<c.length;v++){var E=c[v];m(E.value,{componentStack:E.stack})}}finally{I.T=a,K.p=f}}(ei&3)!==0&&Nd(),va(t),f=t.pendingLanes,(l&261930)!==0&&(f&42)!==0?t===Rm?pc++:(pc=0,Rm=t):pc=0,gc(0)}}function ay(t,a){(t.pooledCacheLanes&=a)===0&&(a=t.pooledCache,a!=null&&(t.pooledCache=null,Wo(a)))}function Nd(){return ty(),ny(),sy(),iy()}function iy(){if(yn!==5)return!1;var t=Li,a=Am;Am=0;var l=Pa(ei),c=I.T,f=K.p;try{K.p=32>l?32:l,I.T=null,l=Cm,Cm=null;var m=Li,v=ei;if(yn=0,Gl=Li=null,ei=0,(St&6)!==0)throw Error(i(331));var E=St;if(St|=4,Bb(m.current),Pb(m,m.current,v,l),St=E,gc(0,!1),G&&typeof G.onPostCommitFiberRoot=="function")try{G.onPostCommitFiberRoot(R,m)}catch{}return!0}finally{K.p=f,I.T=c,ay(t,a)}}function ry(t,a,l){a=As(l,a),a=om(t.stateNode,a,2),t=ki(t,a,2),t!==null&&(_n(t,2),va(t))}function Rt(t,a,l){if(t.tag===3)ry(t,t,l);else for(;a!==null;){if(a.tag===3){ry(a,t,l);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Pi===null||!Pi.has(c))){t=As(l,t),l=lb(2),c=ki(a,l,2),c!==null&&(ob(l,c,a,t),_n(c,2),va(c));break}}a=a.return}}function Dm(t,a,l){var c=t.pingCache;if(c===null){c=t.pingCache=new fE;var f=new Set;c.set(a,f)}else f=c.get(a),f===void 0&&(f=new Set,c.set(a,f));f.has(l)||(Sm=!0,f.add(l),t=bE.bind(null,t,a,l),a.then(t,t))}function bE(t,a,l){var c=t.pingCache;c!==null&&c.delete(a),t.pingedLanes|=t.suspendedLanes&l,t.warmLanes&=~l,Ot===t&&(dt&l)===l&&(Qt===4||Qt===3&&(dt&62914560)===dt&&300>xt()-xd?(St&2)===0&&Yl(t,0):Tm|=l,$l===dt&&($l=0)),va(t)}function ly(t,a){a===0&&(a=wn()),t=kr(t,a),t!==null&&(_n(t,a),va(t))}function yE(t){var a=t.memoizedState,l=0;a!==null&&(l=a.retryLane),ly(t,l)}function vE(t,a){var l=0;switch(t.tag){case 31:case 13:var c=t.stateNode,f=t.memoizedState;f!==null&&(l=f.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),ly(t,l)}function wE(t,a){return je(t,a)}var Ed=null,Ql=null,Mm=!1,Sd=!1,Om=!1,Bi=0;function va(t){t!==Ql&&t.next===null&&(Ql===null?Ed=Ql=t:Ql=Ql.next=t),Sd=!0,Mm||(Mm=!0,NE())}function gc(t,a){if(!Om&&Sd){Om=!0;do for(var l=!1,c=Ed;c!==null;){if(t!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var v=c.suspendedLanes,E=c.pingedLanes;m=(1<<31-ce(42|t)+1)-1,m&=f&~(v&~E),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(l=!0,dy(c,m))}else m=dt,m=Gt(c,c===Ot?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Fn(c,m)||(l=!0,dy(c,m));c=c.next}while(l);Om=!1}}function _E(){oy()}function oy(){Sd=Mm=!1;var t=0;Bi!==0&&DE()&&(t=Bi);for(var a=xt(),l=null,c=Ed;c!==null;){var f=c.next,m=cy(c,a);m===0?(c.next=null,l===null?Ed=f:l.next=f,f===null&&(Ql=l)):(l=c,(t!==0||(m&3)!==0)&&(Sd=!0)),c=f}yn!==0&&yn!==5||gc(t),Bi!==0&&(Bi=0)}function cy(t,a){for(var l=t.suspendedLanes,c=t.pingedLanes,f=t.expirationTimes,m=t.pendingLanes&-62914561;0<m;){var v=31-ce(m),E=1<<v,U=f[v];U===-1?((E&l)===0||(E&c)!==0)&&(f[v]=na(E,a)):U<=a&&(t.expiredLanes|=E),m&=~E}if(a=Ot,l=dt,l=Gt(t,t===a?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,l===0||t===a&&(Ct===2||Ct===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&Be(c),t.callbackNode=null,t.callbackPriority=0;if((l&3)===0||Fn(t,l)){if(a=l&-l,a===t.callbackPriority)return a;switch(c!==null&&Be(c),Pa(l)){case 2:case 8:l=wt;break;case 32:l=_s;break;case 268435456:l=Vn;break;default:l=_s}return c=uy.bind(null,t),l=je(l,c),t.callbackPriority=a,t.callbackNode=l,a}return c!==null&&c!==null&&Be(c),t.callbackPriority=2,t.callbackNode=null,2}function uy(t,a){if(yn!==0&&yn!==5)return t.callbackNode=null,t.callbackPriority=0,null;var l=t.callbackNode;if(Nd()&&t.callbackNode!==l)return null;var c=dt;return c=Gt(t,t===Ot?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:($b(t,c,a),cy(t,xt()),t.callbackNode!=null&&t.callbackNode===l?uy.bind(null,t):null)}function dy(t,a){if(Nd())return null;$b(t,a,!0)}function NE(){OE(function(){(St&6)!==0?je(rn,_E):oy()})}function Vm(){if(Bi===0){var t=Ml;t===0&&(t=Re,Re<<=1,(Re&261888)===0&&(Re=256)),Bi=t}return Bi}function hy(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:yl(""+t)}function fy(t,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,t.id&&l.setAttribute("form",t.id),a.parentNode.insertBefore(l,a),t=new FormData(t),l.parentNode.removeChild(l),t}function EE(t,a,l,c,f){if(a==="submit"&&l&&l.stateNode===f){var m=hy((f[Nn]||null).action),v=c.submitter;v&&(a=(a=v[Nn]||null)?hy(a.formAction):v.getAttribute("formAction"),a!==null&&(m=a,v=null));var E=new fa("action","action",null,c,f);t.push({event:E,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Bi!==0){var U=v?fy(f,v):new FormData(f);nm(l,{pending:!0,data:U,method:f.method,action:m},null,U)}}else typeof m=="function"&&(E.preventDefault(),U=v?fy(f,v):new FormData(f),nm(l,{pending:!0,data:U,method:f.method,action:m},m,U))},currentTarget:f}]})}}for(var Pm=0;Pm<yf.length;Pm++){var Lm=yf[Pm],SE=Lm.toLowerCase(),TE=Lm[0].toUpperCase()+Lm.slice(1);Ys(SE,"on"+TE)}Ys(H0,"onAnimationEnd"),Ys($0,"onAnimationIteration"),Ys(G0,"onAnimationStart"),Ys("dblclick","onDoubleClick"),Ys("focusin","onFocus"),Ys("focusout","onBlur"),Ys(q2,"onTransitionRun"),Ys(F2,"onTransitionStart"),Ys(H2,"onTransitionCancel"),Ys(Y0,"onTransitionEnd"),ca("onMouseEnter",["mouseout","mouseover"]),ca("onMouseLeave",["mouseout","mouseover"]),ca("onPointerEnter",["pointerout","pointerover"]),ca("onPointerLeave",["pointerout","pointerover"]),oa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),oa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),oa("onBeforeInput",["compositionend","keypress","textInput","paste"]),oa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),oa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),oa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xc));function my(t,a){a=(a&4)!==0;for(var l=0;l<t.length;l++){var c=t[l],f=c.event;c=c.listeners;e:{var m=void 0;if(a)for(var v=c.length-1;0<=v;v--){var E=c[v],U=E.instance,te=E.currentTarget;if(E=E.listener,U!==m&&f.isPropagationStopped())break e;m=E,f.currentTarget=te;try{m(f)}catch(oe){Bu(oe)}f.currentTarget=null,m=U}else for(v=0;v<c.length;v++){if(E=c[v],U=E.instance,te=E.currentTarget,E=E.listener,U!==m&&f.isPropagationStopped())break e;m=E,f.currentTarget=te;try{m(f)}catch(oe){Bu(oe)}f.currentTarget=null,m=U}}}}function ut(t,a){var l=a[ml];l===void 0&&(l=a[ml]=new Set);var c=t+"__bubble";l.has(c)||(py(a,t,2,!1),l.add(c))}function Um(t,a,l){var c=0;a&&(c|=4),py(l,t,c,a)}var Td="_reactListening"+Math.random().toString(36).slice(2);function Bm(t){if(!t[Td]){t[Td]=!0,Co.forEach(function(l){l!=="selectionchange"&&(jE.has(l)||Um(l,!1,t),Um(l,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[Td]||(a[Td]=!0,Um("selectionchange",!1,a))}}function py(t,a,l,c){switch(Hy(a)){case 2:var f=tS;break;case 8:f=nS;break;default:f=tp}l=f.bind(null,a,l,t),f=void 0,!Nr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(f=!0),c?f!==void 0?t.addEventListener(a,l,{capture:!0,passive:f}):t.addEventListener(a,l,!0):f!==void 0?t.addEventListener(a,l,{passive:f}):t.addEventListener(a,l,!1)}function zm(t,a,l,c,f){var m=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var E=c.stateNode.containerInfo;if(E===f)break;if(v===4)for(v=c.return;v!==null;){var U=v.tag;if((U===3||U===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;E!==null;){if(v=ra(E),v===null)return;if(U=v.tag,U===5||U===6||U===26||U===27){c=m=v;continue e}E=E.parentNode}}c=c.return}wi(function(){var te=m,oe=Es(l),pe=[];e:{var se=K0.get(t);if(se!==void 0){var ie=fa,De=t;switch(t){case"keypress":if(Sr(l)===0)break e;case"keydown":case"keyup":ie=Pu;break;case"focusin":De="focus",ie=jr;break;case"focusout":De="blur",ie=jr;break;case"beforeblur":case"afterblur":ie=jr;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ie=qo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ie=Au;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ie=b;break;case H0:case $0:case G0:ie=Ru;break;case Y0:ie=A;break;case"scroll":case"scrollend":ie=zo;break;case"wheel":ie=ae;break;case"copy":case"cut":case"paste":ie=ku;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ie=Ba;break;case"toggle":case"beforetoggle":ie=tt}var $e=(a&4)!==0,Mt=!$e&&(t==="scroll"||t==="scrollend"),Q=$e?se!==null?se+"Capture":null:se;$e=[];for(var $=te,ee;$!==null;){var he=$;if(ee=he.stateNode,he=he.tag,he!==5&&he!==26&&he!==27||ee===null||Q===null||(he=Fs($,Q),he!=null&&$e.push(bc($,he,ee))),Mt)break;$=$.return}0<$e.length&&(se=new ie(se,De,null,l,oe),pe.push({event:se,listeners:$e}))}}if((a&7)===0){e:{if(se=t==="mouseover"||t==="pointerover",ie=t==="mouseout"||t==="pointerout",se&&l!==Lo&&(De=l.relatedTarget||l.fromElement)&&(ra(De)||De[aa]))break e;if((ie||se)&&(se=oe.window===oe?oe:(se=oe.ownerDocument)?se.defaultView||se.parentWindow:window,ie?(De=l.relatedTarget||l.toElement,ie=te,De=De?ra(De):null,De!==null&&(Mt=u(De),$e=De.tag,De!==Mt||$e!==5&&$e!==27&&$e!==6)&&(De=null)):(ie=null,De=te),ie!==De)){if($e=qo,he="onMouseLeave",Q="onMouseEnter",$="mouse",(t==="pointerout"||t==="pointerover")&&($e=Ba,he="onPointerLeave",Q="onPointerEnter",$="pointer"),Mt=ie==null?se:rs(ie),ee=De==null?se:rs(De),se=new $e(he,$+"leave",ie,l,oe),se.target=Mt,se.relatedTarget=ee,he=null,ra(oe)===te&&($e=new $e(Q,$+"enter",De,l,oe),$e.target=ee,$e.relatedTarget=Mt,he=$e),Mt=he,ie&&De)t:{for($e=AE,Q=ie,$=De,ee=0,he=Q;he;he=$e(he))ee++;he=0;for(var Fe=$;Fe;Fe=$e(Fe))he++;for(;0<ee-he;)Q=$e(Q),ee--;for(;0<he-ee;)$=$e($),he--;for(;ee--;){if(Q===$||$!==null&&Q===$.alternate){$e=Q;break t}Q=$e(Q),$=$e($)}$e=null}else $e=null;ie!==null&&gy(pe,se,ie,$e,!1),De!==null&&Mt!==null&&gy(pe,Mt,De,$e,!0)}}e:{if(se=te?rs(te):window,ie=se.nodeName&&se.nodeName.toLowerCase(),ie==="select"||ie==="input"&&se.type==="file")var _t=D0;else if(k0(se))if(M0)_t=U2;else{_t=P2;var Le=V2}else ie=se.nodeName,!ie||ie.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?te&&bl(te.elementType)&&(_t=D0):_t=L2;if(_t&&(_t=_t(t,te))){I0(pe,_t,l,oe);break e}Le&&Le(t,se,te),t==="focusout"&&te&&se.type==="number"&&te.memoizedProps.value!=null&&Oo(se,"number",se.value)}switch(Le=te?rs(te):window,t){case"focusin":(k0(Le)||Le.contentEditable==="true")&&(Tl=Le,gf=te,Yo=null);break;case"focusout":Yo=gf=Tl=null;break;case"mousedown":xf=!0;break;case"contextmenu":case"mouseup":case"dragend":xf=!1,q0(pe,l,oe);break;case"selectionchange":if(z2)break;case"keydown":case"keyup":q0(pe,l,oe)}var at;if(Et)e:{switch(t){case"compositionstart":var ht="onCompositionStart";break e;case"compositionend":ht="onCompositionEnd";break e;case"compositionupdate":ht="onCompositionUpdate";break e}ht=void 0}else Sl?Ar(t,l)&&(ht="onCompositionEnd"):t==="keydown"&&l.keyCode===229&&(ht="onCompositionStart");ht&&(ga&&l.locale!=="ko"&&(Sl||ht!=="onCompositionStart"?ht==="onCompositionEnd"&&Sl&&(at=Bo()):(ha=oe,Uo="value"in ha?ha.value:ha.textContent,Sl=!0)),Le=jd(te,ht),0<Le.length&&(ht=new pa(ht,t,null,l,oe),pe.push({event:ht,listeners:Le}),at?ht.data=at:(at=El(l),at!==null&&(ht.data=at)))),(at=Ts?I2(t,l):D2(t,l))&&(ht=jd(te,"onBeforeInput"),0<ht.length&&(Le=new pa("onBeforeInput","beforeinput",null,l,oe),pe.push({event:Le,listeners:ht}),Le.data=at)),EE(pe,t,te,l,oe)}my(pe,a)})}function bc(t,a,l){return{instance:t,listener:a,currentTarget:l}}function jd(t,a){for(var l=a+"Capture",c=[];t!==null;){var f=t,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=Fs(t,l),f!=null&&c.unshift(bc(t,f,m)),f=Fs(t,a),f!=null&&c.push(bc(t,f,m))),t.tag===3)return c;t=t.return}return[]}function AE(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function gy(t,a,l,c,f){for(var m=a._reactName,v=[];l!==null&&l!==c;){var E=l,U=E.alternate,te=E.stateNode;if(E=E.tag,U!==null&&U===c)break;E!==5&&E!==26&&E!==27||te===null||(U=te,f?(te=Fs(l,m),te!=null&&v.unshift(bc(l,te,U))):f||(te=Fs(l,m),te!=null&&v.push(bc(l,te,U)))),l=l.return}v.length!==0&&t.push({event:a,listeners:v})}var CE=/\r\n?/g,RE=/\u0000|\uFFFD/g;function xy(t){return(typeof t=="string"?t:""+t).replace(CE,`
`).replace(RE,"")}function by(t,a){return a=xy(a),xy(t)===a}function Dt(t,a,l,c,f,m){switch(l){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Qn(t,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Qn(t,""+c);break;case"className":ls(t,"class",c);break;case"tabIndex":ls(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ls(t,l,c);break;case"style":Po(t,c,m);break;case"data":if(a!=="object"){ls(t,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||l!=="href")){t.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(l);break}c=yl(""+c),t.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(l==="formAction"?(a!=="input"&&Dt(t,a,"name",f.name,f,null),Dt(t,a,"formEncType",f.formEncType,f,null),Dt(t,a,"formMethod",f.formMethod,f,null),Dt(t,a,"formTarget",f.formTarget,f,null)):(Dt(t,a,"encType",f.encType,f,null),Dt(t,a,"method",f.method,f,null),Dt(t,a,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(l);break}c=yl(""+c),t.setAttribute(l,c);break;case"onClick":c!=null&&(t.onclick=qs);break;case"onScroll":c!=null&&ut("scroll",t);break;case"onScrollEnd":c!=null&&ut("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(f.children!=null)throw Error(i(60));t.innerHTML=l}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}l=yl(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(l,""+c):t.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(l,""):t.removeAttribute(l);break;case"capture":case"download":c===!0?t.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(l,c):t.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(l,c):t.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(l):t.setAttribute(l,c);break;case"popover":ut("beforetoggle",t),ut("toggle",t),gl(t,"popover",c);break;case"xlinkActuate":cn(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":cn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":cn(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":cn(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":cn(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":cn(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":cn(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":cn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":cn(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":gl(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=ju.get(l)||l,gl(t,l,c))}}function qm(t,a,l,c,f,m){switch(l){case"style":Po(t,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(f.children!=null)throw Error(i(60));t.innerHTML=l}}break;case"children":typeof c=="string"?Qn(t,c):(typeof c=="number"||typeof c=="bigint")&&Qn(t,""+c);break;case"onScroll":c!=null&&ut("scroll",t);break;case"onScrollEnd":c!=null&&ut("scrollend",t);break;case"onClick":c!=null&&(t.onclick=qs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ro.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),a=l.slice(2,f?l.length-7:void 0),m=t[Nn]||null,m=m!=null?m[l]:null,typeof m=="function"&&t.removeEventListener(a,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(l in t?t[l]=null:t.hasAttribute(l)&&t.removeAttribute(l)),t.addEventListener(a,c,f);break e}l in t?t[l]=c:c===!0?t.setAttribute(l,""):gl(t,l,c)}}}function In(t,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ut("error",t),ut("load",t);var c=!1,f=!1,m;for(m in l)if(l.hasOwnProperty(m)){var v=l[m];if(v!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Dt(t,a,m,v,l,null)}}f&&Dt(t,a,"srcSet",l.srcSet,l,null),c&&Dt(t,a,"src",l.src,l,null);return;case"input":ut("invalid",t);var E=m=v=f=null,U=null,te=null;for(c in l)if(l.hasOwnProperty(c)){var oe=l[c];if(oe!=null)switch(c){case"name":f=oe;break;case"type":v=oe;break;case"checked":U=oe;break;case"defaultChecked":te=oe;break;case"value":m=oe;break;case"defaultValue":E=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,a));break;default:Dt(t,a,c,oe,l,null)}}Eu(t,m,E,U,te,v,f,!1);return;case"select":ut("invalid",t),c=v=m=null;for(f in l)if(l.hasOwnProperty(f)&&(E=l[f],E!=null))switch(f){case"value":m=E;break;case"defaultValue":v=E;break;case"multiple":c=E;default:Dt(t,a,f,E,l,null)}a=m,l=v,t.multiple=!!c,a!=null?xi(t,!!c,a,!1):l!=null&&xi(t,!!c,l,!0);return;case"textarea":ut("invalid",t),m=f=c=null;for(v in l)if(l.hasOwnProperty(v)&&(E=l[v],E!=null))switch(v){case"value":c=E;break;case"defaultValue":f=E;break;case"children":m=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:Dt(t,a,v,E,l,null)}bi(t,c,f,m);return;case"option":for(U in l)l.hasOwnProperty(U)&&(c=l[U],c!=null)&&(U==="selected"?t.selected=c&&typeof c!="function"&&typeof c!="symbol":Dt(t,a,U,c,l,null));return;case"dialog":ut("beforetoggle",t),ut("toggle",t),ut("cancel",t),ut("close",t);break;case"iframe":case"object":ut("load",t);break;case"video":case"audio":for(c=0;c<xc.length;c++)ut(xc[c],t);break;case"image":ut("error",t),ut("load",t);break;case"details":ut("toggle",t);break;case"embed":case"source":case"link":ut("error",t),ut("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in l)if(l.hasOwnProperty(te)&&(c=l[te],c!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Dt(t,a,te,c,l,null)}return;default:if(bl(a)){for(oe in l)l.hasOwnProperty(oe)&&(c=l[oe],c!==void 0&&qm(t,a,oe,c,l,void 0));return}}for(E in l)l.hasOwnProperty(E)&&(c=l[E],c!=null&&Dt(t,a,E,c,l,null))}function kE(t,a,l,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,v=null,E=null,U=null,te=null,oe=null;for(ie in l){var pe=l[ie];if(l.hasOwnProperty(ie)&&pe!=null)switch(ie){case"checked":break;case"value":break;case"defaultValue":U=pe;default:c.hasOwnProperty(ie)||Dt(t,a,ie,null,c,pe)}}for(var se in c){var ie=c[se];if(pe=l[se],c.hasOwnProperty(se)&&(ie!=null||pe!=null))switch(se){case"type":m=ie;break;case"name":f=ie;break;case"checked":te=ie;break;case"defaultChecked":oe=ie;break;case"value":v=ie;break;case"defaultValue":E=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(137,a));break;default:ie!==pe&&Dt(t,a,se,ie,c,pe)}}xl(t,v,E,U,te,oe,m,f);return;case"select":ie=v=E=se=null;for(m in l)if(U=l[m],l.hasOwnProperty(m)&&U!=null)switch(m){case"value":break;case"multiple":ie=U;default:c.hasOwnProperty(m)||Dt(t,a,m,null,c,U)}for(f in c)if(m=c[f],U=l[f],c.hasOwnProperty(f)&&(m!=null||U!=null))switch(f){case"value":se=m;break;case"defaultValue":E=m;break;case"multiple":v=m;default:m!==U&&Dt(t,a,f,m,c,U)}a=E,l=v,c=ie,se!=null?xi(t,!!l,se,!1):!!c!=!!l&&(a!=null?xi(t,!!l,a,!0):xi(t,!!l,l?[]:"",!1));return;case"textarea":ie=se=null;for(E in l)if(f=l[E],l.hasOwnProperty(E)&&f!=null&&!c.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:Dt(t,a,E,null,c,f)}for(v in c)if(f=c[v],m=l[v],c.hasOwnProperty(v)&&(f!=null||m!=null))switch(v){case"value":se=f;break;case"defaultValue":ie=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&Dt(t,a,v,f,c,m)}Su(t,se,ie);return;case"option":for(var De in l)se=l[De],l.hasOwnProperty(De)&&se!=null&&!c.hasOwnProperty(De)&&(De==="selected"?t.selected=!1:Dt(t,a,De,null,c,se));for(U in c)se=c[U],ie=l[U],c.hasOwnProperty(U)&&se!==ie&&(se!=null||ie!=null)&&(U==="selected"?t.selected=se&&typeof se!="function"&&typeof se!="symbol":Dt(t,a,U,se,c,ie));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $e in l)se=l[$e],l.hasOwnProperty($e)&&se!=null&&!c.hasOwnProperty($e)&&Dt(t,a,$e,null,c,se);for(te in c)if(se=c[te],ie=l[te],c.hasOwnProperty(te)&&se!==ie&&(se!=null||ie!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,a));break;default:Dt(t,a,te,se,c,ie)}return;default:if(bl(a)){for(var Mt in l)se=l[Mt],l.hasOwnProperty(Mt)&&se!==void 0&&!c.hasOwnProperty(Mt)&&qm(t,a,Mt,void 0,c,se);for(oe in c)se=c[oe],ie=l[oe],!c.hasOwnProperty(oe)||se===ie||se===void 0&&ie===void 0||qm(t,a,oe,se,c,ie);return}}for(var Q in l)se=l[Q],l.hasOwnProperty(Q)&&se!=null&&!c.hasOwnProperty(Q)&&Dt(t,a,Q,null,c,se);for(pe in c)se=c[pe],ie=l[pe],!c.hasOwnProperty(pe)||se===ie||se==null&&ie==null||Dt(t,a,pe,se,c,ie)}function yy(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function IE(){if(typeof performance.getEntriesByType=="function"){for(var t=0,a=0,l=performance.getEntriesByType("resource"),c=0;c<l.length;c++){var f=l[c],m=f.transferSize,v=f.initiatorType,E=f.duration;if(m&&E&&yy(v)){for(v=0,E=f.responseEnd,c+=1;c<l.length;c++){var U=l[c],te=U.startTime;if(te>E)break;var oe=U.transferSize,pe=U.initiatorType;oe&&yy(pe)&&(U=U.responseEnd,v+=oe*(U<E?1:(E-te)/(U-te)))}if(--c,a+=8*(m+v)/(f.duration/1e3),t++,10<t)break}}if(0<t)return a/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Fm=null,Hm=null;function Ad(t){return t.nodeType===9?t:t.ownerDocument}function vy(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wy(t,a){if(t===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&a==="foreignObject"?0:t}function $m(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Gm=null;function DE(){var t=window.event;return t&&t.type==="popstate"?t===Gm?!1:(Gm=t,!0):(Gm=null,!1)}var _y=typeof setTimeout=="function"?setTimeout:void 0,ME=typeof clearTimeout=="function"?clearTimeout:void 0,Ny=typeof Promise=="function"?Promise:void 0,OE=typeof queueMicrotask=="function"?queueMicrotask:typeof Ny<"u"?function(t){return Ny.resolve(null).then(t).catch(VE)}:_y;function VE(t){setTimeout(function(){throw t})}function zi(t){return t==="head"}function Ey(t,a){var l=a,c=0;do{var f=l.nextSibling;if(t.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"||l==="/&"){if(c===0){t.removeChild(f),Zl(a);return}c--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")c++;else if(l==="html")yc(t.ownerDocument.documentElement);else if(l==="head"){l=t.ownerDocument.head,yc(l);for(var m=l.firstChild;m;){var v=m.nextSibling,E=m.nodeName;m[ia]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&m.rel.toLowerCase()==="stylesheet"||l.removeChild(m),m=v}}else l==="body"&&yc(t.ownerDocument.body);l=f}while(l);Zl(a)}function Sy(t,a){var l=t;t=0;do{var c=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),c&&c.nodeType===8)if(l=c.data,l==="/$"){if(t===0)break;t--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||t++;l=c}while(l)}function Ym(t){var a=t.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Ym(l),pl(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}t.removeChild(l)}}function PE(t,a,l,c){for(;t.nodeType===1;){var f=l;if(t.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[ia])switch(a){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(m=t.getAttribute("rel"),m==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(m!==f.rel||t.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||t.getAttribute("title")!==(f.title==null?null:f.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(m=t.getAttribute("src"),(m!==(f.src==null?null:f.src)||t.getAttribute("type")!==(f.type==null?null:f.type)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(a==="input"&&t.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&t.getAttribute("name")===m)return t}else return t;if(t=Ds(t.nextSibling),t===null)break}return null}function LE(t,a,l){if(a==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!l||(t=Ds(t.nextSibling),t===null))return null;return t}function Ty(t,a){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=Ds(t.nextSibling),t===null))return null;return t}function Km(t){return t.data==="$?"||t.data==="$~"}function Qm(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function UE(t,a){var l=t.ownerDocument;if(t.data==="$~")t._reactRetry=a;else if(t.data!=="$?"||l.readyState!=="loading")a();else{var c=function(){a(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function Ds(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return t}var Wm=null;function jy(t){t=t.nextSibling;for(var a=0;t;){if(t.nodeType===8){var l=t.data;if(l==="/$"||l==="/&"){if(a===0)return Ds(t.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}t=t.nextSibling}return null}function Ay(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var l=t.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return t;a--}else l!=="/$"&&l!=="/&"||a++}t=t.previousSibling}return null}function Cy(t,a,l){switch(a=Ad(l),t){case"html":if(t=a.documentElement,!t)throw Error(i(452));return t;case"head":if(t=a.head,!t)throw Error(i(453));return t;case"body":if(t=a.body,!t)throw Error(i(454));return t;default:throw Error(i(451))}}function yc(t){for(var a=t.attributes;a.length;)t.removeAttributeNode(a[0]);pl(t)}var Ms=new Map,Ry=new Set;function Cd(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var ti=K.d;K.d={f:BE,r:zE,D:qE,C:FE,L:HE,m:$E,X:YE,S:GE,M:KE};function BE(){var t=ti.f(),a=vd();return t||a}function zE(t){var a=Ns(t);a!==null&&a.tag===5&&a.type==="form"?Yx(a):ti.r(t)}var Wl=typeof document>"u"?null:document;function ky(t,a,l){var c=Wl;if(c&&typeof a=="string"&&a){var f=Kn(a);f='link[rel="'+t+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),Ry.has(f)||(Ry.add(f),t={rel:t,crossOrigin:l,href:a},c.querySelector(f)===null&&(a=c.createElement("link"),In(a,"link",t),on(a),c.head.appendChild(a)))}}function qE(t){ti.D(t),ky("dns-prefetch",t,null)}function FE(t,a){ti.C(t,a),ky("preconnect",t,a)}function HE(t,a,l){ti.L(t,a,l);var c=Wl;if(c&&t&&a){var f='link[rel="preload"][as="'+Kn(a)+'"]';a==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+Kn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+Kn(l.imageSizes)+'"]')):f+='[href="'+Kn(t)+'"]';var m=f;switch(a){case"style":m=Xl(t);break;case"script":m=Jl(t)}Ms.has(m)||(t=_({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:t,as:a},l),Ms.set(m,t),c.querySelector(f)!==null||a==="style"&&c.querySelector(vc(m))||a==="script"&&c.querySelector(wc(m))||(a=c.createElement("link"),In(a,"link",t),on(a),c.head.appendChild(a)))}}function $E(t,a){ti.m(t,a);var l=Wl;if(l&&t){var c=a&&typeof a.as=="string"?a.as:"script",f='link[rel="modulepreload"][as="'+Kn(c)+'"][href="'+Kn(t)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Jl(t)}if(!Ms.has(m)&&(t=_({rel:"modulepreload",href:t},a),Ms.set(m,t),l.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(wc(m)))return}c=l.createElement("link"),In(c,"link",t),on(c),l.head.appendChild(c)}}}function GE(t,a,l){ti.S(t,a,l);var c=Wl;if(c&&t){var f=la(c).hoistableStyles,m=Xl(t);a=a||"default";var v=f.get(m);if(!v){var E={loading:0,preload:null};if(v=c.querySelector(vc(m)))E.loading=5;else{t=_({rel:"stylesheet",href:t,"data-precedence":a},l),(l=Ms.get(m))&&Xm(t,l);var U=v=c.createElement("link");on(U),In(U,"link",t),U._p=new Promise(function(te,oe){U.onload=te,U.onerror=oe}),U.addEventListener("load",function(){E.loading|=1}),U.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Rd(v,a,c)}v={type:"stylesheet",instance:v,count:1,state:E},f.set(m,v)}}}function YE(t,a){ti.X(t,a);var l=Wl;if(l&&t){var c=la(l).hoistableScripts,f=Jl(t),m=c.get(f);m||(m=l.querySelector(wc(f)),m||(t=_({src:t,async:!0},a),(a=Ms.get(f))&&Jm(t,a),m=l.createElement("script"),on(m),In(m,"link",t),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function KE(t,a){ti.M(t,a);var l=Wl;if(l&&t){var c=la(l).hoistableScripts,f=Jl(t),m=c.get(f);m||(m=l.querySelector(wc(f)),m||(t=_({src:t,async:!0,type:"module"},a),(a=Ms.get(f))&&Jm(t,a),m=l.createElement("script"),on(m),In(m,"link",t),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function Iy(t,a,l,c){var f=(f=Ie.current)?Cd(f):null;if(!f)throw Error(i(446));switch(t){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=Xl(l.href),l=la(f).hoistableStyles,c=l.get(a),c||(c={type:"style",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){t=Xl(l.href);var m=la(f).hoistableStyles,v=m.get(t);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(t,v),(m=f.querySelector(vc(t)))&&!m._p&&(v.instance=m,v.state.loading=5),Ms.has(t)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Ms.set(t,l),m||QE(f,t,l,v.state))),a&&c===null)throw Error(i(528,""));return v}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Jl(l),l=la(f).hoistableScripts,c=l.get(a),c||(c={type:"script",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,t))}}function Xl(t){return'href="'+Kn(t)+'"'}function vc(t){return'link[rel="stylesheet"]['+t+"]"}function Dy(t){return _({},t,{"data-precedence":t.precedence,precedence:null})}function QE(t,a,l,c){t.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=t.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),In(a,"link",l),on(a),t.head.appendChild(a))}function Jl(t){return'[src="'+Kn(t)+'"]'}function wc(t){return"script[async]"+t}function My(t,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var c=t.querySelector('style[data-href~="'+Kn(l.href)+'"]');if(c)return a.instance=c,on(c),c;var f=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),on(c),In(c,"style",f),Rd(c,l.precedence,t),a.instance=c;case"stylesheet":f=Xl(l.href);var m=t.querySelector(vc(f));if(m)return a.state.loading|=4,a.instance=m,on(m),m;c=Dy(l),(f=Ms.get(f))&&Xm(c,f),m=(t.ownerDocument||t).createElement("link"),on(m);var v=m;return v._p=new Promise(function(E,U){v.onload=E,v.onerror=U}),In(m,"link",c),a.state.loading|=4,Rd(m,l.precedence,t),a.instance=m;case"script":return m=Jl(l.src),(f=t.querySelector(wc(m)))?(a.instance=f,on(f),f):(c=l,(f=Ms.get(m))&&(c=_({},l),Jm(c,f)),t=t.ownerDocument||t,f=t.createElement("script"),on(f),In(f,"link",c),t.head.appendChild(f),a.instance=f);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Rd(c,l.precedence,t));return a.instance}function Rd(t,a,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,v=0;v<c.length;v++){var E=c[v];if(E.dataset.precedence===a)m=E;else if(m!==f)break}m?m.parentNode.insertBefore(t,m.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(t,a.firstChild))}function Xm(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.title==null&&(t.title=a.title)}function Jm(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.integrity==null&&(t.integrity=a.integrity)}var kd=null;function Oy(t,a,l){if(kd===null){var c=new Map,f=kd=new Map;f.set(l,c)}else f=kd,c=f.get(l),c||(c=new Map,f.set(l,c));if(c.has(t))return c;for(c.set(t,null),l=l.getElementsByTagName(t),f=0;f<l.length;f++){var m=l[f];if(!(m[ia]||m[ln]||t==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var v=m.getAttribute(a)||"";v=t+v;var E=c.get(v);E?E.push(m):c.set(v,[m])}}return c}function Vy(t,a,l){t=t.ownerDocument||t,t.head.insertBefore(l,a==="title"?t.querySelector("head > title"):null)}function WE(t,a,l){if(l===1||a.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(t=a.disabled,typeof a.precedence=="string"&&t==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Py(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function XE(t,a,l,c){if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var f=Xl(c.href),m=a.querySelector(vc(f));if(m){a=m._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(t.count++,t=Id.bind(t),a.then(t,t)),l.state.loading|=4,l.instance=m,on(m);return}m=a.ownerDocument||a,c=Dy(c),(f=Ms.get(f))&&Xm(c,f),m=m.createElement("link"),on(m);var v=m;v._p=new Promise(function(E,U){v.onload=E,v.onerror=U}),In(m,"link",c),l.instance=m}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(t.count++,l=Id.bind(t),a.addEventListener("load",l),a.addEventListener("error",l))}}var Zm=0;function JE(t,a){return t.stylesheets&&t.count===0&&Md(t,t.stylesheets),0<t.count||0<t.imgCount?function(l){var c=setTimeout(function(){if(t.stylesheets&&Md(t,t.stylesheets),t.unsuspend){var m=t.unsuspend;t.unsuspend=null,m()}},6e4+a);0<t.imgBytes&&Zm===0&&(Zm=62500*IE());var f=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Md(t,t.stylesheets),t.unsuspend)){var m=t.unsuspend;t.unsuspend=null,m()}},(t.imgBytes>Zm?50:800)+a);return t.unsuspend=l,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Id(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Md(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Dd=null;function Md(t,a){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Dd=new Map,a.forEach(ZE,t),Dd=null,Id.call(t))}function ZE(t,a){if(!(a.state.loading&4)){var l=Dd.get(t);if(l)var c=l.get(null);else{l=new Map,Dd.set(t,l);for(var f=t.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var v=f[m];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(l.set(v.dataset.precedence,v),c=v)}c&&l.set(null,c)}f=a.instance,v=f.getAttribute("data-precedence"),m=l.get(v)||c,m===c&&l.set(null,f),l.set(v,f),this.count++,c=Id.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(f,t.firstChild)),a.state.loading|=4}}var _c={$$typeof:W,Provider:null,Consumer:null,_currentValue:fe,_currentValue2:fe,_threadCount:0};function eS(t,a,l,c,f,m,v,E,U){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Hn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hn(0),this.hiddenUpdates=Hn(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function Ly(t,a,l,c,f,m,v,E,U,te,oe,pe){return t=new eS(t,a,l,v,U,te,oe,pe,E),a=1,m===!0&&(a|=24),m=cs(3,null,null,a),t.current=m,m.stateNode=t,a=If(),a.refCount++,t.pooledCache=a,a.refCount++,m.memoizedState={element:c,isDehydrated:l,cache:a},Vf(m),t}function Uy(t){return t?(t=Cl,t):Cl}function By(t,a,l,c,f,m){f=Uy(f),c.context===null?c.context=f:c.pendingContext=f,c=Ri(a),c.payload={element:l},m=m===void 0?null:m,m!==null&&(c.callback=m),l=ki(t,c,a),l!==null&&(es(l,t,a),ec(l,t,a))}function zy(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var l=t.retryLane;t.retryLane=l!==0&&l<a?l:a}}function ep(t,a){zy(t,a),(t=t.alternate)&&zy(t,a)}function qy(t){if(t.tag===13||t.tag===31){var a=kr(t,67108864);a!==null&&es(a,t,67108864),ep(t,67108864)}}function Fy(t){if(t.tag===13||t.tag===31){var a=ms();a=pi(a);var l=kr(t,a);l!==null&&es(l,t,a),ep(t,a)}}var Od=!0;function tS(t,a,l,c){var f=I.T;I.T=null;var m=K.p;try{K.p=2,tp(t,a,l,c)}finally{K.p=m,I.T=f}}function nS(t,a,l,c){var f=I.T;I.T=null;var m=K.p;try{K.p=8,tp(t,a,l,c)}finally{K.p=m,I.T=f}}function tp(t,a,l,c){if(Od){var f=np(c);if(f===null)zm(t,a,c,Vd,l),$y(t,c);else if(aS(f,t,a,l,c))c.stopPropagation();else if($y(t,c),a&4&&-1<sS.indexOf(t)){for(;f!==null;){var m=Ns(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var v=$t(m.pendingLanes);if(v!==0){var E=m;for(E.pendingLanes|=2,E.entangledLanes|=2;v;){var U=1<<31-ce(v);E.entanglements[1]|=U,v&=~U}va(m),(St&6)===0&&(bd=xt()+500,gc(0))}}break;case 31:case 13:E=kr(m,2),E!==null&&es(E,m,2),vd(),ep(m,2)}if(m=np(c),m===null&&zm(t,a,c,Vd,l),m===f)break;f=m}f!==null&&c.stopPropagation()}else zm(t,a,c,null,l)}}function np(t){return t=Es(t),sp(t)}var Vd=null;function sp(t){if(Vd=null,t=ra(t),t!==null){var a=u(t);if(a===null)t=null;else{var l=a.tag;if(l===13){if(t=d(a),t!==null)return t;t=null}else if(l===31){if(t=p(a),t!==null)return t;t=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null)}}return Vd=t,null}function Hy(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(lt()){case rn:return 2;case wt:return 8;case _s:case bn:return 32;case Vn:return 268435456;default:return 32}default:return 32}}var ap=!1,qi=null,Fi=null,Hi=null,Nc=new Map,Ec=new Map,$i=[],sS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $y(t,a){switch(t){case"focusin":case"focusout":qi=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":Hi=null;break;case"pointerover":case"pointerout":Nc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ec.delete(a.pointerId)}}function Sc(t,a,l,c,f,m){return t===null||t.nativeEvent!==m?(t={blockedOn:a,domEventName:l,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},a!==null&&(a=Ns(a),a!==null&&qy(a)),t):(t.eventSystemFlags|=c,a=t.targetContainers,f!==null&&a.indexOf(f)===-1&&a.push(f),t)}function aS(t,a,l,c,f){switch(a){case"focusin":return qi=Sc(qi,t,a,l,c,f),!0;case"dragenter":return Fi=Sc(Fi,t,a,l,c,f),!0;case"mouseover":return Hi=Sc(Hi,t,a,l,c,f),!0;case"pointerover":var m=f.pointerId;return Nc.set(m,Sc(Nc.get(m)||null,t,a,l,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Ec.set(m,Sc(Ec.get(m)||null,t,a,l,c,f)),!0}return!1}function Gy(t){var a=ra(t.target);if(a!==null){var l=u(a);if(l!==null){if(a=l.tag,a===13){if(a=d(l),a!==null){t.blockedOn=a,Bs(t.priority,function(){Fy(l)});return}}else if(a===31){if(a=p(l),a!==null){t.blockedOn=a,Bs(t.priority,function(){Fy(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){t.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Pd(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var l=np(t.nativeEvent);if(l===null){l=t.nativeEvent;var c=new l.constructor(l.type,l);Lo=c,l.target.dispatchEvent(c),Lo=null}else return a=Ns(l),a!==null&&qy(a),t.blockedOn=l,!1;a.shift()}return!0}function Yy(t,a,l){Pd(t)&&l.delete(a)}function iS(){ap=!1,qi!==null&&Pd(qi)&&(qi=null),Fi!==null&&Pd(Fi)&&(Fi=null),Hi!==null&&Pd(Hi)&&(Hi=null),Nc.forEach(Yy),Ec.forEach(Yy)}function Ld(t,a){t.blockedOn===a&&(t.blockedOn=null,ap||(ap=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,iS)))}var Ud=null;function Ky(t){Ud!==t&&(Ud=t,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Ud===t&&(Ud=null);for(var a=0;a<t.length;a+=3){var l=t[a],c=t[a+1],f=t[a+2];if(typeof c!="function"){if(sp(c||l)===null)continue;break}var m=Ns(l);m!==null&&(t.splice(a,3),a-=3,nm(m,{pending:!0,data:f,method:l.method,action:c},c,f))}}))}function Zl(t){function a(U){return Ld(U,t)}qi!==null&&Ld(qi,t),Fi!==null&&Ld(Fi,t),Hi!==null&&Ld(Hi,t),Nc.forEach(a),Ec.forEach(a);for(var l=0;l<$i.length;l++){var c=$i[l];c.blockedOn===t&&(c.blockedOn=null)}for(;0<$i.length&&(l=$i[0],l.blockedOn===null);)Gy(l),l.blockedOn===null&&$i.shift();if(l=(t.ownerDocument||t).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var f=l[c],m=l[c+1],v=f[Nn]||null;if(typeof m=="function")v||Ky(l);else if(v){var E=null;if(m&&m.hasAttribute("formAction")){if(f=m,v=m[Nn]||null)E=v.formAction;else if(sp(f)!==null)continue}else E=v.action;typeof E=="function"?l[c+1]=E:(l.splice(c,3),c-=3),Ky(l)}}}function Qy(){function t(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function a(){f!==null&&(f(),f=null),c||setTimeout(l,20)}function l(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),f!==null&&(f(),f=null)}}}function ip(t){this._internalRoot=t}Bd.prototype.render=ip.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,c=ms();By(l,c,t,a,null,null)},Bd.prototype.unmount=ip.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;By(t.current,2,null,t,null,null),vd(),a[aa]=null}};function Bd(t){this._internalRoot=t}Bd.prototype.unstable_scheduleHydration=function(t){if(t){var a=vu();t={blockedOn:null,target:t,priority:a};for(var l=0;l<$i.length&&a!==0&&a<$i[l].priority;l++);$i.splice(l,0,t),l===0&&Gy(t)}};var Wy=e.version;if(Wy!=="19.2.4")throw Error(i(527,Wy,"19.2.4"));K.findDOMNode=function(t){var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(i(188)):(t=Object.keys(t).join(","),Error(i(268,t)));return t=x(a),t=t!==null?y(t):null,t=t===null?null:t.stateNode,t};var rS={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zd.isDisabled&&zd.supportsFiber)try{R=zd.inject(rS),G=zd}catch{}}return jc.createRoot=function(t,a){if(!o(t))throw Error(i(299));var l=!1,c="",f=sb,m=ab,v=ib;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(f=a.onUncaughtError),a.onCaughtError!==void 0&&(m=a.onCaughtError),a.onRecoverableError!==void 0&&(v=a.onRecoverableError)),a=Ly(t,1,!1,null,null,l,c,null,f,m,v,Qy),t[aa]=a.current,Bm(t),new ip(a)},jc.hydrateRoot=function(t,a,l){if(!o(t))throw Error(i(299));var c=!1,f="",m=sb,v=ab,E=ib,U=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(E=l.onRecoverableError),l.formState!==void 0&&(U=l.formState)),a=Ly(t,1,!0,a,l??null,c,f,U,m,v,E,Qy),a.context=Uy(null),l=a.current,c=ms(),c=pi(c),f=Ri(c),f.callback=null,ki(l,f,c),l=c,a.current.lanes=l,_n(a,l),va(a),t[aa]=a.current,Bm(t),new Bd(a)},jc.version="19.2.4",jc}var rv;function xS(){if(rv)return op.exports;rv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),op.exports=gS(),op.exports}var bS=xS();const yS=h_(bS);var lv="popstate";function vS(s={}){function e(o,u){let{pathname:d="/",search:p="",hash:g=""}=ol(o.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),Pp("",{pathname:d,search:p,hash:g},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function n(o,u){let d=o.document.querySelector("base"),p="";if(d&&d.getAttribute("href")){let g=o.location.href,x=g.indexOf("#");p=x===-1?g:g.slice(0,x)}return p+"#"+(typeof u=="string"?u:Yc(u))}function i(o,u){Ps(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(u)})`)}return _S(e,n,i,s)}function Ft(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Ps(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function wS(){return Math.random().toString(36).substring(2,10)}function ov(s,e){return{usr:s.state,key:s.key,idx:e}}function Pp(s,e,n=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?ol(e):e,state:n,key:e&&e.key||i||wS()}}function Yc({pathname:s="/",search:e="",hash:n=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(s+=n.charAt(0)==="#"?n:"#"+n),s}function ol(s){let e={};if(s){let n=s.indexOf("#");n>=0&&(e.hash=s.substring(n),s=s.substring(0,n));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function _S(s,e,n,i={}){let{window:o=document.defaultView,v5Compat:u=!1}=i,d=o.history,p="POP",g=null,x=y();x==null&&(x=0,d.replaceState({...d.state,idx:x},""));function y(){return(d.state||{idx:null}).idx}function _(){p="POP";let P=y(),q=P==null?null:P-x;x=P,g&&g({action:p,location:B.location,delta:q})}function S(P,q){p="PUSH";let Y=Pp(B.location,P,q);n&&n(Y,P),x=y()+1;let W=ov(Y,x),xe=B.createHref(Y);try{d.pushState(W,"",xe)}catch(me){if(me instanceof DOMException&&me.name==="DataCloneError")throw me;o.location.assign(xe)}u&&g&&g({action:p,location:B.location,delta:1})}function C(P,q){p="REPLACE";let Y=Pp(B.location,P,q);n&&n(Y,P),x=y();let W=ov(Y,x),xe=B.createHref(Y);d.replaceState(W,"",xe),u&&g&&g({action:p,location:B.location,delta:0})}function H(P){return NS(P)}let B={get action(){return p},get location(){return s(o,d)},listen(P){if(g)throw new Error("A history only accepts one active listener");return o.addEventListener(lv,_),g=P,()=>{o.removeEventListener(lv,_),g=null}},createHref(P){return e(o,P)},createURL:H,encodeLocation(P){let q=H(P);return{pathname:q.pathname,search:q.search,hash:q.hash}},push:S,replace:C,go(P){return d.go(P)}};return B}function NS(s,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ft(n,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:Yc(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function f_(s,e,n="/"){return ES(s,e,n,!1)}function ES(s,e,n,i){let o=typeof e=="string"?ol(e):e,u=li(o.pathname||"/",n);if(u==null)return null;let d=m_(s);SS(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let x=VS(u);p=MS(d[g],x,i)}return p}function m_(s,e=[],n=[],i="",o=!1){let u=(d,p,g=o,x)=>{let y={relativePath:x===void 0?d.path||"":x,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(y.relativePath.startsWith("/")){if(!y.relativePath.startsWith(i)&&g)return;Ft(y.relativePath.startsWith(i),`Absolute route path "${y.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),y.relativePath=y.relativePath.slice(i.length)}let _=ai([i,y.relativePath]),S=n.concat(y);d.children&&d.children.length>0&&(Ft(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),m_(d.children,e,S,_,g)),!(d.path==null&&!d.index)&&e.push({path:_,score:IS(_,d.index),routesMeta:S})};return s.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of p_(d.path))u(d,p,!0,g)}),e}function p_(s){let e=s.split("/");if(e.length===0)return[];let[n,...i]=e,o=n.endsWith("?"),u=n.replace(/\?$/,"");if(i.length===0)return o?[u,""]:[u];let d=p_(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),o&&p.push(...d),p.map(g=>s.startsWith("/")&&g===""?"/":g)}function SS(s){s.sort((e,n)=>e.score!==n.score?n.score-e.score:DS(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var TS=/^:[\w-]+$/,jS=3,AS=2,CS=1,RS=10,kS=-2,cv=s=>s==="*";function IS(s,e){let n=s.split("/"),i=n.length;return n.some(cv)&&(i+=kS),e&&(i+=AS),n.filter(o=>!cv(o)).reduce((o,u)=>o+(TS.test(u)?jS:u===""?CS:RS),i)}function DS(s,e){return s.length===e.length&&s.slice(0,-1).every((i,o)=>i===e[o])?s[s.length-1]-e[e.length-1]:0}function MS(s,e,n=!1){let{routesMeta:i}=s,o={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],x=p===i.length-1,y=u==="/"?e:e.slice(u.length)||"/",_=fh({path:g.relativePath,caseSensitive:g.caseSensitive,end:x},y),S=g.route;if(!_&&x&&n&&!i[i.length-1].route.index&&(_=fh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},y)),!_)return null;Object.assign(o,_.params),d.push({params:o,pathname:ai([u,_.pathname]),pathnameBase:BS(ai([u,_.pathnameBase])),route:S}),_.pathnameBase!=="/"&&(u=ai([u,_.pathnameBase]))}return d}function fh(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[n,i]=OS(s.path,s.caseSensitive,s.end),o=e.match(n);if(!o)return null;let u=o[0],d=u.replace(/(.)\/+$/,"$1"),p=o.slice(1);return{params:i.reduce((x,{paramName:y,isOptional:_},S)=>{if(y==="*"){let H=p[S]||"";d=u.slice(0,u.length-H.length).replace(/(.)\/+$/,"$1")}const C=p[S];return _&&!C?x[y]=void 0:x[y]=(C||"").replace(/%2F/g,"/"),x},{}),pathname:u,pathnameBase:d,pattern:s}}function OS(s,e=!1,n=!0){Ps(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],o="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),o+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":s!==""&&s!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function VS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ps(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function li(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=s.charAt(n);return i&&i!=="/"?null:s.slice(n)||"/"}var PS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function LS(s,e="/"){let{pathname:n,search:i="",hash:o=""}=typeof s=="string"?ol(s):s,u;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?u=uv(n.substring(1),"/"):u=uv(n,e)):u=e,{pathname:u,search:zS(i),hash:qS(o)}}function uv(s,e){let n=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function hp(s,e,n,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function US(s){return s.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function yg(s){let e=US(s);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function vg(s,e,n,i=!1){let o;typeof s=="string"?o=ol(s):(o={...s},Ft(!o.pathname||!o.pathname.includes("?"),hp("?","pathname","search",o)),Ft(!o.pathname||!o.pathname.includes("#"),hp("#","pathname","hash",o)),Ft(!o.search||!o.search.includes("#"),hp("#","search","hash",o)));let u=s===""||o.pathname==="",d=u?"/":o.pathname,p;if(d==null)p=n;else{let _=e.length-1;if(!i&&d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),_-=1;o.pathname=S.join("/")}p=_>=0?e[_]:"/"}let g=LS(o,p),x=d&&d!=="/"&&d.endsWith("/"),y=(u||d===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(x||y)&&(g.pathname+="/"),g}var ai=s=>s.join("/").replace(/\/\/+/g,"/"),BS=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),zS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,qS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,FS=class{constructor(s,e,n,i=!1){this.status=s,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function HS(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function $S(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var g_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function x_(s,e){let n=s;if(typeof n!="string"||!PS.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,o=!1;if(g_)try{let u=new URL(window.location.href),d=n.startsWith("//")?new URL(u.protocol+n):new URL(n),p=li(d.pathname,e);d.origin===u.origin&&p!=null?n=p+d.search+d.hash:o=!0}catch{Ps(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:o,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var b_=["POST","PUT","PATCH","DELETE"];new Set(b_);var GS=["GET",...b_];new Set(GS);var vo=N.createContext(null);vo.displayName="DataRouter";var Vh=N.createContext(null);Vh.displayName="DataRouterState";var YS=N.createContext(!1),y_=N.createContext({isTransitioning:!1});y_.displayName="ViewTransition";var KS=N.createContext(new Map);KS.displayName="Fetchers";var QS=N.createContext(null);QS.displayName="Await";var ws=N.createContext(null);ws.displayName="Navigation";var iu=N.createContext(null);iu.displayName="Location";var ta=N.createContext({outlet:null,matches:[],isDataRoute:!1});ta.displayName="Route";var wg=N.createContext(null);wg.displayName="RouteError";var v_="REACT_ROUTER_ERROR",WS="REDIRECT",XS="ROUTE_ERROR_RESPONSE";function JS(s){if(s.startsWith(`${v_}:${WS}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function ZS(s){if(s.startsWith(`${v_}:${XS}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new FS(e.status,e.statusText,e.data)}catch{}}function eT(s,{relative:e}={}){Ft(wo(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=N.useContext(ws),{hash:o,pathname:u,search:d}=ru(s,{relative:e}),p=u;return n!=="/"&&(p=u==="/"?n:ai([n,u])),i.createHref({pathname:p,search:d,hash:o})}function wo(){return N.useContext(iu)!=null}function mr(){return Ft(wo(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(iu).location}var w_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function __(s){N.useContext(ws).static||N.useLayoutEffect(s)}function _o(){let{isDataRoute:s}=N.useContext(ta);return s?fT():tT()}function tT(){Ft(wo(),"useNavigate() may be used only in the context of a <Router> component.");let s=N.useContext(vo),{basename:e,navigator:n}=N.useContext(ws),{matches:i}=N.useContext(ta),{pathname:o}=mr(),u=JSON.stringify(yg(i)),d=N.useRef(!1);return __(()=>{d.current=!0}),N.useCallback((g,x={})=>{if(Ps(d.current,w_),!d.current)return;if(typeof g=="number"){n.go(g);return}let y=vg(g,JSON.parse(u),o,x.relative==="path");s==null&&e!=="/"&&(y.pathname=y.pathname==="/"?e:ai([e,y.pathname])),(x.replace?n.replace:n.push)(y,x.state,x)},[e,n,u,o,s])}N.createContext(null);function No(){let{matches:s}=N.useContext(ta),e=s[s.length-1];return e?e.params:{}}function ru(s,{relative:e}={}){let{matches:n}=N.useContext(ta),{pathname:i}=mr(),o=JSON.stringify(yg(n));return N.useMemo(()=>vg(s,JSON.parse(o),i,e==="path"),[s,o,i,e])}function nT(s,e){return N_(s,e)}function N_(s,e,n,i,o){Ft(wo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=N.useContext(ws),{matches:d}=N.useContext(ta),p=d[d.length-1],g=p?p.params:{},x=p?p.pathname:"/",y=p?p.pathnameBase:"/",_=p&&p.route;{let Y=_&&_.path||"";S_(x,!_||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${x}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let S=mr(),C;if(e){let Y=typeof e=="string"?ol(e):e;Ft(y==="/"||Y.pathname?.startsWith(y),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${y}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),C=Y}else C=S;let H=C.pathname||"/",B=H;if(y!=="/"){let Y=y.replace(/^\//,"").split("/");B="/"+H.replace(/^\//,"").split("/").slice(Y.length).join("/")}let P=f_(s,{pathname:B});Ps(_||P!=null,`No routes matched location "${C.pathname}${C.search}${C.hash}" `),Ps(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${C.pathname}${C.search}${C.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let q=lT(P&&P.map(Y=>Object.assign({},Y,{params:Object.assign({},g,Y.params),pathname:ai([y,u.encodeLocation?u.encodeLocation(Y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?y:ai([y,u.encodeLocation?u.encodeLocation(Y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathnameBase])})),d,n,i,o);return e&&q?N.createElement(iu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...C},navigationType:"POP"}},q):q}function sT(){let s=hT(),e=HS(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),n=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:u},"ErrorBoundary")," or"," ",N.createElement("code",{style:u},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:o},n):null,d)}var aT=N.createElement(sT,null),E_=class extends N.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const n=ZS(s.digest);n&&(s=n)}let e=s!==void 0?N.createElement(ta.Provider,{value:this.props.routeContext},N.createElement(wg.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?N.createElement(iT,{error:s},e):e}};E_.contextType=YS;var fp=new WeakMap;function iT({children:s,error:e}){let{basename:n}=N.useContext(ws);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=JS(e.digest);if(i){let o=fp.get(e);if(o)throw o;let u=x_(i.location,n);if(g_&&!fp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw fp.set(e,d),d}return N.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function rT({routeContext:s,match:e,children:n}){let i=N.useContext(vo);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(ta.Provider,{value:s},n)}function lT(s,e=[],n=null,i=null,o=null){if(s==null){if(!n)return null;if(n.errors)s=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)s=n.matches;else return null}let u=s,d=n?.errors;if(d!=null){let y=u.findIndex(_=>_.route.id&&d?.[_.route.id]!==void 0);Ft(y>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,y+1))}let p=!1,g=-1;if(n)for(let y=0;y<u.length;y++){let _=u[y];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(g=y),_.route.id){let{loaderData:S,errors:C}=n,H=_.route.loader&&!S.hasOwnProperty(_.route.id)&&(!C||C[_.route.id]===void 0);if(_.route.lazy||H){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let x=n&&i?(y,_)=>{i(y,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:$S(n.matches),errorInfo:_})}:void 0;return u.reduceRight((y,_,S)=>{let C,H=!1,B=null,P=null;n&&(C=d&&_.route.id?d[_.route.id]:void 0,B=_.route.errorElement||aT,p&&(g<0&&S===0?(S_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,P=null):g===S&&(H=!0,P=_.route.hydrateFallbackElement||null)));let q=e.concat(u.slice(0,S+1)),Y=()=>{let W;return C?W=B:H?W=P:_.route.Component?W=N.createElement(_.route.Component,null):_.route.element?W=_.route.element:W=y,N.createElement(rT,{match:_,routeContext:{outlet:y,matches:q,isDataRoute:n!=null},children:W})};return n&&(_.route.ErrorBoundary||_.route.errorElement||S===0)?N.createElement(E_,{location:n.location,revalidation:n.revalidation,component:B,error:C,children:Y(),routeContext:{outlet:null,matches:q,isDataRoute:!0},onError:x}):Y()},null)}function _g(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oT(s){let e=N.useContext(vo);return Ft(e,_g(s)),e}function cT(s){let e=N.useContext(Vh);return Ft(e,_g(s)),e}function uT(s){let e=N.useContext(ta);return Ft(e,_g(s)),e}function Ng(s){let e=uT(s),n=e.matches[e.matches.length-1];return Ft(n.route.id,`${s} can only be used on routes that contain a unique "id"`),n.route.id}function dT(){return Ng("useRouteId")}function hT(){let s=N.useContext(wg),e=cT("useRouteError"),n=Ng("useRouteError");return s!==void 0?s:e.errors?.[n]}function fT(){let{router:s}=oT("useNavigate"),e=Ng("useNavigate"),n=N.useRef(!1);return __(()=>{n.current=!0}),N.useCallback(async(o,u={})=>{Ps(n.current,w_),n.current&&(typeof o=="number"?await s.navigate(o):await s.navigate(o,{fromRouteId:e,...u}))},[s,e])}var dv={};function S_(s,e,n){!e&&!dv[s]&&(dv[s]=!0,Ps(!1,n))}N.memo(mT);function mT({routes:s,future:e,state:n,onError:i}){return N_(s,void 0,n,i,e)}function pT({to:s,replace:e,state:n,relative:i}){Ft(wo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=N.useContext(ws);Ps(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=N.useContext(ta),{pathname:d}=mr(),p=_o(),g=vg(s,yg(u),d,i==="path"),x=JSON.stringify(g);return N.useEffect(()=>{p(JSON.parse(x),{replace:e,state:n,relative:i})},[p,x,i,e,n]),null}function Ws(s){Ft(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function gT({basename:s="/",children:e=null,location:n,navigationType:i="POP",navigator:o,static:u=!1,unstable_useTransitions:d}){Ft(!wo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),g=N.useMemo(()=>({basename:p,navigator:o,static:u,unstable_useTransitions:d,future:{}}),[p,o,u,d]);typeof n=="string"&&(n=ol(n));let{pathname:x="/",search:y="",hash:_="",state:S=null,key:C="default"}=n,H=N.useMemo(()=>{let B=li(x,p);return B==null?null:{location:{pathname:B,search:y,hash:_,state:S,key:C},navigationType:i}},[p,x,y,_,S,C,i]);return Ps(H!=null,`<Router basename="${p}"> is not able to match the URL "${x}${y}${_}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:N.createElement(ws.Provider,{value:g},N.createElement(iu.Provider,{children:e,value:H}))}function xT({children:s,location:e}){return nT(Lp(s),e)}function Lp(s,e=[]){let n=[];return N.Children.forEach(s,(i,o)=>{if(!N.isValidElement(i))return;let u=[...e,o];if(i.type===N.Fragment){n.push.apply(n,Lp(i.props.children,u));return}Ft(i.type===Ws,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ft(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=Lp(i.props.children,u)),n.push(d)}),n}var Zd="get",eh="application/x-www-form-urlencoded";function Ph(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function bT(s){return Ph(s)&&s.tagName.toLowerCase()==="button"}function yT(s){return Ph(s)&&s.tagName.toLowerCase()==="form"}function vT(s){return Ph(s)&&s.tagName.toLowerCase()==="input"}function wT(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function _T(s,e){return s.button===0&&(!e||e==="_self")&&!wT(s)}var qd=null;function NT(){if(qd===null)try{new FormData(document.createElement("form"),0),qd=!1}catch{qd=!0}return qd}var ET=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function mp(s){return s!=null&&!ET.has(s)?(Ps(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${eh}"`),null):s}function ST(s,e){let n,i,o,u,d;if(yT(s)){let p=s.getAttribute("action");i=p?li(p,e):null,n=s.getAttribute("method")||Zd,o=mp(s.getAttribute("enctype"))||eh,u=new FormData(s)}else if(bT(s)||vT(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||p.getAttribute("action");if(i=g?li(g,e):null,n=s.getAttribute("formmethod")||p.getAttribute("method")||Zd,o=mp(s.getAttribute("formenctype"))||mp(p.getAttribute("enctype"))||eh,u=new FormData(p,s),!NT()){let{name:x,type:y,value:_}=s;if(y==="image"){let S=x?`${x}.`:"";u.append(`${S}x`,"0"),u.append(`${S}y`,"0")}else x&&u.append(x,_)}}else{if(Ph(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Zd,i=null,o=eh,d=s}return u&&o==="text/plain"&&(d=u,u=void 0),{action:i,method:n.toLowerCase(),encType:o,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Eg(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function TT(s,e,n,i){let o=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return n?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${i}`:o.pathname=`${o.pathname}.${i}`:o.pathname==="/"?o.pathname=`_root.${i}`:e&&li(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${i}`,o}async function jT(s,e){if(s.id in e)return e[s.id];try{let n=await import(s.module);return e[s.id]=n,n}catch(n){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function AT(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function CT(s,e,n){let i=await Promise.all(s.map(async o=>{let u=e.routes[o.route.id];if(u){let d=await jT(u,n);return d.links?d.links():[]}return[]}));return DT(i.flat(1).filter(AT).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function hv(s,e,n,i,o,u){let d=(g,x)=>n[x]?g.route.id!==n[x].route.id:!0,p=(g,x)=>n[x].pathname!==g.pathname||n[x].route.path?.endsWith("*")&&n[x].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,x)=>d(g,x)||p(g,x)):u==="data"?e.filter((g,x)=>{let y=i.routes[g.route.id];if(!y||!y.hasLoader)return!1;if(d(g,x)||p(g,x))return!0;if(g.route.shouldRevalidate){let _=g.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function RT(s,e,{includeHydrateFallback:n}={}){return kT(s.map(i=>{let o=e.routes[i.route.id];if(!o)return[];let u=[o.module];return o.clientActionModule&&(u=u.concat(o.clientActionModule)),o.clientLoaderModule&&(u=u.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(u=u.concat(o.hydrateFallbackModule)),o.imports&&(u=u.concat(o.imports)),u}).flat(1))}function kT(s){return[...new Set(s)]}function IT(s){let e={},n=Object.keys(s).sort();for(let i of n)e[i]=s[i];return e}function DT(s,e){let n=new Set;return new Set(e),s.reduce((i,o)=>{let u=JSON.stringify(IT(o));return n.has(u)||(n.add(u),i.push({key:u,link:o})),i},[])}function T_(){let s=N.useContext(vo);return Eg(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function MT(){let s=N.useContext(Vh);return Eg(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Sg=N.createContext(void 0);Sg.displayName="FrameworkContext";function j_(){let s=N.useContext(Sg);return Eg(s,"You must render this element inside a <HydratedRouter> element"),s}function OT(s,e){let n=N.useContext(Sg),[i,o]=N.useState(!1),[u,d]=N.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:x,onMouseLeave:y,onTouchStart:_}=e,S=N.useRef(null);N.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let B=q=>{q.forEach(Y=>{d(Y.isIntersecting)})},P=new IntersectionObserver(B,{threshold:.5});return S.current&&P.observe(S.current),()=>{P.disconnect()}}},[s]),N.useEffect(()=>{if(i){let B=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(B)}}},[i]);let C=()=>{o(!0)},H=()=>{o(!1),d(!1)};return n?s!=="intent"?[u,S,{}]:[u,S,{onFocus:Ac(p,C),onBlur:Ac(g,H),onMouseEnter:Ac(x,C),onMouseLeave:Ac(y,H),onTouchStart:Ac(_,C)}]:[!1,S,{}]}function Ac(s,e){return n=>{s&&s(n),n.defaultPrevented||e(n)}}function VT({page:s,...e}){let{router:n}=T_(),i=N.useMemo(()=>f_(n.routes,s,n.basename),[n.routes,s,n.basename]);return i?N.createElement(LT,{page:s,matches:i,...e}):null}function PT(s){let{manifest:e,routeModules:n}=j_(),[i,o]=N.useState([]);return N.useEffect(()=>{let u=!1;return CT(s,e,n).then(d=>{u||o(d)}),()=>{u=!0}},[s,e,n]),i}function LT({page:s,matches:e,...n}){let i=mr(),{future:o,manifest:u,routeModules:d}=j_(),{basename:p}=T_(),{loaderData:g,matches:x}=MT(),y=N.useMemo(()=>hv(s,e,x,u,i,"data"),[s,e,x,u,i]),_=N.useMemo(()=>hv(s,e,x,u,i,"assets"),[s,e,x,u,i]),S=N.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let B=new Set,P=!1;if(e.forEach(Y=>{let W=u.routes[Y.route.id];!W||!W.hasLoader||(!y.some(xe=>xe.route.id===Y.route.id)&&Y.route.id in g&&d[Y.route.id]?.shouldRevalidate||W.hasClientLoader?P=!0:B.add(Y.route.id))}),B.size===0)return[];let q=TT(s,p,o.unstable_trailingSlashAwareDataRequests,"data");return P&&B.size>0&&q.searchParams.set("_routes",e.filter(Y=>B.has(Y.route.id)).map(Y=>Y.route.id).join(",")),[q.pathname+q.search]},[p,o.unstable_trailingSlashAwareDataRequests,g,i,u,y,e,s,d]),C=N.useMemo(()=>RT(_,u),[_,u]),H=PT(_);return N.createElement(N.Fragment,null,S.map(B=>N.createElement("link",{key:B,rel:"prefetch",as:"fetch",href:B,...n})),C.map(B=>N.createElement("link",{key:B,rel:"modulepreload",href:B,...n})),H.map(({key:B,link:P})=>N.createElement("link",{key:B,nonce:n.nonce,...P,crossOrigin:P.crossOrigin??n.crossOrigin})))}function UT(...s){return e=>{s.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var BT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{BT&&(window.__reactRouterVersion="7.13.0")}catch{}function zT({basename:s,children:e,unstable_useTransitions:n,window:i}){let o=N.useRef();o.current==null&&(o.current=vS({window:i,v5Compat:!0}));let u=o.current,[d,p]=N.useState({action:u.action,location:u.location}),g=N.useCallback(x=>{n===!1?p(x):N.startTransition(()=>p(x))},[n]);return N.useLayoutEffect(()=>u.listen(g),[u,g]),N.createElement(gT,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:n})}var A_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,et=N.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:o,reloadDocument:u,replace:d,state:p,target:g,to:x,preventScrollReset:y,viewTransition:_,unstable_defaultShouldRevalidate:S,...C},H){let{basename:B,unstable_useTransitions:P}=N.useContext(ws),q=typeof x=="string"&&A_.test(x),Y=x_(x,B);x=Y.to;let W=eT(x,{relative:o}),[xe,me,re]=OT(i,C),j=$T(x,{replace:d,state:p,target:g,preventScrollReset:y,relative:o,viewTransition:_,unstable_defaultShouldRevalidate:S,unstable_useTransitions:P});function T(L){e&&e(L),L.defaultPrevented||j(L)}let k=N.createElement("a",{...C,...re,href:Y.absoluteURL||W,onClick:Y.isExternal||u?e:T,ref:UT(H,me),target:g,"data-discover":!q&&n==="render"?"true":void 0});return xe&&!q?N.createElement(N.Fragment,null,k,N.createElement(VT,{page:W})):k});et.displayName="Link";var qT=N.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:o=!1,style:u,to:d,viewTransition:p,children:g,...x},y){let _=ru(d,{relative:x.relative}),S=mr(),C=N.useContext(Vh),{navigator:H,basename:B}=N.useContext(ws),P=C!=null&&WT(_)&&p===!0,q=H.encodeLocation?H.encodeLocation(_).pathname:_.pathname,Y=S.pathname,W=C&&C.navigation&&C.navigation.location?C.navigation.location.pathname:null;n||(Y=Y.toLowerCase(),W=W?W.toLowerCase():null,q=q.toLowerCase()),W&&B&&(W=li(W,B)||W);const xe=q!=="/"&&q.endsWith("/")?q.length-1:q.length;let me=Y===q||!o&&Y.startsWith(q)&&Y.charAt(xe)==="/",re=W!=null&&(W===q||!o&&W.startsWith(q)&&W.charAt(q.length)==="/"),j={isActive:me,isPending:re,isTransitioning:P},T=me?e:void 0,k;typeof i=="function"?k=i(j):k=[i,me?"active":null,re?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let L=typeof u=="function"?u(j):u;return N.createElement(et,{...x,"aria-current":T,className:k,ref:y,style:L,to:d,viewTransition:p},typeof g=="function"?g(j):g)});qT.displayName="NavLink";var FT=N.forwardRef(({discover:s="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:o,state:u,method:d=Zd,action:p,onSubmit:g,relative:x,preventScrollReset:y,viewTransition:_,unstable_defaultShouldRevalidate:S,...C},H)=>{let{unstable_useTransitions:B}=N.useContext(ws),P=KT(),q=QT(p,{relative:x}),Y=d.toLowerCase()==="get"?"get":"post",W=typeof p=="string"&&A_.test(p),xe=me=>{if(g&&g(me),me.defaultPrevented)return;me.preventDefault();let re=me.nativeEvent.submitter,j=re?.getAttribute("formmethod")||d,T=()=>P(re||me.currentTarget,{fetcherKey:e,method:j,navigate:n,replace:o,state:u,relative:x,preventScrollReset:y,viewTransition:_,unstable_defaultShouldRevalidate:S});B&&n!==!1?N.startTransition(()=>T()):T()};return N.createElement("form",{ref:H,method:Y,action:q,onSubmit:i?g:xe,...C,"data-discover":!W&&s==="render"?"true":void 0})});FT.displayName="Form";function HT(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function C_(s){let e=N.useContext(vo);return Ft(e,HT(s)),e}function $T(s,{target:e,replace:n,state:i,preventScrollReset:o,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let x=_o(),y=mr(),_=ru(s,{relative:u});return N.useCallback(S=>{if(_T(S,e)){S.preventDefault();let C=n!==void 0?n:Yc(y)===Yc(_),H=()=>x(s,{replace:C,state:i,preventScrollReset:o,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?N.startTransition(()=>H()):H()}},[y,x,_,n,i,e,s,o,u,d,p,g])}var GT=0,YT=()=>`__${String(++GT)}__`;function KT(){let{router:s}=C_("useSubmit"),{basename:e}=N.useContext(ws),n=dT(),i=s.fetch,o=s.navigate;return N.useCallback(async(u,d={})=>{let{action:p,method:g,encType:x,formData:y,body:_}=ST(u,e);if(d.navigate===!1){let S=d.fetcherKey||YT();await i(S,n,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:y,body:_,formMethod:d.method||g,formEncType:d.encType||x,flushSync:d.flushSync})}else await o(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:y,body:_,formMethod:d.method||g,formEncType:d.encType||x,replace:d.replace,state:d.state,fromRouteId:n,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,o,e,n])}function QT(s,{relative:e}={}){let{basename:n}=N.useContext(ws),i=N.useContext(ta);Ft(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),u={...ru(s||".",{relative:e})},d=mr();if(s==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(y=>y==="")){p.delete("index"),g.filter(_=>_).forEach(_=>p.append("index",_));let y=p.toString();u.search=y?`?${y}`:""}}return(!s||s===".")&&o.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(u.pathname=u.pathname==="/"?n:ai([n,u.pathname])),Yc(u)}function WT(s,{relative:e}={}){let n=N.useContext(y_);Ft(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=C_("useViewTransitionState"),o=ru(s,{relative:e});if(!n.isTransitioning)return!1;let u=li(n.currentLocation.pathname,i)||n.currentLocation.pathname,d=li(n.nextLocation.pathname,i)||n.nextLocation.pathname;return fh(o.pathname,d)!=null||fh(o.pathname,u)!=null}const XT=()=>{};var fv={};const R_=function(s){const e=[];let n=0;for(let i=0;i<s.length;i++){let o=s.charCodeAt(i);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(s.charCodeAt(++i)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},JT=function(s){const e=[];let n=0,i=0;for(;n<s.length;){const o=s[n++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const u=s[n++];e[i++]=String.fromCharCode((o&31)<<6|u&63)}else if(o>239&&o<365){const u=s[n++],d=s[n++],p=s[n++],g=((o&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=s[n++],d=s[n++];e[i++]=String.fromCharCode((o&15)<<12|(u&63)<<6|d&63)}}return e.join("")},k_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<s.length;o+=3){const u=s[o],d=o+1<s.length,p=d?s[o+1]:0,g=o+2<s.length,x=g?s[o+2]:0,y=u>>2,_=(u&3)<<4|p>>4;let S=(p&15)<<2|x>>6,C=x&63;g||(C=64,d||(S=64)),i.push(n[y],n[_],n[S],n[C])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(R_(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):JT(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<s.length;){const u=n[s.charAt(o++)],p=o<s.length?n[s.charAt(o)]:0;++o;const x=o<s.length?n[s.charAt(o)]:64;++o;const _=o<s.length?n[s.charAt(o)]:64;if(++o,u==null||p==null||x==null||_==null)throw new ZT;const S=u<<2|p>>4;if(i.push(S),x!==64){const C=p<<4&240|x>>2;if(i.push(C),_!==64){const H=x<<6&192|_;i.push(H)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class ZT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ej=function(s){const e=R_(s);return k_.encodeByteArray(e,!0)},mh=function(s){return ej(s).replace(/\./g,"")},I_=function(s){try{return k_.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function tj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const nj=()=>tj().__FIREBASE_DEFAULTS__,sj=()=>{if(typeof process>"u"||typeof fv>"u")return;const s=fv.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},aj=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&I_(s[1]);return e&&JSON.parse(e)},Lh=()=>{try{return XT()||nj()||sj()||aj()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},D_=s=>Lh()?.emulatorHosts?.[s],M_=s=>{const e=D_(s);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},O_=()=>Lh()?.config,V_=s=>Lh()?.[`_${s}`];class ij{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function pr(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Tg(s){return(await fetch(s,{credentials:"include"})).ok}function P_(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",o=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[mh(JSON.stringify(n)),mh(JSON.stringify(d)),""].join(".")}const Uc={};function rj(){const s={prod:[],emulator:[]};for(const e of Object.keys(Uc))Uc[e]?s.emulator.push(e):s.prod.push(e);return s}function lj(s){let e=document.getElementById(s),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),n=!0),{created:n,element:e}}let mv=!1;function jg(s,e){if(typeof window>"u"||typeof document>"u"||!pr(window.location.host)||Uc[s]===e||Uc[s]||mv)return;Uc[s]=e;function n(S){return`__firebase__banner__${S}`}const i="__firebase__banner",u=rj().prod.length>0;function d(){const S=document.getElementById(i);S&&S.remove()}function p(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function g(S,C){S.setAttribute("width","24"),S.setAttribute("id",C),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function x(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{mv=!0,d()},S}function y(S,C){S.setAttribute("id",C),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function _(){const S=lj(i),C=n("text"),H=document.getElementById(C)||document.createElement("span"),B=n("learnmore"),P=document.getElementById(B)||document.createElement("a"),q=n("preprendIcon"),Y=document.getElementById(q)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const W=S.element;p(W),y(P,B);const xe=x();g(Y,q),W.append(Y,H,P,xe),document.body.appendChild(W)}u?(H.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,H.innerText="Preview backend running in this workspace."),H.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function zn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zn())}function cj(){const s=Lh()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function dj(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function hj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fj(){const s=zn();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function mj(){return!cj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pj(){try{return typeof indexedDB=="object"}catch{return!1}}function gj(){return new Promise((s,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(i),s(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(n){e(n)}})}const xj="FirebaseError";class Ma extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=xj,Object.setPrototypeOf(this,Ma.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lu.prototype.create)}}class lu{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},o=`${this.service}/${e}`,u=this.errors[e],d=u?bj(u,i):"Error",p=`${this.serviceName}: ${d} (${o}).`;return new Ma(o,p,i)}}function bj(s,e){return s.replace(yj,(n,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const yj=/\{\$([^}]+)}/g;function vj(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Jr(s,e){if(s===e)return!0;const n=Object.keys(s),i=Object.keys(e);for(const o of n){if(!i.includes(o))return!1;const u=s[o],d=e[o];if(pv(u)&&pv(d)){if(!Jr(u,d))return!1}else if(u!==d)return!1}for(const o of i)if(!n.includes(o))return!1;return!0}function pv(s){return s!==null&&typeof s=="object"}function ou(s){const e=[];for(const[n,i]of Object.entries(s))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Ic(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,u]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(u)}}),e}function Dc(s){const e=s.indexOf("?");if(!e)return"";const n=s.indexOf("#",e);return s.substring(e,n>0?n:void 0)}function wj(s,e){const n=new _j(s,e);return n.subscribe.bind(n)}class _j{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let o;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");Nj(e,["next","error","complete"])?o=e:o={next:e,error:n,complete:i},o.next===void 0&&(o.next=pp),o.error===void 0&&(o.error=pp),o.complete===void 0&&(o.complete=pp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Nj(s,e){if(typeof s!="object"||s===null)return!1;for(const n of e)if(n in s&&typeof s[n]=="function")return!0;return!1}function pp(){}function Ht(s){return s&&s._delegate?s._delegate:s}class rr{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Yr="[DEFAULT]";class Ej{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new ij;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:n});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Tj(e))try{this.getOrInitializeService({instanceIdentifier:Yr})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(n);try{const u=this.getOrInitializeService({instanceIdentifier:o});i.resolve(u)}catch{}}}}clearInstance(e=Yr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yr){return this.instances.has(e)}getOptions(e=Yr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(o)}return o}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const u=this.instances.get(i);return u&&e(u,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const o of i)try{o(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Sj(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Yr){return this.component?this.component.multipleInstances?e:Yr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Sj(s){return s===Yr?void 0:s}function Tj(s){return s.instantiationMode==="EAGER"}class jj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Ej(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var ft;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(ft||(ft={}));const Aj={debug:ft.DEBUG,verbose:ft.VERBOSE,info:ft.INFO,warn:ft.WARN,error:ft.ERROR,silent:ft.SILENT},Cj=ft.INFO,Rj={[ft.DEBUG]:"log",[ft.VERBOSE]:"log",[ft.INFO]:"info",[ft.WARN]:"warn",[ft.ERROR]:"error"},kj=(s,e,...n)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),o=Rj[e];if(o)console[o](`[${i}]  ${s.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ag{constructor(e){this.name=e,this._logLevel=Cj,this._logHandler=kj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ft))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Aj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ft.DEBUG,...e),this._logHandler(this,ft.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ft.VERBOSE,...e),this._logHandler(this,ft.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ft.INFO,...e),this._logHandler(this,ft.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ft.WARN,...e),this._logHandler(this,ft.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ft.ERROR,...e),this._logHandler(this,ft.ERROR,...e)}}const Ij=(s,e)=>e.some(n=>s instanceof n);let gv,xv;function Dj(){return gv||(gv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mj(){return xv||(xv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const L_=new WeakMap,Up=new WeakMap,U_=new WeakMap,gp=new WeakMap,Cg=new WeakMap;function Oj(s){const e=new Promise((n,i)=>{const o=()=>{s.removeEventListener("success",u),s.removeEventListener("error",d)},u=()=>{n(er(s.result)),o()},d=()=>{i(s.error),o()};s.addEventListener("success",u),s.addEventListener("error",d)});return e.then(n=>{n instanceof IDBCursor&&L_.set(n,s)}).catch(()=>{}),Cg.set(e,s),e}function Vj(s){if(Up.has(s))return;const e=new Promise((n,i)=>{const o=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",d),s.removeEventListener("abort",d)},u=()=>{n(),o()},d=()=>{i(s.error||new DOMException("AbortError","AbortError")),o()};s.addEventListener("complete",u),s.addEventListener("error",d),s.addEventListener("abort",d)});Up.set(s,e)}let Bp={get(s,e,n){if(s instanceof IDBTransaction){if(e==="done")return Up.get(s);if(e==="objectStoreNames")return s.objectStoreNames||U_.get(s);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return er(s[e])},set(s,e,n){return s[e]=n,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function Pj(s){Bp=s(Bp)}function Lj(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=s.call(xp(this),e,...n);return U_.set(i,e.sort?e.sort():[e]),er(i)}:Mj().includes(s)?function(...e){return s.apply(xp(this),e),er(L_.get(this))}:function(...e){return er(s.apply(xp(this),e))}}function Uj(s){return typeof s=="function"?Lj(s):(s instanceof IDBTransaction&&Vj(s),Ij(s,Dj())?new Proxy(s,Bp):s)}function er(s){if(s instanceof IDBRequest)return Oj(s);if(gp.has(s))return gp.get(s);const e=Uj(s);return e!==s&&(gp.set(s,e),Cg.set(e,s)),e}const xp=s=>Cg.get(s);function Bj(s,e,{blocked:n,upgrade:i,blocking:o,terminated:u}={}){const d=indexedDB.open(s,e),p=er(d);return i&&d.addEventListener("upgradeneeded",g=>{i(er(d.result),g.oldVersion,g.newVersion,er(d.transaction),g)}),n&&d.addEventListener("blocked",g=>n(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),o&&g.addEventListener("versionchange",x=>o(x.oldVersion,x.newVersion,x))}).catch(()=>{}),p}const zj=["get","getKey","getAll","getAllKeys","count"],qj=["put","add","delete","clear"],bp=new Map;function bv(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(bp.get(e))return bp.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,o=qj.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(o||zj.includes(n)))return;const u=async function(d,...p){const g=this.transaction(d,o?"readwrite":"readonly");let x=g.store;return i&&(x=x.index(p.shift())),(await Promise.all([x[n](...p),o&&g.done]))[0]};return bp.set(e,u),u}Pj(s=>({...s,get:(e,n,i)=>bv(e,n)||s.get(e,n,i),has:(e,n)=>!!bv(e,n)||s.has(e,n)}));class Fj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Hj(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function Hj(s){return s.getComponent()?.type==="VERSION"}const zp="@firebase/app",yv="0.14.7";const oi=new Ag("@firebase/app"),$j="@firebase/app-compat",Gj="@firebase/analytics-compat",Yj="@firebase/analytics",Kj="@firebase/app-check-compat",Qj="@firebase/app-check",Wj="@firebase/auth",Xj="@firebase/auth-compat",Jj="@firebase/database",Zj="@firebase/data-connect",eA="@firebase/database-compat",tA="@firebase/functions",nA="@firebase/functions-compat",sA="@firebase/installations",aA="@firebase/installations-compat",iA="@firebase/messaging",rA="@firebase/messaging-compat",lA="@firebase/performance",oA="@firebase/performance-compat",cA="@firebase/remote-config",uA="@firebase/remote-config-compat",dA="@firebase/storage",hA="@firebase/storage-compat",fA="@firebase/firestore",mA="@firebase/ai",pA="@firebase/firestore-compat",gA="firebase",xA="12.8.0";const qp="[DEFAULT]",bA={[zp]:"fire-core",[$j]:"fire-core-compat",[Yj]:"fire-analytics",[Gj]:"fire-analytics-compat",[Qj]:"fire-app-check",[Kj]:"fire-app-check-compat",[Wj]:"fire-auth",[Xj]:"fire-auth-compat",[Jj]:"fire-rtdb",[Zj]:"fire-data-connect",[eA]:"fire-rtdb-compat",[tA]:"fire-fn",[nA]:"fire-fn-compat",[sA]:"fire-iid",[aA]:"fire-iid-compat",[iA]:"fire-fcm",[rA]:"fire-fcm-compat",[lA]:"fire-perf",[oA]:"fire-perf-compat",[cA]:"fire-rc",[uA]:"fire-rc-compat",[dA]:"fire-gcs",[hA]:"fire-gcs-compat",[fA]:"fire-fst",[pA]:"fire-fst-compat",[mA]:"fire-vertex","fire-js":"fire-js",[gA]:"fire-js-all"};const ph=new Map,yA=new Map,Fp=new Map;function vv(s,e){try{s.container.addComponent(e)}catch(n){oi.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,n)}}function Zr(s){const e=s.name;if(Fp.has(e))return oi.debug(`There were multiple attempts to register component ${e}.`),!1;Fp.set(e,s);for(const n of ph.values())vv(n,s);for(const n of yA.values())vv(n,s);return!0}function Uh(s,e){const n=s.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),s.container.getProvider(e)}function ps(s){return s==null?!1:s.settings!==void 0}const vA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},tr=new lu("app","Firebase",vA);class wA{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new rr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw tr.create("app-deleted",{appName:this._name})}}const cl=xA;function B_(s,e={}){let n=s;typeof e!="object"&&(e={name:e});const i={name:qp,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw tr.create("bad-app-name",{appName:String(o)});if(n||(n=O_()),!n)throw tr.create("no-options");const u=ph.get(o);if(u){if(Jr(n,u.options)&&Jr(i,u.config))return u;throw tr.create("duplicate-app",{appName:o})}const d=new jj(o);for(const g of Fp.values())d.addComponent(g);const p=new wA(n,i,d);return ph.set(o,p),p}function Rg(s=qp){const e=ph.get(s);if(!e&&s===qp&&O_())return B_();if(!e)throw tr.create("no-app",{appName:s});return e}function Ea(s,e,n){let i=bA[s]??s;n&&(i+=`-${n}`);const o=i.match(/\s|\//),u=e.match(/\s|\//);if(o||u){const d=[`Unable to register library "${i}" with version "${e}":`];o&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),oi.warn(d.join(" "));return}Zr(new rr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const _A="firebase-heartbeat-database",NA=1,Kc="firebase-heartbeat-store";let yp=null;function z_(){return yp||(yp=Bj(_A,NA,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(Kc)}catch(n){console.warn(n)}}}}).catch(s=>{throw tr.create("idb-open",{originalErrorMessage:s.message})})),yp}async function EA(s){try{const n=(await z_()).transaction(Kc),i=await n.objectStore(Kc).get(q_(s));return await n.done,i}catch(e){if(e instanceof Ma)oi.warn(e.message);else{const n=tr.create("idb-get",{originalErrorMessage:e?.message});oi.warn(n.message)}}}async function wv(s,e){try{const i=(await z_()).transaction(Kc,"readwrite");await i.objectStore(Kc).put(e,q_(s)),await i.done}catch(n){if(n instanceof Ma)oi.warn(n.message);else{const i=tr.create("idb-set",{originalErrorMessage:n?.message});oi.warn(i.message)}}}function q_(s){return`${s.name}!${s.options.appId}`}const SA=1024,TA=30;class jA{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new CA(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=_v();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>TA){const o=RA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){oi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=_v(),{heartbeatsToSend:n,unsentEntries:i}=AA(this._heartbeatsCache.heartbeats),o=mh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return oi.warn(e),""}}}function _v(){return new Date().toISOString().substring(0,10)}function AA(s,e=SA){const n=[];let i=s.slice();for(const o of s){const u=n.find(d=>d.agent===o.agent);if(u){if(u.dates.push(o.date),Nv(n)>e){u.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),Nv(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class CA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pj()?gj().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await EA(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return wv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return wv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Nv(s){return mh(JSON.stringify({version:2,heartbeats:s})).length}function RA(s){if(s.length===0)return-1;let e=0,n=s[0].date;for(let i=1;i<s.length;i++)s[i].date<n&&(n=s[i].date,e=i);return e}function kA(s){Zr(new rr("platform-logger",e=>new Fj(e),"PRIVATE")),Zr(new rr("heartbeat",e=>new jA(e),"PRIVATE")),Ea(zp,yv,s),Ea(zp,yv,"esm2020"),Ea("fire-js","")}kA("");function F_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const IA=F_,H_=new lu("auth","Firebase",F_());const gh=new Ag("@firebase/auth");function DA(s,...e){gh.logLevel<=ft.WARN&&gh.warn(`Auth (${cl}): ${s}`,...e)}function th(s,...e){gh.logLevel<=ft.ERROR&&gh.error(`Auth (${cl}): ${s}`,...e)}function Zs(s,...e){throw kg(s,...e)}function Sa(s,...e){return kg(s,...e)}function $_(s,e,n){const i={...IA(),[e]:n};return new lu("auth","Firebase",i).create(e,{appName:s.name})}function ii(s){return $_(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kg(s,...e){if(typeof s!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(n,...i)}return H_.create(s,...e)}function Ye(s,e,...n){if(!s)throw kg(e,...n)}function ni(s){const e="INTERNAL ASSERTION FAILED: "+s;throw th(e),new Error(e)}function ci(s,e){s||ni(e)}function Hp(){return typeof self<"u"&&self.location?.href||""}function MA(){return Ev()==="http:"||Ev()==="https:"}function Ev(){return typeof self<"u"&&self.location?.protocol||null}function OA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(MA()||dj()||"connection"in navigator)?navigator.onLine:!0}function VA(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class cu{constructor(e,n){this.shortDelay=e,this.longDelay=n,ci(n>e,"Short delay should be less than long delay!"),this.isMobile=oj()||hj()}get(){return OA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ig(s,e){ci(s.emulator,"Emulator should always be set here");const{url:n}=s.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class G_{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const PA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const LA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],UA=new cu(3e4,6e4);function gr(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function xr(s,e,n,i,o={}){return Y_(s,o,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=ou({key:s.config.apiKey,...d}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const x={method:e,headers:g,...u};return uj()||(x.referrerPolicy="no-referrer"),s.emulatorConfig&&pr(s.emulatorConfig.host)&&(x.credentials="include"),G_.fetch()(await K_(s,s.config.apiHost,n,p),x)})}async function Y_(s,e,n){s._canInitEmulator=!1;const i={...PA,...e};try{const o=new zA(s),u=await Promise.race([n(),o.promise]);o.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw Fd(s,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,x]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Fd(s,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw Fd(s,"email-already-in-use",d);if(g==="USER_DISABLED")throw Fd(s,"user-disabled",d);const y=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(x)throw $_(s,y,x);Zs(s,y)}}catch(o){if(o instanceof Ma)throw o;Zs(s,"network-request-failed",{message:String(o)})}}async function uu(s,e,n,i,o={}){const u=await xr(s,e,n,i,o);return"mfaPendingCredential"in u&&Zs(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function K_(s,e,n,i){const o=`${e}${n}?${i}`,u=s,d=u.config.emulator?Ig(s.config,o):`${s.config.apiScheme}://${o}`;return LA.includes(n)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function BA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(Sa(this.auth,"network-request-failed")),UA.get())})}}function Fd(s,e,n){const i={appName:s.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const o=Sa(s,e,i);return o.customData._tokenResponse=n,o}function Sv(s){return s!==void 0&&s.enterprise!==void 0}class qA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return BA(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function FA(s,e){return xr(s,"GET","/v2/recaptchaConfig",gr(s,e))}async function HA(s,e){return xr(s,"POST","/v1/accounts:delete",e)}async function xh(s,e){return xr(s,"POST","/v1/accounts:lookup",e)}function Bc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function $A(s,e=!1){const n=Ht(s),i=await n.getIdToken(e),o=Dg(i);Ye(o&&o.exp&&o.auth_time&&o.iat,n.auth,"internal-error");const u=typeof o.firebase=="object"?o.firebase:void 0,d=u?.sign_in_provider;return{claims:o,token:i,authTime:Bc(vp(o.auth_time)),issuedAtTime:Bc(vp(o.iat)),expirationTime:Bc(vp(o.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function vp(s){return Number(s)*1e3}function Dg(s){const[e,n,i]=s.split(".");if(e===void 0||n===void 0||i===void 0)return th("JWT malformed, contained fewer than 3 sections"),null;try{const o=I_(n);return o?JSON.parse(o):(th("Failed to decode base64 JWT payload"),null)}catch(o){return th("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Tv(s){const e=Dg(s);return Ye(e,"internal-error"),Ye(typeof e.exp<"u","internal-error"),Ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Qc(s,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Ma&&GA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function GA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class YA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class $p{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bc(this.lastLoginAt),this.creationTime=Bc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function bh(s){const e=s.auth,n=await s.getIdToken(),i=await Qc(s,xh(e,{idToken:n}));Ye(i?.users.length,e,"internal-error");const o=i.users[0];s._notifyReloadListener(o);const u=o.providerUserInfo?.length?Q_(o.providerUserInfo):[],d=QA(s.providerData,u),p=s.isAnonymous,g=!(s.email&&o.passwordHash)&&!d?.length,x=p?g:!1,y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new $p(o.createdAt,o.lastLoginAt),isAnonymous:x};Object.assign(s,y)}async function KA(s){const e=Ht(s);await bh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function QA(s,e){return[...s.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function Q_(s){return s.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function WA(s,e){const n=await Y_(s,{},async()=>{const i=ou({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:u}=s.config,d=await K_(s,o,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return s.emulatorConfig&&pr(s.emulatorConfig.host)&&(g.credentials="include"),G_.fetch()(d,g)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function XA(s,e){return xr(s,"POST","/v2/accounts:revokeToken",gr(s,e))}class lo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ye(e.idToken,"internal-error"),Ye(typeof e.idToken<"u","internal-error"),Ye(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Tv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ye(e.length!==0,"internal-error");const n=Tv(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:o,expiresIn:u}=await WA(e,n);this.updateTokensAndExpiration(i,o,Number(u))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:o,expirationTime:u}=n,d=new lo;return i&&(Ye(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),o&&(Ye(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),u&&(Ye(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new lo,this.toJSON())}_performRefresh(){return ni("not implemented")}}function Yi(s,e){Ye(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Xs{constructor({uid:e,auth:n,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new YA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new $p(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await Qc(this,this.stsTokenManager.getToken(this.auth,e));return Ye(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return $A(this,e)}reload(){return KA(this)}_assign(e){this!==e&&(Ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Xs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await bh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ps(this.auth.app))return Promise.reject(ii(this.auth));const e=await this.getIdToken();return await Qc(this,HA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,o=n.email??void 0,u=n.phoneNumber??void 0,d=n.photoURL??void 0,p=n.tenantId??void 0,g=n._redirectEventId??void 0,x=n.createdAt??void 0,y=n.lastLoginAt??void 0,{uid:_,emailVerified:S,isAnonymous:C,providerData:H,stsTokenManager:B}=n;Ye(_&&B,e,"internal-error");const P=lo.fromJSON(this.name,B);Ye(typeof _=="string",e,"internal-error"),Yi(i,e.name),Yi(o,e.name),Ye(typeof S=="boolean",e,"internal-error"),Ye(typeof C=="boolean",e,"internal-error"),Yi(u,e.name),Yi(d,e.name),Yi(p,e.name),Yi(g,e.name),Yi(x,e.name),Yi(y,e.name);const q=new Xs({uid:_,auth:e,email:o,emailVerified:S,displayName:i,isAnonymous:C,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:P,createdAt:x,lastLoginAt:y});return H&&Array.isArray(H)&&(q.providerData=H.map(Y=>({...Y}))),g&&(q._redirectEventId=g),q}static async _fromIdTokenResponse(e,n,i=!1){const o=new lo;o.updateFromServerResponse(n);const u=new Xs({uid:n.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await bh(u),u}static async _fromGetAccountInfoResponse(e,n,i){const o=n.users[0];Ye(o.localId!==void 0,"internal-error");const u=o.providerUserInfo!==void 0?Q_(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!u?.length,p=new lo;p.updateFromIdToken(i);const g=new Xs({uid:o.localId,auth:e,stsTokenManager:p,isAnonymous:d}),x={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new $p(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!u?.length};return Object.assign(g,x),g}}const jv=new Map;function si(s){ci(s instanceof Function,"Expected a class definition");let e=jv.get(s);return e?(ci(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,jv.set(s,e),e)}class W_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}W_.type="NONE";const Av=W_;function nh(s,e,n){return`firebase:${s}:${e}:${n}`}class oo{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:o,name:u}=this.auth;this.fullUserKey=nh(this.userKey,o.apiKey,u),this.fullPersistenceKey=nh("persistence",o.apiKey,u),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await xh(this.auth,{idToken:e}).catch(()=>{});return n?Xs._fromGetAccountInfoResponse(this.auth,n,e):null}return Xs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new oo(si(Av),e,i);const o=(await Promise.all(n.map(async x=>{if(await x._isAvailable())return x}))).filter(x=>x);let u=o[0]||si(Av);const d=nh(i,e.config.apiKey,e.name);let p=null;for(const x of n)try{const y=await x._get(d);if(y){let _;if(typeof y=="string"){const S=await xh(e,{idToken:y}).catch(()=>{});if(!S)break;_=await Xs._fromGetAccountInfoResponse(e,S,y)}else _=Xs._fromJSON(e,y);x!==u&&(p=_),u=x;break}}catch{}const g=o.filter(x=>x._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new oo(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(n.map(async x=>{if(x!==u)try{await x._remove(d)}catch{}})),new oo(u,e,i))}}function Cv(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(e1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(X_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(n1(e))return"Blackberry";if(s1(e))return"Webos";if(J_(e))return"Safari";if((e.includes("chrome/")||Z_(e))&&!e.includes("edge/"))return"Chrome";if(t1(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(n);if(i?.length===2)return i[1]}return"Other"}function X_(s=zn()){return/firefox\//i.test(s)}function J_(s=zn()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Z_(s=zn()){return/crios\//i.test(s)}function e1(s=zn()){return/iemobile/i.test(s)}function t1(s=zn()){return/android/i.test(s)}function n1(s=zn()){return/blackberry/i.test(s)}function s1(s=zn()){return/webos/i.test(s)}function Mg(s=zn()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function JA(s=zn()){return Mg(s)&&!!window.navigator?.standalone}function ZA(){return fj()&&document.documentMode===10}function a1(s=zn()){return Mg(s)||t1(s)||s1(s)||n1(s)||/windows phone/i.test(s)||e1(s)}function i1(s,e=[]){let n;switch(s){case"Browser":n=Cv(zn());break;case"Worker":n=`${Cv(zn())}-${s}`;break;default:n=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${cl}/${i}`}class e5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=n,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const o of n)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function t5(s,e={}){return xr(s,"GET","/v2/passwordPolicy",gr(s,e))}const n5=6;class s5{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??n5,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),o&&(n.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,o,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class a5{constructor(e,n,i,o){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Rv(this),this.idTokenSubscription=new Rv(this),this.beforeStateQueue=new e5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=H_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=si(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await oo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await xh(this,{idToken:e}),i=await Xs._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ps(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await bh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=VA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ps(this.app))return Promise.reject(ii(this));const n=e?Ht(e):null;return n&&Ye(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ps(this.app)?Promise.reject(ii(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ps(this.app)?Promise.reject(ii(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(si(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await t5(this),n=new s5(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lu("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await XA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&si(e)||this._popupRedirectResolver;Ye(n,this,"argument-error"),this.redirectPersistenceManager=await oo.create(this,[si(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,o){if(this._deleted)return()=>{};const u=typeof n=="function"?n:n.next.bind(n);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ye(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof n=="function"){const g=e.addObserver(n,i,o);return()=>{d=!0,g()}}else{const g=e.addObserver(n);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=i1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(ps(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&DA(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ul(s){return Ht(s)}class Rv{constructor(e){this.auth=e,this.observer=null,this.addObserver=wj(n=>this.observer=n)}get next(){return Ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Bh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function i5(s){Bh=s}function r1(s){return Bh.loadJS(s)}function r5(){return Bh.recaptchaEnterpriseScript}function l5(){return Bh.gapiScript}function o5(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class c5{constructor(){this.enterprise=new u5}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class u5{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const d5="recaptcha-enterprise",l1="NO_RECAPTCHA";class h5{constructor(e){this.type=d5,this.auth=ul(e)}async verify(e="verify",n=!1){async function i(u){if(!n){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{FA(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const x=new qA(g);return u.tenantId==null?u._agentRecaptchaConfig=x:u._tenantRecaptchaConfigs[u.tenantId]=x,d(x.siteKey)}}).catch(g=>{p(g)})})}function o(u,d,p){const g=window.grecaptcha;Sv(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(x=>{d(x)}).catch(()=>{d(l1)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new c5().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!n&&Sv(window.grecaptcha))o(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=r5();g.length!==0&&(g+=p),r1(g).then(()=>{o(p,u,d)}).catch(x=>{d(x)})}}).catch(p=>{d(p)})})}}async function kv(s,e,n,i=!1,o=!1){const u=new h5(s);let d;if(o)d=l1;else try{d=await u.verify(n)}catch{d=await u.verify(n,!0)}const p={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,x=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:x,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Gp(s,e,n,i,o){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await kv(s,e,n,n==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await kv(s,e,n,n==="getOobCode");return i(s,d)}else return Promise.reject(u)})}function f5(s,e){const n=Uh(s,"auth");if(n.isInitialized()){const o=n.getImmediate(),u=n.getOptions();if(Jr(u,e??{}))return o;Zs(o,"already-initialized")}return n.initialize({options:e})}function m5(s,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(si);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function p5(s,e,n){const i=ul(s);Ye(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,u=o1(e),{host:d,port:p}=g5(e),g=p===null?"":`:${p}`,x={url:`${u}//${d}${g}/`},y=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){Ye(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ye(Jr(x,i.config.emulator)&&Jr(y,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=x,i.emulatorConfig=y,i.settings.appVerificationDisabledForTesting=!0,pr(d)?(Tg(`${u}//${d}${g}`),jg("Auth",!0)):x5()}function o1(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function g5(s){const e=o1(s),n=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const u=o[1];return{host:u,port:Iv(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:Iv(d)}}}function Iv(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function x5(){function s(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class Og{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ni("not implemented")}_getIdTokenResponse(e){return ni("not implemented")}_linkToIdToken(e,n){return ni("not implemented")}_getReauthenticationResolver(e){return ni("not implemented")}}async function b5(s,e){return xr(s,"POST","/v1/accounts:signUp",e)}async function y5(s,e){return uu(s,"POST","/v1/accounts:signInWithPassword",gr(s,e))}async function v5(s,e){return uu(s,"POST","/v1/accounts:signInWithEmailLink",gr(s,e))}async function w5(s,e){return uu(s,"POST","/v1/accounts:signInWithEmailLink",gr(s,e))}class Wc extends Og{constructor(e,n,i,o=null){super("password",i),this._email=e,this._password=n,this._tenantId=o}static _fromEmailAndPassword(e,n){return new Wc(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new Wc(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Gp(e,n,"signInWithPassword",y5);case"emailLink":return v5(e,{email:this._email,oobCode:this._password});default:Zs(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Gp(e,i,"signUpPassword",b5);case"emailLink":return w5(e,{idToken:n,email:this._email,oobCode:this._password});default:Zs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function co(s,e){return uu(s,"POST","/v1/accounts:signInWithIdp",gr(s,e))}const _5="http://localhost";class el extends Og{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new el(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Zs("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...u}=n;if(!i||!o)return null;const d=new el(i,o);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const n=this.buildRequest();return co(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,co(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,co(e,n)}buildRequest(){const e={requestUri:_5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ou(n)}return e}}function N5(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function E5(s){const e=Ic(Dc(s)).link,n=e?Ic(Dc(e)).deep_link_id:null,i=Ic(Dc(s)).deep_link_id;return(i?Ic(Dc(i)).link:null)||i||n||e||s}class Vg{constructor(e){const n=Ic(Dc(e)),i=n.apiKey??null,o=n.oobCode??null,u=N5(n.mode??null);Ye(i&&o&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=o,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=E5(e);try{return new Vg(n)}catch{return null}}}class Eo{constructor(){this.providerId=Eo.PROVIDER_ID}static credential(e,n){return Wc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Vg.parseLink(n);return Ye(i,"argument-error"),Wc._fromEmailAndCode(e,i.code,i.tenantId)}}Eo.PROVIDER_ID="password";Eo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Eo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class c1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class du extends c1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ki extends du{constructor(){super("facebook.com")}static credential(e){return el._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ki.credential(e.oauthAccessToken)}catch{return null}}}Ki.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ki.PROVIDER_ID="facebook.com";class Qi extends du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return el._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return Qi.credential(n,i)}catch{return null}}}Qi.GOOGLE_SIGN_IN_METHOD="google.com";Qi.PROVIDER_ID="google.com";class Wi extends du{constructor(){super("github.com")}static credential(e){return el._fromParams({providerId:Wi.PROVIDER_ID,signInMethod:Wi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wi.credentialFromTaggedObject(e)}static credentialFromError(e){return Wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wi.credential(e.oauthAccessToken)}catch{return null}}}Wi.GITHUB_SIGN_IN_METHOD="github.com";Wi.PROVIDER_ID="github.com";class Xi extends du{constructor(){super("twitter.com")}static credential(e,n){return el._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Xi.credential(n,i)}catch{return null}}}Xi.TWITTER_SIGN_IN_METHOD="twitter.com";Xi.PROVIDER_ID="twitter.com";async function S5(s,e){return uu(s,"POST","/v1/accounts:signUp",gr(s,e))}class tl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,o=!1){const u=await Xs._fromIdTokenResponse(e,i,o),d=Dv(i);return new tl({user:u,providerId:d,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const o=Dv(i);return new tl({user:e,providerId:o,_tokenResponse:i,operationType:n})}}function Dv(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class yh extends Ma{constructor(e,n,i,o){super(n.code,n.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,yh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,o){return new yh(e,n,i,o)}}function u1(s,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(s):n._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?yh._fromErrorAndOperation(s,u,e,i):u})}async function T5(s,e,n=!1){const i=await Qc(s,e._linkToIdToken(s.auth,await s.getIdToken()),n);return tl._forOperation(s,"link",i)}async function j5(s,e,n=!1){const{auth:i}=s;if(ps(i.app))return Promise.reject(ii(i));const o="reauthenticate";try{const u=await Qc(s,u1(i,o,e,s),n);Ye(u.idToken,i,"internal-error");const d=Dg(u.idToken);Ye(d,i,"internal-error");const{sub:p}=d;return Ye(s.uid===p,i,"user-mismatch"),tl._forOperation(s,o,u)}catch(u){throw u?.code==="auth/user-not-found"&&Zs(i,"user-mismatch"),u}}async function d1(s,e,n=!1){if(ps(s.app))return Promise.reject(ii(s));const i="signIn",o=await u1(s,i,e),u=await tl._fromIdTokenResponse(s,i,o);return n||await s._updateCurrentUser(u.user),u}async function A5(s,e){return d1(ul(s),e)}async function h1(s){const e=ul(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function C5(s,e,n){if(ps(s.app))return Promise.reject(ii(s));const i=ul(s),d=await Gp(i,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",S5).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&h1(s),g}),p=await tl._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function f1(s,e,n){return ps(s.app)?Promise.reject(ii(s)):A5(Ht(s),Eo.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&h1(s),i})}function R5(s,e,n,i){return Ht(s).onIdTokenChanged(e,n,i)}function k5(s,e,n){return Ht(s).beforeAuthStateChanged(e,n)}function I5(s,e,n,i){return Ht(s).onAuthStateChanged(e,n,i)}function D5(s){return Ht(s).signOut()}const vh="__sak";class m1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(vh,"1"),this.storage.removeItem(vh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const M5=1e3,O5=10;class p1 extends m1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=a1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),o=this.localCache[n];i!==o&&e(n,o,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;n?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(i);!n&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);ZA()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,O5):o()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},M5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}p1.type="LOCAL";const V5=p1;class g1 extends m1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}g1.type="SESSION";const x1=g1;function P5(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class zh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(o=>o.isListeningto(e));if(n)return n;const i=new zh(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:o,data:u}=n.data,d=this.handlersMap[o];if(!d?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const p=Array.from(d).map(async x=>x(n.origin,u)),g=await P5(p);n.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}zh.receivers=[];function Pg(s="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return s+n}class L5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const x=Pg("",20);o.port1.start();const y=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:o,onMessage(_){const S=_;if(S.data.eventId===x)switch(S.data.status){case"ack":clearTimeout(y),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(S.data.response);break;default:clearTimeout(y),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:x,data:n},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ta(){return window}function U5(s){Ta().location.href=s}function b1(){return typeof Ta().WorkerGlobalScope<"u"&&typeof Ta().importScripts=="function"}async function B5(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function z5(){return navigator?.serviceWorker?.controller||null}function q5(){return b1()?self:null}const y1="firebaseLocalStorageDb",F5=1,wh="firebaseLocalStorage",v1="fbase_key";class hu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function qh(s,e){return s.transaction([wh],e?"readwrite":"readonly").objectStore(wh)}function H5(){const s=indexedDB.deleteDatabase(y1);return new hu(s).toPromise()}function Yp(){const s=indexedDB.open(y1,F5);return new Promise((e,n)=>{s.addEventListener("error",()=>{n(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(wh,{keyPath:v1})}catch(o){n(o)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(wh)?e(i):(i.close(),await H5(),e(await Yp()))})})}async function Mv(s,e,n){const i=qh(s,!0).put({[v1]:e,value:n});return new hu(i).toPromise()}async function $5(s,e){const n=qh(s,!1).get(e),i=await new hu(n).toPromise();return i===void 0?null:i.value}function Ov(s,e){const n=qh(s,!0).delete(e);return new hu(n).toPromise()}const G5=800,Y5=3;class w1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Yp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>Y5)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return b1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=zh._getInstance(q5()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await B5(),!this.activeServiceWorker)return;this.sender=new L5(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||z5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Yp();return await Mv(e,vh,"1"),await Ov(e,vh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>Mv(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>$5(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ov(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const u=qh(o,!1).getAll();return new hu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:u}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(u)&&(this.notifyListeners(o,u),n.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),n.push(o));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),G5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}w1.type="LOCAL";const K5=w1;new cu(3e4,6e4);function Q5(s,e){return e?si(e):(Ye(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class Lg extends Og{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return co(e,this._buildIdpRequest())}_linkToIdToken(e,n){return co(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return co(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function W5(s){return d1(s.auth,new Lg(s),s.bypassAuthState)}function X5(s){const{auth:e,user:n}=s;return Ye(n,e,"internal-error"),j5(n,new Lg(s),s.bypassAuthState)}async function J5(s){const{auth:e,user:n}=s;return Ye(n,e,"internal-error"),T5(n,new Lg(s),s.bypassAuthState)}class _1{constructor(e,n,i,o,u=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:o,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:n,sessionId:i,tenantId:u||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(x){this.reject(x)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return W5;case"linkViaPopup":case"linkViaRedirect":return J5;case"reauthViaPopup":case"reauthViaRedirect":return X5;default:Zs(this.auth,"internal-error")}}resolve(e){ci(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ci(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Z5=new cu(2e3,1e4);class ao extends _1{constructor(e,n,i,o,u){super(e,n,o,u),this.provider=i,this.authWindow=null,this.pollId=null,ao.currentPopupAction&&ao.currentPopupAction.cancel(),ao.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ye(e,this.auth,"internal-error"),e}async onExecution(){ci(this.filter.length===1,"Popup operations only handle one event");const e=Pg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Sa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Sa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ao.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Sa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Z5.get())};e()}}ao.currentPopupAction=null;const eC="pendingRedirect",sh=new Map;class tC extends _1{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=sh.get(this.auth._key());if(!e){try{const i=await nC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}sh.set(this.auth._key(),e)}return this.bypassAuthState||sh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function nC(s,e){const n=iC(e),i=aC(s);if(!await i._isAvailable())return!1;const o=await i._get(n)==="true";return await i._remove(n),o}function sC(s,e){sh.set(s._key(),e)}function aC(s){return si(s._redirectPersistence)}function iC(s){return nh(eC,s.config.apiKey,s.name)}async function rC(s,e,n=!1){if(ps(s.app))return Promise.reject(ii(s));const i=ul(s),o=Q5(i,e),d=await new tC(i,o,n).execute();return d&&!n&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const lC=600*1e3;class oC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!cC(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!N1(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Sa(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=lC&&this.cachedEventUids.clear(),this.cachedEventUids.has(Vv(e))}saveEventToCache(e){this.cachedEventUids.add(Vv(e)),this.lastProcessedEventTime=Date.now()}}function Vv(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function N1({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function cC(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return N1(s);default:return!1}}async function uC(s,e={}){return xr(s,"GET","/v1/projects",e)}const dC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hC=/^https?/;async function fC(s){if(s.config.emulator)return;const{authorizedDomains:e}=await uC(s);for(const n of e)try{if(mC(n))return}catch{}Zs(s,"unauthorized-domain")}function mC(s){const e=Hp(),{protocol:n,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&i===""?n==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&d.hostname===i}if(!hC.test(n))return!1;if(dC.test(s))return i===s;const o=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}const pC=new cu(3e4,6e4);function Pv(){const s=Ta().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let n=0;n<s.CP.length;n++)s.CP[n]=null}}function gC(s){return new Promise((e,n)=>{function i(){Pv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Pv(),n(Sa(s,"network-request-failed"))},timeout:pC.get()})}if(Ta().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ta().gapi?.load)i();else{const o=o5("iframefcb");return Ta()[o]=()=>{gapi.load?i():n(Sa(s,"network-request-failed"))},r1(`${l5()}?onload=${o}`).catch(u=>n(u))}}).catch(e=>{throw ah=null,e})}let ah=null;function xC(s){return ah=ah||gC(s),ah}const bC=new cu(5e3,15e3),yC="__/auth/iframe",vC="emulator/auth/iframe",wC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_C=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NC(s){const e=s.config;Ye(e.authDomain,s,"auth-domain-config-required");const n=e.emulator?Ig(e,vC):`https://${s.config.authDomain}/${yC}`,i={apiKey:e.apiKey,appName:s.name,v:cl},o=_C.get(s.config.apiHost);o&&(i.eid=o);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${n}?${ou(i).slice(1)}`}async function EC(s){const e=await xC(s),n=Ta().gapi;return Ye(n,s,"internal-error"),e.open({where:document.body,url:NC(s),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wC,dontclear:!0},i=>new Promise(async(o,u)=>{await i.restyle({setHideOnLeave:!1});const d=Sa(s,"network-request-failed"),p=Ta().setTimeout(()=>{u(d)},bC.get());function g(){Ta().clearTimeout(p),o(i)}i.ping(g).then(g,()=>{u(d)})}))}const SC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},TC=500,jC=600,AC="_blank",CC="http://localhost";class Lv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function RC(s,e,n,i=TC,o=jC){const u=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...SC,width:i.toString(),height:o.toString(),top:u,left:d},x=zn().toLowerCase();n&&(p=Z_(x)?AC:n),X_(x)&&(e=e||CC,g.scrollbars="yes");const y=Object.entries(g).reduce((S,[C,H])=>`${S}${C}=${H},`,"");if(JA(x)&&p!=="_self")return kC(e||"",p),new Lv(null);const _=window.open(e||"",p,y);Ye(_,s,"popup-blocked");try{_.focus()}catch{}return new Lv(_)}function kC(s,e){const n=document.createElement("a");n.href=s,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const IC="__/auth/handler",DC="emulator/auth/handler",MC=encodeURIComponent("fac");async function Uv(s,e,n,i,o,u){Ye(s.config.authDomain,s,"auth-domain-config-required"),Ye(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:n,redirectUrl:i,v:cl,eventId:o};if(e instanceof c1){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",vj(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,_]of Object.entries({}))d[y]=_}if(e instanceof du){const y=e.getScopes().filter(_=>_!=="");y.length>0&&(d.scopes=y.join(","))}s.tenantId&&(d.tid=s.tenantId);const p=d;for(const y of Object.keys(p))p[y]===void 0&&delete p[y];const g=await s._getAppCheckToken(),x=g?`#${MC}=${encodeURIComponent(g)}`:"";return`${OC(s)}?${ou(p).slice(1)}${x}`}function OC({config:s}){return s.emulator?Ig(s,DC):`https://${s.authDomain}/${IC}`}const wp="webStorageSupport";class VC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=x1,this._completeRedirectFn=rC,this._overrideRedirectResult=sC}async _openPopup(e,n,i,o){ci(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await Uv(e,n,i,Hp(),o);return RC(e,u,Pg())}async _openRedirect(e,n,i,o){await this._originValidation(e);const u=await Uv(e,n,i,Hp(),o);return U5(u),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:o,promise:u}=this.eventManagers[n];return o?Promise.resolve(o):(ci(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await EC(e),i=new oC(e);return n.register("authEvent",o=>(Ye(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(wp,{type:wp},o=>{const u=o?.[0]?.[wp];u!==void 0&&n(!!u),Zs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=fC(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return a1()||J_()||Mg()}}const PC=VC;var Bv="@firebase/auth",zv="1.12.0";class LC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function UC(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function BC(s){Zr(new rr("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Ye(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:i1(s)},x=new a5(i,o,u,g);return m5(x,n),x},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Zr(new rr("auth-internal",e=>{const n=ul(e.getProvider("auth").getImmediate());return(i=>new LC(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ea(Bv,zv,UC(s)),Ea(Bv,zv,"esm2020")}const zC=300,qC=V_("authIdTokenMaxAge")||zC;let qv=null;const FC=s=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>qC)return;const o=n?.token;qv!==o&&(qv=o,await fetch(s,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function HC(s=Rg()){const e=Uh(s,"auth");if(e.isInitialized())return e.getImmediate();const n=f5(s,{popupRedirectResolver:PC,persistence:[K5,V5,x1]}),i=V_("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=FC(u.toString());k5(n,d,()=>d(n.currentUser)),R5(n,p=>d(p))}}const o=D_("auth");return o&&p5(n,`http://${o}`),n}function $C(){return document.getElementsByTagName("head")?.[0]??document}i5({loadJS(s){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=o=>{const u=Sa("internal-error");u.customData=o,n(u)},i.type="text/javascript",i.charset="UTF-8",$C().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});BC("Browser");var GC="firebase",YC="12.8.0";Ea(GC,YC,"app");var Fv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var nr,E1;(function(){var s;function e(j,T){function k(){}k.prototype=T.prototype,j.F=T.prototype,j.prototype=new k,j.prototype.constructor=j,j.D=function(L,M,z){for(var D=Array(arguments.length-2),F=2;F<arguments.length;F++)D[F-2]=arguments[F];return T.prototype[M].apply(L,D)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(j,T,k){k||(k=0);const L=Array(16);if(typeof T=="string")for(var M=0;M<16;++M)L[M]=T.charCodeAt(k++)|T.charCodeAt(k++)<<8|T.charCodeAt(k++)<<16|T.charCodeAt(k++)<<24;else for(M=0;M<16;++M)L[M]=T[k++]|T[k++]<<8|T[k++]<<16|T[k++]<<24;T=j.g[0],k=j.g[1],M=j.g[2];let z=j.g[3],D;D=T+(z^k&(M^z))+L[0]+3614090360&4294967295,T=k+(D<<7&4294967295|D>>>25),D=z+(M^T&(k^M))+L[1]+3905402710&4294967295,z=T+(D<<12&4294967295|D>>>20),D=M+(k^z&(T^k))+L[2]+606105819&4294967295,M=z+(D<<17&4294967295|D>>>15),D=k+(T^M&(z^T))+L[3]+3250441966&4294967295,k=M+(D<<22&4294967295|D>>>10),D=T+(z^k&(M^z))+L[4]+4118548399&4294967295,T=k+(D<<7&4294967295|D>>>25),D=z+(M^T&(k^M))+L[5]+1200080426&4294967295,z=T+(D<<12&4294967295|D>>>20),D=M+(k^z&(T^k))+L[6]+2821735955&4294967295,M=z+(D<<17&4294967295|D>>>15),D=k+(T^M&(z^T))+L[7]+4249261313&4294967295,k=M+(D<<22&4294967295|D>>>10),D=T+(z^k&(M^z))+L[8]+1770035416&4294967295,T=k+(D<<7&4294967295|D>>>25),D=z+(M^T&(k^M))+L[9]+2336552879&4294967295,z=T+(D<<12&4294967295|D>>>20),D=M+(k^z&(T^k))+L[10]+4294925233&4294967295,M=z+(D<<17&4294967295|D>>>15),D=k+(T^M&(z^T))+L[11]+2304563134&4294967295,k=M+(D<<22&4294967295|D>>>10),D=T+(z^k&(M^z))+L[12]+1804603682&4294967295,T=k+(D<<7&4294967295|D>>>25),D=z+(M^T&(k^M))+L[13]+4254626195&4294967295,z=T+(D<<12&4294967295|D>>>20),D=M+(k^z&(T^k))+L[14]+2792965006&4294967295,M=z+(D<<17&4294967295|D>>>15),D=k+(T^M&(z^T))+L[15]+1236535329&4294967295,k=M+(D<<22&4294967295|D>>>10),D=T+(M^z&(k^M))+L[1]+4129170786&4294967295,T=k+(D<<5&4294967295|D>>>27),D=z+(k^M&(T^k))+L[6]+3225465664&4294967295,z=T+(D<<9&4294967295|D>>>23),D=M+(T^k&(z^T))+L[11]+643717713&4294967295,M=z+(D<<14&4294967295|D>>>18),D=k+(z^T&(M^z))+L[0]+3921069994&4294967295,k=M+(D<<20&4294967295|D>>>12),D=T+(M^z&(k^M))+L[5]+3593408605&4294967295,T=k+(D<<5&4294967295|D>>>27),D=z+(k^M&(T^k))+L[10]+38016083&4294967295,z=T+(D<<9&4294967295|D>>>23),D=M+(T^k&(z^T))+L[15]+3634488961&4294967295,M=z+(D<<14&4294967295|D>>>18),D=k+(z^T&(M^z))+L[4]+3889429448&4294967295,k=M+(D<<20&4294967295|D>>>12),D=T+(M^z&(k^M))+L[9]+568446438&4294967295,T=k+(D<<5&4294967295|D>>>27),D=z+(k^M&(T^k))+L[14]+3275163606&4294967295,z=T+(D<<9&4294967295|D>>>23),D=M+(T^k&(z^T))+L[3]+4107603335&4294967295,M=z+(D<<14&4294967295|D>>>18),D=k+(z^T&(M^z))+L[8]+1163531501&4294967295,k=M+(D<<20&4294967295|D>>>12),D=T+(M^z&(k^M))+L[13]+2850285829&4294967295,T=k+(D<<5&4294967295|D>>>27),D=z+(k^M&(T^k))+L[2]+4243563512&4294967295,z=T+(D<<9&4294967295|D>>>23),D=M+(T^k&(z^T))+L[7]+1735328473&4294967295,M=z+(D<<14&4294967295|D>>>18),D=k+(z^T&(M^z))+L[12]+2368359562&4294967295,k=M+(D<<20&4294967295|D>>>12),D=T+(k^M^z)+L[5]+4294588738&4294967295,T=k+(D<<4&4294967295|D>>>28),D=z+(T^k^M)+L[8]+2272392833&4294967295,z=T+(D<<11&4294967295|D>>>21),D=M+(z^T^k)+L[11]+1839030562&4294967295,M=z+(D<<16&4294967295|D>>>16),D=k+(M^z^T)+L[14]+4259657740&4294967295,k=M+(D<<23&4294967295|D>>>9),D=T+(k^M^z)+L[1]+2763975236&4294967295,T=k+(D<<4&4294967295|D>>>28),D=z+(T^k^M)+L[4]+1272893353&4294967295,z=T+(D<<11&4294967295|D>>>21),D=M+(z^T^k)+L[7]+4139469664&4294967295,M=z+(D<<16&4294967295|D>>>16),D=k+(M^z^T)+L[10]+3200236656&4294967295,k=M+(D<<23&4294967295|D>>>9),D=T+(k^M^z)+L[13]+681279174&4294967295,T=k+(D<<4&4294967295|D>>>28),D=z+(T^k^M)+L[0]+3936430074&4294967295,z=T+(D<<11&4294967295|D>>>21),D=M+(z^T^k)+L[3]+3572445317&4294967295,M=z+(D<<16&4294967295|D>>>16),D=k+(M^z^T)+L[6]+76029189&4294967295,k=M+(D<<23&4294967295|D>>>9),D=T+(k^M^z)+L[9]+3654602809&4294967295,T=k+(D<<4&4294967295|D>>>28),D=z+(T^k^M)+L[12]+3873151461&4294967295,z=T+(D<<11&4294967295|D>>>21),D=M+(z^T^k)+L[15]+530742520&4294967295,M=z+(D<<16&4294967295|D>>>16),D=k+(M^z^T)+L[2]+3299628645&4294967295,k=M+(D<<23&4294967295|D>>>9),D=T+(M^(k|~z))+L[0]+4096336452&4294967295,T=k+(D<<6&4294967295|D>>>26),D=z+(k^(T|~M))+L[7]+1126891415&4294967295,z=T+(D<<10&4294967295|D>>>22),D=M+(T^(z|~k))+L[14]+2878612391&4294967295,M=z+(D<<15&4294967295|D>>>17),D=k+(z^(M|~T))+L[5]+4237533241&4294967295,k=M+(D<<21&4294967295|D>>>11),D=T+(M^(k|~z))+L[12]+1700485571&4294967295,T=k+(D<<6&4294967295|D>>>26),D=z+(k^(T|~M))+L[3]+2399980690&4294967295,z=T+(D<<10&4294967295|D>>>22),D=M+(T^(z|~k))+L[10]+4293915773&4294967295,M=z+(D<<15&4294967295|D>>>17),D=k+(z^(M|~T))+L[1]+2240044497&4294967295,k=M+(D<<21&4294967295|D>>>11),D=T+(M^(k|~z))+L[8]+1873313359&4294967295,T=k+(D<<6&4294967295|D>>>26),D=z+(k^(T|~M))+L[15]+4264355552&4294967295,z=T+(D<<10&4294967295|D>>>22),D=M+(T^(z|~k))+L[6]+2734768916&4294967295,M=z+(D<<15&4294967295|D>>>17),D=k+(z^(M|~T))+L[13]+1309151649&4294967295,k=M+(D<<21&4294967295|D>>>11),D=T+(M^(k|~z))+L[4]+4149444226&4294967295,T=k+(D<<6&4294967295|D>>>26),D=z+(k^(T|~M))+L[11]+3174756917&4294967295,z=T+(D<<10&4294967295|D>>>22),D=M+(T^(z|~k))+L[2]+718787259&4294967295,M=z+(D<<15&4294967295|D>>>17),D=k+(z^(M|~T))+L[9]+3951481745&4294967295,j.g[0]=j.g[0]+T&4294967295,j.g[1]=j.g[1]+(M+(D<<21&4294967295|D>>>11))&4294967295,j.g[2]=j.g[2]+M&4294967295,j.g[3]=j.g[3]+z&4294967295}i.prototype.v=function(j,T){T===void 0&&(T=j.length);const k=T-this.blockSize,L=this.C;let M=this.h,z=0;for(;z<T;){if(M==0)for(;z<=k;)o(this,j,z),z+=this.blockSize;if(typeof j=="string"){for(;z<T;)if(L[M++]=j.charCodeAt(z++),M==this.blockSize){o(this,L),M=0;break}}else for(;z<T;)if(L[M++]=j[z++],M==this.blockSize){o(this,L),M=0;break}}this.h=M,this.o+=T},i.prototype.A=function(){var j=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);j[0]=128;for(var T=1;T<j.length-8;++T)j[T]=0;T=this.o*8;for(var k=j.length-8;k<j.length;++k)j[k]=T&255,T/=256;for(this.v(j),j=Array(16),T=0,k=0;k<4;++k)for(let L=0;L<32;L+=8)j[T++]=this.g[k]>>>L&255;return j};function u(j,T){var k=p;return Object.prototype.hasOwnProperty.call(k,j)?k[j]:k[j]=T(j)}function d(j,T){this.h=T;const k=[];let L=!0;for(let M=j.length-1;M>=0;M--){const z=j[M]|0;L&&z==T||(k[M]=z,L=!1)}this.g=k}var p={};function g(j){return-128<=j&&j<128?u(j,function(T){return new d([T|0],T<0?-1:0)}):new d([j|0],j<0?-1:0)}function x(j){if(isNaN(j)||!isFinite(j))return _;if(j<0)return P(x(-j));const T=[];let k=1;for(let L=0;j>=k;L++)T[L]=j/k|0,k*=4294967296;return new d(T,0)}function y(j,T){if(j.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(j.charAt(0)=="-")return P(y(j.substring(1),T));if(j.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=x(Math.pow(T,8));let L=_;for(let z=0;z<j.length;z+=8){var M=Math.min(8,j.length-z);const D=parseInt(j.substring(z,z+M),T);M<8?(M=x(Math.pow(T,M)),L=L.j(M).add(x(D))):(L=L.j(k),L=L.add(x(D)))}return L}var _=g(0),S=g(1),C=g(16777216);s=d.prototype,s.m=function(){if(B(this))return-P(this).m();let j=0,T=1;for(let k=0;k<this.g.length;k++){const L=this.i(k);j+=(L>=0?L:4294967296+L)*T,T*=4294967296}return j},s.toString=function(j){if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(H(this))return"0";if(B(this))return"-"+P(this).toString(j);const T=x(Math.pow(j,6));var k=this;let L="";for(;;){const M=xe(k,T).g;k=q(k,M.j(T));let z=((k.g.length>0?k.g[0]:k.h)>>>0).toString(j);if(k=M,H(k))return z+L;for(;z.length<6;)z="0"+z;L=z+L}},s.i=function(j){return j<0?0:j<this.g.length?this.g[j]:this.h};function H(j){if(j.h!=0)return!1;for(let T=0;T<j.g.length;T++)if(j.g[T]!=0)return!1;return!0}function B(j){return j.h==-1}s.l=function(j){return j=q(this,j),B(j)?-1:H(j)?0:1};function P(j){const T=j.g.length,k=[];for(let L=0;L<T;L++)k[L]=~j.g[L];return new d(k,~j.h).add(S)}s.abs=function(){return B(this)?P(this):this},s.add=function(j){const T=Math.max(this.g.length,j.g.length),k=[];let L=0;for(let M=0;M<=T;M++){let z=L+(this.i(M)&65535)+(j.i(M)&65535),D=(z>>>16)+(this.i(M)>>>16)+(j.i(M)>>>16);L=D>>>16,z&=65535,D&=65535,k[M]=D<<16|z}return new d(k,k[k.length-1]&-2147483648?-1:0)};function q(j,T){return j.add(P(T))}s.j=function(j){if(H(this)||H(j))return _;if(B(this))return B(j)?P(this).j(P(j)):P(P(this).j(j));if(B(j))return P(this.j(P(j)));if(this.l(C)<0&&j.l(C)<0)return x(this.m()*j.m());const T=this.g.length+j.g.length,k=[];for(var L=0;L<2*T;L++)k[L]=0;for(L=0;L<this.g.length;L++)for(let M=0;M<j.g.length;M++){const z=this.i(L)>>>16,D=this.i(L)&65535,F=j.i(M)>>>16,O=j.i(M)&65535;k[2*L+2*M]+=D*O,Y(k,2*L+2*M),k[2*L+2*M+1]+=z*O,Y(k,2*L+2*M+1),k[2*L+2*M+1]+=D*F,Y(k,2*L+2*M+1),k[2*L+2*M+2]+=z*F,Y(k,2*L+2*M+2)}for(j=0;j<T;j++)k[j]=k[2*j+1]<<16|k[2*j];for(j=T;j<2*T;j++)k[j]=0;return new d(k,0)};function Y(j,T){for(;(j[T]&65535)!=j[T];)j[T+1]+=j[T]>>>16,j[T]&=65535,T++}function W(j,T){this.g=j,this.h=T}function xe(j,T){if(H(T))throw Error("division by zero");if(H(j))return new W(_,_);if(B(j))return T=xe(P(j),T),new W(P(T.g),P(T.h));if(B(T))return T=xe(j,P(T)),new W(P(T.g),T.h);if(j.g.length>30){if(B(j)||B(T))throw Error("slowDivide_ only works with positive integers.");for(var k=S,L=T;L.l(j)<=0;)k=me(k),L=me(L);var M=re(k,1),z=re(L,1);for(L=re(L,2),k=re(k,2);!H(L);){var D=z.add(L);D.l(j)<=0&&(M=M.add(k),z=D),L=re(L,1),k=re(k,1)}return T=q(j,M.j(T)),new W(M,T)}for(M=_;j.l(T)>=0;){for(k=Math.max(1,Math.floor(j.m()/T.m())),L=Math.ceil(Math.log(k)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),z=x(k),D=z.j(T);B(D)||D.l(j)>0;)k-=L,z=x(k),D=z.j(T);H(z)&&(z=S),M=M.add(z),j=q(j,D)}return new W(M,j)}s.B=function(j){return xe(this,j).h},s.and=function(j){const T=Math.max(this.g.length,j.g.length),k=[];for(let L=0;L<T;L++)k[L]=this.i(L)&j.i(L);return new d(k,this.h&j.h)},s.or=function(j){const T=Math.max(this.g.length,j.g.length),k=[];for(let L=0;L<T;L++)k[L]=this.i(L)|j.i(L);return new d(k,this.h|j.h)},s.xor=function(j){const T=Math.max(this.g.length,j.g.length),k=[];for(let L=0;L<T;L++)k[L]=this.i(L)^j.i(L);return new d(k,this.h^j.h)};function me(j){const T=j.g.length+1,k=[];for(let L=0;L<T;L++)k[L]=j.i(L)<<1|j.i(L-1)>>>31;return new d(k,j.h)}function re(j,T){const k=T>>5;T%=32;const L=j.g.length-k,M=[];for(let z=0;z<L;z++)M[z]=T>0?j.i(z+k)>>>T|j.i(z+k+1)<<32-T:j.i(z+k);return new d(M,j.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,E1=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=x,d.fromString=y,nr=d}).apply(typeof Fv<"u"?Fv:typeof self<"u"?self:typeof window<"u"?window:{});var Hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var S1,Mc,T1,ih,Kp,j1,A1,C1;(function(){var s,e=Object.defineProperty;function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hd=="object"&&Hd];for(var b=0;b<h.length;++b){var w=h[b];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var i=n(this);function o(h,b){if(b)e:{var w=i;h=h.split(".");for(var A=0;A<h.length-1;A++){var Z=h[A];if(!(Z in w))break e;w=w[Z]}h=h[h.length-1],A=w[h],b=b(A),b!=A&&b!=null&&e(w,h,{configurable:!0,writable:!0,value:b})}}o("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(h){return h||function(b){var w=[],A;for(A in b)Object.prototype.hasOwnProperty.call(b,A)&&w.push([A,b[A]]);return w}});var u=u||{},d=this||self;function p(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,w){return h.call.apply(h.bind,arguments)}function x(h,b,w){return x=g,x.apply(null,arguments)}function y(h,b){var w=Array.prototype.slice.call(arguments,1);return function(){var A=w.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function _(h,b){function w(){}w.prototype=b.prototype,h.Z=b.prototype,h.prototype=new w,h.prototype.constructor=h,h.Ob=function(A,Z,ae){for(var Ee=Array(arguments.length-2),tt=2;tt<arguments.length;tt++)Ee[tt-2]=arguments[tt];return b.prototype[Z].apply(A,Ee)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function C(h){const b=h.length;if(b>0){const w=Array(b);for(let A=0;A<b;A++)w[A]=h[A];return w}return[]}function H(h,b){for(let A=1;A<arguments.length;A++){const Z=arguments[A];var w=typeof Z;if(w=w!="object"?w:Z?Array.isArray(Z)?"array":w:"null",w=="array"||w=="object"&&typeof Z.length=="number"){w=h.length||0;const ae=Z.length||0;h.length=w+ae;for(let Ee=0;Ee<ae;Ee++)h[w+Ee]=Z[Ee]}else h.push(Z)}}class B{constructor(b,w){this.i=b,this.j=w,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function P(h){d.setTimeout(()=>{throw h},0)}function q(){var h=j;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class Y{constructor(){this.h=this.g=null}add(b,w){const A=W.get();A.set(b,w),this.h?this.h.next=A:this.g=A,this.h=A}}var W=new B(()=>new xe,h=>h.reset());class xe{constructor(){this.next=this.g=this.h=null}set(b,w){this.h=b,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let me,re=!1,j=new Y,T=()=>{const h=Promise.resolve(void 0);me=()=>{h.then(k)}};function k(){for(var h;h=q();){try{h.h.call(h.g)}catch(w){P(w)}var b=W;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}re=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};d.addEventListener("test",w,b),d.removeEventListener("test",w,b)}catch{}return h})();function D(h){return/^[\s\xa0]*$/.test(h)}function F(h,b){M.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}_(F,M),F.prototype.init=function(h,b){const w=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(w=="mouseover"?b=h.fromElement:w=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&F.Z.h.call(this)},F.prototype.h=function(){F.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var O="closure_listenable_"+(Math.random()*1e6|0),I=0;function K(h,b,w,A,Z){this.listener=h,this.proxy=null,this.src=b,this.type=w,this.capture=!!A,this.ha=Z,this.key=++I,this.da=this.fa=!1}function fe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Se(h,b,w){for(const A in h)b.call(w,h[A],A,h)}function we(h,b){for(const w in h)b.call(void 0,h[w],w,h)}function V(h){const b={};for(const w in h)b[w]=h[w];return b}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function le(h,b){let w,A;for(let Z=1;Z<arguments.length;Z++){A=arguments[Z];for(w in A)h[w]=A[w];for(let ae=0;ae<ne.length;ae++)w=ne[ae],Object.prototype.hasOwnProperty.call(A,w)&&(h[w]=A[w])}}function _e(h){this.src=h,this.g={},this.h=0}_e.prototype.add=function(h,b,w,A,Z){const ae=h.toString();h=this.g[ae],h||(h=this.g[ae]=[],this.h++);const Ee=Ie(h,b,A,Z);return Ee>-1?(b=h[Ee],w||(b.fa=!1)):(b=new K(b,this.src,ae,!!A,Z),b.fa=w,h.push(b)),b};function ye(h,b){const w=b.type;if(w in h.g){var A=h.g[w],Z=Array.prototype.indexOf.call(A,b,void 0),ae;(ae=Z>=0)&&Array.prototype.splice.call(A,Z,1),ae&&(fe(b),h.g[w].length==0&&(delete h.g[w],h.h--))}}function Ie(h,b,w,A){for(let Z=0;Z<h.length;++Z){const ae=h[Z];if(!ae.da&&ae.listener==b&&ae.capture==!!w&&ae.ha==A)return Z}return-1}var ue="closure_lm_"+(Math.random()*1e6|0),ze={};function Ue(h,b,w,A,Z){if(Array.isArray(b)){for(let ae=0;ae<b.length;ae++)Ue(h,b[ae],w,A,Z);return null}return w=xn(w),h&&h[O]?h.J(b,w,p(A)?!!A.capture:!1,Z):Ge(h,b,w,!1,A,Z)}function Ge(h,b,w,A,Z,ae){if(!b)throw Error("Invalid event type");const Ee=p(Z)?!!Z.capture:!!Z;let tt=gt(h);if(tt||(h[ue]=tt=new _e(h)),w=tt.add(b,w,A,Ee,ae),w.proxy)return w;if(A=J(),w.proxy=A,A.src=h,A.listener=w,h.addEventListener)z||(Z=Ee),Z===void 0&&(Z=!1),h.addEventListener(b.toString(),A,Z);else if(h.attachEvent)h.attachEvent(Pe(b.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return w}function J(){function h(w){return b.call(h.src,h.listener,w)}const b=qe;return h}function ve(h,b,w,A,Z){if(Array.isArray(b))for(var ae=0;ae<b.length;ae++)ve(h,b[ae],w,A,Z);else A=p(A)?!!A.capture:!!A,w=xn(w),h&&h[O]?(h=h.i,ae=String(b).toString(),ae in h.g&&(b=h.g[ae],w=Ie(b,w,A,Z),w>-1&&(fe(b[w]),Array.prototype.splice.call(b,w,1),b.length==0&&(delete h.g[ae],h.h--)))):h&&(h=gt(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Ie(b,w,A,Z)),(w=h>-1?b[h]:null)&&Ve(w))}function Ve(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[O])ye(b.i,h);else{var w=h.type,A=h.proxy;b.removeEventListener?b.removeEventListener(w,A,h.capture):b.detachEvent?b.detachEvent(Pe(w),A):b.addListener&&b.removeListener&&b.removeListener(A),(w=gt(b))?(ye(w,h),w.h==0&&(w.src=null,b[ue]=null)):fe(h)}}}function Pe(h){return h in ze?ze[h]:ze[h]="on"+h}function qe(h,b){if(h.da)h=!0;else{b=new F(b,this);const w=h.listener,A=h.ha||h.src;h.fa&&Ve(h),h=w.call(A,b)}return h}function gt(h){return h=h[ue],h instanceof _e?h:null}var qn="__closure_events_fn_"+(Math.random()*1e9>>>0);function xn(h){return typeof h=="function"?h:(h[qn]||(h[qn]=function(b){return h.handleEvent(b)}),h[qn])}function vt(){L.call(this),this.i=new _e(this),this.M=this,this.G=null}_(vt,L),vt.prototype[O]=!0,vt.prototype.removeEventListener=function(h,b,w,A){ve(this,h,b,w,A)};function je(h,b){var w,A=h.G;if(A)for(w=[];A;A=A.G)w.push(A);if(h=h.M,A=b.type||b,typeof b=="string")b=new M(b,h);else if(b instanceof M)b.target=b.target||h;else{var Z=b;b=new M(A,h),le(b,Z)}Z=!0;let ae,Ee;if(w)for(Ee=w.length-1;Ee>=0;Ee--)ae=b.g=w[Ee],Z=Be(ae,A,!0,b)&&Z;if(ae=b.g=h,Z=Be(ae,A,!0,b)&&Z,Z=Be(ae,A,!1,b)&&Z,w)for(Ee=0;Ee<w.length;Ee++)ae=b.g=w[Ee],Z=Be(ae,A,!1,b)&&Z}vt.prototype.N=function(){if(vt.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const w=h.g[b];for(let A=0;A<w.length;A++)fe(w[A]);delete h.g[b],h.h--}}this.G=null},vt.prototype.J=function(h,b,w,A){return this.i.add(String(h),b,!1,w,A)},vt.prototype.K=function(h,b,w,A){return this.i.add(String(h),b,!0,w,A)};function Be(h,b,w,A){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let Z=!0;for(let ae=0;ae<b.length;++ae){const Ee=b[ae];if(Ee&&!Ee.da&&Ee.capture==w){const tt=Ee.listener,tn=Ee.ha||Ee.src;Ee.fa&&ye(h.i,Ee),Z=tt.call(tn,A)!==!1&&Z}}return Z&&!A.defaultPrevented}function it(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=x(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(h,b||0)}function Lt(h){h.g=it(()=>{h.g=null,h.i&&(h.i=!1,Lt(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class xt extends L{constructor(b,w){super(),this.m=b,this.l=w,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Lt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lt(h){L.call(this),this.h=h,this.g={}}_(lt,L);var rn=[];function wt(h){Se(h.g,function(b,w){this.g.hasOwnProperty(w)&&Ve(b)},h),h.g={}}lt.prototype.N=function(){lt.Z.N.call(this),wt(this)},lt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _s=d.JSON.stringify,bn=d.JSON.parse,Vn=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Ls(){}function Oa(){}var R={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function G(){M.call(this,"d")}_(G,M);function de(){M.call(this,"c")}_(de,M);var ce={},Me=null;function Te(){return Me=Me||new vt}ce.Ia="serverreachability";function Ce(h){M.call(this,ce.Ia,h)}_(Ce,M);function Re(h){const b=Te();je(b,new Ce(b))}ce.STAT_EVENT="statevent";function rt(h,b){M.call(this,ce.STAT_EVENT,h),this.stat=b}_(rt,M);function ot(h){const b=Te();je(b,new rt(b,h))}ce.Ja="timingevent";function $t(h,b){M.call(this,ce.Ja,h),this.size=b}_($t,M);function Gt(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},b)}function Fn(){this.g=!0}Fn.prototype.ua=function(){this.g=!1};function na(h,b,w,A,Z,ae){h.info(function(){if(h.g)if(ae){var Ee="",tt=ae.split("&");for(let Et=0;Et<tt.length;Et++){var tn=tt[Et].split("=");if(tn.length>1){const zt=tn[0];tn=tn[1];const Ts=zt.split("_");Ee=Ts.length>=2&&Ts[1]=="type"?Ee+(zt+"="+tn+"&"):Ee+(zt+"=redacted&")}}}else Ee=null;else Ee=ae;return"XMLHTTP REQ ("+A+") [attempt "+Z+"]: "+b+`
`+w+`
`+Ee})}function wn(h,b,w,A,Z,ae,Ee){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+Z+"]: "+b+`
`+w+`
`+ae+" "+Ee})}function Hn(h,b,w,A){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+sa(h,w)+(A?" "+A:"")})}function _n(h,b){h.info(function(){return"TIMEOUT: "+b})}Fn.prototype.info=function(){};function sa(h,b){if(!h.g)return b;if(!b)return null;try{const ae=JSON.parse(b);if(ae){for(h=0;h<ae.length;h++)if(Array.isArray(ae[h])){var w=ae[h];if(!(w.length<2)){var A=w[1];if(Array.isArray(A)&&!(A.length<1)){var Z=A[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(let Ee=1;Ee<A.length;Ee++)A[Ee]=""}}}}return _s(ae)}catch{return b}}var Us={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Va={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},mi;function pi(){}_(pi,Ls),pi.prototype.g=function(){return new XMLHttpRequest},mi=new pi;function Pa(h){return encodeURIComponent(String(h))}function vu(h){var b=1;h=h.split(":");const w=[];for(;b>0&&h.length;)w.push(h.shift()),b--;return h.length&&w.push(h.join(":")),w}function Bs(h,b,w,A){this.j=h,this.i=b,this.l=w,this.S=A||1,this.V=new lt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new zs}function zs(){this.i=null,this.g="",this.h=!1}var ln={},Nn={};function aa(h,b,w){h.M=1,h.A=vr(cn(b)),h.u=w,h.R=!0,ml(h,null)}function ml(h,b){h.F=Date.now(),ia(h),h.B=cn(h.A);var w=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),bl(w.i,"t",A),h.C=0,w=h.j.L,h.h=new zs,h.g=Ou(h.j,w?b:null,!h.u),h.P>0&&(h.O=new xt(x(h.Y,h,h.g),h.P)),b=h.V,w=h.g,A=h.ba;var Z="readystatechange";Array.isArray(Z)||(Z&&(rn[0]=Z.toString()),Z=rn);for(let ae=0;ae<Z.length;ae++){const Ee=Ue(w,Z[ae],A||b.handleEvent,!1,b.h||b);if(!Ee)break;b.g[Ee.key]=Ee}b=h.J?V(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),Re(),na(h.i,h.v,h.B,h.l,h.S,h.u)}Bs.prototype.ba=function(h){h=h.target;const b=this.O;b&&Hs(h)==3?b.j():this.Y(h)},Bs.prototype.Y=function(h){try{if(h==this.g)e:{const tt=Hs(this.g),tn=this.g.ya(),Et=this.g.ca();if(!(tt<3)&&(tt!=3||this.g&&(this.h.h||this.g.la()||An(this.g)))){this.K||tt!=4||tn==7||(tn==8||Et<=0?Re(3):Re(2)),ra(this);var b=this.g.ca();this.X=b;var w=hf(this);if(this.o=b==200,wn(this.i,this.v,this.B,this.l,this.S,tt,b),this.o){if(this.U&&!this.L){t:{if(this.g){var A,Z=this.g;if((A=Z.g?Z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(A)){var ae=A;break t}}ae=null}if(h=ae)Hn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,la(this,h);else{this.o=!1,this.m=3,ot(12),rs(this),Ns(this);break e}}if(this.R){h=!0;let zt;for(;!this.K&&this.C<w.length;)if(zt=_u(this,w),zt==Nn){tt==4&&(this.m=4,ot(14),h=!1),Hn(this.i,this.l,null,"[Incomplete Response]");break}else if(zt==ln){this.m=4,ot(15),Hn(this.i,this.l,w,"[Invalid Chunk]"),h=!1;break}else Hn(this.i,this.l,zt,null),la(this,zt);if(wu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tt!=4||w.length!=0||this.h.h||(this.m=1,ot(16),h=!1),this.o=this.o&&h,!h)Hn(this.i,this.l,w,"[Invalid Chunked Response]"),rs(this),Ns(this);else if(w.length>0&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.aa&&!Ee.P&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Fo(Ee),Ee.P=!0,ot(11))}}else Hn(this.i,this.l,w,null),la(this,w);tt==4&&rs(this),this.o&&!this.K&&(tt==4?ku(this.j,this):(this.o=!1,ia(this)))}else Ua(this.g),b==400&&w.indexOf("Unknown SID")>0?(this.m=3,ot(12)):(this.m=0,ot(13)),rs(this),Ns(this)}}}catch{}};function hf(h){if(!wu(h))return h.g.la();const b=An(h.g);if(b==="")return"";let w="";const A=b.length,Z=Hs(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return rs(h),Ns(h),"";h.h.i=new d.TextDecoder}for(let ae=0;ae<A;ae++)h.h.h=!0,w+=h.h.i.decode(b[ae],{stream:!(Z&&ae==A-1)});return b.length=0,h.h.g+=w,h.C=0,h.h.g}function wu(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function _u(h,b){var w=h.C,A=b.indexOf(`
`,w);return A==-1?Nn:(w=Number(b.substring(w,A)),isNaN(w)?ln:(A+=1,A+w>b.length?Nn:(b=b.slice(A,A+w),h.C=A+w,b)))}Bs.prototype.cancel=function(){this.K=!0,rs(this)};function ia(h){h.T=Date.now()+h.H,pl(h,h.H)}function pl(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Gt(x(h.aa,h),b)}function ra(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Bs.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(_n(this.i,this.B),this.M!=2&&(Re(),ot(17)),rs(this),this.m=2,Ns(this)):pl(this,this.T-h)};function Ns(h){h.j.I==0||h.K||ku(h.j,h)}function rs(h){ra(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,wt(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function la(h,b){try{var w=h.j;if(w.I!=0&&(w.g==h||ca(w.h,h))){if(!h.L&&ca(w.h,h)&&w.I==3){try{var A=w.Ba.g.parse(b)}catch{A=null}if(Array.isArray(A)&&A.length==3){var Z=A;if(Z[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<h.F)Nl(w),Ni(w);else break e;jr(w),ot(18)}}else w.xa=Z[1],0<w.xa-w.K&&Z[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=Gt(x(w.Va,w),6e3));oa(w.h)<=1&&w.ta&&(w.ta=void 0)}else pa(w,11)}else if((h.L||w.g==h)&&Nl(w),!D(b))for(Z=w.Ba.g.parse(b),b=0;b<Z.length;b++){let Et=Z[b];const zt=Et[0];if(!(zt<=w.K))if(w.K=zt,Et=Et[1],w.I==2)if(Et[0]=="c"){w.M=Et[1],w.ba=Et[2];const Ts=Et[3];Ts!=null&&(w.ka=Ts,w.j.info("VER="+w.ka));const ga=Et[4];ga!=null&&(w.za=ga,w.j.info("SVER="+w.za));const $s=Et[5];$s!=null&&typeof $s=="number"&&$s>0&&(A=1.5*$s,w.O=A,w.j.info("backChannelRequestTimeoutMs_="+A)),A=w;const Gs=h.g;if(Gs){const Ar=Gs.g?Gs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ar){var ae=A.h;ae.g||Ar.indexOf("spdy")==-1&&Ar.indexOf("quic")==-1&&Ar.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(ko(ae,ae.h),ae.h=null))}if(A.G){const El=Gs.g?Gs.g.getResponseHeader("X-HTTP-Session-Id"):null;El&&(A.wa=El,At(A.J,A.G,El))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-h.F,w.j.info("Handshake RTT: "+w.T+"ms")),A=w;var Ee=h;if(A.na=Mu(A,A.L?A.ba:null,A.W),Ee.L){Io(A.h,Ee);var tt=Ee,tn=A.O;tn&&(tt.H=tn),tt.D&&(ra(tt),ia(tt)),A.g=Ee}else Cu(A);w.i.length>0&&ma(w)}else Et[0]!="stop"&&Et[0]!="close"||pa(w,7);else w.I==3&&(Et[0]=="stop"||Et[0]=="close"?Et[0]=="stop"?pa(w,7):zo(w):Et[0]!="noop"&&w.l&&w.l.qa(Et),w.A=0)}}Re(4)}catch{}}var on=class{constructor(h,b){this.g=h,this.map=b}};function Co(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ro(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function oa(h){return h.h?1:h.g?h.g.size:0}function ca(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function ko(h,b){h.g?h.g.add(b):h.h=b}function Io(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}Co.prototype.cancel=function(){if(this.i=Do(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Do(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const w of h.g.values())b=b.concat(w.G);return b}return C(h.i)}var Nu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gl(h,b){if(h){h=h.split("&");for(let w=0;w<h.length;w++){const A=h[w].indexOf("=");let Z,ae=null;A>=0?(Z=h[w].substring(0,A),ae=h[w].substring(A+1)):Z=h[w],b(Z,ae?decodeURIComponent(ae.replace(/\+/g," ")):"")}}}function ls(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof ls?(this.l=h.l,En(this,h.j),this.o=h.o,this.g=h.g,gi(this,h.u),this.h=h.h,Mo(this,ju(h.i)),this.m=h.m):h&&(b=String(h).match(Nu))?(this.l=!1,En(this,b[1]||"",!0),this.o=ua(b[2]||""),this.g=ua(b[3]||"",!0),gi(this,b[4]),this.h=ua(b[5]||"",!0),Mo(this,b[6]||"",!0),this.m=ua(b[7]||"")):(this.l=!1,this.i=new bi(null,this.l))}ls.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(wr(b,xl,!0),":");var w=this.g;return(w||b=="file")&&(h.push("//"),(b=this.o)&&h.push(wr(b,xl,!0),"@"),h.push(Pa(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&h.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(wr(w,w.charAt(0)=="/"?Oo:Eu,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",wr(w,Su)),h.join("")},ls.prototype.resolve=function(h){const b=cn(this);let w=!!h.j;w?En(b,h.j):w=!!h.o,w?b.o=h.o:w=!!h.g,w?b.g=h.g:w=h.u!=null;var A=h.h;if(w)gi(b,h.u);else if(w=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var Z=b.h.lastIndexOf("/");Z!=-1&&(A=b.h.slice(0,Z+1)+A)}if(Z=A,Z==".."||Z==".")A="";else if(Z.indexOf("./")!=-1||Z.indexOf("/.")!=-1){A=Z.lastIndexOf("/",0)==0,Z=Z.split("/");const ae=[];for(let Ee=0;Ee<Z.length;){const tt=Z[Ee++];tt=="."?A&&Ee==Z.length&&ae.push(""):tt==".."?((ae.length>1||ae.length==1&&ae[0]!="")&&ae.pop(),A&&Ee==Z.length&&ae.push("")):(ae.push(tt),A=!0)}A=ae.join("/")}else A=Z}return w?b.h=A:w=h.i.toString()!=="",w?Mo(b,ju(h.i)):w=!!h.m,w&&(b.m=h.m),b};function cn(h){return new ls(h)}function En(h,b,w){h.j=w?ua(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function gi(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function Mo(h,b,w){b instanceof bi?(h.i=b,yl(h.i,h.l)):(w||(b=wr(b,xi)),h.i=new bi(b,h.l))}function At(h,b,w){h.i.set(b,w)}function vr(h){return At(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function ua(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function wr(h,b,w){return typeof h=="string"?(h=encodeURI(h).replace(b,Kn),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Kn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var xl=/[#\/\?@]/g,Eu=/[#\?:]/g,Oo=/[#\?]/g,xi=/[#\?@]/g,Su=/#/g;function bi(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Qn(h){h.g||(h.g=new Map,h.h=0,h.i&&gl(h.i,function(b,w){h.add(decodeURIComponent(b.replace(/\+/g," ")),w)}))}s=bi.prototype,s.add=function(h,b){Qn(this),this.i=null,h=yi(this,h);let w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(b),this.h+=1,this};function Tu(h,b){Qn(h),b=yi(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Vo(h,b){return Qn(h),b=yi(h,b),h.g.has(b)}s.forEach=function(h,b){Qn(this),this.g.forEach(function(w,A){w.forEach(function(Z){h.call(b,Z,A,this)},this)},this)};function Po(h,b){Qn(h);let w=[];if(typeof b=="string")Vo(h,b)&&(w=w.concat(h.g.get(yi(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)w=w.concat(h[b]);return w}s.set=function(h,b){return Qn(this),this.i=null,h=yi(this,h),Vo(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},s.get=function(h,b){return h?(h=Po(this,h),h.length>0?String(h[0]):b):b};function bl(h,b,w){Tu(h,b),w.length>0&&(h.i=null,h.g.set(yi(h,b),C(w)),h.h+=w.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let A=0;A<b.length;A++){var w=b[A];const Z=Pa(w);w=Po(this,w);for(let ae=0;ae<w.length;ae++){let Ee=Z;w[ae]!==""&&(Ee+="="+Pa(w[ae])),h.push(Ee)}}return this.i=h.join("&")};function ju(h){const b=new bi;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function yi(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function yl(h,b){b&&!h.j&&(Qn(h),h.i=null,h.g.forEach(function(w,A){const Z=A.toLowerCase();A!=Z&&(Tu(this,A),bl(this,Z,w))},h)),h.j=b}function qs(h,b){const w=new Fn;if(d.Image){const A=new Image;A.onload=y(Es,w,"TestLoadImage: loaded",!0,b,A),A.onerror=y(Es,w,"TestLoadImage: error",!1,b,A),A.onabort=y(Es,w,"TestLoadImage: abort",!1,b,A),A.ontimeout=y(Es,w,"TestLoadImage: timeout",!1,b,A),d.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else b(!1)}function Lo(h,b){const w=new Fn,A=new AbortController,Z=setTimeout(()=>{A.abort(),Es(w,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:A.signal}).then(ae=>{clearTimeout(Z),ae.ok?Es(w,"TestPingServer: ok",!0,b):Es(w,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(Z),Es(w,"TestPingServer: error",!1,b)})}function Es(h,b,w,A,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),A(w)}catch{}}function vi(){this.g=new Vn}function da(h){this.i=h.Sb||null,this.h=h.ab||!1}_(da,Ls),da.prototype.g=function(){return new _r(this.i,this.h)};function _r(h,b){vt.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(_r,vt),s=_r.prototype,s.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,Fs(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,wi(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Fs(this)),this.g&&(this.readyState=3,Fs(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;vl(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function vl(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?wi(this):Fs(this),this.readyState==3&&vl(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,wi(this))},s.Na=function(h){this.g&&(this.response=h,wi(this))},s.ga=function(){this.g&&wi(this)};function wi(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Fs(h)}s.setRequestHeader=function(h,b){this.A.append(h,b)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var w=b.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=b.next();return h.join(`\r
`)};function Fs(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(_r.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Ss(h){let b="";return Se(h,function(w,A){b+=A,b+=":",b+=w,b+=`\r
`}),b}function Nr(h,b,w){e:{for(A in w){var A=!1;break e}A=!0}A||(w=Ss(w),typeof h=="string"?w!=null&&Pa(w):At(h,b,w))}function kt(h){vt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(kt,vt);var ha=/^https?$/i,Uo=["POST","PUT"];s=kt.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,b,w,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():mi.g(),this.g.onreadystatechange=S(x(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(ae){Er(this,ae);return}if(h=w||"",w=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var Z in A)w.set(Z,A[Z]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const ae of A.keys())w.set(ae,A.get(ae));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(w.keys()).find(ae=>ae.toLowerCase()=="content-type"),Z=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(Uo,b,void 0)>=0)||A||Z||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,Ee]of w)this.g.setRequestHeader(ae,Ee);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ae){Er(this,ae)}};function Er(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,Bo(h),La(h)}function Bo(h){h.A||(h.A=!0,je(h,"complete"),je(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,je(this,"complete"),je(this,"abort"),La(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),La(this,!0)),kt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Sr(this):this.Xa())},s.Xa=function(){Sr(this)};function Sr(h){if(h.h&&typeof u<"u"){if(h.v&&Hs(h)==4)setTimeout(h.Ca.bind(h),0);else if(je(h,"readystatechange"),Hs(h)==4){h.h=!1;try{const ae=h.ca();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var w;if(!(w=b)){var A;if(A=ae===0){let Ee=String(h.D).match(Nu)[1]||null;!Ee&&d.self&&d.self.location&&(Ee=d.self.location.protocol.slice(0,-1)),A=!ha.test(Ee?Ee.toLowerCase():"")}w=A}if(w)je(h,"complete"),je(h,"success");else{h.o=6;try{var Z=Hs(h)>2?h.g.statusText:""}catch{Z=""}h.l=Z+" ["+h.ca()+"]",Bo(h)}}finally{La(h)}}}}function La(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const w=h.g;h.g=null,b||je(h,"ready");try{w.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Hs(h){return h.g?h.g.readyState:0}s.ca=function(){try{return Hs(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),bn(b)}};function An(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Ua(h){const b={};h=(h.g&&Hs(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(D(h[A]))continue;var w=vu(h[A]);const Z=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const ae=b[Z]||[];b[Z]=ae,ae.push(w)}we(b,function(A){return A.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function fa(h,b,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||b}function _i(h){this.za=0,this.i=[],this.j=new Fn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=fa("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=fa("baseRetryDelayMs",5e3,h),this.Za=fa("retryDelaySeedMs",1e4,h),this.Ta=fa("forwardChannelMaxRetries",2,h),this.va=fa("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Co(h&&h.concurrentRequestLimit),this.Ba=new vi,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=_i.prototype,s.ka=8,s.I=1,s.connect=function(h,b,w,A){ot(0),this.W=h,this.H=b||{},w&&A!==void 0&&(this.H.OSID=w,this.H.OAID=A),this.F=this.X,this.J=Mu(this,null,this.W),ma(this)};function zo(h){if(wl(h),h.I==3){var b=h.V++,w=cn(h.J);if(At(w,"SID",h.M),At(w,"RID",b),At(w,"TYPE","terminate"),Tr(h,w),b=new Bs(h,h.j,b),b.M=2,b.A=vr(cn(w)),w=!1,d.navigator&&d.navigator.sendBeacon)try{w=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!w&&d.Image&&(new Image().src=b.A,w=!0),w||(b.g=Ou(b.j,null),b.g.ea(b.A)),b.F=Date.now(),ia(b)}Du(h)}function Ni(h){h.g&&(Fo(h),h.g.cancel(),h.g=null)}function wl(h){Ni(h),h.v&&(d.clearTimeout(h.v),h.v=null),Nl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function ma(h){if(!Ro(h.h)&&!h.m){h.m=!0;var b=h.Ea;me||T(),re||(me(),re=!0),j.add(b,h),h.D=0}}function _l(h,b){return oa(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Gt(x(h.Ea,h,b),Iu(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const Z=new Bs(this,this.j,h);let ae=this.o;if(this.U&&(ae?(ae=V(ae),le(ae,this.U)):ae=this.U),this.u!==null||this.R||(Z.J=ae,ae=null),this.S)e:{for(var b=0,w=0;w<this.i.length;w++){t:{var A=this.i[w];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(b+=A,b>4096){b=w;break e}if(b===4096||w===this.i.length-1){b=w+1;break e}}b=1e3}else b=1e3;b=Au(this,Z,b),w=cn(this.J),At(w,"RID",h),At(w,"CVER",22),this.G&&At(w,"X-HTTP-Session-Id",this.G),Tr(this,w),ae&&(this.R?b="headers="+Pa(Ss(ae))+"&"+b:this.u&&Nr(w,this.u,ae)),ko(this.h,Z),this.Ra&&At(w,"TYPE","init"),this.S?(At(w,"$req",b),At(w,"SID","null"),Z.U=!0,aa(Z,w,null)):aa(Z,w,b),this.I=2}}else this.I==3&&(h?qo(this,h):this.i.length==0||Ro(this.h)||qo(this))};function qo(h,b){var w;b?w=b.l:w=h.V++;const A=cn(h.J);At(A,"SID",h.M),At(A,"RID",w),At(A,"AID",h.K),Tr(h,A),h.u&&h.o&&Nr(A,h.u,h.o),w=new Bs(h,h.j,w,h.D+1),h.u===null&&(w.J=h.o),b&&(h.i=b.G.concat(h.i)),b=Au(h,w,1e3),w.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),ko(h.h,w),aa(w,A,b)}function Tr(h,b){h.H&&Se(h.H,function(w,A){At(b,A,w)}),h.l&&Se({},function(w,A){At(b,A,w)})}function Au(h,b,w){w=Math.min(h.i.length,w);const A=h.l?x(h.l.Ka,h.l,h):null;e:{var Z=h.i;let tt=-1;for(;;){const tn=["count="+w];tt==-1?w>0?(tt=Z[0].g,tn.push("ofs="+tt)):tt=0:tn.push("ofs="+tt);let Et=!0;for(let zt=0;zt<w;zt++){var ae=Z[zt].g;const Ts=Z[zt].map;if(ae-=tt,ae<0)tt=Math.max(0,Z[zt].g-100),Et=!1;else try{ae="req"+ae+"_"||"";try{var Ee=Ts instanceof Map?Ts:Object.entries(Ts);for(const[ga,$s]of Ee){let Gs=$s;p($s)&&(Gs=_s($s)),tn.push(ae+ga+"="+encodeURIComponent(Gs))}}catch(ga){throw tn.push(ae+"type="+encodeURIComponent("_badmap")),ga}}catch{A&&A(Ts)}}if(Et){Ee=tn.join("&");break e}}Ee=void 0}return h=h.i.splice(0,w),b.G=h,Ee}function Cu(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;me||T(),re||(me(),re=!0),j.add(b,h),h.A=0}}function jr(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Gt(x(h.Da,h),Iu(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Ru(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Gt(x(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ot(10),Ni(this),Ru(this))};function Fo(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Ru(h){h.g=new Bs(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=cn(h.na);At(b,"RID","rpc"),At(b,"SID",h.M),At(b,"AID",h.K),At(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&At(b,"TO",h.ia),At(b,"TYPE","xmlhttp"),Tr(h,b),h.u&&h.o&&Nr(b,h.u,h.o),h.O&&(h.g.H=h.O);var w=h.g;h=h.ba,w.M=1,w.A=vr(cn(b)),w.u=null,w.R=!0,ml(w,h)}s.Va=function(){this.C!=null&&(this.C=null,Ni(this),jr(this),ot(19))};function Nl(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function ku(h,b){var w=null;if(h.g==b){Nl(h),Fo(h),h.g=null;var A=2}else if(ca(h.h,b))w=b.G,Io(h.h,b),A=1;else return;if(h.I!=0){if(b.o)if(A==1){w=b.u?b.u.length:0,b=Date.now()-b.F;var Z=h.D;A=Te(),je(A,new $t(A,w)),ma(h)}else Cu(h);else if(Z=b.m,Z==3||Z==0&&b.X>0||!(A==1&&_l(h,b)||A==2&&jr(h)))switch(w&&w.length>0&&(b=h.h,b.i=b.i.concat(w)),Z){case 1:pa(h,5);break;case 4:pa(h,10);break;case 3:pa(h,6);break;default:pa(h,2)}}}function Iu(h,b){let w=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(w*=2),w*b}function pa(h,b){if(h.j.info("Error code "+b),b==2){var w=x(h.bb,h),A=h.Ua;const Z=!A;A=new ls(A||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||En(A,"https"),vr(A),Z?qs(A.toString(),w):Lo(A.toString(),w)}else ot(2);h.I=0,h.l&&h.l.pa(b),Du(h),wl(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),ot(2)):(this.j.info("Failed to ping google.com"),ot(1))};function Du(h){if(h.I=0,h.ja=[],h.l){const b=Do(h.h);(b.length!=0||h.i.length!=0)&&(H(h.ja,b),H(h.ja,h.i),h.h.i.length=0,C(h.i),h.i.length=0),h.l.oa()}}function Mu(h,b,w){var A=w instanceof ls?cn(w):new ls(w);if(A.g!="")b&&(A.g=b+"."+A.g),gi(A,A.u);else{var Z=d.location;A=Z.protocol,b=b?b+"."+Z.hostname:Z.hostname,Z=+Z.port;const ae=new ls(null);A&&En(ae,A),b&&(ae.g=b),Z&&gi(ae,Z),w&&(ae.h=w),A=ae}return w=h.G,b=h.wa,w&&b&&At(A,w,b),At(A,"VER",h.ka),Tr(h,A),A}function Ou(h,b,w){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new kt(new da({ab:w})):new kt(h.ma),b.Fa(h.L),b}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vu(){}s=Vu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function Ei(){}Ei.prototype.g=function(h,b){return new $n(h,b)};function $n(h,b){vt.call(this),this.g=new _i(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!D(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!D(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new Ba(this)}_($n,vt),$n.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){zo(this.g)},$n.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.v&&(w={},w.__data__=_s(h),h=w);b.i.push(new on(b.Ya++,h)),b.I==3&&ma(b)},$n.prototype.N=function(){this.g.l=null,delete this.j,zo(this.g),delete this.g,$n.Z.N.call(this)};function Pu(h){G.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const w in b){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}_(Pu,G);function Lu(){de.call(this),this.status=1}_(Lu,de);function Ba(h){this.g=h}_(Ba,Vu),Ba.prototype.ra=function(){je(this.g,"a")},Ba.prototype.qa=function(h){je(this.g,new Pu(h))},Ba.prototype.pa=function(h){je(this.g,new Lu)},Ba.prototype.oa=function(){je(this.g,"b")},Ei.prototype.createWebChannel=Ei.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,C1=function(){return new Ei},A1=function(){return Te()},j1=ce,Kp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Us.NO_ERROR=0,Us.TIMEOUT=8,Us.HTTP_ERROR=6,ih=Us,Va.COMPLETE="complete",T1=Va,Oa.EventType=R,R.OPEN="a",R.CLOSE="b",R.ERROR="c",R.MESSAGE="d",vt.prototype.listen=vt.prototype.J,Mc=Oa,kt.prototype.listenOnce=kt.prototype.K,kt.prototype.getLastError=kt.prototype.Ha,kt.prototype.getLastErrorCode=kt.prototype.ya,kt.prototype.getStatus=kt.prototype.ca,kt.prototype.getResponseJson=kt.prototype.La,kt.prototype.getResponseText=kt.prototype.la,kt.prototype.send=kt.prototype.ea,kt.prototype.setWithCredentials=kt.prototype.Fa,S1=kt}).apply(typeof Hd<"u"?Hd:typeof self<"u"?self:typeof window<"u"?window:{});let Un=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Un.UNAUTHENTICATED=new Un(null),Un.GOOGLE_CREDENTIALS=new Un("google-credentials-uid"),Un.FIRST_PARTY=new Un("first-party-uid"),Un.MOCK_USER=new Un("mock-user");let So="12.8.0";function KC(s){So=s}const nl=new Ag("@firebase/firestore");function eo(){return nl.logLevel}function ke(s,...e){if(nl.logLevel<=ft.DEBUG){const n=e.map(Ug);nl.debug(`Firestore (${So}): ${s}`,...n)}}function ui(s,...e){if(nl.logLevel<=ft.ERROR){const n=e.map(Ug);nl.error(`Firestore (${So}): ${s}`,...n)}}function fo(s,...e){if(nl.logLevel<=ft.WARN){const n=e.map(Ug);nl.warn(`Firestore (${So}): ${s}`,...n)}}function Ug(s){if(typeof s=="string")return s;try{return(function(n){return JSON.stringify(n)})(s)}catch{return s}}function Ke(s,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,R1(s,i,n)}function R1(s,e,n){let i=`FIRESTORE (${So}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw ui(i),new Error(i)}function jt(s,e,n,i){let o="Unexpected state";typeof n=="string"?o=n:i=n,s||R1(e,o,i)}function Ze(s,e){return s}const ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ae extends Ma{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ri{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class k1{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Un.UNAUTHENTICATED)))}shutdown(){}}class WC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class XC{constructor(e){this.t=e,this.currentUser=Un.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){jt(this.o===void 0,42304);let i=this.i;const o=g=>this.i!==i?(i=this.i,n(g)):Promise.resolve();let u=new ri;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new ri,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await o(this.currentUser)}))},p=g=>{ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new ri)}}),0),d()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(jt(typeof i.accessToken=="string",31837,{l:i}),new k1(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return jt(e===null||typeof e=="string",2055,{h:e}),new Un(e)}}class JC{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=Un.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class ZC{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new JC(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Un.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Hv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eR{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ps(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){jt(this.o===void 0,3512);const i=u=>{u.error!=null&&ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,ke("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?n(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const o=u=>{ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>o(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?o(u):ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Hv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(jt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Hv(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function tR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<s;i++)n[i]=Math.floor(256*Math.random());return n}class Bg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=tR(40);for(let u=0;u<o.length;++u)i.length<20&&o[u]<n&&(i+=e.charAt(o[u]%62))}return i}}function mt(s,e){return s<e?-1:s>e?1:0}function Qp(s,e){const n=Math.min(s.length,e.length);for(let i=0;i<n;i++){const o=s.charAt(i),u=e.charAt(i);if(o!==u)return _p(o)===_p(u)?mt(o,u):_p(o)?1:-1}return mt(s.length,e.length)}const nR=55296,sR=57343;function _p(s){const e=s.charCodeAt(0);return e>=nR&&e<=sR}function mo(s,e,n){return s.length===e.length&&s.every(((i,o)=>n(i,e[o])))}const $v="__name__";class wa{constructor(e,n,i){n===void 0?n=0:n>e.length&&Ke(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Ke(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return wa.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof wa?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let o=0;o<i;o++){const u=wa.compareSegments(e.get(o),n.get(o));if(u!==0)return u}return mt(e.length,n.length)}static compareSegments(e,n){const i=wa.isNumericId(e),o=wa.isNumericId(n);return i&&!o?-1:!i&&o?1:i&&o?wa.extractNumericId(e).compare(wa.extractNumericId(n)):Qp(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return nr.fromString(e.substring(4,e.length-2))}}class Pt extends wa{construct(e,n,i){return new Pt(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ae(ge.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((o=>o.length>0)))}return new Pt(n)}static emptyPath(){return new Pt([])}}const aR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Mn extends wa{construct(e,n,i){return new Mn(e,n,i)}static isValidIdentifier(e){return aR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Mn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$v}static keyField(){return new Mn([$v])}static fromServerFormat(e){const n=[];let i="",o=0;const u=()=>{if(i.length===0)throw new Ae(ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let d=!1;for(;o<e.length;){const p=e[o];if(p==="\\"){if(o+1===e.length)throw new Ae(ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[o+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ae(ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,o+=2}else p==="`"?(d=!d,o++):p!=="."||d?(i+=p,o++):(u(),o++)}if(u(),d)throw new Ae(ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Mn(n)}static emptyPath(){return new Mn([])}}class He{constructor(e){this.path=e}static fromPath(e){return new He(Pt.fromString(e))}static fromName(e){return new He(Pt.fromString(e).popFirst(5))}static empty(){return new He(Pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Pt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new He(new Pt(e.slice()))}}function I1(s,e,n){if(!n)throw new Ae(ge.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function iR(s,e,n,i){if(e===!0&&i===!0)throw new Ae(ge.INVALID_ARGUMENT,`${s} and ${n} cannot be used together.`)}function Gv(s){if(!He.isDocumentKey(s))throw new Ae(ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function Yv(s){if(He.isDocumentKey(s))throw new Ae(ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function D1(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Fh(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Ke(12329,{type:typeof s})}function as(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ae(ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Fh(s);throw new Ae(ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return s}function gn(s,e){const n={typeString:s};return e&&(n.value=e),n}function fu(s,e){if(!D1(s))throw new Ae(ge.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const o=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){n=`JSON missing required field: '${i}'`;break}const d=s[i];if(o&&typeof d!==o){n=`JSON field '${i}' must be a ${o}.`;break}if(u!==void 0&&d!==u.value){n=`Expected '${i}' field to equal '${u.value}'`;break}}if(n)throw new Ae(ge.INVALID_ARGUMENT,n);return!0}const Kv=-62135596800,Qv=1e6;class Tt{static now(){return Tt.fromMillis(Date.now())}static fromDate(e){return Tt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*Qv);return new Tt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Ae(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ae(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Kv)throw new Ae(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ae(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Qv}_compareTo(e){return this.seconds===e.seconds?mt(this.nanoseconds,e.nanoseconds):mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Tt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(fu(e,Tt._jsonSchema))return new Tt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Kv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Tt._jsonSchemaVersion="firestore/timestamp/1.0",Tt._jsonSchema={type:gn("string",Tt._jsonSchemaVersion),seconds:gn("number"),nanoseconds:gn("number")};class We{static fromTimestamp(e){return new We(e)}static min(){return new We(new Tt(0,0))}static max(){return new We(new Tt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Xc=-1;function rR(s,e){const n=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,o=We.fromTimestamp(i===1e9?new Tt(n+1,0):new Tt(n,i));return new lr(o,He.empty(),e)}function lR(s){return new lr(s.readTime,s.key,Xc)}class lr{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new lr(We.min(),He.empty(),Xc)}static max(){return new lr(We.max(),He.empty(),Xc)}}function oR(s,e){let n=s.readTime.compareTo(e.readTime);return n!==0?n:(n=He.comparator(s.documentKey,e.documentKey),n!==0?n:mt(s.largestBatchId,e.largestBatchId))}const cR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function To(s){if(s.code!==ge.FAILED_PRECONDITION||s.message!==cR)throw s;ke("LocalStore","Unexpectedly lost primary lease")}class be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new be(((i,o)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,o)},this.catchCallback=u=>{this.wrapFailure(n,u).next(i,o)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof be?n:be.resolve(n)}catch(n){return be.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):be.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):be.reject(n)}static resolve(e){return new be(((n,i)=>{n(e)}))}static reject(e){return new be(((n,i)=>{i(e)}))}static waitFor(e){return new be(((n,i)=>{let o=0,u=0,d=!1;e.forEach((p=>{++o,p.next((()=>{++u,d&&u===o&&n()}),(g=>i(g)))})),d=!0,u===o&&n()}))}static or(e){let n=be.resolve(!1);for(const i of e)n=n.next((o=>o?be.resolve(o):i()));return n}static forEach(e,n){const i=[];return e.forEach(((o,u)=>{i.push(n.call(this,o,u))})),this.waitFor(i)}static mapArray(e,n){return new be(((i,o)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const x=g;n(e[x]).next((y=>{d[x]=y,++p,p===u&&i(d)}),(y=>o(y)))}}))}static doWhile(e,n){return new be(((i,o)=>{const u=()=>{e()===!0?n().next((()=>{u()}),o):i()};u()}))}}function dR(s){const e=s.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function jo(s){return s.name==="IndexedDbTransactionError"}class Hh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Hh.ce=-1;const zg=-1;function $h(s){return s==null}function _h(s){return s===0&&1/s==-1/0}function hR(s){return typeof s=="number"&&Number.isInteger(s)&&!_h(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const M1="";function fR(s){let e="";for(let n=0;n<s.length;n++)e.length>0&&(e=Wv(e)),e=mR(s.get(n),e);return Wv(e)}function mR(s,e){let n=e;const i=s.length;for(let o=0;o<i;o++){const u=s.charAt(o);switch(u){case"\0":n+="";break;case M1:n+="";break;default:n+=u}}return n}function Wv(s){return s+M1+""}function Xv(s){let e=0;for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e++;return e}function br(s,e){for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e(n,s[n])}function O1(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Yt{constructor(e,n){this.comparator=e,this.root=n||Dn.EMPTY}insert(e,n){return new Yt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Dn.BLACK,null,null))}remove(e){return new Yt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return n+i.left.size;o<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $d(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $d(this.root,e,this.comparator,!1)}getReverseIterator(){return new $d(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $d(this.root,e,this.comparator,!0)}}class $d{constructor(e,n,i,o){this.isReverse=o,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=n?i(e.key,n):1,n&&o&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dn{constructor(e,n,i,o,u){this.key=e,this.value=n,this.color=i??Dn.RED,this.left=o??Dn.EMPTY,this.right=u??Dn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,o,u){return new Dn(e??this.key,n??this.value,i??this.color,o??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let o=this;const u=i(e,o.key);return o=u<0?o.copy(null,null,null,o.left.insert(e,n,i),null):u===0?o.copy(null,n,null,null,null):o.copy(null,null,null,null,o.right.insert(e,n,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Dn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,o=this;if(n(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,n),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),n(e,o.key)===0){if(o.right.isEmpty())return Dn.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,n))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ke(27949);return e+(this.isRed()?0:1)}}Dn.EMPTY=null,Dn.RED=!0,Dn.BLACK=!1;Dn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ke(57766)}get value(){throw Ke(16141)}get color(){throw Ke(16727)}get left(){throw Ke(29726)}get right(){throw Ke(36894)}copy(e,n,i,o,u){return this}insert(e,n,i){return new Dn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class vn{constructor(e){this.comparator=e,this.data=new Yt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;n(o.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Jv(this.data.getIterator())}getIteratorFrom(e){return new Jv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof vn)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const o=n.getNext().key,u=i.getNext().key;if(this.comparator(o,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new vn(this.comparator);return n.data=e,n}}class Jv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class gs{constructor(e){this.fields=e,e.sort(Mn.comparator)}static empty(){return new gs([])}unionWith(e){let n=new vn(Mn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new gs(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return mo(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class V1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class On{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(o){try{return atob(o)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new V1("Invalid base64 string: "+u):u}})(e);return new On(n)}static fromUint8Array(e){const n=(function(o){let u="";for(let d=0;d<o.length;++d)u+=String.fromCharCode(o[d]);return u})(e);return new On(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let o=0;o<n.length;o++)i[o]=n.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}On.EMPTY_BYTE_STRING=new On("");const pR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function or(s){if(jt(!!s,39018),typeof s=="string"){let e=0;const n=pR.exec(s);if(jt(!!n,46558,{timestamp:s}),n[1]){let o=n[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:an(s.seconds),nanos:an(s.nanos)}}function an(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function cr(s){return typeof s=="string"?On.fromBase64String(s):On.fromUint8Array(s)}const P1="server_timestamp",L1="__type__",U1="__previous_value__",B1="__local_write_time__";function qg(s){return(s?.mapValue?.fields||{})[L1]?.stringValue===P1}function Gh(s){const e=s.mapValue.fields[U1];return qg(e)?Gh(e):e}function Jc(s){const e=or(s.mapValue.fields[B1].timestampValue);return new Tt(e.seconds,e.nanos)}class gR{constructor(e,n,i,o,u,d,p,g,x,y,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=o,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=x,this.isUsingEmulator=y,this.apiKey=_}}const Nh="(default)";class Zc{constructor(e,n){this.projectId=e,this.database=n||Nh}static empty(){return new Zc("","")}get isDefaultDatabase(){return this.database===Nh}isEqual(e){return e instanceof Zc&&e.projectId===this.projectId&&e.database===this.database}}function xR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new Ae(ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zc(s.options.projectId,e)}const z1="__type__",bR="__max__",Gd={mapValue:{}},q1="__vector__",Eh="value";function ur(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?qg(s)?4:vR(s)?9007199254740991:yR(s)?10:11:Ke(28295,{value:s})}function Ia(s,e){if(s===e)return!0;const n=ur(s);if(n!==ur(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Jc(s).isEqual(Jc(e));case 3:return(function(o,u){if(typeof o.timestampValue=="string"&&typeof u.timestampValue=="string"&&o.timestampValue.length===u.timestampValue.length)return o.timestampValue===u.timestampValue;const d=or(o.timestampValue),p=or(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(o,u){return cr(o.bytesValue).isEqual(cr(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(o,u){return an(o.geoPointValue.latitude)===an(u.geoPointValue.latitude)&&an(o.geoPointValue.longitude)===an(u.geoPointValue.longitude)})(s,e);case 2:return(function(o,u){if("integerValue"in o&&"integerValue"in u)return an(o.integerValue)===an(u.integerValue);if("doubleValue"in o&&"doubleValue"in u){const d=an(o.doubleValue),p=an(u.doubleValue);return d===p?_h(d)===_h(p):isNaN(d)&&isNaN(p)}return!1})(s,e);case 9:return mo(s.arrayValue.values||[],e.arrayValue.values||[],Ia);case 10:case 11:return(function(o,u){const d=o.mapValue.fields||{},p=u.mapValue.fields||{};if(Xv(d)!==Xv(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Ia(d[g],p[g])))return!1;return!0})(s,e);default:return Ke(52216,{left:s})}}function eu(s,e){return(s.values||[]).find((n=>Ia(n,e)))!==void 0}function po(s,e){if(s===e)return 0;const n=ur(s),i=ur(e);if(n!==i)return mt(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return mt(s.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=an(u.integerValue||u.doubleValue),g=an(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return Zv(s.timestampValue,e.timestampValue);case 4:return Zv(Jc(s),Jc(e));case 5:return Qp(s.stringValue,e.stringValue);case 6:return(function(u,d){const p=cr(u),g=cr(d);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let x=0;x<p.length&&x<g.length;x++){const y=mt(p[x],g[x]);if(y!==0)return y}return mt(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=mt(an(u.latitude),an(d.latitude));return p!==0?p:mt(an(u.longitude),an(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return ew(s.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},x=p[Eh]?.arrayValue,y=g[Eh]?.arrayValue,_=mt(x?.values?.length||0,y?.values?.length||0);return _!==0?_:ew(x,y)})(s.mapValue,e.mapValue);case 11:return(function(u,d){if(u===Gd.mapValue&&d===Gd.mapValue)return 0;if(u===Gd.mapValue)return 1;if(d===Gd.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),x=d.fields||{},y=Object.keys(x);g.sort(),y.sort();for(let _=0;_<g.length&&_<y.length;++_){const S=Qp(g[_],y[_]);if(S!==0)return S;const C=po(p[g[_]],x[y[_]]);if(C!==0)return C}return mt(g.length,y.length)})(s.mapValue,e.mapValue);default:throw Ke(23264,{he:n})}}function Zv(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return mt(s,e);const n=or(s),i=or(e),o=mt(n.seconds,i.seconds);return o!==0?o:mt(n.nanos,i.nanos)}function ew(s,e){const n=s.values||[],i=e.values||[];for(let o=0;o<n.length&&o<i.length;++o){const u=po(n[o],i[o]);if(u)return u}return mt(n.length,i.length)}function go(s){return Wp(s)}function Wp(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(n){const i=or(n);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(n){return cr(n).toBase64()})(s.bytesValue):"referenceValue"in s?(function(n){return He.fromName(n).toString()})(s.referenceValue):"geoPointValue"in s?(function(n){return`geo(${n.latitude},${n.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(n){let i="[",o=!0;for(const u of n.values||[])o?o=!1:i+=",",i+=Wp(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(n){const i=Object.keys(n.fields||{}).sort();let o="{",u=!0;for(const d of i)u?u=!1:o+=",",o+=`${d}:${Wp(n.fields[d])}`;return o+"}"})(s.mapValue):Ke(61005,{value:s})}function rh(s){switch(ur(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Gh(s);return e?16+rh(e):16;case 5:return 2*s.stringValue.length;case 6:return cr(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,u)=>o+rh(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let o=0;return br(i.fields,((u,d)=>{o+=u.length+rh(d)})),o})(s.mapValue);default:throw Ke(13486,{value:s})}}function tw(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Xp(s){return!!s&&"integerValue"in s}function Fg(s){return!!s&&"arrayValue"in s}function nw(s){return!!s&&"nullValue"in s}function sw(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function lh(s){return!!s&&"mapValue"in s}function yR(s){return(s?.mapValue?.fields||{})[z1]?.stringValue===q1}function zc(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return br(s.mapValue.fields,((n,i)=>e.mapValue.fields[n]=zc(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(s.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=zc(s.arrayValue.values[n]);return e}return{...s}}function vR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===bR}class ns{constructor(e){this.value=e}static empty(){return new ns({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!lh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=zc(n)}setAll(e){let n=Mn.emptyPath(),i={},o=[];e.forEach(((d,p)=>{if(!n.isImmediateParentOf(p)){const g=this.getFieldsMap(n);this.applyChanges(g,i,o),i={},o=[],n=p.popLast()}d?i[p.lastSegment()]=zc(d):o.push(p.lastSegment())}));const u=this.getFieldsMap(n);this.applyChanges(u,i,o)}delete(e){const n=this.field(e.popLast());lh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ia(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=n.mapValue.fields[e.get(i)];lh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=o),n=o}return n.mapValue.fields}applyChanges(e,n,i){br(n,((o,u)=>e[o]=u));for(const o of i)delete e[o]}clone(){return new ns(zc(this.value))}}function F1(s){const e=[];return br(s.fields,((n,i)=>{const o=new Mn([n]);if(lh(i)){const u=F1(i.mapValue).fields;if(u.length===0)e.push(o);else for(const d of u)e.push(o.child(d))}else e.push(o)})),new gs(e)}class Bn{constructor(e,n,i,o,u,d,p){this.key=e,this.documentType=n,this.version=i,this.readTime=o,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new Bn(e,0,We.min(),We.min(),We.min(),ns.empty(),0)}static newFoundDocument(e,n,i,o){return new Bn(e,1,n,We.min(),i,o,0)}static newNoDocument(e,n){return new Bn(e,2,n,We.min(),We.min(),ns.empty(),0)}static newUnknownDocument(e,n){return new Bn(e,3,n,We.min(),We.min(),ns.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(We.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ns.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ns.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=We.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Sh{constructor(e,n){this.position=e,this.inclusive=n}}function aw(s,e,n){let i=0;for(let o=0;o<s.position.length;o++){const u=e[o],d=s.position[o];if(u.field.isKeyField()?i=He.comparator(He.fromName(d.referenceValue),n.key):i=po(d,n.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function iw(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let n=0;n<s.position.length;n++)if(!Ia(s.position[n],e.position[n]))return!1;return!0}class Th{constructor(e,n="asc"){this.field=e,this.dir=n}}function wR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class H1{}class pn extends H1{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new NR(e,n,i):n==="array-contains"?new TR(e,i):n==="in"?new jR(e,i):n==="not-in"?new AR(e,i):n==="array-contains-any"?new CR(e,i):new pn(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new ER(e,i):new SR(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(po(n,this.value)):n!==null&&ur(this.value)===ur(n)&&this.matchesComparison(po(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ea extends H1{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new ea(e,n)}matches(e){return $1(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function $1(s){return s.op==="and"}function G1(s){return _R(s)&&$1(s)}function _R(s){for(const e of s.filters)if(e instanceof ea)return!1;return!0}function Jp(s){if(s instanceof pn)return s.field.canonicalString()+s.op.toString()+go(s.value);if(G1(s))return s.filters.map((e=>Jp(e))).join(",");{const e=s.filters.map((n=>Jp(n))).join(",");return`${s.op}(${e})`}}function Y1(s,e){return s instanceof pn?(function(i,o){return o instanceof pn&&i.op===o.op&&i.field.isEqual(o.field)&&Ia(i.value,o.value)})(s,e):s instanceof ea?(function(i,o){return o instanceof ea&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((u,d,p)=>u&&Y1(d,o.filters[p])),!0):!1})(s,e):void Ke(19439)}function K1(s){return s instanceof pn?(function(n){return`${n.field.canonicalString()} ${n.op} ${go(n.value)}`})(s):s instanceof ea?(function(n){return n.op.toString()+" {"+n.getFilters().map(K1).join(" ,")+"}"})(s):"Filter"}class NR extends pn{constructor(e,n,i){super(e,n,i),this.key=He.fromName(i.referenceValue)}matches(e){const n=He.comparator(e.key,this.key);return this.matchesComparison(n)}}class ER extends pn{constructor(e,n){super(e,"in",n),this.keys=Q1("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class SR extends pn{constructor(e,n){super(e,"not-in",n),this.keys=Q1("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function Q1(s,e){return(e.arrayValue?.values||[]).map((n=>He.fromName(n.referenceValue)))}class TR extends pn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Fg(n)&&eu(n.arrayValue,this.value)}}class jR extends pn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&eu(this.value.arrayValue,n)}}class AR extends pn{constructor(e,n){super(e,"not-in",n)}matches(e){if(eu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!eu(this.value.arrayValue,n)}}class CR extends pn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Fg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>eu(this.value.arrayValue,i)))}}class RR{constructor(e,n=null,i=[],o=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=o,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function rw(s,e=null,n=[],i=[],o=null,u=null,d=null){return new RR(s,e,n,i,o,u,d)}function Hg(s){const e=Ze(s);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>Jp(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),$h(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>go(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>go(i))).join(",")),e.Te=n}return e.Te}function $g(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<s.orderBy.length;n++)if(!wR(s.orderBy[n],e.orderBy[n]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let n=0;n<s.filters.length;n++)if(!Y1(s.filters[n],e.filters[n]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!iw(s.startAt,e.startAt)&&iw(s.endAt,e.endAt)}function Zp(s){return He.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class mu{constructor(e,n=null,i=[],o=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=o,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function kR(s,e,n,i,o,u,d,p){return new mu(s,e,n,i,o,u,d,p)}function Yh(s){return new mu(s)}function lw(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function IR(s){return He.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function W1(s){return s.collectionGroup!==null}function qc(s){const e=Ze(s);if(e.Ie===null){e.Ie=[];const n=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),n.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new vn(Mn.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((x=>{x.isInequality()&&(p=p.add(x.field))}))})),p})(e).forEach((u=>{n.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Th(u,i))})),n.has(Mn.keyField().canonicalString())||e.Ie.push(new Th(Mn.keyField(),i))}return e.Ie}function ja(s){const e=Ze(s);return e.Ee||(e.Ee=DR(e,qc(s))),e.Ee}function DR(s,e){if(s.limitType==="F")return rw(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((o=>{const u=o.dir==="desc"?"asc":"desc";return new Th(o.field,u)}));const n=s.endAt?new Sh(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Sh(s.startAt.position,s.startAt.inclusive):null;return rw(s.path,s.collectionGroup,e,s.filters,s.limit,n,i)}}function eg(s,e){const n=s.filters.concat([e]);return new mu(s.path,s.collectionGroup,s.explicitOrderBy.slice(),n,s.limit,s.limitType,s.startAt,s.endAt)}function tg(s,e,n){return new mu(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,n,s.startAt,s.endAt)}function Kh(s,e){return $g(ja(s),ja(e))&&s.limitType===e.limitType}function X1(s){return`${Hg(ja(s))}|lt:${s.limitType}`}function to(s){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((o=>K1(o))).join(", ")}]`),$h(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((o=>go(o))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((o=>go(o))).join(",")),`Target(${i})`})(ja(s))}; limitType=${s.limitType})`}function Qh(s,e){return e.isFoundDocument()&&(function(i,o){const u=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):He.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,o){for(const u of qc(i))if(!u.field.isKeyField()&&o.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,o){for(const u of i.filters)if(!u.matches(o))return!1;return!0})(s,e)&&(function(i,o){return!(i.startAt&&!(function(d,p,g){const x=aw(d,p,g);return d.inclusive?x<=0:x<0})(i.startAt,qc(i),o)||i.endAt&&!(function(d,p,g){const x=aw(d,p,g);return d.inclusive?x>=0:x>0})(i.endAt,qc(i),o))})(s,e)}function MR(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function J1(s){return(e,n)=>{let i=!1;for(const o of qc(s)){const u=OR(o,e,n);if(u!==0)return u;i=i||o.field.isKeyField()}return 0}}function OR(s,e,n){const i=s.field.isKeyField()?He.comparator(e.key,n.key):(function(u,d,p){const g=d.data.field(u),x=p.data.field(u);return g!==null&&x!==null?po(g,x):Ke(42886)})(s.field,e,n);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return Ke(19790,{direction:s.dir})}}class dl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[o,u]of i)if(this.equalsFn(o,e))return u}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let u=0;u<o.length;u++)if(this.equalsFn(o[u][0],e))return void(o[u]=[e,n]);o.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[n]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){br(this.inner,((n,i)=>{for(const[o,u]of i)e(o,u)}))}isEmpty(){return O1(this.inner)}size(){return this.innerSize}}const VR=new Yt(He.comparator);function di(){return VR}const Z1=new Yt(He.comparator);function Oc(...s){let e=Z1;for(const n of s)e=e.insert(n.key,n);return e}function eN(s){let e=Z1;return s.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function Kr(){return Fc()}function tN(){return Fc()}function Fc(){return new dl((s=>s.toString()),((s,e)=>s.isEqual(e)))}const PR=new Yt(He.comparator),LR=new vn(He.comparator);function pt(...s){let e=LR;for(const n of s)e=e.add(n);return e}const UR=new vn(mt);function BR(){return UR}function Gg(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_h(e)?"-0":e}}function nN(s){return{integerValue:""+s}}function zR(s,e){return hR(e)?nN(e):Gg(s,e)}class Wh{constructor(){this._=void 0}}function qR(s,e,n){return s instanceof tu?(function(o,u){const d={fields:{[L1]:{stringValue:P1},[B1]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return u&&qg(u)&&(u=Gh(u)),u&&(d.fields[U1]=u),{mapValue:d}})(n,e):s instanceof nu?aN(s,e):s instanceof su?iN(s,e):(function(o,u){const d=sN(o,u),p=ow(d)+ow(o.Ae);return Xp(d)&&Xp(o.Ae)?nN(p):Gg(o.serializer,p)})(s,e)}function FR(s,e,n){return s instanceof nu?aN(s,e):s instanceof su?iN(s,e):n}function sN(s,e){return s instanceof jh?(function(i){return Xp(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class tu extends Wh{}class nu extends Wh{constructor(e){super(),this.elements=e}}function aN(s,e){const n=rN(e);for(const i of s.elements)n.some((o=>Ia(o,i)))||n.push(i);return{arrayValue:{values:n}}}class su extends Wh{constructor(e){super(),this.elements=e}}function iN(s,e){let n=rN(e);for(const i of s.elements)n=n.filter((o=>!Ia(o,i)));return{arrayValue:{values:n}}}class jh extends Wh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function ow(s){return an(s.integerValue||s.doubleValue)}function rN(s){return Fg(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class HR{constructor(e,n){this.field=e,this.transform=n}}function $R(s,e){return s.field.isEqual(e.field)&&(function(i,o){return i instanceof nu&&o instanceof nu||i instanceof su&&o instanceof su?mo(i.elements,o.elements,Ia):i instanceof jh&&o instanceof jh?Ia(i.Ae,o.Ae):i instanceof tu&&o instanceof tu})(s.transform,e.transform)}class GR{constructor(e,n){this.version=e,this.transformResults=n}}class Vs{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Vs}static exists(e){return new Vs(void 0,e)}static updateTime(e){return new Vs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function oh(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Xh{}function lN(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new Yg(s.key,Vs.none()):new pu(s.key,s.data,Vs.none());{const n=s.data,i=ns.empty();let o=new vn(Mn.comparator);for(let u of e.fields)if(!o.has(u)){let d=n.field(u);d===null&&u.length>1&&(u=u.popLast(),d=n.field(u)),d===null?i.delete(u):i.set(u,d),o=o.add(u)}return new yr(s.key,i,new gs(o.toArray()),Vs.none())}}function YR(s,e,n){s instanceof pu?(function(o,u,d){const p=o.value.clone(),g=uw(o.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(s,e,n):s instanceof yr?(function(o,u,d){if(!oh(o.precondition,u))return void u.convertToUnknownDocument(d.version);const p=uw(o.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(oN(o)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(s,e,n):(function(o,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,n)}function Hc(s,e,n,i){return s instanceof pu?(function(u,d,p,g){if(!oh(u.precondition,d))return p;const x=u.value.clone(),y=dw(u.fieldTransforms,g,d);return x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),null})(s,e,n,i):s instanceof yr?(function(u,d,p,g){if(!oh(u.precondition,d))return p;const x=dw(u.fieldTransforms,g,d),y=d.data;return y.setAll(oN(u)),y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((_=>_.field)))})(s,e,n,i):(function(u,d,p){return oh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(s,e,n)}function KR(s,e){let n=null;for(const i of s.fieldTransforms){const o=e.data.field(i.field),u=sN(i.transform,o||null);u!=null&&(n===null&&(n=ns.empty()),n.set(i.field,u))}return n||null}function cw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&mo(i,o,((u,d)=>$R(u,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class pu extends Xh{constructor(e,n,i,o=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class yr extends Xh{constructor(e,n,i,o,u=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=o,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function oN(s){const e=new Map;return s.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=s.data.field(n);e.set(n,i)}})),e}function uw(s,e,n){const i=new Map;jt(s.length===n.length,32656,{Ve:n.length,de:s.length});for(let o=0;o<n.length;o++){const u=s[o],d=u.transform,p=e.data.field(u.field);i.set(u.field,FR(d,p,n[o]))}return i}function dw(s,e,n){const i=new Map;for(const o of s){const u=o.transform,d=n.data.field(o.field);i.set(o.field,qR(u,d,e))}return i}class Yg extends Xh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class QR extends Xh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class WR{constructor(e,n,i,o){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let o=0;o<this.mutations.length;o++){const u=this.mutations[o];u.key.isEqual(e.key)&&YR(u,e,i[o])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=Hc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=Hc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=tN();return this.mutations.forEach((o=>{const u=e.get(o.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=n.has(o.key)?null:p;const g=lN(d,p);g!==null&&i.set(o.key,g),d.isValidDocument()||d.convertToNoDocument(We.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),pt())}isEqual(e){return this.batchId===e.batchId&&mo(this.mutations,e.mutations,((n,i)=>cw(n,i)))&&mo(this.baseMutations,e.baseMutations,((n,i)=>cw(n,i)))}}class Kg{constructor(e,n,i,o){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=o}static from(e,n,i){jt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return PR})();const u=e.mutations;for(let d=0;d<u.length;d++)o=o.insert(u[d].key,i[d].version);return new Kg(e,n,i,o)}}class XR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class JR{constructor(e,n){this.count=e,this.unchangedNames=n}}var mn,yt;function ZR(s){switch(s){case ge.OK:return Ke(64938);case ge.CANCELLED:case ge.UNKNOWN:case ge.DEADLINE_EXCEEDED:case ge.RESOURCE_EXHAUSTED:case ge.INTERNAL:case ge.UNAVAILABLE:case ge.UNAUTHENTICATED:return!1;case ge.INVALID_ARGUMENT:case ge.NOT_FOUND:case ge.ALREADY_EXISTS:case ge.PERMISSION_DENIED:case ge.FAILED_PRECONDITION:case ge.ABORTED:case ge.OUT_OF_RANGE:case ge.UNIMPLEMENTED:case ge.DATA_LOSS:return!0;default:return Ke(15467,{code:s})}}function cN(s){if(s===void 0)return ui("GRPC error has no .code"),ge.UNKNOWN;switch(s){case mn.OK:return ge.OK;case mn.CANCELLED:return ge.CANCELLED;case mn.UNKNOWN:return ge.UNKNOWN;case mn.DEADLINE_EXCEEDED:return ge.DEADLINE_EXCEEDED;case mn.RESOURCE_EXHAUSTED:return ge.RESOURCE_EXHAUSTED;case mn.INTERNAL:return ge.INTERNAL;case mn.UNAVAILABLE:return ge.UNAVAILABLE;case mn.UNAUTHENTICATED:return ge.UNAUTHENTICATED;case mn.INVALID_ARGUMENT:return ge.INVALID_ARGUMENT;case mn.NOT_FOUND:return ge.NOT_FOUND;case mn.ALREADY_EXISTS:return ge.ALREADY_EXISTS;case mn.PERMISSION_DENIED:return ge.PERMISSION_DENIED;case mn.FAILED_PRECONDITION:return ge.FAILED_PRECONDITION;case mn.ABORTED:return ge.ABORTED;case mn.OUT_OF_RANGE:return ge.OUT_OF_RANGE;case mn.UNIMPLEMENTED:return ge.UNIMPLEMENTED;case mn.DATA_LOSS:return ge.DATA_LOSS;default:return Ke(39323,{code:s})}}(yt=mn||(mn={}))[yt.OK=0]="OK",yt[yt.CANCELLED=1]="CANCELLED",yt[yt.UNKNOWN=2]="UNKNOWN",yt[yt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yt[yt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yt[yt.NOT_FOUND=5]="NOT_FOUND",yt[yt.ALREADY_EXISTS=6]="ALREADY_EXISTS",yt[yt.PERMISSION_DENIED=7]="PERMISSION_DENIED",yt[yt.UNAUTHENTICATED=16]="UNAUTHENTICATED",yt[yt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yt[yt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yt[yt.ABORTED=10]="ABORTED",yt[yt.OUT_OF_RANGE=11]="OUT_OF_RANGE",yt[yt.UNIMPLEMENTED=12]="UNIMPLEMENTED",yt[yt.INTERNAL=13]="INTERNAL",yt[yt.UNAVAILABLE=14]="UNAVAILABLE",yt[yt.DATA_LOSS=15]="DATA_LOSS";function e4(){return new TextEncoder}const t4=new nr([4294967295,4294967295],0);function hw(s){const e=e4().encode(s),n=new E1;return n.update(e),new Uint8Array(n.digest())}function fw(s){const e=new DataView(s.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new nr([n,i],0),new nr([o,u],0)]}class Qg{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Vc(`Invalid padding: ${n}`);if(i<0)throw new Vc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Vc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Vc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=nr.fromNumber(this.ge)}ye(e,n,i){let o=e.add(n.multiply(nr.fromNumber(i)));return o.compare(t4)===1&&(o=new nr([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=hw(e),[i,o]=fw(n);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,o,u);if(!this.we(d))return!1}return!0}static create(e,n,i){const o=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new Qg(u,o,n);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const n=hw(e),[i,o]=fw(n);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,o,u);this.be(d)}}be(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Vc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Jh{constructor(e,n,i,o,u){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const o=new Map;return o.set(e,gu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new Jh(We.min(),o,new Yt(mt),di(),pt())}}class gu{constructor(e,n,i,o,u){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new gu(i,n,pt(),pt(),pt())}}class ch{constructor(e,n,i,o){this.Se=e,this.removedTargetIds=n,this.key=i,this.De=o}}class uN{constructor(e,n){this.targetId=e,this.Ce=n}}class dN{constructor(e,n,i=On.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=o}}class mw{constructor(){this.ve=0,this.Fe=pw(),this.Me=On.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=pt(),n=pt(),i=pt();return this.Fe.forEach(((o,u)=>{switch(u){case 0:e=e.add(o);break;case 2:n=n.add(o);break;case 1:i=i.add(o);break;default:Ke(38017,{changeType:u})}})),new gu(this.Me,this.xe,e,n,i)}Ke(){this.Oe=!1,this.Fe=pw()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,jt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class n4{constructor(e){this.Ge=e,this.ze=new Map,this.je=di(),this.He=Yd(),this.Je=Yd(),this.Ze=new Yt(mt)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Ke(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,o)=>{this.rt(o)&&n(o)}))}st(e){const n=e.targetId,i=e.Ce.count,o=this.ot(n);if(o){const u=o.target;if(Zp(u))if(i===0){const d=new He(u.path);this.et(n,d,Bn.newNoDocument(d,We.min()))}else jt(i===1,20013,{expectedCount:i});else{const d=this._t(n);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(n);const x=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,x)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:u=0}=n;let d,p;try{d=cr(i).toUint8Array()}catch(g){if(g instanceof V1)return fo("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new Qg(d,o,u)}catch(g){return fo(g instanceof Vc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let o=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(n,u,null),o++)})),o}Tt(e){const n=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&Zp(p.target)){const g=new He(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,Bn.newNoDocument(g,e))}u.Be&&(n.set(d,u.ke()),u.Ke())}}));let i=pt();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const x=this.ot(g);return!x||x.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const o=new Jh(e,n,this.Ze,this.je,i);return this.je=di(),this.He=Yd(),this.Je=Yd(),this.Ze=new Yt(mt),o}Ye(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,i),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,n)?o.qe(n,1):o.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new mw,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new vn(mt),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new vn(mt),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ke("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new mw),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Yd(){return new Yt(He.comparator)}function pw(){return new Yt(He.comparator)}const s4={asc:"ASCENDING",desc:"DESCENDING"},a4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},i4={and:"AND",or:"OR"};class r4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ng(s,e){return s.useProto3Json||$h(e)?e:{value:e}}function Ah(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hN(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function l4(s,e){return Ah(s,e.toTimestamp())}function Aa(s){return jt(!!s,49232),We.fromTimestamp((function(n){const i=or(n);return new Tt(i.seconds,i.nanos)})(s))}function Wg(s,e){return sg(s,e).canonicalString()}function sg(s,e){const n=(function(o){return new Pt(["projects",o.projectId,"databases",o.database])})(s).child("documents");return e===void 0?n:n.child(e)}function fN(s){const e=Pt.fromString(s);return jt(bN(e),10190,{key:e.toString()}),e}function ag(s,e){return Wg(s.databaseId,e.path)}function Np(s,e){const n=fN(e);if(n.get(1)!==s.databaseId.projectId)throw new Ae(ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+s.databaseId.projectId);if(n.get(3)!==s.databaseId.database)throw new Ae(ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+s.databaseId.database);return new He(pN(n))}function mN(s,e){return Wg(s.databaseId,e)}function o4(s){const e=fN(s);return e.length===4?Pt.emptyPath():pN(e)}function ig(s){return new Pt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function pN(s){return jt(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function gw(s,e,n){return{name:ag(s,e),fields:n.value.mapValue.fields}}function c4(s,e){let n;if("targetChange"in e){e.targetChange;const i=(function(x){return x==="NO_CHANGE"?0:x==="ADD"?1:x==="REMOVE"?2:x==="CURRENT"?3:x==="RESET"?4:Ke(39313,{state:x})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],u=(function(x,y){return x.useProto3Json?(jt(y===void 0||typeof y=="string",58123),On.fromBase64String(y||"")):(jt(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),On.fromUint8Array(y||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(x){const y=x.code===void 0?ge.UNKNOWN:cN(x.code);return new Ae(y,x.message||"")})(d);n=new dN(i,o,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=Np(s,i.document.name),u=Aa(i.document.updateTime),d=i.document.createTime?Aa(i.document.createTime):We.min(),p=new ns({mapValue:{fields:i.document.fields}}),g=Bn.newFoundDocument(o,u,d,p),x=i.targetIds||[],y=i.removedTargetIds||[];n=new ch(x,y,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=Np(s,i.document),u=i.readTime?Aa(i.readTime):We.min(),d=Bn.newNoDocument(o,u),p=i.removedTargetIds||[];n=new ch([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=Np(s,i.document),u=i.removedTargetIds||[];n=new ch([],u,o,null)}else{if(!("filter"in e))return Ke(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:u}=i,d=new JR(o,u),p=i.targetId;n=new uN(p,d)}}return n}function u4(s,e){let n;if(e instanceof pu)n={update:gw(s,e.key,e.value)};else if(e instanceof Yg)n={delete:ag(s,e.key)};else if(e instanceof yr)n={update:gw(s,e.key,e.data),updateMask:y4(e.fieldMask)};else{if(!(e instanceof QR))return Ke(16599,{dt:e.type});n={verify:ag(s,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof tu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof nu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof su)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof jh)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Ke(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(o,u){return u.updateTime!==void 0?{updateTime:l4(o,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Ke(27497)})(s,e.precondition)),n}function d4(s,e){return s&&s.length>0?(jt(e!==void 0,14353),s.map((n=>(function(o,u){let d=o.updateTime?Aa(o.updateTime):Aa(u);return d.isEqual(We.min())&&(d=Aa(u)),new GR(d,o.transformResults||[])})(n,e)))):[]}function h4(s,e){return{documents:[mN(s,e.path)]}}function f4(s,e){const n={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=mN(s,o);const u=(function(x){if(x.length!==0)return xN(ea.create(x,"and"))})(e.filters);u&&(n.structuredQuery.where=u);const d=(function(x){if(x.length!==0)return x.map((y=>(function(S){return{field:no(S.field),direction:g4(S.dir)}})(y)))})(e.orderBy);d&&(n.structuredQuery.orderBy=d);const p=ng(s,e.limit);return p!==null&&(n.structuredQuery.limit=p),e.startAt&&(n.structuredQuery.startAt=(function(x){return{before:x.inclusive,values:x.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(x){return{before:!x.inclusive,values:x.position}})(e.endAt)),{ft:n,parent:o}}function m4(s){let e=o4(s.parent);const n=s.structuredQuery,i=n.from?n.from.length:0;let o=null;if(i>0){jt(i===1,65062);const y=n.from[0];y.allDescendants?o=y.collectionId:e=e.child(y.collectionId)}let u=[];n.where&&(u=(function(_){const S=gN(_);return S instanceof ea&&G1(S)?S.getFilters():[S]})(n.where));let d=[];n.orderBy&&(d=(function(_){return _.map((S=>(function(H){return new Th(so(H.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(H.direction))})(S)))})(n.orderBy));let p=null;n.limit&&(p=(function(_){let S;return S=typeof _=="object"?_.value:_,$h(S)?null:S})(n.limit));let g=null;n.startAt&&(g=(function(_){const S=!!_.before,C=_.values||[];return new Sh(C,S)})(n.startAt));let x=null;return n.endAt&&(x=(function(_){const S=!_.before,C=_.values||[];return new Sh(C,S)})(n.endAt)),kR(e,o,d,u,p,"F",g,x)}function p4(s,e){const n=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ke(28987,{purpose:o})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function gN(s){return s.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=so(n.unaryFilter.field);return pn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=so(n.unaryFilter.field);return pn.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=so(n.unaryFilter.field);return pn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=so(n.unaryFilter.field);return pn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ke(61313);default:return Ke(60726)}})(s):s.fieldFilter!==void 0?(function(n){return pn.create(so(n.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ke(58110);default:return Ke(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(n){return ea.create(n.compositeFilter.filters.map((i=>gN(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ke(1026)}})(n.compositeFilter.op))})(s):Ke(30097,{filter:s})}function g4(s){return s4[s]}function x4(s){return a4[s]}function b4(s){return i4[s]}function no(s){return{fieldPath:s.canonicalString()}}function so(s){return Mn.fromServerFormat(s.fieldPath)}function xN(s){return s instanceof pn?(function(n){if(n.op==="=="){if(sw(n.value))return{unaryFilter:{field:no(n.field),op:"IS_NAN"}};if(nw(n.value))return{unaryFilter:{field:no(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(sw(n.value))return{unaryFilter:{field:no(n.field),op:"IS_NOT_NAN"}};if(nw(n.value))return{unaryFilter:{field:no(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:no(n.field),op:x4(n.op),value:n.value}}})(s):s instanceof ea?(function(n){const i=n.getFilters().map((o=>xN(o)));return i.length===1?i[0]:{compositeFilter:{op:b4(n.op),filters:i}}})(s):Ke(54877,{filter:s})}function y4(s){const e=[];return s.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function bN(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function yN(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Zi{constructor(e,n,i,o,u=We.min(),d=We.min(),p=On.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class v4{constructor(e){this.yt=e}}function w4(s){const e=m4({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?tg(e,e.limit,"L"):e}class _4{constructor(){this.Sn=new N4}addToCollectionParentIndex(e,n){return this.Sn.add(n),be.resolve()}getCollectionParents(e,n){return be.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return be.resolve()}deleteFieldIndex(e,n){return be.resolve()}deleteAllFieldIndexes(e){return be.resolve()}createTargetIndexes(e,n){return be.resolve()}getDocumentsMatchingTarget(e,n){return be.resolve(null)}getIndexType(e,n){return be.resolve(0)}getFieldIndexes(e,n){return be.resolve([])}getNextCollectionGroupToUpdate(e){return be.resolve(null)}getMinOffset(e,n){return be.resolve(lr.min())}getMinOffsetFromCollectionGroup(e,n){return be.resolve(lr.min())}updateCollectionGroup(e,n,i){return be.resolve()}updateIndexEntries(e,n){return be.resolve()}}class N4{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),o=this.index[n]||new vn(Pt.comparator),u=!o.has(i);return this.index[n]=o.add(i),u}has(e){const n=e.lastSegment(),i=e.popLast(),o=this.index[n];return o&&o.has(i)}getEntries(e){return(this.index[e]||new vn(Pt.comparator)).toArray()}}const xw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vN=41943040;class ts{static withCacheSize(e){return new ts(e,ts.DEFAULT_COLLECTION_PERCENTILE,ts.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}ts.DEFAULT_COLLECTION_PERCENTILE=10,ts.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ts.DEFAULT=new ts(vN,ts.DEFAULT_COLLECTION_PERCENTILE,ts.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ts.DISABLED=new ts(-1,0,0);class xo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new xo(0)}static ar(){return new xo(-1)}}const bw="LruGarbageCollector",E4=1048576;function yw([s,e],[n,i]){const o=mt(s,n);return o===0?mt(e,i):o}class S4{constructor(e){this.Pr=e,this.buffer=new vn(yw),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();yw(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class T4{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ke(bw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){jo(n)?ke(bw,"Ignoring IndexedDB error during garbage collection: ",n):await To(n)}await this.Ar(3e5)}))}}class j4{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return be.resolve(Hh.ce);const i=new S4(n);return this.Vr.forEachTarget(e,(o=>i.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>i.Er(o))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.Vr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ke("LruGarbageCollector","Garbage collection skipped; disabled"),be.resolve(xw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ke("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xw):this.gr(e,n)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let i,o,u,d,p,g,x;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(ke("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),o=this.params.maximumSequenceNumbersToCollect):o=_,d=Date.now(),this.nthSequenceNumber(e,o)))).next((_=>(i=_,p=Date.now(),this.removeTargets(e,i,n)))).next((_=>(u=_,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((_=>(x=Date.now(),eo()<=ft.DEBUG&&ke("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-y}ms
	Determined least recently used ${o} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${_} documents in `+(x-g)+`ms
Total Duration: ${x-y}ms`),be.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:u,documentsRemoved:_}))))}}function A4(s,e){return new j4(s,e)}class C4{constructor(){this.changes=new dl((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Bn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?be.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class R4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class k4{constructor(e,n,i,o){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,n)))).next((o=>(i!==null&&Hc(i.mutation,o,gs.empty(),Tt.now()),o)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,pt()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=pt()){const o=Kr();return this.populateOverlays(e,o,n).next((()=>this.computeViews(e,n,o,i).next((u=>{let d=Oc();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,n){const i=Kr();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,pt())))}populateOverlays(e,n,i){const o=[];return i.forEach((u=>{n.has(u)||o.push(u)})),this.documentOverlayCache.getOverlays(e,o).next((u=>{u.forEach(((d,p)=>{n.set(d,p)}))}))}computeViews(e,n,i,o){let u=di();const d=Fc(),p=(function(){return Fc()})();return n.forEach(((g,x)=>{const y=i.get(x.key);o.has(x.key)&&(y===void 0||y.mutation instanceof yr)?u=u.insert(x.key,x):y!==void 0?(d.set(x.key,y.mutation.getFieldMask()),Hc(y.mutation,x,y.mutation.getFieldMask(),Tt.now())):d.set(x.key,gs.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((x,y)=>d.set(x,y))),n.forEach(((x,y)=>p.set(x,new R4(y,d.get(x)??null)))),p)))}recalculateAndSaveOverlays(e,n){const i=Fc();let o=new Yt(((d,p)=>d-p)),u=pt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((d=>{for(const p of d)p.keys().forEach((g=>{const x=n.get(g);if(x===null)return;let y=i.get(g)||gs.empty();y=p.applyToLocalView(x,y),i.set(g,y);const _=(o.get(p.batchId)||pt()).add(g);o=o.insert(p.batchId,_)}))})).next((()=>{const d=[],p=o.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),x=g.key,y=g.value,_=tN();y.forEach((S=>{if(!u.has(S)){const C=lN(n.get(S),i.get(S));C!==null&&_.set(S,C),u=u.add(S)}})),d.push(this.documentOverlayCache.saveOverlays(e,x,_))}return be.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,o){return IR(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):W1(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,o):this.getDocumentsMatchingCollectionQuery(e,n,i,o)}getNextDocuments(e,n,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,o).next((u=>{const d=o-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,o-u.size):be.resolve(Kr());let p=Xc,g=u;return d.next((x=>be.forEach(x,((y,_)=>(p<_.largestBatchId&&(p=_.largestBatchId),u.get(y)?be.resolve():this.remoteDocumentCache.getEntry(e,y).next((S=>{g=g.insert(y,S)}))))).next((()=>this.populateOverlays(e,x,u))).next((()=>this.computeViews(e,g,x,pt()))).next((y=>({batchId:p,changes:eN(y)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new He(n)).next((i=>{let o=Oc();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,o){const u=n.collectionGroup;let d=Oc();return this.indexManager.getCollectionParents(e,u).next((p=>be.forEach(p,(g=>{const x=(function(_,S){return new mu(S,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(n,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,x,i,o).next((y=>{y.forEach(((_,S)=>{d=d.insert(_,S)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,n,i,o){let u;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,u,o)))).next((d=>{u.forEach(((g,x)=>{const y=x.getKey();d.get(y)===null&&(d=d.insert(y,Bn.newInvalidDocument(y)))}));let p=Oc();return d.forEach(((g,x)=>{const y=u.get(g);y!==void 0&&Hc(y.mutation,x,gs.empty(),Tt.now()),Qh(n,x)&&(p=p.insert(g,x))})),p}))}}class I4{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return be.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,(function(o){return{id:o.id,version:o.version,createTime:Aa(o.createTime)}})(n)),be.resolve()}getNamedQuery(e,n){return be.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,(function(o){return{name:o.name,query:w4(o.bundledQuery),readTime:Aa(o.readTime)}})(n)),be.resolve()}}class D4{constructor(){this.overlays=new Yt(He.comparator),this.Lr=new Map}getOverlay(e,n){return be.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Kr();return be.forEach(n,(o=>this.getOverlay(e,o).next((u=>{u!==null&&i.set(o,u)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((o,u)=>{this.bt(e,n,u)})),be.resolve()}removeOverlaysForBatchId(e,n,i){const o=this.Lr.get(i);return o!==void 0&&(o.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),be.resolve()}getOverlaysForCollection(e,n,i){const o=Kr(),u=n.length+1,d=new He(n.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,x=g.getKey();if(!n.isPrefixOf(x.path))break;x.path.length===u&&g.largestBatchId>i&&o.set(g.getKey(),g)}return be.resolve(o)}getOverlaysForCollectionGroup(e,n,i,o){let u=new Yt(((x,y)=>x-y));const d=this.overlays.getIterator();for(;d.hasNext();){const x=d.getNext().value;if(x.getKey().getCollectionGroup()===n&&x.largestBatchId>i){let y=u.get(x.largestBatchId);y===null&&(y=Kr(),u=u.insert(x.largestBatchId,y)),y.set(x.getKey(),x)}}const p=Kr(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((x,y)=>p.set(x,y))),!(p.size()>=o)););return be.resolve(p)}bt(e,n,i){const o=this.overlays.get(i.key);if(o!==null){const d=this.Lr.get(o.largestBatchId).delete(i.key);this.Lr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new XR(n,i));let u=this.Lr.get(n);u===void 0&&(u=pt(),this.Lr.set(n,u)),this.Lr.set(n,u.add(i.key))}}class M4{constructor(){this.sessionToken=On.EMPTY_BYTE_STRING}getSessionToken(e){return be.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,be.resolve()}}class Xg{constructor(){this.kr=new vn(Tn.Kr),this.qr=new vn(Tn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const i=new Tn(e,n);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Wr(new Tn(e,n))}Qr(e,n){e.forEach((i=>this.removeReference(i,n)))}Gr(e){const n=new He(new Pt([])),i=new Tn(n,e),o=new Tn(n,e+1),u=[];return this.qr.forEachInRange([i,o],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new He(new Pt([])),i=new Tn(n,e),o=new Tn(n,e+1);let u=pt();return this.qr.forEachInRange([i,o],(d=>{u=u.add(d.key)})),u}containsKey(e){const n=new Tn(e,0),i=this.kr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class Tn{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return He.comparator(e.key,n.key)||mt(e.Hr,n.Hr)}static Ur(e,n){return mt(e.Hr,n.Hr)||He.comparator(e.key,n.key)}}class O4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new vn(Tn.Kr)}checkEmpty(e){return be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,o){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new WR(u,n,i,o);this.mutationQueue.push(d);for(const p of o)this.Jr=this.Jr.add(new Tn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return be.resolve(d)}lookupMutationBatch(e,n){return be.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,o=this.Xr(i),u=o<0?0:o;return be.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return be.resolve(this.mutationQueue.length===0?zg:this.Yn-1)}getAllMutationBatches(e){return be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new Tn(n,0),o=new Tn(n,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,o],(d=>{const p=this.Zr(d.Hr);u.push(p)})),be.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new vn(mt);return n.forEach((o=>{const u=new Tn(o,0),d=new Tn(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),be.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,o=i.length+1;let u=i;He.isDocumentKey(u)||(u=u.child(""));const d=new Tn(new He(u),0);let p=new vn(mt);return this.Jr.forEachWhile((g=>{const x=g.key.path;return!!i.isPrefixOf(x)&&(x.length===o&&(p=p.add(g.Hr)),!0)}),d),be.resolve(this.Yr(p))}Yr(e){const n=[];return e.forEach((i=>{const o=this.Zr(i);o!==null&&n.push(o)})),n}removeMutationBatch(e,n){jt(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return be.forEach(n.mutations,(o=>{const u=new Tn(o.key,n.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,n){const i=new Tn(n,0),o=this.Jr.firstAfterOrEqual(i);return be.resolve(n.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,be.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class V4{constructor(e){this.ti=e,this.docs=(function(){return new Yt(He.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,o=this.docs.get(i),u=o?o.size:0,d=this.ti(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return be.resolve(i?i.document.mutableCopy():Bn.newInvalidDocument(n))}getEntries(e,n){let i=di();return n.forEach((o=>{const u=this.docs.get(o);i=i.insert(o,u?u.document.mutableCopy():Bn.newInvalidDocument(o))})),be.resolve(i)}getDocumentsMatchingQuery(e,n,i,o){let u=di();const d=n.path,p=new He(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:x,value:{document:y}}=g.getNext();if(!d.isPrefixOf(x.path))break;x.path.length>d.length+1||oR(lR(y),i)<=0||(o.has(y.key)||Qh(n,y))&&(u=u.insert(y.key,y.mutableCopy()))}return be.resolve(u)}getAllFromCollectionGroup(e,n,i,o){Ke(9500)}ni(e,n){return be.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new P4(this)}getSize(e){return be.resolve(this.size)}}class P4 extends C4{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?n.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(i)})),be.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}class L4{constructor(e){this.persistence=e,this.ri=new dl((n=>Hg(n)),$g),this.lastRemoteSnapshotVersion=We.min(),this.highestTargetId=0,this.ii=0,this.si=new Xg,this.targetCount=0,this.oi=xo._r()}forEachTarget(e,n){return this.ri.forEach(((i,o)=>n(o))),be.resolve()}getLastRemoteSnapshotVersion(e){return be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return be.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),be.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.ii&&(this.ii=n),be.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new xo(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,be.resolve()}updateTargetData(e,n){return this.lr(n),be.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,be.resolve()}removeTargets(e,n,i){let o=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=n&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),o++)})),be.waitFor(u).next((()=>o))}getTargetCount(e){return be.resolve(this.targetCount)}getTargetData(e,n){const i=this.ri.get(n)||null;return be.resolve(i)}addMatchingKeys(e,n,i){return this.si.$r(n,i),be.resolve()}removeMatchingKeys(e,n,i){this.si.Qr(n,i);const o=this.persistence.referenceDelegate,u=[];return o&&n.forEach((d=>{u.push(o.markPotentiallyOrphaned(e,d))})),be.waitFor(u)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),be.resolve()}getMatchingKeysForTargetId(e,n){const i=this.si.jr(n);return be.resolve(i)}containsKey(e,n){return be.resolve(this.si.containsKey(n))}}class wN{constructor(e,n){this._i={},this.overlays={},this.ai=new Hh(0),this.ui=!1,this.ui=!0,this.ci=new M4,this.referenceDelegate=e(this),this.li=new L4(this),this.indexManager=new _4,this.remoteDocumentCache=(function(o){return new V4(o)})((i=>this.referenceDelegate.hi(i))),this.serializer=new v4(n),this.Pi=new I4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new D4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this._i[e.toKey()];return i||(i=new O4(n,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,i){ke("MemoryPersistence","Starting transaction:",e);const o=new U4(this.ai.next());return this.referenceDelegate.Ti(),i(o).next((u=>this.referenceDelegate.Ii(o).next((()=>u)))).toPromise().then((u=>(o.raiseOnCommittedEvent(),u)))}Ei(e,n){return be.or(Object.values(this._i).map((i=>()=>i.containsKey(e,n))))}}class U4 extends uR{constructor(e){super(),this.currentSequenceNumber=e}}class Jg{constructor(e){this.persistence=e,this.Ri=new Xg,this.Ai=null}static Vi(e){return new Jg(e)}get di(){if(this.Ai)return this.Ai;throw Ke(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.di.delete(i.toString()),be.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.di.add(i.toString()),be.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),be.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach((o=>this.di.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((o=>{o.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,n)))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return be.forEach(this.di,(i=>{const o=He.fromPath(i);return this.mi(e,o).next((u=>{u||n.removeEntry(o,We.min())}))})).next((()=>(this.Ai=null,n.apply(e))))}updateLimboDocument(e,n){return this.mi(e,n).next((i=>{i?this.di.delete(n.toString()):this.di.add(n.toString())}))}hi(e){return 0}mi(e,n){return be.or([()=>be.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class Ch{constructor(e,n){this.persistence=e,this.fi=new dl((i=>fR(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=A4(this,n)}static Vi(e,n){return new Ch(e,n)}Ti(){}Ii(e){return be.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((o=>i+o))))}pr(e){let n=0;return this.mr(e,(i=>{n++})).next((()=>n))}mr(e,n){return be.forEach(this.fi,((i,o)=>this.wr(e,i,o).next((u=>u?be.resolve():n(o)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const o=this.persistence.getRemoteDocumentCache(),u=o.newChangeBuffer();return o.ni(e,(d=>this.wr(e,d,n).next((p=>{p||(i++,u.removeEntry(d,We.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),be.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.fi.set(i,e.currentSequenceNumber),be.resolve()}removeReference(e,n,i){return this.fi.set(i,e.currentSequenceNumber),be.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),be.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=rh(e.data.value)),n}wr(e,n,i){return be.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const o=this.fi.get(n);return be.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Zg{constructor(e,n,i,o){this.targetId=e,this.fromCache=n,this.Ts=i,this.Is=o}static Es(e,n){let i=pt(),o=pt();for(const u of n.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:o=o.add(u.doc.key)}return new Zg(e,n.fromCache,i,o)}}class B4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class z4{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return mj()?8:dR(zn())>0?6:4})()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,o){const u={result:null};return this.gs(e,n).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,n,o,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new B4;return this.ys(e,n,d).next((p=>{if(u.result=p,this.As)return this.ws(e,n,d,p.size)}))})).next((()=>u.result))}ws(e,n,i,o){return i.documentReadCount<this.Vs?(eo()<=ft.DEBUG&&ke("QueryEngine","SDK will not create cache indexes for query:",to(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),be.resolve()):(eo()<=ft.DEBUG&&ke("QueryEngine","Query:",to(n),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.ds*o?(eo()<=ft.DEBUG&&ke("QueryEngine","The SDK decides to create cache indexes for query:",to(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ja(n))):be.resolve())}gs(e,n){if(lw(n))return be.resolve(null);let i=ja(n);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(n.limit!==null&&o===1&&(n=tg(n,null,"F"),i=ja(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=pt(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const x=this.bs(n,p);return this.Ss(n,x,d,g.readTime)?this.gs(e,tg(n,null,"F")):this.Ds(e,x,n,g)}))))})))))}ps(e,n,i,o){return lw(n)||o.isEqual(We.min())?be.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(n,u);return this.Ss(n,d,i,o)?be.resolve(null):(eo()<=ft.DEBUG&&ke("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),to(n)),this.Ds(e,d,n,rR(o,Xc)).next((p=>p)))}))}bs(e,n){let i=new vn(J1(e));return n.forEach(((o,u)=>{Qh(e,u)&&(i=i.add(u))})),i}Ss(e,n,i,o){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const u=e.limitType==="F"?n.last():n.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(o)>0)}ys(e,n,i){return eo()<=ft.DEBUG&&ke("QueryEngine","Using full collection scan to execute query:",to(n)),this.fs.getDocumentsMatchingQuery(e,n,lr.min(),i)}Ds(e,n,i,o){return this.fs.getDocumentsMatchingQuery(e,i,o).next((u=>(n.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const e0="LocalStore",q4=3e8;class F4{constructor(e,n,i,o){this.persistence=e,this.Cs=n,this.serializer=o,this.vs=new Yt(mt),this.Fs=new dl((u=>Hg(u)),$g),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new k4(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.vs)))}}function H4(s,e,n,i){return new F4(s,e,n,i)}async function _N(s,e){const n=Ze(s);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return n.mutationQueue.getAllMutationBatches(i).next((u=>(o=u,n.Os(e),n.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=pt();for(const x of o){d.push(x.batchId);for(const y of x.mutations)g=g.add(y.key)}for(const x of u){p.push(x.batchId);for(const y of x.mutations)g=g.add(y.key)}return n.localDocuments.getDocuments(i,g).next((x=>({Ns:x,removedBatchIds:d,addedBatchIds:p})))}))}))}function $4(s,e){const n=Ze(s);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),u=n.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,x,y){const _=x.batch,S=_.keys();let C=be.resolve();return S.forEach((H=>{C=C.next((()=>y.getEntry(g,H))).next((B=>{const P=x.docVersions.get(H);jt(P!==null,48541),B.version.compareTo(P)<0&&(_.applyToRemoteDocument(B,x),B.isValidDocument()&&(B.setReadTime(x.commitVersion),y.addEntry(B)))}))})),C.next((()=>p.mutationQueue.removeMutationBatch(g,_)))})(n,i,e,u).next((()=>u.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=pt();for(let x=0;x<p.mutationResults.length;++x)p.mutationResults[x].transformResults.length>0&&(g=g.add(p.batch.mutations[x].key));return g})(e)))).next((()=>n.localDocuments.getDocuments(i,o)))}))}function NN(s){const e=Ze(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.li.getLastRemoteSnapshotVersion(n)))}function G4(s,e){const n=Ze(s),i=e.snapshotVersion;let o=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=n.xs.newChangeBuffer({trackRemovals:!0});o=n.vs;const p=[];e.targetChanges.forEach(((y,_)=>{const S=o.get(_);if(!S)return;p.push(n.li.removeMatchingKeys(u,y.removedDocuments,_).next((()=>n.li.addMatchingKeys(u,y.addedDocuments,_))));let C=S.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(_)!==null?C=C.withResumeToken(On.EMPTY_BYTE_STRING,We.min()).withLastLimboFreeSnapshotVersion(We.min()):y.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(y.resumeToken,i)),o=o.insert(_,C),(function(B,P,q){return B.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=q4?!0:q.addedDocuments.size+q.modifiedDocuments.size+q.removedDocuments.size>0})(S,C,y)&&p.push(n.li.updateTargetData(u,C))}));let g=di(),x=pt();if(e.documentUpdates.forEach((y=>{e.resolvedLimboDocuments.has(y)&&p.push(n.persistence.referenceDelegate.updateLimboDocument(u,y))})),p.push(Y4(u,d,e.documentUpdates).next((y=>{g=y.Bs,x=y.Ls}))),!i.isEqual(We.min())){const y=n.li.getLastRemoteSnapshotVersion(u).next((_=>n.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(y)}return be.waitFor(p).next((()=>d.apply(u))).next((()=>n.localDocuments.getLocalViewOfDocuments(u,g,x))).next((()=>g))})).then((u=>(n.vs=o,u)))}function Y4(s,e,n){let i=pt(),o=pt();return n.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let d=di();return n.forEach(((p,g)=>{const x=u.get(p);g.isFoundDocument()!==x.isFoundDocument()&&(o=o.add(p)),g.isNoDocument()&&g.version.isEqual(We.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!x.isValidDocument()||g.version.compareTo(x.version)>0||g.version.compareTo(x.version)===0&&x.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):ke(e0,"Ignoring outdated watch update for ",p,". Current version:",x.version," Watch version:",g.version)})),{Bs:d,Ls:o}}))}function K4(s,e){const n=Ze(s);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=zg),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Q4(s,e){const n=Ze(s);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return n.li.getTargetData(i,e).next((u=>u?(o=u,be.resolve(o)):n.li.allocateTargetId(i).next((d=>(o=new Zi(e,d,"TargetPurposeListen",i.currentSequenceNumber),n.li.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=n.vs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(n.vs=n.vs.insert(i.targetId,i),n.Fs.set(e,i.targetId)),i}))}async function rg(s,e,n){const i=Ze(s),o=i.vs.get(e),u=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!jo(d))throw d;ke(e0,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(o.target)}function vw(s,e,n){const i=Ze(s);let o=We.min(),u=pt();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,x,y){const _=Ze(g),S=_.Fs.get(y);return S!==void 0?be.resolve(_.vs.get(S)):_.li.getTargetData(x,y)})(i,d,ja(e)).next((p=>{if(p)return o=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,n?o:We.min(),n?u:pt()))).next((p=>(W4(i,MR(e),p),{documents:p,ks:u})))))}function W4(s,e,n){let i=s.Ms.get(e)||We.min();n.forEach(((o,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class ww{constructor(){this.activeTargetIds=BR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class X4{constructor(){this.vo=new ww,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,i){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new ww,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class J4{Mo(e){}shutdown(){}}const _w="ConnectivityMonitor";class Nw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ke(_w,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ke(_w,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Kd=null;function lg(){return Kd===null?Kd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Kd++,"0x"+Kd.toString(16)}const Ep="RestConnection",Z4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class ek{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${i}/databases/${o}`,this.$o=this.databaseId.database===Nh?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Wo(e,n,i,o,u){const d=lg(),p=this.Qo(e,n.toUriEncodedString());ke(Ep,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,o,u);const{host:x}=new URL(p),y=pr(x);return this.zo(e,p,g,i,y).then((_=>(ke(Ep,`Received RPC '${e}' ${d}: `,_),_)),(_=>{throw fo(Ep,`RPC '${e}' ${d} failed with error: `,_,"url: ",p,"request:",i),_}))}jo(e,n,i,o,u,d){return this.Wo(e,n,i,o,u)}Go(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+So})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((o,u)=>e[u]=o)),i&&i.headers.forEach(((o,u)=>e[u]=o))}Qo(e,n){const i=Z4[e];let o=`${this.qo}/v1/${n}:${i}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class tk{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Ln="WebChannelConnection",Cc=(s,e,n)=>{s.listen(e,(i=>{try{n(i)}catch(o){setTimeout((()=>{throw o}),0)}}))};class uo extends ek{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!uo.c_){const e=A1();Cc(e,j1.STAT_EVENT,(n=>{n.stat===Kp.PROXY?ke(Ln,"STAT_EVENT: detected buffering proxy"):n.stat===Kp.NOPROXY&&ke(Ln,"STAT_EVENT: detected no buffering proxy")})),uo.c_=!0}}zo(e,n,i,o,u){const d=lg();return new Promise(((p,g)=>{const x=new S1;x.setWithCredentials(!0),x.listenOnce(T1.COMPLETE,(()=>{try{switch(x.getLastErrorCode()){case ih.NO_ERROR:const _=x.getResponseJson();ke(Ln,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(_)),p(_);break;case ih.TIMEOUT:ke(Ln,`RPC '${e}' ${d} timed out`),g(new Ae(ge.DEADLINE_EXCEEDED,"Request time out"));break;case ih.HTTP_ERROR:const S=x.getStatus();if(ke(Ln,`RPC '${e}' ${d} failed with status:`,S,"response text:",x.getResponseText()),S>0){let C=x.getResponseJson();Array.isArray(C)&&(C=C[0]);const H=C?.error;if(H&&H.status&&H.message){const B=(function(q){const Y=q.toLowerCase().replace(/_/g,"-");return Object.values(ge).indexOf(Y)>=0?Y:ge.UNKNOWN})(H.status);g(new Ae(B,H.message))}else g(new Ae(ge.UNKNOWN,"Server responded with status "+x.getStatus()))}else g(new Ae(ge.UNAVAILABLE,"Connection failed."));break;default:Ke(9055,{l_:e,streamId:d,h_:x.getLastErrorCode(),P_:x.getLastError()})}}finally{ke(Ln,`RPC '${e}' ${d} completed.`)}}));const y=JSON.stringify(o);ke(Ln,`RPC '${e}' ${d} sending request:`,o),x.send(n,"POST",y,i,15)}))}T_(e,n,i){const o=lg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,n,i),p.encodeInitMessageHeaders=!0;const x=u.join("");ke(Ln,`Creating RPC '${e}' stream ${o}: ${x}`,p);const y=d.createWebChannel(x,p);this.I_(y);let _=!1,S=!1;const C=new tk({Ho:H=>{S?ke(Ln,`Not sending because RPC '${e}' stream ${o} is closed:`,H):(_||(ke(Ln,`Opening RPC '${e}' stream ${o} transport.`),y.open(),_=!0),ke(Ln,`RPC '${e}' stream ${o} sending:`,H),y.send(H))},Jo:()=>y.close()});return Cc(y,Mc.EventType.OPEN,(()=>{S||(ke(Ln,`RPC '${e}' stream ${o} transport opened.`),C.i_())})),Cc(y,Mc.EventType.CLOSE,(()=>{S||(S=!0,ke(Ln,`RPC '${e}' stream ${o} transport closed`),C.o_(),this.E_(y))})),Cc(y,Mc.EventType.ERROR,(H=>{S||(S=!0,fo(Ln,`RPC '${e}' stream ${o} transport errored. Name:`,H.name,"Message:",H.message),C.o_(new Ae(ge.UNAVAILABLE,"The operation could not be completed")))})),Cc(y,Mc.EventType.MESSAGE,(H=>{if(!S){const B=H.data[0];jt(!!B,16349);const P=B,q=P?.error||P[0]?.error;if(q){ke(Ln,`RPC '${e}' stream ${o} received error:`,q);const Y=q.status;let W=(function(re){const j=mn[re];if(j!==void 0)return cN(j)})(Y),xe=q.message;W===void 0&&(W=ge.INTERNAL,xe="Unknown error status: "+Y+" with message "+q.message),S=!0,C.o_(new Ae(W,xe)),y.close()}else ke(Ln,`RPC '${e}' stream ${o} received:`,B),C.__(B)}})),uo.u_(),setTimeout((()=>{C.s_()}),0),C}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((n=>n===e))}Go(e,n,i){super.Go(e,n,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return C1()}}function nk(s){return new uo(s)}function Sp(){return typeof document<"u"?document:null}function Zh(s){return new r4(s,!0)}uo.c_=!1;class EN{constructor(e,n,i=1e3,o=1.5,u=6e4){this.Ci=e,this.timerId=n,this.R_=i,this.A_=o,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,n-i);o>0&&ke("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Ew="PersistentStream";class SN{constructor(e,n,i,o,u,d,p,g){this.Ci=e,this.b_=i,this.S_=o,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new EN(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===ge.RESOURCE_EXHAUSTED?(ui(n.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===n&&this.G_(i,o)}),(i=>{e((()=>{const o=new Ae(ge.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,n){const i=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ke(Ew,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget((()=>this.D_===e?n():(ke(Ew,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class sk extends SN{constructor(e,n,i,o,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,o,d),this.serializer=u}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=c4(this.serializer,e),i=(function(u){if(!("targetChange"in u))return We.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?We.min():d.readTime?Aa(d.readTime):We.min()})(e);return this.listener.J_(n,i)}Z_(e){const n={};n.database=ig(this.serializer),n.addTarget=(function(u,d){let p;const g=d.target;if(p=Zp(g)?{documents:h4(u,g)}:{query:f4(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=hN(u,d.resumeToken);const x=ng(u,d.expectedCount);x!==null&&(p.expectedCount=x)}else if(d.snapshotVersion.compareTo(We.min())>0){p.readTime=Ah(u,d.snapshotVersion.toTimestamp());const x=ng(u,d.expectedCount);x!==null&&(p.expectedCount=x)}return p})(this.serializer,e);const i=p4(this.serializer,e);i&&(n.labels=i),this.K_(n)}X_(e){const n={};n.database=ig(this.serializer),n.removeTarget=e,this.K_(n)}}class ak extends SN{constructor(e,n,i,o,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,o,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return jt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,jt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){jt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=d4(e.writeResults,e.commitTime),i=Aa(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=ig(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>u4(this.serializer,i)))};this.K_(n)}}class ik{}class rk extends ik{constructor(e,n,i,o){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ae(ge.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,sg(n,i),o,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ae(ge.UNKNOWN,u.toString())}))}jo(e,n,i,o,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,sg(n,i),o,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Ae(ge.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function lk(s,e,n,i){return new rk(s,e,n,i)}class ok{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ui(n),this.aa=!1):ke("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const sl="RemoteStore";class ck{constructor(e,n,i,o,u){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{hl(this)&&(ke(sl,"Restarting streams for network reachability change."),await(async function(g){const x=Ze(g);x.Ea.add(4),await xu(x),x.Va.set("Unknown"),x.Ea.delete(4),await ef(x)})(this))}))})),this.Va=new ok(i,o)}}async function ef(s){if(hl(s))for(const e of s.Ra)await e(!0)}async function xu(s){for(const e of s.Ra)await e(!1)}function TN(s,e){const n=Ze(s);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),a0(n)?s0(n):Ao(n).O_()&&n0(n,e))}function t0(s,e){const n=Ze(s),i=Ao(n);n.Ia.delete(e),i.O_()&&jN(n,e),n.Ia.size===0&&(i.O_()?i.L_():hl(n)&&n.Va.set("Unknown"))}function n0(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(We.min())>0){const n=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ao(s).Z_(e)}function jN(s,e){s.da.$e(e),Ao(s).X_(e)}function s0(s){s.da=new n4({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Ao(s).start(),s.Va.ua()}function a0(s){return hl(s)&&!Ao(s).x_()&&s.Ia.size>0}function hl(s){return Ze(s).Ea.size===0}function AN(s){s.da=void 0}async function uk(s){s.Va.set("Online")}async function dk(s){s.Ia.forEach(((e,n)=>{n0(s,e)}))}async function hk(s,e){AN(s),a0(s)?(s.Va.ha(e),s0(s)):s.Va.set("Unknown")}async function fk(s,e,n){if(s.Va.set("Online"),e instanceof dN&&e.state===2&&e.cause)try{await(async function(o,u){const d=u.cause;for(const p of u.targetIds)o.Ia.has(p)&&(await o.remoteSyncer.rejectListen(p,d),o.Ia.delete(p),o.da.removeTarget(p))})(s,e)}catch(i){ke(sl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Rh(s,i)}else if(e instanceof ch?s.da.Xe(e):e instanceof uN?s.da.st(e):s.da.tt(e),!n.isEqual(We.min()))try{const i=await NN(s.localStore);n.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,x)=>{if(g.resumeToken.approximateByteSize()>0){const y=u.Ia.get(x);y&&u.Ia.set(x,y.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,x)=>{const y=u.Ia.get(g);if(!y)return;u.Ia.set(g,y.withResumeToken(On.EMPTY_BYTE_STRING,y.snapshotVersion)),jN(u,g);const _=new Zi(y.target,g,x,y.sequenceNumber);n0(u,_)})),u.remoteSyncer.applyRemoteEvent(p)})(s,n)}catch(i){ke(sl,"Failed to raise snapshot:",i),await Rh(s,i)}}async function Rh(s,e,n){if(!jo(e))throw e;s.Ea.add(1),await xu(s),s.Va.set("Offline"),n||(n=()=>NN(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{ke(sl,"Retrying IndexedDB access"),await n(),s.Ea.delete(1),await ef(s)}))}function CN(s,e){return e().catch((n=>Rh(s,n,e)))}async function tf(s){const e=Ze(s),n=dr(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:zg;for(;mk(e);)try{const o=await K4(e.localStore,i);if(o===null){e.Ta.length===0&&n.L_();break}i=o.batchId,pk(e,o)}catch(o){await Rh(e,o)}RN(e)&&kN(e)}function mk(s){return hl(s)&&s.Ta.length<10}function pk(s,e){s.Ta.push(e);const n=dr(s);n.O_()&&n.Y_&&n.ea(e.mutations)}function RN(s){return hl(s)&&!dr(s).x_()&&s.Ta.length>0}function kN(s){dr(s).start()}async function gk(s){dr(s).ra()}async function xk(s){const e=dr(s);for(const n of s.Ta)e.ea(n.mutations)}async function bk(s,e,n){const i=s.Ta.shift(),o=Kg.from(i,e,n);await CN(s,(()=>s.remoteSyncer.applySuccessfulWrite(o))),await tf(s)}async function yk(s,e){e&&dr(s).Y_&&await(async function(i,o){if((function(d){return ZR(d)&&d!==ge.ABORTED})(o.code)){const u=i.Ta.shift();dr(i).B_(),await CN(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,o))),await tf(i)}})(s,e),RN(s)&&kN(s)}async function Sw(s,e){const n=Ze(s);n.asyncQueue.verifyOperationInProgress(),ke(sl,"RemoteStore received new credentials");const i=hl(n);n.Ea.add(3),await xu(n),i&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ef(n)}async function vk(s,e){const n=Ze(s);e?(n.Ea.delete(2),await ef(n)):e||(n.Ea.add(2),await xu(n),n.Va.set("Unknown"))}function Ao(s){return s.ma||(s.ma=(function(n,i,o){const u=Ze(n);return u.sa(),new sk(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(s.datastore,s.asyncQueue,{Zo:uk.bind(null,s),Yo:dk.bind(null,s),t_:hk.bind(null,s),J_:fk.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),a0(s)?s0(s):s.Va.set("Unknown")):(await s.ma.stop(),AN(s))}))),s.ma}function dr(s){return s.fa||(s.fa=(function(n,i,o){const u=Ze(n);return u.sa(),new ak(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:gk.bind(null,s),t_:yk.bind(null,s),ta:xk.bind(null,s),na:bk.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await tf(s)):(await s.fa.stop(),s.Ta.length>0&&(ke(sl,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class i0{constructor(e,n,i,o,u){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=o,this.removalCallback=u,this.deferred=new ri,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,o,u){const d=Date.now()+i,p=new i0(e,n,d,o,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ae(ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function r0(s,e){if(ui("AsyncQueue",`${e}: ${s}`),jo(s))return new Ae(ge.UNAVAILABLE,`${e}: ${s}`);throw s}class ho{static emptySet(e){return new ho(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||He.comparator(n.key,i.key):(n,i)=>He.comparator(n.key,i.key),this.keyedMap=Oc(),this.sortedSet=new Yt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ho)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const o=n.getNext().key,u=i.getNext().key;if(!o.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new ho;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class Tw{constructor(){this.ga=new Yt(He.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ke(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class bo{constructor(e,n,i,o,u,d,p,g,x){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=x}static fromInitialDocuments(e,n,i,o,u){const d=[];return n.forEach((p=>{d.push({type:0,doc:p})})),new bo(e,n,ho.emptySet(n),d,i,o,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let o=0;o<n.length;o++)if(n[o].type!==i[o].type||!n[o].doc.isEqual(i[o].doc))return!1;return!0}}class wk{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class _k{constructor(){this.queries=jw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const o=Ze(n),u=o.queries;o.queries=jw(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new Ae(ge.ABORTED,"Firestore shutting down"))}}function jw(){return new dl((s=>X1(s)),Kh)}async function l0(s,e){const n=Ze(s);let i=3;const o=e.query;let u=n.queries.get(o);u?!u.Sa()&&e.Da()&&(i=2):(u=new wk,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await n.onListen(o,!0);break;case 1:u.wa=await n.onListen(o,!1);break;case 2:await n.onFirstRemoteStoreListen(o)}}catch(d){const p=r0(d,`Initialization of query '${to(e.query)}' failed`);return void e.onError(p)}n.queries.set(o,u),u.ba.push(e),e.va(n.onlineState),u.wa&&e.Fa(u.wa)&&c0(n)}async function o0(s,e){const n=Ze(s),i=e.query;let o=3;const u=n.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?o=e.Da()?0:1:!u.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function Nk(s,e){const n=Ze(s);let i=!1;for(const o of e){const u=o.query,d=n.queries.get(u);if(d){for(const p of d.ba)p.Fa(o)&&(i=!0);d.wa=o}}i&&c0(n)}function Ek(s,e,n){const i=Ze(s),o=i.queries.get(e);if(o)for(const u of o.ba)u.onError(n);i.queries.delete(e)}function c0(s){s.Ca.forEach((e=>{e.next()}))}var og,Aw;(Aw=og||(og={})).Ma="default",Aw.Cache="cache";class u0{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new bo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=bo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==og.Cache}}class IN{constructor(e){this.key=e}}class DN{constructor(e){this.key=e}}class Sk{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=pt(),this.mutatedKeys=pt(),this.eu=J1(e),this.tu=new ho(this.eu)}get nu(){return this.Za}ru(e,n){const i=n?n.iu:new Tw,o=n?n.tu:this.tu;let u=n?n.mutatedKeys:this.mutatedKeys,d=o,p=!1;const g=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,x=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((y,_)=>{const S=o.get(y),C=Qh(this.query,_)?_:null,H=!!S&&this.mutatedKeys.has(S.key),B=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let P=!1;S&&C?S.data.isEqual(C.data)?H!==B&&(i.track({type:3,doc:C}),P=!0):this.su(S,C)||(i.track({type:2,doc:C}),P=!0,(g&&this.eu(C,g)>0||x&&this.eu(C,x)<0)&&(p=!0)):!S&&C?(i.track({type:0,doc:C}),P=!0):S&&!C&&(i.track({type:1,doc:S}),P=!0,(g||x)&&(p=!0)),P&&(C?(d=d.add(C),u=B?u.add(y):u.delete(y)):(d=d.delete(y),u=u.delete(y)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const y=this.query.limitType==="F"?d.last():d.first();d=d.delete(y.key),u=u.delete(y.key),i.track({type:1,doc:y})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,o){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((y,_)=>(function(C,H){const B=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ke(20277,{Vt:P})}};return B(C)-B(H)})(y.type,_.type)||this.eu(y.doc,_.doc))),this.ou(i),o=o??!1;const p=n&&!o?this._u():[],g=this.Ya.size===0&&this.current&&!o?1:0,x=g!==this.Xa;return this.Xa=g,d.length!==0||x?{snapshot:new bo(this.query,e.tu,u,d,e.mutatedKeys,g===0,x,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Tw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Za=this.Za.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Za=this.Za.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=pt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const n=[];return e.forEach((i=>{this.Ya.has(i)||n.push(new DN(i))})),this.Ya.forEach((i=>{e.has(i)||n.push(new IN(i))})),n}cu(e){this.Za=e.ks,this.Ya=pt();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return bo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const d0="SyncEngine";class Tk{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class jk{constructor(e){this.key=e,this.hu=!1}}class Ak{constructor(e,n,i,o,u,d){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=o,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new dl((p=>X1(p)),Kh),this.Iu=new Map,this.Eu=new Set,this.Ru=new Yt(He.comparator),this.Au=new Map,this.Vu=new Xg,this.du={},this.mu=new Map,this.fu=xo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Ck(s,e,n=!0){const i=UN(s);let o;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),o=u.view.lu()):o=await MN(i,e,n,!0),o}async function Rk(s,e){const n=UN(s);await MN(n,e,!0,!1)}async function MN(s,e,n,i){const o=await Q4(s.localStore,ja(e)),u=o.targetId,d=s.sharedClientState.addLocalQueryTarget(u,n);let p;return i&&(p=await kk(s,e,u,d==="current",o.resumeToken)),s.isPrimaryClient&&n&&TN(s.remoteStore,o),p}async function kk(s,e,n,i,o){s.pu=(_,S,C)=>(async function(B,P,q,Y){let W=P.view.ru(q);W.Ss&&(W=await vw(B.localStore,P.query,!1).then((({documents:j})=>P.view.ru(j,W))));const xe=Y&&Y.targetChanges.get(P.targetId),me=Y&&Y.targetMismatches.get(P.targetId)!=null,re=P.view.applyChanges(W,B.isPrimaryClient,xe,me);return Rw(B,P.targetId,re.au),re.snapshot})(s,_,S,C);const u=await vw(s.localStore,e,!0),d=new Sk(e,u.ks),p=d.ru(u.documents),g=gu.createSynthesizedTargetChangeForCurrentChange(n,i&&s.onlineState!=="Offline",o),x=d.applyChanges(p,s.isPrimaryClient,g);Rw(s,n,x.au);const y=new Tk(e,n,d);return s.Tu.set(e,y),s.Iu.has(n)?s.Iu.get(n).push(e):s.Iu.set(n,[e]),x.snapshot}async function Ik(s,e,n){const i=Ze(s),o=i.Tu.get(e),u=i.Iu.get(o.targetId);if(u.length>1)return i.Iu.set(o.targetId,u.filter((d=>!Kh(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await rg(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),n&&t0(i.remoteStore,o.targetId),cg(i,o.targetId)})).catch(To)):(cg(i,o.targetId),await rg(i.localStore,o.targetId,!0))}async function Dk(s,e){const n=Ze(s),i=n.Tu.get(e),o=n.Iu.get(i.targetId);n.isPrimaryClient&&o.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),t0(n.remoteStore,i.targetId))}async function Mk(s,e,n){const i=zk(s);try{const o=await(function(d,p){const g=Ze(d),x=Tt.now(),y=p.reduce(((C,H)=>C.add(H.key)),pt());let _,S;return g.persistence.runTransaction("Locally write mutations","readwrite",(C=>{let H=di(),B=pt();return g.xs.getEntries(C,y).next((P=>{H=P,H.forEach(((q,Y)=>{Y.isValidDocument()||(B=B.add(q))}))})).next((()=>g.localDocuments.getOverlayedDocuments(C,H))).next((P=>{_=P;const q=[];for(const Y of p){const W=KR(Y,_.get(Y.key).overlayedDocument);W!=null&&q.push(new yr(Y.key,W,F1(W.value.mapValue),Vs.exists(!0)))}return g.mutationQueue.addMutationBatch(C,x,q,p)})).next((P=>{S=P;const q=P.applyToLocalDocumentSet(_,B);return g.documentOverlayCache.saveOverlays(C,P.batchId,q)}))})).then((()=>({batchId:S.batchId,changes:eN(_)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(d,p,g){let x=d.du[d.currentUser.toKey()];x||(x=new Yt(mt)),x=x.insert(p,g),d.du[d.currentUser.toKey()]=x})(i,o.batchId,n),await bu(i,o.changes),await tf(i.remoteStore)}catch(o){const u=r0(o,"Failed to persist write");n.reject(u)}}async function ON(s,e){const n=Ze(s);try{const i=await G4(n.localStore,e);e.targetChanges.forEach(((o,u)=>{const d=n.Au.get(u);d&&(jt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?jt(d.hu,14607):o.removedDocuments.size>0&&(jt(d.hu,42227),d.hu=!1))})),await bu(n,i,e)}catch(i){await To(i)}}function Cw(s,e,n){const i=Ze(s);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const o=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&o.push(p.snapshot)})),(function(d,p){const g=Ze(d);g.onlineState=p;let x=!1;g.queries.forEach(((y,_)=>{for(const S of _.ba)S.va(p)&&(x=!0)})),x&&c0(g)})(i.eventManager,e),o.length&&i.Pu.J_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Ok(s,e,n){const i=Ze(s);i.sharedClientState.updateQueryState(e,"rejected",n);const o=i.Au.get(e),u=o&&o.key;if(u){let d=new Yt(He.comparator);d=d.insert(u,Bn.newNoDocument(u,We.min()));const p=pt().add(u),g=new Jh(We.min(),new Map,new Yt(mt),d,p);await ON(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),h0(i)}else await rg(i.localStore,e,!1).then((()=>cg(i,e,n))).catch(To)}async function Vk(s,e){const n=Ze(s),i=e.batch.batchId;try{const o=await $4(n.localStore,e);PN(n,i,null),VN(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await bu(n,o)}catch(o){await To(o)}}async function Pk(s,e,n){const i=Ze(s);try{const o=await(function(d,p){const g=Ze(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(x=>{let y;return g.mutationQueue.lookupMutationBatch(x,p).next((_=>(jt(_!==null,37113),y=_.keys(),g.mutationQueue.removeMutationBatch(x,_)))).next((()=>g.mutationQueue.performConsistencyCheck(x))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(x,y,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(x,y))).next((()=>g.localDocuments.getDocuments(x,y)))}))})(i.localStore,e);PN(i,e,n),VN(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await bu(i,o)}catch(o){await To(o)}}function VN(s,e){(s.mu.get(e)||[]).forEach((n=>{n.resolve()})),s.mu.delete(e)}function PN(s,e,n){const i=Ze(s);let o=i.du[i.currentUser.toKey()];if(o){const u=o.get(e);u&&(n?u.reject(n):u.resolve(),o=o.remove(e)),i.du[i.currentUser.toKey()]=o}}function cg(s,e,n=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),n&&s.Pu.yu(i,n);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||LN(s,i)}))}function LN(s,e){s.Eu.delete(e.path.canonicalString());const n=s.Ru.get(e);n!==null&&(t0(s.remoteStore,n),s.Ru=s.Ru.remove(e),s.Au.delete(n),h0(s))}function Rw(s,e,n){for(const i of n)i instanceof IN?(s.Vu.addReference(i.key,e),Lk(s,i)):i instanceof DN?(ke(d0,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||LN(s,i.key)):Ke(19791,{wu:i})}function Lk(s,e){const n=e.key,i=n.path.canonicalString();s.Ru.get(n)||s.Eu.has(i)||(ke(d0,"New document in limbo: "+n),s.Eu.add(i),h0(s))}function h0(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const n=new He(Pt.fromString(e)),i=s.fu.next();s.Au.set(i,new jk(n)),s.Ru=s.Ru.insert(n,i),TN(s.remoteStore,new Zi(ja(Yh(n.path)),i,"TargetPurposeLimboResolution",Hh.ce))}}async function bu(s,e,n){const i=Ze(s),o=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,n).then((x=>{if((x||n)&&i.isPrimaryClient){const y=x?!x.fromCache:n?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,y?"current":"not-current")}if(x){o.push(x);const y=Zg.Es(g.targetId,x);u.push(y)}})))})),await Promise.all(d),i.Pu.J_(o),await(async function(g,x){const y=Ze(g);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>be.forEach(x,(S=>be.forEach(S.Ts,(C=>y.persistence.referenceDelegate.addReference(_,S.targetId,C))).next((()=>be.forEach(S.Is,(C=>y.persistence.referenceDelegate.removeReference(_,S.targetId,C)))))))))}catch(_){if(!jo(_))throw _;ke(e0,"Failed to update sequence numbers: "+_)}for(const _ of x){const S=_.targetId;if(!_.fromCache){const C=y.vs.get(S),H=C.snapshotVersion,B=C.withLastLimboFreeSnapshotVersion(H);y.vs=y.vs.insert(S,B)}}})(i.localStore,u))}async function Uk(s,e){const n=Ze(s);if(!n.currentUser.isEqual(e)){ke(d0,"User change. New user:",e.toKey());const i=await _N(n.localStore,e);n.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new Ae(ge.CANCELLED,d))}))})),u.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await bu(n,i.Ns)}}function Bk(s,e){const n=Ze(s),i=n.Au.get(e);if(i&&i.hu)return pt().add(i.key);{let o=pt();const u=n.Iu.get(e);if(!u)return o;for(const d of u){const p=n.Tu.get(d);o=o.unionWith(p.view.nu)}return o}}function UN(s){const e=Ze(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=ON.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Bk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ok.bind(null,e),e.Pu.J_=Nk.bind(null,e.eventManager),e.Pu.yu=Ek.bind(null,e.eventManager),e}function zk(s){const e=Ze(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Vk.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Pk.bind(null,e),e}class kh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return H4(this.persistence,new z4,e.initialUser,this.serializer)}Cu(e){return new wN(Jg.Vi,this.serializer)}Du(e){return new X4}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kh.provider={build:()=>new kh};class qk extends kh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){jt(this.persistence.referenceDelegate instanceof Ch,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new T4(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?ts.withCacheSize(this.cacheSizeBytes):ts.DEFAULT;return new wN((i=>Ch.Vi(i,n)),this.serializer)}}class ug{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Cw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Uk.bind(null,this.syncEngine),await vk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new _k})()}createDatastore(e){const n=Zh(e.databaseInfo.databaseId),i=nk(e.databaseInfo);return lk(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,o,u,d,p){return new ck(i,o,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(n=>Cw(this.syncEngine,n,0)),(function(){return Nw.v()?new Nw:new J4})())}createSyncEngine(e,n){return(function(o,u,d,p,g,x,y){const _=new Ak(o,u,d,p,g,x);return y&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Ze(n);ke(sl,"RemoteStore shutting down."),i.Ea.add(5),await xu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ug.provider={build:()=>new ug};class f0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ui("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const hr="FirestoreClient";class Fk{constructor(e,n,i,o,u){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this._databaseInfo=o,this.user=Un.UNAUTHENTICATED,this.clientId=Bg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{ke(hr,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(ke(hr,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ri;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=r0(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Tp(s,e){s.asyncQueue.verifyOperationInProgress(),ke(hr,"Initializing OfflineComponentProvider");const n=s.configuration;await e.initialize(n);let i=n.initialUser;s.setCredentialChangeListener((async o=>{i.isEqual(o)||(await _N(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function kw(s,e){s.asyncQueue.verifyOperationInProgress();const n=await Hk(s);ke(hr,"Initializing OnlineComponentProvider"),await e.initialize(n,s.configuration),s.setCredentialChangeListener((i=>Sw(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,o)=>Sw(e.remoteStore,o))),s._onlineComponents=e}async function Hk(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){ke(hr,"Using user provided OfflineComponentProvider");try{await Tp(s,s._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ge.FAILED_PRECONDITION||o.code===ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(n))throw n;fo("Error using user provided cache. Falling back to memory cache: "+n),await Tp(s,new kh)}}else ke(hr,"Using default OfflineComponentProvider"),await Tp(s,new qk(void 0));return s._offlineComponents}async function BN(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(ke(hr,"Using user provided OnlineComponentProvider"),await kw(s,s._uninitializedComponentsProvider._online)):(ke(hr,"Using default OnlineComponentProvider"),await kw(s,new ug))),s._onlineComponents}function $k(s){return BN(s).then((e=>e.syncEngine))}async function Ih(s){const e=await BN(s),n=e.eventManager;return n.onListen=Ck.bind(null,e.syncEngine),n.onUnlisten=Ik.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Rk.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Dk.bind(null,e.syncEngine),n}function Gk(s,e,n,i){const o=new f0(i),u=new u0(e,o,n);return s.asyncQueue.enqueueAndForget((async()=>l0(await Ih(s),u))),()=>{o.Nu(),s.asyncQueue.enqueueAndForget((async()=>o0(await Ih(s),u)))}}function Yk(s,e,n={}){const i=new ri;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,x){const y=new f0({next:S=>{y.Nu(),d.enqueueAndForget((()=>o0(u,_)));const C=S.docs.has(p);!C&&S.fromCache?x.reject(new Ae(ge.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&S.fromCache&&g&&g.source==="server"?x.reject(new Ae(ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):x.resolve(S)},error:S=>x.reject(S)}),_=new u0(Yh(p.path),y,{includeMetadataChanges:!0,Ka:!0});return l0(u,_)})(await Ih(s),s.asyncQueue,e,n,i))),i.promise}function Kk(s,e,n={}){const i=new ri;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,x){const y=new f0({next:S=>{y.Nu(),d.enqueueAndForget((()=>o0(u,_))),S.fromCache&&g.source==="server"?x.reject(new Ae(ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):x.resolve(S)},error:S=>x.reject(S)}),_=new u0(p,y,{includeMetadataChanges:!0,Ka:!0});return l0(u,_)})(await Ih(s),s.asyncQueue,e,n,i))),i.promise}function Qk(s,e){const n=new ri;return s.asyncQueue.enqueueAndForget((async()=>Mk(await $k(s),e,n))),n.promise}function zN(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const Wk="ComponentProvider",Iw=new Map;function Xk(s,e,n,i,o){return new gR(s,e,n,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,zN(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,i)}const qN="firestore.googleapis.com",Dw=!0;class Mw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ae(ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=qN,this.ssl=Dw}else this.host=e.host,this.ssl=e.ssl??Dw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=vN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<E4)throw new Ae(ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zN(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ae(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ae(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ae(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class nf{constructor(e,n,i,o){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ae(ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ae(ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new QC;switch(i.type){case"firstParty":return new ZC(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ae(ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=Iw.get(n);i&&(ke(Wk,"Removing Datastore"),Iw.delete(n),i.terminate())})(this),Promise.resolve()}}function Jk(s,e,n,i={}){s=as(s,nf);const o=pr(e),u=s._getSettings(),d={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${n}`;o&&(Tg(`https://${p}`),jg("Firestore",!0)),u.host!==qN&&u.host!==p&&fo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:o,emulatorOptions:i};if(!Jr(g,d)&&(s._setSettings(g),i.mockUserToken)){let x,y;if(typeof i.mockUserToken=="string")x=i.mockUserToken,y=Un.MOCK_USER;else{x=P_(i.mockUserToken,s._app?.options.projectId);const _=i.mockUserToken.sub||i.mockUserToken.user_id;if(!_)throw new Ae(ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new Un(_)}s._authCredentials=new WC(new k1(x,y))}}class fl{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new fl(this.firestore,e,this._query)}}class Jt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jt(this.firestore,e,this._key)}toJSON(){return{type:Jt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(fu(n,Jt._jsonSchema))return new Jt(e,i||null,new He(Pt.fromString(n.referencePath)))}}Jt._jsonSchemaVersion="firestore/documentReference/1.0",Jt._jsonSchema={type:gn("string",Jt._jsonSchemaVersion),referencePath:gn("string")};class sr extends fl{constructor(e,n,i){super(e,n,Yh(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jt(this.firestore,null,new He(e))}withConverter(e){return new sr(this.firestore,e,this._path)}}function Je(s,e,...n){if(s=Ht(s),I1("collection","path",e),s instanceof nf){const i=Pt.fromString(e,...n);return Yv(i),new sr(s,null,i)}{if(!(s instanceof Jt||s instanceof sr))throw new Ae(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Pt.fromString(e,...n));return Yv(i),new sr(s.firestore,null,i)}}function Qe(s,e,...n){if(s=Ht(s),arguments.length===1&&(e=Bg.newId()),I1("doc","path",e),s instanceof nf){const i=Pt.fromString(e,...n);return Gv(i),new Jt(s,null,new He(i))}{if(!(s instanceof Jt||s instanceof sr))throw new Ae(ge.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Pt.fromString(e,...n));return Gv(i),new Jt(s.firestore,s instanceof sr?s.converter:null,new He(i))}}const Ow="AsyncQueue";class Vw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new EN(this,"async_queue_retry"),this._c=()=>{const i=Sp();i&&ke(Ow,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Sp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Sp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new ri;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!jo(e))throw e;ke(Ow,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ui("INTERNAL UNHANDLED ERROR: ",Pw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const o=i0.createAndSchedule(this,e,n,i,(u=>this.hc(u)));return this.tc.push(o),o}uc(){this.nc&&Ke(47125,{Pc:Pw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Pw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class hi extends nf{constructor(e,n,i,o){super(e,n,i,o),this.type="firestore",this._queue=new Vw,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Vw(e),this._firestoreClient=void 0,await e}}}function Zk(s,e){const n=typeof s=="object"?s:Rg(),i=typeof s=="string"?s:Nh,o=Uh(n,"firestore").getImmediate({identifier:i});if(!o._initialized){const u=M_("firestore");u&&Jk(o,...u)}return o}function sf(s){if(s._terminated)throw new Ae(ge.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||eI(s),s._firestoreClient}function eI(s){const e=s._freezeSettings(),n=Xk(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new Fk(s._authCredentials,s._appCheckCredentials,s._queue,n,s._componentsProvider&&(function(o){const u=o?._online.build();return{_offline:o?._offline.build(u),_online:u}})(s._componentsProvider))}class Os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Os(On.fromBase64String(e))}catch(n){throw new Ae(ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Os(On.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Os._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(fu(e,Os._jsonSchema))return Os.fromBase64String(e.bytes)}}Os._jsonSchemaVersion="firestore/bytes/1.0",Os._jsonSchema={type:gn("string",Os._jsonSchemaVersion),bytes:gn("string")};class m0{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Ae(ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Mn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class af{constructor(e){this._methodName=e}}class Ca{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Ae(ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Ae(ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mt(this._lat,e._lat)||mt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ca._jsonSchemaVersion}}static fromJSON(e){if(fu(e,Ca._jsonSchema))return new Ca(e.latitude,e.longitude)}}Ca._jsonSchemaVersion="firestore/geoPoint/1.0",Ca._jsonSchema={type:gn("string",Ca._jsonSchemaVersion),latitude:gn("number"),longitude:gn("number")};class Js{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==o[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Js._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(fu(e,Js._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Js(e.vectorValues);throw new Ae(ge.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Js._jsonSchemaVersion="firestore/vectorValue/1.0",Js._jsonSchema={type:gn("string",Js._jsonSchemaVersion),vectorValues:gn("object")};const tI=/^__.*__$/;class nI{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new yr(e,this.data,this.fieldMask,n,this.fieldTransforms):new pu(e,this.data,n,this.fieldTransforms)}}class FN{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new yr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function HN(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ke(40011,{dataSource:s})}}class p0{constructor(e,n,i,o,u,d){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=o,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new p0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const n=this.path?.child(e),i=this.contextWith({path:n,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const n=this.path?.child(e),i=this.contextWith({path:n,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Dh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(HN(this.dataSource)&&tI.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class sI{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||Zh(e)}createContext(e,n,i,o=!1){return new p0({dataSource:e,methodName:n,targetDoc:i,path:Mn.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rf(s){const e=s._freezeSettings(),n=Zh(s._databaseId);return new sI(s._databaseId,!!e.ignoreUndefinedProperties,n)}function $N(s,e,n,i,o,u={}){const d=s.createContext(u.merge||u.mergeFields?2:0,e,n,o);x0("Data must be an object, but it was:",d,i);const p=GN(i,d);let g,x;if(u.merge)g=new gs(d.fieldMask),x=d.fieldTransforms;else if(u.mergeFields){const y=[];for(const _ of u.mergeFields){const S=yo(e,_,n);if(!d.contains(S))throw new Ae(ge.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);QN(y,S)||y.push(S)}g=new gs(y),x=d.fieldTransforms.filter((_=>g.covers(_.field)))}else g=null,x=d.fieldTransforms;return new nI(new ns(p),g,x)}class lf extends af{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lf}}class g0 extends af{_toFieldTransform(e){return new HR(e.path,new tu)}isEqual(e){return e instanceof g0}}function aI(s,e,n,i){const o=s.createContext(1,e,n);x0("Data must be an object, but it was:",o,i);const u=[],d=ns.empty();br(i,((g,x)=>{const y=KN(e,g,n);x=Ht(x);const _=o.childContextForFieldPath(y);if(x instanceof lf)u.push(y);else{const S=yu(x,_);S!=null&&(u.push(y),d.set(y,S))}}));const p=new gs(u);return new FN(d,p,o.fieldTransforms)}function iI(s,e,n,i,o,u){const d=s.createContext(1,e,n),p=[yo(e,i,n)],g=[o];if(u.length%2!=0)throw new Ae(ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<u.length;S+=2)p.push(yo(e,u[S])),g.push(u[S+1]);const x=[],y=ns.empty();for(let S=p.length-1;S>=0;--S)if(!QN(x,p[S])){const C=p[S];let H=g[S];H=Ht(H);const B=d.childContextForFieldPath(C);if(H instanceof lf)x.push(C);else{const P=yu(H,B);P!=null&&(x.push(C),y.set(C,P))}}const _=new gs(x);return new FN(y,_,d.fieldTransforms)}function rI(s,e,n,i=!1){return yu(n,s.createContext(i?4:3,e))}function yu(s,e){if(YN(s=Ht(s)))return x0("Unsupported field value:",e,s),GN(s,e);if(s instanceof af)return(function(i,o){if(!HN(o.dataSource))throw o.createError(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(o);u&&o.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,o){const u=[];let d=0;for(const p of i){let g=yu(p,o.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(s,e)}return(function(i,o){if((i=Ht(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return zR(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Tt.fromDate(i);return{timestampValue:Ah(o.serializer,u)}}if(i instanceof Tt){const u=new Tt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ah(o.serializer,u)}}if(i instanceof Ca)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Os)return{bytesValue:hN(o.serializer,i._byteString)};if(i instanceof Jt){const u=o.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw o.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Wg(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof Js)return(function(d,p){const g=d instanceof Js?d.toArray():d;return{mapValue:{fields:{[z1]:{stringValue:q1},[Eh]:{arrayValue:{values:g.map((y=>{if(typeof y!="number")throw p.createError("VectorValues must only contain numeric values.");return Gg(p.serializer,y)}))}}}}}})(i,o);if(yN(i))return i._toProto(o.serializer);throw o.createError(`Unsupported field value: ${Fh(i)}`)})(s,e)}function GN(s,e){const n={};return O1(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):br(s,((i,o)=>{const u=yu(o,e.childContextForField(i));u!=null&&(n[i]=u)})),{mapValue:{fields:n}}}function YN(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Tt||s instanceof Ca||s instanceof Os||s instanceof Jt||s instanceof af||s instanceof Js||yN(s))}function x0(s,e,n){if(!YN(n)||!D1(n)){const i=Fh(n);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function yo(s,e,n){if((e=Ht(e))instanceof m0)return e._internalPath;if(typeof e=="string")return KN(s,e);throw Dh("Field path arguments must be of type string or ",s,!1,void 0,n)}const lI=new RegExp("[~\\*/\\[\\]]");function KN(s,e,n){if(e.search(lI)>=0)throw Dh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,n);try{return new m0(...e.split("."))._internalPath}catch{throw Dh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,n)}}function Dh(s,e,n,i,o){const u=i&&!i.isEmpty(),d=o!==void 0;let p=`Function ${e}() called with invalid data`;n&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${o}`),g+=")"),new Ae(ge.INVALID_ARGUMENT,p+s+g)}function QN(s,e){return s.some((n=>n.isEqual(e)))}class oI{convertValue(e,n="none"){switch(ur(e)){case 0:return null;case 1:return e.booleanValue;case 2:return an(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(cr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ke(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return br(e,((o,u)=>{i[o]=this.convertValue(u,n)})),i}convertVectorValue(e){const n=e.fields?.[Eh].arrayValue?.values?.map((i=>an(i.doubleValue)));return new Js(n)}convertGeoPoint(e){return new Ca(an(e.latitude),an(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Gh(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Jc(e));default:return null}}convertTimestamp(e){const n=or(e);return new Tt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=Pt.fromString(e);jt(bN(i),9688,{name:e});const o=new Zc(i.get(1),i.get(3)),u=new He(i.popFirst(5));return o.isEqual(n)||ui(`Document ${u} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),u}}class b0 extends oI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Os(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Jt(this.firestore,null,n)}}function y0(){return new g0("serverTimestamp")}const Lw="@firebase/firestore",Uw="4.10.0";function Bw(s){return(function(n,i){if(typeof n!="object"||n===null)return!1;const o=n;for(const u of i)if(u in o&&typeof o[u]=="function")return!0;return!1})(s,["next","error","complete"])}class WN{constructor(e,n,i,o,u){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=o,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new cI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const n=this._document.data.field(yo("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class cI extends WN{data(){return super.data()}}function XN(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ae(ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class v0{}class uI extends v0{}function ys(s,e,...n){let i=[];e instanceof v0&&i.push(e),i=i.concat(n),(function(u){const d=u.filter((g=>g instanceof w0)).length,p=u.filter((g=>g instanceof of)).length;if(d>1||d>0&&p>0)throw new Ae(ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const o of i)s=o._apply(s);return s}class of extends uI{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new of(e,n,i)}_apply(e){const n=this._parse(e);return JN(e._query,n),new fl(e.firestore,e.converter,eg(e._query,n))}_parse(e){const n=rf(e.firestore);return(function(u,d,p,g,x,y,_){let S;if(x.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new Ae(ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){qw(_,y);const H=[];for(const B of _)H.push(zw(g,u,B));S={arrayValue:{values:H}}}else S=zw(g,u,_)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||qw(_,y),S=rI(p,d,_,y==="in"||y==="not-in");return pn.create(x,y,S)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ss(s,e,n){const i=e,o=yo("where",s);return of._create(o,i,n)}class w0 extends v0{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new w0(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:ea.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(o,u){let d=o;const p=u.getFlattenedFilters();for(const g of p)JN(d,g),d=eg(d,g)})(e._query,n),new fl(e.firestore,e.converter,eg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function zw(s,e,n){if(typeof(n=Ht(n))=="string"){if(n==="")throw new Ae(ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!W1(e)&&n.indexOf("/")!==-1)throw new Ae(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Pt.fromString(n));if(!He.isDocumentKey(i))throw new Ae(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return tw(s,new He(i))}if(n instanceof Jt)return tw(s,n._key);throw new Ae(ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Fh(n)}.`)}function qw(s,e){if(!Array.isArray(s)||s.length===0)throw new Ae(ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function JN(s,e){const n=(function(o,u){for(const d of o)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Ae(ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ae(ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function ZN(s,e,n){let i;return i=s?s.toFirestore(e):e,i}class Pc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qr extends WN{constructor(e,n,i,o,u,d){super(e,n,i,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new uh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(yo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(ge.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Qr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Qr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qr._jsonSchema={type:gn("string",Qr._jsonSchemaVersion),bundleSource:gn("string","DocumentSnapshot"),bundleName:gn("string"),bundle:gn("string")};class uh extends Qr{data(e={}){return super.data(e)}}class Wr{constructor(e,n,i,o){this._firestore=e,this._userDataWriter=n,this._snapshot=o,this.metadata=new Pc(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new uh(this._firestore,this._userDataWriter,i.key,i,new Pc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Ae(ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(o,u){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((p=>{const g=new uh(o._firestore,o._userDataWriter,p.doc.key,p.doc,new Pc(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new uh(o._firestore,o._userDataWriter,p.doc.key,p.doc,new Pc(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);let x=-1,y=-1;return p.type!==0&&(x=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),y=d.indexOf(p.doc.key)),{type:dI(p.type),doc:g,oldIndex:x,newIndex:y}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(ge.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Wr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Bg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],o=[];return this.docs.forEach((u=>{u._document!==null&&(n.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),o.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function dI(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ke(61501,{type:s})}}Wr._jsonSchemaVersion="firestore/querySnapshot/1.0",Wr._jsonSchema={type:gn("string",Wr._jsonSchemaVersion),bundleSource:gn("string","QuerySnapshot"),bundleName:gn("string"),bundle:gn("string")};function jp(s){s=as(s,Jt);const e=as(s.firestore,hi),n=sf(e);return Yk(n,s._key).then((i=>e2(e,s,i)))}function vs(s){s=as(s,fl);const e=as(s.firestore,hi),n=sf(e),i=new b0(e);return XN(s._query),Kk(n,s._query).then((o=>new Wr(e,i,s,o)))}function Ap(s,e,n){s=as(s,Jt);const i=as(s.firestore,hi),o=ZN(s.converter,e),u=rf(i);return cf(i,[$N(u,"setDoc",s._key,o,s.converter!==null,n).toMutation(s._key,Vs.none())])}function st(s,e,n,...i){s=as(s,Jt);const o=as(s.firestore,hi),u=rf(o);let d;return d=typeof(e=Ht(e))=="string"||e instanceof m0?iI(u,"updateDoc",s._key,e,n,i):aI(u,"updateDoc",s._key,e),cf(o,[d.toMutation(s._key,Vs.exists(!0))])}function hI(s){return cf(as(s.firestore,hi),[new Yg(s._key,Vs.none())])}function fi(s,e){const n=as(s.firestore,hi),i=Qe(s),o=ZN(s.converter,e),u=rf(s.firestore);return cf(n,[$N(u,"addDoc",i._key,o,s.converter!==null,{}).toMutation(i._key,Vs.exists(!1))]).then((()=>i))}function Wt(s,...e){s=Ht(s);let n={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Bw(e[i])||(n=e[i++]);const o={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Bw(e[i])){const x=e[i];e[i]=x.next?.bind(x),e[i+1]=x.error?.bind(x),e[i+2]=x.complete?.bind(x)}let u,d,p;if(s instanceof Jt)d=as(s.firestore,hi),p=Yh(s._key.path),u={next:x=>{e[i]&&e[i](e2(d,s,x))},error:e[i+1],complete:e[i+2]};else{const x=as(s,fl);d=as(x.firestore,hi),p=x._query;const y=new b0(d);u={next:_=>{e[i]&&e[i](new Wr(d,y,x,_))},error:e[i+1],complete:e[i+2]},XN(s._query)}const g=sf(d);return Gk(g,p,o,u)}function cf(s,e){const n=sf(s);return Qk(n,e)}function e2(s,e,n){const i=n.docs.get(e._key),o=new b0(s);return new Qr(s,o,e._key,i,new Pc(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){KC(cl),Zr(new rr("firestore",((i,{instanceIdentifier:o,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new hi(new XC(i.getProvider("auth-internal")),new eR(d,i.getProvider("app-check-internal")),xR(d,o),d);return u={useFetchStreams:n,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),Ea(Lw,Uw,e),Ea(Lw,Uw,"esm2020")})();const t2="firebasestorage.googleapis.com",n2="storageBucket",fI=120*1e3,mI=600*1e3;class en extends Ma{constructor(e,n,i=0){super(Cp(e),`Firebase Storage: ${n} (${Cp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,en.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Cp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Zt;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Zt||(Zt={}));function Cp(s){return"storage/"+s}function _0(){const s="An unknown error occurred, please check the error payload for server response.";return new en(Zt.UNKNOWN,s)}function pI(s){return new en(Zt.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function gI(s){return new en(Zt.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function xI(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new en(Zt.UNAUTHENTICATED,s)}function bI(){return new en(Zt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function yI(s){return new en(Zt.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function vI(){return new en(Zt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function wI(){return new en(Zt.CANCELED,"User canceled the upload/download.")}function _I(s){return new en(Zt.INVALID_URL,"Invalid URL '"+s+"'.")}function NI(s){return new en(Zt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function EI(){return new en(Zt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+n2+"' property when initializing the app?")}function SI(){return new en(Zt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function TI(){return new en(Zt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function jI(s){return new en(Zt.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function dg(s){return new en(Zt.INVALID_ARGUMENT,s)}function s2(){return new en(Zt.APP_DELETED,"The Firebase app was deleted.")}function AI(s){return new en(Zt.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function $c(s,e){return new en(Zt.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Rc(s){throw new en(Zt.INTERNAL_ERROR,"Internal error: "+s)}class xs{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let i;try{i=xs.makeFromUrl(e,n)}catch{return new xs(e,"")}if(i.path==="")return i;throw NI(e)}static makeFromUrl(e,n){let i=null;const o="([A-Za-z0-9.\\-_]+)";function u(xe){xe.path.charAt(xe.path.length-1)==="/"&&(xe.path_=xe.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+o+d,"i"),g={bucket:1,path:3};function x(xe){xe.path_=decodeURIComponent(xe.path)}const y="v[A-Za-z0-9_]+",_=n.replace(/[.]/g,"\\."),S="(/([^?#]*).*)?$",C=new RegExp(`^https?://${_}/${y}/b/${o}/o${S}`,"i"),H={bucket:1,path:3},B=n===t2?"(?:storage.googleapis.com|storage.cloud.google.com)":n,P="([^?#]*)",q=new RegExp(`^https?://${B}/${o}/${P}`,"i"),W=[{regex:p,indices:g,postModify:u},{regex:C,indices:H,postModify:x},{regex:q,indices:{bucket:1,path:2},postModify:x}];for(let xe=0;xe<W.length;xe++){const me=W[xe],re=me.regex.exec(e);if(re){const j=re[me.indices.bucket];let T=re[me.indices.path];T||(T=""),i=new xs(j,T),me.postModify(i);break}}if(i==null)throw _I(e);return i}}class CI{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function RI(s,e,n){let i=1,o=null,u=null,d=!1,p=0;function g(){return p===2}let x=!1;function y(...P){x||(x=!0,e.apply(null,P))}function _(P){o=setTimeout(()=>{o=null,s(C,g())},P)}function S(){u&&clearTimeout(u)}function C(P,...q){if(x){S();return}if(P){S(),y.call(null,P,...q);return}if(g()||d){S(),y.call(null,P,...q);return}i<64&&(i*=2);let W;p===1?(p=2,W=0):W=(i+Math.random())*1e3,_(W)}let H=!1;function B(P){H||(H=!0,S(),!x&&(o!==null?(P||(p=2),clearTimeout(o),_(0)):P||(p=1)))}return _(0),u=setTimeout(()=>{d=!0,B(!0)},n),B}function kI(s){s(!1)}function II(s){return s!==void 0}function DI(s){return typeof s=="object"&&!Array.isArray(s)}function N0(s){return typeof s=="string"||s instanceof String}function Fw(s){return E0()&&s instanceof Blob}function E0(){return typeof Blob<"u"}function Hw(s,e,n,i){if(i<e)throw dg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>n)throw dg(`Invalid value for '${s}'. Expected ${n} or less.`)}function uf(s,e,n){let i=e;return n==null&&(i=`https://${e}`),`${n}://${i}/v0${s}`}function a2(s){const e=encodeURIComponent;let n="?";for(const i in s)if(s.hasOwnProperty(i)){const o=e(i)+"="+e(s[i]);n=n+o+"&"}return n=n.slice(0,-1),n}var Xr;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Xr||(Xr={}));function MI(s,e){const n=s>=500&&s<600,o=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return n||o||u}class OI{constructor(e,n,i,o,u,d,p,g,x,y,_,S=!0,C=!1){this.url_=e,this.method_=n,this.headers_=i,this.body_=o,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=x,this.progressCallback_=y,this.connectionFactory_=_,this.retry=S,this.isUsingEmulator=C,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((H,B)=>{this.resolve_=H,this.reject_=B,this.start_()})}start_(){const e=(i,o)=>{if(o){i(!1,new Qd(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,x=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,x)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Xr.NO_ERROR,g=u.getStatus();if(!p||MI(g,this.additionalRetryCodes_)&&this.retry){const y=u.getErrorCode()===Xr.ABORT;i(!1,new Qd(!1,null,y));return}const x=this.successCodes_.indexOf(g)!==-1;i(!0,new Qd(x,u))})},n=(i,o)=>{const u=this.resolve_,d=this.reject_,p=o.connection;if(o.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());II(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=_0();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(o.canceled){const g=this.appDelete_?s2():wI();d(g)}else{const g=vI();d(g)}};this.canceled_?n(!1,new Qd(!1,null,!0)):this.backoffId_=RI(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&kI(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Qd{constructor(e,n,i){this.wasSuccessCode=e,this.connection=n,this.canceled=!!i}}function VI(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function PI(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function LI(s,e){e&&(s["X-Firebase-GMPID"]=e)}function UI(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function BI(s,e,n,i,o,u,d=!0,p=!1){const g=a2(s.urlParams),x=s.url+g,y=Object.assign({},s.headers);return LI(y,e),VI(y,n),PI(y,u),UI(y,i),new OI(x,s.method,y,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,o,d,p)}function zI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function qI(...s){const e=zI();if(e!==void 0){const n=new e;for(let i=0;i<s.length;i++)n.append(s[i]);return n.getBlob()}else{if(E0())return new Blob(s);throw new en(Zt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function FI(s,e,n){return s.webkitSlice?s.webkitSlice(e,n):s.mozSlice?s.mozSlice(e,n):s.slice?s.slice(e,n):null}function HI(s){if(typeof atob>"u")throw jI("base-64");return atob(s)}const Na={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Rp{constructor(e,n){this.data=e,this.contentType=n||null}}function $I(s,e){switch(s){case Na.RAW:return new Rp(i2(e));case Na.BASE64:case Na.BASE64URL:return new Rp(r2(s,e));case Na.DATA_URL:return new Rp(YI(e),KI(e))}throw _0()}function i2(s){const e=[];for(let n=0;n<s.length;n++){let i=s.charCodeAt(n);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<s.length-1&&(s.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=s.charCodeAt(++n);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function GI(s){let e;try{e=decodeURIComponent(s)}catch{throw $c(Na.DATA_URL,"Malformed data URL.")}return i2(e)}function r2(s,e){switch(s){case Na.BASE64:{const o=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(o||u)throw $c(s,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Na.BASE64URL:{const o=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(o||u)throw $c(s,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=HI(e)}catch(o){throw o.message.includes("polyfill")?o:$c(s,"Invalid character found")}const i=new Uint8Array(n.length);for(let o=0;o<n.length;o++)i[o]=n.charCodeAt(o);return i}class l2{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw $c(Na.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=QI(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function YI(s){const e=new l2(s);return e.base64?r2(Na.BASE64,e.rest):GI(e.rest)}function KI(s){return new l2(s).contentType}function QI(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class Ji{constructor(e,n){let i=0,o="";Fw(e)?(this.data_=e,i=e.size,o=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,n){if(Fw(this.data_)){const i=this.data_,o=FI(i,e,n);return o===null?null:new Ji(o)}else{const i=new Uint8Array(this.data_.buffer,e,n-e);return new Ji(i,!0)}}static getBlob(...e){if(E0()){const n=e.map(i=>i instanceof Ji?i.data_:i);return new Ji(qI.apply(null,n))}else{const n=e.map(d=>N0(d)?$I(Na.RAW,d).data:d.data_);let i=0;n.forEach(d=>{i+=d.byteLength});const o=new Uint8Array(i);let u=0;return n.forEach(d=>{for(let p=0;p<d.length;p++)o[u++]=d[p]}),new Ji(o,!0)}}uploadData(){return this.data_}}function o2(s){let e;try{e=JSON.parse(s)}catch{return null}return DI(e)?e:null}function WI(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function XI(s,e){const n=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?n:s+"/"+n}function c2(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function JI(s,e){return e}class Yn{constructor(e,n,i,o){this.server=e,this.local=n||e,this.writable=!!i,this.xform=o||JI}}let Wd=null;function ZI(s){return!N0(s)||s.length<2?s:c2(s)}function u2(){if(Wd)return Wd;const s=[];s.push(new Yn("bucket")),s.push(new Yn("generation")),s.push(new Yn("metageneration")),s.push(new Yn("name","fullPath",!0));function e(u,d){return ZI(d)}const n=new Yn("name");n.xform=e,s.push(n);function i(u,d){return d!==void 0?Number(d):d}const o=new Yn("size");return o.xform=i,s.push(o),s.push(new Yn("timeCreated")),s.push(new Yn("updated")),s.push(new Yn("md5Hash",null,!0)),s.push(new Yn("cacheControl",null,!0)),s.push(new Yn("contentDisposition",null,!0)),s.push(new Yn("contentEncoding",null,!0)),s.push(new Yn("contentLanguage",null,!0)),s.push(new Yn("contentType",null,!0)),s.push(new Yn("metadata","customMetadata",!0)),Wd=s,Wd}function e6(s,e){function n(){const i=s.bucket,o=s.fullPath,u=new xs(i,o);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:n})}function t6(s,e,n){const i={};i.type="file";const o=n.length;for(let u=0;u<o;u++){const d=n[u];i[d.local]=d.xform(i,e[d.server])}return e6(i,s),i}function d2(s,e,n){const i=o2(e);return i===null?null:t6(s,i,n)}function n6(s,e,n,i){const o=o2(e);if(o===null||!N0(o.downloadTokens))return null;const u=o.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(x=>{const y=s.bucket,_=s.fullPath,S="/b/"+d(y)+"/o/"+d(_),C=uf(S,n,i),H=a2({alt:"media",token:x});return C+H})[0]}function s6(s,e){const n={},i=e.length;for(let o=0;o<i;o++){const u=e[o];u.writable&&(n[u.server]=s[u.local])}return JSON.stringify(n)}class S0{constructor(e,n,i,o){this.url=e,this.method=n,this.handler=i,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function h2(s){if(!s)throw _0()}function a6(s,e){function n(i,o){const u=d2(s,o,e);return h2(u!==null),u}return n}function i6(s,e){function n(i,o){const u=d2(s,o,e);return h2(u!==null),n6(u,o,s.host,s._protocol)}return n}function f2(s){function e(n,i){let o;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?o=bI():o=xI():n.getStatus()===402?o=gI(s.bucket):n.getStatus()===403?o=yI(s.path):o=i,o.status=n.getStatus(),o.serverResponse=i.serverResponse,o}return e}function m2(s){const e=f2(s);function n(i,o){let u=e(i,o);return i.getStatus()===404&&(u=pI(s.path)),u.serverResponse=o.serverResponse,u}return n}function r6(s,e,n){const i=e.fullServerUrl(),o=uf(i,s.host,s._protocol),u="GET",d=s.maxOperationRetryTime,p=new S0(o,u,i6(s,n),d);return p.errorHandler=m2(e),p}function l6(s,e){const n=e.fullServerUrl(),i=uf(n,s.host,s._protocol),o="DELETE",u=s.maxOperationRetryTime;function d(g,x){}const p=new S0(i,o,d,u);return p.successCodes=[200,204],p.errorHandler=m2(e),p}function o6(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function c6(s,e,n){const i=Object.assign({},n);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=o6(null,e)),i}function u6(s,e,n,i,o){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let W="";for(let xe=0;xe<2;xe++)W=W+Math.random().toString().slice(2);return W}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const x=c6(e,i,o),y=s6(x,n),_="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+y+`\r
--`+g+`\r
Content-Type: `+x.contentType+`\r
\r
`,S=`\r
--`+g+"--",C=Ji.getBlob(_,i,S);if(C===null)throw SI();const H={name:x.fullPath},B=uf(u,s.host,s._protocol),P="POST",q=s.maxUploadRetryTime,Y=new S0(B,P,a6(s,n),q);return Y.urlParams=H,Y.headers=d,Y.body=C.uploadData(),Y.errorHandler=f2(e),Y}class d6{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Xr.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Xr.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Xr.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,i,o,u){if(this.sent_)throw Rc("cannot .send() more than once");if(pr(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Rc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Rc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Rc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Rc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class h6 extends d6{initXhr(){this.xhr_.responseType="text"}}function T0(){return new h6}class al{constructor(e,n){this._service=e,n instanceof xs?this._location=n:this._location=xs.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new al(e,n)}get root(){const e=new xs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return c2(this._location.path)}get storage(){return this._service}get parent(){const e=WI(this._location.path);if(e===null)return null;const n=new xs(this._location.bucket,e);return new al(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw AI(e)}}function f6(s,e,n){s._throwIfRoot("uploadBytes");const i=u6(s.storage,s._location,u2(),new Ji(e,!0),n);return s.storage.makeRequestWithTokens(i,T0).then(o=>({metadata:o,ref:s}))}function m6(s){s._throwIfRoot("getDownloadURL");const e=r6(s.storage,s._location,u2());return s.storage.makeRequestWithTokens(e,T0).then(n=>{if(n===null)throw TI();return n})}function p6(s){s._throwIfRoot("deleteObject");const e=l6(s.storage,s._location);return s.storage.makeRequestWithTokens(e,T0)}function g6(s,e){const n=XI(s._location.path,e),i=new xs(s._location.bucket,n);return new al(s.storage,i)}function x6(s){return/^[A-Za-z]+:\/\//.test(s)}function b6(s,e){return new al(s,e)}function p2(s,e){if(s instanceof j0){const n=s;if(n._bucket==null)throw EI();const i=new al(n,n._bucket);return e!=null?p2(i,e):i}else return e!==void 0?g6(s,e):s}function y6(s,e){if(e&&x6(e)){if(s instanceof j0)return b6(s,e);throw dg("To use ref(service, url), the first argument must be a Storage instance.")}else return p2(s,e)}function $w(s,e){const n=e?.[n2];return n==null?null:xs.makeFromBucketSpec(n,s)}function v6(s,e,n,i={}){s.host=`${e}:${n}`;const o=pr(e);o&&(Tg(`https://${s.host}/b`),jg("Storage",!0)),s._isUsingEmulator=!0,s._protocol=o?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:P_(u,s.app.options.projectId))}class j0{constructor(e,n,i,o,u,d=!1){this.app=e,this._authProvider=n,this._appCheckProvider=i,this._url=o,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=t2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=fI,this._maxUploadRetryTime=mI,this._requests=new Set,o!=null?this._bucket=xs.makeFromBucketSpec(o,this._host):this._bucket=$w(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=xs.makeFromBucketSpec(this._url,e):this._bucket=$w(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Hw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Hw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(ps(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new al(this,e)}_makeRequest(e,n,i,o,u=!0){if(this._deleted)return new CI(s2());{const d=BI(e,this._appId,i,o,n,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,n){const[i,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,i,o).getPromise()}}const Gw="@firebase/storage",Yw="0.14.0";const g2="storage";function w6(s,e,n){return s=Ht(s),f6(s,e,n)}function _6(s){return s=Ht(s),m6(s)}function N6(s){return s=Ht(s),p6(s)}function Kw(s,e){return s=Ht(s),y6(s,e)}function E6(s=Rg(),e){s=Ht(s);const i=Uh(s,g2).getImmediate({identifier:e}),o=M_("storage");return o&&S6(i,...o),i}function S6(s,e,n,i={}){v6(s,e,n,i)}function T6(s,{instanceIdentifier:e}){const n=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),o=s.getProvider("app-check-internal");return new j0(n,i,o,e,cl)}function j6(){Zr(new rr(g2,T6,"PUBLIC").setMultipleInstances(!0)),Ea(Gw,Yw,""),Ea(Gw,Yw,"esm2020")}j6();const A6={apiKey:"AIzaSyC1qZ9fK-6LFBxVWZsAD4dZq-KVg36A7f8",authDomain:"scheduler-65e51.firebaseapp.com",projectId:"scheduler-65e51",storageBucket:"scheduler-65e51.firebasestorage.app",messagingSenderId:"93993791456",appId:"1:93993791456:web:3a777a2da0dad4b8b74585"},A0=B_(A6),Ne=Zk(A0),il=HC(A0),Qw=E6(A0);const x2=(...s)=>s.filter((e,n,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===n).join(" ").trim();const C6=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const R6=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,i)=>i?i.toUpperCase():n.toLowerCase());const Ww=s=>{const e=R6(s);return e.charAt(0).toUpperCase()+e.slice(1)};var k6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const I6=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const D6=N.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:o="",children:u,iconNode:d,...p},g)=>N.createElement("svg",{ref:g,...k6,width:e,height:e,stroke:s,strokeWidth:i?Number(n)*24/Number(e):n,className:x2("lucide",o),...!u&&!I6(p)&&{"aria-hidden":"true"},...p},[...d.map(([x,y])=>N.createElement(x,y)),...Array.isArray(u)?u:[u]]));const Oe=(s,e)=>{const n=N.forwardRef(({className:i,...o},u)=>N.createElement(D6,{ref:u,iconNode:e,className:x2(`lucide-${C6(Ww(s))}`,`lucide-${s}`,i),...o}));return n.displayName=Ww(s),n};const M6=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],O6=Oe("arrow-down-right",M6);const V6=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ra=Oe("arrow-left",V6);const P6=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Gc=Oe("arrow-right",P6);const L6=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],U6=Oe("arrow-up-down",L6);const B6=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],z6=Oe("arrow-up-right",B6);const q6=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],io=Oe("bell",q6);const F6=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],kp=Oe("calendar-check",F6);const H6=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Xw=Oe("calendar-days",H6);const $6=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Vt=Oe("calendar",$6);const G6=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Y6=Oe("camera",G6);const K6=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],b2=Oe("chart-column",K6);const Q6=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],W6=Oe("chart-pie",Q6);const X6=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ar=Oe("check",X6);const J6=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],hg=Oe("chevron-down",J6);const Z6=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],y2=Oe("chevron-left",Z6);const e3=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],df=Oe("chevron-right",e3);const t3=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],fg=Oe("chevron-up",t3);const n3=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],bs=Oe("circle-check-big",n3);const s3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],_a=Oe("circle-x",s3);const a3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],jn=Oe("clock",a3);const i3=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],r3=Oe("coffee",i3);const l3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],o3=Oe("copy",l3);const c3=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],u3=Oe("dollar-sign",c3);const d3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],h3=Oe("eye",d3);const f3=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],m3=Oe("ghost",f3);const p3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],g3=Oe("globe",p3);const x3=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],C0=Oe("heart",x3);const b3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],y3=Oe("image",b3);const v3=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],mg=Oe("list-ordered",v3);const w3=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]],Mh=Oe("list-plus",w3);const _3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ip=Oe("loader-circle",_3);const N3=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],v2=Oe("lock",N3);const E3=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],S3=Oe("log-out",E3);const T3=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],pg=Oe("mail",T3);const j3=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Oh=Oe("message-circle",j3);const A3=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],C3=Oe("message-square",A3);const R3=[["path",{d:"M5 12h14",key:"1ays0h"}]],k3=Oe("minus",R3);const I3=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],w2=Oe("party-popper",I3);const D3=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],_2=Oe("pen-line",D3);const M3=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],gg=Oe("phone",M3);const O3=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Dp=Oe("play",O3);const V3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],fr=Oe("plus",V3);const P3=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],N2=Oe("refresh-cw",P3);const L3=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],ir=Oe("repeat",L3);const U3=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],B3=Oe("save",U3);const z3=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],Da=Oe("scissors",z3);const q3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],F3=Oe("search",q3);const H3=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],dh=Oe("send",H3);const $3=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],G3=Oe("settings",$3);const Y3=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],K3=Oe("sparkles",Y3);const Q3=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Jw=Oe("star",Q3);const W3=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],Zw=Oe("sticky-note",W3);const X3=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],is=Oe("tag",X3);const J3=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],E2=Oe("thermometer",J3);const Z3=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],S2=Oe("timer",Z3);const eD=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],au=Oe("trash-2",eD);const tD=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],R0=Oe("trending-up",tD);const nD=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],rl=Oe("triangle-alert",nD);const sD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],aD=Oe("user-plus",sD);const iD=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ll=Oe("user",iD);const rD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Xt=Oe("users",rD);const lD=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ka=Oe("x",lD);const oD=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],cD=Oe("zap",oD);function e_({className:s=""}){return r.jsxs(et,{to:"/",className:`flex items-center gap-2.5 ${s}`,children:[r.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:r.jsx(Da,{className:"w-[18px] h-[18px] text-white"})}),r.jsxs("span",{className:"text-xl font-extrabold tracking-tight text-slate-900",children:["Book",r.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}function uD(){return r.jsxs("div",{className:"min-h-screen bg-white",children:[r.jsx("nav",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-100",children:r.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsx(e_,{}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(et,{to:"/login",className:"px-4 py-2.5 text-sm font-semibold text-slate-600 hover:text-slate-900 transition-colors",children:"Sign In"}),r.jsxs(et,{to:"/register",className:"hidden sm:inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:["Get Started Free",r.jsx(Gc,{className:"w-4 h-4"})]}),r.jsx(et,{to:"/register",className:"sm:hidden px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl text-sm font-semibold transition-all",children:"Start Free"})]})]})}),r.jsxs("section",{className:"relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 -z-10",children:[r.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-blue-50 rounded-full blur-3xl opacity-60 -translate-y-1/2 translate-x-1/3"}),r.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-violet-50 rounded-full blur-3xl opacity-50 translate-y-1/3 -translate-x-1/4"})]}),r.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 pt-16 sm:pt-24 pb-16 sm:pb-20",children:r.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-16 items-center",children:[r.jsxs("div",{className:"animate-fade-in-up",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 px-3.5 py-1.5 bg-blue-50 border border-blue-100 rounded-full text-sm font-medium text-blue-700 mb-6",children:[r.jsx(K3,{className:"w-3.5 h-3.5"}),"Free for beauty professionals"]}),r.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-[3.5rem] font-extrabold text-slate-900 leading-[1.1] mb-6 tracking-tight",children:["Online booking",r.jsx("br",{}),r.jsx("span",{className:"text-blue-600",children:"made effortless"})]}),r.jsx("p",{className:"text-lg sm:text-xl text-slate-600 leading-relaxed mb-8 max-w-lg",children:"Let clients book 24/7. Manage your team, services, and schedule from one beautiful dashboard. No more phone tag."}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-10",children:[r.jsxs(et,{to:"/register",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-base shadow-lg shadow-blue-600/25 hover:shadow-xl hover:shadow-blue-600/30 transition-all hover:-translate-y-0.5",children:["Start for Free",r.jsx(Gc,{className:"w-4 h-4"})]}),r.jsx("a",{href:"#how-it-works",className:"inline-flex items-center justify-center gap-2 px-7 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-base border border-slate-200 transition-all",children:"See How It Works"})]}),r.jsxs("div",{className:"flex items-center gap-5 text-sm text-slate-500",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(bs,{className:"w-4 h-4 text-emerald-500"}),r.jsx("span",{children:"Free to use"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(bs,{className:"w-4 h-4 text-emerald-500"}),r.jsx("span",{children:"No credit card"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(bs,{className:"w-4 h-4 text-emerald-500"}),r.jsx("span",{children:"Setup in 2 min"})]})]})]}),r.jsxs("div",{className:"relative animate-fade-in-up",style:{animationDelay:"150ms"},children:[r.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl shadow-slate-200/60 border border-slate-200/80 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-slate-50 border-b border-slate-100",children:[r.jsxs("div",{className:"flex gap-1.5",children:[r.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),r.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"}),r.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-200"})]}),r.jsx("div",{className:"flex-1 mx-4",children:r.jsx("div",{className:"bg-white border border-slate-200 rounded-lg px-3 py-1.5 text-xs text-slate-400 font-mono",children:"bookflow.app/shop/janes-salon"})})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-sm font-bold",children:"J"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-slate-900",children:"Jane's Salon"}),r.jsx("div",{className:"text-xs text-slate-500",children:"Book your next appointment"})]})]}),r.jsx("div",{className:"space-y-2.5",children:[{name:"Haircut & Style",price:"$45",time:"45 min",color:"bg-blue-500"},{name:"Color Treatment",price:"$120",time:"2 hours",color:"bg-violet-500"},{name:"Blowout",price:"$35",time:"30 min",color:"bg-emerald-500"}].map(s=>r.jsxs("div",{className:"flex items-center justify-between p-3.5 bg-slate-50 rounded-xl border border-slate-100 group hover:border-blue-200 hover:bg-blue-50/50 transition-all cursor-default",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-2 h-8 ${s.color} rounded-full`}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold text-slate-800",children:s.name}),r.jsx("div",{className:"text-xs text-slate-500",children:s.time})]})]}),r.jsx("div",{className:"text-sm font-bold text-slate-900",children:s.price})]},s.name))})]})]}),r.jsxs("div",{className:"absolute -bottom-4 -left-4 bg-white rounded-xl shadow-lg shadow-slate-200/60 border border-slate-100 px-4 py-3 flex items-center gap-3 animate-float",children:[r.jsx("div",{className:"w-9 h-9 bg-emerald-100 rounded-full flex items-center justify-center",children:r.jsx(bs,{className:"w-5 h-5 text-emerald-600"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-slate-500",children:"Booking confirmed"}),r.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Tomorrow at 2:00 PM"})]})]})]})]})})]}),r.jsx("section",{className:"border-y border-slate-100 bg-slate-50/50",children:r.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-8 sm:py-10",children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-8 sm:gap-16 text-center",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"500+"}),r.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Businesses trust BookFlow"})]}),r.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900",children:"10,000+"}),r.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Appointments booked"})]}),r.jsx("div",{className:"hidden sm:block w-px h-10 bg-slate-200"}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl sm:text-3xl font-extrabold text-slate-900",children:["4.9 ",r.jsx(Jw,{className:"w-5 h-5 text-amber-400 fill-amber-400"})]}),r.jsx("div",{className:"text-sm text-slate-500 font-medium",children:"Average rating"})]})]})})}),r.jsx("section",{className:"py-20 sm:py-28",children:r.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[r.jsxs("div",{className:"text-center mb-14",children:[r.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Everything you need to run your bookings"}),r.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Built specifically for beauty professionals, salons, and service businesses. Simple, powerful, and free."})]}),r.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 stagger-children",children:[{icon:r.jsx(Vt,{className:"w-6 h-6"}),title:"Smart Scheduling",desc:"Set weekly hours with breaks. Slots auto-generate so your calendar is always up to date.",color:"bg-blue-100 text-blue-600"},{icon:r.jsx(Xt,{className:"w-6 h-6"}),title:"Multi-Staff Support",desc:"Add your whole team. Each member gets their own schedule, hours, and bookings.",color:"bg-violet-100 text-violet-600"},{icon:r.jsx(cD,{className:"w-6 h-6"}),title:"Instant Booking",desc:"Clients pick a service, choose a stylist, and book  all in under a minute.",color:"bg-amber-100 text-amber-600"},{icon:r.jsx(g3,{className:"w-6 h-6"}),title:"Your Own Booking Page",desc:"Get a unique link to share anywhere. No app downloads needed for your clients.",color:"bg-emerald-100 text-emerald-600"}].map(s=>r.jsxs("div",{className:"group bg-white rounded-2xl p-7 border border-slate-200/80 hover:border-slate-300 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[r.jsx("div",{className:`w-12 h-12 ${s.color} rounded-xl flex items-center justify-center mb-5 group-hover:scale-110 transition-transform duration-300`,children:s.icon}),r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:s.title}),r.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:s.desc})]},s.title))})]})}),r.jsx("section",{id:"how-it-works",className:"py-20 sm:py-28 bg-slate-50 border-y border-slate-100",children:r.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[r.jsxs("div",{className:"text-center mb-14",children:[r.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Up and running in minutes"}),r.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Three simple steps to start accepting online bookings today."})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-8 lg:gap-12 relative",children:[r.jsx("div",{className:"hidden md:block absolute top-14 left-[calc(16.67%+1rem)] right-[calc(16.67%+1rem)] h-px bg-gradient-to-r from-blue-200 via-violet-200 to-emerald-200"}),[{step:"1",title:"Create your account",desc:"Sign up free in 30 seconds. Name your shop and you're in.",color:"from-blue-500 to-blue-600",shadow:"shadow-blue-500/30"},{step:"2",title:"Set up your shop",desc:"Add your services, team, and weekly hours. BookFlow handles the rest.",color:"from-violet-500 to-violet-600",shadow:"shadow-violet-500/30"},{step:"3",title:"Share your link",desc:"Send your booking page to clients. They book, you get notified.",color:"from-emerald-500 to-emerald-600",shadow:"shadow-emerald-500/30"}].map(s=>r.jsxs("div",{className:"relative text-center",children:[r.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${s.color} rounded-2xl flex items-center justify-center mx-auto mb-6 text-white text-xl font-extrabold shadow-lg ${s.shadow} relative z-10`,children:s.step}),r.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:s.title}),r.jsx("p",{className:"text-slate-600 leading-relaxed max-w-xs mx-auto",children:s.desc})]},s.step))]})]})}),r.jsx("section",{className:"py-20 sm:py-28",children:r.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8",children:[r.jsxs("div",{className:"text-center mb-14",children:[r.jsx("h2",{className:"text-3xl sm:text-4xl font-extrabold text-slate-900 mb-4",children:"Loved by professionals"}),r.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"See why salons and stylists are switching to BookFlow."})]}),r.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{quote:"BookFlow replaced our paper appointment book. Clients love being able to book online anytime.",name:"Maria Santos",role:"Salon Owner",initials:"MS",color:"bg-blue-100 text-blue-700"},{quote:"Setting up was incredibly easy. I had my booking page live and shared with clients in under 10 minutes.",name:"David Chen",role:"Barber",initials:"DC",color:"bg-violet-100 text-violet-700"},{quote:"The multi-staff feature is perfect. Each stylist manages their own schedule and clients can pick who they want.",name:"Lisa Park",role:"Studio Manager",initials:"LP",color:"bg-emerald-100 text-emerald-700"}].map(s=>r.jsxs("div",{className:"bg-white rounded-2xl p-7 border border-slate-200/80 hover:shadow-lg hover:shadow-slate-200/40 transition-all duration-300",children:[r.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(5)].map((e,n)=>r.jsx(Jw,{className:"w-4 h-4 text-amber-400 fill-amber-400"},n))}),r.jsxs("p",{className:"text-slate-700 leading-relaxed mb-6",children:['"',s.quote,'"']}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-10 h-10 ${s.color} rounded-full flex items-center justify-center text-sm font-bold`,children:s.initials}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s.name}),r.jsx("div",{className:"text-xs text-slate-500",children:s.role})]})]})]},s.name))})]})}),r.jsxs("section",{className:"py-20 sm:py-28 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 relative overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 -z-0",children:[r.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),r.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-violet-500/10 rounded-full blur-3xl"})]}),r.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto px-5 sm:px-8 text-center",children:[r.jsx("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-extrabold text-white mb-6 leading-tight",children:"Ready to streamline your bookings?"}),r.jsx("p",{className:"text-lg text-slate-400 mb-10 max-w-xl mx-auto",children:"Join hundreds of professionals who have ditched the old appointment book. Set up in minutes, free forever."}),r.jsxs(et,{to:"/register",className:"inline-flex items-center gap-2 px-8 py-4 bg-white hover:bg-slate-50 text-slate-900 rounded-xl font-bold text-lg transition-all hover:shadow-xl hover:shadow-white/10 hover:-translate-y-0.5",children:["Create Your Free Account",r.jsx(Gc,{className:"w-5 h-5"})]})]})]}),r.jsx("footer",{className:"bg-white border-t border-slate-100",children:r.jsx("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 py-10",children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[r.jsx(e_,{}),r.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500",children:[r.jsx(et,{to:"/register",className:"hover:text-slate-900 transition-colors",children:"Sign Up"}),r.jsx("span",{className:"text-slate-200",children:""}),r.jsx(et,{to:"/login",className:"hover:text-slate-900 transition-colors",children:"Sign In"}),r.jsx("span",{className:"text-slate-200",children:""}),r.jsx("a",{href:"#how-it-works",className:"hover:text-slate-900 transition-colors",children:"How It Works"})]}),r.jsxs("p",{className:"text-xs text-slate-400",children:[" ",new Date().getFullYear()," BookFlow. All rights reserved."]})]})})})]})}function dD(s){return s.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function hD(){const s=_o(),[e,n]=N.useState(""),[i,o]=N.useState(""),[u,d]=N.useState(""),[p,g]=N.useState(""),[x,y]=N.useState(!1),_=dD(e),S=async C=>{if(C.preventDefault(),g(""),!_){g("Please enter a valid shop name");return}if(u.length<6){g("Password must be at least 6 characters");return}y(!0);try{const H=ys(Je(Ne,"shops"),ss("slug","==",_));if(!(await vs(H)).empty){g("A shop with that name already exists. Please choose a different name."),y(!1);return}const q=(await C5(il,i,u)).user;await fi(Je(Ne,"shops"),{name:e.trim(),slug:_,ownerUid:q.uid,ownerEmail:i,createdAt:y0()}),s(`/shop/${_}/dashboard`)}catch(H){switch(H.code){case"auth/email-already-in-use":g("An account with this email already exists");break;case"auth/invalid-email":g("Please enter a valid email address");break;case"auth/weak-password":g("Password must be at least 6 characters");break;default:g("Registration failed. Please try again.")}}finally{y(!1)}};return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[r.jsx("div",{className:"text-center mb-8",children:r.jsxs(et,{to:"/",className:"inline-flex items-center gap-2.5",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:r.jsx(Da,{className:"w-5 h-5 text-white"})}),r.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Book",r.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}),r.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Create your shop"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Set up your booking page in seconds  it's free"})]}),r.jsxs("form",{onSubmit:S,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Shop Name"}),r.jsx("input",{type:"text",value:e,onChange:C=>{n(C.target.value),g("")},placeholder:"Jane's Salon",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),_&&r.jsxs("p",{className:"mt-1.5 text-xs text-slate-400",children:["Your page: ",r.jsxs("span",{className:"font-mono text-blue-600 font-medium",children:["bookflow.app/shop/",_]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),r.jsx("input",{type:"email",value:i,onChange:C=>{o(C.target.value),g("")},placeholder:"you@example.com",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),r.jsx("input",{type:"password",value:u,onChange:C=>{d(C.target.value),g("")},placeholder:"At least 6 characters",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${p?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),p&&r.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[r.jsx("span",{children:""})," ",p]})]}),r.jsx("button",{type:"submit",disabled:x,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:x?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Creating your shop"]}):r.jsxs(r.Fragment,{children:["Create Shop",r.jsx(Gc,{className:"w-4 h-4"})]})})]}),r.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:r.jsxs("p",{className:"text-sm text-slate-500",children:["Already have an account?"," ",r.jsx(et,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Sign in"})]})})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs(et,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[r.jsx(Ra,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function fD({user:s}){const e=_o(),[n,i]=N.useState(""),[o,u]=N.useState(""),[d,p]=N.useState(""),[g,x]=N.useState(!1);N.useState(()=>{if(!s)return;(async()=>{const S=ys(Je(Ne,"shops"),ss("ownerUid","==",s.uid)),C=await vs(S);if(!C.empty){const H=C.docs[0].data();e(`/shop/${H.slug}/dashboard`,{replace:!0})}})()},[s,e]);const y=async _=>{_.preventDefault(),p(""),x(!0);try{const C=(await f1(il,n,o)).user,H=ys(Je(Ne,"shops"),ss("ownerUid","==",C.uid)),B=await vs(H);if(B.empty){p("No shop found for this account. Need to create one?"),await il.signOut(),x(!1);return}const P=B.docs[0].data();e(`/shop/${P.slug}/dashboard`,{replace:!0})}catch(S){switch(S.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":p("Invalid email or password");break;case"auth/invalid-email":p("Please enter a valid email address");break;case"auth/too-many-requests":p("Too many failed attempts. Please try again later.");break;default:p("Login failed. Please try again.")}u("")}finally{x(!1)}};return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[r.jsx("div",{className:"text-center mb-8",children:r.jsxs(et,{to:"/",className:"inline-flex items-center gap-2.5",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:r.jsx(Da,{className:"w-5 h-5 text-white"})}),r.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Book",r.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}),r.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),r.jsxs("form",{onSubmit:y,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),r.jsx("input",{type:"email",value:n,onChange:_=>{i(_.target.value),p("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),r.jsx("input",{type:"password",value:o,onChange:_=>{u(_.target.value),p("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${d?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),d&&r.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[r.jsx("span",{children:""})," ",d]})]}),r.jsx("button",{type:"submit",disabled:g,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:g?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):r.jsxs(r.Fragment,{children:["Sign In",r.jsx(Gc,{className:"w-4 h-4"})]})})]}),r.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:r.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",r.jsx(et,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs(et,{to:"/",className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[r.jsx(Ra,{className:"w-3.5 h-3.5"}),"Back to home"]})})]})})}function T2({availableDates:s,selectedDate:e,onSelectDate:n}){const[i,o]=N.useState(new Date),u=q=>{const Y=q.getFullYear(),W=q.getMonth(),xe=new Date(Y,W,1),re=new Date(Y,W+1,0).getDate(),j=xe.getDay();return{daysInMonth:re,startingDayOfWeek:j,year:Y,month:W}},{daysInMonth:d,startingDayOfWeek:p,year:g,month:x}=u(i),y=()=>{o(new Date(i.getFullYear(),i.getMonth()-1))},_=()=>{o(new Date(i.getFullYear(),i.getMonth()+1))},S=q=>{const Y=`${g}-${String(x+1).padStart(2,"0")}-${String(q).padStart(2,"0")}`;return s.includes(Y)},C=q=>`${g}-${String(x+1).padStart(2,"0")}-${String(q).padStart(2,"0")}`===e,H=q=>{if(S(q)){const Y=`${g}-${String(x+1).padStart(2,"0")}-${String(q).padStart(2,"0")}`;n(Y)}},B=["January","February","March","April","May","June","July","August","September","October","November","December"],P=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return r.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-5 sm:p-6 shadow-sm",children:[r.jsxs("div",{className:"flex justify-between items-center mb-5",children:[r.jsx("button",{onClick:y,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(y2,{className:"w-5 h-5 text-slate-600"})}),r.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[B[x]," ",g]}),r.jsx("button",{onClick:_,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(df,{className:"w-5 h-5 text-slate-600"})})]}),r.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:P.map(q=>r.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:q},q))}),r.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:p}).map((q,Y)=>r.jsx("div",{},`empty-${Y}`)),Array.from({length:d}).map((q,Y)=>{const W=Y+1,xe=S(W),me=C(W),re=new Date,j=re.getDate()===W&&re.getMonth()===x&&re.getFullYear()===g;return r.jsxs("button",{onClick:()=>H(W),disabled:!xe,className:`
                relative p-2.5 sm:p-3 text-center rounded-lg text-sm font-semibold transition-all duration-200
                ${me?"bg-blue-600 text-white shadow-md shadow-blue-600/30":xe?"bg-emerald-50 text-emerald-700 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-300 cursor-pointer":j?"text-slate-900 font-bold":"text-slate-300 cursor-not-allowed"}
              `,children:[W,j&&!me&&r.jsx("span",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]},W)})]}),r.jsxs("div",{className:"mt-4 flex gap-5 text-xs text-slate-500",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3 h-3 bg-emerald-50 border border-emerald-200 rounded"}),r.jsx("span",{children:"Available"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded"}),r.jsx("span",{children:"Selected"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-1 h-1 bg-blue-500 rounded-full"}),r.jsx("span",{children:"Today"})]})]})]})}const mD=[{key:"monday",label:"Mon"},{key:"tuesday",label:"Tue"},{key:"wednesday",label:"Wed"},{key:"thursday",label:"Thu"},{key:"friday",label:"Fri"},{key:"saturday",label:"Sat"},{key:"sunday",label:"Sun"}],t_=[{key:"morning",label:"Morning (9AM12PM)",start:"09:00",end:"12:00"},{key:"afternoon",label:"Afternoon (12PM5PM)",start:"12:00",end:"17:00"},{key:"evening",label:"Evening (5PM9PM)",start:"17:00",end:"21:00"},{key:"any",label:"Any time",start:"00:00",end:"23:59"}];function pD(){const s="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="WL";for(let n=0;n<4;n++)e+=s.charAt(Math.floor(Math.random()*s.length));return e}function n_({shopId:s,slug:e,selectedService:n,selectedStaff:i,staffMembers:o,preferredDate:u,onSuccess:d,onCancel:p}){const[g,x]=N.useState({name:"",email:"",phone:""}),[y,_]=N.useState([]),[S,C]=N.useState("any"),[H,B]=N.useState(!1),[P,q]=N.useState(!1),[Y,W]=N.useState(""),xe=re=>{_(j=>j.includes(re)?j.filter(T=>T!==re):[...j,re])},me=async re=>{re.preventDefault(),B(!0);try{const j=pD(),T=t_.find(z=>z.key===S),k=i&&i!=="any"?i.id:"any",L=i&&i!=="any"?i.name:"Any Available",M={clientName:g.name,clientEmail:g.email,clientPhone:g.phone,serviceId:n?.id||null,serviceName:n?.name||"Any Service",staffId:k,staffName:L,preferredDate:u||null,preferredDays:y.length>0?y:null,preferredTimeRange:T?{start:T.start,end:T.end}:null,status:"waiting",refCode:j,createdAt:new Date().toISOString(),notifiedAt:null,notifiedSlot:null};await fi(Je(Ne,"shops",s,"waitlist"),M),W(j),q(!0),d&&d(j)}catch(j){console.error("Waitlist error:",j)}finally{B(!1)}};return P?r.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg shadow-blue-100/50 p-8 text-center animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(bs,{className:"w-8 h-8 text-blue-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"You're on the Waitlist!"}),r.jsxs("p",{className:"text-slate-600 mb-4",children:["We'll notify you when a slot opens up",n?` for ${n.name}`:"","."]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your waitlist reference"}),r.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:Y})]}),r.jsxs("a",{href:`#/shop/${e}/waitlist/${Y}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[r.jsx(jn,{className:"w-4 h-4"}),"Check Waitlist Status"]}),r.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to check your position and get notified"})]}):r.jsxs("div",{className:"bg-white rounded-2xl border border-blue-200 shadow-lg p-6 animate-fade-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:r.jsx(Mh,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Join the Waitlist"}),r.jsx("p",{className:"text-sm text-slate-500",children:"We'll notify you when a slot opens up"})]})]}),r.jsxs("form",{onSubmit:me,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),r.jsx("input",{type:"text",value:g.name,onChange:re=>x({...g,name:re.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),r.jsx("input",{type:"email",value:g.email,onChange:re=>x({...g,email:re.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),r.jsx("input",{type:"tel",value:g.phone,onChange:re=>x({...g,phone:re.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["Preferred Days ",r.jsx("span",{className:"text-slate-400 font-normal",children:"(optional)"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:mD.map(re=>r.jsx("button",{type:"button",onClick:()=>xe(re.key),className:`px-3.5 py-2 rounded-lg text-sm font-semibold transition-all border ${y.includes(re.key)?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:re.label},re.key))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Preferred Time"}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:t_.map(re=>r.jsx("button",{type:"button",onClick:()=>C(re.key),className:`px-3.5 py-2.5 rounded-lg text-sm font-medium transition-all border text-left ${S===re.key?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:re.label},re.key))})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"submit",disabled:H,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:H?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Joining"]}):r.jsxs(r.Fragment,{children:[r.jsx(Mh,{className:"w-4 h-4"}),"Join Waitlist"]})}),p&&r.jsx("button",{type:"button",onClick:p,className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]})}function gD(){return r.jsxs("div",{className:"flex items-end gap-2 mb-3",children:[r.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:r.jsx(Oh,{className:"w-3.5 h-3.5 text-white"})}),r.jsx("div",{className:"bg-slate-100 rounded-2xl rounded-bl-md px-4 py-3",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),r.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),r.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})}function xD({message:s,onSelectService:e,onQuickReply:n}){const i=s.sender==="bot";return r.jsxs("div",{className:`flex items-end gap-2 mb-3 ${i?"":"flex-row-reverse"}`,children:[i&&r.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:r.jsx(Oh,{className:"w-3.5 h-3.5 text-white"})}),r.jsxs("div",{className:"max-w-[85%] space-y-2",children:[r.jsx("div",{className:`px-4 py-2.5 text-sm leading-relaxed whitespace-pre-line ${i?"bg-slate-100 text-slate-800 rounded-2xl rounded-bl-md":"bg-blue-600 text-white rounded-2xl rounded-br-md"}`,children:s.text}),s.serviceCards&&s.serviceCards.length>0&&r.jsx("div",{className:"space-y-1.5",children:s.serviceCards.map(o=>r.jsxs("button",{onClick:()=>e(o),className:"w-full flex items-center justify-between gap-2 px-3.5 py-2.5 bg-white border border-slate-200 hover:border-blue-400 rounded-xl text-left transition-all hover:shadow-sm group",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-semibold text-slate-800 group-hover:text-blue-700 truncate",children:o.name}),r.jsxs("p",{className:"text-xs text-slate-500",children:[hh(o.duration),"  ",xg(o.price)]})]}),r.jsxs("span",{className:"text-xs font-semibold text-blue-600 whitespace-nowrap flex items-center gap-0.5",children:["Book ",r.jsx(df,{className:"w-3 h-3"})]})]},o.id))}),s.quickReplies&&s.quickReplies.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1.5 pt-1",children:s.quickReplies.map((o,u)=>r.jsx("button",{onClick:()=>n(o),className:"px-3 py-1.5 text-xs font-medium text-blue-600 bg-white border border-blue-200 hover:bg-blue-50 hover:border-blue-400 rounded-full transition-all",children:o},u))})]})]})}function xg(s){return s==null?"":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(s)}function hh(s){if(!s)return"";if(s<60)return`${s} min`;const e=Math.floor(s/60),n=s%60;return n?`${e}h ${n}m`:`${e} hour${e>1?"s":""}`}function bD(s,{services:e,staffMembers:n,shop:i}){const o=s.toLowerCase().trim(),u=i?.name||"our shop";if(/^(hi|hello|hey|howdy|sup|yo|hiya|good\s*(morning|afternoon|evening))/.test(o))return{text:`Hi!  I'm here to help you book an appointment at ${u}. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]};if(/how (do i|to|can i) book|help.*(book|appoint)|booking help/i.test(o))return{text:`Booking is easy! Here's how:

1 Choose a service
2 Pick your stylist
3 Select a date & time
4 Fill in your details

That's it! Would you like to start?`,quickReplies:["View Services","View Staff"]};if(/what (services|do you offer)|menu|prices|how much|service list|your services/i.test(o)||o==="view services")return!e||e.length===0?{text:"We don't have any services listed right now. Please check back later!"}:{text:`Here are our services:

${e.map(p=>` ${p.name}  ${hh(p.duration)}  ${xg(p.price)}`).join(`
`)}

Would you like to book one of these? Just tap below! `,serviceCards:e};if(e&&e.length>0){const d=e.find(p=>{const g=p.name.toLowerCase();return o.includes(g)||g.includes(o)});if(d&&o.length>2)return{text:`Great choice! Here are the details for **${d.name}**:

 Duration: ${hh(d.duration)}
 Price: ${xg(d.price)}${d.description?`
 ${d.description}`:""}

Would you like to book this service? Tap "Book" below!`,serviceCards:[d],quickReplies:["View All Services","View Staff"]}}if(/how long|how much time|duration/i.test(o))return!e||e.length===0?{text:"No services are listed right now. Check back soon!"}:{text:`Here's how long each service takes:

${e.map(p=>` ${p.name}: ${hh(p.duration)}`).join(`
`)}`,quickReplies:["View Services","How to Book"]};if(/who works|stylists?|staff|team|barber|who('s| is) (here|available)|your (team|people)/i.test(o)||o==="view staff")return!n||n.length===0?{text:"We don't have any team members listed right now."}:{text:`Meet our team! 

${n.map(p=>{let g=` ${p.name}`;return p.role&&(g+=`  ${p.role}`),p.bio&&(g+=`
  "${p.bio.slice(0,80)}${p.bio.length>80?"":""}"`),g}).join(`
`)}

You can pick your preferred stylist during booking.`,quickReplies:["View Services","How to Book"]};if(/available|open slot|when can i|next available|free slot|any opening/i.test(o)){const d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],p=new Set;return n&&n.length>0&&n.forEach(x=>{x.weeklyHours&&Object.entries(x.weeklyHours).forEach(([y,_])=>{_&&_.enabled&&p.add(y)})}),{text:`You can check available times by selecting a service and date in the booking flow above. We're generally available on ${p.size>0?[...p].sort((x,y)=>d.indexOf(x)-d.indexOf(y)).join(", "):"most days"}. `,quickReplies:["View Services","How to Book"]}}if(/hours|when are you open|business hours|open hours|what time|operating/i.test(o)){const d=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],p={};if(n&&n.length>0&&n.forEach(g=>{g.weeklyHours&&Object.entries(g.weeklyHours).forEach(([x,y])=>{y&&y.enabled&&y.start&&y.end&&(p[x]?(y.start<p[x].start&&(p[x].start=y.start),y.end>p[x].end&&(p[x].end=y.end)):p[x]={start:y.start,end:y.end})})}),Object.keys(p).length>0){const g=y=>{const[_,S]=y.split(":"),C=parseInt(_),H=C>=12?"PM":"AM";return`${C%12||12}:${S} ${H}`};return{text:`Here are our general hours:

${d.filter(y=>p[y]).map(y=>` ${y}: ${g(p[y].start)}  ${g(p[y].end)}`).join(`
`)}

Hours may vary by stylist. Select a service to see exact availability.`,quickReplies:["View Services","View Staff"]}}return{text:"Our hours vary by stylist. You can see exact availability by selecting a service above.",quickReplies:["View Services","How to Book"]}}return/phone|address|contact|where|location|email|reach/i.test(o)?{text:"For contact information, please reach out to the shop directly. You can also find us through the booking confirmation email after you book! ",quickReplies:["View Services","How to Book"]}:/cancel|reschedule|change my (booking|appointment)|modify/i.test(o)?{text:"You can manage your booking using the reference code you received. Go to your confirmation email and click 'Manage Booking' to reschedule or cancel. ",quickReplies:["How to Book","View Services"]}:/waitlist|no availability|fully booked|no slots|all booked|sold out/i.test(o)?{text:"If there are no available slots, you can join our waitlist and we'll notify you when something opens up! Look for the 'Join Waitlist' button when viewing available times. ",quickReplies:["View Services","How to Book"]}:/^(thanks?|thank you|thx|ty|cheers|appreciate)/i.test(o)?{text:"You're welcome!  Let me know if you need anything else.",quickReplies:["View Services","View Staff","How to Book"]}:{text:"I'm not sure about that. You can browse our services above, or try asking about our services, staff, or availability! ",quickReplies:["View Services","View Staff","How to Book"]}}function yD({services:s,staffMembers:e,shop:n,onSelectService:i}){const[o,u]=N.useState(!1),[d,p]=N.useState([]),[g,x]=N.useState(""),[y,_]=N.useState(!1),[S,C]=N.useState(!1),[H,B]=N.useState(!1),[P,q]=N.useState(!1),Y=N.useRef(null),W=N.useRef(null),xe=n?.name||"our shop";N.useEffect(()=>{Y.current?.scrollIntoView({behavior:"smooth"})},[d,y]),N.useEffect(()=>{const M=setTimeout(()=>{!o&&!P&&B(!0)},3e3),z=setTimeout(()=>{S||(C(!0),B(!1),u(!0),p([{id:"welcome",sender:"bot",text:`Hi!  Welcome to ${xe}. I can help you find the right service and book an appointment. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]}]))},5e3);return()=>{clearTimeout(M),clearTimeout(z)}},[]),N.useEffect(()=>{o&&setTimeout(()=>W.current?.focus(),100)},[o]);const me=N.useCallback(()=>{B(!1),q(!0),u(!0),d.length===0&&p([{id:"welcome",sender:"bot",text:`Hi!  Welcome to ${xe}. I can help you find the right service and book an appointment. What are you looking for?`,quickReplies:["View Services","View Staff","How to Book"]}])},[d.length,xe]),re=N.useCallback(M=>{_(!0);const z=400+Math.random()*600;setTimeout(()=>{const D=bD(M,{services:s,staffMembers:e,shop:n});p(F=>[...F,{id:`bot-${Date.now()}`,sender:"bot",text:D.text,serviceCards:D.serviceCards||null,quickReplies:D.quickReplies||null}]),_(!1)},z)},[s,e,n]),j=N.useCallback(()=>{const M=g.trim();M&&(p(z=>[...z,{id:`user-${Date.now()}`,sender:"user",text:M}]),x(""),re(M))},[g,re]),T=N.useCallback(M=>{p(z=>[...z,{id:`user-${Date.now()}`,sender:"user",text:M}]),re(M)},[re]),k=N.useCallback(M=>{i&&(i(M),p(z=>[...z,{id:`bot-${Date.now()}`,sender:"bot",text:`Great! I've selected "${M.name}" for you. You can now pick your stylist and time above. `}]),setTimeout(()=>u(!1),1500))},[i]),L=M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),j())};return r.jsxs(r.Fragment,{children:[H&&!o&&r.jsxs("div",{className:"fixed bottom-24 right-5 z-50 animate-fade-in",children:[r.jsx("button",{onClick:me,className:"bg-white border border-slate-200 shadow-lg rounded-2xl rounded-br-md px-4 py-3 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all max-w-[220px]",children:"Need help booking? "}),r.jsx("button",{onClick:()=>{B(!1),q(!0)},className:"absolute -top-2 -right-2 w-5 h-5 bg-slate-200 hover:bg-slate-300 rounded-full flex items-center justify-center text-slate-500 transition-colors",children:r.jsx(ka,{className:"w-3 h-3"})})]}),o&&r.jsxs("div",{className:`fixed bottom-20 right-5 z-50 bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden animate-scale-in
                     w-[calc(100vw-2.5rem)] max-w-[380px] h-[min(500px,calc(100vh-7rem))]
                     sm:w-[380px] sm:right-5 sm:bottom-20`,style:{transformOrigin:"bottom right"},children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:r.jsx(Oh,{className:"w-4 h-4"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold leading-tight",children:"BookFlow Assistant"}),r.jsx("p",{className:"text-[11px] text-blue-100",children:"Ask me anything about booking"})]})]}),r.jsx("button",{onClick:()=>u(!1),className:"w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors","aria-label":"Close chat",children:r.jsx(ka,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-0 bg-slate-50/50",children:[d.map(M=>r.jsx(xD,{message:M,onSelectService:k,onQuickReply:T},M.id)),y&&r.jsx(gD,{}),r.jsx("div",{ref:Y})]}),r.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 border-t border-slate-200 bg-white flex-shrink-0",children:[r.jsx("input",{ref:W,type:"text",value:g,onChange:M=>x(M.target.value),onKeyDown:L,placeholder:"Type a message",className:"flex-1 px-3.5 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder:text-slate-400"}),r.jsx("button",{onClick:j,disabled:!g.trim(),className:"w-10 h-10 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-200 disabled:cursor-not-allowed text-white disabled:text-slate-400 rounded-xl flex items-center justify-center transition-all flex-shrink-0","aria-label":"Send message",children:r.jsx(dh,{className:"w-4 h-4"})})]})]}),r.jsx("button",{onClick:()=>{o?u(!1):me()},className:`fixed bottom-5 right-5 z-50 w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 hover:scale-105 hover:shadow-xl ${o?"bg-slate-700 hover:bg-slate-800":"bg-blue-600 hover:bg-blue-700 chat-bubble-pulse"}`,"aria-label":o?"Close chat assistant":"Open chat assistant",children:o?r.jsx(ka,{className:"w-6 h-6 text-white"}):r.jsx(Oh,{className:"w-6 h-6 text-white"})})]})}const vD=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function ro(s){const[e,n]=s.split(":").map(Number);return e*60+n}function s_(s){const e=Math.floor(s/60),n=s%60;return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function wD(s){const e=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),i=String(s.getDate()).padStart(2,"0");return`${e}-${n}-${i}`}function _D(s,e,n,i,o,u){if(!s)return[];const p=new Date(e+"T12:00:00").getDay(),g=vD[p],x=s[g];if(!x||!x.enabled)return[];const y=ro(x.start),_=ro(x.end),S=x.break?ro(x.break.start):null,C=x.break?ro(x.break.end):null,H=n+i,B=[];let P=y;for(;P+n<=_;){const q=P+n;if(S!==null&&C!==null&&P<C&&q>S){P=C;continue}B.push({id:`wh-${o}-${e}-${s_(P)}`,date:e,time:s_(P),duration:n,available:!0,staffId:o,staffName:u,generated:!0}),P+=H}return B}function j2(s,e,n=0,i=4){const o=[],u=new Date;u.setHours(0,0,0,0);const d=new Date(u);d.setDate(d.getDate()+i*7);for(const p of s){if(!p.weeklyHours)continue;const g=new Date(u);for(;g<d;){const x=wD(g),y=_D(p.weeklyHours,x,e,n,p.id,p.name);o.push(...y),g.setDate(g.getDate()+1)}}return o}function A2(s,e,n=0){const i=e.filter(o=>!o.status||o.status==="pending"||o.status==="confirmed");return s.filter(o=>{const u=ro(o.time),d=u+o.duration;return!i.some(g=>{if(o.staffId&&g.staffId&&g.staffId!==o.staffId||g.date!==o.date)return!1;const x=ro(g.time),y=g.serviceDuration||g.duration||o.duration,_=x+y;return!(d+n<=x||_+n<=u)})})}function C2(s,e){const n=new Set(e.map(o=>`${o.staffId||""}-${o.date}-${o.time}`)),i=s.filter(o=>{const u=`${o.staffId||""}-${o.date}-${o.time}`;return!n.has(u)});return[...e,...i]}function Lc({name:s,className:e="w-12 h-12",bgClass:n="bg-blue-100 text-blue-700"}){const i=(s||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return r.jsx("div",{className:`${e} ${n} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function ND(){return r.jsxs(et,{to:"/",className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:r.jsx(Da,{className:"w-3.5 h-3.5 text-white"})}),r.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Book",r.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}function ED({member:s,onClose:e}){const[n,i]=N.useState(null),o=s.portfolio||[];return N.useEffect(()=>{const u=d=>{d.key==="Escape"&&(n!==null?i(null):e())};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[n,e]),r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),r.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in",children:[r.jsx("button",{onClick:e,className:"absolute top-4 right-4 w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center text-slate-600 transition-all z-10",children:r.jsx(X,{className:"w-4 h-4"})}),r.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Lc,{name:s.name,className:"w-14 h-14",bgClass:"bg-violet-100 text-violet-700"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-slate-900",children:s.name}),s.role&&r.jsx("p",{className:"text-sm text-violet-600 font-medium",children:s.role})]})]}),s.bio&&r.jsx("p",{className:"mt-3 text-sm text-slate-600 leading-relaxed",children:s.bio})]}),r.jsx("div",{className:"p-6",children:o.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Image,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet"})]}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:o.map((u,d)=>r.jsxs("button",{onClick:()=>i(d),className:"group relative aspect-square rounded-xl overflow-hidden bg-slate-100 shadow-sm hover:shadow-md transition-all hover:-translate-y-0.5",children:[r.jsx("img",{src:u.url,alt:u.caption||"Portfolio",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),u.caption&&r.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/70 to-transparent p-2.5 pt-6",children:r.jsx("p",{className:"text-xs text-white font-medium truncate",children:u.caption})})]},d))})})]}),n!==null&&o[n]&&r.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/90",children:[r.jsx("button",{onClick:()=>i(null),className:"absolute top-4 right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:r.jsx(X,{className:"w-5 h-5"})}),n>0&&r.jsx("button",{onClick:()=>i(n-1),className:"absolute left-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:r.jsx(ChevronLeft,{className:"w-5 h-5"})}),n<o.length-1&&r.jsx("button",{onClick:()=>i(n+1),className:"absolute right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white transition-all",children:r.jsx(ChevronRight,{className:"w-5 h-5"})}),r.jsxs("div",{className:"max-w-4xl max-h-[85vh] flex flex-col items-center",children:[r.jsx("img",{src:o[n].url,alt:o[n].caption||"Portfolio",className:"max-w-full max-h-[75vh] object-contain rounded-lg"}),o[n].caption&&r.jsx("p",{className:"mt-3 text-sm text-white/90 font-medium text-center px-4",children:o[n].caption}),r.jsxs("p",{className:"mt-1 text-xs text-white/50",children:[n+1," / ",o.length]})]})]})]})}function SD(){const{slug:s}=No(),[e,n]=N.useState(null),[i,o]=N.useState(null),[u,d]=N.useState(!0),[p,g]=N.useState(!1),[x,y]=N.useState([]),[_,S]=N.useState([]),[C,H]=N.useState(null),[B,P]=N.useState(null),[q,Y]=N.useState([]),[W,xe]=N.useState([]),[me,re]=N.useState(!1),[j,T]=N.useState(null),[k,L]=N.useState(null),[M,z]=N.useState(""),[D,F]=N.useState(!1),[O,I]=N.useState({name:"",email:"",phone:""}),[K,fe]=N.useState(""),[Se,we]=N.useState(!1),[V,ne]=N.useState(null),[le,_e]=N.useState(!1),[ye,Ie]=N.useState("biweekly"),[ue,ze]=N.useState(null);N.useEffect(()=>{(async()=>{d(!0),g(!1);try{const G=ys(Je(Ne,"shops"),ss("slug","==",s)),de=await vs(G);if(de.empty)g(!0);else{const ce=de.docs[0];n(ce.data()),o(ce.id)}}catch(G){console.error("Error looking up shop:",G),g(!0)}finally{d(!1)}})()},[s]),N.useEffect(()=>{if(!i)return;const R=Wt(Je(Ne,"shops",i,"services"),Me=>{const Te=Me.docs.map(Ce=>({id:Ce.id,...Ce.data()})).filter(Ce=>Ce.active!==!1).sort((Ce,Re)=>(Ce.name||"").localeCompare(Re.name||""));y(Te)}),G=Wt(Je(Ne,"shops",i,"availability"),Me=>{const Te=new Date,Ce=Me.docs.map(Re=>({id:Re.id,...Re.data()})).filter(Re=>new Date(`${Re.date}T${Re.time}`)>Te);Y(Ce)}),de=Wt(Je(Ne,"shops",i,"bookings"),Me=>{const Te=Me.docs.map(Ce=>({id:Ce.id,...Ce.data()}));xe(Te)}),ce=Wt(Je(Ne,"shops",i,"staff"),Me=>{const Te=Me.docs.map(Ce=>({id:Ce.id,...Ce.data()})).filter(Ce=>Ce.active!==!1).sort((Ce,Re)=>(Ce.name||"").localeCompare(Re.name||""));S(Te)});return()=>{R(),G(),de(),ce()}},[i]),N.useEffect(()=>{_.length===1?P(_[0]):_.length===0&&P(null)},[_]);const Ue=x.length>0;_.length>0;const Ge=_.length>1,J=e?.bufferMinutes||0,ve=N.useMemo(()=>{const R=new Date;let G=q.filter(Te=>Te.available);if(C&&(G=G.filter(Te=>Te.duration>=C.duration)),B&&B!=="any"&&(G=G.filter(Te=>Te.staffId===B.id||!Te.staffId)),!C)return G;const de=B&&B!=="any"?_.filter(Te=>Te.id===B.id):_,ce=j2(de,C.duration,J,4).filter(Te=>new Date(`${Te.date}T${Te.time}`)>R),Me=C2(ce,G);return A2(Me,W,J)},[q,C,B,_,W,J]),Ve=(R,G,de=3)=>{const ce=[],Me=new Date(R+"T12:00:00"),Te=new Date(Me);Te.setMonth(Te.getMonth()+de);let Ce=new Date(Me);for(G==="weekly"?Ce.setDate(Ce.getDate()+7):G==="biweekly"?Ce.setDate(Ce.getDate()+14):G==="fourweekly"?Ce.setDate(Ce.getDate()+28):G==="monthly"&&Ce.setMonth(Ce.getMonth()+1);Ce<=Te;){const Re=Ce.getFullYear(),rt=String(Ce.getMonth()+1).padStart(2,"0"),ot=String(Ce.getDate()).padStart(2,"0");ce.push(`${Re}-${rt}-${ot}`),G==="weekly"?Ce.setDate(Ce.getDate()+7):G==="biweekly"?Ce.setDate(Ce.getDate()+14):G==="fourweekly"?Ce.setDate(Ce.getDate()+28):G==="monthly"&&Ce.setMonth(Ce.getMonth()+1)}return ce},Pe=N.useMemo(()=>{if(!le||!j)return null;const R=Ve(j.date,ye),G=C?C.duration:j.duration||60,de=B&&B!=="any"?B.id:j.staffId,ce=j.time,Me=W.filter(wn=>!wn.status||wn.status==="pending"||wn.status==="confirmed"),Te=wn=>{const[Hn,_n]=wn.split(":").map(Number);return Hn*60+_n},Ce=Te(ce),Re=Ce+G;let rt=[],ot=[];const $t=new Set;R.forEach(wn=>{Me.some(_n=>{if(de&&_n.staffId&&_n.staffId!==de||_n.date!==wn)return!1;const sa=Te(_n.time),Us=_n.serviceDuration||_n.duration||G,Va=sa+Us,mi=J||0;return!(Re+mi<=sa||Va+mi<=Ce)})||$t.has(wn)?ot.push(wn):(rt.push(wn),$t.add(wn))});const Gt=R.length>0?R[R.length-1]:j.date,Fn=new Date(Gt+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),na={weekly:"week",biweekly:"2 weeks",fourweekly:"4 weeks",monthly:"month"};return{available:rt,conflicts:ot,total:rt.length+1,skipped:ot.length,endDate:Fn,intervalLabel:na[ye]||ye}},[le,ye,j,C,B,W,J]),qe=R=>{H(R),_.length>1&&P(null),L(null),T(null),re(!1),z("")},gt=R=>{P(R),L(null),T(null),re(!1),z("")},qn=()=>{H(null),_.length>1&&P(null),L(null),T(null),re(!1)},xn=()=>{L(null),T(null),re(!1),Ge?P(null):Ue&&H(null)},vt=R=>{T(R),re(!0),z("")},je=()=>{const R="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let G="BK";for(let de=0;de<4;de++)G+=R.charAt(Math.floor(Math.random()*R.length));return G},Be=async R=>{R.preventDefault(),F(!0),ze(null);try{const G=je(),de=e?.requireApproval?"pending":"confirmed",ce=le?`rg-${Date.now()}-${Math.random().toString(36).slice(2,8)}`:null,Me=le&&Pe?Pe.endDate:null,Te={slotId:j.id,date:j.date,time:j.time,duration:C?C.duration:j.duration,clientName:O.name,clientEmail:O.email,clientPhone:O.phone,bookedAt:new Date().toISOString(),status:de,refCode:G};C&&(Te.serviceId=C.id,Te.serviceName=C.name,Te.servicePrice=C.price,Te.serviceDuration=C.duration),B&&B!=="any"?(Te.staffId=B.id,Te.staffName=B.name):j.staffId&&(Te.staffId=j.staffId,Te.staffName=j.staffName||""),le&&ce&&(Te.recurring=!0,Te.recurringInterval=ye,Te.recurringGroupId=ce,Te.recurringUntil=Me),await fi(Je(Ne,"shops",i,"bookings"),Te),j.generated||await st(Qe(Ne,"shops",i,"availability",j.id),{available:!1});let Ce=1,Re=0;if(le&&Pe){const rt=Pe.available;Re=Pe.skipped;for(const ot of rt){const $t=je(),Gt={...Te,date:ot,slotId:`recurring-${ce}-${ot}`,refCode:$t,bookedAt:new Date().toISOString()};await fi(Je(Ne,"shops",i,"bookings"),Gt),Ce++}ze({created:Ce,skipped:Re})}I({name:"",email:"",phone:""}),re(!1),T(null),H(null),L(null),P(_.length===1?_[0]:null),_e(!1),fe(G),e?.requireApproval?z(" Your booking request has been submitted! The shop will review and confirm it shortly."):z(" Booking confirmed! You will receive a confirmation email shortly.")}catch(G){console.error("Booking error:",G),z(" Something went wrong. Please try again.")}finally{F(!1)}},it=R=>new Date(R+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),Lt=R=>{const[G,de]=R.split(":"),ce=parseInt(G),Me=ce>=12?"PM":"AM";return`${ce%12||12}:${de} ${Me}`},xt=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(R),lt=R=>{if(R<60)return`${R} min`;const G=Math.floor(R/60),de=R%60;return de?`${G}h ${de}m`:`${G} hour${G>1?"s":""}`};if(u)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking page"})]})});if(p)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(Vt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),r.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,r.jsx("span",{className:"font-mono text-blue-600",children:s}),'".']}),r.jsxs(et,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Ra,{className:"w-4 h-4"}),"Go Home"]})]})});const rn=[...new Set(ve.map(R=>R.date))].sort(),wt=k?ve.filter(R=>R.date===k):ve,bn=me?"form":Ue&&!C?"services":Ge&&!B?"staff":"calendar",Vn=[];Ue&&Vn.push({key:"services",label:"Service"}),Ge&&Vn.push({key:"staff",label:"Stylist"}),Vn.push({key:"calendar",label:"Date & Time"}),Vn.push({key:"form",label:"Confirm"});const Ls=Vn.findIndex(R=>R.key===bn),Oa=["border-l-blue-500","border-l-violet-500","border-l-emerald-500","border-l-amber-500","border-l-rose-500","border-l-cyan-500","border-l-indigo-500","border-l-pink-500","border-l-teal-500"];return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Book your appointment"})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs(et,{to:`/shop/${s}/login`,className:"flex items-center gap-1.5 px-3.5 py-2 text-xs font-medium text-slate-500 hover:text-slate-700 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[r.jsx(v2,{className:"w-3.5 h-3.5"}),r.jsx("span",{className:"hidden sm:inline",children:"Owner"})]}),r.jsx(ND,{})]})]})}),r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[Vn.length>1&&r.jsx("div",{className:"flex items-center justify-center gap-0 mb-8 animate-fade-in",children:Vn.map((R,G)=>{const de=R.key===bn,ce=G<Ls;return r.jsxs(N.Fragment,{children:[G>0&&r.jsx("div",{className:`w-8 sm:w-14 h-0.5 transition-colors duration-300 ${G<=Ls?"bg-blue-500":"bg-slate-200"}`}),r.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[r.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 ${de?"bg-blue-600 text-white shadow-md shadow-blue-600/30 scale-110":ce?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:ce?r.jsx(bs,{className:"w-5 h-5"}):G+1}),r.jsx("span",{className:`text-xs font-medium hidden sm:block transition-colors ${de?"text-blue-700":ce?"text-blue-600":"text-slate-400"}`,children:R.label})]})]},R.key)})}),M&&r.jsx("div",{className:"mb-8 animate-scale-in",children:M.startsWith("")?r.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(w2,{className:"w-8 h-8 text-emerald-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Confirmed!"}),r.jsx("p",{className:"text-slate-600 mb-4",children:"You're all set. We'll send a confirmation to your email."}),ue&&r.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[r.jsx(ir,{className:"w-4 h-4"}),"Recurring Series Created"]}),r.jsxs("p",{className:"text-sm text-slate-700",children:[ue.created," appointment",ue.created!==1?"s":""," booked"]}),ue.skipped>0&&r.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",ue.skipped," date",ue.skipped!==1?"s":""," skipped due to conflicts"]})]}),K&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),r.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:K})]}),K&&r.jsxs("div",{className:"mb-4",children:[r.jsxs(et,{to:`/shop/${s}/booking/${K}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[r.jsx(kp,{className:"w-4 h-4"}),"Manage Your Booking"]}),r.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),r.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-lg text-sm text-emerald-700 font-medium",children:[r.jsx(kp,{className:"w-4 h-4"}),"Add to your calendar to remember"]})]}):M.startsWith("")?r.jsxs("div",{className:"bg-white rounded-2xl border border-amber-200 shadow-lg shadow-amber-100/50 p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(jn,{className:"w-8 h-8 text-amber-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Request Submitted!"}),r.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking request has been submitted! The shop will review and confirm it shortly."}),ue&&r.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 font-semibold text-sm mb-1",children:[r.jsx(ir,{className:"w-4 h-4"}),"Recurring Series Created"]}),r.jsxs("p",{className:"text-sm text-slate-700",children:[ue.created," appointment",ue.created!==1?"s":""," submitted"]}),ue.skipped>0&&r.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[" ",ue.skipped," date",ue.skipped!==1?"s":""," skipped due to conflicts"]})]}),K&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Your reference"}),r.jsx("p",{className:"text-2xl font-mono font-extrabold text-blue-600 tracking-wider",children:K})]}),K&&r.jsxs("div",{className:"mb-4",children:[r.jsxs(et,{to:`/shop/${s}/booking/${K}`,className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[r.jsx(kp,{className:"w-4 h-4"}),"Manage Your Booking"]}),r.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Save this link to reschedule or cancel your booking"})]}),r.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-700 font-medium",children:[r.jsx(jn,{className:"w-4 h-4"}),"You'll be notified once it's confirmed"]})]}):r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[r.jsx("span",{children:""}),r.jsx("span",{children:"Something went wrong. Please try again."})]})}),bn==="services"&&r.jsxs("div",{className:"animate-fade-in",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a Service"}),r.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select the service you'd like to book"})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 stagger-children",children:x.map((R,G)=>r.jsxs("button",{onClick:()=>qe(R),className:`group text-left bg-white border-l-4 ${Oa[G%Oa.length]} border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5`,children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors pr-2",children:R.name}),r.jsx("span",{className:"text-xl font-extrabold text-blue-600 whitespace-nowrap",children:xt(R.price)})]}),R.description&&r.jsx("p",{className:"text-sm text-slate-500 mb-3 line-clamp-2 leading-relaxed",children:R.description}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-400",children:[r.jsx(jn,{className:"w-3.5 h-3.5"}),r.jsx("span",{children:lt(R.duration)})]}),r.jsx("span",{className:"text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]})]},R.id))})]}),bn==="staff"&&r.jsxs("div",{className:"animate-fade-in",children:[Ue&&C&&r.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[r.jsxs("button",{onClick:qn,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[r.jsx(Ra,{className:"w-3.5 h-3.5"}),"Back"]}),r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[r.jsx(is,{className:"w-3.5 h-3.5 text-blue-500"}),r.jsx("span",{className:"font-semibold text-slate-800",children:C.name}),r.jsx("span",{className:"text-blue-600 font-bold",children:xt(C.price)})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose Your Stylist"}),r.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Select your preferred professional"})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 stagger-children",children:[r.jsxs("button",{onClick:()=>gt("any"),className:"group text-left bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[r.jsxs("div",{className:"flex items-center gap-3.5 mb-3",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(Xt,{className:"w-5 h-5 text-slate-500"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:"Any Available"}),r.jsx("p",{className:"text-xs text-slate-500",children:"First available professional"})]})]}),r.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),_.map(R=>{const G=R.portfolio||[];return r.jsxs("div",{className:"group bg-white border border-slate-200 hover:border-blue-300 rounded-xl p-5 transition-all duration-200 hover:shadow-lg hover:shadow-slate-200/50 hover:-translate-y-0.5",children:[r.jsxs("button",{onClick:()=>gt(R),className:"w-full text-left",children:[r.jsxs("div",{className:"flex items-center gap-3.5 mb-2",children:[r.jsx(Lc,{name:R.name}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("h3",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition-colors",children:R.name}),R.role&&r.jsx("p",{className:"text-xs text-slate-500",children:R.role})]})]}),R.bio&&r.jsx("p",{className:"text-xs text-slate-500 leading-relaxed mb-2 line-clamp-2",children:R.bio}),G.length>0&&r.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[G.slice(0,3).map((de,ce)=>r.jsx("img",{src:de.url,alt:de.caption||"Work",className:"w-10 h-10 rounded-md object-cover border border-slate-200"},ce)),G.length>3&&r.jsxs("span",{className:"w-10 h-10 rounded-md bg-slate-100 border border-slate-200 flex items-center justify-center text-xs text-slate-500 font-semibold",children:["+",G.length-3]})]}),r.jsx("span",{className:"block text-center text-xs font-semibold text-blue-600 group-hover:translate-x-0.5 transition-transform",children:"Select "})]}),G.length>0&&r.jsxs("button",{onClick:de=>{de.stopPropagation(),ne(R)},className:"mt-2 w-full flex items-center justify-center gap-1.5 py-1.5 text-xs font-semibold text-violet-600 hover:text-violet-700 hover:bg-violet-50 rounded-lg transition-all",children:[r.jsx(Image,{className:"w-3.5 h-3.5"}),"View Portfolio (",G.length,")"]})]},R.id)})]})]}),bn==="calendar"&&r.jsxs("div",{className:"animate-fade-in",children:[(Ue||Ge)&&r.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[r.jsxs("button",{onClick:xn,className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[r.jsx(Ra,{className:"w-3.5 h-3.5"}),"Back"]}),C&&r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[r.jsx(is,{className:"w-3.5 h-3.5 text-blue-500"}),r.jsx("span",{className:"font-semibold text-slate-800",children:C.name}),r.jsx("span",{className:"text-blue-600 font-bold",children:xt(C.price)}),r.jsxs("span",{className:"text-slate-400",children:[" ",lt(C.duration)]})]}),B&&B!=="any"&&r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[r.jsx(Lc,{name:B.name,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),r.jsx("span",{className:"font-semibold text-slate-800",children:B.name})]}),B==="any"&&r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm",children:[r.jsx(Xt,{className:"w-3.5 h-3.5 text-slate-500"}),r.jsx("span",{className:"font-semibold text-slate-700",children:"Any Available"})]})]}),rn.length===0?r.jsx("div",{children:Se?r.jsx("div",{className:"max-w-lg mx-auto",children:r.jsx(n_,{shopId:i,slug:s,selectedService:C,selectedStaff:B,staffMembers:_,preferredDate:null,onCancel:()=>we(!1)})}):r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:r.jsx(Vt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),r.jsx("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:C?`No time slots available for ${C.name} (${lt(C.duration)}). Join the waitlist to be notified when a slot opens up!`:"Check back soon for new availability, or join the waitlist!"}),r.jsxs("button",{onClick:()=>we(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 hover:-translate-y-0.5",children:[r.jsx(Mh,{className:"w-4 h-4"}),"Join Waitlist"]})]})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Select a Date"}),r.jsx("p",{className:"text-slate-500 text-sm",children:"Pick a day that works for you"})]}),r.jsx("div",{className:"mb-8",children:r.jsx(T2,{availableDates:rn,selectedDate:k,onSelectDate:L})}),k&&r.jsxs("div",{className:"animate-slide-down",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",it(k)]}),r.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[wt.length," slot",wt.length!==1?"s":""]})]}),wt.length===0?r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:[r.jsx("p",{className:"text-slate-500 mb-4",children:"No times available for this date"}),Se?r.jsx("div",{className:"mt-4 text-left",children:r.jsx(n_,{shopId:i,slug:s,selectedService:C,selectedStaff:B,staffMembers:_,preferredDate:k,onCancel:()=>we(!1)})}):r.jsxs("button",{onClick:()=>we(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[r.jsx(Mh,{className:"w-4 h-4"}),"Join the Waitlist"]})]}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:wt.sort((R,G)=>R.time.localeCompare(G.time)).map(R=>r.jsxs("button",{onClick:()=>vt(R),className:"group bg-white border border-slate-200 hover:border-blue-400 rounded-xl p-4 transition-all duration-200 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5 text-center",children:[r.jsx("div",{className:"text-lg font-bold text-slate-900 group-hover:text-blue-700 transition-colors mb-1",children:Lt(R.time)}),R.staffName&&B==="any"&&r.jsxs("div",{className:"text-xs text-violet-600 mb-0.5 flex items-center justify-center gap-1",children:[r.jsx(Xt,{className:"w-3 h-3"}),R.staffName]}),r.jsx("div",{className:"text-xs text-slate-400",children:C?lt(C.duration):`${R.duration} min`})]},R.id))})]}),!k&&r.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]}),bn==="form"&&r.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Complete Your Booking"}),r.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Review your details and confirm"}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[C&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(is,{className:"w-4 h-4 text-blue-600"})}),r.jsx("span",{className:"font-semibold text-slate-800",children:C.name})]}),r.jsx("span",{className:"font-bold text-blue-600",children:xt(C.price)})]}),B&&B!=="any"&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx(Lc,{name:B.name,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),r.jsxs("div",{children:[r.jsx("span",{className:"font-semibold text-slate-800",children:B.name}),B.role&&r.jsxs("span",{className:"text-slate-400 text-sm ml-1.5",children:[" ",B.role]})]})]}),B==="any"&&j?.staffName&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx(Lc,{name:j.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),r.jsx("span",{className:"font-semibold text-slate-800",children:j.staffName})]}),r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(Vt,{className:"w-4 h-4 text-slate-600"})}),r.jsxs("span",{className:"font-semibold text-slate-800",children:[it(j.date)," at ",Lt(j.time)]})]}),r.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(jn,{className:"w-4 h-4 text-slate-500"})}),r.jsx("span",{children:C?lt(C.duration):`${j.duration} min`})]})]}),r.jsxs("form",{onSubmit:Be,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Full Name"}),r.jsx("input",{type:"text",value:O.name,onChange:R=>I({...O,name:R.target.value}),required:!0,placeholder:"John Doe",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),r.jsx("input",{type:"email",value:O.email,onChange:R=>I({...O,email:R.target.value}),required:!0,placeholder:"john@example.com",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Phone Number"}),r.jsx("input",{type:"tel",value:O.phone,onChange:R=>I({...O,phone:R.target.value}),required:!0,placeholder:"(555) 123-4567",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(ir,{className:"w-4 h-4 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Make this recurring"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Book the same slot on a regular schedule"})]})]}),r.jsx("button",{type:"button",onClick:()=>_e(!le),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${le?"bg-blue-500":"bg-slate-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${le?"translate-x-6":"translate-x-1"}`})})]}),le&&r.jsxs("div",{className:"space-y-3 pt-1 animate-fade-in",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Repeat every"}),r.jsxs("select",{value:ye,onChange:R=>Ie(R.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[r.jsx("option",{value:"weekly",children:"Week"}),r.jsx("option",{value:"biweekly",children:"2 Weeks"}),r.jsx("option",{value:"fourweekly",children:"4 Weeks"}),r.jsx("option",{value:"monthly",children:"Month"})]})]}),Pe&&r.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[r.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:[" Every ",Pe.intervalLabel," through ",Pe.endDate]}),r.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[Pe.total," total appointment",Pe.total!==1?"s":""]}),Pe.skipped>0&&r.jsxs("p",{className:"text-xs text-amber-600 mt-1 font-medium",children:[" ",Pe.skipped," date",Pe.skipped!==1?"s":""," will be skipped due to existing bookings"]})]})]})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{type:"submit",disabled:D,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:D?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Booking"]}):r.jsxs(r.Fragment,{children:[r.jsx(bs,{className:"w-4 h-4"}),"Confirm Booking"]})}),r.jsx("button",{type:"button",onClick:()=>{re(!1),T(null)},className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Back"})]})]})]})]}),V&&r.jsx(ED,{member:V,onClose:()=>ne(null)}),r.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:r.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",r.jsx(et,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"BookFlow"})]})})}),r.jsx(yD,{services:x,staffMembers:_,shop:e,onSelectService:qe})]})}function TD({slotsByDate:s,bookingsByDate:e,selectedDate:n,onSelectDate:i,recurringDayFlags:o={}}){const[u,d]=N.useState(new Date),p=xe=>{const me=xe.getFullYear(),re=xe.getMonth(),j=new Date(me,re,1),k=new Date(me,re+1,0).getDate(),L=j.getDay();return{daysInMonth:k,startingDayOfWeek:L,year:me,month:re}},{daysInMonth:g,startingDayOfWeek:x,year:y,month:_}=p(u),S=()=>{d(new Date(u.getFullYear(),u.getMonth()-1))},C=()=>{d(new Date(u.getFullYear(),u.getMonth()+1))},H=xe=>`${y}-${String(_+1).padStart(2,"0")}-${String(xe).padStart(2,"0")}`,B=xe=>{const me=H(xe),re=s[me]||[],j=e[me]||[],T=re.filter(L=>L.available).length,k=j.length;return{availableCount:T,bookedCount:k,hasData:re.length>0||j.length>0}},P=xe=>{const me=H(xe);i(me===n?null:me)},q=["January","February","March","April","May","June","July","August","September","October","November","December"],Y=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],W=new Date;return W.setHours(0,0,0,0),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-5",children:[r.jsx("button",{onClick:S,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(y2,{className:"w-5 h-5 text-slate-600"})}),r.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[q[_]," ",y]}),r.jsx("button",{onClick:C,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(df,{className:"w-5 h-5 text-slate-600"})})]}),r.jsx("div",{className:"grid grid-cols-7 gap-1.5 mb-1.5",children:Y.map(xe=>r.jsx("div",{className:"text-center text-xs font-semibold text-slate-400 py-2 uppercase tracking-wider",children:xe},xe))}),r.jsxs("div",{className:"grid grid-cols-7 gap-1.5",children:[Array.from({length:x}).map((xe,me)=>r.jsx("div",{},`empty-${me}`)),Array.from({length:g}).map((xe,me)=>{const re=me+1,j=H(re),{availableCount:T,bookedCount:k,hasData:L}=B(re),M=j===n,z=new Date,D=z.getDate()===re&&z.getMonth()===_&&z.getFullYear()===y,F=new Date(y,_,re),O=F.getDay(),I=o[O]&&F>=W;return r.jsxs("button",{onClick:()=>P(re),className:`
                relative p-2 text-center rounded-lg text-sm font-semibold transition-all duration-200 min-h-[56px] flex flex-col items-center justify-start cursor-pointer
                ${M?"bg-blue-600 text-white shadow-md shadow-blue-600/30":L||I?"bg-slate-50 hover:bg-slate-100 text-slate-900 border border-slate-200 hover:border-slate-300":D?"text-slate-900 font-bold hover:bg-slate-50":"text-slate-400 hover:bg-slate-50"}
              `,children:[r.jsxs("span",{className:`text-sm ${D&&!M?"relative":""}`,children:[re,D&&!M&&r.jsx("span",{className:"absolute -bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full"})]}),(L||I)&&r.jsxs("div",{className:"flex gap-0.5 mt-1 flex-wrap justify-center",children:[I&&r.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${M?"bg-white/20 text-white":"bg-violet-100 text-violet-700"}`,children:"R"}),T>0&&r.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${M?"bg-white/20 text-white":"bg-emerald-100 text-emerald-700"}`,children:T}),k>0&&r.jsx("span",{className:`text-[9px] font-bold px-1 rounded ${M?"bg-white/20 text-white":"bg-blue-100 text-blue-700"}`,children:k})]})]},re)})]}),r.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-xs text-slate-500",children:[Object.keys(o).length>0&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3.5 h-3.5 bg-violet-100 border border-violet-200 rounded flex items-center justify-center text-[7px] font-bold text-violet-700",children:"R"}),r.jsx("span",{children:"Recurring"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3.5 h-3.5 bg-emerald-100 border border-emerald-200 rounded"}),r.jsx("span",{children:"Available"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3.5 h-3.5 bg-blue-100 border border-blue-200 rounded"}),r.jsx("span",{children:"Booked"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("div",{className:"w-3.5 h-3.5 bg-blue-600 rounded"}),r.jsx("span",{children:"Selected"})]})]})]})}const jD=[{value:15,label:"15 min"},{value:30,label:"30 min"},{value:45,label:"45 min"},{value:60,label:"1 hour"},{value:90,label:"1.5 hours"},{value:120,label:"2 hours"}];function AD({shopId:s}){const[e,n]=N.useState([]),[i,o]=N.useState(!1),[u,d]=N.useState(null),[p,g]=N.useState({name:"",description:"",duration:30,price:""}),[x,y]=N.useState(!1);N.useEffect(()=>{if(!s)return;const q=Wt(Je(Ne,"shops",s,"services"),Y=>{const W=Y.docs.map(xe=>({id:xe.id,...xe.data()})).filter(xe=>xe.active!==!1).sort((xe,me)=>(xe.name||"").localeCompare(me.name||""));n(W)});return()=>q()},[s]);const _=()=>{g({name:"",description:"",duration:30,price:""}),o(!1),d(null)},S=async q=>{q.preventDefault(),y(!0);const Y={name:p.name.trim(),description:p.description.trim(),duration:parseInt(p.duration),price:parseFloat(p.price),active:!0};try{u?await st(Qe(Ne,"shops",s,"services",u),Y):await fi(Je(Ne,"shops",s,"services"),{...Y,createdAt:y0()}),_()}catch(W){console.error("Error saving service:",W)}finally{y(!1)}},C=q=>{g({name:q.name,description:q.description||"",duration:q.duration,price:q.price.toString()}),d(q.id),o(!0)},H=async q=>{try{await st(Qe(Ne,"shops",s,"services",q),{active:!1})}catch(Y){console.error("Error deleting service:",Y)}},B=q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(q),P=q=>{if(q<60)return`${q} min`;const Y=Math.floor(q/60),W=q%60;return W?`${Y}h ${W}m`:`${Y}h`};return r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Services"}),r.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Define the services you offer  clients will pick one before booking"})]}),!i&&r.jsxs("button",{onClick:()=>{_(),o(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[r.jsx(fr,{className:"w-4 h-4"}),"Add Service"]})]}),i&&r.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:u?"Edit Service":"New Service"}),r.jsxs("form",{onSubmit:S,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Service Name *"}),r.jsx("input",{type:"text",value:p.name,onChange:q=>g({...p,name:q.target.value}),required:!0,placeholder:"e.g. Haircut",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Description (optional)"}),r.jsx("input",{type:"text",value:p.description,onChange:q=>g({...p,description:q.target.value}),placeholder:"e.g. Classic cut and style",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Duration *"}),r.jsx("select",{value:p.duration,onChange:q=>g({...p,duration:q.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:jD.map(q=>r.jsx("option",{value:q.value,children:q.label},q.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Price (USD) *"}),r.jsxs("div",{className:"relative",children:[r.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-semibold",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:p.price,onChange:q=>g({...p,price:q.target.value}),required:!0,placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsxs("button",{type:"submit",disabled:x,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[r.jsx(ar,{className:"w-4 h-4"}),x?"Saving":u?"Update Service":"Add Service"]}),r.jsxs("button",{type:"button",onClick:_,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[r.jsx(ka,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length===0?r.jsxs("div",{className:"text-center py-16",children:[r.jsx("div",{className:"text-5xl mb-3",children:""}),r.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No services yet"}),r.jsx("p",{className:"text-sm text-slate-600",children:"Add your first service so clients can choose what to book"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(q=>r.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:q.name}),q.description&&r.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:q.description})]}),r.jsx("span",{className:"text-xl font-bold text-blue-600 whitespace-nowrap ml-3",children:B(q.price)})]}),r.jsx("div",{className:"flex items-center gap-4 text-sm text-slate-500 mb-4",children:r.jsxs("span",{className:"flex items-center gap-1.5",children:[r.jsx(jn,{className:"w-4 h-4"}),P(q.duration)]})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:()=>C(q),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:[r.jsx(_2,{className:"w-3.5 h-3.5"}),"Edit"]}),r.jsx("button",{onClick:()=>H(q.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:r.jsx(au,{className:"w-3.5 h-3.5"})})]})]},q.id))})]})}const Mp=[{key:"monday",label:"Monday",short:"Mon"},{key:"tuesday",label:"Tuesday",short:"Tue"},{key:"wednesday",label:"Wednesday",short:"Wed"},{key:"thursday",label:"Thursday",short:"Thu"},{key:"friday",label:"Friday",short:"Fri"},{key:"saturday",label:"Saturday",short:"Sat"},{key:"sunday",label:"Sunday",short:"Sun"}],CD={enabled:!1,start:"09:00",end:"17:00",break:null};function RD({shopId:s,staffId:e,staffName:n,weeklyHours:i,onClose:o}){const[u,d]=N.useState(()=>{const P={};for(const q of Mp){const Y=i?.[q.key];Y?P[q.key]={enabled:!!Y.enabled,start:Y.start||"09:00",end:Y.end||"17:00",break:Y.break?{start:Y.break.start,end:Y.break.end}:null}:P[q.key]={...CD}}return P}),[p,g]=N.useState(!1),[x,y]=N.useState(null),_=(P,q,Y)=>{d(W=>({...W,[P]:{...W[P],[q]:Y}}))},S=P=>{d(q=>({...q,[P]:{...q[P],break:q[P].break?null:{start:"12:00",end:"13:00"}}}))},C=(P,q,Y)=>{d(W=>({...W,[P]:{...W[P],break:{...W[P].break,[q]:Y}}}))},H=P=>{const q=u[P];d(Y=>{const W={...Y};for(const xe of Mp)xe.key!==P&&(W[xe.key]={enabled:q.enabled,start:q.start,end:q.end,break:q.break?{...q.break}:null});return W}),y(P),setTimeout(()=>y(null),1500)},B=async()=>{g(!0);try{await st(Qe(Ne,"shops",s,"staff",e),{weeklyHours:u}),o()}catch(P){console.error("Error saving weekly hours:",P)}finally{g(!1)}};return r.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-6 shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Weekly Hours"}),r.jsx("p",{className:"text-sm text-slate-500",children:n})]}),r.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(ka,{className:"w-5 h-5 text-slate-400"})})]}),r.jsx("div",{className:"space-y-3",children:Mp.map(({key:P,label:q})=>{const Y=u[P];return r.jsx("div",{className:`rounded-xl p-4 transition-all ${Y.enabled?"bg-blue-50 border border-blue-200":"bg-slate-50 border border-slate-200"}`,children:r.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[r.jsxs("div",{className:"flex items-center gap-3 min-w-[140px]",children:[r.jsx("button",{type:"button",onClick:()=>_(P,"enabled",!Y.enabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${Y.enabled?"bg-blue-500":"bg-slate-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${Y.enabled?"translate-x-6":"translate-x-1"}`})}),r.jsx("span",{className:`font-semibold text-sm ${Y.enabled?"text-slate-900":"text-slate-400"}`,children:q})]}),Y.enabled?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(jn,{className:"w-4 h-4 text-blue-500"}),r.jsx("input",{type:"time",value:Y.start,onChange:W=>_(P,"start",W.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("span",{className:"text-slate-400 text-sm",children:"to"}),r.jsx("input",{type:"time",value:Y.end,onChange:W=>_(P,"end",W.target.value),className:"px-2 py-1.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{type:"button",onClick:()=>S(P),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${Y.break?"bg-amber-100 text-amber-700 border border-amber-200":"bg-slate-100 text-slate-500 border border-slate-200 hover:bg-slate-200"}`,children:[r.jsx(r3,{className:"w-3.5 h-3.5"}),Y.break?"Break":"+ Break"]}),Y.break&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("input",{type:"time",value:Y.break.start,onChange:W=>C(P,"start",W.target.value),className:"px-2 py-1.5 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"}),r.jsx("span",{className:"text-slate-400 text-xs",children:""}),r.jsx("input",{type:"time",value:Y.break.end,onChange:W=>C(P,"end",W.target.value),className:"px-2 py-1.5 border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 bg-white"})]})]}),r.jsx("button",{type:"button",onClick:()=>H(P),className:"text-xs text-blue-500 hover:text-blue-700 font-medium transition-colors whitespace-nowrap",children:x===P?" Copied!":"Copy to all"})]}):r.jsx("span",{className:"text-sm text-slate-400 italic",children:"Day off"})]})},P)})}),r.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t border-slate-200",children:[r.jsxs("button",{onClick:B,disabled:p,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[r.jsx(B3,{className:"w-4 h-4"}),p?"Saving":"Save Hours"]}),r.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[r.jsx(ka,{className:"w-4 h-4"}),"Cancel"]})]})]})}const kD=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}],ID=5*1024*1024,DD=["image/jpeg","image/png","image/webp"];function a_(s){if(!s)return"";const[e,n]=s.split(":").map(Number),i=e>=12?"p":"a",o=e%12||12;return n===0?`${o}${i}`:`${o}:${n.toString().padStart(2,"0")}${i}`}function MD({shopId:s}){const[e,n]=N.useState([]),[i,o]=N.useState(!1),[u,d]=N.useState(null),[p,g]=N.useState(null),[x,y]=N.useState(null),[_,S]=N.useState({name:"",role:""}),[C,H]=N.useState(!1),[B,P]=N.useState(null),[q,Y]=N.useState(""),[W,xe]=N.useState(!1),[me,re]=N.useState(!1),[j,T]=N.useState(""),[k,L]=N.useState(null),[M,z]=N.useState(null),[D,F]=N.useState(null),O=N.useRef(null);N.useEffect(()=>{if(!s)return;const ue=Wt(Je(Ne,"shops",s,"staff"),ze=>{const Ue=ze.docs.map(Ge=>({id:Ge.id,...Ge.data()})).filter(Ge=>Ge.active!==!1).sort((Ge,J)=>(Ge.name||"").localeCompare(J.name||""));n(Ue)});return()=>ue()},[s]);const I=()=>{S({name:"",role:""}),o(!1),d(null)},K=async ue=>{ue.preventDefault(),H(!0);const ze={name:_.name.trim(),role:_.role.trim(),active:!0};try{u?await st(Qe(Ne,"shops",s,"staff",u),ze):await fi(Je(Ne,"shops",s,"staff"),{...ze,email:"",bio:"",portfolio:[],createdAt:y0()}),I()}catch(Ue){console.error("Error saving staff member:",Ue)}finally{H(!1)}},fe=ue=>{S({name:ue.name,role:ue.role||""}),d(ue.id),o(!0)},Se=async ue=>{try{await st(Qe(Ne,"shops",s,"staff",ue),{active:!1})}catch(ze){console.error("Error deleting staff member:",ze)}},we=ue=>{P(ue.id),Y(ue.bio||"")},V=async ue=>{xe(!0);try{await st(Qe(Ne,"shops",s,"staff",ue),{bio:q.trim()}),P(null),Y("")}catch(ze){console.error("Error saving bio:",ze)}finally{xe(!1)}},ne=ue=>{L(ue),T(""),z(null),setTimeout(()=>{O.current&&(O.current.value="",O.current.click())},50)},le=ue=>{const ze=ue.target.files?.[0];if(ze){if(!DD.includes(ze.type)){alert("Please select a JPG, PNG, or WebP image.");return}if(ze.size>ID){alert("File size must be under 5MB.");return}z(ze)}},_e=async ue=>{if(M){re(!0);try{const ze=Date.now(),Ue=M.name.split(".").pop(),Ge=`${ze}.${Ue}`,J=`shops/${s}/staff/${ue}/portfolio/${Ge}`,ve=Kw(Qw,J);await w6(ve,M);const Ve=await _6(ve),qe=e.find(gt=>gt.id===ue)?.portfolio||[];await st(Qe(Ne,"shops",s,"staff",ue),{portfolio:[...qe,{url:Ve,storagePath:J,caption:j.trim(),uploadedAt:new Date().toISOString()}]}),L(null),T(""),z(null)}catch(ze){console.error("Error uploading photo:",ze),alert("Upload failed. Please try again.")}finally{re(!1)}}},ye=async(ue,ze)=>{const Ue=e.find(J=>J.id===ue);if(!Ue)return;const Ge=Ue.portfolio[ze];if(Ge){F(`${ue}-${ze}`);try{if(Ge.storagePath)try{const ve=Kw(Qw,Ge.storagePath);await N6(ve)}catch(ve){console.warn("Storage delete warning:",ve)}const J=Ue.portfolio.filter((ve,Ve)=>Ve!==ze);await st(Qe(Ne,"shops",s,"staff",ue),{portfolio:J})}catch(J){console.error("Error deleting photo:",J),alert("Failed to delete photo.")}finally{F(null)}}},Ie=ue=>{if(!ue)return null;const ze=kD.filter(Ue=>ue[Ue.key]?.enabled);return ze.length===0?null:ze.map(Ue=>{const Ge=ue[Ue.key];return`${Ue.short} ${a_(Ge.start)}${a_(Ge.end)}`})};return r.jsxs("div",{children:[r.jsx("input",{ref:O,type:"file",accept:".jpg,.jpeg,.png,.webp",className:"hidden",onChange:le}),r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Staff"}),r.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Manage your team  assign availability and bookings per staff member"})]}),!i&&r.jsxs("button",{onClick:()=>{I(),o(!0)},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all hover:-translate-y-0.5",children:[r.jsx(fr,{className:"w-4 h-4"}),"Add Staff"]})]}),i&&r.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:u?"Edit Staff Member":"New Staff Member"}),r.jsxs("form",{onSubmit:K,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Name *"}),r.jsx("input",{type:"text",value:_.name,onChange:ue=>S({..._,name:ue.target.value}),required:!0,placeholder:"e.g. Jane Smith",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Role (optional)"}),r.jsx("input",{type:"text",value:_.role,onChange:ue=>S({..._,role:ue.target.value}),placeholder:"e.g. Senior Stylist",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsxs("button",{type:"submit",disabled:C,className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",children:[r.jsx(ar,{className:"w-4 h-4"}),C?"Saving":u?"Update Staff":"Add Staff"]}),r.jsxs("button",{type:"button",onClick:I,className:"flex items-center gap-2 px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:[r.jsx(ka,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),e.length===0?r.jsxs("div",{className:"text-center py-16",children:[r.jsx("div",{className:"text-5xl mb-3",children:""}),r.jsx("p",{className:"text-slate-800 font-medium mb-1",children:"No staff members yet"}),r.jsx("p",{className:"text-sm text-slate-600",children:"Add your team members to assign them availability and bookings"})]}):r.jsx("div",{className:"space-y-4",children:e.map(ue=>{const ze=Ie(ue.weeklyHours),Ue=ue.portfolio||[];return r.jsxs("div",{children:[r.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-all",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:ue.name}),ue.role&&r.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:ue.role})]}),r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(Xt,{className:"w-5 h-5 text-blue-600"})})]}),r.jsx("div",{className:"mb-3",children:B===ue.id?r.jsxs("div",{className:"space-y-2",children:[r.jsx("textarea",{value:q,onChange:Ge=>Y(Ge.target.value),placeholder:"Write a short bio  specialties, experience, personality",rows:3,maxLength:500,className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none transition-all"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>V(ue.id),disabled:W,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[W?r.jsx(Ip,{className:"w-3 h-3 animate-spin"}):r.jsx(ar,{className:"w-3 h-3"}),"Save Bio"]}),r.jsx("button",{onClick:()=>{P(null),Y("")},className:"px-3 py-1.5 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"}),r.jsxs("span",{className:"text-xs text-slate-400 ml-auto",children:[q.length,"/500"]})]})]}):r.jsx("div",{onClick:()=>we(ue),className:"cursor-pointer group",children:ue.bio?r.jsxs("p",{className:"text-sm text-slate-600 leading-relaxed group-hover:text-slate-800 transition-colors",children:[ue.bio,r.jsx("span",{className:"ml-1.5 text-xs text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",children:"edit"})]}):r.jsx("p",{className:"text-sm text-slate-400 italic group-hover:text-blue-500 transition-colors",children:"+ Add a bio"})})}),ze?r.jsx("div",{className:"mb-3 flex flex-wrap gap-1.5",children:ze.map((Ge,J)=>r.jsx("span",{className:"inline-block px-2 py-0.5 bg-green-50 text-green-700 border border-green-200 rounded text-xs font-medium",children:Ge},J))}):r.jsx("p",{className:"text-xs text-slate-400 mb-3 italic",children:"No weekly hours set"}),Ue.length>0&&x!==ue.id&&r.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[r.jsx("div",{className:"flex -space-x-1",children:Ue.slice(0,4).map((Ge,J)=>r.jsx("img",{src:Ge.url,alt:Ge.caption||"Portfolio",className:"w-10 h-10 rounded-lg object-cover border-2 border-white shadow-sm"},J))}),r.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[Ue.length," photo",Ue.length!==1?"s":""]})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap",children:[r.jsxs("button",{onClick:()=>g(p===ue.id?null:ue.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${p===ue.id?"bg-blue-100 text-blue-700 border-blue-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:[r.jsx(jn,{className:"w-3.5 h-3.5"}),"Set Hours"]}),r.jsxs("button",{onClick:()=>y(x===ue.id?null:ue.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ${x===ue.id?"bg-violet-100 text-violet-700 border-violet-300":"bg-slate-100 hover:bg-slate-200 text-slate-700 border-slate-200"}`,children:[r.jsx(Y6,{className:"w-3.5 h-3.5"}),"Portfolio"]}),r.jsx("button",{onClick:()=>fe(ue),className:"flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-all border border-slate-200",children:r.jsx(_2,{className:"w-3.5 h-3.5"})}),r.jsx("button",{onClick:()=>Se(ue.id),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm font-medium transition-all border border-red-200",children:r.jsx(au,{className:"w-3.5 h-3.5"})})]})]}),p===ue.id&&r.jsx("div",{className:"mt-2",children:r.jsx(RD,{shopId:s,staffId:ue.id,staffName:ue.name,weeklyHours:ue.weeklyHours,onClose:()=>g(null)})}),x===ue.id&&r.jsxs("div",{className:"mt-2 bg-white border-2 border-violet-200 rounded-xl p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h4",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[r.jsx(y3,{className:"w-4 h-4 text-violet-600"}),"Portfolio  ",ue.name]}),r.jsxs("button",{onClick:()=>ne(ue.id),disabled:me,className:"flex items-center gap-1.5 px-3 py-1.5 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:[r.jsx(fr,{className:"w-3 h-3"}),"Add Photo"]})]}),k===ue.id&&M&&r.jsxs("div",{className:"mb-4 p-3 bg-violet-50 border border-violet-200 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"w-16 h-16 rounded-lg bg-slate-200 overflow-hidden flex-shrink-0",children:r.jsx("img",{src:URL.createObjectURL(M),alt:"Preview",className:"w-full h-full object-cover"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-xs text-slate-600 font-medium mb-1 truncate",children:M.name}),r.jsxs("p",{className:"text-xs text-slate-400",children:[(M.size/1024/1024).toFixed(1)," MB"]})]})]}),r.jsx("input",{type:"text",value:j,onChange:Ge=>T(Ge.target.value),placeholder:"Add a caption (optional)",maxLength:200,className:"w-full px-3 py-2 text-sm border border-violet-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-400 focus:border-transparent mb-2"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>_e(ue.id),disabled:me,className:"flex items-center gap-1.5 px-4 py-2 bg-violet-500 hover:bg-violet-600 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:me?r.jsxs(r.Fragment,{children:[r.jsx(Ip,{className:"w-3 h-3 animate-spin"}),"Uploading"]}):r.jsxs(r.Fragment,{children:[r.jsx(ar,{className:"w-3 h-3"}),"Upload"]})}),r.jsx("button",{onClick:()=>{L(null),z(null),T("")},className:"px-3 py-2 text-slate-600 hover:bg-slate-100 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}),Ue.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"text-3xl mb-2",children:""}),r.jsx("p",{className:"text-sm text-slate-500",children:"No portfolio photos yet. Add some to showcase work!"})]}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:Ue.map((Ge,J)=>r.jsxs("div",{className:"group relative bg-slate-50 rounded-lg overflow-hidden border border-slate-200 shadow-sm",children:[r.jsx("div",{className:"aspect-square",children:r.jsx("img",{src:Ge.url,alt:Ge.caption||"Portfolio photo",className:"w-full h-full object-cover"})}),Ge.caption&&r.jsx("div",{className:"px-2 py-1.5",children:r.jsx("p",{className:"text-xs text-slate-600 truncate",children:Ge.caption})}),r.jsx("button",{onClick:()=>ye(ue.id,J),disabled:D===`${ue.id}-${J}`,className:"absolute top-1.5 right-1.5 w-7 h-7 bg-red-500/90 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-md disabled:opacity-50",title:"Delete photo",children:D===`${ue.id}-${J}`?r.jsx(Ip,{className:"w-3.5 h-3.5 animate-spin"}):r.jsx(au,{className:"w-3.5 h-3.5"})})]},J))})]})]},ue.id)})})]})}function Hr(s){return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`}function OD(s){const e=new Date(s),n=e.getDay(),i=n===0?-6:1-n;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function $r(s){return`$${Number(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function i_(s){return new Date(s+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}function r_(s){return new Date(s+"T12:00:00").toLocaleDateString("en-US",{weekday:"short"})}function Op(s,e){return e===0&&s===0?0:e===0?100:(s-e)/e*100}function VD({bookings:s}){const[e,n]=N.useState(null),[i,o]=N.useState(null),u=N.useMemo(()=>s.filter(F=>F.status==="confirmed"||F.status==="pending"||!F.status),[s]),d=N.useMemo(()=>{const F=new Date;return F.setHours(0,0,0,0),F},[]),p=N.useMemo(()=>Hr(d),[d]),g=N.useMemo(()=>OD(d),[d]),x=N.useMemo(()=>{const F=new Date(g);return F.setDate(F.getDate()+6),F},[g]),y=N.useMemo(()=>{const F=new Date(g);return F.setDate(F.getDate()-7),F},[g]),_=N.useMemo(()=>{const F=new Date(y);return F.setDate(F.getDate()+6),F},[y]),S=N.useMemo(()=>new Date(d.getFullYear(),d.getMonth(),1),[d]),C=N.useMemo(()=>new Date(d.getFullYear(),d.getMonth()-1,1),[d]),H=N.useMemo(()=>{const F=new Date(S);return F.setDate(F.getDate()-1),F},[S]),B=N.useMemo(()=>{const F=new Date(d);return F.setDate(F.getDate()-1),Hr(F)},[d]),P=N.useMemo(()=>{const F=le=>le.reduce((_e,ye)=>_e+(Number(ye.servicePrice)||0),0),O=(le,_e,ye)=>le.date>=Hr(_e)&&le.date<=Hr(ye),I=F(u.filter(le=>le.date===p)),K=F(u.filter(le=>le.date===B)),fe=F(u.filter(le=>O(le,g,x))),Se=F(u.filter(le=>O(le,y,_))),we=F(u.filter(le=>O(le,S,d))),V=F(u.filter(le=>O(le,C,H))),ne=F(u);return{today:I,todayChange:Op(I,K),week:fe,weekChange:Op(fe,Se),month:we,monthChange:Op(we,V),allTime:ne}},[u,p,B,g,x,y,_,S,H,d]),q=N.useMemo(()=>{const F=[];for(let O=13;O>=0;O--){const I=new Date(d);I.setDate(I.getDate()-O),F.push(Hr(I))}return F},[d]),Y=N.useMemo(()=>{const F={};return q.forEach(O=>{F[O]=0}),u.forEach(O=>{F[O.date]!==void 0&&(F[O.date]+=Number(O.servicePrice)||0)}),q.map(O=>({date:O,value:F[O]}))},[u,q]),W=N.useMemo(()=>Math.max(...Y.map(F=>F.value),1),[Y]),xe=N.useMemo(()=>{const F={},O={};return q.forEach(I=>{F[I]=0,O[I]=0}),s.forEach(I=>{F[I.date]!==void 0&&(I.status==="cancelled"||I.status==="rejected"?O[I.date]++:F[I.date]++)}),q.map(I=>({date:I,confirmed:F[I],cancelled:O[I],total:F[I]+O[I]}))},[s,q]),me=N.useMemo(()=>Math.max(...xe.map(F=>F.total),1),[xe]),re=N.useMemo(()=>{const F=s.length;if(F===0)return 100;const O=s.filter(I=>I.status==="cancelled"||I.status==="rejected").length;return Math.round((F-O)/F*100)},[s]),j=N.useMemo(()=>{const F=Array.from({length:7},()=>Array(24).fill(0));u.forEach(I=>{if(!I.date||!I.time)return;const fe=new Date(I.date+"T12:00:00").getDay(),Se=parseInt(I.time.split(":")[0],10);!isNaN(fe)&&!isNaN(Se)&&F[fe][Se]++});let O=0;return F.forEach(I=>I.forEach(K=>{K>O&&(O=K)})),{grid:F,max:O}},[u]),T=N.useMemo(()=>{const F={};return u.forEach(O=>{const I=O.serviceName||"Unknown";F[I]||(F[I]={name:I,count:0,revenue:0}),F[I].count++,F[I].revenue+=Number(O.servicePrice)||0}),Object.values(F).map(O=>({...O,avgRevenue:O.count>0?O.revenue/O.count:0})).sort((O,I)=>I.revenue-O.revenue)},[u]),k=N.useMemo(()=>{const F={};return u.forEach(O=>{const I=O.staffName||"Unassigned";F[I]||(F[I]={name:I,count:0,revenue:0,clients:new Set}),F[I].count++,F[I].revenue+=Number(O.servicePrice)||0,O.clientEmail&&F[I].clients.add(O.clientEmail.toLowerCase())}),Object.values(F).map(O=>({...O,clientCount:O.clients.size})).sort((O,I)=>I.revenue-O.revenue)},[u]),L=N.useMemo(()=>{const F=u.map(ye=>ye.clientEmail?.toLowerCase()).filter(Boolean),O=new Set(F).size,I=u.filter(ye=>ye.date>=Hr(S)&&ye.date<=p),K=new Set(I.map(ye=>ye.clientEmail?.toLowerCase()).filter(Boolean)),fe=u.filter(ye=>ye.date<Hr(S)),Se=new Set(fe.map(ye=>ye.clientEmail?.toLowerCase()).filter(Boolean));let we=0,V=0;K.forEach(ye=>{Se.has(ye)?V++:we++});const ne={};u.forEach(ye=>{const Ie=ye.clientEmail?.toLowerCase();Ie&&(ne[Ie]||(ne[Ie]={email:Ie,name:ye.clientName||Ie,count:0}),ne[Ie].count++,ye.clientName&&(ne[Ie].name=ye.clientName))});const le=Object.values(ne).sort((ye,Ie)=>Ie.count-ye.count).slice(0,10),_e=O>0?u.length/O:0;return{uniqueClients:O,newThisMonth:we,returningThisMonth:V,topClients:le,avgBookingsPerClient:_e}},[u,S,p]),M=({value:F,suffix:O="vs prev"})=>{if(F===0)return r.jsxs("span",{className:"flex items-center gap-0.5 text-xs font-medium text-slate-400",children:[r.jsx(k3,{className:"w-3 h-3"})," 0% ",O]});const I=F>0;return r.jsxs("span",{className:`flex items-center gap-0.5 text-xs font-semibold ${I?"text-emerald-600":"text-red-500"}`,children:[I?r.jsx(z6,{className:"w-3 h-3"}):r.jsx(O6,{className:"w-3 h-3"}),I?"+":"",Math.round(F),"% ",O]})},z=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],D=Array.from({length:15},(F,O)=>O+7);return r.jsxs("div",{className:"animate-fade-in space-y-6",children:[r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Today's Revenue",value:P.today,change:P.todayChange,suffix:"vs yesterday",icon:u3,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:P.week,change:P.weekChange,suffix:"vs last week",icon:R0,color:"bg-violet-100 text-violet-600"},{label:"This Month",value:P.month,change:P.monthChange,suffix:"vs last month",icon:Vt,color:"bg-emerald-100 text-emerald-600"},{label:"All-time Revenue",value:P.allTime,change:null,icon:b2,color:"bg-amber-100 text-amber-600"}].map(F=>{const O=F.icon;return r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:`w-10 h-10 ${F.color} rounded-xl flex items-center justify-center`,children:r.jsx(O,{className:"w-5 h-5"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:$r(F.value)}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5 mb-1",children:F.label}),F.change!==null&&r.jsx(M,{value:F.change,suffix:F.suffix})]},F.label)})}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Revenue  Last 14 Days"}),r.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Daily revenue from confirmed & pending bookings"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[600px]",children:[r.jsxs("div",{className:"flex items-end gap-0",children:[r.jsxs("div",{className:"flex flex-col justify-between h-48 pr-2 text-right flex-shrink-0 w-16",children:[r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:$r(W)}),r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:$r(W/2)}),r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"$0"})]}),r.jsx("div",{className:"flex-1 flex items-end gap-1 h-48 border-b border-l border-slate-200 pl-1 pb-0 relative",children:Y.map((F,O)=>{const I=W>0?F.value/W*100:0,K=e===O;return r.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative group",onMouseEnter:()=>n(O),onMouseLeave:()=>n(null),onTouchStart:()=>n(O),children:[K&&r.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[$r(F.value),r.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),r.jsx("div",{className:"w-full rounded-t-md transition-all duration-200 cursor-pointer",style:{height:`${Math.max(I,F.value>0?2:0)}%`,background:K?"linear-gradient(to top, #2563eb, #60a5fa)":"linear-gradient(to top, #3b82f6, #93c5fd)",minHeight:F.value>0?"4px":"0px"}})]},F.date)})})]}),r.jsx("div",{className:"flex ml-16 pl-1",children:Y.map(F=>r.jsxs("div",{className:"flex-1 text-center",children:[r.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:r_(F.date)}),r.jsx("div",{className:"text-[9px] text-slate-400",children:i_(F.date)})]},F.date))})]})})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Booking Trends  Last 14 Days"}),r.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Daily bookings breakdown"})]}),r.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[r.jsxs("span",{className:"flex items-center gap-1.5",children:[r.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-blue-500"})," Confirmed"]}),r.jsxs("span",{className:"flex items-center gap-1.5",children:[r.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-red-400"})," Cancelled"]}),r.jsxs("span",{className:"px-2.5 py-1 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-lg font-semibold",children:[re,"% completion"]})]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[600px]",children:[r.jsxs("div",{className:"flex items-end gap-0",children:[r.jsxs("div",{className:"flex flex-col justify-between h-40 pr-2 text-right flex-shrink-0 w-16",children:[r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:me}),r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:Math.round(me/2)}),r.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"0"})]}),r.jsx("div",{className:"flex-1 flex items-end gap-1 h-40 border-b border-l border-slate-200 pl-1 relative",children:xe.map((F,O)=>{const I=me>0?F.confirmed/me*100:0,K=me>0?F.cancelled/me*100:0,fe=i===O;return r.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full relative",onMouseEnter:()=>o(O),onMouseLeave:()=>o(null),onTouchStart:()=>o(O),children:[fe&&r.jsxs("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] font-semibold px-2.5 py-1.5 rounded-lg shadow-lg whitespace-nowrap z-10",children:[F.confirmed," confirmed, ",F.cancelled," cancelled",r.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]}),r.jsxs("div",{className:"w-full flex flex-col items-stretch",children:[F.cancelled>0&&r.jsx("div",{className:"w-full rounded-t-md bg-red-400 transition-all duration-200",style:{height:`${Math.max(K,2)}%`}}),F.confirmed>0&&r.jsx("div",{className:`w-full bg-blue-500 transition-all duration-200 ${F.cancelled===0?"rounded-t-md":""}`,style:{height:`${Math.max(I,2)}%`}})]})]},F.date)})})]}),r.jsx("div",{className:"flex ml-16 pl-1",children:xe.map(F=>r.jsxs("div",{className:"flex-1 text-center",children:[r.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-1.5",children:r_(F.date)}),r.jsx("div",{className:"text-[9px] text-slate-400",children:i_(F.date)})]},F.date))})]})})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Busiest Times"}),r.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Booking density by day of week and hour"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[600px]",children:[r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"w-12"}),D.map(F=>r.jsxs("th",{className:"text-[10px] text-slate-400 font-medium pb-2 text-center px-0.5",children:[F%12||12,F>=12?"p":"a"]},F))]})}),r.jsx("tbody",{children:[1,2,3,4,5,6,0].map(F=>r.jsxs("tr",{children:[r.jsx("td",{className:"text-[11px] text-slate-500 font-semibold pr-2 py-0.5 text-right",children:z[F]}),D.map(O=>{const I=j.grid[F][O],K=j.max||1,fe=I/K;let Se="bg-slate-50";return I>0&&(fe<=.2?Se="bg-blue-100":fe<=.4?Se="bg-blue-200":fe<=.6?Se="bg-blue-300":fe<=.8?Se="bg-blue-500 text-white":Se="bg-blue-700 text-white"),r.jsx("td",{className:"px-0.5 py-0.5",children:r.jsx("div",{className:`w-full aspect-square rounded-sm ${Se} flex items-center justify-center text-[9px] font-bold transition-all hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 cursor-default`,title:`${z[F]} ${O}:00  ${I} booking${I!==1?"s":""}`,children:I>0?I:""})},O)})]},F))})]}),r.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-3",children:[r.jsx("span",{className:"text-[10px] text-slate-400",children:"Less"}),["bg-slate-50","bg-blue-100","bg-blue-200","bg-blue-300","bg-blue-500","bg-blue-700"].map((F,O)=>r.jsx("div",{className:`w-4 h-4 rounded-sm ${F} border border-slate-200`},O)),r.jsx("span",{className:"text-[10px] text-slate-400",children:"More"})]})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Top Services"}),r.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Ranked by revenue from confirmed & pending bookings"}),T.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(is,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-slate-400",children:"No service data yet"})]}):r.jsx("div",{className:"space-y-2",children:T.map((F,O)=>r.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm flex-shrink-0",children:O+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:F.name}),r.jsxs("div",{className:"text-xs text-slate-500",children:[F.count," booking",F.count!==1?"s":"","  avg ",$r(F.avgRevenue)]})]}),r.jsx("div",{className:"text-sm font-bold text-blue-600 flex-shrink-0",children:$r(F.revenue)})]},F.name))})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Staff Performance"}),r.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Bookings, revenue & clients per staff member"}),k.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Xt,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-slate-400",children:"No staff data yet"})]}):r.jsx("div",{className:"space-y-2",children:k.map((F,O)=>r.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[r.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center text-violet-600 font-bold text-sm flex-shrink-0",children:O+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:F.name}),r.jsxs("div",{className:"text-xs text-slate-500",children:[F.count," booking",F.count!==1?"s":"","  ",F.clientCount," client",F.clientCount!==1?"s":""]})]}),r.jsx("div",{className:"text-sm font-bold text-violet-600 flex-shrink-0",children:$r(F.revenue)})]},F.name))})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Insights"}),r.jsx("p",{className:"text-xs text-slate-500 mb-5",children:"Understanding your client base"}),r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[r.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-100 p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:L.uniqueClients}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:"Total Unique Clients"})]}),r.jsxs("div",{className:"bg-emerald-50 rounded-xl border border-emerald-100 p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-extrabold text-emerald-700",children:L.newThisMonth}),r.jsx("div",{className:"text-xs font-medium text-emerald-600 mt-0.5",children:"New This Month"})]}),r.jsxs("div",{className:"bg-blue-50 rounded-xl border border-blue-100 p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-extrabold text-blue-700",children:L.returningThisMonth}),r.jsx("div",{className:"text-xs font-medium text-blue-600 mt-0.5",children:"Returning This Month"})]}),r.jsxs("div",{className:"bg-violet-50 rounded-xl border border-violet-100 p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-extrabold text-violet-700",children:L.avgBookingsPerClient.toFixed(1)}),r.jsx("div",{className:"text-xs font-medium text-violet-600 mt-0.5",children:"Avg Bookings / Client"})]})]}),r.jsx("h4",{className:"text-sm font-bold text-slate-700 mb-3",children:"Top Clients by Frequency"}),L.topClients.length===0?r.jsxs("div",{className:"text-center py-6",children:[r.jsx(ll,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-slate-400",children:"No client data yet"})]}):r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:L.topClients.map((F,O)=>r.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-slate-200 transition-all",children:[r.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center text-amber-700 font-bold text-xs flex-shrink-0",children:O+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:F.name}),r.jsx("div",{className:"text-xs text-slate-400 truncate",children:F.email})]}),r.jsxs("div",{className:"flex-shrink-0 px-2.5 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-bold",children:[F.count," visit",F.count!==1?"s":""]})]},F.email))})]})]})}function R2({waitingAhead:s=[],inProgress:e=[],staffCount:n=1,upcomingBookings:i=[],defaultDuration:o=30}){const u=Math.max(n,1),d=Date.now(),p=e.map(y=>{const _=y.startedAt?.toDate?.()||(y.startedAt?new Date(y.startedAt):null);if(!_)return 0;const S=(d-_.getTime())/6e4,C=y.estimatedDuration||o;return Math.max(0,C-S)});p.sort((y,_)=>y-_);const g=[];for(let y=0;y<u;y++)g.push(p[y]||0);g.sort((y,_)=>y-_);const x=s.map(y=>y.estimatedDuration||o);for(const y of x)g[0]+=y,g.sort((_,S)=>_-S);return Math.round(g[0])}function k2({waitingQueue:s=[],inProgress:e=[],staffCount:n=1,upcomingBookings:i=[],defaultDuration:o=30}){const u=new Map;for(let d=0;d<s.length;d++){const p=s.slice(0,d),g=R2({waitingAhead:p,inProgress:e,staffCount:n,upcomingBookings:i,defaultDuration:o});u.set(s[d].id,g)}return u}function PD(s=[],e=3){const n=new Date,i=new Date(n.getTime()+e*60*60*1e3),o=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`;return s.filter(u=>{if(u.status==="cancelled"||u.status==="rejected"||u.date!==o)return!1;const d=new Date(`${u.date}T${u.time}`);return d>=n&&d<=i}).sort((u,d)=>`${u.time}`.localeCompare(`${d.time}`))}function LD(s){if(!s)return"0m";const e=s?.toDate?.()||new Date(s),n=Math.floor((Date.now()-e.getTime())/6e4);if(n<1)return"<1m";if(n<60)return`${n}m`;const i=Math.floor(n/60),o=n%60;return o>0?`${i}h ${o}m`:`${i}h`}function UD(s){if(s==null)return"";if(s<1)return"Next up";if(s<60)return`~${s}m`;const e=Math.floor(s/60),n=s%60;return n>0?`~${e}h ${n}m`:`~${e}h`}function BD({shopId:s,services:e,staff:n,bookings:i}){const[o,u]=N.useState([]),[d,p]=N.useState(!1),[g,x]=N.useState(!1),[y,_]=N.useState(!1),[S,C]=N.useState({clientName:"",serviceId:"",staffId:"",estimatedDuration:30});N.useEffect(()=>{if(!s)return;const O=Wt(Je(Ne,"shops",s,"walkins"),I=>{const K=I.docs.map(fe=>({id:fe.id,...fe.data()}));u(K)});return()=>O()},[s]);const H=N.useMemo(()=>o.filter(O=>O.status==="waiting").sort((O,I)=>(O.position||0)-(I.position||0)),[o]),B=N.useMemo(()=>o.filter(O=>O.status==="in-progress").sort((O,I)=>{const K=O.startedAt?.toDate?.()?.getTime()||0,fe=I.startedAt?.toDate?.()?.getTime()||0;return K-fe}),[o]),P=N.useMemo(()=>{const O=new Date;return O.setHours(0,0,0,0),O},[]),q=N.useMemo(()=>o.filter(O=>{if(O.status!=="completed"&&O.status!=="no-show")return!1;const I=O.completedAt?.toDate?.()||(O.completedAt?new Date(O.completedAt):null);return I?I>=P:!1}).sort((O,I)=>{const K=O.completedAt?.toDate?.()?.getTime()||0;return(I.completedAt?.toDate?.()?.getTime()||0)-K}),[o,P]),Y=N.useMemo(()=>Math.max(n.filter(O=>O.active!==!1).length,1),[n]),W=N.useMemo(()=>PD(i,3),[i]),xe=N.useMemo(()=>k2({waitingQueue:H,inProgress:B,staffCount:Y,upcomingBookings:W,defaultDuration:30}),[H,B,Y,W]),me=N.useMemo(()=>{const O=q.filter(K=>K.status==="completed"&&K.joinedAt&&K.startedAt).map(K=>{const fe=K.joinedAt?.toDate?.()||new Date(K.joinedAt),Se=K.startedAt?.toDate?.()||new Date(K.startedAt);return Math.floor((Se.getTime()-fe.getTime())/6e4)}).filter(K=>K>=0),I=O.length>0?Math.round(O.reduce((K,fe)=>K+fe,0)/O.length):0;return{waiting:H.length,avgWait:I,completedToday:q.filter(K=>K.status==="completed").length}},[H,q]),re=O=>{const I=e.find(K=>K.id===O);C(K=>({...K,serviceId:O,estimatedDuration:I?.duration||30}))},j=()=>H.length===0?1:Math.max(...H.map(O=>O.position||0))+1,T=N.useMemo(()=>o.filter(O=>{const I=O.joinedAt?.toDate?.()||(O.joinedAt?new Date(O.joinedAt):null);return I&&I>=P}).length,[o,P]),k=async O=>{O.preventDefault(),_(!0);const I=e.find(we=>we.id===S.serviceId),K=n.find(we=>we.id===S.staffId),fe=j(),Se=S.clientName.trim()||`Walk-in #${T+1}`;try{await fi(Je(Ne,"shops",s,"walkins"),{clientName:Se,serviceId:S.serviceId||null,serviceName:I?.name||null,staffId:S.staffId||null,staffName:K?.name||null,estimatedDuration:parseInt(S.estimatedDuration)||30,status:"waiting",position:fe,joinedAt:Tt.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),C({clientName:"",serviceId:"",staffId:"",estimatedDuration:30}),p(!1)}catch(we){console.error("Error adding walk-in:",we)}finally{_(!1)}},L=async O=>{try{await st(Qe(Ne,"shops",s,"walkins",O),{status:"in-progress",startedAt:Tt.now()});const I=H.filter(K=>K.id!==O).sort((K,fe)=>(K.position||0)-(fe.position||0));for(let K=0;K<I.length;K++)await st(Qe(Ne,"shops",s,"walkins",I[K].id),{position:K+1})}catch(I){console.error("Error starting service:",I)}},M=async O=>{try{await st(Qe(Ne,"shops",s,"walkins",O),{status:"completed",completedAt:Tt.now()})}catch(I){console.error("Error completing service:",I)}},z=async O=>{try{await st(Qe(Ne,"shops",s,"walkins",O),{status:"no-show",completedAt:Tt.now()});const I=H.filter(K=>K.id!==O).sort((K,fe)=>(K.position||0)-(fe.position||0));for(let K=0;K<I.length;K++)await st(Qe(Ne,"shops",s,"walkins",I[K].id),{position:K+1})}catch(I){console.error("Error marking no-show:",I)}},D=async O=>{const I=H.findIndex(Se=>Se.id===O);if(I<=0)return;const K=H[I-1],fe=H[I];try{await st(Qe(Ne,"shops",s,"walkins",fe.id),{position:K.position}),await st(Qe(Ne,"shops",s,"walkins",K.id),{position:fe.position})}catch(Se){console.error("Error reordering:",Se)}},F=async O=>{const I=H.findIndex(Se=>Se.id===O);if(I<0||I>=H.length-1)return;const K=H[I+1],fe=H[I];try{await st(Qe(Ne,"shops",s,"walkins",fe.id),{position:K.position}),await st(Qe(Ne,"shops",s,"walkins",K.id),{position:fe.position})}catch(Se){console.error("Error reordering:",Se)}};return r.jsxs("div",{className:"animate-fade-in",children:[r.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[{label:"Currently Waiting",value:me.waiting,icon:Xt,color:"bg-blue-100 text-blue-600"},{label:"Avg Wait",value:me.avgWait>0?`${me.avgWait}m`:"",icon:S2,color:"bg-amber-100 text-amber-600"},{label:"Completed Today",value:me.completedToday,icon:R0,color:"bg-emerald-100 text-emerald-600"}].map(O=>{const I=O.icon;return r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:`w-10 h-10 ${O.color} rounded-xl flex items-center justify-center`,children:r.jsx(I,{className:"w-5 h-5"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:O.value}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:O.label})]},O.label)})}),W.length>0&&r.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(rl,{className:"w-4 h-4 text-amber-600"}),r.jsx("span",{className:"text-sm font-bold text-amber-800",children:"Upcoming Online Bookings"})]}),r.jsx("div",{className:"space-y-1",children:W.slice(0,5).map(O=>{const[I,K]=(O.time||"").split(":"),fe=parseInt(I),Se=`${fe%12||12}:${K} ${fe>=12?"PM":"AM"}`;return r.jsxs("div",{className:"text-xs text-amber-700 flex items-center gap-2",children:[r.jsx(jn,{className:"w-3 h-3"}),r.jsx("span",{className:"font-medium",children:Se}),r.jsx("span",{children:""}),r.jsx("span",{children:O.clientName}),O.serviceName&&r.jsxs("span",{className:"text-amber-500",children:["(",O.serviceName,")"]}),O.staffName&&r.jsxs("span",{className:"text-violet-600",children:["with ",O.staffName]})]},O.id)})})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Walk-in Queue"}),!d&&r.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[r.jsx(fr,{className:"w-4 h-4"}),"Add Walk-in"]})]}),d&&r.jsxs("form",{onSubmit:k,className:"mb-5 p-4 bg-slate-50 border border-slate-200 rounded-xl",children:[r.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3",children:"New Walk-in"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Client Name"}),r.jsx("input",{type:"text",value:S.clientName,onChange:O=>C(I=>({...I,clientName:O.target.value})),placeholder:`Walk-in #${T+1}`,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Service"}),r.jsxs("select",{value:S.serviceId,onChange:O=>re(O.target.value),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[r.jsx("option",{value:"",children:"No service selected"}),e.map(O=>r.jsxs("option",{value:O.id,children:[O.name," (",O.duration,"min)"]},O.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Staff Preference"}),r.jsxs("select",{value:S.staffId,onChange:O=>C(I=>({...I,staffId:O.target.value})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[r.jsx("option",{value:"",children:"Next available"}),n.map(O=>r.jsx("option",{value:O.id,children:O.name},O.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Est. Duration (min)"}),r.jsx("select",{value:S.estimatedDuration,onChange:O=>C(I=>({...I,estimatedDuration:parseInt(O.target.value)})),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[15,30,45,60,90,120].map(O=>r.jsx("option",{value:O,children:O<60?`${O} min`:`${O/60}h${O%60?` ${O%60}m`:""}`},O))})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{type:"submit",disabled:y,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[r.jsx(fr,{className:"w-4 h-4"}),y?"Adding":"Add to Queue"]}),r.jsx("button",{type:"button",onClick:()=>{p(!1),C({clientName:"",serviceId:"",staffId:"",estimatedDuration:30})},className:"px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Cancel"})]})]}),H.length===0&&B.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Xt,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No walk-ins in queue"}),r.jsx("p",{className:"text-xs text-slate-400",children:"Add a walk-in client to start the queue."})]}):r.jsxs(r.Fragment,{children:[H.length>0&&r.jsxs("div",{className:"mb-5",children:[r.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[r.jsx(jn,{className:"w-4 h-4 text-blue-500"}),"Waiting",r.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:H.length})]}),r.jsx("div",{className:"space-y-2",children:H.map((O,I)=>{const K=xe.get(O.id);return r.jsxs("div",{className:"group flex items-center gap-3 border border-slate-200 rounded-xl p-3.5 hover:border-slate-300 hover:shadow-sm transition-all",children:[r.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[r.jsx("button",{onClick:()=>D(O.id),disabled:I===0,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:r.jsx(fg,{className:"w-4 h-4"})}),r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center font-bold text-blue-700 text-sm",children:I+1}),r.jsx("button",{onClick:()=>F(O.id),disabled:I===H.length-1,className:"p-0.5 text-slate-400 hover:text-slate-700 disabled:opacity-20 disabled:cursor-not-allowed transition-all",children:r.jsx(hg,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:O.clientName}),r.jsx("span",{className:"px-2 py-0.5 bg-blue-50 text-blue-600 border border-blue-200 text-[10px] font-bold rounded-md",children:"WAITING"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[O.serviceName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(is,{className:"w-3 h-3 text-blue-400"}),O.serviceName]}),O.staffName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(ll,{className:"w-3 h-3 text-violet-400"}),O.staffName]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(jn,{className:"w-3 h-3"}),O.estimatedDuration||30,"min"]})]})]}),r.jsxs("div",{className:"text-right mr-2",children:[r.jsx("div",{className:"text-sm font-bold text-amber-600",children:UD(K)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"est. wait"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsxs("button",{onClick:()=>L(O.id),className:"flex items-center gap-1 px-3 py-2 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 border border-emerald-200 rounded-lg text-xs font-semibold transition-all",title:"Start Service",children:[r.jsx(Dp,{className:"w-3.5 h-3.5"}),r.jsx("span",{className:"hidden sm:inline",children:"Start"})]}),r.jsxs("button",{onClick:()=>z(O.id),className:"flex items-center gap-1 px-3 py-2 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded-lg text-xs font-semibold transition-all",title:"No-show",children:[r.jsx(_a,{className:"w-3.5 h-3.5"}),r.jsx("span",{className:"hidden sm:inline",children:"No-show"})]})]})]},O.id)})})]}),B.length>0&&r.jsxs("div",{className:"mb-5",children:[r.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[r.jsx(Dp,{className:"w-4 h-4 text-emerald-500"}),"In Progress",r.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 border border-emerald-200 text-xs font-bold rounded-full",children:B.length})]}),r.jsx("div",{className:"space-y-2",children:B.map(O=>r.jsxs("div",{className:"flex items-center gap-3 border border-emerald-200 bg-emerald-50/50 rounded-xl p-3.5 transition-all",children:[r.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center",children:r.jsx(Dp,{className:"w-4 h-4 text-emerald-600"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:O.clientName}),r.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 text-[10px] font-bold rounded-md",children:"IN PROGRESS"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-slate-500",children:[O.serviceName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(is,{className:"w-3 h-3 text-blue-400"}),O.serviceName]}),O.staffName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(ll,{className:"w-3 h-3 text-violet-400"}),O.staffName]})]})]}),r.jsxs("div",{className:"text-right mr-2",children:[r.jsx("div",{className:"text-sm font-bold text-emerald-600",children:LD(O.startedAt)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"elapsed"})]}),r.jsxs("button",{onClick:()=>M(O.id),className:"flex items-center gap-1 px-3 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 rounded-lg text-xs font-semibold transition-all",title:"Complete",children:[r.jsx(bs,{className:"w-3.5 h-3.5"}),r.jsx("span",{className:"hidden sm:inline",children:"Complete"})]})]},O.id))})]})]})]}),q.length>0&&r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("button",{onClick:()=>x(!g),className:"w-full flex items-center justify-between",children:[r.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[r.jsx(bs,{className:"w-4 h-4 text-slate-400"}),"Completed Today",r.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-500 border border-slate-200 text-xs font-bold rounded-full",children:q.length})]}),r.jsx(df,{className:`w-4 h-4 text-slate-400 transition-transform ${g?"rotate-90":""}`})]}),g&&r.jsx("div",{className:"mt-3 space-y-2",children:q.map(O=>r.jsxs("div",{className:"flex items-center gap-3 border border-slate-100 rounded-lg p-3 bg-slate-50/50",children:[r.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center bg-slate-100",children:O.status==="no-show"?r.jsx(_a,{className:"w-3.5 h-3.5 text-red-400"}):r.jsx(bs,{className:"w-3.5 h-3.5 text-emerald-400"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-medium text-slate-700 text-sm truncate",children:O.clientName}),r.jsx("span",{className:`text-[10px] font-bold rounded-md px-1.5 py-0.5 border ${O.status==="no-show"?"bg-red-50 text-red-600 border-red-200":"bg-emerald-50 text-emerald-600 border-emerald-200"}`,children:O.status==="no-show"?"NO-SHOW":"COMPLETED"})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[O.serviceName&&r.jsx("span",{children:O.serviceName}),O.staffName&&r.jsxs("span",{children:[" ",O.staffName]})]})]})]},O.id))})]})]})}function zD(s,e){const n=new Date(s+"T12:00:00"),i=e.getTime()-n.getTime();return Math.floor(i/864e5)}function Xd(s){return`$${Number(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function kc(s){return s?new Date(s+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function qD(s,e,n){return s>90?"lost":s>n?"at-risk":s>e?"getting-cold":"active"}const Jd={active:{label:"Active",bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200",icon:C0,iconColor:"text-emerald-500"},"getting-cold":{label:"Getting Cold",bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",icon:E2,iconColor:"text-amber-500"},"at-risk":{label:"At Risk",bg:"bg-orange-50",text:"text-orange-700",border:"border-orange-200",icon:rl,iconColor:"text-orange-500"},lost:{label:"Lost",bg:"bg-red-50",text:"text-red-700",border:"border-red-200",icon:m3,iconColor:"text-red-500"}};function FD({shopId:s,bookings:e,shop:n,slug:i}){const[o,u]=N.useState({}),[d,p]=N.useState(null),[g,x]=N.useState(null),[y,_]=N.useState(""),[S,C]=N.useState(""),[H,B]=N.useState("all"),[P,q]=N.useState("lastVisit"),[Y,W]=N.useState("asc"),[xe,me]=N.useState(null),[re,j]=N.useState(!1),[T,k]=N.useState(null),[L,M]=N.useState(!1),[z,D]=N.useState(null),F=n?.winbackSettings?.warningDays||30,O=n?.winbackSettings?.inactiveDays||60,I=n?.winbackSettings?.enabled!==!1,K=J=>J.toLowerCase().replace(/\./g,"_dot_").replace(/@/g,"_at_");N.useEffect(()=>{if(!s)return;const J=Wt(Je(Ne,"shops",s,"clientNotes"),ve=>{const Ve={};ve.docs.forEach(Pe=>{Ve[Pe.id]=Pe.data()}),u(Ve)});return()=>J()},[s]);const fe=N.useMemo(()=>new Date,[]),Se=N.useMemo(()=>e.filter(J=>J.status==="confirmed"||J.status==="pending"||!J.status),[e]),we=N.useMemo(()=>{const J={};return Se.forEach(ve=>{const Ve=ve.clientEmail?.toLowerCase();if(!Ve)return;J[Ve]||(J[Ve]={email:Ve,name:ve.clientName||Ve,phone:ve.clientPhone||"",totalVisits:0,totalSpent:0,lastVisitDate:null,firstVisitDate:null,bookings:[],serviceFrequency:{},staffFrequency:{}});const Pe=J[Ve];ve.clientName&&(Pe.name=ve.clientName),ve.clientPhone&&(Pe.phone=ve.clientPhone),Pe.totalVisits++,Pe.totalSpent+=Number(ve.servicePrice)||0,Pe.bookings.push(ve),(!Pe.lastVisitDate||ve.date>Pe.lastVisitDate)&&(Pe.lastVisitDate=ve.date),(!Pe.firstVisitDate||ve.date<Pe.firstVisitDate)&&(Pe.firstVisitDate=ve.date),ve.serviceName&&(Pe.serviceFrequency[ve.serviceName]=(Pe.serviceFrequency[ve.serviceName]||0)+1),ve.staffName&&(Pe.staffFrequency[ve.staffName]=(Pe.staffFrequency[ve.staffName]||0)+1)}),Object.values(J).map(ve=>{const Ve=ve.lastVisitDate?zD(ve.lastVisitDate,fe):999,Pe=qD(Ve,F,O),qe=Object.entries(ve.serviceFrequency).sort((je,Be)=>Be[1]-je[1])[0]?.[0]||null,gt=Object.entries(ve.staffFrequency).sort((je,Be)=>Be[1]-je[1])[0]?.[0]||null,qn=ve.totalVisits>0?ve.totalSpent/ve.totalVisits:0,xn=K(ve.email),vt=o[xn];return{...ve,daysSinceLastVisit:Ve,status:Pe,favoriteService:qe,favoriteStaff:gt,avgSpending:qn,encodedEmail:xn,notes:vt?.notes||"",contacted:vt?.contacted||!1,contactedAt:vt?.contactedAt||null,tags:vt?.tags||[]}})},[Se,fe,F,O,o]),V=N.useMemo(()=>{const J={all:we.length,active:0,"getting-cold":0,"at-risk":0,lost:0};return we.forEach(ve=>{J[ve.status]++}),J},[we]),ne=N.useMemo(()=>we.filter(J=>(J.status==="at-risk"||J.status==="lost")&&!J.contacted),[we]),le=N.useMemo(()=>{let J=we;if(S.trim()){const ve=S.toLowerCase();J=J.filter(Ve=>Ve.name.toLowerCase().includes(ve)||Ve.email.includes(ve)||Ve.phone.includes(ve))}return H!=="all"&&(J=J.filter(ve=>ve.status===H)),J=[...J].sort((ve,Ve)=>{if(P==="lastVisit"){const Pe=(ve.lastVisitDate||"").localeCompare(Ve.lastVisitDate||"");return Y==="asc"?Pe:-Pe}return P==="totalVisits"?Y==="desc"?Ve.totalVisits-ve.totalVisits:ve.totalVisits-Ve.totalVisits:P==="totalSpent"?Y==="desc"?Ve.totalSpent-ve.totalSpent:ve.totalSpent-Ve.totalSpent:0}),J},[we,S,H,P,Y]),_e=J=>{P===J?W(ve=>ve==="asc"?"desc":"asc"):(q(J),W(J==="lastVisit"?"asc":"desc"))},ye=N.useCallback(J=>{const ve=n?.name||"our shop",Ve=`${window.location.origin}${window.location.pathname}#/shop/${i}`;return`Hi ${J.name.split(" ")[0]}, we miss you at ${ve}! It's been ${J.daysSinceLastVisit} days since your last visit.${J.favoriteService?` Book your next ${J.favoriteService} today:`:" Book your next appointment:"} ${Ve}`},[n,i]),Ie=J=>{const ve=ye(J);k({email:J.email,encodedEmail:J.encodedEmail,name:J.name,message:ve})},ue=async(J,ve)=>{try{await navigator.clipboard.writeText(J),me(ve),setTimeout(()=>me(null),2e3)}catch(Ve){console.error("Failed to copy:",Ve)}},ze=async J=>{D(J);try{const ve=Qe(Ne,"shops",s,"clientNotes",J),Ve=await jp(ve),Pe=Ve.exists()?Ve.data():{};await Ap(ve,{...Pe,contacted:!0,contactedAt:new Date().toISOString()}),k(null)}catch(ve){console.error("Error marking as contacted:",ve)}finally{D(null)}},Ue=async J=>{try{const ve=Qe(Ne,"shops",s,"clientNotes",J),Ve=await jp(ve),Pe=Ve.exists()?Ve.data():{};await Ap(ve,{...Pe,contacted:!1,contactedAt:null})}catch(ve){console.error("Error resetting contacted status:",ve)}},Ge=async J=>{M(!0);try{const ve=Qe(Ne,"shops",s,"clientNotes",J),Ve=await jp(ve),Pe=Ve.exists()?Ve.data():{};await Ap(ve,{...Pe,notes:y}),x(null)}catch(ve){console.error("Error saving notes:",ve)}finally{M(!1)}};return r.jsxs("div",{className:"animate-fade-in space-y-6",children:[I&&ne.length>0&&r.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-5",children:[r.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>j(!re),children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:r.jsx(rl,{className:"w-5 h-5 text-orange-600"})}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-base font-bold text-slate-900",children:[ne.length," client",ne.length!==1?"s":""," need",ne.length===1?"s":""," attention"]}),r.jsxs("p",{className:"text-xs text-slate-500",children:["Haven't visited in over ",O," days  send a win-back message to re-engage"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"px-2.5 py-1 bg-orange-100 text-orange-700 border border-orange-200 text-xs font-bold rounded-lg",children:ne.length}),re?r.jsx(fg,{className:"w-5 h-5 text-slate-400"}):r.jsx(hg,{className:"w-5 h-5 text-slate-400"})]})]}),re&&r.jsx("div",{className:"mt-4 space-y-2.5",children:ne.sort((J,ve)=>ve.daysSinceLastVisit-J.daysSinceLastVisit).map(J=>r.jsxs("div",{className:"bg-white rounded-xl border border-orange-100 p-4 flex items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[r.jsx("div",{className:"w-9 h-9 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(ll,{className:"w-4 h-4 text-orange-600"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:J.name}),r.jsxs("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Jd[J.status].bg} ${Jd[J.status].text} ${Jd[J.status].border}`,children:[J.daysSinceLastVisit," days ago"]})]}),r.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 flex-wrap mt-0.5",children:[r.jsxs("span",{children:["Last: ",kc(J.lastVisitDate)]}),J.favoriteService&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-slate-300",children:""}),r.jsxs("span",{className:"text-blue-600",children:["Loves ",J.favoriteService]})]}),r.jsx("span",{className:"text-slate-300",children:""}),r.jsxs("span",{children:[J.totalVisits," visit",J.totalVisits!==1?"s":""]})]})]})]}),r.jsxs("button",{onClick:ve=>{ve.stopPropagation(),Ie(J)},className:"flex items-center gap-1.5 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-xl text-xs font-semibold transition-all shadow-sm flex-shrink-0",children:[r.jsx(dh,{className:"w-3.5 h-3.5"}),"Send Win-back"]})]},J.email))})]}),T&&r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 animate-scale-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:r.jsx(C3,{className:"w-5 h-5 text-orange-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Win-back Message"}),r.jsxs("p",{className:"text-sm text-slate-500",children:["Send to ",T.name]})]})]}),r.jsx("div",{className:"bg-slate-50 rounded-xl p-4 mb-4 border border-slate-200",children:r.jsx("textarea",{value:T.message,onChange:J=>k({...T,message:J.target.value}),rows:4,className:"w-full bg-transparent text-sm text-slate-700 resize-none focus:outline-none leading-relaxed"})}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{ue(T.message,T.email)},className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:xe===T.email?r.jsxs(r.Fragment,{children:[r.jsx(ar,{className:"w-4 h-4"}),"Copied!"]}):r.jsxs(r.Fragment,{children:[r.jsx(o3,{className:"w-4 h-4"}),"Copy to Clipboard"]})}),r.jsxs("button",{onClick:()=>ze(T.encodedEmail),disabled:z===T.encodedEmail,className:"flex items-center justify-center gap-2 px-5 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-emerald-600/20 disabled:opacity-50",children:[r.jsx(ar,{className:"w-4 h-4"}),"Mark Contacted"]}),r.jsx("button",{onClick:()=>k(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Close"})]})]})}),r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Clients",value:V.all,icon:Xt,color:"bg-blue-100 text-blue-600"},{label:"Active",value:V.active,icon:C0,color:"bg-emerald-100 text-emerald-600"},{label:"Getting Cold",value:V["getting-cold"],icon:E2,color:"bg-amber-100 text-amber-600"},{label:"At Risk / Lost",value:V["at-risk"]+V.lost,icon:rl,color:"bg-red-100 text-red-600"}].map(J=>{const ve=J.icon;return r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:`w-10 h-10 ${J.color} rounded-xl flex items-center justify-center`,children:r.jsx(ve,{className:"w-5 h-5"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:J.value}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:J.label})]},J.label)})}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"All Clients"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Derived from booking history"})]}),r.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[le.length," client",le.length!==1?"s":""]})]}),r.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[r.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[r.jsx(F3,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2"}),r.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:S,onChange:J=>C(J.target.value),className:"w-full pl-10 pr-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"}),S&&r.jsx("button",{onClick:()=>C(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:r.jsx(ka,{className:"w-4 h-4 text-slate-400 hover:text-slate-600"})})]}),r.jsx("div",{className:"flex items-center gap-1 p-1 bg-slate-100 rounded-xl overflow-x-auto",children:[{key:"all",label:"All"},{key:"active",label:"Active"},{key:"getting-cold",label:"Cold"},{key:"at-risk",label:"At Risk"},{key:"lost",label:"Lost"}].map(J=>r.jsxs("button",{onClick:()=>B(J.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap ${H===J.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[J.label,r.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${H===J.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:V[J.key]??0})]},J.key))}),r.jsx("div",{className:"flex items-center gap-1",children:[{key:"lastVisit",label:"Last Visit"},{key:"totalVisits",label:"Visits"},{key:"totalSpent",label:"Spent"}].map(J=>r.jsxs("button",{onClick:()=>_e(J.key),className:`flex items-center gap-1 px-3 py-2 rounded-lg text-xs font-semibold transition-all border ${P===J.key?"bg-blue-50 text-blue-700 border-blue-200":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[J.label,P===J.key&&r.jsx(U6,{className:"w-3 h-3"})]},J.key))})]}),le.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Xt,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No clients found"}),r.jsx("p",{className:"text-xs text-slate-400",children:S?"Try a different search term":"Client data will appear as bookings come in"})]}):r.jsx("div",{className:"space-y-2",children:le.map(J=>{const ve=d===J.email,Ve=Jd[J.status],Pe=Ve.icon;return r.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden hover:border-slate-300 transition-all",children:[r.jsxs("div",{className:"flex items-center gap-3 p-4 cursor-pointer hover:bg-slate-50/50 transition-all",onClick:()=>p(ve?null:J.email),children:[r.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(ll,{className:"w-4 h-4 text-blue-600"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm truncate",children:J.name}),r.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-bold rounded-md border ${Ve.bg} ${Ve.text} ${Ve.border}`,children:[r.jsx(Pe,{className:"w-3 h-3"}),Ve.label]}),J.contacted&&r.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",children:[r.jsx(dh,{className:"w-2.5 h-2.5"}),"Contacted"]}),J.notes&&r.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-violet-50 text-violet-600 border-violet-200",children:r.jsx(Zw,{className:"w-2.5 h-2.5"})})]}),r.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-3 mt-0.5 flex-wrap",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(pg,{className:"w-3 h-3"}),J.email]}),J.phone&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(gg,{className:"w-3 h-3"}),J.phone]})]})]}),r.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-shrink-0",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900",children:J.totalVisits}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-sm font-bold text-blue-600",children:Xd(J.totalSpent)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-sm font-bold text-slate-700",children:kc(J.lastVisitDate)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),r.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(J.status==="at-risk"||J.status==="lost")&&!J.contacted&&r.jsx("button",{onClick:qe=>{qe.stopPropagation(),Ie(J)},className:"p-2 text-orange-500 hover:text-orange-700 hover:bg-orange-50 rounded-lg transition-all",title:"Send win-back message",children:r.jsx(dh,{className:"w-4 h-4"})}),ve?r.jsx(fg,{className:"w-4 h-4 text-slate-400"}):r.jsx(hg,{className:"w-4 h-4 text-slate-400"})]})]}),ve&&r.jsxs("div",{className:"border-t border-slate-200 bg-slate-50/50 p-5 space-y-5",children:[r.jsxs("div",{className:"sm:hidden grid grid-cols-3 gap-3",children:[r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[r.jsx("div",{className:"text-lg font-bold text-slate-900",children:J.totalVisits}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"visits"})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[r.jsx("div",{className:"text-lg font-bold text-blue-600",children:Xd(J.totalSpent)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"spent"})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3 text-center",children:[r.jsx("div",{className:"text-sm font-bold text-slate-700",children:kc(J.lastVisitDate)}),r.jsx("div",{className:"text-[10px] text-slate-400",children:"last visit"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Avg per Visit"}),r.jsx("div",{className:"text-sm font-bold text-slate-900",children:Xd(J.avgSpending)})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"First Visit"}),r.jsx("div",{className:"text-sm font-bold text-slate-900",children:kc(J.firstVisitDate)})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Days Since Last Visit"}),r.jsxs("div",{className:"text-sm font-bold text-slate-900",children:[J.daysSinceLastVisit,"d"]})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-3",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Favorite Service"}),r.jsx("div",{className:"text-sm font-bold text-blue-600 truncate",children:J.favoriteService||""})]})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[r.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[r.jsx(is,{className:"w-3.5 h-3.5 text-blue-500"}),"Services Used"]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(J.serviceFrequency).sort((qe,gt)=>gt[1]-qe[1]).map(([qe,gt])=>r.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg text-xs font-medium",children:[qe,r.jsxs("span",{className:"bg-blue-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[gt,""]})]},qe))})]}),Object.keys(J.staffFrequency).length>0&&r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[r.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[r.jsx(Xt,{className:"w-3.5 h-3.5 text-violet-500"}),"Staff Members Seen"]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(J.staffFrequency).sort((qe,gt)=>gt[1]-qe[1]).map(([qe,gt])=>r.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-violet-50 text-violet-700 border border-violet-200 rounded-lg text-xs font-medium",children:[qe,r.jsxs("span",{className:"bg-violet-100 px-1.5 py-0.5 rounded text-[10px] font-bold",children:[gt,""]})]},qe))})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[r.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5",children:[r.jsx(Vt,{className:"w-3.5 h-3.5 text-emerald-500"}),"Booking History",r.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",J.bookings.length,")"]})]}),r.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:J.bookings.sort((qe,gt)=>(gt.date+gt.time).localeCompare(qe.date+qe.time)).map((qe,gt)=>r.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded-lg hover:bg-slate-50 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-medium text-slate-700",children:kc(qe.date)}),r.jsx("span",{className:"text-slate-400",children:qe.time}),qe.serviceName&&r.jsx("span",{className:"text-blue-600",children:qe.serviceName})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[qe.staffName&&r.jsx("span",{className:"text-violet-600",children:qe.staffName}),qe.servicePrice!=null&&r.jsx("span",{className:"font-semibold text-slate-900",children:Xd(qe.servicePrice)})]})]},gt))})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-slate-100 p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("h4",{className:"text-sm font-bold text-slate-700 flex items-center gap-1.5",children:[r.jsx(Zw,{className:"w-3.5 h-3.5 text-amber-500"}),"Notes"]}),g!==J.encodedEmail&&r.jsx("button",{onClick:()=>{x(J.encodedEmail),_(J.notes||"")},className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:J.notes?"Edit":"Add Notes"})]}),g===J.encodedEmail?r.jsxs("div",{className:"space-y-2",children:[r.jsx("textarea",{value:y,onChange:qe=>_(qe.target.value),placeholder:"Add notes about this client (e.g., preferences, allergies, favorite styles...)",rows:3,className:"w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>Ge(J.encodedEmail),disabled:L,className:"px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-semibold transition-all disabled:opacity-50",children:L?"Saving...":"Save"}),r.jsx("button",{onClick:()=>x(null),className:"px-4 py-1.5 bg-white hover:bg-slate-50 text-slate-600 border border-slate-200 rounded-lg text-xs font-semibold transition-all",children:"Cancel"})]})]}):r.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:J.notes||'No notes yet. Click "Add Notes" to save preferences, allergies, or anything useful.'})]}),J.contacted&&r.jsxs("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg px-4 py-3",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[r.jsx(ar,{className:"w-4 h-4"}),r.jsxs("span",{className:"font-medium",children:["Contacted",J.contactedAt?` on ${new Date(J.contactedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`:""]})]}),r.jsx("button",{onClick:()=>Ue(J.encodedEmail),className:"text-xs text-blue-600 hover:text-blue-800 font-semibold",children:"Reset"})]})]})]},J.email)})})]})]})}const HD=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function Vp(s){const[e,n]=s.split(":").map(Number);return e*60+n}function $D(s,e){if(s.status!=="waiting"||s.serviceId&&e.serviceId&&s.serviceId!==e.serviceId||s.staffId&&s.staffId!=="any"&&e.staffId&&s.staffId!==e.staffId)return!1;if(e.date){if(s.preferredDate&&s.preferredDate!==e.date)return!1;if(s.preferredDays&&s.preferredDays.length>0){const n=new Date(e.date+"T12:00:00"),i=HD[n.getDay()];if(!s.preferredDays.includes(i))return!1}}if(e.time&&s.preferredTimeRange){const n=Vp(e.time),i=Vp(s.preferredTimeRange.start),o=Vp(s.preferredTimeRange.end);if(!(s.preferredTimeRange.start==="00:00"&&s.preferredTimeRange.end==="23:59")&&(n<i||n>o))return!1}return!0}function GD(s,e){return s.filter(n=>$D(n,e)).sort((n,i)=>(n.createdAt||"").localeCompare(i.createdAt||""))}const l_=[{key:"monday",short:"Mon"},{key:"tuesday",short:"Tue"},{key:"wednesday",short:"Wed"},{key:"thursday",short:"Thu"},{key:"friday",short:"Fri"},{key:"saturday",short:"Sat"},{key:"sunday",short:"Sun"}];function Gr(s){if(!s)return"";const[e,n]=s.split(":").map(Number),i=e>=12?"PM":"AM",o=e%12||12;return n===0?`${o}${i}`:`${o}:${n.toString().padStart(2,"0")}${i}`}function YD({user:s}){const{slug:e}=No(),n=_o(),[i,o]=N.useState(null),[u,d]=N.useState(null),[p,g]=N.useState(!0),[x,y]=N.useState(!1),[_,S]=N.useState([]),[C,H]=N.useState([]),[B,P]=N.useState([]),[q,Y]=N.useState([]),[W,xe]=N.useState("schedule"),[me,re]=N.useState(null),[j,T]=N.useState("all"),[k,L]=N.useState("all"),[M,z]=N.useState([]),[D,F]=N.useState(null),[O,I]=N.useState(null),[K,fe]=N.useState({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""});N.useEffect(()=>{if(!s){n(`/shop/${e}/login`,{replace:!0});return}(async()=>{g(!0);try{const G=ys(Je(Ne,"shops"),ss("slug","==",e)),de=await vs(G);if(de.empty){y(!0),g(!1);return}const ce=de.docs[0],Me=ce.data();if(Me.ownerUid!==s.uid){y(!0),g(!1);return}o(Me),d(ce.id)}catch(G){console.error("Error checking ownership:",G),y(!0)}finally{g(!1)}})()},[s,e,n]),N.useEffect(()=>{if(!u)return;const R=Wt(Je(Ne,"shops",u,"availability"),Te=>{const Ce=Te.docs.map(Re=>({id:Re.id,...Re.data()}));S(Ce)}),G=Wt(Je(Ne,"shops",u,"bookings"),Te=>{const Ce=Te.docs.map(Re=>({id:Re.id,...Re.data()}));H(Ce)}),de=Wt(Je(Ne,"shops",u,"staff"),Te=>{const Ce=Te.docs.map(Re=>({id:Re.id,...Re.data()})).filter(Re=>Re.active!==!1).sort((Re,rt)=>(Re.name||"").localeCompare(rt.name||""));P(Ce)}),ce=Wt(Je(Ne,"shops",u,"waitlist"),Te=>{const Ce=Te.docs.map(Re=>({id:Re.id,...Re.data()})).sort((Re,rt)=>(Re.createdAt||"").localeCompare(rt.createdAt||""));z(Ce)}),Me=Wt(Je(Ne,"shops",u,"services"),Te=>{const Ce=Te.docs.map(Re=>({id:Re.id,...Re.data()})).filter(Re=>Re.active!==!1).sort((Re,rt)=>(Re.name||"").localeCompare(rt.name||""));Y(Ce)});return()=>{R(),G(),de(),ce(),Me()}},[u]);const Se=async()=>{await D5(il),n(`/shop/${e}`,{replace:!0})},we=async R=>{R.preventDefault();const{date:G,startTime:de,endTime:ce,slotDuration:Me,staffId:Te}=K,Ce=parseInt(Me),[Re,rt]=de.split(":").map(Number),[ot,$t]=ce.split(":").map(Number),Gt=Re*60+rt,Fn=ot*60+$t;let na=Gt;for(;na+Ce<=Fn;){const wn=Math.floor(na/60),Hn=na%60,_n=`${wn.toString().padStart(2,"0")}:${Hn.toString().padStart(2,"0")}`,sa={date:G,time:_n,duration:Ce,available:!0};if(Te){const Us=B.find(Va=>Va.id===Te);sa.staffId=Te,sa.staffName=Us?.name||""}await fi(Je(Ne,"shops",u,"availability"),sa),na+=Ce}fe({date:"",startTime:"09:00",endTime:"17:00",slotDuration:"60",staffId:""})},V=async R=>{await hI(Qe(Ne,"shops",u,"availability",R))},ne=R=>{const G={date:R.date,time:R.time,staffId:R.staffId||null,serviceId:R.serviceId||null},de=GD(M,G);de.length>0&&F({matches:de,slot:G})},le=async(R,G)=>{for(const de of R)await st(Qe(Ne,"shops",u,"waitlist",de.id),{status:"notified",notifiedAt:new Date().toISOString(),notifiedSlot:{date:G.date,time:G.time,staffId:G.staffId||null,staffName:G.staffName||null}});F(null)},_e=async R=>{await st(Qe(Ne,"shops",u,"waitlist",R),{status:"notified",notifiedAt:new Date().toISOString()})},ye=async R=>{await st(Qe(Ne,"shops",u,"waitlist",R),{status:"expired"})},Ie=async R=>{const G=C.find(de=>de.id===R);if(G&&G.recurringGroupId){I({bookingId:R,recurringGroupId:G.recurringGroupId});return}if(await st(Qe(Ne,"shops",u,"bookings",R),{status:"cancelled"}),G&&G.slotId&&!G.slotId.startsWith("wh-")&&!G.slotId.startsWith("recurring-"))try{await st(Qe(Ne,"shops",u,"availability",G.slotId),{available:!0})}catch(de){console.warn("Could not re-open slot:",de)}G&&ne(G)},ue=async R=>{const G=C.find(de=>de.id===R);if(await st(Qe(Ne,"shops",u,"bookings",R),{status:"cancelled"}),G&&G.slotId&&!G.slotId.startsWith("wh-")&&!G.slotId.startsWith("recurring-"))try{await st(Qe(Ne,"shops",u,"availability",G.slotId),{available:!0})}catch(de){console.warn("Could not re-open slot:",de)}G&&ne(G),I(null)},ze=async(R,G)=>{const de=C.find(Me=>Me.id===R);if(!de)return;const ce=C.filter(Me=>Me.recurringGroupId===G&&Me.date>=de.date&&(Me.status==="pending"||Me.status==="confirmed"));for(const Me of ce)if(await st(Qe(Ne,"shops",u,"bookings",Me.id),{status:"cancelled"}),Me.slotId&&!Me.slotId.startsWith("wh-")&&!Me.slotId.startsWith("recurring-"))try{await st(Qe(Ne,"shops",u,"availability",Me.slotId),{available:!0})}catch(Te){console.warn("Could not re-open slot:",Te)}de&&ne(de),I(null)},Ue=async R=>{await st(Qe(Ne,"shops",u,"bookings",R),{status:"confirmed"})},Ge=async R=>{const G=C.find(de=>de.id===R);if(await st(Qe(Ne,"shops",u,"bookings",R),{status:"rejected"}),G&&G.slotId&&!G.slotId.startsWith("wh-"))try{await st(Qe(Ne,"shops",u,"availability",G.slotId),{available:!0})}catch(de){console.warn("Could not re-open slot:",de)}G&&ne(G)},J=async()=>{const R=!i?.requireApproval;try{await st(Qe(Ne,"shops",u),{requireApproval:R}),o(G=>({...G,requireApproval:R}))}catch(G){console.error("Error updating requireApproval:",G)}},ve=async R=>{const G=parseInt(R);try{await st(Qe(Ne,"shops",u),{bufferMinutes:G}),o(de=>({...de,bufferMinutes:G}))}catch(de){console.error("Error updating buffer minutes:",de)}},Ve=(R,G)=>new Date(`${R}T${G}`).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),Pe=N.useMemo(()=>{const R={},G=j==="all"?B:B.filter(ce=>ce.id===j),de=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(const ce of G)ce.weeklyHours&&de.forEach((Me,Te)=>{ce.weeklyHours[Me]?.enabled&&(R[Te]=!0)});return R},[B,j]),qe=N.useMemo(()=>(j==="all"?B:B.filter(G=>G.id===j)).filter(G=>G.weeklyHours?l_.some(de=>G.weeklyHours[de.key]?.enabled):!1),[B,j]),gt=N.useMemo(()=>{const R=new Date,G=`${R.getFullYear()}-${String(R.getMonth()+1).padStart(2,"0")}-${String(R.getDate()).padStart(2,"0")}`,de=R.getDay(),ce=de===0?-6:1-de,Me=new Date(R);Me.setDate(R.getDate()+ce),Me.setHours(0,0,0,0);const Te=new Date(Me);Te.setDate(Me.getDate()+6),Te.setHours(23,59,59,999);const Ce=`${Me.getFullYear()}-${String(Me.getMonth()+1).padStart(2,"0")}-${String(Me.getDate()).padStart(2,"0")}`,Re=`${Te.getFullYear()}-${String(Te.getMonth()+1).padStart(2,"0")}-${String(Te.getDate()).padStart(2,"0")}`,rt=C.filter(Gt=>Gt.date===G).length,ot=C.filter(Gt=>Gt.date>=Ce&&Gt.date<=Re).length,$t=new Set(C.map(Gt=>Gt.clientEmail?.toLowerCase()).filter(Boolean)).size;return{todayBookings:rt,weekBookings:ot,uniqueClients:$t,totalBookings:C.length}},[C]),qn=N.useMemo(()=>C.filter(R=>R.status==="pending").length,[C]),xn=N.useMemo(()=>M.filter(R=>R.status==="waiting").length,[M]),[vt,je]=N.useState(0),[Be,it]=N.useState({}),Lt=N.useMemo(()=>{if(!i)return 0;i?.winbackSettings?.warningDays;const R=i?.winbackSettings?.inactiveDays||60;if(!(i?.winbackSettings?.enabled!==!1))return 0;const de=new Date,ce=C.filter(Re=>Re.status==="confirmed"||Re.status==="pending"||!Re.status),Me={};ce.forEach(Re=>{const rt=Re.clientEmail?.toLowerCase();rt&&(!Me[rt]||Re.date>Me[rt])&&(Me[rt]=Re.date)});let Te=0;const Ce=Re=>Re.replace(/\./g,"_dot_").replace(/@/g,"_at_");return Object.entries(Me).forEach(([Re,rt])=>{if(Math.floor((de.getTime()-new Date(rt+"T12:00:00").getTime())/864e5)>R){const $t=Ce(Re);Be[$t]?.contacted||Te++}}),Te},[C,i,Be]);if(N.useEffect(()=>{if(!u)return;const R=Wt(Je(Ne,"shops",u,"clientNotes"),G=>{const de={};G.docs.forEach(ce=>{de[ce.id]=ce.data()}),it(de)});return()=>R()},[u]),N.useEffect(()=>{if(!u)return;const R=Wt(Je(Ne,"shops",u,"walkins"),G=>{const de=G.docs.filter(ce=>ce.data().status==="waiting").length;je(de)});return()=>R()},[u]),p)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading dashboard"})]})});if(x)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(v2,{className:"w-8 h-8 text-red-500"})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Unauthorized"}),r.jsx("p",{className:"text-slate-600 mb-6",children:"You don't have access to this dashboard."}),r.jsx(et,{to:`/shop/${e}/login`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:"Login"})]})});const xt=j==="all"?_:_.filter(R=>R.staffId===j),lt=j==="all"?C:C.filter(R=>R.staffId===j),rn=xt.reduce((R,G)=>(R[G.date]||(R[G.date]=[]),R[G.date].push(G),R),{}),wt=lt.reduce((R,G)=>(R[G.date]||(R[G.date]=[]),R[G.date].push(G),R),{}),_s=me?Object.keys(rn).filter(R=>R===me).sort():Object.keys(rn).sort(),bn=me?lt.filter(R=>R.date===me):lt,Vn=k==="all"?bn:k==="pending"?bn.filter(R=>R.status==="pending"):k==="confirmed"?bn.filter(R=>!R.status||R.status==="confirmed"):bn.filter(R=>R.status==="cancelled"||R.status==="rejected"),Ls={all:bn.length,pending:bn.filter(R=>R.status==="pending").length,confirmed:bn.filter(R=>!R.status||R.status==="confirmed").length,cancelled:bn.filter(R=>R.status==="cancelled"||R.status==="rejected").length},Oa=[{key:"schedule",label:"Schedule",icon:Vt},{key:"clients",label:"Clients",icon:C0},{key:"walkins",label:"Walk-ins",icon:aD},{key:"analytics",label:"Analytics",icon:W6},{key:"waitlist",label:"Waitlist",icon:mg},{key:"staff",label:"Staff",icon:Xt},{key:"services",label:"Services",icon:is},{key:"settings",label:"Settings",icon:G3}];return r.jsxs("div",{className:"min-h-screen bg-slate-50",children:[r.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(i.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{className:"hidden sm:block",children:[r.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:i.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Dashboard"})]})]}),r.jsx("div",{className:"flex items-center bg-slate-100 p-1 rounded-xl",children:Oa.map(R=>{const G=R.icon;return r.jsxs("button",{onClick:()=>xe(R.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-semibold transition-all ${W===R.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[r.jsx(G,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:R.label}),R.key==="schedule"&&qn>0&&r.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-amber-500 text-white text-[10px] font-bold rounded-full leading-none",children:qn}),R.key==="clients"&&Lt>0&&r.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-orange-500 text-white text-[10px] font-bold rounded-full leading-none",children:Lt}),R.key==="walkins"&&vt>0&&r.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-emerald-500 text-white text-[10px] font-bold rounded-full leading-none",children:vt}),R.key==="waitlist"&&xn>0&&r.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-blue-500 text-white text-[10px] font-bold rounded-full leading-none",children:xn})]},R.key)})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(et,{to:`/shop/${e}`,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-lg transition-all border border-transparent hover:border-slate-200",children:[r.jsx(h3,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"View Page"})]}),r.jsxs("button",{onClick:Se,className:"flex items-center gap-1.5 px-3.5 py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",children:[r.jsx(S3,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[W==="schedule"&&r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8 animate-fade-in",children:[{label:"Today's Bookings",value:gt.todayBookings,icon:Xw,color:"bg-blue-100 text-blue-600"},{label:"This Week",value:gt.weekBookings,icon:R0,color:"bg-violet-100 text-violet-600"},{label:"Total Bookings",value:gt.totalBookings,icon:b2,color:"bg-emerald-100 text-emerald-600"},{label:"Unique Clients",value:gt.uniqueClients,icon:Xt,color:"bg-amber-100 text-amber-600"}].map(R=>{const G=R.icon;return r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 hover:shadow-md transition-all",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:r.jsx("div",{className:`w-10 h-10 ${R.color} rounded-xl flex items-center justify-center`,children:r.jsx(G,{className:"w-5 h-5"})})}),r.jsx("div",{className:"text-2xl font-extrabold text-slate-900",children:R.value}),r.jsx("div",{className:"text-xs font-medium text-slate-500 mt-0.5",children:R.label})]},R.label)})}),W==="clients"&&r.jsx(FD,{shopId:u,bookings:C,shop:i,slug:e}),W==="walkins"&&r.jsx(BD,{shopId:u,services:q,staff:B,bookings:C}),W==="analytics"&&r.jsx(VD,{bookings:C}),W==="staff"&&r.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:r.jsx(MD,{shopId:u})}),W==="services"&&r.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 animate-fade-in",children:r.jsx(AD,{shopId:u})}),D&&r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:r.jsx(io,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Waitlist Match!"}),r.jsxs("p",{className:"text-sm text-slate-500",children:[D.matches.length," client",D.matches.length!==1?"s":""," on the waitlist match this freed slot"]})]})]}),r.jsx("div",{className:"bg-slate-50 rounded-xl p-3 mb-4 text-sm",children:r.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[r.jsx(Vt,{className:"w-4 h-4 text-blue-500"}),r.jsxs("span",{className:"font-medium",children:[new Date(D.slot.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})," at ",(()=>{const[R,G]=D.slot.time.split(":"),de=parseInt(R);return`${de%12||12}:${G} ${de>=12?"PM":"AM"}`})()]})]})}),r.jsx("div",{className:"space-y-2 mb-5 max-h-48 overflow-y-auto",children:D.matches.map(R=>r.jsx("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-50 border border-blue-100 rounded-lg",children:r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:R.clientName}),r.jsx("span",{className:"text-xs text-slate-500 ml-2",children:R.serviceName})]})},R.id))}),r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("button",{onClick:()=>le(D.matches,D.slot),className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm transition-all shadow-md shadow-blue-600/20",children:[r.jsx(io,{className:"w-4 h-4"}),"Notify All"]}),r.jsx("button",{onClick:()=>F(null),className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Dismiss"})]})]})}),O&&r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-scale-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center",children:r.jsx(ir,{className:"w-5 h-5 text-red-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Cancel Recurring Booking"}),r.jsx("p",{className:"text-sm text-slate-500",children:"This booking is part of a recurring series"})]})]}),r.jsxs("div",{className:"space-y-2 mb-5",children:[r.jsxs("button",{onClick:()=>ue(O.bookingId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[r.jsx(_a,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this one only"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments stay active"})]})]}),r.jsxs("button",{onClick:()=>ze(O.bookingId,O.recurringGroupId),className:"w-full flex items-center gap-3 p-3 bg-slate-50 hover:bg-red-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[r.jsx(ir,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future in series"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments"})]})]})]}),r.jsx("button",{onClick:()=>I(null),className:"w-full px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Never mind"})]})}),W==="waitlist"&&r.jsx("div",{className:"animate-fade-in",children:r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-5",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Waitlist"}),xn>0&&r.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 border border-blue-200 text-xs font-bold rounded-full",children:[xn," waiting"]})]}),r.jsxs("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:[M.length," total"]})]}),M.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(mg,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:"No waitlist entries yet"}),r.jsx("p",{className:"text-xs text-slate-400",children:"Clients can join the waitlist when no slots are available on your booking page."})]}):r.jsx("div",{children:(()=>{const R={};return M.forEach(G=>{const de=G.serviceName||"Other";R[de]||(R[de]=[]),R[de].push(G)}),Object.entries(R).sort(([G],[de])=>G.localeCompare(de)).map(([G,de])=>r.jsxs("div",{className:"mb-6 last:mb-0",children:[r.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100 flex items-center gap-2",children:[r.jsx(is,{className:"w-3.5 h-3.5 text-blue-500"}),G,r.jsxs("span",{className:"text-xs font-medium text-slate-400",children:["(",de.filter(ce=>ce.status==="waiting").length," waiting)"]})]}),r.jsx("div",{className:"space-y-2.5",children:de.sort((ce,Me)=>(ce.createdAt||"").localeCompare(Me.createdAt||"")).map(ce=>{const Me={waiting:"bg-blue-50 text-blue-700 border-blue-200",notified:"bg-emerald-50 text-emerald-700 border-emerald-200",booked:"bg-emerald-50 text-emerald-700 border-emerald-200",expired:"bg-slate-100 text-slate-500 border-slate-200"},Te={waiting:"Waiting",notified:"Notified",booked:"Booked",expired:"Removed"},Ce=ce.createdAt?(()=>{const rt=Date.now()-new Date(ce.createdAt).getTime(),ot=Math.floor(rt/864e5),$t=Math.floor(rt/36e5);return ot>0?`${ot}d`:`${$t}h`})():"",Re={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return r.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(ll,{className:"w-4 h-4 text-blue-600"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:ce.clientName}),r.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${Me[ce.status]||Me.waiting}`,children:Te[ce.status]||"Waiting"})]}),r.jsxs("div",{className:"text-xs text-slate-500",children:["Joined ",Ce," ago",ce.refCode&&r.jsx("span",{className:"font-mono text-slate-400 ml-2",children:ce.refCode})]})]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[ce.status==="waiting"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>_e(ce.id),className:"p-1.5 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-all",title:"Notify client",children:r.jsx(io,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>ye(ce.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove from waitlist",children:r.jsx(ka,{className:"w-4 h-4"})})]}),ce.status==="notified"&&r.jsx("button",{onClick:()=>ye(ce.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Remove",children:r.jsx(ka,{className:"w-3.5 h-3.5"})})]})]}),r.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[ce.staffName&&ce.staffName!=="Any Available"&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Xt,{className:"w-3 h-3 text-violet-400"}),r.jsx("span",{className:"text-violet-600",children:ce.staffName})]}),ce.preferredDate&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Vt,{className:"w-3 h-3 text-slate-400"}),r.jsxs("span",{children:["Preferred: ",new Date(ce.preferredDate+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]})]}),ce.preferredDays&&ce.preferredDays.length>0&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Vt,{className:"w-3 h-3 text-slate-400"}),r.jsxs("span",{children:["Days: ",ce.preferredDays.map(rt=>Re[rt]||rt).join(", ")]})]}),ce.preferredTimeRange&&!(ce.preferredTimeRange.start==="00:00"&&ce.preferredTimeRange.end==="23:59")&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(jn,{className:"w-3 h-3 text-slate-400"}),r.jsxs("span",{children:["Time: ",Gr(ce.preferredTimeRange.start),"",Gr(ce.preferredTimeRange.end)]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(pg,{className:"w-3 h-3"}),ce.clientEmail]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(gg,{className:"w-3 h-3"}),ce.clientPhone]})]}),ce.status==="notified"&&ce.notifiedSlot&&r.jsxs("div",{className:"mt-1.5 px-2.5 py-1.5 bg-emerald-50 border border-emerald-200 rounded-lg inline-flex items-center gap-1.5",children:[r.jsx(io,{className:"w-3 h-3 text-emerald-500"}),r.jsxs("span",{className:"text-emerald-700 font-medium",children:["Notified about ",new Date(ce.notifiedSlot.date+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})," at ",Gr(ce.notifiedSlot.time)]})]})]})]},ce.id)})})]},G))})()})]})}),W==="settings"&&r.jsxs("div",{className:"max-w-2xl animate-fade-in space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Shop Settings"}),r.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure your booking preferences"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsxs("div",{className:"pr-4",children:[r.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Require Booking Approval"}),r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Review and approve bookings before they're confirmed"})]}),r.jsx("button",{type:"button",onClick:J,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${i?.requireApproval?"bg-blue-500":"bg-slate-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${i?.requireApproval?"translate-x-6":"translate-x-1"}`})})]}),i?.requireApproval&&r.jsxs("div",{className:"p-3.5 bg-amber-50 border border-amber-200 rounded-xl text-xs text-amber-800 leading-relaxed",children:[r.jsx("strong",{children:" Approval mode is on."}),' New bookings will appear as "Pending" until you approve or reject them. Time slots are held while pending to prevent double-booking.']}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsxs("div",{className:"pr-4",children:[r.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Buffer Time Between Bookings"}),r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Add a gap between consecutive appointments"})]}),r.jsxs("select",{value:i?.bufferMinutes||0,onChange:R=>ve(R.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[r.jsx("option",{value:"0",children:"No buffer"}),r.jsx("option",{value:"5",children:"5 minutes"}),r.jsx("option",{value:"10",children:"10 minutes"}),r.jsx("option",{value:"15",children:"15 minutes"}),r.jsx("option",{value:"30",children:"30 minutes"})]})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Client Retention"}),r.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Configure win-back alerts to re-engage inactive clients"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsxs("div",{className:"pr-4",children:[r.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Enable Win-back Alerts"}),r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Show alerts when clients haven't visited in a while"})]}),r.jsx("button",{type:"button",onClick:async()=>{const R=i?.winbackSettings||{},G=R.enabled===!1;try{await st(Qe(Ne,"shops",u),{winbackSettings:{...R,enabled:G}}),o(de=>({...de,winbackSettings:{...de.winbackSettings||{},enabled:G}}))}catch(de){console.error("Error updating winback settings:",de)}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors flex-shrink-0 ${i?.winbackSettings?.enabled!==!1?"bg-blue-500":"bg-slate-300"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform ${i?.winbackSettings?.enabled!==!1?"translate-x-6":"translate-x-1"}`})})]}),i?.winbackSettings?.enabled!==!1&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsxs("div",{className:"pr-4",children:[r.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Getting Cold Threshold"}),r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "Getting Cold" after this many days without a booking'})]}),r.jsxs("select",{value:i?.winbackSettings?.warningDays||30,onChange:async R=>{const G=parseInt(R.target.value),de=i?.winbackSettings||{};try{await st(Qe(Ne,"shops",u),{winbackSettings:{...de,warningDays:G}}),o(ce=>({...ce,winbackSettings:{...ce.winbackSettings||{},warningDays:G}}))}catch(ce){console.error("Error updating warning days:",ce)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[r.jsx("option",{value:"14",children:"14 days"}),r.jsx("option",{value:"21",children:"21 days"}),r.jsx("option",{value:"30",children:"30 days"}),r.jsx("option",{value:"45",children:"45 days"}),r.jsx("option",{value:"60",children:"60 days"})]})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsxs("div",{className:"pr-4",children:[r.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"At Risk Threshold"}),r.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:'Flag clients as "At Risk" after this many days without a booking'})]}),r.jsxs("select",{value:i?.winbackSettings?.inactiveDays||60,onChange:async R=>{const G=parseInt(R.target.value),de=i?.winbackSettings||{};try{await st(Qe(Ne,"shops",u),{winbackSettings:{...de,inactiveDays:G}}),o(ce=>({...ce,winbackSettings:{...ce.winbackSettings||{},inactiveDays:G}}))}catch(ce){console.error("Error updating inactive days:",ce)}},className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium flex-shrink-0",children:[r.jsx("option",{value:"30",children:"30 days"}),r.jsx("option",{value:"45",children:"45 days"}),r.jsx("option",{value:"60",children:"60 days"}),r.jsx("option",{value:"90",children:"90 days"}),r.jsx("option",{value:"120",children:"120 days"})]})]}),r.jsxs("div",{className:"p-3.5 bg-orange-50 border border-orange-200 rounded-xl text-xs text-orange-800 leading-relaxed",children:[r.jsx("strong",{children:" Tip:"}),' Clients flagged as "Lost" (over 90 days) will also appear in win-back alerts. Visit the ',r.jsx("strong",{children:"Clients"})," tab to view at-risk clients and send win-back messages."]})]})]})]})]}),W==="schedule"&&r.jsxs("div",{className:"animate-fade-in",children:[B.length>0&&r.jsx("div",{className:"flex flex-wrap gap-4 mb-6",children:r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5",children:"Filter by Staff"}),r.jsxs("select",{value:j,onChange:R=>T(R.target.value),className:"px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm font-medium",children:[r.jsx("option",{value:"all",children:"All Staff"}),B.map(R=>r.jsxs("option",{value:R.id,children:[R.name,R.role?`  ${R.role}`:""]},R.id))]})]})}),qe.length>0&&r.jsxs("div",{className:"mb-6 bg-violet-50 border border-violet-200 rounded-xl p-5",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(N2,{className:"w-4 h-4 text-violet-600"}),r.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Recurring Weekly Hours"})]}),r.jsx("div",{className:"space-y-2.5",children:qe.map(R=>{const G=l_.filter(de=>R.weeklyHours[de.key]?.enabled);return r.jsxs("div",{className:"flex items-start gap-2.5",children:[r.jsx("div",{className:"w-7 h-7 bg-violet-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:r.jsx(Xt,{className:"w-3.5 h-3.5 text-violet-600"})}),r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-slate-900 text-sm",children:R.name}),r.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:G.map(de=>{const ce=R.weeklyHours[de.key];return r.jsxs("span",{className:"inline-block px-2 py-0.5 bg-white text-violet-700 border border-violet-200 rounded text-xs font-medium",children:[de.short," ",Gr(ce.start),"",Gr(ce.end),ce.break&&r.jsxs("span",{className:"text-amber-600 ml-1",children:["(break ",Gr(ce.break.start),"",Gr(ce.break.end),")"]})]},de.key)})})]})]},R.id)})}),r.jsx("p",{className:"text-xs text-violet-500 mt-3",children:"Slots auto-generate on the booking page. Manage hours in the Staff tab."})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5 mb-6",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-4",children:"Monthly Overview"}),r.jsx(TD,{slotsByDate:rn,bookingsByDate:wt,selectedDate:me,onSelectDate:re,recurringDayFlags:Pe}),me&&r.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[r.jsxs("span",{className:"text-sm text-slate-600",children:["Showing: ",r.jsx("strong",{className:"text-slate-900",children:new Date(me+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),r.jsx("button",{onClick:()=>re(null),className:"text-xs px-3 py-1 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-medium transition-all border border-slate-200",children:"Show All"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:qe.length>0?"Add Custom Slots":"Create Time Slots"}),qe.length>0&&r.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Use this for one-off availability outside regular hours."}),!qe.length&&r.jsx("div",{className:"mb-4"}),r.jsxs("form",{onSubmit:we,className:"space-y-4",children:[B.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Staff Member"}),r.jsxs("select",{value:K.staffId,onChange:R=>fe({...K,staffId:R.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[r.jsx("option",{value:"",children:"Select a staff member"}),B.map(R=>r.jsxs("option",{value:R.id,children:[R.name,R.role?`  ${R.role}`:""]},R.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Date"}),r.jsx("input",{type:"date",value:K.date,onChange:R=>fe({...K,date:R.target.value}),required:!0,min:new Date().toISOString().split("T")[0],className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Start"}),r.jsx("input",{type:"time",value:K.startTime,onChange:R=>fe({...K,startTime:R.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"End"}),r.jsx("input",{type:"time",value:K.endTime,onChange:R=>fe({...K,endTime:R.target.value}),required:!0,className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1.5",children:"Slot Duration"}),r.jsxs("select",{value:K.slotDuration,onChange:R=>fe({...K,slotDuration:R.target.value}),className:"w-full px-3.5 py-2.5 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",children:[r.jsx("option",{value:"15",children:"15 minutes"}),r.jsx("option",{value:"30",children:"30 minutes"}),r.jsx("option",{value:"45",children:"45 minutes"}),r.jsx("option",{value:"60",children:"1 hour"}),r.jsx("option",{value:"90",children:"1.5 hours"}),r.jsx("option",{value:"120",children:"2 hours"})]})]}),r.jsxs("button",{type:"submit",className:"w-full flex items-center justify-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold text-sm shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[r.jsx(fr,{className:"w-4 h-4"}),"Generate Slots"]})]}),r.jsxs("div",{className:"mt-4 p-3.5 bg-blue-50 border border-blue-100 rounded-xl text-xs text-slate-600 leading-relaxed",children:[r.jsx("strong",{className:"text-slate-700",children:" Tip:"})," ",qe.length>0?"Weekly hours auto-generate slots. Use this for one-off slots outside regular hours.":B.length>0?"Select a staff member, pick a date, and set working hours to create slots.":"Set your hours and slot duration. We'll create all the time slots for that day."]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:me?"Bookings":"All Bookings"}),Ls.pending>0&&r.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 border border-amber-200 text-xs font-bold rounded-full",children:[Ls.pending," pending"]})]}),r.jsx("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-lg",children:Vn.length})]}),r.jsx("div",{className:"flex items-center gap-1 mb-4 p-1 bg-slate-100 rounded-lg overflow-x-auto",children:[{key:"all",label:"All"},{key:"pending",label:"Pending"},{key:"confirmed",label:"Confirmed"},{key:"cancelled",label:"Cancelled"}].map(R=>r.jsxs("button",{onClick:()=>L(R.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-semibold transition-all whitespace-nowrap ${k===R.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[R.label,r.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] leading-none ${k===R.key?"bg-blue-100 text-blue-700":"bg-slate-200 text-slate-500"}`,children:Ls[R.key]})]},R.key))}),Vn.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Xw,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium",children:k!=="all"?`No ${k} bookings`:me?"No bookings for this date":"No bookings yet"})]}):r.jsx("div",{className:"space-y-2.5 max-h-[500px] overflow-y-auto pr-1",children:Vn.sort((R,G)=>`${R.date}${R.time}`.localeCompare(`${G.date}${G.time}`)).map(R=>{const G=R.status||"confirmed",de={pending:"bg-amber-50 text-amber-700 border-amber-200",confirmed:"bg-emerald-50 text-emerald-700 border-emerald-200",rejected:"bg-red-50 text-red-700 border-red-200",cancelled:"bg-slate-100 text-slate-500 border-slate-200"},ce={pending:"Pending",confirmed:"Confirmed",rejected:"Rejected",cancelled:"Cancelled"};return r.jsxs("div",{className:"group border border-slate-200 rounded-xl p-4 hover:border-slate-300 hover:shadow-sm transition-all",children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(ll,{className:"w-4 h-4 text-blue-600"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:R.clientName}),r.jsx("span",{className:`inline-block px-2 py-0.5 text-[10px] font-bold rounded-md border ${de[G]}`,children:ce[G]}),R.recurring&&r.jsx("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-bold rounded-md border bg-blue-50 text-blue-600 border-blue-200",title:"Recurring appointment",children:r.jsx(ir,{className:"w-2.5 h-2.5"})})]}),r.jsx("div",{className:"text-xs text-slate-500",children:Ve(R.date,R.time)})]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[G==="pending"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>Ue(R.id),className:"p-1.5 text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50 rounded-lg transition-all",title:"Approve booking",children:r.jsx(ar,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>Ge(R.id),className:"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Reject booking",children:r.jsx(_a,{className:"w-4 h-4"})})]}),G==="confirmed"&&r.jsx("button",{onClick:()=>Ie(R.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Cancel booking",children:r.jsx(au,{className:"w-3.5 h-3.5"})})]})]}),r.jsxs("div",{className:"ml-[46px] space-y-0.5 text-xs text-slate-500",children:[R.serviceName&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(is,{className:"w-3 h-3 text-blue-400"}),r.jsx("span",{className:"font-medium text-slate-700",children:R.serviceName}),R.servicePrice!=null&&r.jsxs("span",{className:"text-blue-600 font-semibold",children:["$",Number(R.servicePrice).toFixed(2)]})]}),R.staffName&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Xt,{className:"w-3 h-3 text-violet-400"}),r.jsx("span",{className:"text-violet-600",children:R.staffName})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(pg,{className:"w-3 h-3"}),R.clientEmail]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(gg,{className:"w-3 h-3"}),R.clientPhone]})]}),r.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[R.refCode&&r.jsxs("span",{className:"font-mono text-[10px] text-slate-400",children:["REF: ",R.refCode]}),R.recurring&&r.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-indigo-50 border border-indigo-200 rounded text-[10px] font-semibold text-indigo-600",children:" Recurring"})]})]})]},R.id)})})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("h2",{className:"text-lg font-bold text-slate-900",children:me?"Custom Time Slots":"All Custom Time Slots"}),r.jsx("span",{className:"text-xs font-semibold text-slate-500 bg-slate-100 px-2.5 py-1 rounded-lg",children:me?(rn[me]||[]).length:xt.length})]}),qe.length>0&&r.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Recurring slots from weekly hours auto-generate  not shown here."}),!qe.length&&r.jsx("div",{className:"mb-4"}),_s.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Vt,{className:"w-6 h-6 text-slate-400"})}),r.jsx("p",{className:"text-sm text-slate-500 font-medium mb-1",children:me?"No custom slots for this date":"No custom slots yet"}),r.jsx("p",{className:"text-xs text-slate-400",children:qe.length>0?"Recurring hours handle most scheduling.":"Use the form above to generate availability."})]}):r.jsx("div",{className:"space-y-6",children:_s.map(R=>r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3 pb-2 border-b border-slate-100",children:new Date(R).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-2.5",children:rn[R].sort((G,de)=>G.time.localeCompare(de.time)).map(G=>r.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-3.5 text-center group hover:border-slate-300 transition-all",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 mb-0.5",children:G.time}),r.jsxs("div",{className:"text-xs text-slate-500 mb-1",children:[G.duration," min"]}),G.staffName&&r.jsxs("div",{className:"text-xs text-violet-600 mb-1.5 flex items-center justify-center gap-1",children:[r.jsx(Xt,{className:"w-3 h-3"}),G.staffName]}),r.jsx("div",{className:"mb-2",children:G.available?r.jsx("span",{className:"inline-block px-2 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-md text-xs font-medium",children:"Available"}):r.jsx("span",{className:"inline-block px-2 py-0.5 bg-red-50 text-red-700 border border-red-200 rounded-md text-xs font-medium",children:"Booked"})}),G.available&&r.jsxs("button",{onClick:()=>V(G.id),className:"opacity-0 group-hover:opacity-100 flex items-center justify-center gap-1 w-full px-2 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-xs font-medium transition-all border border-red-200",children:[r.jsx(au,{className:"w-3 h-3"}),"Remove"]})]},G.id))})]},R))})]})]})]})]})}function KD({user:s}){const{slug:e}=No(),n=_o(),[i,o]=N.useState(""),[u,d]=N.useState(""),[p,g]=N.useState(""),[x,y]=N.useState(!1);N.useEffect(()=>{if(!s)return;(async()=>{const C=ys(Je(Ne,"shops"),ss("slug","==",e)),H=await vs(C);H.empty||H.docs[0].data().ownerUid===s.uid&&n(`/shop/${e}/dashboard`,{replace:!0})})()},[s,e,n]);const _=async S=>{S.preventDefault(),g(""),y(!0);try{const H=(await f1(il,i,u)).user,B=ys(Je(Ne,"shops"),ss("slug","==",e)),P=await vs(B);if(P.empty){g("Shop not found"),y(!1);return}if(P.docs[0].data().ownerUid!==H.uid){g("You are not the owner of this shop"),await il.signOut(),y(!1);return}n(`/shop/${e}/dashboard`,{replace:!0})}catch(C){switch(C.code){case"auth/invalid-credential":case"auth/wrong-password":case"auth/user-not-found":g("Invalid email or password");break;case"auth/invalid-email":g("Please enter a valid email address");break;case"auth/too-many-requests":g("Too many failed attempts. Please try again later.");break;default:g("Login failed. Please try again.")}d("")}finally{y(!1)}};return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"w-full max-w-md animate-fade-in-up",children:[r.jsx("div",{className:"text-center mb-8",children:r.jsxs(et,{to:"/",className:"inline-flex items-center gap-2.5",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-md shadow-blue-600/20",children:r.jsx(Da,{className:"w-5 h-5 text-white"})}),r.jsxs("span",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:["Book",r.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}),r.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg shadow-slate-200/50 border border-slate-200",children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Welcome back"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Sign in to manage your shop"})]}),r.jsxs("form",{onSubmit:_,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Email"}),r.jsx("input",{type:"email",value:i,onChange:S=>{o(S.target.value),g("")},placeholder:"you@example.com",required:!0,autoFocus:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Password"}),r.jsx("input",{type:"password",value:u,onChange:S=>{d(S.target.value),g("")},placeholder:"Enter password",required:!0,className:`w-full px-4 py-3 bg-white border rounded-xl focus:outline-none focus:ring-2 transition-all text-sm ${p?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-slate-200 focus:ring-blue-500 focus:border-transparent"}`}),p&&r.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[r.jsx("span",{children:""})," ",p]})]}),r.jsx("button",{type:"submit",disabled:x,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 text-sm",children:x?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Signing in"]}):"Sign In"})]}),r.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 text-center",children:r.jsxs("p",{className:"text-sm text-slate-500",children:["Don't have an account?"," ",r.jsx(et,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:"Create one"})]})})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs(et,{to:`/shop/${e}`,className:"inline-flex items-center gap-1.5 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[r.jsx(Ra,{className:"w-3.5 h-3.5"}),"Back to booking page"]})})]})})}function o_({name:s,className:e="w-12 h-12",bgClass:n="bg-blue-100 text-blue-700"}){const i=(s||"").split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return r.jsx("div",{className:`${e} ${n} rounded-full flex items-center justify-center font-bold text-sm select-none flex-shrink-0`,children:i||"?"})}function c_(){return r.jsxs(et,{to:"/",className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:r.jsx(Da,{className:"w-3.5 h-3.5 text-white"})}),r.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Book",r.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}function QD(){const{slug:s,refCode:e}=No(),[n,i]=N.useState(null),[o,u]=N.useState(null),[d,p]=N.useState(!0),[g,x]=N.useState(!1),[y,_]=N.useState(null),[S,C]=N.useState(null),[H,B]=N.useState(!1),[P,q]=N.useState([]),[Y,W]=N.useState([]),[xe,me]=N.useState([]),[re,j]=N.useState([]),[T,k]=N.useState(!1),[L,M]=N.useState(!1),[z,D]=N.useState(null),[F,O]=N.useState(null),[I,K]=N.useState(null),[fe,Se]=N.useState(!1),[we,V]=N.useState("");N.useEffect(()=>{(async()=>{p(!0);try{const Be=ys(Je(Ne,"shops"),ss("slug","==",s)),it=await vs(Be);if(it.empty)x(!0);else{const Lt=it.docs[0];i(Lt.data()),u(Lt.id)}}catch(Be){console.error("Error looking up shop:",Be),x(!0)}finally{p(!1)}})()},[s]),N.useEffect(()=>{if(!o)return;(async()=>{try{const Be=ys(Je(Ne,"shops",o,"bookings"),ss("refCode","==",e.toUpperCase())),it=await vs(Be);if(it.empty)B(!0);else{const Lt=it.docs[0];_(Lt.data()),C(Lt.id)}}catch(Be){console.error("Error looking up booking:",Be),B(!0)}})()},[o,e]),N.useEffect(()=>{if(!o||!y)return;const je=Wt(Je(Ne,"shops",o,"bookings"),xt=>{q(xt.docs.map(lt=>({id:lt.id,...lt.data()})))}),Be=Wt(Je(Ne,"shops",o,"availability"),xt=>{const lt=new Date,rn=xt.docs.map(wt=>({id:wt.id,...wt.data()})).filter(wt=>new Date(`${wt.date}T${wt.time}`)>lt);W(rn)}),it=Wt(Je(Ne,"shops",o,"staff"),xt=>{me(xt.docs.map(lt=>({id:lt.id,...lt.data()})).filter(lt=>lt.active!==!1).sort((lt,rn)=>(lt.name||"").localeCompare(rn.name||"")))}),Lt=Wt(Je(Ne,"shops",o,"services"),xt=>{j(xt.docs.map(lt=>({id:lt.id,...lt.data()})).filter(lt=>lt.active!==!1))});return()=>{je(),Be(),it(),Lt()}},[o,y]);const ne=n?.bufferMinutes||0,le=N.useMemo(()=>{if(!y)return null;if(y.serviceId){const je=re.find(Be=>Be.id===y.serviceId);if(je)return je}return y.serviceName?{id:y.serviceId,name:y.serviceName,price:y.servicePrice,duration:y.serviceDuration||y.duration}:null},[y,re]),_e=N.useMemo(()=>{if(!T||!y)return[];const je=new Date,Be=le?.duration||y.duration||60;let it=Y.filter(wt=>wt.available);it=it.filter(wt=>wt.duration>=Be),y.staffId&&(it=it.filter(wt=>wt.staffId===y.staffId||!wt.staffId));const Lt=y.staffId?xe.filter(wt=>wt.id===y.staffId):xe,xt=j2(Lt,Be,ne,4).filter(wt=>new Date(`${wt.date}T${wt.time}`)>je),lt=C2(xt,it),rn=P.filter(wt=>wt.id!==S);return A2(lt,rn,ne)},[T,y,S,Y,xe,P,ne,le]),ye=N.useMemo(()=>[...new Set(_e.map(je=>je.date))].sort(),[_e]),Ie=N.useMemo(()=>F?_e.filter(je=>je.date===F):[],[F,_e]),ue=async(je="single")=>{Se(!0);try{if(await st(Qe(Ne,"shops",o,"bookings",S),{status:"cancelled"}),y.slotId&&!y.slotId.startsWith("wh-")&&!y.slotId.startsWith("recurring-"))try{await st(Qe(Ne,"shops",o,"availability",y.slotId),{available:!0})}catch(Be){console.warn("Could not re-open slot:",Be)}if(je==="future"&&y.recurringGroupId){const Be=P.filter(it=>it.recurringGroupId===y.recurringGroupId&&it.id!==S&&it.date>=y.date&&(it.status==="pending"||it.status==="confirmed"));for(const it of Be)if(await st(Qe(Ne,"shops",o,"bookings",it.id),{status:"cancelled"}),it.slotId&&!it.slotId.startsWith("wh-")&&!it.slotId.startsWith("recurring-"))try{await st(Qe(Ne,"shops",o,"availability",it.slotId),{available:!0})}catch(Lt){console.warn("Could not re-open slot:",Lt)}}_(Be=>({...Be,status:"cancelled"})),M(!1),D(null),V("cancelled")}catch(Be){console.error("Cancel error:",Be),V("error")}finally{Se(!1)}},ze=async()=>{if(I){Se(!0);try{const je={date:I.date,time:I.time,slotId:I.id};if(I.staffId&&(je.staffId=I.staffId,je.staffName=I.staffName||""),n?.requireApproval&&(je.status="pending"),y.slotId&&!y.slotId.startsWith("wh-"))try{await st(Qe(Ne,"shops",o,"availability",y.slotId),{available:!0})}catch(Be){console.warn("Could not re-open old slot:",Be)}if(!I.generated&&I.id)try{await st(Qe(Ne,"shops",o,"availability",I.id),{available:!1})}catch(Be){console.warn("Could not block new slot:",Be)}await st(Qe(Ne,"shops",o,"bookings",S),je),_(Be=>({...Be,...je})),k(!1),O(null),K(null),V("rescheduled")}catch(je){console.error("Reschedule error:",je),V("error")}finally{Se(!1)}}},Ue=je=>new Date(je+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),Ge=je=>{const[Be,it]=je.split(":"),Lt=parseInt(Be),xt=Lt>=12?"PM":"AM";return`${Lt%12||12}:${it} ${xt}`},J=je=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(je),ve=je=>{if(!je)return"";if(je<60)return`${je} min`;const Be=Math.floor(je/60),it=je%60;return it?`${Be}h ${it}m`:`${Be} hour${Be>1?"s":""}`};if(d)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(g)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(Vt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),r.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,r.jsx("span",{className:"font-mono text-blue-600",children:s}),'".']}),r.jsxs(et,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Ra,{className:"w-4 h-4"}),"Go Home"]})]})});if(H)return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(n?.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:n?.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),r.jsx(c_,{})]})}),r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(rl,{className:"w-8 h-8 text-amber-500"})}),r.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Not Found"}),r.jsx("p",{className:"text-slate-600 mb-2",children:"No booking found with reference code"}),r.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),r.jsxs(et,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Vt,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!y)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading booking"})]})});const Ve=y.status||"confirmed",Pe=Ve==="pending"||Ve==="confirmed",qe=Ve==="cancelled",gt=Ve==="rejected",qn={pending:{label:"Pending Approval",color:"bg-amber-100 text-amber-700 border-amber-200",icon:jn},confirmed:{label:"Confirmed",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:bs},cancelled:{label:"Cancelled",color:"bg-slate-100 text-slate-500 border-slate-200",icon:_a},rejected:{label:"Rejected",color:"bg-red-100 text-red-700 border-red-200",icon:_a}},xn=qn[Ve]||qn.confirmed,vt=xn.icon;return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(n?.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:n?.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Manage Booking"})]})]}),r.jsx(c_,{})]})}),r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[we==="rescheduled"&&r.jsx("div",{className:"mb-6 animate-scale-in",children:r.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(w2,{className:"w-8 h-8 text-emerald-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Rescheduled!"}),r.jsx("p",{className:"text-slate-600 mb-4",children:n?.requireApproval?"Your booking has been rescheduled and is pending approval.":"Your booking has been successfully rescheduled."}),r.jsx("button",{onClick:()=>V(""),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View updated details "})]})}),we==="cancelled"&&r.jsx("div",{className:"mb-6 animate-scale-in",children:r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(_a,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Booking Cancelled"}),r.jsx("p",{className:"text-slate-600 mb-4",children:"Your booking has been cancelled."}),r.jsxs(et,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[r.jsx(Vt,{className:"w-4 h-4"}),"Book a new appointment"]})]})}),we==="error"&&r.jsx("div",{className:"mb-6 animate-scale-in",children:r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 flex items-center gap-3 text-red-800 font-medium",children:[r.jsx("span",{children:""}),r.jsx("span",{children:"Something went wrong. Please try again."})]})}),!T&&r.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Your Booking"}),r.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference: ",r.jsx("span",{className:"font-mono font-bold text-blue-600",children:(y.refCode||e).toUpperCase()})]})]}),(qe||gt)&&r.jsxs("div",{className:`mb-4 p-4 rounded-xl border flex items-center gap-3 ${qe?"bg-slate-50 border-slate-200":"bg-red-50 border-red-200"}`,children:[r.jsx(vt,{className:`w-5 h-5 ${qe?"text-slate-400":"text-red-500"}`}),r.jsx("span",{className:`font-medium text-sm ${qe?"text-slate-600":"text-red-700"}`,children:qe?"This booking has been cancelled.":"This booking has been rejected by the shop."})]}),y.recurringGroupId&&r.jsxs("div",{className:"mb-4 p-3.5 bg-blue-50 border border-blue-200 rounded-xl flex items-center gap-2.5",children:[r.jsx(ir,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-blue-800",children:"Part of a recurring series"}),y.recurringInterval&&r.jsxs("p",{className:"text-xs text-blue-600 mt-0.5",children:["Repeats every ",y.recurringInterval==="weekly"?"week":y.recurringInterval==="biweekly"?"2 weeks":y.recurringInterval==="fourweekly"?"4 weeks":y.recurringInterval==="monthly"?"month":y.recurringInterval]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 mb-6 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),r.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${xn.color}`,children:[r.jsx(vt,{className:"w-3.5 h-3.5"}),xn.label]})]}),y.serviceName&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(is,{className:"w-4 h-4 text-blue-600"})}),r.jsx("span",{className:"font-semibold text-slate-800",children:y.serviceName})]}),y.servicePrice!=null&&r.jsx("span",{className:"font-bold text-blue-600",children:J(y.servicePrice)})]}),y.staffName&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx(o_,{name:y.staffName,className:"w-8 h-8 text-xs",bgClass:"bg-violet-100 text-violet-700"}),r.jsx("span",{className:"font-semibold text-slate-800",children:y.staffName})]}),r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(Vt,{className:"w-4 h-4 text-slate-600"})}),r.jsxs("span",{className:"font-semibold text-slate-800",children:[Ue(y.date)," at ",Ge(y.time)]})]}),r.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-500",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(jn,{className:"w-4 h-4 text-slate-500"})}),r.jsx("span",{children:ve(y.serviceDuration||y.duration)})]})]}),Pe&&!we&&r.jsx("div",{className:"space-y-3",children:L?r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 animate-scale-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(rl,{className:"w-5 h-5 text-red-500"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-slate-900",children:"Are you sure?"}),r.jsx("p",{className:"text-sm text-slate-600",children:"This action cannot be undone."})]})]}),y.recurringGroupId&&!z&&r.jsxs("div",{className:"space-y-2 mb-4",children:[r.jsxs("button",{onClick:()=>D("single"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[r.jsx(_a,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel this appointment only"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Other appointments in the series remain active"})]})]}),r.jsxs("button",{onClick:()=>D("future"),className:"w-full flex items-center gap-3 p-3 bg-white hover:bg-slate-50 border border-slate-200 hover:border-red-300 rounded-xl text-left transition-all",children:[r.jsx(ir,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Cancel all future appointments"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Cancel this and all later appointments in the series"})]})]}),r.jsx("button",{onClick:()=>M(!1),className:"w-full px-5 py-2.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold text-sm transition-all border border-slate-200",children:"Go Back"})]}),(!y.recurringGroupId||z)&&r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("button",{onClick:()=>ue(z||"single"),disabled:fe,className:"flex-1 flex items-center justify-center gap-2 px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold transition-all disabled:opacity-50",children:[fe?r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}):r.jsx(_a,{className:"w-4 h-4"}),fe?"Cancelling":z==="future"?"Cancel All Future":"Yes, Cancel"]}),r.jsx("button",{onClick:()=>{z?D(null):M(!1)},disabled:fe,className:"px-5 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Go Back"})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>{k(!0),V("")},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[r.jsx(N2,{className:"w-4 h-4"}),"Reschedule Booking"]}),r.jsxs("button",{onClick:()=>{M(!0),D(null)},className:"w-full flex items-center justify-center gap-2 px-6 py-3.5 bg-white hover:bg-red-50 text-red-600 rounded-xl font-semibold border border-red-200 hover:border-red-300 transition-all",children:[r.jsx(_a,{className:"w-4 h-4"}),"Cancel Booking"]})]})}),(qe||gt)&&r.jsx("div",{className:"text-center",children:r.jsxs(et,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5",children:[r.jsx(Vt,{className:"w-4 h-4"}),"Book Again"]})})]}),T&&r.jsxs("div",{className:"animate-fade-in",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[r.jsxs("button",{onClick:()=>{k(!1),O(null),K(null)},className:"flex items-center gap-1.5 px-3.5 py-2 bg-white hover:bg-slate-50 text-slate-600 rounded-lg font-medium transition-all border border-slate-200 text-sm",children:[r.jsx(Ra,{className:"w-3.5 h-3.5"}),"Back to Booking"]}),y.serviceName&&r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[r.jsx(is,{className:"w-3.5 h-3.5 text-blue-500"}),r.jsx("span",{className:"font-semibold text-slate-800",children:y.serviceName}),y.servicePrice!=null&&r.jsx("span",{className:"text-blue-600 font-bold",children:J(y.servicePrice)})]}),y.staffName&&r.jsxs("div",{className:"flex items-center gap-2 px-3.5 py-2 bg-violet-50 border border-violet-200 rounded-lg text-sm",children:[r.jsx(o_,{name:y.staffName,className:"w-5 h-5 text-[10px]",bgClass:"bg-violet-200 text-violet-700"}),r.jsx("span",{className:"font-semibold text-slate-800",children:y.staffName})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Choose a New Time"}),r.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Pick a new date and time for your appointment"})]}),ye.length===0?r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:r.jsx(Vt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No available slots"}),r.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"No time slots are currently available. Check back soon!"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mb-8",children:r.jsx(T2,{availableDates:ye,selectedDate:F,onSelectDate:je=>{O(je),K(null)}})}),F&&r.jsxs("div",{className:"animate-slide-down",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900",children:["Times for ",Ue(F)]}),r.jsxs("span",{className:"text-sm text-slate-500 font-medium",children:[Ie.length," slot",Ie.length!==1?"s":""]})]}),Ie.length===0?r.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-8 text-center",children:r.jsx("p",{className:"text-slate-500",children:"No slots available for this date"})}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 stagger-children",children:Ie.sort((je,Be)=>je.time.localeCompare(Be.time)).map(je=>{const Be=I?.id===je.id;return r.jsxs("button",{onClick:()=>K(je),className:`group border rounded-xl p-4 transition-all duration-200 text-center ${Be?"bg-blue-600 border-blue-600 text-white shadow-md shadow-blue-600/30":"bg-white border-slate-200 hover:border-blue-400 hover:shadow-md hover:shadow-blue-100/50 hover:-translate-y-0.5"}`,children:[r.jsx("div",{className:`text-lg font-bold mb-1 ${Be?"text-white":"text-slate-900 group-hover:text-blue-700"} transition-colors`,children:Ge(je.time)}),je.staffName&&r.jsxs("div",{className:`text-xs mb-0.5 flex items-center justify-center gap-1 ${Be?"text-blue-100":"text-violet-600"}`,children:[r.jsx(Xt,{className:"w-3 h-3"}),je.staffName]}),r.jsx("div",{className:`text-xs ${Be?"text-blue-200":"text-slate-400"}`,children:ve(y.serviceDuration||y.duration)})]},je.id)})}),I&&r.jsxs("div",{className:"mt-6 animate-fade-in",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-blue-200 shadow-sm p-5 mb-4",children:[r.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"New Appointment Time"}),r.jsxs("div",{className:"flex items-center gap-2.5 text-sm",children:[r.jsx(Vt,{className:"w-4 h-4 text-blue-500"}),r.jsxs("span",{className:"font-semibold text-slate-800",children:[Ue(I.date)," at ",Ge(I.time)]})]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:ze,disabled:fe,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-md shadow-blue-600/20 hover:shadow-lg hover:shadow-blue-600/25 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed",children:fe?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner-sm border-white/30 border-t-white"}),"Rescheduling"]}):r.jsxs(r.Fragment,{children:[r.jsx(bs,{className:"w-4 h-4"}),"Confirm Reschedule"]})}),r.jsx("button",{onClick:()=>K(null),className:"px-5 py-3.5 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]})]}),!F&&r.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Select a date above to see available times"})]})]})]}),r.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:r.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",r.jsx(et,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"BookFlow"})]})})})]})}function u_(){return r.jsxs(et,{to:"/",className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:r.jsx(Da,{className:"w-3.5 h-3.5 text-white"})}),r.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Book",r.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}function WD(s){if(!s)return"Any time";const e=n=>{const[i,o]=n.split(":").map(Number),u=i>=12?"PM":"AM",d=i%12||12;return o===0?`${d}${u}`:`${d}:${o.toString().padStart(2,"0")}${u}`};return s.start==="00:00"&&s.end==="23:59"?"Any time":`${e(s.start)}  ${e(s.end)}`}function XD(s){if(!s||s.length===0)return"Any day";const e={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return s.map(n=>e[n]||n).join(", ")}function JD(s){if(!s)return"";const e=new Date,n=new Date(s),i=e-n,o=Math.floor(i/6e4);if(o<60)return`${o}m ago`;const u=Math.floor(o/60);return u<24?`${u}h ago`:`${Math.floor(u/24)}d ago`}function ZD(){const{slug:s,refCode:e}=No(),[n,i]=N.useState(null),[o,u]=N.useState(null),[d,p]=N.useState(!0),[g,x]=N.useState(!1),[y,_]=N.useState(null),[S,C]=N.useState(!1),[H,B]=N.useState(null);if(N.useEffect(()=>{(async()=>{p(!0);try{const re=ys(Je(Ne,"shops"),ss("slug","==",s)),j=await vs(re);if(j.empty)x(!0);else{const T=j.docs[0];i(T.data()),u(T.id)}}catch(re){console.error("Error looking up shop:",re),x(!0)}finally{p(!1)}})()},[s]),N.useEffect(()=>{if(!o)return;(async()=>{try{const re=ys(Je(Ne,"shops",o,"waitlist"),ss("refCode","==",e.toUpperCase())),j=await vs(re);if(j.empty){C(!0);return}const T=j.docs[0],k={id:T.id,...T.data()};_(k);const L=ys(Je(Ne,"shops",o,"waitlist"),ss("serviceId","==",k.serviceId),ss("status","==","waiting")),D=(await vs(L)).docs.map(F=>({id:F.id,...F.data()})).sort((F,O)=>(F.createdAt||"").localeCompare(O.createdAt||"")).findIndex(F=>F.id===k.id);D>=0&&B(D+1)}catch(re){console.error("Error looking up waitlist entry:",re),C(!0)}})()},[o,e]),d)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})});if(g)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(Vt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),r.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,r.jsx("span",{className:"font-mono text-blue-600",children:s}),'".']}),r.jsxs(et,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Ra,{className:"w-4 h-4"}),"Go Home"]})]})});if(S)return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(n?.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:n?.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),r.jsx(u_,{})]})}),r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-8",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md mx-auto animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(rl,{className:"w-8 h-8 text-amber-500"})}),r.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Waitlist Entry Not Found"}),r.jsx("p",{className:"text-slate-600 mb-2",children:"No waitlist entry found with reference code"}),r.jsx("p",{className:"font-mono text-lg font-bold text-blue-600 mb-6",children:e.toUpperCase()}),r.jsxs(et,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Vt,{className:"w-4 h-4"}),"Book an Appointment"]})]})})]});if(!y)return r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading waitlist"})]})});const P={waiting:{label:"Waiting",color:"bg-blue-100 text-blue-700 border-blue-200",icon:jn},notified:{label:"Slot Available!",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:io},booked:{label:"Booked",color:"bg-emerald-100 text-emerald-700 border-emerald-200",icon:bs},expired:{label:"Expired",color:"bg-slate-100 text-slate-500 border-slate-200",icon:jn}},q=P[y.status]||P.waiting,Y=q.icon,W=me=>me?new Date(me+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):"",xe=me=>{if(!me)return"";const[re,j]=me.split(":"),T=parseInt(re),k=T>=12?"PM":"AM";return`${T%12||12}:${j} ${k}`};return r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(n?.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:n?.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Waitlist Status"})]})]}),r.jsx(u_,{})]})}),r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:r.jsxs("div",{className:"max-w-lg mx-auto animate-fade-in",children:[y.status==="notified"&&r.jsx("div",{className:"mb-6 animate-scale-in",children:r.jsxs("div",{className:"bg-white rounded-2xl border border-emerald-200 shadow-lg shadow-emerald-100/50 p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(io,{className:"w-8 h-8 text-emerald-600"})}),r.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"A Slot Is Available!"}),r.jsxs("p",{className:"text-slate-600 mb-4",children:["A slot has opened up for ",y.serviceName,". Book now before it's taken!"]}),y.notifiedSlot&&r.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-xl text-sm text-emerald-700 font-medium mb-4",children:[r.jsx(Vt,{className:"w-4 h-4"}),W(y.notifiedSlot.date)," at"," ",xe(y.notifiedSlot.time),y.notifiedSlot.staffName&&r.jsxs("span",{className:"text-emerald-600",children:[" ","with ",y.notifiedSlot.staffName]})]}),r.jsx("div",{children:r.jsxs(et,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-emerald-600/20 hover:shadow-lg",children:[r.jsx(Vt,{className:"w-4 h-4"}),"Book Now "]})})]})}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Waitlist Status"}),r.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["Reference:"," ",r.jsx("span",{className:"font-mono font-bold text-blue-600",children:(y.refCode||e).toUpperCase()})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Status"}),r.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-lg border ${q.color}`,children:[r.jsx(Y,{className:"w-3.5 h-3.5"}),q.label]})]}),y.status==="waiting"&&H!=null&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Position"}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(mg,{className:"w-4 h-4 text-blue-500"}),r.jsxs("span",{className:"font-bold text-slate-900 text-lg",children:["#",H]}),r.jsx("span",{className:"text-sm text-slate-500",children:"in line"})]})]}),y.serviceName&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(is,{className:"w-4 h-4 text-blue-600"})}),r.jsx("span",{className:"font-semibold text-slate-800",children:y.serviceName})]}),y.staffName&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-violet-100 rounded-lg flex items-center justify-center",children:r.jsx(Xt,{className:"w-4 h-4 text-violet-600"})}),r.jsx("span",{className:"font-semibold text-slate-800",children:y.staffName})]}),y.preferredDate&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(Vt,{className:"w-4 h-4 text-slate-600"})}),r.jsxs("span",{className:"text-sm text-slate-700",children:["Preferred: ",W(y.preferredDate)]})]}),y.preferredDays&&y.preferredDays.length>0&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(Vt,{className:"w-4 h-4 text-slate-600"})}),r.jsxs("span",{className:"text-sm text-slate-700",children:["Days: ",XD(y.preferredDays)]})]}),y.preferredTimeRange&&r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-lg flex items-center justify-center",children:r.jsx(jn,{className:"w-4 h-4 text-slate-500"})}),r.jsxs("span",{className:"text-sm text-slate-700",children:["Time: ",WD(y.preferredTimeRange)]})]}),y.createdAt&&r.jsxs("div",{className:"pt-2 border-t border-slate-100 text-xs text-slate-400",children:["Joined ",JD(y.createdAt)]})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs(et,{to:`/shop/${s}`,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all shadow-md shadow-blue-600/20 hover:shadow-lg",children:[r.jsx(Vt,{className:"w-4 h-4"}),y.status==="notified"?"Book Now":"Check Available Slots"]})})]})}),r.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:r.jsx("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-center",children:r.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",r.jsx(et,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"BookFlow"})]})})})]})}function eM(){return r.jsxs(et,{to:"/",className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:r.jsx(Da,{className:"w-3.5 h-3.5 text-white"})}),r.jsxs("span",{className:"text-sm font-extrabold tracking-tight text-slate-900",children:["Book",r.jsx("span",{className:"text-blue-600",children:"Flow"})]})]})}function d_(s){if(s==null)return"";if(s<1)return"Next up!";if(s<60)return`~${s} min`;const e=Math.floor(s/60),n=s%60;return n>0?`~${e}h ${n}m`:`~${e}h`}function tM(){const{slug:s}=No(),[e,n]=N.useState(null),[i,o]=N.useState(null),[u,d]=N.useState(!0),[p,g]=N.useState(!1),[x,y]=N.useState([]),[_,S]=N.useState([]),[C,H]=N.useState([]),[B,P]=N.useState(!1),[q,Y]=N.useState(!1),[W,xe]=N.useState(!1),[me,re]=N.useState(""),[j,T]=N.useState(0),[k,L]=N.useState({clientName:"",serviceId:""}),[M,z]=N.useState(Date.now());N.useEffect(()=>{const we=setInterval(()=>z(Date.now()),3e4);return()=>clearInterval(we)},[]),N.useEffect(()=>{(async()=>{d(!0);try{const V=ys(Je(Ne,"shops"),ss("slug","==",s)),ne=await vs(V);if(ne.empty)g(!0);else{const le=ne.docs[0];n(le.data()),o(le.id)}}catch(V){console.error("Error looking up shop:",V),g(!0)}finally{d(!1)}})()},[s]),N.useEffect(()=>{if(!i)return;const we=Wt(Je(Ne,"shops",i,"walkins"),le=>{const _e=le.docs.map(ye=>({id:ye.id,...ye.data()}));y(_e)}),V=Wt(Je(Ne,"shops",i,"staff"),le=>{const _e=le.docs.map(ye=>({id:ye.id,...ye.data()})).filter(ye=>ye.active!==!1);S(_e)}),ne=Wt(Je(Ne,"shops",i,"services"),le=>{const _e=le.docs.map(ye=>({id:ye.id,...ye.data()})).filter(ye=>ye.active!==!1).sort((ye,Ie)=>(ye.name||"").localeCompare(Ie.name||""));H(_e)});return()=>{we(),V(),ne()}},[i]);const D=N.useMemo(()=>x.filter(we=>we.status==="waiting").sort((we,V)=>(we.position||0)-(V.position||0)),[x]),F=N.useMemo(()=>x.filter(we=>we.status==="in-progress"),[x]),O=N.useMemo(()=>Math.max(_.length,1),[_]),I=N.useMemo(()=>k2({waitingQueue:D,inProgress:F,staffCount:O,defaultDuration:30}),[D,F,O]),K=N.useMemo(()=>R2({waitingAhead:D,inProgress:F,staffCount:O,defaultDuration:30}),[D,F,O]),fe=N.useMemo(()=>{const we=new Date;return we.setHours(0,0,0,0),x.filter(V=>{const ne=V.joinedAt?.toDate?.()||(V.joinedAt?new Date(V.joinedAt):null);return ne&&ne>=we}).length},[x]),Se=async we=>{we.preventDefault(),Y(!0);const V=C.find(ye=>ye.id===k.serviceId),le=(D.length>0?Math.max(...D.map(ye=>ye.position||0)):0)+1,_e=k.clientName.trim()||`Walk-in #${fe+1}`;try{await fi(Je(Ne,"shops",i,"walkins"),{clientName:_e,serviceId:k.serviceId||null,serviceName:V?.name||null,staffId:null,staffName:null,estimatedDuration:V?.duration||30,status:"waiting",position:le,joinedAt:Tt.now(),startedAt:null,completedAt:null,estimatedWaitMinutes:null}),re(_e),T(le),xe(!0),P(!1),L({clientName:"",serviceId:""})}catch(ye){console.error("Error joining queue:",ye)}finally{Y(!1)}};return u?r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):p?r.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-5",children:r.jsxs("div",{className:"bg-white rounded-2xl p-10 shadow-lg border border-slate-200 text-center max-w-md w-full animate-scale-in",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5",children:r.jsx(Vt,{className:"w-8 h-8 text-slate-400"})}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Shop Not Found"}),r.jsxs("p",{className:"text-slate-600 mb-6",children:[`We couldn't find a shop with the URL "`,r.jsx("span",{className:"font-mono text-blue-600",children:s}),'".']}),r.jsxs(et,{to:"/",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all",children:[r.jsx(Ra,{className:"w-4 h-4"}),"Go Home"]})]})}):r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100/80",children:[r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 h-16 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-violet-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md shadow-blue-600/20",children:(e?.name||"")[0]?.toUpperCase()||"S"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-tight",children:e?.name}),r.jsx("p",{className:"text-xs text-slate-500",children:"Live Queue"})]})]}),r.jsx(eM,{})]})}),r.jsxs("div",{className:"max-w-2xl mx-auto px-5 sm:px-8 py-6 sm:py-8",children:[W&&r.jsxs("div",{className:"mb-6 bg-emerald-50 border border-emerald-200 rounded-2xl p-6 text-center animate-scale-in",children:[r.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-3",children:r.jsx(Xt,{className:"w-7 h-7 text-emerald-600"})}),r.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"You're in the queue!"}),r.jsxs("p",{className:"text-slate-600 text-sm mb-2",children:[r.jsx("strong",{children:me}),"  Position #",j]}),r.jsx("button",{onClick:()=>xe(!1),className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium",children:"Dismiss"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Xt,{className:"w-6 h-6 text-blue-600"})}),r.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:D.length}),r.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"People Waiting"})]}),r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center",children:[r.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:r.jsx(S2,{className:"w-6 h-6 text-amber-600"})}),r.jsx("div",{className:"text-3xl font-extrabold text-slate-900",children:d_(K)}),r.jsx("div",{className:"text-sm font-medium text-slate-500 mt-1",children:"Est. Wait (New)"})]})]}),F.length>0&&r.jsxs("div",{className:"mb-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[r.jsx(Da,{className:"w-5 h-5 text-emerald-500"}),"Currently Being Served"]}),r.jsx("div",{className:"space-y-2",children:F.map(we=>r.jsxs("div",{className:"bg-white rounded-xl border border-emerald-200 p-4 flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:r.jsx(Da,{className:"w-5 h-5 text-emerald-600"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-semibold text-slate-900",children:we.clientName}),r.jsx("div",{className:"text-xs text-slate-500",children:we.serviceName||"Service in progress"})]})]},we.id))})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-3 flex items-center gap-2",children:[r.jsx(jn,{className:"w-5 h-5 text-blue-500"}),"Queue"]}),D.length===0?r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-10 text-center",children:[r.jsx("div",{className:"w-14 h-14 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:r.jsx(Xt,{className:"w-7 h-7 text-emerald-500"})}),r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"No Wait!"}),r.jsx("p",{className:"text-sm text-slate-500",children:"The queue is empty  you can walk right in!"})]}):r.jsx("div",{className:"space-y-2",children:D.map((we,V)=>{const ne=I.get(we.id);return r.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4 flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center font-extrabold text-blue-700 text-lg flex-shrink-0",children:V+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-semibold text-slate-900 text-lg truncate",children:we.clientName}),we.serviceName&&r.jsxs("div",{className:"text-sm text-slate-500 flex items-center gap-1",children:[r.jsx(is,{className:"w-3 h-3"}),we.serviceName]})]}),r.jsxs("div",{className:"text-right flex-shrink-0",children:[r.jsx("div",{className:"text-lg font-bold text-amber-600",children:d_(ne)}),r.jsx("div",{className:"text-xs text-slate-400",children:"est. wait"})]})]},we.id)})})]}),!W&&r.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:B?r.jsxs("form",{onSubmit:Se,children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Join the Queue"}),r.jsxs("div",{className:"space-y-3 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Your Name"}),r.jsx("input",{type:"text",value:k.clientName,onChange:we=>L(V=>({...V,clientName:we.target.value})),placeholder:"Optional",className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg"})]}),C.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Service"}),r.jsxs("select",{value:k.serviceId,onChange:we=>L(V=>({...V,serviceId:we.target.value})),className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg",children:[r.jsx("option",{value:"",children:"Select a service"}),C.map(we=>r.jsxs("option",{value:we.id,children:[we.name," (",we.duration,"min  $",Number(we.price).toFixed(2),")"]},we.id))]})]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("button",{type:"submit",disabled:q,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all disabled:opacity-50",children:[r.jsx(fr,{className:"w-5 h-5"}),q?"Joining":"Join Queue"]}),r.jsx("button",{type:"button",onClick:()=>{P(!1),L({clientName:"",serviceId:""})},className:"px-6 py-3 bg-white hover:bg-slate-50 text-slate-700 rounded-xl font-semibold transition-all border border-slate-200",children:"Cancel"})]})]}):r.jsxs("button",{onClick:()=>P(!0),className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-md shadow-blue-600/20 transition-all hover:-translate-y-0.5",children:[r.jsx(fr,{className:"w-5 h-5"}),"Join the Queue"]})})]}),r.jsx("footer",{className:"border-t border-slate-200 mt-auto",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-5 sm:px-8 py-4 flex items-center justify-between",children:[r.jsxs(et,{to:`/shop/${s}`,className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[r.jsx(Vt,{className:"w-4 h-4"}),"Book Online"]}),r.jsxs("span",{className:"text-xs text-slate-400",children:["Powered by"," ",r.jsx(et,{to:"/",className:"font-semibold text-slate-500 hover:text-blue-600 transition-colors",children:"BookFlow"})]})]})})]})}function nM(){const[s,e]=N.useState(null),[n,i]=N.useState(!0);return N.useEffect(()=>{const o=I5(il,u=>{e(u),i(!1)});return()=>o()},[]),n?r.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-fade-in",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Loading"})]})}):r.jsx(zT,{children:r.jsxs(xT,{children:[r.jsx(Ws,{path:"/",element:r.jsx(uD,{})}),r.jsx(Ws,{path:"/register",element:r.jsx(hD,{})}),r.jsx(Ws,{path:"/login",element:r.jsx(fD,{user:s})}),r.jsx(Ws,{path:"/shop/:slug",element:r.jsx(SD,{})}),r.jsx(Ws,{path:"/shop/:slug/booking/:refCode",element:r.jsx(QD,{})}),r.jsx(Ws,{path:"/shop/:slug/waitlist/:refCode",element:r.jsx(ZD,{})}),r.jsx(Ws,{path:"/shop/:slug/queue",element:r.jsx(tM,{})}),r.jsx(Ws,{path:"/shop/:slug/login",element:r.jsx(KD,{user:s})}),r.jsx(Ws,{path:"/shop/:slug/dashboard",element:r.jsx(YD,{user:s})}),r.jsx(Ws,{path:"*",element:r.jsx(pT,{to:"/",replace:!0})})]})})}yS.createRoot(document.getElementById("root")).render(r.jsx(dS.StrictMode,{children:r.jsx(nM,{})}));
